<div class="container">
    <div class="main">
        <div class="db-toolbar-editor">
            <div class="menu-control">
                <ejs-menu #menuObj id="menu" [items]="menuItems" (select)="menuClick($event)">
                </ejs-menu>
            </div>
            <div class="db-toolbar-container">
                <ejs-toolbar #toolbarObj id="toolbarEditor" (clicked)="toolbarClick($event)" width="100%" height="46">
                    <e-items>
                        <e-item prefixIcon="sf-icon-undo" tooltipText="Undo" [disabled]="true"></e-item>
                        <e-item prefixIcon="sf-icon-redo" tooltipText="Redo" [disabled]="true"></e-item>
                        <e-item type="Separator"></e-item>
                        <e-item prefixIcon="sf-icon-pointer tb-icons" tooltipText="Select Tool"
                            cssClass="tb-item-selected"></e-item>
                        <e-item prefixIcon="sf-icon-Pan tb-icons" tooltipText="Pan Tool"></e-item>
                        <e-item type="Separator"></e-item>
                        <e-item prefixIcon="sf-icon-add-child" tooltipText="Add Child" [disabled]="true"></e-item>
                        <e-item prefixIcon="sf-icon-add-sibling" tooltipText="Add Sibling" [disabled]="true"></e-item>
                        <e-item type="Separator"></e-item>
                        <e-item cssClass="tb-item-end tb-zoom-dropdown-btn" align="Right">
                            <ng-template #template>
                                <button ejs-dropdownbutton id="btnZoomIncrement" [items]="zoomMenuItems"
                                    [content]="zoomContent" (select)="zoomChange($event)">
                                </button>
                            </ng-template>
                        </e-item>
                    </e-items>
                </ejs-toolbar>
            </div>
        </div>
        <div class="diagram-upload-file">
            <ejs-uploader id="fileupload" name="UploadFiles" [asyncSettings]="asyncSettings"
                (success)="onUploadSuccess($event)" [showFileList]="false">
            </ejs-uploader>
        </div>
        <div id="shortcutDiv"
            style="width: 400px; height: 480px; padding: 10px; background-color: #fff7b5; border: 1px solid #fff7b5; position: absolute; margin: 27px; visibility: hidden; z-index: 1000;">

            <!-- Close Icon -->
            <div id="closeIconDiv" style="float: right; width: 22px; height: 22px; border: 1px solid #fff7b5;"
                (click)="onHideNodeClick()">
                <span class="sf-icon-close" style="font-size: 14px; cursor: pointer;"></span>
            </div>

            <!-- Quick shortcuts Title -->
            <div>
                <span class="db-html-font-medium">Quick shortcuts</span>
            </div>

            <!-- Shortcut List -->
            <div style="padding-top: 10px;">
                <ul>
                    <li>
                        <span class="db-html-font-medium">Tab : </span>
                        <span class="db-html-font-normal">Add a subtopic to the left</span>
                    </li>
                    <li>
                        <span class="db-html-font-medium">Shift + Tab : </span>
                        <span class="db-html-font-normal">Add a subtopic to the right</span>
                    </li>
                    <li>
                        <span class="db-html-font-medium">Enter : </span>
                        <span class="db-html-font-normal">Add a new sibling child</span>
                    </li>
                    <li>
                        <span class="db-html-font-medium">Delete / Backspace : </span>
                        <span class="db-html-font-normal">Delete a topic</span>
                    </li>
                    <li>
                        <span class="db-html-font-medium">Arrow(Up, Down, Left, Right) : </span>
                        <span class="db-html-font-normal">Navigate between topics</span>
                    </li>
                    <li>
                        <span class="db-html-font-medium">F2 : </span>
                        <span class="db-html-font-normal">Edit a topic</span>
                    </li>
                    <li>
                        <span class="db-html-font-medium">Esc : </span>
                        <span class="db-html-font-normal">End text editing</span>
                    </li>
                    <li>
                        <span class="db-html-font-medium">Ctrl + B : </span>
                        <span class="db-html-font-normal">To make text bold</span>
                    </li>
                    <li>
                        <span class="db-html-font-medium">Ctrl + I : </span>
                        <span class="db-html-font-normal">To make text Italic</span>
                    </li>
                    <li>
                        <span class="db-html-font-medium">Ctrl + U : </span>
                        <span class="db-html-font-normal">Underline the text</span>
                    </li>
                    <li>
                        <span class="db-html-font-medium">Space : </span>
                        <span class="db-html-font-normal">Expand / Collapse the selected node</span>
                    </li>
                    <li>
                        <span class="db-html-font-medium">Ctrl + E :</span>
                        <span class="db-html-font-normal">Expand / Collapse the whole diagram</span>
                    </li>
                    <li>
                        <span class="db-html-font-medium">F8 : </span>
                        <span class="db-html-font-normal">To Fit the diagram into the viewport</span>
                    </li>
                    <li>
                        <span class="db-html-font-medium">F1 : </span>
                        <span class="db-html-font-normal">Show/Hide shortcut Key</span>
                    </li>
                </ul>
            </div>
        </div>

        <div style="margin-top: 5px; margin-left: 5px; margin-right: 5px; border: 1px solid #b0b0b0;">
            <ejs-diagram #diagram id="diagram" width="100%" height="900px" [tool]="diagramToolDefaults"
                (selectionChange)="selectionChange($event)" (historyChange)="historyChange()"
                (scrollChange)="onScrollChange($event)" (onUserHandleMouseDown)="onUserHandleMouseDown($event)"
                [snapSettings]="{ horizontalGridlines: gridlines, verticalGridlines: gridlines }"
                [scrollSettings]="{ scrollLimit: 'Infinity' }" [layout]="{
        type: 'MindMap',
        horizontalSpacing: 80,
        verticalSpacing: 50,
        getBranch: 'getBranch'
      }" [selectedItems]="selectedItems" [dataSourceSettings]="{
        id: 'id',
        parentId: 'parentId',
        dataSource: items,
        root: '1'
      }" [rulerSettings]="{ showRulers: true }" [getNodeDefaults]="getNodeDefaults"
                [getConnectorDefaults]="getConnectorDefaults" (dragEnter)="dragEnter($event)">
            </ejs-diagram>
        </div>

    </div>
    <div id='container'>
        <ejs-dialog #dialog id="dialog"
            header='<span class="e-icons e-aiassist-chat" style="color: black; width:20px; font-size: 16px;"></span> AI Assist'
            [showCloseIcon]="true" [isModal]="true" target='#container' width="540px" height="310px" [visible]="false">
            <p style="margin-bottom: 10px; font-weight: bold;">Suggested Prompts</p>

            <button ejs-button id="btn2" cssClass="e-primary"
                (click)="onBtnClick('Mindmap for top tourist places in the world')"
                style="flex: 1; overflow: visible; border-radius: 8px; margin-bottom: 10px">
                Mindmap for top tourist places in the world
            </button>

            <button ejs-button id="btn1" cssClass="e-primary"
                (click)="onBtnClick('Mindmap for categories of topics in science')"
                style="flex: 1; overflow: visible; border-radius: 8px; margin-bottom: 10px">
                Mindmap for categories of topics in science
            </button>

            <button ejs-button id="btn3" cssClass="e-primary"
                (click)="onBtnClick('Mindmap for different components in syncfusion')"
                style="flex: 1; overflow: visible; border-radius: 8px; margin-bottom: 10px">
                Mindmap for different components in syncfusion
            </button>

            <div style="display: flex; align-items: center; margin-top: 20px;">
                <ejs-textbox #textBox id="textBox" placeholder="Please enter your prompt here..." style="flex: 1;"
                    (input)="onTextBoxChange($event)"></ejs-textbox>

                <button ejs-button id="db-send" (click)="onSendClick()" iconCss='e-icons e-send' cssClass="e-primary"
                    style="margin-left: 5px; height: 32px; width: 32px;"></button>
            </div>
        </ejs-dialog>

    </div>
    <button ejs-button id="ai-assist" [isPrimary]="true" content="AI Assist" iconCss="e-icons e-assist-chat"
        (click)="showDialog()"></button>
    <div id="loadingContainer" class="loading-container">
        <div class="loading-indicator"></div>
        <div class="loading-text">Generating Mindmap...</div>
    </div>
</div>