var tR=Object.defineProperty,iR=Object.defineProperties;var rR=Object.getOwnPropertyDescriptors;var vM=Object.getOwnPropertySymbols;var nR=Object.prototype.hasOwnProperty,sR=Object.prototype.propertyIsEnumerable;var mM=(o,e,t)=>e in o?tR(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,Sl=(o,e)=>{for(var t in e||={})nR.call(e,t)&&mM(o,t,e[t]);if(vM)for(var t of vM(e))sR.call(e,t)&&mM(o,t,e[t]);return o},fh=(o,e)=>iR(o,rR(e));var yM=null;var Ab=1,bM=Symbol("SIGNAL");function As(o){let e=yM;return yM=o,e}var SM={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function aR(o){if(!(kb(o)&&!o.dirty)&&!(!o.dirty&&o.lastCleanEpoch===Ab)){if(!o.producerMustRecompute(o)&&!Tb(o)){o.dirty=!1,o.lastCleanEpoch=Ab;return}o.producerRecomputeValue(o),o.dirty=!1,o.lastCleanEpoch=Ab}}function CM(o){return o&&(o.nextProducerIndex=0),As(o)}function wM(o,e){if(As(e),!(!o||o.producerNode===void 0||o.producerIndexOfThis===void 0||o.producerLastReadVersion===void 0)){if(kb(o))for(let t=o.nextProducerIndex;t<o.producerNode.length;t++)Lb(o.producerNode[t],o.producerIndexOfThis[t]);for(;o.producerNode.length>o.nextProducerIndex;)o.producerNode.pop(),o.producerLastReadVersion.pop(),o.producerIndexOfThis.pop()}}function Tb(o){Gf(o);for(let e=0;e<o.producerNode.length;e++){let t=o.producerNode[e],i=o.producerLastReadVersion[e];if(i!==t.version||(aR(t),i!==t.version))return!0}return!1}function xM(o){if(Gf(o),kb(o))for(let e=0;e<o.producerNode.length;e++)Lb(o.producerNode[e],o.producerIndexOfThis[e]);o.producerNode.length=o.producerLastReadVersion.length=o.producerIndexOfThis.length=0,o.liveConsumerNode&&(o.liveConsumerNode.length=o.liveConsumerIndexOfThis.length=0)}function Lb(o,e){if(oR(o),Gf(o),o.liveConsumerNode.length===1)for(let i=0;i<o.producerNode.length;i++)Lb(o.producerNode[i],o.producerIndexOfThis[i]);let t=o.liveConsumerNode.length-1;if(o.liveConsumerNode[e]=o.liveConsumerNode[t],o.liveConsumerIndexOfThis[e]=o.liveConsumerIndexOfThis[t],o.liveConsumerNode.length--,o.liveConsumerIndexOfThis.length--,e<o.liveConsumerNode.length){let i=o.liveConsumerIndexOfThis[e],r=o.liveConsumerNode[e];Gf(r),r.producerIndexOfThis[i]=e}}function kb(o){return o.consumerIsAlwaysLive||(o?.liveConsumerNode?.length??0)>0}function Gf(o){o.producerNode??=[],o.producerIndexOfThis??=[],o.producerLastReadVersion??=[]}function oR(o){o.liveConsumerNode??=[],o.liveConsumerIndexOfThis??=[]}function lR(){throw new Error}var hR=lR;function IM(o){hR=o}function fs(o){return typeof o=="function"}function Yf(o){let t=o(i=>{Error.call(i),i.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Qf=Yf(o=>function(t){o(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((i,r)=>`${r+1}) ${i.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Dd(o,e){if(o){let t=o.indexOf(e);0<=t&&o.splice(t,1)}}var gs=class o{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let n of t)n.remove(this);else t.remove(this);let{initialTeardown:i}=this;if(fs(i))try{i()}catch(n){e=n instanceof Qf?n.errors:[n]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let n of r)try{MM(n)}catch(s){e=e??[],s instanceof Qf?e=[...e,...s.errors]:e.push(s)}}if(e)throw new Qf(e)}}add(e){var t;if(e&&e!==this)if(this.closed)MM(e);else{if(e instanceof o){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Dd(t,e)}remove(e){let{_finalizers:t}=this;t&&Dd(t,e),e instanceof o&&e._removeParent(this)}};gs.EMPTY=(()=>{let o=new gs;return o.closed=!0,o})();var Nb=gs.EMPTY;function Xf(o){return o instanceof gs||o&&"closed"in o&&fs(o.remove)&&fs(o.add)&&fs(o.unsubscribe)}function MM(o){fs(o)?o():o.unsubscribe()}var wa={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Tu={setTimeout(o,e,...t){let{delegate:i}=Tu;return i?.setTimeout?i.setTimeout(o,e,...t):setTimeout(o,e,...t)},clearTimeout(o){let{delegate:e}=Tu;return(e?.clearTimeout||clearTimeout)(o)},delegate:void 0};function DM(o){Tu.setTimeout(()=>{let{onUnhandledError:e}=wa;if(e)e(o);else throw o})}function Fb(){}var EM=Ob("C",void 0,void 0);function AM(o){return Ob("E",void 0,o)}function TM(o){return Ob("N",o,void 0)}function Ob(o,e,t){return{kind:o,value:e,error:t}}var gh=null;function Lu(o){if(wa.useDeprecatedSynchronousErrorHandling){let e=!gh;if(e&&(gh={errorThrown:!1,error:null}),o(),e){let{errorThrown:t,error:i}=gh;if(gh=null,t)throw i}}else o()}function LM(o){wa.useDeprecatedSynchronousErrorHandling&&gh&&(gh.errorThrown=!0,gh.error=o)}var vh=class extends gs{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Xf(e)&&e.add(this)):this.destination=dR}static create(e,t,i){return new ku(e,t,i)}next(e){this.isStopped?Pb(TM(e),this):this._next(e)}error(e){this.isStopped?Pb(AM(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Pb(EM,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},uR=Function.prototype.bind;function Rb(o,e){return uR.call(o,e)}var Bb=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){$f(i)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){$f(i)}else $f(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){$f(t)}}},ku=class extends vh{constructor(e,t,i){super();let r;if(fs(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let n;this&&wa.useDeprecatedNextContext?(n=Object.create(e),n.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&Rb(e.next,n),error:e.error&&Rb(e.error,n),complete:e.complete&&Rb(e.complete,n)}):r=e}this.destination=new Bb(r)}};function $f(o){wa.useDeprecatedSynchronousErrorHandling?LM(o):DM(o)}function cR(o){throw o}function Pb(o,e){let{onStoppedNotification:t}=wa;t&&Tu.setTimeout(()=>t(o,e))}var dR={closed:!0,next:Fb,error:cR,complete:Fb};var kM=typeof Symbol=="function"&&Symbol.observable||"@@observable";function NM(o){return o}function FM(o){return o.length===0?NM:o.length===1?o[0]:function(t){return o.reduce((i,r)=>r(i),t)}}var zb=(()=>{class o{constructor(t){t&&(this._subscribe=t)}lift(t){let i=new o;return i.source=this,i.operator=t,i}subscribe(t,i,r){let n=fR(t)?t:new ku(t,i,r);return Lu(()=>{let{operator:s,source:a}=this;n.add(s?s.call(n,a):a?this._subscribe(n):this._trySubscribe(n))}),n}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return i=OM(i),new i((r,n)=>{let s=new ku({next:a=>{try{t(a)}catch(l){n(l),s.unsubscribe()}},error:n,complete:r});this.subscribe(s)})}_subscribe(t){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(t)}[kM](){return this}pipe(...t){return FM(t)(this)}toPromise(t){return t=OM(t),new t((i,r)=>{let n;this.subscribe(s=>n=s,s=>r(s),()=>i(n))})}}return o.create=e=>new o(e),o})();function OM(o){var e;return(e=o??wa.Promise)!==null&&e!==void 0?e:Promise}function pR(o){return o&&fs(o.next)&&fs(o.error)&&fs(o.complete)}function fR(o){return o&&o instanceof vh||pR(o)&&Xf(o)}function gR(o){return fs(o?.lift)}function RM(o){return e=>{if(gR(e))return e.lift(function(t){try{return o(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function PM(o,e,t,i,r){return new jb(o,e,t,i,r)}var jb=class extends vh{constructor(e,t,i,r,n,s){super(e),this.onFinalize=n,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var BM=Yf(o=>function(){o(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Nu=(()=>{class o extends zb{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let i=new Kf(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new BM}next(t){Lu(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let i of this.currentObservers)i.next(t)}})}error(t){Lu(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Lu(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:i,isStopped:r,observers:n}=this;return i||r?Nb:(this.currentObservers=null,n.push(t),new gs(()=>{this.currentObservers=null,Dd(n,t)}))}_checkFinalizedStatuses(t){let{hasError:i,thrownError:r,isStopped:n}=this;i?t.error(r):n&&t.complete()}asObservable(){let t=new zb;return t.source=this,t}}return o.create=(e,t)=>new Kf(e,t),o})(),Kf=class extends Nu{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.next)===null||i===void 0||i.call(t,e)}error(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.error)===null||i===void 0||i.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,i;return(i=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&i!==void 0?i:Nb}};var Ed=class extends Nu{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}};function Zf(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n}function Hb(o,e){return RM((t,i)=>{let r=0;t.subscribe(PM(i,n=>{i.next(o.call(e,n,r++))}))})}var Hi=class extends Error{constructor(e,t){super(T0(e,t)),this.code=e}};function T0(o,e){return`${`NG0${Math.abs(o)}`}${e?": "+e:""}`}function dr(o){for(let e in o)if(o[e]===dr)return e;throw Error("Could not find renamed property on target object.")}function vR(o,e){for(let t in e)e.hasOwnProperty(t)&&!o.hasOwnProperty(t)&&(o[t]=e[t])}function Ea(o){if(typeof o=="string")return o;if(Array.isArray(o))return"["+o.map(Ea).join(", ")+"]";if(o==null)return""+o;if(o.overriddenName)return`${o.overriddenName}`;if(o.name)return`${o.name}`;let e=o.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function zM(o,e){return o==null||o===""?e===null?"":e:e==null||e===""?o:o+" "+e}var mR=dr({__forward_ref__:dr});function bD(o){return o.__forward_ref__=bD,o.toString=function(){return Ea(this())},o}function Ia(o){return yR(o)?o():o}function yR(o){return typeof o=="function"&&o.hasOwnProperty(mR)&&o.__forward_ref__===bD}function SD(o){return o&&!!o.\u0275providers}var bR=dr({\u0275cmp:dr}),SR=dr({\u0275dir:dr}),CR=dr({\u0275pipe:dr});var jM=dr({\u0275fac:dr}),Ad=dr({__NG_ELEMENT_ID__:dr}),HM=dr({__NG_ENV_ID__:dr});function wR(o){return typeof o=="string"?o:o==null?"":String(o)}function xR(o){return typeof o=="function"?o.name||o.toString():typeof o=="object"&&o!=null&&typeof o.type=="function"?o.type.name||o.type.toString():wR(o)}function IR(o,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${o}`:"";throw new Hi(-200,`Circular dependency in DI detected for ${o}${t}`)}function L0(o,e){throw new Hi(-201,!1)}function MR(o,e){o==null&&DR(e,o,null,"!=")}function DR(o,e,t,i){throw new Error(`ASSERTION ERROR: ${o}`+(i==null?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}function pn(o){return{token:o.token,providedIn:o.providedIn||null,factory:o.factory,value:void 0}}function qd(o){return{providers:o.providers||[],imports:o.imports||[]}}function k0(o){return VM(o,CD)||VM(o,wD)}function VM(o,e){return o.hasOwnProperty(e)?o[e]:null}function ER(o){let e=o&&(o[CD]||o[wD]);return e||null}function _M(o){return o&&(o.hasOwnProperty(UM)||o.hasOwnProperty(AR))?o[UM]:null}var CD=dr({\u0275prov:dr}),UM=dr({\u0275inj:dr}),wD=dr({ngInjectableDef:dr}),AR=dr({ngInjectorDef:dr}),gi=function(o){return o[o.Default=0]="Default",o[o.Host=1]="Host",o[o.Self=2]="Self",o[o.SkipSelf=4]="SkipSelf",o[o.Optional=8]="Optional",o}(gi||{}),Kb;function TR(){return Kb}function Ja(o){let e=Kb;return Kb=o,e}function xD(o,e,t){let i=k0(o);if(i&&i.providedIn=="root")return i.value===void 0?i.value=i.factory():i.value;if(t&gi.Optional)return null;if(e!==void 0)return e;L0(o,"Injector")}var Td=globalThis;var yr=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=pn({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};var LR={},Nd=LR,kR="__NG_DI_FLAG__",ag="ngTempTokenPath",NR="ngTokenPath",FR=/\n/gm,OR="\u0275",WM="__source",Ld;function Fu(o){let e=Ld;return Ld=o,e}function RR(o,e=gi.Default){if(Ld===void 0)throw new Hi(-203,!1);return Ld===null?xD(o,void 0,e):Ld.get(o,e&gi.Optional?null:void 0,e)}function Xi(o,e=gi.Default){return(TR()||RR)(Ia(o),e)}function Tn(o,e=gi.Default){return Xi(o,Sg(e))}function Sg(o){return typeof o>"u"||typeof o=="number"?o:0|(o.optional&&8)|(o.host&&1)|(o.self&&2)|(o.skipSelf&&4)}function Zb(o){let e=[];for(let t=0;t<o.length;t++){let i=Ia(o[t]);if(Array.isArray(i)){if(i.length===0)throw new Hi(900,!1);let r,n=gi.Default;for(let s=0;s<i.length;s++){let a=i[s],l=PR(a);typeof l=="number"?l===-1?r=a.token:n|=l:r=a}e.push(Xi(r,n))}else e.push(Xi(i))}return e}function PR(o){return o[kR]}function BR(o,e,t,i){let r=o[ag];throw e[WM]&&r.unshift(e[WM]),o.message=zR(`
`+o.message,r,t,i),o[NR]=r,o[ag]=null,o}function zR(o,e,t,i=null){o=o&&o.charAt(0)===`
`&&o.charAt(1)==OR?o.slice(2):o;let r=Ea(e);if(Array.isArray(e))r=e.map(Ea).join(" -> ");else if(typeof e=="object"){let n=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];n.push(s+":"+(typeof a=="string"?JSON.stringify(a):Ea(a)))}r=`{${n.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${o.replace(FR,`
  `)}`}function N0(o){return{toString:o}.toString()}var ID=function(o){return o[o.OnPush=0]="OnPush",o[o.Default=1]="Default",o}(ID||{}),ro=function(o){return o[o.Emulated=0]="Emulated",o[o.None=2]="None",o[o.ShadowDom=3]="ShadowDom",o}(ro||{}),zu={},Ma=[],bh=function(o){return o[o.None=0]="None",o[o.SignalBased=1]="SignalBased",o[o.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",o}(bh||{});function MD(o,e,t){let i=o.length;for(;;){let r=o.indexOf(e,t);if(r===-1)return r;if(r===0||o.charCodeAt(r-1)<=32){let n=e.length;if(r+n===i||o.charCodeAt(r+n)<=32)return r}t=r+1}}function Jb(o,e,t){let i=0;for(;i<t.length;){let r=t[i];if(typeof r=="number"){if(r!==0)break;i++;let n=t[i++],s=t[i++],a=t[i++];o.setAttribute(e,s,a,n)}else{let n=r,s=t[++i];HR(n)?o.setProperty(e,n,s):o.setAttribute(e,n,s),i++}}return i}function jR(o){return o===3||o===4||o===6}function HR(o){return o.charCodeAt(0)===64}function Fd(o,e){if(!(e===null||e.length===0))if(o===null||o.length===0)o=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){let r=e[i];typeof r=="number"?t=r:t===0||(t===-1||t===2?qM(o,t,r,null,e[++i]):qM(o,t,r,null,null))}}return o}function qM(o,e,t,i,r){let n=0,s=o.length;if(e===-1)s=-1;else for(;n<o.length;){let a=o[n++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=n-1;break}}}for(;n<o.length;){let a=o[n];if(typeof a=="number")break;if(a===t){if(i===null){r!==null&&(o[n+1]=r);return}else if(i===o[n+1]){o[n+2]=r;return}}n++,i!==null&&n++,r!==null&&n++}s!==-1&&(o.splice(s,0,e),n=s+1),o.splice(n++,0,t),i!==null&&o.splice(n++,0,i),r!==null&&o.splice(n++,0,r)}var DD="ng-template";function VR(o,e,t){let i=0,r=!0;for(;i<o.length;){let n=o[i++];if(typeof n=="string"&&r){let s=o[i++];if(t&&n==="class"&&MD(s.toLowerCase(),e,0)!==-1)return!0}else if(n===1){for(;i<o.length&&typeof(n=o[i++])=="string";)if(n.toLowerCase()===e)return!0;return!1}else typeof n=="number"&&(r=!1)}return!1}function ED(o){return o.type===4&&o.value!==DD}function _R(o,e,t){let i=o.type===4&&!t?DD:o.value;return e===i}function UR(o,e,t){let i=4,r=o.attrs||[],n=GR(r),s=!1;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="number"){if(!s&&!xa(i)&&!xa(l))return!1;if(s&&xa(l))continue;s=!1,i=l|i&1;continue}if(!s)if(i&4){if(i=2|i&1,l!==""&&!_R(o,l,t)||l===""&&e.length===1){if(xa(i))return!1;s=!0}}else{let h=i&8?l:e[++a];if(i&8&&o.attrs!==null){if(!VR(o.attrs,h,t)){if(xa(i))return!1;s=!0}continue}let u=i&8?"class":l,c=WR(u,r,ED(o),t);if(c===-1){if(xa(i))return!1;s=!0;continue}if(h!==""){let d;c>n?d="":d=r[c+1].toLowerCase();let p=i&8?d:null;if(p&&MD(p,h,0)!==-1||i&2&&h!==d){if(xa(i))return!1;s=!0}}}}return xa(i)||s}function xa(o){return(o&1)===0}function WR(o,e,t,i){if(e===null)return-1;let r=0;if(i||!t){let n=!1;for(;r<e.length;){let s=e[r];if(s===o)return r;if(s===3||s===6)n=!0;else if(s===1||s===2){let a=e[++r];for(;typeof a=="string";)a=e[++r];continue}else{if(s===4)break;if(s===0){r+=4;continue}}r+=n?1:2}return-1}else return YR(e,o)}function AD(o,e,t=!1){for(let i=0;i<e.length;i++)if(UR(o,e[i],t))return!0;return!1}function qR(o){let e=o.attrs;if(e!=null){let t=e.indexOf(5);if(!(t&1))return e[t+1]}return null}function GR(o){for(let e=0;e<o.length;e++){let t=o[e];if(jR(t))return e}return o.length}function YR(o,e){let t=o.indexOf(4);if(t>-1)for(t++;t<o.length;){let i=o[t];if(typeof i=="number")return-1;if(i===e)return t;t++}return-1}function QR(o,e){e:for(let t=0;t<e.length;t++){let i=e[t];if(o.length===i.length){for(let r=0;r<o.length;r++)if(o[r]!==i[r])continue e;return!0}}return!1}function GM(o,e){return o?":not("+e.trim()+")":e}function XR(o){let e=o[0],t=1,i=2,r="",n=!1;for(;t<o.length;){let s=o[t];if(typeof s=="string")if(i&2){let a=o[++t];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else i&8?r+="."+s:i&4&&(r+=" "+s);else r!==""&&!xa(s)&&(e+=GM(n,r),r=""),i=s,n=n||!xa(i);t++}return r!==""&&(e+=GM(n,r)),e}function $R(o){return o.map(XR).join(",")}function KR(o){let e=[],t=[],i=1,r=2;for(;i<o.length;){let n=o[i];if(typeof n=="string")r===2?n!==""&&e.push(n,o[++i]):r===8&&t.push(n);else{if(!xa(r))break;r=n}i++}return{attrs:e,classes:t}}function qu(o){return N0(()=>{let e=kD(o),t=fh(Sl({},e),{decls:o.decls,vars:o.vars,template:o.template,consts:o.consts||null,ngContentSelectors:o.ngContentSelectors,onPush:o.changeDetection===ID.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&o.dependencies||null,getStandaloneInjector:null,signals:o.signals??!1,data:o.data||{},encapsulation:o.encapsulation||ro.Emulated,styles:o.styles||Ma,_:null,schemas:o.schemas||null,tView:null,id:""});ND(t);let i=o.dependencies;return t.directiveDefs=QM(i,!1),t.pipeDefs=QM(i,!0),t.id=tP(t),t})}function ZR(o){return ju(o)||TD(o)}function JR(o){return o!==null}function Gd(o){return N0(()=>({type:o.type,bootstrap:o.bootstrap||Ma,declarations:o.declarations||Ma,imports:o.imports||Ma,exports:o.exports||Ma,transitiveCompileScopes:null,schemas:o.schemas||null,id:o.id||null}))}function YM(o,e){if(o==null)return zu;let t={};for(let i in o)if(o.hasOwnProperty(i)){let r=o[i],n,s,a=bh.None;Array.isArray(r)?(a=r[0],n=r[1],s=r[2]??n):(n=r,s=r),e?(t[n]=a!==bh.None?[i,a]:i,e[n]=s):t[n]=i}return t}function nn(o){return N0(()=>{let e=kD(o);return ND(e),e})}function ju(o){return o[bR]||null}function TD(o){return o[SR]||null}function LD(o){return o[CR]||null}function eP(o){let e=ju(o)||TD(o)||LD(o);return e!==null?e.standalone:!1}function kD(o){let e={};return{type:o.type,providersResolver:null,factory:null,hostBindings:o.hostBindings||null,hostVars:o.hostVars||0,hostAttrs:o.hostAttrs||null,contentQueries:o.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:o.inputs||zu,exportAs:o.exportAs||null,standalone:o.standalone===!0,signals:o.signals===!0,selectors:o.selectors||Ma,viewQuery:o.viewQuery||null,features:o.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:YM(o.inputs,e),outputs:YM(o.outputs),debugInfo:null}}function ND(o){o.features?.forEach(e=>e(o))}function QM(o,e){if(!o)return null;let t=e?LD:ZR;return()=>(typeof o=="function"?o():o).map(i=>t(i)).filter(JR)}function tP(o){let e=0,t=[o.selectors,o.ngContentSelectors,o.hostVars,o.hostAttrs,o.consts,o.vars,o.decls,o.encapsulation,o.standalone,o.signals,o.exportAs,JSON.stringify(o.inputs),JSON.stringify(o.outputs),Object.getOwnPropertyNames(o.type.prototype),!!o.contentQueries,!!o.viewQuery].join("|");for(let r of t)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}var Bo=0,hi=1,Pt=2,Ln=3,Aa=4,Ls=5,Od=6,Rd=7,Oo=8,Hu=9,Cl=10,vs=11,Pd=12,XM=13,Yd=14,no=15,Qd=16,Ou=17,io=18,Cg=19,FD=20,kd=21,Vb=22,Sh=23,wl=25,OD=1;var Ch=7,og=8,Vu=9,Ts=10,F0=function(o){return o[o.None=0]="None",o[o.HasTransplantedViews=2]="HasTransplantedViews",o}(F0||{});function mh(o){return Array.isArray(o)&&typeof o[OD]=="object"}function zo(o){return Array.isArray(o)&&o[OD]===!0}function RD(o){return(o.flags&4)!==0}function O0(o){return o.componentOffset>-1}function PD(o){return(o.flags&1)===1}function wh(o){return!!o.template}function iP(o){return(o[Pt]&512)!==0}function Bd(o,e){let t=o.hasOwnProperty(jM);return t?o[jM]:null}var e0=class{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}};function BD(o,e,t,i){e!==null?e.applyValueToInputSignal(e,i):o[t]=i}function zD(){return jD}function jD(o){return o.type.prototype.ngOnChanges&&(o.setInput=nP),rP}zD.ngInherit=!0;function rP(){let o=VD(this),e=o?.current;if(e){let t=o.previous;if(t===zu)o.previous=e;else for(let i in e)t[i]=e[i];o.current=null,this.ngOnChanges(e)}}function nP(o,e,t,i,r){let n=this.declaredInputs[i],s=VD(o)||sP(o,{previous:zu,current:null}),a=s.current||(s.current={}),l=s.previous,h=l[n];a[n]=new e0(h&&h.currentValue,t,l===zu),BD(o,e,r,t)}var HD="__ngSimpleChanges__";function VD(o){return o[HD]||null}function sP(o,e){return o[HD]=e}var $M=null;var eo=function(o,e,t){$M?.(o,e,t)},aP="svg",oP="math",lP=!1;function hP(){return lP}function Ro(o){for(;Array.isArray(o);)o=o[Bo];return o}function Ta(o,e){return Ro(e[o.index])}function _D(o,e){return o.data[e]}function Ih(o,e){let t=e[o];return mh(t)?t:t[Bo]}function uP(o){return(o[Pt]&4)===4}function R0(o){return(o[Pt]&128)===128}function cP(o){return zo(o[Ln])}function KM(o,e){return e==null?null:o[e]}function UD(o){o[Ou]=0}function dP(o){o[Pt]&1024||(o[Pt]|=1024,R0(o)&&zd(o))}function WD(o){return o[Pt]&9216||o[Sh]?.dirty}function t0(o){WD(o)?zd(o):o[Pt]&64&&(hP()?(o[Pt]|=1024,zd(o)):o[Cl].changeDetectionScheduler?.notify())}function zd(o){o[Cl].changeDetectionScheduler?.notify();let e=jd(o);for(;e!==null&&!(e[Pt]&8192||(e[Pt]|=8192,!R0(e)));)e=jd(e)}function pP(o,e){if((o[Pt]&256)===256)throw new Hi(911,!1);o[kd]===null&&(o[kd]=[]),o[kd].push(e)}function jd(o){let e=o[Ln];return zo(e)?e[Ln]:e}var Ti={lFrame:JD(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function fP(){return Ti.lFrame.elementDepthCount}function gP(){Ti.lFrame.elementDepthCount++}function vP(){Ti.lFrame.elementDepthCount--}function qD(){return Ti.bindingsEnabled}function GD(){return Ti.skipHydrationRootTNode!==null}function mP(o){return Ti.skipHydrationRootTNode===o}function yP(){Ti.skipHydrationRootTNode=null}function rn(){return Ti.lFrame.lView}function so(){return Ti.lFrame.tView}function La(){let o=YD();for(;o!==null&&o.type===64;)o=o.parent;return o}function YD(){return Ti.lFrame.currentTNode}function bP(){let o=Ti.lFrame,e=o.currentTNode;return o.isParent?e:e.parent}function wg(o,e){let t=Ti.lFrame;t.currentTNode=o,t.isParent=e}function QD(){return Ti.lFrame.isParent}function XD(){Ti.lFrame.isParent=!1}function SP(o){return Ti.lFrame.bindingIndex=o}function CP(){return Ti.lFrame.bindingIndex++}function wP(){return Ti.lFrame.inI18n}function xP(o,e){let t=Ti.lFrame;t.bindingIndex=t.bindingRootIndex=o,i0(e)}function IP(){return Ti.lFrame.currentDirectiveIndex}function i0(o){Ti.lFrame.currentDirectiveIndex=o}function $D(){return Ti.lFrame.currentQueryIndex}function P0(o){Ti.lFrame.currentQueryIndex=o}function MP(o){let e=o[hi];return e.type===2?e.declTNode:e.type===1?o[Ls]:null}function KD(o,e,t){if(t&gi.SkipSelf){let r=e,n=o;for(;r=r.parent,r===null&&!(t&gi.Host);)if(r=MP(n),r===null||(n=n[Yd],r.type&10))break;if(r===null)return!1;e=r,o=n}let i=Ti.lFrame=ZD();return i.currentTNode=e,i.lView=o,!0}function B0(o){let e=ZD(),t=o[hi];Ti.lFrame=e,e.currentTNode=t.firstChild,e.lView=o,e.tView=t,e.contextLView=o,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function ZD(){let o=Ti.lFrame,e=o===null?null:o.child;return e===null?JD(o):e}function JD(o){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:o,child:null,inI18n:!1};return o!==null&&(o.child=e),e}function e1(){let o=Ti.lFrame;return Ti.lFrame=o.parent,o.currentTNode=null,o.lView=null,o}var t1=e1;function z0(){let o=e1();o.isParent=!0,o.tView=null,o.selectedIndex=-1,o.contextLView=null,o.elementDepthCount=0,o.currentDirectiveIndex=-1,o.currentNamespace=null,o.bindingRootIndex=-1,o.bindingIndex=-1,o.currentQueryIndex=0}function i1(){return Ti.lFrame.selectedIndex}function xh(o){Ti.lFrame.selectedIndex=o}function DP(){let o=Ti.lFrame;return _D(o.tView,o.selectedIndex)}function EP(){return Ti.lFrame.currentNamespace}var r1=!0;function n1(){return r1}function s1(o){r1=o}function AP(o,e,t){let{ngOnChanges:i,ngOnInit:r,ngDoCheck:n}=e.type.prototype;if(i){let s=jD(e);(t.preOrderHooks??=[]).push(o,s),(t.preOrderCheckHooks??=[]).push(o,s)}r&&(t.preOrderHooks??=[]).push(0-o,r),n&&((t.preOrderHooks??=[]).push(o,n),(t.preOrderCheckHooks??=[]).push(o,n))}function a1(o,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){let n=o.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:h,ngOnDestroy:u}=n;s&&(o.contentHooks??=[]).push(-t,s),a&&((o.contentHooks??=[]).push(t,a),(o.contentCheckHooks??=[]).push(t,a)),l&&(o.viewHooks??=[]).push(-t,l),h&&((o.viewHooks??=[]).push(t,h),(o.viewCheckHooks??=[]).push(t,h)),u!=null&&(o.destroyHooks??=[]).push(t,u)}}function eg(o,e,t){o1(o,e,3,t)}function tg(o,e,t,i){(o[Pt]&3)===t&&o1(o,e,t,i)}function _b(o,e){let t=o[Pt];(t&3)===e&&(t&=16383,t+=1,o[Pt]=t)}function o1(o,e,t,i){let r=i!==void 0?o[Ou]&65535:0,n=i??-1,s=e.length-1,a=0;for(let l=r;l<s;l++)if(typeof e[l+1]=="number"){if(a=e[l],i!=null&&a>=i)break}else e[l]<0&&(o[Ou]+=65536),(a<n||n==-1)&&(TP(o,t,e,l),o[Ou]=(o[Ou]&4294901760)+l+2),l++}function ZM(o,e){eo(4,o,e);let t=As(null);try{e.call(o)}finally{As(t),eo(5,o,e)}}function TP(o,e,t,i){let r=t[i]<0,n=t[i+1],s=r?-t[i]:t[i],a=o[s];r?o[Pt]>>14<o[Ou]>>16&&(o[Pt]&3)===e&&(o[Pt]+=16384,ZM(a,n)):ZM(a,n)}var Bu=-1,Hd=class{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}};function LP(o){return o instanceof Hd}function kP(o){return(o.flags&8)!==0}function NP(o){return(o.flags&16)!==0}function l1(o){return o!==Bu}function lg(o){return o&32767}function FP(o){return o>>16}function hg(o,e){let t=FP(o),i=e;for(;t>0;)i=i[Yd],t--;return i}var r0=!0;function JM(o){let e=r0;return r0=o,e}var OP=256,h1=OP-1,u1=5,RP=0,to={};function PP(o,e,t){let i;typeof t=="string"?i=t.charCodeAt(0)||0:t.hasOwnProperty(Ad)&&(i=t[Ad]),i==null&&(i=t[Ad]=RP++);let r=i&h1,n=1<<r;e.data[o+(r>>u1)]|=n}function c1(o,e){let t=d1(o,e);if(t!==-1)return t;let i=e[hi];i.firstCreatePass&&(o.injectorIndex=e.length,Ub(i.data,o),Ub(e,null),Ub(i.blueprint,null));let r=j0(o,e),n=o.injectorIndex;if(l1(r)){let s=lg(r),a=hg(r,e),l=a[hi].data;for(let h=0;h<8;h++)e[n+h]=a[s+h]|l[s+h]}return e[n+8]=r,n}function Ub(o,e){o.push(0,0,0,0,0,0,0,0,e)}function d1(o,e){return o.injectorIndex===-1||o.parent&&o.parent.injectorIndex===o.injectorIndex||e[o.injectorIndex+8]===null?-1:o.injectorIndex}function j0(o,e){if(o.parent&&o.parent.injectorIndex!==-1)return o.parent.injectorIndex;let t=0,i=null,r=e;for(;r!==null;){if(i=m1(r),i===null)return Bu;if(t++,r=r[Yd],i.injectorIndex!==-1)return i.injectorIndex|t<<16}return Bu}function BP(o,e,t){PP(o,e,t)}function p1(o,e,t){if(t&gi.Optional||o!==void 0)return o;L0(e,"NodeInjector")}function f1(o,e,t,i){if(t&gi.Optional&&i===void 0&&(i=null),!(t&(gi.Self|gi.Host))){let r=o[Hu],n=Ja(void 0);try{return r?r.get(e,i,t&gi.Optional):xD(e,i,t&gi.Optional)}finally{Ja(n)}}return p1(i,e,t)}function g1(o,e,t,i=gi.Default,r){if(o!==null){if(e[Pt]&2048&&!(i&gi.Self)){let s=VP(o,e,t,i,to);if(s!==to)return s}let n=v1(o,e,t,i,to);if(n!==to)return n}return f1(e,t,i,r)}function v1(o,e,t,i,r){let n=jP(t);if(typeof n=="function"){if(!KD(e,o,i))return i&gi.Host?p1(r,t,i):f1(e,t,i,r);try{let s;if(s=n(i),s==null&&!(i&gi.Optional))L0(t);else return s}finally{t1()}}else if(typeof n=="number"){let s=null,a=d1(o,e),l=Bu,h=i&gi.Host?e[no][Ls]:null;for((a===-1||i&gi.SkipSelf)&&(l=a===-1?j0(o,e):e[a+8],l===Bu||!tD(i,!1)?a=-1:(s=e[hi],a=lg(l),e=hg(l,e)));a!==-1;){let u=e[hi];if(eD(n,a,u.data)){let c=zP(a,e,t,s,i,h);if(c!==to)return c}l=e[a+8],l!==Bu&&tD(i,e[hi].data[a+8]===h)&&eD(n,a,e)?(s=u,a=lg(l),e=hg(l,e)):a=-1}}return r}function zP(o,e,t,i,r,n){let s=e[hi],a=s.data[o+8],l=i==null?O0(a)&&r0:i!=s&&(a.type&3)!==0,h=r&gi.Host&&n===a,u=ig(a,s,t,l,h);return u!==null?_u(e,s,u,a):to}function ig(o,e,t,i,r){let n=o.providerIndexes,s=e.data,a=n&1048575,l=o.directiveStart,h=o.directiveEnd,u=n>>20,c=i?a:a+u,d=r?a+u:h;for(let p=c;p<d;p++){let f=s[p];if(p<l&&t===f||p>=l&&f.type===t)return p}if(r){let p=s[l];if(p&&wh(p)&&p.type===t)return l}return null}function _u(o,e,t,i){let r=o[t],n=e.data;if(LP(r)){let s=r;s.resolving&&IR(xR(n[t]));let a=JM(s.canSeeViewProviders);s.resolving=!0;let l,h=s.injectImpl?Ja(s.injectImpl):null,u=KD(o,i,gi.Default);try{r=o[t]=s.factory(void 0,n,o,i),e.firstCreatePass&&t>=i.directiveStart&&AP(t,n[t],e)}finally{h!==null&&Ja(h),JM(a),s.resolving=!1,t1()}}return r}function jP(o){if(typeof o=="string")return o.charCodeAt(0)||0;let e=o.hasOwnProperty(Ad)?o[Ad]:void 0;return typeof e=="number"?e>=0?e&h1:HP:e}function eD(o,e,t){let i=1<<o;return!!(t[e+(o>>u1)]&i)}function tD(o,e){return!(o&gi.Self)&&!(o&gi.Host&&e)}var yh=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return g1(this._tNode,this._lView,e,Sg(i),t)}};function HP(){return new yh(La(),rn())}function VP(o,e,t,i,r){let n=o,s=e;for(;n!==null&&s!==null&&s[Pt]&2048&&!(s[Pt]&512);){let a=v1(n,s,t,i|gi.Self,to);if(a!==to)return a;let l=n.parent;if(!l){let h=s[FD];if(h){let u=h.get(t,to,i);if(u!==to)return u}l=m1(s),s=s[Yd]}n=l}return r}function m1(o){let e=o[hi],t=e.type;return t===2?e.declTNode:t===1?o[Ls]:null}function _P(o){return typeof o=="function"}function UP(o,e,t){if(o.length!==e.length)return!1;for(let i=0;i<o.length;i++){let r=o[i],n=e[i];if(t&&(r=t(r),n=t(n)),n!==r)return!1}return!0}function WP(o){return o.flat(Number.POSITIVE_INFINITY)}function H0(o,e){o.forEach(t=>Array.isArray(t)?H0(t,e):e(t))}function y1(o,e,t){e>=o.length?o.push(t):o.splice(e,0,t)}function ug(o,e){return e>=o.length-1?o.pop():o.splice(e,1)[0]}function qP(o,e){let t=[];for(let i=0;i<o;i++)t.push(e);return t}var Vd=new yr(""),b1=new yr("",-1),S1=new yr(""),cg=class{get(e,t=Nd){if(t===Nd){let i=new Error(`NullInjectorError: No provider for ${Ea(e)}!`);throw i.name="NullInjectorError",i}return t}};function C1(o){return{\u0275providers:o}}function GP(...o){return{\u0275providers:w1(!0,o),\u0275fromNgModule:!0}}function w1(o,...e){let t=[],i=new Set,r,n=s=>{t.push(s)};return H0(e,s=>{let a=s;n0(a,n,[],i)&&(r||=[],r.push(a))}),r!==void 0&&x1(r,n),t}function x1(o,e){for(let t=0;t<o.length;t++){let{ngModule:i,providers:r}=o[t];V0(r,n=>{e(n,i)})}}function n0(o,e,t,i){if(o=Ia(o),!o)return!1;let r=null,n=_M(o),s=!n&&ju(o);if(!n&&!s){let l=o.ngModule;if(n=_M(l),n)r=l;else return!1}else{if(s&&!s.standalone)return!1;r=o}let a=i.has(r);if(s){if(a)return!1;if(i.add(r),s.dependencies){let l=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let h of l)n0(h,e,t,i)}}else if(n){if(n.imports!=null&&!a){i.add(r);let h;try{H0(n.imports,u=>{n0(u,e,t,i)&&(h||=[],h.push(u))})}finally{}h!==void 0&&x1(h,e)}if(!a){let h=Bd(r)||(()=>new r);e({provide:r,useFactory:h,deps:Ma},r),e({provide:S1,useValue:r,multi:!0},r),e({provide:Vd,useValue:()=>Xi(r),multi:!0},r)}let l=n.providers;if(l!=null&&!a){let h=o;V0(l,u=>{e(u,h)})}}else return!1;return r!==o&&o.providers!==void 0}function V0(o,e){for(let t of o)SD(t)&&(t=t.\u0275providers),Array.isArray(t)?V0(t,e):e(t)}var YP=dr({provide:String,useValue:dr});function I1(o){return o!==null&&typeof o=="object"&&YP in o}function QP(o){return!!(o&&o.useExisting)}function XP(o){return!!(o&&o.useFactory)}function s0(o){return typeof o=="function"}var xg=new yr(""),rg={},$P={},Wb;function _0(){return Wb===void 0&&(Wb=new cg),Wb}var xl=class{},dg=class extends xl{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,o0(e,s=>this.processProvider(s)),this.records.set(b1,Ru(void 0,this)),r.has("environment")&&this.records.set(xl,Ru(void 0,this));let n=this.records.get(xg);n!=null&&typeof n.value=="string"&&this.scopes.add(n.value),this.injectorDefTypes=new Set(this.get(S1,Ma,gi.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(let t of this._ngOnDestroyHooks)t.ngOnDestroy();let e=this._onDestroyHooks;this._onDestroyHooks=[];for(let t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=Fu(this),i=Ja(void 0),r;try{return e()}finally{Fu(t),Ja(i)}}get(e,t=Nd,i=gi.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(HM))return e[HM](this);i=Sg(i);let r,n=Fu(this),s=Ja(void 0);try{if(!(i&gi.SkipSelf)){let l=this.records.get(e);if(l===void 0){let h=iB(e)&&k0(e);h&&this.injectableDefInScope(h)?l=Ru(a0(e),rg):l=null,this.records.set(e,l)}if(l!=null)return this.hydrate(e,l)}let a=i&gi.Self?_0():this.parent;return t=i&gi.Optional&&t===Nd?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[ag]=a[ag]||[]).unshift(Ea(e)),n)throw a;return BR(a,e,"R3InjectorError",this.source)}else throw a}finally{Ja(s),Fu(n)}}resolveInjectorInitializers(){let e=Fu(this),t=Ja(void 0),i;try{let r=this.get(Vd,Ma,gi.Self);for(let n of r)n()}finally{Fu(e),Ja(t)}}toString(){let e=[],t=this.records;for(let i of t.keys())e.push(Ea(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Hi(205,!1)}processProvider(e){e=Ia(e);let t=s0(e)?e:Ia(e&&e.provide),i=ZP(e);if(!s0(e)&&e.multi===!0){let r=this.records.get(t);r||(r=Ru(void 0,rg,!0),r.factory=()=>Zb(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===rg&&(t.value=$P,t.value=t.factory()),typeof t.value=="object"&&t.value&&tB(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Ia(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function a0(o){let e=k0(o),t=e!==null?e.factory:Bd(o);if(t!==null)return t;if(o instanceof yr)throw new Hi(204,!1);if(o instanceof Function)return KP(o);throw new Hi(204,!1)}function KP(o){if(o.length>0)throw new Hi(204,!1);let t=ER(o);return t!==null?()=>t.factory(o):()=>new o}function ZP(o){if(I1(o))return Ru(void 0,o.useValue);{let e=JP(o);return Ru(e,rg)}}function JP(o,e,t){let i;if(s0(o)){let r=Ia(o);return Bd(r)||a0(r)}else if(I1(o))i=()=>Ia(o.useValue);else if(XP(o))i=()=>o.useFactory(...Zb(o.deps||[]));else if(QP(o))i=()=>Xi(Ia(o.useExisting));else{let r=Ia(o&&(o.useClass||o.provide));if(eB(o))i=()=>new r(...Zb(o.deps));else return Bd(r)||a0(r)}return i}function Ru(o,e,t=!1){return{factory:o,value:e,multi:t?[]:void 0}}function eB(o){return!!o.deps}function tB(o){return o!==null&&typeof o=="object"&&typeof o.ngOnDestroy=="function"}function iB(o){return typeof o=="function"||typeof o=="object"&&o instanceof yr}function o0(o,e){for(let t of o)Array.isArray(t)?o0(t,e):t&&SD(t)?o0(t.\u0275providers,e):e(t)}function iD(o,e=null,t=null,i){let r=rB(o,e,t,i);return r.resolveInjectorInitializers(),r}function rB(o,e=null,t=null,i,r=new Set){let n=[t||Ma,GP(o)];return i=i||(typeof o=="object"?void 0:Ea(o)),new dg(n,e||_0(),i||null,r)}var Xd=(()=>{class o{static{this.THROW_IF_NOT_FOUND=Nd}static{this.NULL=new cg}static create(t,i){if(Array.isArray(t))return iD({name:""},i,t,"");{let r=t.name??"";return iD({name:r},t.parent,t.providers,r)}}static{this.\u0275prov=pn({token:o,providedIn:"any",factory:()=>Xi(b1)})}static{this.__NG_ELEMENT_ID__=-1}}return o})();var l0;function M1(o){l0=o}function nB(){if(l0!==void 0)return l0;if(typeof document<"u")return document;throw new Hi(210,!1)}var U0=new yr("",{providedIn:"root",factory:()=>sB}),sB="ng",W0=new yr(""),Gu=new yr("",{providedIn:"platform",factory:()=>"unknown"});var q0=new yr("",{providedIn:"root",factory:()=>nB().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function D1(o){return(o.flags&128)===128}var Mh=function(o){return o[o.Important=1]="Important",o[o.DashCase=2]="DashCase",o}(Mh||{});var E1=new Map,aB=0;function oB(){return aB++}function lB(o){E1.set(o[Cg],o)}function hB(o){E1.delete(o[Cg])}var rD="__ngContext__";function Uu(o,e){mh(e)?(o[rD]=e[Cg],lB(e)):o[rD]=e}var uB;function G0(o,e){return uB(o,e)}function Pu(o,e,t,i,r){if(i!=null){let n,s=!1;zo(i)?n=i:mh(i)&&(s=!0,i=i[Bo]);let a=Ro(i);o===0&&t!==null?r==null?F1(e,t,a):pg(e,t,a,r||null,!0):o===1&&t!==null?pg(e,t,a,r||null,!0):o===2?IB(e,a,s):o===3&&e.destroyNode(a),n!=null&&DB(e,o,n,t,r)}}function cB(o,e){return o.createText(e)}function A1(o,e,t){return o.createElement(e,t)}function dB(o,e){T1(o,e),e[Bo]=null,e[Ls]=null}function pB(o,e,t,i,r,n){i[Bo]=r,i[Ls]=e,Ig(o,i,t,1,r,n)}function T1(o,e){Ig(o,e,e[vs],2,null,null)}function fB(o){let e=o[Pd];if(!e)return qb(o[hi],o);for(;e;){let t=null;if(mh(e))t=e[Pd];else{let i=e[Ts];i&&(t=i)}if(!t){for(;e&&!e[Aa]&&e!==o;)mh(e)&&qb(e[hi],e),e=e[Ln];e===null&&(e=o),mh(e)&&qb(e[hi],e),t=e&&e[Aa]}e=t}}function gB(o,e,t,i){let r=Ts+i,n=t.length;i>0&&(t[r-1][Aa]=e),i<n-Ts?(e[Aa]=t[r],y1(t,Ts+i,e)):(t.push(e),e[Aa]=null),e[Ln]=t;let s=e[Qd];s!==null&&t!==s&&vB(s,e);let a=e[io];a!==null&&a.insertView(o),t0(e),e[Pt]|=128}function vB(o,e){let t=o[Vu],r=e[Ln][Ln][no];e[no]!==r&&(o[Pt]|=F0.HasTransplantedViews),t===null?o[Vu]=[e]:t.push(e)}function L1(o,e){let t=o[Vu],i=t.indexOf(e);t.splice(i,1)}function h0(o,e){if(o.length<=Ts)return;let t=Ts+e,i=o[t];if(i){let r=i[Qd];r!==null&&r!==o&&L1(r,i),e>0&&(o[t-1][Aa]=i[Aa]);let n=ug(o,Ts+e);dB(i[hi],i);let s=n[io];s!==null&&s.detachView(n[hi]),i[Ln]=null,i[Aa]=null,i[Pt]&=-129}return i}function k1(o,e){if(!(e[Pt]&256)){let t=e[vs];t.destroyNode&&Ig(o,e,t,3,null,null),fB(e)}}function qb(o,e){if(!(e[Pt]&256)){e[Pt]&=-129,e[Pt]|=256,e[Sh]&&xM(e[Sh]),yB(o,e),mB(o,e),e[hi].type===1&&e[vs].destroy();let t=e[Qd];if(t!==null&&zo(e[Ln])){t!==e[Ln]&&L1(t,e);let i=e[io];i!==null&&i.detachView(o)}hB(e)}}function mB(o,e){let t=o.cleanup,i=e[Rd];if(t!==null)for(let n=0;n<t.length-1;n+=2)if(typeof t[n]=="string"){let s=t[n+3];s>=0?i[s]():i[-s].unsubscribe(),n+=2}else{let s=i[t[n+1]];t[n].call(s)}i!==null&&(e[Rd]=null);let r=e[kd];if(r!==null){e[kd]=null;for(let n=0;n<r.length;n++){let s=r[n];s()}}}function yB(o,e){let t;if(o!=null&&(t=o.destroyHooks)!=null)for(let i=0;i<t.length;i+=2){let r=e[t[i]];if(!(r instanceof Hd)){let n=t[i+1];if(Array.isArray(n))for(let s=0;s<n.length;s+=2){let a=r[n[s]],l=n[s+1];eo(4,a,l);try{l.call(a)}finally{eo(5,a,l)}}else{eo(4,r,n);try{n.call(r)}finally{eo(5,r,n)}}}}}function N1(o,e,t){return bB(o,e.parent,t)}function bB(o,e,t){let i=e;for(;i!==null&&i.type&40;)e=i,i=e.parent;if(i===null)return t[Bo];{let{componentOffset:r}=i;if(r>-1){let{encapsulation:n}=o.data[i.directiveStart+r];if(n===ro.None||n===ro.Emulated)return null}return Ta(i,t)}}function pg(o,e,t,i,r){o.insertBefore(e,t,i,r)}function F1(o,e,t){o.appendChild(e,t)}function nD(o,e,t,i,r){i!==null?pg(o,e,t,i,r):F1(o,e,t)}function SB(o,e,t,i){o.removeChild(e,t,i)}function Y0(o,e){return o.parentNode(e)}function CB(o,e){return o.nextSibling(e)}function O1(o,e,t){return xB(o,e,t)}function wB(o,e,t){return o.type&40?Ta(o,t):null}var xB=wB,sD;function R1(o,e,t,i){let r=N1(o,i,e),n=e[vs],s=i.parent||e[Ls],a=O1(s,i,e);if(r!=null)if(Array.isArray(t))for(let l=0;l<t.length;l++)nD(n,r,t[l],a,!1);else nD(n,r,t,a,!1);sD!==void 0&&sD(n,i,e,t,r)}function ng(o,e){if(e!==null){let t=e.type;if(t&3)return Ta(e,o);if(t&4)return u0(-1,o[e.index]);if(t&8){let i=e.child;if(i!==null)return ng(o,i);{let r=o[e.index];return zo(r)?u0(-1,r):Ro(r)}}else{if(t&32)return G0(e,o)()||Ro(o[e.index]);{let i=P1(o,e);if(i!==null){if(Array.isArray(i))return i[0];let r=jd(o[no]);return ng(r,i)}else return ng(o,e.next)}}}return null}function P1(o,e){if(e!==null){let i=o[no][Ls],r=e.projection;return i.projection[r]}return null}function u0(o,e){let t=Ts+o+1;if(t<e.length){let i=e[t],r=i[hi].firstChild;if(r!==null)return ng(i,r)}return e[Ch]}function IB(o,e,t){let i=Y0(o,e);i&&SB(o,i,e,t)}function Q0(o,e,t,i,r,n,s){for(;t!=null;){let a=i[t.index],l=t.type;if(s&&e===0&&(a&&Uu(Ro(a),i),t.flags|=2),(t.flags&32)!==32)if(l&8)Q0(o,e,t.child,i,r,n,!1),Pu(e,o,r,a,n);else if(l&32){let h=G0(t,i),u;for(;u=h();)Pu(e,o,r,u,n);Pu(e,o,r,a,n)}else l&16?B1(o,e,i,t,r,n):Pu(e,o,r,a,n);t=s?t.projectionNext:t.next}}function Ig(o,e,t,i,r,n){Q0(t,i,o.firstChild,e,r,n,!1)}function MB(o,e,t){let i=e[vs],r=N1(o,t,e),n=t.parent||e[Ls],s=O1(n,t,e);B1(i,0,e,t,r,s)}function B1(o,e,t,i,r,n){let s=t[no],l=s[Ls].projection[i.projection];if(Array.isArray(l))for(let h=0;h<l.length;h++){let u=l[h];Pu(e,o,r,u,n)}else{let h=l,u=s[Ln];D1(i)&&(h.flags|=128),Q0(o,e,h,u,r,n,!0)}}function DB(o,e,t,i,r){let n=t[Ch],s=Ro(t);n!==s&&Pu(e,o,i,n,r);for(let a=Ts;a<t.length;a++){let l=t[a];Ig(l[hi],l,o,e,i,n)}}function EB(o,e,t){o.setAttribute(e,"style",t)}function z1(o,e,t){t===""?o.removeAttribute(e,"class"):o.setAttribute(e,"class",t)}function j1(o,e,t){let{mergedAttrs:i,classes:r,styles:n}=t;i!==null&&Jb(o,e,i),r!==null&&z1(o,e,r),n!==null&&EB(o,e,n)}var c0=class{};var AB="h",TB="b";var LB=()=>null;function X0(o,e,t=!1){return LB(o,e,t)}var d0=class{},fg=class{};function kB(o){let e=Error(`No component factory found for ${Ea(o)}.`);return e[NB]=o,e}var NB="ngComponent";var p0=class{resolveComponentFactory(e){throw kB(e)}},$0=(()=>{class o{static{this.NULL=new p0}}return o})();function FB(){return Yu(La(),rn())}function Yu(o,e){return new Il(Ta(o,e))}var Il=(()=>{class o{constructor(t){this.nativeElement=t}static{this.__NG_ELEMENT_ID__=FB}}return o})();function OB(o){return o instanceof Il?o.nativeElement:o}var _d=class{},Mg=(()=>{class o{constructor(){this.destroyNode=null}static{this.__NG_ELEMENT_ID__=()=>RB()}}return o})();function RB(){let o=rn(),e=La(),t=Ih(e.index,o);return(mh(t)?t:o)[vs]}var PB=(()=>{class o{static{this.\u0275prov=pn({token:o,providedIn:"root",factory:()=>null})}}return o})(),Gb={};function gg(o,e,t,i,r=!1){for(;t!==null;){let n=e[t.index];n!==null&&i.push(Ro(n)),zo(n)&&BB(n,i);let s=t.type;if(s&8)gg(o,e,t.child,i);else if(s&32){let a=G0(t,e),l;for(;l=a();)i.push(l)}else if(s&16){let a=P1(e,t);if(Array.isArray(a))i.push(...a);else{let l=jd(e[no]);gg(l[hi],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function BB(o,e){for(let t=Ts;t<o.length;t++){let i=o[t],r=i[hi].firstChild;r!==null&&gg(i[hi],i,r,e)}o[Ch]!==o[Bo]&&e.push(o[Ch])}var H1=[];function zB(o){return o[Sh]??jB(o)}function jB(o){let e=H1.pop()??Object.create(VB);return e.lView=o,e}function HB(o){o.lView[Sh]!==o&&(o.lView=null,H1.push(o))}var VB=fh(Sl({},SM),{consumerIsAlwaysLive:!0,consumerMarkedDirty:o=>{zd(o.lView)},consumerOnSignalRead(){this.lView[Sh]=this}});function V1(o){return U1(o[Pd])}function _1(o){return U1(o[Aa])}function U1(o){for(;o!==null&&!zo(o);)o=o[Aa];return o}var _B="ngOriginalError";function Yb(o){return o[_B]}var Po=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Yb(e);for(;t&&Yb(t);)t=Yb(t);return t||null}},W1=new yr("",{providedIn:"root",factory:()=>Tn(Po).handleError.bind(void 0)});var q1=!1,UB=new yr("",{providedIn:"root",factory:()=>q1});var G1={};function jo(o=1){Y1(so(),rn(),i1()+o,!1)}function Y1(o,e,t,i){if(!i)if((e[Pt]&3)===3){let n=o.preOrderCheckHooks;n!==null&&eg(e,n,t)}else{let n=o.preOrderHooks;n!==null&&tg(e,n,0,t)}xh(t)}function qn(o,e=gi.Default){let t=rn();if(t===null)return Xi(o,e);let i=La();return g1(i,t,Ia(o),e)}function Q1(o,e,t,i,r,n){let s=As(null);try{let a=null;r&bh.SignalBased&&(a=e[i][bM]),a!==null&&a.transformFn!==void 0&&(n=a.transformFn(n)),r&bh.HasDecoratorInputTransform&&(n=o.inputTransforms[i].call(e,n)),o.setInput!==null?o.setInput(e,a,n,t,i):BD(e,a,i,n)}finally{As(s)}}function WB(o,e){let t=o.hostBindingOpCodes;if(t!==null)try{for(let i=0;i<t.length;i++){let r=t[i];if(r<0)xh(~r);else{let n=r,s=t[++i],a=t[++i];xP(s,n);let l=e[n];a(2,l)}}}finally{xh(-1)}}function Dg(o,e,t,i,r,n,s,a,l,h,u){let c=e.blueprint.slice();return c[Bo]=r,c[Pt]=i|4|128|8|64,(h!==null||o&&o[Pt]&2048)&&(c[Pt]|=2048),UD(c),c[Ln]=c[Yd]=o,c[Oo]=t,c[Cl]=s||o&&o[Cl],c[vs]=a||o&&o[vs],c[Hu]=l||o&&o[Hu]||null,c[Ls]=n,c[Cg]=oB(),c[Od]=u,c[FD]=h,c[no]=e.type==2?o[no]:c,c}function Eg(o,e,t,i,r){let n=o.data[e];if(n===null)n=qB(o,e,t,i,r),wP()&&(n.flags|=32);else if(n.type&64){n.type=t,n.value=i,n.attrs=r;let s=bP();n.injectorIndex=s===null?-1:s.injectorIndex}return wg(n,!0),n}function qB(o,e,t,i,r){let n=YD(),s=QD(),a=s?n:n&&n.parent,l=o.data[e]=JB(o,a,t,e,i,r);return o.firstChild===null&&(o.firstChild=l),n!==null&&(s?n.child==null&&l.parent!==null&&(n.child=l):n.next===null&&(n.next=l,l.prev=n)),l}function X1(o,e,t,i){if(t===0)return-1;let r=e.length;for(let n=0;n<t;n++)e.push(i),o.blueprint.push(i),o.data.push(null);return r}function $1(o,e,t,i,r){let n=i1(),s=i&2;try{xh(-1),s&&e.length>wl&&Y1(o,e,wl,!1),eo(s?2:0,r),t(i,r)}finally{xh(n),eo(s?3:1,r)}}function K1(o,e,t){if(RD(e)){let i=As(null);try{let r=e.directiveStart,n=e.directiveEnd;for(let s=r;s<n;s++){let a=o.data[s];a.contentQueries&&a.contentQueries(1,t[s],s)}}finally{As(i)}}}function GB(o,e,t){qD()&&(oz(o,e,t,Ta(t,e)),(t.flags&64)===64&&tE(o,e,t))}function YB(o,e,t=Ta){let i=e.localNames;if(i!==null){let r=e.index+1;for(let n=0;n<i.length;n+=2){let s=i[n+1],a=s===-1?t(e,o):o[s];o[r++]=a}}}function Z1(o){let e=o.tView;return e===null||e.incompleteFirstPass?o.tView=J1(1,null,o.template,o.decls,o.vars,o.directiveDefs,o.pipeDefs,o.viewQuery,o.schemas,o.consts,o.id):e}function J1(o,e,t,i,r,n,s,a,l,h,u){let c=wl+i,d=c+r,p=QB(c,d),f=typeof h=="function"?h():h;return p[hi]={type:o,blueprint:p,template:t,queries:null,viewQuery:a,declTNode:e,data:p.slice().fill(null,c),bindingStartIndex:c,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof n=="function"?n():n,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1,ssrId:u}}function QB(o,e){let t=[];for(let i=0;i<e;i++)t.push(i<o?null:G1);return t}function XB(o,e,t,i){let n=i.get(UB,q1)||t===ro.ShadowDom,s=o.selectRootElement(e,n);return $B(s),s}function $B(o){KB(o)}var KB=()=>null;function ZB(o,e,t,i){let r=rE(e);r.push(t),o.firstCreatePass&&nE(o).push(i,r.length-1)}function JB(o,e,t,i,r,n){let s=e?e.injectorIndex:-1,a=0;return GD()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:n,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function aD(o,e,t,i,r){for(let n in e){if(!e.hasOwnProperty(n))continue;let s=e[n];if(s===void 0)continue;i??={};let a,l=bh.None;Array.isArray(s)?(a=s[0],l=s[1]):a=s;let h=n;if(r!==null){if(!r.hasOwnProperty(n))continue;h=r[n]}o===0?oD(i,t,h,a,l):oD(i,t,h,a)}return i}function oD(o,e,t,i,r){let n;o.hasOwnProperty(t)?(n=o[t]).push(e,i):n=o[t]=[e,i],r!==void 0&&n.push(r)}function ez(o,e,t){let i=e.directiveStart,r=e.directiveEnd,n=o.data,s=e.attrs,a=[],l=null,h=null;for(let u=i;u<r;u++){let c=n[u],d=t?t.get(c):null,p=d?d.inputs:null,f=d?d.outputs:null;l=aD(0,c.inputs,u,l,p),h=aD(1,c.outputs,u,h,f);let v=l!==null&&s!==null&&!ED(e)?vz(l,u,s):null;a.push(v)}l!==null&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=h}function tz(o){return o==="class"?"className":o==="for"?"htmlFor":o==="formaction"?"formAction":o==="innerHtml"?"innerHTML":o==="readonly"?"readOnly":o==="tabindex"?"tabIndex":o}function iz(o,e,t,i,r,n,s,a){let l=Ta(e,t),h=e.inputs,u;!a&&h!=null&&(u=h[i])?(Z0(o,t,u,i,r),O0(e)&&rz(t,e.index)):e.type&3?(i=tz(i),r=s!=null?s(r,e.value||"",i):r,n.setProperty(l,i,r)):e.type&12}function rz(o,e){let t=Ih(e,o);t[Pt]&16||(t[Pt]|=64)}function nz(o,e,t,i){if(qD()){let r=i===null?null:{"":-1},n=hz(o,t),s,a;n===null?s=a=null:[s,a]=n,s!==null&&eE(o,e,t,s,r,a),r&&uz(t,i,r)}t.mergedAttrs=Fd(t.mergedAttrs,t.attrs)}function eE(o,e,t,i,r,n){for(let h=0;h<i.length;h++)BP(c1(t,e),o,i[h].type);dz(t,o.data.length,i.length);for(let h=0;h<i.length;h++){let u=i[h];u.providersResolver&&u.providersResolver(u)}let s=!1,a=!1,l=X1(o,e,i.length,null);for(let h=0;h<i.length;h++){let u=i[h];t.mergedAttrs=Fd(t.mergedAttrs,u.hostAttrs),pz(o,t,e,l,u),cz(l,u,r),u.contentQueries!==null&&(t.flags|=4),(u.hostBindings!==null||u.hostAttrs!==null||u.hostVars!==0)&&(t.flags|=64);let c=u.type.prototype;!s&&(c.ngOnChanges||c.ngOnInit||c.ngDoCheck)&&((o.preOrderHooks??=[]).push(t.index),s=!0),!a&&(c.ngOnChanges||c.ngDoCheck)&&((o.preOrderCheckHooks??=[]).push(t.index),a=!0),l++}ez(o,t,n)}function sz(o,e,t,i,r){let n=r.hostBindings;if(n){let s=o.hostBindingOpCodes;s===null&&(s=o.hostBindingOpCodes=[]);let a=~e.index;az(s)!=a&&s.push(a),s.push(t,i,n)}}function az(o){let e=o.length;for(;e>0;){let t=o[--e];if(typeof t=="number"&&t<0)return t}return 0}function oz(o,e,t,i){let r=t.directiveStart,n=t.directiveEnd;O0(t)&&fz(e,t,o.data[r+t.componentOffset]),o.firstCreatePass||c1(t,e),Uu(i,e);let s=t.initialInputs;for(let a=r;a<n;a++){let l=o.data[a],h=_u(e,o,a,t);if(Uu(h,e),s!==null&&gz(e,a-r,h,l,t,s),wh(l)){let u=Ih(t.index,e);u[Oo]=_u(e,o,a,t)}}}function tE(o,e,t){let i=t.directiveStart,r=t.directiveEnd,n=t.index,s=IP();try{xh(n);for(let a=i;a<r;a++){let l=o.data[a],h=e[a];i0(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&lz(l,h)}}finally{xh(-1),i0(s)}}function lz(o,e){o.hostBindings!==null&&o.hostBindings(1,e)}function hz(o,e){let t=o.directiveRegistry,i=null,r=null;if(t)for(let n=0;n<t.length;n++){let s=t[n];if(AD(e,s.selectors,!1))if(i||(i=[]),wh(s))if(s.findHostDirectiveDefs!==null){let a=[];r=r||new Map,s.findHostDirectiveDefs(s,a,r),i.unshift(...a,s);let l=a.length;f0(o,e,l)}else i.unshift(s),f0(o,e,0);else r=r||new Map,s.findHostDirectiveDefs?.(s,i,r),i.push(s)}return i===null?null:[i,r]}function f0(o,e,t){e.componentOffset=t,(o.components??=[]).push(e.index)}function uz(o,e,t){if(e){let i=o.localNames=[];for(let r=0;r<e.length;r+=2){let n=t[e[r+1]];if(n==null)throw new Hi(-301,!1);i.push(e[r],n)}}}function cz(o,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=o;wh(e)&&(t[""]=o)}}function dz(o,e,t){o.flags|=1,o.directiveStart=e,o.directiveEnd=e+t,o.providerIndexes=e}function pz(o,e,t,i,r){o.data[i]=r;let n=r.factory||(r.factory=Bd(r.type,!0)),s=new Hd(n,wh(r),qn);o.blueprint[i]=s,t[i]=s,sz(o,e,i,X1(o,t,r.hostVars,G1),r)}function fz(o,e,t){let i=Ta(e,o),r=Z1(t),n=o[Cl].rendererFactory,s=16;t.signals?s=4096:t.onPush&&(s=64);let a=K0(o,Dg(o,r,null,s,i,e,null,n.createRenderer(i,t),null,null,null));o[e.index]=a}function gz(o,e,t,i,r,n){let s=n[e];if(s!==null)for(let a=0;a<s.length;){let l=s[a++],h=s[a++],u=s[a++],c=s[a++];Q1(i,t,l,h,u,c)}}function vz(o,e,t){let i=null,r=0;for(;r<t.length;){let n=t[r];if(n===0){r+=4;continue}else if(n===5){r+=2;continue}if(typeof n=="number")break;if(o.hasOwnProperty(n)){i===null&&(i=[]);let s=o[n];for(let a=0;a<s.length;a+=3)if(s[a]===e){i.push(n,s[a+1],s[a+2],t[r+1]);break}}r+=2}return i}function mz(o,e,t,i){return[o,!0,0,e,null,i,null,t,null,null]}function iE(o,e){let t=o.contentQueries;if(t!==null){let i=As(null);try{for(let r=0;r<t.length;r+=2){let n=t[r],s=t[r+1];if(s!==-1){let a=o.data[s];P0(n),a.contentQueries(2,e[s],s)}}}finally{As(i)}}}function K0(o,e){return o[Pd]?o[XM][Aa]=e:o[Pd]=e,o[XM]=e,e}function g0(o,e,t){P0(0);let i=As(null);try{e(o,t)}finally{As(i)}}function rE(o){return o[Rd]||(o[Rd]=[])}function nE(o){return o.cleanup||(o.cleanup=[])}function sE(o,e){let t=o[Hu],i=t?t.get(Po,null):null;i&&i.handleError(e)}function Z0(o,e,t,i,r){for(let n=0;n<t.length;){let s=t[n++],a=t[n++],l=t[n++],h=e[s],u=o.data[s];Q1(u,h,i,a,l,r)}}var yz=100;function bz(o,e=!0){let t=o[Cl],i=t.rendererFactory,r=!1;r||i.begin?.();try{Sz(o)}catch(n){throw e&&sE(o,n),n}finally{r||(i.end?.(),t.inlineEffectRunner?.flush())}}function Sz(o){v0(o,0);let e=0;for(;WD(o);){if(e===yz)throw new Hi(103,!1);e++,v0(o,1)}}function Cz(o,e,t,i){let r=e[Pt];if((r&256)===256)return;let n=!1;!n&&e[Cl].inlineEffectRunner?.flush(),B0(e);let s=null,a=null;!n&&wz(o)&&(a=zB(e),s=CM(a));try{UD(e),SP(o.bindingStartIndex),t!==null&&$1(o,e,t,2,i);let l=(r&3)===3;if(!n)if(l){let c=o.preOrderCheckHooks;c!==null&&eg(e,c,null)}else{let c=o.preOrderHooks;c!==null&&tg(e,c,0,null),_b(e,0)}if(xz(e),aE(e,0),o.contentQueries!==null&&iE(o,e),!n)if(l){let c=o.contentCheckHooks;c!==null&&eg(e,c)}else{let c=o.contentHooks;c!==null&&tg(e,c,1),_b(e,1)}WB(o,e);let h=o.components;h!==null&&lE(e,h,0);let u=o.viewQuery;if(u!==null&&g0(2,u,i),!n)if(l){let c=o.viewCheckHooks;c!==null&&eg(e,c)}else{let c=o.viewHooks;c!==null&&tg(e,c,2),_b(e,2)}if(o.firstUpdatePass===!0&&(o.firstUpdatePass=!1),e[Vb]){for(let c of e[Vb])c();e[Vb]=null}n||(e[Pt]&=-73)}catch(l){throw zd(e),l}finally{a!==null&&(wM(a,s),HB(a)),z0()}}function wz(o){return o.type!==2}function aE(o,e){for(let t=V1(o);t!==null;t=_1(t))for(let i=Ts;i<t.length;i++){let r=t[i];oE(r,e)}}function xz(o){for(let e=V1(o);e!==null;e=_1(e)){if(!(e[Pt]&F0.HasTransplantedViews))continue;let t=e[Vu];for(let i=0;i<t.length;i++){let r=t[i],n=r[Ln];dP(r)}}}function Iz(o,e,t){let i=Ih(e,o);oE(i,t)}function oE(o,e){R0(o)&&v0(o,e)}function v0(o,e){let i=o[hi],r=o[Pt],n=o[Sh],s=!!(e===0&&r&16);if(s||=!!(r&64&&e===0),s||=!!(r&1024),s||=!!(n?.dirty&&Tb(n)),n&&(n.dirty=!1),o[Pt]&=-9217,s)Cz(i,o,i.template,o[Oo]);else if(r&8192){aE(o,1);let a=i.components;a!==null&&lE(o,a,1)}}function lE(o,e,t){for(let i=0;i<e.length;i++)Iz(o,e[i],t)}function J0(o){for(o[Cl].changeDetectionScheduler?.notify();o;){o[Pt]|=64;let e=jd(o);if(iP(o)&&!e)return o;o=e}return null}var Ud=class{get rootNodes(){let e=this._lView,t=e[hi];return gg(t,e,t.firstChild,[])}constructor(e,t,i=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=i,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Oo]}set context(e){this._lView[Oo]=e}get destroyed(){return(this._lView[Pt]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Ln];if(zo(e)){let t=e[og],i=t?t.indexOf(this):-1;i>-1&&(h0(e,i),ug(t,i))}this._attachedToViewContainer=!1}k1(this._lView[hi],this._lView)}onDestroy(e){pP(this._lView,e)}markForCheck(){J0(this._cdRefInjectingView||this._lView)}detach(){this._lView[Pt]&=-129}reattach(){t0(this._lView),this._lView[Pt]|=128}detectChanges(){this._lView[Pt]|=1024,bz(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Hi(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,T1(this._lView[hi],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Hi(902,!1);this._appRef=e,t0(this._lView)}};var lD=new Set;function hE(o){lD.has(o)||(lD.add(o),performance?.mark?.("mark_feature_usage",{detail:{feature:o}}))}var m0=class extends Nu{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let r=e,n=t||(()=>null),s=i;if(e&&typeof e=="object"){let l=e;r=l.next?.bind(l),n=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(n=Qb(n),r&&(r=Qb(r)),s&&(s=Qb(s)));let a=super.subscribe({next:r,error:n,complete:s});return e instanceof gs&&e.add(a),a}};function Qb(o){return e=>{setTimeout(o,void 0,e)}}var Da=m0;function hD(...o){}function Mz(){let o=typeof Td.requestAnimationFrame=="function",e=Td[o?"requestAnimationFrame":"setTimeout"],t=Td[o?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){let i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);let r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}var Wn=class o{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Da(!1),this.onMicrotaskEmpty=new Da(!1),this.onStable=new Da(!1),this.onError=new Da(!1),typeof Zone>"u")throw new Hi(908,!1);Zone.assertZonePatched();let r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=Mz().nativeRequestAnimationFrame,Az(r)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!o.isInAngularZone())throw new Hi(909,!1)}static assertNotInAngularZone(){if(o.isInAngularZone())throw new Hi(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){let n=this._inner,s=n.scheduleEventTask("NgZoneEvent: "+r,e,Dz,hD,hD);try{return n.runTask(s,t,i)}finally{n.cancelTask(s)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}},Dz={};function eS(o){if(o._nesting==0&&!o.hasPendingMicrotasks&&!o.isStable)try{o._nesting++,o.onMicrotaskEmpty.emit(null)}finally{if(o._nesting--,!o.hasPendingMicrotasks)try{o.runOutsideAngular(()=>o.onStable.emit(null))}finally{o.isStable=!0}}}function Ez(o){o.isCheckStableRunning||o.lastRequestAnimationFrameId!==-1||(o.lastRequestAnimationFrameId=o.nativeRequestAnimationFrame.call(Td,()=>{o.fakeTopEventTask||(o.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{o.lastRequestAnimationFrameId=-1,y0(o),o.isCheckStableRunning=!0,eS(o),o.isCheckStableRunning=!1},void 0,()=>{},()=>{})),o.fakeTopEventTask.invoke()}),y0(o))}function Az(o){let e=()=>{Ez(o)};o._inner=o._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,n,s,a)=>{if(Tz(a))return t.invokeTask(r,n,s,a);try{return uD(o),t.invokeTask(r,n,s,a)}finally{(o.shouldCoalesceEventChangeDetection&&n.type==="eventTask"||o.shouldCoalesceRunChangeDetection)&&e(),cD(o)}},onInvoke:(t,i,r,n,s,a,l)=>{try{return uD(o),t.invoke(r,n,s,a,l)}finally{o.shouldCoalesceRunChangeDetection&&e(),cD(o)}},onHasTask:(t,i,r,n)=>{t.hasTask(r,n),i===r&&(n.change=="microTask"?(o._hasPendingMicrotasks=n.microTask,y0(o),eS(o)):n.change=="macroTask"&&(o.hasPendingMacrotasks=n.macroTask))},onHandleError:(t,i,r,n)=>(t.handleError(r,n),o.runOutsideAngular(()=>o.onError.emit(n)),!1)})}function y0(o){o._hasPendingMicrotasks||(o.shouldCoalesceEventChangeDetection||o.shouldCoalesceRunChangeDetection)&&o.lastRequestAnimationFrameId!==-1?o.hasPendingMicrotasks=!0:o.hasPendingMicrotasks=!1}function uD(o){o._nesting++,o.isStable&&(o.isStable=!1,o.onUnstable.emit(null))}function cD(o){o._nesting--,eS(o)}function Tz(o){return!Array.isArray(o)||o.length!==1?!1:o[0].data?.__ignore_ng_zone__===!0}var uE=(()=>{class o{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){let t=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let r of t)r();return!!this.handler?.execute()||t.length>0}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static{this.\u0275prov=pn({token:o,providedIn:"root",factory:()=>new o})}}return o})();function Lz(o,e){let t=Ih(e,o),i=t[hi];kz(i,t);let r=t[Bo];r!==null&&t[Od]===null&&(t[Od]=X0(r,t[Hu])),tS(i,t,t[Oo])}function kz(o,e){for(let t=e.length;t<o.blueprint.length;t++)e.push(o.blueprint[t])}function tS(o,e,t){B0(e);try{let i=o.viewQuery;i!==null&&g0(1,i,t);let r=o.template;r!==null&&$1(o,e,r,1,t),o.firstCreatePass&&(o.firstCreatePass=!1),o.staticContentQueries&&iE(o,e),o.staticViewQueries&&g0(2,o.viewQuery,t);let n=o.components;n!==null&&Nz(e,n)}catch(i){throw o.firstCreatePass&&(o.incompleteFirstPass=!0,o.firstCreatePass=!1),i}finally{e[Pt]&=-5,z0()}}function Nz(o,e){for(let t=0;t<e.length;t++)Lz(o,e[t])}function b0(o,e,t){let i=t?o.styles:null,r=t?o.classes:null,n=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")n=a;else if(n==1)r=zM(r,a);else if(n==2){let l=a,h=e[++s];i=zM(i,l+": "+h+";")}}t?o.styles=i:o.stylesWithoutHost=i,t?o.classes=r:o.classesWithoutHost=r}var S0=class extends $0{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=ju(e);return new vg(t,this.ngModule)}};function dD(o){let e=[];for(let t in o){if(!o.hasOwnProperty(t))continue;let i=o[t];i!==void 0&&e.push({propName:Array.isArray(i)?i[0]:i,templateName:t})}return e}function Fz(o){let e=o.toLowerCase();return e==="svg"?aP:e==="math"?oP:null}var C0=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=Sg(i);let r=this.injector.get(e,Gb,i);return r!==Gb||t===Gb?r:this.parentInjector.get(e,t,i)}},vg=class extends fg{get inputs(){let e=this.componentDef,t=e.inputTransforms,i=dD(e.inputs);if(t!==null)for(let r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return dD(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=$R(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){r=r||this.ngModule;let n=r instanceof xl?r:r?.injector;n&&this.componentDef.getStandaloneInjector!==null&&(n=this.componentDef.getStandaloneInjector(n)||n);let s=n?new C0(e,n):e,a=s.get(_d,null);if(a===null)throw new Hi(407,!1);let l=s.get(PB,null),h=s.get(uE,null),u=s.get(c0,null),c={rendererFactory:a,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:h,changeDetectionScheduler:u},d=a.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",f=i?XB(d,i,this.componentDef.encapsulation,s):A1(d,p,Fz(p)),v=512;this.componentDef.signals?v|=4096:this.componentDef.onPush||(v|=16);let m=null;f!==null&&(m=X0(f,s,!0));let y=J1(0,null,null,1,0,null,null,null,null,null,null),S=Dg(null,y,null,v,null,null,c,d,s,null,m);B0(S);let b,w;try{let I=this.componentDef,x,M=null;I.findHostDirectiveDefs?(x=[],M=new Map,I.findHostDirectiveDefs(I,x,M),x.push(I)):x=[I];let D=Oz(S,f),A=Rz(D,f,I,x,S,c,d);w=_D(y,wl),f&&zz(d,I,f,i),t!==void 0&&jz(w,this.ngContentSelectors,t),b=Bz(A,I,x,M,S,[Hz]),tS(y,S,null)}finally{z0()}return new w0(this.componentType,b,Yu(w,S),S,w)}},w0=class extends d0{constructor(e,t,i,r,n){super(),this.location=i,this._rootLView=r,this._tNode=n,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new Ud(r,void 0,!1),this.componentType=e}setInput(e,t){let i=this._tNode.inputs,r;if(i!==null&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let n=this._rootLView;Z0(n[hi],n,r,e,t),this.previousInputValues.set(e,t);let s=Ih(this._tNode.index,n);J0(s)}}get injector(){return new yh(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function Oz(o,e){let t=o[hi],i=wl;return o[i]=e,Eg(t,i,2,"#host",null)}function Rz(o,e,t,i,r,n,s){let a=r[hi];Pz(i,o,e,s);let l=null;e!==null&&(l=X0(e,r[Hu]));let h=n.rendererFactory.createRenderer(e,t),u=16;t.signals?u=4096:t.onPush&&(u=64);let c=Dg(r,Z1(t),null,u,r[o.index],o,n,h,null,null,l);return a.firstCreatePass&&f0(a,o,i.length-1),K0(r,c),r[o.index]=c}function Pz(o,e,t,i){for(let r of o)e.mergedAttrs=Fd(e.mergedAttrs,r.hostAttrs);e.mergedAttrs!==null&&(b0(e,e.mergedAttrs,!0),t!==null&&j1(i,t,e))}function Bz(o,e,t,i,r,n){let s=La(),a=r[hi],l=Ta(s,r);eE(a,r,s,t,null,i);for(let u=0;u<t.length;u++){let c=s.directiveStart+u,d=_u(r,a,c,s);Uu(d,r)}tE(a,r,s),l&&Uu(l,r);let h=_u(r,a,s.directiveStart+s.componentOffset,s);if(o[Oo]=r[Oo]=h,n!==null)for(let u of n)u(h,e);return K1(a,s,o),h}function zz(o,e,t,i){if(i)Jb(o,t,["ng-version","17.1.2"]);else{let{attrs:r,classes:n}=KR(e.selectors[0]);r&&Jb(o,t,r),n&&n.length>0&&z1(o,t,n.join(" "))}}function jz(o,e,t){let i=o.projection=[];for(let r=0;r<e.length;r++){let n=t[r];i.push(n!=null?Array.from(n):null)}}function Hz(){let o=La();a1(rn()[hi],o)}function Vz(o){return Object.getPrototypeOf(o.prototype).constructor}function Wr(o){let e=Vz(o.type),t=!0,i=[o];for(;e;){let r;if(wh(o))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Hi(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);let s=o;s.inputs=Jf(o.inputs),s.inputTransforms=Jf(o.inputTransforms),s.declaredInputs=Jf(o.declaredInputs),s.outputs=Jf(o.outputs);let a=r.hostBindings;a&&Gz(o,a);let l=r.viewQuery,h=r.contentQueries;if(l&&Wz(o,l),h&&qz(o,h),_z(o,r),vR(o.outputs,r.outputs),wh(r)&&r.data.animation){let u=o.data;u.animation=(u.animation||[]).concat(r.data.animation)}}let n=r.features;if(n)for(let s=0;s<n.length;s++){let a=n[s];a&&a.ngInherit&&a(o),a===Wr&&(t=!1)}}e=Object.getPrototypeOf(e)}Uz(i)}function _z(o,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||o.inputs.hasOwnProperty(t))continue;let i=e.inputs[t];if(i!==void 0&&(o.inputs[t]=i,o.declaredInputs[t]=e.declaredInputs[t],e.inputTransforms!==null)){let r=Array.isArray(i)?i[0]:i;if(!e.inputTransforms.hasOwnProperty(r))continue;o.inputTransforms??={},o.inputTransforms[r]=e.inputTransforms[r]}}}function Uz(o){let e=0,t=null;for(let i=o.length-1;i>=0;i--){let r=o[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Fd(r.hostAttrs,t=Fd(t,r.hostAttrs))}}function Jf(o){return o===zu?{}:o===Ma?[]:o}function Wz(o,e){let t=o.viewQuery;t?o.viewQuery=(i,r)=>{e(i,r),t(i,r)}:o.viewQuery=e}function qz(o,e){let t=o.contentQueries;t?o.contentQueries=(i,r,n)=>{e(i,r,n),t(i,r,n)}:o.contentQueries=e}function Gz(o,e){let t=o.hostBindings;t?o.hostBindings=(i,r)=>{e(i,r),t(i,r)}:o.hostBindings=e}var o7=new RegExp(`^(\\d+)*(${TB}|${AB})*(.*)`);var Yz=()=>null;function pD(o,e){return Yz(o,e)}function Qz(o,e,t,i){let r=e.tView,s=o[Pt]&4096?4096:16,a=Dg(o,r,t,s,null,e,null,null,null,i?.injector??null,i?.dehydratedView??null),l=o[e.index];a[Qd]=l;let h=o[io];return h!==null&&(a[io]=h.createEmbeddedView(r)),tS(r,a,t),a}function fD(o,e){return!e||e.firstChild===null||D1(o)}function Xz(o,e,t,i=!0){let r=e[hi];if(gB(r,e,o,t),i){let s=u0(t,o),a=e[vs],l=Y0(a,o[Ch]);l!==null&&pB(r,o[Ls],a,e,l,s)}let n=e[Od];n!==null&&n.firstChild!==null&&(n.firstChild=null)}var es=(()=>{class o{static{this.__NG_ELEMENT_ID__=$z}}return o})();function $z(){let o=La();return dE(o,rn())}var Kz=es,cE=class extends Kz{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Yu(this._hostTNode,this._hostLView)}get injector(){return new yh(this._hostTNode,this._hostLView)}get parentInjector(){let e=j0(this._hostTNode,this._hostLView);if(l1(e)){let t=hg(e,this._hostLView),i=lg(e),r=t[hi].data[i+8];return new yh(r,t)}else return new yh(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=gD(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Ts}createEmbeddedView(e,t,i){let r,n;typeof i=="number"?r=i:i!=null&&(r=i.index,n=i.injector);let s=pD(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},n,s);return this.insertImpl(a,r,fD(this._hostTNode,s)),a}createComponent(e,t,i,r,n){let s=e&&!_P(e),a;if(s)a=t;else{let f=t||{};a=f.index,i=f.injector,r=f.projectableNodes,n=f.environmentInjector||f.ngModuleRef}let l=s?e:new vg(ju(e)),h=i||this.parentInjector;if(!n&&l.ngModule==null){let v=(s?h:this.parentInjector).get(xl,null);v&&(n=v)}let u=ju(l.componentType??{}),c=pD(this._lContainer,u?.id??null),d=c?.firstChild??null,p=l.create(h,r,d,n);return this.insertImpl(p.hostView,a,fD(this._hostTNode,c)),p}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){let r=e._lView;if(cP(r)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let l=r[Ln],h=new cE(l,l[Ls],l[Ln]);h.detach(h.indexOf(e))}}let n=this._adjustIndex(t),s=this._lContainer;return Xz(s,r,n,i),e.attachToViewContainerRef(),y1(Xb(s),n,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=gD(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),i=h0(this._lContainer,t);i&&(ug(Xb(this._lContainer),t),k1(i[hi],i))}detach(e){let t=this._adjustIndex(e,-1),i=h0(this._lContainer,t);return i&&ug(Xb(this._lContainer),t)!=null?new Ud(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function gD(o){return o[og]}function Xb(o){return o[og]||(o[og]=[])}function dE(o,e){let t,i=e[o.index];return zo(i)?t=i:(t=mz(i,e,null,o),e[o.index]=t,K0(e,t)),Jz(t,e,o,i),new cE(t,o,e)}function Zz(o,e){let t=o[vs],i=t.createComment(""),r=Ta(e,o),n=Y0(t,r);return pg(t,n,i,CB(t,r),!1),i}var Jz=e2;function e2(o,e,t,i){if(o[Ch])return;let r;t.type&8?r=Ro(i):r=Zz(e,t),o[Ch]=r}function t2(o,e,t){let i=o[e];return Object.is(i,t)?!1:(o[e]=t,!0)}function ao(o,e,t){let i=rn(),r=CP();if(t2(i,r,e)){let n=so(),s=DP();iz(n,s,i,o,e,i[vs],t,!1)}return ao}function vD(o,e,t,i,r){let n=e.inputs,s=r?"class":"style";Z0(o,t,n[s],s,i)}function i2(o,e,t,i,r,n){let s=e.consts,a=KM(s,r),l=Eg(e,o,2,i,a);return nz(e,t,l,KM(s,n)),l.attrs!==null&&b0(l,l.attrs,!1),l.mergedAttrs!==null&&b0(l,l.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,l),l}function mi(o,e,t,i){let r=rn(),n=so(),s=wl+o,a=r[vs],l=n.firstCreatePass?i2(s,n,r,e,t,i):n.data[s],h=r2(n,r,l,a,e,o);r[s]=h;let u=PD(l);return wg(l,!0),j1(a,h,l),(l.flags&32)!==32&&n1()&&R1(n,r,h,l),fP()===0&&Uu(h,r),gP(),u&&(GB(n,r,l),K1(n,l,r)),i!==null&&YB(r,l),mi}function $t(){let o=La();QD()?XD():(o=o.parent,wg(o,!1));let e=o;mP(e)&&yP(),vP();let t=so();return t.firstCreatePass&&(a1(t,o),RD(o)&&t.queries.elementEnd(o)),e.classesWithoutHost!=null&&kP(e)&&vD(t,e,rn(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&NP(e)&&vD(t,e,rn(),e.stylesWithoutHost,!1),$t}function $d(o,e,t,i){return mi(o,e,t,i),$t(),$d}var r2=(o,e,t,i,r,n)=>(s1(!0),A1(i,r,EP()));var mg="en-US";var n2=mg;function s2(o){MR(o,"Expected localeId to be defined"),typeof o=="string"&&(n2=o.toLowerCase().replace(/_/g,"-"))}function iS(o){return!!o&&typeof o.then=="function"}function pE(o){return!!o&&typeof o.subscribe=="function"}function rS(o,e,t,i){let r=rn(),n=so(),s=La();return o2(n,r,r[vs],s,o,e,i),rS}function a2(o,e,t,i){let r=o.cleanup;if(r!=null)for(let n=0;n<r.length-1;n+=2){let s=r[n];if(s===t&&r[n+1]===i){let a=e[Rd],l=r[n+2];return a.length>l?a[l]:null}typeof s=="string"&&(n+=2)}return null}function o2(o,e,t,i,r,n,s){let a=PD(i),h=o.firstCreatePass&&nE(o),u=e[Oo],c=rE(e),d=!0;if(i.type&3||s){let v=Ta(i,e),m=s?s(v):v,y=c.length,S=s?w=>s(Ro(w[i.index])):i.index,b=null;if(!s&&a&&(b=a2(o,e,r,i.index)),b!==null){let w=b.__ngLastListenerFn__||b;w.__ngNextListenerFn__=n,b.__ngLastListenerFn__=n,d=!1}else{n=yD(i,e,u,n,!1);let w=t.listen(m,r,n);c.push(n,w),h&&h.push(r,S,y,y+1)}}else n=yD(i,e,u,n,!1);let p=i.outputs,f;if(d&&p!==null&&(f=p[r])){let v=f.length;if(v)for(let m=0;m<v;m+=2){let y=f[m],S=f[m+1],I=e[y][S].subscribe(n),x=c.length;c.push(n,I),h&&h.push(r,i.index,x,-(x+1))}}}function mD(o,e,t,i){try{return eo(6,e,t),t(i)!==!1}catch(r){return sE(o,r),!1}finally{eo(7,e,t)}}function yD(o,e,t,i,r){return function n(s){if(s===Function)return i;let a=o.componentOffset>-1?Ih(o.index,e):e;J0(a);let l=mD(e,t,i,s),h=n.__ngNextListenerFn__;for(;h;)l=mD(e,t,h,s)&&l,h=h.__ngNextListenerFn__;return r&&l===!1&&s.preventDefault(),l}}function l2(o,e){let t=null,i=qR(o);for(let r=0;r<e.length;r++){let n=e[r];if(n==="*"){t=r;continue}if(i===null?AD(o,n,!0):QR(i,n))return r}return t}function fE(o){let e=rn()[no][Ls];if(!e.projection){let t=o?o.length:1,i=e.projection=qP(t,null),r=i.slice(),n=e.child;for(;n!==null;){let s=o?l2(n,o):0;s!==null&&(r[s]?r[s].projectionNext=n:i[s]=n,r[s]=n),n=n.next}}}function gE(o,e=0,t){let i=rn(),r=so(),n=Eg(r,wl+o,16,null,t||null);n.projection===null&&(n.projection=e),XD(),(!i[Od]||GD())&&(n.flags&32)!==32&&MB(r,i,n)}function h2(){return this._results[Symbol.iterator]()}var x0=class o{get changes(){return this._changes??=new Da}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;let t=o.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=h2)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let i=WP(e);(this._changesDetected=!UP(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}},Wd=(()=>{class o{static{this.__NG_ELEMENT_ID__=d2}}return o})(),u2=Wd,c2=class extends u2{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,i){let r=Qz(this._declarationLView,this._declarationTContainer,e,{injector:t,dehydratedView:i});return new Ud(r)}};function d2(){return nS(La(),rn())}function nS(o,e){return o.type&4?new c2(e,o,Yu(o,e)):null}var I0=class o{constructor(e){this.queryList=e,this.matches=null}clone(){return new o(this.queryList)}setDirty(){this.queryList.setDirty()}},M0=class o{constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let i=e.contentQueries!==null?e.contentQueries[0]:t.length,r=[];for(let n=0;n<i;n++){let s=t.getByIndex(n),a=this.queries[s.indexInDeclarationView];r.push(a.clone())}return new o(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)bE(e,t).matches!==null&&this.queries[t].setDirty()}},yg=class{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}},D0=class o{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){let r=t!==null?t.length:0,n=this.getByIndex(i).embeddedTView(e,r);n&&(n.indexInDeclarationView=i,t!==null?t.push(n):t=[n])}return t!==null?new o(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},E0=class o{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new o(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,i=e.parent;for(;i!==null&&i.type&8&&i.index!==t;)i=i.parent;return t===(i!==null?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){let n=i[r];this.matchTNodeWithReadOption(e,t,p2(t,n)),this.matchTNodeWithReadOption(e,t,ig(t,e,n,!1,!1))}else i===Wd?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,ig(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(i!==null){let r=this.metadata.read;if(r!==null)if(r===Il||r===es||r===Wd&&t.type&4)this.addMatch(t.index,-2);else{let n=ig(t,e,r,!1,!1);n!==null&&this.addMatch(t.index,n)}else this.addMatch(t.index,i)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function p2(o,e){let t=o.localNames;if(t!==null){for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1]}return null}function f2(o,e){return o.type&11?Yu(o,e):o.type&4?nS(o,e):null}function g2(o,e,t,i){return t===-1?f2(e,o):t===-2?v2(o,e,i):_u(o,o[hi],t,e)}function v2(o,e,t){if(t===Il)return Yu(e,o);if(t===Wd)return nS(e,o);if(t===es)return dE(e,o)}function vE(o,e,t,i){let r=e[io].queries[i];if(r.matches===null){let n=o.data,s=t.matches,a=[];for(let l=0;l<s.length;l+=2){let h=s[l];if(h<0)a.push(null);else{let u=n[h];a.push(g2(e,u,s[l+1],t.metadata.read))}}r.matches=a}return r.matches}function A0(o,e,t,i){let r=o.queries.getByIndex(t),n=r.matches;if(n!==null){let s=vE(o,e,r,t);for(let a=0;a<n.length;a+=2){let l=n[a];if(l>0)i.push(s[a/2]);else{let h=n[a+1],u=e[-l];for(let c=Ts;c<u.length;c++){let d=u[c];d[Qd]===d[Ln]&&A0(d[hi],d,h,i)}if(u[Vu]!==null){let c=u[Vu];for(let d=0;d<c.length;d++){let p=c[d];A0(p[hi],p,h,i)}}}}}return i}function m2(o,e){return o[io].queries[e].queryList}function mE(o,e,t){let i=new x0((t&4)===4);ZB(o,e,i,i.destroy),e[io]===null&&(e[io]=new M0),e[io].queries.push(new I0(i))}function yE(o,e,t){o.queries===null&&(o.queries=new D0),o.queries.track(new E0(e,t))}function y2(o,e){let t=o.contentQueries||(o.contentQueries=[]),i=t.length?t[t.length-1]:-1;e!==i&&t.push(o.queries.length-1,e)}function bE(o,e){return o.queries.getByIndex(e)}function qr(o,e,t,i){let r=so();if(r.firstCreatePass){let n=La();yE(r,new yg(e,t,i),n.index),y2(r,o),(t&2)===2&&(r.staticContentQueries=!0)}mE(r,rn(),t)}function SE(o,e,t){let i=so();i.firstCreatePass&&(yE(i,new yg(o,e,t),-1),(e&2)===2&&(i.staticViewQueries=!0)),mE(i,rn(),e)}function kr(o){let e=rn(),t=so(),i=$D();P0(i+1);let r=bE(t,i);if(o.dirty&&uP(e)===((r.metadata.flags&2)===2)){if(r.matches===null)o.reset([]);else{let n=r.crossesNgTemplate?A0(t,e,i,[]):vE(t,e,r,i);o.reset(n,OB),o.notifyOnChanges()}return!0}return!1}function Nr(){return m2(rn(),$D())}function Ht(o,e=""){let t=rn(),i=so(),r=o+wl,n=i.firstCreatePass?Eg(i,r,1,e,null):i.data[r],s=b2(i,t,n,e,o);t[r]=s,n1()&&R1(i,t,s,n),wg(n,!1)}var b2=(o,e,t,i,r)=>(s1(!0),cB(e[vs],i));var Wu=class{};var bg=class extends Wu{constructor(e){super(),this.componentFactoryResolver=new S0(this),this.instance=null;let t=new dg([...e.providers,{provide:Wu,useValue:this},{provide:$0,useValue:this.componentFactoryResolver}],e.parent||_0(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function S2(o,e,t=null){return new bg({providers:o,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var C2=(()=>{class o{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let i=w1(!1,t.type),r=i.length>0?S2([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=pn({token:o,providedIn:"environment",factory:()=>new o(Xi(xl))})}}return o})();function Ag(o){hE("NgStandalone"),o.getStandaloneInjector=e=>e.get(C2).getOrCreateStandaloneInjector(o)}var CE=(()=>{class o{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Ed(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275prov=pn({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var wE=new yr("");var w2=new yr(""),xE=(()=>{class o{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=Tn(w2,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let t=[];for(let r of this.appInits){let n=r();if(iS(n))t.push(n);else if(pE(n)){let s=new Promise((a,l)=>{n.subscribe({complete:a,error:l})});t.push(s)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),t.length===0&&i(),this.initialized=!0}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275prov=pn({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})(),x2=new yr("");function I2(){IM(()=>{throw new Hi(600,!1)})}function M2(o){return o.isBoundToModule}function D2(o,e,t){try{let i=t();return iS(i)?i.catch(r=>{throw e.runOutsideAngular(()=>o.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>o.handleError(i)),i}}var sS=(()=>{class o{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Tn(W1),this.afterRenderEffectManager=Tn(uE),this.componentTypes=[],this.components=[],this.isStable=Tn(CE).hasPendingTasks.pipe(Hb(t=>!t)),this._injector=Tn(xl)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){let r=t instanceof fg;if(!this._injector.get(xE).done){let d=!r&&eP(t),p=!1;throw new Hi(405,p)}let s;r?s=t:s=this._injector.get($0).resolveComponentFactory(t),this.componentTypes.push(s.componentType);let a=M2(s)?void 0:this._injector.get(Wu),l=i||s.selector,h=s.create(Xd.NULL,[],l,a),u=h.location.nativeElement,c=h.injector.get(wE,null);return c?.registerApplication(u),h.onDestroy(()=>{this.detachView(h.hostView),$b(this.components,h),c?.unregisterApplication(u)}),this._loadComponent(h),h}tick(){if(this._runningTick)throw new Hi(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{try{let t=this.afterRenderEffectManager.execute()}catch(t){this.internalErrorHandler(t)}this._runningTick=!1}}attachView(t){let i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){let i=t;$b(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);let i=this._injector.get(x2,[]);[...this._bootstrapListeners,...i].forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>$b(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Hi(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275prov=pn({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function $b(o,e){let t=o.indexOf(e);t>-1&&o.splice(t,1)}var E2=(()=>{class o{constructor(){this.zone=Tn(Wn),this.applicationRef=Tn(sS)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275prov=pn({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function A2(o){return[{provide:Wn,useFactory:o},{provide:Vd,multi:!0,useFactory:()=>{let e=Tn(E2,{optional:!0});return()=>e.initialize()}},{provide:Vd,multi:!0,useFactory:()=>{let e=Tn(N2);return()=>{e.initialize()}}},{provide:W1,useFactory:T2}]}function T2(){let o=Tn(Wn),e=Tn(Po);return t=>o.runOutsideAngular(()=>e.handleError(t))}function L2(o){let e=A2(()=>new Wn(k2(o)));return C1([[],e])}function k2(o){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:o?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:o?.runCoalescing??!1}}var N2=(()=>{class o{constructor(){this.subscription=new gs,this.initialized=!1,this.zone=Tn(Wn),this.pendingTasks=Tn(CE)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Wn.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Wn.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275prov=pn({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function F2(){return typeof $localize<"u"&&$localize.locale||mg}var aS=new yr("",{providedIn:"root",factory:()=>Tn(aS,gi.Optional|gi.SkipSelf)||F2()});var IE=new yr("");var sg=null;function O2(o=[],e){return Xd.create({name:e,providers:[{provide:xg,useValue:"platform"},{provide:IE,useValue:new Set([()=>sg=null])},...o]})}function R2(o=[]){if(sg)return sg;let e=O2(o);return sg=e,I2(),P2(e),e}function P2(o){o.get(W0,null)?.forEach(t=>t())}function ME(o){try{let{rootComponent:e,appProviders:t,platformProviders:i}=o,r=R2(i),n=[L2(),...t||[]],a=new bg({providers:n,parent:r,debugName:"",runEnvironmentInitializers:!1}).injector,l=a.get(Wn);return l.run(()=>{a.resolveInjectorInitializers();let h=a.get(Po,null),u;l.runOutsideAngular(()=>{u=l.onError.subscribe({next:p=>{h.handleError(p)}})});let c=()=>a.destroy(),d=r.get(IE);return d.add(c),a.onDestroy(()=>{u.unsubscribe(),d.delete(c)}),D2(h,l,()=>{let p=a.get(xE);return p.runInitializers(),p.donePromise.then(()=>{let f=a.get(aS,mg);s2(f||mg);let v=a.get(sS);return e!==void 0&&v.bootstrap(e),v})})})}catch(e){return Promise.reject(e)}}var DE=null;function oS(){return DE}function EE(o){DE??=o}var Tg=class{},Ml=new yr("");function AE(o,e){e=encodeURIComponent(e);for(let t of o.split(";")){let i=t.indexOf("="),[r,n]=i==-1?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(n)}return null}var lS=(()=>{class o{static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275mod=Gd({type:o})}static{this.\u0275inj=qd({})}}return o})(),TE="browser",j2="server";function hS(o){return o===j2}var Lg=class{};var dS=class extends Tg{constructor(){super(...arguments),this.supportsDOMEvents=!0}},pS=class o extends dS{static makeCurrent(){EE(new o)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=V2();return t==null?null:_2(t)}resetBaseElement(){Zd=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return AE(document.cookie,e)}},Zd=null;function V2(){return Zd=Zd||document.querySelector("base"),Zd?Zd.getAttribute("href"):null}function _2(o){return new URL(o,document.baseURI).pathname}var U2=(()=>{class o{build(){return new XMLHttpRequest}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275prov=pn({token:o,factory:o.\u0275fac})}}return o})(),fS=new yr(""),FE=(()=>{class o{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(n=>n.supports(t)),!i)throw new Hi(5101,!1);return this._eventNameToPlugin.set(t,i),i}static{this.\u0275fac=function(i){return new(i||o)(Xi(fS),Xi(Wn))}}static{this.\u0275prov=pn({token:o,factory:o.\u0275fac})}}return o})(),kg=class{constructor(e){this._doc=e}},uS="ng-app-id",OE=(()=>{class o{constructor(t,i,r,n={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=n,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=hS(n),this.resetHostNodes()}addStyles(t){for(let i of t)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(t){for(let i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){let i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${uS}="${this.appId}"]`);if(t?.length){let i=new Map;return t.forEach(r=>{r.textContent!=null&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){let r=this.styleRef;if(r.has(t)){let n=r.get(t);return n.usage+=i,n.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){let r=this.styleNodesInDOM,n=r?.get(i);if(n?.parentNode===t)return r.delete(i),n.removeAttribute(uS),n;{let s=this.doc.createElement("style");return this.nonce&&s.setAttribute("nonce",this.nonce),s.textContent=i,this.platformIsServer&&s.setAttribute(uS,this.appId),t.appendChild(s),s}}addStyleToHost(t,i){let r=this.getStyleElement(t,i),n=this.styleRef,s=n.get(i)?.elements;s?s.push(r):n.set(i,{elements:[r],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(i){return new(i||o)(Xi(Ml),Xi(U0),Xi(q0,8),Xi(Gu))}}static{this.\u0275prov=pn({token:o,factory:o.\u0275fac})}}return o})(),cS={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},vS=/%COMP%/g,RE="%COMP%",W2=`_nghost-${RE}`,q2=`_ngcontent-${RE}`,G2=!0,Y2=new yr("",{providedIn:"root",factory:()=>G2});function Q2(o){return q2.replace(vS,o)}function X2(o){return W2.replace(vS,o)}function PE(o,e){return e.map(t=>t.replace(vS,o))}var LE=(()=>{class o{constructor(t,i,r,n,s,a,l,h=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=n,this.doc=s,this.platformId=a,this.ngZone=l,this.nonce=h,this.rendererByCompId=new Map,this.platformIsServer=hS(a),this.defaultRenderer=new Jd(t,s,l,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===ro.ShadowDom&&(i=fh(Sl({},i),{encapsulation:ro.Emulated}));let r=this.getOrCreateRenderer(t,i);return r instanceof Ng?r.applyToHost(t):r instanceof ep&&r.applyStyles(),r}getOrCreateRenderer(t,i){let r=this.rendererByCompId,n=r.get(i.id);if(!n){let s=this.doc,a=this.ngZone,l=this.eventManager,h=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,c=this.platformIsServer;switch(i.encapsulation){case ro.Emulated:n=new Ng(l,h,i,this.appId,u,s,a,c);break;case ro.ShadowDom:return new gS(l,h,t,i,s,a,this.nonce,c);default:n=new ep(l,h,i,u,s,a,c);break}r.set(i.id,n)}return n}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(i){return new(i||o)(Xi(FE),Xi(OE),Xi(U0),Xi(Y2),Xi(Ml),Xi(Gu),Xi(Wn),Xi(q0))}}static{this.\u0275prov=pn({token:o,factory:o.\u0275fac})}}return o})(),Jd=class{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(cS[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(kE(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(kE(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new Hi(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;let n=cS[r];n?e.setAttributeNS(n,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){let r=cS[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Mh.DashCase|Mh.Important)?e.style.setProperty(t,i,r&Mh.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Mh.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e!=null&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i){if(typeof e=="string"&&(e=oS().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function kE(o){return o.tagName==="TEMPLATE"&&o.content!==void 0}var gS=class extends Jd{constructor(e,t,i,r,n,s,a,l){super(e,n,s,l),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let h=PE(r.id,r.styles);for(let u of h){let c=document.createElement("style");a&&c.setAttribute("nonce",a),c.textContent=u,this.shadowRoot.appendChild(c)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},ep=class extends Jd{constructor(e,t,i,r,n,s,a,l){super(e,n,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=l?PE(l,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Ng=class extends ep{constructor(e,t,i,r,n,s,a,l){let h=r+"-"+i.id;super(e,t,i,n,s,a,l,h),this.contentAttr=Q2(h),this.hostAttr=X2(h)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}},$2=(()=>{class o extends kg{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static{this.\u0275fac=function(i){return new(i||o)(Xi(Ml))}}static{this.\u0275prov=pn({token:o,factory:o.\u0275fac})}}return o})(),NE=["alt","control","meta","shift"],K2={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Z2={alt:o=>o.altKey,control:o=>o.ctrlKey,meta:o=>o.metaKey,shift:o=>o.shiftKey},J2=(()=>{class o extends kg{constructor(t){super(t)}supports(t){return o.parseEventName(t)!=null}addEventListener(t,i,r){let n=o.parseEventName(i),s=o.eventCallback(n.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>oS().onAndCancel(t,n.domEventName,s))}static parseEventName(t){let i=t.toLowerCase().split("."),r=i.shift();if(i.length===0||!(r==="keydown"||r==="keyup"))return null;let n=o._normalizeKey(i.pop()),s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),NE.forEach(h=>{let u=i.indexOf(h);u>-1&&(i.splice(u,1),s+=h+".")}),s+=n,i.length!=0||n.length===0)return null;let l={};return l.domEventName=r,l.fullKey=s,l}static matchEventFullKeyCode(t,i){let r=K2[t.key]||t.key,n="";return i.indexOf("code.")>-1&&(r=t.code,n="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),NE.forEach(s=>{if(s!==r){let a=Z2[s];a(t)&&(n+=s+".")}}),n+=r,n===i)}static eventCallback(t,i,r){return n=>{o.matchEventFullKeyCode(n,t)&&r.runGuarded(()=>i(n))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(i){return new(i||o)(Xi(Ml))}}static{this.\u0275prov=pn({token:o,factory:o.\u0275fac})}}return o})();function BE(o,e){return ME(Sl({rootComponent:o},ej(e)))}function ej(o){return{appProviders:[...sj,...o?.providers??[]],platformProviders:nj}}function tj(){pS.makeCurrent()}function ij(){return new Po}function rj(){return M1(document),document}var nj=[{provide:Gu,useValue:TE},{provide:W0,useValue:tj,multi:!0},{provide:Ml,useFactory:rj,deps:[]}];var sj=[{provide:xg,useValue:"root"},{provide:Po,useFactory:ij,deps:[]},{provide:fS,useClass:$2,multi:!0,deps:[Ml,Wn,Gu]},{provide:fS,useClass:J2,multi:!0,deps:[Ml]},LE,OE,FE,{provide:_d,useExisting:LE},{provide:Lg,useClass:U2,deps:[]},[]];var zE={providers:[]};var jE="ej2_instances",aj=0,oj=!1;function Pg(o,e){var t=e;return t.unshift(void 0),new(Function.prototype.bind.apply(o,t))}function lj(o){var e,t=new Uint16Array(5),i=window.msCrypto||window.crypto;i.getRandomValues(t);var r="ej2"+uj(t),n=function(s){s.source===window&&typeof s.data=="string"&&s.data.length<=32&&s.data===r&&(o(),e())};return window.addEventListener("message",n,!1),window.postMessage(r,"*"),e=function(){window.removeEventListener("message",n),o=n=r=void 0}}function V(o,e){for(var t=e,i=o.replace(/\[/g,".").replace(/\]/g,"").split("."),r=0;r<i.length&&!Ee(t);r++)t=t[i[parseInt(r.toString(),10)]];return t}function Ge(o,e,t){var i=o.replace(/\[/g,".").replace(/\]/g,"").split("."),r=t||{},n=r,s,a=i.length,l;for(s=0;s<a;s++)l=i[parseInt(s.toString(),10)],s+1===a?n[""+l]=e===void 0?{}:e:g(n[""+l])&&(n[""+l]={}),n=n[""+l];return r}function ip(o,e){delete o[""+e]}var Qu=typeof window<"u"?window:{};function ms(o){var e={};return!g(o)&&o.constructor===e.constructor}function ht(o,e){if(!g(e))for(var t=o,i=e,r=Object.keys(e),n="deepMerge",s=0,a=r;s<a.length;s++){var l=a[s];!g(t[""+n])&&t[""+n].indexOf(l)!==-1&&(ms(i[""+l])||Array.isArray(i[""+l]))?he(t[""+l],t[""+l],i[""+l],!0):t[""+l]=i[""+l]}}function he(o,e,t,i){var r=o&&typeof o=="object"?o:{},n=arguments.length,s=[o,e,t,i];i&&(n=n-1);for(var a=function(h){if(!s[parseInt(h.toString(),10)])return"continue";var u=s[parseInt(h.toString(),10)];Object.keys(u).forEach(function(c){var d=r[""+c],p=u[""+c],f,v=Array.isArray(p)&&Array.isArray(d)&&p.length!==d.length,m=qe()?!(d instanceof Event)&&!v:!0;i&&m&&(ms(p)||Array.isArray(p))?ms(p)?(f=d||{},Array.isArray(f)&&Object.prototype.hasOwnProperty.call(f,"isComplexArray")?he(f,{},p,i):r[""+c]=he(f,{},p,i)):(f=qe()?d&&Object.keys(p).length:d||[],r[""+c]=he([],f,p,f&&f.length||p&&p.length)):r[""+c]=p})},l=1;l<n;l++)a(l);return r}function g(o){return o==null}function Ee(o){return typeof o>"u"}function kt(o){return o+"_"+aj++}function Bg(o,e){var t;return function(){for(var i=this,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var s=function(){return t=null,o.apply(i,r)};clearTimeout(t),t=setTimeout(s,e)}}function zg(o,e){var t=o;return t===e?!0:t===document||!t?!1:zg(t.parentNode,e)}function Dh(o){try{throw new Error(o)}catch(e){throw new Error(e.message+`
`+e.stack)}}function TS(o,e){var t=document.createElement("div"),i=[].slice.call(document.getElementsByTagName("head")[0].querySelectorAll("base, link, style")),r=[].slice.call(document.getElementsByTagName("body")[0].querySelectorAll("link, style"));if(r.length)for(var n=0,s=r.length;n<s;n++)i.push(r[parseInt(n.toString(),10)]);var a="";g(e)&&(e=window.open("","print","height=452,width=1024,tabbar=no")),t.appendChild(o.cloneNode(!0));for(var l=0,s=i.length;l<s;l++)a+=i[parseInt(l.toString(),10)].outerHTML;e.document.write("<!DOCTYPE html> <html><head>"+a+"</head><body>"+t.innerHTML+"<script> (function() { window.ready = true; })(); <\/script></body></html>"),e.document.close(),e.focus();var h=setInterval(function(){e.ready&&(e.print(),e.close(),clearInterval(h))},500);return e}function Le(o){var e=o+"";return e.match(/auto|cm|mm|in|px|pt|pc|%|em|ex|ch|rem|vw|vh|vmin|vmax/)?e:e+"px"}function qe(){return oj}function LS(o){var e="xPath";return!(o instanceof Node)&&qe()&&!g(o[""+e])?document.evaluate(o[""+e],document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue:o}function fr(o,e){var t=typeof o=="string"?document.querySelector(o):o;if(t[""+jE])for(var i=0,r=t[""+jE];i<r.length;i++){var n=r[i];if(n instanceof e)return n}return null}function hj(){if(!(typeof window>"u")){var o=new Uint16Array(5),e=window.msCrypto||window.crypto;return e.getRandomValues(o)}}function uj(o){for(var e="",t=0;t<5;t++)e+=(t?",":"")+o[parseInt(t.toString(),10)];return e}var cj={latn:{_digits:"0123456789",_type:"numeric"}},HE={decimal:".",group:",",percentSign:"%",plusSign:"+",minusSign:"-",infinity:"\u221E",nan:"NaN",exponential:"E"},VE=[0,1,2,3,4,5,6,7,8,9],pr=function(){function o(){}return o.getMainObject=function(e,t){var i=qe()?t:"main."+t;return V(i,e)},o.getNumberingSystem=function(e){return V("supplemental.numberingSystems",e)||this.numberingSystems},o.reverseObject=function(e,t){for(var i=t||Object.keys(e),r={},n=0,s=i;n<s.length;n++){var a=s[n];Object.prototype.hasOwnProperty.call(r,e[""+a])||(r[e[""+a]]=a)}return r},o.getSymbolRegex=function(e){var t=e.map(function(r){return r.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")}).join("|"),i=RegExp;return new i(t,"g")},o.getSymbolMatch=function(e){for(var t=Object.keys(HE),i={},r=0,n=t;r<n.length;r++){var s=n[r];i[e[""+s]]=HE[""+s]}return i},o.constructRegex=function(e){for(var t=e.length,i="",r=0;r<t;r++)r!==t-1?i+=e[parseInt(r.toString(),10)]+"|":i+=e[parseInt(r.toString(),10)];return i},o.convertValueParts=function(e,t,i){return e.replace(t,function(r){return i[""+r]})},o.getDefaultNumberingSystem=function(e){var t={};return t.obj=V("numbers",e),t.nSystem=V("defaultNumberingSystem",t.obj),t},o.getCurrentNumericOptions=function(e,t,i,r){var n={},s=this.getDefaultNumberingSystem(e);if(!Ee(s.nSystem)||r){var a=r?V("obj.mapperDigits",s):V(s.nSystem+"._digits",t);if(!Ee(a)){n.numericPair=this.reverseObject(a,VE);var l=RegExp;n.numberParseRegex=new l(this.constructRegex(a),"g"),n.numericRegex="["+a[0]+"-"+a[9]+"]",i&&(n.numericRegex=a[0]+"-"+a[9],n.symbolNumberSystem=V(r?"numberSymbols":"symbols-numberSystem-"+s.nSystem,s.obj),n.symbolMatch=this.getSymbolMatch(n.symbolNumberSystem),n.numberSystem=s.nSystem)}}return n},o.getNumberMapper=function(e,t,i){var r={mapper:{}},n=this.getDefaultNumberingSystem(e);if(!Ee(n.nSystem)){r.numberSystem=n.nSystem,r.numberSymbols=V("symbols-numberSystem-"+n.nSystem,n.obj),r.timeSeparator=V("timeSeparator",r.numberSymbols);var s=V(n.nSystem+"._digits",t);if(!Ee(s))for(var a=0,l=VE;a<l.length;a++){var h=l[a];r.mapper[parseInt(h.toString(),10)]=s[parseInt(h.toString(),10)]}}return r},o.nPair="numericPair",o.nRegex="numericRegex",o.numberingSystems=cj,o}(),dj={DJF:"Fdj",ERN:"Nfk",ETB:"Br",NAD:"$",ZAR:"R",XAF:"FCFA",GHS:"GH\u20B5",XDR:"XDR",AED:"\u062F.\u0625.",BHD:"\u062F.\u0628.",DZD:"\u062F.\u062C.",EGP:"\u062C.\u0645.",ILS:"\u20AA",IQD:"\u062F.\u0639.",JOD:"\u062F.\u0627.",KMF:"CF",KWD:"\u062F.\u0643.",LBP:"\u0644.\u0644.",LYD:"\u062F.\u0644.",MAD:"\u062F.\u0645.",MRU:"\u0623.\u0645.",OMR:"\u0631.\u0639.",QAR:"\u0631.\u0642.",SAR:"\u0631.\u0633.",SDG:"\u062C.\u0633.",SOS:"S",SSP:"\xA3",SYP:"\u0644.\u0633.",TND:"\u062F.\u062A.",YER:"\u0631.\u064A.",CLP:"$",INR:"\u20B9",TZS:"TSh",EUR:"\u20AC",AZN:"\u20BC",RUB:"\u20BD",BYN:"Br",ZMW:"K",BGN:"\u043B\u0432.",NGN:"\u20A6",XOF:"CFA",BDT:"\u09F3",CNY:"\xA5",BAM:"\u041A\u041C",UGX:"USh",USD:"$",CZK:"K\u010D",GBP:"\xA3",DKK:"kr.",KES:"Ksh",CHF:"CHF",MVR:"\u0783.",BTN:"Nu.",XCD:"EC$",AUD:"$",BBD:"$",BIF:"FBu",BMD:"$",BSD:"$",BWP:"P",BZD:"$",CAD:"$",NZD:"$",FJD:"$",FKP:"\xA3",GIP:"\xA3",GMD:"D",GYD:"$",HKD:"$",IDR:"Rp",JMD:"$",KYD:"$",LRD:"$",MGA:"Ar",MOP:"MOP$",MUR:"Rs",MWK:"MK",MYR:"RM",PGK:"K",PHP:"\u20B1",PKR:"Rs",RWF:"RF",SBD:"$",SCR:"SR",SEK:"kr",SGD:"$",SHP:"\xA3",SLL:"Le",ANG:"NAf.",SZL:"E",TOP:"T$",TTD:"$",VUV:"VT",WST:"WS$",ARS:"$",BOB:"Bs",BRL:"R$",COP:"$",CRC:"\u20A1",CUP:"$",DOP:"$",GTQ:"Q",HNL:"L",MXN:"$",NIO:"C$",PAB:"B/.",PEN:"S/",PYG:"\u20B2",UYU:"$",VES:"Bs.S",IRR:"\u0631\u064A\u0627\u0644",GNF:"FG",CDF:"FC",HTG:"G",XPF:"FCFP",HRK:"kn",HUF:"Ft",AMD:"\u058F",ISK:"kr",JPY:"\xA5",GEL:"\u20BE",CVE:"\u200B",KZT:"\u20B8",KHR:"\u17DB",KPW:"\u20A9",KRW:"\u20A9",KGS:"\u0441\u043E\u043C",AOA:"Kz",LAK:"\u20AD",MZN:"MTn",MKD:"\u0434\u0435\u043D",MNT:"\u20AE",BND:"$",MMK:"K",NOK:"kr",NPR:"\u0930\u0941",AWG:"Afl.",SRD:"$",PLN:"z\u0142",AFN:"\u060B",STN:"Db",MDL:"L",RON:"lei",UAH:"\u20B4",LKR:"\u0DBB\u0DD4.",ALL:"Lek\xEB",RSD:"\u0434\u0438\u043D.",TJS:"\u0441\u043C\u043D",THB:"\u0E3F",TMT:"m.",TRY:"\u20BA",UZS:"\u0441\u045E\u043C",VND:"\u20AB",TWD:"NT$"};function pj(o){return V(o||"",dj)}var ts="USD",lA=null,hA=null;function fj(o){lA=o}function gj(o){hA=o}var _E=RegExp,UE={"en-US":{d:"M/d/y",D:"EEEE, MMMM d, y",f:"EEEE, MMMM d, y h:mm a",F:"EEEE, MMMM d, y h:mm:s a",g:"M/d/y h:mm a",G:"M/d/yyyy h:mm:ss tt",m:"MMMM d",M:"MMMM d",r:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",R:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",s:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",t:"h:mm tt",T:"h:m:s tt",u:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",U:"dddd, MMMM d, yyyy h:mm:ss tt",y:"MMMM yyyy",Y:"MMMM yyyy"}},nt;(function(o){o.negativeDataRegex=/^(('[^']+'|''|[^*#@0,.E])*)(\*.)?((([#,]*[0,]*0+)(\.0*[0-9]*#*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,o.customRegex=/^(('[^']+'|''|[^*#@0,.])*)(\*.)?((([0#,]*[0,]*[0#]*[0# ]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,o.latnParseRegex=/0|1|2|3|4|5|6|7|8|9/g;var e=/[0-9]/g;o.defaultCurrency="$";var t=["infinity","nan","group","decimal"],i=/G|M|L|H|c|'| a|yy|y|EEEE|E/g,r={G:"",M:"m",L:"m",H:"h",c:"d","'":'"'," a":" AM/PM",yy:"yy",y:"yyyy",EEEE:"dddd",E:"ddd"};o.dateConverterMapper=/dddd|ddd/ig;var n="sun";o.islamicRegex=/^islamic/;var s={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6};o.formatRegex=new _E("(^[ncpae]{1})([0-1]?[0-9]|20)?$","i"),o.currencyFormatRegex=new _E("(^[ca]{1})([0-1]?[0-9]|20)?$","i"),o.curWithoutNumberRegex=/(c|a)$/ig;var a={$:"isCurrency","%":"isPercent","-":"isNegative",0:"nlead",1:"nend"};o.dateParseRegex=/([a-z])\1*|'([^']|'')+'|''|./gi,o.basicPatterns=["short","medium","long","full"],o.defaultObject={dates:{calendars:{gregorian:{months:{"stand-alone":{abbreviated:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},narrow:{1:"J",2:"F",3:"M",4:"A",5:"M",6:"J",7:"J",8:"A",9:"S",10:"O",11:"N",12:"D"},wide:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}}},days:{"stand-alone":{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},narrow:{sun:"S",mon:"M",tue:"T",wed:"W",thu:"T",fri:"F",sat:"S"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}}},dayPeriods:{format:{wide:{am:"AM",pm:"PM"}}},eras:{eraNames:{0:"Before Christ","0-alt-variant":"Before Common Era",1:"Anno Domini","1-alt-variant":"Common Era"},eraAbbr:{0:"BC","0-alt-variant":"BCE",1:"AD","1-alt-variant":"CE"},eraNarrow:{0:"B","0-alt-variant":"BCE",1:"A","1-alt-variant":"CE"}},dateFormats:{full:"EEEE, MMMM d, y",long:"MMMM d, y",medium:"MMM d, y",short:"M/d/yy"},timeFormats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}",availableFormats:{d:"d",E:"ccc",Ed:"d E",Ehm:"E h:mm a",EHm:"E HH:mm",Ehms:"E h:mm:ss a",EHms:"E HH:mm:ss",Gy:"y G",GyMMM:"MMM y G",GyMMMd:"MMM d, y G",GyMMMEd:"E, MMM d, y G",h:"h a",H:"HH",hm:"h:mm a",Hm:"HH:mm",hms:"h:mm:ss a",Hms:"HH:mm:ss",hmsv:"h:mm:ss a v",Hmsv:"HH:mm:ss v",hmv:"h:mm a v",Hmv:"HH:mm v",M:"L",Md:"M/d",MEd:"E, M/d",MMM:"LLL",MMMd:"MMM d",MMMEd:"E, MMM d",MMMMd:"MMMM d",ms:"mm:ss",y:"y",yM:"M/y",yMd:"M/d/y",yMEd:"E, M/d/y",yMMM:"MMM y",yMMMd:"MMM d, y",yMMMEd:"E, MMM d, y",yMMMM:"MMMM y"}}},islamic:{months:{"stand-alone":{abbreviated:{1:"Muh.",2:"Saf.",3:"Rab. I",4:"Rab. II",5:"Jum. I",6:"Jum. II",7:"Raj.",8:"Sha.",9:"Ram.",10:"Shaw.",11:"Dhu\u02BBl-Q.",12:"Dhu\u02BBl-H."},narrow:{1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12"},wide:{1:"Muharram",2:"Safar",3:"Rabi\u02BB I",4:"Rabi\u02BB II",5:"Jumada I",6:"Jumada II",7:"Rajab",8:"Sha\u02BBban",9:"Ramadan",10:"Shawwal",11:"Dhu\u02BBl-Qi\u02BBdah",12:"Dhu\u02BBl-Hijjah"}}},days:{"stand-alone":{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},narrow:{sun:"S",mon:"M",tue:"T",wed:"W",thu:"T",fri:"F",sat:"S"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}}},dayPeriods:{format:{wide:{am:"AM",pm:"PM"}}},eras:{eraNames:{0:"AH"},eraAbbr:{0:"AH"},eraNarrow:{0:"AH"}},dateFormats:{full:"EEEE, MMMM d, y G",long:"MMMM d, y G",medium:"MMM d, y G",short:"M/d/y GGGGG"},timeFormats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}",availableFormats:{d:"d",E:"ccc",Ed:"d E",Ehm:"E h:mm a",EHm:"E HH:mm",Ehms:"E h:mm:ss a",EHms:"E HH:mm:ss",Gy:"y G",GyMMM:"MMM y G",GyMMMd:"MMM d, y G",GyMMMEd:"E, MMM d, y G",h:"h a",H:"HH",hm:"h:mm a",Hm:"HH:mm",hms:"h:mm:ss a",Hms:"HH:mm:ss",M:"L",Md:"M/d",MEd:"E, M/d",MMM:"LLL",MMMd:"MMM d",MMMEd:"E, MMM d",MMMMd:"MMMM d",ms:"mm:ss",y:"y G",yyyy:"y G",yyyyM:"M/y GGGGG",yyyyMd:"M/d/y GGGGG",yyyyMEd:"E, M/d/y GGGGG",yyyyMMM:"MMM y G",yyyyMMMd:"MMM d, y G",yyyyMMMEd:"E, MMM d, y G",yyyyMMMM:"MMMM y G",yyyyQQQ:"QQQ y G",yyyyQQQQ:"QQQQ y G"}}}},timeZoneNames:{hourFormat:"+HH:mm;-HH:mm",gmtFormat:"GMT{0}",gmtZeroFormat:"GMT"}},numbers:{currencies:{USD:{displayName:"US Dollar",symbol:"$","symbol-alt-narrow":"$"},EUR:{displayName:"Euro",symbol:"\u20AC","symbol-alt-narrow":"\u20AC"},GBP:{displayName:"British Pound","symbol-alt-narrow":"\xA3"}},defaultNumberingSystem:"latn",minimumGroupingDigits:"1","symbols-numberSystem-latn":{decimal:".",group:",",list:";",percentSign:"%",plusSign:"+",minusSign:"-",exponential:"E",superscriptingExponent:"\xD7",perMille:"\u2030",infinity:"\u221E",nan:"NaN",timeSeparator:":"},"decimalFormats-numberSystem-latn":{standard:"#,##0.###"},"percentFormats-numberSystem-latn":{standard:"#,##0%"},"currencyFormats-numberSystem-latn":{standard:"\xA4#,##0.00",accounting:"\xA4#,##0.00;(\xA4#,##0.00)"},"scientificFormats-numberSystem-latn":{standard:"#E0"}}},o.blazorDefaultObject={numbers:{mapper:{0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9"},mapperDigits:"0123456789",numberSymbols:{decimal:".",group:",",plusSign:"+",minusSign:"-",percentSign:"%",nan:"NaN",timeSeparator:":",infinity:"\u221E"},timeSeparator:":",currencySymbol:"$",currencypData:{nlead:"$",nend:"",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},percentpData:{nlead:"",nend:"%",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},percentnData:{nlead:"-",nend:"%",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},currencynData:{nlead:"($",nend:")",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},decimalnData:{nlead:"-",nend:"",groupData:{primary:3},maximumFraction:2,minimumFraction:2},decimalpData:{nlead:"",nend:"",groupData:{primary:3},maximumFraction:2,minimumFraction:2}},dates:{dayPeriods:{am:"AM",pm:"PM"},dateSeperator:"/",days:{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}},months:{abbreviated:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},wide:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}},eras:{1:"AD"}}},o.monthIndex={3:"abbreviated",4:"wide",5:"narrow",1:"abbreviated"},o.month="months",o.days="days",o.patternMatcher={C:"currency",P:"percent",N:"decimal",A:"currency",E:"scientific"};function l(R,N,P,O,z){var H,Q=P||"date";if(z)H=d({skeleton:R},z).format||d({skeleton:"d"},"en-US").format;else{if(o.basicPatterns.indexOf(R)!==-1){if(H=V(Q+"Formats."+R,N),Q==="dateTime"){var $=V("dateFormats."+R,N),U=V("timeFormats."+R,N);H=H.replace("{1}",$).replace("{0}",U)}}else H=V("dateTimeFormats.availableFormats."+R,N);Ee(H)&&R==="yMd"&&(H="M/d/y")}return H}o.getResultantPattern=l;function h(R,N,P,O){var z={},H=P||"gregorian";if(z.parserObject=pr.getMainObject(R,N)||(qe()?o.blazorDefaultObject:o.defaultObject),O)z.numericObject=V("numbers",z.parserObject);else{var Q=qe()?"dates":"dates.calendars."+H;z.dateObject=V(Q,z.parserObject)}return z}o.getDependables=h;function u(R,N,P,O){return V(R+"Formats-numberSystem-"+N+(O?".accounting":".standard"),P)||(O?V(R+"Formats-numberSystem-"+N+".standard",P):"")}o.getSymbolPattern=u;function c(R){var N=R.match(o.dateConverterMapper);if(N&&qe()){var P=N[0].length===3?"EEE":"EEEE";return R.replace(o.dateConverterMapper,P)}return R}o.ConvertDateToWeekFormat=c;function d(R,N){var P=R.format||R.skeleton,O=V((N||"en-US")+"."+P,UE);return O||(O=V("en-US."+P,UE)),O&&(O=c(O),R.format=O.replace(/tt/,"a")),R}o.compareBlazorDateFormats=d;function p(R){var N=R.match(o.formatRegex),P={},O=N[1].toUpperCase();return P.isAccount=O==="A",P.type=o.patternMatcher[""+O],R.length>1&&(P.fractionDigits=parseInt(N[2],10)),P}o.getProperNumericSkeleton=p;function f(R,N,P,O){var z=O?{}:{nlead:"",nend:""},H=R.match(o.customRegex);if(H){O||(z.nlead=v(H[1],P),z.nend=v(H[10],P),z.groupPattern=H[4]);var Q=H[7];if(Q&&N){var $=Q.match(e);g($)?z.minimumFraction=0:z.minimumFraction=$.length,z.maximumFraction=Q.length-1}}return z}o.getFormatData=f;function v(R,N){return R?(R=R.replace(o.defaultCurrency,N),N===""?R.trim():R):""}o.changeCurrencySymbol=v;function m(R,N,P,O){var z=P?"."+P:".symbol",H=O?"$":V("currencies."+N+z,R)||V("currencies."+N+".symbol-alt-narrow",R)||"$";return H}o.getCurrencySymbol=m;function y(R,N,P){for(var O={},z=R.split(";"),H=["pData","nData","zeroData"],Q=0;Q<z.length;Q++)O[""+H[parseInt(Q.toString(),10)]]=S(z[parseInt(Q.toString(),10)],N,P);return g(O.nData)&&(O.nData=he({},O.pData),O.nData.nlead=g(N)?"-"+O.nData.nlead:N.minusSymbol+O.nData.nlead),O}o.customFormat=y;function S(R,N,P){var O={type:"decimal",minimumFractionDigits:0,maximumFractionDigits:0},z=R.match(o.customRegex);if(g(z)||z[5]===""&&R!=="N/A")return O.type=void 0,O;O.nlead=z[1],O.nend=z[10];var H=z[6],Q=!!H.match(/ $/g),$=H.replace(/ $/g,"").indexOf(" ")!==-1;O.useGrouping=H.indexOf(",")!==-1||$,H=H.replace(/,/g,""),H=/\s$/.test(H)?H.replace(/ /g,""):H;var U=z[7];if(H.indexOf("0")!==-1&&(O.minimumIntegerDigits=H.length-H.indexOf("0")),g(U)||(O.minimumFractionDigits=U.lastIndexOf("0"),O.maximumFractionDigits=U.lastIndexOf("#"),O.minimumFractionDigits===-1&&(O.minimumFractionDigits=0),(O.maximumFractionDigits===-1||O.maximumFractionDigits<O.minimumFractionDigits)&&(O.maximumFractionDigits=O.minimumFractionDigits)),g(N)?he(O,b([O.nlead,O.nend],"%","%")):(N.isCustomFormat=!0,he(O,b([O.nlead,O.nend],"$",N.currencySymbol)),O.isCurrency||he(O,b([O.nlead,O.nend],"%",N.percentSymbol))),!g(P)){var ie=u(O.type,N.numberMapper.numberSystem,P,!1);O.useGrouping&&(O.groupSeparator=$?" ":N.numberMapper.numberSymbols[t[2]],O.groupData=lA.getGroupingDetails(ie.split(";")[0])),O.nlead=O.nlead.replace(/'/g,""),O.nend=Q?" "+O.nend.replace(/'/g,""):O.nend.replace(/'/g,"")}return O}o.customNumberFormat=S;function b(R,N,P){for(var O={nlead:R[0],nend:R[1]},z=0;z<2;z++){var H=R[parseInt(z.toString(),10)],Q=H.indexOf(N);if(Q!==-1&&(Q<H.indexOf("'")||Q>H.lastIndexOf("'"))){O[""+a[parseInt(z.toString(),10)]]=H.substr(0,Q)+P+H.substr(Q+1),O[""+a[""+N]]=!0,O.type=O.isCurrency?"currency":"percent";break}}return O}o.isCurrencyPercent=b;function w(R){var N=(V("dateFormats.short",R)||"").match(/[dM]([^dM])[dM]/i);return N?N[1]:"/"}o.getDateSeparator=w;function I(R,N,P,O){var z=h(P,R,N.calendar);qe()&&(N=d(N,R));var H=N.format||l(N.skeleton,z.dateObject,N.type);if(O){if(H=H.replace(i,function(oe){return r[""+oe]}),H.indexOf("z")!==-1){var Q=H.match(/z/g).length,$=void 0,U={timeZone:{}};U.numMapper=pr.getNumberMapper(z.parserObject,pr.getNumberingSystem(P)),U.timeZone=V("dates.timeZoneNames",z.parserObject);var ie=new Date,ne=ie.getTimezoneOffset(),te=Q<4?"+H;-H":U.timeZone.hourFormat;te=te.replace(/:/g,U.numMapper.timeSeparator),ne===0?$=U.timeZone.gmtZeroFormat:($=hA.getTimeZoneValue(ne,te),$=U.timeZone.gmtFormat.replace(/\{0\}/,$)),H=H.replace(/[z]+/,'"'+$+'"')}H=H.replace(/ $/,"")}return H}o.getActualDateTimeFormat=I;function x(R,N){if(R.indexOf(",")!==-1){var P=R.split(",");R=P[0]+V("numberMapper.numberSymbols.group",N)+P[1].replace(".",V("numberMapper.numberSymbols.decimal",N))}else R=R.replace(".",V("numberMapper.numberSymbols.decimal",N));return R}o.processSymbol=x;function M(R,N,P,O){var z=h(P,R,"",!0),H={custom:!0},Q=z.numericObject,$,U={},ie=(N.format||"").match(o.currencyFormatRegex),ne=o.formatRegex.test(N.format)?p(N.format||"N"):{},te={};if(ie){te.numberMapper=qe()?he({},z.numericObject):pr.getNumberMapper(z.parserObject,pr.getNumberingSystem(P),!0);var oe=qe()?V("currencySymbol",z.numericObject):m(z.numericObject,N.currency||ts,N.altSymbol),ae=u("currency",te.numberMapper.numberSystem,z.numericObject,/a/i.test(N.format));ae=ae.replace(/\u00A4/g,oe);var ye=ae.split(";");U.hasNegativePattern=qe()?!0:ye.length>1,U.nData=qe()?V(ne.type+"nData",Q):f(ye[1]||"-"+ye[0],!0,oe),U.pData=qe()?V(ne.type+"pData",Q):f(ye[0],!1,oe),!ie[2]&&!N.minimumFractionDigits&&!N.maximumFractionDigits&&($=f(ae.split(";")[0],!0,"",!0).minimumFraction)}var De;if(o.formatRegex.test(N.format)||!N.format){if(he(H,p(N.format||"N")),H.custom=!1,De="###0",H.fractionDigits||N.minimumFractionDigits||N.maximumFractionDigits||$){var ve=0;H.fractionDigits&&(N.minimumFractionDigits=N.maximumFractionDigits=H.fractionDigits),De=D(De,$||H.fractionDigits||N.minimumFractionDigits||ve,N.maximumFractionDigits||ve)}if(N.minimumIntegerDigits&&(De=A(De,N.minimumIntegerDigits)),N.useGrouping&&(De=L(De)),H.type==="currency"||H.type&&qe()){qe()&&H.type!=="currency"&&(U.pData=V(H.type+"pData",Q),U.nData=V(H.type+"nData",Q));var ue=De;De=U.pData.nlead+ue+U.pData.nend,(U.hasNegativePattern||qe())&&(De+=";"+U.nData.nlead+ue+U.nData.nend)}H.type==="percent"&&!qe()&&(De+=" %")}else De=N.format.replace(/'/g,'"');return Object.keys(te).length>0&&(De=O?De:x(De,te)),De}o.getActualNumberFormat=M;function D(R,N,P){R+=".";for(var O=0;O<N;O++)R+="0";if(N<P)for(var z=P-N,H=0;H<z;H++)R+="#";return R}o.fractionDigitsPattern=D;function A(R,N){for(var P=R.split("."),O="",z=0;z<N;z++)O+="0";return P[1]?O+"."+P[1]:O}o.minimumIntegerPattern=A;function L(R){var N=R.split("."),P=N[0],O=3-P.length%3,z=O&&O===1?"#":O===2?"##":"";P=z+P,R="";for(var H=P.length-1;H>0;H=H-3)R=","+P[H-2]+P[H-1]+P[parseInt(H.toString(),10)]+R;return R=R.slice(1),N[1]?R+"."+N[1]:R}o.groupingPattern=L;function T(R,N){var P=n,O=V("supplemental.weekData.firstDay",N),z=R;return/en-/.test(z)&&(z=z.slice(3)),z=z.slice(0,2).toUpperCase()+z.substr(2),O&&(P=O[""+z]||O[z.slice(0,2)]||n),s[""+P]}o.getWeekData=T;function k(R,N,P){var O=pj(P);if(N!==O)for(var z=0,H=R;z<H.length;z++){var Q=H[z];Q.nend=Q.nend.replace(N,O),Q.nlead=Q.nlead.replace(N,O)}}o.replaceBlazorCurrency=k;function F(R,N){var P=new Date(R.getFullYear(),0,1),O=P.getDay(),z;O=O>=0?O:O+7;var H=Math.floor((R.getTime()-P.getTime()-(R.getTimezoneOffset()-P.getTimezoneOffset())*6e4)/864e5)+1;if(O<4){if(z=Math.floor((H+O-N-1)/7)+1,z>52){var Q=new Date(R.getFullYear()+1,0,1),$=Q.getDay();$=$>=0?$:$+7,z=$<4?1:53}}else z=Math.floor((H+O-N-1)/7);return z}o.getWeekOfYear=F})(nt||(nt={}));var jg=function(){function o(e,t,i){this.type="GET",this.emitError=!0,typeof e=="string"?(this.url=e,this.type=g(t)?this.type:t.toUpperCase(),this.contentType=i):ms(e)&&Object.keys(e).length>0&&ht(this,e),this.contentType=g(this.contentType)?"application/json; charset=utf-8":this.contentType}return o.prototype.send=function(e){var t=this,i={"application/json":"json","multipart/form-data":"formData","application/octet-stream":"blob","application/x-www-form-urlencoded":"formData"};try{g(this.fetchRequest)&&this.type==="GET"?this.fetchRequest=new Request(this.url,{method:this.type}):g(this.fetchRequest)&&(this.data=g(e)?this.data:e,this.fetchRequest=new Request(this.url,{method:this.type,headers:{"Content-Type":this.contentType},body:this.data}));var r={cancel:!1,fetchRequest:this.fetchRequest};return this.triggerEvent(this.beforeSend,r),r.cancel?null:(this.fetchResponse=fetch(this.fetchRequest),this.fetchResponse.then(function(n){if(t.triggerEvent(t.onLoad,n),!n.ok)throw n;for(var s="text",a=0,l=Object.keys(i);a<l.length;a++){var h=l[a];n.headers.get("Content-Type")&&n.headers.get("Content-Type").indexOf(h)!==-1&&(s=i[h])}return n[s]()}).then(function(n){return t.triggerEvent(t.onSuccess,n,t),n}).catch(function(n){var s={};return t.emitError&&(t.triggerEvent(t.onFailure,n),s=Promise.reject(n)),s}))}catch(n){return n}},o.prototype.triggerEvent=function(e,t,i){!g(e)&&typeof e=="function"&&e(t,i)},o}(),vj=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini|mobile/i,mj=/msie|trident/i,yj=/Trident\/7\./,bj=/(ipad|iphone|ipod touch)/i,Sj=/(ipad|iphone|ipod touch);.*os 7_\d|(ipad|iphone|ipod touch);.*os 8_\d/i,Cj=/android/i,wj=/trident|windows phone|edge/i,xj=/(version)[ /]([\w.]+)/i,mS={OPERA:/(opera|opr)(?:.*version|)[ /]([\w.]+)/i,EDGE:/(edge)(?:.*version|)[ /]([\w.]+)/i,CHROME:/(chrome|crios)[ /]([\w.]+)/i,PANTHOMEJS:/(phantomjs)[ /]([\w.]+)/i,SAFARI:/(safari)[ /]([\w.]+)/i,WEBKIT:/(webkit)[ /]([\w.]+)/i,MSIE:/(msie|trident) ([\w.]+)/i,MOZILLA:/(mozilla)(?:.*? rv:([\w.]+)|)/i};typeof window<"u"&&(window.browserDetails=window.browserDetails||{});var B=function(){function o(){}return o.extractBrowserDetail=function(){for(var e={culture:{}},t=Object.keys(mS),i=[],r=0,n=t;r<n.length;r++){var s=n[r];if(i=o.userAgent.match(mS[""+s]),i){if(e.name=i[1].toLowerCase()==="opr"?"opera":i[1].toLowerCase(),e.name=i[1].toLowerCase()==="crios"?"chrome":e.name,e.version=i[2],e.culture.name=e.culture.language=navigator.language,o.userAgent.match(yj)){e.name="msie";break}var a=o.userAgent.match(xj);e.name==="safari"&&a&&(e.version=a[2]);break}}return e},o.getEvent=function(e){var t={start:{isPointer:"pointerdown",isTouch:"touchstart",isDevice:"mousedown"},move:{isPointer:"pointermove",isTouch:"touchmove",isDevice:"mousemove"},end:{isPointer:"pointerup",isTouch:"touchend",isDevice:"mouseup"},cancel:{isPointer:"pointercancel",isTouch:"touchcancel",isDevice:"mouseleave"}};return o.isPointer?t[""+e].isPointer:o.isTouch?t[""+e].isTouch+(o.isDevice?"":" "+t[""+e].isDevice):t[""+e].isDevice},o.getTouchStartEvent=function(){return o.getEvent("start")},o.getTouchEndEvent=function(){return o.getEvent("end")},o.getTouchMoveEvent=function(){return o.getEvent("move")},o.getTouchCancelEvent=function(){return o.getEvent("cancel")},o.isSafari=function(){return o.isDevice&&o.isIos&&o.isTouch&&typeof window<"u"&&window.navigator.userAgent.toLowerCase().indexOf("iphone")===-1&&window.navigator.userAgent.toLowerCase().indexOf("safari")>-1},o.getValue=function(e,t){var i=typeof window<"u"?window.browserDetails:{};return typeof navigator<"u"&&navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1&&o.isTouch===!0&&!mS.CHROME.test(navigator.userAgent)&&(i.isIos=!0,i.isDevice=!0,i.isTouch=!0,i.isPointer=!0,i.isPointer="pointerEnabled"in window.navigator),typeof window<"u"&&window.Capacitor&&window.Capacitor.getPlatform()==="ios"&&(i.isPointer=!1),typeof i[""+e]>"u"?i[""+e]=t.test(o.userAgent):i[""+e]},Object.defineProperty(o,"userAgent",{get:function(){return o.uA},set:function(e){o.uA=e,window.browserDetails={}},enumerable:!0,configurable:!0}),Object.defineProperty(o,"info",{get:function(){return Ee(window.browserDetails.info)?window.browserDetails.info=o.extractBrowserDetail():window.browserDetails.info},enumerable:!0,configurable:!0}),Object.defineProperty(o,"isIE",{get:function(){return o.getValue("isIE",mj)},enumerable:!0,configurable:!0}),Object.defineProperty(o,"isTouch",{get:function(){return Ee(window.browserDetails.isTouch)?window.browserDetails.isTouch="ontouchstart"in window.navigator||window&&window.navigator&&window.navigator.maxTouchPoints>0||"ontouchstart"in window:window.browserDetails.isTouch},enumerable:!0,configurable:!0}),Object.defineProperty(o,"isPointer",{get:function(){return Ee(window.browserDetails.isPointer)?window.browserDetails.isPointer="pointerEnabled"in window.navigator:window.browserDetails.isPointer},enumerable:!0,configurable:!0}),Object.defineProperty(o,"isMSPointer",{get:function(){return Ee(window.browserDetails.isMSPointer)?window.browserDetails.isMSPointer="msPointerEnabled"in window.navigator:window.browserDetails.isMSPointer},enumerable:!0,configurable:!0}),Object.defineProperty(o,"isDevice",{get:function(){return o.getValue("isDevice",vj)},enumerable:!0,configurable:!0}),Object.defineProperty(o,"isIos",{get:function(){return o.getValue("isIos",bj)},enumerable:!0,configurable:!0}),Object.defineProperty(o,"isIos7",{get:function(){return o.getValue("isIos7",Sj)},enumerable:!0,configurable:!0}),Object.defineProperty(o,"isAndroid",{get:function(){return o.getValue("isAndroid",Cj)},enumerable:!0,configurable:!0}),Object.defineProperty(o,"isWebView",{get:function(){return Ee(window.browserDetails.isWebView)&&(window.browserDetails.isWebView=!(Ee(window.cordova)&&Ee(window.PhoneGap)&&Ee(window.phonegap)&&window.forge!=="object")),window.browserDetails.isWebView},enumerable:!0,configurable:!0}),Object.defineProperty(o,"isWindows",{get:function(){return o.getValue("isWindows",wj)},enumerable:!0,configurable:!0}),Object.defineProperty(o,"touchStartEvent",{get:function(){return Ee(window.browserDetails.touchStartEvent)?window.browserDetails.touchStartEvent=o.getTouchStartEvent():window.browserDetails.touchStartEvent},enumerable:!0,configurable:!0}),Object.defineProperty(o,"touchMoveEvent",{get:function(){return Ee(window.browserDetails.touchMoveEvent)?window.browserDetails.touchMoveEvent=o.getTouchMoveEvent():window.browserDetails.touchMoveEvent},enumerable:!0,configurable:!0}),Object.defineProperty(o,"touchEndEvent",{get:function(){return Ee(window.browserDetails.touchEndEvent)?window.browserDetails.touchEndEvent=o.getTouchEndEvent():window.browserDetails.touchEndEvent},enumerable:!0,configurable:!0}),Object.defineProperty(o,"touchCancelEvent",{get:function(){return Ee(window.browserDetails.touchCancelEvent)?window.browserDetails.touchCancelEvent=o.getTouchCancelEvent():window.browserDetails.touchCancelEvent},enumerable:!0,configurable:!0}),o.uA=typeof navigator<"u"?navigator.userAgent:"",o}(),E=function(){function o(){}return o.addOrGetEventData=function(e){return"__eventList"in e?e.__eventList.events:(e.__eventList={},e.__eventList.events=[])},o.add=function(e,t,i,r,n){var s=o.addOrGetEventData(e),a;n?a=Bg(i,n):a=i,r&&(a=a.bind(r));for(var l=t.split(" "),h=0;h<l.length;h++)s.push({name:l[parseInt(h.toString(),10)],listener:i,debounce:a}),B.isIE?e.addEventListener(l[parseInt(h.toString(),10)],a):e.addEventListener(l[parseInt(h.toString(),10)],a,{passive:!1});return a},o.remove=function(e,t,i){for(var r=o.addOrGetEventData(e),n=t.split(" "),s=function(l){var h=-1,u;r&&r.length!==0&&r.some(function(c,d){return c.name===n[parseInt(l.toString(),10)]&&c.listener===i?(h=d,u=c.debounce,!0):!1}),h!==-1&&r.splice(h,1),u&&e.removeEventListener(n[parseInt(l.toString(),10)],u)},a=0;a<n.length;a++)s(a)},o.clearEvents=function(e){for(var t=o.addOrGetEventData(e),i=he([],void 0,t),r=0;r<i.length;r++){var n=i[parseInt(r.toString(),10)];e.removeEventListener(n.name,n.debounce),t.shift()}},o.trigger=function(e,t,i){for(var r=o.addOrGetEventData(e),n=0,s=r;n<s.length;n++){var a=s[n];a.name===t&&a.debounce.call(this,i)}},o}();var Ij=/^svg|^path|^g/;function Xe(o,e){var t=Ij.test(o)?document.createElementNS("http://www.w3.org/2000/svg",o):document.createElement(o);return typeof e>"u"||(t.innerHTML=e.innerHTML?e.innerHTML:"",e.className!==void 0&&(t.className=e.className),e.id!==void 0&&(t.id=e.id),e.styles!==void 0&&(t.style.cssText=e.styles),e.attrs!==void 0&&Ie(t,e.attrs)),t}function Y(o,e){for(var t=uA(e),i=RegExp,r=0,n=o;r<n.length;r++)for(var s=n[r],a=0,l=t;a<l.length;a++){var h=l[a];if(ms(s)){var u=V("attributes.className",s);g(u)?Ge("attributes.className",h,s):new i("\\b"+h+"\\b","i").test(u)||Ge("attributes.className",u+" "+h,s)}else s.classList.contains(h)||s.classList.add(h)}return o}function K(o,e){for(var t=uA(e),i=0,r=o;i<r.length;i++){var n=r[i],s=ms(n),a=s?V("attributes.className",n):n.className!=="";if(a)for(var l=0,h=t;l<h.length;l++){var u=h[l];if(s){var c=V("attributes.className",n),d=c.split(" "),p=d.indexOf(u);p!==-1&&d.splice(p,1),Ge("attributes.className",d.join(" "),n)}else n.classList.remove(u)}}return o}function uA(o){var e=[];return typeof o=="string"?e.push(o):e=o,e}function gr(o){var e=o;return e.style.visibility===""&&e.offsetWidth>0}function jr(o,e,t){for(var i=document.createDocumentFragment(),r=0,n=o;r<n.length;r++){var s=n[r];i.appendChild(s)}return e.insertBefore(i,e.firstElementChild),t&&cA(e),o}function dt(o,e,t){var i=document.createDocumentFragment();if(o instanceof NodeList)for(;o.length>0;)i.appendChild(o[0]);else for(var r=0,n=o;r<n.length;r++){var s=n[r];i.appendChild(s)}return e.appendChild(i),t&&cA(e),o}function cA(o){var e=o.querySelectorAll("script");e.forEach(function(t){var i=document.createElement("script");i.text=t.innerHTML,document.head.appendChild(i),ee(i)})}function ee(o){var e=o.parentNode;if(e)return e.removeChild(o)}function Ue(o){var e=o.parentNode;E.clearEvents(o),e.removeChild(o)}function Ie(o,e){for(var t=Object.keys(e),i=o,r=0,n=t;r<n.length;r++){var s=n[r];if(ms(i)){var a=s;s==="tabindex"&&(a="tabIndex"),i.attributes[""+a]=e[""+s]}else i.setAttribute(s,e[""+s])}return i}function X(o,e,t){return e===void 0&&(e=document),o=dA(o),e.querySelector(o)}function Oe(o,e,t){e===void 0&&(e=document),o=dA(o);var i=e.querySelectorAll(o);return i}function dA(o){var e=/(!|"|\$|%|&|'|\(|\)|\*|\/|:|;|<|=|\?|@|\]|\^|`|{|}|\||\+|~)/g;if(o.match(/#[0-9]/g)||o.match(e)){for(var t=o.split(","),i=0;i<t.length;i++){for(var r=t[parseInt(i.toString(),10)].split(" "),n=0;n<r.length;n++)if(r[parseInt(n.toString(),10)].indexOf("#")>-1&&!r[parseInt(n.toString(),10)].match(/\[.*\]/)){var s=r[parseInt(n.toString(),10)].split("#");if(s[1].match(/^\d/)||s[1].match(e)){var a=r[parseInt(n.toString(),10)].split(".");a[0]=a[0].replace(/#/,"[id='")+"']",r[parseInt(n.toString(),10)]=a.join(".")}}t[parseInt(i.toString(),10)]=r.join(" ")}return t.join(",")}return o}function j(o,e){var t=o;if(typeof t.closest=="function")return t.closest(e);for(;t&&t.nodeType===1;){if(ic(t,e))return t;t=t.parentNode}return null}function Ye(o,e){e!==void 0&&Object.keys(e).forEach(function(t){o.style[""+t]=e[""+t]})}function wi(o,e,t){Y([o],e),K([o],t)}function ic(o,e){var t=o.matches||o.msMatchesSelector||o.webkitMatchesSelector;return t?t.call(o,e):[].indexOf.call(document.querySelectorAll(e),o)!==-1}var Ju=function(){function o(e){this.ranArray=[],this.boundedEvents={},!g(e)&&(this.context=e)}return o.prototype.on=function(e,t,i,r){if(!g(t)){var n=i||this.context;if(this.notExist(e)){this.boundedEvents[""+e]=[{handler:t,context:n,id:r}];return}g(r)?this.isHandlerPresent(this.boundedEvents[""+e],t)||this.boundedEvents[""+e].push({handler:t,context:n}):this.ranArray.indexOf(r)===-1&&(this.ranArray.push(r),this.boundedEvents[""+e].push({handler:t,context:n,id:r}))}},o.prototype.off=function(e,t,i){if(!this.notExist(e)){var r=V(e,this.boundedEvents);if(t){for(var n=0;n<r.length;n++)if(i){if(r[parseInt(n.toString(),10)].id===i){r.splice(n,1);var s=this.ranArray.indexOf(i);s!==-1&&this.ranArray.splice(s,1);break}}else if(t===r[parseInt(n.toString(),10)].handler){r.splice(n,1);break}}else delete this.boundedEvents[""+e]}},o.prototype.notify=function(e,t,i,r){if(this.notExist(e)){i&&i.call(this,t);return}t&&(t.name=e);var n="Blazor",s=V(e,this.boundedEvents).slice(0);if(window[""+n])return this.blazorCallback(s,t,i,r,0);for(var a=0,l=s;a<l.length;a++){var h=l[a];h.handler.call(h.context,t)}i&&i.call(this,t)},o.prototype.blazorCallback=function(e,t,i,r,n){var s=this,a=n===e.length-1;if(n<e.length){var l=e[parseInt(n.toString(),10)],h=l.handler.call(l.context,t);if(h&&typeof h.then=="function"){if(!i)return h;h.then(function(u){if(u=typeof u=="string"&&s.isJson(u)?JSON.parse(u,s.dateReviver):u,he(t,t,u,!0),i&&a)i.call(l.context,t);else return s.blazorCallback(e,t,i,r,n+1)}).catch(function(u){r&&r.call(l.context,typeof u=="string"&&s.isJson(u)?JSON.parse(u,s.dateReviver):u)})}else if(i&&a)i.call(l.context,t);else return this.blazorCallback(e,t,i,r,n+1)}},o.prototype.dateReviver=function(e,t){var i=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/;return qe&&typeof t=="string"&&t.match(i)!==null?new Date(t):t},o.prototype.isJson=function(e){try{JSON.parse(e)}catch{return!1}return!0},o.prototype.destroy=function(){this.boundedEvents=this.context=void 0},o.prototype.offIntlEvents=function(){var e=this.boundedEvents.notifyExternalChange;if(e){for(var t=0;t<e.length;t++){var i=e[parseInt(t.toString(),10)].context;i&&i.detectFunction&&i.randomId&&i.isReactMock&&(this.off("notifyExternalChange",i.detectFunction,i.randomId),t--)}this.boundedEvents.notifyExternalChange.length||delete this.boundedEvents.notifyExternalChange}},o.prototype.notExist=function(e){return Object.prototype.hasOwnProperty.call(this.boundedEvents,e)===!1||this.boundedEvents[""+e].length<=0},o.prototype.isHandlerPresent=function(e,t){for(var i=0,r=e;i<r.length;i++){var n=r[i];if(n.handler===t)return!0}return!1},o}(),Mj=new RegExp("]"),$s=function(){function o(e,t){this.isRendered=!1,this.isComplexArraySetter=!1,this.isServerRendered=!1,this.allowServerDataBinding=!0,this.isProtectedOnChange=!0,this.properties={},this.changedProperties={},this.oldProperties={},this.bulkChanges={},this.refreshing=!1,this.ignoreCollectionWatch=!1,this.finalUpdate=function(){},this.childChangedProperties={},this.modelObserver=new Ju(this),Ee(t)||(typeof t=="string"?this.element=document.querySelector(t):this.element=t,g(this.element)||(this.isProtectedOnChange=!1,this.addInstance())),Ee(e)||this.setProperties(e,!0),this.isDestroyed=!1}return o.prototype.setProperties=function(e,t){var i=this.isProtectedOnChange;this.isProtectedOnChange=!!t,ht(this,e),t!==!0?(ht(this.changedProperties,e),this.dataBind()):qe()&&this.isRendered&&this.serverDataBind(e),this.finalUpdate(),this.changedProperties={},this.oldProperties={},this.isProtectedOnChange=i},o.callChildDataBind=function(e,t){for(var i=Object.keys(e),r=0,n=i;r<n.length;r++){var s=n[r];if(t[""+s]instanceof Array)for(var a=0,l=t[""+s];a<l.length;a++){var h=l[a];h.dataBind!==void 0&&h.dataBind()}else t[""+s].dataBind()}},o.prototype.clearChanges=function(){this.finalUpdate(),this.changedProperties={},this.oldProperties={},this.childChangedProperties={}},o.prototype.dataBind=function(){if(o.callChildDataBind(this.childChangedProperties,this),Object.getOwnPropertyNames(this.changedProperties).length){var e=this.isProtectedOnChange,t=this.changedProperties,i=this.oldProperties;this.clearChanges(),this.isProtectedOnChange=!0,this.onPropertyChanged(t,i),this.isProtectedOnChange=e}},o.prototype.serverDataBind=function(e){if(qe()){e=e||{},he(this.bulkChanges,{},e,!0);var t="sfBlazor";this.allowServerDataBinding&&window[""+t].updateModel&&(window[""+t].updateModel(this),this.bulkChanges={})}},o.prototype.saveChanges=function(e,t,i){if(qe()){var r={};r[""+e]=t,this.serverDataBind(r)}this.isProtectedOnChange||(this.oldProperties[""+e]=i,this.changedProperties[""+e]=t,this.finalUpdate(),this.finalUpdate=lj(this.dataBind.bind(this)))},o.prototype.addEventListener=function(e,t){this.modelObserver.on(e,t)},o.prototype.removeEventListener=function(e,t){this.modelObserver.off(e,t)},o.prototype.trigger=function(e,t,i,r){var n=this;if(this.isDestroyed!==!0){var s=this.isProtectedOnChange;this.isProtectedOnChange=!1;var a=this.modelObserver.notify(e,t,i,r);if(Mj.test(e)){var l=V(e,this);if(l){var h="Blazor";if(window[""+h]){var u=l.call(this,t);u&&typeof u.then=="function"?i?u.then(function(c){i&&(c=typeof c=="string"&&n.modelObserver.isJson(c)?JSON.parse(c):c,i.call(n,c))}).catch(function(c){r&&(c=typeof c=="string"&&n.modelObserver.isJson(c)?JSON.parse(c):c,r.call(n,c))}):a=u:i&&i.call(this,t)}else l.call(this,t),i&&i.call(this,t)}else i&&i.call(this,t)}return this.isProtectedOnChange=s,a}},o.prototype.addInstance=function(){var e="e-"+this.getModuleName().toLowerCase();Y([this.element],["e-lib",e]),g(this.element.ej2_instances)?Ge("ej2_instances",[this],this.element):this.element.ej2_instances.push(this)},o.prototype.destroy=function(){var e=this;this.element.ej2_instances=this.element.ej2_instances?this.element.ej2_instances.filter(function(t){return yS?yS(t)!==yS(e):t!==e}):[],K([this.element],["e-"+this.getModuleName()]),this.element.ej2_instances.length===0&&K([this.element],["e-lib"]),this.clearChanges(),this.modelObserver.destroy(),this.isDestroyed=!0},o}();function at(o,e){var t,i,r=typeof o=="string"?document.getElementById(o):o;for(i=0;i<r.ej2_instances.length;i++)if(t=r.ej2_instances[parseInt(i.toString(),10)],typeof e=="string"){var n=t.getModuleName();if(e===n)return t}else if(t instanceof e)return t}var yS;function pA(o,e,t,i){return(!Object.prototype.hasOwnProperty.call(o.properties,e)||!(o.properties[""+e]instanceof i))&&(o.properties[""+e]=Pg(i,[o,e,t])),o.properties[""+e]}function xS(o,e,t,i,r,n){for(var s=[],a=t?t.length:0,l=0;l<a;l++){var h=i;if(n&&(h=i(t[parseInt(l.toString(),10)],o)),r){var u=Pg(h,[o,e,{},!0]);u.setProperties(t[parseInt(l.toString(),10)],!0),s.push(u)}else s.push(Pg(h,[o,e,t[parseInt(l.toString(),10)],!1]))}return s}function fA(o,e){return function(){return Object.prototype.hasOwnProperty.call(this.properties,e)||(this.properties[""+e]=o),this.properties[""+e]}}function Dj(o,e){return function(t){if(this.properties[""+e]!==t){var i=Object.prototype.hasOwnProperty.call(this.properties,e)?this.properties[""+e]:o;this.saveChanges(e,t,i),this.properties[""+e]=t}}}function Ej(o,e,t){return function(){return pA(this,e,o,t)}}function Aj(o,e,t){return function(i){pA(this,e,o,t).setProperties(i)}}function Tj(o,e,t){return function(){var i=this;if(!Object.prototype.hasOwnProperty.call(this.properties,e)){var r=xS(this,e,o,t,!1);this.properties[""+e]=r}var n=this.controlParent!==void 0&&this.controlParent.ignoreCollectionWatch||this.ignoreCollectionWatch;return!Object.prototype.hasOwnProperty.call(this.properties[""+e],"push")&&!n&&["push","pop"].forEach(function(s){var a={value:kj(s,e,t,i.properties[""+e]).bind(i),configurable:!0};Object.defineProperty(i.properties[""+e],s,a)}),Object.prototype.hasOwnProperty.call(this.properties[""+e],"isComplexArray")||Object.defineProperty(this.properties[""+e],"isComplexArray",{value:!0}),this.properties[""+e]}}function Lj(o,e,t){return function(i){this.isComplexArraySetter=!0;var r=xS(this,e,o,t,!1),n=xS(this,e,i,t,!0);this.isComplexArraySetter=!1,this.saveChanges(e,n,r),this.properties[""+e]=n}}function kj(o,e,t,i){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var s=this.propName?this.getParentKey()+"."+e+"-":e+"-";switch(o){case"push":for(var a=0;a<r.length;a++){var l=r[parseInt(a.toString(),10)];Array.prototype[""+o].apply(i,[l]);var h=WE(s+(i.length-1),l,!this.controlParent,o);this.serverDataBind(h,r[parseInt(a.toString(),10)],!1,o)}break;case"pop":{Array.prototype[""+o].apply(i);var h=WE(s+i.length,null,!this.controlParent,o);this.serverDataBind(h,{ejsAction:"pop"},!1,o);break}}return i}}function WE(o,e,t,i){var r=o;if(t&&(r={},r[""+o]=e,e&&typeof e=="object")){var n="ejsAction";r[""+o][""+n]=i}return r}function C(o){return function(e,t){var i={set:Dj(o,t),get:fA(o,t),enumerable:!0,configurable:!0};Object.defineProperty(e,t,i),Hg(e,t,"prop",o)}}function be(o,e){return function(t,i){var r={set:Aj(o,i,e),get:Ej(o,i,e),enumerable:!0,configurable:!0};Object.defineProperty(t,i,r),Hg(t,i,"complexProp",o,e)}}function Wt(o,e){return function(t,i){var r={set:Lj(o,i,e),get:Tj(o,i,e),enumerable:!0,configurable:!0};Object.defineProperty(t,i,r),Hg(t,i,"colProp",o,e)}}function q(){return function(o,e){var t={set:function(i){var r=this.properties[""+e];if(r!==i){var n=gA(this,e);Ee(r)===!1&&n.context.removeEventListener(n.prefix,r),n.context.addEventListener(n.prefix,i),this.properties[""+e]=i}},get:fA(void 0,e),enumerable:!0,configurable:!0};Object.defineProperty(o,e,t),Hg(o,e,"event")}}function bt(o){}function Hg(o,e,t,i,r){Ee(o.propList)&&(o.propList={props:[],complexProps:[],colProps:[],events:[],propNames:[],complexPropNames:[],colPropNames:[],eventNames:[]}),o.propList[t+"s"].push({propertyName:e,defaultValue:i,type:r}),o.propList[t+"Names"].push(e)}function gA(o,e){if(Object.prototype.hasOwnProperty.call(o,"parentObj")===!1)return{context:o,prefix:e};var t=V("propName",o);return t&&(e=t+"-"+e),gA(V("parentObj",o),e)}var Nj=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ho=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},It=function(o){Nj(e,o);function e(i){var r=o.call(this,i,void 0)||this;return r.easing={ease:"cubic-bezier(0.250, 0.100, 0.250, 1.000)",linear:"cubic-bezier(0.250, 0.250, 0.750, 0.750)",easeIn:"cubic-bezier(0.420, 0.000, 1.000, 1.000)",easeOut:"cubic-bezier(0.000, 0.000, 0.580, 1.000)",easeInOut:"cubic-bezier(0.420, 0.000, 0.580, 1.000)",elasticInOut:"cubic-bezier(0.5,-0.58,0.38,1.81)",elasticIn:"cubic-bezier(0.17,0.67,0.59,1.81)",elasticOut:"cubic-bezier(0.7,-0.75,0.99,1.01)"},r}t=e,e.prototype.animate=function(i,r){r=r||{};var n=this.getModel(r);if(typeof i=="string")for(var s=Array.prototype.slice.call(Oe(i,document)),a=0,l=s;a<l.length;a++){var h=l[a];n.element=h,t.delayAnimation(n)}else n.element=i,t.delayAnimation(n)},e.stop=function(i,r){i.style.animation="",i.removeAttribute("e-animate");var n=i.getAttribute("e-animation-id");if(n){var s=parseInt(n,10);cancelAnimationFrame(s),i.removeAttribute("e-animation-id")}r&&r.end&&r.end.call(this,r)},e.delayAnimation=function(i){Ut==="Disable"||Ut===yA.Disable?(i.begin&&i.begin.call(this,i),i.end&&i.end.call(this,i)):i.delay?setTimeout(function(){t.applyAnimation(i)},i.delay):t.applyAnimation(i)},e.applyAnimation=function(i){var r=this;i.timeStamp=0;var n=0,s=0,a=0,l=i.duration;i.element.setAttribute("e-animate","true");var h=function(u){try{if(u){a=a===0?u:a,i.timeStamp=u+i.timeStamp-a,a=u,!n&&i.begin&&i.begin.call(r,i),n=n+1;var c=i.timeStamp/n;i.timeStamp<l&&i.timeStamp+c<l&&i.element.getAttribute("e-animate")?(i.element.style.animation=i.name+" "+i.duration+"ms "+i.timingFunction,i.progress&&i.progress.call(r,i),requestAnimationFrame(h)):(cancelAnimationFrame(s),i.element.removeAttribute("e-animation-id"),i.element.removeAttribute("e-animate"),i.element.style.animation="",i.end&&i.end.call(r,i))}else s=requestAnimationFrame(h),i.element.setAttribute("e-animation-id",s.toString())}catch(d){cancelAnimationFrame(s),i.element.removeAttribute("e-animation-id"),i.fail&&i.fail.call(r,d)}};h()},e.prototype.getModel=function(i){return{name:i.name||this.name,delay:i.delay||this.delay,duration:i.duration!==void 0?i.duration:this.duration,begin:i.begin||this.begin,end:i.end||this.end,fail:i.fail||this.fail,progress:i.progress||this.progress,timingFunction:this.easing[i.timingFunction]?this.easing[i.timingFunction]:i.timingFunction||this.easing[this.timingFunction]}},e.prototype.onPropertyChanged=function(i,r){},e.prototype.getModuleName=function(){return"animation"},e.prototype.destroy=function(){};var t;return Ho([C("FadeIn")],e.prototype,"name",void 0),Ho([C(400)],e.prototype,"duration",void 0),Ho([C("ease")],e.prototype,"timingFunction",void 0),Ho([C(0)],e.prototype,"delay",void 0),Ho([q()],e.prototype,"progress",void 0),Ho([q()],e.prototype,"begin",void 0),Ho([q()],e.prototype,"end",void 0),Ho([q()],e.prototype,"fail",void 0),e=t=Ho([bt],e),e}($s);function Vi(o,e,t){var i=Fj(e);return i.rippleFlag===!1||i.rippleFlag===void 0&&!ka?function(){}:(o.setAttribute("data-ripple","true"),E.add(o,"mousedown",qE,{parent:o,rippleOptions:i}),E.add(o,"mouseup",GE,{parent:o,rippleOptions:i,done:t}),E.add(o,"mouseleave",Zu,{parent:o,rippleOptions:i}),B.isPointer&&E.add(o,"transitionend",Zu,{parent:o,rippleOptions:i}),function(){o.removeAttribute("data-ripple"),E.remove(o,"mousedown",qE),E.remove(o,"mouseup",GE),E.remove(o,"mouseleave",Zu),E.remove(o,"transitionend",Zu)})}function Fj(o){var e={selector:o&&o.selector?o.selector:null,ignore:o&&o.ignore?o.ignore:null,rippleFlag:o&&o.rippleFlag,isCenterRipple:o&&o.isCenterRipple,duration:o&&o.duration?o.duration:350};return e}function qE(o){var e=o.target,t=this.rippleOptions.selector,i=t?j(e,t):e;if(!(!i||this.rippleOptions&&j(e,this.rippleOptions.ignore))){var r=i.getBoundingClientRect(),n=o.pageX-document.body.scrollLeft,s=o.pageY-(!document.body.scrollTop&&document.documentElement?document.documentElement.scrollTop:document.body.scrollTop),a=Math.max(Math.abs(n-r.left),Math.abs(n-r.right)),l=Math.max(Math.abs(s-r.top),Math.abs(s-r.bottom)),h=Math.sqrt(a*a+l*l),u=h*2+"px",c=n-r.left-h,d=s-r.top-h;this.rippleOptions&&this.rippleOptions.isCenterRipple&&(c=0,d=0,u="100%"),i.classList.add("e-ripple");var p=this.rippleOptions.duration.toString(),f="width: "+u+";height: "+u+";left: "+c+"px;top: "+d+"px;transition-duration: "+p+"ms;",v=Xe("div",{className:"e-ripple-element",styles:f});i.appendChild(v),window.getComputedStyle(v).getPropertyValue("opacity"),v.style.transform="scale(1)",i!==this.parent&&E.add(i,"mouseleave",Zu,{parent:this.parent,rippleOptions:this.rippleOptions})}}function GE(o){vA(o,this)}function Zu(o){vA(o,this)}function vA(o,e){var t=e.rippleOptions.duration,i=o.target,r=e.rippleOptions.selector,n=r?j(i,r):i;if(!(!n||n&&n.className.indexOf("e-ripple")===-1)){var s=Oe(".e-ripple-element",n),a=s[s.length-1];a&&(a.style.opacity="0.5"),e.parent!==n&&E.remove(n,"mouseleave",Zu),setTimeout(function(){a&&a.parentNode&&a.parentNode.removeChild(a),n.getElementsByClassName("e-ripple-element").length||n.classList.remove("e-ripple"),e.done&&e.done(o)},t)}}var ka=!1;function mA(o){return ka=o,ka}var Ut;var yA=function(o){return o.Default="Default",o.Enable="Enable",o.Disable="Disable",o}(yA||{}),Oj="Module",Rj=function(){function o(e){this.loadedModules=[],this.parent=e}return o.prototype.inject=function(e,t){var i=e.length;if(i===0){this.clean();return}this.loadedModules.length&&this.clearUnusedModule(e);for(var r=0;r<i;r++)for(var n=e[parseInt(r.toString(),10)],s=0,a=t;s<a.length;s++){var l=a[s],h=n.member;if(l&&l.prototype.getModuleName()===n.member&&!this.isModuleLoaded(h)){var u=Pg(l,n.args),c=this.getMemberName(h);n.isProperty?Ge(c,l,this.parent):Ge(c,u,this.parent);var d=n;d.member=c,this.loadedModules.push(d)}}},o.prototype.clean=function(){for(var e=0,t=this.loadedModules;e<t.length;e++){var i=t[e];i.isProperty||V(i.member,this.parent).destroy()}this.loadedModules=[]},o.prototype.getNonInjectedModules=function(e){var t=this;return e.filter(function(i){return!t.isModuleLoaded(i.member)})},o.prototype.clearUnusedModule=function(e){for(var t=this,i=e.map(function(l){return t.getMemberName(l.member)}),r=this.loadedModules.filter(function(l){return i.indexOf(l.member)===-1}),n=0,s=r;n<s.length;n++){var a=s[n];a.isProperty||V(a.member,this.parent).destroy(),this.loadedModules.splice(this.loadedModules.indexOf(a),1),ip(this.parent,a.member)}},o.prototype.getMemberName=function(e){return e[0].toLowerCase()+e.substring(1)+Oj},o.prototype.isModuleLoaded=function(e){for(var t=0,i=this.loadedModules;t<i.length;t++){var r=i[t];if(r.member===this.getMemberName(e))return!0}return!1},o}(),Re=function(){function o(e,t,i,r){this.isComplexArraySetter=!1,this.properties={},this.changedProperties={},this.childChangedProperties={},this.oldProperties={},this.finalUpdate=function(){},this.callChildDataBind=V("callChildDataBind",$s),this.parentObj=e,this.controlParent=this.parentObj.controlParent||this.parentObj,this.propName=t,this.isParentArray=r,this.setProperties(i,!0)}return o.prototype.updateChange=function(e,t){e===!0?this.parentObj.childChangedProperties[""+t]=e:delete this.parentObj.childChangedProperties[""+t],this.parentObj.updateChange&&this.parentObj.updateChange(e,this.parentObj.propName)},o.prototype.updateTimeOut=function(){if(this.parentObj.updateTimeOut)this.parentObj.finalUpdate(),this.parentObj.updateTimeOut();else{var e=setTimeout(this.parentObj.dataBind.bind(this.parentObj)),t=function(){clearTimeout(e)};this.finalUpdate=t}},o.prototype.clearChanges=function(){this.finalUpdate(),this.updateChange(!1,this.propName),this.oldProperties={},this.changedProperties={}},o.prototype.setProperties=function(e,t){t===!0?(ht(this,e),this.updateChange(!1,this.propName),this.clearChanges()):ht(this,e)},o.prototype.dataBind=function(){if(this.callChildDataBind(this.childChangedProperties,this),this.isParentArray){var e=this.parentObj[this.propName].indexOf(this);Object.keys(this.changedProperties).length&&(Ge(this.propName+"."+e,this.changedProperties,this.parentObj.changedProperties),Ge(this.propName+"."+e,this.oldProperties,this.parentObj.oldProperties))}else this.parentObj.changedProperties[this.propName]=this.changedProperties,this.parentObj.oldProperties[this.propName]=this.oldProperties;this.clearChanges()},o.prototype.saveChanges=function(e,t,i,r){this.controlParent.isProtectedOnChange||(r||this.serverDataBind(e,t,!0),this.oldProperties[""+e]=i,this.changedProperties[""+e]=t,this.updateChange(!0,this.propName),this.finalUpdate(),this.updateTimeOut())},o.prototype.serverDataBind=function(e,t,i,r){if(qe()&&!this.parentObj.isComplexArraySetter){var n,s={},a=i?this.getParentKey(!0)+"."+e:e;if(a.indexOf(".")!==-1){var l=a.split(".");n=s;for(var h=0;h<l.length;h++){var u=h===l.length-1;n[l[parseInt(h.toString(),10)]]=u?t:{},n=u?n:n[l[parseInt(h.toString(),10)]]}}else s[""+a]={},n=s[""+a],s[""+a][""+e]=t;if(this.isParentArray){var c="ejsAction";n[""+c]=r||"none"}this.controlParent.serverDataBind(s)}},o.prototype.getParentKey=function(e){var t="",i=this.propName;if(this.isParentArray){t=this.parentObj[this.propName].indexOf(this);var r=this.parentObj[this.propName].length;r=e?r:r>0?r-1:0,t=t!==-1?"-"+t:"-"+r,i=i+t}return this.controlParent!==this.parentObj&&(i=this.parentObj.getParentKey()+"."+this.propName+t),i},o}(),ec;(function(o){var e=[28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990];function t(r){var n=r.getDate(),s=r.getMonth(),a=r.getFullYear(),l=s+1,h=a;l<3&&(h-=1,l+=12);var u=Math.floor(h/100),c=u-Math.floor(u/4)-2,d=Math.floor(365.25*(h+4716))+Math.floor(30.6001*(l+1))+n-c-1524;u=Math.floor((d-186721625e-2)/36524.25),c=u-Math.floor(u/4)+1;var p=d+c+1524,f=Math.floor((p-122.1)/365.25),v=Math.floor(365.25*f),m=Math.floor((p-v)/30.6001);n=p-v-Math.floor(30.6001*m),s=Math.floor((p-v)/20.6001),s>13&&(f+=1,s-=12),s-=1,a=f-4716;var y=d-24e5,S=10631/30,b=d-1948084,w=Math.floor(b/10631);b=b-10631*w;var I=Math.floor((b-.1335)/S),x=30*w+I;b=b-Math.floor(I*S+.1335);var M=Math.floor((b+28.5001)/29.5);M===13&&(M=12);for(var D=b-Math.floor(29.5001*M-29),A=0;A<e.length&&!(e[parseInt(A.toString(),10)]>y);A++);var L=A+16260,T=Math.floor((L-1)/12),k=T+1,F=L-12*T,R=y-e[A-1]+1;return(R+"").length>2&&(R=D,F=M,k=x),{year:k,month:F,date:R}}o.getHijriDate=t;function i(r,n,s){var a=r,l=n,h=s,u=a-1,c=u*12+1+(l-1),d=c-16260,p=h+e[d-1]-1,f=p+24e5,v=Math.floor(f+.5),m=Math.floor((v-186721625e-2)/36524.25);m=v+1+m-Math.floor(m/4);var y=m+1524,S=Math.floor((y-122.1)/365.25),b=Math.floor(365.25*S),w=Math.floor((y-b)/30.6001),I=y-b-Math.floor(w*30.6001),x=w-(w>13.5?13:1),M=S-(x>2.5?4716:4715);return M<=0&&x--,new Date(M+"/"+x+"/"+I)}o.toGregorian=i})(ec||(ec={}));var Pj=/\/MMMMM|MMMM|MMM|a|LLLL|LLL|EEEEE|EEEE|E|K|cccc|ccc|WW|W|G+|z+/gi,YE="stand-alone",Bj=["sun","mon","tue","wed","thu","fri","sat"],QE={m:"getMinutes",h:"getHours",H:"getHours",s:"getSeconds",d:"getDate",f:"getMilliseconds"},zj={M:"month",d:"day",E:"weekday",c:"weekday",y:"year",m:"minute",h:"hour",H:"hour",s:"second",L:"month",a:"designator",z:"timeZone",Z:"timeZone",G:"era",f:"milliseconds"},jj="timeSeparator",bA=function(){function o(){}return o.dateFormat=function(e,t,i){var r=this,n=nt.getDependables(i,e,t.calendar),s=V("parserObject.numbers",n),a=n.dateObject,l={isIslamic:nt.islamicRegex.test(t.calendar)};l.firstDayOfWeek=nt.getWeekData(e,i),qe()&&t.isServerRendered&&(t=nt.compareBlazorDateFormats(t,e));var h=t.format||nt.getResultantPattern(t.skeleton,n.dateObject,t.type,!1,qe()?e:"");if(l.dateSeperator=qe()?V("dateSeperator",a):nt.getDateSeparator(n.dateObject),Ee(h))Dh("Format options or type given must be invalid");else{h=nt.ConvertDateToWeekFormat(h),qe()&&(h=h.replace(/tt/,"a")),l.pattern=h,l.numMapper=qe()?he({},s):pr.getNumberMapper(n.parserObject,pr.getNumberingSystem(i));for(var u=h.match(Pj)||[],c=0,d=u;c<d.length;c++){var p=d[c],f=p.length,v=p[0];switch(v==="K"&&(v="h"),v){case"E":case"c":qe()?l.weekday=V("days."+nt.monthIndex[""+f],a):l.weekday=n.dateObject[""+nt.days][""+YE][nt.monthIndex[""+f]];break;case"M":case"L":qe()?l.month=V("months."+nt.monthIndex[""+f],a):l.month=n.dateObject[""+nt.month][""+YE][nt.monthIndex[""+f]];break;case"a":l.designator=qe()?V("dayPeriods",a):V("dayPeriods.format.wide",a);break;case"G":{var m=f<=3?"eraAbbr":f===4?"eraNames":"eraNarrow";l.era=qe()?V("eras",a):V("eras."+m,n.dateObject);break}case"z":l.timeZone=V("dates.timeZoneNames",n.parserObject);break}}}return function(y){return isNaN(y.getDate())?null:r.intDateFormatter(y,l)}},o.intDateFormatter=function(e,t){for(var i=t.pattern,r="",n=i.match(nt.dateParseRegex),s=this.getCurrentDateValue(e,t.isIslamic),a=0,l=n;a<l.length;a++){var h=l[a],u=h.length,c=h[0];c==="K"&&(c="h");var d=void 0,p="",f=void 0,v=void 0,m="";switch(c){case"M":case"L":d=s.month,u>2?r+=t.month[""+d]:f=!0;break;case"E":case"c":r+=t.weekday[""+Bj[e.getDay()]];break;case"H":case"h":case"m":case"s":case"d":case"f":if(f=!0,c==="d")d=s.date;else if(c==="f"){f=!1,v=!0,p=e[""+QE[""+c]]().toString(),p=p.substring(0,u);var y=p.length;if(u!==y){if(u>3)continue;for(var S=0;S<u-y;S++)p="0"+p.toString()}m+=p}else d=e[""+QE[""+c]]();c==="h"&&(d=d%12||12);break;case"y":v=!0,m+=s.year,u===2&&(m=m.substr(m.length-2));break;case"a":{var b=e.getHours()<12?"am":"pm";r+=t.designator[""+b];break}case"G":{var w=e.getFullYear()<0?0:1,I=t.era[""+w];g(I)&&(I=t.era[w?0:1]),r+=I||"";break}case"'":r+=h==="''"?"'":h.replace(/'/g,"");break;case"z":{var x=e.getTimezoneOffset(),M=u<4?"+H;-H":t.timeZone.hourFormat;M=M.replace(/:/g,t.numMapper.timeSeparator),x===0?r+=t.timeZone.gmtZeroFormat:(v=!0,m=this.getTimeZoneValue(x,M)),m=t.timeZone.gmtFormat.replace(/\{0\}/,m);break}case":":r+=t.numMapper.numberSymbols[""+jj];break;case"/":r+=t.dateSeperator;break;case"W":f=!0,d=nt.getWeekOfYear(e,t.firstDayOfWeek);break;default:r+=h}f&&(v=!0,m=this.checkTwodigitNumber(d,u)),v&&(r+=pr.convertValueParts(m,nt.latnParseRegex,t.numMapper.mapper))}return r},o.getCurrentDateValue=function(e,t){return t?ec.getHijriDate(e):{year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate()}},o.checkTwodigitNumber=function(e,t){var i=e+"";return t===2&&i.length!==2?"0"+i:i},o.getTimeZoneValue=function(e,t){var i=this,r=t.split(";"),n=r[e>0?1:0],s=Math.abs(e);return n=n.replace(/HH?|mm/g,function(a){var l=a.length,h=a.indexOf("H")!==-1;return i.checkTwodigitNumber(Math.floor(h?s/60:s%60),l)})},o}();gj(bA);var XE={ms:"minimumSignificantDigits",ls:"maximumSignificantDigits",mf:"minimumFractionDigits",lf:"maximumFractionDigits"},Hj="percentSign",Vj="minusSign",Xu=["infinity","nan","group","decimal","exponential"],SA=function(){function o(){}return o.numberFormatter=function(e,t,i){var r=this,n=he({},t),s={},a={},l,h=nt.getDependables(i,e,"",!0),u=h.numericObject;a.numberMapper=qe()?he({},u):pr.getNumberMapper(h.parserObject,pr.getNumberingSystem(i),!0),a.currencySymbol=qe()?V("currencySymbol",u):nt.getCurrencySymbol(h.numericObject,n.currency||ts,t.altSymbol,t.ignoreCurrency),a.percentSymbol=qe()?V("numberSymbols.percentSign",u):a.numberMapper.numberSymbols[""+Hj],a.minusSymbol=qe()?V("numberSymbols.minusSign",u):a.numberMapper.numberSymbols[""+Vj];var c=a.numberMapper.numberSymbols;if(t.format&&!nt.formatRegex.test(t.format))s=nt.customFormat(t.format,a,h.numericObject),!Ee(n.useGrouping)&&n.useGrouping&&(n.useGrouping=s.pData.useGrouping);else{if(he(n,nt.getProperNumericSkeleton(t.format||"N")),n.isCurrency=n.type==="currency",n.isPercent=n.type==="percent",qe()||(l=nt.getSymbolPattern(n.type,a.numberMapper.numberSystem,h.numericObject,n.isAccount)),n.groupOne=this.checkValueRange(n.maximumSignificantDigits,n.minimumSignificantDigits,!0),this.checkValueRange(n.maximumFractionDigits,n.minimumFractionDigits,!1,!0),Ee(n.fractionDigits)||(n.minimumFractionDigits=n.maximumFractionDigits=n.fractionDigits),Ee(n.useGrouping)&&(n.useGrouping=!0),n.isCurrency&&!qe()&&(l=l.replace(/\u00A4/g,nt.defaultCurrency)),qe())s.nData=he({},{},V(n.type+"nData",u)),s.pData=he({},{},V(n.type+"pData",u)),n.type==="currency"&&t.currency&&nt.replaceBlazorCurrency([s.pData,s.nData],a.currencySymbol,t.currency);else{var d=l.split(";");s.nData=nt.getFormatData(d[1]||"-"+d[0],!0,a.currencySymbol),s.pData=nt.getFormatData(d[0],!1,a.currencySymbol),n.useGrouping&&(n.groupSeparator=c[Xu[2]],n.groupData=this.getGroupingDetails(d[0]))}var p=Ee(n.minimumFractionDigits);if(p&&(n.minimumFractionDigits=s.nData.minimumFraction),Ee(n.maximumFractionDigits)){var f=s.nData.maximumFraction;n.maximumFractionDigits=Ee(f)&&n.isPercent?0:f}var v=n.minimumFractionDigits,m=n.maximumFractionDigits;!Ee(v)&&!Ee(m)&&v>m&&(n.maximumFractionDigits=v)}return he(s.nData,n),he(s.pData,n),function(y){return isNaN(y)?c[Xu[1]]:isFinite(y)?r.intNumberFormatter(y,s,a,t):c[Xu[0]]}},o.getGroupingDetails=function(e){var t={},i=e.match(nt.negativeDataRegex);if(i&&i[4]){var r=i[4],n=r.lastIndexOf(",");if(n!==-1){var s=r.split(".")[0];t.primary=s.length-n-1;var a=r.lastIndexOf(",",n-1);a!==-1&&(t.secondary=n-1-a)}}return t},o.checkValueRange=function(e,t,i,r){var n=r?"f":"s",s=0,a=XE["l"+n],l=XE["m"+n];if(Ee(e)||(this.checkRange(e,a,r),s++),Ee(t)||(this.checkRange(t,l,r),s++),s===2)if(e<t)Dh(l+"specified must be less than the"+a);else return!0;else i&&s===1&&Dh("Both"+l+"and"+l+"must be present");return!1},o.checkRange=function(e,t,i){var r=i?[0,20]:[1,21];(e<r[0]||e>r[1])&&Dh(t+"value must be within the range"+r[0]+"to"+r[1])},o.intNumberFormatter=function(e,t,i,r){var n;if(!Ee(t.nData.type)){e<0?(e=e*-1,n=t.nData):e===0?n=t.zeroData||t.pData:n=t.pData;var s="";if(n.isPercent&&(e=e*100),n.groupOne)s=this.processSignificantDigits(e,n.minimumSignificantDigits,n.maximumSignificantDigits);else if(s=this.processFraction(e,n.minimumFractionDigits,n.maximumFractionDigits,r),n.minimumIntegerDigits&&(s=this.processMinimumIntegers(s,n.minimumIntegerDigits)),i.isCustomFormat&&n.minimumFractionDigits<n.maximumFractionDigits&&/\d+\.\d+/.test(s)){for(var a=s.split("."),l=a[1],h=l.length,u=h-1;u>=0&&(l[parseInt(u.toString(),10)]==="0"&&u>=n.minimumFractionDigits);u--)l=l.slice(0,u);s=a[0]+"."+l}return n.type==="scientific"&&(s=e.toExponential(n.maximumFractionDigits),s=s.replace("e",i.numberMapper.numberSymbols[Xu[4]])),s=s.replace(".",i.numberMapper.numberSymbols[Xu[3]]),s=n.format==="#,###,,;(#,###,,)"?this.customPivotFormat(parseInt(s,10)):s,n.useGrouping&&(s=this.groupNumbers(s,n.groupData.primary,n.groupSeparator||",",i.numberMapper.numberSymbols[Xu[3]]||".",n.groupData.secondary)),s=pr.convertValueParts(s,nt.latnParseRegex,i.numberMapper.mapper),n.nlead==="N/A"?n.nlead:s==="0"&&r&&r.format==="0"?s+n.nend:n.nlead+s+n.nend}},o.processSignificantDigits=function(e,t,i){var r=e+"",n,s=r.length;return s<t?e.toPrecision(t):(r=e.toPrecision(i),n=+r,n+"")},o.groupNumbers=function(e,t,i,r,n){for(var s=!g(n)&&n!==0,a=e.split(r),l=a[0],h=l.length,u="";h>t;)u=l.slice(h-t,h)+(u.length?i+u:""),h-=t,s&&(t=n,s=!1);return a[0]=l.slice(0,h)+(u.length?i:"")+u,a.join(r)},o.processFraction=function(e,t,i,r){var n=(e+"").split(".")[1],s=n?n.length:0;if(t&&s<t){var a="";if(s===0)a=e.toFixed(t);else{a+=e;for(var l=0;l<t-s;l++)a+="0";return a}return e.toFixed(t)}else if(!g(i)&&(s>i||i===0))return e.toFixed(i);var h=e+"";return h[0]==="0"&&r&&r.format==="###.00"&&(h=h.slice(1)),h},o.processMinimumIntegers=function(e,t){var i=e.split("."),r=i[0],n=r.length;if(n<t){for(var s=0;s<t-n;s++)r="0"+r;i[0]=r}return i.join(".")},o.customPivotFormat=function(e){if(e>=5e5){e/=1e6;var t=e.toString().split("."),i=t[0],r=t[1];return r&&+r.substring(0,1)>=5?Math.ceil(e).toString():Math.floor(e).toString()}return""},o}();fj(SA);var $E="stand-alone",_j=/^[0-9]*$/,KE={minute:"setMinutes",hour:"setHours",second:"setSeconds",day:"setDate",month:"setMonth",milliseconds:"setMilliseconds"},Uj="months",Wj=function(){function o(){}return o.dateParser=function(e,t,i){var r=this,n=nt.getDependables(i,e,t.calendar),s=pr.getCurrentNumericOptions(n.parserObject,pr.getNumberingSystem(i),!1,qe()),a={};qe()&&t.isServerRendered&&(t=nt.compareBlazorDateFormats(t,e));var l=t.format||nt.getResultantPattern(t.skeleton,n.dateObject,t.type,!1,qe()?e:""),h="",u;if(Ee(l))Dh("Format options or type given must be invalid");else{l=nt.ConvertDateToWeekFormat(l),a={isIslamic:nt.islamicRegex.test(t.calendar),pattern:l,evalposition:{},culture:e};for(var c=l.match(nt.dateParseRegex)||[],d=c.length,p=0,f=0,v=!1,m=s.numericRegex,y=qe()?n.parserObject.numbers:pr.getNumberMapper(n.parserObject,pr.getNumberingSystem(i)),S=0;S<d;S++){var b=c[parseInt(S.toString(),10)],w=b.length,I=b[0]==="K"?"h":b[0],x=void 0,M=void 0,D=zj[""+I],A=w===2?"":"?";switch(v&&(p=f,v=!1),I){case"E":case"c":{var L=void 0;qe()?L=V("days."+nt.monthIndex[""+w],n.dateObject):L=n.dateObject[""+nt.days][""+$E][nt.monthIndex[""+w]];var T=pr.reverseObject(L);h+="("+Object.keys(T).join("|")+")";break}case"M":case"L":case"d":case"m":case"s":case"h":case"H":case"f":if(M=!0,(I==="M"||I==="L")&&w>2){var k=void 0;qe()?k=V("months."+nt.monthIndex[""+w],n.dateObject):k=n.dateObject[""+Uj][""+$E][nt.monthIndex[""+w]],a[""+D]=pr.reverseObject(k),h+="("+Object.keys(a[""+D]).join("|")+")"}else if(I==="f"){if(w>3)continue;x=!0,h+="("+m+m+"?"+m+"?)"}else x=!0,h+="("+m+m+A+")";I==="h"&&(a.hour12=!0);break;case"W":{var F=w===1?"?":"";h+="("+m+F+m+")";break}case"y":M=x=!0,w===2?h+="("+m+m+")":h+="("+m+"{"+w+",})";break;case"a":{M=!0;var R=qe()?V("dayPeriods",n.dateObject):V("dayPeriods.format.wide",n.dateObject);a[""+D]=pr.reverseObject(R),h+="("+Object.keys(a[""+D]).join("|")+")";break}case"G":{M=!0;var N=w<=3?"eraAbbr":w===4?"eraNames":"eraNarrow";a[""+D]=pr.reverseObject(qe()?V("eras",n.dateObject):V("eras."+N,n.dateObject)),h+="("+Object.keys(a[""+D]).join("|")+"?)";break}case"z":{var P=new Date().getTimezoneOffset();M=P!==0,a[""+D]=V("dates.timeZoneNames",n.parserObject);var O=a[""+D];u=w<4;var z=u?"+H;-H":O.hourFormat;z=z.replace(/:/g,y.timeSeparator),h+="("+this.parseTimeZoneRegx(z,O,m)+")?",v=!0,f=u?6:12;break}case"'":{var H=b.replace(/'/g,"");h+="("+H+")?";break}default:h+="([\\D])";break}if(M&&(a.evalposition[""+D]={isNumber:x,pos:S+1+p,hourOnly:u}),S===d-1&&!g(h)){var Q=RegExp;a.parserRegex=new Q("^"+h+"$","i")}}}return function($){var U=r.internalDateParse($,a,s);if(g(U)||!Object.keys(U).length)return null;if(a.isIslamic){var ie={},ne=U.year,te=U.day,oe=U.month,ae=ne?ne+"":"",ye=ae.length===2;(!ne||!oe||!te||ye)&&(ie=ec.getHijriDate(new Date)),ye&&(ne=parseInt((ie.year+"").slice(0,2)+ae,10));var De=ec.toGregorian(ne||ie.year,oe||ie.month,te||ie.date);U.year=De.getFullYear(),U.month=De.getMonth()+1,U.day=De.getDate()}return r.getDateObject(U)}},o.getDateObject=function(e,t){var i=t||new Date;i.setMilliseconds(0);var r=["hour","minute","second","milliseconds","month","day"],n=e.year,s=e.designator,a=e.timeZone;if(!Ee(n)){var l=(n+"").length;if(l<=2){var h=Math.floor(i.getFullYear()/100)*100;n+=h}i.setFullYear(n)}for(var u=0,c=r;u<c.length;u++){var d=c[u],p=e[""+d];if(Ee(p)&&d==="day"&&i.setDate(1),!Ee(p))if(d==="month"){if(p-=1,p<0||p>11)return new Date("invalid");var f=i.getDate();i.setDate(1),i[KE[""+d]](p);var v=new Date(i.getFullYear(),p+1,0).getDate();i.setDate(f<v?f:v)}else{if(d==="day"){var m=new Date(i.getFullYear(),i.getMonth()+1,0).getDate();if(p<1||p>m)return null}i[""+KE[""+d]](p)}}if(!Ee(s)){var y=i.getHours();s==="pm"?i.setHours(y+(y===12?0:12)):y===12&&i.setHours(0)}if(!Ee(a)){var S=a-i.getTimezoneOffset();S!==0&&i.setMinutes(i.getMinutes()+S)}return i},o.internalDateParse=function(e,t,i){var r=e.match(t.parserRegex),n={hour:0,minute:0,second:0};if(g(r))return null;for(var s=Object.keys(t.evalposition),a=0,l=s;a<l.length;a++){var h=l[a],u=t.evalposition[""+h],c=r[u.pos];if(u.isNumber)n[""+h]=this.internalNumberParser(c,i);else if(h==="timeZone"&&!Ee(c)){var d=u.pos,p=void 0,f=r[d+1],v=!Ee(f);u.hourOnly?p=this.getZoneValue(v,f,r[d+4],i)*60:(p=this.getZoneValue(v,f,r[d+7],i)*60,p+=this.getZoneValue(v,r[d+4],r[d+10],i)),g(p)||(n[""+h]=p)}else{var m=["en-US","en-MH","en-MP"];c=h==="month"&&!t.isIslamic&&(t.culture==="en"||t.culture==="en-GB"||t.culture==="en-US")?c[0].toUpperCase()+c.substring(1).toLowerCase():c,c=h!=="month"&&h==="designator"&&t.culture&&t.culture.indexOf("en-")!==-1&&m.indexOf(t.culture)===-1?c.toLowerCase():c,n[""+h]=t[""+h][""+c]}}return t.hour12&&(n.hour12=!0),n},o.internalNumberParser=function(e,t){return e=pr.convertValueParts(e,t.numberParseRegex,t.numericPair),_j.test(e)?+e:null},o.parseTimeZoneRegx=function(e,t,i){var r=t.gmtFormat,n,s="("+i+")("+i+")";n=e.replace("+","\\+"),e.indexOf("HH")!==-1?n=n.replace(/HH|mm/g,"("+s+")"):n=n.replace(/H|m/g,"("+s+"?)");var a=n.split(";").map(function(l){return r.replace("{0}",l)});return n=a.join("|")+"|"+t.gmtZeroFormat,n},o.getZoneValue=function(e,t,i,r){var n=e?t:i;if(!n)return 0;var s=this.internalNumberParser(n,r);return e?-s:s},o}(),qj=RegExp,Gj=new qj("^([^0-9]*)(([0-9,]*[0-9]+)(.[0-9]+)?)([Ee][+-]?[0-9]+)?([^0-9]*)$"),Yj=/,/g,Qj=["minusSign","infinity"],Xj=function(){function o(){}return o.numberParser=function(e,t,i){var r=this,n=nt.getDependables(i,e,"",!0),s={custom:!0};nt.formatRegex.test(t.format)||!t.format?(he(s,nt.getProperNumericSkeleton(t.format||"N")),s.custom=!1,s.fractionDigits||t.maximumFractionDigits&&(s.maximumFractionDigits=t.maximumFractionDigits)):he(s,nt.customFormat(t.format,null,null));var a=V("numbers",n.parserObject),l=pr.getCurrentNumericOptions(n.parserObject,pr.getNumberingSystem(i),!0,qe());s.symbolRegex=pr.getSymbolRegex(Object.keys(l.symbolMatch)),s.infinity=l.symbolNumberSystem[Qj[1]];var h;if(qe())s.nData=he({},{},V(s.type+"nData",a)),s.pData=he({},{},V(s.type+"pData",a)),s.type==="currency"&&t.currency&&nt.replaceBlazorCurrency([s.pData,s.nData],V("currencySymbol",a),t.currency);else if(h=nt.getSymbolPattern(s.type,l.numberSystem,n.numericObject,s.isAccount),h){h=h.replace(/\u00A4/g,nt.defaultCurrency);var u=h.split(";");s.nData=nt.getFormatData(u[1]||"-"+u[0],!0,""),s.pData=nt.getFormatData(u[0],!0,"")}return function(c){return r.getParsedNumber(c,s,l)}},o.getParsedNumber=function(e,t,i){var r,n,s,a,l,h;if(e.indexOf(t.infinity)!==-1)return 1/0;e=pr.convertValueParts(e,t.symbolRegex,i.symbolMatch),e=pr.convertValueParts(e,i.numberParseRegex,i.numericPair),e=e.indexOf("-")!==-1?e.replace("-.","-0."):e,e.indexOf(".")===0&&(e="0"+e);var u=e.match(Gj);if(g(u))return NaN;a=u[1],s=u[2];var c=u[5];return l=u[6],r=t.custom?a===t.nData.nlead&&l===t.nData.nend:a.indexOf(t.nData.nlead)!==-1&&l.indexOf(t.nData.nend)!==-1,n=r?t.nData.isPercent:t.pData.isPercent,s=s.replace(Yj,""),c&&(s+=c),h=+s,(t.type==="percent"||n)&&(h=h/100),(t.custom||t.fractionDigits)&&(h=parseFloat(h.toFixed(t.custom?r?t.nData.maximumFractionDigits:t.pData.maximumFractionDigits:t.fractionDigits))),t.maximumFractionDigits&&(h=this.convertMaxFracDigits(s,t,h,r)),r&&(h*=-1),h},o.convertMaxFracDigits=function(e,t,i,r){var n=e.split(".");return n[1]&&n[1].length>t.maximumFractionDigits&&(i=+i.toFixed(t.custom?r?t.nData.maximumFractionDigits:t.pData.maximumFractionDigits:t.maximumFractionDigits)),i},o}(),tc=new Ju,$j=!1,zr={},tp="en-US",IS=["numericObject","dateObject"],Et=function(){function o(e){e&&(this.culture=e)}return o.prototype.getDateFormat=function(e){return bA.dateFormat(this.getCulture(),e||{type:"date",skeleton:"short"},zr)},o.prototype.getNumberFormat=function(e){return e&&!e.currency&&(e.currency=ts),qe()&&e&&!e.format&&(e.minimumFractionDigits=0),SA.numberFormatter(this.getCulture(),e||{},zr)},o.prototype.getDateParser=function(e){return Wj.dateParser(this.getCulture(),e||{skeleton:"short",type:"date"},zr)},o.prototype.getNumberParser=function(e){return qe()&&e&&!e.format&&(e.minimumFractionDigits=0),Xj.numberParser(this.getCulture(),e||{format:"N"},zr)},o.prototype.formatNumber=function(e,t){return this.getNumberFormat(t)(e)},o.prototype.formatDate=function(e,t){return this.getDateFormat(t)(e)},o.prototype.parseDate=function(e,t){return this.getDateParser(t)(e)},o.prototype.parseNumber=function(e,t){return this.getNumberParser(t)(e)},o.prototype.getDatePattern=function(e,t){return nt.getActualDateTimeFormat(this.getCulture(),e,zr,t)},o.prototype.getNumberPattern=function(e,t){return nt.getActualNumberFormat(this.getCulture(),e,zr,t)},o.prototype.getFirstDayOfWeek=function(){return nt.getWeekData(this.getCulture(),zr)},o.prototype.getCulture=function(){return this.culture||tp},o}();function CA(o){tp=o,tc.notify("notifyExternalChange",{locale:tp})}function Yi(o,e){var t=nt.getDependables(zr,o,"",!0)[IS[0]],i=nt.getDependables(zr,o,"")[IS[1]],r=V("defaultNumberingSystem",t),n=qe()?V("numberSymbols",t):V("symbols-numberSystem-"+r,t),s=nt.getSymbolPattern(e||"decimal",r,t,!1);return he(n,nt.getFormatData(s,!0,"",!0),{dateSeparator:nt.getDateSeparator(i)})}function Eh(o,e){var t=nt.getDependables(zr,o,"",!0);return nt.getCurrencySymbol(t.numericObject,e)}function Vg(o){return nt.getDependables(zr,"",o,!1)[IS[1]]}var Kj=["grid","pivotview","treegrid","spreadsheet","rangeNavigator","DocumentEditor","listbox","inplaceeditor","PdfViewer","richtexteditor","DashboardLayout","chart","stockChart","circulargauge","diagram","heatmap","lineargauge","maps","slider","smithchart","barcode","sparkline","treemap","bulletChart","kanban","daterangepicker","schedule","gantt","signature","query-builder","drop-down-tree","carousel","filemanager","uploader","accordion","tab","treeview"],ZE=[115,121,110,99,102,117,115,105,111,110,46,105,115,76,105,99,86,97,108,105,100,97,116,101,100],MS,wA=function(){function o(e){this.isValidated=!1,this.isLicensed=!0,this.version="29",this.platform=/JavaScript|ASPNET|ASPNETCORE|ASPNETMVC|FileFormats|essentialstudio/i,this.errors={noLicense:"<span>This application was built using a trial version of Syncfusion<sup>\xAE</sup> Essential Studio<sup>\xAE</sup>. To remove the license validation message permanently, a valid license key must be included.</span>",trailExpired:"<span>This application was built using a trial version of Syncfusion<sup>\xAE</sup> Essential Studio<sup>\xAE</sup>. To remove the license validation message permanently, a valid license key must be included.</span>",versionMismatched:"<span>The included Syncfusion<sup>\xAE</sup> license key is invalid.</span>",platformMismatched:"<span>The included Syncfusion<sup>\xAE</sup> license key is invalid.</span>",invalidKey:"<span>The included Syncfusion<sup>\xAE</sup> license key is invalid.</span>"},this.minVersion=null,this.manager=function(){var t=null;function i(n){t=n}function r(){return t}return{setKey:i,getKey:r}}(),this.npxManager=function(){var t="npxKeyReplace";function i(){return t}return{getKey:i}}(),this.manager.setKey(e)}return o.prototype.validate=function(){var e=[115,121,110,99,102,117,115,105,111,110,46,108,105,99,101,110,115,101,67,111,110,116,101,110,116],t=[115,121,110,99,102,117,115,105,111,110,46,99,108,97,105,109,65,99,99,111,117,110,116,85,82,76];if(!this.isValidated&&Qu&&!V(Fg(ZE),Qu)&&!V("Blazor",Qu)){var i=void 0,r=void 0;if(this.manager&&this.manager.getKey()||this.npxManager&&this.npxManager.getKey()!=="npxKeyReplace"){var n=this.getInfoFromKey();if(n&&n.length)for(var s=0,a=n;s<a.length;s++){var l=a[s];if(!this.platform.test(l.platform)||l.invalidPlatform)i=this.errors.platformMismatched;else if(l.minVersion>=l.lastValue&&l.minVersion!==l.lastValue||l.lastValue<parseInt(this.version,10)?(i=this.errors.versionMismatched,i=i.replace("##LicenseVersion",l.version),i=i.replace("##Requireversion",this.version+".x")):(l.lastValue==null||isNaN(l.lastValue))&&(i=this.errors.versionMismatched,i=i.replace("##LicenseVersion",l.version),i=i.replace("##Requireversion",this.version+".x")),l.expiryDate){var h=new Date(l.expiryDate),u=new Date;if(h!==u&&h<u)i=this.errors.trailExpired;else break}}else i=this.errors.invalidKey}else{var c=V(Fg(e),Qu);r=V(Fg(t),Qu),c&&c!==""?i=c:i=this.errors.noLicense}if(i&&typeof document<"u"&&!g(document)){MS=r&&r!==""?r:"https://www.syncfusion.com/account/claim-license-key?pl=SmF2YVNjcmlwdA==&vs=Mjk=&utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information";var d=Xe("div",{innerHTML:`<img src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzE5OV80KSI+CjxwYXRoIGQ9Ik0xMiAyMUMxNi45NzA2IDIxIDIxIDE2Ljk3MDYgMjEgMTJDMjEgNy4wMjk0NCAxNi45NzA2IDMgMTIgM0M3LjAyOTQ0IDMgMyA3LjAyOTQ0IDMgMTJDMyAxNi45NzA2IDcuMDI5NDQgMjEgMTIgMjFaIiBzdHJva2U9IiM3MzczNzMiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xMS4yNSAxMS4yNUgxMlYxNi41SDEyLjc1IiBmaWxsPSIjNjE2MDYzIi8+CjxwYXRoIGQ9Ik0xMS4yNSAxMS4yNUgxMlYxNi41SDEyLjc1IiBzdHJva2U9IiM3MzczNzMiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xMS44MTI1IDlDMTIuNDMzOCA5IDEyLjkzNzUgOC40OTYzMiAxMi45Mzc1IDcuODc1QzEyLjkzNzUgNy4yNTM2OCAxMi40MzM4IDYuNzUgMTEuODEyNSA2Ljc1QzExLjE5MTIgNi43NSAxMC42ODc1IDcuMjUzNjggMTAuNjg3NSA3Ljg3NUMxMC42ODc1IDguNDk2MzIgMTEuMTkxMiA5IDExLjgxMjUgOVoiIGZpbGw9IiM3MzczNzMiLz4KPC9nPgo8ZGVmcz4KPGNsaXBQYXRoIGlkPSJjbGlwMF8xOTlfNCI+CjxyZWN0IHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0id2hpdGUiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K' style="top: 6px;
                    position: absolute;
                    left: 16px;
                    width: 24px;
                    height: 24px;"/>`+i+' <a style="text-decoration: none;color: #0D6EFD;font-weight: 500;" href='+MS+">Claim your free account</a>"});d.setAttribute("style",`position: fixed;
                top: 10px;
                left: 10px;
                right: 10px;
                font-size: 14px;
                background: #EEF2FF;
                color: #222222;
                z-index: 999999999;
                text-align: left;
                border: 1px solid #EEEEEE;
                padding: 10px 11px 10px 50px;
                border-radius: 8px;
                font-family: Helvetica Neue, Helvetica, Arial;`),document.body.appendChild(d),this.isLicensed=!1}this.isValidated=!0,Ge(Fg(ZE),this.isValidated,Qu)}return this.isLicensed},o.prototype.getDecryptedData=function(e){try{return atob(e)}catch{return""}},o.prototype.getInfoFromKey=function(){try{var e="",t=[5439488,7929856,5111808,6488064,4587520,7667712,5439488,6881280,5177344,7208960,4194304,4456448,6619136,7733248,5242880,7077888,6356992,7602176,4587520,7274496,7471104,7143424],i=[],r=[],n=!1,s=!1;this.manager.getKey()?e=this.manager.getKey():(s=!0,e=this.npxManager.getKey().split("npxKeyReplace")[1]);for(var a=e.split(";"),l=0,h=a;l<h.length;l++){var u=h[l],c=this.getDecryptedData(u);if(c){var d=0,p="";if(s){for(var m=c[c.length-1],y=[],f=0;f<c.length;f++)y[parseInt(f.toString(),10)]=c[parseInt(f.toString(),10)].charCodeAt(0)-m.charCodeAt(0);for(var f=0;f<y.length;f++)p+=String.fromCharCode(y[parseInt(f.toString(),10)])}else for(var f=0;f<c.length;f++,d++){d===t.length&&(d=0);var v=c.charCodeAt(f);p+=String.fromCharCode(v^t[parseInt(d.toString(),10)]>>16)}if(this.platform.test(p)){if(i=p.split(";"),n=!1,i.length>3){var S=parseInt(i[1].split(".")[0],10),b=parseInt(i[4],10);r.push({platform:i[0],version:i[1],expiryDate:i[2],lastValue:b,minVersion:S})}}else p&&p.split(";").length>3&&(n=!0)}}return n&&!r.length?[{invalidPlatform:n}]:r.length?r:null}catch{return null}},o}(),xA=new wA;function Fg(o){for(var e="",t=0,i=o;t<i.length;t++){var r=i[t];e+=String.fromCharCode(r)}return e}function Zj(o){xA=new wA(o)}var Jj=function(o){return o&&Zj(o),xA.validate()};var e3=function(){var o=`
    <div style="
    position: fixed;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 99999;
    ">
        <div style="
    background: #FFFFFF;
    height: 455px;
    width: 840px;
    font-family: Helvetica Neue, Helvetica, Arial;
    color: #000000;
    box-shadow: 0px 4.8px 14.4px rgb(0 0 0 / 18%), 0px 25.6px 57.6px rgb(0 0 0 / 22%);
    display: block;
    margin: 8% auto;
    border-radius: 20px;
    ">
            <div style="
    position: absolute;
width: 838px;
height: 62px;
background-color: #F9F9F9;
border: 1px solid #EEEEEE;
border-top-left-radius: 20px;
border-top-right-radius: 20px;
">
                <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQ2IiBoZWlnaHQ9IjMyIiB2aWV3Qm94PSIwIDAgMTQ2IDMyIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNNDAuNTk2NSAxNS4wMDc4SDMyLjQyNUMzMS41NTU3IDE1LjAwNzggMzAuOTAzNyAxNS4xODEyIDMwLjUxMjUgMTUuNDg0NkMzMC4xMjEzIDE1LjgzMTQgMjkuOTA0IDE2LjMwODIgMjkuOTA0IDE3LjA0NTFDMjkuOTA0IDE3LjYwODYgMzAuMDc3OCAxOC4wNDIxIDMwLjQyNTYgMTguMzAyMkMzMC43NzMzIDE4LjYwNTYgMzEuMjk0OSAxOC43MzU2IDMxLjk5MDMgMTguNzM1NkgzNi4zMzY5QzM4LjExODkgMTguNzM1NiAzOS40MjI5IDE5LjA4MjQgNDAuMTYxOCAxOS43MzI2QzQwLjk0NDIgMjAuNDI2MiA0MS4yOTE5IDIxLjU1MzIgNDEuMjkxOSAyMy4xMTM3QzQxLjI5MTkgMjQuNzE3NiA0MC44NTcyIDI1Ljg4OCAzOS45ODc5IDI2LjY2ODJDMzkuMTE4NiAyNy40MDUxIDM3LjcyNzcgMjcuNzk1MyAzNS44NTg3IDI3Ljc5NTNIMjcuMDc4N1YyNS4wMjFIMzUuMzM3MkMzNi4yOTM0IDI1LjAyMSAzNi45NDU0IDI0Ljg5MSAzNy4zMzY2IDI0LjYzMDlDMzcuNzI3NyAyNC4zNzA4IDM3LjkwMTYgMjMuODk0IDM3LjkwMTYgMjMuMjg3MUMzNy45MDE2IDIyLjYzNjkgMzcuNzI3NyAyMi4xNjAxIDM3LjM4IDIxLjlDMzcuMDMyMyAyMS42Mzk5IDM2LjQyMzggMjEuNDY2NSAzNS41NTQ1IDIxLjQ2NjVIMzEuNjQyNkMyOS44NjA1IDIxLjQ2NjUgMjguNTEzMSAyMS4xMTk4IDI3LjY4NzMgMjAuMzgyOEMyNi44NjE0IDE5LjY0NTkgMjYuNDI2OCAxOC41MTg5IDI2LjQyNjggMTcuMDAxN0MyNi40MjY4IDE1LjM1NDUgMjYuODYxNCAxNC4xNDA4IDI3LjczMDcgMTMuMzYwNkMyOC42IDEyLjU4MDMgMjkuOTkwOSAxMi4yMzM1IDMxLjkwMzQgMTIuMjMzNUg0MC41OTY1VjE1LjAwNzhaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik00OC4wNzI3IDI1LjI4MTFINTAuNTA2OFYxNi4zOTQ5SDUzLjU0OTNWMjcuNTM1MkM1My41NDkzIDI5LjA1MjQgNTMuMjAxNiAzMC4xNzk0IDUyLjUwNjIgMzAuOTE2M0M1MS44MTA3IDMxLjY1MzIgNTAuNzI0MSAzMiA0OS4yNDYzIDMySDQzLjMzNVYyOS42NTkySDQ4LjcyNDdDNDkuMjg5NyAyOS42NTkyIDQ5Ljc2NzkgMjkuNTI5MiA1MC4wNzIxIDI5LjIyNThDNTAuMzc2NCAyOC45NjU3IDUwLjU1MDIgMjguNTMyMiA1MC41NTAyIDI4LjAxMlYyNy44Mzg2SDQ3Ljg5ODlDNDYuMjAzNyAyNy44Mzg2IDQ0Ljk0MzIgMjcuNDkxOSA0NC4yNDc4IDI2Ljg0MTZDNDMuNTA4OSAyNi4xNDgxIDQzLjE2MTEgMjUuMDY0NCA0My4xNjExIDIzLjQ2MDVWMTYuMzk0OUg0Ni4xNjAyVjIzLjIwMDVDNDYuMTYwMiAyNC4wNjc0IDQ2LjI5MDYgMjQuNjMwOSA0Ni41NTE0IDI0Ljg5MUM0Ni43MjUzIDI1LjE1MTEgNDcuMjQ2OSAyNS4yODExIDQ4LjA3MjcgMjUuMjgxMVoiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTU1Ljg5NjUgMTYuMzk0OUg2MS41OTA0QzYzLjMyOTEgMTYuMzk0OSA2NC41NDYxIDE2LjY5ODMgNjUuMjg1IDE3LjM0ODVDNjYuMDIzOSAxNy45OTg4IDY2LjM3MTYgMTkuMDgyNCA2Ni4zNzE2IDIwLjU1NjNWMjcuNzk1M0g2My4zMjkxVjIwLjk0NjRDNjMuMzI5MSAyMC4wNzk0IDYzLjE5ODcgMTkuNTE1OSA2Mi45Mzc5IDE5LjI5OTJDNjIuNjc3MSAxOS4wMzkxIDYyLjE1NTUgMTguOTA5MSA2MS4zMjk3IDE4LjkwOTFINTguODk1NlYyNy44Mzg2SDU1Ljg1M1YxNi4zOTQ5SDU1Ljg5NjVaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik03NC45MzQyIDI1LjM2NzhINzguMTUwNlYyNy43OTUySDc0LjAyMTRDNzIuOTc4MiAyNy43OTUyIDcyLjEwODkgMjcuNjY1MiA3MS40NTcgMjcuNDkxOEM3MC44MDUgMjcuMjc1IDcwLjE5NjUgMjYuOTI4MyA2OS43MTgzIDI2LjQ1MTRDNjkuMTk2OCAyNS45MzEzIDY4Ljc2MjEgMjUuMjgxMSA2OC40NTc4IDI0LjU0NDJDNjguMTUzNiAyMy44MDcyIDY4LjAyMzIgMjIuOTgzNiA2OC4wMjMyIDIyLjE2QzY4LjAyMzIgMjEuMjkzMSA2OC4xNTM2IDIwLjQ2OTUgNjguNDU3OCAxOS42ODkyQzY4Ljc2MjEgMTguOTA5IDY5LjE1MzMgMTguMzAyMSA2OS43MTgzIDE3Ljc4MTlDNzAuMjM5OSAxNy4zMDUxIDcwLjgwNSAxNi45NTgzIDcxLjUwMDQgMTYuNzQxNkM3Mi4xOTU5IDE2LjUyNDkgNzMuMDIxNyAxNi40MzgyIDc0LjA2NDkgMTYuNDM4Mkg3OC4xOTQxVjE4LjkwOUg3NC45MzQyQzczLjQ5OTggMTguOTA5IDcyLjU0MzYgMTkuMTY5MSA3MS45Nzg1IDE5LjY0NTlDNzEuNDU2OSAyMC4xMjI3IDcxLjE1MjcgMjAuOTg5NyA3MS4xNTI3IDIyLjIwMzRDNzEuMTUyNyAyMi44OTY5IDcxLjI4MzEgMjMuNDYwNSA3MS41MDA0IDIzLjkzNzNDNzEuNzE3NyAyNC40MTQxIDcyLjA2NTUgMjQuNzYwOSA3Mi41MDAxIDI1LjA2NDNDNzIuNzE3NCAyNS4xOTQ0IDcyLjk3ODIgMjUuMjgxMSA3My4yODI1IDI1LjM2NzhDNzMuNjMwMiAyNS4zMjQ0IDc0LjE1MTggMjUuMzY3OCA3NC45MzQyIDI1LjM2NzhaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik04MC44NDU2IDE4LjY0ODlINzguNjcyNFYxNi4zNTE1SDgwLjg0NTZWMTUuMTgxMUM4MC44NDU2IDE0LjAxMDggODEuMDYzIDEzLjIzMDUgODEuNDk3NiAxMi44NDA0QzgxLjkzMjMgMTIuNDUwMyA4Mi43NTgxIDEyLjIzMzUgODMuOTc1MSAxMi4yMzM1SDg2Ljg0MzhWMTQuNDAwOUg4NS40MDk1Qzg0Ljg4NzkgMTQuNDAwOSA4NC41NDAyIDE0LjQ4NzYgODQuMzIyOSAxNC42NjFDODQuMTA1NSAxNC44MzQ0IDgzLjk3NTEgMTUuMDk0NSA4My45NzUxIDE1LjQ0MTJWMTYuMzUxNUg4Ni44NDM4VjE4LjY0ODlIODMuOTc1MVYyNy43OTUzSDgwLjg0NTZWMTguNjQ4OVoiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTk4LjQwNTYgMjcuNzk1M0g5Mi43MTE2QzkxLjAxNjUgMjcuNzk1MyA4OS44NDI5IDI3LjQ0ODUgODkuMDYwNSAyNi43OTgzQzg4LjMyMTYgMjYuMTQ4MSA4Ny45MzA0IDI1LjA2NDQgODcuOTMwNCAyMy41OTA2VjE2LjM5NDlIOTAuOTI5NVYyMy40MTcyQzkwLjkyOTUgMjQuMTk3NCA5MS4wNTk5IDI0LjY3NDMgOTEuMzIwNyAyNC45MzQ0QzkxLjU4MTUgMjUuMTk0NCA5Mi4xMDMxIDI1LjMyNDUgOTIuOTI4OSAyNS4zMjQ1SDk1LjM2M1YxNi4zOTQ5SDk4LjQwNTZWMjcuNzk1M1oiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTEwMC42MjIgMjUuNDExMkgxMDcuMDExQzEwNy41NzcgMjUuNDExMiAxMDguMDExIDI1LjMyNDUgMTA4LjI3MiAyNS4xNTExQzEwOC41MzMgMjQuOTc3NyAxMDguNjYzIDI0LjY3NDMgMTA4LjY2MyAyNC4zMjc1QzEwOC42NjMgMjMuOTM3NCAxMDguNTMzIDIzLjY3NzMgMTA4LjI3MiAyMy40NjA1QzEwOC4wMTEgMjMuMjg3MSAxMDcuNTc3IDIzLjIwMDUgMTA3LjA1NSAyMy4yMDA1SDEwNC40NDdDMTAyLjg4MiAyMy4yMDA1IDEwMS44MzkgMjIuOTgzNyAxMDEuMzE4IDIyLjUwNjlDMTAwLjc1MiAyMi4wMzAxIDEwMC40OTIgMjEuMjA2NSAxMDAuNDkyIDE5Ljk5MjdDMTAwLjQ5MiAxOC43NzkgMTAwLjgzOSAxNy44Njg3IDEwMS40OTEgMTcuMjYxOEMxMDIuMTQzIDE2LjY5ODMgMTAzLjE4NyAxNi4zOTQ5IDEwNC41MzQgMTYuMzk0OUgxMTEuMDU0VjE4Ljc3OUgxMDUuNzA4QzEwNC44MzggMTguNzc5IDEwNC4yNzMgMTguODY1NyAxMDQuMDEyIDE4Ljk5NTdDMTAzLjc1MiAxOS4xNjkxIDEwMy42MjEgMTkuNDI5MiAxMDMuNjIxIDE5LjgxOTRDMTAzLjYyMSAyMC4xNjYxIDEwMy43NTIgMjAuNDI2MiAxMDMuOTY5IDIwLjU5OTZDMTA0LjE4NiAyMC43NzMgMTA0LjU3NyAyMC44NTk3IDEwNS4wNTYgMjAuODU5N0gxMDcuNzk0QzEwOS4wNTQgMjAuODU5NyAxMTAuMDExIDIxLjE2MzEgMTEwLjY2MyAyMS43MjY2QzExMS4zMTUgMjIuMjkwMiAxMTEuNjYyIDIzLjE1NzEgMTExLjY2MiAyNC4yNDA4QzExMS42NjIgMjUuMjgxMSAxMTEuMzU4IDI2LjE0ODEgMTEwLjc5MyAyNi43OTgzQzExMC4yMjggMjcuNDQ4NSAxMDkuNDQ2IDI3Ljc5NTMgMTA4LjUzMyAyNy43OTUzSDEwMC43MDlWMjUuNDExMkgxMDAuNjIyWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMTE2LjU3NCAxNS4wOTQ0SDExMy40MDFWMTIuMjc2OUgxMTYuNTc0VjE1LjA5NDRaTTExNi41NzQgMjcuNzk1M0gxMTMuNDAxVjE2LjM5NDlIMTE2LjU3NFYyNy43OTUzWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMTMwLjMwOSAyMi4xMTY3QzEzMC4zMDkgMjMuODkzOSAxMjkuNzQ0IDI1LjMyNDQgMTI4LjY1NyAyNi40MDgxQzEyNy41NzEgMjcuNDkxOCAxMjYuMDkzIDI4LjAxMiAxMjQuMjI0IDI4LjAxMkMxMjIuMzU1IDI4LjAxMiAxMjAuODc3IDI3LjQ5MTggMTE5Ljc5IDI2LjQwODFDMTE4LjcwNCAyNS4zMjQ0IDExOC4xMzkgMjMuODkzOSAxMTguMTM5IDIyLjExNjdDMTE4LjEzOSAyMC4zMzk0IDExOC43MDQgMTguOTA5IDExOS43OSAxNy44MjUzQzEyMC44NzcgMTYuNzQxNiAxMjIuMzk4IDE2LjIyMTQgMTI0LjIyNCAxNi4yMjE0QzEyNi4wNDkgMTYuMjIxNCAxMjcuNTI3IDE2Ljc0MTYgMTI4LjY1NyAxNy44MjUzQzEyOS43NDQgMTguODY1NiAxMzAuMzA5IDIwLjI5NjEgMTMwLjMwOSAyMi4xMTY3Wk0xMjEuMjY4IDIyLjExNjdDMTIxLjI2OCAyMy4yMDA0IDEyMS41MjkgMjQuMDY3MyAxMjIuMDUxIDI0LjY3NDJDMTIyLjU3MiAyNS4yODExIDEyMy4yNjggMjUuNTg0NSAxMjQuMTggMjUuNTg0NUMxMjUuMDkzIDI1LjU4NDUgMTI1Ljc4OSAyNS4yODExIDEyNi4zMSAyNC42NzQyQzEyNi44MzIgMjQuMDY3MyAxMjcuMDkzIDIzLjIwMDQgMTI3LjA5MyAyMi4xMTY3QzEyNy4wOTMgMjEuMDMzIDEyNi44MzIgMjAuMTY2MSAxMjYuMzEgMTkuNjAyNUMxMjUuNzg5IDE4Ljk5NTcgMTI1LjA5MyAxOC42OTIyIDEyNC4xMzcgMTguNjkyMkMxMjMuMjI0IDE4LjY5MjIgMTIyLjUyOSAxOC45OTU3IDEyMi4wMDcgMTkuNjAyNUMxMjEuNTI5IDIwLjE2NjEgMTIxLjI2OCAyMS4wMzMgMTIxLjI2OCAyMi4xMTY3WiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMTMxLjc4NyAxNi4zOTQ5SDEzNy40ODFDMTM5LjIxOSAxNi4zOTQ5IDE0MC40MzYgMTYuNjk4MyAxNDEuMTc1IDE3LjM0ODVDMTQxLjkxNCAxNy45OTg4IDE0Mi4yNjIgMTkuMDgyNCAxNDIuMjYyIDIwLjU1NjNWMjcuNzk1M0gxMzkuMjE5VjIwLjk0NjRDMTM5LjIxOSAyMC4wNzk0IDEzOS4wODkgMTkuNTE1OSAxMzguODI4IDE5LjI5OTJDMTM4LjU2NyAxOS4wMzkxIDEzOC4wNDYgMTguOTA5MSAxMzcuMjIgMTguOTA5MUgxMzQuNzg2VjI3LjgzODZIMTMxLjc0M1YxNi4zOTQ5SDEzMS43ODdaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik03LjEyODMxIDMuNzM3NDNIMFYxMC44NDY0SDcuMTI4MzFWMy43Mzc0M1oiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTIzLjI1MTMgLTIuMTU3MjVlLTA1TDE4LjU1MTMgNS41MTY4NUwyNC4wODMxIDEwLjIwNDFMMjguNzgzMSA0LjY4NzI1TDIzLjI1MTMgLTIuMTU3MjVlLTA1WiIgZmlsbD0iI0ZGODYwMCIvPgo8cGF0aCBkPSJNMTUuNjA0MSAzLjczNzQzSDguNDc1ODNWMTAuODQ2NEgxNS42MDQxVjMuNzM3NDNaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik03LjEyODMxIDEyLjE5MDJIMFYxOS4yOTkySDcuMTI4MzFWMTIuMTkwMloiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTE1LjYwNDEgMTIuMTkwMkg4LjQ3NTgzVjE5LjI5OTJIMTUuNjA0MVYxMi4xOTAyWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMjQuMDc5NyAxMi4xOTAySDE2Ljk1MTRWMTkuMjk5MkgyNC4wNzk3VjEyLjE5MDJaIiBmaWxsPSIjRkY4NjAwIi8+CjxwYXRoIGQ9Ik03LjEyODMxIDIwLjY4NjNIMFYyNy43OTUzSDcuMTI4MzFWMjAuNjg2M1oiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTE1LjYwNDEgMjAuNjg2M0g4LjQ3NTgzVjI3Ljc5NTNIMTUuNjA0MVYyMC42ODYzWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMjQuMTIzMiAyMC42ODYzSDE2Ljk5NDlWMjcuNzk1M0gyNC4xMjMyVjIwLjY4NjNaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik0xNDYgMTUuODMxM0MxNDYgMTYuODcxNyAxNDUuMTc0IDE3LjY5NTMgMTQ0LjEzMSAxNy42OTUzQzE0My4wODggMTcuNjk1MyAxNDIuMjYyIDE2Ljg3MTcgMTQyLjI2MiAxNS44MzEzQzE0Mi4yNjIgMTQuNzkxIDE0My4wODggMTQuMDEwNyAxNDQuMTMxIDE0LjAxMDdDMTQ1LjEzMSAxMy45Njc0IDE0NiAxNC43OTEgMTQ2IDE1LjgzMTNaTTE0Mi45NTcgMTQuNzkxQzE0Mi42OTcgMTUuMDUxMSAxNDIuNTY2IDE1LjQ0MTIgMTQyLjU2NiAxNS44MzEzQzE0Mi41NjYgMTYuNjk4MyAxNDMuMjYyIDE3LjM5MTggMTQ0LjEzMSAxNy4zOTE4QzE0NSAxNy4zOTE4IDE0NS42OTYgMTYuNjk4MyAxNDUuNjk2IDE1LjgzMTNDMTQ1LjY5NiAxNS4wMDc3IDE0NSAxNC4yNzA4IDE0NC4xNzQgMTQuMjcwOEMxNDMuNjUzIDE0LjI3MDggMTQzLjI2MiAxNC40NDQyIDE0Mi45NTcgMTQuNzkxWk0xNDQuODcgMTYuOTE1SDE0NC40NzlMMTQzLjkxNCAxNi4wOTE0VjE2LjkxNUgxNDMuNjA5VjE0Ljc0NzZIMTQzLjk1N0MxNDQuNDM1IDE0Ljc0NzYgMTQ0LjY1MyAxNC45NjQ0IDE0NC42NTMgMTUuMzU0NUMxNDQuNjUzIDE1LjY1NzkgMTQ0LjQ3OSAxNS44NzQ3IDE0NC4xNzQgMTUuOTYxNEwxNDQuODcgMTYuOTE1Wk0xNDQuMDQ0IDE1LjY1NzlDMTQ0LjI2MSAxNS42NTc5IDE0NC4zOTIgMTUuNTI3OSAxNDQuMzkyIDE1LjM1NDVDMTQ0LjM5MiAxNS4xMzc4IDE0NC4yNjEgMTUuMDUxMSAxNDQuMDAxIDE1LjA1MTFIMTQzLjkxNFYxNS42NTc5SDE0NC4wNDRaIiBmaWxsPSIjMzU0M0E4Ii8+Cjwvc3ZnPgo=" style="
    text-align: left;
    width: 146px;
    position: absolute;
    top: 14px;
    left: 31px;
">
            </div>
            <div style="
    position: relative;
    top: 80px;
    left: 32px;
    font-size: 20px;
    text-align: left;
    font-weight: 700;
    letter-spacing: 0.02em;
    font-style: normal;
    line-height: 125%;
    ">Claim your FREE account and get a key in less than a minute</div>
            <ul style="
        font-size: 15px;
        font-weight: 400;
        color: #333333;
        letter-spacing: 0.01em;
        position: relative;
        left: 32px;
        top: 88px;
        line-height: 180%;
        ">
                <li><span>Access to a 30-day free trial of any of our products.</span></li>
                <li><span>Access to 24x5 support by developers via the <a href="https://support.syncfusion.com/create?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information" style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">support tickets</a>, <a href="https://www.syncfusion.com/forums?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information" style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">forum</a>, <a href="https://www.syncfusion.com/feedback?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information
                " style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">feature &amp; feedback page</a> and chat.</span></li>
                <li><span>200+ <a href="https://www.syncfusion.com/succinctly-free-ebooks?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information" style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">ebooks </a>on the latest technologies, industry trends, and research topics.</span>
                </li>
                <li><span>Largest collection of over 7500 flat and wireframe icons for free with Syncfusion<sup>\xAE</sup> <a href="https://www.syncfusion.com/downloads/metrostudio?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information
                " style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">Metro Studio.</a></span></li>
                <li><span>Free and unlimited access to Syncfusion<sup>\xAE</sup> technical <a href="https://www.syncfusion.com/blogs/?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information
                " style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">blogs</a> and <a href="https://www.syncfusion.com/resources/techportal/whitepapers?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information" style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">whitepapers.</a></span></li>
            </ul>
            <div style="
            font-size: 18px;
            font-weight: 700;
            position: relative;
            line-height: 125%;
            letter-spacing: 0.02em;
            top: 90px;
            left: 32px;
    ">Syncfusion is trusted by 29,000+ businesses worldwide</div>
            <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjIyMzAiIGhlaWdodD0iMTU2Ij4KPHBhdGggZD0iTTAgMCBDMTAuMjAxNTE3OTEgOC44MjE1MTgwNSAxNi4yMjU4NjAxNyAxOS4zODQ1MTIyMiAxNy4yODEyNSAzMi45NzI2NTYyNSBDMTcuNDE3OTUwMTYgNDUuOTc2MjU4NTUgMTMuMTkyNTE4MDQgNTcuNjM2ODk1NzMgNC4yNDYwOTM3NSA2Ny4xMzI4MTI1IEMtNS44MzQzNzk4NyA3Ni42NDQzNzA1IC0xNi43MjM2MTUyMyA4MC40NzU4MTc3IC0zMC40MTAxNTYyNSA4MC4yMjI2NTYyNSBDLTQzLjEyNjA0NDAyIDc5LjI2MTgzMzU2IC01NC4yMDMwOTQ1MyA3My40MDM0NzMyNCAtNjIuNzE4NzUgNjMuOTcyNjU2MjUgQy03MS4xNDgwNjkyNSA1MS44OTg2NTk5MiAtNzMuMTk0NzM3MSA0MC4zOTM3NzYxNCAtNzEuNzE4NzUgMjUuOTcyNjU2MjUgQy02OS4wOTkxNjQzNyAxNC41NTg3NDc0NCAtNjIuMzc0NTczNzggNC42NDI1NDI1NiAtNTIuNzE4NzUgLTIuMDI3MzQzNzUgQy0zNS45MDE4NDE2MSAtMTEuOTUyMDc2NTcgLTE1Ljg5MjUyMDU5IC0xMi4xNTE1ODYzNiAwIDAgWiAiIGZpbGw9IiMwODY4NDIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzODguNzE4NzUsNDIuMDI3MzQzNzUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzcuMzY3MjM5MTYgNC4wNDIzMjQxMSAxMS4xMDI1Mzc1MyAxMS4zOTA0MDEzMyAxNCAxOSBDMTQuMzg5NjU4MjYgMjAuOTg5NzkzMzQgMTQuNzQwMDUyODkgMjIuOTg5MTQ0ODEgMTUgMjUgQzE1LjY2IDI1IDE2LjMyIDI1IDE3IDI1IEMxNy4xMDA1NDY4NyAyNC4xNDQwNjI1IDE3LjIwMTA5Mzc1IDIzLjI4ODEyNSAxNy4zMDQ2ODc1IDIyLjQwNjI1IEMxOC45MTc0Mjc1NSAxNC41MDU2MzU4IDIzLjYwODM5NDI3IDUuNzcxNDMyNzMgMzAuMTc5Njg3NSAwLjg5NDUzMTI1IEMzMy43MzEzMzY1NCAtMC44NTA4MDcwMSAzNi4wNzI1NTM3NiAtMC42MjM0MDQxNyA0MCAwIEM0Ny43ODg2NDkxMyAzLjU4Mjc3ODYgNTEuMzQ3MDc2MTEgMTAuOTI1MDE3NDYgNTQuMzUyNzgzMiAxOC41ODg4NjcxOSBDNjAuNjYxMjYyNjMgMzUuNzMzMjUxOTkgNjMuMjM3ODY0ODggNTQuNDE0MDMxNTkgNjMuMDYyNSA3Mi42MjUgQzYzLjA1Nzk4ODI4IDczLjUzMzc4OTA2IDYzLjA1MzQ3NjU2IDc0LjQ0MjU3ODEyIDYzLjA0ODgyODEyIDc1LjM3ODkwNjI1IEM2My4wMzcyMTIwMiA3Ny41ODU5NjY5NSA2My4wMTkyODQ1MyA3OS43OTI5OTI5OSA2MyA4MiBDNTkuMDQgODIgNTUuMDggODIgNTEgODIgQzUwLjkzMDA2ODM2IDgwLjkwMzQ5MTIxIDUwLjg2MDEzNjcyIDc5LjgwNjk4MjQyIDUwLjc4ODA4NTk0IDc4LjY3NzI0NjA5IEM1MC4zMzA4MzIxNSA0MS45ODYzMDU3MyA1MC4zMzA4MzIxNSA0MS45ODYzMDU3MyAzOSA4IEMzOC4wMSA3LjY3IDM3LjAyIDcuMzQgMzYgNyBDMjUuMTQyMTkxNjggMTYuMjQ0MTIxMzEgMjQuODI2NDcwMzkgMzguNDA3NTg2NzUgMjMuNjgzNTkzNzUgNTEuNjcyMzYzMjggQzIzLjA0MTM0NzcxIDU5Ljc3NjY1NDY5IDIyLjUwMDE0OTM2IDY3Ljg4NTgxMjE3IDIyIDc2IEMxOC4wNCA3NiAxNC4wOCA3NiAxMCA3NiBDOS44OTUxMDI1NCA3NC40NzU4NDQ3MyA5Ljg5NTEwMjU0IDc0LjQ3NTg0NDczIDkuNzg4MDg1OTQgNzIuOTIwODk4NDQgQzkuMjg4Njk2MTIgMzkuNjQwNjkzMTMgOS4yODg2OTYxMiAzOS42NDA2OTMxMyAtMSA5IEMtMy4wMzU2NDA0IDcuNzQxNDM2NTkgLTMuMDM1NjQwNCA3Ljc0MTQzNjU5IC01IDcgQy0xNS44NDgzODY5NyAxNi40OTIzMzg2IC0xNi4wNTg3MjYyNSA0MC4yNTk3NTY0MSAtMTcgNTQgQy0xNy40NzQyMTEwMiA2My4zMjgyOTc4NCAtMTcuNzQ3NjYxNTkgNzIuNjYzNDc4NzQgLTE4IDgyIEMtMjIuMjkgODIgLTI2LjU4IDgyIC0zMSA4MiBDLTMxLjg5MjU5MjA1IDU1LjgxNzI5OTc3IC0yOS45NTA2NDQ2MiAyMi44Mzc1NTI0MSAtMTIgMiBDLTguNDczMzg5NDMgLTAuNjQ0OTU3OTMgLTQuMjE5NTgzOTggLTAuOTU4OTk2MzYgMCAwIFogIiBmaWxsPSIjRkZDQzAwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4MjgsMzcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzUuODg3MjkwNzMgMS40NDk4NTUxOCA5LjE2NjM4NTEzIDEuMjgxNTYyNTYgMTQuNzUgLTAuODM5ODQzNzUgQzIwLjM1Nzc0OTYyIC0yLjU0NjE0OTE0IDI1LjU0MDY3MjkyIC0xLjM4Mjk1NTEgMzAuNjI1IDEuMjUgQzMyLjkzNzM1MDYzIDMuMjczMzA2OCAzNC4xMDM0MzU0MiA0LjU3NzExOTE4IDM1LjEyNSA3LjQzNzUgQzM0LjM0MTI1IDguMTggMzMuNTU3NSA4LjkyMjUgMzIuNzUgOS42ODc1IEMyOS4xMTkwMTcwMyAxMy40OTEzODY5MiAyOC4yMzgzODk0NyAxNS4wMzE0NzA1OCAyNy44MTI1IDIwLjMxMjUgQzI3Ljk2MDg4MjA0IDI1LjAxNzA4MzQ0IDI5LjE5MzUzOTM2IDI4LjU3NDg0NDU4IDMyLjY2MDE1NjI1IDMxLjkxNzk2ODc1IEMzNC4xMDgzOTEwMSAzMy4xNDAyMzc4IDM1LjYxMjk3ODE1IDM0LjI5NTA4MzQ5IDM3LjEyNSAzNS40Mzc1IEMzNi4wNzAxOTM1MiA0Mi40Njk1NDMyIDMyLjAzNjA5MDQ5IDQ3Ljk3MzE5OTEgMjcuNzUgNTMuNSBDMjQuMjczODU5MzcgNTYuMDY1NzIyODUgMjEuNDA5Njc2NTkgNTYuNjI0MTU5MTggMTcuMTI1IDU2LjQzNzUgQzE1LjExMjc3OTUzIDU1LjgwODY4MTEgMTMuMTEyMjMyNjggNTUuMTQxMzExNTcgMTEuMTI1IDU0LjQzNzUgQzcuMTMyMjAwNjEgNTQuMDEwODUwMDcgMy44Njk5NzIwNCA1NC4xNzkwNDAzMSAwLjA2MjUgNTUuNSBDLTMuNzQ1OTgyNzYgNTYuNzE1NDczMjIgLTYuMDIwMDcxMDYgNTYuNDcwMDcwMjUgLTkuODc1IDU1LjQzNzUgQy0xNy44OTY4MjA0OCA1MC4zNjI0NzA3MiAtMjMuMjI0ODkxNjcgNDAuMjQ1NjM5MjYgLTI1LjQzMzU5Mzc1IDMxLjEzMjgxMjUgQy0yNi42OTE4Nzk2IDIzLjQ0OTQ3NDE1IC0yNy4zMTA4Njc4MiAxNC4yMDI1NjkzMiAtMjIuODc1IDcuNDM3NSBDLTE5LjE4NzExNTEzIDMuMTY0NjQwMjkgLTE0Ljk1ODc1MDk1IC0wLjQ2NDczMTYxIC05LjI2NTYyNSAtMS41NzQyMTg3NSBDLTYuMDIyMDAxNTYgLTEuNTU4MzE4NjQgLTMuMTQ1MDkxMDYgLTAuNzc5NDY1MjEgMCAwIFogIiBmaWxsPSIjMDAwMDAwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMjIuODc1LDU1LjU2MjUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzYuOTk4NjY1NzYgNi41NjU2MTQ1OCAxMy4yMzU0MjQ3IDEzLjIxNDc1OTU1IDE0LjE3OTY4NzUgMjMuMTg3NSBDMTMuOTYxMTk2MzQgMjguMjczOTc0MSAxMi4yNTY2NDk1NCAzMi4wNjY5ODMyNiA5LjAzNTE1NjI1IDM1Ljk3NjU2MjUgQzAuNTMzMzg4MDQgNDMuNTgzNDA3NzQgLTguOTc3NTY4MjUgNDUuMDAzODkwNjcgLTE5Ljg1NTQ2ODc1IDQ0Ljg5ODQzNzUgQy0yMS4xODA5NDcyNyA0NC44OTE2Njk5MiAtMjEuMTgwOTQ3MjcgNDQuODkxNjY5OTIgLTIyLjUzMzIwMzEyIDQ0Ljg4NDc2NTYyIEMtMjQuNzAzMTU0MzQgNDQuODczMDM2MTYgLTI2Ljg3MzA3MDQ3IDQ0Ljg1NTEwMjQ1IC0yOS4wNDI5Njg3NSA0NC44MzU5Mzc1IEMtMjkuMzcyOTY4NzUgNDUuNDk1OTM3NSAtMjkuNzAyOTY4NzUgNDYuMTU1OTM3NSAtMzAuMDQyOTY4NzUgNDYuODM1OTM3NSBDLTMyLjQxNzk2ODc1IDQ2Ljk2MDkzNzUgLTMyLjQxNzk2ODc1IDQ2Ljk2MDkzNzUgLTM1LjA0Mjk2ODc1IDQ2LjgzNTkzNzUgQy0zNy4wNDI5Njg3NSA0NC44MzU5Mzc1IC0zNy4wNDI5Njg3NSA0NC44MzU5Mzc1IC0zNy40MTQwNjI1IDQyLjM1NTQ2ODc1IEMtMzcuNzgyMzI5OTcgMzkuNzMzNjQ1MzEgLTM3Ljc4MjMyOTk3IDM5LjczMzY0NTMxIC0zOS44MjgxMjUgMzguNTM1MTU2MjUgQy00MC41Nzk2NDg0NCAzOC4yMDEyODkwNiAtNDEuMzMxMTcxODcgMzcuODY3NDIxODcgLTQyLjEwNTQ2ODc1IDM3LjUyMzQzNzUgQy00Ny4zNTI0NjU4MyAzNC44NTM3NjUzOCAtNTEuNDU1NzUyNzEgMzEuNTMwNDMxOTUgLTU1LjA0Mjk2ODc1IDI2LjgzNTkzNzUgQy01Ni4wNDI5Njg3NSAyMy4zMzU5Mzc1IC01Ni4wNDI5Njg3NSAyMy4zMzU5Mzc1IC01Ni4wNDI5Njg3NSAyMC44MzU5Mzc1IEMtNTEuMzM2NTk3OTUgMTYuMTI5NTY2NyAtNDUuMzAzOTE4MTcgMTQuNTc0NTc2MzMgLTM5LjA0Mjk2ODc1IDEyLjgzNTkzNzUgQy0zOC4zODI5Njg3NSAxMi44MzU5Mzc1IC0zNy43MjI5Njg3NSAxMi44MzU5Mzc1IC0zNy4wNDI5Njg3NSAxMi44MzU5Mzc1IEMtMzYuOTIxNzk2ODggMTEuOTA5MTAxNTYgLTM2LjgwMDYyNSAxMC45ODIyNjU2MiAtMzYuNjc1NzgxMjUgMTAuMDI3MzQzNzUgQy0zNi41MDgyMDMxMyA4LjgyOTgwNDY5IC0zNi4zNDA2MjUgNy42MzIyNjU2MyAtMzYuMTY3OTY4NzUgNi4zOTg0Mzc1IEMtMzYuMDA1NTQ2ODggNS4yMDM0NzY1NiAtMzUuODQzMTI1IDQuMDA4NTE1NjMgLTM1LjY3NTc4MTI1IDIuNzc3MzQzNzUgQy0zNS40NjY5NTMxMyAxLjgwNjY3OTY5IC0zNS4yNTgxMjUgMC44MzYwMTU2MyAtMzUuMDQyOTY4NzUgLTAuMTY0MDYyNSBDLTM0LjM4Mjk2ODc1IC0wLjQ5NDA2MjUgLTMzLjcyMjk2ODc1IC0wLjgyNDA2MjUgLTMzLjA0Mjk2ODc1IC0xLjE2NDA2MjUgQy0zMC4wNzc2OTExNyAxLjI4MTI3NiAtMjkuNDg3MTQ2NjEgMy4yODE5NjA5NyAtMjguODU1NDY4NzUgNy4wMjM0Mzc1IEMtMjguNjk2OTE0MDYgNy45MjQ0OTIxOSAtMjguNTM4MzU5MzggOC44MjU1NDY4OCAtMjguMzc1IDkuNzUzOTA2MjUgQy0yOC4yNjU0Mjk2OSAxMC40NDA5NzY1NiAtMjguMTU1ODU5MzcgMTEuMTI4MDQ2ODcgLTI4LjA0Mjk2ODc1IDExLjgzNTkzNzUgQy0yNy4xMjUxNTYyNSAxMS45MzM5MDYyNSAtMjYuMjA3MzQzNzUgMTIuMDMxODc1IC0yNS4yNjE3MTg3NSAxMi4xMzI4MTI1IEMtMTguMDQ1MDgyNTkgMTMuMDEyMTUwNTIgLTEyLjIzNzYzMDI1IDEzLjk0OTA5MTA3IC02LjA0Mjk2ODc1IDE3LjgzNTkzNzUgQy00LjY2MTcxODU3IDIwLjU5ODQzNzg2IC00Ljg1MjE3NTY5IDIyLjc4MzI0ODQ5IC01LjA0Mjk2ODc1IDI1LjgzNTkzNzUgQy03LjA0Mjk2ODc1IDI3LjgzNTkzNzUgLTcuMDQyOTY4NzUgMjcuODM1OTM3NSAtMTAuNjY3OTY4NzUgMjcuOTYwOTM3NSBDLTExLjc4MTcxODc1IDI3LjkxOTY4NzUgLTEyLjg5NTQ2ODc1IDI3Ljg3ODQzNzUgLTE0LjA0Mjk2ODc1IDI3LjgzNTkzNzUgQy0xMy4zODI5Njg3NSAyNi41MTU5Mzc1IC0xMi43MjI5Njg3NSAyNS4xOTU5Mzc1IC0xMi4wNDI5Njg3NSAyMy44MzU5Mzc1IEMtMTUuNzk1MjI3MTUgMjIuMTc5MDk2MTMgLTE5LjMwNjQ5OTM2IDIxLjMzMzg1NTg3IC0yMy4zNTU0Njg3NSAyMC43MTA5Mzc1IEMtMjUuMjMyMzQzNzUgMjAuNDIyMTg3NSAtMjcuMTA5MjE4NzUgMjAuMTMzNDM3NSAtMjkuMDQyOTY4NzUgMTkuODM1OTM3NSBDLTI4LjU0Nzk2ODc1IDI4LjI1MDkzNzUgLTI4LjU0Nzk2ODc1IDI4LjI1MDkzNzUgLTI4LjA0Mjk2ODc1IDM2LjgzNTkzNzUgQy0xMi4wNjE3Nzk5MSAzNy4zODI2NDE3MiAtMTIuMDYxNzc5OTEgMzcuMzgyNjQxNzIgMi4wODIwMzEyNSAzMC42NDg0Mzc1IEM0Ljc2MDcwNTQxIDI2LjYzMDQyNjI2IDQuNzc1MjY3NDcgMjMuNTI1MDYwNDMgMy45NTcwMzEyNSAxOC44MzU5Mzc1IEMxLjAxMTM1NTYzIDguNTI2MDcyODEgLTguODY3NTEyMiAyLjM4NDg3MDU4IC0xNy43MzQzNzUgLTIuNTYyNSBDLTMxLjY3NjMzMzk0IC05LjMxMTI2NDA3IC00NS42NDMxNzQyMiAtMTEuNTY4NzI4NjMgLTYxLjA0Mjk2ODc1IC0xMS4xNjQwNjI1IEMtNjEuMDQyOTY4NzUgLTEwLjE3NDA2MjUgLTYxLjA0Mjk2ODc1IC05LjE4NDA2MjUgLTYxLjA0Mjk2ODc1IC04LjE2NDA2MjUgQy02My4wMjI5Njg3NSAtOC4xNjQwNjI1IC02NS4wMDI5Njg3NSAtOC4xNjQwNjI1IC02Ny4wNDI5Njg3NSAtOC4xNjQwNjI1IEMtNjcuNzkyOTY4NzUgLTkuOTE0MDYyNSAtNjcuNzkyOTY4NzUgLTkuOTE0MDYyNSAtNjguMDQyOTY4NzUgLTEyLjE2NDA2MjUgQy02NS45Njg1NDMxOCAtMTUuNTIyNjU2MjggLTYzLjQ3ODY1NTM5IC0xNi41NTA0NzkzNSAtNTkuNzkyOTY4NzUgLTE3LjQ3NjU2MjUgQy0zOS4xODA0NTMyNSAtMjAuODM2MzExNzIgLTE1Ljg1MjQ2NDU2IC0xMy4zOTczMDI3NCAwIDAgWiBNLTQ3LjM1NTQ2ODc1IDIwLjgzNTkzNzUgQy00OC4yMzg0NzY1NiAyMS4wMjE1NjI1IC00OS4xMjE0ODQzOCAyMS4yMDcxODc1IC01MC4wMzEyNSAyMS4zOTg0Mzc1IEMtNTAuNjk1MTE3MTkgMjEuNTQyODEyNSAtNTEuMzU4OTg0MzcgMjEuNjg3MTg3NSAtNTIuMDQyOTY4NzUgMjEuODM1OTM3NSBDLTUyLjUwMDI0MDQ0IDI1LjcyNDc4Mzk5IC01Mi41MDAyNDA0NCAyNS43MjQ3ODM5OSAtNTAuNTAzOTA2MjUgMjcuNDY4NzUgQy00Ni40NjI2MDg1IDMwLjM1OTcxNTgxIC00Mi45NDE1MjEwNyAzMi42MTEyOTk0MiAtMzguMDQyOTY4NzUgMzMuODM1OTM3NSBDLTM2LjcwMzk1MDgzIDMyLjcyNDY3MDkxIC0zNi43MDM5NTA4MyAzMi43MjQ2NzA5MSAtMzYuOTQ1MzEyNSAyOS44OTQ1MzEyNSBDLTM2Ljk1NjkxNDA2IDI4LjY5OTU3MDMxIC0zNi45Njg1MTU2MyAyNy41MDQ2MDkzOCAtMzYuOTgwNDY4NzUgMjYuMjczNDM3NSBDLTM2Ljk4OTQ5MjE5IDI1LjA3NTg5ODQ0IC0zNi45OTg1MTU2MiAyMy44NzgzNTkzOCAtMzcuMDA3ODEyNSAyMi42NDQ1MzEyNSBDLTM3LjAxOTQxNDA2IDIxLjcxNzY5NTMxIC0zNy4wMzEwMTU2MyAyMC43OTA4NTkzNyAtMzcuMDQyOTY4NzUgMTkuODM1OTM3NSBDLTQwLjYzODE2MTY3IDE5LjczMjI5MjMgLTQzLjg0MDg2MTA3IDIwLjA4NjE1NDUzIC00Ny4zNTU0Njg3NSAyMC44MzU5Mzc1IFogIiBmaWxsPSIjMjIxRTIwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1NTEuMDQyOTY4NzUsNTguMTY0MDYyNSkiLz4KPHBhdGggZD0iTTAgMCBDMy4zIDAgNi42IDAgMTAgMCBDMTMuOTk1NTQ4MTcgOC40NTIxMjExMyAxNi45NDE0Njg4MSAxNy4xNzE5NjY3OSAyMCAyNiBDMjAuMzMgMTcuNDIgMjAuNjYgOC44NCAyMSAwIEMyNC42MyAwIDI4LjI2IDAgMzIgMCBDMzIgMTguNDggMzIgMzYuOTYgMzIgNTYgQzI4IDU3IDI4IDU3IDIwIDU3IEMxNy4zNiA0OS40MSAxNC43MiA0MS44MiAxMiAzNCBDMTEuNjcgNDIuMjUgMTEuMzQgNTAuNSAxMSA1OSBDNS41NTUgNTkuNDk1IDUuNTU1IDU5LjQ5NSAwIDYwIEMwIDQwLjIgMCAyMC40IDAgMCBaICIgZmlsbD0iI0Q4MUYyNSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTk1LDUyKSIvPgo8cGF0aCBkPSJNMCAwIEMxLjE3MDQ2ODc1IDAuMDI3MDcwMzEgMi4zNDA5Mzc1IDAuMDU0MTQwNjMgMy41NDY4NzUgMC4wODIwMzEyNSBDNC40Mzg5MDYyNSAwLjExNjgzNTk0IDUuMzMwOTM3NSAwLjE1MTY0MDYyIDYuMjUgMC4xODc1IEM3LjUzODE4NzMxIDYuMjE4NDU0OTcgOC44MTk3NDQ4OSAxMi4yNTA3NjY0NyAxMC4wOTUyMTQ4NCAxOC4yODQ0MjM4MyBDMTAuNTI5OTIzMzUgMjAuMzM2MjQxNDggMTAuOTY2NDMxOTEgMjIuMzg3Njc4NjMgMTEuNDA0Nzg1MTYgMjQuNDM4NzIwNyBDMTIuMDM1MDI5NTggMjcuMzg5MTUwNjYgMTIuNjU4NzU5NzQgMzAuMzQwODk0MzcgMTMuMjgxMjUgMzMuMjkyOTY4NzUgQzEzLjQ3ODExNDAxIDM0LjIwNzczNDgzIDEzLjY3NDk3ODAzIDM1LjEyMjUwMDkyIDEzLjg3NzgwNzYyIDM2LjA2NDk4NzE4IEMxNC4wNTc5OTQzOCAzNi45MjU1MDE4NiAxNC4yMzgxODExNSAzNy43ODYwMTY1NCAxNC40MjM4MjgxMiAzOC42NzI2MDc0MiBDMTQuNTgzNzEyMTYgMzkuNDI1Mzk0NzQgMTQuNzQzNTk2MTkgNDAuMTc4MTgyMDcgMTQuOTA4MzI1MiA0MC45NTM3ODExMyBDMTUuMjUgNDMuMTg3NSAxNS4yNSA0My4xODc1IDE1LjI1IDQ4LjE4NzUgQzExLjI5IDQ4LjE4NzUgNy4zMyA0OC4xODc1IDMuMjUgNDguMTg3NSBDMi45MiA0NS44Nzc1IDIuNTkgNDMuNTY3NSAyLjI1IDQxLjE4NzUgQy0yLjcgNDEuNTE3NSAtNy42NSA0MS44NDc1IC0xMi43NSA0Mi4xODc1IEMtMTMuNDEgNDQuMTY3NSAtMTQuMDcgNDYuMTQ3NSAtMTQuNzUgNDguMTg3NSBDLTE5LjM3IDQ4LjE4NzUgLTIzLjk5IDQ4LjE4NzUgLTI4Ljc1IDQ4LjE4NzUgQy0yNi44MDgzMTEyNiA0Mi4yMDY0MzQ4NSAtMjQuNzAyMzE0NTggMzYuMzU1OTk3NzMgLTIyLjMxNjQwNjI1IDMwLjUzOTA2MjUgQy0yMS45OTcxOTcxMSAyOS43NTk4NTQ0MyAtMjEuNjc3OTg3OTggMjguOTgwNjQ2MzYgLTIxLjM0OTEwNTgzIDI4LjE3NzgyNTkzIEMtMjAuNjc5NDY4MTMgMjYuNTQ4NjI2IC0yMC4wMDc5ODYzNCAyNC45MjAxODI4OSAtMTkuMzM0NzE2OCAyMy4yOTI0ODA0NyBDLTE4LjY0OTcxMDY3IDIxLjYzMDYwMDMgLTE3Ljk3MDA3MDg4IDE5Ljk2NjQ5ODY1IC0xNy4yOTU2NTQzIDE4LjMwMDI5Mjk3IEMtMTYuMzEzOTk1MTggMTUuODc1MDE3NSAtMTUuMzE3MDg2OTUgMTMuNDU2NTQxMzggLTE0LjMxNjQwNjI1IDExLjAzOTA2MjUgQy0xNC4wMTgzNTU4NyAxMC4yOTUzMjM3OSAtMTMuNzIwMzA1NDggOS41NTE1ODUwOCAtMTMuNDEzMjIzMjcgOC43ODUzMDg4NCBDLTEwLjMyNjYxNzczIDEuNDMzOTIzMTMgLTcuOTE5NDc2MjUgLTAuMjM3NTg0MjkgMCAwIFogTS0zLjc1IDE1LjE4NzUgQy01LjQgMjAuMTM3NSAtNy4wNSAyNS4wODc1IC04Ljc1IDMwLjE4NzUgQy02LjExIDMwLjE4NzUgLTMuNDcgMzAuMTg3NSAtMC43NSAzMC4xODc1IEMtMS40MDM0OTYzMyAyMi42MzcxMTU3OCAtMS40MDM0OTYzMyAyMi42MzcxMTU3OCAtMi43NSAxNS4xODc1IEMtMy4wOCAxNS4xODc1IC0zLjQxIDE1LjE4NzUgLTMuNzUgMTUuMTg3NSBaICIgZmlsbD0iIzIzNDM5QSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTcwLjc1LDUzLjgxMjUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzIuNzg5Mjg3NzggMi4zMDgzNzYwOSAzLjc1MTc2ODg4IDQuMjY1OTI4MzQgNC4yNzM0Mzc1IDcuOTEwMTU2MjUgQzQuNjM2ODE4NzQgMTUuNjExMDQzMzQgMS45NDAyMDM5IDIxLjI4NjM5NDY0IC0yLjc5Njg3NSAyNy4yNjk1MzEyNSBDLTkuMDAxNDUwMzQgMzMuOTU4MDYzNDcgLTE1LjA5NjEwOTIxIDM3LjE0MTAyMzg5IC0yNC4yNSAzNy41IEMtMjguMDQyMTE1NTYgMzcuMzY0OTExOTEgLTI5Ljc2NDgxODA0IDM3LjEzMTcwMTkgLTMzLjEyNSAzNS4yNSBDLTM2LjYxNDUyNjY5IDMxLjA2MjU2Nzk3IC0zNy40NTgyNTE2IDI3Ljc5OTc2MzM3IC0zNy4zMDg1OTM3NSAyMi40Mjk2ODc1IEMtMzYuMzE4MDI0MjMgMTQuNjMwNTE5ODYgLTMxLjc1MTQwMDU4IDguMTU2MDQwNzUgLTI2IDMgQy0xNy42OTY1MDc2NiAtMi42NTI1NDYzMSAtOS4yMjAwNTQ5MyAtNS42NTc3NjA5OCAwIDAgWiAiIGZpbGw9IiMwNjg4MkYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIwNDUsNzkpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuNzQ5ODUzMjUgLTAuMDg3MTc0NyA3LjQ5OTQ0NTU1IC0wLjE0MDQ1MDAzIDExLjI1IC0wLjE4NzUgQzEyLjMxMzQ3NjU2IC0wLjIxMjYzNjcyIDEzLjM3Njk1MzEyIC0wLjIzNzc3MzQ0IDE0LjQ3MjY1NjI1IC0wLjI2MzY3MTg4IEMxNS40OTc0NjA5NCAtMC4yNzMzMzk4NCAxNi41MjIyNjU2MyAtMC4yODMwMDc4MSAxNy41NzgxMjUgLTAuMjkyOTY4NzUgQzE4LjUyMDc1MTk1IC0wLjMwODY3OTIgMTkuNDYzMzc4OTEgLTAuMzI0Mzg5NjUgMjAuNDM0NTcwMzEgLTAuMzQwNTc2MTcgQzIzLjU2MjEwMzM5IDAuMDc0NjIyNTkgMjQuODI1NjM1MDMgMC43MTY2NzQ2NSAyNyAzIEMyNy45MTMwODU5NCA1LjYzNTQ5ODA1IDI3LjkxMzA4NTk0IDUuNjM1NDk4MDUgMjguNDg0Mzc1IDguNzYxNzE4NzUgQzI4LjgwMzQxNzk3IDEwLjQzOTExMTMzIDI4LjgwMzQxNzk3IDEwLjQzOTExMTMzIDI5LjEyODkwNjI1IDEyLjE1MDM5MDYyIEMyOS4zMzM4NjcxOSAxMy4zMTc2MzY3MiAyOS41Mzg4MjgxMiAxNC40ODQ4ODI4MSAyOS43NSAxNS42ODc1IEMyOS45NzA0Mjk2OSAxNi44NjYzNDc2NiAzMC4xOTA4NTkzOCAxOC4wNDUxOTUzMSAzMC40MTc5Njg3NSAxOS4yNTk3NjU2MiBDMzAuOTYwMTAyNjQgMjIuMTcwNzg4OTEgMzEuNDg2NzY4MjIgMjUuMDgzNzY2MzEgMzIgMjggQzM1LjA3NTc1MDg3IDIxLjMyMzQ4NDU3IDM4LjA0NTYyMTcyIDE0LjYyMjgwNzQ2IDQwLjgxMjUgNy44MTI1IEM0MS4xMjM4MDg1OSA3LjA1MTMwODU5IDQxLjQzNTExNzE5IDYuMjkwMTE3MTkgNDEuNzU1ODU5MzggNS41MDU4NTkzOCBDNDIuNTA1ODE1MTcgMy42NzEzNTIxMyA0My4yNTMxOTk4MiAxLjgzNTc5NDExIDQ0IDAgQzQ4LjI5IDAgNTIuNTggMCA1NyAwIEM1NS44NzQ5NzQ1OCA2Ljc1MDE1MjU0IDU1Ljg3NDk3NDU4IDYuNzUwMTUyNTQgNTQuMzQxNzk2ODggMTAuMzIxMjg5MDYgQzU0LjAwNDc0NzMxIDExLjExNTIxMDU3IDUzLjY2NzY5Nzc1IDExLjkwOTEzMjA4IDUzLjMyMDQzNDU3IDEyLjcyNzExMTgyIEM1Mi45NTY4Nzg2NiAxMy41NjQ4MjExNyA1Mi41OTMzMjI3NSAxNC40MDI1MzA1MiA1Mi4yMTg3NSAxNS4yNjU2MjUgQzUxLjg0NTIwMzg2IDE2LjE0MDIzMzc2IDUxLjQ3MTY1NzcxIDE3LjAxNDg0MjUzIDUxLjA4Njc5MTk5IDE3LjkxNTk1NDU5IEM0OS44OTczNDQ2IDIwLjY5NjY1Mjc4IDQ4LjY5ODc0NTQ1IDIzLjQ3MzI5OTM5IDQ3LjUgMjYuMjUgQzQ2LjY5MzQyMDAxIDI4LjEzMjU1OTY1IDQ1Ljg4NzQyNDAyIDMwLjAxNTM2OTYzIDQ1LjA4MjAzMTI1IDMxLjg5ODQzNzUgQzQzLjYxMDkxMDIyIDM1LjMzMjU2NDA1IDQyLjEzODAzMjE4IDM4Ljc2NTkwNDg3IDQwLjY1ODIwMzEyIDQyLjE5NjI4OTA2IEM0MC4zNjE0MzY3NyA0Mi44ODQzNDYzMSA0MC4wNjQ2NzA0MSA0My41NzI0MDM1NiAzOS43NTg5MTExMyA0NC4yODEzMTEwNCBDMzkuMjA1MDIxMiA0NS41MzU2OTMxMSAzOC42MTMyMzIxNyA0Ni43NzM1MzU2NyAzOCA0OCBDMzMuMzggNDggMjguNzYgNDggMjQgNDggQzIzLjcxODAxNzU4IDQ2Ljg2OTgxNDQ1IDIzLjQzNjAzNTE2IDQ1LjczOTYyODkxIDIzLjE0NTUwNzgxIDQ0LjU3NTE5NTMxIEMyMi4wOTM1MjM1MyA0MC4zNzQ2MTE1MyAyMS4wMjMxNzA3NiAzNi4xNzg4ODk2NSAxOS45NDcyNjU2MiAzMS45ODQzNzUgQzE5LjQ4NDU3MjAzIDMwLjE2OTg5MDMxIDE5LjAyNjgzOTQ1IDI4LjM1NDEzMjkyIDE4LjU3NDIxODc1IDI2LjUzNzEwOTM4IEMxNy45MjE5MzU4OSAyMy45MjIyNTYxNiAxNy4yNTE4MjE4MSAyMS4zMTI1MzE3MyAxNi41NzgxMjUgMTguNzAzMTI1IEMxNi4yODA5ODYwMiAxNy40ODcyODcyOSAxNi4yODA5ODYwMiAxNy40ODcyODcyOSAxNS45Nzc4NDQyNCAxNi4yNDY4ODcyMSBDMTQuODEwMjA5MzQgMTEuODA0OTMzNDYgMTMuNzk5Njc2MzYgOC44OTA1NzQxMSAxMCA2IEM3LjQ0MzcyNDc1IDQuODk3OTA2NjcgNy40NDM3MjQ3NSA0Ljg5NzkwNjY3IDQuNzUgNC4yNSBDMy44NTc5Njg3NSA0LjAwNzY1NjI1IDIuOTY1OTM3NSAzLjc2NTMxMjUgMi4wNDY4NzUgMy41MTU2MjUgQzEuMzcxNDA2MjUgMy4zNDU0Njg3NSAwLjY5NTkzNzUgMy4xNzUzMTI1IDAgMyBDMCAyLjAxIDAgMS4wMiAwIDAgWiAiIGZpbGw9IiMyMTI5NjUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM2LDU0KSIvPgo8cGF0aCBkPSJNMCAwIEMzLjYzIDAgNy4yNiAwIDExIDAgQzE1IDkuNjI1IDE1IDkuNjI1IDE1IDEzIEMxNS42NiAxMyAxNi4zMiAxMyAxNyAxMyBDMTcuMTkzMzU5MzggMTIuMzk2NzE4NzUgMTcuMzg2NzE4NzUgMTEuNzkzNDM3NSAxNy41ODU5Mzc1IDExLjE3MTg3NSBDMTcuODQ2MzI4MTIgMTAuMzcyNjU2MjUgMTguMTA2NzE4NzUgOS41NzM0Mzc1IDE4LjM3NSA4Ljc1IEMxOC43NTc4NTE1NiA3LjU2NjY0MDYyIDE4Ljc1Nzg1MTU2IDcuNTY2NjQwNjIgMTkuMTQ4NDM3NSA2LjM1OTM3NSBDMjAgNCAyMCA0IDIyIDAgQzI1LjYzIDAgMjkuMjYgMCAzMyAwIEMzMS42MTIzNzc3OCA0LjQ4OTM2NjAxIDMwLjA5OTAyNzU4IDguODM1MTMyMDUgMjguMjA3MDMxMjUgMTMuMTM2NzE4NzUgQzI3LjcyNjY1NDA1IDE0LjI0Mjg1NTIyIDI3LjcyNjY1NDA1IDE0LjI0Mjg1NTIyIDI3LjIzNjU3MjI3IDE1LjM3MTMzNzg5IEMyNi41ODgzNzkzNiAxNi44NTIwMjc5OSAyNS45MjY0NjI4MyAxOC4zMjY4MDAwNiAyNS4yNDk3NTU4NiAxOS43OTQ2Nzc3MyBDMjEuMjM0Nzg2MTQgMjkuMDI3NTEyNzMgMjUuMDc1MDY3NzkgMzYuMzYzMTg5NTkgMjguNTYyNSA0NS4yNSBDMjkuNDAxNTk1MTQgNDcuMzk5MzA1OTEgMzAuMjM2NDQwNzggNDkuNTUwMjc3MTYgMzEuMDY2NDA2MjUgNTEuNzAzMTI1IEMzMS40MzcwOTIyOSA1Mi42NDgzMzAwOCAzMS44MDc3NzgzMiA1My41OTM1MzUxNiAzMi4xODk2OTcyNyA1NC41NjczODI4MSBDMzMgNTcgMzMgNTcgMzMgNjAgQzMxLjU2MTYzMjQ5IDU5Ljg4NTQxMzA3IDMwLjEyNDI5MDM0IDU5Ljc1NzkwODg0IDI4LjY4NzUgNTkuNjI1IEMyNy44ODY5OTIxOSA1OS41NTUzOTA2MyAyNy4wODY0ODQzOCA1OS40ODU3ODEyNSAyNi4yNjE3MTg3NSA1OS40MTQwNjI1IEMyNCA1OSAyNCA1OSAyMSA1NyBDMTkuNjEzMjgxMjUgNTMuOTYwOTM3NSAxOS42MTMyODEyNSA1My45NjA5Mzc1IDE4LjMxMjUgNTAuMzc1IEMxNy44NzU1MDc4MSA0OS4xODY0ODQzNyAxNy40Mzg1MTU2MyA0Ny45OTc5Njg3NSAxNi45ODgyODEyNSA0Ni43NzM0Mzc1IEMxNi42NjIxNDg0NCA0NS44NTgyMDMxMyAxNi4zMzYwMTU2MyA0NC45NDI5Njg3NSAxNiA0NCBDMTQuMjExNzgyMjYgNDYuNjgyMzI2NjEgMTIuNzk4NTczOTYgNDkuMzAyODg5NjEgMTEuMzc1IDUyLjE4NzUgQzEwLjkyODk4NDM4IDUzLjA4ODU1NDY5IDEwLjQ4Mjk2ODc1IDUzLjk4OTYwOTM4IDEwLjAyMzQzNzUgNTQuOTE3OTY4NzUgQzkuNjg1NzAzMTIgNTUuNjA1MDM5MDYgOS4zNDc5Njg3NSA1Ni4yOTIxMDkzNyA5IDU3IEM1LjcgNTYuNjcgMi40IDU2LjM0IC0xIDU2IEMtMC4zOTQ5ODQ5MyA0OS4xNzY3NzQ1NCAyLjkyNjY1MjAyIDQzLjQ2Njc3Nzg3IDUuOTM3NSAzNy40MzE2NDA2MiBDOC40NDU2MTQ0IDMyLjE0NzgyNjM3IDkuNzA2Nzk0NDIgMjguODM0MjUxNjYgOCAyMyBDNi43NTQ5MDE0NiAxOS41MzQxMTc5NSA1LjM3Mjc0NjExIDE2LjE0MTA0NzgxIDMuOTM3NSAxMi43NSBDMy4xOTE5Mjc4NyAxMC45NzU5MjA2OSAyLjQ1MDgyOTQ5IDkuMTk5OTUyNjcgMS43MTQ4NDM3NSA3LjQyMTg3NSBDMS4zODYwNTIyNSA2LjY0NDI0ODA1IDEuMDU3MjYwNzQgNS44NjY2MjEwOSAwLjcxODUwNTg2IDUuMDY1NDI5NjkgQzAgMyAwIDMgMCAwIFogIiBmaWxsPSIjRDgxRTI1IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMTgzLDUyKSIvPgo8cGF0aCBkPSJNMCAwIEMtMC42NiAzLjYzIC0xLjMyIDcuMjYgLTIgMTEgQy0yLjgyNSAxMC44MzUgLTMuNjUgMTAuNjcgLTQuNSAxMC41IEMtMTEuNDA5NDk0MjQgOS40MzI1NTU0MyAtMTEuNDA5NDk0MjQgOS40MzI1NTU0MyAtMTggMTEgQy0xNy45MDQ4MDU0NiAxMi44OTU3NjM2NiAtMTcuOTA0ODA1NDYgMTIuODk1NzYzNjYgLTE3IDE1IEMtMTQuNTcyODYxMyAxNi44NzM4MTgyMSAtMTQuNTcyODYxMyAxNi44NzM4MTgyMSAtMTEuNjI1IDE4LjUgQy03LjkzODczNzE5IDIwLjYzOTc4MzE2IC01LjIyOTM2OTIyIDIyLjMxNTc1MDIyIC0zIDI2IEMtMS41MDg4MTc1MSAzMS42NDUxOTA4NSAtMi4xNzg0MTgzNiAzNC45MjExNTMwNiAtNSA0MCBDLTkuMzQ2NDcyNTcgNDUuMTQ3MTM4NTcgLTEzLjQ5MjA4MjkgNDcuMDc2ODA4NDEgLTIwLjEyNSA0Ny43NSBDLTI1Ljk4NTQzMDQyIDQ4LjIyMDQyOTExIC0zMS4zMDM1NDk3NiA0Ny4zMzMyMTE3NiAtMzcgNDYgQy0zOC4wOTg5ODcwMiA0Mi43MDMwMzg5NSAtMzcuODcxMjQ0NDQgNDEuNTk1MDUwOTcgLTM3LjA2MjUgMzguMzEyNSBDLTM2Ljg2Nzg1MTU2IDM3LjUwNDI1NzgxIC0zNi42NzMyMDMxMyAzNi42OTYwMTU2MyAtMzYuNDcyNjU2MjUgMzUuODYzMjgxMjUgQy0zNi4zMTY2Nzk2OSAzNS4yNDgzOTg0NCAtMzYuMTYwNzAzMTIgMzQuNjMzNTE1NjMgLTM2IDM0IEMtMzQuODQ1IDM0LjMzIC0zMy42OSAzNC42NiAtMzIuNSAzNSBDLTI4LjE4MjA3NzU3IDM2LjA3MzcyODQ5IC0yNC40NDM3NDM0NCAzNi4zMDEyNzA3NCAtMjAgMzYgQy0xOS4wMSAzNS4zNCAtMTguMDIgMzQuNjggLTE3IDM0IEMtMTcuMTc4MjU1OTkgMzIuMDY3MDg1MjEgLTE3LjE3ODI1NTk5IDMyLjA2NzA4NTIxIC0xOCAzMCBDLTE5LjkwMzM3ODEzIDI4LjYwODcxNTU2IC0xOS45MDMzNzgxMyAyOC42MDg3MTU1NiAtMjIuMjUgMjcuNTYyNSBDLTMxLjA3MTA4MzE3IDIyLjkxMzE3MTEzIC0zMS4wNzEwODMxNyAyMi45MTMxNzExMyAtMzIuNjYwMTU2MjUgMTcuOTI5Njg3NSBDLTMzLjUwOTcyNjg3IDEzLjA2MzIxNTAxIC0zMy4wODExMzgwMSA5LjYxMDg4NDM3IC0zMC4yOTI5Njg3NSA1LjUgQy0yMi4zNjg4Mzc3IC0zLjY5Mjk0OTYyIC0xMC42NjIyMzUzMyAtMi42NjU1NTg4MyAwIDAgWiAiIGZpbGw9IiMyMjM5ODUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE0Niw1NSkiLz4KPHBhdGggZD0iTTAgMCBDNC4yNTM4MDEzOCAxLjUxOTIxNDc4IDUuODUwNjA1NjkgNC4xMzEwOTAyNCA4IDggQzEwLjIxNjIxNjM0IDE0LjEzODE3MjIyIDExLjE3ODUwNDM3IDIwLjIzMzA3NjcgOC41NjI1IDI2LjM3NSBDNyAyOSA3IDI5IDYgMzAgQzMuNjM2NzE4NzUgMzAuMjk2ODc1IDMuNjM2NzE4NzUgMzAuMjk2ODc1IDEgMzAgQy0wLjczMDQ2ODc1IDI4LjM5MDYyNSAtMC43MzA0Njg3NSAyOC4zOTA2MjUgLTIuMTg3NSAyNi4yNSBDLTIuOTIwMzMyMDMgMjUuMjA1ODU5MzggLTIuOTIwMzMyMDMgMjUuMjA1ODU5MzggLTMuNjY3OTY4NzUgMjQuMTQwNjI1IEMtNC45MTMwODMwNCAyMi4xMzk2Nzg4OCAtNS45ODkwNDQ2MiAyMC4xMjczMTg0MyAtNyAxOCBDLTcuMTk5MTYwMTYgMTkuMjY0NTcwMzEgLTcuMTk5MTYwMTYgMTkuMjY0NTcwMzEgLTcuNDAyMzQzNzUgMjAuNTU0Njg3NSBDLTcuNTc4OTQ1MzEgMjEuNjUwMzkwNjIgLTcuNzU1NTQ2ODggMjIuNzQ2MDkzNzUgLTcuOTM3NSAyMy44NzUgQy04LjExMTUyMzQ0IDI0Ljk2NTU0Njg4IC04LjI4NTU0Njg4IDI2LjA1NjA5Mzc1IC04LjQ2NDg0Mzc1IDI3LjE3OTY4NzUgQy05IDMwIC05IDMwIC0xMCAzMiBDLTExLjg3NSAzMS43NSAtMTEuODc1IDMxLjc1IC0xNCAzMSBDLTE1LjI1IDI4LjkzNzUgLTE1LjI1IDI4LjkzNzUgLTE2IDI3IEMtMTYuNDMzMTI1IDI3LjQ3NDM3NSAtMTYuODY2MjUgMjcuOTQ4NzUgLTE3LjMxMjUgMjguNDM3NSBDLTIxLjI2ODUzMTg1IDMyLjEwMDQ5MjQ1IC0yNi43NTQ4NDI1IDMxLjMyNjM3NjY4IC0zMS44MjAzMTI1IDMxLjI4MTI1IEMtMzYuMjA3MDY0MDkgMzAuODkzMjMyNjYgLTM3LjkwMzMwOTI4IDMwLjA5NjY5MDcyIC00MSAyNyBDLTQyLjU2MjUgMjQuNSAtNDIuNTYyNSAyNC41IC00MyAyMiBDLTQxLjYyNSAxOS42ODc1IC00MS42MjUgMTkuNjg3NSAtNDAgMTggQy00MS4zMiAxNy4wMSAtNDIuNjQgMTYuMDIgLTQ0IDE1IEMtNDQgMTEuNzUgLTQ0IDExLjc1IC00MyA4IEMtMzcuODIzNzMwOTQgMy44MDUyMDc0OSAtMzIuMDE2MTEwNTQgMy40NTA1OTcyMiAtMjUuNjI1IDMuNjg3NSBDLTI0LjgxOTMzNTk0IDMuNjk3MTY3OTcgLTI0LjAxMzY3MTg4IDMuNzA2ODM1OTQgLTIzLjE4MzU5Mzc1IDMuNzE2Nzk2ODggQy0xNy4zNDEzMjczMSAzLjgyOTMzNjM1IC0xNy4zNDEzMjczMSAzLjgyOTMzNjM1IC0xNSA1IEMtMTUuMzEyNSA2LjkzNzUgLTE1LjMxMjUgNi45Mzc1IC0xNiA5IEMtMjAuMjg5NzAxMzQgMTAuNDI5OTAwNDUgLTI0LjU3MTM0MzI0IDEwLjQzODEyMTc2IC0yOS4wNjY0MDYyNSAxMC43MTg3NSBDLTMxLjkzMTY1NzQ2IDEwLjgxNTkwNjYxIC0zMS45MzE2NTc0NiAxMC44MTU5MDY2MSAtMzQgMTIgQy0zMy4wMzU3ODEyNSAxMi4xMDk1NzAzMSAtMzIuMDcxNTYyNSAxMi4yMTkxNDA2MiAtMzEuMDc4MTI1IDEyLjMzMjAzMTI1IEMtMjkuODE0ODQzNzUgMTIuNDkwNTg1OTQgLTI4LjU1MTU2MjUgMTIuNjQ5MTQwNjMgLTI3LjI1IDEyLjgxMjUgQy0yNS4zNzA1NDY4NyAxMy4wMzg3MzA0NyAtMjUuMzcwNTQ2ODcgMTMuMDM4NzMwNDcgLTIzLjQ1MzEyNSAxMy4yNjk1MzEyNSBDLTIwLjA1NDQ1OTUzIDEzLjk4ODQ3OTcxIC0xOC40MjUxMDM5MSAxNC41NjkwMDk5MSAtMTYgMTcgQy0xNS42NyAxNy45OSAtMTUuMzQgMTguOTggLTE1IDIwIEMtMTQuODc4ODI4MTMgMTkuMzI0NTMxMjUgLTE0Ljc1NzY1NjI1IDE4LjY0OTA2MjUgLTE0LjYzMjgxMjUgMTcuOTUzMTI1IEMtMTQuNDY1MjM0MzggMTcuMDYxMDkzNzUgLTE0LjI5NzY1NjI1IDE2LjE2OTA2MjUgLTE0LjEyNSAxNS4yNSBDLTEzLjk2MjU3ODEzIDE0LjM2ODI4MTI1IC0xMy44MDAxNTYyNSAxMy40ODY1NjI1IC0xMy42MzI4MTI1IDEyLjU3ODEyNSBDLTEzLjAzMjAzNzM2IDEwLjEzMDUyMjU2IC0xMi4yMjAwMjg4MyA4LjE5NDAwMTQzIC0xMSA2IEMtOC43Njk1MzEyNSA2LjEyMTA5Mzc1IC04Ljc2OTUzMTI1IDYuMTIxMDkzNzUgLTYgNyBDLTMuNzYxNzE4NzUgOS43MjI2NTYyNSAtMy43NjE3MTg3NSA5LjcyMjY1NjI1IC0xLjY4NzUgMTMuMDYyNSBDLTAuOTkwMTE3MTkgMTQuMTY3MjI2NTYgLTAuMjkyNzM0MzggMTUuMjcxOTUzMTIgMC40MjU3ODEyNSAxNi40MTAxNTYyNSBDMS4yMDUwMTk1MyAxNy42OTIxMjg5MSAxLjIwNTAxOTUzIDE3LjY5MjEyODkxIDIgMTkgQzEuODAwODM5ODQgMTcuODA1MDM5MDYgMS44MDA4Mzk4NCAxNy44MDUwMzkwNiAxLjU5NzY1NjI1IDE2LjU4NTkzNzUgQzEuMDY1MTA0MTcgMTMuMzkwNjI1IDAuNTMyNTUyMDggMTAuMTk1MzEyNSAwIDcgQy0wLjIwNzUzOTA2IDUuODk5MTQwNjMgLTAuNDE1MDc4MTMgNC43OTgyODEyNSAtMC42Mjg5MDYyNSAzLjY2NDA2MjUgQy0wLjc1MTM2NzE5IDIuNzg0OTIxODcgLTAuODczODI4MTMgMS45MDU3ODEyNSAtMSAxIEMtMC42NyAwLjY3IC0wLjM0IDAuMzQgMCAwIFogTS0yOCAxOCBDLTI2LjE4Nzc3NDY2IDIwLjA2MjQ5OTQgLTI2LjE4Nzc3NDY2IDIwLjA2MjQ5OTQgLTI0IDIyIEMtMjMuMDEgMjIgLTIyLjAyIDIyIC0yMSAyMiBDLTIxLjMzIDIxLjAxIC0yMS42NiAyMC4wMiAtMjIgMTkgQy0yNC45NyAxOC41MDUgLTI0Ljk3IDE4LjUwNSAtMjggMTggWiBNLTM5IDIyIEMtMzkgMjIuNjYgLTM5IDIzLjMyIC0zOSAyNCBDLTM2LjAzIDI0LjMzIC0zMy4wNiAyNC42NiAtMzAgMjUgQy0zMi4zNTk2ODc0NCAyMi45MDI1MDAwNSAtMzMuNTQ2MTY5OTQgMjIuMDMwOTQyOTYgLTM2Ljc1IDIxLjgxMjUgQy0zNy40OTI1IDIxLjg3NDM3NSAtMzguMjM1IDIxLjkzNjI1IC0zOSAyMiBaICIgZmlsbD0iIzIyMUUyMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjIwLDY3KSIvPgo8cGF0aCBkPSJNMCAwIEMyLjA1NDY4NzUgLTAuMTk5MjE4NzUgMi4wNTQ2ODc1IC0wLjE5OTIxODc1IDUuODY3MTg3NSAwLjM2MzI4MTI1IEM4LjI4Mjg5NDcyIDIuNDI4NzM2NjggMTAuMDk2NDE2NDkgNC43MzM5NTQ2IDExLjg2NzE4NzUgNy4zNjMyODEyNSBDMTIuMTQ5NDkyMTkgNi44NDYzNjcxOSAxMi40MzE3OTY4NyA2LjMyOTQ1MzEzIDEyLjcyMjY1NjI1IDUuNzk2ODc1IEMxNC4yNzE2ODgxMyAzLjQ3NTU5ODQ4IDE1LjU3MTg3NDIgMS45NzEyNTAyOCAxNy44NjcxODc1IDAuMzYzMjgxMjUgQzI2LjQ3NDM3MzUgLTAuNzg0MzQzNTUgMzQuOTQxNzAyNzcgMi4yOTMwNDg0MyA0Mi44NjcxODc1IDUuMzYzMjgxMjUgQzQxLjE2MTc1MzAxIDkuMTA0MjM0MzIgMzkuMjkzODYwOCAxMS4wMjMxMTQxMiAzNS44NjcxODc1IDEzLjM2MzI4MTI1IEMzNC44NzcxODc1IDEzLjM2MzI4MTI1IDMzLjg4NzE4NzUgMTMuMzYzMjgxMjUgMzIuODY3MTg3NSAxMy4zNjMyODEyNSBDMzIuMjA3MTg3NSAxMi4zNzMyODEyNSAzMS41NDcxODc1IDExLjM4MzI4MTI1IDMwLjg2NzE4NzUgMTAuMzYzMjgxMjUgQzI4LjY3MjY0MDY5IDkuNzgzMzQ0MjYgMjguNjcyNjQwNjkgOS43ODMzNDQyNiAyNi4yNDIxODc1IDkuNjc1NzgxMjUgQzI1LjQyNDkyMTg4IDkuNjEwMDM5MDYgMjQuNjA3NjU2MjUgOS41NDQyOTY4OCAyMy43NjU2MjUgOS40NzY1NjI1IEMyMi44MjU4OTg0NCA5LjQyMDQ4ODI4IDIyLjgyNTg5ODQ0IDkuNDIwNDg4MjggMjEuODY3MTg3NSA5LjM2MzI4MTI1IEMyMS43NTg4NzYwNCA5Ljk5OTk5MjUyIDIxLjY1MDU2NDU4IDEwLjYzNjcwMzggMjEuNTM4OTcwOTUgMTEuMjkyNzA5MzUgQzIwLjQxMzg1NTQzIDE3Ljg5NjI5MTI1IDE5LjI3NjQ4MDM1IDI0LjQ5NzY3NjE0IDE4LjEzMTgzNTk0IDMxLjA5NzkwMDM5IEMxNy43MDU4MDczNiAzMy41NjQxNTA1NiAxNy4yODI5NDkwNyAzNi4wMzA5NTA1MSAxNi44NjMyODEyNSAzOC40OTgyOTEwMiBDMTYuMjYwODYwODcgNDIuMDM2ODAwMzYgMTUuNjQ3MjEwNTMgNDUuNTczMjAwOSAxNS4wMzEyNSA0OS4xMDkzNzUgQzE0Ljg0NDcwODU2IDUwLjIxOTc3NjQ2IDE0LjY1ODE2NzExIDUxLjMzMDE3NzkyIDE0LjQ2NTk3MjkgNTIuNDc0MjI3OTEgQzE0LjI4NTkzNzE5IDUzLjQ5NTIxMDcyIDE0LjEwNTkwMTQ5IDU0LjUxNjE5MzU0IDEzLjkyMDQxMDE2IDU1LjU2ODExNTIzIEMxMy42ODcyNDU5NCA1Ni45MjM3OTg2IDEzLjY4NzI0NTk0IDU2LjkyMzc5ODYgMTMuNDQ5MzcxMzQgNTguMzA2ODY5NTEgQzEzLjI1NzI1MDY3IDU4Ljk4NTQ4NTM4IDEzLjA2NTEzIDU5LjY2NDEwMTI2IDEyLjg2NzE4NzUgNjAuMzYzMjgxMjUgQzExLjg3NzE4NzUgNjAuODU4MjgxMjUgMTEuODc3MTg3NSA2MC44NTgyODEyNSAxMC44NjcxODc1IDYxLjM2MzI4MTI1IEM5LjU4MDQ1Mjg0IDU0LjQ1OTA5MjQzIDguMjk5Mjc3MDIgNDcuNTUzODg4ODYgNy4wMjE5NzI2NiA0MC42NDc5NDkyMiBDNi41ODY3MzE3NyAzOC4yOTg0Mjc0MSA2LjE1MDIxNTc5IDM1Ljk0OTE0MTQ1IDUuNzEyNDAyMzQgMzMuNjAwMDk3NjYgQzUuMDgzNTYyMzcgMzAuMjI0ODk1MzcgNC40NTkzMDI5NCAyNi44NDg4NzMzNSAzLjgzNTkzNzUgMjMuNDcyNjU2MjUgQzMuNTQwNjQxNDggMjEuODk1OTAxMTggMy41NDA2NDE0OCAyMS44OTU5MDExOCAzLjIzOTM3OTg4IDIwLjI4NzI5MjQ4IEMzLjA1OTE5MzEyIDE5LjMwNjU3Nzc2IDIuODc5MDA2MzUgMTguMzI1ODYzMDQgMi42OTMzNTkzOCAxNy4zMTU0Mjk2OSBDMi41MzM0NzUzNCAxNi40NTM4MzI0IDIuMzczNTkxMzEgMTUuNTkyMjM1MTEgMi4yMDg4NjIzIDE0LjcwNDUyODgxIEMxLjg2NzE4NzUgMTIuMzYzMjgxMjUgMS44NjcxODc1IDEyLjM2MzI4MTI1IDEuODY3MTg3NSA4LjM2MzI4MTI1IEMtMS43NjI4MTI1IDkuMDIzMjgxMjUgLTUuMzkyODEyNSA5LjY4MzI4MTI1IC05LjEzMjgxMjUgMTAuMzYzMjgxMjUgQy05LjQ2MjgxMjUgMTEuMzUzMjgxMjUgLTkuNzkyODEyNSAxMi4zNDMyODEyNSAtMTAuMTMyODEyNSAxMy4zNjMyODEyNSBDLTE1LjA4OTc3ODMxIDEyLjEyNDAzOTggLTE3LjI0OTM5NzE2IDEwLjU3NzUwMzY3IC0yMC4xMzI4MTI1IDYuMzYzMjgxMjUgQy0xMy40NzU0Nzc3IDMuMTIxMTc0OTQgLTcuMjY2ODA3MzkgMS4yMzc3NTI5MSAwIDAgWiAiIGZpbGw9IiNFODIwMjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE3NzUuMTMyODEyNSwzNS42MzY3MTg3NSkiLz4KPHBhdGggZD0iTTAgMCBDOC41OCAwIDE3LjE2IDAgMjYgMCBDMjYgMy4zIDI2IDYuNiAyNiAxMCBDMjAuNzIgMTAgMTUuNDQgMTAgMTAgMTAgQzEwIDEzLjYzIDEwIDE3LjI2IDEwIDIxIEMxMy45NiAyMSAxNy45MiAyMSAyMiAyMSBDMjIgMjQuMyAyMiAyNy42IDIyIDMxIEMxOC4wNCAzMSAxNC4wOCAzMSAxMCAzMSBDMTAgMzUuMjkgMTAgMzkuNTggMTAgNDQgQzE3LjkyIDQzLjUwNSAxNy45MiA0My41MDUgMjYgNDMgQzI2IDQ2LjMgMjYgNDkuNiAyNiA1MyBDMjIuODY0NjI0MDIgNTQuMDQ1MTI1MzMgMjAuMjI4NTQ5MDIgNTQuMzE1Mzc3MTMgMTYuOTM3NSA1NC41NjI1IEMxNS44NzQwMjM0NCA1NC42NDYyODkwNiAxNC44MTA1NDY4OCA1NC43MzAwNzgxMyAxMy43MTQ4NDM3NSA1NC44MTY0MDYyNSBDOS4xNDgzOTI5NSA1NS4wNDIwODc4NCA0LjU3MjAyNDE4IDU1IDAgNTUgQzAgMzYuODUgMCAxOC43IDAgMCBaICIgZmlsbD0iI0Q4MUUyNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAzNSw1MikiLz4KPHBhdGggZD0iTTAgMCBDMS45MTAxNTYyNSAwLjgyMDMxMjUgMS45MTAxNTYyNSAwLjgyMDMxMjUgNC41MzUxNTYyNSAyLjMyMDMxMjUgQzQuNTM1MTU2MjUgNC45NjAzMTI1IDQuNTM1MTU2MjUgNy42MDAzMTI1IDQuNTM1MTU2MjUgMTAuMzIwMzEyNSBDMS43NzIzOTQ0OCA5Ljc5NzYyNzg0IC0wLjc5MDkzMTM1IDkuMjExNjE2NjMgLTMuNDY0ODQzNzUgOC4zMjAzMTI1IEMtNS4wMjYwMjgwMyA4LjI1MjkwMzg1IC02LjU4OTg2ODk1IDguMjM1MTY3OTQgLTguMTUyMzQzNzUgOC4yNTc4MTI1IEMtOC45NjA1ODU5NCA4LjI2NjgzNTk0IC05Ljc2ODgyODEzIDguMjc1ODU5MzcgLTEwLjYwMTU2MjUgOC4yODUxNTYyNSBDLTExLjIxNjQ0NTMxIDguMjk2NzU3ODEgLTExLjgzMTMyODEzIDguMzA4MzU5MzggLTEyLjQ2NDg0Mzc1IDguMzIwMzEyNSBDLTEyLjc5NDg0Mzc1IDkuMzEwMzEyNSAtMTMuMTI0ODQzNzUgMTAuMzAwMzEyNSAtMTMuNDY0ODQzNzUgMTEuMzIwMzEyNSBDLTEyLjU4NDQxNDA2IDExLjcwNzAzMTI1IC0xMS43MDM5ODQzNyAxMi4wOTM3NSAtMTAuNzk2ODc1IDEyLjQ5MjE4NzUgQy05LjYzNTQyOTY5IDEzLjAxMjk2ODc1IC04LjQ3Mzk4NDM4IDEzLjUzMzc1IC03LjI3NzM0Mzc1IDE0LjA3MDMxMjUgQy01LjU1NDUxMTcyIDE0LjgzNjAxNTYzIC01LjU1NDUxMTcyIDE0LjgzNjAxNTYzIC0zLjc5Njg3NSAxNS42MTcxODc1IEMwLjI0MTM3MzEyIDE3LjY4MTI4NjE5IDMuNTY0NTg1NyAxOS42ODc5ODkzIDUuOTEwMTU2MjUgMjMuNjMyODEyNSBDNi45OTYzOTk0NiAyOC4zMDM2NTgzIDYuMzE4NTczOSAzMS44ODQwNDY4MSA0LjAzNTE1NjI1IDM2LjA3MDMxMjUgQy0wLjE5NDIwMDc5IDM5Ljg3NjczMzg0IC00LjYxMjE4MDA4IDQxLjI1NzA5NTU4IC0xMC4yODUxNTYyNSA0MS4zODI4MTI1IEMtMTUuNjc4ODQ0MzEgNDEuMDMwMDkxNzUgLTE5Ljg2NjQ0MTQ4IDQwLjE3ODc3ODc4IC0yNC40NjQ4NDM3NSAzNy4zMjAzMTI1IEMtMjQuNDY0ODQzNzUgMzQuMDIwMzEyNSAtMjQuNDY0ODQzNzUgMzAuNzIwMzEyNSAtMjQuNDY0ODQzNzUgMjcuMzIwMzEyNSBDLTIzLjE2NTQ2ODc1IDI3Ljk4MDMxMjUgLTIxLjg2NjA5Mzc1IDI4LjY0MDMxMjUgLTIwLjUyNzM0Mzc1IDI5LjMyMDMxMjUgQy0xNS41OTQwNTE2OSAzMS41NDQyMDkyNCAtMTEuODI1MTI2MDMgMzEuNjYwNjQ3ODggLTYuNDY0ODQzNzUgMzEuMzIwMzEyNSBDLTYuNDY0ODQzNzUgMzAuMDAwMzEyNSAtNi40NjQ4NDM3NSAyOC42ODAzMTI1IC02LjQ2NDg0Mzc1IDI3LjMyMDMxMjUgQy03LjQxNzQ2MDk0IDI2Ljk1Njc5Njg3IC04LjM3MDA3ODEyIDI2LjU5MzI4MTI1IC05LjM1MTU2MjUgMjYuMjE4NzUgQy0yMi40OTU3MTQwNSAyMS4wMzAxNzczIC0yMi40OTU3MTQwNSAyMS4wMzAxNzczIC0yNS40NjQ4NDM3NSAxNS4zMjAzMTI1IEMtMjYuMjE3MDIwNTkgMTEuNDI4OTQ4NjQgLTI1LjgyMjM5NTM5IDguMjE0MTkxNTkgLTI0LjMzOTg0Mzc1IDQuNTA3ODEyNSBDLTE4LjQ5MTUxODczIC0yLjMxNTIzMzM1IC04LjEzNzk4MzIgLTIuMjQ0MDcxNDQgMCAwIFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxOTY5LjQ2NDg0Mzc1LDQwLjY3OTY4NzUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzguOTEgMCAxNy44MiAwIDI3IDAgQzI3IDMuMyAyNyA2LjYgMjcgMTAgQzIxLjM5IDEwIDE1Ljc4IDEwIDEwIDEwIEMxMCAxMy42MyAxMCAxNy4yNiAxMCAyMSBDMTQuMjkgMjEgMTguNTggMjEgMjMgMjEgQzIzIDI0LjMgMjMgMjcuNiAyMyAzMSBDMTguNzEgMzEgMTQuNDIgMzEgMTAgMzEgQzEwIDM3LjkzIDEwIDQ0Ljg2IDEwIDUyIEM2LjcgNTIgMy40IDUyIDAgNTIgQzAgMzQuODQgMCAxNy42OCAwIDAgWiAiIGZpbGw9IiNEODFFMjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDExMDEsNTIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzIuOTcgMCA1Ljk0IDAgOSAwIEM5IDEzLjUzIDkgMjcuMDYgOSA0MSBDNS4zNyA0MSAxLjc0IDQxIC0yIDQxIEMtMy4yMTY4NzUgNDEuMjQ3NSAtNC40MzM3NSA0MS40OTUgLTUuNjg3NSA0MS43NSBDLTEwLjMxMDAyNjQxIDQyLjA5ODg2OTkyIC0xMy4zMDg5OTE4NSA0MC43MzUwMDM3OSAtMTcgMzggQy0yMC42ODY4MTg5NSAzMy4xNjEwNTAxMyAtMjAuNjk0NzYzNjEgMjcuODUzMTQ1NTEgLTIwIDIyIEMtMTguNzI2MDcyMzggMTguMzEyMzE0NzcgLTE3Ljc0NDY5MDYyIDE2LjU4MzY3NjQzIC0xNC42ODc1IDE0LjE4NzUgQy05LjYzMTE5NDU5IDExLjk1MzMxODU0IC02LjQ1NjIyNjA3IDExLjkwODc1NDc5IC0xIDEzIEMtMC42NyA4LjcxIC0wLjM0IDQuNDIgMCAwIFogTS05LjQzNzUgMjEuMDYyNSBDLTExLjI1OTI1OTU5IDI0LjQ4NzQwODAyIC0xMS42MzY3NDE4MyAyNi4xNzk1NDkgLTExIDMwIEMtOS40NTY2NDk3MSAzMi45NTA0NzU1MyAtOS40NTY2NDk3MSAzMi45NTA0NzU1MyAtNyAzNSBDLTQuNDE0MTc4NzIgMzUuNTg0MDIxMzMgLTQuNDE0MTc4NzIgMzUuNTg0MDIxMzMgLTIgMzUgQzAuMzI4NjYyMjkgMzMuMTExNTM4MTcgMC4zMjg2NjIyOSAzMy4xMTE1MzgxNyAwLjE5NTMxMjUgMjkuOTYwOTM3NSBDMC4xNzIxMDkzOCAyOC43Nzc1NzgxMiAwLjE0ODkwNjI1IDI3LjU5NDIxODc1IDAuMTI1IDI2LjM3NSBDMC4xMDY5NTMxMyAyNS4xODY0ODQzNyAwLjA4ODkwNjI1IDIzLjk5Nzk2ODc1IDAuMDcwMzEyNSAyMi43NzM0Mzc1IEMwLjA0NzEwOTM4IDIxLjg1ODIwMzEzIDAuMDIzOTA2MjUgMjAuOTQyOTY4NzUgMCAyMCBDLTUuMTAxNDUzNyAxOC41Nzg2MzU2MiAtNS4xMDE0NTM3IDE4LjU3ODYzNTYyIC05LjQzNzUgMjEuMDYyNSBaICIgZmlsbD0iIzAwODQyOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjEzMSw0MCkiLz4KPHBhdGggZD0iTTAgMCBDOS45IDAgMTkuOCAwIDMwIDAgQzMwIDMuMyAzMCA2LjYgMzAgMTAgQzI2LjcgMTAgMjMuNCAxMCAyMCAxMCBDMjAgMjMuODYgMjAgMzcuNzIgMjAgNTIgQzE1LjA1IDUyLjQ5NSAxNS4wNSA1Mi40OTUgMTAgNTMgQzEwIDM4LjgxIDEwIDI0LjYyIDEwIDEwIEM2LjcgMTAgMy40IDEwIDAgMTAgQzAgNi43IDAgMy40IDAgMCBaICIgZmlsbD0iI0Q4MUUyNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTA2Niw1MikiLz4KPHBhdGggZD0iTTAgMCBDLTAuNDgxMTQ5MSA1Ljc3Mzc4OTI1IC0yLjE4NDY3MTgxIDkuOTU4NTk4MzYgLTUgMTUgQy00LjMxOTM3NSAxNC4yOTg3NSAtMy42Mzg3NSAxMy41OTc1IC0yLjkzNzUgMTIuODc1IEMtMS45NjMyMDUxNCAxMS45MTE3MTQxMyAtMC45ODM1MTk0NiAxMC45NTM4NjU2MSAwIDEwIEMwLjU1NDI5Njg3IDkuNDYxMTcxODggMS4xMDg1OTM3NSA4LjkyMjM0Mzc1IDEuNjc5Njg3NSA4LjM2NzE4NzUgQzUuMjUwOTM2OCA1LjA4MTYzODE0IDcuODk2NjgzMzIgMi44ODQwMTU1MyAxMyAzIEMxNS4wMDY0OTYwNyA0LjUzNjM3NTAxIDE1Ljg3Mzg5MDQ5IDUuNTg4MTQ4NyAxNi42MTcxODc1IDguMDE1NjI1IEMxNy4yNTE1NjExIDEzLjUxMzUyOTUzIDE2Ljg0OTMwMTA3IDE3LjA2MTIxMTQ3IDE0IDIyIEMxMS4wNTUwNzk0MyAyNS40MDk5MDgwMyA4LjEyMTcwMjE1IDI4LjEzNTQyMDQ2IDQgMzAgQzEuNjY3MTQ1MiAzMC4wNDcyNTM5OSAtMC42NjcyNDM5MyAzMC4wNTE4OTk3MyAtMyAzMCBDLTMuMjY1NTQ2ODggMzEuMDczNzg5MDYgLTMuNTMxMDkzNzUgMzIuMTQ3NTc4MTIgLTMuODA0Njg3NSAzMy4yNTM5MDYyNSBDLTQuMTYxMzk0MjEgMzQuNjkwMTIwMSAtNC41MTgxNjg2NiAzNi4xMjYzMTcxMiAtNC44NzUgMzcuNTYyNSBDLTUuMDQ5MDIzNDQgMzguMjY2OTcyNjYgLTUuMjIzMDQ2ODggMzguOTcxNDQ1MzEgLTUuNDAyMzQzNzUgMzkuNjk3MjY1NjIgQy02LjUxMjk0ODE1IDQ0LjE2MDI0OTk4IC03LjcxMjAxMjE2IDQ4LjU4NDg3MDUyIC05IDUzIEMtMTMuODc1IDUxLjI1IC0xMy44NzUgNTEuMjUgLTE1IDQ5IEMtMTUuODA3NzM2NjkgNDEuNjExMTk1NTcgLTE0LjQ0MzM4Mzc0IDM1LjkyMzE3NjkzIC0xMS44NzEwOTM3NSAyOS4wNDI5Njg3NSBDLTEwLjkzNjk5MDk5IDI1Ljc3OTg5MjMxIC0xMC44OTM4OTA4MiAyMy4yNTE1MDY5MSAtMTEuMDYyNSAxOS44NzUgQy0xMS4zNDcwMDEzMyAxMi4zOTk0ODI0MiAtOC41MjkxMDMxNSA3LjAzNDkyMzc4IC0zLjgxMjUgMS4zNzUgQy0yIDAgLTIgMCAwIDAgWiBNMTAgMTAgQzcuOTU1NDM5NDEgMTIuMTcyNjQ2NTUgNy45NTU0Mzk0MSAxMi4xNzI2NDY1NSA1Ljg3NSAxNC44NzUgQzUuMTUwNTQ2ODggMTUuNzc5OTIxODcgNC40MjYwOTM3NSAxNi42ODQ4NDM3NSAzLjY3OTY4NzUgMTcuNjE3MTg3NSBDMS44MDc5NDc2NiAxOS43ODY1NTgxMSAxLjgwNzk0NzY2IDE5Ljc4NjU1ODExIDIgMjIgQzYuMDE1MzA1MDUgMjEuMDg3NDMwNjcgNy43MTEyODI3NSAyMC4zNDk0OTk4MyAxMC4zNzUgMTcuMTI1IEMxMi4zMDc1Njg0OSAxMy45OTU1NjM5MiAxMi4zMDc1Njg0OSAxMy45OTU1NjM5MiAxMiAxMCBDMTEuMzQgMTAgMTAuNjggMTAgMTAgMTAgWiAiIGZpbGw9IiMyMjFFMjAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDY2NSw3MCkiLz4KPHBhdGggZD0iTTAgMCBDMy4zIDAgNi42IDAgMTAgMCBDMTAgMTQuMTkgMTAgMjguMzggMTAgNDMgQzEzLjk2IDQzIDE3LjkyIDQzIDIyIDQzIEMyMy4zMiA0My4zMyAyNC42NCA0My42NiAyNiA0NCBDMjYgNDcuMyAyNiA1MC42IDI2IDU0IEMxMy4xMyA1My41MDUgMTMuMTMgNTMuNTA1IDAgNTMgQzAgMzUuNTEgMCAxOC4wMiAwIDAgWiAiIGZpbGw9IiNEODFFMjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDExMzMsNTIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuMyAwIDYuNiAwIDEwIDAgQzEwLjMzIDQuNjIgMTAuNjYgOS4yNCAxMSAxNCBDMTIuNTQ2ODc1IDEzLjQ0MzEyNSAxMi41NDY4NzUgMTMuNDQzMTI1IDE0LjEyNSAxMi44NzUgQzE4LjM5OTA1MzgzIDExLjkwOTg5MTA3IDIwLjEwMjI4MDU4IDEyLjEzOTcyNDgyIDI0IDE0IEMyNS45NTA0Njk0MiAxNS42MTQxODE1OSAyNi44NzAxODY5MyAxNi43NDAzNzM4NiAyOCAxOSBDMjguMDcxODE4MjEgMjEuNzE3NjAxMDggMjguMDkyOTk1MDYgMjQuNDA4NTkzODggMjguMDYyNSAyNy4xMjUgQzI4LjA1Nzk4ODI4IDI3Ljg3OTEwMTU2IDI4LjA1MzQ3NjU2IDI4LjYzMzIwMzEyIDI4LjA0ODgyODEyIDI5LjQxMDE1NjI1IEMyOC4wMzcwMzQ5OSAzMS4yNzM0NzEyNyAyOC4wMTkwOTk0MiAzMy4xMzY3NDU1NSAyOCAzNSBDMjMuNTQ1IDM1LjQ5NSAyMy41NDUgMzUuNDk1IDE5IDM2IEMxOC45Mzk0MTQwNiAzNS4wODQ3NjU2MyAxOC44Nzg4MjgxMiAzNC4xNjk1MzEyNSAxOC44MTY0MDYyNSAzMy4yMjY1NjI1IEMxOC43MzI2MTcxOSAzMi4wMzgwNDY4NyAxOC42NDg4MjgxMiAzMC44NDk1MzEyNSAxOC41NjI1IDI5LjYyNSBDMTguNDgxMjg5MDYgMjguNDQxNjQwNjMgMTguNDAwMDc4MTIgMjcuMjU4MjgxMjUgMTguMzE2NDA2MjUgMjYuMDM5MDYyNSBDMTguMTg5MTUwNjQgMjMuMDg0ODEwOTkgMTguMTg5MTUwNjQgMjMuMDg0ODEwOTkgMTcgMjEgQzE1LjMzMzg4MDk1IDIwLjk1NzI3OSAxMy42NjYxNzExNSAyMC45NTkzNjE2OCAxMiAyMSBDMTAuNDUwNDk3MzIgMjIuNTQ5NTAyNjggMTAuNzgzNDQ4MDcgMjQuMDk5OTA1OTQgMTAuNjgzNTkzNzUgMjYuMjUzOTA2MjUgQzEwLjY0MTY5OTIyIDI3LjEwNzkxMDE2IDEwLjU5OTgwNDY5IDI3Ljk2MTkxNDA2IDEwLjU1NjY0MDYyIDI4Ljg0MTc5Njg4IEMxMC41MTczMjQyMiAyOS43Mzk2Mjg5MSAxMC40NzgwMDc4MSAzMC42Mzc0NjA5NCAxMC40Mzc1IDMxLjU2MjUgQzEwLjM5NDMxNjQxIDMyLjQ2NDE5OTIyIDEwLjM1MTEzMjgxIDMzLjM2NTg5ODQ0IDEwLjMwNjY0MDYyIDM0LjI5NDkyMTg4IEMxMC4yMDAyMjAxNiAzNi41Mjk3NTE1NiAxMC4wOTk1NzUxOSAzOC43NjQ4NTQ4NiAxMCA0MSBDNi43IDQxIDMuNCA0MSAwIDQxIEMwIDI3LjQ3IDAgMTMuOTQgMCAwIFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDA1LDQwKSIvPgo8cGF0aCBkPSJNMCAwIEM0LjI5IDAgOC41OCAwIDEzIDAgQzkuOTk1NDE0NiAxNi4wODQxMjA5OCA2Ljc1MDQyOTQ2IDMyLjA3MjY0NDI3IDMgNDggQy0xLjI5IDQ4IC01LjU4IDQ4IC0xMCA0OCBDLTkuMzUyMDc5OTYgNDIuMjQzMTY0OTggLTguMzkyNDE1OTEgMzYuNjQxMDIxMyAtNy4xODc1IDMwLjk3NjU2MjUgQy03LjAxMzcxODI2IDMwLjE0OTE3NTcyIC02LjgzOTkzNjUyIDI5LjMyMTc4ODk0IC02LjY2MDg4ODY3IDI4LjQ2OTMyOTgzIEMtNi4yOTYwMjY4NiAyNi43MzYyMTU3NCAtNS45Mjk1NTA3IDI1LjAwMzQ0MDc3IC01LjU2MTUyMzQ0IDIzLjI3MDk5NjA5IEMtNC45OTczNjgxOSAyMC42MTI1OTg0NyAtNC40Mzk3NTU1NCAxNy45NTI4ODU2NSAtMy44ODI4MTI1IDE1LjI5Mjk2ODc1IEMtMy41MjY0Mjg0MSAxMy42MDQwODUwMSAtMy4xNjk2NzA5OSAxMS45MTUyOCAtMi44MTI1IDEwLjIyNjU2MjUgQy0yLjY0NTgwODExIDkuNDMwNzc3ODkgLTIuNDc5MTE2MjEgOC42MzQ5OTMyOSAtMi4zMDczNzMwNSA3LjgxNTA5Mzk5IEMtMS4xMTUxOTMxMyAyLjIzMDM4NjI2IC0xLjExNTE5MzEzIDIuMjMwMzg2MjYgMCAwIFogIiBmaWxsPSIjMjIzMTc1IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5OCw1NCkiLz4KPHBhdGggZD0iTTAgMCBDMCAzIDAgMyAtMSA1IEMtMS4yMTM3NzcyMSAxMC42MDcwMzIxMyAtMS4yMTM3NzcyMSAxMC42MDcwMzIxMyAwIDE2IEMwLjc1NDE0MjM1IDIyLjQ5MDU2OTM3IC0wLjI2NzY1MDE5IDI1LjU4MjA3Mjg1IC00IDMxIEMtMy45Mjc0OTIxNCAzNC41NTI4ODQ5NCAtMy4zMTc3NDE2NCAzNi40OTE2MTMzNyAtMS40Mzc1IDM5LjUgQzAuNDMyMjMyNTQgNDIuNzUxNzA4NzYgMC40OTI4MjA0OCA0NC4yNjg2NDQ5NCAwIDQ4IEMtMS4xNzkwNDA1IDUxLjQwNDQxNTYzIC0yLjU0MTk2MzU0IDU0LjcwNjM5OTc4IC00IDU4IEMtMTMuMDQyMzMyOTIgNTUuOTEzMzA3NzkgLTE5LjIzMTExMzk5IDQ5LjIyNDI2NTc5IC0yNC42ODc1IDQyLjExMzI4MTI1IEMtMjUuOTc2NzY1MDIgNDAuMDM3NDExMDkgLTI2LjU2ODUwMjU3IDM4LjM4OTQxNzA0IC0yNyAzNiBDLTIyLjM3NSAzMyAtMjIuMzc1IDMzIC0xOSAzMyBDLTE5IDMzLjk5IC0xOSAzNC45OCAtMTkgMzYgQy0xNi4wMjk4MjMwNiAzNS4zNzE4OTgyNyAtMTYuMDI5ODIzMDYgMzUuMzcxODk4MjcgLTEzIDM0IEMtMTEuODAxNjE3OTEgMzEuNjcxNDU1MzcgLTExLjgwMTYxNzkxIDMxLjY3MTQ1NTM3IC0xMSAyOSBDLTEwLjMyMzI0MjE5IDI4LjI5NDg4MjgxIC05LjY0NjQ4NDM4IDI3LjU4OTc2NTYyIC04Ljk0OTIxODc1IDI2Ljg2MzI4MTI1IEMtNi4yODY2NTkzNyAyMi45NTIxNDY5MyAtNi42NDc5NDA5OCAyMC4wOTMyNzg3OCAtNi45Mzc1IDE1LjUgQy03LjQ2Nzc4NzQgNi4zMzQ3MzQyNSAtNy40Njc3ODc0IDYuMzM0NzM0MjUgLTQgMiBDLTEuODEyNSAwLjY4NzUgLTEuODEyNSAwLjY4NzUgMCAwIFogIiBmaWxsPSIjMTg3MjRFIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzQ4LDYwKSIvPgo8cGF0aCBkPSJNMCAwIEM0LjIyNzM1OTE0IDUuMDI2MTMzNCA0LjM0Mzc1IDYuNjc1NjQ0OTEgNC4zNDM3NSAxMy41OTc2NTYyNSBDLTEuOTI2MjUgMTMuNTk3NjU2MjUgLTguMTk2MjUgMTMuNTk3NjU2MjUgLTE0LjY1NjI1IDEzLjU5NzY1NjI1IEMtMTIuMzAwNDg3NzkgMTguNzcwMzg3NjYgLTEyLjMwMDQ4Nzc5IDE4Ljc3MDM4NzY2IC04LjUzMTI1IDE5LjU5NzY1NjI1IEMtMy43NTI5OTc1NyAxOS41OTc2NTYyNSAtMC4wNTEzNDIxNSAxOC4zNjE2NzI4MyA0LjM0Mzc1IDE2LjU5NzY1NjI1IEM0LjY1NjI1IDE5LjQxMDE1NjI1IDQuNjU2MjUgMTkuNDEwMTU2MjUgNC4zNDM3NSAyMi41OTc2NTYyNSBDMC45MDEyMjIwNSAyNS45MjU0MzMyNyAtMy40MTQ1NjU0OCAyNi4zMjk5Njg0IC04LjAyMzQzNzUgMjYuNjYwMTU2MjUgQy0xMy42ODcyNjY0IDI2LjUyNTcwMzM0IC0xOC4xMzQxNTE4MiAyNS4xMTk3NTQ0MyAtMjIuMTU2MjUgMjEuMDk3NjU2MjUgQy0yNC43NzM1ODM1MyAxNi43MzU0MzM3IC0yNS4zMTY1NTAzOCAxMi41OTU3NjMyOCAtMjQuNjU2MjUgNy41OTc2NTYyNSBDLTIzLjI5NDg1NjcgMy44NjEyMjM1NSAtMjEuNDAxMzMxNDIgMS4xNzA3OTU4IC0xOC4yMTg3NSAtMS4yNzczNDM3NSBDLTEyLjMxODQ0Njg5IC0zLjg2NzcyMDcyIC01LjI1NTA1Mjk0IC00LjQ0OTQ0MzQxIDAgMCBaIE0tMTMuNjU2MjUgNC41OTc2NTYyNSBDLTEzLjk4NjI1IDUuOTE3NjU2MjUgLTE0LjMxNjI1IDcuMjM3NjU2MjUgLTE0LjY1NjI1IDguNTk3NjU2MjUgQy0xMS4wMjYyNSA4LjU5NzY1NjI1IC03LjM5NjI1IDguNTk3NjU2MjUgLTMuNjU2MjUgOC41OTc2NTYyNSBDLTQuOTgzMjM1NTkgMy42NzQ2NDYzMyAtNC45ODMyMzU1OSAzLjY3NDY0NjMzIC03LjUzMTI1IDIuNjYwMTU2MjUgQy0xMC4yMTA5NzMzNSAyLjU4MTM0MDg2IC0xMS40ODU2NTkxNSAzLjAyNTg0OTA4IC0xMy42NTYyNSA0LjU5NzY1NjI1IFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDkxLjY1NjI1LDU1LjQwMjM0Mzc1KSIvPgo8cGF0aCBkPSJNMCAwIEMzLjUyMDkwNTk1IDQuNTExMTYwNzUgMyA2LjQxMTcwNDg5IDMgMTIuNTYyNSBDLTMuMjcgMTIuNTYyNSAtOS41NCAxMi41NjI1IC0xNiAxMi41NjI1IEMtMTMuNjQ0MjM3NzkgMTcuNzM1MjMxNDEgLTEzLjY0NDIzNzc5IDE3LjczNTIzMTQxIC05Ljg3NSAxOC41NjI1IEMtNS4wOTY3NDc1NyAxOC41NjI1IC0xLjM5NTA5MjE1IDE3LjMyNjUxNjU4IDMgMTUuNTYyNSBDMy4zMTI1IDE4LjM3NSAzLjMxMjUgMTguMzc1IDMgMjEuNTYyNSBDLTAuNDQyNTI3OTUgMjQuODkwMjc3MDIgLTQuNzU4MzE1NDggMjUuMjk0ODEyMTUgLTkuMzY3MTg3NSAyNS42MjUgQy0xNS4wMzEwMTY0IDI1LjQ5MDU0NzA5IC0xOS40Nzc5MDE4MiAyNC4wODQ1OTgxOCAtMjMuNSAyMC4wNjI1IEMtMjYuMTE3MzMzNTMgMTUuNzAwMjc3NDUgLTI2LjY2MDMwMDM4IDExLjU2MDYwNzAzIC0yNiA2LjU2MjUgQy0yNC42Mzg2MDY3IDIuODI2MDY3MyAtMjIuNzQ1MDgxNDIgMC4xMzU2Mzk1NSAtMTkuNTYyNSAtMi4zMTI1IEMtMTIuNjA1NTU1NjYgLTUuMzY2NzY4MjUgLTUuOTgyNDU3MiAtNC44NjA3NDY0OCAwIDAgWiBNLTE1IDMuNTYyNSBDLTE1LjMzIDQuODgyNSAtMTUuNjYgNi4yMDI1IC0xNiA3LjU2MjUgQy0xMi4zNyA3LjU2MjUgLTguNzQgNy41NjI1IC01IDcuNTYyNSBDLTYuMzI2OTg1NTkgMi42Mzk0OTAwOCAtNi4zMjY5ODU1OSAyLjYzOTQ5MDA4IC04Ljg3NSAxLjYyNSBDLTExLjU1NDcyMzM1IDEuNTQ2MTg0NjEgLTEyLjgyOTQwOTE1IDEuOTkwNjkyODMgLTE1IDMuNTYyNSBaICIgZmlsbD0iIzAwODQyOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjE2OSw1Ni40Mzc1KSIvPgo8cGF0aCBkPSJNMCAwIEMzLjMgMCA2LjYgMCAxMCAwIEMxMCAxOC4xNSAxMCAzNi4zIDEwIDU1IEM3LjAzIDU1IDQuMDYgNTUgMSA1NSBDMCA1NCAwIDU0IC0wLjEyMDI1NDUyIDUxLjgyOTY5NjY2IEMtMC4xMTgwMzM5MSA1MC44NzI2MTMwNyAtMC4xMTU4MTMyOSA0OS45MTU1Mjk0OCAtMC4xMTM1MjUzOSA0OC45Mjk0NDMzNiBDLTAuMTEzNDQ5ODYgNDcuODQ4Mzk4MjggLTAuMTEzMzc0MzMgNDYuNzY3MzUzMjEgLTAuMTEzMjk2NTEgNDUuNjUzNTQ5MTkgQy0wLjEwODEzNTIyIDQ0LjQ3NzUyNjQgLTAuMTAyOTczOTQgNDMuMzAxNTAzNiAtMC4wOTc2NTYyNSA0Mi4wODk4NDM3NSBDLTAuMDk2MjQxMyA0MC44OTI2NzIyNyAtMC4wOTQ4MjYzNSAzOS42OTU1MDA3OSAtMC4wOTMzNjg1MyAzOC40NjIwNTEzOSBDLTAuMDg3NzQ5NzkgMzQuNjIwNTA5MzQgLTAuMDc1MTk0MTEgMzAuNzc5MDI0NTcgLTAuMDYyNSAyNi45Mzc1IEMtMC4wNTc0ODc0MSAyNC4zNDA0OTU2MyAtMC4wNTI5MjQwOSAyMS43NDM0OTAzNSAtMC4wNDg4MjgxMiAxOS4xNDY0ODQzOCBDLTAuMDM3Nzc0MjcgMTIuNzY0MzAwNjggLTAuMDIwNDk3MDggNi4zODIxNjAwNyAwIDAgWiAiIGZpbGw9IiNEODFGMjUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDExNjYsNTIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuMyAwIDYuNiAwIDEwIDAgQzEwIDAuNjYgMTAgMS4zMiAxMCAyIEMxMC45OSAxLjM0IDExLjk4IDAuNjggMTMgMCBDMTYuMzkyMTAyODcgLTAuNTQ2MTg2MDYgMTkuNjA2NTQzNSAtMC41MzU4MDg5MiAyMyAwIEMyNi42MTk5NTgyMSAyLjY1OTU2MTEzIDI4LjIwNjgzODE3IDQuNjQ4NDIzNTEgMjkgOSBDMjkuMDc4MTg2MzYgMTAuNTEzOTU2OTYgMjkuMTA3ODk5MDkgMTIuMDMwOTM1MDcgMjkuMDk3NjU2MjUgMTMuNTQ2ODc1IEMyOS4wOTQ0MzM1OSAxNC4zOTEyMTA5NCAyOS4wOTEyMTA5NCAxNS4yMzU1NDY4NyAyOS4wODc4OTA2MiAxNi4xMDU0Njg3NSBDMjkuMDc5NTExNzIgMTYuOTc4MTY0MDYgMjkuMDcxMTMyODEgMTcuODUwODU5MzcgMjkuMDYyNSAxOC43NSBDMjkuMDU3OTg4MjggMTkuNjM4MTY0MDYgMjkuMDUzNDc2NTYgMjAuNTI2MzI4MTIgMjkuMDQ4ODI4MTIgMjEuNDQxNDA2MjUgQzI5LjAzNzA3NDIyIDIzLjYyNzYzMzE2IDI5LjAxOTEzOTY2IDI1LjgxMzgyNTI4IDI5IDI4IEMyNS43IDI4IDIyLjQgMjggMTkgMjggQzE4LjUwNSAxOC4xIDE4LjUwNSAxOC4xIDE4IDggQzE2LjY4IDcuNjcgMTUuMzYgNy4zNCAxNCA3IEMxMy4wMSA3LjY2IDEyLjAyIDguMzIgMTEgOSBDMTAuNDE0MDczNjYgMTIuMTE2MTA1NTQgMTAuNDE0MDczNjYgMTIuMTE2MTA1NTQgMTAuMzEyNSAxNS42MjUgQzEwLjI0Njc1NzgxIDE2LjgxMzUxNTYzIDEwLjE4MTAxNTYzIDE4LjAwMjAzMTI1IDEwLjExMzI4MTI1IDE5LjIyNjU2MjUgQzEwLjA3NTg5ODQ0IDIwLjE0MTc5Njg3IDEwLjAzODUxNTYyIDIxLjA1NzAzMTI1IDEwIDIyIEM2LjcgMjEuNjcgMy40IDIxLjM0IDAgMjEgQzAgMTQuMDcgMCA3LjE0IDAgMCBaICIgZmlsbD0iIzAwODQyOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjAzNiw1MykiLz4KPHBhdGggZD0iTTAgMCBDNy44MjQzNDA1OCAtMC4xMTcwMzA3NCA3LjgyNDM0MDU4IC0wLjExNzAzMDc0IDEwLjQ4ODI4MTI1IDIuNDE0MDYyNSBDMTIuNzg3NDM3MTMgNi4yMDk3NTk4NSAxMy43NDA2OTg2IDkuNTU1ODA4MzkgMTMgMTQgQzExLjk1MTAwNjYgMTUuNzE2NTM0NjYgMTAuOTAxMjc3MjcgMTcuNDMyNzI1OTggOS44MzIwMzEyNSAxOS4xMzY3MTg3NSBDOC4yODEzNDc3OCAyMi42MDkzNzYxMSA5LjE2NDUxNTkyIDI1LjM1OTY3NjUzIDEwIDI5IEMxMC4zNTA2MjUgMjkuNzAxMjUgMTAuNzAxMjUgMzAuNDAyNSAxMS4wNjI1IDMxLjEyNSBDMTIuMzk2NjM0OTIgMzMuNzkzMjY5ODUgMTIuMTk1NTczOTMgMzYuMDY2MzkwOTggMTIgMzkgQzExIDQwIDExIDQwIDguMTI4OTA2MjUgNDAuMTMyODEyNSBDNi45NTE5OTIxOSA0MC4xMzAyMzQzOCA1Ljc3NTA3ODEyIDQwLjEyNzY1NjI1IDQuNTYyNSA0MC4xMjUgQzMuMzg4MTY0MDYgNDAuMTI3NTc4MTIgMi4yMTM4MjgxMiA0MC4xMzAxNTYyNSAxLjAwMzkwNjI1IDQwLjEzMjgxMjUgQy0yIDQwIC0yIDQwIC00IDM5IEMtMy4yNDgxNzUxOCAzMS40ODE3NTE4MiAtMy4yNDgxNzUxOCAzMS40ODE3NTE4MiAtMS45Mzc1IDI4LjkzNzUgQy0wLjQzNzQ4NjY0IDI1LjgzNzQ3MjM5IC0wLjY0OTM5MDYgMjMuMzg5MjI0MiAtMSAyMCBDLTIuMzE0MzE2OTUgMTcuOTg3NDUyMTggLTMuNjQ3MjE4ODUgMTUuOTg2ODk3MzEgLTUgMTQgQy01Ljg1NTE0NzQgOS42MjkyNDY2MSAtNC43NjA4MzQzNiA3LjI4MzU1ODE3IC0yLjUgMy42MjUgQy0xLjY3OTQ5NTggMi40MDc5MTg3NiAtMC44NTAyODE2NCAxLjE5NjQ2NzczIDAgMCBaICIgZmlsbD0iI0ZBRkJGQiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM1Nyw4MikiLz4KPHBhdGggZD0iTTAgMCBDMy45MDkzODcwMyAzLjczOTQxMzY4IDMuOTA5Mzg3MDMgMy43Mzk0MTM2OCA0LjEzMjgxMjUgNi44NDc2NTYyNSBDNC4xMzAyMzQzOCA3LjU3ODU1NDY5IDQuMTI3NjU2MjUgOC4zMDk0NTMxMyA0LjEyNSA5LjA2MjUgQzQuMTIzNzEwOTQgOS44NjU1ODU5NCA0LjEyMjQyMTg4IDEwLjY2ODY3MTg4IDQuMTIxMDkzNzUgMTEuNDk2MDkzNzUgQzQuMDAyNzk5MjggMTMuOTQyMTE4MSAzLjYyMDk4NDQgMTYuMjE4MTI5NDkgMy4xODc1IDE4LjYyNSBDMi43MDMyNTg3MiAyMi4yNzU5MjQ0MiAzLjIxMzk4MTIzIDIzLjg4MzIwMTQgNS40Mzc1IDI2LjgxMjUgQzUuOTEwNTg1OTQgMjcuMzM0NTcwMzEgNi4zODM2NzE4NyAyNy44NTY2NDA2MiA2Ljg3MTA5Mzc1IDI4LjM5NDUzMTI1IEM4IDMwIDggMzAgOCAzNCBDOC42NiAzNCA5LjMyIDM0IDEwIDM0IEM3Ljk4MzAzMjM0IDI5LjA1NjczNDA2IDcuOTgzMDMyMzQgMjkuMDU2NzM0MDYgNS4yNSAyNC41IEMzLjUwMjExMTMyIDIxLjAwNDIyMjYzIDQuMzAxODA1ODYgMTguODA4MzMxNjUgNSAxNSBDNS4yMjA5MzE1MSAxMC40OTc1NjgxMyA1LjIzOTU1NzQ5IDYuMzU4MTI2NzUgNCAyIEM3LjQ0NTAwNjYgNC45MzU2NjQyMyA3LjU3NDgyNDY0IDcuMjU3NDQyOTQgNy45Njg3NSAxMS41OTc2NTYyNSBDNy45OTg4MzUyIDEzLjkxMDQ1NTggNy43MDc4ODYzOCAxNS44NjYzODczNSA3LjI1IDE4LjEyNSBDNi45ODQxMjA2MSAyMi4yNDYxMzA1MyA3LjEwOTg0MDQyIDIyLjY4NTU3NDIyIDkuNDM3NSAyNS43NSBDOS45MTA1ODU5NCAyNi4yODEwOTM3NSAxMC4zODM2NzE4NyAyNi44MTIxODc1IDEwLjg3MTA5Mzc1IDI3LjM1OTM3NSBDMTIgMjkgMTIgMjkgMTIgMzMgQzE0LjMxIDMzLjY2IDE2LjYyIDM0LjMyIDE5IDM1IEMxOSAzNS45OSAxOSAzNi45OCAxOSAzOCBDMTkuNjM5Mzc1IDM4LjI4ODc1IDIwLjI3ODc1IDM4LjU3NzUgMjAuOTM3NSAzOC44NzUgQzIzIDQwIDIzIDQwIDI0IDQyIEMxOS4yNDAwNTc5OSA0OC4wNjgxMzc5OSAxMy45MjU3ODgzNiA1My40MjgxMzM2MyA3IDU3IEM0IDU2IDQgNTYgMi43OTY4NzUgNTMuOTI1NzgxMjUgQy0wLjc2MDI4NTczIDQ1LjA0NjE1MjQyIC0wLjc2MDI4NTczIDQ1LjA0NjE1MjQyIDEgNDAgQzEuNTE1NjI1IDM5LjE3NSAyLjAzMTI1IDM4LjM1IDIuNTYyNSAzNy41IEM0LjM4NzAyNzU2IDM0LjMyNjkwODU4IDQuNTE2NDQxMTggMzIuNjE1MDg4MjUgNCAyOSBDMy4zNCAyOC4wMzA2MjUgMi42OCAyNy4wNjEyNSAyIDI2LjA2MjUgQy0wLjQxMDU3NzgyIDIyLjM3MTMwMjcyIC0wLjQwODMyNzU1IDIwLjMyODI3MTk5IDAgMTYgQzAuMzMgMTUuMDEgMC42NiAxNC4wMiAxIDEzIEMxLjA5MjQ3MzgxIDExLjUyMzEzODg5IDEuMTI5OTkwNzEgMTAuMDQyMjQ0OTkgMS4xMjUgOC41NjI1IEMxLjEyODg2NzE5IDcuNDE5NzQ2MDkgMS4xMjg4NjcxOSA3LjQxOTc0NjA5IDEuMTMyODEyNSA2LjI1MzkwNjI1IEMxLjAwMjc2MDE1IDQuMDQ2ODQxNDEgMC42MDg1NjE5OSAyLjEyMDMwNzI0IDAgMCBaICIgZmlsbD0iIzI5N0Q1QiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM3NCw2MSkiLz4KPHBhdGggZD0iTTAgMCBDMCAyLjY0IDAgNS4yOCAwIDggQy0wLjk5IDcuNjcgLTEuOTggNy4zNCAtMyA3IEMtNi41NTg4MDA1MSA2LjYyNjg5OTk1IC05LjgyNzU4NTIyIDYuMzQwNTE2NjkgLTEzIDguMTI1IEMtMTQuNDYyMjEyMTcgMTAuODY2NjQ3ODEgLTE0LjMxODMzNzMzIDEyLjk0Mzk2MTYyIC0xNCAxNiBDLTEyLjMyMDg1NTg1IDE5LjIyNTQwMTU2IC0xMi4zMjA4NTU4NSAxOS4yMjU0MDE1NiAtOS4zMTI1IDE5Ljc1IEMtNS43MDcwOTgyNCAyMC4wMjIxMDU3OSAtMi41NTAxMDA2NiAxOS42MzkwMTgxMiAxIDE5IEMxIDIxLjMxIDEgMjMuNjIgMSAyNiBDLTYuMzQ1MjM2NzIgMjguMjcwMzQ1ODkgLTEyLjM4MTY4ODY4IDI4Ljg3NjE2MTQyIC0xOS4zNzUgMjUuMjUgQy0yMi44MjkzNDgyMSAyMi4yODkxMzAxIC0yNC42OTA4NzcyNCAyMC4yNzgzNDkyMiAtMjUuMzE2NDA2MjUgMTUuNjY3OTY4NzUgQy0yNS41ODIxMzY1MiA5Ljk1MDQ4MTkxIC0yNC45Njg0NzE1MiA2LjM5NzQ5NTQ3IC0yMSAyIEMtMTQuMTcwMDE0MTEgLTMuMjEyMzU3NjUgLTcuODE4OTkzNjcgLTEuODY5NzU5MzYgMCAwIFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDAyLDU0KSIvPgo8cGF0aCBkPSJNMCAwIEMzIDMuMTkwMzcxOTkgMyAzLjE5MDM3MTk5IDMgNiBDLTAuMDkyNjI3NjcgNy41NDYzMTM4NCAtMy4zNjcwODkxIDcuMzkwNjA3MTYgLTYuNzg1MTU2MjUgNy42MjEwOTM3NSBDLTcuODgxNTAzOTEgNy44MDg2NTIzNCAtNy44ODE1MDM5MSA3LjgwODY1MjM0IC05IDggQy05LjMzIDguNjYgLTkuNjYgOS4zMiAtMTAgMTAgQy03LjY5IDEwLjMzIC01LjM4IDEwLjY2IC0zIDExIEMtMi40Mzc1IDEyLjkzNzUgLTIuNDM3NSAxMi45Mzc1IC0yIDE1IEMtMyAxNiAtMyAxNiAtNS4yODUxNTYyNSAxNi4wOTc2NTYyNSBDLTYuNjU5OTQxNDEgMTYuMDgwMjUzOTEgLTYuNjU5OTQxNDEgMTYuMDgwMjUzOTEgLTguMDYyNSAxNi4wNjI1IEMtOC45ODE2MDE1NiAxNi4wNTM0NzY1NiAtOS45MDA3MDMxMiAxNi4wNDQ0NTMxMyAtMTAuODQ3NjU2MjUgMTYuMDM1MTU2MjUgQy0xMS41NTc5Mjk2OSAxNi4wMjM1NTQ2OSAtMTIuMjY4MjAzMTMgMTYuMDExOTUzMTMgLTEzIDE2IEMtMTMuMzMgMTcuNjUgLTEzLjY2IDE5LjMgLTE0IDIxIEMtMTIuNzYyNSAyMC42NDkzNzUgLTExLjUyNSAyMC4yOTg3NSAtMTAuMjUgMTkuOTM3NSBDLTcuMDk2NzA4IDE5LjA0NDA2NzI3IC01LjEzMjI1ODM2IDE4Ljk5MTE4NzA2IC0yIDIwIEMtMS42NyAyMS4zMiAtMS4zNCAyMi42NCAtMSAyNCBDLTcuMDgzMDUwMzggMjguMTkwNTQ1ODIgLTExLjYyMjE1Nzc3IDI5Ljk3NTQ2ODkgLTE5IDI5IEMtMjEuMDYyNSAyNy4zNzUgLTIxLjA2MjUgMjcuMzc1IC0yMiAyNSBDLTIyLjU2NDA4OTkgMjAuMDM2MDA4OTIgLTIxLjQ2ODAwNjg0IDE1LjcxMzA3NDU4IC0yMCAxMSBDLTE4LjM3NSA5IC0xOC4zNzUgOSAtMTcgOCBDLTE3LjQ5NSA3LjU2Njg3NSAtMTcuOTkgNy4xMzM3NSAtMTguNSA2LjY4NzUgQy0yMCA1IC0yMCA1IC0yMCAyIEMtNi4wODE1NDUwNiAtMS4zMTY3MzgyIC02LjA4MTU0NTA2IC0xLjMxNjczODIgMCAwIFogIiBmaWxsPSIjMjIxRTIwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2NTIsNzEpIi8+CjxwYXRoIGQ9Ik0wIDAgQzIgMiAyIDIgMi4zMTI1IDUuMTg3NSBDMS45Njk4MjgxOCA5LjM2ODA5NjIyIDAuNjY2NjA4NjQgMTIuMTgwNjg4NTMgLTEgMTYgQy0xLjU4NzYzMjQ0IDIwLjExMzQyNzEgLTEuMzMwNDM1NTggMjEuNTA0MzQ2NjQgMSAyNSBDMy4zMzQ1ODYzNSAyOC41MDE4Nzk1MyAzLjY3MjYwNzI3IDI5Ljg4MDI4MDQ3IDMgMzQgQzEuOTUxMDA2NiAzNS43MTY1MzQ2NiAwLjkwMTI3NzI3IDM3LjQzMjcyNTk4IC0wLjE2Nzk2ODc1IDM5LjEzNjcxODc1IEMtMS43MTg2NTIyMiA0Mi42MDkzNzYxMSAtMC44MzU0ODQwOCA0NS4zNTk2NzY1MyAwIDQ5IEMwLjM1MDYyNSA0OS43MDEyNSAwLjcwMTI1IDUwLjQwMjUgMS4wNjI1IDUxLjEyNSBDMi4zODM4NTAwOCA1My43Njc3MDAxNyAyLjEzMjA5ODM3IDU2LjA5MzgzNTkxIDIgNTkgQzEuMDEgNTkgMC4wMiA1OSAtMSA1OSBDLTEuMjg4NzUgNTcuNzgzMTI1IC0xLjU3NzUgNTYuNTY2MjUgLTEuODc1IDU1LjMxMjUgQy0yLjQ4MDE5MTExIDUyLjgzMDc4MTA3IC0zLjEwNzk3MDM0IDUwLjc2NzAxMTM3IC00LjE4NzUgNDguNDM3NSBDLTUuMzQyMzE4NDQgNDQuOTczMDQ0NjggLTQuODE4NjU2ODYgNDIuNTI2NTIxODcgLTQgMzkgQy0zLjIyNjU2MjUgMzcuNzMxNTYyNSAtMy4yMjY1NjI1IDM3LjczMTU2MjUgLTIuNDM3NSAzNi40Mzc1IEMtMC42MTEwNTMyMSAzMy4zNDA0ODE1MiAtMC41NTY2MDA4MSAzMS41NDcxOTM1MyAtMSAyOCBDLTIuNDI2MjE2ODQgMjUuMjg4NzM2MTYgLTIuNDI2MjE2ODQgMjUuMjg4NzM2MTYgLTQgMjMgQy00IDIyLjM0IC00IDIxLjY4IC00IDIxIEMtNi45NyAyMSAtOS45NCAyMSAtMTMgMjEgQy0xNi44OTY3Nzg1MSAyNy4wMDIyMTQ0NSAtMTYuODk2Nzc4NTEgMjcuMDAyMjE0NDUgLTE3IDM0IEMtMTYuMzQgMzQuOTY5Mzc1IC0xNS42OCAzNS45Mzg3NSAtMTUgMzYuOTM3NSBDLTEyLjUzNTY0NjkzIDQwLjcxMTA0MDY0IC0xMi40NTUwODUxNiA0Mi41NjI4MzYyOCAtMTMgNDcgQy0xMy45MzU3ODk5NSA0OS4zNTk4MTgxMyAtMTQuOTMzNDc4MDggNTEuNjk2MzEyNjQgLTE2IDU0IEMtMTYuNjkxNDA1MjIgNTYuNzc4ODg2MTMgLTE2LjY5MTQwNTIyIDU2Ljc3ODg4NjEzIC0xNyA1OSBDLTE3Ljk5IDU5IC0xOC45OCA1OSAtMjAgNTkgQy0yMC4yNTgxMzMwMiA1NS4zODYxMzc3NCAtMjAuMTY4MTU2NjcgNTMuMzI5MzA2OCAtMTguNSA1MC4wNjI1IEMtMTYuNjczNDE0OTMgNDYuMzMzMjIyMTUgLTE2LjQ4NjE3MTMzIDQ0LjExMDYyOTM5IC0xNyA0MCBDLTE4LjMxNDMxNjk1IDM3Ljk4NzQ1MjE4IC0xOS42NDcyMTg4NSAzNS45ODY4OTczMSAtMjEgMzQgQy0yMS41IDMxIC0yMS41IDMxIC0yMSAyOCBDLTIwLjMxOTM3NSAyNy4wNzE4NzUgLTE5LjYzODc1IDI2LjE0Mzc1IC0xOC45Mzc1IDI1LjE4NzUgQy0xNi4yOTQzMTIzNCAyMC44MzkwMjk5NyAtMTYuODYxMjA4MTUgMTcuODI0MTczMzMgLTE4IDEzIEMtMTguNjU5OTY3OSAxMS4zMzA2Njk0MiAtMTkuMzI1NTg4NjkgOS42NjM1NDc5IC0yMCA4IEMtMjAuMTI1IDQuNjg3NSAtMjAuMTI1IDQuNjg3NSAtMjAgMiBDLTE5LjM0IDIgLTE4LjY4IDIgLTE4IDIgQy0xOCAyLjY2IC0xOCAzLjMyIC0xOCA0IEMtMTYuNjggNCAtMTUuMzYgNCAtMTQgNCBDLTE0IDQuNjYgLTE0IDUuMzIgLTE0IDYgQy0xNC45OSA2IC0xNS45OCA2IC0xNyA2IEMtMTUuOTcwMjgxNCAxMS4yMzU1MDE3NyAtMTUuOTcwMjgxNCAxMS4yMzU1MDE3NyAtMTMuNzUgMTYgQy0xMC45NzQxNDAxOSAxNy41ODYyMDU2MSAtOS4xMjcxMzUyNSAxNy41MTA1NTI2OSAtNiAxNyBDLTIuMzk2ODM5NzggMTMuNjg4OTg3OTEgLTEuNDQ3Mjk0NzYgMTAuODA4NDE4NyAtMSA2IEMtMy4zMSA2LjMzIC01LjYyIDYuNjYgLTggNyBDLTguMDQyNzIxIDUuMzMzODgwOTUgLTguMDQwNjM4MzIgMy42NjYxNzExNSAtOCAyIEMtNS45NTQ0Nzk1OCAtMC4wNDU1MjA0MiAtMi43Mjk0MTkxNCAwLjIzOTQyMjczIDAgMCBaICIgZmlsbD0iIzIyNzg1NSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM3MCw2MikiLz4KPHBhdGggZD0iTTAgMCBDMC45NDg3NSAwLjY2IDEuODk3NSAxLjMyIDIuODc1IDIgQzMuMzAxNTM3MjcgNi4zNTA2ODAxOCAzLjQ1MjcyODcyIDguMjkzODg3MTIgMC42MjUgMTEuNzUgQy0wLjI4MjUgMTIuNDkyNSAtMS4xOSAxMy4yMzUgLTIuMTI1IDE0IEMtMi43MDYzNjcxOSAxNC41MTY5MTQwNiAtMy4yODc3MzQzOCAxNS4wMzM4MjgxMiAtMy44ODY3MTg3NSAxNS41NjY0MDYyNSBDLTYuNzk2MjA2MzYgMTcuNDI5OTAwMDYgLTkuMjc0ODQ0NzUgMTcuNzMzMjU1NzkgLTEyLjY4NzUgMTguMTg3NSBDLTEzLjgyMzE2NDA2IDE4LjM0NjA1NDY5IC0xNC45NTg4MjgxMiAxOC41MDQ2MDkzOCAtMTYuMTI4OTA2MjUgMTguNjY3OTY4NzUgQy0xOS4xMjUgMTkgLTE5LjEyNSAxOSAtMjIuMTI1IDE5IEMtMjMuOTMxNDYxMTggMTUuMzg3MDc3NjQgLTI1LjEyNSAxMi45OTMwMDYgLTI1LjEyNSA4LjkzNzUgQy0yMy41NjkwNzIyNyA0LjM2Njk2MjI5IC0yMS4wMzM3Mjg5IDEuMTk5NzcyNDUgLTE2LjkzNzUgLTEuMzc1IEMtMTEuMDE1MDAyNTMgLTIuNjkxMTEwNTUgLTUuMzkzODE5MTMgLTMuMDkxNTc5MjYgMCAwIFogTS0xOC4xMjUgNSBDLTE4Ljc4NSA2LjMyIC0xOS40NDUgNy42NCAtMjAuMTI1IDkgQy0xOC44MDUgNy42OCAtMTcuNDg1IDYuMzYgLTE2LjEyNSA1IEMtMTYuNzg1IDUgLTE3LjQ0NSA1IC0xOC4xMjUgNSBaIE0tMTIuMTI1IDkgQy0xMy45NTgwMDkwOSAxMS4xMDU3NTY0MyAtMTMuOTU4MDA5MDkgMTEuMTA1NzU2NDMgLTE1LjEyNSAxMyBDLTkuMzI4NzM4OTMgMTIuNjAwMjU3ODYgLTUuNzEwMjc1MzcgMTEuODk3NDg0MDcgLTEuMTI1IDggQy0xLjEyNSA3LjAxIC0xLjEyNSA2LjAyIC0xLjEyNSA1IEMtNS45NTc3NzI2OCA0LjQzMTQzODUxIC04LjM2ODA4Njg2IDYuMDU5ODA3MTEgLTEyLjEyNSA5IFogIiBmaWxsPSIjMjIxRTIwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1ODUuMTI1LDQ5KSIvPgo8cGF0aCBkPSJNMCAwIEMyLjk3IDAgNS45NCAwIDkgMCBDOS4zMyAxLjMyIDkuNjYgMi42NCAxMCA0IEMxMC41MTU2MjUgMy4zNCAxMS4wMzEyNSAyLjY4IDExLjU2MjUgMiBDMTQuODI2NDEzMTkgLTAuNjc4MDgyNjIgMTYuODgzOTk1MjUgLTAuMzgxMTExNTUgMjEgMCBDMjEuNjYgMC4zMyAyMi4zMiAwLjY2IDIzIDEgQzIyLjY3IDMuNjQgMjIuMzQgNi4yOCAyMiA5IEMxOSAxMCAxOSAxMCAxNy4wNjI1IDkuMzEyNSBDMTYuMzgxODc1IDkuMjA5Mzc1IDE1LjcwMTI1IDkuMTA2MjUgMTUgOSBDMTEuNjQ5OTE3OTUgMTEuNzc1NzgyMjcgMTAuMTM2Mzk1ODYgMTMuNjg5OTI2MiA5LjY4MzU5Mzc1IDE4LjAzOTA2MjUgQzkuNjAyMzgyODEgMTkuMjIyNDIxODcgOS41MjExNzE4OCAyMC40MDU3ODEyNSA5LjQzNzUgMjEuNjI1IEM5LjM1MzcxMDk0IDIyLjgxMzUxNTYzIDkuMjY5OTIxODcgMjQuMDAyMDMxMjUgOS4xODM1OTM3NSAyNS4yMjY1NjI1IEM5LjEyMzAwNzgxIDI2LjE0MTc5Njg3IDkuMDYyNDIxODcgMjcuMDU3MDMxMjUgOSAyOCBDNi4wMyAyOCAzLjA2IDI4IDAgMjggQzAgMTguNzYgMCA5LjUyIDAgMCBaICIgZmlsbD0iIzAwODQyOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjE3Niw1MykiLz4KPHBhdGggZD0iTTAgMCBDMC40OTUgMS40ODUgMC40OTUgMS40ODUgMSAzIEMwLjAxIDMuOTkgLTAuOTggNC45OCAtMiA2IEMtMi43MjcwMzEyNSA1LjczNDQ1MzEzIC0zLjQ1NDA2MjUgNS40Njg5MDYyNSAtNC4yMDMxMjUgNS4xOTUzMTI1IEMtMjUuMTQ4Njk1MTMgLTIuMTYyNDkwMzQgLTQ1LjE2MzM2MjQ5IC0xLjA2MjQxOCAtNjYgNiBDLTY2LjMzIDQuMzUgLTY2LjY2IDIuNyAtNjcgMSBDLTQ4Ljc3Mzk1ODUzIC05LjkzNTYyNDg4IC0xOC43MTE0Nzg5MyAtOC4zODU4NDYyMiAwIDAgWiAiIGZpbGw9IiNFODIwMjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4MjAsMzUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuNjYgMCAxLjMyIDAgMiAwIEMyLjMzIDEuNjUgMi42NiAzLjMgMyA1IEM0LjY1IDUgNi4zIDUgOCA1IEM3LjAxIDYuNDg1IDcuMDEgNi40ODUgNiA4IEM1LjgzMjg2NDMxIDEwLjYyNTMxNTI0IDUuODMyODY0MzEgMTAuNjI1MzE1MjQgNiAxMyBDNi45MDc1IDEyLjQ4NDM3NSA3LjgxNSAxMS45Njg3NSA4Ljc1IDExLjQzNzUgQzEyIDEwIDEyIDEwIDE0LjM3NSAxMC4zMTI1IEMxNC45MTEyNSAxMC41MzkzNzUgMTUuNDQ3NSAxMC43NjYyNSAxNiAxMSBDMTUuNjcgMTIuMzIgMTUuMzQgMTMuNjQgMTUgMTUgQzE2Ljk4IDE0LjY3IDE4Ljk2IDE0LjM0IDIxIDE0IEMxOS42OCAxNi42NCAxOC4zNiAxOS4yOCAxNyAyMiBDMTYuMjM4MTY0MDYgMjEuNzgzNDM3NSAxNS40NzYzMjgxMyAyMS41NjY4NzUgMTQuNjkxNDA2MjUgMjEuMzQzNzUgQzMuNTQ5MjExNDUgMTguMzM5MTEzMiAtMy45OTQ5NjA1MyAxOC41NDQyMTE5MSAtMTUgMjIgQy0xNi4zMiAxOS4zNiAtMTcuNjQgMTYuNzIgLTE5IDE0IEMtMTYuNjkgMTQuMzMgLTE0LjM4IDE0LjY2IC0xMiAxNSBDLTEyLjY2IDEzLjM1IC0xMy4zMiAxMS43IC0xNCAxMCBDLTEwLjI4MTExNzYxIDEwLjUwNzEyMDMzIC03LjI2NTQ1NzYxIDExLjExNjA4MjE1IC00IDEzIEMtMy43OTkxMzU1NyA5LjI4NDAwODA5IC0zLjg0ODA1NjMgOC4yMjc5MTU1NSAtNiA1IEMtNC4zNSA1IC0yLjcgNSAtMSA1IEMtMC42NyAzLjM1IC0wLjM0IDEuNyAwIDAgWiAiIGZpbGw9IiNGM0Y4RjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNjAsMzcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEuNzQyMTY3OTcgMC4wNTQxNDA2MyAxLjc0MjE2Nzk3IDAuMDU0MTQwNjMgMy41MTk1MzEyNSAwLjEwOTM3NSBDNC4zOTk5NjA5NCAwLjE1NTc4MTI1IDUuMjgwMzkwNjMgMC4yMDIxODc1IDYuMTg3NSAwLjI1IEM1Ljg1NzUgMS45IDUuNTI3NSAzLjU1IDUuMTg3NSA1LjI1IEMzLjIwNzUgNS41OCAxLjIyNzUgNS45MSAtMC44MTI1IDYuMjUgQy0xLjA1MDMzMjAzIDcuMzU0MDgyMDMgLTEuMDUwMzMyMDMgNy4zNTQwODIwMyAtMS4yOTI5Njg3NSA4LjQ4MDQ2ODc1IEMtMi43NDE2MTc3NyAxNC41MzkxODMxOCAtMy44MTM2MDk0MSAxOC40MDQ2OTk1NSAtOC44MTI1IDIyLjI1IEMtMTEuNTc3MDIwMzMgMjMuNjMyMjYwMTYgLTEzLjg1ODYzNjMgMjMuMzQ1MjUzODcgLTE2LjkzNzUgMjMuMzEyNSBDLTE4LjAzMzIwMzEyIDIzLjMwMzQ3NjU2IC0xOS4xMjg5MDYyNSAyMy4yOTQ0NTMxMyAtMjAuMjU3ODEyNSAyMy4yODUxNTYyNSBDLTIxLjUyMjM4MjgxIDIzLjI2Nzc1MzkxIC0yMS41MjIzODI4MSAyMy4yNjc3NTM5MSAtMjIuODEyNSAyMy4yNSBDLTIyLjQ4MjUgMjEuNiAtMjIuMTUyNSAxOS45NSAtMjEuODEyNSAxOC4yNSBDLTE5LjgzMjUgMTcuOTIgLTE3Ljg1MjUgMTcuNTkgLTE1LjgxMjUgMTcuMjUgQy0xNS41ODE3NTc4MSAxNi4zNTc5Njg3NSAtMTUuMzUxMDE1NjIgMTUuNDY1OTM3NSAtMTUuMTEzMjgxMjUgMTQuNTQ2ODc1IEMtMTQuNzg3MTQ4NDQgMTMuMzc2NDA2MjUgLTE0LjQ2MTAxNTYzIDEyLjIwNTkzNzUgLTE0LjEyNSAxMSBDLTEzLjgxMTc1NzgxIDkuODM5ODQzNzUgLTEzLjQ5ODUxNTYyIDguNjc5Njg3NSAtMTMuMTc1NzgxMjUgNy40ODQzNzUgQy0xMC40NDExMzY5OSAwLjk5NjQ1MTA5IC02Ljc2ODAwODc1IC0wLjI3MzQ1NDkgMCAwIFogIiBmaWxsPSIjRjVGOUY2IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDM2LjgxMjUsODQuNzUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzIuOTcgMCA1Ljk0IDAgOSAwIEM5IDkuMjQgOSAxOC40OCA5IDI4IEM2LjAzIDI4IDMuMDYgMjggMCAyOCBDMCAxOC43NiAwIDkuNTIgMCAwIFogIiBmaWxsPSIjMDA4NDJBIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDk5LDUzKSIvPgo8cGF0aCBkPSJNMCAwIEM0LjgwODE5NTIyIDAuMDEzNzU3MzUgNC44MDgxOTUyMiAwLjAxMzc1NzM1IDcuODEyNSAyLjg3NSBDOC40OTMxMjUgNC4xMTI1IDguNDkzMTI1IDQuMTEyNSA5LjE4NzUgNS4zNzUgQzYuODc3NSA1LjcwNSA0LjU2NzUgNi4wMzUgMi4xODc1IDYuMzc1IEMxLjg1NzUgOC4wMjUgMS41Mjc1IDkuNjc1IDEuMTg3NSAxMS4zNzUgQzQuNjUyNSAxMC44OCA0LjY1MjUgMTAuODggOC4xODc1IDEwLjM3NSBDOC42ODA5ODE3NSAxNC41MjAyNDY3MSA4LjMyNjA0MzA3IDE2LjE1NDk2MSA2LjA2MjUgMTkuNzUgQzMuMTg3NSAyMi4zNzUgMy4xODc1IDIyLjM3NSAwLjE4NzUgMjMuMTI1IEMtNC4xMzU1MDE1OSAyMi4wNDQyNDk2IC01LjQ3Mjc4ODMxIDIwLjA5MTAxMjY4IC03LjgxMjUgMTYuMzc1IEMtOC4xMjUgMTMgLTguMTI1IDEzIC03LjgxMjUgMTAuMzc1IEMtNS41MDI1IDEwLjM3NSAtMy4xOTI1IDEwLjM3NSAtMC44MTI1IDEwLjM3NSBDLTEuMTQyNSA5LjA1NSAtMS40NzI1IDcuNzM1IC0xLjgxMjUgNi4zNzUgQy00Ljc4MjUgNS44OCAtNC43ODI1IDUuODggLTcuODEyNSA1LjM3NSBDLTUuNjI4MjEwMTUgMC44NjA4MDA5NyAtNS4wOTkzMDg2NyAwLjE5NDExNzE3IDAgMCBaICIgZmlsbD0iI0U1RUZFQiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM2MC44MTI1LDU3LjYyNSkiLz4KPHBhdGggZD0iTTAgMCBDMTUuNTEgMCAzMS4wMiAwIDQ3IDAgQzQ3IDEuNjUgNDcgMy4zIDQ3IDUgQzMxLjQ5IDUgMTUuOTggNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1OTUsNzIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzQuNjIgMCA5LjI0IDAgMTQgMCBDMTQgMS4zMiAxNCAyLjY0IDE0IDQgQzEwLjcgNCA3LjQgNCA0IDQgQzQgNS45OCA0IDcuOTYgNCAxMCBDNy4zIDEwIDEwLjYgMTAgMTQgMTAgQzE0IDExLjMyIDE0IDEyLjY0IDE0IDE0IEMxMC43IDE0IDcuNCAxNCA0IDE0IEM0IDE1Ljk4IDQgMTcuOTYgNCAyMCBDNy4zIDIwIDEwLjYgMjAgMTQgMjAgQzE0LjMzIDIxLjMyIDE0LjY2IDIyLjY0IDE1IDI0IEMxMC4wNSAyNCA1LjEgMjQgMCAyNCBDMCAxNi4wOCAwIDguMTYgMCAwIFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDU2LDg1KSIvPgo8cGF0aCBkPSJNMCAwIEMxNC41MiAwIDI5LjA0IDAgNDQgMCBDNDMuMzQgMS42NSA0Mi42OCAzLjMgNDIgNSBDMjguMTQgNSAxNC4yOCA1IDAgNSBDMCAzLjM1IDAgMS43IDAgMCBaICIgZmlsbD0iIzFFNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU0MSw5NCkiLz4KPHBhdGggZD0iTTAgMCBDMTMuODYgMCAyNy43MiAwIDQyIDAgQzQyLjY2IDEuNjUgNDMuMzIgMy4zIDQ0IDUgQzI5LjQ4IDUgMTQuOTYgNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1NDEsNTcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEuOTUxOTMyMjEgNS44NTU3OTY2MyAzLjYyOTIyNzk1IDE1LjU1OTg2NzYxIDAuOTE0MDYyNSAyMS4yOTI5Njg3NSBDMC40NDc0MjE4NyAyMS44MzU2NjQwNiAtMC4wMTkyMTg3NSAyMi4zNzgzNTkzOCAtMC41IDIyLjkzNzUgQy0zLjIyMjkwNTM0IDI1LjY1Mjg1NDI2IC0zLjIyMjkwNTM0IDI1LjY1Mjg1NDI2IC0zLjExMzI4MTI1IDI4LjQwNjI1IEMtMi44NDc1MjI1NiAzMC42NDI3NjQ2OSAtMi41MDI2MTIyNCAzMi44MDU0MjU3OCAtMiAzNSBDLTYuNjI1IDM4IC02LjYyNSAzOCAtMTAgMzggQy0xMC4zMyAzOS4zMiAtMTAuNjYgNDAuNjQgLTExIDQyIEMtMTIuMzIgNDIgLTEzLjY0IDQyIC0xNSA0MiBDLTE2LjcwMzEyNSA0MC4xMDE1NjI1IC0xNi43MDMxMjUgNDAuMTAxNTYyNSAtMTguMjUgMzcuNjI1IEMtMTguNzcwNzgxMjUgMzYuODEyODkwNjIgLTE5LjI5MTU2MjUgMzYuMDAwNzgxMjUgLTE5LjgyODEyNSAzNS4xNjQwNjI1IEMtMjEgMzMgLTIxIDMzIC0yMSAzMSBDLTE4LjA5NDUxMTE4IDI4Ljk1ODMwNTE1IC0xNi41OTg1Nzk1NCAyOCAtMTMgMjggQy0xMyAyOC45OSAtMTMgMjkuOTggLTEzIDMxIEMtMTAuMDI5ODIzMDYgMzAuMzcxODk4MjcgLTEwLjAyOTgyMzA2IDMwLjM3MTg5ODI3IC03IDI5IEMtNS44MDE2MTc5MSAyNi42NzE0NTUzNyAtNS44MDE2MTc5MSAyNi42NzE0NTUzNyAtNSAyNCBDLTQuMzI1ODIwMzEgMjMuMjk4NzUgLTMuNjUxNjQwNjMgMjIuNTk3NSAtMi45NTcwMzEyNSAyMS44NzUgQy0wLjI3MTkxNzk2IDE3LjkzMDQwMjQ0IC0wLjU4MDIxNDc2IDE0Ljk1NDI2NzczIC0wLjgxMjUgMTAuMzEyNSBDLTEuMDkwOTg5MDUgMi4xODE5NzgxMSAtMS4wOTA5ODkwNSAyLjE4MTk3ODExIDAgMCBaICIgZmlsbD0iI0VCRjNFRiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM0Miw2NSkiLz4KPHBhdGggZD0iTTAgMCBDLTAuNDAyODE3NzEgNS44NDA4NTY3NCAtMS4xMTI3NzkgOS4zNzczNTg4MSAtNSAxNCBDLTguMjkwNzY2NiAxNi43MTg0NTkzNyAtMTAuMDk2NDA4NjQgMTcuOTMzMDY3MzEgLTE0LjM3NSAxOC4yNSBDLTE1LjI0MTI1IDE4LjE2NzUgLTE2LjEwNzUgMTguMDg1IC0xNyAxOCBDLTE2LjY2ODA5NTE4IDExLjY5MzgwODQyIC0xNS41MDUxNjQ5NyA3LjU2NTU1NTkzIC0xMSAzIEMtNy4yMTg5MzIxOCAwLjU1ODA2MDM3IC00LjQ5MzYzOTc2IC0wLjM5NjQ5NzYzIDAgMCBaICIgZmlsbD0iIzAwMDAwMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzQ1LDM3KSIvPgo8cGF0aCBkPSJNMCAwIEM0Ljc1MDUzNTExIC0wLjA3NDM1MjIyIDkuNTAwNzI4ODcgLTAuMTI4Njk2OTEgMTQuMjUxNzA4OTggLTAuMTY0Nzk0OTIgQzE1Ljg2NjY3Nzg5IC0wLjE3OTg0ODc2IDE3LjQ4MTYwNjEzIC0wLjIwMDI5NjQ4IDE5LjA5NjQzNTU1IC0wLjIyNjMxODM2IEMyMS40MjI0NjU1NSAtMC4yNjI4NTI4NiAyMy43NDc5NTM0MSAtMC4yNzk3NjAxNSAyNi4wNzQyMTg3NSAtMC4yOTI5Njg3NSBDMjcuMTUxMDcxODUgLTAuMzE2MTk0NTMgMjcuMTUxMDcxODUgLTAuMzE2MTk0NTMgMjguMjQ5Njc5NTcgLTAuMzM5ODg5NTMgQzMyLjY1ODMwNTk5IC0wLjM0MTM1Nzg4IDM1LjUyNjI3Nzc5IDAuMjE1ODYwOTQgMzkgMyBDMzkgMy42NiAzOSA0LjMyIDM5IDUgQzI2LjEzIDUgMTMuMjYgNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1NDEsNTApIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuNjYgMCAxLjMyIDAgMiAwIEM1LjE4NDE5OTU5IDMuNzk2NTQ1NjcgNS4zODczNDU0OCA3LjExNjc2MjIgNS4yMzgyODEyNSAxMS44NjMyODEyNSBDNC45NDYwNDkxMyAxNC40ODM3ODg5NyA0LjA0MjM4MTk1IDE2LjU4OTQ5MTczIDMgMTkgQzIuNDgyMDk2ODIgMjMuMDU2OTA4MjUgMi42OTk5NDI5NCAyNC41NDk5MTQ0MSA1IDI4IEM3LjMzNDU4NjM1IDMxLjUwMTg3OTUzIDcuNjcyNjA3MjcgMzIuODgwMjgwNDcgNyAzNyBDNi4zNDg5OTE3IDM4LjE2Njk1MjY0IDUuNjU4MzE0NjEgMzkuMzEyMzI1OTggNC45Mzc1IDQwLjQzNzUgQzMuMTY4MTQxMTcgNDMuMjg2MDQyMjIgMi45OTk2OTkxNiA0My45ODI4NTIyOSAzLjA2MjUgNDcuNTYyNSBDNC4wMDI5NTg2MSA1MS4wMTA4NDgyMyA1LjM3ODg4Njc3IDUzLjgyODI1NjcyIDcgNTcgQzcgNTguMzIgNyA1OS42NCA3IDYxIEM1LjAyIDYxLjQ5NSA1LjAyIDYxLjQ5NSAzIDYyIEMyLjcxMTI1IDYwLjc4MzEyNSAyLjQyMjUgNTkuNTY2MjUgMi4xMjUgNTguMzEyNSBDMS41MTk4MDg4OSA1NS44MzA3ODEwNyAwLjg5MjAyOTY2IDUzLjc2NzAxMTM3IC0wLjE4NzUgNTEuNDM3NSBDLTEuMzQyMzE4NDQgNDcuOTczMDQ0NjggLTAuODE4NjU2ODYgNDUuNTI2NTIxODcgMCA0MiBDMC43NzM0Mzc1IDQwLjczMTU2MjUgMC43NzM0Mzc1IDQwLjczMTU2MjUgMS41NjI1IDM5LjQzNzUgQzMuNDExMzY2MjEgMzYuMzAyNDY1OTkgMy41MTMyNzU5MiAzNC41OTI5MzE0MSAzIDMxIEMyLjM0IDMwLjAxIDEuNjggMjkuMDIgMSAyOCBDLTEuMzMwNDM1NTggMjQuNTA0MzQ2NjQgLTEuNTg3NjMyNDQgMjMuMTEzNDI3MSAtMSAxOSBDLTAuNTA1IDE3Ljg2NTYyNSAtMC4wMSAxNi43MzEyNSAwLjUgMTUuNTYyNSBDMi41NDM3NjAwOCAxMC43MDg1Njk4MSAyLjY5NzAxMDU0IDcuMDQ3NDY4NDUgMSAyLjA2MjUgQzAuNjcgMS4zODE4NzUgMC4zNCAwLjcwMTI1IDAgMCBaICIgZmlsbD0iI0U5RjFFRSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM2OSw1OSkiLz4KPHBhdGggZD0iTTAgMCBDMS4zMiAwLjMzIDIuNjQgMC42NiA0IDEgQzUuMTU2NjQ3MzcgNi40ODI2OTA2OSA1LjExNDE2MjU1IDExLjgwMzM5Mjc0IDUuMDYyNSAxNy4zNzUgQzUuMDU3OTg4MjggMTguMzAxODM1OTQgNS4wNTM0NzY1NiAxOS4yMjg2NzE4OCA1LjA0ODgyODEyIDIwLjE4MzU5Mzc1IEM1LjAzNzExNTc0IDIyLjQ1NTc5NzA5IDUuMDIwNzEzNzIgMjQuNzI3ODYzODggNSAyNyBDMy4zNSAyNy4zMyAxLjcgMjcuNjYgMCAyOCBDLTIuNjA1MTM5NTkgMjQuMDkyMjkwNjIgLTIuMjkzNjc1NjUgMjAuNzc3NzA5MjEgLTIuMjUgMTYuMjUgQy0yLjI1NzczNDM4IDE1LjQ2MzY3MTg4IC0yLjI2NTQ2ODc1IDE0LjY3NzM0Mzc1IC0yLjI3MzQzNzUgMTMuODY3MTg3NSBDLTIuMjU2ODM4MzYgOC44NzA4NDc1NSAtMS41OTU2NjE5NSA0LjczNjMyOTkxIDAgMCBaICIgZmlsbD0iIzIyMUUyMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNTY5LDcxKSIvPgo8cGF0aCBkPSJNMCAwIEMxLjY3NTQyOTc2IDAuMjg2MDQ4OTggMy4zNDM4NTM0MyAwLjYxNzgxMjMzIDUgMSBDNi4wNjgwODM3NCA3LjI3NDk5MTk3IDcuMDQzNjc4MzkgMTMuODY4OTY0ODMgNSAyMCBDNC40NDQ5NTIwOSAyNS44ODM1MDc4OCA1Ljc0ODA2MTcyIDI4LjIyMzcxNTY1IDkgMzMgQzkuNjgyNDU2MDcgMzcuMDA5NDI5NCA5LjA2MjU0MzA2IDM5LjEyMDM1OTYxIDYuOTM3NSA0Mi40Mzc1IEM1LjE4NzQ3ODQxIDQ1LjI2MTExNjM5IDQuOTk5MzU1NTggNDUuOTYzOTEyNyA1LjA2MjUgNDkuNSBDNi4wNjQxNTYzNSA1My4yMzk1MTcwMiA3LjQxMDgyMDg0IDU2LjQ3NjE2Nzk1IDkgNjAgQzkgNjAuNjYgOSA2MS4zMiA5IDYyIEM4LjAxIDYyIDcuMDIgNjIgNiA2MiBDNS4xMjcyMDEzOCA2MC4xMzM2MDAxOSA0LjI3NzQ4OTczIDU4LjI1NjM5Mzg5IDMuNDM3NSA1Ni4zNzUgQzIuOTYxODM1OTQgNTUuMzMwODU5MzggMi40ODYxNzE4OCA1NC4yODY3MTg3NSAxLjk5NjA5Mzc1IDUzLjIxMDkzNzUgQzAuODc4NDcyMzMgNDkuNjA4MjUxOTcgMS4wMTg2Mjk2NiA0Ny42MDg1ODA1MSAyIDQ0IEMyLjUxNTYyNSA0My4xNzUgMy4wMzEyNSA0Mi4zNSAzLjU2MjUgNDEuNSBDNS4zODcwMjc1NiAzOC4zMjY5MDg1OCA1LjUxNjQ0MTE4IDM2LjYxNTA4ODI1IDUgMzMgQzQuMzE5Mzc1IDMyLjA3MTg3NSAzLjYzODc1IDMxLjE0Mzc1IDIuOTM3NSAzMC4xODc1IEMwLjMyMzM1MDI2IDI1Ljg4NjgwMjA0IDAuODgyMTgxNzcgMjIuNzc3MDAxIDIgMTggQzIuMzMgMTcuMzQgMi42NiAxNi42OCAzIDE2IEMzLjQxNzQwMjY4IDExLjA1OTExNzE1IDMuNDg3NDY4NzMgNi40MjIxNjY2NCAxIDIgQzAuMzQgMS42NyAtMC4zMiAxLjM0IC0xIDEgQy0wLjY3IDAuNjcgLTAuMzQgMC4zNCAwIDAgWiAiIGZpbGw9IiMxRDc1NTIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNzAsNTcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuMzMgMC42NiAwLjY2IDEuMzIgMSAyIEMwLjY3IDIuNjYgMC4zNCAzLjMyIDAgNCBDMC4wMjM3OTA0IDYuMzExMDc4NzggMC4wMjM3OTA0IDYuMzExMDc4NzggMC4zMTI1IDguODc1IEMwLjM5MTEzMjgxIDkuNzM4NjcxODcgMC40Njk3NjU2MyAxMC42MDIzNDM3NSAwLjU1MDc4MTI1IDExLjQ5MjE4NzUgQzEuMDAzMjA3MjQgMTQuMDE3OTA0NzUgMS44MTI2MDgzMyAxNS43NDgyMTM0IDMgMTggQzMuNzA0NDkyODkgMjMuNDAxMTEyMTcgMS45Mjk0NDIzOSAyNS42MDU4MzY0MiAtMSAzMCBDLTEuNjc4NzgwNTkgMzQuMDcyNjgzNTYgLTEuMzQxNzI0MDYgMzUuNDk4MDkyNzkgMSAzOC45Mzc1IEMzLjQ1MjU5MTI5IDQyLjY5MzAzMDQxIDMuNTUxNTQyOTEgNDQuNTg3NjU2NyAzIDQ5IEMyLjA2NTUzNDY1IDUxLjAzMTQ0NjQxIDEuMDY3NzUyMjQgNTMuMDM1MzM1ODcgMCA1NSBDLTAuNjk5MDc0MTQgNTcuNzM1NzI1ODUgLTAuNjk5MDc0MTQgNTcuNzM1NzI1ODUgLTEgNjAgQy0yLjMyIDU5LjY3IC0zLjY0IDU5LjM0IC01IDU5IEMtNC41MjI2OTE2MiA1Ny41NDEwNTc0IC00LjA0MzA4OTU4IDU2LjA4Mjg2NTA0IC0zLjU2MjUgNTQuNjI1IEMtMy4xNjIyNDYwOSA1My40MDY4MzU5NCAtMy4xNjIyNDYwOSA1My40MDY4MzU5NCAtMi43NTM5MDYyNSA1Mi4xNjQwNjI1IEMtMiA1MCAtMiA1MCAtMSA0OCBDLTAuNTQzMTA3NzYgNDQuMDcwNzI2NzUgLTAuOTU5NzA3MDkgNDEuNzM5NDU4MTMgLTMgMzguNDM3NSBDLTUuNzU4MjkzODQgMzMuNjk2NjgyNDYgLTUuNzU4MjkzODQgMzMuNjk2NjgyNDYgLTUgMzAgQy00LjM0IDI5LjA1MTI1IC0zLjY4IDI4LjEwMjUgLTMgMjcuMTI1IEMtMC41ODgzOTUzIDIzLjM1Njg2NzY2IC0wLjUyMDEwNzIzIDIxLjM5OTAxNzAyIC0xIDE3IEMtMS4zMyAxNi4xOTU2MjUgLTEuNjYgMTUuMzkxMjUgLTIgMTQuNTYyNSBDLTMuNDY1MDU4MjkgMTAuODA4Mjg4MTIgLTMuMzIwMjAxNTkgOC4wMzQ1NDAwMiAtMyA0IEMtMS41IDEuNSAtMS41IDEuNSAwIDAgWiAiIGZpbGw9IiNGMUY2RjQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNTEsNjApIi8+CjxwYXRoIGQ9Ik0wIDAgQzMgMSAzIDEgNSA0IEM1IDQuOTkgNSA1Ljk4IDUgNyBDNS42NiA2LjY3IDYuMzIgNi4zNCA3IDYgQzguNTQwMjM5OTYgNS45MzA0OTQ1OSAxMC4wODMzNDk4OCA1LjkxNTQ3NjQzIDExLjYyNSA1LjkzNzUgQzEyLjg1MDg5ODQ0IDUuOTUxMDM1MTYgMTIuODUwODk4NDQgNS45NTEwMzUxNiAxNC4xMDE1NjI1IDUuOTY0ODQzNzUgQzE1LjA0MTI4OTA2IDUuOTgyMjQ2MDkgMTUuMDQxMjg5MDYgNS45ODIyNDYwOSAxNiA2IEMxNS4yMzY4NzUgNi43NDI1IDE0LjQ3Mzc1IDcuNDg1IDEzLjY4NzUgOC4yNSBDMTEuMDU1OTU5NzIgMTAuNzU4MDE3NDUgMTEuMDU1OTU5NzIgMTAuNzU4MDE3NDUgOS42NTIzNDM3NSAxMy4wOTc2NTYyNSBDNy41MTM0ODk4OSAxNS41NjAxMTkyIDYuMDYwMDUxNDUgMTUuNzE4NTYzODUgMi44NzUgMTYuMTg3NSBDLTAuMzYzMTQzNTQgMTYuNDU4MzM3OTMgLTAuMzYzMTQzNTQgMTYuNDU4MzM3OTMgLTMgMTggQy00LjY2NjE3MTE1IDE4LjA0MDYzODMyIC02LjMzMzg4MDk1IDE4LjA0MjcyMSAtOCAxOCBDLTcuMjU5NDMzNTkgMTYuOTMwNzIyNjYgLTcuMjU5NDMzNTkgMTYuOTMwNzIyNjYgLTYuNTAzOTA2MjUgMTUuODM5ODQzNzUgQy0xLjU0NzYwNyA4LjUwMTAxOTAzIC0xLjU0NzYwNyA4LjUwMTAxOTAzIDAgMCBaICIgZmlsbD0iI0VGRjVGMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTMyNiw1NSkiLz4KPHBhdGggZD0iTTAgMCBDMS44NzUgMS4xMjUgMS44NzUgMS4xMjUgMyAzIEMzLjY4NzUgNi4xODc1IDMuNjg3NSA2LjE4NzUgNCA5IEMwLjM3IDkgLTMuMjYgOSAtNyA5IEMtNi4wMSA5Ljk5IC01LjAyIDEwLjk4IC00IDEyIEMtMC4zNTQ1ODE1NSAxMS43NjUyMjgwMSAtMC4zNTQ1ODE1NSAxMS43NjUyMjgwMSAzIDExIEMyLjY3IDEyLjY1IDIuMzQgMTQuMyAyIDE2IEMtNC4yNDE1OTc5NyAxNy4zNDYyMjcwMSAtNC4yNDE1OTc5NyAxNy4zNDYyMjcwMSAtNy44NzUgMTUuNjg3NSBDLTEwIDE0IC0xMCAxNCAtMTEgMTIgQy0xMS41NzE0Mjg1NyA0LjkxNDI4NTcxIC0xMS41NzE0Mjg1NyA0LjkxNDI4NTcxIC05LjQzNzUgMS41IEMtNi4wODk2NTY1MSAtMC41NjAyMTEzOCAtMy44NTk4NTc1MyAtMC40OTEyNTQ1OSAwIDAgWiBNLTUgMyBDLTUuOTkgNC40ODUgLTUuOTkgNC40ODUgLTcgNiBDLTQuNjkgNiAtMi4zOCA2IDAgNiBDLTAuNjYgNS4wMSAtMS4zMiA0LjAyIC0yIDMgQy0yLjk5IDMgLTMuOTggMyAtNSAzIFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMTAwLDkzKSIvPgo8cGF0aCBkPSJNMCAwIEMxMC44OSAwIDIxLjc4IDAgMzMgMCBDMzIuNjcgMS4zMiAzMi4zNCAyLjY0IDMyIDQgQzI5LjA3ODAyMzEgNS40NjA5ODg0NSAyNi41MDEwNjUyNSA1LjExMTM0OTAxIDIzLjI0MjE4NzUgNS4wOTc2NTYyNSBDMjIuMjQ3NjEwMzIgNS4wOTU1MzM4MyAyMi4yNDc2MTAzMiA1LjA5NTUzMzgzIDIxLjIzMjk0MDY3IDUuMDkzMzY4NTMgQzE5LjExMzU4MTM3IDUuMDg3NzY3NTQgMTYuOTk0MzI3NDEgNS4wNzUyMTUgMTQuODc1IDUuMDYyNSBDMTMuNDM4ODAzNjEgNS4wNTc0ODUxMiAxMi4wMDI2MDU1NiA1LjA1MjkyMjE5IDEwLjU2NjQwNjI1IDUuMDQ4ODI4MTIgQzcuMDQ0MjM2NTUgNS4wMzc3OTc4MiAzLjUyMjEyODU1IDUuMDIwNTMyNTkgMCA1IEMwIDMuMzUgMCAxLjcgMCAwIFogIiBmaWxsPSIjMUU3MEMwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNTQ5LDcyKSIvPgo8cGF0aCBkPSJNMCAwIEM0LjIxNzQ5MjE5IC0wLjA3NDE5MTM0IDguNDM0NjM4MTEgLTAuMTI4NjIwNCAxMi42NTI1ODc4OSAtMC4xNjQ3OTQ5MiBDMTQuMDg3MjI1NTIgLTAuMTc5ODc1ODkgMTUuNTIxODE3MDggLTAuMjAwMzQzOCAxNi45NTYyOTg4MyAtMC4yMjYzMTgzNiBDMTkuMDE5MTU4NTkgLTAuMjYyNzM0MzcgMjEuMDgxNDA4NTggLTAuMjc5NzMyNDMgMjMuMTQ0NTMxMjUgLTAuMjkyOTY4NzUgQzI1LjAwNjIxOTQ4IC0wLjMxNjUzNDQyIDI1LjAwNjIxOTQ4IC0wLjMxNjUzNDQyIDI2LjkwNTUxNzU4IC0wLjM0MDU3NjE3IEMzMCAwIDMwIDAgMzEuOTI4NDY2OCAxLjM5MzMxMDU1IEMzMyAzIDMzIDMgMzMgNSBDMjIuMTEgNSAxMS4yMiA1IDAgNSBDMCAzLjM1IDAgMS43IDAgMCBaICIgZmlsbD0iIzFGNzBDMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU0OSw3OSkiLz4KPHBhdGggZD0iTTAgMCBDMC42NiAwIDEuMzIgMCAyIDAgQzIuMDg2MzY3MTkgMC41Njg0NzY1NiAyLjE3MjczNDM3IDEuMTM2OTUzMTIgMi4yNjE3MTg3NSAxLjcyMjY1NjI1IEMzLjM1MjcwNTM2IDcuNzE4MDc4MSA1LjI4MTQzMTU2IDExLjIwNTAwMzg1IDkgMTYgQzkgMTYuNjYgOSAxNy4zMiA5IDE4IEM4LjI3NTU0Njg3IDE3Ljg0NjYwMTU2IDcuNTUxMDkzNzUgMTcuNjkzMjAzMTIgNi44MDQ2ODc1IDE3LjUzNTE1NjI1IEM0LjA3MzM2NjA3IDE2Ljk3MzE0OTc3IDQuMDczMzY2MDcgMTYuOTczMTQ5NzcgMS41NzAzMTI1IDE2Ljc0NjA5Mzc1IEMtNC45MDkwNjM1OCAxNS45Mjg0MDg5MSAtNy44MDY5NTYzOCAxMy44OTExMzYyMyAtMTEuODIwMzEyNSA4Ljc3NzM0Mzc1IEMtMTMgNyAtMTMgNyAtMTMgNiBDLTYuMzc1IDUuODc1IC02LjM3NSA1Ljg3NSAtMyA3IEMtMi44NzYyNSA2LjQwMTg3NSAtMi43NTI1IDUuODAzNzUgLTIuNjI1IDUuMTg3NSBDLTIgMyAtMiAzIDAgMCBaICIgZmlsbD0iI0YyRjdGNSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM5NCw1NSkiLz4KPHBhdGggZD0iTTAgMCBDMSAyIDEgMiAwLjkzNzUgNS44MTI1IEMwLjg3OTY0ODA4IDkuMzg2NDYzMTggMS42NDA2MzE3NyAxMS42ODY1Mzk5NCAzIDE1IEMzLjQ3NzIyODgxIDE5LjM3NDU5NzM5IDMuNDk4NjQwNDQgMjEuMjg5ODE1MTMgMC45Mzc1IDI0LjkzNzUgQy0xLjA1MTY1MDY5IDI4LjA4MTY0MTQxIC0xLjI4MzkwMDM2IDI4LjY1NDU4MTU5IC0wLjkzNzUgMzIuMTI1IEMtMC4wNDE1OTEyMiAzNS44MjgwODk2MSAwLjc4Mzk2MDg3IDM3LjEwOTUxNDE4IDMgNDAgQzMuNjQwNzA0NzggNDQuOTEyMDY5OTQgMi4yODAwNjUxNiA0Ny43MTM0Nzc1IDAgNTIgQy0wLjY5OTA3NDE0IDU0LjczNTcyNTg1IC0wLjY5OTA3NDE0IDU0LjczNTcyNTg1IC0xIDU3IEMtMS45OSA1NyAtMi45OCA1NyAtNCA1NyBDLTMuMjQ3ODEzNDEgNTAuNDgxMDQ5NTYgLTMuMjQ3ODEzNDEgNTAuNDgxMDQ5NTYgLTEuOTM3NSA0Ny45Mzc1IEMtMC41NTU0NjYzNyA0NS4wODEyOTcxNyAtMC42Mjk3ODY4MiA0My4xNDY4MTIgLTEgNDAgQy0xLjkyMzQ0MjExIDM4LjIzNzkyNDggLTEuOTIzNDQyMTEgMzguMjM3OTI0OCAtMy4wNjI1IDM2LjUgQy00LjcyOTM3MDExIDMzLjgyMjM2ODIyIC01LjAwMjU5OTI2IDMzLjEzMjU2MjEgLTQuOTM3NSAyOS44MTI1IEMtNCAyNyAtNCAyNyAtMi40Mzc1IDI1LjE4NzUgQy0wLjE2NjczOTU4IDIxLjczMTk5NTAyIC0wLjYxNDU0MzE5IDE4LjAyNTA1ODY1IC0xIDE0IEMtMS4zMyAxMy4wMSAtMS42NiAxMi4wMiAtMiAxMSBDLTIuMTY3OTY4NzUgOS4wNjI1IC0yLjE2Nzk2ODc1IDkuMDYyNSAtMi4xODc1IDcgQy0yLjIwMTY3OTY5IDYuMzE5Mzc1IC0yLjIxNTg1OTM4IDUuNjM4NzUgLTIuMjMwNDY4NzUgNC45Mzc1IEMtMiAzIC0yIDMgMCAwIFogIiBmaWxsPSIjMTQ3MDRCIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzQ4LDYyKSIvPgo8cGF0aCBkPSJNMCAwIEMxMi44NyAwIDI1Ljc0IDAgMzkgMCBDMzUuMDM1MDk2OTkgMy45NjQ5MDMwMSAzNS4wMzUwOTY5OSAzLjk2NDkwMzAxIDMwLjY1MTg1NTQ3IDQuMTEzNTI1MzkgQzI5LjIyMzYyMzAzIDQuMTEzMzY2ODggMjcuNzk1Mzg0NTggNC4xMDc3MDczNSAyNi4zNjcxODc1IDQuMDk3NjU2MjUgQzI1LjIzOTQzNDA1IDQuMDk1NTMzODMgMjUuMjM5NDM0MDUgNC4wOTU1MzM4MyAyNC4wODg4OTc3MSA0LjA5MzM2ODUzIEMyMS42ODQyMjQ5IDQuMDg3NzY0NjUgMTkuMjc5NjQ0NzMgNC4wNzUyMTE1NyAxNi44NzUgNC4wNjI1IEMxNS4yNDYwOTUwOSA0LjA1NzQ4NTUgMTMuNjE3MTg4NzMgNC4wNTI5MjI1IDExLjk4ODI4MTI1IDQuMDQ4ODI4MTIgQzcuOTkyMTUxNzMgNC4wMzc3OTM5NyAzLjk5NjA5MTU4IDQuMDIwNTI2NzkgMCA0IEMwIDIuNjggMCAxLjM2IDAgMCBaICIgZmlsbD0iIzFGNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU0MSwxMDIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuNDQ1MDA2NiAyLjkzNTY2NDIzIDMuNTc0ODI0NjQgNS4yNTc0NDI5NCAzLjk2ODc1IDkuNTk3NjU2MjUgQzMuOTk4ODM1MiAxMS45MTA0NTU4IDMuNzA3ODg2MzggMTMuODY2Mzg3MzUgMy4yNSAxNi4xMjUgQzIuOTg0MTIwNjEgMjAuMjQ2MTMwNTMgMy4xMDk4NDA0MiAyMC42ODU1NzQyMiA1LjQzNzUgMjMuNzUgQzUuOTEwNTg1OTQgMjQuMjgxMDkzNzUgNi4zODM2NzE4NyAyNC44MTIxODc1IDYuODcxMDkzNzUgMjUuMzU5Mzc1IEM4IDI3IDggMjcgOCAzMSBDMTAuMzEgMzEuNjYgMTIuNjIgMzIuMzIgMTUgMzMgQzE1IDMzLjk5IDE1IDM0Ljk4IDE1IDM2IEMxNi4zMiAzNi42NiAxNy42NCAzNy4zMiAxOSAzOCBDMTkgMzguOTkgMTkgMzkuOTggMTkgNDEgQzE3LjkxNzE4NzUgNDAuNDc0MDYyNSAxNy45MTcxODc1IDQwLjQ3NDA2MjUgMTYuODEyNSAzOS45Mzc1IEMxNC4wNzY4ODc3IDM4Ljc1NjQ4MjEyIDE0LjA3Njg4NzcgMzguNzU2NDgyMTIgMTEuNSAzOS41NjI1IEM5IDQwIDkgNDAgNi4xODc1IDM4LjU2MjUgQzUuNDY1NjI1IDM4LjA0Njg3NSA0Ljc0Mzc1IDM3LjUzMTI1IDQgMzcgQzQuMTk1MjkyOTcgMzYuMTY0Njg3NSA0LjE5NTI5Mjk3IDM2LjE2NDY4NzUgNC4zOTQ1MzEyNSAzNS4zMTI1IEM1LjMwMzg2MTMxIDMwLjQ2NzI5MzAxIDUuMzAzODYxMzEgMzAuNDY3MjkzMDEgMy45MTc5Njg3NSAyNS44NjcxODc1IEMyLjk3NDUwMDc2IDI0LjU0MTY1Mzk2IDIuMDI5MTkzNjQgMjMuMjE3NDI3NDggMS4wODIwMzEyNSAyMS44OTQ1MzEyNSBDLTAuNjgwNTA5NzQgMTguODA4NDkzNzggMC4yMzQyODE5NyAxNi4zNTczNzkwNyAxIDEzIEMxLjA4MjI5MTcgMTEuNDM5MTEyMjkgMS4xMjI0NDU5OSA5Ljg3NTU1MzM3IDEuMTI1IDguMzEyNSBDMS4xMjg4NjcxOSA3LjIyMzg4NjcyIDEuMTI4ODY3MTkgNy4yMjM4ODY3MiAxLjEzMjgxMjUgNi4xMTMyODEyNSBDMC45OTc4MDczMiAzLjk2NTExMDU5IDAuNTg3NzI5NCAyLjA2NjM4MTk1IDAgMCBaICIgZmlsbD0iI0VGRjVGMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM3OCw2MykiLz4KPHBhdGggZD0iTTAgMCBDOS4yNCAwIDE4LjQ4IDAgMjggMCBDMjggMS42NSAyOCAzLjMgMjggNSBDMTguNzYgNSA5LjUyIDUgMCA1IEMwIDMuMzUgMCAxLjcgMCAwIFogIiBmaWxsPSIjMUU3MEMxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNTEwLDk0KSIvPgo8cGF0aCBkPSJNMCAwIEM5LjI0IDAgMTguNDggMCAyOCAwIEMyOCAxLjY1IDI4IDMuMyAyOCA1IEMxOC43NiA1IDkuNTIgNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1MTAsNTcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzkuMjQgMCAxOC40OCAwIDI4IDAgQzI4IDEuNjUgMjggMy4zIDI4IDUgQzE4Ljc2IDUgOS41MiA1IDAgNSBDMCAzLjM1IDAgMS43IDAgMCBaICIgZmlsbD0iIzFGNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTUxMCw1MCkiLz4KPHBhdGggZD0iTTAgMCBDMCAzIDAgMyAtMSA1IEMtMS4yMTM3NzcyMSAxMC42MDcwMzIxMyAtMS4yMTM3NzcyMSAxMC42MDcwMzIxMyAwIDE2IEMwLjc1NDE0MjM1IDIyLjQ5MDU2OTM3IC0wLjI2NzY1MDE5IDI1LjU4MjA3Mjg1IC00IDMxIEMtMy45Mjc0OTIxNCAzNC41NTI4ODQ5NCAtMy4zMTc3NDE2NCAzNi40OTE2MTMzNyAtMS40Mzc1IDM5LjUgQzAuNDMyMjMyNTQgNDIuNzUxNzA4NzYgMC40OTI4MjA0OCA0NC4yNjg2NDQ5NCAwIDQ4IEMtMS4xNzkwNDA1IDUxLjQwNDQxNTYzIC0yLjU0MTk2MzU0IDU0LjcwNjM5OTc4IC00IDU4IEMtNC45OSA1Ny42NyAtNS45OCA1Ny4zNCAtNyA1NyBDLTYuNTc1MjcyMSA1NC40NTE2MzI2IC02LjE4NjYwNjY3IDUyLjM0MDI4Mjc1IC00LjkzNzUgNTAuMDYyNSBDLTMuNjI5MDkzODEgNDcuMTg0MDA2MzkgLTMuNjg2MTgxNDMgNDUuMTM4MTg1NzMgLTQgNDIgQy00LjQ5NSA0MS4wMSAtNC45OSA0MC4wMiAtNS41IDM5IEMtNy4yMTc0NTA3IDM1LjU2NTA5ODYgLTcuNTUyMzU3MzMgMzMuNzg3NTkzMTMgLTcgMzAgQy01Ljk4MjkyOTY5IDI4LjY2Nzc1MzkxIC01Ljk4MjkyOTY5IDI4LjY2Nzc1MzkxIC00Ljk0NTMxMjUgMjcuMzA4NTkzNzUgQy0yLjU3NzgwMDU3IDIzLjI4MTkyMTg1IC0yLjgyMDAzNjc0IDIwLjUwMjM1NDg2IC0zLjQzNzUgMTYuMDYyNSBDLTQuMjQwNTQ3MzkgMTAuMDc2NjY0NDYgLTMuNzgyNzc2OTMgNi4zMjc0MTg5MSAtMSAxIEMtMC42NyAwLjY3IC0wLjM0IDAuMzQgMCAwIFogIiBmaWxsPSIjRTRFRUVBIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzQ4LDYwKSIvPgo8cGF0aCBkPSJNMCAwIEMzLjkwOTM4NzAzIDMuNzM5NDEzNjggMy45MDkzODcwMyAzLjczOTQxMzY4IDQuMTMyODEyNSA2Ljg0NzY1NjI1IEM0LjEzMDIzNDM4IDcuNTc4NTU0NjkgNC4xMjc2NTYyNSA4LjMwOTQ1MzEzIDQuMTI1IDkuMDYyNSBDNC4xMjI0MjE4OCA5Ljg2MzAwNzgxIDQuMTE5ODQzNzUgMTAuNjYzNTE1NjMgNC4xMTcxODc1IDExLjQ4ODI4MTI1IEM0LjAwMTcwMTk1IDEzLjk2MzUyMTY0IDMuNjUxMDI0NzkgMTYuMzA3MDIyNDggMy4yNSAxOC43NSBDMi43NjIwMjY5NSAyMi40MjA4OTQxOCAyLjc2MjAyNjk1IDIyLjQyMDg5NDE4IDQuOTM3NSAyNS41NjI1IEM1Ljk1ODQzNzUgMjYuNzY5MDYyNSA1Ljk1ODQzNzUgMjYuNzY5MDYyNSA3IDI4IEM4LjA0NzU1MTk0IDMzLjMxNDE0MzcgNi44NDIyMzI0NCAzNi40OTk3OTg2MyA0IDQxIEMzLjM3MDk3MDM5IDQ1LjkyNzM5ODU3IDQuNzQ3ODkzNDUgNDguNjgzNDYyNDQgNyA1MyBDNyA1NC4zMiA3IDU1LjY0IDcgNTcgQzQgNTYgNCA1NiAyLjc5Njg3NSA1My45MjU3ODEyNSBDLTAuNzYwMjg1NzMgNDUuMDQ2MTUyNDIgLTAuNzYwMjg1NzMgNDUuMDQ2MTUyNDIgMSA0MCBDMS41MTU2MjUgMzkuMTc1IDIuMDMxMjUgMzguMzUgMi41NjI1IDM3LjUgQzQuMzg3MDI3NTYgMzQuMzI2OTA4NTggNC41MTY0NDExOCAzMi42MTUwODgyNSA0IDI5IEMzLjM0IDI4LjAzMDYyNSAyLjY4IDI3LjA2MTI1IDIgMjYuMDYyNSBDLTAuNDEwNTc3ODIgMjIuMzcxMzAyNzIgLTAuNDA4MzI3NTUgMjAuMzI4MjcxOTkgMCAxNiBDMC4zMyAxNS4wMSAwLjY2IDE0LjAyIDEgMTMgQzEuMDkyNDczODEgMTEuNTIzMTM4ODkgMS4xMjk5OTA3MSAxMC4wNDIyNDQ5OSAxLjEyNSA4LjU2MjUgQzEuMTI4ODY3MTkgNy40MTk3NDYwOSAxLjEyODg2NzE5IDcuNDE5NzQ2MDkgMS4xMzI4MTI1IDYuMjUzOTA2MjUgQzEuMDAyNzYwMTUgNC4wNDY4NDE0MSAwLjYwODU2MTk5IDIuMTIwMzA3MjQgMCAwIFogIiBmaWxsPSIjRTZGMEVDIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzc0LDYxKSIvPgo8cGF0aCBkPSJNMCAwIEM4LjI1IDAgMTYuNSAwIDI1IDAgQzI1LjY2IDEuNjUgMjYuMzIgMy4zIDI3IDUgQzE4LjA5IDUgOS4xOCA1IDAgNSBDMCAzLjM1IDAgMS43IDAgMCBaICIgZmlsbD0iIzFFNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU4Nyw1NykiLz4KPHBhdGggZD0iTTAgMCBDOC4yNSAwIDE2LjUgMCAyNSAwIEMyNSAxLjY1IDI1IDMuMyAyNSA1IEMxNi40MiA1IDcuODQgNSAtMSA1IEMtMC42NyAzLjM1IC0wLjM0IDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MjQsNTcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuNjYgMCAxLjMyIDAgMiAwIEMyLjMzIDEuNjUgMi42NiAzLjMgMyA1IEM0LjY1IDUgNi4zIDUgOCA1IEM3LjAxIDYuNDg1IDcuMDEgNi40ODUgNiA4IEM1LjgzMjg2NDMxIDEwLjYyNTMxNTI0IDUuODMyODY0MzEgMTAuNjI1MzE1MjQgNiAxMyBDNi42NiAxMy4zMyA3LjMyIDEzLjY2IDggMTQgQzcuMzQgMTQgNi42OCAxNCA2IDE0IEM2IDE0LjY2IDYgMTUuMzIgNiAxNiBDMi43IDE2IC0wLjYgMTYgLTQgMTYgQy00IDE1LjM0IC00IDE0LjY4IC00IDE0IEMtNC42NiAxMy42NyAtNS4zMiAxMy4zNCAtNiAxMyBDLTUuMzQgMTMgLTQuNjggMTMgLTQgMTMgQy0zLjc5OTEzNTU3IDkuMjg0MDA4MDkgLTMuODQ4MDU2MyA4LjIyNzkxNTU1IC02IDUgQy00LjM1IDUgLTIuNyA1IC0xIDUgQy0wLjY3IDMuMzUgLTAuMzQgMS43IDAgMCBaICIgZmlsbD0iI0Q4RTdFMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM2MCwzNykiLz4KPHBhdGggZD0iTTAgMCBDMCAxLjY1IDAgMy4zIDAgNSBDLTAuNzYzMTI1IDQuNzczMTI1IC0xLjUyNjI1IDQuNTQ2MjUgLTIuMzEyNSA0LjMxMjUgQy0zLjE5OTM3NSA0LjIwOTM3NSAtNC4wODYyNSA0LjEwNjI1IC01IDQgQy02LjgzNTQ3OTkgNS4zMzM3ODU3NSAtNi44MzU0Nzk5IDUuMzMzNzg1NzUgLTggNyBDLTcuMzQgOC42NSAtNi42OCAxMC4zIC02IDEyIEMtMy42OSAxMiAtMS4zOCAxMiAxIDEyIEMxIDEzLjMyIDEgMTQuNjQgMSAxNiBDLTUuMjAwODE5NjcgMTcuMzM3NDMxNjkgLTUuMjAwODE5NjcgMTcuMzM3NDMxNjkgLTguODEyNSAxNS44MTI1IEMtMTEuMTQwMzY2MTcgMTMuODgzNjk2NiAtMTIuMTcyMjU2MTEgMTIuODk3MTAzNjEgLTEzIDEwIEMtMTIuODU1NzAyNCA2LjUzNjg1NzUgLTEyLjM0NTYyNDk3IDQuNTI1MzQ5OTYgLTEwLjQzNzUgMS42MjUgQy02Ljg1NzUyODY3IC0wLjc2MTY0NzU1IC00LjI0ODUyOTc0IC0wLjI4MzIzNTMyIDAgMCBaICIgZmlsbD0iIzAwODQyOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjE5Miw5MykiLz4KPHBhdGggZD0iTTAgMCBDMCAwLjk5IDAgMS45OCAwIDMgQzEuNjUgMyAzLjMgMyA1IDMgQzUgNC4zMiA1IDUuNjQgNSA3IEMzLjM1IDcgMS43IDcgMCA3IEMwIDkuOTcgMCAxMi45NCAwIDE2IEMxLjY1IDE1LjY3IDMuMyAxNS4zNCA1IDE1IEM1IDE2LjMyIDUgMTcuNjQgNSAxOSBDMS43MTMwMzc2NyAxOS43OTk1MzEzOCAwLjI4OTc2ODA4IDIwLjA5NjU4OTM2IC0zIDE5IEMtNC4yNjIzNzczMSAxNi40NzUyNDUzOCAtNC4wOTg1NjQwNCAxNC42ODc5OTUzNCAtNC4wNjI1IDExLjg3NSBDLTQuMDUzNDc2NTYgMTAuOTY0OTIxODggLTQuMDQ0NDUzMTMgMTAuMDU0ODQzNzUgLTQuMDM1MTU2MjUgOS4xMTcxODc1IEMtNC4wMjM1NTQ2OSA4LjQxODUxNTYyIC00LjAxMTk1MzEzIDcuNzE5ODQzNzUgLTQgNyBDLTQuOTkgNyAtNS45OCA3IC03IDcgQy0zLjg2MjA2ODk3IDAgLTMuODYyMDY4OTcgMCAwIDAgWiAiIGZpbGw9IiMwMDg0MjkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIxMzcsOTApIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuMzMgMS42NSAwLjY2IDMuMyAxIDUgQzAuMDUxMjUgNC43OTM3NSAtMC44OTc1IDQuNTg3NSAtMS44NzUgNC4zNzUgQy0zLjQyMTg3NSA0LjE4OTM3NSAtMy40MjE4NzUgNC4xODkzNzUgLTUgNCBDLTcuMzQ5NzM4MTggNS44OTc1NTE0NCAtNy4zNDk3MzgxOCA1Ljg5NzU1MTQ0IC03LjEyNSA5LjEyNSBDLTcuMDYzMTI1IDEwLjU0ODEyNSAtNy4wNjMxMjUgMTAuNTQ4MTI1IC03IDEyIEMtNC4zNiAxMiAtMS43MiAxMiAxIDEyIEMxIDEzLjMyIDEgMTQuNjQgMSAxNiBDLTUuMzI5OTc5ODggMTcuMjE3MzAzODIgLTUuMzI5OTc5ODggMTcuMjE3MzAzODIgLTguMzEyNSAxNi4yNSBDLTEwIDE1IC0xMCAxNSAtMTIgMTIgQy0xMi40NDUwNTU3NiA3Ljk5NDQ5ODEzIC0xMi4zNDMxOTE2NyA1LjY3MjA4MzY5IC0xMC41IDIuMDYyNSBDLTYuODg4MjI0MDkgLTAuOTE3MjE1MTMgLTQuNTg5MTk0MjEgLTAuMzgyNDMyODUgMCAwIFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMTIyLDkzKSIvPgo8cGF0aCBkPSJNMCAwIEM3LjU5IDAgMTUuMTggMCAyMyAwIEMyMy4zMyAxLjY1IDIzLjY2IDMuMyAyNCA1IEMxNi4wOCA1IDguMTYgNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRjcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1ODcsNTApIi8+CjxwYXRoIGQ9Ik0wIDAgQzcuMjYgMCAxNC41MiAwIDIyIDAgQzIyIDEuNjUgMjIgMy4zIDIyIDUgQzE0LjQxIDUgNi44MiA1IC0xIDUgQy0wLjY3IDMuMzUgLTAuMzQgMS43IDAgMCBaICIgZmlsbD0iIzFGNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTYyNyw1MCkiLz4KPHBhdGggZD0iTTAgMCBDMy45NiAwIDcuOTIgMCAxMiAwIEMxMiAzLjY2NjY2NjY3IDEyIDcuMzMzMzMzMzMgMTIgMTEgQzguMDQgMTEgNC4wOCAxMSAwIDExIEMwIDcuMzMzMzMzMzMgMCAzLjY2NjY2NjY3IDAgMCBaICIgZmlsbD0iI0U4MjAyNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTc4MiwxMTYpIi8+CjxwYXRoIGQ9Ik0wIDAgQzkuMjQgMCAxOC40OCAwIDI4IDAgQzI4IDEuMzIgMjggMi42NCAyOCA0IEMxOC43NiA0IDkuNTIgNCAwIDQgQzAgMi42OCAwIDEuMzYgMCAwIFogIiBmaWxsPSIjMUU3MEMwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNTEwLDEwMikiLz4KPHBhdGggZD0iTTAgMCBDMCAxLjY1IDAgMy4zIDAgNSBDLTAuNTU1NTg1OTQgNC41MTQwMjM0NCAtMS4xMTExNzE4OCA0LjAyODA0Njg4IC0xLjY4MzU5Mzc1IDMuNTI3MzQzNzUgQy00LjM3OTY1MzUgMS43NDk2NzE5NyAtNS44NjQwNjM4NiAxLjU2NzMyNDE5IC05LjA2MjUgMS41NjI1IEMtOS45MTk3MjY1NiAxLjU0MzE2NDA2IC0xMC43NzY5NTMxMyAxLjUyMzgyODEzIC0xMS42NjAxNTYyNSAxLjUwMzkwNjI1IEMtMTQuMTc3NTgwNDEgMS43OTY0NDEzNyAtMTQuMTc3NTgwNDEgMS43OTY0NDEzNyAtMTUuODA4NTkzNzUgNC4wMjczNDM3NSBDLTE2LjM5ODMzOTg0IDUuMDAzODA4NTkgLTE2LjM5ODMzOTg0IDUuMDAzODA4NTkgLTE3IDYgQy0xNS4wMiA2IC0xMy4wNCA2IC0xMSA2IEMtMTAuNjcgNy42NSAtMTAuMzQgOS4zIC0xMCAxMSBDLTExLjMyIDExIC0xMi42NCAxMSAtMTQgMTEgQy0xNCAxMC4zNCAtMTQgOS42OCAtMTQgOSBDLTE1LjMyIDkgLTE2LjY0IDkgLTE4IDkgQy0xOC4zMyA3LjM1IC0xOC42NiA1LjcgLTE5IDQgQy0xOS42NiA0LjY2IC0yMC4zMiA1LjMyIC0yMSA2IEMtMjEgNC4wMiAtMjEgMi4wNCAtMjEgMCBDLTEzLjk3OTM2NDY0IC0yLjM5MDAwMzUzIC02Ljg1MjIxNDU0IC0zLjUzNjYyNjg2IDAgMCBaICIgZmlsbD0iIzE5NzM0RiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM3MCw1NykiLz4KPHBhdGggZD0iTTAgMCBDNi45MyAwIDEzLjg2IDAgMjEgMCBDMjEgMS42NSAyMSAzLjMgMjEgNSBDMTQuMDcgNSA3LjE0IDUgMCA1IEMwIDMuMzUgMCAxLjcgMCAwIFogIiBmaWxsPSIjMUU3MEMwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjI5LDk0KSIvPgo8cGF0aCBkPSJNMCAwIEMwIDAuOTkgMCAxLjk4IDAgMyBDLTAuOTkgMyAtMS45OCAzIC0zIDMgQy0zIDMuNjYgLTMgNC4zMiAtMyA1IEMtMi4wMSA1LjMzIC0xLjAyIDUuNjYgMCA2IEMwIDcuMzIgMCA4LjY0IDAgMTAgQy02LjYyNSAxMi44NzUgLTYuNjI1IDEyLjg3NSAtMTAgMTQgQy0xMS4xOTI4NzQxMSAxMC4xMjMxNTkxMyAtMTIgNy4wODM3ODA3NyAtMTIgMyBDLTEwLjc1MzM2NjY5IDIuNDkxNjY0MDkgLTkuNTAyNTA2MTMgMS45OTM2ODg1NSAtOC4yNSAxLjUgQy03LjU1MzkwNjI1IDEuMjIxNTYyNSAtNi44NTc4MTI1IDAuOTQzMTI1IC02LjE0MDYyNSAwLjY1NjI1IEMtNCAwIC00IDAgMCAwIFogIiBmaWxsPSIjMUM3NTUxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzI5LDgwKSIvPgo8cGF0aCBkPSJNMCAwIEM2LjYgMCAxMy4yIDAgMjAgMCBDMjAgMS42NSAyMCAzLjMgMjAgNSBDMTMuNCA1IDYuOCA1IDAgNSBDMCAzLjM1IDAgMS43IDAgMCBaICIgZmlsbD0iIzFFNzBDMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU4Nyw5NCkiLz4KPHBhdGggZD0iTTAgMCBDMS4zMiAwIDIuNjQgMCA0IDAgQzQgNy45MiA0IDE1Ljg0IDQgMjQgQzIuNjggMjQgMS4zNiAyNCAwIDI0IEMwIDE2LjA4IDAgOC4xNiAwIDAgWiAiIGZpbGw9IiMwMDg0MjkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIwNzcsODUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEuNjA4NzUgLTAuMDIwNjI1IDMuMjE3NSAtMC4wNDEyNSA0Ljg3NSAtMC4wNjI1IEM1Ljc3OTkyMTg4IC0wLjA3NDEwMTU2IDYuNjg0ODQzNzUgLTAuMDg1NzAzMTIgNy42MTcxODc1IC0wLjA5NzY1NjI1IEMxMCAwIDEwIDAgMTIgMSBDMTEuMzQgMi4zMiAxMC42OCAzLjY0IDEwIDUgQzguMzUgNSA2LjcgNSA1IDUgQzQuNjcgOC42MyA0LjM0IDEyLjI2IDQgMTYgQzIuNjggMTYgMS4zNiAxNiAwIDE2IEMwIDEwLjcyIDAgNS40NCAwIDAgWiAiIGZpbGw9IiMwMDg0MjkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIxNDksOTMpIi8+CjxwYXRoIGQ9Ik0wIDAgQzYuMjcgMCAxMi41NCAwIDE5IDAgQzE4LjY3IDEuNjUgMTguMzQgMy4zIDE4IDUgQzEyLjM5IDUgNi43OCA1IDEgNSBDMC42NyAzLjM1IDAuMzQgMS43IDAgMCBaICIgZmlsbD0iIzFGNzBDMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTYwOSw3OSkiLz4KPHBhdGggZD0iTTAgMCBDNi45MyAwIDEzLjg2IDAgMjEgMCBDMjEgMS4zMiAyMSAyLjY0IDIxIDQgQzEzLjc0IDQgNi40OCA0IC0xIDQgQy0wLjY3IDIuNjggLTAuMzQgMS4zNiAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MjEsNjUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuODEyNSAyLjE4NzUgMC44MTI1IDIuMTg3NSAxIDUgQy0xLjEyNSA3Ljg3NSAtMS4xMjUgNy44NzUgLTQgMTAgQy02LjgxMjUgOS44MTI1IC02LjgxMjUgOS44MTI1IC05IDkgQy05Ljc1IDYuNzUgLTkuNzUgNi43NSAtMTAgNCBDLTcuMTk2NDEzNTIgLTAuMTQ5MzA3OTkgLTQuODI5NDYzOCAtMC40MzkwNDIxNiAwIDAgWiAiIGZpbGw9IiMwMDg0MjkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIxMDgsNDApIi8+CjxwYXRoIGQ9Ik0wIDAgQzYuOTMgMCAxMy44NiAwIDIxIDAgQzIxIDEuMzIgMjEgMi42NCAyMSA0IEMxNC4wNyA0IDcuMTQgNCAwIDQgQzAgMi42OCAwIDEuMzYgMCAwIFogIiBmaWxsPSIjMUU3MEMwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjI5LDEwMikiLz4KPHBhdGggZD0iTTAgMCBDNi42IDAgMTMuMiAwIDIwIDAgQzIwLjMzIDEuMzIgMjAuNjYgMi42NCAyMSA0IEMxNC4wNyA0IDcuMTQgNCAwIDQgQzAgMi42OCAwIDEuMzYgMCAwIFogIiBmaWxsPSIjMUU3MEMwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNTk1LDY1KSIvPgo8cGF0aCBkPSJNMCAwIEM2LjYgMCAxMy4yIDAgMjAgMCBDMjAgMS4zMiAyMCAyLjY0IDIwIDQgQzEzLjQgNCA2LjggNCAwIDQgQzAgMi42OCAwIDEuMzYgMCAwIFogIiBmaWxsPSIjMUU3MEMxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNTg3LDEwMikiLz4KPHBhdGggZD0iTTAgMCBDMC4zMyAwLjY2IDAuNjYgMS4zMiAxIDIgQzAuNjcgMi42NiAwLjM0IDMuMzIgMCA0IEMwLjAyMzc5MDQgNi4zMTEwNzg3OCAwLjAyMzc5MDQgNi4zMTEwNzg3OCAwLjMxMjUgOC44NzUgQzAuMzkxMTMyODEgOS43Mzg2NzE4NyAwLjQ2OTc2NTYzIDEwLjYwMjM0Mzc1IDAuNTUwNzgxMjUgMTEuNDkyMTg3NSBDMS4wMDMyMDcyNCAxNC4wMTc5MDQ3NSAxLjgxMjYwODMzIDE1Ljc0ODIxMzQgMyAxOCBDMy42ODc1MDI5NCAyMy4yNzA4NTU4NiAyLjE2OTQxODg1IDI1Ljg0MDEzNzc1IC0xIDMwIEMtMS42NiAyOS42NyAtMi4zMiAyOS4zNCAtMyAyOSBDLTIuNTA1IDI3Ljk3OTA2MjUgLTIuNTA1IDI3Ljk3OTA2MjUgLTIgMjYuOTM3NSBDLTAuNTQwNjAwMTQgMjIuNjUwNTEyOSAtMC4yNjA1MDE3MyAxOC44MDI1MjcwNCAtMiAxNC41NjI1IEMtMy40NjUwNTgyOSAxMC44MDgyODgxMiAtMy4zMjAyMDE1OSA4LjAzNDU0MDAyIC0zIDQgQy0xLjUgMS41IC0xLjUgMS41IDAgMCBaICIgZmlsbD0iI0U1RUZFQiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM1MSw2MCkiLz4KPHBhdGggZD0iTTAgMCBDMC4zMyAwIDAuNjYgMCAxIDAgQzAuOTg4Mzk4NDQgMC43NTAyMzQzNyAwLjk3Njc5Njg3IDEuNTAwNDY4NzUgMC45NjQ4NDM3NSAyLjI3MzQzNzUgQzAuOTE5NjU0NTMgNy4zOTkxODY2NiAwLjk4NDI4NjYxIDEyLjMwMTE4MTk1IDEuNzUgMTcuMzc1IEMyLjE5NjY0NjM5IDIxLjE0NzM1MTI3IDIuMTA3NDI3NTkgMjEuODEwMjExMjYgMC4xMjUgMjUuMzEyNSBDLTAuOTI2ODc1IDI2LjY0MjgxMjUgLTAuOTI2ODc1IDI2LjY0MjgxMjUgLTIgMjggQy0yLjc4MjE1NTg4IDMwLjcyODI1MDQgLTIuNzgyMTU1ODggMzAuNzI4MjUwNCAtMyAzMyBDLTMuOTkgMzMgLTQuOTggMzMgLTYgMzMgQy01LjY2Mzk0OTIgMjkuMzg3NDUzODUgLTUuNDU0NzA0MzIgMjcuNDg1NTg5OSAtMi45Mjk2ODc1IDI0Ljc4OTA2MjUgQy0wLjM4MTE3MzczIDIxLjEwNTU4MzA5IC0wLjgyNDUyNDMzIDE4LjI5NzIzMDcyIC0xLjM3NSAxNC4wNjI1IEMtMS45OTMyNTI0NiA4Ljg4OTQ2NTc5IC0yLjA0NDM3NzU4IDQuOTExMTE3NTYgMCAwIFogIiBmaWxsPSIjMkE3RDVDIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzQ0LDYyKSIvPgo8cGF0aCBkPSJNMCAwIEMzLjE2MTE1Nzc2IDEuMzY5ODM1MDMgMy45OTI3MDkyIDEuOTg5MDYzOCA2IDUgQzYuNTMwNzQ3NDEgMTAuNTE5NzczMDggNS4zMDE0OTUxMSAxNC4wMjg3NzA1NSAzIDE5IEMyLjMwODU5NDc4IDIxLjc3ODg4NjEzIDIuMzA4NTk0NzggMjEuNzc4ODg2MTMgMiAyNCBDMS4wMSAyNCAwLjAyIDI0IC0xIDI0IEMtMS4yNTgxMzMwMiAyMC4zODYxMzc3NCAtMS4xNjgxNTY2NyAxOC4zMjkzMDY4IDAuNSAxNS4wNjI1IEMyLjczMzE5NzQyIDEwLjUwMzA1NTI2IDIuNjIzNDM0NjEgNi44MzEzMzkxNiAxIDIuMDYyNSBDMC42NyAxLjM4MTg3NSAwLjM0IDAuNzAxMjUgMCAwIFogIiBmaWxsPSIjMTc3MjREIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzUxLDk3KSIvPgo8cGF0aCBkPSJNMCAwIEMwLjMzIDAuOTkgMC42NiAxLjk4IDEgMyBDMC41MDUgMy45MDc1IDAuMDEgNC44MTUgLTAuNSA1Ljc1IEMtMi4zNzE1ODI0MSA5LjgwNTA5NTIzIC0yLjA1NTkwNDQyIDExLjcwMDk2MDU3IC0xIDE2IEMtMC4wODA4Mzc4IDE4LjM3NzMwOTU2IDAuOTUxMzM0NzMgMjAuNjc0Njk4NzUgMiAyMyBDMiAyMy42NiAyIDI0LjMyIDIgMjUgQzEuMDEgMjUgMC4wMiAyNSAtMSAyNSBDLTEuODcyNzk4NjIgMjMuMTMzNjAwMTkgLTIuNzIyNTEwMjcgMjEuMjU2MzkzODkgLTMuNTYyNSAxOS4zNzUgQy00LjI3NTk5NjA5IDE3LjgwODc4OTA2IC00LjI3NTk5NjA5IDE3LjgwODc4OTA2IC01LjAwMzkwNjI1IDE2LjIxMDkzNzUgQy02LjEzMjU2NzY4IDEyLjU3MjY2NDE5IC02LjAzOTIzNjQyIDEwLjYzNzMyNzQ1IC01IDcgQy0zLjU1NDMxMTQ1IDQuNDMwOTQwMzUgLTEuODIzMDY5ODYgMi4zMzcyNjkwNSAwIDAgWiAiIGZpbGw9IiMxMzZGNEEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNzcsOTQpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuNjYgMCAxLjMyIDAgMiAwIEM1LjE4NDE5OTU5IDMuNzk2NTQ1NjcgNS4zODczNDU0OCA3LjExNjc2MjIgNS4yMzgyODEyNSAxMS44NjMyODEyNSBDNC45NDYwNDkxMyAxNC40ODM3ODg5NyA0LjA0MjM4MTk1IDE2LjU4OTQ5MTczIDMgMTkgQzIuNzkzNDQ5MzQgMjIuNDQyNTEwOTcgMi45MDYxNjA2OSAyNC43MTg0ODIwOCA0IDI4IEMyLjA2MjUgMjcuNjI1IDIuMDYyNSAyNy42MjUgMCAyNyBDLTEuNDIxNTEzNDUgMjQuMTU2OTczMDkgLTEuMjM5MjI2MDYgMjIuMTY5NzQ1MjggLTEgMTkgQy0wLjUwNSAxNy44NjU2MjUgLTAuMDEgMTYuNzMxMjUgMC41IDE1LjU2MjUgQzIuNTQzNzYwMDggMTAuNzA4NTY5ODEgMi42OTcwMTA1NCA3LjA0NzQ2ODQ1IDEgMi4wNjI1IEMwLjY3IDEuMzgxODc1IDAuMzQgMC43MDEyNSAwIDAgWiAiIGZpbGw9IiNEREVBRTUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNjksNTkpIi8+CjxwYXRoIGQ9Ik0wIDAgQzIgMiAyIDIgMi4yNSA1LjMxMjUgQzIuMDE4NjM0NTIgOC43MjUxNDA4NCAxLjQ3NjUyODggMTAuOTU0NjU5MzUgMCAxNCBDLTAuNjYgMTMuMzQgLTEuMzIgMTIuNjggLTIgMTIgQy0xLjYyNSA4Ljg3NSAtMS42MjUgOC44NzUgLTEgNiBDLTMuMzEgNi4zMyAtNS42MiA2LjY2IC04IDcgQy04LjA0MjcyMSA1LjMzMzg4MDk1IC04LjA0MDYzODMyIDMuNjY2MTcxMTUgLTggMiBDLTUuOTU0NDc5NTggLTAuMDQ1NTIwNDIgLTIuNzI5NDE5MTQgMC4yMzk0MjI3MyAwIDAgWiAiIGZpbGw9IiMwQzZCNDUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNzAsNjIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzQuMjkgMCA4LjU4IDAgMTMgMCBDMTMgMS42NSAxMyAzLjMgMTMgNSBDOC43MSA1IDQuNDIgNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MjksNzkpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEuMzIgMCAyLjY0IDAgNCAwIEM0IDUuMjggNCAxMC41NiA0IDE2IEMyLjY4IDE2IDEuMzYgMTYgMCAxNiBDMCAxMC43MiAwIDUuNDQgMCAwIFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMTY5LDkzKSIvPgo8cGF0aCBkPSJNMCAwIEM0LjI5IDAgOC41OCAwIDEzIDAgQzEyLjY3IDAuOTkgMTIuMzQgMS45OCAxMiAzIEMxMC42OCAzIDkuMzYgMyA4IDMgQzggNS42NCA4IDguMjggOCAxMSBDNy4wMSAxMSA2LjAyIDExIDUgMTEgQzUgOC4zNiA1IDUuNzIgNSAzIEMzLjM1IDIuNjcgMS43IDIuMzQgMCAyIEMwIDEuMzQgMCAwLjY4IDAgMCBaICIgZmlsbD0iI0U4MjAyNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTc0OSwxMTYpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuOTYgMCA3LjkyIDAgMTIgMCBDMTIgMS42NSAxMiAzLjMgMTIgNSBDOC4wNCA1IDQuMDggNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1OTUsNzkpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuOTYgMCA3LjkyIDAgMTIgMCBDMTIgMS42NSAxMiAzLjMgMTIgNSBDOC4wNCA1IDQuMDggNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1MTgsNzkpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuOTYgMCA3LjkyIDAgMTIgMCBDMTIgMS42NSAxMiAzLjMgMTIgNSBDOC4wNCA1IDQuMDggNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRjcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1MTgsNzIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuOTkgMCAxLjk4IDAgMyAwIEMzIDIuNjQgMyA1LjI4IDMgOCBDNS42NCA4IDguMjggOCAxMSA4IEMxMC42NyA4Ljk5IDEwLjM0IDkuOTggMTAgMTEgQzYuNyAxMSAzLjQgMTEgMCAxMSBDMCA3LjM3IDAgMy43NCAwIDAgWiAiIGZpbGw9IiNFODIwMjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE3OTgsMTE2KSIvPgo8cGF0aCBkPSJNMCAwIEMwLjEyMTE3MTg4IDAuNjAzMjgxMjUgMC4yNDIzNDM3NSAxLjIwNjU2MjUgMC4zNjcxODc1IDEuODI4MTI1IEMwLjUzNDc2NTYzIDIuNjI3MzQzNzUgMC43MDIzNDM3NSAzLjQyNjU2MjUgMC44NzUgNC4yNSBDMS4wMzc0MjE4OCA1LjAzODkwNjI1IDEuMTk5ODQzNzUgNS44Mjc4MTI1IDEuMzY3MTg3NSA2LjY0MDYyNSBDMS45MTcxMzYxNyA5LjAxNDkwNDM4IDEuOTE3MTM2MTcgOS4wMTQ5MDQzOCAzLjA2MjUgMTEuMDkzNzUgQzQuMzcxMjUzNjQgMTMuNzU0ODgyNCA0LjEzMjY4NDUxIDE2LjA4MDk0MDc2IDQgMTkgQzMuMDEgMTkgMi4wMiAxOSAxIDE5IEMwLjcxMTI1IDE3Ljc4MzEyNSAwLjQyMjUgMTYuNTY2MjUgMC4xMjUgMTUuMzEyNSBDLTAuNDgzNjM3NyAxMi44NDMxNjk5MSAtMS4xMzkxMzY4MSAxMC42Njc2MTc2MyAtMi4xMjUgOC4zMTI1IEMtMy4xMDE2MzIyIDUuNzMxNDAwNjMgLTMuMTU2Mzg1NjggMy43MzY3NDk0NSAtMyAxIEMtMSAwIC0xIDAgMCAwIFogIiBmaWxsPSIjMEU2QzQ3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzY4LDEwMikiLz4KPHBhdGggZD0iTTAgMCBDNC45NSAwIDkuOSAwIDE1IDAgQzE0LjM0IDEuMzIgMTMuNjggMi42NCAxMyA0IEM5LjA0IDQgNS4wOCA0IDEgNCBDMC42NyAyLjY4IDAuMzQgMS4zNiAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MTEsODcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuNjI1NDM5MjIgMC41MTc5MTk4OSA3LjI1MDczNjc2IDEuMDM2Mzk3MjcgMTAuODc1IDEuNTYyNSBDMTIuOTMwODIyNzEgMS44NzcxMDUwMiAxMi45MzA4MjI3MSAxLjg3NzEwNTAyIDE1IDIgQzE1IDMuNjUgMTUgNS4zIDE1IDcgQzkuNTQ1MjA4MTUgNi40MzE3OTI1MiA1LjA4OTQwNzQ0IDUuMDUzNjIwNTUgMCAzIEMwIDIuMDEgMCAxLjAyIDAgMCBaICIgZmlsbD0iI0VFRjRGMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM5MSw3MykiLz4KPHBhdGggZD0iTTAgMCBDMy42MyAwIDcuMjYgMCAxMSAwIEMxMSAyLjMxIDExIDQuNjIgMTEgNyBDMTAuMzQgNyA5LjY4IDcgOSA3IEM5IDUuNjggOSA0LjM2IDkgMyBDNy4wMiAzIDUuMDQgMyAzIDMgQzIuNjcgNC4zMiAyLjM0IDUuNjQgMiA3IEMxLjM0IDcgMC42OCA3IDAgNyBDMCA0LjY5IDAgMi4zOCAwIDAgWiAiIGZpbGw9IiNFODIwMjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4MTMsMTIwKSIvPgo8cGF0aCBkPSJNMCAwIEM0LjI5IDAgOC41OCAwIDEzIDAgQzEzIDEuMzIgMTMgMi42NCAxMyA0IEM4LjcxIDQgNC40MiA0IDAgNCBDMCAyLjY4IDAgMS4zNiAwIDAgWiAiIGZpbGw9IiMxRjcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MjksODcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuOTYgMCA3LjkyIDAgMTIgMCBDMTIuMzMgMS4zMiAxMi42NiAyLjY0IDEzIDQgQzguNzEgNCA0LjQyIDQgMCA0IEMwIDIuNjggMCAxLjM2IDAgMCBaICIgZmlsbD0iIzFFNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU3Miw4NykiLz4KPHBhdGggZD0iTTAgMCBDMy40NDQ0NzI5OSAyLjkzNTIwOTUxIDMuNTc3ODc2MSA1LjI1NjU4Mjc0IDMuOTY0ODQzNzUgOS41OTc2NTYyNSBDMy45OTg0NTQwNiAxMS44OTQzNjEgMy43Mzc5MTUwOSAxMy44NzUxMjQzMyAzLjMxMjUgMTYuMTI1IEMyLjkwNDY5NjM3IDIxLjE4MTc2NSA0LjE4MDYwNDkgMjIuODk5MDYxNjcgNyAyNyBDNi4zNCAyNy4zMyA1LjY4IDI3LjY2IDUgMjggQy0wLjA2ODA5Mzg0IDIxLjI0ODM4NzEgLTAuMDY4MDkzODQgMjEuMjQ4Mzg3MSAwLjE4NzUgMTYuNTYyNSBDMC40NTU2MjUgMTUuMzg2ODc1IDAuNzIzNzUgMTQuMjExMjUgMSAxMyBDMS4wODIyOTE3IDExLjQzOTExMjI5IDEuMTIyNDQ1OTkgOS44NzU1NTMzNyAxLjEyNSA4LjMxMjUgQzEuMTI4ODY3MTkgNy4yMjM4ODY3MiAxLjEyODg2NzE5IDcuMjIzODg2NzIgMS4xMzI4MTI1IDYuMTEzMjgxMjUgQzAuOTk3ODA3MzIgMy45NjUxMTA1OSAwLjU4NzcyOTQgMi4wNjYzODE5NSAwIDAgWiAiIGZpbGw9IiNEMEUyREIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNzgsNjMpIi8+CjxwYXRoIGQ9Ik0wIDAgQzQuMjkgMCA4LjU4IDAgMTMgMCBDMTIuNjcgMS4zMiAxMi4zNCAyLjY0IDEyIDQgQzguMDQgNCA0LjA4IDQgMCA0IEMwIDIuNjggMCAxLjM2IDAgMCBaICIgZmlsbD0iIzFFNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU3Miw2NSkiLz4KPHBhdGggZD0iTTAgMCBDMCAwLjk5IDAgMS45OCAwIDMgQy0xLjU3OTY3ODA3IDMuNjc1MjgyMjMgLTMuMTYzOTE5MDMgNC4zMzk4OTY5NCAtNC43NSA1IEMtNi4wNzI1NzgxMyA1LjU1Njg3NSAtNi4wNzI1NzgxMyA1LjU1Njg3NSAtNy40MjE4NzUgNi4xMjUgQy0xMCA3IC0xMCA3IC0xNCA3IEMtMTQgNS42OCAtMTQgNC4zNiAtMTQgMyBDLTQuNTg5OTc3MjIgLTAuNDQ0MTkxMzQgLTQuNTg5OTc3MjIgLTAuNDQ0MTkxMzQgMCAwIFogIiBmaWxsPSIjRUZGNUYzIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzMxLDczKSIvPgo8cGF0aCBkPSJNMCAwIEMzLjk2IDAgNy45MiAwIDEyIDAgQzEyIDEuMzIgMTIgMi42NCAxMiA0IEM4LjA0IDQgNC4wOCA0IDAgNCBDMCAyLjY4IDAgMS4zNiAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1OTUsODcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuOTYgMCA3LjkyIDAgMTIgMCBDMTIgMS4zMiAxMiAyLjY0IDEyIDQgQzguMDQgNCA0LjA4IDQgMCA0IEMwIDIuNjggMCAxLjM2IDAgMCBaICIgZmlsbD0iIzFFNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU0OSw4NykiLz4KPHBhdGggZD0iTTAgMCBDMy45NiAwIDcuOTIgMCAxMiAwIEMxMiAxLjMyIDEyIDIuNjQgMTIgNCBDOC4wNCA0IDQuMDggNCAwIDQgQzAgMi42OCAwIDEuMzYgMCAwIFogIiBmaWxsPSIjMUU3MEMwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNTE4LDg3KSIvPgo8cGF0aCBkPSJNMCAwIEMzLjk2IDAgNy45MiAwIDEyIDAgQzEyIDEuMzIgMTIgMi42NCAxMiA0IEM4LjA0IDQgNC4wOCA0IDAgNCBDMCAyLjY4IDAgMS4zNiAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1NDksNjUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuOTYgMCA3LjkyIDAgMTIgMCBDMTIgMS4zMiAxMiAyLjY0IDEyIDQgQzguMDQgNCA0LjA4IDQgMCA0IEMwIDIuNjggMCAxLjM2IDAgMCBaICIgZmlsbD0iIzFFNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTUxOCw2NSkiLz4KPHBhdGggZD0iTTAgMCBDMy4zNzQ2MjcxNSAwLjU0NzIzNjgzIDUuMDgyMzUgMS4wNTQ5IDggMyBDNy4zNCA0Ljk4IDYuNjggNi45NiA2IDkgQzQgOCAyIDcgMCA2IEMwIDQuMDIgMCAyLjA0IDAgMCBaICIgZmlsbD0iIzFENzY1MiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM5Myw5MykiLz4KPHBhdGggZD0iTTAgMCBDMCAzIDAgMyAtMSA1IEMtMS4yMTM3NzcyMSAxMC42MDcwMzIxMyAtMS4yMTM3NzcyMSAxMC42MDcwMzIxMyAwIDE2IEMwLjEyNzgxNzg2IDE4LjY3Mzk0OTY0IDAuMDQzOTE4NzEgMjEuMzIwOTU4NTcgMCAyNCBDLTAuNjYgMjQgLTEuMzIgMjQgLTIgMjQgQy0zLjcyNzI5MzA0IDE3LjI5MDY3OTkxIC00Ljc4MjM1NDYyIDEwLjgxODQwMzYgLTMgNCBDLTEuNDQ5MjE4NzUgMS43MTA5Mzc1IC0xLjQ0OTIxODc1IDEuNzEwOTM3NSAwIDAgWiAiIGZpbGw9IiNEOUU4RTIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNDgsNjApIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuMzMgMCAwLjY2IDAgMSAwIEMxIDEuNjUgMSAzLjMgMSA1IEMxLjg4Njg3NSA0LjY5MDYyNSAyLjc3Mzc1IDQuMzgxMjUgMy42ODc1IDQuMDYyNSBDOS4xNjA2NzE0NiAyLjMwNjk1NDQ0IDkuMTYwNjcxNDYgMi4zMDY5NTQ0NCAxMiAyIEMxMi45OSAyLjY2IDEzLjk4IDMuMzIgMTUgNCBDMTQuNjcgNC42NiAxNC4zNCA1LjMyIDE0IDYgQzExLjY4MDI1NzY2IDYuNDE3NTUzNjIgOS4zNDIxNDIwNyA2LjczNTU2NDYgNyA3IEM1LjA1MDkzNzUgNy4yNzg0Mzc1IDUuMDUwOTM3NSA3LjI3ODQzNzUgMy4wNjI1IDcuNTYyNSBDMi4wNTE4NzUgNy43MDY4NzUgMS4wNDEyNSA3Ljg1MTI1IDAgOCBDMCA1LjM2IDAgMi43MiAwIDAgWiAiIGZpbGw9IiMxODcyNEUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzMTcsNjgpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuMzMzMzMzMzMgMCA2LjY2NjY2NjY3IDAgMTAgMCBDMTAgMS45OCAxMCAzLjk2IDEwIDYgQzcuMzYgNiA0LjcyIDYgMiA2IEMyIDQuNjggMiAzLjM2IDIgMiBDMS4zNCAyIDAuNjggMiAwIDIgQzAgMS4zNCAwIDAuNjggMCAwIFogIiBmaWxsPSIjMDA2NDNDIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzg1LDExNykiLz4KPHBhdGggZD0iTTAgMCBDMi45NyAwIDUuOTQgMCA5IDAgQzguNjcgMS42NSA4LjM0IDMuMyA4IDUgQzUuNjkgNSAzLjM4IDUgMSA1IEMwLjY3IDMuMzUgMC4zNCAxLjcgMCAwIFogIiBmaWxsPSIjMUU3MEMxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjE0LDk0KSIvPgo8cGF0aCBkPSJNMCAwIEMwIDAuOTkgMCAxLjk4IDAgMyBDLTMuNjMgNC4zMiAtNy4yNiA1LjY0IC0xMSA3IEMtMTEuMzMgNS42OCAtMTEuNjYgNC4zNiAtMTIgMyBDLTEwLjc1MzM2NjY5IDIuNDkxNjY0MDkgLTkuNTAyNTA2MTMgMS45OTM2ODg1NSAtOC4yNSAxLjUgQy03LjU1MzkwNjI1IDEuMjIxNTYyNSAtNi44NTc4MTI1IDAuOTQzMTI1IC02LjE0MDYyNSAwLjY1NjI1IEMtNCAwIC00IDAgMCAwIFogIiBmaWxsPSIjRUZGNUYyIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzI5LDgwKSIvPgo8cGF0aCBkPSJNMCAwIEMxLjA3MDc3Mzc1IDMuMjEyMzIxMjUgMSA1LjYzOTM3ODA3IDEgOSBDMS4zMyA5Ljk5IDEuNjYgMTAuOTggMiAxMiBDMS4wMSAxMiAwLjAyIDEyIC0xIDEyIEMtMS4zMyAxMC4zNSAtMS42NiA4LjcgLTIgNyBDLTMuOTggNyAtNS45NiA3IC04IDcgQy03LjIzNjg3NSA2LjQwMTg3NSAtNi40NzM3NSA1LjgwMzc1IC01LjY4NzUgNS4xODc1IEMtMy42NTE2NDI1IDMuNTMwNDA2NjggLTEuODAyMTcyMSAxLjg5NzAyMzI2IDAgMCBaICIgZmlsbD0iIzBENkI0NSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM2OCw3NSkiLz4KPHBhdGggZD0iTTAgMCBDMS4yMDE1NzEzMSAzLjYwNDcxMzkzIDEuNTQ5ODEzNDggNy4xMTUwMzA4OCAxLjg3NSAxMC44NzUgQzEuOTYwMDc4MTMgMTEuNTgyNjk1MzEgMi4wNDUxNTYyNSAxMi4yOTAzOTA2MyAyLjEzMjgxMjUgMTMuMDE5NTMxMjUgQzIuNDc2OTI2MjggMTcuMjE5MjgzNTEgMi4yMzk3Mzc5MiAxOC43MTA2NjExMyAtMC40OTIxODc1IDIyLjAwNzgxMjUgQy0xLjMxOTc2NTYyIDIyLjY2NTIzNDM3IC0yLjE0NzM0Mzc1IDIzLjMyMjY1NjI1IC0zIDI0IEMtMi4xMjUgMjAuMTI1IC0yLjEyNSAyMC4xMjUgLTEgMTkgQy0wLjkzOTY4OTYzIDE1LjM4NTE0NzQyIC0wLjk4MDA1NDkzIDExLjc4NDEzNTc2IC0xLjAzOTA2MjUgOC4xNjk5MjE4OCBDLTEuMTAwMTMzMTUgMi4yMDAyNjYyOSAtMS4xMDAxMzMxNSAyLjIwMDI2NjI5IDAgMCBaICIgZmlsbD0iI0RERUFFNSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM0Miw2NSkiLz4KPHBhdGggZD0iTTAgMCBDMSAyIDEgMiAwLjkzNzUgNS42ODc1IEMwLjg2OTQ3NzA3IDkuODIxNzgyMyAxLjY5NjU0Mzg5IDEzLjA4OTYzMTY4IDMgMTcgQzIuMzQgMTcgMS42OCAxNyAxIDE3IEMwLjY3IDE4LjMyIDAuMzQgMTkuNjQgMCAyMSBDLTEuMzk3NzM2NjEgMTQuOTA5ODYxOSAtMi40MzkxOTg3NCA5LjI1ODU4MjExIC0yIDMgQy0xLjM0IDIuMDEgLTAuNjggMS4wMiAwIDAgWiAiIGZpbGw9IiMyMTc4NTUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNDgsNjIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzQuMTk0Njk1NzEgMC41OTkyNDIyNCA4LjAwOTk5ODM0IDEuNTc0OTk5NDEgMTIgMyBDMTIgMy45OSAxMiA0Ljk4IDEyIDYgQzcuNjgyMjU0MiA1LjQ5MjAyOTkxIDMuOTY2OTc4ODYgNC44MDMxNzIyMSAwIDMgQzAgMi4wMSAwIDEuMDIgMCAwIFogIiBmaWxsPSIjRTdGMEVDIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzkzLDgwKSIvPgo8cGF0aCBkPSJNMCAwIEMxLjY3NTQyOTc2IDAuMjg2MDQ4OTggMy4zNDM4NTM0MyAwLjYxNzgxMjMzIDUgMSBDNS44NDY4MTEzMyA2LjA4MDg2Nzk2IDYuMDkwMzgwOTkgMTAuODQ4MjgzNzcgNiAxNiBDNS4zNCAxNiA0LjY4IDE2IDQgMTYgQzMuOTUxMDE1NjMgMTUuNDA4MzIwMzEgMy45MDIwMzEyNSAxNC44MTY2NDA2MyAzLjg1MTU2MjUgMTQuMjA3MDMxMjUgQzMuMjYxOTU4IDcuODg5NzQ5MDkgMy4yNjE5NTggNy44ODk3NDkwOSAxIDIgQzAuMzQgMS42NyAtMC4zMiAxLjM0IC0xIDEgQy0wLjY3IDAuNjcgLTAuMzQgMC4zNCAwIDAgWiAiIGZpbGw9IiMxNzcyNEUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNzAsNTcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuNjA4ODEzMSAwLjgzNTA2MTE3IDMuNjA4ODEzMSAwLjgzNTA2MTE3IDUuODEyNSAtMC41IEM1LjgxMjUgMS4xNSA1LjgxMjUgMi44IDUuODEyNSA0LjUgQzMuNDc5MTY2NjcgNC4xNjY2NjY2NyAxLjE0NTgzMzMzIDMuODMzMzMzMzMgLTEuMTg3NSAzLjUgQy0yLjQ2NjI1IDMuMzU1NjI1IC0zLjc0NSAzLjIxMTI1IC01LjA2MjUgMy4wNjI1IEMtNi4wOTM3NSAyLjg3Njg3NSAtNy4xMjUgMi42OTEyNSAtOC4xODc1IDIuNSBDLTguNTE3NSAxLjg0IC04Ljg0NzUgMS4xOCAtOS4xODc1IDAuNSBDLTUuOTIyMjU5MDcgLTAuNDE4MzQ5MDEgLTMuMzE1NTMyMDkgLTAuNDc3MDk4NDIgMCAwIFogIiBmaWxsPSIjMUI3NDUxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzk5LjE4NzUsNzEuNSkiLz4KPHBhdGggZD0iTTAgMCBDMi45NyAwIDUuOTQgMCA5IDAgQzguNjcgMS4zMiA4LjM0IDIuNjQgOCA0IEM1LjAzIDQgMi4wNiA0IC0xIDQgQy0wLjY3IDIuNjggLTAuMzQgMS4zNiAwIDAgWiAiIGZpbGw9IiNEQ0VERTIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIwNDAsOTIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuOTYgMCA3LjkyIDAgMTIgMCBDMTEuNjcgMC45OSAxMS4zNCAxLjk4IDExIDMgQzcuNyAzIDQuNCAzIDEgMyBDMC42NyAyLjAxIDAuMzQgMS4wMiAwIDAgWiAiIGZpbGw9IiNFNzIwMjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE3NjYsMTIwKSIvPgo8cGF0aCBkPSJNMCAwIEMzLjk2IDAgNy45MiAwIDEyIDAgQzExLjY3IDAuOTkgMTEuMzQgMS45OCAxMSAzIEM3LjcgMyA0LjQgMyAxIDMgQzAuNjcgMi4wMSAwLjM0IDEuMDIgMCAwIFogIiBmaWxsPSIjRTkyMDI2IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNzY2LDExNikiLz4KPHBhdGggZD0iTTAgMCBDOS40MTAwMjI3OCAtMC4zNjkwMjA1IDkuNDEwMDIyNzggLTAuMzY5MDIwNSAxNCAyIEMxNCAzLjY1IDE0IDUuMyAxNCA3IEMxMy41MDUgNi41MjU2MjUgMTMuMDEgNi4wNTEyNSAxMi41IDUuNTYyNSBDOS45MzI3MzUyOSAzLjk1Nzk1OTU1IDguODAwMzY5MDkgMy43NDk5ODYwOSA1Ljg3NSAzLjUgQzQuNTk2MjUgMy4zMzUgMy4zMTc1IDMuMTcgMiAzIEMxLjM0IDIuMDEgMC42OCAxLjAyIDAgMCBaICIgZmlsbD0iIzNEODk2QiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM1Niw1NSkiLz4KPHBhdGggZD0iTTAgMCBDMC4yODQ4ODI4MSAwLjU3NDkyMTg4IDAuNTY5NzY1NjIgMS4xNDk4NDM3NSAwLjg2MzI4MTI1IDEuNzQyMTg3NSBDMS41OTM5MzI5NyAzLjE5MzQ0NzYyIDIuMzQwMTUwNTEgNC42MzcwMzEgMy4xMDU0Njg3NSA2LjA3MDMxMjUgQzMuNDYyNTM5MDYgNi43NDgzNTkzOCAzLjgxOTYwOTM4IDcuNDI2NDA2MjUgNC4xODc1IDguMTI1IEM0LjU1MjMwNDY5IDguODA4MjAzMTMgNC45MTcxMDkzOCA5LjQ5MTQwNjI1IDUuMjkyOTY4NzUgMTAuMTk1MzEyNSBDNS41MjYyODkwNiAxMC43OTA4NTkzNyA1Ljc1OTYwOTM4IDExLjM4NjQwNjI1IDYgMTIgQzUuNjcgMTIuNjYgNS4zNCAxMy4zMiA1IDE0IEM0LjM0IDE0IDMuNjggMTQgMyAxNCBDLTEuMDc4Nzc0NjIgNS45NjQ5ODkwNiAtMS4wNzg3NzQ2MiA1Ljk2NDk4OTA2IC0wLjc1IDEuOTM3NSBDLTAuNTAyNSAxLjI5ODEyNSAtMC4yNTUgMC42NTg3NSAwIDAgWiAiIGZpbGw9IiMwQzZCNDUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNzgsMTAzKSIvPgo8cGF0aCBkPSJNMCAwIEMzLjk2IDAgNy45MiAwIDEyIDAgQzExLjAxIDEuNDg1IDExLjAxIDEuNDg1IDEwIDMgQzguMTI1IDMuMzI4MTI1IDguMTI1IDMuMzI4MTI1IDYgMy4yNSBDNS4yOTg3NSAzLjIzNDUzMTI1IDQuNTk3NSAzLjIxOTA2MjUgMy44NzUgMy4yMDMxMjUgQzIgMyAyIDMgMCAyIEMwIDEuMzQgMCAwLjY4IDAgMCBaICIgZmlsbD0iI0U4MjAyNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTc2NiwxMjQpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuNjMgMCA3LjI2IDAgMTEgMCBDMTAuNjcgMC45OSAxMC4zNCAxLjk4IDEwIDMgQzcuMDMgMyA0LjA2IDMgMSAzIEMwLjY3IDIuMDEgMC4zNCAxLjAyIDAgMCBaICIgZmlsbD0iI0U4MjAyNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTgxMywxMTYpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuNDk1IDAuMzkxODc1IDAuOTkgMC43ODM3NSAxLjUgMS4xODc1IEMwLjE2NjY2NjY3IDEuODU0MTY2NjcgLTEuMTY2NjY2NjcgMi41MjA4MzMzMyAtMi41IDMuMTg3NSBDLTMuNDkgMy43NDQzNzUgLTMuNDkgMy43NDQzNzUgLTQuNSA0LjMxMjUgQy02LjUgNS4xODc1IC02LjUgNS4xODc1IC0xMC41IDUuMTg3NSBDLTEwLjUgNC4xOTc1IC0xMC41IDMuMjA3NSAtMTAuNSAyLjE4NzUgQy0zLjI4Nzc0NjE3IC0xLjA2ODUxNzUxIC0zLjI4Nzc0NjE3IC0xLjA2ODUxNzUxIDAgMCBaICIgZmlsbD0iIzEyNkY0QSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTMyNy41LDc3LjgxMjUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzIuNjQgMCA1LjI4IDAgOCAwIEM3LjY3IDEuMzIgNy4zNCAyLjY0IDcgNCBDNC42OSA0IDIuMzggNCAwIDQgQzAgMi42OCAwIDEuMzYgMCAwIFogIiBmaWxsPSIjRDdFQkRFIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDA5LDk2KSIvPgo8cGF0aCBkPSJNMCAwIEMzLjU1NzgwMTk2IDAuNjA5OTA4OTEgNi42ODI4NTg5IDEuNTc4MzY4MSAxMCAzIEM5LjY3IDMuOTkgOS4zNCA0Ljk4IDkgNiBDNS44NTI2MjgxOCA1LjMwMDU4NDA0IDIuOTc0MTExMjQgNC4yMzkyMTMwMiAwIDMgQzAgMi4wMSAwIDEuMDIgMCAwIFogIiBmaWxsPSIjREZFQkU2IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzk0LDg3KSIvPgo8cGF0aCBkPSJNMCAwIEMtMSAzIC0xIDMgLTIuODQ3NjU2MjUgNC4xNjc5Njg3NSBDLTMuNTc4NTU0NjkgNC41MDQ0MTQwNiAtNC4zMDk0NTMxMiA0Ljg0MDg1OTM3IC01LjA2MjUgNS4xODc1IEMtNS43OTU5NzY1NiA1LjUzMTY3OTY5IC02LjUyOTQ1MzEyIDUuODc1ODU5MzggLTcuMjg1MTU2MjUgNi4yMzA0Njg3NSBDLTguMTM0MDAzOTEgNi42MTEzODY3MiAtOC4xMzQwMDM5MSA2LjYxMTM4NjcyIC05IDcgQy05LjMzIDUuNjggLTkuNjYgNC4zNiAtMTAgMyBDLTYuMjcwMzQ4NjEgMC45NjU2NDQ2OSAtNC4zMzA5NDk1OCAwIDAgMCBaICIgZmlsbD0iI0U4RjFFRCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTMyOCw4NykiLz4KPHBhdGggZD0iTTAgMCBDMi4zOTI3MzIzNSAzLjU4OTA5ODUzIDMuMTUzMTA5ODYgNS4yNjMxMzQ3OCAzLjE4NzUgOS41IEMzLjIwMTY3OTY5IDEwLjI5NDA2MjUgMy4yMTU4NTkzOCAxMS4wODgxMjUgMy4yMzA0Njg3NSAxMS45MDYyNSBDMyAxNCAzIDE0IDEgMTYgQy0wLjE1NzAzOTggMTIuNTI4ODgwNTkgLTAuMDMzOTY0ODkgOS43NzM2ODM0NiAwLjA2MjUgNi4xNTYyNSBDMC4wOTg0MjE3OSAzLjgxNDI1MTIzIDAuMDk4NDIxNzkgMy44MTQyNTEyMyAtMSAxIEMtMC42NyAwLjY3IC0wLjM0IDAuMzQgMCAwIFogIiBmaWxsPSIjMjI3OTU2IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzc3LDYyKSIvPgo8cGF0aCBkPSJNMCAwIEMwLjY2IDAuMzMgMS4zMiAwLjY2IDIgMSBDMS4zNCAzLjk3IDAuNjggNi45NCAwIDEwIEMtMC45OSA5LjY3IC0xLjk4IDkuMzQgLTMgOSBDLTIuNDQyNzEwODcgNS42NTYyNjUyNSAtMS42NDgyNjExMSAyLjk2Njg3MDAxIDAgMCBaICIgZmlsbD0iI0RDRUFFNCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM0NCwxMDgpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuMjcyODY2ODIgMi43ODE5MzY4IDQuOTY0Mjc2OTcgNi4yNzk1NDA2NyA3IDEwIEM2LjAxIDEwLjMzIDUuMDIgMTAuNjYgNCAxMSBDMy4zMjU5MTY5MiA5LjczMzA4NDkzIDIuNjYwOTk1MDMgOC40NjEyOTI1MSAyIDcuMTg3NSBDMS42Mjg3NSA2LjQ3OTgwNDY5IDEuMjU3NSA1Ljc3MjEwOTM3IDAuODc1IDUuMDQyOTY4NzUgQzAgMyAwIDMgMCAwIFogIiBmaWxsPSIjRDVFNURGIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzc5LDEwNCkiLz4KPHBhdGggZD0iTTAgMCBDMi42NCAwIDUuMjggMCA4IDAgQzcuMzQgMS4zMiA2LjY4IDIuNjQgNiA0IEMzLjAzIDMuNTA1IDMuMDMgMy41MDUgMCAzIEMwIDIuMDEgMCAxLjAyIDAgMCBaICIgZmlsbD0iI0ZDRkRGQyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjAzOCw5OSkiLz4KPHBhdGggZD0iTTAgMCBDMCAwLjk5IDAgMS45OCAwIDMgQy0zLjQ2NSA0LjQ4NSAtMy40NjUgNC40ODUgLTcgNiBDLTcuMzMgNS4wMSAtNy42NiA0LjAyIC04IDMgQy0zLjM3NSAwIC0zLjM3NSAwIDAgMCBaICIgZmlsbD0iI0Q2RTZERiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTMyOSw5MykiLz4KPHBhdGggZD0iTTAgMCBDLTAuNzUgNy43NSAtMC43NSA3Ljc1IC0zIDEwIEMtNC40NzgzMjI2IDcuMDQzMzU0ODEgLTQuMDYwMzI3ODMgNC4yNTc3MDI2MyAtNCAxIEMtMiAwIC0yIDAgMCAwIFogIiBmaWxsPSIjMkM3RTVEIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzcyLDY2KSIvPgo8cGF0aCBkPSJNMCAwIEMwLjkzMDQ1OTMzIDIuNTUxNDQ4MjQgMS4wODU2NDA5MSAzLjc0MDA2NDc4IDAuMjIyNjU2MjUgNi4zNTkzNzUgQy0wLjE2MDE5NTMxIDcuMTQ4MjgxMjUgLTAuNTQzMDQ2ODggNy45MzcxODc1IC0wLjkzNzUgOC43NSBDLTEuNTA3OTEwMTYgOS45NDg4MjgxMyAtMS41MDc5MTAxNiA5Ljk0ODgyODEzIC0yLjA4OTg0Mzc1IDExLjE3MTg3NSBDLTIuMzkwMTk1MzEgMTEuNzc1MTU2MjUgLTIuNjkwNTQ2ODggMTIuMzc4NDM3NSAtMyAxMyBDLTMuNjYgMTIuNjcgLTQuMzIgMTIuMzQgLTUgMTIgQy00LjQ2MjMxMTI4IDguMTI4NjQxMiAtMy40MjI1MjcgNi4wMjgxNTg3NSAtMSAzIEMtMC42NyAyLjAxIC0wLjM0IDEuMDIgMCAwIFogIiBmaWxsPSIjRENFOUU0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzQyLDEwMykiLz4KPHBhdGggZD0iTTAgMCBDMC45OSAwLjMzIDEuOTggMC42NiAzIDEgQzIuNTQ2MjUgMS43NDI1IDIuMDkyNSAyLjQ4NSAxLjYyNSAzLjI1IEMwLjMxMzU5MjA0IDUuNDY5MzA1NzggLTAuODgyODA4MDMgNy42Nzk2NzgyMiAtMiAxMCBDLTMuMDYzNTE2NzUgNi42MTYwODMwNyAtMy4yMTQ0Mjk4MiA1LjQxOTUzNjYgLTEuNTYyNSAyLjE4NzUgQy0xLjA0Njg3NSAxLjQ2NTYyNSAtMC41MzEyNSAwLjc0Mzc1IDAgMCBaICIgZmlsbD0iI0RCRTlFMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM3OCw5NikiLz4KPHBhdGggZD0iTTAgMCBDMCAwLjk5IDAgMS45OCAwIDMgQy0yLjUgNC42ODc1IC0yLjUgNC42ODc1IC01IDYgQy01LjY2IDUuMDEgLTYuMzIgNC4wMiAtNyAzIEMtMy4zNzUgMCAtMy4zNzUgMCAwIDAgWiAiIGZpbGw9IiMwRDZDNDYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzMjksOTYpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuNjYgMCAxLjMyIDAgMiAwIEMyIDAuNjYgMiAxLjMyIDIgMiBDMy4zMiAyIDQuNjQgMiA2IDIgQzYgMi42NiA2IDMuMzIgNiA0IEM0LjY4IDQgMy4zNiA0IDIgNCBDMS42NyA1LjMyIDEuMzQgNi42NCAxIDggQy0wLjM1NDM5NjY4IDUuMjkxMjA2NjUgLTAuMDY1MDE0NTEgMi45OTA2NjczMiAwIDAgWiAiIGZpbGw9IiMxOTczNEYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNTAsNjQpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEuMzIgMC42NiAyLjY0IDEuMzIgNCAyIEM0IDIuOTkgNCAzLjk4IDQgNSBDMSA1IDEgNSAtMC42ODc1IDMuNSBDLTEuMTIwNjI1IDMuMDA1IC0xLjU1Mzc1IDIuNTEgLTIgMiBDLTEuMzQgMS4zNCAtMC42OCAwLjY4IDAgMCBaICIgZmlsbD0iIzE1NzI0QyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM5MiwxMDEpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuOTkgMC4zMyAxLjk4IDAuNjYgMyAxIEMyLjM0IDMuOTcgMS42OCA2Ljk0IDEgMTAgQzAuMDEgOS4wMSAtMC45OCA4LjAyIC0yIDcgQy0xLjM0IDQuNjkgLTAuNjggMi4zOCAwIDAgWiAiIGZpbGw9IiMyOTdENUIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNzMsNzMpIi8+CjxwYXRoIGQ9Ik0wIDAgQzIgMC42NjY2NjY2NyA0IDEuMzMzMzMzMzMgNiAyIEM1LjY3IDIuNjYgNS4zNCAzLjMyIDUgNCBDMi4zNTEzOTU3MyA0LjU5MzU1NjE0IC0wLjI5MTk3MzIyIDQuNzQyMDkyNjkgLTMgNSBDLTIuNjI1IDMuMDYyNSAtMi42MjUgMy4wNjI1IC0yIDEgQy0xLjM0IDAuNjcgLTAuNjggMC4zNCAwIDAgWiAiIGZpbGw9IiMzMzgzNjMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzMjYsNzApIi8+CjxwYXRoIGQ9Ik0wIDAgQzIuMzEgMCA0LjYyIDAgNyAwIEM3IDEuMzIgNyAyLjY0IDcgNCBDNS42OCA0IDQuMzYgNCAzIDQgQzMgMy4zNCAzIDIuNjggMyAyIEMyLjAxIDIgMS4wMiAyIDAgMiBDMCAxLjM0IDAgMC42OCAwIDAgWiAiIGZpbGw9IiM2N0EyOEEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNTMsNjQpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuOTkgMCAxLjk4IDAgMyAwIEMyLjY4NzUgMS44NzUgMi42ODc1IDEuODc1IDIgNCBDMS4wMSA0LjY2IDAuMDIgNS4zMiAtMSA2IEMtMS42MjUgNC4xMjUgLTEuNjI1IDQuMTI1IC0yIDIgQy0xLjM0IDEuMzQgLTAuNjggMC42OCAwIDAgWiAiIGZpbGw9IiMxNDcwNEIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzMjgsMTAxKSIvPgo8cGF0aCBkPSJNMCAwIEM0Ljc1IDEuODc1IDQuNzUgMS44NzUgNyAzIEM2LjY3IDMuOTkgNi4zNCA0Ljk4IDYgNiBDMy45NjE2NjU3NiA0LjcyNjA0MTEgMS45NjE0Nzg3NCAzLjM4OTM4MDc3IDAgMiBDMCAxLjM0IDAgMC42OCAwIDAgWiAiIGZpbGw9IiNFOEYxRUUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzOTQsOTMpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEuOTggMCAzLjk2IDAgNiAwIEM2IDAuOTkgNiAxLjk4IDYgMyBDMy42OSAzIDEuMzggMyAtMSAzIEMtMC42NyAyLjAxIC0wLjM0IDEuMDIgMCAwIFogIiBmaWxsPSIjRjhGQkY5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDEyLDkwKSIvPgo8cGF0aCBkPSJNMCAwIEMwLjMzIDEuMzIgMC42NiAyLjY0IDEgNCBDMS42NiA0IDIuMzIgNCAzIDQgQzMuNjYgNS42NSA0LjMyIDcuMyA1IDkgQzMuMDYyNSA4LjYyNSAzLjA2MjUgOC42MjUgMSA4IEMtMC4zNTQzOTY2OCA1LjI5MTIwNjY1IC0wLjA2NTAxNDUxIDIuOTkwNjY3MzIgMCAwIFogIiBmaWxsPSIjRDRFNERFIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzY4LDc4KSIvPgo8cGF0aCBkPSJNMCAwIEMwLjk5IDAuMzMgMS45OCAwLjY2IDMgMSBDMi4zNCAzLjMxIDEuNjggNS42MiAxIDggQzAuMzQgOCAtMC4zMiA4IC0xIDggQy0xLjEyNSAyLjI1IC0xLjEyNSAyLjI1IDAgMCBaICIgZmlsbD0iI0VGRjVGMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM3MCw3NCkiLz4KPHBhdGggZD0iTTAgMCBDMi4wMDcyMDkyMyAwLjI4Njc0NDE4IDQuMDA4NTk0NCAwLjYxODY2NzAxIDYgMSBDNiAxLjY2IDYgMi4zMiA2IDMgQzQuMzUgMyAyLjcgMyAxIDMgQzEgMy45OSAxIDQuOTggMSA2IEMwLjM0IDYgLTAuMzIgNiAtMSA2IEMtMS4wNDI3MjEgNC4zMzM4ODA5NSAtMS4wNDA2MzgzMiAyLjY2NjE3MTE1IC0xIDEgQy0wLjY3IDAuNjcgLTAuMzQgMC4zNCAwIDAgWiAiIGZpbGw9IiM3MkE5OTMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNjMsNjMpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEuOTM3NSAwLjY4NzUgMS45Mzc1IDAuNjg3NSA0IDIgQzQuNzUgNC42MjUgNC43NSA0LjYyNSA1IDcgQzQuMzQgNyAzLjY4IDcgMyA3IEMwIDIuNjE1Mzg0NjIgMCAyLjYxNTM4NDYyIDAgMCBaICIgZmlsbD0iIzBDNkI0NSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM1MSw5NykiLz4KPHBhdGggZD0iTTAgMCBDMS4zMiAwIDIuNjQgMCA0IDAgQzQgMC45OSA0IDEuOTggNCAzIEMyLjAyIDMuNjYgMC4wNCA0LjMyIC0yIDUgQy0xLjM0IDMuMzUgLTAuNjggMS43IDAgMCBaICIgZmlsbD0iI0U2RjBFQyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTMyNSw4MCkiLz4KPHBhdGggZD0iTTAgMCBDMS4zMiAwIDIuNjQgMCA0IDAgQzMuNjcgMS4zMiAzLjM0IDIuNjQgMyA0IEMyLjAxIDQgMS4wMiA0IDAgNCBDMCAyLjY4IDAgMS4zNiAwIDAgWiAiIGZpbGw9IiMwMDg0MjgiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIxNjksODcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuOTkgMCAxLjk4IDAgMyAwIEMyLjM0IDEuMzIgMS42OCAyLjY0IDEgNCBDMC42NyAyLjY4IDAuMzQgMS4zNiAwIDAgWiAiIGZpbGw9IiMxRTcwQzEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MTcsMTAyKSIvPgo8L3N2Zz4K" style="
            width: 742.5px;
            position: relative;
            top: 107px;
            left: 32px;
            ">
            <a href=`+MS+` style="
        float: left;
        border-radius: 56px;
        background: #0D6EFD;
        padding-top: 8px;
        width: 280px;
        height: 38px;
        text-align: center;
        position: relative;
        top: 127px;
        left: 274px;
        font-size: 16px;
        color: white;
        text-decoration: none;
        letter-spacing: 0.02em;
    ">Claim your FREE account</a>
            <div style="
    font-size: 14px;
    position: relative;
    top: 180px;
    left: 19px;
    letter-spacing: 0.02em;
    font-weight: 500;
    line-height: 125%;
">have a Syncfusion<sup>\xAE</sup> account? <a href="https://www.syncfusion.com/account/login?ReturnUrl=/account/login" style="text-decoration: none;
color: #0D6EFD;
font-weight: 500;">Sign In</a></div>
        </div>
    </div>`;if(typeof document<"u"&&!g(document)){var e=Xe("div",{innerHTML:o});document.body.appendChild(e)}},t3=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Og=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},DS=0,bS,JE=0,SS=0,eA=!0,tA=!1,CS=!1;var Kt=function(o){t3(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.randomId=hj(),r.isStringTemplate=!1,r.needsID=!1,r.isReactHybrid=!1,r.isAngular=!1,r.isReact=!1,r.isVue=!1,g(r.enableRtl)&&r.setProperties({enableRtl:$j},!0),g(r.locale)&&r.setProperties({locale:tp},!0),r.moduleLoader=new Rj(r),r.localObserver=new Ju(r),tc.on("notifyExternalChange",r.detectFunction,r,r.randomId),typeof window<"u"&&typeof document<"u"&&!Jj()&&Kj.indexOf(r.getModuleName())!==-1&&(SS=SS+1,SS>5&&(eA=!1)),Ee(i)||r.appendTo(),r}return e.prototype.requiredModules=function(){return[]},e.prototype.destroy=function(){this.isDestroyed||(this.enablePersistence&&(this.setPersistData(),this.detachUnloadEvent()),this.localObserver.destroy(),!this.refreshing&&(K([this.element],["e-control"]),this.trigger("destroyed",{cancel:!1}),o.prototype.destroy.call(this),this.moduleLoader.clean(),tc.off("notifyExternalChange",this.detectFunction,this.randomId)))},e.prototype.refresh=function(){this.refreshing=!0,this.moduleLoader.clean(),this.destroy(),this.clearChanges(),this.localObserver=new Ju(this),this.preRender(),this.injectModules(),this.render(),this.refreshing=!1},e.prototype.accessMount=function(){this.mount&&!this.isReactHybrid&&this.mount()},e.prototype.getRootElement=function(){return this.isReactHybrid?this.actualElement:this.element},e.prototype.getLocalData=function(){var t=this.getModuleName()+this.element.id;return CS?window.localStorage.getItem(t+this.ej2StatePersistenceVersion):window.localStorage.getItem(t)},e.prototype.attachUnloadEvent=function(){this.handleUnload=this.handleUnload.bind(this),window.addEventListener("pagehide",this.handleUnload)},e.prototype.handleUnload=function(){this.setPersistData()},e.prototype.detachUnloadEvent=function(){window.removeEventListener("pagehide",this.handleUnload)},e.prototype.appendTo=function(t){if(!g(t)&&typeof t=="string"?this.element=X(t,document):g(t)||(this.element=t),!g(this.element)){var i="e-"+this.getModuleName().toLowerCase();Y([this.element],["e-control",i]),this.isProtectedOnChange=!1,this.needsID&&!this.element.id&&(this.element.id=this.getUniqueID(this.getModuleName())),this.enablePersistence&&(this.mergePersistData(),this.attachUnloadEvent());var r=V("ej2_instances",this.element);(!r||r.indexOf(this)===-1)&&o.prototype.addInstance.call(this),this.preRender(),this.injectModules();var n={schedule:"all",diagram:"all",PdfViewer:"all",grid:["logger"],richtexteditor:["link","table","image","audio","video","formatPainter","emojiPicker","pasteCleanup","htmlEditor","toolbar","importExport"],treegrid:["filter"],gantt:["tooltip"],chart:["Export","Zoom"],accumulationchart:["Export"],"query-builder":"all"},s=this.getModuleName();if(this.requiredModules&&(!n[""+s]||n[""+s]!=="all"))for(var a=this.requiredModules(),l=0,h=this.moduleLoader.getNonInjectedModules(a);l<h.length;l++){var u=h[l],c=u.name?u.name:u.member;if(!(n[""+s]&&n[""+s].indexOf(u.member)!==-1)){var d=s.charAt(0).toUpperCase()+s.slice(1);console.warn('[WARNING] :: Module "'+c+'" is not available in '+d+" component! You either misspelled the module name or forgot to load it.")}}!eA&&!tA&&(e3(),tA=!0),this.render(),this.mount?this.accessMount():this.trigger("created")}},e.prototype.renderComplete=function(t){if(qe()){var i="sfBlazor";window[""+i].renderComplete(this.element,t)}this.isRendered=!0},e.prototype.dataBind=function(){this.injectModules(),o.prototype.dataBind.call(this)},e.prototype.on=function(t,i,r){if(typeof t=="string")this.localObserver.on(t,i,r);else for(var n=0,s=t;n<s.length;n++){var a=s[n];this.localObserver.on(a.event,a.handler,a.context)}},e.prototype.off=function(t,i){if(typeof t=="string")this.localObserver.off(t,i);else for(var r=0,n=t;r<n.length;r++){var s=n[r];this.localObserver.off(s.event,s.handler)}},e.prototype.notify=function(t,i){this.isDestroyed!==!0&&this.localObserver.notify(t,i)},e.prototype.getInjectedModules=function(){return this.injectedModules},e.Inject=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.prototype.injectedModules||(this.prototype.injectedModules=[]);for(var r=0;r<t.length;r++)this.prototype.injectedModules.indexOf(t[parseInt(r.toString(),10)])===-1&&this.prototype.injectedModules.push(t[parseInt(r.toString(),10)])},e.prototype.createElement=function(t,i,r){return Xe(t,i)},e.prototype.triggerStateChange=function(t,i){this.isReactHybrid&&(this.setState(),this.currentContext={calls:t,args:i})},e.prototype.injectModules=function(){this.injectedModules&&this.injectedModules.length&&this.moduleLoader.inject(this.requiredModules(),this.injectedModules)},e.prototype.detectFunction=function(t){var i=Object.keys(t);i.length&&(this[i[0]]=t[i[0]])},e.prototype.mergePersistData=function(){var t;CS?t=window.localStorage.getItem(this.getModuleName()+this.element.id+this.ej2StatePersistenceVersion):t=window.localStorage.getItem(this.getModuleName()+this.element.id),g(t)||t===""||this.setProperties(JSON.parse(t),!0)},e.prototype.setPersistData=function(){this.isDestroyed||(CS?window.localStorage.setItem(this.getModuleName()+this.element.id+this.ej2StatePersistenceVersion,this.getPersistData()):window.localStorage.setItem(this.getModuleName()+this.element.id,this.getPersistData()))},e.prototype.renderReactTemplates=function(t){g(t)||t()},e.prototype.clearTemplate=function(t,i){},e.prototype.getUniqueID=function(t){return this.isHistoryChanged()&&(DS=0),bS=this.pageID(location.href),JE=history.length,t+"_"+bS+"_"+DS++},e.prototype.pageID=function(t){var i=0;if(t.length===0)return i;for(var r=0;r<t.length;r++){var n=t.charCodeAt(r);i=(i<<5)-i+n,i=i&i}return Math.abs(i)},e.prototype.isHistoryChanged=function(){return bS!==this.pageID(location.href)||JE!==history.length},e.prototype.addOnPersist=function(t){for(var i=this,r={},n=0,s=t;n<s.length;n++){var a=s[n],l=V(a,this);Ee(l)||Ge(a,this.getActualProperties(l),r)}return JSON.stringify(r,function(h,u){return i.getActualProperties(u)})},e.prototype.getActualProperties=function(t){return t instanceof Re?V("properties",t):t},e.prototype.ignoreOnPersist=function(t){return JSON.stringify(this.iterateJsonProperties(this.properties,t))},e.prototype.iterateJsonProperties=function(t,i){for(var r={},n=function(u){if(i.indexOf(u)===-1){var c=t[""+u];if(typeof c=="object"&&!(c instanceof Array)){var d=i.filter(function(p){var f=RegExp;return new f(u+".").test(p)}).map(function(p){return p.replace(u+".","")});r[""+u]=s.iterateJsonProperties(s.getActualProperties(c),d)}else r[""+u]=c}},s=this,a=0,l=Object.keys(t);a<l.length;a++){var h=l[a];n(h)}return r},Og([C(!1)],e.prototype,"enablePersistence",void 0),Og([C()],e.prototype,"enableRtl",void 0),Og([C()],e.prototype,"locale",void 0),e=Og([bt],e),e}($s);(function(){typeof window<"u"&&window.addEventListener("popstate",function(){DS=0})})();var IA=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Gi=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},i3={left:0,top:0,bottom:0,right:0},wS={isDragged:!1},r3=function(o){IA(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Gi([C(0)],e.prototype,"left",void 0),Gi([C(0)],e.prototype,"top",void 0),e}(Re),Dl=function(o){IA(e,o);function e(i,r){var n=o.call(this,r,i)||this;return n.dragLimit=t.getDefaultPosition(),n.borderWidth=t.getDefaultPosition(),n.padding=t.getDefaultPosition(),n.diffX=0,n.prevLeft=0,n.prevTop=0,n.dragProcessStarted=!1,n.eleTop=0,n.tapHoldTimer=0,n.externalInitialize=!1,n.diffY=0,n.parentScrollX=0,n.parentScrollY=0,n.droppables={},n.bind(),n}t=e,e.prototype.bind=function(){this.toggleEvents(),B.isIE&&Y([this.element],"e-block-touch"),this.droppables[this.scope]={}},e.getDefaultPosition=function(){return he({},i3)},e.prototype.toggleEvents=function(i){var r;Ee(this.handle)||(r=X(this.handle,this.element));var n=this.enableTapHold&&B.isDevice&&B.isTouch?this.mobileInitialize:this.initialize;i?E.remove(r||this.element,B.isSafari()?"touchstart":B.touchStartEvent,n):E.add(r||this.element,B.isSafari()?"touchstart":B.touchStartEvent,n,this)},e.prototype.mobileInitialize=function(i){var r=this,n=i.currentTarget;this.tapHoldTimer=setTimeout(function(){r.externalInitialize=!0,r.removeTapholdTimer(),r.initialize(i,n)},this.tapHoldThreshold),E.add(document,B.isSafari()?"touchmove":B.touchMoveEvent,this.removeTapholdTimer,this),E.add(document,B.isSafari()?"touchend":B.touchEndEvent,this.removeTapholdTimer,this)},e.prototype.removeTapholdTimer=function(){clearTimeout(this.tapHoldTimer),E.remove(document,B.isSafari()?"touchmove":B.touchMoveEvent,this.removeTapholdTimer),E.remove(document,B.isSafari()?"touchend":B.touchEndEvent,this.removeTapholdTimer)},e.prototype.getScrollableParent=function(i,r){var n={vertical:"scrollHeight",horizontal:"scrollWidth"},s={vertical:"clientHeight",horizontal:"clientWidth"};return g(i)?null:i[n[""+r]]>i[s[""+r]]?(r==="vertical"?i.scrollTop>0:i.scrollLeft>0)?(r==="vertical"?(this.parentScrollY=this.parentScrollY+(this.parentScrollY===0?i.scrollTop:i.scrollTop-this.parentScrollY),this.tempScrollHeight=i.scrollHeight):(this.parentScrollX=this.parentScrollX+(this.parentScrollX===0?i.scrollLeft:i.scrollLeft-this.parentScrollX),this.tempScrollWidth=i.scrollWidth),g(i)?i:this.getScrollableParent(i.parentNode,r)):this.getScrollableParent(i.parentNode,r):this.getScrollableParent(i.parentNode,r)},e.prototype.getScrollableValues=function(){this.parentScrollX=0,this.parentScrollY=0;var i=this.element.classList.contains("e-dialog")&&this.element.classList.contains("e-dlg-modal"),r=this.getScrollableParent(this.element.parentNode,"vertical"),n=this.getScrollableParent(this.element.parentNode,"horizontal")},e.prototype.initialize=function(i,r){if(this.currentStateTarget=i.target,!this.isDragStarted()){if(this.isDragStarted(!0),this.externalInitialize=!1,this.target=i.currentTarget||r,this.dragProcessStarted=!1,this.abort){var n=this.abort;typeof n=="string"&&(n=[n]);for(var s=0;s<n.length;s++)if(!g(j(i.target,n[parseInt(s.toString(),10)]))){this.isDragStarted()&&this.isDragStarted(!0);return}}this.preventDefault&&!Ee(i.changedTouches)&&i.type!=="touchstart"&&i.preventDefault(),this.element.setAttribute("aria-grabbed","true");var a=this.getCoordinates(i);if(this.initialPosition={x:a.pageX,y:a.pageY},!this.clone){var l=this.element.getBoundingClientRect();this.getScrollableValues(),i.clientX===i.pageX&&(this.parentScrollX=0),i.clientY===i.pageY&&(this.parentScrollY=0),this.relativeXPosition=a.pageX-(l.left+this.parentScrollX),this.relativeYPosition=a.pageY-(l.top+this.parentScrollY)}this.externalInitialize?this.intDragStart(i):(E.add(document,B.isSafari()?"touchmove":B.touchMoveEvent,this.intDragStart,this),E.add(document,B.isSafari()?"touchend":B.touchEndEvent,this.intDestroy,this)),this.toggleEvents(!0),i.type!=="touchstart"&&this.isPreventSelect&&document.body.classList.add("e-prevent-select"),this.externalInitialize=!1,E.trigger(document.documentElement,B.isSafari()?"touchstart":B.touchStartEvent,i)}},e.prototype.intDragStart=function(i){this.removeTapholdTimer();var r=!Ee(i.changedTouches);if(!(r&&i.changedTouches.length!==1)){var n=this.getCoordinates(i),s,a=getComputedStyle(this.element);this.margin={left:parseInt(a.marginLeft,10),top:parseInt(a.marginTop,10),right:parseInt(a.marginRight,10),bottom:parseInt(a.marginBottom,10)};var l=this.element;if(this.clone&&this.dragTarget){var h=j(i.target,this.dragTarget);g(h)||(l=h)}this.isReplaceDragEle&&(l=this.currentStateCheck(i.target,l)),this.offset=this.calculateParentPosition(l),this.position=this.getMousePosition(i,this.isDragScroll);var u=this.initialPosition.x-n.pageX,c=this.initialPosition.y-n.pageY,d=Math.sqrt(u*u+c*c);if(d>=this.distance||this.externalInitialize){var p=this.getHelperElement(i);if(!p||g(p))return;r&&i.preventDefault();var f=this.helperElement=p;if(this.parentClientRect=this.calculateParentPosition(f.offsetParent),this.dragStart){var v=this.getProperTargetElement(i),m={event:i,element:l,target:v,bindEvents:qe()?this.bindDragEvents.bind(this):null,dragElement:f};this.trigger("dragStart",m)}this.dragArea?this.setDragArea():(this.dragLimit={left:0,right:0,bottom:0,top:0},this.borderWidth={top:0,left:0}),s={left:this.position.left-this.parentClientRect.left,top:this.position.top-this.parentClientRect.top},this.clone&&!this.enableTailMode&&(this.diffX=this.position.left-this.offset.left,this.diffY=this.position.top-this.offset.top),this.getScrollableValues();var y=getComputedStyle(l),S=parseFloat(y.marginTop);this.clone&&S!==0&&(s.top+=S),this.eleTop=isNaN(parseFloat(y.top))?0:parseFloat(y.top)-this.offset.top,this.enableScrollHandler&&!this.clone&&(s.top-=this.parentScrollY,s.left-=this.parentScrollX);var b=this.getProcessedPositionValue({top:s.top-this.diffY+"px",left:s.left-this.diffX+"px"});this.dragArea&&typeof this.dragArea!="string"&&this.dragArea.classList.contains("e-kanban-content")&&this.dragArea.style.position==="relative"&&(s.top+=this.dragArea.scrollTop),this.dragElePosition={top:s.top,left:s.left},Ye(f,this.getDragPosition({position:"absolute",left:b.left,top:b.top})),E.remove(document,B.isSafari()?"touchmove":B.touchMoveEvent,this.intDragStart),E.remove(document,B.isSafari()?"touchend":B.touchEndEvent,this.intDestroy),qe()||this.bindDragEvents(f)}}},e.prototype.bindDragEvents=function(i){gr(i)?(E.add(document,B.isSafari()?"touchmove":B.touchMoveEvent,this.intDrag,this),E.add(document,B.isSafari()?"touchend":B.touchEndEvent,this.intDragStop,this),this.setGlobalDroppables(!1,this.element,i)):(this.toggleEvents(),document.body.classList.remove("e-prevent-select"))},e.prototype.elementInViewport=function(i){for(this.top=i.offsetTop,this.left=i.offsetLeft,this.width=i.offsetWidth,this.height=i.offsetHeight;i.offsetParent;)i=i.offsetParent,this.top+=i.offsetTop,this.left+=i.offsetLeft;return this.top>=window.pageYOffset&&this.left>=window.pageXOffset&&this.top+this.height<=window.pageYOffset+window.innerHeight&&this.left+this.width<=window.pageXOffset+window.innerWidth},e.prototype.getProcessedPositionValue=function(i){return this.queryPositionInfo?this.queryPositionInfo(i):i},e.prototype.calculateParentPosition=function(i){if(g(i))return{left:0,top:0};var r=i.getBoundingClientRect(),n=getComputedStyle(i);return{left:r.left+window.pageXOffset-parseInt(n.marginLeft,10),top:r.top+window.pageYOffset-parseInt(n.marginTop,10)}},e.prototype.intDrag=function(i){if(!(!Ee(i.changedTouches)&&i.changedTouches.length!==1)){this.clone&&i.changedTouches&&B.isDevice&&B.isTouch&&i.preventDefault();var r,n;this.position=this.getMousePosition(i,this.isDragScroll);var s=this.getDocumentWidthHeight("Height");s<this.position.top&&(this.position.top=s);var a=this.getDocumentWidthHeight("Width");if(a<this.position.left&&(this.position.left=a),this.drag){var l=this.getProperTargetElement(i);this.trigger("drag",{event:i,element:this.element,target:l})}var h=this.checkTargetElement(i);if(h.target&&h.instance){var u=!0;this.hoverObject&&(this.hoverObject.instance!==h.instance?this.triggerOutFunction(i,h):u=!1),u&&(h.instance.dragData[this.scope]=this.droppables[this.scope],h.instance.intOver(i,h.target),this.hoverObject=h)}else this.hoverObject&&this.triggerOutFunction(i,h);var c=this.droppables[this.scope].helper;this.parentClientRect=this.calculateParentPosition(this.helperElement.offsetParent);var d=this.parentClientRect.left,p=this.parentClientRect.top,f=this.getCoordinates(i),v=f.pageX,m=f.pageY,y=this.position.left-this.diffX,S=this.position.top-this.diffY,b=getComputedStyle(c);if(this.dragArea){if(this.enableAutoScroll&&this.setDragArea(),this.pageX!==v||this.skipDistanceCheck){var w=c.offsetWidth+(parseFloat(b.marginLeft)+parseFloat(b.marginRight));this.dragLimit.left>y&&y>0?r=this.dragLimit.left:this.dragLimit.right+window.pageXOffset<y+w&&y>0?r=y-(y-this.dragLimit.right)+window.pageXOffset-w:r=y<0?this.dragLimit.left:y}if(this.pageY!==m||this.skipDistanceCheck){var I=c.offsetHeight+(parseFloat(b.marginTop)+parseFloat(b.marginBottom));this.dragLimit.top>S&&S>0?n=this.dragLimit.top:this.dragLimit.bottom+window.pageYOffset<S+I&&S>0?n=S-(S-this.dragLimit.bottom)+window.pageYOffset-I:n=S<0?this.dragLimit.top:S}}else r=y,n=S;var x=p+this.borderWidth.top,M=d+this.borderWidth.left;this.dragProcessStarted&&(g(n)&&(n=this.prevTop),g(r)&&(r=this.prevLeft));var D,A;if(this.helperElement.classList.contains("e-treeview"))this.dragArea?(this.dragLimit.top=this.clone?this.dragLimit.top:0,D=n-x<0?this.dragLimit.top:n-this.borderWidth.top,A=r-M<0?this.dragLimit.left:r-this.borderWidth.left):(D=n-this.borderWidth.top,A=r-this.borderWidth.left);else if(this.dragArea){var L=this.helperElement.classList.contains("e-dialog");this.dragLimit.top=this.clone?this.dragLimit.top:0,D=n-x<0?this.dragLimit.top:n-x,A=r-M<0?L?r-(M-this.borderWidth.left):this.dragElePosition.left:r-M}else D=n-x,A=r-M;var T=parseFloat(getComputedStyle(this.element).marginTop);if(T>0&&(this.clone&&(D+=T,S<0&&(T+S>=0?D=T+S:D-=T),this.dragArea&&(D=this.dragLimit.bottom<D?this.dragLimit.bottom:D)),n-x<0))if(S+T+(c.offsetHeight-x)>=0){var k=this.dragLimit.top+S-x;k+T+x<0?D-=T+x:D=k}else D-=T+x;if(this.dragArea&&this.helperElement.classList.contains("e-treeview")){var I=c.offsetHeight+(parseFloat(b.marginTop)+parseFloat(b.marginBottom));D=D+I>this.dragLimit.bottom?this.dragLimit.bottom-I:D}this.enableScrollHandler&&!this.clone&&(D-=this.parentScrollY,A-=this.parentScrollX),this.dragArea&&typeof this.dragArea!="string"&&this.dragArea.classList.contains("e-kanban-content")&&this.dragArea.style.position==="relative"&&(D+=this.dragArea.scrollTop);var F=this.getProcessedPositionValue({top:D+"px",left:A+"px"});this.isPreventScroll&&(F=this.getProcessedPositionValue({top:this.position.top-this.parentClientRect.top-2+"px",left:this.position.left-this.parentClientRect.left-2+"px"})),Ye(c,this.getDragPosition(F)),!this.elementInViewport(c)&&this.enableAutoScroll&&!this.helperElement.classList.contains("e-treeview")&&this.helperElement.scrollIntoView();var R=document.querySelectorAll(":hover");if(this.enableAutoScroll&&this.helperElement.classList.contains("e-treeview")){R.length===0&&(R=this.getPathElements(i));var N=this.getScrollParent(R,!1);this.elementInViewport(this.helperElement)?this.getScrollPosition(N,D):this.elementInViewport(this.helperElement)||(R=[].slice.call(document.querySelectorAll(":hover")),R.length===0&&(R=this.getPathElements(i)),N=this.getScrollParent(R,!0),this.getScrollPosition(N,D))}this.dragProcessStarted=!0,this.prevLeft=r,this.prevTop=n,this.position.left=r,this.position.top=n,this.pageX=v,this.pageY=m}},e.prototype.getScrollParent=function(i,r){for(var n=r?i.reverse():i,s,a=n.length-1;a>=0;a--)if(s=window.getComputedStyle(n[parseInt(a.toString(),10)])["overflow-y"],(s==="auto"||s==="scroll")&&n[parseInt(a.toString(),10)].scrollHeight>n[parseInt(a.toString(),10)].clientHeight)return n[parseInt(a.toString(),10)];if(s=window.getComputedStyle(document.scrollingElement)["overflow-y"],s==="visible")return document.scrollingElement.style.overflow="auto",document.scrollingElement},e.prototype.getScrollPosition=function(i,r){if(i&&i===document.scrollingElement)i.clientHeight+document.scrollingElement.scrollTop-this.helperElement.clientHeight<r&&i.getBoundingClientRect().height+this.parentClientRect.top>r?i.scrollTop+=this.helperElement.clientHeight:i.scrollTop>r-this.helperElement.clientHeight&&(i.scrollTop-=this.helperElement.clientHeight);else if(i&&i!==document.scrollingElement){var n=document.scrollingElement.scrollTop,s=this.helperElement.clientHeight;i.clientHeight+i.getBoundingClientRect().top-s+n<r?i.scrollTop+=this.helperElement.clientHeight:i.getBoundingClientRect().top>r-s-n&&(i.scrollTop-=this.helperElement.clientHeight)}},e.prototype.getPathElements=function(i){var r=i.clientX>0?i.clientX:0,n=i.clientY>0?i.clientY:0;return document.elementsFromPoint(r,n)},e.prototype.triggerOutFunction=function(i,r){this.hoverObject.instance.intOut(i,r.target),this.hoverObject.instance.dragData[this.scope]=null,this.hoverObject=null},e.prototype.getDragPosition=function(i){var r=he({},i);return this.axis&&(this.axis==="x"?delete r.top:this.axis==="y"&&delete r.left),r},e.prototype.getDocumentWidthHeight=function(i){var r=document.body,n=document.documentElement,s=Math.max(r["scroll"+i],n["scroll"+i],r["offset"+i],n["offset"+i],n["client"+i]);return s},e.prototype.intDragStop=function(i){if(this.dragProcessStarted=!1,!(!Ee(i.changedTouches)&&i.changedTouches.length!==1)){var r=["touchend","pointerup","mouseup"];if(r.indexOf(i.type)!==-1){if(this.dragStop){var n=this.getProperTargetElement(i);this.trigger("dragStop",{event:i,element:this.element,target:n,helper:this.helperElement})}this.intDestroy(i)}else this.element.setAttribute("aria-grabbed","false");var s=this.checkTargetElement(i);s.target&&s.instance&&(s.instance.dragStopCalled=!0,s.instance.dragData[this.scope]=this.droppables[this.scope],s.instance.intDrop(i,s.target)),this.setGlobalDroppables(!0),document.body.classList.remove("e-prevent-select")}},e.prototype.intDestroy=function(i){this.dragProcessStarted=!1,this.toggleEvents(),document.body.classList.remove("e-prevent-select"),this.element.setAttribute("aria-grabbed","false"),E.remove(document,B.isSafari()?"touchmove":B.touchMoveEvent,this.intDragStart),E.remove(document,B.isSafari()?"touchend":B.touchEndEvent,this.intDragStop),E.remove(document,B.isSafari()?"touchend":B.touchEndEvent,this.intDestroy),E.remove(document,B.isSafari()?"touchmove":B.touchMoveEvent,this.intDrag),this.isDragStarted()&&this.isDragStarted(!0)},e.prototype.onPropertyChanged=function(i,r){},e.prototype.getModuleName=function(){return"draggable"},e.prototype.isDragStarted=function(i){return i&&(wS.isDragged=!wS.isDragged),wS.isDragged},e.prototype.setDragArea=function(){var i,r,n=0,s=0,a,l=typeof this.dragArea;if(l==="string"?a=X(this.dragArea):a=this.dragArea,a){var h=a.getBoundingClientRect();i=a.scrollWidth?a.scrollWidth:h.right-h.left,r=a.scrollHeight?this.dragArea&&!g(this.helperElement)&&this.helperElement.classList.contains("e-treeview")?a.clientHeight:a.scrollHeight:h.bottom-h.top;for(var u=["Top","Left","Bottom","Right"],c=getComputedStyle(a),d=0;d<u.length;d++){var p=u[parseInt(d.toString(),10)],f=c["border"+p+"Width"],v=c["padding"+p],m=p.toLowerCase();this.borderWidth[""+m]=isNaN(parseFloat(f))?0:parseFloat(f),this.padding[""+m]=isNaN(parseFloat(v))?0:parseFloat(v)}this.dragArea&&!g(this.helperElement)&&this.helperElement.classList.contains("e-treeview")?n=h.top+document.scrollingElement.scrollTop:n=h.top,s=h.left,this.dragLimit.left=s+this.borderWidth.left+this.padding.left,this.dragLimit.top=a.offsetTop+this.borderWidth.top+this.padding.top,this.dragLimit.right=s+i-(this.borderWidth.right+this.padding.right),this.dragLimit.bottom=n+r-(this.borderWidth.bottom+this.padding.bottom)}},e.prototype.getProperTargetElement=function(i){var r=this.getCoordinates(i),n,s=this.helperElement.style.pointerEvents||"",a=i.type.indexOf("pointer")!==-1&&B.info.name==="safari"&&parseInt(B.info.version,10)>12;return zg(i.target,this.helperElement)||i.type.indexOf("touch")!==-1||a?(this.helperElement.style.pointerEvents="none",n=document.elementFromPoint(r.clientX,r.clientY),this.helperElement.style.pointerEvents=s):n=i.target,n},e.prototype.currentStateCheck=function(i,r){var n;return!g(this.currentStateTarget)&&this.currentStateTarget!==i?n=this.currentStateTarget:n=g(r)?i:r,n},e.prototype.getMousePosition=function(i,r){var n=i.srcElement!==void 0?i.srcElement:i.target,s=this.getCoordinates(i),a,l,h=g(n.offsetParent);if(r?(a=this.clone?s.pageX:s.pageX+(h?0:n.offsetParent.scrollLeft)-this.relativeXPosition,l=this.clone?s.pageY:s.pageY+(h?0:n.offsetParent.scrollTop)-this.relativeYPosition):(a=this.clone?s.pageX:s.pageX+window.pageXOffset-this.relativeXPosition,l=this.clone?s.pageY:s.pageY+window.pageYOffset-this.relativeYPosition),document.scrollingElement&&!r&&!this.clone){var u=document.scrollingElement,c=u.scrollHeight>0&&u.scrollHeight>u.clientHeight&&u.scrollTop>0,d=u.scrollWidth>0&&u.scrollWidth>u.clientWidth&&u.scrollLeft>0;a=d?a-u.scrollLeft:a,l=c?l-u.scrollTop:l}return{left:a-(this.margin.left+this.cursorAt.left),top:l-(this.margin.top+this.cursorAt.top)}},e.prototype.getCoordinates=function(i){return i.type.indexOf("touch")>-1?i.changedTouches[0]:i},e.prototype.getHelperElement=function(i){var r;return this.clone?this.helper?r=this.helper({sender:i,element:this.target,currentTargetElement:this.currentStateTarget}):(r=Xe("div",{className:"e-drag-helper e-block-touch",innerHTML:"Draggable"}),document.body.appendChild(r)):r=this.element,r},e.prototype.setGlobalDroppables=function(i,r,n){this.droppables[this.scope]=i?null:{draggable:r,helper:n,draggedElement:this.element}},e.prototype.checkTargetElement=function(i){var r=this.getProperTargetElement(i),n=this.getDropInstance(r);if(!n&&r&&!g(r.parentNode)){var s=j(r.parentNode,".e-droppable")||r.parentElement;s&&(n=this.getDropInstance(s))}return{target:r,instance:n}},e.prototype.getDropInstance=function(i){var r="getModuleName",n,s=i&&i.ej2_instances;if(s)for(var a=0,l=s;a<l.length;a++){var h=l[a];if(h[""+r]()==="droppable"){n=h;break}}return n},e.prototype.destroy=function(){this.toggleEvents(!0),o.prototype.destroy.call(this)};var t;return Gi([be({},r3)],e.prototype,"cursorAt",void 0),Gi([C(!0)],e.prototype,"clone",void 0),Gi([C()],e.prototype,"dragArea",void 0),Gi([C()],e.prototype,"isDragScroll",void 0),Gi([C()],e.prototype,"isReplaceDragEle",void 0),Gi([C(!0)],e.prototype,"isPreventSelect",void 0),Gi([C(!1)],e.prototype,"isPreventScroll",void 0),Gi([q()],e.prototype,"drag",void 0),Gi([q()],e.prototype,"dragStart",void 0),Gi([q()],e.prototype,"dragStop",void 0),Gi([C(1)],e.prototype,"distance",void 0),Gi([C()],e.prototype,"handle",void 0),Gi([C()],e.prototype,"abort",void 0),Gi([C()],e.prototype,"helper",void 0),Gi([C("default")],e.prototype,"scope",void 0),Gi([C("")],e.prototype,"dragTarget",void 0),Gi([C()],e.prototype,"axis",void 0),Gi([C()],e.prototype,"queryPositionInfo",void 0),Gi([C(!1)],e.prototype,"enableTailMode",void 0),Gi([C(!1)],e.prototype,"skipDistanceCheck",void 0),Gi([C(!0)],e.prototype,"preventDefault",void 0),Gi([C(!1)],e.prototype,"enableAutoScroll",void 0),Gi([C(!1)],e.prototype,"enableTapHold",void 0),Gi([C(750)],e.prototype,"tapHoldThreshold",void 0),Gi([C(!1)],e.prototype,"enableScrollHandler",void 0),e=t=Gi([bt],e),e}($s),n3=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),$u=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},kS=function(o){n3(e,o);function e(t,i){var r=o.call(this,i,t)||this;return r.mouseOver=!1,r.dragData={},r.dragStopCalled=!1,r.bind(),r}return e.prototype.bind=function(){this.wireEvents()},e.prototype.wireEvents=function(){E.add(this.element,B.isSafari()?"touchend":B.touchEndEvent,this.intDrop,this)},e.prototype.onPropertyChanged=function(t,i){},e.prototype.getModuleName=function(){return"droppable"},e.prototype.intOver=function(t,i){if(!this.mouseOver){var r=this.dragData[this.scope];this.trigger("over",{event:t,target:i,dragData:r}),this.mouseOver=!0}},e.prototype.intOut=function(t,i){this.mouseOver&&(this.trigger("out",{evt:t,target:i}),this.mouseOver=!1)},e.prototype.intDrop=function(t,i){if(this.dragStopCalled)this.dragStopCalled=!1;else return;var r=!0,n=this.dragData[this.scope],s=n?n.helper&&gr(n.helper):!1,a;s&&(a=this.isDropArea(t,n.helper,i),this.accept&&(r=ic(n.helper,this.accept))),s&&this.drop&&a.canDrop&&r&&this.trigger("drop",{event:t,target:a.target,droppedElement:n.helper,dragData:n}),this.mouseOver=!1},e.prototype.isDropArea=function(t,i,r){var n={canDrop:!0,target:r||t.target},s=t.type==="touchend";if(s||n.target===i){i.style.display="none";var a=s?t.changedTouches[0]:t,l=document.elementFromPoint(a.clientX,a.clientY);n.canDrop=!1,n.canDrop=zg(l,this.element),n.canDrop&&(n.target=l),i.style.display=""}return n},e.prototype.destroy=function(){E.remove(this.element,B.isSafari()?"touchend":B.touchEndEvent,this.intDrop),o.prototype.destroy.call(this)},$u([C()],e.prototype,"accept",void 0),$u([C("default")],e.prototype,"scope",void 0),$u([q()],e.prototype,"drop",void 0),$u([q()],e.prototype,"over",void 0),$u([q()],e.prototype,"out",void 0),e=$u([bt],e),e}($s),s3=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Rg=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},a3={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,space:32,escape:27,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,insert:45,delete:46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,plus:187,comma:188,minus:189,dot:190,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,singlequote:222},$i=function(o){s3(e,o);function e(i,r){var n=o.call(this,r,i)||this;return n.keyPressHandler=function(s){for(var a=s.altKey,l=s.ctrlKey,h=s.shiftKey,u=s.which,c=Object.keys(n.keyConfigs),d=0,p=c;d<p.length;d++)for(var f=p[d],v=n.keyConfigs[""+f].split(","),m=0,y=v;m<y.length;m++){var S=y[m],b=t.getKeyConfigData(S.trim());a===b.altKey&&l===b.ctrlKey&&h===b.shiftKey&&u===b.keyCode&&(s.action=f,n.keyAction&&n.keyAction(s))}},n.bind(),n}t=e,e.prototype.destroy=function(){this.unwireEvents(),o.prototype.destroy.call(this)},e.prototype.onPropertyChanged=function(i,r){},e.prototype.bind=function(){this.wireEvents()},e.prototype.getModuleName=function(){return"keyboard"},e.prototype.wireEvents=function(){this.element.addEventListener(this.eventName,this.keyPressHandler)},e.prototype.unwireEvents=function(){this.element.removeEventListener(this.eventName,this.keyPressHandler)},e.getKeyConfigData=function(i){if(i in this.configCache)return this.configCache[""+i];var r=i.toLowerCase().split("+"),n={altKey:r.indexOf("alt")!==-1,ctrlKey:r.indexOf("ctrl")!==-1,shiftKey:r.indexOf("shift")!==-1,keyCode:null};return r[r.length-1].length>1&&Number(r[r.length-1])?n.keyCode=Number(r[r.length-1]):n.keyCode=t.getKeyCode(r[r.length-1]),t.configCache[""+i]=n,n},e.getKeyCode=function(i){return a3[""+i]||i.toUpperCase().charCodeAt(0)};var t;return e.configCache={},Rg([C({})],e.prototype,"keyConfigs",void 0),Rg([C("keyup")],e.prototype,"eventName",void 0),Rg([q()],e.prototype,"keyAction",void 0),e=t=Rg([bt],e),e}($s),Li=function(){function o(e,t,i){this.controlName=e,this.localeStrings=t,this.setLocale(i||tp)}return o.prototype.setLocale=function(e){var t=this.intGetControlConstant(o.locale,e);this.currentLocale=t||this.localeStrings},o.load=function(e){this.locale=he(this.locale,e,{},!0)},o.prototype.getConstant=function(e){return g(this.currentLocale[""+e])?this.localeStrings[""+e]||"":this.currentLocale[""+e]},o.prototype.intGetControlConstant=function(e,t){return e[""+t]?e[""+t][this.controlName]:null},o.locale={},o}(),MA=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Vo=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},o3=function(o){MA(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Vo([C(50)],e.prototype,"swipeThresholdDistance",void 0),e}(Re),l3=/(Up|Down)/,Fr=function(o){MA(e,o);function e(t,i){var r=o.call(this,i,t)||this;return r.touchAction=!0,r.tapCount=0,r.startEvent=function(n){if(r.touchAction===!0){var s=r.updateChangeTouches(n);n.changedTouches!==void 0&&(r.touchAction=!1),r.isTouchMoved=!1,r.movedDirection="",r.startPoint=r.lastMovedPoint={clientX:s.clientX,clientY:s.clientY},r.startEventData=s,r.hScrollLocked=r.vScrollLocked=!1,r.tStampStart=Date.now(),r.timeOutTapHold=setTimeout(function(){r.tapHoldEvent(n)},r.tapHoldThreshold),E.add(r.element,B.touchMoveEvent,r.moveEvent,r),E.add(r.element,B.touchEndEvent,r.endEvent,r),E.add(r.element,B.touchCancelEvent,r.cancelEvent,r)}},r.moveEvent=function(n){var s=r.updateChangeTouches(n);r.movedPoint=s,r.isTouchMoved=!(s.clientX===r.startPoint.clientX&&s.clientY===r.startPoint.clientY);var a={};if(r.isTouchMoved){clearTimeout(r.timeOutTapHold),r.calcScrollPoints(n);var l={startEvents:r.startEventData,originalEvent:n,startX:r.startPoint.clientX,startY:r.startPoint.clientY,distanceX:r.distanceX,distanceY:r.distanceY,scrollDirection:r.scrollDirection,velocity:r.getVelocity(s)};a=he(a,{},l),r.trigger("scroll",a),r.lastMovedPoint={clientX:s.clientX,clientY:s.clientY}}},r.cancelEvent=function(n){clearTimeout(r.timeOutTapHold),clearTimeout(r.timeOutTap),r.tapCount=0,r.swipeFn(n),E.remove(r.element,B.touchCancelEvent,r.cancelEvent)},r.endEvent=function(n){r.swipeFn(n),r.isTouchMoved||typeof r.tap=="function"&&(r.trigger("tap",{originalEvent:n,tapCount:++r.tapCount}),r.timeOutTap=setTimeout(function(){r.tapCount=0},r.tapThreshold)),r.modeclear()},r.swipeFn=function(n){clearTimeout(r.timeOutTapHold),clearTimeout(r.timeOutTap);var s=r.updateChangeTouches(n),a=s.clientX-r.startPoint.clientX,l=s.clientY-r.startPoint.clientY;a=Math.floor(a<0?-1*a:a),l=Math.floor(l<0?-1*l:a),r.isTouchMoved=a>1||l>1;var h=/Firefox/.test(B.userAgent);h&&s.clientX===0&&s.clientY===0&&n.type==="mouseup"&&(r.isTouchMoved=!1),r.endPoint=s,r.calcPoints(n);var u={originalEvent:n,startEvents:r.startEventData,startX:r.startPoint.clientX,startY:r.startPoint.clientY,distanceX:r.distanceX,distanceY:r.distanceY,swipeDirection:r.movedDirection,velocity:r.getVelocity(s)};if(r.isTouchMoved){var c=r.swipeSettings.swipeThresholdDistance,d=he(void 0,r.defaultArgs,u),p=!1,f=r.element,v=r.isScrollable(f),m=l3.test(r.movedDirection);(c<r.distanceX&&!m||c<r.distanceY&&m)&&(v?p=r.checkSwipe(f,m):p=!0),p&&r.trigger("swipe",d)}r.modeclear()},r.modeclear=function(){r.modeClear=setTimeout(function(){r.touchAction=!0},typeof r.tap!="function"?0:20),r.lastTapTime=new Date().getTime(),E.remove(r.element,B.touchMoveEvent,r.moveEvent),E.remove(r.element,B.touchEndEvent,r.endEvent),E.remove(r.element,B.touchCancelEvent,r.cancelEvent)},r.bind(),r}return e.prototype.onPropertyChanged=function(t,i){},e.prototype.bind=function(){this.wireEvents(),B.isIE&&this.element.classList.add("e-block-touch")},e.prototype.destroy=function(){this.unwireEvents(),o.prototype.destroy.call(this)},e.prototype.wireEvents=function(){E.add(this.element,B.touchStartEvent,this.startEvent,this)},e.prototype.unwireEvents=function(){E.remove(this.element,B.touchStartEvent,this.startEvent)},e.prototype.getModuleName=function(){return"touch"},e.prototype.isScrollable=function(t){var i=getComputedStyle(t),r=i.overflow+i.overflowX+i.overflowY;return!!/(auto|scroll)/.test(r)},e.prototype.tapHoldEvent=function(t){this.tapCount=0,this.touchAction=!0,E.remove(this.element,B.touchMoveEvent,this.moveEvent),E.remove(this.element,B.touchEndEvent,this.endEvent);var i={originalEvent:t};this.trigger("tapHold",i),E.remove(this.element,B.touchCancelEvent,this.cancelEvent)},e.prototype.calcPoints=function(t){var i=this.updateChangeTouches(t);this.defaultArgs={originalEvent:t},this.distanceX=Math.abs(Math.abs(i.clientX)-Math.abs(this.startPoint.clientX)),this.distanceY=Math.abs(Math.abs(i.clientY)-Math.abs(this.startPoint.clientY)),this.distanceX>this.distanceY?this.movedDirection=i.clientX>this.startPoint.clientX?"Right":"Left":this.movedDirection=i.clientY<this.startPoint.clientY?"Up":"Down"},e.prototype.calcScrollPoints=function(t){var i=this.updateChangeTouches(t);this.defaultArgs={originalEvent:t},this.distanceX=Math.abs(Math.abs(i.clientX)-Math.abs(this.lastMovedPoint.clientX)),this.distanceY=Math.abs(Math.abs(i.clientY)-Math.abs(this.lastMovedPoint.clientY)),(this.distanceX>this.distanceY||this.hScrollLocked===!0)&&this.vScrollLocked===!1?(this.scrollDirection=i.clientX>this.lastMovedPoint.clientX?"Right":"Left",this.hScrollLocked=!0):(this.scrollDirection=i.clientY<this.lastMovedPoint.clientY?"Up":"Down",this.vScrollLocked=!0)},e.prototype.getVelocity=function(t){var i=t.clientX,r=t.clientY,n=Date.now(),s=i-this.startPoint.clientX,a=r-this.startPoint.clientX,l=n-this.tStampStart;return Math.sqrt(s*s+a*a)/l},e.prototype.checkSwipe=function(t,i){var r=["scroll","offset"],n=i?["Height","Top"]:["Width","Left"];return t[r[0]+n[0]]<=t[r[1]+n[0]]?!0:t[r[0]+n[1]]===0||t[r[1]+n[0]]+t[r[0]+n[1]]>=t[r[0]+n[0]]},e.prototype.updateChangeTouches=function(t){var i=t.changedTouches&&t.changedTouches.length!==0?t.changedTouches[0]:t;return i},Vo([q()],e.prototype,"tap",void 0),Vo([q()],e.prototype,"tapHold",void 0),Vo([q()],e.prototype,"swipe",void 0),Vo([q()],e.prototype,"scroll",void 0),Vo([C(350)],e.prototype,"tapThreshold",void 0),Vo([C(750)],e.prototype,"tapHoldThreshold",void 0),Vo([be({},o3)],e.prototype,"swipeSettings",void 0),e=Vo([bt],e),e}($s),h3=new RegExp("\\n|\\r|\\s\\s+","g"),u3=new RegExp(/'|"/g),c3=new RegExp("if ?\\("),d3=new RegExp("else if ?\\("),iA=new RegExp("else"),p3=new RegExp("for ?\\("),rA=new RegExp("(/if|/for)"),f3=new RegExp("\\((.*)\\)",""),NS=new RegExp("^[0-9]+$","g"),g3=new RegExp(`[\\w"'.\\s+]+`,"g"),v3=new RegExp('"(.*?)"',"g"),m3=new RegExp(`[\\w"'@#$.\\s-+]+`,"g"),nA=new RegExp("\\${([^}]*)}","g"),y3=/^\..*/gm,ES=/\\/gi,b3=/\\\\/gi,S3=new RegExp(`[\\w"'@#$.\\s+]+`,"g"),C3=/\window\./gm;function w3(o,e,t){if(typeof o=="function")return o;var i="data",r=x3(o,i,e,t),n=`var valueRegEx = (/value=\\'([A-Za-z0-9 _]*)((.)([\\w)(!-;?-\u25A0\\s]+)['])/g);
        var hrefRegex = (/(?:href)([\\s='"./]+)([\\w-./?=&\\\\#"]+)((.)([\\w)(!-;/?-\u25A0\\s]+)['])/g);
        if(str.match(valueRegEx)){
            var check = str.match(valueRegEx);
            var str1 = str;
            for (var i=0; i < check.length; i++) {
                var check1 = str.match(valueRegEx)[i].split('value=')[1];
                var change = check1.match(/^'/) !== null ? check1.replace(/^'/, '"') : check1;
                change =change.match(/.$/)[0] === '\\'' ? change.replace(/.$/,'"') : change;
                str1 = str1.replace(check1, change);
            }
            str = str.replace(str, str1);
        }
        else if (str.match(/(?:href='')/) === null) {
            if(str.match(hrefRegex)) {
                var check = str.match(hrefRegex);
                var str1 = str;
                for (var i=0; i < check.length; i++) {
                    var check1 = str.match(hrefRegex)[i].split('href=')[1];
                    if (check1) {
                        var change = check1.match(/^'/) !== null ? check1.replace(/^'/, '"') : check1;
                        change =change.match(/.$/)[0] === '\\'' ? change.replace(/.$/,'"') : change;
                        str1 = str1.replace(check1, change);
                    }
                }
                str = str.replace(str, str1);
            }
        }
        `,s='var str="'+r+'";'+n+" return str;",a=new Function(i,s);return a.bind(e)}function x3(o,e,t,i){var r=0,n=[],s=o.match(/class="([^"]+|)\s{2}/g),a="";if(s&&s.forEach(function(c){a=c.replace(/\s\s+/g," "),o=o.replace(c,a)}),nA.test(o)){for(var l=!1,h="",u=0;u<o.length;u++)o[u+""]==="$"&&o[u+1]==="{"?l=!0:o[u+""]==="}"&&(l=!1),h+=o[u+""]==='"'&&!l?'\\"':o[u+""];o=h}else o=o.replace(/\\?"/g,'\\"');return o.replace(h3,"").replace(v3,"'$1'").replace(nA,function(c,d,p,f){var v=/@|#|\$/gm,m=d.match(f3);if(m){var y=m[1];if(d3.test(d))d='";} '+d.replace(m[1],y.replace(g3,function(A){return A=A.trim(),Ku(A,!u3.test(A)&&n.indexOf(A)===-1,e,n,i)}))+`{ 
 str = str + "`;else if(c3.test(d))d='"; '+d.replace(m[1],y.replace(m3,function(A){return aA(A,e,n,i)}))+`{ 
 str = str + "`;else if(p3.test(d)){var S=m[1].split(" of ");d='"; '+d.replace(m[1],function(A){return n.push(S[0]),n.push(S[0]+"Index"),r=r+1,"var i"+r+"=0; i"+r+" < "+Ku(S[1],!0,e,n,i)+".length; i"+r+"++"})+`{ 
 `+S[0]+"= "+Ku(S[1],!0,e,n,i)+"[i"+r+`]; 
 var `+S[0]+"Index=i"+r+`; 
 str = str + "`}else{var b=d.split("("),w=t&&Object.prototype.hasOwnProperty.call(t,b[0])?"this.":"global";w=/\./.test(b[0])?"":w;var I=m[1].split(",");m[1].length!==0&&!/data/.test(I[0])&&!/window./.test(I[0])&&(m[1]=w==="global"?e+"."+m[1]:m[1]);var x=/@|\$|#/gm,M=/\]\./gm;if(C3.test(d)&&M.test(d)||x.test(d)){var D=/@|\$|#|\]\./gm;D.test(d)&&(d='"+ '+(w==="global"?"":w)+d.replace(m[1],y.replace(S3,function(A){return aA(A,e,n,i)}))+'+ "')}else d='" + '+(w==="global"?"":w)+d.replace(y,Ku(m[1].replace(/,( |)data.|,/gi,","+e+".").replace(/,( |)data.window/gi,",window"),w!=="global",e,n,i))+'+"'}}else iA.test(d)?d='"; '+d.replace(iA,`} else { 
 str = str + "`):d.match(rA)?d=d.replace(rA,`"; 
 } 
 str = str + "`):v.test(d)?(d.match(ES)&&(d=sA(d)),d='"+'+AS(d,n.indexOf(d)===-1,e,n)+'"]+"'):d.match(ES)?(d=sA(d),d='"+'+AS(d,n.indexOf(d)===-1,e,n)+'"]+"'):d=d!==""?'"+'+Ku(d.replace(/,/gi,"+"+e+"."),n.indexOf(d)===-1,e,n,i)+'+"':"${}";return d})}function Ku(o,e,t,i,r){return e&&!NS.test(o)&&i.indexOf(o.split(".")[0])===-1&&!r&&o!=="true"&&o!=="false"?t+"."+o:o}function I3(o,e,t,i){var r=/^\..*/gm;return e&&!NS.test(o)&&i.indexOf(o.split(".")[0])===-1&&!r.test(o)?t+"."+o:o}function AS(o,e,t,i){return e&&!NS.test(o)&&i.indexOf(o.split(".")[0])===-1?t+'["'+o:o}function sA(o){var e="\\\\";return o.match(b3)?o:o.replace(ES,e)}function aA(o,e,t,i){o=o.trim();var r=/\window\./gm;if(r.test(o))return o;var n=/'|"/gm,s=/@|\$|#/gm;return s.test(o)&&(o=AS(o,t.indexOf(o)===-1,e,t)+'"]'),y3.test(o)?I3(o,!n.test(o)&&t.indexOf(o)===-1,e,t):Ku(o,!n.test(o)&&t.indexOf(o)===-1,e,t,i)}var M3=/^[\n\r.]+<tr|^<tr/,D3=/^[\n\r.]+<svg|^<path|^<g/,_o={};function FS(){return"-"+Math.random().toString(36).substr(2,5)}function wt(o,e,t){var i=OS.compile(o,e,t);return function(r,n,s,a,l,h,u,c){var d=i(r,n,s,u,c),p="BlazorTemplateId";if(qe()&&!l){var f=FS(),v=a+f;if(_o[""+a]||(_o[""+a]=[]),g(h))r[""+p]=v,_o[""+a].push(r);else for(var m=Object.keys(_o[""+a][parseInt(h.toString(),10)]),y=0,S=m;y<S.length;y++){var b=S[y];b!==p&&r[""+b]&&(_o[""+a][parseInt(h.toString(),10)][""+b]=r[""+b]),b===p&&(v=_o[""+a][parseInt(h.toString(),10)][""+b])}return s==="rowTemplate"?[Xe("tr",{id:v,className:"e-blazor-template"})]:[Xe("div",{id:v,className:"e-blazor-template"})]}if(typeof d=="string")if(D3.test(d)){var w=Xe("svg",{innerHTML:d});return w.childNodes}else{var w=Xe(M3.test(d)?"table":"div",{innerHTML:d});return w.childNodes}else return d}}function rc(o,e,t,i,r){if(qe()){var n="sfBlazor";window[""+n].updateTemplate(e,_o[""+o],o,t,r),i!==!1&&(_o[""+o]=[])}}function El(o,e,t){var i=document.getElementById(o);if(i)for(var r=i.getElementsByClassName("blazor-inner-template"),n=0;n<r.length;n++){var s=" ";g(t)?s=r[parseInt(n.toString(),10)].getAttribute("data-templateId"):s=r[parseInt(t.toString(),10)].getAttribute("data-templateId");var a=document.getElementById(s);if(a)for(var l=a.childNodes.length,h=0;h<l;h++)g(t)?r[parseInt(n.toString(),10)].appendChild(a.childNodes[0]):(r[parseInt(t.toString(),10)].appendChild(a.childNodes[0]),n=r.length)}}function DA(o){OS.compile=o.compile}function EA(){return OS.compile}function Ks(o,e){var t;return o.prototype.CSPTemplate=!0,g(e)?t=o:(t=o.bind(e),t.prototype=Object.create(o.prototype)),t}var E3=function(){function o(){}return o.prototype.compile=function(e,t,i){return t===void 0&&(t={}),w3(e,t)},o}(),OS={compile:new E3().compile},A3=["script","style","iframe[src]",'link[href*="javascript:"]','object[type="text/x-scriptlet"]','object[data^="data:text/html;base64"]','img[src^="data:text/html;base64"]','[src^="javascript:"]','[dynsrc^="javascript:"]','[lowsrc^="javascript:"]','[type^="application/x-shockwave-flash"]'],T3=[{attribute:"href",selector:'[href*="javascript:"]'},{attribute:"href",selector:"a[href]"},{attribute:"background",selector:'[background^="javascript:"]'},{attribute:"style",selector:'[style*="javascript:"]'},{attribute:"style",selector:'[style*="expression("]'},{attribute:"href",selector:'a[href^="data:text/html;base64"]'}],oA=["onchange","onclick","onmouseover","onmouseout","onkeydown","onload","onerror","onblur","onfocus","onbeforeload","onbeforeunload","onkeyup","onsubmit","onafterprint","onbeforeonload","onbeforeprint","oncanplay","oncanplaythrough","oncontextmenu","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onformchange","onforminput","onhaschange","oninput","oninvalid","onkeypress","onloadeddata","onloadedmetadata","onloadstart","onmessage","onmousedown","onmousemove","onmouseup","onmousewheel","onoffline","onoine","ononline","onpagehide","onpageshow","onpause","onplay","onplaying","onpopstate","onprogress","onratechange","onreadystatechange","onredo","onresize","onscroll","onseeked","onseeking","onselect","onstalled","onstorage","onsuspend","ontimeupdate","onundo","onunload","onvolumechange","onwaiting","onmouseenter","onmouseleave","onstart","onpropertychange","oncopy","ontoggle","onpointerout","onpointermove","onpointerleave","onpointerenter","onpointerrawupdate","onpointerover","onbeforecopy","onbeforecut","onbeforeinput"],Bt=function(){function o(){}return o.beforeSanitize=function(){return{selectors:{tags:A3,attributes:T3}}},o.sanitize=function(e){if(g(e))return e;var t=this.beforeSanitize(),i=this.serializeValue(t,e);return i},o.serializeValue=function(e,t){this.removeAttrs=e.selectors.attributes,this.removeTags=e.selectors.tags,this.wrapElement=document.createElement("div"),this.wrapElement.innerHTML=t,this.removeXssTags(),this.removeJsEvents(),this.removeXssAttrs();var i=this.wrapElement.innerHTML;return this.removeElement(),this.wrapElement=null,i.replace(/&amp;/g,"&")},o.removeElement=function(){for(var e=this.wrapElement.children,t=0;t<e.length;t++)for(var i=e[parseInt(t.toString(),10)].attributes,r=0;r<i.length;r++)this.wrapElement.children[parseInt(t.toString(),10)].removeAttribute(i[parseInt(r.toString(),10)].localName)},o.removeXssTags=function(){var e=this.wrapElement.querySelectorAll(this.removeTags.join(","));if(e.length>0)e.forEach(function(t){ee(t)});else return},o.removeJsEvents=function(){var e=this.wrapElement.querySelectorAll("["+oA.join("],[")+"]");if(e.length>0)e.forEach(function(t){oA.forEach(function(i){t.hasAttribute(i)&&t.removeAttribute(i)})});else return},o.removeXssAttrs=function(){var e=this;this.removeAttrs.forEach(function(t,i){var r=e.wrapElement.querySelectorAll(t.selector);r.length>0&&(t.selector==="a[href]"?r.forEach(function(n){n.getAttribute(t.attribute).replace(/\t|\s|&/,"").indexOf("javascript:alert")!==-1&&n.removeAttribute(t.attribute)}):r.forEach(function(n){n.removeAttribute(t.attribute)}))})},o}();function L3(o,e){e.forEach(function(t){Object.getOwnPropertyNames(t.prototype).forEach(function(i){(!Object.prototype.hasOwnProperty.call(o.prototype,i)||t.isFormBase&&i!=="constructor")&&(o.prototype["".concat(i)]=t.prototype["".concat(i)])})})}function AA(o){return function(e){L3(e,o)}}function _g(o,e,t){var i={};if(o&&o.length){for(var r=0,n=o;r<n.length;r++){var s=n[r];t===!0?(e.propCollection["".concat(s)]=new Da(!1),e["".concat(s)]=e.propCollection["".concat(s)]):i["".concat(s)]=new Da(!1)}t!==!0&&e.setProperties(i,!0)}}function Ug(o,e,t){var i,r=Object.keys(o.registeredTemplate);if(r.length)for(var n=e&&e.filter(function(I){return!/\./g.test(I)}),s=/tab|accordion|toolbar/.test((i=o.getModuleName)===null||i===void 0?void 0:i.call(o)),a=0,l=n&&n||r;a<l.length;a++){var h=l[a];if(t&&t.length)for(var u=0;u<t.length;u++)if(s)for(var c=0;c<o.registeredTemplate["".concat(h)].length;c++){var d=o.registeredTemplate["".concat(h)][parseInt(c.toString(),10)];d&&d===t["".concat(u)]&&(d.destroy(),o.registeredTemplate["".concat(h)].splice(c,1))}else for(var c=0;c<o.registeredTemplate.template.length;c++){var d=o.registeredTemplate.template[parseInt(c.toString(),10)].rootNodes[0];if(d===t["".concat(u)]){var p=o.registeredTemplate["".concat(h)];p[parseInt(c.toString(),10)].destroy()}}else if(o.registeredTemplate["".concat(h)])for(var f=0,v=o.registeredTemplate["".concat(h)];f<v.length;f++){var p=v[f];if(!p.destroyed){if(p._view){var m=p._view.renderer.parentNode(p.rootNodes[0]);if(!g(m))for(var c=0;c<p.rootNodes.length;c++)m.appendChild(p.rootNodes[parseInt(c.toString(),10)])}p.destroy()}}(!s||!t)&&delete o.registeredTemplate["".concat(h)]}for(var y=function(I){I.instance&&I.instance.clearTemplate(e&&e.filter(function(x){var M=RegExp;return!!new M(I.name).test(x)}))},S=0,b=o.tagObjects;S<b.length;S++){var w=b[S];y(w)}}function Na(o,e,t){for(var i=o.replace(/\[/g,".").replace(/\]/g,"").split("."),r=t||{},n=0;n<i.length;n++){var s=i[parseInt(n.toString(),10)];n+1===i.length?r["".concat(s)]=e===void 0?{}:e:r["".concat(s)]===void 0&&(r["".concat(s)]={}),r=r["".concat(s)]}return r}var k3=/Ref$/,oo=function(){function o(){this.hasChanges=!1,this.propCollection={},this.dataSource={},this.tags=[],this.tagObjects=[]}return o.prototype.ngOnInit=function(){this.registeredTemplate={};for(var e=0,t=this.tags;e<t.length;e++){var i=t[e],r=V("child"+i.substring(0,1).toUpperCase()+i.substring(1),this);r&&this.tagObjects.push({instance:r,name:i})}for(var n=Object.keys(this),s=0;s<n.length;s++){var a=V(n[parseInt(s.toString(),10)],this);typeof a=="object"&&a&&a.elementRef&&(V(n[parseInt(s.toString(),10)].indexOf("Ref")!==-1?n[parseInt(s.toString(),10)]:n[parseInt(s.toString(),10)]+"Ref",this)||Ge(n[parseInt(s.toString(),10)].indexOf("Ref")!==-1?n[parseInt(s.toString(),10)]:n[parseInt(s.toString(),10)]+"Ref",a,this),V("viewContainerRef",this)&&!V("_viewContainerRef",a.elementRef.nativeElement)&&!V("propName",a.elementRef.nativeElement)&&(Ge("_viewContainerRef",V("viewContainerRef",this),a.elementRef.nativeElement),Ge("propName",n[parseInt(s.toString(),10)].replace("Ref",""),a.elementRef.nativeElement)))}n=Object.keys(this),n=n.filter(function(v){return/Ref$/i.test(v)});for(var l=0,h=n;l<h.length;l++){var u=h[l],c=u.replace("Ref","");Ge(c.replace("_","."),V(c,this),this.propCollection)}var d=Object.keys(this);if(this.directivePropList){for(var p=0;p<this.directivePropList.length;p++){var f=this.directivePropList[parseInt(p.toString(),10)];d.indexOf(f)!==-1&&(V(f,this)===!1||V(f,this))&&Ge(f,V(f,this),this.propCollection)}this.hasChanges=!0}this.isInitChanges=!0},o.prototype.registerEvents=function(e){_g(e,this,!0)},o.prototype.ngOnChanges=function(e){for(var t=0,i=Object.keys(e);t<i.length;t++){var r=i[t],n=e["".concat(r)];this.propCollection["".concat(r)]=n.currentValue}this.isUpdated=!1,this.hasChanges=!0},o.prototype.clearTemplate=function(e){Ug(this,e)},o.prototype.getProperties=function(){for(var e=0,t=this.tagObjects;e<t.length;e++){var i=t[e];this.propCollection[i.name]=i.instance.getProperties()}return this.propCollection},o.prototype.isChanged=function(){var e=this.hasChanges;if(!g(this.propCollection[this.property])){for(var t=this.propCollection[this.property],i=Object.keys(t[0]),r=0;r<i.length;r++)if(!g(this.propCollection[i[parseInt(r.toString(),10)]])){var n=V(i[parseInt(r.toString(),10)],this),s=this.propCollection[this.property][0][i[parseInt(r.toString(),10)]];!g(n)&&this.propCollection[i[parseInt(r.toString(),10)]]!==n&&s!==n&&(Ge(i[parseInt(r.toString(),10)],n,this.propCollection[this.property][0]),Ge(i[parseInt(r.toString(),10)],n,this.propCollection),this.hasChanges=!0,this.isUpdated=!1)}}for(var a=0,l=this.tagObjects;a<l.length;a++){var h=l[a];e=e||h.instance.hasChanges}return e||this.hasChanges},o.prototype.ngAfterContentChecked=function(){if(this.hasChanges=this.isChanged(),this.isInitChanges||this.hasChanges){var e=Object.keys(this);e=e.filter(function(s){return k3.test(s)});for(var t=0,i=e;t<i.length;t++){var r=i[t],n=r.replace("Ref","");Ge(n.replace("_","."),V(n,this),this.propCollection)}}},o.prototype.ngAfterViewChecked=function(){this.isUpdated&&(this.hasChanges=!1)},o.prototype.ngAfterViewInit=function(){this.isInitChanges=!1},o.prototype.ngOnDestroy=function(){this.directivePropList=[]},o}();var lo=function(){function o(e){this.list=[],this.hasChanges=!1,this.propertyName=e}return o.prototype.ngOnInit=function(){this.isInitChanges=!0},o.prototype.ngAfterContentInit=function(){var e=this,t=0;this.list=this.children.map(function(i){return i.dirIndex=t++,i.property=e.propertyName,i}),this.hasChanges=!0},o.prototype.getProperties=function(){for(var e=[],t=0,i=this.list;t<i.length;t++){var r=i[t];e.push(r.getProperties())}return e},o.prototype.isChanged=function(){var e=this,t=!1,i=0,r=!1,n=this.children.map(function(u){return u});if(this.list.length===this.children.length)for(var s=0;s<this.list.length;s++)this.list[parseInt(s.toString(),10)].propCollection.dataSource&&(this.list[parseInt(s.toString(),10)].dataSource&&this.list[parseInt(s.toString(),10)].propCollection.dataSource!==this.list[parseInt(s.toString(),10)].dataSource&&(this.list[parseInt(s.toString(),10)].propCollection.dataSource=this.list[parseInt(s.toString(),10)].dataSource,this.list[parseInt(s.toString(),10)].hasChanges=!0),this.list[parseInt(s.toString(),10)].property!=="series"&&(r=JSON.stringify(this.list[parseInt(s.toString(),10)].propCollection.dataSource)!==JSON.stringify(n[parseInt(s.toString(),10)].propCollection.dataSource))),r=this.list[parseInt(s.toString(),10)].hasChanges!==n[parseInt(s.toString(),10)].hasChanges;this.hasNewChildren=this.list.length!==this.children.length||r?!0:null,this.hasNewChildren&&(this.list=this.children.map(function(u){return u.dirIndex=i++,u.property=e.propertyName,u}));for(var a=0,l=this.list;a<l.length;a++){var h=l[a];t=t||h.hasChanges}return!!this.list.length&&t},o.prototype.clearTemplate=function(e){for(var t=this,i=0,r=this.list;i<r.length;i++){var n=r[i];n.clearTemplate(e&&e.map(function(s){var a=RegExp;return new a(t.propertyName).test(s)?s.replace(t.propertyName+".",""):s}))}},o.prototype.ngAfterContentChecked=function(){this.hasChanges=this.isChanged();for(var e=0;e<this.list.length;e++)V("childColumns",this.list[parseInt(e.toString(),10)])&&V("property",this.list[parseInt(e.toString(),10)])==="columns"&&Ge("columns",V("childColumns",this.list[parseInt(e.toString(),10)]).getProperties(),this.list[parseInt(e.toString(),10)].propCollection),this.list[parseInt(e.toString(),10)].isUpdated=!0},o.prototype.ngAfterViewInit=function(){this.isInitChanges=!1},o.prototype.ngOnDestroy=function(){this.list=[]},o}();var RS=function(){function o(){this.isProtectedOnChange=!0,this.isFormInit=!0}return o.prototype.saveChanges=function(e,t,i){if(!this.isProtectedOnChange){this.oldProperties["".concat(e)]=i,this.changedProperties["".concat(e)]=t,this.finalUpdate();var r=setTimeout(this.dataBind.bind(this)),n=function(){clearTimeout(r)};this.finalUpdate=n}},o.prototype.ngOnInit=function(e){var t=e||this;t.registeredTemplate={},t.ngBoundedEvents={},t.isAngular=!0,t.isFormInit=!0,e&&(this.tags=e.tags),t.tags=this.tags||[],t.complexTemplate=this.complexTemplate||[],t.tagObjects=[],t.ngAttr=this.getAngularAttr(t.element),t.createElement=function(v,m){var y=t.srenderer?t.srenderer.createElement(v):Xe(v);return typeof m>"u"||(y.innerHTML=m.innerHTML?m.innerHTML:"",m.className!==void 0&&(y.className=m.className),m.id!==void 0&&(y.id=m.id),m.styles!==void 0&&y.setAttribute("style",m.styles),t.ngAttr!==void 0&&y.setAttribute(t.ngAttr,""),m.attrs!==void 0&&Ie(y,m.attrs)),y};for(var i=0,r=t.tags;i<r.length;i++){var n=r[i],s={instance:V("child"+n.substring(0,1).toUpperCase()+n.substring(1),t),name:n};t.tagObjects.push(s)}for(var a=Object.keys(t),l=0;l<a.length;l++){var h=V(a[parseInt(l.toString(),10)],t);typeof h=="object"&&h&&h.elementRef&&(typeof h=="object"&&h&&h.elementRef&&a[parseInt(l.toString(),10)].indexOf("_")!==-1&&a[parseInt(l.toString(),10)].indexOf("Ref")===-1&&Ge(a[parseInt(l.toString(),10)]+"Ref",h,t),t.viewContainerRef&&!V("_viewContainerRef",h.elementRef.nativeElement)&&!V("propName",h.elementRef.nativeElement)&&(Ge("_viewContainerRef",t.viewContainerRef,h.elementRef.nativeElement),Ge("propName",a[parseInt(l.toString(),10)].replace("Ref",""),h.elementRef.nativeElement)))}a=Object.keys(t),a=a.filter(function(v){return/Ref$/i.test(v)&&/_/i.test(v)});for(var u=0,c=a;u<c.length;u++){var d=c[u],p=d.replace("Ref",""),f={};Ge(p.replace("_","."),V(p,t),f),t.setProperties(f,!0)}},o.prototype.getAngularAttr=function(e){for(var t=e.attributes,i=t.length,r,n=0;n<i;n++)/_ngcontent/g.test(t[parseInt(n.toString(),10)].name)&&(r=t[parseInt(n.toString(),10)].name);return r},o.prototype.ngAfterViewInit=function(e){var t=e||this,i=/ejs-tab|ejs-accordion/g;i.test(t.ngEle.nativeElement.outerHTML)&&(t.ngEle.nativeElement.style.visibility="hidden");var r=Object.keys(t);r=r.filter(function(c){return/Ref$/i.test(c)});for(var n=t.getModuleName()==="DocumentEditor",s=0,a=r;s<a.length;s++){var l=a[s],h=l.replace("Ref","");Ge(h.replace("_","."),V(h+"Ref",t),t)}var u=function(c){typeof window<"u"&&c.element&&(c.appendTo(c.element),c.ngEle.nativeElement.style.visibility="")};!n&&!t.getModuleName().includes("btn")?setTimeout(function(){u(t)}):u(t)},o.prototype.ngOnDestroy=function(e){var t=e||this;setTimeout(function(){if(typeof window<"u"&&t.element.classList.contains("e-control")){if(t.ngOnFocus!==void 0&&t.ngOnBlur!==void 0){var i=t.inputElement||t.element;i.removeEventListener("focus",t.ngOnFocusBound),i.removeEventListener("blur",t.ngOnBlurBound),t.ngOnFocusBound=null,t.ngOnBlurBound=null}t.destroy(),t.clearTemplate(null),setTimeout(function(){for(var r=0,n=Object.keys(t);r<n.length;r++){var s=n[r],a=t["".concat(s)];if(a&&/object/.test(typeof a)&&Object.keys(a).length!==0)if(/properties|changedProperties|childChangedProperties|oldProperties|moduleLoader/.test(s))for(var l=0,h=Object.keys(t["".concat(s)]);l<h.length;l++){var u=h[l],c=a["".concat(u)];c&&/object/.test(typeof c)&&Object.keys(c).length!==0&&(c.parent||c.parentObj)&&(t["".concat(s)]["".concat(u)]=null)}else(a.parent||a.parentObj)&&(t["".concat(s)]=null)}})}})},o.prototype.clearTemplate=function(e,t){Ug(this,e,t)},o.prototype.ngAfterContentChecked=function(e){for(var t=e||this,i=0,r=t.tagObjects;i<r.length;i++){var n=r[i];if(!Ee(n.instance)&&(n.instance.isInitChanges||n.instance.hasChanges||n.instance.hasNewChildren)){var s={};if(n.instance.isInitChanges){var a=void 0,l=V("instance.list",n);l&&l.length&&(a=l[0].directivePropList);var h=!0;if(t.getModuleName&&t.getModuleName()==="gantt"&&(h=!1),a&&h&&a.indexOf(n.instance.propertyName)===-1)for(var u=Object.keys(n.instance.list[0].propCollection),c=0;c<n.instance.list.length;c++){n.instance.list["".concat(c)].propCollection[n.instance.propertyName]=[];for(var d={},p=0;p<u.length;p++){var f=u[parseInt(p.toString(),10)];d["".concat(f)]=n.instance.list["".concat(c)].propCollection["".concat(f)]}for(var v=function(F){var R=n.instance.list["".concat(c)].tags[parseInt(F.toString(),10)],N=V("child"+R.substring(0,1).toUpperCase()+R.substring(1),n.instance.list["".concat(c)]);if(N){var P=n.instance.list["".concat(c)]["child"+R.substring(0,1).toUpperCase()+R.substring(1)],O=function(z){var H=[];if(z)for(var Q=0;Q<z.list.length;Q++){var $=z.list[0].tags[0];if($){var U=V("child"+$.substring(0,1).toUpperCase()+$.substring(1),z.list[parseInt(Q.toString(),10)]);U&&(z.list[parseInt(Q.toString(),10)].tagObjects.push({instance:U,name:$}),H.push(U))}}if(H.length!==0)for(var ie=0;ie<H.length;ie++)O(H[parseInt(ie.toString(),10)])};O(P),n.instance.list["".concat(c)].tagObjects.push({instance:N,name:R})}},m=0;m<n.instance.list["".concat(c)].tags.length;m++)v(m);n.instance.list["".concat(c)].propCollection[n.instance.propertyName].push(d)}s[n.name]=n.instance.getProperties(),t.setProperties(s,n.instance.isInitChanges)}else{var y=!1;(t[n.name].length!==n.instance.list.length||/diagram|DashboardLayout/.test(t.getModuleName()))&&(t[n.name]=n.instance.list,y=!0);for(var S=0,b=n.instance.list;S<b.length;S++){var l=b[S];if(l.tags)for(var w=0,I=l.tags;w<I.length;w++){var x=I[w],M=V("child"+x.substring(0,1).toUpperCase()+x.substring(1),l);M&&l.tagObjects.push({instance:M,name:x})}var D=n.instance.list.indexOf(l),A=V(n.name,t)["".concat(D)],L=Object.keys(A);if(L=L.filter(function(R){return/Ref$/i.test(R)}),A.properties&&Object.keys(A.properties).length!==0)for(var T=0,k=L;T<k.length;T++){var f=k[T];f=f.replace(/Ref/,""),A.properties["".concat(f)]=A.properties["".concat(f)]?A.properties["".concat(f)]:A.propCollection["".concat(f)]}!Ee(A)&&!Ee(A.setProperties)&&(/diagram|DashboardLayout/.test(t.getModuleName())?A.setProperties(l.getProperties(),!0):A.setProperties(l.getProperties())),l.isUpdated=!0}(/grid/.test(t.getModuleName())&&y||/chart/.test(t.getModuleName()))&&(s[n.name]=n.instance.getProperties(),t.setProperties(s,n.instance.isInitChanges))}}}},o.prototype.registerEvents=function(e){_g(e,this)},o.prototype.twoWaySetter=function(e,t){var i=V(t,this.properties);i!==e&&(this.saveChanges(t,e,i),Ge(t,g(e)?null:e,this.properties),V(t+"Change",this).emit(e))},o.prototype.addTwoWay=function(e){for(var t=this,i=function(l){V(l,r),Object.defineProperty(r,l,{get:function(){return V(l,t.properties)},set:function(h){return t.twoWaySetter(h,l)}}),Ge(l+"Change",new Da,r)},r=this,n=0,s=e;n<s.length;n++){var a=s[n];i(a)}},o.prototype.addEventListener=function(e,t){var i=V(e,this);Ee(i)||(this.ngBoundedEvents["".concat(e)]||(this.ngBoundedEvents["".concat(e)]=new Map),this.ngBoundedEvents["".concat(e)].set(t,i.subscribe(t)))},o.prototype.removeEventListener=function(e,t){var i=V(e,this);Ee(i)||this.ngBoundedEvents["".concat(e)].get(t).unsubscribe()},o.prototype.trigger=function(e,t,i){var r=V(e,this),n=this.isProtectedOnChange;this.isProtectedOnChange=!1,t&&(t.name=e),Ee(r)||r.next(t);var s=V("local"+e.charAt(0).toUpperCase()+e.slice(1),this);Ee(s)||s.call(this,t),this.isProtectedOnChange=n,i&&(this.preventChange=this.isPreventChange,i.call(this,t)),this.isPreventChange=!1},o}();var LG=function(){function o(){}return o.prototype.propagateChange=function(e){},o.prototype.propagateTouch=function(){},o.prototype.localChange=function(e){var t=e.checked===void 0?e.value:e.checked;if(this.objCheck=ms(t),this.isUpdated===!0&&(this.angularValue=this.oldValue),this.objCheck===!0)this.duplicateValue=JSON.stringify(t),this.duplicateAngularValue=JSON.stringify(this.angularValue),this.duplicateValue!==this.duplicateAngularValue&&this.propagateChange!==void 0&&t!==void 0&&(this.propagateChange(t),this.angularValue=t);else if(t!==this.angularValue&&this.propagateChange!==void 0&&t!==void 0)if(t!==""&&t!==null)this.propagateChange(t),this.angularValue=t;else{var i=t;this.propagateChange(i),this.angularValue=t}this.cdr.markForCheck()},o.prototype.registerOnChange=function(e){this.propagateChange=e},o.prototype.registerOnTouched=function(e){this.propagateTouch=e},o.prototype.twoWaySetter=function(e,t){var i=this.oldValue||V(t,this.properties),r=this.inputElement||this.element;r&&i===e&&this.value===e&&(r.value===void 0||r.value==="")||(this.saveChanges(t,e,i),Ge(t,g(e)?null:e,this.properties),V(t+"Change",this).emit(e))},o.prototype.ngAfterViewInit=function(e){var t=e||this;if(t.ngOnBlurBound=this.ngOnBlur.bind(this),t.ngOnFocusBound=this.ngOnFocus.bind(this),typeof window<"u"){t.getModuleName().includes("dropdowntree")?setTimeout(function(){t.appendTo(t.element)}):t.appendTo(t.element);var i=t.inputElement||t.element;i.addEventListener("focus",t.ngOnFocusBound),i.addEventListener("blur",t.ngOnBlurBound)}this.isFormInit=!1},o.prototype.setDisabledState=function(e){this.enabled=!e,this.disabled=e},o.prototype.writeValue=function(e){var t=/ejs-radiobutton/g;this.checked===void 0?this.value=e:this.ngEle&&(typeof e=="boolean"?t.test(this.ngEle.nativeElement.outerHTML)?this.checked=e===this.value:this.checked=e:this.checked=e===this.value),this.angularValue=e,this.isUpdated=!0,this.preventChange=!this.isFormInit,this.cdr.markForCheck()},o.prototype.ngOnFocus=function(e){this.skipFromEvent!==!0&&this.focus.emit(e),this.cdr.markForCheck()},o.prototype.ngOnBlur=function(e){this.propagateTouch(),this.skipFromEvent!==!0&&this.blur.emit(e),this.cdr.markForCheck()},o.isFormBase=!0,o}();var N3=EA();function F3(o,e){if(typeof o=="string"||typeof o=="function"&&o.prototype&&o.prototype.CSPTemplate)return N3(o,e);var t=o.elementRef.nativeElement._viewContainerRef,i=o.elementRef.nativeElement.propName;return function(r,n,s){var a={$implicit:r},l=t||n.viewContainerRef,h=l.createEmbeddedView(o,a);/EJS-MENTION|EJS-DROPDOWNLIST/.test(V("currentInstance.element.nodeName",l))||/E-TABITEM/.test(V("element.nativeElement.nodeName",l))&&V("currentInstance.headerTemplateRef",l)?h.detectChanges():h.markForCheck();var u=n&&n.registeredTemplate?n.registeredTemplate:V("currentInstance.registeredTemplate",l);return s=s&&n.registeredTemplate?s:i,typeof u["".concat(s)]>"u"&&(u["".concat(s)]=[]),u["".concat(s)].push(h),h.rootNodes}}function PS(o){return function(e,t){var i={set:O3(t),get:R3(t,o),enumerable:!0,configurable:!0};Object.defineProperty(e,t,i)}}function O3(o){return function(e){e!==void 0&&(Ge(o+"Ref",e,this),typeof e!="string"?(e.elementRef.nativeElement._viewContainerRef=this.viewContainerRef,e.elementRef.nativeElement.propName=o):this.saveChanges&&(this.saveChanges(o,e,void 0),this.dataBind()))}}function R3(o,e){return function(){return V(o+"Ref",this)||e}}DA({compile:F3});var Pe=function(){function o(e){return this.subQuery=null,this.isChild=!1,this.distincts=[],this.queries=[],this.key="",this.fKey="",typeof e=="string"?this.fromTable=e:e&&e instanceof Array&&(this.lookups=e),this.expands=[],this.sortedColumns=[],this.groupedColumns=[],this.subQuery=null,this.isChild=!1,this.params=[],this.lazyLoad=[],this}return Object.defineProperty(o.prototype,"moduleName",{get:function(){return"query"},enumerable:!0,configurable:!0}),o.prototype.setKey=function(e){return this.key=e,this},o.prototype.using=function(e){return this.dataManager=e,this},o.prototype.execute=function(e,t,i,r){return e=e||this.dataManager,e?e.executeQuery(this,t,i,r):de.throwError('Query - execute() : dataManager needs to be is set using "using" function or should be passed as argument')},o.prototype.executeLocal=function(e){return e=e||this.dataManager,e?e.executeLocal(this):de.throwError('Query - executeLocal() : dataManager needs to be is set using "using" function or should be passed as argument')},o.prototype.clone=function(){var e=new o;return e.queries=this.queries.slice(0),e.key=this.key,e.isChild=this.isChild,e.dataManager=this.dataManager,e.fromTable=this.fromTable,e.params=this.params.slice(0),e.expands=this.expands.slice(0),e.sortedColumns=this.sortedColumns.slice(0),e.groupedColumns=this.groupedColumns.slice(0),e.subQuerySelector=this.subQuerySelector,e.subQuery=this.subQuery,e.fKey=this.fKey,e.isCountRequired=this.isCountRequired,e.distincts=this.distincts.slice(0),e.lazyLoad=this.lazyLoad.slice(0),e},o.prototype.from=function(e){return this.fromTable=e,this},o.prototype.addParams=function(e,t){return typeof t=="function"?this.params.push({key:e,fn:t}):this.params.push({key:e,value:t}),this},o.prototype.distinct=function(e){return typeof e=="string"?this.distincts=[].slice.call([e],0):this.distincts=e.slice(0),this},o.prototype.expand=function(e){return typeof e=="string"?this.expands=[].slice.call([e],0):this.expands=e.slice(0),this},o.prototype.where=function(e,t,i,r,n,s){t=t?t.toLowerCase():null;var a=null;return typeof e=="string"?a=new St(e,t,i,r,n,s):e instanceof St&&(a=e),this.queries.push({fn:"onWhere",e:a}),this},o.prototype.search=function(e,t,i,r,n){typeof t=="string"&&(t=[t]),(!i||i==="none")&&(i="contains");var s=de.fnOperators[i];return this.queries.push({fn:"onSearch",e:{fieldNames:t,operator:i,searchKey:e,ignoreCase:r,ignoreAccent:n,comparer:s}}),this},o.prototype.sortBy=function(e,t,i){return this.sortByForeignKey(e,t,i)},o.prototype.sortByForeignKey=function(e,t,i,r){var n=g(r)?"ascending":r,s,a;if(typeof e=="string"&&de.endsWith(e.toLowerCase()," desc")&&(e=e.replace(/ desc$/i,""),t="descending"),(!t||typeof t=="string")&&(n=t?t.toLowerCase():"ascending",t=de.fnSort(t)),i){s=o.filterQueries(this.queries,"onSortBy");for(var l=0;l<s.length;l++)if(a=s[l].e.fieldName,typeof a=="string"){if(a===e)return this}else if(a instanceof Array){for(var h=0;h<a.length;h++)if(a[h]===e||e.toLowerCase()===a[h]+" desc")return this}}return this.queries.push({fn:"onSortBy",e:{fieldName:e,comparer:t,direction:n}}),this},o.prototype.sortByDesc=function(e){return this.sortBy(e,"descending")},o.prototype.group=function(e,t,i){return this.sortBy(e,null,!0),this.queries.push({fn:"onGroup",e:{fieldName:e,comparer:t||null,format:i||null}}),this},o.prototype.page=function(e,t){return this.queries.push({fn:"onPage",e:{pageIndex:e,pageSize:t}}),this},o.prototype.range=function(e,t){return this.queries.push({fn:"onRange",e:{start:e,end:t}}),this},o.prototype.take=function(e){return this.queries.push({fn:"onTake",e:{nos:e}}),this},o.prototype.skip=function(e){return this.queries.push({fn:"onSkip",e:{nos:e}}),this},o.prototype.select=function(e){return typeof e=="string"&&(e=[].slice.call([e],0)),this.queries.push({fn:"onSelect",e:{fieldNames:e}}),this},o.prototype.hierarchy=function(e,t){return this.subQuerySelector=t,this.subQuery=e,this},o.prototype.foreignKey=function(e){return this.fKey=e,this},o.prototype.requiresCount=function(){return this.isCountRequired=!0,this},o.prototype.aggregate=function(e,t){return this.queries.push({fn:"onAggregates",e:{field:t,type:e}}),this},o.filterQueries=function(e,t){return e.filter(function(i){return i.fn===t})},o.filterQueryLists=function(e,t){for(var i=e.filter(function(s){return t.indexOf(s.fn)!==-1}),r={},n=0;n<i.length;n++)r[i[n].fn]||(r[i[n].fn]=i[n].e);return r},o}(),St=function(){function o(e,t,i,r,n,s){return r===void 0&&(r=!1),this.ignoreAccent=!1,this.isComplex=!1,typeof e=="string"?(this.field=e,this.operator=t.toLowerCase(),this.value=i,this.matchCase=s,this.ignoreCase=r,this.ignoreAccent=n,this.isComplex=!1,this.comparer=de.fnOperators.processOperator(this.operator)):(e instanceof o&&i instanceof o||i instanceof Array)&&(this.isComplex=!0,this.condition=t.toLowerCase(),this.predicates=[e],this.matchCase=e.matchCase,this.ignoreCase=e.ignoreCase,this.ignoreAccent=e.ignoreAccent,i instanceof Array?[].push.apply(this.predicates,i):this.predicates.push(i)),this}return o.and=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.combinePredicates([].slice.call(e,0),"and")},o.prototype.and=function(e,t,i,r,n){return o.combine(this,e,t,i,"and",r,n)},o.or=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.combinePredicates([].slice.call(e,0),"or")},o.prototype.or=function(e,t,i,r,n){return o.combine(this,e,t,i,"or",r,n)},o.ornot=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.combinePredicates([].slice.call(e,0),"or not")},o.prototype.ornot=function(e,t,i,r,n){return o.combine(this,e,t,i,"ornot",r,n)},o.andnot=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.combinePredicates([].slice.call(e,0),"and not")},o.prototype.andnot=function(e,t,i,r,n){return o.combine(this,e,t,i,"andnot",r,n)},o.fromJson=function(e){if(e instanceof Array){for(var t=[],i=0,r=e.length;i<r;i++)t.push(this.fromJSONData(e[i]));return t}var n=e;return this.fromJSONData(n)},o.prototype.validate=function(e){var t=this.predicates?this.predicates:[],i,r;if(!this.isComplex&&this.comparer)return this.condition&&this.condition.indexOf("not")!==-1?(this.condition=this.condition.split("not")[0]===""?void 0:this.condition.split("not")[0],!this.comparer.call(this,de.getObject(this.field,e),this.value,this.ignoreCase,this.ignoreAccent)):this.comparer.call(this,de.getObject(this.field,e),this.value,this.ignoreCase,this.ignoreAccent);this.condition&&this.condition.indexOf("not")!==-1?r=this.condition.indexOf("and")!==-1:r=this.condition==="and";for(var n=0;n<t.length;n++)if(n>0&&this.condition&&this.condition.indexOf("not")!==-1&&(t[n].condition=t[n].condition?t[n].condition+"not":"not"),i=t[n].validate(e),r){if(!i)return!1}else if(i)return!0;return r},o.prototype.toJson=function(){var e,t;if(this.isComplex){e=[],t=this.predicates;for(var i=0;i<t.length;i++)e.push(t[i].toJson())}return{isComplex:this.isComplex,field:this.field,operator:this.operator,value:this.value,ignoreCase:this.ignoreCase,ignoreAccent:this.ignoreAccent,condition:this.condition,predicates:e,matchCase:this.matchCase}},o.combinePredicates=function(e,t){if(e.length===1){if(!(e[0]instanceof Array))return e[0];e=e[0]}return new o(e[0],t,e.slice(1))},o.combine=function(e,t,i,r,n,s,a){return t instanceof o?o[n](e,t):typeof t=="string"?o[n](e,new o(t,i,r,s,a)):de.throwError("Predicate - "+n+" : invalid arguments")},o.fromJSONData=function(e){for(var t=e.predicates||[],i=t.length,r=[],n,s=0;s<i;s++)r.push(this.fromJSONData(t[s]));return e.isComplex?n=new o(r[0],e.condition,r.slice(1)):n=new o(e.field,e.operator,e.value,e.ignoreCase,e.ignoreAccent),n},o}(),TA={GroupGuid:"{271bbba0-1ee7}"},de=function(){function o(){}return o.getValue=function(e,t){return typeof e=="function"?e.call(t||{}):e},o.endsWith=function(e,t){return e.slice&&e.slice(-t.length)===t},o.notEndsWith=function(e,t){return e.slice&&e.slice(-t.length)!==t},o.startsWith=function(e,t){return e.slice(0,t.length)===t},o.notStartsWith=function(e,t){return e.slice(0,t.length)!==t},o.wildCard=function(e,t){var i,r;if(t.indexOf("[")!==-1&&(t=t.split("[").join("[[]")),t.indexOf("(")!==-1&&(t=t.split("(").join("[(]")),t.indexOf(")")!==-1&&(t=t.split(")").join("[)]")),t.indexOf("\\")!==-1&&(t=t.split("\\").join("[\\\\]")),t.indexOf("*")!==-1){t.charAt(0)!=="*"&&(t="^"+t),t.charAt(t.length-1)!=="*"&&(t=t+"$"),i=t.split("*");for(var n=0;n<i.length;n++)i[n].indexOf(".")===-1?i[n]=i[n]+".*":i[n]=i[n]+"*";t=i.join("")}(t.indexOf("%3f")!==-1||t.indexOf("?")!==-1)&&(r=t.indexOf("%3f")!==-1?t.split("%3f"):t.split("?"),t=r.join("."));var s=new RegExp(t,"g");return s.test(e)},o.like=function(e,t){return t.indexOf("%")!==-1?t.charAt(0)==="%"&&t.lastIndexOf("%")<2?(t=t.substring(1,t.length),o.startsWith(o.toLowerCase(e),o.toLowerCase(t))):t.charAt(t.length-1)==="%"&&t.indexOf("%")>t.length-3?(t=t.substring(0,t.length-1),o.endsWith(o.toLowerCase(e),o.toLowerCase(t))):(t.lastIndexOf("%")!==t.indexOf("%")&&t.lastIndexOf("%")>t.indexOf("%")+1&&(t=t.substring(t.indexOf("%")+1,t.lastIndexOf("%"))),e.indexOf(t)!==-1):!1},o.fnSort=function(e){return e=e?o.toLowerCase(e):"ascending",e==="ascending"?this.fnAscending:this.fnDescending},o.fnAscending=function(e,t){return g(e)&&g(t)?0:t==null?-1:typeof e=="string"?e.localeCompare(t):e==null?1:e-t},o.fnDescending=function(e,t){return g(e)&&g(t)?0:t==null?1:typeof e=="string"?e.localeCompare(t)*-1:e==null?-1:t-e},o.extractFields=function(e,t){for(var i={},r=0;r<t.length;r++)i=this.setValue(t[r],this.getObject(t[r],e),i);return i},o.select=function(e,t){for(var i=[],r=0;r<e.length;r++)i.push(this.extractFields(e[r],t));return i},o.group=function(e,t,i,r,n,s,a){r=r||1;var l=e,h="GroupGuid";if(l.GroupGuid===TA[h]){for(var u=function(b){if(g(n))l[b].items=c.group(l[b].items,t,i,l.level+1,null,s,a),l[b].count=l[b].items.length;else{var w=-1,I=n.filter(function(x){return x.key===l[b].key});w=n.indexOf(I[0]),l[b].items=c.group(l[b].items,t,i,l.level+1,n[w].items,s,a),l[b].count=n[w].count}},c=this,d=0;d<l.length;d++)u(d);return l.childLevels+=1,l}var p={},f=[];f.GroupGuid=TA[h],f.level=r,f.childLevels=0,f.records=l;for(var v=function(b){var w=m.getVal(l,b,t);if(g(s)||(w=s(w,t)),!p[w]&&(p[w]={key:w,count:0,items:[],aggregates:{},field:t},f.push(p[w]),!g(n))){var I=n.filter(function(x){return x.key===p[w].key});p[w].count=I[0].count}p[w].count=g(n)?p[w].count+=1:p[w].count,(!a||a&&i.length)&&p[w].items.push(l[b])},m=this,y=0;y<l.length;y++)v(y);if(i&&i.length)for(var S=function(b){for(var w={},I=void 0,x=i,M=0;M<i.length;M++)if(I=o.aggregates[i[M].type],g(n))I&&(w[x[M].field+" - "+x[M].type]=I(f[b].items,x[M].field));else{var D=n.filter(function(A){return A.key===f[b].key});I&&(w[x[M].field+" - "+x[M].type]=I(D[0].items,x[M].field))}f[b].aggregates=w},y=0;y<f.length;y++)S(y);if(a&&f.length&&i.length)for(var y=0;y<f.length;y++)f[y].items=[];return l.length&&f||l},o.buildHierarchy=function(e,t,i,r,n){var s,a={},l;for(r.result&&(r=r.result),r.GroupGuid&&this.throwError("DataManager: Do not have support Grouping in hierarchy"),s=0;s<r.length;s++){var h=this.getObject(e,r[s]);l=a[h]||(a[h]=[]),l.push(r[s])}for(s=0;s<i.length;s++){var h=this.getObject(n||e,i[s]);i[s][t]=a[h]}},o.getFieldList=function(e,t,i){if(i===void 0&&(i=""),t==null)return this.getFieldList(e,[],i);for(var r=e,n=Object.keys(e),s=0,a=n;s<a.length;s++){var l=a[s];typeof r[l]=="object"&&!(r[l]instanceof Array)?this.getFieldList(r[l],t,i+l+"."):t.push(i+l)}return t},o.getObject=function(e,t){if(!e)return t;if(t){if(e.indexOf(".")===-1)if(g(t[e])){var i=e.charAt(0).toLowerCase()+e.slice(1),r=e.charAt(0).toUpperCase()+e.slice(1);return g(t[i])?g(t[r])?null:t[r]:t[i]}else return t[e];for(var n=t,s=e.split("."),a=0;a<s.length&&n!=null;a++){if(n=n[s[a]],n===void 0){var l=s[a].charAt(0).toUpperCase()+s[a].slice(1);n=t[l]||t[l.charAt(0).toLowerCase()+l.slice(1)]||null}t=n}return n}},o.setValue=function(e,t,i){var r=e.toString().split("."),n=i||{},s=n,a,l=r.length,h;for(a=0;a<l;a++)h=r[a],a+1===l?s[h]=t===void 0?void 0:t:g(s[h])&&(s[h]={}),s=s[h];return n},o.sort=function(e,t,i){var r=this;return e.length<=1?e:e.slice().sort(function(n,s){return i(r.getVal([n],0,t),r.getVal([s],0,t),n,s)})},o.ignoreDiacritics=function(e){if(typeof e!="string")return e;var t=e.split(""),i=t.map(function(r){return r in o.diacritics?o.diacritics[r]:r});return i.join("")},o.ignoreDiacriticsForArrays=function(e){return Array.isArray(e)?e.map(function(t){return o.ignoreDiacritics(t)}):[]},o.merge=function(e,t,i,r){for(var n=[],s;e.length>0||t.length>0;)e.length>0&&t.length>0?r?s=r(this.getVal(e,0,i),this.getVal(t,0,i),e[0],t[0])<=0?e:t:s=e[0][i]<e[0][i]?e:t:s=e.length>0?e:t,n.push(s.shift());return n},o.getVal=function(e,t,i){return i?this.getObject(i,e[t]):e[t]},o.toLowerCase=function(e){return g(e)?"":typeof e=="string"?e.toLowerCase():e instanceof Date?e.toString().toLowerCase():e.toString()},o.callAdaptorFunction=function(e,t,i,r){if(t in e){var n=e[t](i,r);g(n)||(i=n)}return i},o.getAddParams=function(e,t,i){var r={};return o.callAdaptorFunction(e,"addParams",{dm:t,query:i,params:i?i.params:[],reqParams:r}),r},o.isPlainObject=function(e){return!!e&&e.constructor===Object},o.isCors=function(){var e=null,t="XMLHttpRequest";try{e=new window[t]}catch{}return!!e&&"withCredentials"in e},o.getGuid=function(e){var t="0123456789abcdef",i;return(e||"")+"00000000-0000-4000-0000-000000000000".replace(/0/g,function(r,n){if("crypto"in window&&"getRandomValues"in crypto){var s=new Uint8Array(1);window.crypto.getRandomValues(s),i=s[0]%16|0}else i=Math.random()*16|0;return t[n===19?i&3|8:i]})},o.isNull=function(e){return e==null},o.getItemFromComparer=function(e,t,i){var r,n,s,a=0,l=typeof o.getVal(e,0,t)=="string";if(e.length)for(;g(r)&&a<e.length;)r=o.getVal(e,a,t),s=e[a++];for(;a<e.length;a++)n=o.getVal(e,a,t),!g(n)&&(l&&(r=+r,n=+n),i(r,n)>0&&(r=n,s=e[a]));return s},o.distinct=function(e,t,i){i=g(i)?!1:i;var r=[],n,s={};return e.forEach(function(a,l){n=typeof e[l]=="object"?o.getVal(e,l,t):e[l],n in s||(r.push(i?e[l]:n),s[n]=1)}),r},o.processData=function(e,t){var i=this.prepareQuery(e),r=new re(t);e.requiresCounts&&i.requiresCount();var n=r.executeLocal(i),s={result:e.requiresCounts?n.result:n,count:n.count,aggregates:JSON.stringify(n.aggregates)};return e.requiresCounts?s:n},o.prepareQuery=function(e){var t=this,i=new Pe;if(e.select&&i.select(e.select),e.where){var r=o.parse.parseJson(e.where);r.filter(function(s){if(g(s.condition))i.where(s.field,s.operator,s.value,s.ignoreCase,s.ignoreAccent);else{var a=[];s.field?a.push(new St(s.field,s.operator,s.value,s.ignoreCase,s.ignoreAccent)):a=a.concat(t.getPredicate(s.predicates)),s.condition==="or"?i.where(St.or(a)):s.condition==="and"&&i.where(St.and(a))}})}if(e.search){var n=o.parse.parseJson(e.search);n.filter(function(s){return i.search(s.key,s.fields,s.operator,s.ignoreCase,s.ignoreAccent)})}return e.aggregates&&e.aggregates.filter(function(s){return i.aggregate(s.type,s.field)}),e.sorted&&e.sorted.filter(function(s){return i.sortBy(s.name,s.direction)}),e.skip&&i.skip(e.skip),e.take&&i.take(e.take),e.group&&e.group.filter(function(s){return i.group(s)}),i},o.getPredicate=function(e){for(var t=[],i=0;i<e.length;i++){var r=e[i];if(r.field)t.push(new St(r.field,r.operator,r.value,r.ignoreCase,r.ignoreAccent));else{for(var n=[],s=this.getPredicate(r.predicates),a=0,l=Object.keys(s);a<l.length;a++){var h=l[a];n.push(s[h])}t.push(r.condition==="or"?St.or(n):St.and(n))}}return t},o.serverTimezoneOffset=null,o.timeZoneHandling=!0,o.throwError=function(e){try{throw new Error(e)}catch(t){throw t.message+`
`+t.stack}},o.aggregates={sum:function(e,t){for(var i=0,r,n=typeof o.getVal(e,0,t)!="number",s=0;s<e.length;s++)r=o.getVal(e,s,t),!isNaN(r)&&r!==null&&(n&&(r=+r),i+=r);return i},average:function(e,t){return o.aggregates.sum(e,t)/e.length},min:function(e,t){var i;return typeof t=="function"&&(i=t,t=null),o.getObject(t,o.getItemFromComparer(e,t,i||o.fnAscending))},max:function(e,t){var i;return typeof t=="function"&&(i=t,t=null),o.getObject(t,o.getItemFromComparer(e,t,i||o.fnDescending))},truecount:function(e,t){return new re(e).executeLocal(new Pe().where(t,"equal",!0,!0)).length},falsecount:function(e,t){return new re(e).executeLocal(new Pe().where(t,"equal",!1,!0)).length},count:function(e,t){return e.length}},o.operatorSymbols={"<":"lessthan",">":"greaterthan","<=":"lessthanorequal",">=":"greaterthanorequal","==":"equal","!=":"notequal","*=":"contains","$=":"endswith","^=":"startswith"},o.odBiOperator={"<":" lt ",">":" gt ","<=":" le ",">=":" ge ","==":" eq ","!=":" ne ",lessthan:" lt ",lessthanorequal:" le ",greaterthan:" gt ",greaterthanorequal:" ge ",equal:" eq ",notequal:" ne "},o.odUniOperator={"$=":"endswith","^=":"startswith","*=":"substringof",endswith:"endswith",startswith:"startswith",contains:"substringof",doesnotendwith:"not endswith",doesnotstartwith:"not startswith",doesnotcontain:"not substringof",wildcard:"wildcard",like:"like"},o.odv4UniOperator={"$=":"endswith","^=":"startswith","*=":"contains",endswith:"endswith",startswith:"startswith",contains:"contains",doesnotendwith:"not endswith",doesnotstartwith:"not startswith",doesnotcontain:"not contains",wildcard:"wildcard",like:"like"},o.diacritics={"\u24B6":"A",\uFF21:"A",\u00C0:"A",\u00C1:"A",\u00C2:"A",\u1EA6:"A",\u1EA4:"A",\u1EAA:"A",\u1EA8:"A",\u00C3:"A",\u0100:"A",\u0102:"A",\u1EB0:"A",\u1EAE:"A",\u1EB4:"A",\u1EB2:"A",\u0226:"A",\u01E0:"A",\u00C4:"A",\u01DE:"A",\u1EA2:"A",\u00C5:"A",\u01FA:"A",\u01CD:"A",\u0200:"A",\u0202:"A",\u1EA0:"A",\u1EAC:"A",\u1EB6:"A",\u1E00:"A",\u0104:"A","\u023A":"A","\u2C6F":"A","\uA732":"AA",\u00C6:"AE",\u01FC:"AE",\u01E2:"AE","\uA734":"AO","\uA736":"AU","\uA738":"AV","\uA73A":"AV","\uA73C":"AY","\u24B7":"B",\uFF22:"B",\u1E02:"B",\u1E04:"B",\u1E06:"B","\u0243":"B",\u0182:"B",\u0181:"B","\u24B8":"C",\uFF23:"C",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u00C7:"C",\u1E08:"C",\u0187:"C","\u023B":"C","\uA73E":"C","\u24B9":"D",\uFF24:"D",\u1E0A:"D",\u010E:"D",\u1E0C:"D",\u1E10:"D",\u1E12:"D",\u1E0E:"D",\u0110:"D",\u018B:"D",\u018A:"D",\u0189:"D","\uA779":"D",\u01F1:"DZ",\u01C4:"DZ",\u01F2:"Dz",\u01C5:"Dz","\u24BA":"E",\uFF25:"E",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u1EC0:"E",\u1EBE:"E",\u1EC4:"E",\u1EC2:"E",\u1EBC:"E",\u0112:"E",\u1E14:"E",\u1E16:"E",\u0114:"E",\u0116:"E",\u00CB:"E",\u1EBA:"E",\u011A:"E",\u0204:"E",\u0206:"E",\u1EB8:"E",\u1EC6:"E",\u0228:"E",\u1E1C:"E",\u0118:"E",\u1E18:"E",\u1E1A:"E",\u0190:"E",\u018E:"E","\u24BB":"F",\uFF26:"F",\u1E1E:"F",\u0191:"F","\uA77B":"F","\u24BC":"G",\uFF27:"G",\u01F4:"G",\u011C:"G",\u1E20:"G",\u011E:"G",\u0120:"G",\u01E6:"G",\u0122:"G",\u01E4:"G",\u0193:"G","\uA7A0":"G","\uA77D":"G","\uA77E":"G","\u24BD":"H",\uFF28:"H",\u0124:"H",\u1E22:"H",\u1E26:"H",\u021E:"H",\u1E24:"H",\u1E28:"H",\u1E2A:"H",\u0126:"H","\u2C67":"H","\u2C75":"H","\uA78D":"H","\u24BE":"I",\uFF29:"I",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u0128:"I",\u012A:"I",\u012C:"I",\u0130:"I",\u00CF:"I",\u1E2E:"I",\u1EC8:"I",\u01CF:"I",\u0208:"I",\u020A:"I",\u1ECA:"I",\u012E:"I",\u1E2C:"I",\u0197:"I","\u24BF":"J",\uFF2A:"J",\u0134:"J","\u0248":"J","\u24C0":"K",\uFF2B:"K",\u1E30:"K",\u01E8:"K",\u1E32:"K",\u0136:"K",\u1E34:"K",\u0198:"K","\u2C69":"K","\uA740":"K","\uA742":"K","\uA744":"K","\uA7A2":"K","\u24C1":"L",\uFF2C:"L",\u013F:"L",\u0139:"L",\u013D:"L",\u1E36:"L",\u1E38:"L",\u013B:"L",\u1E3C:"L",\u1E3A:"L",\u0141:"L","\u023D":"L","\u2C62":"L","\u2C60":"L","\uA748":"L","\uA746":"L","\uA780":"L",\u01C7:"LJ",\u01C8:"Lj","\u24C2":"M",\uFF2D:"M",\u1E3E:"M",\u1E40:"M",\u1E42:"M","\u2C6E":"M",\u019C:"M","\u24C3":"N",\uFF2E:"N",\u01F8:"N",\u0143:"N",\u00D1:"N",\u1E44:"N",\u0147:"N",\u1E46:"N",\u0145:"N",\u1E4A:"N",\u1E48:"N","\u0220":"N",\u019D:"N","\uA790":"N","\uA7A4":"N",\u01CA:"NJ",\u01CB:"Nj","\u24C4":"O",\uFF2F:"O",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u1ED2:"O",\u1ED0:"O",\u1ED6:"O",\u1ED4:"O",\u00D5:"O",\u1E4C:"O",\u022C:"O",\u1E4E:"O",\u014C:"O",\u1E50:"O",\u1E52:"O",\u014E:"O",\u022E:"O",\u0230:"O",\u00D6:"O",\u022A:"O",\u1ECE:"O",\u0150:"O",\u01D1:"O",\u020C:"O",\u020E:"O",\u01A0:"O",\u1EDC:"O",\u1EDA:"O",\u1EE0:"O",\u1EDE:"O",\u1EE2:"O",\u1ECC:"O",\u1ED8:"O",\u01EA:"O",\u01EC:"O",\u00D8:"O",\u01FE:"O",\u0186:"O",\u019F:"O","\uA74A":"O","\uA74C":"O",\u01A2:"OI","\uA74E":"OO",\u0222:"OU","\u24C5":"P",\uFF30:"P",\u1E54:"P",\u1E56:"P",\u01A4:"P","\u2C63":"P","\uA750":"P","\uA752":"P","\uA754":"P","\u24C6":"Q",\uFF31:"Q","\uA756":"Q","\uA758":"Q","\u024A":"Q","\u24C7":"R",\uFF32:"R",\u0154:"R",\u1E58:"R",\u0158:"R",\u0210:"R",\u0212:"R",\u1E5A:"R",\u1E5C:"R",\u0156:"R",\u1E5E:"R","\u024C":"R","\u2C64":"R","\uA75A":"R","\uA7A6":"R","\uA782":"R","\u24C8":"S",\uFF33:"S","\u1E9E":"S",\u015A:"S",\u1E64:"S",\u015C:"S",\u1E60:"S",\u0160:"S",\u1E66:"S",\u1E62:"S",\u1E68:"S",\u0218:"S",\u015E:"S","\u2C7E":"S","\uA7A8":"S","\uA784":"S","\u24C9":"T",\uFF34:"T",\u1E6A:"T",\u0164:"T",\u1E6C:"T",\u021A:"T",\u0162:"T",\u1E70:"T",\u1E6E:"T",\u0166:"T",\u01AC:"T",\u01AE:"T","\u023E":"T","\uA786":"T","\uA728":"TZ","\u24CA":"U",\uFF35:"U",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u0168:"U",\u1E78:"U",\u016A:"U",\u1E7A:"U",\u016C:"U",\u00DC:"U",\u01DB:"U",\u01D7:"U",\u01D5:"U",\u01D9:"U",\u1EE6:"U",\u016E:"U",\u0170:"U",\u01D3:"U",\u0214:"U",\u0216:"U",\u01AF:"U",\u1EEA:"U",\u1EE8:"U",\u1EEE:"U",\u1EEC:"U",\u1EF0:"U",\u1EE4:"U",\u1E72:"U",\u0172:"U",\u1E76:"U",\u1E74:"U","\u0244":"U","\u24CB":"V",\uFF36:"V",\u1E7C:"V",\u1E7E:"V",\u01B2:"V","\uA75E":"V","\u0245":"V","\uA760":"VY","\u24CC":"W",\uFF37:"W",\u1E80:"W",\u1E82:"W",\u0174:"W",\u1E86:"W",\u1E84:"W",\u1E88:"W","\u2C72":"W","\u24CD":"X",\uFF38:"X",\u1E8A:"X",\u1E8C:"X","\u24CE":"Y",\uFF39:"Y",\u1EF2:"Y",\u00DD:"Y",\u0176:"Y",\u1EF8:"Y",\u0232:"Y",\u1E8E:"Y",\u0178:"Y",\u1EF6:"Y",\u1EF4:"Y",\u01B3:"Y","\u024E":"Y","\u1EFE":"Y","\u24CF":"Z",\uFF3A:"Z",\u0179:"Z",\u1E90:"Z",\u017B:"Z",\u017D:"Z",\u1E92:"Z",\u1E94:"Z",\u01B5:"Z",\u0224:"Z","\u2C7F":"Z","\u2C6B":"Z","\uA762":"Z","\u24D0":"a",\uFF41:"a",\u1E9A:"a",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u1EA7:"a",\u1EA5:"a",\u1EAB:"a",\u1EA9:"a",\u00E3:"a",\u0101:"a",\u0103:"a",\u1EB1:"a",\u1EAF:"a",\u1EB5:"a",\u1EB3:"a",\u0227:"a",\u01E1:"a",\u00E4:"a",\u01DF:"a",\u1EA3:"a",\u00E5:"a",\u01FB:"a",\u01CE:"a",\u0201:"a",\u0203:"a",\u1EA1:"a",\u1EAD:"a",\u1EB7:"a",\u1E01:"a",\u0105:"a","\u2C65":"a",\u0250:"a","\uA733":"aa",\u00E6:"ae",\u01FD:"ae",\u01E3:"ae","\uA735":"ao","\uA737":"au","\uA739":"av","\uA73B":"av","\uA73D":"ay","\u24D1":"b",\uFF42:"b",\u1E03:"b",\u1E05:"b",\u1E07:"b",\u0180:"b",\u0183:"b",\u0253:"b","\u24D2":"c",\uFF43:"c",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u00E7:"c",\u1E09:"c",\u0188:"c","\u023C":"c","\uA73F":"c","\u2184":"c","\u24D3":"d",\uFF44:"d",\u1E0B:"d",\u010F:"d",\u1E0D:"d",\u1E11:"d",\u1E13:"d",\u1E0F:"d",\u0111:"d",\u018C:"d",\u0256:"d",\u0257:"d","\uA77A":"d",\u01F3:"dz",\u01C6:"dz","\u24D4":"e",\uFF45:"e",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u1EC1:"e",\u1EBF:"e",\u1EC5:"e",\u1EC3:"e",\u1EBD:"e",\u0113:"e",\u1E15:"e",\u1E17:"e",\u0115:"e",\u0117:"e",\u00EB:"e",\u1EBB:"e",\u011B:"e",\u0205:"e",\u0207:"e",\u1EB9:"e",\u1EC7:"e",\u0229:"e",\u1E1D:"e",\u0119:"e",\u1E19:"e",\u1E1B:"e","\u0247":"e",\u025B:"e",\u01DD:"e","\u24D5":"f",\uFF46:"f",\u1E1F:"f",\u0192:"f","\uA77C":"f","\u24D6":"g",\uFF47:"g",\u01F5:"g",\u011D:"g",\u1E21:"g",\u011F:"g",\u0121:"g",\u01E7:"g",\u0123:"g",\u01E5:"g",\u0260:"g","\uA7A1":"g","\u1D79":"g","\uA77F":"g","\u24D7":"h",\uFF48:"h",\u0125:"h",\u1E23:"h",\u1E27:"h",\u021F:"h",\u1E25:"h",\u1E29:"h",\u1E2B:"h",\u1E96:"h",\u0127:"h","\u2C68":"h","\u2C76":"h",\u0265:"h",\u0195:"hv","\u24D8":"i",\uFF49:"i",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u0129:"i",\u012B:"i",\u012D:"i",\u00EF:"i",\u1E2F:"i",\u1EC9:"i",\u01D0:"i",\u0209:"i",\u020B:"i",\u1ECB:"i",\u012F:"i",\u1E2D:"i",\u0268:"i",\u0131:"i","\u24D9":"j",\uFF4A:"j",\u0135:"j",\u01F0:"j","\u0249":"j","\u24DA":"k",\uFF4B:"k",\u1E31:"k",\u01E9:"k",\u1E33:"k",\u0137:"k",\u1E35:"k",\u0199:"k","\u2C6A":"k","\uA741":"k","\uA743":"k","\uA745":"k","\uA7A3":"k","\u24DB":"l",\uFF4C:"l",\u0140:"l",\u013A:"l",\u013E:"l",\u1E37:"l",\u1E39:"l",\u013C:"l",\u1E3D:"l",\u1E3B:"l",\u017F:"l",\u0142:"l",\u019A:"l",\u026B:"l","\u2C61":"l","\uA749":"l","\uA781":"l","\uA747":"l",\u01C9:"lj","\u24DC":"m",\uFF4D:"m",\u1E3F:"m",\u1E41:"m",\u1E43:"m",\u0271:"m",\u026F:"m","\u24DD":"n",\uFF4E:"n",\u01F9:"n",\u0144:"n",\u00F1:"n",\u1E45:"n",\u0148:"n",\u1E47:"n",\u0146:"n",\u1E4B:"n",\u1E49:"n",\u019E:"n",\u0272:"n",\u0149:"n","\uA791":"n","\uA7A5":"n",\u01CC:"nj","\u24DE":"o",\uFF4F:"o",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u1ED3:"o",\u1ED1:"o",\u1ED7:"o",\u1ED5:"o",\u00F5:"o",\u1E4D:"o",\u022D:"o",\u1E4F:"o",\u014D:"o",\u1E51:"o",\u1E53:"o",\u014F:"o",\u022F:"o",\u0231:"o",\u00F6:"o",\u022B:"o",\u1ECF:"o",\u0151:"o",\u01D2:"o",\u020D:"o",\u020F:"o",\u01A1:"o",\u1EDD:"o",\u1EDB:"o",\u1EE1:"o",\u1EDF:"o",\u1EE3:"o",\u1ECD:"o",\u1ED9:"o",\u01EB:"o",\u01ED:"o",\u00F8:"o",\u01FF:"o",\u0254:"o","\uA74B":"o","\uA74D":"o",\u0275:"o",\u01A3:"oi",\u0223:"ou","\uA74F":"oo","\u24DF":"p",\uFF50:"p",\u1E55:"p",\u1E57:"p",\u01A5:"p","\u1D7D":"p","\uA751":"p","\uA753":"p","\uA755":"p","\u24E0":"q",\uFF51:"q","\u024B":"q","\uA757":"q","\uA759":"q","\u24E1":"r",\uFF52:"r",\u0155:"r",\u1E59:"r",\u0159:"r",\u0211:"r",\u0213:"r",\u1E5B:"r",\u1E5D:"r",\u0157:"r",\u1E5F:"r","\u024D":"r",\u027D:"r","\uA75B":"r","\uA7A7":"r","\uA783":"r","\u24E2":"s",\uFF53:"s",\u00DF:"s",\u015B:"s",\u1E65:"s",\u015D:"s",\u1E61:"s",\u0161:"s",\u1E67:"s",\u1E63:"s",\u1E69:"s",\u0219:"s",\u015F:"s","\u023F":"s","\uA7A9":"s","\uA785":"s",\u1E9B:"s","\u24E3":"t",\uFF54:"t",\u1E6B:"t",\u1E97:"t",\u0165:"t",\u1E6D:"t",\u021B:"t",\u0163:"t",\u1E71:"t",\u1E6F:"t",\u0167:"t",\u01AD:"t",\u0288:"t","\u2C66":"t","\uA787":"t","\uA729":"tz","\u24E4":"u",\uFF55:"u",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u0169:"u",\u1E79:"u",\u016B:"u",\u1E7B:"u",\u016D:"u",\u00FC:"u",\u01DC:"u",\u01D8:"u",\u01D6:"u",\u01DA:"u",\u1EE7:"u",\u016F:"u",\u0171:"u",\u01D4:"u",\u0215:"u",\u0217:"u",\u01B0:"u",\u1EEB:"u",\u1EE9:"u",\u1EEF:"u",\u1EED:"u",\u1EF1:"u",\u1EE5:"u",\u1E73:"u",\u0173:"u",\u1E77:"u",\u1E75:"u",\u0289:"u","\u24E5":"v",\uFF56:"v",\u1E7D:"v",\u1E7F:"v",\u028B:"v","\uA75F":"v",\u028C:"v","\uA761":"vy","\u24E6":"w",\uFF57:"w",\u1E81:"w",\u1E83:"w",\u0175:"w",\u1E87:"w",\u1E85:"w",\u1E98:"w",\u1E89:"w","\u2C73":"w","\u24E7":"x",\uFF58:"x",\u1E8B:"x",\u1E8D:"x","\u24E8":"y",\uFF59:"y",\u1EF3:"y",\u00FD:"y",\u0177:"y",\u1EF9:"y",\u0233:"y",\u1E8F:"y",\u00FF:"y",\u1EF7:"y",\u1E99:"y",\u1EF5:"y",\u01B4:"y","\u024F":"y","\u1EFF":"y","\u24E9":"z",\uFF5A:"z",\u017A:"z",\u1E91:"z",\u017C:"z",\u017E:"z",\u1E93:"z",\u1E95:"z",\u01B6:"z",\u0225:"z","\u0240":"z","\u2C6C":"z","\uA763":"z",\u0386:"\u0391",\u0388:"\u0395",\u0389:"\u0397",\u038A:"\u0399",\u03AA:"\u0399",\u038C:"\u039F",\u038E:"\u03A5",\u03AB:"\u03A5",\u038F:"\u03A9",\u03AC:"\u03B1",\u03AD:"\u03B5",\u03AE:"\u03B7",\u03AF:"\u03B9",\u03CA:"\u03B9",\u0390:"\u03B9",\u03CC:"\u03BF",\u03CD:"\u03C5",\u03CB:"\u03C5",\u03B0:"\u03C5",\u03C9:"\u03C9",\u03C2:"\u03C3"},o.fnOperators={equal:function(e,t,i,r){return r&&(e=o.ignoreDiacritics(e),t=o.ignoreDiacritics(t)),i?o.toLowerCase(e)===o.toLowerCase(t):e===t},notequal:function(e,t,i,r){return r&&(e=o.ignoreDiacritics(e),t=o.ignoreDiacritics(t)),!o.fnOperators.equal(e,t,i)},lessthan:function(e,t,i){return i?o.toLowerCase(e)<o.toLowerCase(t):(g(e)&&(e=void 0),e<t)},greaterthan:function(e,t,i){return i?o.toLowerCase(e)>o.toLowerCase(t):e>t},lessthanorequal:function(e,t,i){return i?o.toLowerCase(e)<=o.toLowerCase(t):(g(e)&&(e=void 0),e<=t)},greaterthanorequal:function(e,t,i){return i?o.toLowerCase(e)>=o.toLowerCase(t):e>=t},contains:function(e,t,i,r){return r&&(e=o.ignoreDiacritics(e),t=o.ignoreDiacritics(t)),i?!g(e)&&!g(t)&&o.toLowerCase(e).indexOf(o.toLowerCase(t))!==-1:!g(e)&&!g(t)&&e.toString().indexOf(t)!==-1},doesnotcontain:function(e,t,i,r){return r&&(e=o.ignoreDiacritics(e),t=o.ignoreDiacritics(t)),i?!g(e)&&!g(t)&&o.toLowerCase(e).indexOf(o.toLowerCase(t))===-1:!g(e)&&!g(t)&&e.toString().indexOf(t)===-1},isnotnull:function(e){return e!=null},isnull:function(e){return e==null},startswith:function(e,t,i,r){return r&&(e=o.ignoreDiacritics(e),t=o.ignoreDiacritics(t)),i?e&&t&&o.startsWith(o.toLowerCase(e),o.toLowerCase(t)):e&&t&&o.startsWith(e,t)},doesnotstartwith:function(e,t,i,r){return r&&(e=o.ignoreDiacritics(e),t=o.ignoreDiacritics(t)),i?e&&t&&o.notStartsWith(o.toLowerCase(e),o.toLowerCase(t)):e&&t&&o.notStartsWith(e,t)},like:function(e,t,i,r){return r&&(e=o.ignoreDiacritics(e),t=o.ignoreDiacritics(t)),i?e&&t&&o.like(o.toLowerCase(e),o.toLowerCase(t)):e&&t&&o.like(e,t)},isempty:function(e){return e===void 0||e===""},isnotempty:function(e){return e!==void 0&&e!==""},wildcard:function(e,t,i,r){return r&&(e=o.ignoreDiacritics(e),t=o.ignoreDiacritics(t)),i?(e||typeof e=="boolean")&&t&&typeof e!="object"&&o.wildCard(o.toLowerCase(e),o.toLowerCase(t)):(e||typeof e=="boolean")&&t&&o.wildCard(e,t)},endswith:function(e,t,i,r){return r&&(e=o.ignoreDiacritics(e),t=o.ignoreDiacritics(t)),i?e&&t&&o.endsWith(o.toLowerCase(e),o.toLowerCase(t)):e&&t&&o.endsWith(e,t)},doesnotendwith:function(e,t,i,r){return r&&(e=o.ignoreDiacritics(e),t=o.ignoreDiacritics(t)),i?e&&t&&o.notEndsWith(o.toLowerCase(e),o.toLowerCase(t)):e&&t&&o.notEndsWith(e,t)},processSymbols:function(e){var t=o.operatorSymbols[e];if(t){var i=o.fnOperators[t];return i}return o.throwError("Query - Process Operator : Invalid operator")},processOperator:function(e){var t=o.fnOperators[e];return t||o.fnOperators.processSymbols(e)},in:function(e,t,i,r){return r&&(e=o.ignoreDiacritics(e),t=o.ignoreDiacriticsForArrays(t)),i?!g(e)&&t&&t.length>0&&t.map(function(n){return o.toLowerCase(n)}).indexOf(o.toLowerCase(e))>-1:e instanceof Date?!g(e)&&t&&t.length>0&&Array.isArray(t)&&t.some(function(n){return n instanceof Date&&n.getTime()===e.getTime()}):!g(e)&&t&&t.length>0&&t.indexOf(e)>-1},notin:function(e,t,i,r){return r&&(e=o.ignoreDiacritics(e),t=o.ignoreDiacriticsForArrays(t)),i?!g(e)&&t&&t.length>0&&t.map(function(n){return o.toLowerCase(n)}).indexOf(o.toLowerCase(e))===-1:e instanceof Date?!g(e)&&t&&t.length>0&&Array.isArray(t)&&t.every(function(n){return!(n instanceof Date)||n.getTime()!==e.getTime()}):!g(e)&&t&&t.length>0&&t.indexOf(e)===-1}},o.parse={parseJson:function(e){return typeof e=="string"&&(/^[\s]*\[|^[\s]*\{(.)+:/g.test(e)||e.indexOf('"')===-1)?e=JSON.parse(e,o.parse.jsonReviver):e instanceof Array?o.parse.iterateAndReviveArray(e):typeof e=="object"&&e!==null&&o.parse.iterateAndReviveJson(e),e},iterateAndReviveArray:function(e){for(var t=0;t<e.length;t++)typeof e[t]=="object"&&e[t]!==null?o.parse.iterateAndReviveJson(e[t]):typeof e[t]=="string"&&(!/^[\s]*\[|^[\s]*\{(.)+:|\"/g.test(e[t])||e[t].toString().indexOf('"')===-1)?e[t]=o.parse.jsonReviver("",e[t]):e[t]=o.parse.parseJson(e[t])},iterateAndReviveJson:function(e){for(var t,i=Object.keys(e),r=0,n=i;r<n.length;r++){var s=n[r];o.startsWith(s,"__")||(t=e[s],typeof t=="object"?t instanceof Array?o.parse.iterateAndReviveArray(t):t&&o.parse.iterateAndReviveJson(t):e[s]=o.parse.jsonReviver(e[s],t))}},jsonReviver:function(e,t){if(typeof t=="string"){var i=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(t),r=o.timeZoneHandling?o.serverTimezoneOffset:null;if(i)return o.dateParse.toTimeZone(new Date(parseInt(i[1],10)),r,!0);if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(t)){var n=t.indexOf("Z")>-1||t.indexOf("z")>-1,s=t.split(/[^0-9.]/);if(n){if(s[5].indexOf(".")>-1){var a=s[5].split(".");s[5]=a[0],s[6]=new Date(t).getUTCMilliseconds().toString()}else s[6]="00";t=o.dateParse.toTimeZone(new Date(parseInt(s[0],10),parseInt(s[1],10)-1,parseInt(s[2],10),parseInt(s[3],10),parseInt(s[4],10),parseInt(s[5]?s[5]:"00",10),parseInt(s[6],10)),o.serverTimezoneOffset,!1)}else{var l=new Date(parseInt(s[0],10),parseInt(s[1],10)-1,parseInt(s[2],10),parseInt(s[3],10),parseInt(s[4],10),parseInt(s[5]?s[5]:"00",10)),h=parseInt(s[6],10),u=parseInt(s[7],10);if(isNaN(h)&&isNaN(u))return l;t.indexOf("+")>-1?l.setHours(l.getHours()-h,l.getMinutes()-u):l.setHours(l.getHours()+h,l.getMinutes()+u),t=o.dateParse.toTimeZone(l,o.serverTimezoneOffset,!1)}o.serverTimezoneOffset==null&&(t=o.dateParse.addSelfOffset(t))}}return t},isJson:function(e){return typeof e[0]=="string"?e:o.parse.parseJson(e)},isGuid:function(e){var t=/[A-Fa-f0-9]{8}(?:-[A-Fa-f0-9]{4}){3}-[A-Fa-f0-9]{12}/i,i=t.exec(e);return i!=null},replacer:function(e,t){return o.isPlainObject(e)?o.parse.jsonReplacer(e,t):e instanceof Array?o.parse.arrayReplacer(e):e instanceof Date?o.parse.jsonReplacer({val:e},t).val:e},jsonReplacer:function(e,t){for(var i,r=Object.keys(e),n=0,s=r;n<s.length;n++){var a=s[n];if(i=e[a],i instanceof Date){var l=i;o.serverTimezoneOffset==null?e[a]=o.dateParse.toTimeZone(l,null).toJSON():(l=new Date(+l+o.serverTimezoneOffset*36e5),e[a]=o.dateParse.toTimeZone(o.dateParse.addSelfOffset(l),null).toJSON())}}return e},arrayReplacer:function(e){for(var t=0;t<e.length;t++)o.isPlainObject(e[t])?e[t]=o.parse.jsonReplacer(e[t]):e[t]instanceof Date&&(e[t]=o.parse.jsonReplacer({date:e[t]}).date);return e},jsonDateReplacer:function(e,t){if(e==="value"&&t){if(typeof t=="string"){var i=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(t);if(i)t=o.dateParse.toTimeZone(new Date(parseInt(i[1],10)),null,!0);else if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(t)){var r=t.split(/[^0-9]/);t=o.dateParse.toTimeZone(new Date(parseInt(r[0],10),parseInt(r[1],10)-1,parseInt(r[2],10),parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10)),null,!0)}}if(t instanceof Date)return t=o.dateParse.addSelfOffset(t),o.serverTimezoneOffset===null?o.dateParse.toTimeZone(o.dateParse.addSelfOffset(t),null).toJSON():(t=o.dateParse.toTimeZone(t,t.getTimezoneOffset()/60-o.serverTimezoneOffset,!1),t.toJSON())}return t}},o.dateParse={addSelfOffset:function(e){return new Date(+e-e.getTimezoneOffset()*6e4)},toUTC:function(e){return new Date(+e+e.getTimezoneOffset()*6e4)},toTimeZone:function(e,t,i){if(t===null)return e;var r=i?o.dateParse.toUTC(e):e;return new Date(+r-t*36e5)},toLocalTime:function(e){var t=e,i=-t.getTimezoneOffset(),r=i>=0?"+":"-",n=function(a){var l=Math.floor(Math.abs(a));return(l<10?"0":"")+l},s=t.getFullYear()+"-"+n(t.getMonth()+1)+"-"+n(t.getDate())+"T"+n(t.getHours())+":"+n(t.getMinutes())+":"+n(t.getSeconds())+r+n(i/60)+":"+n(i%60);return s}},o}(),nc=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),P3={GroupGuid:"{271bbba0-1ee7}"},LA=function(){function o(e){this.options={from:"table",requestType:"json",sortBy:"sorted",select:"select",skip:"skip",group:"group",take:"take",search:"search",count:"requiresCounts",where:"where",aggregates:"aggregates",expand:"expand"},this.type=o,this.dataSource=e,this.pvt={}}return o.prototype.processResponse=function(e,t,i,r){return e},o}(),np=function(o){nc(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return e.prototype.processQuery=function(t,i){for(var r=t.dataSource.json.slice(0),n=r.length,s=!0,a,l,h={},u=0,c=[],d=[],p,f=0;f<i.lazyLoad.length;f++)u++,h[i.lazyLoad[f].key]=i.lazyLoad[f].value;var v={},m=!1;if(i.lazyLoad.length){for(var f=0;f<i.queries.length;f++)if(l=i.queries[f],l.fn==="onGroup"&&!g(l.e.format)){m=!0;break}}for(var f=0;f<i.queries.length;f++){if(l=i.queries[f],(l.fn==="onPage"||l.fn==="onGroup"||l.fn==="onSortBy"&&!m)&&i.lazyLoad.length){l.fn==="onGroup"&&c.push(l.e),l.fn==="onPage"&&(p=l.e),l.fn==="onSortBy"&&d.unshift(l.e);continue}a=this[l.fn].call(this,r,l.e,i),l.fn==="onAggregates"?v[l.e.field+" - "+l.e.type]=a:r=a!==void 0?a:r,(l.fn==="onPage"||l.fn==="onSkip"||l.fn==="onTake"||l.fn==="onRange")&&(s=!1),s&&(n=r.length)}if(u){var y={query:i,lazyLoad:h,result:r,group:c,page:p,sort:d},S=this.lazyLoadGroup(y);r=S.result,n=S.count}return i.isCountRequired&&(r={result:r,count:n,aggregates:v}),r},e.prototype.lazyLoadGroup=function(t){var i=0,r=this.getAggregate(t.query),n=t.result;if(g(t.lazyLoad.onDemandGroupInfo)){var u=t.group[0].fieldName;n=de.group(n,u,r,null,null,t.group[0].comparer,!0),i=n.length;var h=n;if(t.sort.length){var c=t.sort.length>1?t.sort.filter(function(p){return p.fieldName===u})[0]:t.sort[0];n=this.onSortBy(n,c,t.query,!0)}t.page&&(n=this.onPage(n,t.page,t.query)),this.formGroupResult(n,h)}else{for(var s=t.lazyLoad.onDemandGroupInfo,a=s.where.length-1;a>=0;a--)n=this.onWhere(n,s.where[a]);if(t.group.length!==s.level){var l=t.group[s.level].fieldName;n=de.group(n,l,r,null,null,t.group[s.level].comparer,!0),t.sort.length&&(n=this.onSortBy(n,t.sort[parseInt(s.level.toString(),10)],t.query,!0))}else for(var a=t.sort.length-1;a>=s.level;a--)n=this.onSortBy(n,t.sort[parseInt(a.toString(),10)],t.query,!1);i=n.length;var h=n;n=n.slice(s.skip),n=n.slice(0,s.take),t.group.length!==s.level&&this.formGroupResult(n,h)}return{result:n,count:i}},e.prototype.formGroupResult=function(t,i){if(t.length&&i.length){var r="GroupGuid",n="childLevels",s="level",a="records";t[r]=i[r],t[n]=i[n],t[s]=i[s],t[a]=i[a]}return t},e.prototype.getAggregate=function(t){var i=Pe.filterQueries(t.queries,"onAggregates"),r=[];if(i.length)for(var n=void 0,s=0;s<i.length;s++)n=i[s].e,r.push({type:n.type,field:de.getValue(n.field,t)});return r},e.prototype.batchRequest=function(t,i,r){var n,s=i.deletedRecords.length;for(n=0;n<i.addedRecords.length;n++)this.insert(t,i.addedRecords[n]);for(n=0;n<i.changedRecords.length;n++)this.update(t,r.key,i.changedRecords[n]);for(n=0;n<s;n++)this.remove(t,r.key,i.deletedRecords[n]);return i},e.prototype.onWhere=function(t,i){return!t||!t.length?t:t.filter(function(r){if(i)return i.validate(r)})},e.prototype.onAggregates=function(t,i){var r=de.aggregates[i.type];return!t||!r||t.length===0?null:r(t,i.field)},e.prototype.onSearch=function(t,i){return!t||!t.length?t:(i.fieldNames.length===0&&de.getFieldList(t[0],i.fieldNames),t.filter(function(r){for(var n=0;n<i.fieldNames.length;n++)if(i.comparer.call(r,de.getObject(i.fieldNames[n],r),i.searchKey,i.ignoreCase,i.ignoreAccent))return!0;return!1}))},e.prototype.onSortBy=function(t,i,r,n){if(!t||!t.length)return t;var s,a=de.getValue(i.fieldName,r);if(!a)return t.sort(i.comparer);if(a instanceof Array){a=a.slice(0);for(var l=a.length-1;l>=0;l--)a[l]&&(s=i.comparer,de.endsWith(a[l]," desc")&&(s=de.fnSort("descending"),a[l]=a[l].replace(" desc","")),t=de.sort(t,a[l],s));return t}return de.sort(t,n?"key":a,i.comparer)},e.prototype.onGroup=function(t,i,r){if(!t||!t.length)return t;var n=this.getAggregate(r);return de.group(t,de.getValue(i.fieldName,r),n,null,null,i.comparer)},e.prototype.onPage=function(t,i,r){var n=de.getValue(i.pageSize,r),s=(de.getValue(i.pageIndex,r)-1)*n,a=s+n;return!t||!t.length?t:t.slice(s,a)},e.prototype.onRange=function(t,i){return!t||!t.length?t:t.slice(de.getValue(i.start),de.getValue(i.end))},e.prototype.onTake=function(t,i){return!t||!t.length?t:t.slice(0,de.getValue(i.nos))},e.prototype.onSkip=function(t,i){return!t||!t.length?t:t.slice(de.getValue(i.nos))},e.prototype.onSelect=function(t,i){return!t||!t.length?t:de.select(t,de.getValue(i.fieldNames))},e.prototype.insert=function(t,i,r,n,s){return g(s)?t.dataSource.json.push(i):t.dataSource.json.splice(s,0,i)},e.prototype.remove=function(t,i,r,n){var s=t.dataSource.json,a;for(typeof r=="object"&&!(r instanceof Date)&&(r=de.getObject(i,r)),a=0;a<s.length&&de.getObject(i,s[a])!==r;a++);return a!==s.length?s.splice(a,1):null},e.prototype.update=function(t,i,r,n){var s=t.dataSource.json,a,l;for(g(i)||(l=V(i,r)),a=0;a<s.length&&!(!g(i)&&V(i,s[a])===l);a++);return a<s.length?ht(s[a],r):null},e}(LA),Al=function(o){nc(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return e.prototype.processQuery=function(t,i,r){var n=this.getQueryRequest(i),s=Pe.filterQueryLists(i.queries,["onSelect","onPage","onSkip","onTake","onRange"]),a=i.params,l=t.dataSource.url,h,u,c=null,d=this.options,p={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};"onPage"in s?(h=s.onPage,u=de.getValue(h.pageIndex,i),c=de.getValue(h.pageSize,i),u=(u-1)*c):"onRange"in s&&(h=s.onRange,u=h.start,c=h.end-h.start);for(var f=0;f<n.sorts.length;f++)h=de.getValue(n.sorts[f].e.fieldName,i),p.sorts.push(de.callAdaptorFunction(this,"onEachSort",{name:h,direction:n.sorts[f].e.direction},i));r&&(h=this.getFiltersFrom(r,i),h&&p.filters.push(de.callAdaptorFunction(this,"onEachWhere",h.toJson(),i)));for(var f=0;f<n.filters.length;f++){var v=de.callAdaptorFunction(this,"onEachWhere",n.filters[f].e.toJson(),i);this.getModuleName&&this.getModuleName()==="ODataV4Adaptor"&&!g(n.filters[f].e.key)&&n.filters.length>1&&(v="("+v+")"),p.filters.push(v);for(var m=typeof p.filters[f]=="object"?Object.keys(p.filters[f]):[],y=0,S=m;y<S.length;y++){var b=S[y];de.isNull(p[b])&&delete p[b]}}for(var f=0;f<n.searches.length;f++)h=n.searches[f].e,p.searches.push(de.callAdaptorFunction(this,"onEachSearch",{fields:h.fieldNames,operator:h.operator,key:h.searchKey,ignoreCase:h.ignoreCase,ignoreAccent:h.ignoreAccent},i));for(var f=0;f<n.groups.length;f++)p.groups.push(de.getValue(n.groups[f].e.fieldName,i));for(var f=0;f<n.aggregates.length;f++)h=n.aggregates[f].e,p.aggregates.push({type:h.type,field:de.getValue(h.field,i)});var w={};if(this.getRequestQuery(d,i,s,p,w),de.callAdaptorFunction(this,"addParams",{dm:t,query:i,params:a,reqParams:w}),i.lazyLoad.length)for(var f=0;f<i.lazyLoad.length;f++)w[i.lazyLoad[f].key]=i.lazyLoad[f].value;for(var I=Object.keys(w),x=0,M=I;x<M.length;x++){var b=M[x];(de.isNull(w[b])||w[b]===""||w[b].length===0)&&delete w[b]}!(d.skip in w&&d.take in w)&&c!==null&&(w[d.skip]=de.callAdaptorFunction(this,"onSkip",u,i),w[d.take]=de.callAdaptorFunction(this,"onTake",c,i));var D=this.pvt;return this.pvt={},this.options.requestType==="json"?{data:JSON.stringify(w,de.parse.jsonDateReplacer),url:l,pvtData:D,type:"POST",contentType:"application/json; charset=utf-8"}:(h=this.convertToQueryString(w,i,t),h=(t.dataSource.url.indexOf("?")!==-1?"&":"/")+h,{type:"GET",url:h.length?l.replace(/\/*$/,h):l,pvtData:D})},e.prototype.getRequestQuery=function(t,i,r,n,s){var a="param",l=s;l[t.from]=i.fromTable,t.apply&&i.distincts.length&&(l[t.apply]="onDistinct"in this?de.callAdaptorFunction(this,"onDistinct",i.distincts):""),!i.distincts.length&&t.expand&&(l[t.expand]="onExpand"in this&&"onSelect"in r?de.callAdaptorFunction(this,"onExpand",{selects:de.getValue(r.onSelect.fieldNames,i),expands:i.expands},i):i.expands),l[t.select]="onSelect"in r&&!i.distincts.length?de.callAdaptorFunction(this,"onSelect",de.getValue(r.onSelect.fieldNames,i),i):"",l[t.count]=i.isCountRequired?de.callAdaptorFunction(this,"onCount",i.isCountRequired,i):"",l[t.search]=n.searches.length?de.callAdaptorFunction(this,"onSearch",n.searches,i):"",l[t.skip]="onSkip"in r?de.callAdaptorFunction(this,"onSkip",de.getValue(r.onSkip.nos,i),i):"",l[t.take]="onTake"in r?de.callAdaptorFunction(this,"onTake",de.getValue(r.onTake.nos,i),i):"",l[t.where]=n.filters.length||n.searches.length?de.callAdaptorFunction(this,"onWhere",n.filters,i):"",l[t.sortBy]=n.sorts.length?de.callAdaptorFunction(this,"onSortBy",n.sorts,i):"",l[t.group]=n.groups.length?de.callAdaptorFunction(this,"onGroup",n.groups,i):"",l[t.aggregates]=n.aggregates.length?de.callAdaptorFunction(this,"onAggregates",n.aggregates,i):"",l[a]=[]},e.prototype.convertToQueryString=function(t,i,r){return""},e.prototype.processResponse=function(t,i,r,n,s,a){if(n&&n.headers.get("Content-Type")&&n.headers.get("Content-Type").indexOf("application/json")!==-1){var l=de.timeZoneHandling;i&&!i.timeZoneHandling&&(de.timeZoneHandling=!1),i.enableCache||(t=de.parse.parseJson(t)),de.timeZoneHandling=l}var h=s,u=h.pvtData||{},c=t?t.groupDs:[];if(n&&n.headers.get("Content-Type")&&n.headers.get("Content-Type").indexOf("xml")!==-1)return r.isCountRequired?{result:[],count:0}:[];var d=JSON.parse(h.data);if(d&&d.action==="batch"&&t&&t.addedRecords&&!g(a))return a.addedRecords=t.addedRecords,a;t&&t.d&&(t=t.d);var p={};t&&"count"in t&&(p.count=t.count),p.result=t&&t.result?t.result:t;var f=!1;if(Array.isArray(t.result)&&t.result.length){var v="key",m="value",y="level";if(g(t.result[0][v])||(p.result=this.formRemoteGroupedData(p.result,1,u.groups.length-1)),r&&r.lazyLoad.length&&u.groups.length){for(var S=0;S<r.lazyLoad.length;S++)if(r.lazyLoad[S][v]==="onDemandGroupInfo"){var b=r.lazyLoad[S][m][y];u.groups.length===b&&(f=!0)}}}return f||this.getAggregateResult(u,t,p,c,r),de.isNull(p.count)?p.result:{result:p.result,count:p.count,aggregates:p.aggregates}},e.prototype.formRemoteGroupedData=function(t,i,r){for(var n=0;n<t.length;n++)t[n].items.length&&Object.keys(t[n].items[0]).indexOf("key")>-1&&this.formRemoteGroupedData(t[n].items,i+1,r-1);var s="GroupGuid",a="childLevels",l="level",h="records";return t[s]=P3[s],t[l]=i,t[a]=r,t[h]=t[0].items.length?this.getGroupedRecords(t,!g(t[0].items[h])):[],t},e.prototype.getGroupedRecords=function(t,i){for(var r=[],n="records",s=0;s<t.length;s++)if(i)r=r.concat(t[s].items[n]);else for(var a=0;a<t[s].items.length;a++)r.push(t[s].items[a]);return r},e.prototype.onGroup=function(t){return this.pvt.groups=t,t},e.prototype.onAggregates=function(t){this.pvt.aggregates=t},e.prototype.batchRequest=function(t,i,r,n,s){var a,l;return{type:"POST",url:t.dataSource.batchUrl||t.dataSource.crudUrl||t.dataSource.removeUrl||t.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(he({},{changed:i.changedRecords,added:i.addedRecords,deleted:i.deletedRecords,action:"batch",table:r[a],key:r[l]},de.getAddParams(this,t,n)))}},e.prototype.beforeSend=function(t,i,r){},e.prototype.insert=function(t,i,r,n){return{url:t.dataSource.insertUrl||t.dataSource.crudUrl||t.dataSource.url,data:JSON.stringify(he({},{value:i,table:r,action:"insert"},de.getAddParams(this,t,n)))}},e.prototype.remove=function(t,i,r,n,s){return{type:"POST",url:t.dataSource.removeUrl||t.dataSource.crudUrl||t.dataSource.url,data:JSON.stringify(he({},{key:r,keyColumn:i,table:n,action:"remove"},de.getAddParams(this,t,s)))}},e.prototype.update=function(t,i,r,n,s){return{type:"POST",url:t.dataSource.updateUrl||t.dataSource.crudUrl||t.dataSource.url,data:JSON.stringify(he({},{value:r,action:"update",keyColumn:i,key:de.getObject(i,r),table:n},de.getAddParams(this,t,s)))}},e.prototype.getFiltersFrom=function(t,i){var r=i.fKey,n,s=r,a=i.key,l=[];typeof t[0]!="object"&&(s=null);for(var h=0;h<t.length;h++)typeof t[0]=="object"?n=de.getObject(a||s,t[h]):n=t[h],l.push(new St(r,"equal",n));return St.or(l)},e.prototype.getAggregateResult=function(t,i,r,n,s){var a=i;if(i&&i.result&&(a=i.result),t&&t.aggregates&&t.aggregates.length){var l=t.aggregates,h=void 0,u=a,c={};i.aggregate&&(u=i.aggregate);for(var d=0;d<l.length;d++)h=de.aggregates[l[d].type],h&&(c[l[d].field+" - "+l[d].type]=h(u,l[d].field));r.aggregates=c}var p="key",f=Array.isArray(i.result)&&i.result.length&&!g(i.result[0][p]);if(t&&t.groups&&t.groups.length&&!f){for(var v=t.groups,d=0;d<v.length;d++){var m=null;g(n)||(n=de.group(n,v[d]));var y=Pe.filterQueries(s.queries,"onGroup")[d].e;a=de.group(a,v[d],t.aggregates,m,n,y.comparer)}r.result=a}return r},e.prototype.getQueryRequest=function(t){var i={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};return i.sorts=Pe.filterQueries(t.queries,"onSortBy"),i.groups=Pe.filterQueries(t.queries,"onGroup"),i.filters=Pe.filterQueries(t.queries,"onWhere"),i.searches=Pe.filterQueries(t.queries,"onSearch"),i.aggregates=Pe.filterQueries(t.queries,"onAggregates"),i},e.prototype.addParams=function(t){var i=t.reqParams;t.params.length&&(i.params={});for(var r=0,n=t.params;r<n.length;r++){var s=n[r];if(i[s.key])throw new Error("Query() - addParams: Custom Param is conflicting other request arguments");i[s.key]=s.value,s.fn&&(i[s.key]=s.fn.call(t.query,s.key,t.query,t.dm)),i.params[s.key]=i[s.key]}},e}(LA),rp=function(o){nc(e,o);function e(t){var i=o.call(this)||this;return i.options=he({},i.options,{requestType:"get",accept:"application/json;odata=light;q=1,application/json;odata=verbose;q=0.5",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$inlinecount",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:`Content-Type: application/http
Content-Transfer-Encoding: binary `,batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 ",updateType:"PUT"}),he(i.options,t||{}),i}return e.prototype.getModuleName=function(){return"ODataAdaptor"},e.prototype.onPredicate=function(t,i,r){var n="",s,a,l=t.value,h=typeof l,u=t.field?e.getField(t.field):null;if(l instanceof Date&&(l="datetime'"+de.parse.replacer(l)+"'"),h==="string"&&(l=l.replace(/'/g,"''"),t.ignoreCase&&(l=l.toLowerCase()),t.operator!=="like"&&(l=encodeURIComponent(l)),t.operator!=="wildcard"&&t.operator!=="like"&&(l="'"+l+"'"),r&&(u="cast("+u+", 'Edm.String')"),de.parse.isGuid(l)&&(a="guid"),t.ignoreCase&&(a||(u="tolower("+u+")"),l=l.toLowerCase())),t.operator==="isempty"||t.operator==="isnull"||t.operator==="isnotempty"||t.operator==="isnotnull"?(s=t.operator.indexOf("isnot")!==-1?de.odBiOperator.notequal:de.odBiOperator.equal,l=t.operator==="isnull"||t.operator==="isnotnull"?null:"''"):s=de.odBiOperator[t.operator],s)return n+=u,n+=s,a&&(n+=a),n+l;if(!g(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?s=de.odv4UniOperator[t.operator]:s=de.odUniOperator[t.operator],s==="like")l=l,l.indexOf("%")!==-1&&(l.charAt(0)==="%"&&l.lastIndexOf("%")<2?(l=l.substring(1,l.length),s=!g(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?de.odv4UniOperator.startswith:de.odUniOperator.startswith):l.charAt(l.length-1)==="%"&&l.indexOf("%")>l.length-3?(l=l.substring(0,l.length-1),s=!g(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?de.odv4UniOperator.endswith:de.odUniOperator.endswith):l.lastIndexOf("%")!==l.indexOf("%")&&l.lastIndexOf("%")>l.indexOf("%")+1?(l=l.substring(l.indexOf("%")+1,l.lastIndexOf("%")),s=!g(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?de.odv4UniOperator.contains:de.odUniOperator.contains):s=!g(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?de.odv4UniOperator.contains:de.odUniOperator.contains),l=encodeURIComponent(l),l="'"+l+"'";else if(s==="wildcard")if(l=l,l.indexOf("*")!==-1){var c=l.split("*"),d=void 0,p=0;if(l.indexOf("*")!==0&&c[0].indexOf("%3f")===-1&&c[0].indexOf("?")===-1&&(d=c[0],d="'"+d+"'",s=!g(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?de.odv4UniOperator.startswith:de.odUniOperator.startswith,n+=s+"(",n+=u+",",a&&(n+=a),n+=d+")",p++),l.lastIndexOf("*")!==l.length-1&&c[c.length-1].indexOf("%3f")===-1&&c[c.length-1].indexOf("?")===-1&&(d=c[c.length-1],d="'"+d+"'",s=!g(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?de.odv4UniOperator.endswith:de.odUniOperator.endswith,p>0&&(n+=" and "),n+=s+"(",n+=u+",",a&&(n+=a),n+=d+")",p++),c.length>2){for(var f=1;f<c.length-1;f++)if(c[f].indexOf("%3f")===-1&&c[f].indexOf("?")===-1){if(d=c[f],d="'"+d+"'",s=!g(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?de.odv4UniOperator.contains:de.odUniOperator.contains,p>0&&(n+=" and "),s==="substringof"||s==="not substringof"){var v=d;d=u,u=v}n+=s+"(",n+=u+",",a&&(n+=a),n+=d+")",p++}}p===0?(s=!g(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?de.odv4UniOperator.contains:de.odUniOperator.contains,(l.indexOf("?")!==-1||l.indexOf("%3f")!==-1)&&(l=l.indexOf("?")!==-1?l.split("?").join(""):l.split("%3f").join("")),l="'"+l+"'"):s="wildcard"}else s=!g(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?de.odv4UniOperator.contains:de.odUniOperator.contains,(l.indexOf("?")!==-1||l.indexOf("%3f")!==-1)&&(l=l.indexOf("?")!==-1?l.split("?").join(""):l.split("%3f").join("")),l="'"+l+"'";if(s==="substringof"||s==="not substringof"){var v=l;l=u,u=v}return s!=="wildcard"&&(n+=s+"(",n+=u+",",a&&(n+=a),n+=l+")"),n},e.prototype.addParams=function(t){o.prototype.addParams.call(this,t),delete t.reqParams.params},e.prototype.onComplexPredicate=function(t,i,r){for(var n=[],s=0;s<t.predicates.length;s++)n.push("("+this.onEachWhere(t.predicates[s],i,r)+")");return n.join(" "+t.condition+" ")},e.prototype.onEachWhere=function(t,i,r){return t.isComplex?this.onComplexPredicate(t,i,r):this.onPredicate(t,i,r)},e.prototype.onWhere=function(t){return this.pvt.search&&t.push(this.onEachWhere(this.pvt.search,null,!0)),t.join(" and ")},e.prototype.onEachSearch=function(t){t.fields&&t.fields.length===0&&de.throwError("Query() - Search : oData search requires list of field names to search");for(var i=this.pvt.search||[],r=0;r<t.fields.length;r++)i.push(new St(t.fields[r],t.operator,t.key,t.ignoreCase));this.pvt.search=i},e.prototype.onSearch=function(t){return this.pvt.search=St.or(this.pvt.search),""},e.prototype.onEachSort=function(t){var i=[];if(t.name instanceof Array)for(var r=0;r<t.name.length;r++)i.push(e.getField(t.name[r])+(t.direction==="descending"?" desc":""));else i.push(e.getField(t.name)+(t.direction==="descending"?" desc":""));return i.join(",")},e.prototype.onSortBy=function(t){return t.reverse().join(",")},e.prototype.onGroup=function(t){return this.pvt.groups=t,[]},e.prototype.onSelect=function(t){for(var i=0;i<t.length;i++)t[i]=e.getField(t[i]);return t.join(",")},e.prototype.onAggregates=function(t){return this.pvt.aggregates=t,""},e.prototype.onCount=function(t){return t===!0?"allpages":""},e.prototype.beforeSend=function(t,i,r){de.endsWith(r.url,this.options.batch)&&r.type.toLowerCase()==="post"?(i.headers.set("Accept",this.options.multipartAccept),i.headers.set("DataServiceVersion","2.0")):i.headers.set("Accept",this.options.accept),i.headers.set("DataServiceVersion","2.0"),i.headers.set("MaxDataServiceVersion","2.0")},e.prototype.processResponse=function(t,i,r,n,s,a){var l="odata.metadata";if(s&&s.type==="GET"&&!this.rootUrl&&t[l]){var h=t[l].split("/$metadata#");this.rootUrl=h[0],this.resourceTableName=h[1]}var u="pvtData";if(!g(t.d)){var c=r&&r.isCountRequired?t.d.results:t.d,d="__metadata";if(!g(c))for(var p=0;p<c.length;p++)g(c[p][d])||delete c[p][d]}var f=s&&s[u],v=this.processBatchResponse(t,r,n,s,a);if(v)return v;var m=n&&s.fetchRequest.headers.get("DataServiceVersion"),y=null,S=m&&parseInt(m,10)||2;if(r&&r.isCountRequired){var b="__count";(t[b]||t["odata.count"])&&(y=t[b]||t["odata.count"]),t.d&&(t=t.d),(t[b]||t["odata.count"])&&(y=t[b]||t["odata.count"])}S===3&&t.value&&(t=t.value),t.d&&(t=t.d),S<3&&t.results&&(t=t.results);var w={};return w.count=y,w.result=t,this.getAggregateResult(f,t,w,null,r),de.isNull(y)?w.result:{result:w.result,count:w.count,aggregates:w.aggregates}},e.prototype.convertToQueryString=function(t,i,r){var n=[],s="table",a=t[s]||"",l="$format";delete t[s],r.dataSource.requiresFormat&&(t[l]="json");for(var h=Object.keys(t),u=0,c=h;u<c.length;u++){var d=c[u];n.push(d+"="+t[d])}return n=n.join("&"),r.dataSource.url&&r.dataSource.url.indexOf("?")!==-1&&!a?n:n.length?a+"?"+n:a||""},e.prototype.localTimeReplacer=function(t,i){for(var r=0,n=g(i)?[]:Object.keys(i);r<n.length;r++){var s=n[r];i[s]instanceof Date&&(i[s]=de.dateParse.toLocalTime(i[s]))}return i},e.prototype.insert=function(t,i,r){return{url:(t.dataSource.insertUrl||t.dataSource.url).replace(/\/*$/,r?"/"+r:""),data:JSON.stringify(i,this.options.localTime?this.localTimeReplacer:null)}},e.prototype.remove=function(t,i,r,n){var s;return typeof r=="string"&&!de.parse.isGuid(r)?s="('"+r+"')":s="("+r+")",{type:"DELETE",url:(t.dataSource.removeUrl||t.dataSource.url).replace(/\/*$/,n?"/"+n:"")+s}},e.prototype.update=function(t,i,r,n,s,a){this.options.updateType==="PATCH"&&!g(a)&&(r=this.compareAndRemove(r,a,i));var l;return typeof r[i]=="string"&&!de.parse.isGuid(r[i])?l="('"+r[i]+"')":l="("+r[i]+")",{type:this.options.updateType,url:(t.dataSource.updateUrl||t.dataSource.url).replace(/\/*$/,n?"/"+n:"")+l,data:JSON.stringify(r,this.options.localTime?this.localTimeReplacer:null),accept:this.options.accept}},e.prototype.batchRequest=function(t,i,r,n,s){var a=r.guid=de.getGuid(this.options.batchPre),l=t.dataSource.batchUrl||this.rootUrl?(t.dataSource.batchUrl||this.rootUrl)+"/"+this.options.batch:(t.dataSource.batchUrl||t.dataSource.url).replace(/\/*$/,"/"+this.options.batch);r.url=this.resourceTableName?this.resourceTableName:r.url;var h={url:r.url,key:r.key,cid:1,cSet:de.getGuid(this.options.changeSet)},u="--"+a+`
`;return u+="Content-Type: multipart/mixed; boundary="+h.cSet.replace("--","")+`
`,this.pvt.changeSet=0,u+=this.generateInsertRequest(i.addedRecords,h,t),u+=this.generateUpdateRequest(i.changedRecords,h,t,s?s.changedRecords:[]),u+=this.generateDeleteRequest(i.deletedRecords,h,t),u+=h.cSet+`--
`,u+="--"+a+"--",{type:"POST",url:l,dataType:"json",contentType:"multipart/mixed; charset=UTF-8;boundary="+a,data:u}},e.prototype.generateDeleteRequest=function(t,i,r){if(!t)return"";var n="",s={method:"DELETE ",url:function(a,l,h){var u=de.getObject(h,a[l]);if(typeof u=="number"||de.parse.isGuid(u))return"("+u+")";if(u instanceof Date){var c=a[l][h];return"("+c.toJSON()+")"}else return"('"+u+"')"},data:function(a,l){return""}};return n=this.generateBodyContent(t,i,s,r),n+`
`},e.prototype.generateInsertRequest=function(t,i,r){if(!t)return"";var n="",s={method:"POST ",url:function(a,l,h){return""},data:function(a,l){return JSON.stringify(a[l])+`

`}};return n=this.generateBodyContent(t,i,s,r),n},e.prototype.generateUpdateRequest=function(t,i,r,n){var s=this;if(!t)return"";var a="";t.forEach(function(h){return h=s.compareAndRemove(h,n.filter(function(u){return de.getObject(i.key,u)===de.getObject(i.key,h)})[0],i.key)});var l={method:this.options.updateType+" ",url:function(h,u,c){if(typeof h[u][c]=="number"||de.parse.isGuid(h[u][c]))return"("+h[u][c]+")";if(h[u][c]instanceof Date){var d=h[u][c];return"("+d.toJSON()+")"}else return"('"+h[u][c]+"')"},data:function(h,u){return JSON.stringify(h[u])+`

`}};return a=this.generateBodyContent(t,i,l,r),a},e.getField=function(t){return t.replace(/\./g,"/")},e.prototype.generateBodyContent=function(t,i,r,n){for(var s="",a=0;a<t.length;a++)s+=`
`+i.cSet+`
`,s+=this.options.changeSetContent+`

`,s+=r.method,r.method==="POST "?s+=(n.dataSource.insertUrl||n.dataSource.crudUrl||i.url)+r.url(t,a,i.key)+` HTTP/1.1
`:r.method==="PUT "||r.method==="PATCH "?s+=(n.dataSource.updateUrl||n.dataSource.crudUrl||i.url)+r.url(t,a,i.key)+` HTTP/1.1
`:r.method==="DELETE "&&(s+=(n.dataSource.removeUrl||n.dataSource.crudUrl||i.url)+r.url(t,a,i.key)+` HTTP/1.1
`),s+="Accept: "+this.options.accept+`
`,s+="Content-Id: "+this.pvt.changeSet+++`
`,s+=this.options.batchChangeSetContentType+`
`,g(t[a]["@odata.etag"])?s+=`
`:(s+="If-Match: "+t[a]["@odata.etag"]+`

`,delete t[a]["@odata.etag"]),s+=r.data(t,a);return s},e.prototype.processBatchResponse=function(t,i,r,n,s){if(r&&r.headers.get("Content-Type")&&r.headers.get("Content-Type").indexOf("xml")!==-1)return i.isCountRequired?{result:[],count:0}:[];if(n&&this.options.batch&&de.endsWith(n.url,this.options.batch)&&n.type.toLowerCase()==="post"){var a=r.headers.get("Content-Type"),l=void 0,h=void 0,u=t+"";if(a=a.substring(a.indexOf("=batchresponse")+1),u=u.split(a),u.length<2)return{};u=u[1];var c=/(?:\bContent-Type.+boundary=)(changesetresponse.+)/i.exec(u);c&&u.replace(c[0],"");var d=c?c[1]:"";u=u.split(d);for(var p=u.length;p>-1;p--)!/\bContent-ID:/i.test(u[p])||!/\bHTTP.+201/.test(u[p])||(l=parseInt(/\bContent-ID: (\d+)/i.exec(u[p])[1],10),s.addedRecords[l]&&(h=de.parse.parseJson(/^\{.+\}/m.exec(u[p])[0]),he({},s.addedRecords[l],this.processResponse(h))));return s}return null},e.prototype.compareAndRemove=function(t,i,r){var n=this;return g(i)||Object.keys(t).forEach(function(s){if(s!==r&&s!=="@odata.etag")if(de.isPlainObject(t[s])){n.compareAndRemove(t[s],i[s]);var a=Object.keys(t[s]).filter(function(l){return l!=="@odata.etag"});a.length===0&&delete t[s]}else(t[s]===i[s]||t[s]&&i[s]&&t[s].valueOf()===i[s].valueOf())&&delete t[s]}),t},e}(Al);var kA=function(o){nc(e,o);function e(){var t=o.call(this)||this;return Ge("beforeSend",Al.prototype.beforeSend,t),t}return e.prototype.insert=function(t,i,r,n,s){return this.pvt.position=s,this.updateType="add",{url:t.dataSource.insertUrl||t.dataSource.crudUrl||t.dataSource.url,data:JSON.stringify(he({},{value:i,table:r,action:"insert"},de.getAddParams(this,t,n)))}},e.prototype.remove=function(t,i,r,n,s){return o.prototype.remove.call(this,t,i,r),{type:"POST",url:t.dataSource.removeUrl||t.dataSource.crudUrl||t.dataSource.url,data:JSON.stringify(he({},{key:r,keyColumn:i,table:n,action:"remove"},de.getAddParams(this,t,s)))}},e.prototype.update=function(t,i,r,n,s){return this.updateType="update",this.updateKey=i,{type:"POST",url:t.dataSource.updateUrl||t.dataSource.crudUrl||t.dataSource.url,data:JSON.stringify(he({},{value:r,action:"update",keyColumn:i,key:r[i],table:n},de.getAddParams(this,t,s)))}},e.prototype.processResponse=function(t,i,r,n,s,a,l){var h,u=s?JSON.parse(s.data):t;if(t=u.action==="batch"?de.parse.parseJson(t):t,this.updateType==="add"&&o.prototype.insert.call(this,i,t,null,null,this.pvt.position),this.updateType==="update"&&o.prototype.update.call(this,i,this.updateKey,t),this.updateType=void 0,t.added)for(h=0;h<t.added.length;h++)o.prototype.insert.call(this,i,t.added[h]);if(t.changed)for(h=0;h<t.changed.length;h++)o.prototype.update.call(this,i,l.key,t.changed[h]);if(t.deleted)for(h=0;h<t.deleted.length;h++)o.prototype.remove.call(this,i,l.key,t.deleted[h]);return t},e.prototype.batchRequest=function(t,i,r,n,s){return{type:"POST",url:t.dataSource.batchUrl||t.dataSource.crudUrl||t.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(he({},{changed:i.changedRecords,added:i.addedRecords,deleted:i.deletedRecords,action:"batch",table:r.url,key:r.key},de.getAddParams(this,t,n)))}},e.prototype.addParams=function(t){var i=new Al;i.addParams(t)},e}(np),B3=function(o){nc(e,o);function e(t){var i=o.call(this)||this;return i.options=he({},i.options,{getData:function(){},addRecord:function(){},updateRecord:function(){},deleteRecord:function(){},batchUpdate:function(){}}),he(i.options,t||{}),i}return e.prototype.getModuleName=function(){return"CustomDataAdaptor"},e}(Al);var z3=function(o){nc(e,o);function e(t,i,r){var n=o.call(this)||this;n.isCrudAction=!1,n.isInsertAction=!1,g(t)||(n.cacheAdaptor=t),n.pageSize=r,n.guidId=de.getGuid("cacheAdaptor");var s={keys:[],results:[]};window.localStorage.setItem(n.guidId,JSON.stringify(s));var a=n.guidId;return g(i)||setInterval(function(){for(var l=de.parse.parseJson(window.localStorage.getItem(a)),h=[],u=0;u<l.results.length;u++){var c=+new Date,d=+new Date(l.results[u].timeStamp);l.results[u].timeStamp=c-d,c-d>i&&h.push(u)}for(var u=0;u<h.length;u++)l.results.splice(h[u],1),l.keys.splice(h[u],1);window.localStorage.removeItem(a),window.localStorage.setItem(a,JSON.stringify(l))},i),n}return e.prototype.generateKey=function(t,i){var r=this.getQueryRequest(i),n=Pe.filterQueryLists(i.queries,["onSelect","onPage","onSkip","onTake","onRange"]),s=t,a="onPage";a in n&&(s+=n[a].pageIndex),r.sorts.forEach(function(d){s+=d.e.direction+d.e.fieldName}),r.groups.forEach(function(d){s+=d.e.fieldName}),r.searches.forEach(function(d){s+=d.e.searchKey});for(var l=0;l<r.filters.length;l++){var h=r.filters[l];if(h.e.isComplex){var u=i.clone();u.queries=[];for(var c=0;c<h.e.predicates.length;c++)u.queries.push({fn:"onWhere",e:h.e.predicates[c],filter:i.queries.filter});s+=h.e.condition+this.generateKey(t,u)}else s+=h.e.field+h.e.operator+h.e.value}return s},e.prototype.processQuery=function(t,i,r){var n=this.generateKey(t.dataSource.url,i),s=de.parse.parseJson(window.localStorage.getItem(this.guidId)),a=s?s.results[s.keys.indexOf(n)]:null;return a!=null&&!this.isCrudAction&&!this.isInsertAction?a:(this.isCrudAction=null,this.isInsertAction=null,this.cacheAdaptor.processQuery.apply(this.cacheAdaptor,[].slice.call(arguments,0)))},e.prototype.processResponse=function(t,i,r,n,s,a){if(this.isInsertAction||s&&this.cacheAdaptor.options.batch&&de.endsWith(s.url,this.cacheAdaptor.options.batch)&&s.type.toLowerCase()==="post")return this.cacheAdaptor.processResponse(t,i,r,n,s,a);t=this.cacheAdaptor.processResponse.apply(this.cacheAdaptor,[].slice.call(arguments,0));var l=r?this.generateKey(i.dataSource.url,r):i.dataSource.url,h={};h=de.parse.parseJson(window.localStorage.getItem(this.guidId));var u=h.keys.indexOf(l);for(u!==-1&&(h.results.splice(u,1),h.keys.splice(u,1)),h.results[h.keys.push(l)-1]={keys:l,result:t.result,timeStamp:new Date,count:t.count};h.results.length>this.pageSize;)h.results.splice(0,1),h.keys.splice(0,1);return window.localStorage.setItem(this.guidId,JSON.stringify(h)),t},e.prototype.beforeSend=function(t,i,r){!g(this.cacheAdaptor.options.batch)&&de.endsWith(r.url,this.cacheAdaptor.options.batch)&&r.type.toLowerCase()==="post"&&i.headers.set("Accept",this.cacheAdaptor.options.multipartAccept),t.dataSource.crossDomain||i.headers.set("Accept",this.cacheAdaptor.options.accept)},e.prototype.update=function(t,i,r,n){return this.isCrudAction=!0,this.cacheAdaptor.update(t,i,r,n)},e.prototype.insert=function(t,i,r){return this.isInsertAction=!0,this.cacheAdaptor.insert(t,i,r)},e.prototype.remove=function(t,i,r,n){return this.isCrudAction=!0,this.cacheAdaptor.remove(t,i,r,n)},e.prototype.batchRequest=function(t,i,r){return this.cacheAdaptor.batchRequest(t,i,r)},e}(Al),Wg=function(o,e,t,i){return new(t||(t=Promise))(function(r,n){function s(h){try{l(i.next(h))}catch(u){n(u)}}function a(h){try{l(i.throw(h))}catch(u){n(u)}}function l(h){h.done?r(h.value):new t(function(u){u(h.value)}).then(s,a)}l((i=i.apply(o,e||[])).next())})},qg=function(o,e){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,r,n,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(h){return function(u){return l([h,u])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,r&&(n=h[0]&2?r.return:h[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,h[1])).done)return n;switch(r=0,n&&(h=[h[0]&2,n.value]),h[0]){case 0:case 1:n=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,r=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!n||h[1]>n[0]&&h[1]<n[3])){t.label=h[1];break}if(h[0]===6&&t.label<n[1]){t.label=n[1],n=h;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(h);break}n[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(o,t)}catch(u){h=[6,u],r=0}finally{i=n=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},re=function(){function o(e,t,i){var r=this;this.dateParse=!0,this.timeZoneHandling=!0,this.persistQuery={},this.isInitialLoad=!1,this.requests=[],this.isEnableCache=!1,this.isInitialLoad=!0,this.isEnableCache=!1,!e&&!this.dataSource&&(e=[]),i=i||e.adaptor,e&&e.timeZoneHandling===!1&&(this.timeZoneHandling=e.timeZoneHandling);var n;if(e instanceof Array?n={json:e,offline:!0}:typeof e=="object"?(e.json||(e.json=[]),e.enablePersistence||(e.enablePersistence=!1),e.id||(e.id=""),e.ignoreOnPersist||(e.ignoreOnPersist=[]),n={url:e.url,insertUrl:e.insertUrl,removeUrl:e.removeUrl,updateUrl:e.updateUrl,crudUrl:e.crudUrl,batchUrl:e.batchUrl,json:e.json,headers:e.headers,accept:e.accept,data:e.data,enableCache:e.enableCache,timeTillExpiration:e.timeTillExpiration,cachingPageSize:e.cachingPageSize,enableCaching:e.enableCaching,requestType:e.requestType,key:e.key,crossDomain:e.crossDomain,jsonp:e.jsonp,dataType:e.dataType,offline:e.offline!==void 0?e.offline:e.adaptor instanceof kA||e.adaptor instanceof B3?!1:!e.url,requiresFormat:e.requiresFormat,enablePersistence:e.enablePersistence,id:e.id,ignoreOnPersist:e.ignoreOnPersist}):de.throwError("DataManager: Invalid arguments"),n.requiresFormat===void 0&&!de.isCors()&&(n.requiresFormat=g(n.crossDomain)?!0:n.crossDomain),n.dataType===void 0&&(n.dataType="json"),this.isEnableCache=n.enableCache,this.dataSource=n,this.defaultQuery=t,this.dataSource.enablePersistence&&this.dataSource.id&&window.addEventListener("unload",this.setPersistData.bind(this)),n.url&&n.offline&&!n.json.length?(this.isDataAvailable=!1,this.adaptor=i||new rp,this.dataSource.offline=!1,this.ready=this.executeQuery(t||new Pe),this.ready.then(function(a){r.dataSource.offline=!0,r.isDataAvailable=!0,n.json=a.result,r.adaptor=new np})):this.adaptor=n.offline?new np:new rp,!n.jsonp&&this.adaptor instanceof rp&&(n.jsonp="callback"),this.adaptor=i||this.adaptor,this.isEnableCache){this.guidId=de.getGuid("cacheAdaptor");var s={keys:[],results:[]};window.localStorage.setItem(this.guidId,JSON.stringify(s))}return n.enableCaching&&(this.adaptor=new z3(this.adaptor,n.timeTillExpiration,n.cachingPageSize)),this}return Object.defineProperty(o.prototype,"moduleName",{get:function(){return"datamanager"},enumerable:!0,configurable:!0}),o.prototype.getPersistedData=function(e){var t=localStorage.getItem(e||this.dataSource.id);return JSON.parse(t)},o.prototype.setPersistData=function(e,t,i){localStorage.setItem(t||this.dataSource.id,JSON.stringify(i||this.persistQuery))},o.prototype.setPersistQuery=function(e){var t=this,i=this.getPersistedData();if(this.isInitialLoad&&i&&Object.keys(i).length){this.persistQuery=i,this.persistQuery.queries=this.persistQuery.queries.filter(function(n){if(t.dataSource.ignoreOnPersist&&t.dataSource.ignoreOnPersist.length&&n.fn&&t.dataSource.ignoreOnPersist.some(function(l){return n.fn===l}))return!1;if(n.fn==="onWhere"){var s=n.e;if(s&&s.isComplex&&s.predicates instanceof Array){var a=s.predicates.map(function(l){if(l.predicates&&l.predicates instanceof Array){var h=l.predicates.map(function(m){var y=m.field,S=m.operator,b=m.value,w=m.ignoreCase,I=m.ignoreAccent,x=m.matchCase;return new St(y,S,b,w,I,x)});return l.condition==="and"?St.and(h):St.or(h)}else{var u=l.field,c=l.operator,d=l.value,p=l.ignoreCase,f=l.ignoreAccent,v=l.matchCase;return new St(u,c,d,p,f,v)}});n.e=new St(a[0],s.condition,a.slice(1))}}return!0});var r=he(new Pe,this.persistQuery);return this.isInitialLoad=!1,r}else return this.persistQuery=e,this.isInitialLoad=!1,e},o.prototype.setDefaultQuery=function(e){return this.defaultQuery=e,this},o.prototype.executeLocal=function(e){!this.defaultQuery&&!(e instanceof Pe)&&de.throwError("DataManager - executeLocal() : A query is required to execute"),this.dataSource.json||de.throwError("DataManager - executeLocal() : Json data is required to execute"),this.dataSource.enablePersistence&&this.dataSource.id&&(e=this.setPersistQuery(e)),e=e||this.defaultQuery;var t=this.adaptor.processQuery(this,e);if(e.subQuery){var i=e.subQuery.fromTable,r=e.subQuery.lookups,n=e.isCountRequired?t.result:t;r&&r instanceof Array&&de.buildHierarchy(e.subQuery.fKey,i,n,r,e.subQuery.key);for(var s=0;s<n.length;s++)n[s][i]instanceof Array&&(n[s]=he({},{},n[s]),n[s][i]=this.adaptor.processResponse(e.subQuery.using(new o(n[s][i].slice(0))).executeLocal(),this,e))}return this.adaptor.processResponse(t,this,e)},o.prototype.executeQuery=function(e,t,i,r){var n=this,s="makeRequest";this.dataSource.enablePersistence&&this.dataSource.id&&(e=this.setPersistQuery(e)),typeof e=="function"&&(r=i,i=t,t=e,e=null),e||(e=this.defaultQuery),e instanceof Pe||de.throwError("DataManager - executeQuery() : A query is required to execute");var a=new kn,l={query:e};if(!this.dataSource.offline&&this.dataSource.url!==void 0&&this.dataSource.url!==""||!g(this.adaptor[s])||this.isCustomDataAdaptor(this.adaptor)){var h=this.isEnableCache?this.processQuery(e):this.adaptor.processQuery(this,e);g(this.adaptor[s])?!g(h.url)||this.isCustomDataAdaptor(this.adaptor)?(this.requests=[],this.makeRequest(h,a,l,e)):(l=o.getDeferedArgs(e,h,l),a.resolve(l)):this.adaptor[s](h,a,l,e)}else o.nextTick(function(){var u=n.executeLocal(e);l=o.getDeferedArgs(e,u,l),a.resolve(l)});return(t||i)&&a.promise.then(t,i),r&&a.promise.then(r,r),a.promise},o.prototype.getQueryRequest=function(e){var t={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};return t.sorts=Pe.filterQueries(e.queries,"onSortBy"),t.groups=Pe.filterQueries(e.queries,"onGroup"),t.filters=Pe.filterQueries(e.queries,"onWhere"),t.searches=Pe.filterQueries(e.queries,"onSearch"),t.aggregates=Pe.filterQueries(e.queries,"onAggregates"),t},o.prototype.generateKey=function(e,t){var i=this.getQueryRequest(t),r=Pe.filterQueryLists(t.queries,["onSelect","onPage","onSkip","onTake","onRange"]),n=e,s="onPage";i.sorts.forEach(function(d){n+=d.e.direction+d.e.fieldName}),i.groups.forEach(function(d){n+=d.e.fieldName}),i.searches.forEach(function(d){n+=d.e.searchKey});for(var a=0;a<i.filters.length;a++){var l=i.filters[a];if(l.e.isComplex){var h=t.clone();h.queries=[];for(var u=0;u<l.e.predicates.length;u++)h.queries.push({fn:"onWhere",e:l.e.predicates[u],filter:t.queries.filter});n+=l.e.condition+this.generateKey(e,h)}else n+=l.e.field+l.e.operator+l.e.value}if(!g(this.previousCacheQuery)&&this.previousCacheQuery!==n){var c={keys:[],results:[]};window.localStorage.setItem(this.guidId,JSON.stringify(c))}return this.previousCacheQuery=n,s in r&&(n+=r[s].pageIndex),n},o.prototype.processQuery=function(e){var t=this.generateKey(this.dataSource.url,e),i=JSON.parse(window.localStorage.getItem(this.guidId)),r=i?i.results[i.keys.indexOf(t)]:null;return r!=null?de.parse.parseJson(r):this.adaptor.processQuery(this,e)},o.getDeferedArgs=function(e,t,i){return e.isCountRequired?(i.result=t.result,i.count=t.count,i.aggregates=t.aggregates):i.result=t,i},o.nextTick=function(e){(window.setImmediate||window.setTimeout)(e,0)},o.prototype.extendRequest=function(e,t,i){return he({},{type:"GET",dataType:this.dataSource.dataType,crossDomain:this.dataSource.crossDomain,jsonp:this.dataSource.jsonp,cache:!0,processData:!1,onSuccess:t,onFailure:i},e)},o.prototype.makeRequest=function(e,t,i,r){var n=this,s=!!r.subQuerySelector,a=function(m){i.error=m,t.reject(i)},l=function(m,y,S,b,w,I,x){i.xhr=S,i.count=y?parseInt(y.toString(),10):0,i.result=m,i.request=b,i.aggregates=I,i.actual=w,i.virtualSelectRecords=x,t.resolve(i)},h=function(m,y){var S=new kn,b={parent:i};r.subQuery.isChild=!0;var w=n.adaptor.processQuery(n,r.subQuery,m?n.adaptor.processResponse(m):y),I=n.makeRequest(w,S,b,r.subQuery);return s||S.then(function(x){m&&(de.buildHierarchy(r.subQuery.fKey,r.subQuery.fromTable,m,x,r.subQuery.key),l(m,x.count,x.xhr))},a),I},u=function(m,y){if(n.isGraphQLAdaptor(n.adaptor)&&!g(m.errors))return a(m.errors);n.isCustomDataAdaptor(n.adaptor)&&(y=he({},n.fetchReqOption,y)),y.contentType.indexOf("xml")===-1&&n.dateParse&&!n.isEnableCache&&(m=de.parse.parseJson(m));var S,b=n.afterReponseRequest(m);b.then(function(w){if(S=n.adaptor.processResponse(w,n,r,y.fetchRequest,y),n.isEnableCache){var I=r?n.generateKey(n.dataSource.url,r):n.dataSource.url,x={};x=JSON.parse(window.localStorage.getItem(n.guidId));var M=x.keys.indexOf(I);M!==-1&&(x.results.splice(M,1),x.keys.splice(M,1)),x.results[x.keys.push(I)-1]={keys:I,result:S.result,timeStamp:new Date,count:S.count},window.localStorage.setItem(n.guidId,JSON.stringify(x))}y.contentType.indexOf("xml")===-1&&n.dateParse&&n.isEnableCache&&(S=de.parse.parseJson(S));var D=0,A=null,L="virtualSelectRecords",T=w[L];if(r.isCountRequired&&(D=S.count,A=S.aggregates,S=S.result),!r.subQuery){l(S,D,y.fetchRequest,y.type,w,A,T);return}s||h(S,y)}).catch(function(w){return a(y)})},c=this.extendRequest(e,u,a);if(this.isCustomDataAdaptor(this.adaptor)){this.fetchReqOption=c;var f=c;this.adaptor.options.getData({data:f.data,onSuccess:f.onSuccess,onFailure:f.onFailure})}else{var d=this.useMiddleware(c),p;d.then(function(m){p=new jg(c),p.beforeSend=function(){n.beforeSend(p.fetchRequest,p,m)},c=p.send(),c.catch(function(y){return!0}),n.requests.push(p)}).catch(function(m){return a(c)})}if(s){var d=void 0,v=r.subQuerySelector.call(this,{query:r.subQuery,parent:r});v&&v.length?(d=Promise.all([c,h(null,v)]),d.then(function(){for(var y=[],S=0;S<arguments.length;S++)y[S]=arguments[S];var b=y[0],w=n.adaptor.processResponse(b[0],n,r,n.requests[0].fetchRequest,n.requests[0]),I=0;r.isCountRequired&&(I=w.count,w=w.result);var x=n.adaptor.processResponse(b[1],n,r.subQuery,n.requests[1].fetchRequest,n.requests[1]);I=0,r.subQuery.isCountRequired&&(I=x.count,x=x.result),de.buildHierarchy(r.subQuery.fKey,r.subQuery.fromTable,w,x,r.subQuery.key),s=!1,l(w,I,n.requests[0].fetchRequest)})):s=!1}return c},o.prototype.afterReponseRequest=function(e){return Wg(this,void 0,void 0,function(){var t,i;return qg(this,function(r){switch(r.label){case 0:return[4,this.applyPostRequestMiddlewares(e)];case 1:return t=r.sent(),i=new kn,i.resolve(t),[2,i.promise]}})})},o.prototype.applyPostRequestMiddlewares=function(e){return Wg(this,void 0,void 0,function(){return qg(this,function(t){return[2,e]})})},o.prototype.useMiddleware=function(e){return Wg(this,void 0,void 0,function(){var t,i;return qg(this,function(r){switch(r.label){case 0:return[4,this.applyPreRequestMiddlewares(e)];case 1:return t=r.sent(),i=new kn,i.resolve(t),[2,i.promise]}})})},o.prototype.applyPreRequestMiddlewares=function(e){return Wg(this,void 0,void 0,function(){return qg(this,function(t){return[2,e]})})},o.prototype.beforeSend=function(e,t,i){this.adaptor.beforeSend(this,e,t);var r=[];this.dataSource.headers&&(r=r.concat(this.dataSource.headers));var n;i&&i.headers&&(r=r.concat(i.headers));for(var s=0;r&&s<r.length;s++){n=[];for(var a=Object.keys(r[s]),l=0,h=a;l<h.length;l++){var u=h[l];n.push(u),e.headers.set(u,r[s][u])}}},o.prototype.saveChanges=function(e,t,i,r,n){var s=this;i instanceof Pe&&(r=i,i=null);var a={url:i,key:t||this.dataSource.key},l=this.adaptor.batchRequest(this,e,a,r||new Pe,n),h="dofetchRequest";if(this.dataSource.offline)return l;if(g(this.adaptor[h])){if(this.isCustomDataAdaptor(this.adaptor))return this.dofetchRequest(l,this.adaptor.options.batchUpdate,e);var u=new kn,c=new jg(l);return c.beforeSend=function(){s.beforeSend(c.fetchRequest,c)},c.onSuccess=function(d,p){s.isGraphQLAdaptor(s.adaptor)&&(g(d.errors)||c.onFailure(JSON.stringify(d.errors))),u.resolve(s.adaptor.processResponse(d,s,null,p.fetchRequest,p,e,a))},c.onFailure=function(d){u.reject([{error:d}])},c.send().catch(function(d){return!0}),u.promise}else return this.adaptor[h](l)},o.prototype.insert=function(e,t,i,r){t instanceof Pe&&(i=t,t=null);var n=this.adaptor.insert(this,e,t,i,r),s="dofetchRequest";return this.dataSource.offline?n:g(this.adaptor[s])?this.dofetchRequest(n,this.adaptor.options.addRecord):this.adaptor[s](n)},o.prototype.remove=function(e,t,i,r){typeof t=="object"&&(t=de.getObject(e,t)),i instanceof Pe&&(r=i,i=null);var n=this.adaptor.remove(this,e,t,i,r),s="dofetchRequest";if(this.dataSource.offline)return n;if(g(this.adaptor[s])){var a=this.adaptor.options.deleteRecord;return this.dofetchRequest(n,a)}else return this.adaptor[s](n)},o.prototype.update=function(e,t,i,r,n){i instanceof Pe&&(r=i,i=null),this.isEnableCache&&(this.cacheQuery=this.generateKey(this.dataSource.url,r));var s=this.adaptor.update(this,e,t,i,r,n),a="dofetchRequest";if(this.dataSource.offline)return s;if(g(this.adaptor[a])){var l=this.adaptor.options.updateRecord;return this.dofetchRequest(s,l)}else return this.adaptor[a](s)},o.prototype.isCustomDataAdaptor=function(e){return this.adaptor.getModuleName&&this.adaptor.getModuleName()==="CustomDataAdaptor"},o.prototype.isGraphQLAdaptor=function(e){return this.adaptor.getModuleName&&this.adaptor.getModuleName()==="GraphQLAdaptor"},o.prototype.successFunc=function(e,t,i){if(this.isGraphQLAdaptor(this.adaptor)){var r=typeof e=="object"?e:JSON.parse(e);g(r.errors)||this.failureFunc(JSON.stringify(r.errors))}this.isCustomDataAdaptor(this.adaptor)&&(t=he({},this.fetchReqOption,t));try{de.parse.parseJson(e)}catch{e=[]}if(this.isEnableCache){var n=JSON.parse(t.data);if(n.action==="insert"||n.action==="remove"){var s={keys:[],results:[]};window.localStorage.setItem(this.guidId,JSON.stringify(s))}else if(n.action==="update"){var a=JSON.parse(window.localStorage.getItem(this.guidId)),r=a?a.results[a.keys.indexOf(this.cacheQuery)]:null;if(r&&r.result){for(var l=r.result,h=0;h<l.length;h++)if(l[h][n.keyColumn]===n.key){l[h]=n.value,window.localStorage.setItem(this.guidId,JSON.stringify(a));break}}}}e=this.adaptor.processResponse(de.parse.parseJson(e),this,null,t.fetchRequest,t,i),this.fetchDeffered.resolve(e)},o.prototype.failureFunc=function(e){this.isEnableCache&&(this.cacheQuery=""),this.fetchDeffered.reject([{error:e}])},o.prototype.dofetchRequest=function(e,t,i){var r=this;if(e=he({},{type:"POST",contentType:"application/json; charset=utf-8",processData:!1},e),this.fetchDeffered=new kn,this.isCustomDataAdaptor(this.adaptor))this.fetchReqOption=e,t.call(this,{data:e.data,onSuccess:this.successFunc.bind(this),onFailure:this.failureFunc.bind(this),changes:i});else{var n=new jg(e);n.beforeSend=function(){r.beforeSend(n.fetchRequest,n)},n.onSuccess=this.successFunc.bind(this),n.onFailure=this.failureFunc.bind(this),n.send().catch(function(s){return!0})}return this.fetchDeffered.promise},o.prototype.clearPersistence=function(){window.removeEventListener("unload",this.setPersistData.bind(this)),this.dataSource.enablePersistence=!1,this.persistQuery={},window.localStorage.setItem(this.dataSource.id,"[]")},o}(),kn=function(){function o(){var e=this;this.promise=new Promise(function(t,i){e.resolve=t,e.reject=i}),this.then=this.promise.then.bind(this.promise),this.catch=this.promise.catch.bind(this.promise)}return o}();function FA(o,e,t,i,r,n){var s=i;if(i.tagName===e){var a=V("ej2_instances",i);s=o("input",{attrs:{type:t}});for(var l=["change","cssClass","label","labelPosition","id"],h=0,u=i.attributes.length;h<u;h++)l.indexOf(i.attributes[h].nodeName)===-1&&s.setAttribute(i.attributes[h].nodeName,i.attributes[h].nodeValue);Ie(i,{class:r}),i.appendChild(s),i.classList.add(n),i.classList.remove(n),Ge("ej2_instances",a,s),ip(i,"ej2_instances")}return s}function j3(o){for(var e,t=o.childNodes,i=0;i<t.length;i++)if(e=t[i],e.nodeType===3)return e;return null}function Uo(o,e,t){e===void 0&&(e=!1),t===void 0&&(t={});var i=o("div",{className:"e-checkbox-wrapper e-css"});if(t.cssClass&&Y([i],t.cssClass.split(" ")),t.enableRtl&&i.classList.add("e-rtl"),e){var r=o("span",{className:"e-ripple-container"});Vi(r,{isCenterRipple:!0,duration:400}),i.appendChild(r)}var n=o("span",{className:"e-frame e-icons"});if(t.checked&&n.classList.add("e-check"),i.appendChild(n),t.label){var s=o("span",{className:"e-label"});t.disableHtmlEncode?s.textContent=t.label:s.innerHTML=t.label,i.appendChild(s)}return i}function Tl(o,e){if(e){var t=document.createEvent("MouseEvents");t.initEvent(o.type,!1,!0),e.dispatchEvent(t)}}function H3(o,e){o.element.getAttribute("ejs-for")&&e.appendChild(o.createElement("input",{attrs:{name:o.name||o.element.name,value:"false",type:"hidden"}}))}var V3=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Fa=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n};var GG=new Ju,Zs={RTL:"e-rtl",BUTTON:"e-btn",PRIMARY:"e-primary",ICONBTN:"e-icon-btn"},bn=function(o){V3(e,o);function e(t,i){return o.call(this,t,i)||this}return e.prototype.preRender=function(){},e.prototype.render=function(){this.initialize(),this.removeRippleEffect=Vi(this.element,{selector:"."+Zs.BUTTON}),this.renderComplete()},e.prototype.initialize=function(){if(this.cssClass&&Y([this.element],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.isPrimary&&this.element.classList.add(Zs.PRIMARY),!qe()||qe()&&this.getModuleName()!=="progress-btn"){if(this.content){var t=this.enableHtmlSanitizer?Bt.sanitize(this.content):this.content;this.element.innerHTML=t}this.setIconCss()}this.enableRtl&&this.element.classList.add(Zs.RTL),this.disabled?this.controlStatus(this.disabled):this.wireEvents()},e.prototype.controlStatus=function(t){this.element.disabled=t},e.prototype.setIconCss=function(){if(this.iconCss){var t=this.createElement("span",{className:"e-btn-icon "+this.iconCss});this.element.textContent.trim()?(t.classList.add("e-icon-"+this.iconPosition.toLowerCase()),(this.iconPosition==="Top"||this.iconPosition==="Bottom")&&this.element.classList.add("e-"+this.iconPosition.toLowerCase()+"-icon-btn")):this.element.classList.add(Zs.ICONBTN);var i=this.element.childNodes[0];i&&(this.iconPosition==="Left"||this.iconPosition==="Top")?this.element.insertBefore(t,i):this.element.appendChild(t)}},e.prototype.wireEvents=function(){this.isToggle&&E.add(this.element,"click",this.btnClickHandler,this)},e.prototype.unWireEvents=function(){this.isToggle&&E.remove(this.element,"click",this.btnClickHandler)},e.prototype.btnClickHandler=function(){this.element.classList.contains("e-active")?this.element.classList.remove("e-active"):this.element.classList.add("e-active")},e.prototype.destroy=function(){var t=[Zs.PRIMARY,Zs.RTL,Zs.ICONBTN,"e-success","e-info","e-danger","e-warning","e-flat","e-outline","e-small","e-bigger","e-active","e-round","e-top-icon-btn","e-bottom-icon-btn"];this.cssClass&&(t=t.concat(this.cssClass.split(/\s+/).filter(function(r){return r.length>0}))),o.prototype.destroy.call(this),K([this.element],t),this.element.getAttribute("class")||this.element.removeAttribute("class"),this.disabled&&this.element.removeAttribute("disabled"),this.content&&(this.element.innerHTML=this.element.innerHTML.replace(this.content,""));var i=this.element.querySelector("span.e-btn-icon");i&&ee(i),this.unWireEvents(),ka&&this.removeRippleEffect()},e.prototype.getModuleName=function(){return"btn"},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.Inject=function(){},e.prototype.onPropertyChanged=function(t,i){for(var r=this.element.querySelector("span.e-btn-icon"),n=0,s=Object.keys(t);n<s.length;n++){var a=s[n];switch(a){case"isPrimary":t.isPrimary?this.element.classList.add(Zs.PRIMARY):this.element.classList.remove(Zs.PRIMARY);break;case"disabled":this.controlStatus(t.disabled);break;case"iconCss":{r=this.element.querySelector("span.e-btn-icon"),r?t.iconCss?(r.className="e-btn-icon "+t.iconCss,this.element.textContent.trim()&&(this.iconPosition==="Left"?r.classList.add("e-icon-left"):r.classList.add("e-icon-right"))):ee(r):this.setIconCss();break}case"iconPosition":K([this.element],["e-top-icon-btn","e-bottom-icon-btn"]),r=this.element.querySelector("span.e-btn-icon"),r&&ee(r),this.setIconCss();break;case"cssClass":i.cssClass&&K([this.element],i.cssClass.split(/\s+/).filter(function(h){return h.length>0})),t.cssClass&&Y([this.element],t.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":t.enableRtl?this.element.classList.add(Zs.RTL):this.element.classList.remove(Zs.RTL);break;case"content":{var l=j3(this.element);l||this.element.classList.remove(Zs.ICONBTN),(!qe()||qe()&&!this.isServerRendered&&this.getModuleName()!=="progress-btn")&&(this.enableHtmlSanitizer&&(t.content=Bt.sanitize(t.content)),this.element.innerHTML=t.content,this.setIconCss());break}case"isToggle":t.isToggle?E.add(this.element,"click",this.btnClickHandler,this):(E.remove(this.element,"click",this.btnClickHandler),K([this.element],["e-active"]));break}}},e.prototype.click=function(){this.element.click()},e.prototype.focusIn=function(){this.element.focus()},Fa([C("Left")],e.prototype,"iconPosition",void 0),Fa([C("")],e.prototype,"iconCss",void 0),Fa([C(!1)],e.prototype,"disabled",void 0),Fa([C(!1)],e.prototype,"isPrimary",void 0),Fa([C("")],e.prototype,"cssClass",void 0),Fa([C("")],e.prototype,"content",void 0),Fa([C(!1)],e.prototype,"isToggle",void 0),Fa([C()],e.prototype,"locale",void 0),Fa([C(!0)],e.prototype,"enableHtmlSanitizer",void 0),Fa([q()],e.prototype,"created",void 0),e=Fa([bt],e),e}(Kt),_3=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ks=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},BS="e-check",NA="e-checkbox-disabled",sp="e-frame",zS="e-stop",jS="e-label",ap="e-ripple-container",HS="e-ripple-check",VS="e-ripple-stop",_S="e-rtl",US="e-checkbox-wrapper",U3=["title","class","style","disabled","readonly","name","value","id","tabindex","aria-label","required"],ea=function(o){_3(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.isFocused=!1,r.isMouseClick=!1,r.clickTriggered=!1,r.validCheck=!0,r.type="checkbox",r}return e.prototype.changeState=function(t,i,r){var n=this.getWrapper(),s=null,a=null;n&&(a=n.getElementsByClassName(sp)[0],ka&&(s=n.getElementsByClassName(ap)[0])),t==="check"?(a&&(a.classList.remove(zS),a.classList.add(BS)),s&&(s.classList.remove(VS),s.classList.add(HS)),this.element.checked=!0,(this.element.required||j(this.element,"form")&&j(this.element,"form").classList.contains("e-formvalidator"))&&this.validCheck&&!i&&r?(this.element.checked=!1,this.validCheck=!1):(this.element.required||j(this.element,"form")&&j(this.element,"form").classList.contains("e-formvalidator"))&&(this.validCheck=!0)):t==="uncheck"?(a&&K([a],[BS,zS]),s&&K([s],[HS,VS]),this.element.checked=!1,(this.element.required||j(this.element,"form")&&j(this.element,"form").classList.contains("e-formvalidator"))&&this.validCheck&&!i&&r?(this.element.checked=!0,this.validCheck=!1):(this.element.required||j(this.element,"form")&&j(this.element,"form").classList.contains("e-formvalidator"))&&(this.validCheck=!0)):(a&&(a.classList.remove(BS),a.classList.add(zS)),s&&(s.classList.remove(HS),s.classList.add(VS)),this.element.indeterminate=!0,this.indeterminate=!0)},e.prototype.clickHandler=function(t){if(t.target.tagName==="INPUT"&&this.clickTriggered){this.changeState(this.checked?"check":"uncheck"),this.clickTriggered=!1;return}(t.target.tagName==="SPAN"||t.target.tagName==="LABEL"||j(t.target,".e-label"))&&(this.clickTriggered=!0),this.isMouseClick&&(this.focusOutHandler(),this.isMouseClick=!1),this.indeterminate?(this.changeState(this.checked?"check":"uncheck",!1,!0),this.indeterminate=!1,this.element.indeterminate=!1):this.checked?(this.changeState("uncheck",!1,!0),this.checked=!1):(this.changeState("check",!1,!0),this.checked=!0);var i={checked:this.updateVueArrayModel(!1),event:t};this.trigger("change",i),t.stopPropagation()},e.prototype.destroy=function(){var t=this,i=this.getWrapper();o.prototype.destroy.call(this),this.wrapper&&(i=this.wrapper,this.disabled||this.unWireEvents(),this.tagName==="INPUT"?(this.getWrapper()&&i.parentNode&&i.parentNode.insertBefore(this.element,i),ee(i),this.element.checked=!1,this.indeterminate&&(this.element.indeterminate=!1),["name","value","disabled"].forEach(function(r){t.element.removeAttribute(r)})):(["class"].forEach(function(r){i.removeAttribute(r)}),i.innerHTML="",this.element=i,this.refreshing&&(["e-control","e-checkbox","e-lib"].forEach(function(r){t.element.classList.add(r)}),Ge("ej2_instances",[this],this.element))))},e.prototype.focusHandler=function(){this.isFocused=!0},e.prototype.focusOutHandler=function(){var t=this.getWrapper();t&&t.classList.remove("e-focus"),this.isFocused=!1},e.prototype.getModuleName=function(){return"checkbox"},e.prototype.getPersistData=function(){return this.addOnPersist(["checked","indeterminate"])},e.prototype.getWrapper=function(){return this.element&&this.element.parentElement?this.element.parentElement.parentElement:null},e.prototype.getLabel=function(){return this.element?this.element.parentElement:null},e.prototype.initialize=function(){g(this.initialCheckedValue)&&(this.initialCheckedValue=this.checked),this.name&&this.element.setAttribute("name",this.name),this.element.setAttribute("tabindex","0"),this.value&&(this.element.setAttribute("value",this.value),this.isVue&&typeof this.value=="boolean"&&this.value===!0&&this.setProperties({checked:!0},!0)),this.checked&&this.changeState("check",!0),this.indeterminate&&this.changeState(),this.disabled&&this.setDisabled()},e.prototype.initWrapper=function(){var t=this.element.parentElement;t.classList.contains(US)||(t=this.createElement("div",{className:US}),this.element.parentNode&&this.element.parentNode.insertBefore(t,this.element));var i=this.createElement("label",{attrs:{for:this.htmlAttributes.id?this.htmlAttributes.id:this.element.id}}),r=this.createElement("span",{className:"e-icons "+sp});if(t.classList.add("e-wrapper"),this.enableRtl&&t.classList.add(_S),this.cssClass&&Y([t],this.cssClass.replace(/\s+/g," ").trim().split(" ")),t.appendChild(i),i.appendChild(this.element),H3(this,i),i.appendChild(r),ka){var n=this.createElement("span",{className:ap});this.labelPosition==="Before"?i.appendChild(n):i.insertBefore(n,r),Vi(n,{duration:400,isCenterRipple:!0})}this.label&&this.setText(this.label)},e.prototype.keyUpHandler=function(){this.isFocused&&this.getWrapper().classList.add("e-focus")},e.prototype.labelMouseDownHandler=function(t){this.isMouseClick=!0;var i=this.getWrapper().getElementsByClassName(ap)[0];Tl(t,i)},e.prototype.labelMouseLeaveHandler=function(t){var i=this.getLabel().getElementsByClassName(ap)[0];if(i){for(var r=i.querySelectorAll(".e-ripple-element"),n=r.length-1;n>0;n--)i.removeChild(i.childNodes[n]);Tl(t,i)}},e.prototype.labelMouseUpHandler=function(t){this.isMouseClick=!0;var i=this.getWrapper().getElementsByClassName(ap)[0];if(i){for(var r=i.querySelectorAll(".e-ripple-element"),n=0;n<r.length-1;n++)i.removeChild(i.childNodes[n]);Tl(t,i)}},e.prototype.onPropertyChanged=function(t,i){for(var r=this.getWrapper(),n=0,s=Object.keys(t);n<s.length;n++){var a=s[n];switch(a){case"checked":this.indeterminate=!1,this.element.indeterminate=!1,this.changeState(t.checked?"check":"uncheck");break;case"indeterminate":t.indeterminate?this.changeState():(this.element.indeterminate=!1,this.changeState(this.checked?"check":"uncheck"));break;case"disabled":t.disabled?(this.setDisabled(),this.wrapper=this.getWrapper(),this.unWireEvents()):(this.element.disabled=!1,r.classList.remove(NA),r.setAttribute("aria-disabled","false"),this.wireEvents());break;case"cssClass":i.cssClass&&K([r],i.cssClass.split(/\s+/).filter(function(u){return u.length>0})),t.cssClass&&Y([r],t.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":t.enableRtl?r.classList.add(_S):r.classList.remove(_S);break;case"label":this.setText(t.label);break;case"labelPosition":{var l=r.getElementsByClassName(jS)[0],h=r.getElementsByTagName("label")[0];ee(l),t.labelPosition==="After"?h.appendChild(l):h.insertBefore(l,r.getElementsByClassName(sp)[0]);break}case"name":this.element.setAttribute("name",t.name);break;case"value":if(this.isVue&&typeof t.value=="object")break;this.element.setAttribute("value",t.value);break;case"htmlAttributes":this.updateHtmlAttributeToWrapper();break}}},e.prototype.preRender=function(){var t=this.element;this.tagName=this.element.tagName,t=FA(this.createElement,"EJS-CHECKBOX","checkbox",t,US,"checkbox"),this.element=t,this.element.getAttribute("type")!=="checkbox"&&this.element.setAttribute("type","checkbox"),this.element.id||(this.element.id=kt("e-"+this.getModuleName()))},e.prototype.render=function(){this.initWrapper(),this.initialize(),this.disabled||this.wireEvents(),this.updateHtmlAttributeToWrapper(),this.updateVueArrayModel(!0),this.renderComplete(),this.wrapper=this.getWrapper()},e.prototype.setDisabled=function(){var t=this.getWrapper();this.element.disabled=!0,t.classList.add(NA),t.setAttribute("aria-disabled","true")},e.prototype.setText=function(t){var i=this.getWrapper();if(i){var r=i.getElementsByClassName(jS)[0];if(r)r.innerHTML=this.enableHtmlSanitizer?Bt.sanitize(t):t;else{t=this.enableHtmlSanitizer?Bt.sanitize(t):t,r=this.createElement("span",{className:jS,innerHTML:t});var n=i.getElementsByTagName("label")[0];this.labelPosition==="Before"?n.insertBefore(r,i.getElementsByClassName(sp)[0]):n.appendChild(r)}}},e.prototype.changeHandler=function(t){t.stopPropagation()},e.prototype.formResetHandler=function(){this.checked=this.initialCheckedValue,this.element.checked=this.initialCheckedValue},e.prototype.unWireEvents=function(){var t=this.wrapper;E.remove(t,"click",this.clickHandler),E.remove(this.element,"keyup",this.keyUpHandler),E.remove(this.element,"focus",this.focusHandler),E.remove(this.element,"focusout",this.focusOutHandler);var i=t.getElementsByTagName("label")[0];i&&(E.remove(i,"mousedown",this.labelMouseDownHandler),E.remove(i,"mouseup",this.labelMouseUpHandler),E.remove(i,"mouseleave",this.labelMouseLeaveHandler));var r=j(this.element,"form");r&&E.remove(r,"reset",this.formResetHandler),this.tagName==="EJS-CHECKBOX"&&E.remove(this.element,"change",this.changeHandler)},e.prototype.wireEvents=function(){var t=this.getWrapper();E.add(t,"click",this.clickHandler,this),E.add(this.element,"keyup",this.keyUpHandler,this),E.add(this.element,"focus",this.focusHandler,this),E.add(this.element,"focusout",this.focusOutHandler,this);var i=t.getElementsByTagName("label")[0];E.add(i,"mousedown",this.labelMouseDownHandler,this),E.add(i,"mouseup",this.labelMouseUpHandler,this),E.add(i,"mouseleave",this.labelMouseLeaveHandler,this);var r=j(this.element,"form");r&&E.add(r,"reset",this.formResetHandler,this),this.tagName==="EJS-CHECKBOX"&&E.add(this.element,"change",this.changeHandler,this)},e.prototype.updateVueArrayModel=function(t){if(this.isVue&&typeof this.value=="object"){var i=this.element.value;if(i&&this.value)if(t)for(var r=0;r<this.value.length;r++)i===this.value[r]&&(this.changeState("check"),this.setProperties({checked:!0},!0));else{var n=this.value.indexOf(i);return this.checked?n<0&&this.value.push(i):n>-1&&this.value.splice(n,1),this.value}}return this.validCheck?this.element.checked:!this.element.checked},e.prototype.updateHtmlAttributeToWrapper=function(){if(!g(this.htmlAttributes))for(var t=0,i=Object.keys(this.htmlAttributes);t<i.length;t++){var r=i[t],n=this.getWrapper();if(U3.indexOf(r)>-1)if(r==="class")Y([n],this.htmlAttributes[""+r].split(" "));else if(r==="title")n.setAttribute(r,this.htmlAttributes[""+r]);else if(r==="style"){var s=this.getWrapper().getElementsByClassName(sp)[0];s.setAttribute(r,this.htmlAttributes[""+r])}else r==="disabled"?(this.htmlAttributes[""+r]==="true"&&this.setDisabled(),this.element.setAttribute(r,this.htmlAttributes[""+r])):this.element.setAttribute(r,this.htmlAttributes[""+r]);else n.setAttribute(r,this.htmlAttributes[""+r])}},e.prototype.click=function(){this.element.click()},e.prototype.focusIn=function(){this.element.focus()},ks([q()],e.prototype,"change",void 0),ks([q()],e.prototype,"created",void 0),ks([C(!1)],e.prototype,"checked",void 0),ks([C("")],e.prototype,"cssClass",void 0),ks([C(!1)],e.prototype,"disabled",void 0),ks([C(!1)],e.prototype,"indeterminate",void 0),ks([C("")],e.prototype,"label",void 0),ks([C("After")],e.prototype,"labelPosition",void 0),ks([C("")],e.prototype,"name",void 0),ks([C("")],e.prototype,"value",void 0),ks([C(!0)],e.prototype,"enableHtmlSanitizer",void 0),ks([C({})],e.prototype,"htmlAttributes",void 0),e=ks([bt],e),e}(Kt),W3=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Js=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},WS="e-label",Gg="e-ripple-container",qS="e-rtl",GS="e-radio-wrapper",q3=["title","class","style","disabled","readonly","name","value","id"],sc=function(o){W3(e,o);function e(i,r){var n=o.call(this,i,r)||this;return n.isFocused=!1,n.type="radio",n}t=e,e.prototype.changeHandler=function(i){this.checked=!0,this.dataBind();var r=this.element.getAttribute("value");r=this.isVue&&r?this.element.value:this.value;var n=typeof this.value;this.isVue&&n==="boolean"&&(r=r==="true"),this.trigger("change",{value:r,event:i}),this.isAngular&&i.stopPropagation()},e.prototype.updateChange=function(){for(var i,r,n=this.getRadioGroup(),s=0;s<n.length;s++)i=n[s],i!==this.element&&(r=fr(i,t),r.checked=!1,this.tagName==="EJS-RADIOBUTTON"&&(r.angularValue=this.value))},e.prototype.destroy=function(){var i=this,r=this.wrapper;o.prototype.destroy.call(this),r&&(this.disabled||this.unWireEvents(),this.tagName==="INPUT"?(r.parentNode&&r.parentNode.insertBefore(this.element,r),ee(r),this.element.checked=!1,["name","value","disabled"].forEach(function(n){i.element.removeAttribute(n)})):(["role","aria-checked","class"].forEach(function(n){r.removeAttribute(n)}),r.innerHTML="",this.element=this.wrapper,this.refreshing&&(["e-control","e-radio","e-lib"].forEach(function(n){i.element.classList.add(n)}),Ge("ej2_instances",[this],this.element))))},e.prototype.focusHandler=function(){this.isFocused=!0},e.prototype.focusOutHandler=function(){var i=this.getLabel();i&&i.classList.remove("e-focus")},e.prototype.getModuleName=function(){return"radio"},e.prototype.getSelectedValue=function(){for(var i,r=this.getRadioGroup(),n=0,s=r.length;n<s;n++)if(i=r[n],i.checked)return i.value;return""},e.prototype.getRadioGroup=function(){return document.querySelectorAll('input.e-radio[name="'+this.element.getAttribute("name")+'"]')},e.prototype.getPersistData=function(){return this.addOnPersist(["checked"])},e.prototype.getWrapper=function(){return this.element.parentElement?this.element.parentElement:null},e.prototype.getLabel=function(){return this.element.nextElementSibling?this.element.nextElementSibling:null},e.prototype.initialize=function(){g(this.initialCheckedValue)&&(this.initialCheckedValue=this.checked),this.initWrapper(),this.updateHtmlAttribute(),this.name&&this.element.setAttribute("name",this.name);var i=this.element.getAttribute("value"),r=typeof this.value;this.isVue&&r==="boolean"&&(i=i==="true"),(this.isVue?this.value&&r!=="boolean"&&!i:this.value)&&this.element.setAttribute("value",this.value),this.checked&&(this.element.checked=!0),this.disabled&&this.setDisabled()},e.prototype.initWrapper=function(){var i,r=this.element.parentElement;r.classList.contains(GS)||(r=this.createElement("div",{className:GS}),this.element.parentNode&&this.element.parentNode.insertBefore(r,this.element));var n=this.createElement("label",{attrs:{for:this.element.id}});r.appendChild(this.element),r.appendChild(n),ka&&(i=this.createElement("span",{className:Gg}),n.appendChild(i),Vi(i,{duration:400,isCenterRipple:!0})),r.classList.add("e-wrapper"),this.enableRtl&&n.classList.add(qS),this.cssClass&&Y([r],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.label&&this.setText(this.label)},e.prototype.keyUpHandler=function(){this.isFocused&&this.getLabel().classList.add("e-focus")},e.prototype.labelMouseDownHandler=function(i){var r=this.getLabel().getElementsByClassName(Gg)[0];Tl(i,r)},e.prototype.labelMouseLeaveHandler=function(i){var r=this.getLabel().getElementsByClassName(Gg)[0];if(r){for(var n=r.querySelectorAll(".e-ripple-element"),s=n.length-1;s>0;s--)r.removeChild(r.childNodes[s]);Tl(i,r)}},e.prototype.labelMouseUpHandler=function(i){var r=this.getLabel().getElementsByClassName(Gg)[0];if(r){for(var n=r.querySelectorAll(".e-ripple-element"),s=n.length-1;s>0;s--)r.removeChild(r.childNodes[s]);Tl(i,r)}},e.prototype.formResetHandler=function(){this.checked=this.initialCheckedValue,this.initialCheckedValue&&Ie(this.element,{checked:"true"})},e.prototype.onPropertyChanged=function(i,r){for(var n=this.getWrapper(),s=this.getLabel(),a=0,l=Object.keys(i);a<l.length;a++){var h=l[a];switch(h){case"checked":i.checked&&this.updateChange(),this.element.checked=i.checked;break;case"disabled":i.disabled?(this.setDisabled(),this.unWireEvents()):(this.element.disabled=!1,this.wireEvents());break;case"cssClass":r.cssClass&&K([n],r.cssClass.split(/\s+/).filter(function(c){return c.length>0})),i.cssClass&&Y([n],i.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":i.enableRtl?s.classList.add(qS):s.classList.remove(qS);break;case"label":this.setText(i.label);break;case"labelPosition":i.labelPosition==="Before"?s.classList.add("e-right"):s.classList.remove("e-right");break;case"name":this.element.setAttribute("name",i.name);break;case"value":var u=typeof this.htmlAttributes.value;if(!g(this.htmlAttributes)&&(this.htmlAttributes.value||u==="boolean"&&!this.htmlAttributes.value))break;this.element.setAttribute("value",i.value);break;case"htmlAttributes":this.updateHtmlAttribute();break}}},e.prototype.preRender=function(){var i=this.element;if(this.formElement=j(this.element,"form"),this.tagName=this.element.tagName,i=FA(this.createElement,"EJS-RADIOBUTTON","radio",i,GS,"radio"),this.element=i,this.element.getAttribute("type")!=="radio"&&this.element.setAttribute("type","radio"),this.element.id||(this.element.id=kt("e-"+this.getModuleName())),this.tagName==="EJS-RADIOBUTTON"){var r=this.element.getAttribute("formcontrolname");r&&(this.setProperties({name:r},!0),this.element.setAttribute("name",r))}},e.prototype.render=function(){this.initialize(),this.disabled||this.wireEvents(),this.renderComplete(),this.wrapper=this.getWrapper()},e.prototype.setDisabled=function(){this.element.disabled=!0},e.prototype.setText=function(i){var r=this.getLabel(),n=r.getElementsByClassName(WS)[0];n?n.textContent=i:(i=this.enableHtmlSanitizer?Bt.sanitize(i):i,n=this.createElement("span",{className:WS,innerHTML:i}),r.appendChild(n)),this.labelPosition==="Before"?this.getLabel().classList.add("e-right"):this.getLabel().classList.remove("e-right")},e.prototype.updateHtmlAttribute=function(){if(!g(this.htmlAttributes))for(var i=0,r=Object.keys(this.htmlAttributes);i<r.length;i++){var n=r[i],s=this.element.parentElement;q3.indexOf(n)>-1?n==="class"?Y([s],this.htmlAttributes[""+n].replace(/\s+/g," ").trim().split(" ")):n==="title"||n==="style"?s.setAttribute(n,this.htmlAttributes[""+n]):this.element.setAttribute(n,this.htmlAttributes[""+n]):s.setAttribute(n,this.htmlAttributes[""+n])}},e.prototype.unWireEvents=function(){var i=this.wrapper;E.remove(this.element,"change",this.changeHandler),E.remove(this.element,"focus",this.focusHandler),E.remove(this.element,"focusout",this.focusOutHandler),E.remove(this.element,"keyup",this.keyUpHandler);var r=i.getElementsByTagName("label")[0];r&&(E.remove(r,"mousedown",this.labelMouseDownHandler),E.remove(r,"mouseup",this.labelMouseUpHandler),E.remove(r,"mouseleave",this.labelMouseLeaveHandler)),this.formElement&&E.remove(this.formElement,"reset",this.formResetHandler)},e.prototype.wireEvents=function(){var i=this.getLabel();E.add(this.element,"change",this.changeHandler,this),E.add(this.element,"keyup",this.keyUpHandler,this),E.add(this.element,"focus",this.focusHandler,this),E.add(this.element,"focusout",this.focusOutHandler,this);var r=i.getElementsByClassName(WS)[0];r&&(E.add(r,"mousedown",this.labelMouseDownHandler,this),E.add(r,"mouseup",this.labelMouseUpHandler,this),E.add(r,"mouseleave",this.labelMouseLeaveHandler,this)),this.formElement&&E.add(this.formElement,"reset",this.formResetHandler,this)},e.prototype.click=function(){this.element.click()},e.prototype.focusIn=function(){this.element.focus()};var t;return Js([q()],e.prototype,"change",void 0),Js([q()],e.prototype,"created",void 0),Js([C(!1)],e.prototype,"checked",void 0),Js([C("")],e.prototype,"cssClass",void 0),Js([C(!1)],e.prototype,"disabled",void 0),Js([C("")],e.prototype,"label",void 0),Js([C("After")],e.prototype,"labelPosition",void 0),Js([C("")],e.prototype,"name",void 0),Js([C("")],e.prototype,"value",void 0),Js([C(!0)],e.prototype,"enableHtmlSanitizer",void 0),Js([C({})],e.prototype,"htmlAttributes",void 0),e=t=Js([bt],e),e}(Kt);var uo,Ll,Ns,up,mC=!1;function lv(o,e){var t=!1,i={left:0,top:0},r=o;if(!o||!e)return i;for(g(e.offsetParent)&&e.style.position==="fixed"&&(t=!0);(e.offsetParent||t)&&o&&e.offsetParent!==o;)i.left+=o.offsetLeft,i.top+=o.offsetTop,o=o.offsetParent;for(o=r;(e.offsetParent||t)&&o&&e.offsetParent!==o;)i.left-=o.scrollLeft,i.top-=o.scrollTop,o=o.parentElement;return i}function br(o,e,t,i,r){if(Ll=void 0,Ll=r,mC=!!i,!o)return{left:0,top:0};e||(e="left"),t||(t="top"),up=o.ownerDocument,Ns=o;var n={left:0,top:0};return G3(e.toLowerCase(),t.toLowerCase(),n)}function Wo(o,e){e.left=o}function qo(o,e){e.top=o}function G3(o,e,t){switch(uo=Ns.getBoundingClientRect(),e+o){case"topcenter":Wo($S(),t),qo(Jg(),t);break;case"topright":Wo(XS(),t),qo(Jg(),t);break;case"centercenter":Wo($S(),t),qo(QS(),t);break;case"centerright":Wo(XS(),t),qo(QS(),t);break;case"centerleft":Wo(ev(),t),qo(QS(),t);break;case"bottomcenter":Wo($S(),t),qo(YS(),t);break;case"bottomright":Wo(XS(),t),qo(YS(),t);break;case"bottomleft":Wo(ev(),t),qo(YS(),t);break;default:case"topleft":Wo(ev(),t),qo(Jg(),t);break}return Ns=null,t}function mT(){return up.documentElement.scrollTop||up.body.scrollTop}function yT(){return up.documentElement.scrollLeft||up.body.scrollLeft}function YS(){return mC?uo.bottom:uo.bottom+mT()}function QS(){return Jg()+uo.height/2}function Jg(){return mC?uo.top:uo.top+mT()}function ev(){return uo.left+yT()}function XS(){var o=Ns&&((Ns.classList.contains("e-date-wrapper")||Ns.classList.contains("e-datetime-wrapper"))&&Ns.classList.contains("e-rtl")||Ns.classList.contains("e-ddl")&&Ns.classList.contains("e-rtl")||Ns.classList.contains("e-date-range-wrapper"))?Ll?Ll.width:0:Ll&&uo.width>=Ll.width?Ll.width:0;return Ns&&Ns.classList.contains("e-rtl")&&Ns.classList.contains("e-multiselect")&&(o=Ll.width),uo.right+yT()-o}function $S(){return ev()+uo.width/2}var Nl,ys;function hv(o,e,t,i){if(e===void 0&&(e=null),t===void 0&&(t={X:!1,Y:!1}),!t.Y&&!t.X)return{left:0,top:0};var r=o.getBoundingClientRect();if(ys=e,Nl=o.ownerDocument,i||(i=br(o,"left","top")),t.X){var n=ys?IT():TT(),s=CC(),a=wC(),l=s-i.left,h=i.left+r.width-a;r.width>n?l>0&&h<=0?i.left=a-r.width:h>0&&l<=0?i.left=s:i.left=l>h?a-r.width:s:l>0?i.left+=l:h>0&&(i.left-=h)}if(t.Y){var u=ys?MT():AT(),c=SC(),d=xC(),p=c-i.top,f=i.top+r.height-d;r.height>u?p>0&&f<=0?i.top=d-r.height:f>0&&p<=0?i.top=c:i.top=p>f?d-r.height:c:p>0?i.top+=p:f>0&&(i.top-=f)}return i}function is(o,e,t,i){e===void 0&&(e=null);var r=br(o,"left","top");t&&(r.left=t),i&&(r.top=i);var n=[];ys=e,Nl=o.ownerDocument;var s=o.getBoundingClientRect(),a=r.top,l=r.left,h=r.left+s.width,u=r.top+s.height,c=xT(a,u),d=ST(l,h);return c.topSide&&n.push("top"),d.rightSide&&n.push("right"),d.leftSide&&n.push("left"),c.bottomSide&&n.push("bottom"),n}function Y3(o,e,t,i,r,n,s,a,l){if(s===void 0&&(s=null),a===void 0&&(a={X:!0,Y:!0}),!(!e||!o||!r||!n||!a.X&&!a.Y)){var h={TL:null,TR:null,BL:null,BR:null},u={TL:null,TR:null,BL:null,BR:null},c;if(window.getComputedStyle(o).display==="none"){var d=o.style.visibility;o.style.visibility="hidden",o.style.display="block",c=o.getBoundingClientRect(),o.style.removeProperty("display"),o.style.visibility=d}else c=o.getBoundingClientRect();var p={posX:r,posY:n,offsetX:t,offsetY:i,position:{left:0,top:0}};ys=s,Nl=e.ownerDocument,X3(e,h,p,l,c),bC(u,p,c),a.X&&CT(e,u,h,p,c,!0),a.Y&&h.TL.top>-1&&wT(e,u,h,p,c,!0),Q3(o,p,c)}}function Q3(o,e,t){var i=0,r=0;if(o.offsetParent!=null&&(getComputedStyle(o.offsetParent).position==="absolute"||getComputedStyle(o.offsetParent).position==="relative")){var n=br(o.offsetParent,"left","top",!1,t);i=n.left,r=n.top}var s=1,a=1,l=bT(o);if(l){var h=getComputedStyle(l).transform;if(h!=="none"){var u=new DOMMatrix(h);s=u.a,a=u.d}var c=getComputedStyle(l).zoom;if(c!=="none"){var d=yC(document.body);s=d*s,a=d*a}}o.style.top=e.position.top/a+e.offsetY-r/a+"px",o.style.left=e.position.left/s+e.offsetX-i/s+"px"}function yC(o){var e=getComputedStyle(o).zoom;return parseFloat(e)||1}function bT(o){for(;o;){var e=window.getComputedStyle(o).transform,t=yC(document.body);if(e&&e!=="none"||t&&t!==1)return o;if(o===document.body)return null;o=o.offsetParent||o.parentElement}return null}function X3(o,e,t,i,r){t.position=br(o,t.posX,t.posY,i,r),e.TL=br(o,"left","top",i,r),e.TR=br(o,"right","top",i,r),e.BR=br(o,"left","bottom",i,r),e.BL=br(o,"right","bottom",i,r)}function bC(o,e,t){o.TL={top:e.position.top+e.offsetY,left:e.position.left+e.offsetX},o.TR={top:o.TL.top,left:o.TL.left+t.width},o.BL={top:o.TL.top+t.height,left:o.TL.left},o.BR={top:o.TL.top+t.height,left:o.TL.left+t.width}}function ST(o,e){var t=!1,i=!1;return o-rv()<CC()&&(t=!0),e>wC()&&(i=!0),{leftSide:t,rightSide:i}}function CT(o,e,t,i,r,n){var s=ST(e.TL.left,e.TR.left);t.TL.left-rv()<=CC()&&(s.leftSide=!1),t.TR.left>wC()&&(s.rightSide=!1),(s.leftSide&&!s.rightSide||!s.leftSide&&s.rightSide)&&(i.posX==="right"?i.posX="left":i.posX="right",i.offsetX=i.offsetX+r.width,i.offsetX=-1*i.offsetX,i.position=br(o,i.posX,i.posY,!1),bC(e,i,r),n&&CT(o,e,t,i,r,!1))}function wT(o,e,t,i,r,n){var s=xT(e.TL.top,e.BL.top);t.TL.top-iv()<=SC()&&(s.topSide=!1),t.BL.top>=xC()&&o.getBoundingClientRect().bottom<window.innerHeight&&(s.bottomSide=!1),(s.topSide&&!s.bottomSide||!s.topSide&&s.bottomSide)&&(i.posY==="top"?i.posY="bottom":i.posY="top",i.offsetY=i.offsetY+r.height,i.offsetY=-1*i.offsetY,i.position=br(o,i.posX,i.posY,!1,r),bC(e,i,r),n&&wT(o,e,t,i,r,!1))}function xT(o,e){var t=!1,i=!1;return o-iv()<SC()&&(t=!0),e>xC()&&(i=!0),{topSide:t,bottomSide:i}}function IT(){return ys.getBoundingClientRect().width}function MT(){return ys.getBoundingClientRect().height}function DT(){return ys.getBoundingClientRect().left}function ET(){return ys.getBoundingClientRect().top}function SC(){return ys?ET():0}function CC(){return ys?DT():0}function wC(){return ys?rv()+DT()+IT():rv()+TT()}function xC(){return ys?iv()+ET()+MT():iv()+AT()}function iv(){return Nl.documentElement.scrollTop||Nl.body.scrollTop}function rv(){return Nl.documentElement.scrollLeft||Nl.body.scrollLeft}function AT(){return window.innerHeight}function TT(){var o=window.innerWidth,e=document.documentElement.getBoundingClientRect(),t=g(document.documentElement)?0:e.width;return o-(o-t)}function LT(){ys=null,Nl=null}var kT=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Gr=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},NT=function(o){kT(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Gr([C("left")],e.prototype,"X",void 0),Gr([C("top")],e.prototype,"Y",void 0),e}(Re),fn={ROOT:"e-popup",RTL:"e-rtl",OPEN:"e-popup-open",CLOSE:"e-popup-close"},Gn=function(o){kT(e,o);function e(t,i){return o.call(this,i,t)||this}return e.prototype.onPropertyChanged=function(t,i){for(var r=0,n=Object.keys(t);r<n.length;r++){var s=n[r];switch(s){case"width":Ye(this.element,{width:Le(t.width)});break;case"height":Ye(this.element,{height:Le(t.height)});break;case"zIndex":Ye(this.element,{zIndex:t.zIndex});break;case"enableRtl":this.setEnableRtl();break;case"position":case"relateTo":this.refreshPosition();break;case"offsetX":{var a=t.offsetX-i.offsetX;this.element.style.left=(parseInt(this.element.style.left,10)+a).toString()+"px";break}case"offsetY":{var l=t.offsetY-i.offsetY;this.element.style.top=(parseInt(this.element.style.top,10)+l).toString()+"px";break}case"content":this.setContent();break;case"actionOnScroll":t.actionOnScroll!=="none"?this.wireScrollEvents():this.unwireScrollEvents();break}}},e.prototype.getModuleName=function(){return"popup"},e.prototype.resolveCollision=function(){this.checkCollision()},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.destroy=function(){this.element.classList.contains("e-popup-open")&&this.unwireEvents(),this.element.classList.remove(fn.ROOT,fn.RTL,fn.OPEN,fn.CLOSE),this.content=null,this.relateTo=null,LT(),o.prototype.destroy.call(this)},e.prototype.render=function(){this.element.classList.add(fn.ROOT);var t={};this.zIndex!==1e3&&(t.zIndex=this.zIndex),this.width!=="auto"&&(t.width=Le(this.width)),this.height!=="auto"&&(t.height=Le(this.height)),Ye(this.element,t),this.fixedParent=!1,this.setEnableRtl(),this.setContent()},e.prototype.wireEvents=function(){B.isDevice&&E.add(window,"orientationchange",this.orientationOnChange,this),this.actionOnScroll!=="none"&&this.wireScrollEvents()},e.prototype.wireScrollEvents=function(){if(this.getRelateToElement())for(var t=0,i=this.getScrollableParent(this.getRelateToElement());t<i.length;t++){var r=i[t];E.add(r,"scroll",this.scrollRefresh,this)}},e.prototype.unwireEvents=function(){B.isDevice&&E.remove(window,"orientationchange",this.orientationOnChange),this.actionOnScroll!=="none"&&this.unwireScrollEvents()},e.prototype.unwireScrollEvents=function(){if(this.getRelateToElement())for(var t=0,i=this.getScrollableParent(this.getRelateToElement());t<i.length;t++){var r=i[t];E.remove(r,"scroll",this.scrollRefresh)}},e.prototype.getRelateToElement=function(){var t=this.relateTo===""||g(this.relateTo)?document.body:this.relateTo;return this.setProperties({relateTo:t},!0),typeof this.relateTo=="string"?document.querySelector(this.relateTo):this.relateTo},e.prototype.scrollRefresh=function(t){if(this.actionOnScroll==="reposition"?!g(this.element)&&!(this.element.offsetParent===t.target||this.element.offsetParent&&this.element.offsetParent.tagName==="BODY"&&t.target.parentElement==null)&&this.refreshPosition():this.actionOnScroll==="hide"&&this.hide(),this.actionOnScroll!=="none"&&this.getRelateToElement()){var i=this.isElementOnViewport(this.getRelateToElement(),t.target);!i&&!this.targetInvisibleStatus?(this.trigger("targetExitViewport"),this.targetInvisibleStatus=!0):i&&(this.targetInvisibleStatus=!1)}},e.prototype.isElementOnViewport=function(t,i){for(var r=this.getScrollableParent(t),n=0;n<r.length;n++)if(!this.isElementVisible(t,r[n]))return!1;return!0},e.prototype.isElementVisible=function(t,i){var r=this.checkGetBoundingClientRect(t);if(!r.height||!r.width)return!1;if(g(this.checkGetBoundingClientRect(i))){var s=window,a={top:s.scrollY,left:s.scrollX,right:s.scrollX+s.outerWidth,bottom:s.scrollY+s.outerHeight},l=br(t),h={top:l.top,left:l.left,right:l.left+r.width,bottom:l.top+r.height},u={top:a.bottom-h.top,left:a.right-h.left,bottom:h.bottom-a.top,right:h.right-a.left};return u.top>0&&u.left>0&&u.right>0&&u.bottom>0}else{var n=i.getBoundingClientRect();return!(r.bottom<n.top)&&!(r.bottom>n.bottom)&&!(r.right>n.right)&&!(r.left<n.left)}},e.prototype.preRender=function(){},e.prototype.setEnableRtl=function(){this.reposition(),this.enableRtl?this.element.classList.add(fn.RTL):this.element.classList.remove(fn.RTL)},e.prototype.setContent=function(){if(!g(this.content))if(this.element.innerHTML="",typeof this.content=="string")this.element.textContent=this.content;else{var t=this.getRelateToElement(),i=this.content.props;(!t.classList.contains("e-dropdown-btn")||g(i))&&this.element.appendChild(this.content)}},e.prototype.orientationOnChange=function(){var t=this;setTimeout(function(){t.refreshPosition()},200)},e.prototype.refreshPosition=function(t,i){g(t)||this.checkFixedParent(t),this.reposition(),i||this.checkCollision()},e.prototype.reposition=function(){var t,i,r=this.getRelateToElement();if(typeof this.position.X=="number"&&typeof this.position.Y=="number")t={left:this.position.X,top:this.position.Y};else if(typeof this.position.X=="string"&&typeof this.position.Y=="number"||typeof this.position.X=="number"&&typeof this.position.Y=="string"){var n=void 0,s=this.element.style.display;this.element.style.display="block",this.element.classList.contains("e-dlg-modal")&&(n=this.element.parentElement.style.display,this.element.parentElement.style.display="block"),i=this.getAnchorPosition(r,this.element,this.position,this.offsetX,this.offsetY),typeof this.position.X=="string"?t={left:i.left,top:this.position.Y}:t={left:this.position.X,top:i.top},this.element.style.display=s,this.element.classList.contains("e-dlg-modal")&&(this.element.parentElement.style.display=n)}else if(r){var a=this.element.clientHeight,s=this.element.style.display;this.element.style.display="block",t=this.getAnchorPosition(r,this.element,this.position,this.offsetX,this.offsetY,a),this.element.style.display=s}else t={left:0,top:0};g(t)||(this.element.style.left=t.left+"px",this.element.style.top=t.top+"px")},e.prototype.checkGetBoundingClientRect=function(t){var i;try{return i=t.getBoundingClientRect(),i}catch{return null}},e.prototype.getAnchorPosition=function(t,i,r,n,s,a){a===void 0&&(a=0);var l=this.checkGetBoundingClientRect(i),h=this.checkGetBoundingClientRect(t);if(g(l)||g(h))return null;var u=t,c={left:0,top:0};switch(i.offsetParent&&i.offsetParent.tagName==="BODY"&&t.tagName==="BODY"?c=br(t):(i.classList.contains("e-dlg-modal")&&u.tagName!=="BODY"&&(i=i.parentElement),c=lv(u,i)),r.X){default:case"left":break;case"center":i.classList.contains("e-dlg-modal")&&u.tagName==="BODY"&&this.targetType==="container"?c.left+=window.innerWidth/2-l.width/2:this.targetType==="container"?c.left+=h.width/2-l.width/2:c.left+=h.width/2;break;case"right":if(i.classList.contains("e-dlg-modal")&&u.tagName==="BODY"&&this.targetType==="container")c.left+=window.innerWidth-l.width;else if(this.targetType==="container"){var d=1,p=bT(i);if(p){var f=getComputedStyle(p).transform;if(f!=="none"){var v=new DOMMatrix(f);d=v.a}var m=getComputedStyle(p).zoom;if(m!=="none"){var y=yC(document.body);d=y*d}}c.left+=(h.width-l.width)/d}else c.left+=h.width;break}switch(r.Y){default:case"top":break;case"center":i.classList.contains("e-dlg-modal")&&u.tagName==="BODY"&&this.targetType==="container"?c.top+=window.innerHeight/2-l.height/2:this.targetType==="container"?c.top+=h.height/2-l.height/2:c.top+=h.height/2;break;case"bottom":i.classList.contains("e-dlg-modal")&&u.tagName==="BODY"&&this.targetType==="container"?c.top+=window.innerHeight-l.height:this.targetType==="container"&&!i.classList.contains("e-dialog")?c.top+=h.height-l.height:this.targetType==="container"&&i.classList.contains("e-dialog")?c.top+=h.height-a:c.top+=h.height;break}return c.left+=n,c.top+=s,c},e.prototype.callFlip=function(t){var i=this.getRelateToElement();Y3(this.element,i,this.offsetX,this.offsetY,this.position.X,this.position.Y,this.viewPortElement,t,this.fixedParent)},e.prototype.callFit=function(t){if(is(this.element,this.viewPortElement).length!==0)if(g(this.viewPortElement)){var i=hv(this.element,this.viewPortElement,t);t.X&&(this.element.style.left=i.left+"px"),t.Y&&(this.element.style.top=i.top+"px")}else{var r=this.checkGetBoundingClientRect(this.element),n=this.checkGetBoundingClientRect(this.viewPortElement);if(g(r)||g(n))return null;t&&t.Y===!0&&(n.top>r.top?this.element.style.top="0px":n.bottom<r.bottom&&(this.element.style.top=parseInt(this.element.style.top,10)-(r.bottom-n.bottom)+"px")),t&&t.X===!0&&(n.right<r.right?this.element.style.left=parseInt(this.element.style.left,10)-(r.right-n.right)+"px":n.left>r.left&&(this.element.style.left=parseInt(this.element.style.left,10)+(n.left-r.left)+"px"))}},e.prototype.checkCollision=function(){var t=this.collision.X,i=this.collision.Y;t==="none"&&i==="none"||(t==="flip"&&i==="flip"?this.callFlip({X:!0,Y:!0}):t==="fit"&&i==="fit"?this.callFit({X:!0,Y:!0}):(t==="flip"?this.callFlip({X:!0,Y:!1}):i==="flip"&&this.callFlip({Y:!0,X:!1}),t==="fit"?this.callFit({X:!0,Y:!1}):i==="fit"&&this.callFit({X:!1,Y:!0})))},e.prototype.show=function(t,i){var r=this;if(this.wireEvents(),this.zIndex===1e3||!g(i)){var n=g(i)?this.element:i;this.zIndex=Fs(n),Ye(this.element,{zIndex:this.zIndex})}t=!g(t)&&typeof t=="object"?t:this.showAnimation,(this.collision.X!=="none"||this.collision.Y!=="none")&&(K([this.element],fn.CLOSE),Y([this.element],fn.OPEN),this.checkCollision(),K([this.element],fn.OPEN),Y([this.element],fn.CLOSE)),g(t)?(K([this.element],fn.CLOSE),Y([this.element],fn.OPEN),this.trigger("open")):(t.begin=function(){r.isDestroyed||(K([r.element],fn.CLOSE),Y([r.element],fn.OPEN))},t.end=function(){r.isDestroyed||r.trigger("open")},new It(t).animate(this.element))},e.prototype.hide=function(t){var i=this;t=!g(t)&&typeof t=="object"?t:this.hideAnimation,g(t)?(K([this.element],fn.OPEN),Y([this.element],fn.CLOSE),this.trigger("close")):(t.end=function(){i.isDestroyed||(K([i.element],fn.OPEN),Y([i.element],fn.CLOSE),i.trigger("close"))},new It(t).animate(this.element)),this.unwireEvents()},e.prototype.getScrollableParent=function(t){return this.checkFixedParent(t),uv(t,this.fixedParent)},e.prototype.checkFixedParent=function(t){for(var i=t.parentElement;i&&i.tagName!=="HTML";){var r=getComputedStyle(i);(r.position==="fixed"||r.position==="sticky")&&!g(this.element)&&this.element.offsetParent&&this.element.offsetParent.tagName==="BODY"&&getComputedStyle(this.element.offsetParent).overflow!=="hidden"&&(this.element.style.top=window.scrollY>parseInt(this.element.style.top,10)?Le(window.scrollY-parseInt(this.element.style.top,10)):Le(parseInt(this.element.style.top,10)-window.scrollY),this.element.style.position="fixed",this.fixedParent=!0),i=i.parentElement,!g(this.element)&&g(this.element.offsetParent)&&r.position==="fixed"&&this.element.style.position==="fixed"&&(this.fixedParent=!0)}},Gr([C("auto")],e.prototype,"height",void 0),Gr([C("auto")],e.prototype,"width",void 0),Gr([C(null)],e.prototype,"content",void 0),Gr([C("container")],e.prototype,"targetType",void 0),Gr([C(null)],e.prototype,"viewPortElement",void 0),Gr([C({X:"none",Y:"none"})],e.prototype,"collision",void 0),Gr([C("")],e.prototype,"relateTo",void 0),Gr([be({},NT)],e.prototype,"position",void 0),Gr([C(0)],e.prototype,"offsetX",void 0),Gr([C(0)],e.prototype,"offsetY",void 0),Gr([C(1e3)],e.prototype,"zIndex",void 0),Gr([C(!1)],e.prototype,"enableRtl",void 0),Gr([C("reposition")],e.prototype,"actionOnScroll",void 0),Gr([C(null)],e.prototype,"showAnimation",void 0),Gr([C(null)],e.prototype,"hideAnimation",void 0),Gr([q()],e.prototype,"open",void 0),Gr([q()],e.prototype,"close",void 0),Gr([q()],e.prototype,"targetExitViewport",void 0),e=Gr([bt],e),e}(Kt);function uv(o,e){for(var t=getComputedStyle(o),i=[],r=/(auto|scroll)/,n=o.parentElement;n&&n.tagName!=="HTML";){var s=getComputedStyle(n);!(t.position==="absolute"&&s.position==="static")&&r.test(s.overflow+s.overflowY+s.overflowX)&&i.push(n),n=n.parentElement}return e||i.push(document),i}function Fs(o){for(var e=o.parentElement,t=[];e&&e.tagName!=="BODY";){var i=document.defaultView.getComputedStyle(e,null).getPropertyValue("z-index"),r=document.defaultView.getComputedStyle(e,null).getPropertyValue("position");i!=="auto"&&r!=="static"&&t.push(i),e=e.parentElement}for(var n=[],s=0;s<document.body.children.length;s++)if(!o.isEqualNode(document.body.children[s])){var i=document.defaultView.getComputedStyle(document.body.children[s],null).getPropertyValue("z-index"),r=document.defaultView.getComputedStyle(document.body.children[s],null).getPropertyValue("position");i!=="auto"&&r!=="static"&&n.push(i)}n.push("999");var a=[];if(!g(o.parentElement)&&o.parentElement.tagName!=="BODY"){for(var l=[].slice.call(o.parentElement.children),s=0;s<l.length;s++)if(!o.isEqualNode(l[s])){var i=document.defaultView.getComputedStyle(l[s],null).getPropertyValue("z-index"),r=document.defaultView.getComputedStyle(l[s],null).getPropertyValue("position");i!=="auto"&&r!=="static"&&a.push(i)}}var h=t.concat(n,a),u=Math.max.apply(Math,h)+1;return u>2147483647?2147483647:u}var KS=["north-west","north","north-east","west","east","south-west","south","south-east"],pp="e-resize-handle",kl="e-focused-handle",$3="e-dlg-resizable",OA=["e-restrict-left"],FT="e-resize-viewport",K3=["north","west","east","south"],yi,Ra,IC=0,MC=0,OT=0,RT=0,cp=0,dp=0,lc,Yo,DC,Qo,Gt,hc=null,nv=null,sv=null,Go,av=!0,RA=0,ZS=!0;function Z3(o){hc=o.resizeBegin,nv=o.resizing,sv=o.resizeComplete,yi=PA(o.element),Gt=PA(o.boundary);for(var e=o.direction.split(" "),t=0;t<e.length;t++)if(K3.indexOf(e[t])>=0&&e[t])J3(e[t]);else if(e[t].trim()!==""){var i=Xe("div",{className:"e-icons "+pp+" e-"+e[t]});yi.appendChild(i)}lc=o.minHeight,DC=o.minWidth,Qo=o.maxWidth,Yo=o.maxHeight,o.proxy&&o.proxy.element&&o.proxy.element.classList.contains("e-dialog")?BA(o.proxy):BA()}function J3(o){EC();var e=Xe("span",{attrs:{unselectable:"on",contenteditable:"false"}});e.setAttribute("class","e-dialog-border-resize e-"+o),o==="south"&&(e.style.height="2px",e.style.width="100%",e.style.bottom="0px",e.style.left="0px"),o==="north"&&(e.style.height="2px",e.style.width="100%",e.style.top="0px",e.style.left="0px"),o==="east"&&(e.style.height="100%",e.style.width="2px",e.style.right="0px",e.style.top="0px"),o==="west"&&(e.style.height="100%",e.style.width="2px",e.style.left="0px",e.style.top="0px"),yi.appendChild(e)}function PA(o){var e;return g(o)||(typeof o=="string"?e=document.querySelector(o):e=o),e}function BA(o){for(var e=o||this,t=yi.querySelectorAll("."+pp),i=0;i<t.length;i++){Ra=t[i],E.add(Ra,"mousedown",zA,e);var r=B.info.name==="msie"?"pointerdown":"touchstart";E.add(Ra,r,jA,e)}var n=yi.querySelectorAll(".e-dialog-border-resize");if(!g(n))for(var i=0;i<n.length;i++){Ra=n[i],E.add(Ra,"mousedown",zA,e);var r=B.info.name==="msie"?"pointerdown":"touchstart";E.add(Ra,r,jA,e)}}function PT(o){return o.indexOf("mouse")>-1?"mouse":"touch"}function zA(o){if(o.preventDefault(),yi=o.target.parentElement,EC(),cp=o.pageX,dp=o.pageY,o.target.classList.add(kl),!g(hc)){var e=this;if(hc(o,e)===!0)return}this.targetEle&&yi&&yi.querySelector("."+$3)&&(Gt=this.target==="body"?null:this.targetEle,Qo=this.targetEle.clientWidth,Yo=this.targetEle.clientHeight);var t=g(Gt)?document:Gt;E.add(t,"mousemove",hp,this),E.add(document,"mouseup",ov,this);for(var i=0;i<OA.length;i++)yi.classList.contains(OA[i])?av=!1:av=!0}function ov(o){var e=B.info.name==="msie"?"pointermove":"touchmove",t=B.info.name==="msie"?"pointerup":"touchend",i=g(Gt)?document:Gt,r=B.info.name==="msie"?"pointerdown":"touchstart";if(E.remove(i,"mousemove",hp),E.remove(i,e,hp),E.remove(i,r,hp),g(document.body.querySelector("."+kl))||document.body.querySelector("."+kl).classList.remove(kl),!g(sv)){var n=this;sv(o,n)}E.remove(document,"mouseup",ov),E.remove(document,t,ov)}function EC(){IC=parseFloat(getComputedStyle(yi,null).getPropertyValue("width").replace("px","")),MC=parseFloat(getComputedStyle(yi,null).getPropertyValue("height").replace("px","")),OT=yi.getBoundingClientRect().left,RT=yi.getBoundingClientRect().top}function jA(o){yi=o.target.parentElement,EC();var e=yi.classList.contains("e-dialog");(o.target.classList.contains(pp)||o.target.classList.contains("e-dialog-border-resize"))&&e&&o.target.classList.add(kl);var t=o.touches?o.changedTouches[0]:o;if(cp=t.pageX,dp=t.pageY,!g(hc)){var i=this;if(hc(o,i)===!0)return}var r=B.info.name==="msie"?"pointermove":"touchmove",n=B.info.name==="msie"?"pointerup":"touchend",s=g(Gt)?document:Gt;E.add(s,r,hp,this),E.add(document,n,ov,this)}function hp(o){if(o.target.classList.contains(pp)&&o.target.classList.contains(kl)?Ra=o.target:g(document.body.querySelector("."+kl))||(Ra=document.body.querySelector("."+kl)),!g(Ra)){for(var e="",t=0;t<KS.length;t++)Ra.classList.contains("e-"+KS[t])&&(e=KS[t]);if(!g(nv)){var i=this;nv(o,i)}switch(e){case"south":JS(o);break;case"north":eC(o);break;case"west":tC(o);break;case"east":iC(o);break;case"south-east":JS(o),iC(o);break;case"south-west":JS(o),tC(o);break;case"north-east":eC(o),iC(o);break;case"north-west":eC(o),tC(o);break}}}function Fl(o){return o.getBoundingClientRect()}function JS(o){var e=document.documentElement.clientHeight,t=!1,i=o.touches?o.changedTouches[0]:o,r=i.pageY,n=Fl(yi),s;g(Gt)||(s=Fl(Gt)),g(Gt)?g(Gt)&&(e-r>=0||n.top<0)&&(t=!0):t=!0;var a=MC+(r-dp);a=a>lc?a:lc;var l=0;g(Gt)||(l=s.top);var h=g(Gt)?0:Gt.offsetHeight-Gt.clientHeight,u=n.top-l-h/2;if(u=u<0?0:u,n.top>0&&u+a>Yo){if(t=!1,yi.classList.contains(FT))return;yi.style.height=Yo-parseInt(u.toString(),10)+"px";return}var c=0;if(t){n.top<0&&e+(n.height+n.top)>0&&(c=n.top,a+c<=30&&(a=n.height-(n.height+n.top)+30)),a+n.top>=Yo&&(yi.style.height=n.height+(e-(n.height+n.top))+"px");var d=g(Gt)?c:u;a>=lc&&a+d<=Yo&&(yi.style.height=a+"px")}}function eC(o){var e=!1,t,i=PT(o.type)==="mouse"?o.pageY:o.touches[0].pageY,r=Fl(yi),n=g(Gt)?0:Gt.offsetHeight-Gt.clientHeight;g(Gt)||(t=Fl(Gt)),(!g(Gt)&&r.top-t.top>0||g(Gt)&&i>0||!g(Gt)&&Math.floor(r.top-t.top+r.height+(t.bottom-r.bottom))-n<=Yo)&&(e=!0);var s=MC-(i-dp);if(e&&s>=lc&&s<=Yo){var a=0;g(Gt)||(a=t.top);var l=RT-a+(i-dp);l=l>0?l:1,yi.style.height=s+"px",yi.style.top=l+"px"}}function tC(o){var e=document.documentElement.clientWidth,t=!1,i;g(Gt)||(i=Fl(Gt));var r=PT(o.type)==="mouse"?o.pageX:o.touches[0].pageX,n=Fl(yi),s=g(Gt)?0:Gt.offsetWidth-Gt.clientWidth,a=g(Gt)?0:i.left,l=g(Gt)?0:i.width;g(Go)&&(g(Gt)?Go=e:(Go=n.left-a-s/2+n.width,Go=Go+(l-s-Go))),(!g(Gt)&&Math.floor(n.left-i.left+n.width+(i.right-n.right))-s<=Qo||g(Gt)&&r>=0)&&(t=!0);var h=IC-(r-cp);if(av&&(h=h>Go?Go:h),t&&h>=DC&&h<=Qo){var u=0;g(Gt)||(u=i.left);var c=OT-u+(r-cp);c=c>0?c:1,h!==RA&&ZS&&(yi.style.width=h+"px"),av&&(yi.style.left=c+"px",c===1?ZS=!1:ZS=!0)}RA=h}function iC(o){var e=document.documentElement.clientWidth,t=!1,i;g(Gt)||(i=Fl(Gt));var r=o.touches?o.changedTouches[0]:o,n=r.pageX,s=Fl(yi);(!g(Gt)&&(s.left-i.left+s.width<=Qo||s.right-i.left>=s.width)||g(Gt)&&e-n>0)&&(t=!0);var a=IC+(n-cp),l=0;if(g(Gt)||(l=i.left),s.left-l+a>Qo){if(t=!1,yi.classList.contains(FT))return;yi.style.width=Qo-(s.left-l)+"px"}t&&a>=DC&&a<=Qo&&(yi.style.width=a+"px")}function e4(o){lc=o}function t4(o){Qo=o}function i4(o){Yo=o}function HA(){for(var o=yi.querySelectorAll("."+pp),e=0;e<o.length;e++)ee(o[e]);var t=yi.querySelectorAll(".e-dialog-border-resize");if(!g(t))for(var e=0;e<t.length;e++)ee(t[e])}function r4(){yi=null,Ra=null,Gt=null,Go=null,hc=null,nv=null,sv=null}var AC=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),qt=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},n4=function(o){AC(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return qt([C(!0)],e.prototype,"isFlat",void 0),qt([C()],e.prototype,"buttonModel",void 0),qt([C("Button")],e.prototype,"type",void 0),qt([q()],e.prototype,"click",void 0),e}(Re),s4=function(o){AC(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return qt([C("Fade")],e.prototype,"effect",void 0),qt([C(400)],e.prototype,"duration",void 0),qt([C(0)],e.prototype,"delay",void 0),e}(Re),Yg="e-dialog",rC="e-rtl",nC="e-dlg-header-content",VA="e-dlg-header",Qg="e-footer-content",Xg="e-dlg-modal",a4="e-dlg-content",_A="e-icon-dlg-close",o4="e-dlg-overlay",Oa="e-dlg-target",l4="e-dlg-container",ta="e-scroll-disabled",h4="e-primary",u4="e-icons",c4="e-popup",UA="e-device",$g="e-dlg-fullscreen",WA="e-dlg-closeicon-btn",d4="e-popup-close",qA="e-popup-open",GA="Information",YA="e-scroll-disabled",BT="e-alert-dialog",zT="e-confirm-dialog",sC="e-dlg-resizable",ac="e-restrict-left",QA="e-resize-viewport",p4="e-dlg-ref-element",aC="user action",f4="close icon",g4="escape",v4="overlayClick",m4="e-draggable",Ah=function(o){AC(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.needsID=!0,r}return e.prototype.render=function(){this.initialize(),this.initRender(),this.wireEvents(),this.width==="100%"&&(this.element.style.width=""),this.minHeight!==""&&(this.element.style.minHeight=Le(this.minHeight)),this.enableResize&&(this.setResize(),this.isModal&&(this.isModelResize=!0),this.animationSettings.effect==="None"&&this.getMinHeight()),this.renderComplete()},e.prototype.initializeValue=function(){this.dlgClosedBy=aC},e.prototype.preRender=function(){var t=this;this.initializeValue(),this.headerContent=null,this.allowMaxHeight=!0,this.preventVisibility=!0,this.clonedEle=this.element.cloneNode(!0),this.closeIconClickEventHandler=function(n){t.dlgClosedBy=f4,t.hide(n)},this.dlgOverlayClickEventHandler=function(n){t.dlgClosedBy=v4,n.preventFocus=!1,t.trigger("overlayClick",n,function(s){s.preventFocus||t.focusContent(),t.dlgClosedBy=aC})};var i={close:"Close"};if(this.l10n=new Li("dialog",i,this.locale),this.checkPositionData(),g(this.target)){var r=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.target=document.body,this.isProtectedOnChange=r}},e.prototype.updatePersistData=function(){this.enablePersistence&&this.setProperties({width:parseFloat(this.element.style.width),height:parseFloat(this.element.style.height),position:{X:parseFloat(this.dragObj.element.style.left),Y:parseFloat(this.dragObj.element.style.top)}},!0)},e.prototype.isNumberValue=function(t){var i=/^[-+]?\d*\.?\d+$/.test(t);return i},e.prototype.checkPositionData=function(){if(!g(this.position)){if(!g(this.position.X)&&typeof this.position.X!="number"){var t=this.isNumberValue(this.position.X);if(t){var i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.position.X=parseFloat(this.position.X),this.isProtectedOnChange=i}}if(!g(this.position.Y)&&typeof this.position.Y!="number"){var t=this.isNumberValue(this.position.Y);if(t){var i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.position.Y=parseFloat(this.position.Y),this.isProtectedOnChange=i}}}},e.prototype.getEle=function(t,i){for(var r=void 0,n=0;n<t.length;n++)if(t[n].classList.contains(i)){r=t[n];break}return r},e.prototype.getMinHeight=function(){var t="0px",i="0px";g(this.element.querySelector("."+nC))||(t=getComputedStyle(this.headerContent).height);var r=this.getEle(this.element.children,Qg);g(r)||(i=getComputedStyle(r).height);var n=parseInt(t.slice(0,t.indexOf("p")),10),s=parseInt(i.slice(0,i.indexOf("p")),10);return e4(n+30+(isNaN(s)?0:s)),n+30+s},e.prototype.onResizeStart=function(t,i){if(i.trigger("resizeStart",t),!t.cancel&&this.isModelResize&&!g(this.dlgContainer)&&this.dlgContainer.classList.contains("e-dlg-"+this.position.X+"-"+this.position.Y)){this.setPopupPosition(),this.dlgContainer.classList.remove("e-dlg-"+this.position.X+"-"+this.position.Y);var r=this.getTargetContainer(this.target);if(r instanceof Element){var n=window.getComputedStyle(r);n.getPropertyValue("direction")==="rtl"?this.element.style.position="absolute":this.element.style.position="relative"}else this.element.style.position="relative";this.element.classList.contains(ac)&&this.element.classList.remove(ac),this.isModelResize=!1}return t.cancel},e.prototype.onResizing=function(t,i){i.trigger("resizing",t)},e.prototype.onResizeComplete=function(t,i){i.trigger("resizeStop",t),this.updatePersistData()},e.prototype.setResize=function(){if(this.enableResize){this.element.classList.add(sC);for(var t=getComputedStyle(this.element).minHeight,i=getComputedStyle(this.element).minWidth,r="",n=0;n<this.resizeHandles.length;n++)if(this.resizeHandles[n]==="All"){r="south north east west north-east north-west south-east south-west";break}else{var s="";switch(this.resizeHandles[n].toString()){case"SouthEast":s="south-east";break;case"SouthWest":s="south-west";break;case"NorthEast":s="north-east";break;case"NorthWest":s="north-west";break;default:s=this.resizeHandles[n].toString();break}r+=s.toLocaleLowerCase()+" "}this.enableRtl&&r.trim()==="south-east"?r="south-west":this.enableRtl&&r.trim()==="south-west"&&(r="south-east"),this.isModal&&this.enableRtl?this.element.classList.add(ac):this.isModal&&this.target===document.body&&this.element.classList.add(QA),Z3({element:this.element,direction:r,minHeight:parseInt(t.slice(0,i.indexOf("p")),10),maxHeight:this.targetEle.clientHeight,minWidth:parseInt(i.slice(0,i.indexOf("p")),10),maxWidth:this.targetEle.clientWidth,boundary:this.target===document.body?null:this.targetEle,resizeBegin:this.onResizeStart.bind(this),resizeComplete:this.onResizeComplete.bind(this),resizing:this.onResizing.bind(this),proxy:this}),this.wireWindowResizeEvent()}else HA(),this.unWireWindowResizeEvent(),this.isModal?this.element.classList.remove(ac):this.element.classList.remove(QA),this.element.classList.remove(sC)},e.prototype.getFocusElement=function(t){var i='input,select,textarea,button:enabled,a,[contenteditable="true"],[tabindex]',r=t.querySelectorAll(i);return{element:r[r.length-1]}},e.prototype.keyDown=function(t){var i=this;if(t.keyCode===9&&this.isModal){var r=void 0;g(this.btnObj)||(r=this.btnObj[this.btnObj.length-1]),g(this.btnObj)&&!g(this.ftrTemplateContent)&&(r=this.getFocusElement(this.ftrTemplateContent)),g(this.btnObj)&&g(this.ftrTemplateContent)&&!g(this.contentEle)&&(r=this.getFocusElement(this.contentEle)),!g(r)&&document.activeElement===r.element&&!t.shiftKey&&(t.preventDefault(),this.focusableElements(this.element).focus()),document.activeElement===this.focusableElements(this.element)&&t.shiftKey&&(t.preventDefault(),g(r)||r.element.focus())}var n=document.activeElement,s=["input","textarea"].indexOf(n.tagName.toLowerCase())>-1,a=!1;if(s||(a=n.hasAttribute("contenteditable")&&n.getAttribute("contenteditable")==="true"),t.keyCode===27&&this.closeOnEscape){this.dlgClosedBy=g4;var l=document.querySelector(".e-popup-open:not(.e-dialog)");!g(l)&&!l.classList.contains("e-toolbar-pop")&&!l.classList.contains("e-slider-tooltip")||this.hide(t)}if(t.keyCode===13&&!t.ctrlKey&&n.tagName.toLowerCase()!=="textarea"&&s&&!g(this.primaryButtonEle)||t.keyCode===13&&t.ctrlKey&&(n.tagName.toLowerCase()==="textarea"||a)&&!g(this.primaryButtonEle)){var h,u=this.buttons.some(function(c,d){h=d;var p=c.buttonModel;return!g(p)&&p.isPrimary===!0});u&&typeof this.buttons[h].click=="function"&&!this.primaryButtonEle.disabled&&setTimeout(function(){i.buttons[h].click.call(i,t)})}},e.prototype.initialize=function(){g(this.target)||(this.targetEle=typeof this.target=="string"?document.querySelector(this.target):this.target),this.isBlazorServerRender()||Y([this.element],Yg),B.isDevice&&Y([this.element],UA),this.isBlazorServerRender()||this.setCSSClass(),this.setMaxHeight()},e.prototype.initRender=function(){var t=this;if(this.initialRender=!0,this.isBlazorServerRender()||Ie(this.element,{role:"dialog"}),this.zIndex===1e3?(this.setzIndex(this.element,!1),this.calculatezIndex=!0):this.calculatezIndex=!1,this.setTargetContent(),this.header!==""&&!g(this.header)&&this.setHeader(),this.renderCloseIcon(),this.setContent(),this.footerTemplate!==""&&!g(this.footerTemplate)?this.setFooterTemplate():!g(this.buttons[0])&&!g(this.buttons[0].buttonModel)&&this.setButton(),this.allowDragging&&!g(this.headerContent)&&this.setAllowDragging(),Ie(this.element,{"aria-modal":this.isModal?"true":"false"}),this.isModal&&this.setIsModal(),this.element.classList.contains(BT)!==!0&&this.element.classList.contains(zT)!==!0&&!g(this.element.parentElement)){var i=this.isModal?this.dlgContainer.parentElement:this.element.parentElement;this.refElement=this.createElement("div",{className:p4}),i.insertBefore(this.refElement,this.isModal?this.dlgContainer:this.element)}if(g(this.targetEle)||(this.isModal?this.targetEle.appendChild(this.dlgContainer):this.targetEle.appendChild(this.element)),this.popupObj=new Gn(this.element,{height:this.height,width:this.width,zIndex:this.zIndex,relateTo:this.target,actionOnScroll:"none",enableRtl:this.enableRtl,open:function(s){var a={container:t.isModal?t.dlgContainer:t.element,element:t.element,target:t.target,preventFocus:!1};t.enableResize&&t.resetResizeIcon(),t.trigger("open",a,function(l){l.preventFocus||t.focusContent()})},close:function(s){t.isModal&&Y([t.dlgOverlay],"e-fade"),t.unBindEvent(t.element),t.isModal&&(t.dlgContainer.style.display="none"),t.trigger("close",t.closeArgs);var a=document.activeElement;!g(a)&&!g(a.blur)&&a.blur(),!g(t.storeActiveElement)&&!g(t.storeActiveElement.focus)&&t.storeActiveElement.focus()}}),this.positionChange(),this.setEnableRTL(),this.isBlazorServerRender()||(Y([this.element],d4),this.isModal&&this.setOverlayZindex()),this.visible){if(this.show(),this.isModal){var r=this.getTargetContainer(this.target);if(r instanceof Element){var n=window.getComputedStyle(r);n.getPropertyValue("direction")==="rtl"&&this.setPopupPosition()}}}else this.isModal&&(this.dlgOverlay.style.display="none");this.initialRender=!1},e.prototype.getTargetContainer=function(t){var i=null;if(typeof t=="string")if(t.startsWith("#"))i=document.getElementById(t.substring(1));else if(t.startsWith(".")){var r=document.getElementsByClassName(t.substring(1));i=r.length>0?r[0]:null}else!(t instanceof HTMLElement)&&t!==document.body&&(i=document.querySelector(t));else t instanceof HTMLElement&&(i=t);return i},e.prototype.resetResizeIcon=function(){var t=this.getMinHeight();if(this.targetEle.offsetHeight<t){var i=this.enableRtl?"e-south-west":"e-south-east",r=this.element.querySelector("."+i);g(r)||(r.style.bottom="-"+t.toString()+"px")}},e.prototype.setOverlayZindex=function(t){var i;g(t)?i=parseInt(this.element.style.zIndex,10)?parseInt(this.element.style.zIndex,10):this.zIndex:i=t,this.dlgOverlay.style.zIndex=(i-1).toString(),this.dlgContainer.style.zIndex=i.toString()},e.prototype.positionChange=function(){this.isModal?!isNaN(parseFloat(this.position.X))&&!isNaN(parseFloat(this.position.Y))?this.setPopupPosition():!isNaN(parseFloat(this.position.X))&&isNaN(parseFloat(this.position.Y))||isNaN(parseFloat(this.position.X))&&!isNaN(parseFloat(this.position.Y))?this.setPopupPosition():(this.element.style.top="0px",this.element.style.left="0px",this.dlgContainer.classList.add("e-dlg-"+this.position.X+"-"+this.position.Y)):this.setPopupPosition()},e.prototype.setPopupPosition=function(){this.popupObj.setProperties({position:{X:this.position.X,Y:this.position.Y}})},e.prototype.setAllowDragging=function(){var t=this,i="."+nC;this.element.classList.contains(m4)||(this.dragObj=new Dl(this.element,{clone:!1,isDragScroll:!0,abort:".e-dlg-closeicon-btn",handle:i,dragStart:function(r){t.trigger("dragStart",r,function(n){qe()&&n.bindEvents(r.dragElement)})},dragStop:function(r){if(t.isModal){t.IsDragStop=!0,g(t.position)||t.dlgContainer.classList.remove("e-dlg-"+t.position.X+"-"+t.position.Y);var n=t.getTargetContainer(t.target);if(n instanceof Element){var s=window.getComputedStyle(n);s.getPropertyValue("direction")==="rtl"?t.element.style.position="absolute":t.element.style.position="relative"}else t.element.style.position="relative"}t.trigger("dragStop",r),t.isModelResize=!1,t.element.classList.remove(ac),t.updatePersistData()},drag:function(r){t.trigger("drag",r)}}),g(this.targetEle)||(this.dragObj.dragArea=this.targetEle))},e.prototype.setButton=function(){if(!this.isBlazorServerRender()){this.buttonContent=[],this.btnObj=[];for(var t=0;t<this.buttons.length;t++)if(!g(this.buttons[t].buttonModel)){var i=g(this.buttons[t].type)?"button":this.buttons[t].type.toLowerCase(),r=this.createElement("button",{className:this.cssClass,attrs:{type:i,tabindex:"0"}});this.buttonContent.push(r.outerHTML)}this.setFooterTemplate()}for(var n,t=0,s=this.element.children;t<s.length;t++)s[t].classList.contains(Qg)&&(n=s[t].querySelectorAll("button"));for(var t=0;t<this.buttons.length;t++)g(this.buttons[t].buttonModel)||(this.isBlazorServerRender()||(this.btnObj[t]=new bn(this.buttons[t].buttonModel)),!g(this.ftrTemplateContent)&&n.length>0&&(typeof this.buttons[t].click=="function"&&E.add(n[t],"click",this.buttons[t].click,this),typeof this.buttons[t].click=="object"&&E.add(n[t],"click",this.buttonClickHandler.bind(this,t),this)),!this.isBlazorServerRender()&&!g(this.ftrTemplateContent)&&(this.btnObj[t].appendTo(this.ftrTemplateContent.children[t]),this.buttons[t].isFlat&&this.btnObj[t].element.classList.add("e-flat"),this.primaryButtonEle=this.element.getElementsByClassName("e-primary")[0]))},e.prototype.buttonClickHandler=function(t){this.trigger("buttons["+t+"].click",{})},e.prototype.setContent=function(){this.contentEle=this.createElement("div",{className:a4,id:this.element.id+"_dialog-content"}),this.headerEle?Ie(this.element,{"aria-describedby":this.element.id+"_title "+this.element.id+"_dialog-content"}):Ie(this.element,{"aria-describedby":this.element.id+"_dialog-content"}),this.innerContentElement?this.contentEle.appendChild(this.innerContentElement):(!g(this.content)&&this.content!==""||!this.initialRender)&&(typeof this.content=="string"&&!qe()?this.setTemplate(this.content,this.contentEle,"content"):this.content instanceof HTMLElement?this.contentEle.appendChild(this.content):this.setTemplate(this.content,this.contentEle,"content")),g(this.headerContent)?this.element.insertBefore(this.contentEle,this.element.children[0]):this.element.insertBefore(this.contentEle,this.element.children[1]),this.height==="auto"&&(!this.isBlazorServerRender()&&B.isIE&&this.element.style.width===""&&!g(this.width)&&(this.element.style.width=Le(this.width)),this.setMaxHeight())},e.prototype.setTemplate=function(t,i,r){var n,s;i.classList.contains(VA)?s=this.element.id+"header":i.classList.contains(Qg)?s=this.element.id+"footerTemplate":s=this.element.id+"content";var a;g(t.outerHTML)?(typeof t=="string"||typeof t!="string"||qe()&&!this.isStringTemplate)&&(typeof t=="string"&&(t=this.sanitizeHelper(t)),this.isVue||typeof t!="string"?(n=wt(t),a=t):i.innerHTML=t):i.appendChild(t);var l=[];if(!g(n)){for(var h=qe()&&!this.isStringTemplate&&a.indexOf("<div>Blazor")===0?this.isStringTemplate:!0,u=0,c=n({},this,r,s,h);u<c.length;u++){var d=c[u];l.push(d)}dt([].slice.call(l),i)}},e.prototype.sanitizeHelper=function(t){if(this.enableHtmlSanitizer){var i=Bt.beforeSanitize(),r={cancel:!1,helper:null};he(i,i,r),this.trigger("beforeSanitizeHtml",i),i.cancel&&!g(i.helper)?t=i.helper(t):i.cancel||(t=Bt.serializeValue(i,t))}return t},e.prototype.setMaxHeight=function(){if(this.allowMaxHeight){var t=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=!g(this.target)&&this.targetEle.offsetHeight<window.innerHeight?this.targetEle.offsetHeight-20+"px":window.innerHeight-20+"px",this.element.style.display=t,B.isIE&&this.height==="auto"&&!g(this.contentEle)&&this.element.offsetHeight<this.contentEle.offsetHeight&&(this.element.style.height="inherit")}},e.prototype.setEnableRTL=function(){this.isBlazorServerRender()||(this.enableRtl?Y([this.element],rC):K([this.element],rC)),g(this.element.querySelector(".e-resize-handle"))||(HA(),this.setResize())},e.prototype.setTargetContent=function(){var t=this;if(g(this.content)||this.content===""){var i=this.element.innerHTML.replace(/\s|<(\/?|\/?)(!--!--)>/g,"")!=="";(this.element.children.length>0||i)&&(this.innerContentElement=document.createDocumentFragment(),[].slice.call(this.element.childNodes).forEach(function(r){r.nodeType!==8&&t.innerContentElement.appendChild(r)}))}},e.prototype.setHeader=function(){this.headerEle?this.headerEle.innerHTML="":this.headerEle=this.createElement("div",{id:this.element.id+"_title",className:VA}),this.createHeaderContent(),this.headerContent.appendChild(this.headerEle),this.setTemplate(this.header,this.headerEle,"header"),Ie(this.element,{"aria-describedby":this.element.id+"_title"}),Ie(this.element,{"aria-labelledby":this.element.id+"_dialog-header"}),this.element.insertBefore(this.headerContent,this.element.children[0]),this.allowDragging&&!g(this.headerContent)&&this.setAllowDragging()},e.prototype.setFooterTemplate=function(){this.ftrTemplateContent?this.ftrTemplateContent.innerHTML="":this.ftrTemplateContent=this.createElement("div",{className:Qg}),this.footerTemplate!==""&&!g(this.footerTemplate)?this.setTemplate(this.footerTemplate,this.ftrTemplateContent,"footerTemplate"):this.ftrTemplateContent.innerHTML=this.buttonContent.join(""),this.element.appendChild(this.ftrTemplateContent)},e.prototype.createHeaderContent=function(){g(this.headerContent)&&(this.headerContent=this.createElement("div",{id:this.element.id+"_dialog-header",className:nC}))},e.prototype.renderCloseIcon=function(){this.showCloseIcon&&(this.closeIcon=this.createElement("button",{className:WA,attrs:{type:"button"}}),this.closeIconBtnObj=new bn({cssClass:"e-flat",iconCss:_A+" "+u4}),this.closeIconTitle(),g(this.headerContent)?(this.createHeaderContent(),jr([this.closeIcon],this.headerContent),this.element.insertBefore(this.headerContent,this.element.children[0])):jr([this.closeIcon],this.headerContent),this.closeIconBtnObj.appendTo(this.closeIcon))},e.prototype.closeIconTitle=function(){this.l10n.setLocale(this.locale);var t=this.l10n.getConstant("close");this.closeIcon.setAttribute("title",t),this.closeIcon.setAttribute("aria-label",t)},e.prototype.setCSSClass=function(t){t&&(K([this.element],t.split(" ")),this.isModal&&!g(this.dlgContainer)&&K([this.dlgContainer],t.split(" "))),this.cssClass&&(Y([this.element],this.cssClass.split(" ")),this.isModal&&!g(this.dlgContainer)&&Y([this.dlgContainer],this.cssClass.split(" ")))},e.prototype.setIsModal=function(){this.dlgContainer=this.createElement("div",{className:l4}),this.setCSSClass(),this.element.classList.remove(qA),this.element.parentNode.insertBefore(this.dlgContainer,this.element),this.dlgContainer.appendChild(this.element),Y([this.element],Xg),this.dlgOverlay=this.createElement("div",{className:o4}),this.dlgOverlay.style.zIndex=(this.zIndex-1).toString(),this.dlgContainer.appendChild(this.dlgOverlay)},e.prototype.getValidFocusNode=function(t){for(var i,r=0;r<t.length;r++){if(i=t[r],(i.clientHeight>0||i.tagName.toLowerCase()==="a"&&i.hasAttribute("href"))&&i.tabIndex>-1&&!i.disabled&&!this.disableElement(i,'[disabled],[aria-disabled="true"],[type="hidden"]'))return i;i=null}return i},e.prototype.focusableElements=function(t){if(!g(t)){var i='input,select,textarea,button,a,[contenteditable="true"],[tabindex]',r=t.querySelectorAll(i);return this.getValidFocusNode(r)}return null},e.prototype.getAutoFocusNode=function(t){var i=t.querySelector("."+WA),r="[autofocus]",n=t.querySelectorAll(r),s=this.getValidFocusNode(n);if(qe()&&(this.primaryButtonEle=this.element.getElementsByClassName("e-primary")[0]),!g(s))i=s;else if(s=this.focusableElements(this.contentEle),g(s)){if(!g(this.primaryButtonEle))return this.element.querySelector("."+h4)}else return i=s;return i},e.prototype.disableElement=function(t,i){var r=t?t.matches||t.webkitMatchesSelector||t.msGetRegionContent:null;if(r){for(;t;t=t.parentNode)if(t instanceof Element&&r.call(t,i))return t}return null},e.prototype.focusContent=function(){var t=this.getAutoFocusNode(this.element),i=g(t)?this.element:t,r=B.userAgent;(r.indexOf("MSIE ")>0||r.indexOf("Trident/")>0)&&this.element.focus(),i.focus(),this.unBindEvent(this.element),this.bindEvent(this.element)},e.prototype.bindEvent=function(t){E.add(t,"keydown",this.keyDown,this)},e.prototype.unBindEvent=function(t){E.remove(t,"keydown",this.keyDown)},e.prototype.updateSanitizeContent=function(){this.isBlazorServerRender()||(this.contentEle.innerHTML=this.sanitizeHelper(this.content))},e.prototype.isBlazorServerRender=function(){return qe()&&this.isServerRendered},e.prototype.getModuleName=function(){return"dialog"},e.prototype.onPropertyChanged=function(t,i){if(this.element.classList.contains(Yg))for(var r=0,n=Object.keys(t);r<n.length;r++){var s=n[r];switch(s){case"content":!g(this.content)&&this.content!==""?(this.isBlazorServerRender()&&(this.contentEle=this.element.querySelector(".e-dlg-content")),!g(this.contentEle)&&this.contentEle.getAttribute("role")!=="dialog"?(this.isBlazorServerRender()||(this.contentEle.innerHTML=""),typeof this.content=="function"?(this.clearTemplate(["content"]),ee(this.contentEle),this.contentEle=null,this.setContent()):typeof this.content=="string"?this.updateSanitizeContent():this.contentEle.appendChild(this.content),this.setMaxHeight()):this.setContent()):g(this.contentEle)||(ee(this.contentEle),this.contentEle=null);break;case"header":this.header===""||g(this.header)?this.headerEle&&(ee(this.headerEle),this.headerEle=null):this.setHeader();break;case"footerTemplate":if(this.footerTemplate===""||g(this.footerTemplate)){if(!this.ftrTemplateContent)return;ee(this.ftrTemplateContent),this.ftrTemplateContent=null,this.buttons=[{}]}else this.setFooterTemplate(),this.buttons=[{}];break;case"showCloseIcon":this.element.getElementsByClassName(_A).length>0?!this.showCloseIcon&&(this.header===""||g(this.header))?(ee(this.headerContent),this.headerContent=null):this.showCloseIcon||ee(this.closeIcon):(this.renderCloseIcon(),this.wireEvents());break;case"locale":this.showCloseIcon&&this.closeIconTitle();break;case"visible":this.visible?this.show():this.hide();break;case"isModal":this.updateIsModal();break;case"height":Ye(this.element,{height:Le(t.height)}),this.updatePersistData();break;case"width":Ye(this.element,{width:Le(t.width)}),this.updatePersistData();break;case"zIndex":this.popupObj.zIndex=this.zIndex,this.isModal&&this.setOverlayZindex(this.zIndex),this.element.style.zIndex!==this.zIndex.toString()&&(this.calculatezIndex=!1);break;case"cssClass":this.setCSSClass(i.cssClass);break;case"buttons":{this.unWireButtonEvents(),this.destroyButtons(),g(this.ftrTemplateContent)||(ee(this.ftrTemplateContent),this.ftrTemplateContent=null),this.footerTemplate="",this.setButton();break}case"allowDragging":this.allowDragging&&!g(this.headerContent)?this.setAllowDragging():this.dragObj.destroy();break;case"target":this.setTarget(t.target);break;case"position":if(this.checkPositionData(),this.isModal){var a=this.position.X,l=this.position.Y;g(i.position)||(g(i.position.X)||(a=i.position.X),g(i.position.Y)||(l=i.position.Y)),this.dlgContainer.classList.contains("e-dlg-"+a+"-"+l)&&this.dlgContainer.classList.remove("e-dlg-"+a+"-"+l)}this.positionChange(),this.updatePersistData();break;case"enableRtl":this.setEnableRTL();break;case"enableResize":this.setResize(),this.isModelResize=this.enableResize&&this.isModal,this.enableResize&&this.dialogOpen&&this.resetResizeIcon();break;case"minHeight":this.minHeight!==""&&(this.element.style.minHeight=Le(this.minHeight));break}}},e.prototype.setTarget=function(t){this.popupObj.relateTo=t,this.target=t,this.targetEle=typeof this.target=="string"?document.querySelector(this.target):this.target,this.dragObj&&(this.dragObj.dragArea=this.targetEle),this.setMaxHeight(),this.isModal&&this.updateIsModal(),this.enableResize&&this.setResize(),g(this.targetEle)||(this.isModal&&!g(this.dlgContainer)?this.targetEle.appendChild(this.dlgContainer):g(this.element)||this.targetEle.appendChild(this.element))},e.prototype.updateIsModal=function(){if(this.element.setAttribute("aria-modal",this.isModal?"true":"false"),this.isModal)g(this.dlgOverlay)&&(this.setIsModal(),this.element.style.top="0px",this.element.style.left="0px",g(this.targetEle)||this.targetEle.appendChild(this.dlgContainer));else{for(K([this.element],Xg),K([document.body],[Oa,ta]),ee(this.dlgOverlay);this.dlgContainer.firstChild;)this.dlgContainer.parentElement.insertBefore(this.dlgContainer.firstChild,this.dlgContainer);this.dlgContainer.parentElement.removeChild(this.dlgContainer)}this.visible&&this.show(),this.positionChange(),this.isModal&&this.dlgOverlay&&E.add(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler,this)},e.prototype.setzIndex=function(t,i){var r=this.isProtectedOnChange;this.isProtectedOnChange=!0;var n=Fs(t);this.zIndex=n>this.zIndex?n:this.zIndex,this.isProtectedOnChange=r,i&&(this.popupObj.zIndex=this.zIndex)},e.prototype.windowResizeHandler=function(){t4(this.targetEle.clientWidth),i4(this.targetEle.clientHeight),this.setMaxHeight()},e.prototype.getPersistData=function(){return this.addOnPersist(["width","height","position"])},e.prototype.removeAllChildren=function(t){for(;t.children[0];)this.removeAllChildren(t.children[0]),t.removeChild(t.children[0])},e.prototype.destroy=function(){if(!this.isDestroyed){var t=[rC,Xg,sC,ac,$g,UA],i=["role","aria-modal","aria-labelledby","aria-describedby","aria-grabbed","tabindex","style"];K([this.targetEle],[Oa,ta]),!g(this.element)&&this.element.classList.contains($g)&&K([document.body],[Oa,ta]),this.isModal&&K([g(this.targetEle)?document.body:this.targetEle],ta),this.unWireEvents(),this.unWireButtonEvents(),this.destroyButtons(),g(this.closeIconBtnObj)||this.closeIconBtnObj.destroy(),g(this.dragObj)||this.dragObj.destroy(),!g(this.popupObj.element)&&this.popupObj.element.classList.contains(c4)&&this.popupObj.destroy(),K([this.element],t),!g(this.cssClass)&&this.cssClass!==""&&K([this.element],this.cssClass.split(" ")),!g(this.refElement)&&!g(this.refElement.parentElement)&&(this.refElement.parentElement.insertBefore(this.isModal?this.dlgContainer:this.element,this.refElement),ee(this.refElement),this.refElement=void 0),this.isModal&&(ee(this.dlgOverlay),this.dlgContainer.parentNode.insertBefore(this.element,this.dlgContainer),ee(this.dlgContainer)),this.element.innerHTML=this.clonedEle.innerHTML;for(var r=0;r<i.length;r++)this.element.removeAttribute(i[r]);this.ftrTemplateContent=null,this.headerContent=null,!this.isReact&&!this.isVue&&!g(this.contentEle)&&this.removeAllChildren(this.contentEle),this.contentEle=null,r4(),o.prototype.destroy.call(this),this.isReact&&this.clearTemplate()}},e.prototype.wireWindowResizeEvent=function(){this.boundWindowResizeHandler=this.windowResizeHandler.bind(this),window.addEventListener("resize",this.boundWindowResizeHandler)},e.prototype.unWireWindowResizeEvent=function(){window.removeEventListener("resize",this.boundWindowResizeHandler),this.boundWindowResizeHandler=null},e.prototype.wireEvents=function(){this.showCloseIcon&&E.add(this.closeIcon,"click",this.closeIconClickEventHandler,this),this.isModal&&this.dlgOverlay&&E.add(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler,this)},e.prototype.unWireEvents=function(){this.showCloseIcon&&E.remove(this.closeIcon,"click",this.closeIconClickEventHandler),this.isModal&&E.remove(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler)},e.prototype.refreshPosition=function(){this.popupObj.refreshPosition(),this.element.classList.contains(Xg)&&this.positionChange()},e.prototype.getDimension=function(){var t=this.element.offsetWidth,i=this.element.offsetHeight;return{width:t,height:i}},e.prototype.show=function(t){var i=this;if(this.element.classList.contains(Yg)){if(!this.element.classList.contains(qA)||!g(t)){g(t)||this.fullScreen(t);var r=qe()?{cancel:!1,element:this.element,container:this.isModal?this.dlgContainer:this.element,maxHeight:this.element.style.maxHeight}:{cancel:!1,element:this.element,container:this.isModal?this.dlgContainer:this.element,target:this.target,maxHeight:this.element.style.maxHeight};this.trigger("beforeOpen",r,function(n){if(!n.cancel){if(i.element.style.maxHeight!==r.maxHeight&&(i.allowMaxHeight=!1,i.element.style.maxHeight=r.maxHeight),i.enableResize&&i.boundWindowResizeHandler==null&&!i.initialRender&&i.wireWindowResizeEvent(),i.storeActiveElement=document.activeElement,i.element.tabIndex=-1,i.isModal&&!g(i.dlgOverlay))if(i.dlgOverlay.style.display="block",i.dlgContainer.style.display="flex",K([i.dlgOverlay],"e-fade"),g(i.targetEle))Y([document.body],[Oa,ta]);else{i.targetEle===document.body?i.dlgContainer.style.position="fixed":i.dlgContainer.style.position="absolute",i.dlgOverlay.style.position="absolute";var s=i.getTargetContainer(i.target);if(s instanceof Element){var a=window.getComputedStyle(s);a.getPropertyValue("direction")==="rtl"?i.element.style.position="absolute":i.element.style.position="relative"}else i.element.style.position="relative";Y([i.targetEle],[Oa,ta])}var l={name:i.animationSettings.effect==="None"&&Ut==="Enable"?"ZoomIn":i.animationSettings.effect+"In",duration:i.animationSettings.duration,delay:i.animationSettings.delay},h=i.isModal?i.element.parentElement:i.element;if(i.calculatezIndex&&(i.setzIndex(h,!0),Ye(i.element,{zIndex:i.zIndex}),i.isModal&&i.setOverlayZindex(i.zIndex)),i.animationSettings.effect==="None"&&Ut==="Enable"?i.popupObj.show(l):i.animationSettings.effect==="None"?i.popupObj.show():i.popupObj.show(l),i.isModal){var s=i.getTargetContainer(i.target);if(s instanceof Element){var a=window.getComputedStyle(s);a.getPropertyValue("direction")==="rtl"&&!i.IsDragStop&&i.setPopupPosition()}}i.dialogOpen=!0;var u=i.isProtectedOnChange;i.isProtectedOnChange=!0,i.visible=!0,i.preventVisibility=!0,i.isProtectedOnChange=u}})}this.isReact&&this.renderReactTemplates()}},e.prototype.hide=function(t){var i=this;if(this.element.classList.contains(Yg)&&this.preventVisibility){var r=qe()?{cancel:!1,isInteracted:!!t,element:this.element,container:this.isModal?this.dlgContainer:this.element,event:t}:{cancel:!1,isInteracted:!!t,element:this.element,target:this.target,container:this.isModal?this.dlgContainer:this.element,event:t,closedBy:this.dlgClosedBy};this.closeArgs=r,this.trigger("beforeClose",r,function(n){if(!n.cancel){i.enableResize&&i.unWireWindowResizeEvent();var s={name:i.animationSettings.effect==="None"&&Ut==="Enable"?"ZoomOut":i.animationSettings.effect+"Out",duration:i.animationSettings.duration,delay:i.animationSettings.delay};i.animationSettings.effect==="None"&&Ut==="Enable"?i.popupObj.hide(s):i.animationSettings.effect==="None"?i.popupObj.hide():i.popupObj.hide(s),setTimeout(function(){i.isModal&&!g(i.targetEle)&&i.targetEle.classList.contains(Oa)&&i.targetEle.classList.contains(ta)&&K([i.targetEle],[Oa,ta]),document.body.classList.contains(Oa)&&document.body.classList.contains(ta)&&K([document.body],[Oa,ta])},i.animationSettings.duration+i.animationSettings.delay),i.dialogOpen=!1;var a=i.isProtectedOnChange;i.isProtectedOnChange=!0,i.visible=!1,i.preventVisibility=!1,i.isProtectedOnChange=a}i.dlgClosedBy=aC})}},e.prototype.fullScreen=function(t){var i=this.element.offsetTop,r=this.element.offsetLeft;if(t){this.isModal||(this.element.style.top=document.scrollingElement.scrollTop+"px"),Y([this.element],$g);var n=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=g(this.target)?window.innerHeight+"px":this.targetEle.offsetHeight+"px",this.element.style.display=n,Y([document.body],[Oa,ta]),this.allowDragging&&!g(this.dragObj)&&this.dragObj.destroy()}else K([this.element],$g),K([document.body],[Oa,ta]),this.allowDragging&&!g(this.headerContent)&&this.setAllowDragging();return t},e.prototype.getButtons=function(t){return g(t)?this.btnObj:this.btnObj[t]},e.prototype.unWireButtonEvents=function(){if(this.buttons.length>0&&this.footerTemplate===""&&this.ftrTemplateContent)for(var t=0;t<this.buttons.length;t++)this.buttons[t].click&&typeof this.buttons[t].click=="function"&&this.ftrTemplateContent.children[t]&&E.remove(this.ftrTemplateContent.children[t],"click",this.buttons[t].click)},e.prototype.destroyButtons=function(){if(!g(this.btnObj))for(var t=0;t<this.btnObj.length;t++)this.btnObj[t]&&!this.btnObj[t].isDestroyed&&this.btnObj[t].destroy()},qt([C("")],e.prototype,"content",void 0),qt([C(!0)],e.prototype,"enableHtmlSanitizer",void 0),qt([C(!1)],e.prototype,"enablePersistence",void 0),qt([C(!1)],e.prototype,"showCloseIcon",void 0),qt([C(!1)],e.prototype,"isModal",void 0),qt([C("")],e.prototype,"header",void 0),qt([C(!0)],e.prototype,"visible",void 0),qt([C(!1)],e.prototype,"enableResize",void 0),qt([C(["South-East"])],e.prototype,"resizeHandles",void 0),qt([C("auto")],e.prototype,"height",void 0),qt([C("")],e.prototype,"minHeight",void 0),qt([C("100%")],e.prototype,"width",void 0),qt([C("")],e.prototype,"cssClass",void 0),qt([C(1e3)],e.prototype,"zIndex",void 0),qt([C(null)],e.prototype,"target",void 0),qt([C("")],e.prototype,"footerTemplate",void 0),qt([C(!1)],e.prototype,"allowDragging",void 0),qt([Wt([{}],n4)],e.prototype,"buttons",void 0),qt([C(!0)],e.prototype,"closeOnEscape",void 0),qt([be({},s4)],e.prototype,"animationSettings",void 0),qt([be({X:"center",Y:"center"},NT)],e.prototype,"position",void 0),qt([q()],e.prototype,"created",void 0),qt([q()],e.prototype,"open",void 0),qt([q()],e.prototype,"beforeSanitizeHtml",void 0),qt([q()],e.prototype,"beforeOpen",void 0),qt([q()],e.prototype,"close",void 0),qt([q()],e.prototype,"beforeClose",void 0),qt([q()],e.prototype,"dragStart",void 0),qt([q()],e.prototype,"dragStop",void 0),qt([q()],e.prototype,"drag",void 0),qt([q()],e.prototype,"overlayClick",void 0),qt([q()],e.prototype,"resizeStart",void 0),qt([q()],e.prototype,"resizing",void 0),qt([q()],e.prototype,"resizeStop",void 0),qt([q()],e.prototype,"destroyed",void 0),e=qt([bt],e),e}(Kt),XA;(function(o){function e(u){var c=Xe("div",{className:BT});document.body.appendChild(c);var d,p=[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}}];return typeof u=="string"?d=i({content:u,position:{X:"center",Y:"top"},isModal:!0,header:GA,buttons:p},c):d=i(r(u),c),d.close=function(){u&&u.close&&u.close.apply(d),d.destroy(),d.element.classList.contains("e-dlg-modal")?(d.element.parentElement.remove(),d.target.classList.remove(YA)):d.element.remove()},d}o.alert=e;function t(u){var c=Xe("div",{className:zT});document.body.appendChild(c);var d,p=[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}},{buttonModel:{content:"Cancel"},click:function(){this.hide()}}];return typeof u=="string"?d=i({position:{X:"center",Y:"top"},content:u,isModal:!0,header:GA,buttons:p},c):d=i(n(u),c),d.close=function(){u&&u.close&&u.close.apply(d),d.destroy(),d.element.classList.contains("e-dlg-modal")?(d.element.parentElement.remove(),d.target.classList.remove(YA)):d.element.remove()},d}o.confirm=t;function i(u,c){var d=new Ah(u);return d.appendTo(c),d}function r(u){var c={};return c.buttons=[],c=s(c,u),c=a(c,u),c}function n(u){var c={};return c.buttons=[],c=s(c,u),c=l(c,u),c}function s(u,c){return u.header=g(c.title)?null:c.title,u.content=g(c.content)?"":c.content,u.isModal=g(c.isModal)?!0:c.isModal,u.showCloseIcon=g(c.showCloseIcon)?!1:c.showCloseIcon,u.allowDragging=g(c.isDraggable)?!1:c.isDraggable,u.closeOnEscape=g(c.closeOnEscape)?!1:c.closeOnEscape,u.position=g(c.position)?{X:"center",Y:"top"}:c.position,u.animationSettings=g(c.animationSettings)?{effect:"Fade",duration:400,delay:0}:c.animationSettings,u.cssClass=g(c.cssClass)?"":c.cssClass,u.zIndex=g(c.zIndex)?1e3:c.zIndex,u.open=g(c.open)?null:c.open,u.width=g(c.width)?"auto":c.width,u.height=g(c.height)?"auto":c.height,u}function a(u,c){var d=[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}}];return g(c.okButton)?u.buttons=d:u.buttons[0]=h(u.buttons[0],c.okButton,d[0]),u}function l(u,c){var d={buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}},p={buttonModel:{content:"Cancel"},click:function(){this.hide()}};return g(c.okButton)?u.buttons[0]=d:u.buttons[0]=h(u.buttons[0],c.okButton,d),g(c.cancelButton)?u.buttons[1]=p:u.buttons[1]=h(u.buttons[1],c.cancelButton,p),u}function h(u,c,d){var p=d;return g(c.text)||(p.buttonModel.content=c.text),g(c.icon)||(p.buttonModel.iconCss=c.icon),g(c.cssClass)||(p.buttonModel.cssClass=c.cssClass),g(c.click)||(p.click=c.click),g(c.isFlat)||(p.isFlat=c.isFlat),p}})(XA||(XA={}));var jT=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),xi=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},y4=1500,b4=500,$A=0,KA=8,S4=2,ho=2,oC="e-tooltip",ZA="e-rtl",C4="e-bigger",JA="e-icons",eT="e-tooltip-close",lC="e-tooltip-wrap",tT="e-tip-content",oc="e-arrow-tip",iT="e-arrow-tip-outer",Kg="e-arrow-tip-inner",op="e-tip-bottom",hC="e-tip-top",rT="e-tip-left",uC="e-tip-right",cC="e-popup",lp="e-popup-open",dC="e-popup-close",Zg="e-lib",w4="e-hidden",nT="e-tooltip-popup-container",x4=function(o){jT(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return xi([C({effect:"FadeIn",duration:150,delay:0})],e.prototype,"open",void 0),xi([C({effect:"FadeOut",duration:150,delay:0})],e.prototype,"close",void 0),e}(Re),Ol=function(o){jT(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.mouseMoveEvent=null,r.mouseMoveTarget=null,r.containerElement=null,r.isBodyContainer=!0,r}return e.prototype.initialize=function(){this.formatPosition(),Y([this.element],oC)},e.prototype.formatPosition=function(){var t,i;this.position&&(this.position.indexOf("Top")===0||this.position.indexOf("Bottom")===0?(t=this.position.split(/(?=[A-Z])/),this.tooltipPositionY=t[0],this.tooltipPositionX=t[1]):(i=this.position.split(/(?=[A-Z])/),this.tooltipPositionX=i[0],this.tooltipPositionY=i[1]))},e.prototype.renderArrow=function(){this.setTipClass(this.position);var t=this.createElement("div",{className:oc+" "+this.tipClass});t.appendChild(this.createElement("div",{className:iT+" "+this.tipClass})),t.appendChild(this.createElement("div",{className:Kg+" "+this.tipClass})),this.tooltipEle.appendChild(t)},e.prototype.setTipClass=function(t){t.indexOf("Right")===0?this.tipClass=rT:t.indexOf("Bottom")===0?this.tipClass=hC:t.indexOf("Left")===0?this.tipClass=uC:this.tipClass=op},e.prototype.renderPopup=function(t){var i=this.mouseTrail?{top:0,left:0}:this.getTooltipPosition(t);this.tooltipEle.classList.remove(Zg),this.popupObj=new Gn(this.tooltipEle,{height:this.height,width:this.width,position:{X:i.left,Y:i.top},enableRtl:this.enableRtl,open:this.openPopupHandler.bind(this),close:this.closePopupHandler.bind(this)})},e.prototype.getScalingFactor=function(t){if(!t)return{x:1,y:1};var i={x:1,y:1},r=t.closest('[style*="transform: scale"]');if(r&&r!==this.tooltipEle&&r.contains(this.tooltipEle)){var n=window.getComputedStyle(r),s=n.getPropertyValue("transform"),a=s.match(/matrix\(([^)]+)\)/)[1].split(",").map(parseFloat);i.x=a[0],i.y=a[3]}return i},e.prototype.getTooltipPosition=function(t){this.tooltipEle.style.display="block";var i=this.element.closest('[style*="zoom"]');i&&(i.contains(this.tooltipEle)||(this.tooltipEle.style.zoom=getComputedStyle(i).zoom));var r=br(t,this.tooltipPositionX,this.tooltipPositionY,!this.isBodyContainer,this.isBodyContainer?null:this.containerElement.getBoundingClientRect()),n=this.getScalingFactor(t),s=this.calculateTooltipOffset(this.position,n.x,n.y),a=this.calculateElementPosition(r,s),l=a[0],h=a[1],u=this.collisionFlipFit(t,l,h);return u.left=u.left/n.x,u.top=u.top/n.y,this.tooltipEle.style.display="",u},e.prototype.windowResize=function(){this.reposition(this.findTarget())},e.prototype.reposition=function(t){if(this.popupObj&&t){var i=this.getTooltipPosition(t);this.popupObj.position={X:i.left,Y:i.top},this.popupObj.dataBind()}},e.prototype.openPopupHandler=function(){!this.mouseTrail&&this.needTemplateReposition()&&this.reposition(this.findTarget()),this.trigger("afterOpen",this.tooltipEventArgs),this.tooltipEventArgs=null},e.prototype.closePopupHandler=function(){this.isReact&&!(this.opensOn==="Click"||typeof this.content=="function")&&this.clearTemplate(["content"]),this.clear();var t={type:this.tooltipEventArgs.event?this.tooltipEventArgs.event.type:null,cancel:!1,target:this.tooltipEventArgs.target,event:this.tooltipEventArgs.event?this.tooltipEventArgs.event:null,element:this.tooltipEle,isInteracted:!g(this.tooltipEventArgs.event)};this.trigger("afterClose",t),t=null},e.prototype.calculateTooltipOffset=function(t,i,r){i===void 0&&(i=1),r===void 0&&(r=1);var n={top:0,left:0},s,a,l,h,u,c,d,p;if(i!==1||r!==1){var f=this.tooltipEle.getBoundingClientRect(),v=void 0;l=Math.round(f.width),h=Math.round(f.height),u=X("."+oc,this.tooltipEle),u&&(v=u.getBoundingClientRect()),s=u?Math.round(v.width):0,a=u?Math.round(v.height):0,c=this.showTipPointer?$A:KA,d=a/2+ho+(h-this.tooltipEle.clientHeight*r),p=s/2+ho+(l-this.tooltipEle.clientWidth*i)}else l=this.tooltipEle.offsetWidth,h=this.tooltipEle.offsetHeight,u=X("."+oc,this.tooltipEle),s=u?u.offsetWidth:0,a=u?u.offsetHeight:0,c=this.showTipPointer?$A:KA,d=a/2+ho+(this.tooltipEle.offsetHeight-this.tooltipEle.clientHeight),p=s/2+ho+(this.tooltipEle.offsetWidth-this.tooltipEle.clientWidth);switch(this.mouseTrail&&(c+=S4),t){case"RightTop":n.left+=s+c,n.top-=h-d;break;case"RightCenter":n.left+=s+c,n.top-=h/2;break;case"RightBottom":n.left+=s+c,n.top-=d;break;case"BottomRight":n.top+=a+c,n.left-=p;break;case"BottomCenter":n.top+=a+c,n.left-=l/2;break;case"BottomLeft":n.top+=a+c,n.left-=l-p;break;case"LeftBottom":n.left-=s+l+c,n.top-=d;break;case"LeftCenter":n.left-=s+l+c,n.top-=h/2;break;case"LeftTop":n.left-=s+l+c,n.top-=h-d;break;case"TopLeft":n.top-=h+a+c,n.left-=l-p;break;case"TopRight":n.top-=h+a+c,n.left-=p;break;default:n.top-=h+a+c,n.left-=l/2;break}return n.left+=this.offsetX,n.top+=this.offsetY,n},e.prototype.updateTipPosition=function(t){var i=Oe("."+oc+",."+iT+",."+Kg,this.tooltipEle),r=[op,hC,rT,uC];K(i,r),this.setTipClass(t),Y(i,this.tipClass)},e.prototype.adjustArrow=function(t,i,r,n){var s=X("."+oc,this.tooltipEle);if(!(this.showTipPointer===!1||s===null)){this.updateTipPosition(i);var a,l;this.tooltipEle.style.display="block";var h=this.tooltipEle.clientWidth,u=this.tooltipEle.clientHeight,c=X("."+Kg,this.tooltipEle),d=s.offsetWidth,p=s.offsetHeight;if(this.tooltipEle.style.display="",this.tipClass===op||this.tipClass===hC){if(this.tipClass===op?(l="99.9%",c.style.top="-"+(p-2)+"px"):(l=-(p-1)+"px",c.style.top="-"+(p-6)+"px"),t){var f=r!=="Center"||h>t.offsetWidth||this.mouseTrail;f&&r==="Left"||!f&&this.tipPointerPosition==="End"?a=h-d-ho+"px":f&&r==="Right"||!f&&this.tipPointerPosition==="Start"?a=ho+"px":f&&(this.tipPointerPosition==="End"||this.tipPointerPosition==="Start")?a=this.tipPointerPosition==="End"?t.offsetWidth+(this.tooltipEle.offsetWidth-t.offsetWidth)/2-d/2-ho+"px":(this.tooltipEle.offsetWidth-t.offsetWidth)/2-d/2+ho+"px":a=h/2-d/2+"px"}}else{this.tipClass===uC?(a="99.9%",c.style.left="-"+(d-2)+"px"):(a=-(d-1)+"px",c.style.left=-d+(d-2)+"px");var f=n!=="Center"||u>t.offsetHeight||this.mouseTrail;f&&n==="Top"||!f&&this.tipPointerPosition==="End"?l=u-p-ho+"px":f&&n==="Bottom"||!f&&this.tipPointerPosition==="Start"?l=ho+"px":l=u/2-p/2+"px"}s.style.top=l,s.style.left=a}},e.prototype.renderContent=function(t){var i=this,r=X("."+tT,this.tooltipEle);if(this.cssClass&&Y([this.tooltipEle],this.cssClass.split(" ")),t&&!g(t.getAttribute("title"))&&(t.setAttribute("data-content",t.getAttribute("title")),t.removeAttribute("title")),g(this.content))t&&!g(t.getAttribute("data-content"))&&(r.innerHTML=t.getAttribute("data-content"));else if(r.innerHTML="",this.content instanceof HTMLElement)r.appendChild(this.content);else if(typeof this.content=="string")if(this.isAngular?this.setProperties({content:Bt.sanitize(this.content)},!0):this.content=this.enableHtmlSanitizer?Bt.sanitize(this.content):this.content,this.enableHtmlParse){var n=wt(this.content),s=n({},this,"content",this.element.id+"content",void 0,void 0,r,this.root);s&&dt(s,r)}else r.textContent=this.content;else{var a=wt(this.content),s=a({},this,"content",this.element.id+"content",void 0,void 0,r);s&&(this.isAngular&&setTimeout(function(){i.reposition(t)},1),dt(s,r)),this.renderReactTemplates()}},e.prototype.renderCloseIcon=function(){if(!this.isSticky){var t=this.tooltipEle.querySelector("."+JA+"."+eT);t&&Ue(t);return}var i=this.createElement("div",{className:JA+" "+eT,attrs:{role:"button","aria-label":"Press escape to close the Tooltip"}});this.tooltipEle.appendChild(i),E.add(i,B.touchStartEvent,this.onStickyClose,this)},e.prototype.addDescribedBy=function(t,i){var r=(t.getAttribute("aria-describedby")||"").split(/\s+/);r.indexOf(i)<0&&r.push(i),Ie(t,{"aria-describedby":r.join(" ").trim(),"data-tooltip-id":i})},e.prototype.removeDescribedBy=function(t){var i=t.getAttribute("data-tooltip-id"),r=(t.getAttribute("aria-describedby")||"").split(/\s+/),n=r.indexOf(i);n!==-1&&r.splice(n,1),t.removeAttribute("data-tooltip-id");var s=r.join(" ").trim();s?t.setAttribute("aria-describedby",s):t.removeAttribute("aria-describedby")},e.prototype.tapHoldHandler=function(t){clearTimeout(this.autoCloseTimer),this.targetHover(t.originalEvent)},e.prototype.touchEndHandler=function(){var t=this;if(!this.isSticky){var i=function(){t.close()};this.autoCloseTimer=setTimeout(i,y4)}},e.prototype.targetClick=function(t){var i;if(this.target?i=j(t.target,this.target):i=this.element,!g(i)){var r=t;i.getAttribute("data-tooltip-id")===null?r.type==="mousedown"&&r.button===2||this.targetHover(t):this.isSticky||this.hideTooltip(this.animation.close,t,i)}},e.prototype.targetHover=function(t){var i;if(this.target?i=j(t.target,this.target):i=this.element,!(g(i)||i.getAttribute("data-tooltip-id")!==null&&this.closeDelay===0)){for(var r=[].slice.call(Oe('[data-tooltip-id= "'+this.ctrlId+'_content"]',document)),n=0,s=r;n<s.length;n++){var a=s[n];this.restoreElement(a)}this.showTooltip(i,this.animation.open,t)}},e.prototype.mouseMoveBeforeOpen=function(t){this.mouseMoveEvent=t},e.prototype.mouseMoveBeforeRemove=function(){this.mouseMoveTarget&&E.remove(this.mouseMoveTarget,"mousemove touchstart",this.mouseMoveBeforeOpen)},e.prototype.showTooltip=function(t,i,r){var n=this;clearTimeout(this.showTimer),clearTimeout(this.hideTimer),this.openDelay&&this.mouseTrail&&(this.mouseMoveBeforeRemove(),this.mouseMoveTarget=t,E.add(this.mouseMoveTarget,"mousemove touchstart",this.mouseMoveBeforeOpen,this)),this.tooltipEventArgs={type:r?r.type:null,cancel:!1,target:t,event:r||null,element:this.tooltipEle,isInteracted:!g(r)};var s=function(a){n.beforeRenderCallback(a,t,r,i)};this.trigger("beforeRender",this.tooltipEventArgs,s.bind(this))},e.prototype.beforeRenderCallback=function(t,i,r,n){t.cancel?(this.isHidden=!0,this.clear(),this.mouseMoveBeforeRemove()):(this.isHidden=!1,g(this.tooltipEle)?(this.ctrlId=this.element.getAttribute("id")?kt(this.element.getAttribute("id")):kt("tooltip"),this.tooltipEle=this.createElement("div",{className:lC+" "+cC+" "+Zg,attrs:{role:"tooltip","aria-hidden":"false",id:this.ctrlId+"_content"}}),this.tooltipEle.style.width=Le(this.width),this.tooltipEle.style.height=Le(this.height),this.tooltipEle.style.position="absolute",this.tooltipBeforeRender(i,this),this.tooltipAfterRender(i,r,n,this)):i&&(this.adjustArrow(i,this.position,this.tooltipPositionX,this.tooltipPositionY),this.addDescribedBy(i,this.ctrlId+"_content"),this.renderContent(i),It.stop(this.tooltipEle),this.reposition(i),this.tooltipAfterRender(i,r,n,this)))},e.prototype.appendContainer=function(t){typeof this.container=="string"?this.container==="body"?this.containerElement=document.body:(this.isBodyContainer=!1,this.containerElement=X(this.container,document)):this.container instanceof HTMLElement&&(this.containerElement=this.container,this.isBodyContainer=this.containerElement.tagName==="BODY"),this.isBodyContainer||Y([this.containerElement],nT),this.containerElement.appendChild(t.tooltipEle)},e.prototype.tooltipBeforeRender=function(t,i){t&&(B.isDevice&&Y([i.tooltipEle],C4),i.width!=="auto"&&(i.tooltipEle.style.maxWidth=Le(i.width)),i.tooltipEle.appendChild(i.createElement("div",{className:tT})),this.appendContainer(i),K([i.tooltipEle],w4),i.addDescribedBy(t,i.ctrlId+"_content"),i.renderContent(t),Y([i.tooltipEle],lp),i.showTipPointer&&i.renderArrow(),i.renderCloseIcon(),i.renderPopup(t),i.adjustArrow(t,i.position,i.tooltipPositionX,i.tooltipPositionY),It.stop(i.tooltipEle),i.reposition(t))},e.prototype.tooltipAfterRender=function(t,i,r,n){if(t){K([n.tooltipEle],lp),Y([n.tooltipEle],dC),n.tooltipEventArgs={type:i?i.type:null,cancel:!1,target:t,event:i||null,element:n.tooltipEle,isInteracted:!g(i)},n.needTemplateReposition()&&!n.mouseTrail&&(r.effect==="None"||r.effect==="FadeIn"||this.isReact&&typeof n.content!="string")&&(n.tooltipEle.style.display="none");var s=function(a){n.beforeOpenCallback(a,t,r,i)};n.trigger("beforeOpen",n.tooltipEventArgs,s.bind(n))}},e.prototype.beforeOpenCallback=function(t,i,r,n){var s=this;if(t.cancel)this.isHidden=!0,this.clear(),this.mouseMoveBeforeRemove(),this.restoreElement(i);else{var a={name:r.effect==="None"&&Ut==="Enable"?"FadeIn":this.animation.open.effect,duration:r.duration,delay:r.delay,timingFunction:"easeOut"};if(r.effect==="None"&&(a=void 0),this.openDelay>0){var l=function(){s.mouseTrail&&E.add(i,"mousemove touchstart mouseenter",s.onMouseMove,s),s.popupObj&&(s.popupObj.show(a,i),s.mouseMoveEvent&&s.mouseTrail&&s.onMouseMove(s.mouseMoveEvent))};this.showTimer=setTimeout(l,this.openDelay)}else this.popupObj&&this.popupObj.show(a,i)}n&&this.wireMouseEvents(n,i)},e.prototype.needTemplateReposition=function(){var t=this;return!g(t.viewContainerRef)&&typeof t.viewContainerRef!="string"||this.isReact},e.prototype.checkCollision=function(t,i,r){var n={left:i,top:r,position:this.position,horizontal:this.tooltipPositionX,vertical:this.tooltipPositionY},s=is(this.tooltipEle,this.checkCollideTarget(),i,r);return s.length>0&&(n.horizontal=s.indexOf("left")>=0?"Right":s.indexOf("right")>=0?"Left":this.tooltipPositionX,n.vertical=s.indexOf("top")>=0?"Bottom":s.indexOf("bottom")>=0?"Top":this.tooltipPositionY),n},e.prototype.calculateElementPosition=function(t,i){return[this.isBodyContainer?t.left+i.left:t.left-this.containerElement.getBoundingClientRect().left+i.left+window.pageXOffset+this.containerElement.scrollLeft,this.isBodyContainer?t.top+i.top:t.top-this.containerElement.getBoundingClientRect().top+i.top+window.pageYOffset+this.containerElement.scrollTop]},e.prototype.collisionFlipFit=function(t,i,r){var n=this.checkCollision(t,i,r),s=n.position;if(this.tooltipPositionY!==n.vertical&&(s=this.position.indexOf("Bottom")===0||this.position.indexOf("Top")===0?n.vertical+this.tooltipPositionX:this.tooltipPositionX+n.vertical),this.tooltipPositionX!==n.horizontal&&(s.indexOf("Left")===0&&(n.vertical=s==="LeftTop"||s==="LeftCenter"?"Top":"Bottom",s=n.vertical+"Left"),s.indexOf("Right")===0&&(n.vertical=s==="RightTop"||s==="RightCenter"?"Top":"Bottom",s=n.vertical+"Right"),n.horizontal=this.tooltipPositionX),this.tooltipEventArgs={type:null,cancel:!1,target:t,event:null,element:this.tooltipEle,collidedPosition:s},this.trigger("beforeCollision",this.tooltipEventArgs),this.tooltipEventArgs.cancel)s=this.position;else{var a=n.vertical,l=n.horizontal;if(n.position!==s){var h=br(t,l,a,!this.isBodyContainer,this.isBodyContainer?null:this.containerElement.getBoundingClientRect());this.adjustArrow(t,s,l,a);var u=this.getScalingFactor(t),c=this.calculateTooltipOffset(s,u.x,u.y);c.top-=this.getOffSetPosition("TopBottom",s,this.offsetY),c.left-=this.getOffSetPosition("RightLeft",s,this.offsetX),n.position=s;var d=this.calculateElementPosition(h,c);n.left=d[0],n.top=d[1]}else this.adjustArrow(t,s,l,a)}var p={left:n.left,top:n.top},f=this.isBodyContainer?hv(this.tooltipEle,this.checkCollideTarget(),{X:!0,Y:this.windowCollision},p):p;this.tooltipEle.style.display="block";var v=X("."+oc,this.tooltipEle);if(this.showTipPointer&&v!=null&&(s.indexOf("Bottom")===0||s.indexOf("Top")===0)){var m=parseInt(v.style.left,10)-(f.left-n.left);m<0?m=0:m+v.offsetWidth>this.tooltipEle.clientWidth&&(m=this.tooltipEle.clientWidth-v.offsetWidth),v.style.left=m.toString()+"px"}return this.tooltipEle.style.display="",p.left=f.left,p.top=f.top,p},e.prototype.getOffSetPosition=function(t,i,r){return t.indexOf(this.position.split(/(?=[A-Z])/)[0])!==-1&&t.indexOf(i.split(/(?=[A-Z])/)[0])!==-1?2*r:0},e.prototype.checkCollideTarget=function(){return!this.windowCollision&&this.target?this.element:null},e.prototype.hideTooltip=function(t,i,r){var n=this;if(this.closeDelay>0){clearTimeout(this.hideTimer),clearTimeout(this.showTimer);var s=function(){n.closeDelay&&n.tooltipEle&&n.isTooltipOpen||n.tooltipHide(t,i,r)};this.hideTimer=setTimeout(s,this.closeDelay)}else this.tooltipHide(t,i,r)},e.prototype.tooltipHide=function(t,i,r){var n=this,s;i?s=this.target?r||i.target:this.element:s=X('[data-tooltip-id= "'+this.ctrlId+'_content"]',document),this.tooltipEventArgs={type:i?i.type:null,cancel:!1,target:s,event:i||null,element:this.tooltipEle,isInteracted:!g(i)},this.trigger("beforeClose",this.tooltipEventArgs,function(a){a.cancel?n.isHidden=!1:(n.mouseMoveBeforeRemove(),n.popupHide(t,s,i))})},e.prototype.popupHide=function(t,i,r){i&&r&&this.restoreElement(i),this.isHidden=!0;var n={name:t.effect==="None"&&Ut==="Enable"?"FadeOut":this.animation.close.effect,duration:t.duration,delay:t.delay,timingFunction:"easeIn"};t.effect==="None"&&(n=void 0),this.popupObj&&this.popupObj.hide(n)},e.prototype.restoreElement=function(t){this.unwireMouseEvents(t),g(t.getAttribute("data-content"))||(t.setAttribute("title",t.getAttribute("data-content")),t.removeAttribute("data-content")),this.removeDescribedBy(t)},e.prototype.clear=function(){var t=this.findTarget();t&&this.restoreElement(t),this.tooltipEle&&(K([this.tooltipEle],dC),Y([this.tooltipEle],lp)),this.isHidden&&(this.popupObj&&this.popupObj.destroy(),this.tooltipEle&&Ue(this.tooltipEle),this.tooltipEle=null,this.popupObj=null)},e.prototype.tooltipHover=function(){this.tooltipEle&&(this.isTooltipOpen=!0)},e.prototype.tooltipMouseOut=function(t){this.isTooltipOpen=!1,this.hideTooltip(this.animation.close,t,this.findTarget())},e.prototype.onMouseOut=function(t){var i=t.relatedTarget;if(i&&!this.mouseTrail){var r=j(i,"."+lC+"."+Zg+"."+cC);r?E.add(r,"mouseleave",this.tooltipElementMouseOut,this):(this.hideTooltip(this.animation.close,t,this.findTarget()),this.closeDelay===0&&(this.animation.close.effect==="None"||this.isReact&&typeof this.content!="string")&&this.clear())}else this.hideTooltip(this.animation.close,t,this.findTarget()),this.clear();this.popupObj&&!this.popupObj.element.classList.contains(lp)&&this.clear()},e.prototype.tooltipElementMouseOut=function(t){this.hideTooltip(this.animation.close,t,this.findTarget()),E.remove(this.element,"mouseleave",this.tooltipElementMouseOut),this.clear()},e.prototype.onStickyClose=function(){this.close()},e.prototype.onMouseMove=function(t){var i=0,r=0;if(t.type.indexOf("touch")>-1?(t.preventDefault(),i=t.touches[0].pageX,r=t.touches[0].pageY):(i=t.pageX,r=t.pageY),!g(this.tooltipEle)){It.stop(this.tooltipEle),K([this.tooltipEle],dC),Y([this.tooltipEle],lp),this.adjustArrow(t.target,this.position,this.tooltipPositionX,this.tooltipPositionY);var n=this.getScalingFactor(t.target),s=this.calculateTooltipOffset(this.position,n.x,n.y),a=i+s.left+this.offsetX,l=r+s.top+this.offsetY,h=this.checkCollision(t.target,a,l);if(this.tooltipPositionX!==h.horizontal||this.tooltipPositionY!==h.vertical){var u=this.position.indexOf("Bottom")===0||this.position.indexOf("Top")===0?h.vertical+h.horizontal:h.horizontal+h.vertical;h.position=u,this.adjustArrow(t.target,h.position,h.horizontal,h.vertical);var c=this.calculateTooltipOffset(h.position,n.x,n.y);h.left=i+c.left-this.offsetX,h.top=r+c.top-this.offsetY}this.tooltipEle.style.left=h.left+"px",this.tooltipEle.style.top=h.top+"px"}},e.prototype.keyDown=function(t){this.tooltipEle&&t.keyCode===27&&this.close()},e.prototype.touchEnd=function(t){this.tooltipEle&&j(t.target,"."+oC)===null&&!this.isSticky&&this.close()},e.prototype.scrollHandler=function(t){this.tooltipEle&&!this.isSticky&&!j(t.target,"."+lC+"."+Zg+"."+cC)&&!this.isSticky&&this.close()},e.prototype.render=function(){this.initialize(),this.wireEvents(this.opensOn),this.renderComplete()},e.prototype.preRender=function(){this.tipClass=op,this.tooltipPositionX="Center",this.tooltipPositionY="Top",this.isHidden=!0},e.prototype.wireEvents=function(t){for(var i=this.getTriggerList(t),r=0,n=i;r<n.length;r++){var s=n[r];if(s==="Custom")return;s==="Focus"&&this.wireFocusEvents(),s==="Click"&&E.add(this.element,B.touchStartEvent,this.targetClick,this),s==="Hover"&&(B.isDevice?(this.touchModule=new Fr(this.element,{tapHoldThreshold:b4,tapHold:this.tapHoldHandler.bind(this)}),E.add(this.element,B.touchEndEvent,this.touchEndHandler,this)):E.add(this.element,"mouseover",this.targetHover,this))}this.windowResizeBound=this.windowResize.bind(this),this.keyDownBound=this.keyDown.bind(this),this.touchEndBound=this.touchEnd.bind(this),this.scrollWheelBound=this.scrollHandler.bind(this),document.addEventListener("wheel",this.scrollWheelBound),document.addEventListener("scroll",this.scrollWheelBound),document.addEventListener("touchend",this.touchEndBound),document.addEventListener("keydown",this.keyDownBound),window.addEventListener("resize",this.windowResizeBound)},e.prototype.getTriggerList=function(t){return t?(t==="Auto"&&(t=B.isDevice?"Hover":"Hover Focus"),t.split(" ")):[]},e.prototype.wireFocusEvents=function(){if(g(this.target))E.add(this.element,"focusin",this.targetHover,this);else{var t=[].slice.call(Oe(this.target,this.element));if(this.targetsList=t,!g(this.targetsList)&&this.targetsList.length>0)for(var i=0,r=t;i<r.length;i++){var n=r[i];E.add(n,"focus",this.targetHover,this)}else E.add(this.element,"focusin",this.targetHover,this)}},e.prototype.wireMouseEvents=function(t,i){this.tooltipEle&&(this.isSticky||(t.type==="focus"&&E.add(i,"blur",this.onMouseOut,this),t.type==="focusin"&&E.add(i,"focusout",this.onMouseOut,this),t.type==="mouseover"&&E.add(i,"mouseleave",this.onMouseOut,this),this.closeDelay&&(E.add(this.tooltipEle,"mouseenter",this.tooltipHover,this),E.add(this.tooltipEle,"mouseleave",this.tooltipMouseOut,this))),this.mouseTrail&&this.openDelay===0&&E.add(i,"mousemove touchstart mouseenter",this.onMouseMove,this))},e.prototype.unwireEvents=function(t){for(var i=this.getTriggerList(t),r=0,n=i;r<n.length;r++){var s=n[r];if(s==="Custom")return;s==="Focus"&&this.unwireFocusEvents(),s==="Click"&&E.remove(this.element,B.touchStartEvent,this.targetClick),s==="Hover"&&(B.isDevice?(this.touchModule&&this.touchModule.destroy(),E.remove(this.element,B.touchEndEvent,this.touchEndHandler)):E.remove(this.element,"mouseover",this.targetHover))}document.removeEventListener("touchend",this.touchEndBound),this.touchEndBound=null,document.removeEventListener("wheel",this.scrollWheelBound),document.removeEventListener("scroll",this.scrollWheelBound),this.scrollWheelBound=null,window.removeEventListener("resize",this.windowResizeBound),this.windowResizeBound=null,document.removeEventListener("keydown",this.keyDownBound),this.keyDownBound=null},e.prototype.unwireFocusEvents=function(){if(g(this.target))E.remove(this.element,"focusin",this.targetHover);else{var t=[].slice.call(Oe(this.target,this.element));if(!g(this.targetsList)&&this.targetsList.length>0)for(var i=0,r=t;i<r.length;i++){var n=r[i];E.remove(n,"focus",this.targetHover)}else E.remove(this.element,"focusin",this.targetHover)}},e.prototype.unwireMouseEvents=function(t){if(!this.isSticky){for(var i=this.getTriggerList(this.opensOn),r=0,n=i;r<n.length;r++){var s=n[r];s==="Focus"&&(E.remove(t,"blur",this.onMouseOut),E.remove(t,"focusout",this.onMouseOut)),s==="Hover"&&!B.isDevice&&E.remove(t,"mouseleave",this.onMouseOut)}this.closeDelay&&(E.remove(t,"mouseenter",this.tooltipHover),E.remove(t,"mouseleave",this.tooltipMouseOut))}this.mouseTrail&&E.remove(t,"mousemove touchstart mouseenter",this.onMouseMove)},e.prototype.findTarget=function(){var t=X('[data-tooltip-id= "'+this.ctrlId+'_content"]',document);return t},e.prototype.getModuleName=function(){return"tooltip"},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.onPropertyChanged=function(t,i){for(var r=this.findTarget(),n=0,s=Object.keys(t);n<s.length;n++){var a=s[n];switch(a){case"width":this.tooltipEle&&r&&(this.tooltipEle.style.width=this.tooltipEle.style.maxWidth=Le(t.width),this.reposition(r));break;case"height":this.tooltipEle&&r&&(this.tooltipEle.style.height=Le(t.height),this.reposition(r));break;case"content":this.tooltipEle&&this.renderContent();break;case"opensOn":this.unwireEvents(i.opensOn),this.wireEvents(t.opensOn);break;case"position":if(this.formatPosition(),this.tooltipEle&&r){var l=X("."+Kg,this.tooltipEle);l&&(l.style.top=l.style.left=null),this.reposition(r)}break;case"tipPointerPosition":this.tooltipEle&&r&&this.reposition(r);break;case"offsetX":if(this.tooltipEle){var h=t.offsetX-i.offsetX;this.tooltipEle.style.left=(parseInt(this.tooltipEle.style.left,10)+h).toString()+"px"}break;case"offsetY":if(this.tooltipEle){var u=t.offsetY-i.offsetY;this.tooltipEle.style.top=(parseInt(this.tooltipEle.style.top,10)+u).toString()+"px"}break;case"cssClass":this.tooltipEle&&(i.cssClass&&K([this.tooltipEle],i.cssClass.split(" ")),t.cssClass&&Y([this.tooltipEle],t.cssClass.split(" ")));break;case"enableRtl":this.tooltipEle&&(this.enableRtl?Y([this.tooltipEle],ZA):K([this.tooltipEle],ZA));break;case"isSticky":this.tooltipEle&&r&&(this.renderCloseIcon(),this.reposition(r));break;case"container":g(this.containerElement)||K([this.containerElement],nT),this.container=t.container,this.tooltipEle&&r&&(this.appendContainer(this),this.reposition(r))}}},e.prototype.open=function(t,i){g(i)&&(i=this.animation.open),g(t)&&(t=this.element),t.style.display!=="none"&&this.showTooltip(t,i)},e.prototype.close=function(t){t||(t=this.animation.close),this.hideTooltip(t)},e.prototype.refresh=function(t){if(this.tooltipEle&&this.renderContent(t),this.popupObj&&t&&this.reposition(t),!g(this.targetsList)&&!g(this.target)){var i=Oe(this.target,this.element);i.length!==this.targetsList.length&&(this.unwireEvents(this.opensOn),this.wireEvents(this.opensOn))}},e.prototype.destroy=function(){o.prototype.destroy.call(this),this.tooltipEle&&Ue(this.tooltipEle),this.popupObj&&this.popupObj.destroy(),LT(),K([this.element],oC),this.unwireEvents(this.opensOn),this.unwireMouseEvents(this.element),this.tooltipEle=null,this.popupObj=null;for(var t=Oe('[data-tooltip-id= "'+this.ctrlId+'_content"]',this.element),i=0,r=t;i<r.length;i++){var n=r[i];this.restoreElement(n)}this.containerElement=null,this.tipClass=null,this.tooltipPositionX=null,this.tooltipPositionY=null,this.ctrlId=null,this.tooltipEventArgs=null,this.touchModule=null,this.mouseMoveEvent=null,this.mouseMoveTarget=null,this.containerElement=null,this.targetsList=null},xi([C("auto")],e.prototype,"width",void 0),xi([C("auto")],e.prototype,"height",void 0),xi([C()],e.prototype,"content",void 0),xi([C("body")],e.prototype,"container",void 0),xi([C()],e.prototype,"target",void 0),xi([C("TopCenter")],e.prototype,"position",void 0),xi([C(0)],e.prototype,"offsetX",void 0),xi([C(0)],e.prototype,"offsetY",void 0),xi([C(!0)],e.prototype,"showTipPointer",void 0),xi([C(!0)],e.prototype,"enableHtmlParse",void 0),xi([C(!1)],e.prototype,"windowCollision",void 0),xi([C("Auto")],e.prototype,"tipPointerPosition",void 0),xi([C("Auto")],e.prototype,"opensOn",void 0),xi([C(!1)],e.prototype,"mouseTrail",void 0),xi([C(!1)],e.prototype,"isSticky",void 0),xi([be({},x4)],e.prototype,"animation",void 0),xi([C(0)],e.prototype,"openDelay",void 0),xi([C(0)],e.prototype,"closeDelay",void 0),xi([C()],e.prototype,"cssClass",void 0),xi([C(!0)],e.prototype,"enableHtmlSanitizer",void 0),xi([C("")],e.prototype,"htmlAttributes",void 0),xi([q()],e.prototype,"beforeRender",void 0),xi([q()],e.prototype,"beforeOpen",void 0),xi([q()],e.prototype,"afterOpen",void 0),xi([q()],e.prototype,"beforeClose",void 0),xi([q()],e.prototype,"afterClose",void 0),xi([q()],e.prototype,"beforeCollision",void 0),xi([q()],e.prototype,"created",void 0),xi([q()],e.prototype,"destroyed",void 0),e=xi([bt],e),e}(Kt),sn={},I4=30,M4=30,sT=30,D4=30,E4=30,A4=30,T4=36,L4=36,pC="e-spin-show",tv="e-spin-hide",aT="e-spin-material",oT="e-spin-material3",lT="e-spin-tailwind3",hT="e-spin-fabric",uT="e-spin-fluent",cT="e-spin-fluent2",dT="e-spin-tailwind",k4="e-spin-bootstrap",pT="e-spin-bootstrap4",fT="e-spin-bootstrap5",gT="e-spin-high-contrast",fC="e-spinner-pane",TC="e-spinner-inner",cv="e-path-circle",N4="e-path-arc",F4="e-spin-label",gC="e-spin-template",vT=null,O4=null;function Os(o,e){var t;if(o.target){var i,r=g(e)?Xe:e,n=rH(o.target,r);if(!g(o.cssClass)){var s=o.cssClass.split(" ").filter(function(u){return u.trim()!==""});(t=n.wrap.classList).add.apply(t,s)}if(!g(o.template)||!g(vT)){var a=g(o.template)?vT:o.template;n.wrap.classList.add(gC),eH(n.wrap,a,O4)}else{var l=g(o.type)?Y4(n.wrap):o.type,h=g(o.width)?void 0:o.width;i=tH(h,l),Q4(l,n.wrap,i,r),g(o.label)||R4(n.inner_wrap,o.label,r)}n.wrap.classList.add(tv),n=null}}function R4(o,e,t){var i=t("div",{});return i.classList.add(F4),i.innerHTML=e,o.appendChild(i),i}function P4(o,e,t){var i=Pa();sn[""+i]={timeOut:0,type:"Material",radius:e},gp(o,i,t,aT),vp(e,o,"Material",aT)}function B4(o,e,t){var i=Pa();sn[""+i]={timeOut:0,type:"Tailwind3",radius:e},gp(o,i,t,lT),vp(e,o,"Tailwind3",lT)}function z4(o,e,t){var i=Pa();sn[""+i]={timeOut:0,type:"Material3",radius:e},gp(o,i,t,oT),vp(e,o,"Material3",oT)}function j4(o,e,t){var i=Pa();sn[""+i]={timeOut:0,type:"Bootstrap4",radius:e},gp(o,i,t,pT),vp(e,o,"Bootstrap4",pT)}function H4(o,e,t){var i=Pa();sn[""+i]={timeOut:0,type:"Bootstrap5",radius:e},gp(o,i,t,fT),vp(e,o,"Bootstrap5",fT)}function V4(o,e,t){var i={},r=0;sn[""+e].timeOut=0,i[""+e]=iH(e,t,0,0);var n={uniqueID:e,container:o,globalInfo:i,timeOutVar:r};HT(n)}function _4(o,e,t){var i=Pa();sn[""+i]={timeOut:0,type:"Fabric",radius:e},fp(o,i,hT),mp(e,o,hT)}function U4(o,e,t){var i=Pa();sn[""+i]={timeOut:0,type:"Fluent",radius:e},fp(o,i,uT),mp(e,o,uT)}function W4(o,e,t){var i=Pa();sn[""+i]={timeOut:0,type:"Fluent2",radius:e},fp(o,i,cT),mp(e,o,cT)}function q4(o,e,t){var i=Pa();sn[""+i]={timeOut:0,type:"Tailwind",radius:e},fp(o,i,dT),mp(e,o,dT)}function G4(o,e,t){var i=Pa();sn[""+i]={timeOut:0,type:"HighContrast",radius:e},fp(o,i,gT),mp(e,o,gT)}function Y4(o){var e=window.getComputedStyle(o,":after").getPropertyValue("content");return e.replace(/['"]+/g,"")}function Q4(o,e,t,i){var r=e.querySelector("."+TC),n=r.querySelector("svg");switch(g(n)||r.removeChild(n),o){case"Material":P4(r,t,i);break;case"Material3":z4(r,t,i);break;case"Fabric":_4(r,t);break;case"Fluent":U4(r,t);break;case"Fluent2":W4(r,t);break;case"Bootstrap":X4(r,t);break;case"HighContrast":G4(r,t);break;case"Bootstrap4":j4(r,t,i);break;case"Bootstrap5":H4(r,t,i);break;case"Tailwind":case"Tailwind-dark":q4(r,t);break;case"Tailwind3":B4(r,t,i);break}}function X4(o,e,t){var i=Pa();sn[""+i]={timeOut:0,type:"Bootstrap",radius:e},$4(o,i),K4(o,e)}function $4(o,e,t){var i=document.createElementNS("http://www.w3.org/2000/svg","svg"),r=64,n=32,s=2;i.setAttribute("id",e),i.setAttribute("class",k4),i.setAttribute("viewBox","0 0 "+r+" "+r),o.insertBefore(i,o.firstChild);for(var a=0;a<=7;a++){var l=document.createElementNS("http://www.w3.org/2000/svg","circle");l.setAttribute("class",cv+"_"+a),l.setAttribute("r",s+""),l.setAttribute("transform","translate("+n+","+n+")"),i.appendChild(l)}}function K4(o,e){var t=o.querySelector("svg.e-spin-bootstrap"),i=0,r=0,n=24;t.style.width=t.style.height=e+"px";for(var s=90,a=0;a<=7;a++){var l=vC(i,r,n,s),h=t.querySelector("."+cv+"_"+a);h.setAttribute("cx",l.x+""),h.setAttribute("cy",l.y+""),s=s>=360?0:s,s=s+45}}function Z4(o,e){var t=[],i=o,r=e,n=!1,s=1;a(i);function a(l){t.push(l),(l!==r||s===1)&&(l<=i&&l>1&&!n?l=parseFloat((l-.2).toFixed(2)):l===1?(l=7,l=parseFloat((l+.2).toFixed(2)),n=!0):l<8&&n?(l=parseFloat((l+.2).toFixed(2)),l===8&&(n=!1)):l<=8&&!n&&(l=parseFloat((l-.2).toFixed(2))),++s,a(l))}return t}function J4(o){for(var e=o.querySelector("svg.e-spin-bootstrap"),t=e.getAttribute("id"),i=1;i<=8;i++){var r=o.getElementsByClassName("e-path-circle_"+(i===8?0:i))[0];n(r,i,i,Z4(i,i),t)}function n(s,a,l,h,u){var c=0;d(a);function d(p){sn[""+u].isAnimate&&(++c,s.setAttribute("r",p+""),c>=h.length&&(c=0),sn[u].timeOut=setTimeout(d.bind(null,h[c]),18))}}}function eH(o,e,t){g(t)||o.classList.add(t);var i=o.querySelector(".e-spinner-inner");i.innerHTML=e}function tH(o,e){var t;switch(e){case"Material":t=I4;break;case"Material3":t=M4;break;case"Fabric":t=sT;break;case"Tailwind":case"Tailwind-dark":case"Tailwind3":t=sT;break;case"Fluent":t=D4;break;case"Fluent2":t=E4;break;case"Bootstrap4":t=T4;break;case"Bootstrap5":t=L4;break;default:t=A4}return o=o?parseFloat(o+""):t,e==="Bootstrap"?o:o/2}function iH(o,e,t,i){return{radius:e,count:t,previousId:i}}function Pa(){for(var o="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=0;t<5;t++)o+=e.charAt(Math.floor(Math.random()*e.length));return o}function fp(o,e,t,i){var r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("id",e),r.setAttribute("class",t);var n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("class",cv);var s=document.createElementNS("http://www.w3.org/2000/svg","path");s.setAttribute("class",N4),o.insertBefore(r,o.firstChild),r.appendChild(n),r.appendChild(s)}function gp(o,e,t,i){var r=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("class",i),r.setAttribute("id",e),n.setAttribute("class",cv),o.insertBefore(r,o.firstChild),r.appendChild(n)}function rH(o,e){var t=e("div",{}),i=e("div",{});return t.classList.add(fC),i.classList.add(TC),i.setAttribute("aria-disabled","true"),o.appendChild(t),t.appendChild(i),{wrap:t,inner_wrap:i}}function HT(o){var e=1,t=149,i=1333,r=75;nH(e,t,oH,i,o.globalInfo[o.uniqueID].count,r,o),o.globalInfo[o.uniqueID].count=++o.globalInfo[o.uniqueID].count%4}function nH(o,e,t,i,r,n,s){var a=++s.globalInfo[s.uniqueID].previousId,l=new Date().getTime(),h=e-o,u=sH(s.globalInfo[s.uniqueID].radius*2+""),c=VT(u),d=-90*(s.globalInfo[s.uniqueID].count||0);p(s);function p(v){var m=Math.max(0,Math.min(new Date().getTime()-l,i));f(t(m,o,h,i),v.container),a===v.globalInfo[v.uniqueID].previousId&&m<i?sn[v.uniqueID].timeOut=setTimeout(p.bind(null,v),1):HT(v)}function f(v,m){if(!g(m.querySelector("svg.e-spin-material"))||!g(m.querySelector("svg.e-spin-material3"))||!g(m.querySelector("svg.e-spin-tailwind3"))){var y=void 0;if(!g(m.querySelector("svg.e-spin-material"))&&!g(m.querySelector("svg.e-spin-material").querySelector("path.e-path-circle"))?y=m.querySelector("svg.e-spin-material"):!g(m.querySelector("svg.e-spin-material3"))&&!g(m.querySelector("svg.e-spin-material3").querySelector("path.e-path-circle"))?y=m.querySelector("svg.e-spin-material3"):!g(m.querySelector("svg.e-spin-tailwind3"))&&!g(m.querySelector("svg.e-spin-tailwind3").querySelector("path.e-path-circle"))&&(y=m.querySelector("svg.e-spin-tailwind3")),!g(y)){var S=y.querySelector("path.e-path-circle");S.setAttribute("stroke-dashoffset",_T(u,c,v,n)+""),S.setAttribute("transform","rotate("+d+" "+u/2+" "+u/2+")")}}}}function vp(o,e,t,i){var r=o*2,n=e.querySelector("svg."+i),s=n.querySelector("path.e-path-circle"),a=VT(r),l=r/2+"px";n.setAttribute("viewBox","0 0 "+r+" "+r),n.style.width=n.style.height=r+"px",n.style.transformOrigin=l+" "+l+" "+l,s.setAttribute("d",aH(r,a)),(t==="Material"||t==="Material3"||t==="Fluent2"||t==="Tailwind3")&&(s.setAttribute("stroke-width",a+""),s.setAttribute("stroke-dasharray",(r-a)*Math.PI*.75+""),s.setAttribute("stroke-dashoffset",_T(r,a,1,75)+""))}function sH(o){var e=parseFloat(o);return e}function aH(o,e){var t=o/2,i=e/2;return"M"+t+","+i+"A"+(t-i)+","+(t-i)+" 0 1 1 "+i+","+t}function VT(o){return 10/100*o}function _T(o,e,t,i){return(o-e)*Math.PI*(3*i/100-t/100)}function oH(o,e,t,i){var r=(o/=i)*o,n=r*o;return e+t*(6*n*r+-15*r*r+10*n)}function mp(o,e,t){var i=o,r=o,n=o*2,s=315,a=45,l=e.querySelector("."+t),h=l.querySelector(".e-path-circle"),u=l.querySelector(".e-path-arc"),c=n/2+"px";h.setAttribute("d",hH(i,r,o)),u.setAttribute("d",lH(i,r,o,s,a)),l.setAttribute("viewBox","0 0 "+n+" "+n),l.style.transformOrigin=c+" "+c+" "+c,l.style.width=l.style.height=n+"px"}function vC(o,e,t,i){var r=(i-90)*Math.PI/180;return{x:o+t*Math.cos(r),y:e+t*Math.sin(r)}}function lH(o,e,t,i,r){var n=vC(o,e,t,r),s=vC(o,e,t,i),a=["M",n.x,n.y,"A",t,t,0,0,0,s.x,s.y].join(" ");return a}function hH(o,e,t){var i=["M",o,e,"m",-t,0,"a",t,t,0,1,0,t*2,0,"a",t,t,0,1,0,-t*2,0].join(" ");return i}function rs(o){UT(o,!1),o=null}function UT(o,e){var t;if(o)if(o.classList.contains(fC))t=o;else{var i=o.querySelectorAll("."+fC);if(B.isIE){for(var r=0;r<i.length;r++)if(i[r].parentElement&&i[r].parentElement===o){t=i[r];break}}else t=Array.from(i).find(function(h){return h.parentElement===o})||null}if(o&&t){var n=t.querySelector("."+TC),s=e?!t.classList.contains(gC)&&!t.classList.contains(tv):!t.classList.contains(gC)&&!t.classList.contains(pC);if(s){var a=t.querySelector("svg");if(g(a))return;var l=a.getAttribute("id");switch(sn[""+l].isAnimate=!e,sn[""+l].type){case"Material":case"Material3":case"Tailwind3":e?clearTimeout(sn[l].timeOut):V4(n,l,sn[l].radius);break;case"Bootstrap":e?clearTimeout(sn[l].timeOut):J4(n);break}}e?wi(t,[tv],[pC]):wi(t,[pC],[tv]),o=null}}function Rs(o){UT(o,!0),o=null}var ei={li:"e-list-item",ul:"e-list-parent e-ul",group:"e-list-group-item",icon:"e-list-icon",text:"e-list-text",check:"e-list-check",checked:"e-checked",selected:"e-selected",expanded:"e-expanded",textContent:"e-text-content",hasChild:"e-has-child",level:"e-level",url:"e-list-url",collapsible:"e-icon-collapsible",disabled:"e-disabled",image:"e-list-img",iconWrapper:"e-icon-wrapper",anchorWrap:"e-anchor-wrap",navigable:"e-navigable"},At;(function(o){o.defaultMappedFields={id:"id",text:"text",url:"url",value:"value",isChecked:"isChecked",enabled:"enabled",expanded:"expanded",selected:"selected",iconCss:"iconCss",child:"child",isVisible:"isVisible",hasChildren:"hasChildren",tooltip:"tooltip",htmlAttributes:"htmlAttributes",urlAttributes:"urlAttributes",imageAttributes:"imageAttributes",imageUrl:"imageUrl",groupBy:null,sortBy:null};var e={level:1,listRole:"presentation",itemRole:"presentation",groupItemRole:"group",itemText:"list-item",wrapperRole:"presentation"},t={showCheckBox:!1,showIcon:!1,enableHtmlSanitizer:!1,expandCollapse:!1,fields:o.defaultMappedFields,ariaAttributes:e,listClass:"",itemClass:"",processSubChild:!1,sortOrder:"None",template:null,groupTemplate:null,headerTemplate:null,expandIconClass:"e-icon-collapsible",moduleName:"list",expandIconPosition:"Right",itemNavigable:!1};function i(T,k,F,R,N){var P=he({},t,F),O=he({},e,P.ariaAttributes),z=f(k).typeof;return z==="string"||z==="number"?r(T,k,R,F,N):a(T,k,F,O.level,R,N)}o.createList=i;function r(T,k,F,R,N){var P=n(T,k,F,R,N);return A(T,P,null,R)}o.createListFromArray=r;function n(T,k,F,R,N){var P=[],O=he({},t,R);ei=x(O.moduleName);for(var z=b(),H=0;H<k.length;H++)if(!g(k[H])){var Q=void 0;if(O.itemCreating&&typeof O.itemCreating=="function"){var $={dataSource:k,curData:k[H],text:k[H],options:O};O.itemCreating($)}if(F?Q=I(T,k[H],void 0,null,null,[],null,z,H,R):Q=D(T,k[H],void 0,null,null,R,N),O.itemCreated&&typeof O.itemCreated=="function"){var $={dataSource:k,curData:k[H],text:k[H],item:Q,options:O};O.itemCreated($)}P.push(Q)}return P}o.createListItemFromArray=n;function s(T,k,F,R,N,P){var O=he({},t,F);ei=x(O.moduleName);var z=P&&(P.getModuleName()==="listview"||P.getModuleName()==="multiselect")?O.fields:he({},o.defaultMappedFields,O.fields),H=he({},e,O.ariaAttributes),Q,$=[];R&&(H.level=R);var U=[],ie,ne;k&&k.length&&!g(f(k).item)&&!Object.prototype.hasOwnProperty.call(f(k).item,z.id)&&(Q=b());for(var te=0;te<k.length;te++){var oe=Sn(k[te],z);if(!g(k[te])){if(O.itemCreating&&typeof O.itemCreating=="function"){var ae={dataSource:k,curData:k[te],text:oe[z.text],options:O,fields:z};O.itemCreating(ae)}var ye=k[te];O.itemCreating&&typeof O.itemCreating=="function"&&(oe=Sn(k[te],z)),Object.prototype.hasOwnProperty.call(oe,z.id)&&!g(oe[z.id])&&(Q=oe[z.id]);var De=[];if(O.showCheckBox&&(O.itemNavigable&&(oe[z.url]||oe[z.urlAttributes])?$.push(T("input",{className:ei.check,attrs:{type:"checkbox"}})):De.push(T("input",{className:ei.check,attrs:{type:"checkbox"}}))),N===!0){if(O.showIcon&&Object.prototype.hasOwnProperty.call(oe,z.iconCss)&&!g(oe[z.iconCss])&&De.push(T("span",{className:ei.icon+" "+oe[z.iconCss]})),ie=I(T,ye,oe,z,O.itemClass,De,!!(Object.prototype.hasOwnProperty.call(ye,"isHeader")&&ye.isHeader),Q,te,F),ne=ie.querySelector("."+ei.anchorWrap),Object.prototype.hasOwnProperty.call(oe,z.tooltip)){var ve=oe[z.tooltip];if(F&&F.enableHtmlSanitizer)ve=Bt.sanitize(ve);else{var ue=T("span",{innerHTML:ve});ve=ue.innerText,ue=null}ie.setAttribute("title",ve)}O.itemNavigable&&$.length&&jr($,ie.firstElementChild)}else{if(ie=D(T,ye,oe,z,O.itemClass,F,P),ie.classList.add(ei.level+"-"+H.level),ie.setAttribute("aria-level",H.level.toString()),(H.groupItemRole==="presentation"||H.itemRole==="presentation")&&ie.removeAttribute("aria-level"),ne=ie.querySelector("."+ei.anchorWrap),Object.prototype.hasOwnProperty.call(oe,z.tooltip)){var ve=oe[z.tooltip];if(F&&F.enableHtmlSanitizer)ve=Bt.sanitize(ve);else{var ue=T("span",{innerHTML:ve});ve=ue.innerText,ue=null}ie.setAttribute("title",ve)}if(Object.prototype.hasOwnProperty.call(oe,z.htmlAttributes)&&oe[z.htmlAttributes]){var Tt=oe[z.htmlAttributes];"class"in Tt&&typeof Tt.class=="string"&&Tt.class.trim()===""&&delete Tt.class,v(ie,Tt)}if(Object.prototype.hasOwnProperty.call(oe,z.enabled)&&oe[z.enabled]===!1&&ie.classList.add(ei.disabled),Object.prototype.hasOwnProperty.call(oe,z.isVisible)&&oe[z.isVisible]===!1&&(ie.style.display="none"),Object.prototype.hasOwnProperty.call(oe,z.imageUrl)&&!g(oe[z.imageUrl])&&!O.template){var _e={src:oe[z.imageUrl],alt:g(oe.name)?"Displaying Image":"Displaying "+oe.name+" Image"};ht(_e,oe[z.imageAttributes]);var lt=T("img",{className:ei.image,attrs:_e});ne?ne.insertAdjacentElement("afterbegin",lt):jr([lt],ie.firstElementChild)}if(O.showIcon&&Object.prototype.hasOwnProperty.call(oe,z.iconCss)&&!g(oe[z.iconCss])&&!O.template){var We=T("div",{className:ei.icon+" "+oe[z.iconCss]});ne?ne.insertAdjacentElement("afterbegin",We):jr([We],ie.firstElementChild)}De.length&&jr(De,ie.firstElementChild),O.itemNavigable&&$.length&&jr($,ie.firstElementChild),w(T,oe,z,k,O,ie,H.level)}if(ne&&Y([ie],[ei.navigable]),O.itemCreated&&typeof O.itemCreated=="function"){var ae={dataSource:k,curData:k[te],text:oe[z.text],item:ie,options:O,fields:z};O.itemCreated(ae)}$=[],U.push(ie)}}return U}o.createListItemFromJson=s;function a(T,k,F,R,N,P){var O=he({},t,F),z=s(T,k,F,R,N,P);return A(T,z,O.listClass,F)}o.createListFromJson=a;function l(T,k,F){if(ei=x(t.moduleName),!(!T||!T.length)){var R,N,P=Array.prototype.slice.call(T);for(k?N=h(k,P):N=F===!0?P.length:-1,R=P[N+(F===!0?-1:1)];R&&(!gr(R)||R.classList.contains(ei.disabled));)N=N+(F===!0?-1:1),R=P[N];return R}}o.getSiblingLI=l;function h(T,k){if(!(!k||!T)){var F=k;return F=Array.prototype.slice.call(k),F.indexOf(T)}}o.indexOf=h;function u(T,k,F){F===void 0&&(F="None");var R=he({},o.defaultMappedFields,k),N=new Pe().group(R.groupBy);N=c(F,"key",N);var P=d(T,N);T=[];for(var O=0;O<P.length;O++){var z=P[O].items,H={},Q="isHeader";H[R.text]=P[O].key,H[""+Q]=!0;var $=R.text;$==="id"&&($="text",H[""+$]=P[O].key),H._id="group-list-item-"+(P[O].key?P[O].key.toString().trim():"undefined"),H.items=z,T.push(H);for(var U=0;U<z.length;U++)T.push(z[U])}return T}o.groupDataSource=u;function c(T,k,F){if(F===void 0&&(F=new Pe),T==="Ascending")F.sortBy(k,"ascending",!0);else if(T==="Descending")F.sortBy(k,"descending",!0);else for(var R=0;R<F.queries.length;R++)F.queries[R].fn==="onSortBy"&&F.queries.splice(R,1);return F}o.addSorting=c;function d(T,k){return new re(T).executeLocal(k)}o.getDataSource=d;function p(T,k){var F=he({},t,k),R=he({},o.defaultMappedFields,F.fields),N=T.cloneNode(!0),P=[];N.classList.add("json-parent");var O=N.querySelectorAll(".json-parent>li");N.classList.remove("json-parent");for(var z=0;z<O.length;z++){for(var H=O[z],Q=H.querySelector("a"),$=H.querySelector("ul"),U={},ie=Q?Q.childNodes:H.childNodes,ne=Object.keys(ie),te=0;te<ie.length;te++)ie[Number(ne[te])].hasChildNodes()||(U[R.text]=ie[Number(ne[te])].textContent);var oe=m(H);oe.id?(U[R.id]=oe.id,delete oe.id):U[R.id]=b(),Object.keys(oe).length&&(U[R.htmlAttributes]=oe),Q&&(oe=m(Q),Object.keys(oe).length&&(U[R.urlAttributes]=oe)),$&&(U[R.child]=p($,k)),P.push(U)}return P}o.createJsonFromElement=p;function f(T){for(var k={typeof:null,item:null},F=0;F<T.length;F++)if(!g(T[F]))return k={typeof:typeof T[F],item:T[F]};return k}function v(T,k){var F={};ht(F,k),F.class&&(Y([T],F.class.split(" ")),delete F.class),Ie(T,F)}function m(T){for(var k={},F=T.attributes,R=0;R<F.length;R++)k[F[R].nodeName]=F[R].nodeValue;return k}function y(T,k,F,R,N,P){ei=x(t.moduleName);for(var O=T("ul",{className:ei.ul,attrs:{role:"presentation"}}),z=he({},t,N),H=he({},o.defaultMappedFields,R),Q=dv(k),$=[],U,ie=b(),ne=0;ne<F.length;ne++){var te=Sn(F[ne],H),oe=F[ne],ae=oe.isHeader;if(typeof F[ne]=="string"||typeof F[ne]=="number"?U=oe:U=te[H.value],z.itemCreating&&typeof z.itemCreating=="function"){var ye={dataSource:F,curData:oe,text:U,options:z,fields:H};z.itemCreating(ye)}z.itemCreating&&typeof z.itemCreating=="function"&&(te=Sn(F[ne],H),typeof F[ne]=="string"||typeof F[ne]=="number"?U=oe:U=te[H.value]);var De=T("li",{id:ie+"-"+ne,className:ae?ei.group:ei.li,attrs:{role:"presentation"}});if(ae)typeof F[ne]=="string"||typeof F[ne]=="number"?De.innerText=oe:De.innerText=te[H.text];else{var ve=ae?z.groupTemplateID:z.templateID;if(ae)if(P&&P.getModuleName()!=="listview"){var ue=Q(oe,P,"headerTemplate",ve,!!z.isStringTemplate,null,De);ue&&dt(ue,De)}else dt(Q(oe,P,"headerTemplate",ve,!!z.isStringTemplate),De);else if(P&&P.getModuleName()!=="listview"){var ue=Q(oe,P,"template",ve,!!z.isStringTemplate,null,De);ue&&dt(ue,De)}else dt(Q(oe,P,"template",ve,!!z.isStringTemplate),De);De.setAttribute("data-value",g(U)?"null":U),De.setAttribute("role","option")}if(z.itemCreated&&typeof z.itemCreated=="function"){var ye={dataSource:F,curData:oe,text:U,item:De,options:z,fields:H};z.itemCreated(ye)}$.push(De)}return dt($,O),O}o.renderContentTemplate=y;function S(T,k,F,R,N,P){for(var O=dv(T),z=he({},o.defaultMappedFields,F),H=he({},t,N),Q=z.groupBy,$=0,U=R;$<U.length;$++){var ie=U[$],ne={};if(ne[""+Q]=ie.textContent,ie.innerHTML="",P&&P.getModuleName()!=="listview"){var te=O(ne,P,"groupTemplate",H.groupTemplateID,!!H.isStringTemplate,null,ie);te&&dt(te,ie)}else dt(O(ne,P,"groupTemplate",H.groupTemplateID,!!H.isStringTemplate),ie)}return R}o.renderGroupTemplate=S;function b(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}o.generateId=b;function w(T,k,F,R,N,P,O){var z=k[F.child]||[],H=k[F.hasChildren];if(z.length&&(H=!0,P.classList.add(ei.hasChild),N.processSubChild)){var Q=a(T,z,N,++O);P.appendChild(Q)}if(N.expandCollapse&&H&&!N.template){P.firstElementChild.classList.add(ei.iconWrapper);var $=N.expandIconPosition==="Left"?jr:dt;$([T("div",{className:"e-icons "+N.expandIconClass})],P.querySelector("."+ei.textContent))}}function I(T,k,F,R,N,P,O,z,H,Q){var $=he({},t,Q),U=he({},e,$.ariaAttributes),ie=k,ne=k,te;typeof k!="string"&&typeof k!="number"&&typeof k!="boolean"&&(te=k,ie=typeof F[R.text]=="boolean"||typeof F[R.text]=="number"?F[R.text]:F[R.text]||"",ne=F[R.value]);var oe;!g(te)&&!g(F[R.id])&&F[R.id]!==""?oe=z:oe=z+"-"+H;var ae=T("li",{className:(O===!0?ei.group:ei.li)+" "+(g(N)?"":N),id:oe,attrs:U.groupItemRole!==""&&U.itemRole!==""?{role:O===!0?U.groupItemRole:U.itemRole}:{}});return te&&Object.prototype.hasOwnProperty.call(F,R.enabled)&&F[R.enabled].toString()==="false"&&ae.classList.add(ei.disabled),Q&&Q.enableHtmlSanitizer&&(ie=Bt.sanitize(ie)),O?ae.innerText=ie:(ae.setAttribute("data-value",g(ne)?"null":ne),ae.setAttribute("role","option"),te&&Object.prototype.hasOwnProperty.call(F,R.htmlAttributes)&&F[R.htmlAttributes]&&v(ae,F[R.htmlAttributes]),P.length&&!$.itemNavigable&&dt(P,ae),te&&(F[R.url]||F[R.urlAttributes]&&F[R.urlAttributes].href)?ae.appendChild(M(T,te,R,ie,P,$.itemNavigable)):(P.length&&$.itemNavigable&&dt(P,ae),ae.appendChild(document.createTextNode(ie)))),ae}function x(T){var k;return k={li:"e-"+T+"-item",ul:"e-"+T+"-parent e-ul",group:"e-"+T+"-group-item",icon:"e-"+T+"-icon",text:"e-"+T+"-text",check:"e-"+T+"-check",checked:"e-checked",selected:"e-selected",expanded:"e-expanded",textContent:"e-text-content",hasChild:"e-has-child",level:"e-level",url:"e-"+T+"-url",collapsible:"e-icon-collapsible",disabled:"e-disabled",image:"e-"+T+"-img",iconWrapper:"e-icon-wrapper",anchorWrap:"e-anchor-wrap",navigable:"e-navigable"}}function M(T,k,F,R,N,P){var O=Sn(k,F),z={href:O[F.url]};Object.prototype.hasOwnProperty.call(O,F.urlAttributes)&&O[F.urlAttributes]&&(ht(z,O[F.urlAttributes]),z.href=O[F.url]?O[F.url]:O[F.urlAttributes].href);var H;if(!P)H=T("a",{className:ei.text+" "+ei.url,innerHTML:R});else{H=T("a",{className:ei.text+" "+ei.url});var Q=T("div",{className:ei.anchorWrap});N&&N.length&&dt(N,Q),Q.appendChild(document.createTextNode(R)),dt([Q],H)}return v(H,z),H}function D(T,k,F,R,N,P,O){var z=he({},t,P),H=he({},e,z.ariaAttributes),Q=k,$,U,ie;typeof k!="string"&&typeof k!="number"&&(ie=k,Q=F[R.text]||"",$=g(F._id)?F[R.id]:F._id,U=!!(Object.prototype.hasOwnProperty.call(k,"isHeader")&&k.isHeader)),P&&P.enableHtmlSanitizer&&(Q=Bt.sanitize(Q));var ne=T("li",{className:(U===!0?ei.group:ei.li)+" "+(g(N)?"":N),attrs:H.groupItemRole!==""&&H.itemRole!==""?{role:U===!0?H.groupItemRole:H.itemRole}:{}});if(g($)?ne.setAttribute("data-uid",b()):ne.setAttribute("data-uid",$),U&&P&&P.groupTemplate){var te=dv(P.groupTemplate);if(O&&O.getModuleName()!=="listview"){var oe=te(k,O,"groupTemplate",z.groupTemplateID,!!z.isStringTemplate,null,ne);oe&&dt(oe,ne)}else dt(te(k,O,"groupTemplate",z.groupTemplateID,!!z.isStringTemplate),ne)}else if(!U&&P&&P.template){var te=dv(P.template);if(O&&O.getModuleName()!=="listview"){var oe=te(k,O,"template",z.templateID,!!z.isStringTemplate,null,ne);oe&&dt(oe,ne)}else dt(te(k,O,"template",z.templateID,!!z.isStringTemplate),ne)}else{var ae=T("div",{className:ei.textContent,attrs:H.wrapperRole!==""?{role:H.wrapperRole}:{}});if(ie&&(F[R.url]||F[R.urlAttributes]&&F[R.urlAttributes].href))ae.appendChild(M(T,ie,R,Q,null,z.itemNavigable));else{var ye=T("span",{className:ei.text,attrs:H.itemText!==""?{role:H.itemText}:{}});P&&P.enableHtmlSanitizer?ye.innerText=Q:ye.innerHTML=Q,ae.appendChild(ye)}ne.appendChild(ae)}return ne}function A(T,k,F,R){var N=he({},t,R),P=he({},e,N.ariaAttributes);ei=x(N.moduleName);var O=T("ul",{className:ei.ul+" "+(g(F)?"":F),attrs:P.listRole!==""?{role:P.listRole}:{}});return dt(k,O),O}o.generateUL=A;function L(T,k,F,R){var N=he({},t,R);ei=x(N.moduleName);var P=N.expandIconPosition==="Left"?jr:dt;return P([T("div",{className:"e-icons "+N.expandIconClass+" "+(g(F)?"":F)})],k.querySelector("."+ei.textContent)),k}o.generateIcon=L})(At||(At={}));function Sn(o,e){var t={};if(g(o)||typeof o=="string"||typeof o=="number"||!g(o.isHeader))return o;for(var i=0,r=Object.keys(e);i<r.length;i++){var n=r[i],s=e[""+n],a=!g(s)&&typeof s=="string"?V(s,o):void 0;g(a)||(t[""+s]=a)}return t}function dv(o){if(o)try{return typeof o!="function"&&document.querySelector(o)?wt(document.querySelector(o).innerHTML.trim()):wt(o)}catch{return wt(o)}}var YT=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ti=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},WT={None:[],SlideLeft:["SlideRightOut","SlideLeftOut","SlideLeftIn","SlideRightIn"],SlideDown:["SlideTopOut","SlideBottomOut","SlideBottomIn","SlideTopIn"],Zoom:["FadeOut","FadeZoomOut","FadeZoomIn","FadeIn"],Fade:["FadeOut","FadeOut","FadeIn","FadeIn"]},uH={None:[],SlideLeft:["SlideLeftOut","SlideRightOut","SlideRightIn","SlideLeftIn"],SlideDown:["SlideBottomOut","SlideTopOut","SlideTopIn","SlideBottomIn"],Zoom:["FadeZoomOut","FadeOut","FadeIn","FadeZoomIn"],Fade:["FadeOut","FadeOut","FadeIn","FadeIn"]},ge={root:"e-listview",hover:"e-hover",selected:"e-active",focused:"e-focused",parentItem:"e-list-parent",listItem:"e-list-item",listIcon:"e-list-icon",textContent:"e-text-content",listItemText:"e-list-text",groupListItem:"e-list-group-item",hasChild:"e-has-child",view:"e-view",header:"e-list-header",headerText:"e-headertext",headerTemplateText:"e-headertemplate-text",text:"e-text",disable:"e-disabled",container:"e-list-container",icon:"e-icons",backIcon:"e-icon-back",backButton:"e-back-button",checkboxWrapper:"e-checkbox-wrapper",checkbox:"e-checkbox",checked:"e-check",checklist:"e-checklist",checkboxIcon:"e-frame",checkboxRight:"e-checkbox-right",checkboxLeft:"e-checkbox-left",listviewCheckbox:"e-listview-checkbox",itemCheckList:"e-checklist",virtualElementContainer:"e-list-virtualcontainer"},qT="Template",GT="GroupTemplate",cH="HeaderTemplate",dH=.5,pH=function(o){YT(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ti([C("id")],e.prototype,"id",void 0),ti([C("text")],e.prototype,"text",void 0),ti([C("isChecked")],e.prototype,"isChecked",void 0),ti([C("isVisible")],e.prototype,"isVisible",void 0),ti([C("enabled")],e.prototype,"enabled",void 0),ti([C("iconCss")],e.prototype,"iconCss",void 0),ti([C("child")],e.prototype,"child",void 0),ti([C("tooltip")],e.prototype,"tooltip",void 0),ti([C("groupBy")],e.prototype,"groupBy",void 0),ti([C("text")],e.prototype,"sortBy",void 0),ti([C("htmlAttributes")],e.prototype,"htmlAttributes",void 0),ti([C("tableName")],e.prototype,"tableName",void 0),e}(Re),yp=function(o){YT(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.previousSelectedItems=[],r.hiddenItems=[],r.enabledItems=[],r.disabledItems=[],r}return e.prototype.onPropertyChanged=function(t,i){for(var r=0,n=Object.keys(t);r<n.length;r++){var s=n[r];switch(s){case"htmlAttributes":this.setHTMLAttribute();break;case"cssClass":this.setCSSClass(i.cssClass);break;case"enable":this.setEnable();break;case"width":case"height":this.setSize();break;case"enableRtl":this.setEnableRTL();break;case"fields":this.listBaseOption.fields=this.fields.properties,this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.reRender();break;case"headerTitle":this.curDSLevel.length||this.header(this.headerTitle,!1,"header");break;case"query":this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.reRender();break;case"showHeader":this.header(this.headerTitle,!1,"header");break;case"enableVirtualization":g(this.contentContainer)||ee(this.contentContainer),this.refresh();break;case"showCheckBox":case"checkBoxPosition":this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.setCheckbox();break;case"dataSource":this.previousScrollTop=this.element.scrollTop,this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.reRender();break;case"sortOrder":case"template":this.enableVirtualization||this.refresh();break;case"showIcon":this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():(this.listBaseOption.showIcon=this.showIcon,this.curViewDS=this.getSubDS(),this.resetCurrentList());break}}},e.prototype.setHTMLAttribute=function(){!g(this.htmlAttributes)&&Object.keys(this.htmlAttributes).length&&Ie(this.element,this.htmlAttributes)},e.prototype.setCSSClass=function(t){this.cssClass&&Y([this.element],this.cssClass.split(" ").filter(function(i){return i})),t&&K([this.element],t.split(" ").filter(function(i){return i}))},e.prototype.setSize=function(){this.element.style.height=Le(this.height),this.element.style.width=Le(this.width),this.isWindow=!this.element.clientHeight},e.prototype.setEnable=function(){this.enableElement(this.element,this.enable)},e.prototype.setEnableRTL=function(){this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")},e.prototype.enableElement=function(t,i){i?t.classList.remove(ge.disable):t.classList.add(ge.disable)},e.prototype.header=function(t,i,r){if(this.headerEle===void 0&&this.showHeader){this.headerEle=this.createElement("div",{className:ge.header});var n=this.createElement("span",{className:ge.headerText});this.enableHtmlSanitizer?(this.setProperties({headerTitle:Bt.sanitize(this.headerTitle)},!0),n.innerText=this.headerTitle):n.innerHTML=this.headerTitle;var s=this.createElement("div",{className:ge.text,innerHTML:n.outerHTML}),a=this.createElement("div",{className:ge.icon+" "+ge.backIcon+" "+ge.backButton,attrs:{style:"display:none;"}});if(this.headerEle.appendChild(a),this.headerEle.appendChild(s),this.headerTemplate){var l=wt(this.headerTemplate),h=this.createElement("div",{className:ge.headerTemplateText}),u=l({},this,r,this.LISTVIEW_HEADERTEMPLATE_ID,null,null,this.headerEle);u&&dt(u,h),dt([h],this.headerEle),this.isReact&&this.renderReactTemplates()}this.headerTemplate&&this.headerTitle&&s.classList.add("header"),this.element.classList.add("e-has-header"),jr([this.headerEle],this.element)}else if(this.headerEle)if(this.showHeader){this.headerEle.style.display="";var s=this.headerEle.querySelector("."+ge.headerText),a=this.headerEle.querySelector("."+ge.backIcon);this.enableHtmlSanitizer&&(t=Bt.sanitize(t)),s.innerHTML=t,this.headerTemplate&&i&&(s.parentElement.classList.remove("header"),this.headerEle.querySelector("."+ge.headerTemplateText).classList.add("nested-header")),this.headerTemplate&&!i&&(s.parentElement.classList.add("header"),this.headerEle.querySelector("."+ge.headerTemplateText).classList.remove("nested-header"),this.headerEle.querySelector("."+ge.headerTemplateText).classList.add("header")),i===!0?a.style.display="":a.style.display="none"}else this.headerEle.style.display="none"},e.prototype.switchView=function(t,i,r){var n=this;if(t&&i){var s=t.style.position,a=this.element.style.overflow!=="hidden"?this.element.style.overflow:"";t.style.position="absolute",t.classList.add("e-view");var l=void 0,h=this.animation.duration;if(this.animation.effect)l=this.enableRtl?uH[this.animation.effect]:WT[this.animation.effect];else{var u="SlideLeft";l=WT[""+u],r=this.enableRtl,h=0}this.element.style.overflow="hidden",this.aniObj.animate(t,{name:r===!0?l[0]:l[1],duration:h===0&&Ut==="Enable"?400:h,timingFunction:this.animation.easing,end:function(){t.style.display="none",n.element.style.overflow=a,t.style.position=s,t.classList.remove("e-view")}}),i.style.display="",this.aniObj.animate(i,{name:r===!0?l[2]:l[3],duration:h===0&&Ut==="Enable"?400:h,timingFunction:this.animation.easing,end:function(){n.trigger("actionComplete")}}),this.curUL=i}},e.prototype.preRender=function(){if(this.template)try{typeof this.template!="function"&&document.querySelectorAll(this.template).length&&this.setProperties({template:document.querySelector(this.template).innerHTML.trim()},!0)}catch{wt(this.template)}this.listBaseOption={template:this.template,headerTemplate:this.headerTemplate,groupTemplate:this.groupTemplate,expandCollapse:!0,listClass:"",ariaAttributes:{itemRole:"listitem",listRole:"list",itemText:"",groupItemRole:"presentation",wrapperRole:"presentation"},fields:this.fields.properties,sortOrder:this.sortOrder,showIcon:this.showIcon,itemCreated:this.renderCheckbox.bind(this),templateID:""+this.element.id+qT,groupTemplateID:""+this.element.id+GT,enableHtmlSanitizer:this.enableHtmlSanitizer},this.initialization()},e.prototype.initialization=function(){this.curDSLevel=[],this.animateOptions={},this.curViewDS=[],this.currentLiElements=[],this.isNestedList=!1,this.selectedData=[],this.selectedId=this.enablePersistence?this.selectedId:[],this.LISTVIEW_TEMPLATE_ID=""+this.element.id+qT,this.LISTVIEW_GROUPTEMPLATE_ID=""+this.element.id+GT,this.LISTVIEW_HEADERTEMPLATE_ID=""+this.element.id+cH,this.aniObj=new It(this.animateOptions),this.removeElement(this.curUL),this.removeElement(this.ulElement),this.removeElement(this.headerEle),this.removeElement(this.contentContainer),this.curUL=this.ulElement=this.liCollection=this.headerEle=this.contentContainer=void 0},e.prototype.renderCheckbox=function(t){var i=this;if(t.item.classList.contains(ge.hasChild)&&(this.isNestedList=!0),this.showCheckBox&&t.item.classList.contains(ge.listItem)){var r,n=Uo(this.createElement,!1,{checked:!1,enableRtl:this.enableRtl,cssClass:ge.listviewCheckbox});n.setAttribute("role","checkbox");var s=n.querySelector("."+ge.checkboxIcon);if(t.item.classList.add(ge.itemCheckList),t.item.firstElementChild.classList.add(ge.checkbox),typeof this.dataSource[0]!="string"&&typeof this.dataSource[0]!="number")if(r=Sn(t.curData,this.listBaseOption.fields),this.enablePersistence&&!g(this.selectedId)){var a=this.selectedId.findIndex(function(l){return l===r[i.listBaseOption.fields.id].toString()});a!==-1&&this.checkInternally(t,n)}else r[this.listBaseOption.fields.isChecked]&&this.checkInternally(t,n);else(typeof this.dataSource[0]=="string"||typeof this.dataSource[0]=="number")&&this.selectedData.indexOf(t.text)!==-1&&this.checkInternally(t,n);n.setAttribute("aria-checked",s.classList.contains(ge.checked)?"true":"false"),n.setAttribute("aria-label",t.text),this.checkBoxPosition==="Left"?(n.classList.add(ge.checkboxLeft),t.item.firstElementChild.classList.add(ge.checkboxLeft),t.item.firstElementChild.insertBefore(n,t.item.firstElementChild.childNodes[0])):(n.classList.add(ge.checkboxRight),t.item.firstElementChild.classList.add(ge.checkboxRight),t.item.firstElementChild.appendChild(n)),this.currentLiElements.push(t.item),this.checkBoxPosition==="Left"?this.virtualCheckBox=t.item.firstElementChild.children[0]:this.virtualCheckBox=t.item.firstElementChild.lastElementChild}},e.prototype.checkInternally=function(t,i){t.item.classList.add(ge.selected),i.querySelector("."+ge.checkboxIcon).classList.add(ge.checked),i.setAttribute("aria-checked","true")},e.prototype.checkItem=function(t){this.toggleCheckBase(t,!0)},e.prototype.toggleCheckBase=function(t,i){if(this.showCheckBox){var r=t;if(t instanceof Object&&t.constructor!==HTMLLIElement&&(r=this.getLiFromObjOrElement(t)),!g(r)){var n=r.querySelector("."+ge.checkboxIcon);i===!0?r.classList.add(ge.selected):r.classList.remove(ge.selected),i===!0?n.classList.add(ge.checked):n.classList.remove(ge.checked),n.parentElement.setAttribute("aria-checked",i?"true":"false")}this.setSelectedItemData(r),this.updateSelectedId()}},e.prototype.uncheckItem=function(t){this.toggleCheckBase(t,!1)},e.prototype.checkAllItems=function(){this.toggleAllCheckBase(!0)},e.prototype.uncheckAllItems=function(){this.toggleAllCheckBase(!1)},e.prototype.toggleAllCheckBase=function(t){if(this.showCheckBox){for(var i=0;i<this.liCollection.length;i++){var r=this.liCollection[i].querySelector("."+ge.checkboxIcon);r&&(t?r.classList.contains(ge.checked)||this.checkItem(this.liCollection[i]):r.classList.contains(ge.checked)&&this.uncheckItem(this.liCollection[i]))}this.enableVirtualization&&this.virtualizationModule.checkedItem(t),this.updateSelectedId()}},e.prototype.setCheckbox=function(){if(this.showCheckBox)for(var t=Array.prototype.slice.call(this.element.querySelectorAll("."+ge.listItem)),i={item:void 0,curData:void 0,dataSource:void 0,fields:void 0,options:void 0,text:""},r=0;r<t.length;r++){var n=t[r];i.item=n,i.curData=this.getItemData(n),n.querySelector("."+ge.checkboxWrapper)&&this.removeElement(n.querySelector("."+ge.checkboxWrapper)),this.renderCheckbox(i),i.item.classList.contains(ge.selected)&&this.checkInternally(i,i.item.querySelector("."+ge.checkboxWrapper))}else{for(var t=Array.prototype.slice.call(this.element.querySelectorAll("."+ge.itemCheckList)),r=0;r<t.length;r++){var n=t[r];n.classList.remove(ge.selected),n.firstElementChild.classList.remove(ge.checkbox),this.removeElement(n.querySelector("."+ge.checkboxWrapper))}this.selectedItems&&this.selectedItems.item.classList.add(ge.selected)}},e.prototype.refreshItemHeight=function(){this.virtualizationModule&&this.virtualizationModule.refreshItemHeight()},e.prototype.handleCheckboxState=function(t,i,r,n,s,a,l,h){this.trigger("select",a,function(u){u.cancel&&((l?n:!n)?(i.classList.add(ge.checked),t.classList.add(ge.selected)):(i.classList.remove(ge.checked),t.classList.remove(ge.selected)),r.setAttribute("aria-checked",l?n?"true":"false":n?"false":"true"),ht(a,{isChecked:i.classList.contains(ge.checked)}),s&&(t.classList.remove(ge.focused),h&&h.classList.remove("e-focused")))})},e.prototype.clickHandler=function(t){if(!(Array.isArray(this.dataSource)&&this.dataSource.length===0)){var i=t.target;this.targetElement=i;var r=i.classList,n;if(r.contains(ge.backIcon)||r.contains(ge.headerText))this.showCheckBox&&this.curDSLevel[this.curDSLevel.length-1]&&this.uncheckAllItems(),this.back();else{var s=j(i.parentNode,"."+ge.listItem);if(s===null&&(s=i),this.removeFocus(),this.enable&&this.showCheckBox&&this.isValidLI(s))if(t.target.classList.contains(ge.checkboxIcon)){if(s.classList.add(ge.focused),g(s.querySelector("."+ge.checked))){var a={curData:void 0,dataSource:void 0,fields:void 0,options:void 0,text:void 0,item:s};this.checkInternally(a,a.item.querySelector("."+ge.checkboxWrapper))}else this.uncheckItem(s),s.classList.add(ge.focused);if(this.enableVirtualization&&this.virtualizationModule.setCheckboxLI(s,t),t){var l=this.selectEventData(s,t),h=s.querySelector("."+ge.checkboxIcon);ht(l,{isChecked:h.classList.contains(ge.checked)});var u=s.querySelector("."+ge.checkboxWrapper),c=h.classList.contains(ge.checked),d=s.classList.contains(ge.focused);this.handleCheckboxState(s,h,u,c,d,l,!1)}}else s.classList.contains(ge.hasChild)?(this.removeHover(),this.removeSelect(),this.removeSelect(s),this.setSelectLI(s,t),s.classList.remove(ge.selected)):(this.setCheckboxLI(s,t),(i.nodeName==="INPUT"||i.nodeName==="TEXTAREA")&&(i.classList.add("e-focused"),this.targetElement=i));else this.setSelectLI(s,t),(i.nodeName==="INPUT"||i.nodeName==="TEXTAREA")&&(i.classList.add("e-focused"),this.targetElement=i);n=j(t.target,"li"),g(n)||n.classList.contains("e-has-child")&&!t.target.parentElement.classList.contains("e-listview-checkbox")&&n.classList.add(ge.disable)}this.updateSelectedId()}},e.prototype.removeElement=function(t){return t&&t.parentNode&&t.parentNode.removeChild(t)},e.prototype.hoverHandler=function(t){var i=j(t.target.parentNode,"."+ge.listItem);this.setHoverLI(i)},e.prototype.leaveHandler=function(){this.removeHover()},e.prototype.homeKeyHandler=function(t,i){if(t.preventDefault(),Object.keys(this.dataSource).length&&this.curUL){var r=this.curUL.querySelectorAll("."+ge.listItem),n=this.curUL.querySelector("."+ge.focused)||this.curUL.querySelector("."+ge.selected);n&&(n.classList.remove(ge.focused),this.showCheckBox||n.classList.remove(ge.selected));var s=i?r.length-1:0;r[s].classList.contains(ge.hasChild)||this.showCheckBox?r[s].classList.add(ge.focused):this.setSelectLI(r[s],t),r[s]?this.element.setAttribute("aria-activedescendant",r[s].id.toString()):this.element.removeAttribute("aria-activedescendant")}},e.prototype.onArrowKeyDown=function(t,i){var r,n,s=!g(this.curUL.querySelector("."+ge.hasChild));return s||this.showCheckBox?(n=this.curUL.querySelector("."+ge.focused)||this.curUL.querySelector("."+ge.selected),r=At.getSiblingLI(this.curUL.querySelectorAll("."+ge.listItem),n,i),g(r)||(n&&(n.classList.remove(ge.focused),this.showCheckBox||n.classList.remove(ge.selected)),r.classList.contains(ge.hasChild)||this.showCheckBox?r.classList.add(ge.focused):this.setSelectLI(r,t))):(n=this.curUL.querySelector("."+ge.selected),r=At.getSiblingLI(this.curUL.querySelectorAll("."+ge.listItem),n,i),this.setSelectLI(r,t)),r?this.element.setAttribute("aria-activedescendant",r.id.toString()):this.element.removeAttribute("aria-activedescendant"),r},e.prototype.arrowKeyHandler=function(t,i){var r=this;if(t.preventDefault(),Object.keys(this.dataSource).length&&this.curUL){var n=this.onArrowKeyDown(t,i),s=this.element.getBoundingClientRect().top,a=this.element.getBoundingClientRect().height,l=this.curUL.querySelector("."+ge.listItem).getBoundingClientRect(),h=void 0,u=void 0;if(this.fields.groupBy&&(u=this.curUL.querySelector("."+ge.groupListItem).getBoundingClientRect()),n){var c=n.getBoundingClientRect().top,d=n.getBoundingClientRect().height;if(i)h=this.isWindow?c:c-s,h<0&&(this.isWindow===!0?window.scroll(0,pageYOffset+h):this.element.scrollTop=this.element.scrollTop+h);else{var p=this.isWindow?window.innerHeight:a;h=this.isWindow?c+d:c-s+d,h>p&&(this.isWindow===!0?window.scroll(0,pageYOffset+(h-p)):this.element.scrollTop=this.element.scrollTop+(h-p))}}else if(this.enableVirtualization&&i&&this.virtualizationModule.uiFirstIndex)this.onUIScrolled=function(){r.onArrowKeyDown(t,i),r.onUIScrolled=void 0},h=this.virtualizationModule.listItemHeight,this.isWindow===!0?window.scroll(0,pageYOffset-h):this.element.scrollTop=this.element.scrollTop-h;else if(i)if(this.showHeader&&this.headerEle){var f=u?u.top:l.top,v=this.headerEle.getBoundingClientRect();h=v.top<0?v.height-f:0,this.isWindow===!0?window.scroll(0,pageYOffset-h):this.element.scrollTop=0}else this.fields.groupBy&&(h=this.isWindow?u.top<0?u.top:0:s-l.top+u.height,this.isWindow===!0?window.scroll(0,pageYOffset+h):this.element.scrollTop=this.element.scrollTop-h)}},e.prototype.enterKeyHandler=function(t){if(Object.keys(this.dataSource).length&&this.curUL){var i=!g(this.curUL.querySelector("."+ge.hasChild)),r=this.curUL.querySelector("."+ge.focused);i&&r&&(r.classList.remove(ge.focused),this.showCheckBox&&(this.removeSelect(),this.removeSelect(r),this.removeHover()),this.setSelectLI(r,t))}},e.prototype.spaceKeyHandler=function(t){if(this.enable&&this.showCheckBox&&Object.keys(this.dataSource).length&&this.curUL){t.preventDefault();var i=this.curUL.querySelector("."+ge.focused),r=void 0,n=void 0;if(!g(i)&&g(i.querySelector("."+ge.checked))){var s={curData:void 0,dataSource:void 0,fields:void 0,options:void 0,text:void 0,item:i};r=s.item.querySelector("."+ge.checkboxWrapper),this.checkInternally(s,r),n=r.querySelector("."+ge.checkboxIcon+"."+ge.icon)}else this.uncheckItem(i);var a=this.selectEventData(i,t);if(ht(a,{isChecked:n?n.classList.contains(ge.checked):!1}),!g(i)){var l=i.querySelector("."+ge.checkboxWrapper),h=i.querySelector("."+ge.checkboxIcon),u=h.classList.contains(ge.checked),c=i.classList.contains(ge.focused);this.handleCheckboxState(i,h,l,u,c,a,!1)}this.updateSelectedId()}},e.prototype.keyActionHandler=function(t){switch(t.keyCode){case 36:this.homeKeyHandler(t);break;case 35:this.homeKeyHandler(t,!0);break;case 40:this.arrowKeyHandler(t);break;case 38:this.arrowKeyHandler(t,!0);break;case 13:this.enterKeyHandler(t);break;case 8:this.showCheckBox&&this.curDSLevel[this.curDSLevel.length-1]&&this.uncheckAllItems(),this.back();break;case 32:(g(this.targetElement)||!this.targetElement.classList.contains("e-focused"))&&this.spaceKeyHandler(t);break}},e.prototype.swipeActionHandler=function(t){t.swipeDirection==="Right"&&t.velocity>dH&&t.originalEvent.type==="touchend"&&(this.showCheckBox&&this.curDSLevel[this.curDSLevel.length-1]&&this.uncheckAllItems(),this.back())},e.prototype.focusout=function(){if(Object.keys(this.dataSource).length&&this.curUL){var t=this.curUL.querySelector("."+ge.focused);t&&(t.classList.remove(ge.focused),!this.showCheckBox&&!g(this.selectedLI)&&this.selectedLI.classList.add(ge.selected))}},e.prototype.wireEvents=function(){E.add(this.element,"keydown",this.keyActionHandler,this),E.add(this.element,"click",this.clickHandler,this),E.add(this.element,"mouseover",this.hoverHandler,this),E.add(this.element,"mouseout",this.leaveHandler,this),E.add(this.element,"focusout",this.focusout,this),this.touchModule=new Fr(this.element,{swipe:this.swipeActionHandler.bind(this)}),g(this.scroll)||E.add(this.element,"scroll",this.onListScroll,this)},e.prototype.unWireEvents=function(){E.remove(this.element,"keydown",this.keyActionHandler),E.remove(this.element,"click",this.clickHandler),E.remove(this.element,"mouseover",this.hoverHandler),E.remove(this.element,"mouseout",this.leaveHandler),E.remove(this.element,"mouseover",this.hoverHandler),E.remove(this.element,"mouseout",this.leaveHandler),E.remove(this.element,"focusout",this.focusout),g(this.scroll)||E.remove(this.element,"scroll",this.onListScroll),this.touchModule&&this.touchModule.destroy(),this.touchModule=null},e.prototype.removeFocus=function(){for(var t=this.element.querySelectorAll("."+ge.focused),i=0,r=t;i<r.length;i++){var n=r[i];n.classList.remove(ge.focused)}},e.prototype.removeHover=function(){var t=this.element.querySelector("."+ge.hover);t&&t.classList.remove(ge.hover)},e.prototype.removeSelect=function(t){if(g(t))for(var i=this.element.querySelectorAll("."+ge.selected),r=0,n=i;r<n.length;r++){var s=n[r];this.showCheckBox&&s.querySelector("."+ge.checked)||s.classList.remove(ge.selected)}else t.classList.remove(ge.selected)},e.prototype.isValidLI=function(t){return t&&t.classList.contains(ge.listItem)&&!t.classList.contains(ge.groupListItem)&&!t.classList.contains(ge.disable)},e.prototype.setCheckboxLI=function(t,i){if(this.isValidLI(t)&&this.enable&&this.showCheckBox){this.curUL.querySelector("."+ge.focused)&&this.curUL.querySelector("."+ge.focused).classList.remove(ge.focused);var r=t.querySelector("textarea")||t.querySelector("input");t.classList.add(ge.focused),g(i)||i.target===r&&r.classList.add("e-focused");var n=t.querySelector("."+ge.checkboxWrapper),s=n.querySelector("."+ge.checkboxIcon+"."+ge.icon);this.removeHover();var a=s.classList.contains(ge.checked),l=t.classList.contains(ge.focused);a?(s.classList.remove(ge.checked),t.classList.remove(ge.selected)):(s.classList.add(ge.checked),t.classList.add(ge.selected)),n.setAttribute("aria-checked",s.classList.contains(ge.checked)?"true":"false");var h=this.selectEventData(t,i);ht(h,{isChecked:s.classList.contains(ge.checked)}),this.enableVirtualization&&this.virtualizationModule.setCheckboxLI(t,i),this.handleCheckboxState(t,s,n,a,l,h,!0,r),this.setSelectedItemData(t),this.renderSubList(t)}},e.prototype.selectEventData=function(t,i){var r=this.getItemData(t),n=Sn(r,this.listBaseOption.fields),s;!g(r)&&typeof this.dataSource[0]=="string"||typeof this.dataSource[0]=="number"?s={item:t,text:t&&t.innerText.trim(),data:this.dataSource}:s={item:t,text:n&&n[this.listBaseOption.fields.text],data:r};var a={};return ht(a,s),i&&ht(a,{isInteracted:!0,event:i,cancel:!1,index:this.curUL&&Array.prototype.indexOf.call(this.curUL.children,t)}),a},e.prototype.setSelectedItemData=function(t){var i=this.getItemData(t),r=Sn(i,this.listBaseOption.fields);!g(i)&&(typeof this.dataSource[0]=="string"||typeof this.dataSource[0]=="number")?this.selectedItems={item:t,text:t&&t.innerText.trim(),data:this.dataSource}:this.selectedItems={item:t,text:r&&r[this.listBaseOption.fields.text],data:i}},e.prototype.setSelectLI=function(t,i){var r=this;if(this.isValidLI(t)&&!t.classList.contains(ge.selected)&&this.enable){this.showCheckBox||this.removeSelect(),t.classList.add(ge.selected),this.removeHover(),this.setSelectedItemData(t),this.enableVirtualization&&this.virtualizationModule.setSelectLI(t,i);var n=this.selectEventData(t,i);this.trigger("select",n,function(s){s.cancel?(t.classList.remove(ge.selected),r.selectedLI=t):(r.selectedLI=t,r.renderSubList(t))})}},e.prototype.setHoverLI=function(t){if(this.isValidLI(t)&&!t.classList.contains(ge.hover)&&this.enable){var i=this.element.querySelectorAll("."+ge.hover);i&&i.length&&K(i,ge.hover),(!t.classList.contains(ge.selected)||this.showCheckBox)&&t.classList.add(ge.hover)}},e.prototype.getSubDS=function(){var t=this.curDSLevel;if(t.length){for(var i=this.localData,r=0,n=t;r<n.length;r++){var s=n[r],a={};a[this.fields.id]=s,this.curDSJSON=this.findItemFromDS(i,a);var l=Sn(this.curDSJSON,this.listBaseOption.fields);i=this.curDSJSON?l[this.fields.child]:i}return i}return this.localData},e.prototype.getItemData=function(t){var i=this.dataSource instanceof re?this.localData:this.dataSource,r=this.getElementUID(t),n;return g(this.element.querySelector("."+ge.hasChild))&&this.fields.groupBy?n=this.curViewDS:n=i,this.findItemFromDS(n,r)},e.prototype.findItemFromDS=function(t,i,r){var n=this,s;return t&&t.length&&i?t.some(function(a){var l=Sn(a,n.listBaseOption.fields);if((i[n.fields.id]||i[n.fields.text])&&(!i[n.fields.id]||(!g(l[n.fields.id])&&l[n.fields.id].toString())===i[n.fields.id].toString())&&(!i[n.fields.text]||l[n.fields.text]===i[n.fields.text]))s=r?t:a;else if(typeof a!="object"&&t.indexOf(a)!==-1)s=r?t:a;else if(!g(i[n.fields.id])&&g(l[n.fields.id])){var h=n.element.querySelector('[data-uid="'+i[n.fields.id]+'"]');h&&h.innerText.trim()===l[n.fields.text]&&(s=a)}else Object.prototype.hasOwnProperty.call(l,n.fields.child)&&l[n.fields.child].length&&(s=n.findItemFromDS(l[n.fields.child],i,r));return!!s}):s=t,s},e.prototype.getQuery=function(){var t=[],i=this.query?this.query:new Pe;if(!this.query){for(var r=0,n=Object.keys(this.fields.properties);r<n.length;r++){var s=n[r];s!=="tableName"&&this.fields[""+s]&&this.fields[""+s]!==At.defaultMappedFields[""+s]&&t.indexOf(this.fields[""+s])===-1&&t.push(this.fields[""+s])}i.select(t),Object.prototype.hasOwnProperty.call(this.fields.properties,"tableName")&&i.from(this.fields.tableName)}return i},e.prototype.setViewDataSource=function(t){t===void 0&&(t=this.localData);var i=g(this.fields.sortBy)?this.fields.text:this.fields.sortBy,r=At.addSorting(this.sortOrder,i);t&&this.fields.groupBy?this.sortOrder!=="None"?this.curViewDS=At.groupDataSource(At.getDataSource(t,r),this.listBaseOption.fields,this.sortOrder):this.curViewDS=At.groupDataSource(t,this.listBaseOption.fields,this.sortOrder):t&&this.sortOrder!=="None"?this.curViewDS=At.getDataSource(t,r):this.curViewDS=t},e.prototype.isInAnimation=function(){return this.curUL.classList.contains(".e-animate")},e.prototype.renderRemoteLists=function(t,i){this.isDestroyed||(this.localData=t.result,i.removeElement(i.contentContainer),this.renderList(),this.trigger("actionComplete",t))},e.prototype.triggerActionFailure=function(t){this.isDestroyed||this.trigger("actionFailure",t)},e.prototype.setLocalData=function(){var t=this;if(this.trigger("actionBegin"),this.dataSource instanceof re)this.dataSource.ready?this.dataSource.ready.then(function(r){t.isOffline=t.dataSource.dataSource.offline,t.dataSource instanceof re&&t.isOffline&&t.renderRemoteLists(r,t)}).catch(function(r){t.triggerActionFailure(r)}):this.dataSource.executeQuery(this.getQuery()).then(function(r){t.renderRemoteLists(r,t)}).catch(function(r){t.triggerActionFailure(r)});else if(!this.dataSource||!this.dataSource.length){var i=this.element.querySelector("ul");i&&(Ue(i),this.setProperties({dataSource:At.createJsonFromElement(i)},!0),this.localData=this.dataSource,this.renderList(),this.trigger("actionComplete",{data:this.localData}))}else this.localData=this.dataSource,this.renderList(),this.trigger("actionComplete",{data:this.localData})},e.prototype.reRender=function(){this.removeElement(this.headerEle),this.removeElement(this.ulElement),this.removeElement(this.contentContainer),this.isReact&&this.clearTemplate(),Object.keys(window).indexOf("ejsInterop")===-1&&(this.element.innerHTML=""),this.headerEle=this.ulElement=this.liCollection=void 0,this.header(),this.setLocalData()},e.prototype.resetCurrentList=function(){this.setViewDataSource(this.curViewDS),this.contentContainer.innerHTML="",this.createList(),this.renderIntoDom(this.curUL)},e.prototype.setAttributes=function(t){for(var i=0;i<t.length;i++){var r=t[parseInt(i.toString(),10)];r.classList.contains("e-list-item")&&(r.setAttribute("id",this.element.id+"_"+r.getAttribute("data-uid")),r.setAttribute("tabindex","-1"))}},e.prototype.createList=function(){this.currentLiElements=[],this.isNestedList=!1,this.ulElement=this.curUL=At.createList(this.createElement,this.curViewDS,this.listBaseOption,null,this),this.liCollection=this.curUL.querySelectorAll("."+ge.listItem),this.setAttributes(this.liCollection)},e.prototype.renderSubList=function(t){this.liElement=t;var i=t.getAttribute("data-uid");if(t.classList.contains(ge.hasChild)&&i){var r=j(t.parentNode,"."+ge.parentItem),n=this.element.querySelector("[pid='"+i+"']");if(this.curDSLevel.push(i),this.setViewDataSource(this.getSubDS()),this.enableVirtualization&&this.virtualizationModule.updateDOMItemCount(),!n){var s=this.curViewDS;n=At.createListFromJson(this.createElement,s,this.listBaseOption,this.curDSLevel.length,null,this),this.isReact&&this.renderReactTemplates();var a=n.querySelectorAll("."+ge.listItem);this.setAttributes(a),n.setAttribute("pID",i),n.style.display="none",this.renderIntoDom(n)}if(this.switchView(r,n),this.liCollection=this.curUL.querySelectorAll("."+ge.listItem),this.selectedItems){var l=Sn(this.selectedItems.data,this.listBaseOption.fields);this.header(l[this.listBaseOption.fields.text],!0,"header")}this.selectedLI=void 0}},e.prototype.renderIntoDom=function(t){this.contentContainer.appendChild(t)},e.prototype.renderList=function(t){this.setViewDataSource(t),this.enableVirtualization?(Object.keys(this.dataSource).length&&(this.template||this.groupTemplate)&&!this.virtualizationModule.isNgTemplate()&&(this.listBaseOption.itemCreated=this.virtualizationModule.createUIItem.bind(this.virtualizationModule)),this.virtualizationModule.uiVirtualization()):(this.createList(),this.contentContainer=this.createElement("div",{className:ge.container}),this.element.appendChild(this.contentContainer),this.renderIntoDom(this.ulElement),this.isReact&&this.renderReactTemplates())},e.prototype.getElementUID=function(t){var i={};return t instanceof Element?i[this.fields.id]=t.getAttribute("data-uid"):i=t,i},e.prototype.render=function(){this.element.classList.add(ge.root),Ie(this.element,{tabindex:"0"}),this.setCSSClass(),this.setEnableRTL(),this.setEnable(),this.setSize(),this.wireEvents(),this.header(),this.setLocalData(),this.setHTMLAttribute(),this.rippleFn=Vi(this.element,{selector:"."+ge.listItem}),this.renderComplete(),this.previousScrollTop=this.element.scrollTop},e.prototype.destroy=function(){this.isReact&&this.clearTemplate(),this.unWireEvents();var t=[ge.root,ge.disable,"e-rtl","e-has-header","e-lib"].concat(this.cssClass?this.cssClass.split(" ").filter(function(i){return i}):[]);K([this.element],t),this.element.removeAttribute("role"),this.element.removeAttribute("tabindex"),this.curUL=this.ulElement=this.liCollection=this.headerEle=void 0,this.element.innerHTML="",this.contentContainer=null,this.selectedItems=null,this.selectedLI=null,this.liElement=null,this.targetElement=null,this.currentLiElements=null,this.virtualCheckBox=null,o.prototype.destroy.call(this)},e.prototype.back=function(){var t=this.curDSLevel[this.curDSLevel.length-1];if(!(t===void 0||this.isInAnimation())){this.curDSLevel.pop(),this.setViewDataSource(this.getSubDS()),this.enableVirtualization&&this.virtualizationModule.updateDOMItemCount();var i=this.element.querySelector("[data-uid='"+t+"']"),r=this.curUL;i?i=i.parentElement:(this.createList(),this.renderIntoDom(this.ulElement),i=this.curUL);var n=Sn(this.curDSJSON,this.listBaseOption.fields),s=n[this.fields.text];this.switchView(r,i,!0),this.removeFocus();var a=this.element.querySelector("[data-uid='"+t+"']");a.classList.remove(ge.disable),a.classList.add(ge.focused),this.showCheckBox&&a.querySelector("."+ge.checkboxIcon).classList.contains(ge.checked)||a.classList.remove(ge.selected),this.liCollection=this.curUL.querySelectorAll("."+ge.listItem),this.enableHtmlSanitizer&&this.setProperties({headerTitle:Bt.sanitize(this.headerTitle)},!0),this.header(this.curDSLevel.length?s:this.headerTitle,!!this.curDSLevel.length,"header")}},e.prototype.selectItem=function(t){this.enableVirtualization?this.virtualizationModule.selectItem(t):this.showCheckBox?this.setCheckboxLI(this.getLiFromObjOrElement(t)):g(t)===!0?this.removeSelect():this.setSelectLI(this.getLiFromObjOrElement(t))},e.prototype.unselectItem=function(t){if(g(t))this.removeSelect();else{var i=this.getLiFromObjOrElement(t);g(i)||this.removeSelect(i)}},e.prototype.getLiFromObjOrElement=function(t){var i,r=this.dataSource instanceof re?this.localData:this.dataSource;if(!g(t))if(typeof r[0]=="string"||typeof r[0]=="number")if(t instanceof Element){for(var n=t.getAttribute("data-uid").toString(),s=0;s<this.liCollection.length;s++)if(this.liCollection[parseInt(s.toString(),10)].getAttribute("data-uid").toString()===n){i=this.liCollection[parseInt(s.toString(),10)];break}}else Array.prototype.some.call(this.curUL.querySelectorAll("."+ge.listItem),function(u){return u.innerText.trim()===t.toString()?(i=u,!0):!1});else{var a=this.getItemData(t),l=Sn(a,this.listBaseOption.fields);if(a&&(i=this.element.querySelector('[data-uid="'+l[this.fields.id]+'"]'),!this.enableVirtualization&&g(i)))for(var h=this.element.querySelectorAll("."+ge.listItem),s=0;s<h.length;s++)h[parseInt(s.toString(),10)].innerText.trim()===l[this.fields.text]&&(i=h[parseInt(s.toString(),10)])}return i},e.prototype.selectMultipleItems=function(t){if(!g(t))for(var i=0;i<t.length;i++)g(t[parseInt(i.toString(),10)])||this.selectItem(t[parseInt(i.toString(),10)])},e.prototype.getParentId=function(){var t=[];if(this.isNestedList)for(var i=this.curDSLevel.length-1;i>=0;i--)t.push(this.curDSLevel[parseInt(i.toString(),10)]);return t},e.prototype.updateSelectedId=function(){this.selectedId=[];for(var t=this.curUL.getElementsByClassName(ge.selected),i=0;i<t.length;i++){var r=this.getItemData(t[parseInt(i.toString(),10)]);!g(r)&&r[this.listBaseOption.fields.id]&&this.selectedId.push(r[this.listBaseOption.fields.id])}},e.prototype.getSelectedItems=function(){var t,i=!1;this.selectedId=[];var r=this.dataSource instanceof re?this.localData:this.dataSource;if(this.enableVirtualization&&!i)t=this.virtualizationModule.getSelectedItems(),i=!0;else if(this.showCheckBox&&!i){var n=this.curUL.getElementsByClassName(ge.selected),s=[],a=[];this.selectedId=[];for(var l=[],h=0;h<n.length;h++)if(typeof r[0]=="string"||typeof r[0]=="number")s.push(n[parseInt(h.toString(),10)].innerText.trim());else{var u=this.getItemData(n[parseInt(h.toString(),10)]),c=Sn(u,this.listBaseOption.fields);this.isNestedList?l.push({data:u,parentId:this.getParentId()}):a.push(u),c?(s.push(c[this.listBaseOption.fields.text]),this.selectedId.push(c[this.listBaseOption.fields.id])):(s.push(void 0),this.selectedId.push(void 0))}(typeof r[0]=="string"||typeof r[0]=="number")&&!i&&(t={item:n,data:r,text:s},i=!0),this.isNestedList&&!i?(t={item:n,data:l,text:s},i=!0):i||(t={item:n,data:a,text:s},i=!0)}else if(!i){var d=this.element.getElementsByClassName(ge.selected)[0],c=Sn(this.getItemData(d),this.listBaseOption.fields);(typeof r[0]=="string"||typeof r[0]=="number")&&!i?(t=g(d)?void 0:{item:d,data:r,text:d.innerText.trim()},i=!0):i||(g(c)||g(d)?(t=void 0,i=!0):(this.selectedId.push(c[this.listBaseOption.fields.id]),t={text:c[this.listBaseOption.fields.text],item:d,data:this.getItemData(d)},i=!0))}return t},e.prototype.findItem=function(t){return this.getItemData(t)},e.prototype.enableItem=function(t){this.setItemState(t,!0),this.enableVirtualization&&this.virtualizationModule.enableItem(t)},e.prototype.disableItem=function(t){this.setItemState(t,!1),this.enableVirtualization&&this.virtualizationModule.disableItem(t)},e.prototype.setItemState=function(t,i){var r=this.getItemData(t),n=Sn(r,this.listBaseOption.fields);if(r){var s=this.element.querySelector('[data-uid="'+n[this.fields.id]+'"]');i?(s&&s.classList.remove(ge.disable),delete r[this.fields.enabled]):i||(s&&s.classList.add(ge.disable),r[this.fields.enabled]=!1)}},e.prototype.showItem=function(t){this.showHideItem(t,!1,""),this.enableVirtualization&&this.virtualizationModule.showItem(t)},e.prototype.hideItem=function(t){this.showHideItem(t,!0,"none"),this.enableVirtualization&&this.virtualizationModule.hideItem(t)},e.prototype.showHideItem=function(t,i,r){var n=this.getItemData(t),s=Sn(n,this.listBaseOption.fields);if(n){var a=this.element.querySelector('[data-uid="'+s[this.fields.id]+'"]');a&&(a.style.display=r),i?n[this.fields.isVisible]=!1:delete n[this.fields.isVisible]}},e.prototype.addItem=function(t,i,r){i===void 0&&(i=void 0);var n=this.dataSource instanceof re?this.localData:this.dataSource;this.addItemInternally(t,i,n,r)},e.prototype.addItemInternally=function(t,i,r,n){if(t instanceof Array)if(this.enableVirtualization)this.virtualizationModule.addItem(t,i,r,n);else{var s=this.findItemFromDS(r,i),a=void 0;if(s){var l=Sn(s,this.listBaseOption.fields);a=l[this.fields.child],a||(a=[]),a=a.concat(t)}if(s instanceof Array){for(var h=0;h<t.length;h++){r=this.addItemAtIndex(n,r,t[parseInt(h.toString(),10)]),this.setViewDataSource(r);var u=this.contentContainer?this.contentContainer.children[0]:null;this.contentContainer&&u?this.addItemIntoDom(t[parseInt(h.toString(),10)],u,this.curViewDS):this.reRender()}this.liCollection=this.curUL.querySelectorAll("."+ge.listItem)}else s&&(s[this.fields.child]=a,this.addItemInNestedList(s,t))}},e.prototype.addItemAtIndex=function(t,i,r){var n=!g(t)&&t>=0&&t<i.length&&g(this.listBaseOption.fields.groupBy);return n?i.splice(t,0,r):i.push(r),i},e.prototype.addItemInNestedList=function(t,i){var r=t[this.fields.id],n=t[this.fields.child],s=this.element.querySelector("[pid='"+r+"']"),a=this.element.querySelector("[data-uid='"+r+"']"),l=s||(a?j(a,"ul"):null),h=s?n:[t],u=a?!a.classList.contains(ge.hasChild):!1;if(u){var c=At.createListItemFromJson(this.createElement,h,this.listBaseOption,null,null,this);this.setAttributes(c),l.insertBefore(c[0],a),ee(a)}if(s&&i)for(var d=0;d<i.length;d++)h.push(i[parseInt(d.toString(),10)]),this.addItemIntoDom(i[parseInt(d.toString(),10)],l,h)},e.prototype.addItemIntoDom=function(t,i,r){var n=r.indexOf(t);this.addListItem(t,n,i,r);var s=r[n-1];s&&s.isHeader&&s.items.length===1&&this.addListItem(s,n-1,i,r)},e.prototype.addListItem=function(t,i,r,n){var s=this.getLiFromObjOrElement(n[i+1])||this.getLiFromObjOrElement(n[i+2])||null,a=At.createListItemFromJson(this.createElement,[t],this.listBaseOption,null,null,this);if(this.setAttributes(a),this.template&&this.isReact&&this.renderReactTemplates(),this.fields.groupBy&&n[i+1]&&n[i+1].isHeader){var l=this.getLiFromObjOrElement(n[i-1]);l&&(s=l.nextElementSibling)}r.insertBefore(a[0],s)},e.prototype.removeItem=function(t){var i=this.dataSource instanceof re?this.localData:this.dataSource;this.enableVirtualization?this.virtualizationModule.removeItem(t):this.removeItemFromList(t,i)},e.prototype.removeItemFromList=function(t,i){var r=this,n=this.curViewDS,s=t instanceof Element?this.getElementUID(t):t,a=this.findItemFromDS(i,s,!0);if(a){var l=this.findItemFromDS(a,s),h=n.indexOf(l),u=this.getLiFromObjOrElement(t),c=void 0;this.validateNestedView(u),this.fields.groupBy&&this.curViewDS[h-1]&&n[h-1].isHeader&&n[h-1].items.length===1&&u&&u.previousElementSibling.classList.contains(ge.groupListItem)&&(g(u.nextElementSibling)||u.nextElementSibling&&u.nextElementSibling.classList.contains(ge.groupListItem))&&(c=u.previousElementSibling),u&&ee(u),c&&ee(c);var d=a.length-1<=0?this.findParent(this.localData,this.fields.id,function(m){return m===l[r.fields.id]},null):null,p=a.indexOf(l);if(a.splice(p,1),this.setViewDataSource(i),d&&d.parent&&Array.isArray(d.parent[this.fields.child])&&d.parent[this.fields.child].length<=0){var f=this.getLiFromObjOrElement(d.parent);if(f){var v=At.createListItemFromJson(this.createElement,[d.parent],this.listBaseOption,null,null,this);this.setAttributes(v),f.parentElement.insertBefore(v[0],f),f.parentElement.removeChild(f)}}a.length<=0&&this.back(),this.liCollection=Array.prototype.slice.call(this.element.querySelectorAll("."+ge.listItem))}},e.prototype.validateNestedView=function(t){var i=t?t.getAttribute("data-uid").toString().toLowerCase():null;if(i&&this.curDSLevel&&this.curDSLevel.length>0)for(;this.curDSLevel.some(function(r){return r.toString().toLowerCase()===i});)this.back()},e.prototype.removeMultipleItems=function(t){if(t.length)for(var i=0;i<t.length;i++)this.removeItem(t[parseInt(i.toString(),10)])},e.prototype.findParent=function(t,i,r,n){if(Object.prototype.hasOwnProperty.call(t,i)&&r(t[i])===!0)return he({},t);for(var s=0;s<Object.keys(t).length;s++)if(t[Object.keys(t)[parseInt(s.toString(),10)]]&&typeof t[Object.keys(t)[parseInt(s.toString(),10)]]=="object"){var a=this.findParent(t[Object.keys(t)[parseInt(s.toString(),10)]],i,r,t);if(a!=null)return a.parent||(a.parent=n),a}return null},e.prototype.getModuleName=function(){return"listview"},e.prototype.requiredModules=function(){var t=[];return this.enableVirtualization&&t.push({args:[this],member:"virtualization",name:"Virtualization"}),t},e.prototype.onListScroll=function(t){var i={originalEvent:t,scrollDirection:"Bottom",distanceY:this.element.scrollHeight-this.element.scrollTop},r=this.element.scrollTop;r>this.previousScrollTop?(i.scrollDirection="Bottom",i.distanceY=this.element.scrollHeight-this.element.clientHeight-this.element.scrollTop,this.trigger("scroll",i)):this.previousScrollTop>r&&(i.scrollDirection="Top",i.distanceY=this.element.scrollTop,this.trigger("scroll",i)),this.previousScrollTop=r},e.prototype.getPersistData=function(){return this.addOnPersist(["cssClass","enableRtl","htmlAttributes","enable","fields","animation","headerTitle","sortOrder","showIcon","height","width","showCheckBox","checkBoxPosition","selectedId"])},ti([C("")],e.prototype,"cssClass",void 0),ti([C(!1)],e.prototype,"enableVirtualization",void 0),ti([C({})],e.prototype,"htmlAttributes",void 0),ti([C(!0)],e.prototype,"enable",void 0),ti([C([])],e.prototype,"dataSource",void 0),ti([C()],e.prototype,"query",void 0),ti([be(At.defaultMappedFields,pH)],e.prototype,"fields",void 0),ti([C({effect:"SlideLeft",duration:400,easing:"ease"})],e.prototype,"animation",void 0),ti([C("None")],e.prototype,"sortOrder",void 0),ti([C(!1)],e.prototype,"showIcon",void 0),ti([C(!1)],e.prototype,"showCheckBox",void 0),ti([C("Left")],e.prototype,"checkBoxPosition",void 0),ti([C("")],e.prototype,"headerTitle",void 0),ti([C(!1)],e.prototype,"showHeader",void 0),ti([C(!0)],e.prototype,"enableHtmlSanitizer",void 0),ti([C("")],e.prototype,"height",void 0),ti([C("")],e.prototype,"width",void 0),ti([C(null)],e.prototype,"template",void 0),ti([C(null)],e.prototype,"headerTemplate",void 0),ti([C(null)],e.prototype,"groupTemplate",void 0),ti([q()],e.prototype,"select",void 0),ti([q()],e.prototype,"actionBegin",void 0),ti([q()],e.prototype,"actionComplete",void 0),ti([q()],e.prototype,"actionFailure",void 0),ti([q()],e.prototype,"scroll",void 0),e=ti([bt],e),e}(Kt);var fH=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),uc=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n};function cc(o,e){for(var t=he({},o),i=0,r=Object.keys(t);i<r.length;i++){var n=r[i];e.indexOf(n)<0&&ip(t,n)}return t}function gH(o,e){var t=e===40?0:o.childElementCount-1,i=t,r,n=o.querySelector(".e-selected");n&&n.classList.remove("e-selected");for(var s=0,a=o.children.length;s<a;s++)o.children[s].classList.contains("e-focused")&&(r=o.children[s],i=s,r.classList.remove("e-focused"),e===40?i++:i--,i===(e===40?o.childElementCount:-1)&&(i=t));r=o.children[i],i=QT(o,r,i,e),i!==-1&&(Y([o.children[i]],"e-focused"),o.children[i].focus())}function QT(o,e,t,i,r){if(r===void 0&&(r=0),(e.classList.contains("e-separator")||e.classList.contains("e-disabled"))&&(t===(i===40?o.childElementCount-1:0)?t=i===40?0:o.childElementCount-1:i===40?t++:t--),e=o.children[t],e.classList.contains("e-separator")||e.classList.contains("e-disabled")){if(r++,r===o.childElementCount)return t=-1;t=QT(o,e,t,i,r)}return t}function vH(o,e){var t=[].slice.call(o.getElementsByClassName("e-blank-icon"));if(e){var i=[].slice.call(o.getElementsByClassName("e-item"));i.forEach(function(h){(h.style.paddingLeft||h.style.paddingRight)&&h.removeAttribute("style")})}if(t.length){var r=o.querySelector(".e-item:not(.e-blank-icon):not(.e-separator)");if(!g(r)){r.classList.contains("e-url")&&(r=r.querySelector(".e-menu-url"));var n=r.querySelector(".e-menu-icon"),s,a=o.classList.contains("e-rtl");a?s={padding:"paddingRight",margin:"marginLeft"}:s={padding:"paddingLeft",margin:"marginRight"};var l=parseInt(getComputedStyle(n).fontSize,10)+parseInt(getComputedStyle(n)[s.margin],10)+parseInt(getComputedStyle(r).paddingLeft,10)+"px";t.forEach(function(h){h.classList.contains("e-url")&&h.querySelector(".e-menu-url")?h.querySelector(".e-menu-url").style[s.padding]=l:h.style[s.padding]=l})}}}var kC=function(o){fH(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return uc([C("")],e.prototype,"iconCss",void 0),uc([C("")],e.prototype,"id",void 0),uc([C(!1)],e.prototype,"separator",void 0),uc([C("")],e.prototype,"text",void 0),uc([C("")],e.prototype,"url",void 0),uc([C(!1)],e.prototype,"disabled",void 0),e}(Re),XT=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Sr=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},ns={DISABLED:"e-disabled",FOCUS:"e-focused",ICON:"e-menu-icon",ITEM:"e-item",POPUP:"e-dropdown-popup",RTL:"e-rtl",SEPARATOR:"e-separator",VERTICAL:"e-vertical",POPUPWIDTH:"e-dropdown-popup-width"},mH=function(o){XT(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Sr([C("SlideDown")],e.prototype,"effect",void 0),Sr([C(400)],e.prototype,"duration",void 0),Sr([C("ease")],e.prototype,"easing",void 0),e}(Re),Or=function(o){XT(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.isPopupCreated=!0,r}return e.prototype.preRender=function(){},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.toggle=function(){this.canOpen()?this.openPopUp():this.createPopupOnClick&&!this.isPopupCreated?(this.createPopup(),this.openPopUp()):this.closePopup()},e.prototype.render=function(){this.initialize(),this.disabled||this.wireEvents(),this.renderComplete()},e.prototype.addItems=function(t,i){for(var r,n=this.items.length,s=0,a=this.items.length;s<a;s++)if(i===this.items[s].text){n=s;break}for(var l=t.length-1;l>=0;l--)r=new kC(this,"items",t[l],!0),this.items.splice(n,0,r);this.canOpen()||this.createItems()},e.prototype.removeItems=function(t,i){for(var r=!1,n=0,s=t.length;n<s;n++)for(var a=0,l=this.items.length;a<l;a++)if(t[n]===(i?this.items[a].id:this.items[a].text)){this.items.splice(a,1),r=!0;break}r&&this.getULElement()&&this.createItems()},e.prototype.createPopup=function(){var t,i=this.createElement("div",{className:this.popupWidth!=="auto"?ns.POPUP+" "+ns.POPUPWIDTH:ns.POPUP,id:this.element.id+"-popup"});if(document.body.appendChild(i),this.dropDown=new Gn(i,{width:this.popupWidth,relateTo:this.element,collision:{X:"fit",Y:"flip"},position:{X:"left",Y:"bottom"},targetType:"relative",content:this.target?this.getTargetElement():"",enableRtl:this.enableRtl}),this.dropDown.element.setAttribute("role","dialog"),this.dropDown.element.setAttribute("aria-label","dropdown menu"),g(this.popupContent)||(this.popupContent.style.display=""),this.dropDown.element.style.position==="fixed"&&this.dropDown.refreshPosition(this.element),this.dropDown.hide(),Ie(this.element,(t={},t["aria-haspopup"]=this.items.length||this.target?"true":"false",t["aria-expanded"]="false",t.type="button",t)),this.cssClass&&Y([i],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.isPopupCreated=!0,this.createPopupOnClick){var r=at(this.activeElem[0],"split-btn");r&&(r.isPopupCreated=!0)}},e.prototype.getTargetElement=function(){return this.createPopupOnClick&&!this.isColorPicker()&&!g(this.popupContent)?this.popupContent:typeof this.target=="string"?X(this.target):this.target},e.prototype.createItems=function(t){var i=this,r=this.items,n=this.hasIcon(this.items,"iconCss"),s,a,l,h,u=this.getULElement();if(u?u.innerHTML="":u=this.createElement("ul",{attrs:{role:"menu",tabindex:"0"}}),this.itemTemplate){var c=this.compiletemplate(this.itemTemplate);r.forEach(function(m){var y=i.createElement("li",{className:m.separator?ns.ITEM+" "+ns.SEPARATOR:ns.ITEM,attrs:m.separator?{role:"separator",tabindex:"-1","aria-label":"separator","aria-hidden":"true"}:{role:"menuitem",tabindex:"-1","aria-label":m.text},id:m.id?m.id:kt("e-"+i.getModuleName()+"-item")}),S=c(m,i,"template",null,!1,null,y);S&&dt(S,y),m.disabled&&y.classList.add("e-disabled");var b={item:m,element:y};i.trigger("beforeItemRender",b),b.item.disabled!==m.disabled&&y.classList[b.item.disabled?"add":"remove"]("e-disabled"),u.appendChild(y)}),this.isReact&&this.renderReactTemplates()}else for(var d=0;d<r.length;d++){a=r[d],this.enableHtmlSanitizer&&(a.text=Bt.sanitize(a.text));var p=a.text;l=this.createElement("li",{innerHTML:a.url?"":p,className:a.separator?ns.ITEM+" "+ns.SEPARATOR:ns.ITEM,attrs:a.separator?{role:"separator",tabindex:"-1","aria-label":"separator","aria-hidden":"true"}:{role:"menuitem",tabindex:"-1","aria-label":p},id:a.id?a.id:kt("e-"+this.getModuleName()+"-item")}),this.enableHtmlSanitizer?l.textContent=a.url?"":p:l.innerHTML=a.url?"":p,a.url&&(l.appendChild(this.createAnchor(a)),l.classList.add("e-url")),a.iconCss?(s=this.createElement("span",{className:ns.ICON+" "+a.iconCss}),a.url?l.childNodes[0].appendChild(s):l.insertBefore(s,l.childNodes[0])):n&&!a.separator&&l.classList.add("e-blank-icon");var f=a.disabled;a.disabled&&l.classList.add("e-disabled"),h={item:a,element:l},this.trigger("beforeItemRender",h);var v=h.item.disabled;f!==v&&(h.item.disabled?l.classList.add("e-disabled"):l.classList.remove("e-disabled")),u.appendChild(l)}t&&this.getPopUpElement().appendChild(u),n&&vH(this.getPopUpElement())},e.prototype.compiletemplate=function(t){if(this.itemTemplate)try{if(typeof this.itemTemplate!="function"){var i=document.querySelector(this.itemTemplate);if(i)return wt(i.innerHTML.trim())}return wt(t)}catch{return wt(t)}},e.prototype.hasIcon=function(t,i){for(var r=0,n=t.length;r<n;r++)if(t[r][""+i])return!0;return!1},e.prototype.createAnchor=function(t){var i=t.text,r=this.createElement("a",{className:"e-menu-text e-menu-url",attrs:{href:t.url}});return this.enableHtmlSanitizer?r.textContent=i:r.innerHTML=i,r},e.prototype.initialize=function(){this.button=new bn({iconCss:this.iconCss,iconPosition:this.iconPosition,cssClass:this.cssClass,content:this.content,disabled:this.disabled,enableRtl:this.enableRtl,enablePersistence:this.enablePersistence}),this.button.createElement=this.createElement,this.button.appendTo(this.element),this.element.id||(this.element.id=kt("e-"+this.getModuleName())),this.appendArrowSpan(),this.setActiveElem([this.element]),this.element.setAttribute("tabindex","0"),this.element.setAttribute("aria-label",this.element.textContent?this.element.textContent:"dropdownbutton"),this.target&&!this.isColorPicker()&&!this.createPopupOnClick||!this.createPopupOnClick?this.createPopup():(this.isPopupCreated=!1,this.target&&!this.isColorPicker()&&this.createPopupOnClick&&(this.popupContent=this.getTargetElement(),this.popupContent.style.display="none"))},e.prototype.isColorPicker=function(){if(!this.element)return!1;var t=this.element.previousSibling;return!!(t&&t.classList&&t.classList.contains("e-split-colorpicker"))},e.prototype.appendArrowSpan=function(){this.cssClass=g(this.cssClass)?"":this.cssClass,this.element.appendChild(this.createElement("span",{className:"e-btn-icon e-icons e-icon-"+(this.cssClass.indexOf(ns.VERTICAL)>-1?"bottom":"right")+" e-caret"}))},e.prototype.setActiveElem=function(t){this.activeElem=t},e.prototype.getModuleName=function(){return"dropdown-btn"},e.prototype.canOpen=function(){var t=!1;return this.isPopupCreated&&(t=this.getPopUpElement().classList.contains("e-popup-close")),t},e.prototype.destroy=function(){var t=this;if(o.prototype.destroy.call(this),this.getModuleName()==="dropdown-btn"){var i;this.element.querySelector("span.e-caret")&&ee(this.element.querySelector("span.e-caret")),this.cssClass&&(i=this.cssClass.split(" ")),this.button.destroy(),i&&K([this.element],i),K(this.activeElem,["e-active"]);var r=this.element.getAttribute("class")?["aria-haspopup","aria-expanded","aria-owns","type"]:["aria-haspopup","aria-expanded","aria-owns","type","class"];r.forEach(function(n){t.element.removeAttribute(n)}),this.popupUnWireEvents(),this.destroyPopup(),this.isPopupCreated=!1,this.disabled||this.unWireEvents()}},e.prototype.destroyPopup=function(){if(this.isPopupCreated){if(this.dropDown.destroy(),this.getPopUpElement()){var t=document.getElementById(this.getPopUpElement().id);t&&(K([t],["e-popup-open","e-popup-close"]),ee(t))}E.remove(this.getPopUpElement(),"click",this.clickHandler),E.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler),this.isPopupCreated&&this.dropDown&&(this.dropDown.element=null,this.dropDown=void 0)}this.isPopupCreated=!1;var i=at(this.activeElem[0],"split-btn");if(this.createPopupOnClick&&i){var r=at(this.activeElem[1],"dropdown-btn");r&&(r.isPopupCreated=!1)}},e.prototype.getPopUpElement=function(){var t=null;if(!this.dropDown&&this.activeElem[0].classList.contains("e-split-btn")){var i=at(this.activeElem[1],"dropdown-btn");i&&(this.dropDown=i.dropDown)}return this.dropDown&&(t=this.dropDown.element),t},e.prototype.getULElement=function(){var t=null;return this.getPopUpElement()&&(t=this.getPopUpElement().children[0]),t},e.prototype.wireEvents=function(){this.delegateMousedownHandler=this.mousedownHandler.bind(this),this.createPopupOnClick||E.add(document,"mousedown touchstart",this.delegateMousedownHandler,this),E.add(this.element,"click",this.clickHandler,this),E.add(this.element,"keydown",this.keyBoardHandler,this),E.add(window,"resize",this.windowResize,this)},e.prototype.windowResize=function(){!this.canOpen()&&this.dropDown&&this.dropDown.refreshPosition(this.element)},e.prototype.popupWireEvents=function(){this.delegateMousedownHandler||(this.delegateMousedownHandler=this.mousedownHandler.bind(this));var t=this.getPopUpElement();this.createPopupOnClick&&E.add(document,"mousedown touchstart",this.delegateMousedownHandler,this),t&&(E.add(t,"click",this.clickHandler,this),E.add(t,"keydown",this.keyBoardHandler,this),this.closeActionEvents&&E.add(t,this.closeActionEvents,this.focusoutHandler,this)),this.rippleFn=Vi(t,{selector:"."+ns.ITEM})},e.prototype.popupUnWireEvents=function(){var t=this.getPopUpElement();this.createPopupOnClick&&E.remove(document,"mousedown touchstart",this.delegateMousedownHandler),t&&t.parentElement&&(E.remove(t,"click",this.clickHandler),E.remove(t,"keydown",this.keyBoardHandler),this.closeActionEvents&&E.remove(t,this.closeActionEvents,this.focusoutHandler)),ka&&this.rippleFn&&this.rippleFn()},e.prototype.keyBoardHandler=function(t){if(!(t.target===this.element&&(t.keyCode===9||!t.altKey&&t.keyCode===40||t.keyCode===38)))switch(t.keyCode){case 38:case 40:t.altKey&&(t.keyCode===38||t.keyCode===40)?this.keyEventHandler(t):this.upDownKeyHandler(t);break;case 9:case 13:case 27:case 32:this.keyEventHandler(t);break}},e.prototype.isSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},e.prototype.upDownKeyHandler=function(t){this.target&&(t.keyCode===38||t.keyCode===40)||(t.preventDefault(),gH(this.getULElement(),t.keyCode))},e.prototype.keyEventHandler=function(t){if(!(this.target&&(t.keyCode===13||t.keyCode===9))){if(t.keyCode===13&&this.activeElem[0].classList.contains("e-split-btn")){this.triggerSelect(t),this.activeElem[0].focus();return}t.target&&t.target.className.indexOf("e-edit-template")>-1&&t.keyCode===32||(t.keyCode!==9&&t.preventDefault(),t.keyCode===27||t.keyCode===38||t.keyCode===9?this.canOpen()||this.closePopup(t,this.element):this.clickHandler(t))}},e.prototype.getLI=function(t){return t.tagName==="LI"?t:j(t,"li")},e.prototype.mousedownHandler=function(t){var i=t.target;this.dropDown&&!this.canOpen()&&this.getPopUpElement()&&!(j(i,'[id="'+this.getPopUpElement().id+'"]')||j(i,'[id="'+this.element.id+'"]'))&&this.closePopup(t)},e.prototype.focusoutHandler=function(t){if(this.isPopupCreated&&!this.canOpen()){var i=t.relatedTarget||t.target;if(i&&i.className.indexOf("e-item")>-1){var r=this.getLI(i);if(r){var n=Array.prototype.indexOf.call(this.getULElement().children,r),s=this.items[n];if(s){var a={element:r,item:s,event:t};this.trigger("select",a)}}}this.closePopup(t)}},e.prototype.clickHandler=function(t){var i=t.target;if(j(i,'[id="'+this.element.id+'"]'))!this.createPopupOnClick||this.target&&this.target!==""&&!this.isColorPicker()&&!this.createPopupOnClick?this.getPopUpElement().classList.contains("e-popup-close")?this.openPopUp(t):this.closePopup(t):this.isPopupCreated?this.closePopup(t,this.activeElem[0]):(this.createPopup(),this.openPopUp(t));else if(j(i,'[id="'+this.getPopUpElement().id+'"]')){var r=this.getLI(t.target);r&&(this.triggerSelect(t),this.closePopup(t,this.activeElem[0]))}},e.prototype.triggerSelect=function(t){var i,r,n,s=this.getLI(t.target);s&&(r=Array.prototype.indexOf.call(this.getULElement().children,s),n=this.items[r],n&&(i={element:s,item:n,event:t},this.trigger("select",i)))},e.prototype.openPopUp=function(t){var i=this;t===void 0&&(t=null);var r=this.getPopUpElement();if(this.activeElem[0]&&this.activeElem[0].classList.contains("e-dropdown-btn")&&r.style.width&&r.style.width!=="auto"&&this.setWidth(r),!this.target)this.createItems(!0);else if(this.activeElem.length>1){var n=at(this.activeElem[0],"split-btn");n.isReact&&r.childNodes.length<1&&(n.appendReactElement&&n.appendReactElement(this.getTargetElement(),this.getPopUpElement()),this.renderReactTemplates())}else this.isReact&&r.childNodes.length<1&&(this.appendReactElement&&this.appendReactElement(this.getTargetElement(),this.getPopUpElement()),this.renderReactTemplates());var s=this.getULElement();this.popupWireEvents();var a={element:s,items:this.items,event:t,cancel:!1};this.trigger("beforeOpen",a,function(l){if(!l.cancel){var h=i.getULElement(),u=i.animationSettings.effect!=="None"?{name:i.animationSettings.effect,duration:i.animationSettings.duration,timingFunction:i.animationSettings.easing}:null;if(u&&i.animatePopup(u,h),i.dropDown.show(null,i.element),Y([i.element],"e-active"),i.element.setAttribute("aria-expanded","true"),i.element.setAttribute("aria-owns",i.getPopUpElement().id),h&&!i.isSafari()&&h.focus(),i.enableRtl&&h.parentElement.style.left!=="0px"){var c=void 0;i.element.parentElement&&i.element.parentElement.classList.contains("e-split-btn-wrapper")?c=i.element.parentElement.offsetWidth:c=i.element.offsetWidth;var d=h.parentElement.offsetWidth-c,p=parseFloat(h.parentElement.style.left)-d;p<0&&(p=0),h.parentElement.style.left=p+"px"}var f={element:h,items:i.items};i.trigger("open",f),h&&i.isSafari()&&h.focus()}})},e.prototype.animatePopup=function(t,i){new It(t).animate(i,{begin:function(r){r.element.parentElement.style.height=r.element.parentElement.offsetHeight+"px"}})},e.prototype.setWidth=function(t){var i=Le(t.style.width);if(i.indexOf("%")>-1){var r=this.element.offsetWidth*parseFloat(i)/100;t.style.width=r+"px"}},e.prototype.closePopup=function(t,i){var r=this;t===void 0&&(t=null);var n=this.getULElement(),s={element:n,items:this.items,event:t,cancel:!1};this.trigger("beforeClose",s,function(a){if(a.cancel)n&&n.focus();else{var l=r.getPopUpElement();l&&E.remove(l,"keydown",r.keyBoardHandler),r.popupUnWireEvents();var h=r.getULElement(),u=void 0;h&&(u=h.querySelector(".e-selected")),u&&u.classList.remove("e-selected"),r.dropDown&&r.dropDown.hide(),K(r.activeElem,"e-active"),r.element.setAttribute("aria-expanded","false"),r.element.removeAttribute("aria-owns"),i&&(r.isSafari()?i.focus({preventScroll:!0}):i.focus());var c={element:h,items:r.items};r.trigger("close",c),!r.target&&h&&ee(h),(!r.target||r.isColorPicker()||r.target&&!r.isColorPicker())&&r.createPopupOnClick&&r.destroyPopup()}})},e.prototype.unWireEvents=function(){this.createPopupOnClick||E.remove(document,"mousedown touchstart",this.delegateMousedownHandler),E.remove(this.element,"click",this.clickHandler),E.remove(this.element,"keydown",this.keyBoardHandler),this.isPopupCreated&&(E.remove(this.getPopUpElement(),"click",this.clickHandler),E.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler)),E.remove(window,"resize",this.windowResize)},e.prototype.onPropertyChanged=function(t,i){var r=["content","cssClass","iconCss","iconPosition","disabled","enableRtl"];this.button.setProperties(cc(t,r));var n;this.isPopupCreated&&(n=this.getPopUpElement(),this.dropDown.setProperties(cc(t,["enableRtl"])));for(var s=0,a=Object.keys(t);s<a.length;s++){var l=a[s];switch(l){case"content":this.element.querySelector("span.e-caret")||this.appendArrowSpan();break;case"disabled":t.disabled?(this.unWireEvents(),this.isPopupCreated&&!this.canOpen()&&this.closePopup()):this.wireEvents();break;case"cssClass":if(i.cssClass=g(i.cssClass)?"":i.cssClass,t.cssClass.indexOf(ns.VERTICAL)>-1||i.cssClass.indexOf(ns.VERTICAL)>-1){this.element.querySelector("span.e-caret")||this.appendArrowSpan();var h=this.element.querySelector("span.e-caret");t.cssClass.indexOf(ns.VERTICAL)>-1?wi(h,["e-icon-bottom"],["e-icon-right"]):wi(h,["e-icon-right"],["e-icon-bottom"])}this.isPopupCreated&&(i.cssClass&&K([n],i.cssClass.split(" ")),t.cssClass&&Y([n],t.cssClass.replace(/\s+/g," ").trim().split(" ")));break;case"target":this.dropDown.content=this.getTargetElement(),this.dropDown.dataBind();break;case"items":this.isPopupCreated&&this.getULElement()&&this.createItems();break;case"createPopupOnClick":t.createPopupOnClick?this.destroyPopup():this.createPopup();break}}},e.prototype.focusIn=function(){this.element.focus()},Sr([C("")],e.prototype,"content",void 0),Sr([C("")],e.prototype,"cssClass",void 0),Sr([C(!1)],e.prototype,"disabled",void 0),Sr([C("")],e.prototype,"iconCss",void 0),Sr([C("Left")],e.prototype,"iconPosition",void 0),Sr([C(!0)],e.prototype,"enableHtmlSanitizer",void 0),Sr([Wt([],kC)],e.prototype,"items",void 0),Sr([C(!1)],e.prototype,"createPopupOnClick",void 0),Sr([C("")],e.prototype,"target",void 0),Sr([C("")],e.prototype,"closeActionEvents",void 0),Sr([C(null)],e.prototype,"itemTemplate",void 0),Sr([C("auto")],e.prototype,"popupWidth",void 0),Sr([be({effect:"None"},mH)],e.prototype,"animationSettings",void 0),Sr([q()],e.prototype,"beforeItemRender",void 0),Sr([q()],e.prototype,"beforeOpen",void 0),Sr([q()],e.prototype,"beforeClose",void 0),Sr([q()],e.prototype,"close",void 0),Sr([q()],e.prototype,"open",void 0),Sr([q()],e.prototype,"select",void 0),Sr([q()],e.prototype,"created",void 0),e=Sr([bt],e),e}(Kt),yH=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Nn=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},pv="e-rtl",LC="EJS-SPLITBUTTON",Sp=function(o){yH(e,o);function e(t,i){return o.call(this,t,i)||this}return e.prototype.preRender=function(){var t=this.element;if(t.tagName===LC){for(var i=V("ej2_instances",t),r=this.createElement("button",{attrs:{type:"button"}}),n=this.createElement(LC,{className:"e-"+this.getModuleName()+"-wrapper"}),s=0,a=t.attributes.length;s<a;s++)r.setAttribute(t.attributes[s].nodeName,t.attributes[s].nodeValue);t.parentNode.insertBefore(n,t),ee(t),t=r,n.appendChild(t),Ge("ej2_instances",i,t),this.wrapper=n,this.element=t}this.element.id||(this.element.id=kt("e-"+this.getModuleName()))},e.prototype.render=function(){this.initWrapper(),this.createPrimaryButton(),this.renderControl()},e.prototype.renderControl=function(){this.createSecondaryButton(),this.setActiveElem([this.element,this.secondaryBtnObj.element]),this.setAria(),this.wireEvents(),this.renderComplete()},e.prototype.addItems=function(t,i){o.prototype.addItems.call(this,t,i),this.secondaryBtnObj.items=this.items},e.prototype.removeItems=function(t,i){o.prototype.removeItems.call(this,t,i),this.secondaryBtnObj.items=this.items},e.prototype.initWrapper=function(){this.wrapper||(this.wrapper=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"}),this.element.parentNode.insertBefore(this.wrapper,this.element)),this.element.classList.remove("e-"+this.getModuleName()),this.enableRtl&&this.wrapper.classList.add(pv),this.cssClass&&Y([this.wrapper],this.cssClass.replace(/\s+/g," ").trim().split(" "))},e.prototype.createPrimaryButton=function(){var t={cssClass:this.cssClass,enableRtl:this.enableRtl,iconCss:this.iconCss,iconPosition:this.iconPosition,content:this.content,disabled:this.disabled};this.primaryBtnObj=new bn(t),this.primaryBtnObj.createElement=this.createElement,this.primaryBtnObj.appendTo(this.element),this.element.classList.add("e-"+this.getModuleName()),this.element.type="button",this.wrapper.appendChild(this.element)},e.prototype.createSecondaryButton=function(){var t=this,i=this.createElement("button",{className:"e-icon-btn",attrs:{tabindex:"-1"},id:this.element.id+"_dropdownbtn"});this.wrapper.appendChild(i);var r={cssClass:this.cssClass,disabled:this.disabled,enableRtl:this.enableRtl,items:this.items,target:this.target,createPopupOnClick:this.createPopupOnClick};r.beforeItemRender=function(n){t.createPopupOnClick&&(t.secondaryBtnObj.dropDown.relateTo=t.wrapper,t.dropDown=t.secondaryBtnObj.dropDown),t.trigger("beforeItemRender",n)},r.open=function(n){t.trigger("open",n)},r.close=function(n){t.trigger("close",n)},r.select=function(n){t.trigger("select",n)},r.beforeOpen=function(n){t.createPopupOnClick&&t.items.length===0&&(t.secondaryBtnObj.dropDown.relateTo=t.wrapper,t.dropDown=t.secondaryBtnObj.dropDown);var s=new bp;return t.trigger("beforeOpen",n,function(a){s.resolve(a)}),s},r.beforeClose=function(n){var s=new bp;return t.trigger("beforeClose",n,function(a){s.resolve(a)}),s},this.secondaryBtnObj=new Or(r),this.secondaryBtnObj.createElement=this.createElement,this.secondaryBtnObj.appendTo(i),this.createPopupOnClick||(this.secondaryBtnObj.dropDown.relateTo=this.wrapper,this.dropDown=this.secondaryBtnObj.dropDown),this.isPopupCreated=this.secondaryBtnObj.isPopupCreated,this.secondaryBtnObj.activeElem=[this.element,this.secondaryBtnObj.element],this.secondaryBtnObj.element.querySelector(".e-btn-icon").classList.remove("e-icon-right"),this.disabled&&this.wrapper.classList.add("e-splitbtn-disabled")},e.prototype.setAria=function(){Ie(this.element,{"aria-expanded":"false","aria-haspopup":"true","aria-label":this.element.textContent?this.element.textContent+" splitbutton":"splitbutton","aria-owns":this.element.id+"_dropdownbtn-popup"})},e.prototype.getModuleName=function(){return"split-btn"},e.prototype.toggle=function(){this.secondaryBtnObj.toggle()},e.prototype.destroy=function(){var t=this,i=[pv];if(this.cssClass&&(i=i.concat(this.cssClass.split(" "))),this.element){var r=document.getElementById(this.element.id);r&&r.parentElement===this.wrapper&&(this.wrapper.tagName===LC?(this.wrapper.innerHTML="",K([this.wrapper],["e-rtl","e-"+this.getModuleName()+"-wrapper"]),K([this.wrapper],this.cssClass.split(" "))):(K([this.element],i),["aria-label","aria-haspopup","aria-expanded","aria-owns","type"].forEach(function(n){t.element.removeAttribute(n)}),this.wrapper.parentNode.insertBefore(this.element,this.wrapper),Ue(this.wrapper)),this.unWireEvents())}this.primaryBtnObj.destroy(),this.secondaryBtnObj.destroy(),o.prototype.destroy.call(this),this.element&&!this.element.getAttribute("class")&&this.element.removeAttribute("class"),this.refreshing&&this.isAngular&&(this.element=this.wrapper,["e-control","e-split-btn","e-lib"].forEach(function(n){t.element.classList.add(n)}),Ge("ej2_instances",[this],this.element)),this.wrapper=null},e.prototype.wireEvents=function(){E.add(this.element,"click",this.primaryBtnClickHandler,this),new $i(this.element,{keyAction:this.btnKeyBoardHandler.bind(this),keyConfigs:{altdownarrow:"alt+downarrow",enter:"enter"}})},e.prototype.unWireEvents=function(){E.remove(this.element,"click",this.primaryBtnClickHandler),fr(this.element,$i).destroy()},e.prototype.primaryBtnClickHandler=function(){this.trigger("click",{element:this.element})},e.prototype.btnKeyBoardHandler=function(t){switch(t.action){case"altdownarrow":this.clickHandler(t);break;case"enter":this.clickHandler(t),this.getPopUpElement()&&!this.getPopUpElement().classList.contains("e-popup-close")?(this.element.classList.remove("e-active"),this.secondaryBtnObj.element.classList.add("e-active")):this.secondaryBtnObj.element.classList.remove("e-active");break}},e.prototype.onPropertyChanged=function(t,i){var r=["content","iconCss","iconPosition","cssClass","disabled","enableRtl"];this.primaryBtnObj.setProperties(cc(t,r)),r=["beforeOpen","beforeItemRender","select","open","close","cssClass","disabled","enableRtl","createPopupOnClick"],Object.keys(t).indexOf("items")>-1&&(this.secondaryBtnObj.items=t.items,this.secondaryBtnObj.dataBind()),this.secondaryBtnObj.setProperties(cc(t,r));for(var n=0,s=Object.keys(t);n<s.length;n++){var a=s[n];switch(a){case"cssClass":i.cssClass&&K([this.wrapper],i.cssClass.split(" ")),Y([this.wrapper],t.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":t.enableRtl?Y([this.wrapper],pv):K([this.wrapper],pv);break;case"disabled":t.disabled?Y([this.wrapper],"e-splitbtn-disabled"):K([this.wrapper],"e-splitbtn-disabled")}}},e.prototype.focusIn=function(){this.element.focus()},Nn([C("")],e.prototype,"content",void 0),Nn([C("")],e.prototype,"cssClass",void 0),Nn([C(!1)],e.prototype,"disabled",void 0),Nn([C("")],e.prototype,"iconCss",void 0),Nn([C("Left")],e.prototype,"iconPosition",void 0),Nn([C(!1)],e.prototype,"createPopupOnClick",void 0),Nn([Wt([],kC)],e.prototype,"items",void 0),Nn([C("")],e.prototype,"target",void 0),Nn([q()],e.prototype,"beforeItemRender",void 0),Nn([q()],e.prototype,"beforeOpen",void 0),Nn([q()],e.prototype,"beforeClose",void 0),Nn([q()],e.prototype,"click",void 0),Nn([q()],e.prototype,"close",void 0),Nn([q()],e.prototype,"open",void 0),Nn([q()],e.prototype,"select",void 0),Nn([q()],e.prototype,"created",void 0),e=Nn([bt],e),e}(Or),bp=function(){function o(){var e=this;this.promise=new Promise(function(t,i){e.resolve=t,e.reject=i}),this.catch=this.promise.catch.bind(this.promise),this.then=this.promise.then.bind(this.promise)}return o}();var $e={RTL:"e-rtl",DISABLE:"e-disabled",INPUT:"e-input",TEXTAREA:"e-multi-line-input",INPUTGROUP:"e-input-group",FLOATINPUT:"e-float-input",FLOATLINE:"e-float-line",FLOATTEXT:"e-float-text",FLOATTEXTCONTENT:"e-float-text-content",CLEARICON:"e-clear-icon",CLEARICONHIDE:"e-clear-icon-hide",LABELTOP:"e-label-top",LABELBOTTOM:"e-label-bottom",NOFLOATLABEL:"e-no-float-label",INPUTCUSTOMTAG:"e-input-custom-tag",FLOATCUSTOMTAG:"e-float-custom-tag"},HC=["title","style","class"],$T="e-input-focus",Ce;(function(o){var e,t=!0;function i(_,Z){_.element.__eventHandlers={};var we=g(Z)?Xe:Z,Te={container:null,buttons:[],clearButton:null};if(e=_.floatLabelType,t=_.bindClearAction,g(_.floatLabelType)||_.floatLabelType==="Never"?(Te.container=P(_,$e.INPUTGROUP,$e.INPUTCUSTOMTAG,"span",we),_.element.parentNode.insertBefore(Te.container,_.element),Y([_.element],$e.INPUT),Te.container.appendChild(_.element)):m(_,Te,we),a(_),!g(_.properties)&&!g(_.properties.showClearButton)&&_.properties.showClearButton&&(oe(_.properties.showClearButton,_.element,Te,!0,we),Te.clearButton.setAttribute("role","button"),Te.container.classList.contains($e.FLOATINPUT)&&Y([Te.container],$e.INPUTGROUP)),!g(_.buttons))for(var je=0;je<_.buttons.length;je++)Te.buttons.push(zi(_.buttons[je],Te.container,we));return!g(_.element)&&_.element.tagName==="TEXTAREA"&&Y([Te.container],$e.TEXTAREA),Ct(Te.container,_.element),Te=b(_,Te),ue(Te.container,we),Te}o.createInput=i;function r(_){var Z=x(_.element);(Z.classList.contains("e-input-group")||Z.classList.contains("e-outline")||Z.classList.contains("e-filled"))&&Z.classList.add("e-input-focus"),_.floatLabelType!=="Never"&&setTimeout(function(){o.calculateWidth(_.element,Z)},80)}function n(_){var Z=x(_.element);(Z.classList.contains("e-input-group")||Z.classList.contains("e-outline")||Z.classList.contains("e-filled"))&&Z.classList.remove("e-input-focus"),_.floatLabelType!=="Never"&&setTimeout(function(){o.calculateWidth(_.element,Z)},80)}function s(_){h(_.floatLabelType,_.element)}function a(_){h(_.floatLabelType,_.element);var Z=function(){return r(_)},we=function(){return n(_)},Te=function(){return s(_)};_.element.addEventListener("focus",Z),_.element.addEventListener("blur",we),_.element.addEventListener("input",Te),_.element.__eventHandlers.inputFocusHandler={focusHandler:Z},_.element.__eventHandlers.inputBlurHandler={blurHandler:we},_.element.__eventHandlers.inputHandler={inputHandler:Te}}o.bindInitialEvent=a;function l(_){if(!g(_.element)&&!g(_.element.__eventHandlers)&&!g(_.element.__eventHandlers.inputFocusHandler)&&!g(_.element.__eventHandlers.inputBlurHandler)&&!g(_.element.__eventHandlers.inputHandler)){var Z=_.element.__eventHandlers.inputFocusHandler.focusHandler,we=_.element.__eventHandlers.inputBlurHandler.blurHandler,Te=_.element.__eventHandlers.inputHandler.inputHandler;_.element.removeEventListener("focus",Z),_.element.removeEventListener("blur",we),_.element.removeEventListener("input",Te),delete _.element.__eventHandlers.inputFocusHandler,delete _.element.__eventHandlers.inputBlurHandler,delete _.element.__eventHandlers.inputHandler}}function h(_,Z){var we=Z.value,Te=Z.parentElement,je=Te&&Te.parentElement;we!==""&&!g(we)?Te&&Te.classList.contains("e-input-group")?Te.classList.add("e-valid-input"):je&&je.classList.contains("e-input-group")&&je.classList.add("e-valid-input"):_!=="Always"&&(Te&&Te.classList.contains("e-input-group")?Te.classList.remove("e-valid-input"):je&&je.classList.contains("e-input-group")&&je.classList.remove("e-valid-input"))}function u(){var _=x(this).getElementsByClassName("e-float-text")[0];g(_)||(Y([_],$e.LABELTOP),_.classList.contains($e.LABELBOTTOM)&&K([_],$e.LABELBOTTOM))}function c(){var _=x(this);if(_.getElementsByTagName("textarea")[0]?_.getElementsByTagName("textarea")[0].value==="":_.getElementsByTagName("input")[0].value===""){var Z=_.getElementsByClassName("e-float-text")[0];g(Z)||(Z.classList.contains($e.LABELTOP)&&K([Z],$e.LABELTOP),Y([Z],$e.LABELBOTTOM))}}function d(_){_.addEventListener("focus",u),_.addEventListener("blur",c)}o.wireFloatingEvents=d;function p(_){g(_)||(_.removeEventListener("focus",u),_.removeEventListener("blur",c))}function f(_){N(_.element,_.floatLabelType)}function v(_){N(_.element,_.floatLabelType)}function m(_,Z,we){var Te=g(we)?Xe:we;_.floatLabelType==="Auto"&&d(_.element),g(Z.container)?(Z.container=P(_,$e.FLOATINPUT,$e.FLOATCUSTOMTAG,"div",Te),Z.container.classList.add($e.INPUTGROUP),_.element.parentNode&&_.element.parentNode.insertBefore(Z.container,_.element)):(g(_.customTag)||Z.container.classList.add($e.FLOATCUSTOMTAG),Z.container.classList.add($e.FLOATINPUT));var je=Te("span",{className:$e.FLOATLINE}),He=Te("label",{className:$e.FLOATTEXT});if(!g(_.element.id)&&_.element.id!==""&&(He.id="label_"+_.element.id.replace(/ /g,"_"),Ie(_.element,{"aria-labelledby":He.id})),!g(_.element.placeholder)&&_.element.placeholder!==""&&(He.innerText=O(_.element.placeholder),_.element.removeAttribute("placeholder")),!g(_.properties)&&!g(_.properties.placeholder)&&_.properties.placeholder!==""&&(He.innerText=O(_.properties.placeholder)),He.innerText||Z.container.classList.add($e.NOFLOATLABEL),Z.container.classList.contains("e-float-icon-left")){var gt=Z.container.querySelector(".e-input-in-wrap");gt.appendChild(_.element),gt.appendChild(je),gt.appendChild(He)}else Z.container.appendChild(_.element),Z.container.appendChild(je),Z.container.appendChild(He);if(I(_.element.value,He),_.floatLabelType==="Always"&&(He.classList.contains($e.LABELBOTTOM)&&K([He],$e.LABELBOTTOM),Y([He],$e.LABELTOP)),_.floatLabelType==="Auto"){var Lr=function(){return f(_)},Ai=function(){return v(_)};_.element.addEventListener("input",Lr),_.element.addEventListener("blur",Ai),_.element.__eventHandlers.floatInputHandler={inputFloatHandler:Lr},_.element.__eventHandlers.floatBlurHandler={blurFloatHandler:Ai}}else y(_);g(_.element.getAttribute("id"))||He.setAttribute("for",_.element.getAttribute("id"))}function y(_){if(!g(_.element)&&!g(_.element.__eventHandlers)&&!g(_.element.__eventHandlers.floatInputHandler)&&!g(_.element.__eventHandlers.floatBlurHandler)){var Z=_.element.__eventHandlers.floatInputHandler.inputFloatHandler,we=_.element.__eventHandlers.floatBlurHandler.blurFloatHandler;_.element.removeEventListener("input",Z),_.element.removeEventListener("blur",we),delete _.element.__eventHandlers.floatInputHandler,delete _.element.__eventHandlers.floatBlurHandler}}function S(_,Z){_==="Always"&&Z.classList.contains("e-outline")&&Z.classList.add("e-valid-input")}function b(_,Z){if(!g(_.properties))for(var we=0,Te=Object.keys(_.properties);we<Te.length;we++){var je=Te[we];switch(je){case"cssClass":H(_.properties.cssClass,[Z.container]),S(_.floatLabelType,Z.container);break;case"enabled":te(_.properties.enabled,_.element,_.floatLabelType,Z.container);break;case"enableRtl":ne(_.properties.enableRtl,[Z.container]);break;case"placeholder":U(_.properties.placeholder,_.element);break;case"readonly":ie(_.properties.readonly,_.element);break}}return Z}function w(_,Z,we){g(Z)||(_&&!we?K([Z],$e.CLEARICONHIDE):Y([Z],$e.CLEARICONHIDE))}function I(_,Z,we){if(we===void 0&&(we=null),_)Y([Z],$e.LABELTOP),Z.classList.contains($e.LABELBOTTOM)&&K([Z],$e.LABELBOTTOM);else{var Te=we!=null?we!==document.activeElement:!0;Te&&(Z.classList.contains($e.LABELTOP)&&K([Z],$e.LABELTOP),Y([Z],$e.LABELBOTTOM))}}function x(_){var Z=g(_.parentNode)?_:_.parentNode;return Z&&Z.classList.contains("e-input-in-wrap")&&(Z=Z.parentNode),Z}function M(_,Z,we,Te){var je=g(Te)?Xe:Te,He=je("span",{className:$e.CLEARICON}),gt=Z.container;if(!g(we))gt.appendChild(He);else{var Lr=Z.container.classList.contains($e.FLOATINPUT)?Z.container.querySelector("."+$e.FLOATTEXT):_;Lr.insertAdjacentElement("afterend",He)}return Y([He],$e.CLEARICONHIDE),k(_,He),He.setAttribute("aria-label","close"),He}function D(_,Z,we){Z.classList.contains($e.DISABLE)||Z.readOnly||(_.preventDefault(),Z!==document.activeElement&&Z.focus(),Z.value="",Y([we],$e.CLEARICONHIDE))}function A(_,Z){w(_.value,Z)}function L(_,Z){w(_.value,Z,_.readOnly)}function T(_,Z){setTimeout(function(){g(Z)||(Y([Z],$e.CLEARICONHIDE),Z=!g(_)&&_.classList.contains("e-combobox")?null:Z)},200)}function k(_,Z,we){if(t===void 0||t){var Te=function(Lr){return D(Lr,_,Z)};Z.addEventListener("click",Te),_.__eventHandlers.clearClickHandler={clickHandlerEvent:Te}}var je=function(){return A(_,Z)},He=function(){return L(_,Z)},gt=function(){return T(_,Z)};_.addEventListener("input",je),_.addEventListener("focus",He),_.addEventListener("blur",gt),_.__eventHandlers.clearInputHandler={inputHandlerEvent:je},_.__eventHandlers.clearFocusHandler={focusHandlerEvent:He},_.__eventHandlers.clearBlurHandler={blurHandlerEvent:gt}}o.wireClearBtnEvents=k;function F(_,Z){if(!g(_)&&!g(_.__eventHandlers)){if(!g(_.__eventHandlers.clearClickHandler)){var we=_.__eventHandlers.clearClickHandler.clickHandlerEvent;(t===void 0||t)&&(g(Z)||Z.removeEventListener("click",we)),delete _.__eventHandlers.clearClickHandler}if(!g(_.__eventHandlers.clearInputHandler)&&!g(_.__eventHandlers.clearFocusHandler)&&!g(_.__eventHandlers.clearBlurHandler)){var Te=_.__eventHandlers.clearInputHandler.inputHandlerEvent,je=_.__eventHandlers.clearFocusHandler.focusHandlerEvent,He=_.__eventHandlers.clearBlurHandler.blurHandlerEvent;_.removeEventListener("input",Te),_.removeEventListener("focus",je),_.removeEventListener("blur",He),delete _.__eventHandlers.clearInputHandler,delete _.__eventHandlers.clearFocusHandler,delete _.__eventHandlers.clearBlurHandler}}}function R(_,Z){Z===void 0&&(Z=null),l(_),_.floatLabelType==="Auto"&&y(_),_.properties.showClearButton&&F(_.element,Z),g(_.buttons)||_e(!1,null,_.buttons),p(_.element),g(_.element)||(delete _.element.__eventHandlers,_.element.classList.contains($e.INPUT)&&_.element.classList.remove($e.INPUT))}o.destroy=R;function N(_,Z){var we=x(_);if(we.classList.contains($e.FLOATINPUT)&&Z==="Auto"){var Te=x(_).getElementsByClassName("e-float-text")[0];I(_.value,Te,_)}}function P(_,Z,we,Te,je){var He=g(je)?Xe:je,gt;return g(_.customTag)?gt=He(Te,{className:Z}):(gt=He(_.customTag,{className:Z}),gt.classList.add(we)),gt.classList.add("e-control-wrapper"),gt}function O(_){var Z="";if(!g(_)&&_!==""){var we=document.createElement("span");we.innerHTML='<input  placeholder="'+_+'"/>';var Te=we.children[0];Z=Te.placeholder}return Z}function z(_,Z,we,Te){if(Z.value=_,we!=="Never"&&Q(Z,Z.parentElement),!g(we)&&we==="Auto"&&N(Z,we),!g(Te)&&Te){var je=x(Z);if(!g(je)){var He=je.getElementsByClassName($e.CLEARICON)[0];g(He)||(Z.value&&!g(je)&&je.classList.contains("e-input-focus")?K([He],$e.CLEARICONHIDE):Y([He],$e.CLEARICONHIDE))}}h(we,Z)}o.setValue=z;function H(_,Z,we){!g(we)&&we!==""&&K(Z,we.split(" ")),!g(_)&&_!==""&&Y(Z,_.split(" "))}o.setCssClass=H;function Q(_,Z,we){if(!(we!=="multiselect"&&!We(_))){var Te=we==="multiselect"?_:_.clientWidth-parseInt(getComputedStyle(_,null).getPropertyValue("padding-left"),10);!g(Z)&&!g(Z.getElementsByClassName("e-float-text-content")[0])&&(Z.getElementsByClassName("e-float-text-content")[0].classList.contains("e-float-text-overflow")&&Z.getElementsByClassName("e-float-text-content")[0].classList.remove("e-float-text-overflow"),(Te<Z.getElementsByClassName("e-float-text-content")[0].clientWidth||Te===Z.getElementsByClassName("e-float-text-content")[0].clientWidth)&&Z.getElementsByClassName("e-float-text-content")[0].classList.add("e-float-text-overflow"))}}o.calculateWidth=Q;function $(_,Z){typeof _=="number"?Z.style.width=Le(_):typeof _=="string"&&(Z.style.width=_.match(/px|%|em/)?_:Le(_)),Q(Z.firstChild,Z)}o.setWidth=$;function U(_,Z){_=O(_);var we=x(Z);if(we.classList.contains($e.FLOATINPUT))if(!g(_)&&_!==""){var Te=we.getElementsByClassName("e-float-text-content")[0];Te&&Te.children[0]?Te.children[0].textContent=_:we.getElementsByClassName($e.FLOATTEXT)[0].textContent=_,we.classList.remove($e.NOFLOATLABEL),Z.removeAttribute("placeholder")}else{we.classList.add($e.NOFLOATLABEL);var Te=we.getElementsByClassName("e-float-text-content")[0];Te?Te.children[0].textContent="":we.getElementsByClassName($e.FLOATTEXT)[0].textContent=""}else!g(_)&&_!==""?Ie(Z,{placeholder:_}):Z.removeAttribute("placeholder")}o.setPlaceholder=U;function ie(_,Z,we){_?Ie(Z,{readonly:""}):Z.removeAttribute("readonly"),g(we)||N(Z,we)}o.setReadonly=ie;function ne(_,Z){_?Y(Z,$e.RTL):K(Z,$e.RTL)}o.setEnableRtl=ne;function te(_,Z,we,Te){var je={disabled:"","aria-disabled":"true"},He=!g(Te);_?(Z.classList.remove($e.DISABLE),ae(je,Z),He&&K([Te],$e.DISABLE)):(Z.classList.add($e.DISABLE),ye(je,Z),He&&Y([Te],$e.DISABLE)),g(we)||N(Z,we)}o.setEnabled=te;function oe(_,Z,we,Te,je){var He=g(je)?Xe:je;_?we.clearButton=M(Z,we,Te,He):(Ue(we.clearButton),we.clearButton=null)}o.setClearButton=oe;function ae(_,Z){for(var we=0,Te=Object.keys(_);we<Te.length;we++){var je=Te[we],He=x(Z);je==="disabled"&&Z.classList.remove($e.DISABLE),je==="disabled"&&He.classList.contains($e.INPUTGROUP)&&He.classList.remove($e.DISABLE),je==="placeholder"&&He.classList.contains($e.FLOATINPUT)?He.getElementsByClassName($e.FLOATTEXT)[0].textContent="":Z.removeAttribute(je)}}o.removeAttributes=ae;function ye(_,Z){for(var we=0,Te=Object.keys(_);we<Te.length;we++){var je=Te[we],He=x(Z);je==="disabled"&&Z.classList.add($e.DISABLE),je==="disabled"&&He.classList.contains($e.INPUTGROUP)&&He.classList.add($e.DISABLE),je==="placeholder"&&He.classList.contains($e.FLOATINPUT)?He.getElementsByClassName($e.FLOATTEXT)[0].textContent=_[""+je]:Z.setAttribute(je,_[""+je])}}o.addAttributes=ye;function De(_){var Z=_.container;if(!g(Z)&&Z.classList.contains($e.FLOATINPUT)){var we=Z.querySelector("textarea")?Z.querySelector("textarea"):Z.querySelector("input"),Te=Z.querySelector("."+$e.FLOATTEXT).textContent,je=Z.querySelector(".e-clear-icon")!==null;ee(Z.querySelector("."+$e.FLOATLINE)),ee(Z.querySelector("."+$e.FLOATTEXT)),wi(Z,[$e.INPUTGROUP],[$e.FLOATINPUT]),p(we),Ie(we,{placeholder:Te}),we.classList.add($e.INPUT),!je&&we.tagName==="INPUT"&&we.removeAttribute("required")}}o.removeFloating=De;function ve(_,Z,we,Te){var je=g(Te)?Xe:Te,He=j(_,"."+$e.INPUTGROUP);e=Z;var gt=He.tagName;gt=gt!=="DIV"&&gt!=="SPAN"?gt:null;var Lr={element:_,floatLabelType:Z,customTag:gt,properties:{placeholder:we}};if(Z!=="Never"){var Ai=He.querySelector(".e-clear-icon"),dn={container:He};_.classList.remove($e.INPUT),m(Lr,dn,je),ue(dn.container,je),Q(Lr.element,dn.container);var tn=He.classList.contains("e-float-icon-left");if(g(Ai))if(tn){var mn=He.querySelector(".e-input-in-wrap");Ai=mn.querySelector(".e-input-group-icon")}else Ai=He.querySelector(".e-input-group-icon");if(g(Ai))tn&&(Ai=He.querySelector(".e-input-group-icon"));else{var Sa=He.querySelector("."+$e.FLOATLINE),xd=He.querySelector("."+$e.FLOATTEXT),yn=tn?He.querySelector(".e-input-in-wrap"):He;yn.insertBefore(_,Ai),yn.insertBefore(Sa,Ai),yn.insertBefore(xd,Ai)}}else y(Lr);S(Z,_.parentElement)}o.addFloating=ve;function ue(_,Z){if(_.classList.contains("e-outline")&&_.getElementsByClassName("e-float-text")[0]){var we=Z("span",{className:$e.FLOATTEXTCONTENT});we.innerHTML=_.getElementsByClassName("e-float-text")[0].innerHTML,_.getElementsByClassName("e-float-text")[0].innerHTML="",_.getElementsByClassName("e-float-text")[0].appendChild(we)}}o.createSpanElement=ue;function Tt(_,Z){for(var we=0;we<Z.length;we++)_e(_,Z[parseInt(we.toString(),10)].container)}o.setRipple=Tt;function _e(_,Z,we){var Te=[];Te.push(we);var je=g(we)?Z.querySelectorAll(".e-input-group-icon"):Te;if(_&&je.length>0)for(var He=0;He<je.length;He++)je[parseInt(He.toString(),10)].addEventListener("mousedown",ct,!1),je[parseInt(He.toString(),10)].addEventListener("mouseup",Dt,!1);else if(je.length>0)for(var He=0;He<je.length;He++)je[parseInt(He.toString(),10)].removeEventListener("mousedown",ct,this),je[parseInt(He.toString(),10)].removeEventListener("mouseup",Dt,this)}function lt(_,Z){!_.classList.contains("e-disabled")&&!_.querySelector("input").readOnly&&Z.classList.add("e-input-btn-ripple")}function We(_){if(!_)return!1;for(var Z=_;Z&&Z!==document.body;){var we=window.getComputedStyle(Z);if(we.display==="none")return!1;Z=Z.parentElement}return!0}function ct(){for(var _=this,Z=this.parentElement;!Z.classList.contains("e-input-group");)Z=Z.parentElement;lt(Z,_)}function Dt(){var _=this;setTimeout(function(){_.classList.remove("e-input-btn-ripple")},500)}function Xt(_,Z){var we=Z("span",{className:_});return we.classList.add("e-input-group-icon"),we}function Lt(_,Z,we,Te,je){var He=typeof Z=="string"?Z.split(","):Z;if(_.toLowerCase()==="append")for(var gt=0,Lr=He;gt<Lr.length;gt++){var Ai=Lr[gt];zi(Ai,we,je)}else for(var dn=0,tn=He;dn<tn.length;dn++){var Ai=tn[dn];Bi(Ai,we,Te,je)}we.getElementsByClassName("e-input-group-icon")[0]&&we.getElementsByClassName("e-float-text-overflow")[0]&&we.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon")}o.addIcon=Lt;function Bi(_,Z,we,Te){var je=g(Te)?Xe:Te,He=Xt(_,je);Z.classList.add("e-float-icon-left");var gt=Z.querySelector(".e-input-in-wrap");if(g(gt)){gt=je("span",{className:"e-input-in-wrap"}),we.parentNode.insertBefore(gt,we);var Lr=Z.querySelectorAll(we.tagName+" ~ *");gt.appendChild(we);for(var Ai=0;Ai<Lr.length;Ai++){var dn=Lr[parseInt(Ai.toString(),10)],tn=gt.parentElement;(!dn.classList.contains("e-float-line")||!(tn&&tn.classList.contains("e-filled"))&&tn)&&gt.appendChild(dn)}}return gt.parentNode.insertBefore(He,gt),_e(!0,Z,He),He}o.prependSpan=Bi;function zi(_,Z,we){var Te=g(we)?Xe:we,je=Xt(_,Te),He=Z.classList.contains("e-float-icon-left")?Z.querySelector(".e-input-in-wrap"):Z;return He.appendChild(je),_e(!0,Z,je),je}o.appendSpan=zi;function Ct(_,Z){Z.type==="hidden"?_.classList.add("e-hidden"):_.classList.contains("e-hidden")&&_.classList.remove("e-hidden")}o.validateInputType=Ct;function Ei(_,Z){if(!g(_))for(var we=0,Te=Object.keys(_);we<Te.length;we++){var je=Te[we];HC.indexOf(je)<0&&Z.setAttribute(je,_[""+je])}}o.updateHTMLAttributesToElement=Ei;function ji(_,Z,we){H(Ur(_),[we],Ur(Z))}o.updateCssClass=ji;function Ur(_){var Z=_;return!g(_)&&_!==""&&(Z=_.replace(/\s+/g," ").trim()),Z}o.getInputValidClassList=Ur;function Fi(_,Z){if(!g(_))for(var we=0,Te=Object.keys(_);we<Te.length;we++){var je=Te[we];if(HC.indexOf(je)>-1)if(je==="class"){var He=this.getInputValidClassList(_[""+je]);He!==""&&Y([Z],He.split(" "))}else if(je==="style"){var gt=Z.getAttribute(je);gt=g(gt)?_[""+je]:gt+_[""+je],Z.setAttribute(je,gt)}else Z.setAttribute(je,_[""+je])}}o.updateHTMLAttributesToWrapper=Fi;function Tr(_){return!_||/^\s*$/.test(_)}o.isBlank=Tr})(Ce||(Ce={}));var bH=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ar=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},SH="e-control-wrapper e-numeric",NC="e-input-group-icon",FC="e-spin-up",CH="e-spin-down",KT="e-error",dc="increment",Cp="decrement",wH=new RegExp("^(-)?(\\d*)$"),xH=".",IH="e-numerictextbox",MH="e-control",ZT="e-input-focus",DH="e-numeric-hidden",JT=["title","style","class"],eL=0,ia=function(o){bH(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.preventChange=!1,r.isDynamicChange=!1,r.numericOptions=t,r}return e.prototype.preRender=function(){this.isPrevFocused=!1,this.decimalSeparator=".",this.intRegExp=new RegExp("/^(-)?(d*)$/"),this.isCalled=!1;var t=V("ej2_instances",this.element);if(this.cloneElement=this.element.cloneNode(!0),K([this.cloneElement],[MH,IH,"e-lib"]),this.angularTagName=null,this.formEle=j(this.element,"form"),this.element.tagName==="EJS-NUMERICTEXTBOX"){this.angularTagName=this.element.tagName;var i=this.createElement("input"),r=0;for(r;r<this.element.attributes.length;r++){var n=this.element.attributes[r].nodeName;n!=="id"&&n!=="class"?(i.setAttribute(this.element.attributes[r].nodeName,this.element.attributes[r].nodeValue),i.innerHTML=this.element.innerHTML):n==="class"&&i.setAttribute(n,this.element.className.split(" ").filter(function(a){return a.indexOf("ng-")!==0}).join(" "))}this.element.hasAttribute("name")&&this.element.removeAttribute("name"),this.element.classList.remove("e-control","e-numerictextbox"),this.element.appendChild(i),this.element=i,Ge("ej2_instances",t,this.element)}Ie(this.element,{role:"spinbutton",tabindex:"0",autocomplete:"off"});var s={incrementTitle:"Increment value",decrementTitle:"Decrement value",placeholder:this.placeholder};this.l10n=new Li("numerictextbox",s,this.locale),this.l10n.getConstant("placeholder")!==""&&this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),this.element.hasAttribute("id")||this.element.setAttribute("id",kt("numerictextbox")),this.isValidState=!0,this.inputStyle=null,this.inputName=null,this.cultureInfo={},this.initCultureInfo(),this.initCultureFunc(),this.prevValue=this.value,this.updateHTMLAttrToElement(),this.checkAttributes(!1),this.formEle&&(this.inputEleValue=this.value),this.validateMinMax(),this.validateStep(),this.placeholder===null&&this.updatePlaceholder()},e.prototype.render=function(){this.element.tagName.toLowerCase()==="input"&&(this.createWrapper(),this.showSpinButton&&this.spinBtnCreation(),this.setElementWidth(this.width),this.container.classList.contains("e-input-group")||this.container.classList.add("e-input-group"),this.changeValue(this.value===null||isNaN(this.value)?null:this.strictMode?this.trimValue(this.value):this.value),this.wireEvents(),this.value!==null&&!isNaN(this.value)&&this.decimals&&this.setProperties({value:this.roundNumber(this.value,this.decimals)},!0),(this.element.getAttribute("value")||this.value)&&(this.element.setAttribute("value",this.element.value),this.hiddenInput.setAttribute("value",this.hiddenInput.value)),this.elementPrevValue=this.element.value,this.element.hasAttribute("data-val")&&this.element.setAttribute("data-val","false"),!this.element.hasAttribute("aria-labelledby")&&!this.element.hasAttribute("placeholder")&&!this.element.hasAttribute("aria-label")&&this.element.setAttribute("aria-label","numerictextbox"),!g(j(this.element,"fieldset"))&&j(this.element,"fieldset").disabled&&(this.enabled=!1),this.renderComplete())},e.prototype.checkAttributes=function(t){for(var i=t?g(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["value","min","max","step","disabled","readonly","style","name","placeholder"],r=0,n=i;r<n.length;r++){var s=n[r];if(!g(this.element.getAttribute(s)))switch(s){case"disabled":if(g(this.numericOptions)||this.numericOptions.enabled===void 0||t){var a=!(this.element.getAttribute(s)==="disabled"||this.element.getAttribute(s)===""||this.element.getAttribute(s)==="true");this.setProperties({enabled:a},!t)}break;case"readonly":if(g(this.numericOptions)||this.numericOptions.readonly===void 0||t){var l=this.element.getAttribute(s)==="readonly"||this.element.getAttribute(s)===""||this.element.getAttribute(s)==="true";this.setProperties({readonly:l},!t)}break;case"placeholder":(g(this.numericOptions)||this.numericOptions.placeholder===void 0||t)&&this.setProperties({placeholder:this.element.placeholder},!t);break;case"value":if(g(this.numericOptions)||this.numericOptions.value===void 0||t){var h=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(s));this.setProperties(Ge(s,h,{}),!t)}break;case"min":if(g(this.numericOptions)||this.numericOptions.min===void 0||t){var u=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(s));u!==null&&!isNaN(u)&&this.setProperties(Ge(s,u,{}),!t)}break;case"max":if(g(this.numericOptions)||this.numericOptions.max===void 0||t){var c=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(s));c!==null&&!isNaN(c)&&this.setProperties(Ge(s,c,{}),!t)}break;case"step":if(g(this.numericOptions)||this.numericOptions.step===void 0||t){var d=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(s));d!==null&&!isNaN(d)&&this.setProperties(Ge(s,d,{}),!t)}break;case"style":this.inputStyle=this.element.getAttribute(s);break;case"name":this.inputName=this.element.getAttribute(s);break;default:{var p=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(s));(p!==null&&!isNaN(p)||s==="value")&&this.setProperties(Ge(s,p,{}),!0)}break}}},e.prototype.updatePlaceholder=function(){this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0)},e.prototype.initCultureFunc=function(){this.instance=new Et(this.locale)},e.prototype.initCultureInfo=function(){this.cultureInfo.format=this.format,V("currency",this)!==null&&(Ge("currency",this.currency,this.cultureInfo),this.setProperties({currencyCode:this.currency},!0))},e.prototype.createWrapper=function(){var t=this.cssClass;!g(this.cssClass)&&this.cssClass!==""&&(t=this.getNumericValidClassList(this.cssClass));var i=Ce.createInput({element:this.element,floatLabelType:this.floatLabelType,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:t,enableRtl:this.enableRtl,showClearButton:this.showClearButton,enabled:this.enabled}},this.createElement);this.inputWrapper=i,this.container=i.container,this.container.setAttribute("class",SH+" "+this.container.getAttribute("class")),this.updateHTMLAttrToWrapper(),this.readonly&&Ie(this.element,{"aria-readonly":"true"}),this.hiddenInput=this.createElement("input",{attrs:{type:"text",validateHidden:"true","aria-label":"hidden",class:DH}}),this.inputName=this.inputName!==null?this.inputName:this.element.id,this.element.removeAttribute("name"),this.isAngular&&this.angularTagName==="EJS-NUMERICTEXTBOX"&&this.cloneElement.id.length>0?Ie(this.hiddenInput,{name:this.cloneElement.id}):Ie(this.hiddenInput,{name:this.inputName}),this.container.insertBefore(this.hiddenInput,this.container.childNodes[1]),this.updateDataAttribute(!1),this.inputStyle!==null&&Ie(this.container,{style:this.inputStyle})},e.prototype.updateDataAttribute=function(t){var i={};if(t)i=this.htmlAttributes;else for(var r=0;r<this.element.attributes.length;r++)i[this.element.attributes[r].name]=this.element.getAttribute(this.element.attributes[r].name);for(var n=0,s=Object.keys(i);n<s.length;n++){var a=s[n];a.indexOf("data")===0&&this.hiddenInput.setAttribute(a,i[""+a])}},e.prototype.updateHTMLAttrToElement=function(){if(!g(this.htmlAttributes))for(var t=0,i=Object.keys(this.htmlAttributes);t<i.length;t++){var r=i[t];JT.indexOf(r)<0&&this.element.setAttribute(r,this.htmlAttributes[""+r])}},e.prototype.updateCssClass=function(t,i){Ce.setCssClass(this.getNumericValidClassList(t),[this.container],this.getNumericValidClassList(i))},e.prototype.getNumericValidClassList=function(t){var i=t;return!g(t)&&t!==""&&(i=t.replace(/\s+/g," ").trim()),i},e.prototype.updateHTMLAttrToWrapper=function(){if(!g(this.htmlAttributes))for(var t=0,i=Object.keys(this.htmlAttributes);t<i.length;t++){var r=i[t];if(JT.indexOf(r)>-1)if(r==="class"){var n=this.getNumericValidClassList(this.htmlAttributes[""+r]);n!==""&&Y([this.container],n.split(" "))}else if(r==="style"){var s=this.container.getAttribute(r);s=g(s)?this.htmlAttributes[""+r]:s+this.htmlAttributes[""+r],this.container.setAttribute(r,s)}else this.container.setAttribute(r,this.htmlAttributes[""+r])}},e.prototype.setElementWidth=function(t){g(t)||(typeof t=="number"?this.container.style.width=Le(t):typeof t=="string"&&(this.container.style.width=t.match(/px|%|em/)?t:Le(t)))},e.prototype.spinBtnCreation=function(){this.spinDown=Ce.appendSpan(NC+" "+CH,this.container,this.createElement),Ie(this.spinDown,{title:this.l10n.getConstant("decrementTitle")}),this.spinUp=Ce.appendSpan(NC+" "+FC,this.container,this.createElement),Ie(this.spinUp,{title:this.l10n.getConstant("incrementTitle")}),this.wireSpinBtnEvents()},e.prototype.validateMinMax=function(){typeof this.min=="number"&&!isNaN(this.min)||this.setProperties({min:-Number.MAX_VALUE},!0),typeof this.max=="number"&&!isNaN(this.max)||this.setProperties({max:Number.MAX_VALUE},!0),this.decimals!==null&&(this.min!==-Number.MAX_VALUE&&this.setProperties({min:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.min))},!0),this.max!==Number.MAX_VALUE&&this.setProperties({max:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.max))},!0)),this.setProperties({min:this.min>this.max?this.max:this.min},!0),this.min!==-Number.MAX_VALUE&&Ie(this.element,{"aria-valuemin":this.min.toString()}),this.max!==Number.MAX_VALUE&&Ie(this.element,{"aria-valuemax":this.max.toString()})},e.prototype.formattedValue=function(t,i){return this.instance.getNumberFormat({maximumFractionDigits:t,minimumFractionDigits:t,useGrouping:!1})(i)},e.prototype.validateStep=function(){this.decimals!==null&&this.setProperties({step:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.step))},!0)},e.prototype.action=function(t,i){this.isInteract=!0;var r=this.isFocused?this.instance.getNumberParser({format:"n"})(this.element.value):this.value;this.changeValue(this.performAction(r,this.step,t)),this.raiseChangeEvent(i)},e.prototype.checkErrorClass=function(){this.isValidState?K([this.container],KT):Y([this.container],KT),Ie(this.element,{"aria-invalid":this.isValidState?"false":"true"})},e.prototype.bindClearEvent=function(){this.showClearButton&&E.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this)},e.prototype.resetHandler=function(t){t.preventDefault(),(!this.inputWrapper.clearButton.classList.contains("e-clear-icon-hide")||this.inputWrapper.container.classList.contains("e-static-clear"))&&this.clear(t),this.isInteract=!0,this.raiseChangeEvent(t)},e.prototype.clear=function(t){this.setProperties({value:null},!0),this.setElementValue(""),this.hiddenInput.value="";var i=j(this.element,"form");if(i){var r=this.element.nextElementSibling,n=document.createEvent("KeyboardEvent");n.initEvent("keyup",!1,!0),r.dispatchEvent(n)}},e.prototype.resetFormHandler=function(){this.element.tagName==="EJS-NUMERICTEXTBOX"?this.updateValue(null):this.updateValue(this.inputEleValue)},e.prototype.setSpinButton=function(){g(this.spinDown)||Ie(this.spinDown,{title:this.l10n.getConstant("decrementTitle"),"aria-label":this.l10n.getConstant("decrementTitle")}),g(this.spinUp)||Ie(this.spinUp,{title:this.l10n.getConstant("incrementTitle"),"aria-label":this.l10n.getConstant("incrementTitle")})},e.prototype.wireEvents=function(){E.add(this.element,"focus",this.focusHandler,this),E.add(this.element,"blur",this.focusOutHandler,this),E.add(this.element,"keydown",this.keyDownHandler,this),E.add(this.element,"keyup",this.keyUpHandler,this),E.add(this.element,"input",this.inputHandler,this),E.add(this.element,"keypress",this.keyPressHandler,this),E.add(this.element,"change",this.changeHandler,this),E.add(this.element,"paste",this.pasteHandler,this),this.enabled&&(this.bindClearEvent(),this.formEle&&E.add(this.formEle,"reset",this.resetFormHandler,this))},e.prototype.wireSpinBtnEvents=function(){E.add(this.spinUp,B.touchStartEvent,this.mouseDownOnSpinner,this),E.add(this.spinDown,B.touchStartEvent,this.mouseDownOnSpinner,this),E.add(this.spinUp,B.touchEndEvent,this.mouseUpOnSpinner,this),E.add(this.spinDown,B.touchEndEvent,this.mouseUpOnSpinner,this),E.add(this.spinUp,B.touchMoveEvent,this.touchMoveOnSpinner,this),E.add(this.spinDown,B.touchMoveEvent,this.touchMoveOnSpinner,this)},e.prototype.unwireEvents=function(){E.remove(this.element,"focus",this.focusHandler),E.remove(this.element,"blur",this.focusOutHandler),E.remove(this.element,"keyup",this.keyUpHandler),E.remove(this.element,"input",this.inputHandler),E.remove(this.element,"keydown",this.keyDownHandler),E.remove(this.element,"keypress",this.keyPressHandler),E.remove(this.element,"change",this.changeHandler),E.remove(this.element,"paste",this.pasteHandler),this.formEle&&E.remove(this.formEle,"reset",this.resetFormHandler)},e.prototype.unwireSpinBtnEvents=function(){E.remove(this.spinUp,B.touchStartEvent,this.mouseDownOnSpinner),E.remove(this.spinDown,B.touchStartEvent,this.mouseDownOnSpinner),E.remove(this.spinUp,B.touchEndEvent,this.mouseUpOnSpinner),E.remove(this.spinDown,B.touchEndEvent,this.mouseUpOnSpinner),E.remove(this.spinUp,B.touchMoveEvent,this.touchMoveOnSpinner),E.remove(this.spinDown,B.touchMoveEvent,this.touchMoveOnSpinner)},e.prototype.changeHandler=function(t){t.stopPropagation(),this.element.value.length||this.setProperties({value:null},!0);var i=this.instance.getNumberParser({format:"n"})(this.element.value);this.updateValue(i,t)},e.prototype.raiseChangeEvent=function(t){if(this.inputValue=g(this.inputValue)||isNaN(this.inputValue)?null:this.inputValue,this.prevValue!==this.value||this.prevValue!==this.inputValue){var i={};this.changeEventArgs={value:this.value,previousValue:this.prevValue,isInteracted:this.isInteract,isInteraction:this.isInteract,event:t},t&&(this.changeEventArgs.event=t),this.changeEventArgs.event===void 0&&(this.changeEventArgs.isInteracted=!1,this.changeEventArgs.isInteraction=!1),ht(i,this.changeEventArgs),this.prevValue=this.value,this.isInteract=!1,this.elementPrevValue=this.element.value,this.preventChange=!1,this.trigger("change",i)}},e.prototype.pasteHandler=function(){var t=this;if(!(!this.enabled||this.readonly)){var i=this.element.value;setTimeout(function(){t.numericRegex().test(t.element.value)||t.setElementValue(i)})}},e.prototype.preventHandler=function(){var t=this,i=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);setTimeout(function(){if(t.element.selectionStart>0){var r=t.element.selectionStart,n=t.element.selectionStart-1,s=0,a=t.element.value.split(""),l=Yi(t.locale),h=V("decimal",l),u=h.charCodeAt(0);t.element.value[n]===" "&&t.element.selectionStart>0&&!i?(g(t.prevVal)?t.element.value=t.element.value.trim():n!==0?t.element.value=t.prevVal:n===0&&(t.element.value=t.element.value.trim()),t.element.setSelectionRange(n,n)):isNaN(parseFloat(t.element.value[t.element.selectionStart-1]))&&t.element.value[t.element.selectionStart-1].charCodeAt(0)!==45?(a.indexOf(t.element.value[t.element.selectionStart-1])!==a.lastIndexOf(t.element.value[t.element.selectionStart-1])&&t.element.value[t.element.selectionStart-1].charCodeAt(0)===u||t.element.value[t.element.selectionStart-1].charCodeAt(0)!==u)&&(t.element.value=t.element.value.substring(0,n)+t.element.value.substring(r,t.element.value.length),t.element.setSelectionRange(n,n),isNaN(parseFloat(t.element.value[t.element.selectionStart-1]))&&t.element.selectionStart>0&&t.element.value.length&&t.preventHandler()):isNaN(parseFloat(t.element.value[t.element.selectionStart-2]))&&t.element.selectionStart>1&&t.element.value[t.element.selectionStart-2].charCodeAt(0)!==45&&(a.indexOf(t.element.value[t.element.selectionStart-2])!==a.lastIndexOf(t.element.value[t.element.selectionStart-2])&&t.element.value[t.element.selectionStart-2].charCodeAt(0)===u||t.element.value[t.element.selectionStart-2].charCodeAt(0)!==u)&&(t.element.setSelectionRange(n,n),t.nextEle=t.element.value[t.element.selectionStart],t.cursorPosChanged=!0,t.preventHandler()),t.cursorPosChanged===!0&&t.element.value[t.element.selectionStart]===t.nextEle&&isNaN(parseFloat(t.element.value[t.element.selectionStart-1]))&&(t.element.setSelectionRange(t.element.selectionStart+1,t.element.selectionStart+1),t.cursorPosChanged=!1,t.nextEle=null),t.element.value.trim()===""&&t.element.setSelectionRange(s,s),t.element.selectionStart>0&&(t.element.value[t.element.selectionStart-1].charCodeAt(0)===45&&t.element.selectionStart>1&&(g(t.prevVal)||(t.element.value=t.prevVal),t.element.setSelectionRange(t.element.selectionStart,t.element.selectionStart)),t.element.value[t.element.selectionStart-1]===h&&t.decimals===0&&t.validateDecimalOnType&&(t.element.value=t.element.value.substring(0,n)+t.element.value.substring(r,t.element.value.length))),t.prevVal=t.element.value}})},e.prototype.keyUpHandler=function(){if(!(!this.enabled||this.readonly)){var t=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);!t&&B.isDevice&&this.preventHandler();var i=this.instance.getNumberParser({format:"n"})(this.element.value);i=i===null||isNaN(i)?null:i,this.hiddenInput.value=i||i===0?i.toString():null;var r=j(this.element,"form");if(r){var n=this.element.nextElementSibling,s=document.createEvent("KeyboardEvent");s.initEvent("keyup",!1,!0),n.dispatchEvent(s)}}},e.prototype.inputHandler=function(t){var i=this;if(!(!this.enabled||this.readonly)){var r=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform),n=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;if((n||r)&&B.isDevice&&this.preventHandler(),this.isAngular&&this.element.value!==V("decimal",Yi(this.locale))&&this.element.value!==V("minusSign",Yi(this.locale))){var s=this.instance.getNumberParser({format:"n"})(this.element.value);s=isNaN(s)?null:s,i.localChange({value:s}),this.preventChange=!0}if(this.isVue){var a=this.instance.getNumberParser({format:"n"})(this.element.value),l=this.instance.getNumberParser({format:"n"})(this.elementPrevValue),h=new RegExp("[^0-9]+$");(h.test(this.element.value)||(this.elementPrevValue.indexOf(".")!==-1||this.elementPrevValue.indexOf("-")!==-1)&&this.element.value[this.element.value.length-1]==="0")&&(a=this.value);var u={event:t,value:a===null||isNaN(a)?null:a,previousValue:l===null||isNaN(l)?null:l};this.preventChange=!0,this.elementPrevValue=this.element.value,this.trigger("input",u)}}},e.prototype.keyDownHandler=function(t){if(!this.readonly)switch(t.keyCode){case 38:t.preventDefault(),this.action(dc,t);break;case 40:t.preventDefault(),this.action(Cp,t);break}},e.prototype.performAction=function(t,i,r){(t===null||isNaN(t))&&(t=0);var n=r===dc?t+i:t-i;return n=this.correctRounding(t,i,n),this.strictMode?this.trimValue(n):n},e.prototype.correctRounding=function(t,i,r){var n=new RegExp("[,.](.*)"),s=n.test(t.toString()),a=n.test(i.toString());if(s||a){var l=s?n.exec(t.toString())[0].length:0,h=a?n.exec(i.toString())[0].length:0,u=Math.max(l,h);return t=this.roundValue(r,u)}return r},e.prototype.roundValue=function(t,i){i=i||0;var r=Math.pow(10,i);return t*=r,t=Math.round(t)/r},e.prototype.updateValue=function(t,i){i&&(this.isInteract=!0),t!==null&&!isNaN(t)&&this.decimals&&(t=this.roundNumber(t,this.decimals)),this.inputValue=t,this.changeValue(t===null||isNaN(t)?null:this.strictMode?this.trimValue(t):t),this.isDynamicChange||this.raiseChangeEvent(i)},e.prototype.updateCurrency=function(t,i){Ge(t,i,this.cultureInfo),this.updateValue(this.value)},e.prototype.changeValue=function(t){if(!(t||t===0))t=null,this.setProperties({value:t},!0);else{var i=this.getNumberOfDecimals(t);this.setProperties({value:this.roundNumber(t,i)},!0)}this.modifyText(),this.strictMode||this.validateState()},e.prototype.modifyText=function(){if(this.value||this.value===0){var t=this.formatNumber(),i=this.isFocused?t:this.instance.getNumberFormat(this.cultureInfo)(this.value);this.setElementValue(i),Ie(this.element,{"aria-valuenow":t}),g(this.hiddenInput)||(this.hiddenInput.value=this.value.toString(),this.value!==null&&this.serverDecimalSeparator&&(this.hiddenInput.value=this.hiddenInput.value.replace(".",this.serverDecimalSeparator)))}else this.setElementValue(""),this.element.removeAttribute("aria-valuenow"),this.hiddenInput.value=null},e.prototype.setElementValue=function(t,i){Ce.setValue(t,i||this.element,this.floatLabelType,this.showClearButton)},e.prototype.validateState=function(){this.isValidState=!0,(this.value||this.value===0)&&(this.isValidState=!(this.value>this.max||this.value<this.min)),this.checkErrorClass()},e.prototype.getNumberOfDecimals=function(t){var i,r=new RegExp("[eE][-+]?([0-9]+)"),n=t.toString();if(r.test(n)){var s=r.exec(n);g(s)||(n=t.toFixed(Math.min(parseInt(s[1],10),20)))}var a=n.split(".")[1];return i=!a||!a.length?0:a.length,this.decimals!==null&&(i=i<this.decimals?i:this.decimals),i},e.prototype.formatNumber=function(){var t=this.getNumberOfDecimals(this.value);return this.instance.getNumberFormat({maximumFractionDigits:t,minimumFractionDigits:t,useGrouping:!1})(this.value)},e.prototype.trimValue=function(t){return t>this.max?this.max:t<this.min?this.min:t},e.prototype.roundNumber=function(t,i){var r=t,n=i||0,s=r.toString().split("e");r=Math.round(+(s[0]+"e"+(s[1]?Number(s[1])+n:n)));var a=r.toString().split("e");return r=+(a[0]+"e"+(a[1]?Number(a[1])-n:-n)),Number(r.toFixed(n))},e.prototype.cancelEvent=function(t){return t.preventDefault(),!1},e.prototype.keyPressHandler=function(t){if(!this.enabled||this.readonly)return!0;if(!B.isDevice&&B.info.version==="11.0"&&t.keyCode===13){var i=this.instance.getNumberParser({format:"n"})(this.element.value);return this.updateValue(i,t),!0}if(t.which===0||t.metaKey||t.ctrlKey||t.keyCode===8||t.keyCode===13)return!0;var r=String.fromCharCode(t.which),n=V("decimal",Yi(this.locale)),s=t.code==="NumpadDecimal"&&r!==n;s&&(r=n);var a=this.element.value;if(a=a.substring(0,this.element.selectionStart)+r+a.substring(this.element.selectionEnd),this.numericRegex().test(a)){if(s){var l=this.element.selectionStart+1;this.element.value=a,this.element.setSelectionRange(l,l),t.preventDefault(),t.stopPropagation()}return!0}else return t.preventDefault(),t.stopPropagation(),!1},e.prototype.numericRegex=function(){var t=Yi(this.locale),i=V("decimal",t),r="*";return i===xH&&(i="\\"+i),this.decimals===0&&this.validateDecimalOnType?wH:(this.decimals&&this.validateDecimalOnType&&(r="{0,"+this.decimals+"}"),new RegExp("^\\s*(-)?(((\\d+("+i+"\\d"+r+")?)|("+i+"\\d"+r+")))?$"))},e.prototype.mouseWheel=function(t){t.preventDefault();var i,r=t;r.wheelDelta?i=r.wheelDelta/120:r.detail&&(i=-r.detail/3),i>0?this.action(dc,t):i<0&&this.action(Cp,t),this.cancelEvent(t)},e.prototype.focusHandler=function(t){var i=this;if(clearTimeout(eL),this.focusEventArgs={event:t,value:this.value,container:this.container},this.trigger("focus",this.focusEventArgs),!(!this.enabled||this.readonly)){if(this.isFocused=!0,this.prevValue=this.value,this.value||this.value===0){var r=this.formatNumber();if(this.setElementValue(r),!this.isPrevFocused)if(!B.isDevice&&B.info.version==="11.0")this.element.setSelectionRange(0,r.length);else{var n=B.isDevice&&B.isIos?600:0;eL=setTimeout(function(){i.element.setSelectionRange(0,r.length)},n)}}B.isDevice||E.add(this.element,"mousewheel DOMMouseScroll",this.mouseWheel,this)}},e.prototype.focusOutHandler=function(t){var i=this;if(this.blurEventArgs={event:t,value:this.value,container:this.container},this.trigger("blur",this.blurEventArgs),!(!this.enabled||this.readonly)){if(this.isPrevFocused){if(t.preventDefault(),B.isDevice){var r=this.element.value;this.element.focus(),this.isPrevFocused=!1;var n=this.element;setTimeout(function(){i.setElementValue(r,n)},200)}}else{this.isFocused=!1,this.element.value.length||this.setProperties({value:null},!0);var s=this.instance.getNumberParser({format:"n"})(this.element.value);this.updateValue(s),B.isDevice||E.remove(this.element,"mousewheel DOMMouseScroll",this.mouseWheel)}var a=j(this.element,"form");if(a){var l=this.element.nextElementSibling,h=document.createEvent("FocusEvent");h.initEvent("focusout",!1,!0),l.dispatchEvent(h)}}},e.prototype.mouseDownOnSpinner=function(t){var i=this;if(this.isFocused&&(this.isPrevFocused=!0,t.preventDefault()),!!this.getElementData(t)){this.getElementData(t);var r=t.currentTarget,n=r.classList.contains(FC)?dc:Cp;E.add(r,"mouseleave",this.mouseUpClick,this),this.timeOut=setInterval(function(){i.isCalled=!0,i.action(n,t)},150),E.add(document,"mouseup",this.mouseUpClick,this)}},e.prototype.touchMoveOnSpinner=function(t){var i;if(t.type==="touchmove"){var r=t.touches;i=r.length&&document.elementFromPoint(r[0].pageX,r[0].pageY)}else i=document.elementFromPoint(t.clientX,t.clientY);i.classList.contains(NC)||clearInterval(this.timeOut)},e.prototype.mouseUpOnSpinner=function(t){if(this.prevValue=this.value,this.isPrevFocused&&(this.element.focus(),B.isDevice||(this.isPrevFocused=!1)),B.isDevice||t.preventDefault(),!!this.getElementData(t)){var i=t.currentTarget,r=i.classList.contains(FC)?dc:Cp;E.remove(i,"mouseleave",this.mouseUpClick),this.isCalled||this.action(r,t),this.isCalled=!1,E.remove(document,"mouseup",this.mouseUpClick);var n=j(this.element,"form");if(n){var s=this.element.nextElementSibling,a=document.createEvent("KeyboardEvent");a.initEvent("keyup",!1,!0),s.dispatchEvent(a)}}},e.prototype.getElementData=function(t){return t.which&&t.which===3||t.button&&t.button===2||!this.enabled||this.readonly?!1:(clearInterval(this.timeOut),!0)},e.prototype.floatLabelTypeUpdate=function(){Ce.removeFloating(this.inputWrapper);var t=this.hiddenInput;this.hiddenInput.remove(),Ce.addFloating(this.element,this.floatLabelType,this.placeholder,this.createElement),this.container.insertBefore(t,this.container.childNodes[1])},e.prototype.mouseUpClick=function(t){t.stopPropagation(),clearInterval(this.timeOut),this.isCalled=!1,this.spinUp&&E.remove(this.spinUp,"mouseleave",this.mouseUpClick),this.spinDown&&E.remove(this.spinDown,"mouseleave",this.mouseUpClick)},e.prototype.increment=function(t){t===void 0&&(t=this.step),this.isInteract=!1,this.changeValue(this.performAction(this.value,t,dc)),this.raiseChangeEvent()},e.prototype.decrement=function(t){t===void 0&&(t=this.step),this.isInteract=!1,this.changeValue(this.performAction(this.value,t,Cp)),this.raiseChangeEvent()},e.prototype.destroy=function(){this.unwireEvents(),this.showClearButton&&(this.clearButton=document.getElementsByClassName("e-clear-icon")[0]),ee(this.hiddenInput),this.showSpinButton&&(this.unwireSpinBtnEvents(),ee(this.spinUp),ee(this.spinDown));for(var t=["aria-labelledby","role","autocomplete","aria-readonly","aria-disabled","autocapitalize","spellcheck","aria-autocomplete","tabindex","aria-valuemin","aria-valuemax","aria-valuenow","aria-invalid"],i=0;i<t.length;i++)this.element.removeAttribute(t[i]);this.element.classList.remove("e-input"),this.container.insertAdjacentElement("afterend",this.element),ee(this.container),this.spinUp=null,this.spinDown=null,this.container=null,this.hiddenInput=null,this.changeEventArgs=null,this.blurEventArgs=null,this.focusEventArgs=null,this.inputWrapper=null,Ce.destroy({element:this.element,floatLabelType:this.floatLabelType,properties:this.properties},this.clearButton),o.prototype.destroy.call(this)},e.prototype.getText=function(){return this.element.value},e.prototype.focusIn=function(){document.activeElement!==this.element&&this.enabled&&(this.element.focus(),Y([this.container],[ZT]))},e.prototype.focusOut=function(){document.activeElement===this.element&&this.enabled&&(this.element.blur(),K([this.container],[ZT]))},e.prototype.getPersistData=function(){var t=["value"];return this.addOnPersist(t)},e.prototype.onPropertyChanged=function(t,i){for(var r=0,n=Object.keys(t);r<n.length;r++){var s=n[r];switch(s){case"width":this.setElementWidth(t.width),Ce.calculateWidth(this.element,this.container);break;case"cssClass":this.updateCssClass(t.cssClass,i.cssClass);break;case"enabled":Ce.setEnabled(t.enabled,this.element),this.bindClearEvent();break;case"enableRtl":Ce.setEnableRtl(t.enableRtl,[this.container]);break;case"readonly":Ce.setReadonly(t.readonly,this.element),this.readonly?Ie(this.element,{"aria-readonly":"true"}):this.element.removeAttribute("aria-readonly");break;case"htmlAttributes":this.updateHTMLAttrToElement(),this.updateHTMLAttrToWrapper(),this.updateDataAttribute(!0),this.checkAttributes(!0),Ce.validateInputType(this.container,this.element);break;case"placeholder":Ce.setPlaceholder(t.placeholder,this.element),Ce.calculateWidth(this.element,this.container);break;case"step":this.step=t.step,this.validateStep();break;case"showSpinButton":this.updateSpinButton(t);break;case"showClearButton":this.updateClearButton(t);break;case"floatLabelType":this.floatLabelType=t.floatLabelType,this.floatLabelTypeUpdate();break;case"value":this.isDynamicChange=(this.isAngular||this.isVue)&&this.preventChange,this.updateValue(t.value),this.isDynamicChange&&(this.preventChange=!1,this.isDynamicChange=!1);break;case"min":case"max":Ge(s,V(s,t),this),this.validateMinMax(),this.updateValue(this.value);break;case"strictMode":this.strictMode=t.strictMode,this.updateValue(this.value),this.validateState();break;case"locale":this.initCultureFunc(),this.l10n.setLocale(this.locale),this.setSpinButton(),this.updatePlaceholder(),Ce.setPlaceholder(this.placeholder,this.element),this.updateValue(this.value);break;case"currency":{var a=V(s,t);this.setProperties({currencyCode:a},!0),this.updateCurrency(s,a)}break;case"currencyCode":{var l=V(s,t);this.setProperties({currency:l},!0),this.updateCurrency("currency",l)}break;case"format":Ge(s,V(s,t),this),this.initCultureInfo(),this.updateValue(this.value);break;case"decimals":this.decimals=t.decimals,this.updateValue(this.value)}}},e.prototype.updateClearButton=function(t){Ce.setClearButton(t.showClearButton,this.element,this.inputWrapper,void 0,this.createElement),this.bindClearEvent()},e.prototype.updateSpinButton=function(t){t.showSpinButton?this.spinBtnCreation():(ee(this.spinUp),ee(this.spinDown))},e.prototype.getModuleName=function(){return"numerictextbox"},ar([C("")],e.prototype,"cssClass",void 0),ar([C(null)],e.prototype,"value",void 0),ar([C(-Number.MAX_VALUE)],e.prototype,"min",void 0),ar([C(Number.MAX_VALUE)],e.prototype,"max",void 0),ar([C(1)],e.prototype,"step",void 0),ar([C(null)],e.prototype,"width",void 0),ar([C(null)],e.prototype,"placeholder",void 0),ar([C({})],e.prototype,"htmlAttributes",void 0),ar([C(!0)],e.prototype,"showSpinButton",void 0),ar([C(!1)],e.prototype,"readonly",void 0),ar([C(!0)],e.prototype,"enabled",void 0),ar([C(!1)],e.prototype,"showClearButton",void 0),ar([C(!1)],e.prototype,"enablePersistence",void 0),ar([C("n2")],e.prototype,"format",void 0),ar([C(null)],e.prototype,"decimals",void 0),ar([C(null)],e.prototype,"currency",void 0),ar([C(null)],e.prototype,"currencyCode",void 0),ar([C(!0)],e.prototype,"strictMode",void 0),ar([C(!1)],e.prototype,"validateDecimalOnType",void 0),ar([C("Never")],e.prototype,"floatLabelType",void 0),ar([q()],e.prototype,"created",void 0),ar([q()],e.prototype,"destroyed",void 0),ar([q()],e.prototype,"change",void 0),ar([q()],e.prototype,"focus",void 0),ar([q()],e.prototype,"blur",void 0),e=ar([bt],e),e}(Kt);var Ep=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),zt=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},EH=function(o){Ep(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return zt([C("None")],e.prototype,"placement",void 0),zt([C(10)],e.prototype,"largeStep",void 0),zt([C(1)],e.prototype,"smallStep",void 0),zt([C(!1)],e.prototype,"showSmallTicks",void 0),zt([C(null)],e.prototype,"format",void 0),e}(Re),AH=function(o){Ep(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return zt([C(null)],e.prototype,"color",void 0),zt([C(null)],e.prototype,"start",void 0),zt([C(null)],e.prototype,"end",void 0),e}(Re),TH=function(o){Ep(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return zt([C(!1)],e.prototype,"enabled",void 0),zt([C(null)],e.prototype,"minStart",void 0),zt([C(null)],e.prototype,"minEnd",void 0),zt([C(null)],e.prototype,"maxStart",void 0),zt([C(null)],e.prototype,"maxEnd",void 0),zt([C(!1)],e.prototype,"startHandleFixed",void 0),zt([C(!1)],e.prototype,"endHandleFixed",void 0),e}(Re),LH=function(o){Ep(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return zt([C("")],e.prototype,"cssClass",void 0),zt([C("Before")],e.prototype,"placement",void 0),zt([C("Focus")],e.prototype,"showOn",void 0),zt([C(!1)],e.prototype,"isVisible",void 0),zt([C(null)],e.prototype,"format",void 0),e}(Re),kH=6,NH=3,me={root:"e-slider",rtl:"e-rtl",sliderHiddenInput:"e-slider-input",controlWrapper:"e-control-wrapper",sliderHandle:"e-handle",rangeBar:"e-range",sliderButton:"e-slider-button",firstButton:"e-first-button",secondButton:"e-second-button",scale:"e-scale",tick:"e-tick",large:"e-large",tickValue:"e-tick-value",sliderTooltip:"e-slider-tooltip",sliderHover:"e-slider-hover",sliderFirstHandle:"e-handle-first",sliderSecondHandle:"e-handle-second",sliderDisabled:"e-disabled",sliderContainer:"e-slider-container",horizontalTooltipBefore:"e-slider-horizontal-before",horizontalTooltipAfter:"e-slider-horizontal-after",verticalTooltipBefore:"e-slider-vertical-before",verticalTooltipAfter:"e-slider-vertical-after",materialTooltip:"e-material-tooltip",materialTooltipOpen:"e-material-tooltip-open",materialTooltipActive:"e-tooltip-active",materialSlider:"e-material-slider",sliderTrack:"e-slider-track",sliderHorizantalColor:"e-slider-horizantal-color",sliderVerticalColor:"e-slider-vertical-color",sliderHandleFocused:"e-handle-focused",verticalSlider:"e-vertical",horizontalSlider:"e-horizontal",sliderHandleStart:"e-handle-start",sliderTooltipStart:"e-material-tooltip-start",sliderTabHandle:"e-tab-handle",sliderButtonIcon:"e-button-icon",sliderSmallSize:"e-small-size",sliderTickPosition:"e-tick-pos",sliderFirstTick:"e-first-tick",sliderLastTick:"e-last-tick",sliderButtonClass:"e-slider-btn",sliderTooltipWrapper:"e-tooltip-wrap",sliderTabTrack:"e-tab-track",sliderTabRange:"e-tab-range",sliderActiveHandle:"e-handle-active",sliderMaterialHandle:"e-material-handle",sliderMaterialRange:"e-material-range",sliderMaterialDefault:"e-material-default",materialTooltipShow:"e-material-tooltip-show",materialTooltipHide:"e-material-tooltip-hide",readonly:"e-read-only",limits:"e-limits",limitBarDefault:"e-limit-bar",limitBarFirst:"e-limit-first",limitBarSecond:"e-limit-second",dragHorizontal:"e-drag-horizontal",dragVertical:"e-drag-vertical"},tL=function(o){Ep(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.horDir="left",r.verDir="bottom",r.transition={handle:"left .4s cubic-bezier(.25, .8, .25, 1), right .4s cubic-bezier(.25, .8, .25, 1), top .4s cubic-bezier(.25, .8, .25, 1) , bottom .4s cubic-bezier(.25, .8, .25, 1)",rangeBar:"all .4s cubic-bezier(.25, .8, .25, 1)"},r.transitionOnMaterialTooltip={handle:"left 1ms ease-out, right 1ms ease-out, bottom 1ms ease-out, top 1ms ease-out",rangeBar:"left 1ms ease-out, right 1ms ease-out, bottom 1ms ease-out, width 1ms ease-out, height 1ms ease-out"},r.scaleTransform="transform .4s cubic-bezier(.25, .8, .25, 1)",r.customAriaText=null,r.drag=!0,r.isDragComplete=!1,r.initialTooltip=!0,r}return e.prototype.preRender=function(){var t={incrementTitle:"Increase",decrementTitle:"Decrease"};this.l10n=new Li("slider",t,this.locale),this.isElementFocused=!1,this.tickElementCollection=[],this.tooltipFormatInfo={},this.ticksFormatInfo={},this.initCultureInfo(),this.initCultureFunc(),this.formChecker()},e.prototype.formChecker=function(){var t=j(this.element,"form");t?(this.isForm=!0,g(this.formResetValue)||this.setProperties({value:this.formResetValue},!0),this.formResetValue=this.value,this.type==="Range"&&(g(this.formResetValue)||typeof this.formResetValue!="object")?this.formResetValue=[parseFloat(Le(this.min)),parseFloat(Le(this.max))]:g(this.formResetValue)&&(this.formResetValue=parseFloat(Le(this.min))),this.formElement=t):this.isForm=!1},e.prototype.initCultureFunc=function(){this.internationalization=new Et(this.locale)},e.prototype.initCultureInfo=function(){this.tooltipFormatInfo.format=g(this.tooltip.format)?null:this.tooltip.format,this.ticksFormatInfo.format=g(this.ticks.format)?null:this.ticks.format},e.prototype.formatString=function(t,i){var r=null,n=null;if(t||t===0){r=this.formatNumber(t);var s=this.numberOfDecimals(t);n=this.internationalization.getNumberFormat(i)(this.makeRoundNumber(t,s))}return{elementVal:r,formatString:n}},e.prototype.formatNumber=function(t){var i=this.numberOfDecimals(t);return this.internationalization.getNumberFormat({maximumFractionDigits:i,minimumFractionDigits:i,useGrouping:!1})(t)},e.prototype.numberOfDecimals=function(t){var i=t.toString().split(".")[1],r=!i||!i.length?0:i.length;return r},e.prototype.makeRoundNumber=function(t,i){var r=i||0;return Number(t.toFixed(r))},e.prototype.fractionalToInteger=function(t){t=this.numberOfDecimals(t)===0?Number(t).toFixed(this.noOfDecimals):t;for(var i=1,r=0;r<this.noOfDecimals;r++)i*=10;return t=Number((t*i).toFixed(0)),t},e.prototype.render=function(){var t=this;this.initialize(),this.initRender(),this.wireEvents(),this.setZindex(),this.renderComplete(),this.element.tagName==="EJS-SLIDER"&&this.getTheme(this.sliderContainer)==="none"&&setTimeout(function(){t.refresh()},0)},e.prototype.initialize=function(){Y([this.element],me.root),this.setCSSClass()},e.prototype.setElementWidth=function(t){!g(t)&&!g(this.sliderContainer)&&(typeof t=="number"?this.sliderContainer.style.width=Le(t):typeof t=="string"&&(this.sliderContainer.style.width=t.match(/px|%|em/)?t:Le(t)))},e.prototype.setCSSClass=function(t){t&&K([this.element],t.split(" ")),this.cssClass&&Y([this.element],this.cssClass.split(" "))},e.prototype.setEnabled=function(){this.enabled?(K([this.sliderContainer],[me.sliderDisabled]),this.tooltip.isVisible&&this.tooltipElement&&this.tooltip.showOn==="Always"&&this.tooltipElement.classList.remove(me.sliderDisabled),this.wireEvents()):(Y([this.sliderContainer],[me.sliderDisabled]),this.tooltip.isVisible&&this.tooltipElement&&this.tooltip.showOn==="Always"&&this.tooltipElement.classList.add(me.sliderDisabled),this.unwireEvents())},e.prototype.getTheme=function(t){var i=window.getComputedStyle(t,":after").getPropertyValue("content");return i.replace(/['"]+/g,"")},e.prototype.initRender=function(){this.sliderContainer=this.createElement("div",{className:me.sliderContainer+" "+me.controlWrapper}),this.element.parentNode.insertBefore(this.sliderContainer,this.element),this.sliderContainer.appendChild(this.element),this.sliderTrack=this.createElement("div",{className:me.sliderTrack}),this.element.appendChild(this.sliderTrack),this.setElementWidth(this.width),this.element.tabIndex=-1,this.getThemeInitialization(),this.setHandler(),this.createRangeBar(),this.limits.enabled&&this.createLimitBar(),this.setOrientClass(),this.hiddenInput=this.createElement("input",{attrs:{type:"hidden",value:g(this.value)?g(this.min)?"0":this.min.toString():this.value.toString(),name:this.element.getAttribute("name")||this.element.getAttribute("id")||"_"+(Math.random()*1e3).toFixed(0)+"slider",class:me.sliderHiddenInput}}),this.hiddenInput.tabIndex=-1,this.sliderContainer.appendChild(this.hiddenInput),this.showButtons&&this.setButtons(),this.setEnableRTL(),this.type==="Range"?this.rangeValueUpdate():this.value=g(this.value)?g(this.min)?0:parseFloat(Le(this.min.toString())):this.value,this.previousVal=this.type!=="Range"?this.checkHandleValue(parseFloat(Le(this.value.toString()))):[this.checkHandleValue(parseFloat(Le(this.value[0].toString()))),this.checkHandleValue(parseFloat(Le(this.value[1].toString())))],this.previousChanged=this.previousVal,g(this.element.hasAttribute("name"))||this.element.removeAttribute("name"),this.setValue(),this.limits.enabled&&this.setLimitBar(),this.ticks.placement!=="None"&&this.renderScale(),this.tooltip.isVisible&&this.renderTooltip(),this.enabled?K([this.sliderContainer],[me.sliderDisabled]):Y([this.sliderContainer],[me.sliderDisabled]),this.readonly?Y([this.sliderContainer],[me.readonly]):K([this.sliderContainer],[me.readonly])},e.prototype.getThemeInitialization=function(){this.isMaterial=this.getTheme(this.sliderContainer)==="material"||this.getTheme(this.sliderContainer)==="material-dark",this.isMaterial3=this.getTheme(this.sliderContainer)==="Material3"||this.getTheme(this.sliderContainer)==="Material3-dark",this.isBootstrap=this.getTheme(this.sliderContainer)==="bootstrap"||this.getTheme(this.sliderContainer)==="bootstrap-dark",this.isBootstrap4=this.getTheme(this.sliderContainer)==="bootstrap4",this.isTailwind=this.getTheme(this.sliderContainer)==="tailwind"||this.getTheme(this.sliderContainer)==="tailwind-dark",this.isTailwind3=this.getTheme(this.sliderContainer)==="tailwind3"||this.getTheme(this.sliderContainer)==="tailwind3-dark",this.isBootstrap5=this.getTheme(this.sliderContainer)==="bootstrap5",this.isFluent=this.getTheme(this.sliderContainer)==="FluentUI",this.isFluent2=this.getTheme(this.sliderContainer)==="fluent2",this.isBootstrap5Dot3=this.getTheme(this.sliderContainer)==="bootstrap5.3",this.isMaterialTooltip=(this.isMaterial||this.isMaterial3)&&this.type!=="Range"&&this.tooltip.isVisible},e.prototype.createRangeBar=function(){this.type!=="Default"&&(this.rangeBar=this.createElement("div",{attrs:{class:me.rangeBar}}),this.element.appendChild(this.rangeBar),this.drag&&this.type==="Range"&&(this.orientation==="Horizontal"?this.rangeBar.classList.add(me.dragHorizontal):this.rangeBar.classList.add(me.dragVertical)))},e.prototype.createLimitBar=function(){var t=this.type!=="Range"?me.limitBarDefault:me.limitBarFirst;t+=" "+me.limits,this.limitBarFirst=this.createElement("div",{attrs:{class:t}}),this.element.appendChild(this.limitBarFirst),this.type==="Range"&&(this.limitBarSecond=this.createElement("div",{attrs:{class:me.limitBarSecond+" "+me.limits}}),this.element.appendChild(this.limitBarSecond))},e.prototype.setOrientClass=function(){this.orientation!=="Vertical"?(this.sliderContainer.classList.remove(me.verticalSlider),this.sliderContainer.classList.add(me.horizontalSlider),this.firstHandle.setAttribute("aria-orientation","horizontal"),this.type==="Range"&&this.secondHandle.setAttribute("aria-orientation","horizontal")):(this.sliderContainer.classList.remove(me.horizontalSlider),this.sliderContainer.classList.add(me.verticalSlider),this.firstHandle.setAttribute("aria-orientation","vertical"),this.type==="Range"&&this.secondHandle.setAttribute("aria-orientation","vertical"))},e.prototype.setAriaAttributes=function(t){var i=this,r=this.min,n=this.max;if(!g(this.customValues)&&this.customValues.length>0&&(r=this.customValues[0],n=this.customValues[this.customValues.length-1]),this.type!=="Range")Ie(t,{"aria-valuemin":g(r)?"0":r.toString(),"aria-valuemax":g(n)?"100":n.toString()});else{var s=!g(this.customValues)&&this.customValues.length>0?[[r.toString(),this.customValues[this.value[1]].toString()],[this.customValues[this.value[0]].toString(),n.toString()]]:[[r.toString(),this.value[1].toString()],[this.value[0].toString(),n.toString()]];s.forEach(function(a,l){var h=l===0?i.firstHandle:i.secondHandle;h&&Ie(h,{"aria-valuemin":a[0],"aria-valuemax":a[1]})})}},e.prototype.createSecondHandle=function(){this.secondHandle=this.createElement("div",{attrs:{class:me.sliderHandle,role:"slider",tabIndex:"0","aria-label":"slider"}}),this.secondHandle.classList.add(me.sliderSecondHandle),this.element.appendChild(this.secondHandle)},e.prototype.createFirstHandle=function(){this.firstHandle=this.createElement("div",{attrs:{class:me.sliderHandle,role:"slider",tabIndex:"0","aria-label":"slider"}}),this.firstHandle.classList.add(me.sliderFirstHandle),this.element.appendChild(this.firstHandle),this.isMaterialTooltip&&(this.materialHandle=this.createElement("div",{attrs:{class:me.sliderHandle+" "+me.sliderMaterialHandle}}),this.element.appendChild(this.materialHandle))},e.prototype.wireFirstHandleEvt=function(t){t?(E.remove(this.firstHandle,"mousedown touchstart",this.handleFocus),E.remove(this.firstHandle,"transitionend",this.transitionEnd),E.remove(this.firstHandle,"mouseenter touchenter",this.handleOver),E.remove(this.firstHandle,"mouseleave touchend",this.handleLeave)):(E.add(this.firstHandle,"mousedown touchstart",this.handleFocus,this),E.add(this.firstHandle,"transitionend",this.transitionEnd,this),E.add(this.firstHandle,"mouseenter touchenter",this.handleOver,this),E.add(this.firstHandle,"mouseleave touchend",this.handleLeave,this))},e.prototype.wireSecondHandleEvt=function(t){t?(E.remove(this.secondHandle,"mousedown touchstart",this.handleFocus),E.remove(this.secondHandle,"transitionend",this.transitionEnd),E.remove(this.secondHandle,"mouseenter touchenter",this.handleOver),E.remove(this.secondHandle,"mouseleave touchend",this.handleLeave)):(E.add(this.secondHandle,"mousedown touchstart",this.handleFocus,this),E.add(this.secondHandle,"transitionend",this.transitionEnd,this),E.add(this.secondHandle,"mouseenter touchenter",this.handleOver,this),E.add(this.secondHandle,"mouseleave touchend",this.handleLeave,this))},e.prototype.handleStart=function(){this.type!=="Range"&&(this.firstHandle.classList[this.handlePos1===0?"add":"remove"](me.sliderHandleStart),this.isMaterialTooltip&&(this.materialHandle.classList[this.handlePos1===0?"add":"remove"](me.sliderHandleStart),this.tooltipElement&&this.tooltipElement.classList[this.handlePos1===0?"add":"remove"](me.sliderTooltipStart)))},e.prototype.transitionEnd=function(t){t.propertyName!=="transform"&&(this.handleStart(),this.enableAnimation||(this.getHandle().style.transition="none"),this.type!=="Default"&&(this.rangeBar.style.transition="none"),(this.isMaterial||this.isMaterial3)&&this.tooltip.isVisible&&this.type==="Default"&&(this.tooltipElement.style.transition=this.transition.handle),this.tooltipToggle(this.getHandle()),this.closeTooltip())},e.prototype.handleFocusOut=function(){this.firstHandle.classList.contains(me.sliderHandleFocused)&&this.firstHandle.classList.remove(me.sliderHandleFocused),this.type==="Range"&&this.secondHandle.classList.contains(me.sliderHandleFocused)&&this.secondHandle.classList.remove(me.sliderHandleFocused)},e.prototype.handleFocus=function(t){this.focusSliderElement(),this.sliderBarClick(t),t.currentTarget===this.firstHandle?(this.firstHandle.classList.add(me.sliderHandleFocused),this.firstHandle.classList.add(me.sliderTabHandle)):(this.secondHandle.classList.add(me.sliderHandleFocused),this.secondHandle.classList.add(me.sliderTabHandle)),E.add(document,"mousemove touchmove",this.sliderBarMove,this),E.add(document,"mouseup touchend",this.sliderBarUp,this)},e.prototype.handleOver=function(t){this.tooltip.isVisible&&this.tooltip.showOn==="Hover"&&this.tooltipToggle(t.currentTarget),this.type==="Default"&&this.tooltipToggle(this.getHandle())},e.prototype.handleLeave=function(t){this.tooltip.isVisible&&this.tooltip.showOn==="Hover"&&!t.currentTarget.classList.contains(me.sliderHandleFocused)&&!t.currentTarget.classList.contains(me.sliderTabHandle)&&this.closeTooltip()},e.prototype.setHandler=function(){this.createFirstHandle(),this.type==="Range"&&this.createSecondHandle()},e.prototype.setEnableRTL=function(){this.enableRtl&&this.orientation!=="Vertical"?Y([this.sliderContainer],me.rtl):K([this.sliderContainer],me.rtl);var t=this.orientation!=="Vertical"?this.horDir:this.verDir;this.enableRtl?(this.horDir="right",this.verDir="bottom"):(this.horDir="left",this.verDir="bottom");var i=this.orientation!=="Vertical"?this.horDir:this.verDir;t!==i&&this.orientation==="Horizontal"&&(Ye(this.firstHandle,{right:"",left:"auto"}),this.type==="Range"&&Ye(this.secondHandle,{top:"",left:"auto"})),this.setBarColor()},e.prototype.tooltipValue=function(){var t=this,i,r={value:this.value,text:""};this.initialTooltip&&(this.initialTooltip=!1,this.setTooltipContent(),r.text=i=typeof this.tooltipObj.content=="function"?this.tooltipObj.content():this.tooltipObj.content,this.trigger("tooltipChange",r,function(n){if(t.addTooltipClass(n.text),i!==n.text){t.customAriaText=n.text,t.enableHtmlSanitizer?n.text=Bt.sanitize(n.text.toString()):n.text=n.text.toString();var s=function(){return n.text};t.tooltipObj.content=Ks(s),t.setAriaAttrValue(t.firstHandle),t.type==="Range"&&t.setAriaAttrValue(t.secondHandle)}}),this.isMaterialTooltip&&this.setPreviousVal("change",this.value))},e.prototype.setTooltipContent=function(){var t=this.formatContent(this.tooltipFormatInfo,!1),i=function(){return t};this.tooltipObj.content=Ks(i)},e.prototype.formatContent=function(t,i){var r="",n=this.handleVal1,s=this.handleVal2;return!g(this.customValues)&&this.customValues.length>0&&(n=this.customValues[this.handleVal1],s=this.customValues[this.handleVal2]),i?(this.type==="Range"?this.enableRtl&&this.orientation!=="Vertical"?r=!g(this.tooltip)&&!g(this.tooltip.format)?this.formatString(s,t).elementVal+" - "+this.formatString(n,t).elementVal:s.toString()+" - "+n.toString():r=!g(this.tooltip)&&!g(this.tooltip.format)?this.formatString(n,t).elementVal+" - "+this.formatString(s,t).elementVal:n.toString()+" - "+s.toString():g(n)||(r=!g(this.tooltip)&&!g(this.tooltip.format)?this.formatString(n,t).elementVal:n.toString()),r):(this.type==="Range"?this.enableRtl&&this.orientation!=="Vertical"?r=g(t.format)?s.toString()+" - "+n.toString():this.formatString(s,t).formatString+" - "+this.formatString(n,t).formatString:r=g(t.format)?n.toString()+" - "+s.toString():this.formatString(n,t).formatString+" - "+this.formatString(s,t).formatString:g(n)||(r=g(t.format)?n.toString():this.formatString(n,t).formatString),r)},e.prototype.addTooltipClass=function(t){if(this.isMaterialTooltip){var i=t.toString().length;if(this.tooltipElement){var r=i>4?{oldCss:me.sliderMaterialDefault,newCss:me.sliderMaterialRange}:{oldCss:me.sliderMaterialRange,newCss:me.sliderMaterialDefault};this.tooltipElement.classList.remove(r.oldCss),this.tooltipElement.classList.contains(r.newCss)||(this.tooltipElement.classList.add(r.newCss),this.tooltipElement.style.transform=i>4?"scale(1)":this.getTooltipTransformProperties(this.previousTooltipClass).rotate)}else{var r=i>4?me.sliderMaterialRange:me.sliderMaterialDefault;this.tooltipObj.cssClass=me.sliderTooltip+" "+r}}},e.prototype.tooltipPlacement=function(){return this.orientation==="Horizontal"?this.tooltip.placement==="Before"?"TopCenter":"BottomCenter":this.tooltip.placement==="Before"?"LeftCenter":"RightCenter"},e.prototype.tooltipBeforeOpen=function(t){this.tooltipElement=t.element,this.tooltip.cssClass&&Y([this.tooltipElement],this.tooltip.cssClass.split(" ").filter(function(i){return i})),t.target.removeAttribute("aria-describedby"),this.isMaterialTooltip&&(this.tooltipElement.firstElementChild.classList.add(me.materialTooltipHide),this.handleStart(),this.setTooltipTransform())},e.prototype.tooltipCollision=function(t){if(this.isBootstrap||this.isBootstrap4||(this.isMaterial||this.isMaterial3)&&!this.isMaterialTooltip){var i=this.isBootstrap4?NH:kH;switch(t){case"TopCenter":this.tooltipObj.setProperties({offsetY:-i},!1);break;case"BottomCenter":this.tooltipObj.setProperties({offsetY:i},!1);break;case"LeftCenter":this.tooltipObj.setProperties({offsetX:-i},!1);break;case"RightCenter":this.tooltipObj.setProperties({offsetX:i},!1);break}}},e.prototype.materialTooltipEventCallBack=function(t){this.sliderBarClick(t),E.add(document,"mousemove touchmove",this.sliderBarMove,this),E.add(document,"mouseup touchend",this.sliderBarUp,this)},e.prototype.wireMaterialTooltipEvent=function(t){this.isMaterialTooltip&&(t?E.remove(this.tooltipElement,"mousedown touchstart",this.materialTooltipEventCallBack):E.add(this.tooltipElement,"mousedown touchstart",this.materialTooltipEventCallBack,this))},e.prototype.tooltipPositionCalculation=function(t){var i;switch(t){case"TopCenter":i=me.horizontalTooltipBefore;break;case"BottomCenter":i=me.horizontalTooltipAfter;break;case"LeftCenter":i=me.verticalTooltipBefore;break;case"RightCenter":i=me.verticalTooltipAfter;break}return i},e.prototype.getTooltipTransformProperties=function(t){var i;if(this.tooltipElement){var r=this.orientation==="Horizontal"?this.tooltipElement.clientHeight+14-this.tooltipElement.clientHeight/2:this.tooltipElement.clientWidth+14-this.tooltipElement.clientWidth/2;i=this.orientation==="Horizontal"?t===me.horizontalTooltipBefore?{rotate:"rotate(45deg)",translate:"translateY("+r+"px)"}:{rotate:"rotate(225deg)",translate:"translateY("+-r+"px)"}:t===me.verticalTooltipBefore?{rotate:"rotate(-45deg)",translate:"translateX("+r+"px)"}:{rotate:"rotate(-225deg)",translate:"translateX("+-r+"px)"}}return i},e.prototype.openMaterialTooltip=function(){var t=this;if(this.isMaterialTooltip){this.refreshTooltip(this.firstHandle);var i=this.tooltipElement.firstElementChild;i.classList.remove(me.materialTooltipHide),i.classList.add(me.materialTooltipShow),this.firstHandle.style.cursor="default",this.tooltipElement.style.transition=this.scaleTransform,this.tooltipElement.classList.add(me.materialTooltipOpen),this.materialHandle.style.transform="scale(0)",i.innerText.length>4?this.tooltipElement.style.transform="scale(1)":this.tooltipElement.style.transform=this.getTooltipTransformProperties(this.previousTooltipClass).rotate,this.type==="Default"?setTimeout(function(){t.tooltipElement&&(t.tooltipElement.style.transition=t.transition.handle)},2500):setTimeout(function(){t.tooltipElement&&(t.tooltipElement.style.transition="none")},2500)}},e.prototype.closeMaterialTooltip=function(){var t=this;if(this.isMaterialTooltip){var i=this.tooltipElement.firstElementChild;this.tooltipElement.style.transition=this.scaleTransform,i.classList.remove(me.materialTooltipShow),i.classList.add(me.materialTooltipHide),this.firstHandle.style.cursor="-webkit-grab",this.firstHandle.style.cursor="grab",this.materialHandle&&(this.materialHandle.style.transform="scale(1)"),this.tooltipElement.classList.remove(me.materialTooltipOpen),this.setTooltipTransform(),this.tooltipTarget=void 0,setTimeout(function(){t.tooltipElement&&(t.tooltipElement.style.transition="none")},2500)}},e.prototype.checkTooltipPosition=function(t){var i=this.tooltipPositionCalculation(t.collidedPosition);(this.tooltipCollidedPosition===void 0||this.tooltipCollidedPosition!==t.collidedPosition||!t.element.classList.contains(i))&&(this.isMaterialTooltip&&(i!==void 0&&(t.element.classList.remove(this.previousTooltipClass),t.element.classList.add(i),this.previousTooltipClass=i),t.element.style.transform&&t.element.classList.contains(me.materialTooltipOpen)&&t.element.firstElementChild.innerText.length<=4&&(t.element.style.transform=this.getTooltipTransformProperties(this.previousTooltipClass).rotate)),this.tooltipCollidedPosition=t.collidedPosition),this.isMaterialTooltip&&this.tooltipElement&&this.tooltipElement.style.transform.indexOf("translate")!==-1&&this.setTooltipTransform()},e.prototype.setTooltipTransform=function(){var t=this.getTooltipTransformProperties(this.previousTooltipClass);g(this.tooltipElement)||(this.tooltipElement.firstElementChild.innerText.length>4?this.tooltipElement.style.transform=t.translate+" scale(0.01)":this.tooltipElement.style.transform=t.translate+" "+t.rotate+" scale(0.01)")},e.prototype.renderTooltip=function(){this.tooltipObj=new Ol({showTipPointer:this.isBootstrap||this.isMaterial||this.isMaterial3||this.isBootstrap4||this.isTailwind||this.isTailwind3||this.isBootstrap5||this.isFluent||this.isFluent2||this.isBootstrap5Dot3,cssClass:me.sliderTooltip,height:this.isMaterial||this.isMaterial3?30:"auto",animation:{open:{effect:"None"},close:{effect:"FadeOut",duration:500}},opensOn:"Custom",beforeOpen:this.tooltipBeforeOpen.bind(this),beforeCollision:this.checkTooltipPosition.bind(this),beforeClose:this.tooltipBeforeClose.bind(this),enableHtmlSanitizer:this.enableHtmlSanitizer}),this.tooltipObj.appendTo(this.firstHandle),this.initializeTooltipProps()},e.prototype.initializeTooltipProps=function(){var t=this.tooltip.showOn==="Auto"?"Hover":this.tooltip.showOn;this.setProperties({tooltip:{showOn:t}},!0),this.tooltipObj.position=this.tooltipPlacement(),this.tooltipCollision(this.tooltipObj.position),[this.firstHandle,this.rangeBar,this.secondHandle].forEach(function(i){g(i)||(i.style.transition="none")}),this.isMaterialTooltip&&(this.sliderContainer.classList.add(me.materialSlider),this.tooltipValue(),this.tooltipObj.animation.close.effect="None",this.tooltipObj.open(this.firstHandle))},e.prototype.tooltipBeforeClose=function(){this.tooltipElement=void 0,this.tooltipCollidedPosition=void 0},e.prototype.setButtons=function(){this.firstBtn=this.createElement("div",{className:me.sliderButton+" "+me.firstButton}),this.firstBtn.appendChild(this.createElement("span",{className:me.sliderButtonIcon})),(this.isTailwind||this.isTailwind3)&&this.firstBtn.querySelector("span").classList.add("e-icons"),this.firstBtn.tabIndex=-1,this.secondBtn=this.createElement("div",{className:me.sliderButton+" "+me.secondButton}),this.secondBtn.appendChild(this.createElement("span",{className:me.sliderButtonIcon})),(this.isTailwind||this.isTailwind3)&&this.secondBtn.querySelector("span").classList.add("e-icons"),this.secondBtn.tabIndex=-1,this.sliderContainer.classList.add(me.sliderButtonClass),this.sliderContainer.appendChild(this.firstBtn),this.sliderContainer.appendChild(this.secondBtn),this.sliderContainer.appendChild(this.element),this.buttonTitle()},e.prototype.buttonTitle=function(){var t=this.enableRtl&&this.orientation!=="Vertical";this.l10n.setLocale(this.locale);var i=this.l10n.getConstant("decrementTitle"),r=this.l10n.getConstant("incrementTitle");Ie(t?this.secondBtn:this.firstBtn,{"aria-label":i,title:i}),Ie(t?this.firstBtn:this.secondBtn,{"aria-label":r,title:r})},e.prototype.buttonFocusOut=function(){(this.isMaterial||this.isMaterial3)&&this.getHandle().classList.remove("e-large-thumb-size")},e.prototype.repeatButton=function(t){var i=this.handleValueUpdate(),r=this.enableRtl&&this.orientation!=="Vertical",n;t.target.parentElement.classList.contains(me.firstButton)||t.target.classList.contains(me.firstButton)?r?n=this.add(i,parseFloat(this.step.toString()),!0):n=this.add(i,parseFloat(this.step.toString()),!1):(t.target.parentElement.classList.contains(me.secondButton)||t.target.classList.contains(me.secondButton))&&(r?n=this.add(i,parseFloat(this.step.toString()),!1):n=this.add(i,parseFloat(this.step.toString()),!0)),this.limits.enabled&&(n=this.getLimitCorrectedValues(n)),n>=this.min&&n<=this.max&&(this.changeHandleValue(n),this.tooltipToggle(this.getHandle()))},e.prototype.repeatHandlerMouse=function(t){t.preventDefault(),(t.type==="mousedown"||t.type==="touchstart")&&(this.buttonClick(t),this.repeatInterval=setInterval(this.repeatButton.bind(this),180,t))},e.prototype.materialChange=function(){this.getHandle().classList.contains("e-large-thumb-size")||this.getHandle().classList.add("e-large-thumb-size")},e.prototype.focusHandle=function(){this.getHandle().classList.contains(me.sliderTabHandle)||this.getHandle().classList.add(me.sliderTabHandle)},e.prototype.repeatHandlerUp=function(t){this.changeEvent("changed",t),this.closeTooltip(),clearInterval(this.repeatInterval),this.getHandle().focus()},e.prototype.customTickCounter=function(t){var i=4;return!g(this.customValues)&&this.customValues.length>0&&(t>4&&(i=3),t>7&&(i=2),t>14&&(i=1),t>28&&(i=0)),i},e.prototype.renderScale=function(){var t=this.orientation==="Vertical"?"v":"h";this.noOfDecimals=this.numberOfDecimals(this.step),this.ul=this.createElement("ul",{className:me.scale+" e-"+t+"-scale "+me.tick+"-"+this.ticks.placement.toLowerCase(),attrs:{role:"presentation","aria-hidden":"true"}}),this.ul.style.zIndex="-1",B.isAndroid&&t==="h"&&this.ul.classList.add(me.sliderTickPosition);var i=this.ticks.smallStep;this.ticks.showSmallTicks?i<=0&&(i=parseFloat(Le(this.step))):this.ticks.largeStep>0?i=this.ticks.largeStep:i=parseFloat(Le(this.max))-parseFloat(Le(this.min));var r=this.fractionalToInteger(this.min),n=this.fractionalToInteger(this.max),s=this.fractionalToInteger(i),a=!g(this.customValues)&&this.customValues.length>0&&this.customValues.length-1,l=this.customTickCounter(a),h=!g(this.customValues)&&this.customValues.length>0?a*l+a:Math.abs((n-r)/s);this.element.appendChild(this.ul);var u,c=parseFloat(this.min.toString());t==="v"&&(c=parseFloat(this.max.toString()));var d=0,p,f=100/h;f===1/0&&(f=5);for(var v=0,m=!g(this.customValues)&&this.customValues.length>0?this.customValues.length-1:0,y=0;v<=h;v++){if(u=this.createElement("li",{attrs:{class:me.tick,role:"presentation","aria-hidden":"true"}}),!g(this.customValues)&&this.customValues.length>0)p=v%(l+1)===0,p&&(t==="h"?(c=this.customValues[y],y++):(c=this.customValues[m],m--),u.setAttribute("title",c.toString()));else if(u.setAttribute("title",c.toString()),this.numberOfDecimals(this.max)===0&&this.numberOfDecimals(this.min)===0&&this.numberOfDecimals(this.step)===0)t==="h"?p=(c-parseFloat(this.min.toString()))%this.ticks.largeStep===0:p=Math.abs(c-parseFloat(this.max.toString()))%this.ticks.largeStep===0;else{var S=this.fractionalToInteger(this.ticks.largeStep),b=this.fractionalToInteger(c);t==="h"?p=(b-r)%S===0:p=Math.abs(b-parseFloat(n.toString()))%S===0}p&&u.classList.add(me.large),t==="h"?u.style.width=f+"%":u.style.height=f+"%";var w=p?this.ticks.placement==="Both"?2:1:0;if(p)for(var I=0;I<w;I++)this.createTick(u,c);else g(this.customValues)&&this.formatTicksValue(u,c);this.ul.appendChild(u),this.tickElementCollection.push(u);var x=void 0;g(this.customValues)&&(this.numberOfDecimals(i)>this.numberOfDecimals(c)?x=this.numberOfDecimals(i):x=this.numberOfDecimals(c),t==="h"?c=this.makeRoundNumber(c+i,x):this.min>this.max?c=this.makeRoundNumber(c+i,x):c=this.makeRoundNumber(c-i,x),d=this.makeRoundNumber(d+i,x))}this.ticksAlignment(t,f)},e.prototype.ticksAlignment=function(t,i,r){r===void 0&&(r=!0),this.firstChild=this.ul.firstElementChild,this.lastChild=this.ul.lastElementChild,this.firstChild.classList.add(me.sliderFirstTick),this.lastChild.classList.add(me.sliderLastTick),this.sliderContainer.classList.add(me.scale+"-"+this.ticks.placement.toLowerCase()),t==="h"?(this.firstChild.style.width=i/2+"%",this.lastChild.style.width=i/2+"%"):(this.firstChild.style.height=i/2+"%",this.lastChild.style.height=i/2+"%");var n={ticksWrapper:this.ul,tickElements:this.tickElementCollection};r&&this.trigger("renderedTicks",n),this.scaleAlignment()},e.prototype.createTick=function(t,i){var r=this.createElement("span",{className:me.tickValue+" "+me.tick+"-"+this.ticks.placement.toLowerCase(),attrs:{role:"presentation","aria-hidden":"true"}});t.appendChild(r),g(this.customValues)?this.formatTicksValue(t,i,r):this.enableHtmlSanitizer?r.innerHTML=Bt.sanitize(i.toString()):r.innerHTML=i.toString()},e.prototype.formatTicksValue=function(t,i,r){var n=this,s=this.formatNumber(i),a=!g(this.ticks)&&!g(this.ticks.format)?this.formatString(i,this.ticksFormatInfo).formatString:s,l={value:i,text:a,tickElement:t};this.trigger("renderingTicks",l,function(h){t.setAttribute("title",h.text.toString()),r&&(n.enableHtmlSanitizer?r.innerHTML=Bt.sanitize(h.text.toString()):r.innerHTML=h.text.toString())})},e.prototype.scaleAlignment=function(){this.tickValuePosition(),this.orientation==="Vertical"?this.element.getBoundingClientRect().width<=15?this.sliderContainer.classList.add(me.sliderSmallSize):this.sliderContainer.classList.remove(me.sliderSmallSize):this.element.getBoundingClientRect().height<=15?this.sliderContainer.classList.add(me.sliderSmallSize):this.sliderContainer.classList.remove(me.sliderSmallSize)},e.prototype.tickValuePosition=function(){this.firstChild=this.element.querySelector("ul").children[0];var t=this.firstChild.getBoundingClientRect(),i,r,n=this.ticks.smallStep,s=Math.abs(parseFloat(Le(this.max))-parseFloat(Le(this.min)))/n;this.firstChild.children.length>0&&(i=this.firstChild.children[0].getBoundingClientRect());var a=[this.sliderContainer.querySelectorAll("."+me.tick+"."+me.large+" ."+me.tickValue)],l;this.ticks.placement==="Both"?l=[].slice.call(a[0],2):l=[].slice.call(a[0],1);for(var h=this.orientation==="Vertical"?t.height*2:t.width*2,u=0;u<this.firstChild.children.length;u++)this.orientation==="Vertical"?this.firstChild.children[u].style.top=-(i.height/2)+"px":this.enableRtl?this.firstChild.children[u].style.left=(h-this.firstChild.children[u].getBoundingClientRect().width)/2+"px":this.firstChild.children[u].style.left=-(i.width/2)+"px";for(var u=0;u<l.length;u++)r=l[u].getBoundingClientRect(),this.orientation==="Vertical"?Ye(l[u],{top:(h-r.height)/2+"px"}):Ye(l[u],{left:(h-r.width)/2+"px"});this.enableRtl&&this.lastChild.children.length&&s!==0&&(this.lastChild.children[0].style.left=-(this.lastChild.getBoundingClientRect().width/2)+"px",this.ticks.placement==="Both"&&(this.lastChild.children[1].style.left=-(this.lastChild.getBoundingClientRect().width/2)+"px")),s===0&&(this.orientation==="Horizontal"&&(this.enableRtl?(this.firstChild.classList.remove(me.sliderLastTick),this.firstChild.style.right=this.firstHandle.style.right,this.firstChild.children[0].style.left=this.firstChild.getBoundingClientRect().width/2+2+"px",this.ticks.placement==="Both"&&(this.firstChild.children[1].style.left=this.firstChild.getBoundingClientRect().width/2+2+"px")):(this.firstChild.classList.remove(me.sliderLastTick),this.firstChild.style.left=this.firstHandle.style.left)),this.orientation==="Vertical"&&this.firstChild.classList.remove(me.sliderLastTick))},e.prototype.setAriaAttrValue=function(t){var i,r=!g(this.ticks)&&!g(this.ticks.format),n=r?this.formatContent(this.tooltipFormatInfo,!1):this.formatContent(this.ticksFormatInfo,!1),s=r?this.formatContent(this.ticksFormatInfo,!0):this.formatContent(this.tooltipFormatInfo,!0);n=this.customAriaText?this.customAriaText:n,n.split(" - ").length===2?i=n.split(" - "):i=[n,n],this.setAriaAttributes(t),this.type!=="Range"?Ie(t,{"aria-valuenow":s,"aria-valuetext":n}):this.enableRtl?t===this.firstHandle?Ie(t,{"aria-valuenow":s.split(" - ")[1],"aria-valuetext":i[1]}):Ie(t,{"aria-valuenow":s.split(" - ")[0],"aria-valuetext":i[0]}):t===this.firstHandle?Ie(t,{"aria-valuenow":s.split(" - ")[0],"aria-valuetext":i[0]}):Ie(t,{"aria-valuenow":s.split(" - ")[1],"aria-valuetext":i[1]})},e.prototype.handleValueUpdate=function(){var t;return this.type==="Range"?this.activeHandle===1?t=this.handleVal1:t=this.handleVal2:t=this.handleVal1,t},e.prototype.getLimitCorrectedValues=function(t){return this.type==="MinRange"||this.type==="Default"?t=this.getLimitValueAndPosition(t,this.limits.minStart,this.limits.minEnd)[0]:this.activeHandle===1?t=this.getLimitValueAndPosition(t,this.limits.minStart,this.limits.minEnd)[0]:t=this.getLimitValueAndPosition(t,this.limits.maxStart,this.limits.maxEnd)[0],t},e.prototype.focusSliderElement=function(){this.isElementFocused||(this.element.focus(),this.isElementFocused=!0)},e.prototype.buttonClick=function(t){this.focusSliderElement();var i,r=this.enableRtl&&this.orientation!=="Vertical",n=this.handleValueUpdate();t.keyCode===40||t.keyCode===37||t.currentTarget.classList.contains(me.firstButton)?r?i=this.add(n,parseFloat(this.step.toString()),!0):i=this.add(n,parseFloat(this.step.toString()),!1):t.keyCode===38||t.keyCode===39||t.currentTarget.classList.contains(me.secondButton)?r?i=this.add(n,parseFloat(this.step.toString()),!1):i=this.add(n,parseFloat(this.step.toString()),!0):t.keyCode===33||t.currentTarget.classList.contains(me.firstButton)?r?i=this.add(n,parseFloat(this.ticks.largeStep.toString()),!1):i=this.add(n,parseFloat(this.ticks.largeStep.toString()),!0):t.keyCode===34||t.currentTarget.classList.contains(me.secondButton)?r?i=this.add(n,parseFloat(this.ticks.largeStep.toString()),!0):i=this.add(n,parseFloat(this.ticks.largeStep.toString()),!1):t.keyCode===36?i=parseFloat(this.min<this.max?this.min.toString():this.max.toString()):t.keyCode===35&&(i=parseFloat(this.min<this.max?this.max.toString():this.min.toString())),this.limits.enabled&&(i=this.getLimitCorrectedValues(i)),this.changeHandleValue(i),(this.isMaterial||this.isMaterial3)&&!this.tooltip.isVisible&&!this.getHandle().classList.contains(me.sliderTabHandle)&&this.materialChange(),this.tooltipToggle(this.getHandle()),this.getHandle().focus(),this.focusHandle(),t.currentTarget.classList.contains(me.firstButton)&&E.add(this.firstBtn,"mouseup touchend",this.buttonUp,this),t.currentTarget.classList.contains(me.secondButton)&&E.add(this.secondBtn,"mouseup touchend",this.buttonUp,this)},e.prototype.tooltipToggle=function(t){this.isMaterialTooltip?this.tooltipElement.classList.contains(me.materialTooltipOpen)?this.refreshTooltip(this.firstHandle):this.openMaterialTooltip():this.tooltipElement?this.refreshTooltip(t):this.openTooltip(t)},e.prototype.buttonUp=function(t){t.currentTarget.classList.contains(me.firstButton)&&E.remove(this.firstBtn,"mouseup touchend",this.buttonUp),t.currentTarget.classList.contains(me.secondButton)&&E.remove(this.secondBtn,"mouseup touchend",this.buttonUp)},e.prototype.setRangeBar=function(){this.orientation==="Horizontal"&&!g(this.rangeBar)?this.type==="MinRange"?(this.enableRtl?this.rangeBar.style.right="0px":this.rangeBar.style.left="0px",Ye(this.rangeBar,{width:g(this.handlePos1)?0:this.handlePos1+"px"})):(this.enableRtl?this.rangeBar.style.right=this.handlePos1+"px":this.rangeBar.style.left=this.handlePos1+"px",Ye(this.rangeBar,{width:this.handlePos2-this.handlePos1+"px"})):g(this.rangeBar)||(this.type==="MinRange"?(this.rangeBar.style.bottom=this.min>this.max?this.handlePos1+"px":"0px",Ye(this.rangeBar,{height:g(this.handlePos1)?0:this.min>this.max?this.element.clientHeight-this.handlePos1+"px":this.handlePos1+"px"})):(this.rangeBar.style.bottom=this.min>this.max?this.handlePos2+"px":this.handlePos1+"px",Ye(this.rangeBar,{height:this.min>this.max?this.handlePos1-this.handlePos2+"px":this.handlePos2-this.handlePos1+"px"})))},e.prototype.checkValidValueAndPos=function(t){return t=this.checkHandleValue(t),t=this.checkHandlePosition(t),t},e.prototype.setLimitBarPositions=function(t,i,r,n){this.orientation==="Horizontal"?this.enableRtl?(this.limitBarFirst.style.right=t+"px",this.limitBarFirst.style.width=i-t+"px"):(this.limitBarFirst.style.left=t+"px",this.limitBarFirst.style.width=i-t+"px"):(this.limitBarFirst.style.bottom=(this.min<this.max?t:i)+"px",this.limitBarFirst.style.height=(this.min<this.max?i-t:t-i)+"px"),this.type==="Range"&&(this.orientation==="Horizontal"?this.enableRtl?(this.limitBarSecond.style.right=r+"px",this.limitBarSecond.style.width=n-r+"px"):(this.limitBarSecond.style.left=r+"px",this.limitBarSecond.style.width=n-r+"px"):(this.limitBarSecond.style.bottom=(this.min<this.max?r:n)+"px",this.limitBarSecond.style.height=(this.min<this.max?n-r:r-n)+"px"))},e.prototype.setLimitBar=function(){if(this.type==="Default"||this.type==="MinRange"){var t=this.getLimitValueAndPosition(this.limits.minStart,this.limits.minStart,this.limits.minEnd,!0)[0];t=this.checkValidValueAndPos(t);var i=this.getLimitValueAndPosition(this.limits.minEnd,this.limits.minStart,this.limits.minEnd,!0)[0];i=this.checkValidValueAndPos(i),this.setLimitBarPositions(t,i)}else if(this.type==="Range"){var r=this.getLimitValueAndPosition(this.limits.minStart,this.limits.minStart,this.limits.minEnd,!0)[0];r=this.checkValidValueAndPos(r);var n=this.getLimitValueAndPosition(this.limits.minEnd,this.limits.minStart,this.limits.minEnd,!0)[0];n=this.checkValidValueAndPos(n);var s=this.getLimitValueAndPosition(this.limits.maxStart,this.limits.maxStart,this.limits.maxEnd,!0)[0];s=this.checkValidValueAndPos(s);var a=this.getLimitValueAndPosition(this.limits.maxEnd,this.limits.maxStart,this.limits.maxEnd,!0)[0];a=this.checkValidValueAndPos(a),this.setLimitBarPositions(r,n,s,a)}},e.prototype.getLimitValueAndPosition=function(t,i,r,n){return g(i)&&(i=this.min<this.max?this.min:this.max,g(t)&&n&&(t=i)),g(r)&&(r=this.min<this.max?this.max:this.min,g(t)&&n&&(t=r)),t<i&&(t=i),t>r&&(t=r),[t,this.checkHandlePosition(t)]},e.prototype.setValue=function(){if(!g(this.customValues)&&this.customValues.length>0&&(this.min=0,this.max=this.customValues.length-1,this.setBarColor()),this.setAriaAttributes(this.firstHandle),this.handleVal1=g(this.value)?this.checkHandleValue(parseFloat(this.min.toString())):this.checkHandleValue(parseFloat(this.value.toString())),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.preHandlePos1=this.handlePos1,g(this.activeHandle)&&(this.activeHandle=this.type==="Range"?2:1),this.type==="Default"||this.type==="MinRange"){if(this.limits.enabled){var t=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=t[0],this.handlePos1=t[1],this.preHandlePos1=this.handlePos1}this.setHandlePosition(null),this.handleStart(),this.value=this.handleVal1,this.setAriaAttrValue(this.firstHandle),this.changeEvent("changed",null)}else this.validateRangeValue();this.type!=="Default"&&this.setRangeBar(),this.limits.enabled&&this.setLimitBar()},e.prototype.rangeValueUpdate=function(){(this.value===null||typeof this.value!="object")&&(this.value=[parseFloat(Le(this.min)),parseFloat(Le(this.max))])},e.prototype.validateRangeValue=function(){this.rangeValueUpdate(),this.setRangeValue()},e.prototype.modifyZindex=function(){this.type==="Range"&&!g(this.firstHandle)&&!g(this.secondHandle)?this.activeHandle===1?(this.firstHandle.style.zIndex=this.zIndex+4+"",this.secondHandle.style.zIndex=this.zIndex+3+""):(this.firstHandle.style.zIndex=this.zIndex+3+"",this.secondHandle.style.zIndex=this.zIndex+4+""):this.isMaterialTooltip&&this.tooltipElement&&(this.tooltipElement.style.zIndex=Fs(this.element)+"")},e.prototype.setHandlePosition=function(t){var i=this,r,n=this.activeHandle===1?this.handlePos1:this.handlePos2;this.isMaterialTooltip?r=[this.firstHandle,this.materialHandle]:r=[this.getHandle()],this.handleStart(),r.forEach(function(s){g(s)||(i.orientation==="Horizontal"?i.enableRtl?s.style.right=n+"px":s.style.left=n+"px":s.style.bottom=n+"px")}),this.changeEvent("change",t)},e.prototype.getHandle=function(){return this.activeHandle===1?this.firstHandle:this.secondHandle},e.prototype.setRangeValue=function(){this.updateRangeValue(),this.activeHandle=1,this.setHandlePosition(null),this.activeHandle=2,this.setHandlePosition(null),this.activeHandle=1},e.prototype.changeEvent=function(t,i){var r=t==="change"?this.previousVal:this.previousChanged;if(this.type!=="Range")this.setProperties({value:this.handleVal1},!0),r!==this.value&&(!this.isMaterialTooltip||!this.initialTooltip)&&(this.trigger(t,this.changeEventArgs(t,i)),this.initialTooltip=!0,this.setPreviousVal(t,this.value)),this.setAriaAttrValue(this.firstHandle);else{var n=this.value=[this.handleVal1,this.handleVal2];this.setProperties({value:n},!0),(r.length===this.value.length&&this.value[0]!==r[0]||this.value[1]!==r[1])&&(this.initialTooltip=!1,this.trigger(t,this.changeEventArgs(t,i)),this.initialTooltip=!0,this.setPreviousVal(t,this.value)),this.setAriaAttrValue(this.getHandle())}this.hiddenInput.value=this.value.toString()},e.prototype.changeEventArgs=function(t,i){var r;return this.tooltip.isVisible&&this.tooltipObj&&this.initialTooltip?(this.tooltipValue(),r={value:this.value,previousValue:t==="change"?this.previousVal:this.previousChanged,action:t,text:typeof this.tooltipObj.content=="function"?this.tooltipObj.content():this.tooltipObj.content,isInteracted:!g(i)}):r={value:this.value,previousValue:t==="change"?this.previousVal:this.previousChanged,action:t,text:g(this.ticksFormatInfo.format)?this.value.toString():this.type!=="Range"?this.formatString(this.value,this.ticksFormatInfo).formatString:this.formatString(this.value[0],this.ticksFormatInfo).formatString+" - "+this.formatString(this.value[1],this.ticksFormatInfo).formatString,isInteracted:!g(i)},r},e.prototype.setPreviousVal=function(t,i){t==="change"?this.previousVal=i:this.previousChanged=i},e.prototype.updateRangeValue=function(){var t=this.value.toString().split(",").map(Number);if(this.enableRtl&&this.orientation!=="Vertical"||this.rtl?this.value=[t[1],t[0]]:this.value=[t[0],t[1]],this.enableRtl&&this.orientation!=="Vertical"?(this.handleVal1=this.checkHandleValue(this.value[1]),this.handleVal2=this.checkHandleValue(this.value[0])):(this.handleVal1=this.checkHandleValue(this.value[0]),this.handleVal2=this.checkHandleValue(this.value[1])),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handlePos2=this.checkHandlePosition(this.handleVal2),this.min<this.max&&this.handlePos1>this.handlePos2&&(this.handlePos1=this.handlePos2,this.handleVal1=this.handleVal2),this.min>this.max&&this.handlePos1<this.handlePos2&&(this.handlePos2=this.handlePos1,this.handleVal2=this.handleVal1),this.preHandlePos1=this.handlePos1,this.preHandlePos2=this.handlePos2,this.limits.enabled){this.activeHandle=1;var i=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=i[0],this.handlePos1=i[1],this.preHandlePos1=this.handlePos1,this.activeHandle=2,i=this.getLimitValueAndPosition(this.handleVal2,this.limits.maxStart,this.limits.maxEnd),this.handleVal2=i[0],this.handlePos2=i[1],this.preHandlePos2=this.handlePos2}},e.prototype.checkHandlePosition=function(t){var i;return t=100*(t-parseFloat(Le(this.min)))/(parseFloat(Le(this.max))-parseFloat(Le(this.min))),this.orientation==="Horizontal"?i=this.element.getBoundingClientRect().width*(t/100):i=this.element.getBoundingClientRect().height*(t/100),parseFloat(Le(this.max))===parseFloat(Le(this.min))&&(this.orientation==="Horizontal"?i=this.element.getBoundingClientRect().width:i=this.element.getBoundingClientRect().height),i},e.prototype.checkHandleValue=function(t){if(this.min===this.max)return parseFloat(Le(this.max));var i=this.tempStartEnd();return t<i.start?t=i.start:t>i.end&&(t=i.end),t},e.prototype.reposition=function(){var t=this;g(this.firstHandle)||(this.firstHandle.style.transition="none"),this.type!=="Default"&&!g(this.rangeBar)&&(this.rangeBar.style.transition="none"),this.type==="Range"&&!g(this.secondHandle)&&(this.secondHandle.style.transition="none"),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handleVal2&&(this.handlePos2=this.checkHandlePosition(this.handleVal2)),this.orientation==="Horizontal"?(this.enableRtl?this.firstHandle.style.right=this.handlePos1+"px":this.firstHandle.style.left=this.handlePos1+"px",this.isMaterialTooltip&&!g(this.materialHandle)&&(this.enableRtl?this.materialHandle.style.right=this.handlePos1+"px":this.materialHandle.style.left=this.handlePos1+"px"),this.type==="MinRange"&&!g(this.rangeBar)?(this.enableRtl?this.rangeBar.style.right="0px":this.rangeBar.style.left="0px",Ye(this.rangeBar,{width:g(this.handlePos1)?0:this.handlePos1+"px"})):this.type==="Range"&&!g(this.secondHandle)&&!g(this.rangeBar)&&(this.enableRtl?(this.secondHandle.style.right=this.handlePos2+"px",this.rangeBar.style.right=this.handlePos1+"px"):(this.secondHandle.style.left=this.handlePos2+"px",this.rangeBar.style.left=this.handlePos1+"px"),Ye(this.rangeBar,{width:this.handlePos2-this.handlePos1+"px"}))):(this.firstHandle.style.bottom=this.handlePos1+"px",this.isMaterialTooltip&&(this.materialHandle.style.bottom=this.handlePos1+"px"),this.type==="MinRange"?(this.rangeBar.style.bottom=this.min>this.max?this.handlePos1+"px":"0px",Ye(this.rangeBar,{height:g(this.handlePos1)?0:this.min>this.max?this.element.clientHeight-this.handlePos1+"px":this.handlePos1+"px"})):this.type==="Range"&&(this.secondHandle.style.bottom=this.handlePos2+"px",this.rangeBar.style.bottom=this.min>this.max?this.handlePos2+"px":this.handlePos1+"px",Ye(this.rangeBar,{height:this.min>this.max?this.handlePos1-this.handlePos2+"px":this.handlePos2-this.handlePos1+"px"}))),this.limits.enabled&&this.setLimitBar(),this.ticks.placement!=="None"&&this.ul&&(this.removeElement(this.ul),this.ul=void 0,this.renderScale()),this.handleStart(),this.tooltip.isVisible||setTimeout(function(){g(t.firstHandle)||(t.firstHandle.style.transition=t.scaleTransform),t.type==="Range"&&!g(t.secondHandle)&&(t.secondHandle.style.transition=t.scaleTransform)}),this.refreshTooltip(this.tooltipTarget),this.setBarColor()},e.prototype.changeHandleValue=function(t){var i=null;this.activeHandle===1?(this.limits.enabled&&this.limits.startHandleFixed||(this.handleVal1=this.checkHandleValue(t),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.type==="Range"&&(this.handlePos1>this.handlePos2&&this.min<this.max||this.handlePos1<this.handlePos2&&this.min>this.max)&&(this.handlePos1=this.handlePos2,this.handleVal1=this.handleVal2),this.handlePos1!==this.preHandlePos1&&(i=this.preHandlePos1=this.handlePos1)),this.modifyZindex()):(this.limits.enabled&&this.limits.endHandleFixed||(this.handleVal2=this.checkHandleValue(t),this.handlePos2=this.checkHandlePosition(this.handleVal2),this.type==="Range"&&(this.handlePos2<this.handlePos1&&this.min<this.max||this.handlePos2>this.handlePos1&&this.min>this.max)&&(this.handlePos2=this.handlePos1,this.handleVal2=this.handleVal1),this.handlePos2!==this.preHandlePos2&&(i=this.preHandlePos2=this.handlePos2)),this.modifyZindex()),i!==null&&(this.type!=="Default"&&this.setRangeBar(),this.setHandlePosition(null))},e.prototype.tempStartEnd=function(){return this.min>this.max?{start:this.max,end:this.min}:{start:this.min,end:this.max}},e.prototype.xyToPosition=function(t){var i;if(this.min===this.max)return 100;if(this.orientation==="Horizontal"){var r=t.x-this.element.getBoundingClientRect().left,n=this.element.offsetWidth/100;this.val=r/n}else{var s=t.y-this.element.getBoundingClientRect().top,n=this.element.offsetHeight/100;this.val=100-s/n}var a=this.stepValueCalculation(this.val);return a<0?a=0:a>100&&(a=100),this.enableRtl&&this.orientation!=="Vertical"&&(a=100-a),this.orientation==="Horizontal"?i=this.element.getBoundingClientRect().width*(a/100):i=this.element.getBoundingClientRect().height*(a/100),i},e.prototype.stepValueCalculation=function(t){this.step===0&&(this.step=1);var i=parseFloat(Le(this.step))/((parseFloat(Le(this.max))-parseFloat(Le(this.min)))/100),r=t%Math.abs(i);return r!==0&&(i/2>r?t-=r:t+=Math.abs(i)-r),t},e.prototype.add=function(t,i,r){var n=Math.pow(10,3),s;return r?s=(Math.round(t*n)+Math.round(i*n))/n:s=(Math.round(t*n)-Math.round(i*n))/n,s},e.prototype.positionToValue=function(t){var i,r=parseFloat(Le(this.max))-parseFloat(Le(this.min));this.orientation==="Horizontal"?i=t/this.element.getBoundingClientRect().width*r:i=t/this.element.getBoundingClientRect().height*r;var n=this.add(i,parseFloat(this.min.toString()),!0);return n},e.prototype.sliderBarClick=function(t){t.preventDefault();var i;t.type==="mousedown"||t.type==="mouseup"||t.type==="click"?i={x:t.clientX,y:t.clientY}:(t.type==="touchend"||t.type==="touchstart")&&(i={x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY});var r=this.xyToPosition(i),n=this.positionToValue(r);if(this.type==="Range"&&(this.min<this.max&&this.handlePos2-r<r-this.handlePos1||this.min>this.max&&this.handlePos1-r>r-this.handlePos2)){if(this.activeHandle=2,!(this.limits.enabled&&this.limits.endHandleFixed)){if(this.limits.enabled){var s=this.getLimitValueAndPosition(n,this.limits.maxStart,this.limits.maxEnd);n=s[0],r=s[1]}this.secondHandle.classList.add(me.sliderActiveHandle),this.handlePos2=this.preHandlePos2=r,this.handleVal2=n}this.modifyZindex(),this.secondHandle.focus()}else{if(this.activeHandle=1,!(this.limits.enabled&&this.limits.startHandleFixed)){if(this.limits.enabled){var s=this.getLimitValueAndPosition(n,this.limits.minStart,this.limits.minEnd);n=s[0],r=s[1]}this.firstHandle.classList.add(me.sliderActiveHandle),this.handlePos1=this.preHandlePos1=r,this.handleVal1=n}this.modifyZindex(),this.firstHandle.focus()}this.isMaterialTooltip&&this.tooltipElement.classList.add(me.materialTooltipActive);var a=this.element.querySelector("."+me.sliderTabHandle);a&&this.getHandle()!==a&&a.classList.remove(me.sliderTabHandle);var l=this.activeHandle===1?this.firstHandle:this.secondHandle,h;if((t.type==="click"||t.type==="mousedown")&&t.target===l){var u=t.clientX,c=t.clientY;h=document.elementFromPoint(u,c)}if(this.checkRepeatedValue(n)){var d=(this.isMaterial||this.isMaterial3)&&this.tooltip.isVisible?this.transitionOnMaterialTooltip:this.transition;this.getHandle().style.transition=d.handle,this.type!=="Default"&&(this.rangeBar.style.transition=d.rangeBar),this.setHandlePosition(t),this.isMaterialTooltip&&(this.initialTooltip=!1),t.target!==l&&this.changeEvent("changed",t),this.type!=="Default"&&this.setRangeBar()}},e.prototype.handleValueAdjust=function(t,i,r){r===1?(this.handleVal1=i,this.handleVal2=this.handleVal1+this.minDiff):r===2&&(this.handleVal2=i,this.handleVal1=this.handleVal2-this.minDiff),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handlePos2=this.checkHandlePosition(this.handleVal2)},e.prototype.dragRangeBarMove=function(t){var i,r;t.type!=="touchmove"&&t.preventDefault(),this.rangeBarDragged=!0;var n;this.rangeBar.style.transition="none",this.firstHandle.style.transition="none",this.secondHandle.style.transition="none";var s,a;if(t.type==="mousemove"?(i=[t.clientX,t.clientY],s=i[0],a=i[1]):(r=[t.changedTouches[0].clientX,t.changedTouches[0].clientY],s=r[0],a=r[1]),!(this.limits.enabled&&this.limits.startHandleFixed)&&!(this.limits.enabled&&this.limits.endHandleFixed)){if(this.enableRtl?n={x:s+this.secondPartRemain,y:a+this.secondPartRemain}:n={x:s-this.firstPartRemain,y:a+this.secondPartRemain},this.min>this.max?(this.handlePos2=this.xyToPosition(n),this.handleVal2=this.positionToValue(this.handlePos2)):(this.handlePos1=this.xyToPosition(n),this.handleVal1=this.positionToValue(this.handlePos1)),this.enableRtl?n={x:s-this.firstPartRemain,y:a-this.firstPartRemain}:n={x:s+this.secondPartRemain,y:a-this.firstPartRemain},this.min>this.max?(this.handlePos1=this.xyToPosition(n),this.handleVal1=this.positionToValue(this.handlePos1)):(this.handlePos2=this.xyToPosition(n),this.handleVal2=this.positionToValue(this.handlePos2)),this.limits.enabled){var l=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=l[0],this.handlePos1=l[1],this.handleVal1===this.limits.minEnd&&this.handleValueAdjust(this.handleVal1,this.limits.minEnd,1),this.handleVal1===this.limits.minStart&&this.handleValueAdjust(this.handleVal1,this.limits.minStart,1),l=this.getLimitValueAndPosition(this.handleVal2,this.limits.maxStart,this.limits.maxEnd),this.handleVal2=l[0],this.handlePos2=l[1],this.handleVal2===this.limits.maxStart&&this.handleValueAdjust(this.handleVal2,this.limits.maxStart,2),this.handleVal2===this.limits.maxEnd&&this.handleValueAdjust(this.handleVal2,this.limits.maxEnd,2)}this.handleVal2===(this.min>this.max?this.min:this.max)&&this.handleValueAdjust(this.handleVal2,this.min>this.max?this.min:this.max,2),this.handleVal1===(this.min>this.max?this.max:this.min)&&this.handleValueAdjust(this.handleVal1,this.min>this.max?this.max:this.min,1)}this.activeHandle=1,this.setHandlePosition(t),this.activeHandle=2,this.setHandlePosition(t),this.tooltipToggle(this.rangeBar),this.setRangeBar()},e.prototype.sliderBarUp=function(t){this.changeEvent("changed",t),this.handleFocusOut(),this.firstHandle.classList.remove(me.sliderActiveHandle),this.type==="Range"&&(this.initialTooltip=!1,this.secondHandle.classList.remove(me.sliderActiveHandle)),this.closeTooltip(),(this.isMaterial||this.isMaterial3)&&(this.getHandle().classList.remove("e-large-thumb-size"),this.isMaterialTooltip&&this.tooltipElement.classList.remove(me.materialTooltipActive)),E.remove(document,"mousemove touchmove",this.sliderBarMove),E.remove(document,"mouseup touchend",this.sliderBarUp)},e.prototype.sliderBarMove=function(t){t.type!=="touchmove"&&t.preventDefault();var i;t.type==="mousemove"?i={x:t.clientX,y:t.clientY}:i={x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY};var r=this.xyToPosition(i),n=this.positionToValue(r);if(r=Math.round(r),this.type!=="Range"&&this.activeHandle===1){if(!(this.limits.enabled&&this.limits.startHandleFixed)){if(this.limits.enabled){var s=this.getLimitValueAndPosition(n,this.limits.minStart,this.limits.minEnd);r=s[1],n=s[0]}this.handlePos1=r,this.handleVal1=n}this.firstHandle.classList.add(me.sliderActiveHandle)}if(this.type==="Range"){if(this.activeHandle===1){if(this.firstHandle.classList.add(me.sliderActiveHandle),!(this.limits.enabled&&this.limits.startHandleFixed)&&((this.min<this.max&&r>this.handlePos2||this.min>this.max&&r<this.handlePos2)&&(r=this.handlePos2,n=this.handleVal2),r!==this.preHandlePos1)){if(this.limits.enabled){var a=this.getLimitValueAndPosition(n,this.limits.minStart,this.limits.minEnd);n=a[0],r=a[1]}this.handlePos1=this.preHandlePos1=r,this.handleVal1=n,this.activeHandle=1}}else if(this.activeHandle===2&&(this.secondHandle.classList.add(me.sliderActiveHandle),!(this.limits.enabled&&this.limits.endHandleFixed)&&((this.min<this.max&&r<this.handlePos1||this.min>this.max&&r>this.handlePos1)&&(r=this.handlePos1,n=this.handleVal1),r!==this.preHandlePos2))){if(this.limits.enabled){var a=this.getLimitValueAndPosition(n,this.limits.maxStart,this.limits.maxEnd);n=a[0],r=a[1]}this.handlePos2=this.preHandlePos2=r,this.handleVal2=n,this.activeHandle=2}}this.checkRepeatedValue(n)&&(this.getHandle().style.transition=this.scaleTransform,this.type!=="Default"&&(this.rangeBar.style.transition="none"),this.setHandlePosition(t),(this.isMaterial||this.isMaterial3)&&!this.tooltip.isVisible&&!this.getHandle().classList.contains(me.sliderTabHandle)&&this.materialChange(),this.tooltipToggle(this.getHandle()),this.type!=="Default"&&this.setRangeBar())},e.prototype.dragRangeBarUp=function(t){this.rangeBarDragged?this.isDragComplete=!0:(this.focusSliderElement(),this.sliderBarClick(t)),this.changeEvent("changed",t),this.closeTooltip(),E.remove(document,"mousemove touchmove",this.dragRangeBarMove),E.remove(document,"mouseup touchend",this.dragRangeBarUp),this.rangeBarDragged=!1},e.prototype.checkRepeatedValue=function(t){if(this.type==="Range"){var i=this.enableRtl&&this.orientation!=="Vertical"?this.activeHandle===1?this.previousVal[1]:this.previousVal[0]:this.activeHandle===1?this.previousVal[0]:this.previousVal[1];if(t===i)return 0}else if(t===this.previousVal)return 0;return 1},e.prototype.refreshTooltip=function(t){this.tooltip.isVisible&&this.tooltipObj&&(this.tooltipValue(),t&&(this.tooltipObj.refresh(t),this.tooltipTarget=t))},e.prototype.openTooltip=function(t){this.tooltip.isVisible&&this.tooltipObj&&!this.isMaterialTooltip&&(this.tooltipValue(),this.tooltipObj.open(t),this.tooltipTarget=t)},e.prototype.closeTooltip=function(){this.tooltip.isVisible&&this.tooltipObj&&this.tooltip.showOn!=="Always"&&!this.isMaterialTooltip&&(this.tooltipValue(),this.tooltipObj.close(),this.tooltipTarget=void 0)},e.prototype.keyDown=function(t){switch(t.keyCode){case 37:case 38:case 39:case 40:case 33:case 34:case 36:case 35:t.preventDefault(),this.buttonClick(t);break}},e.prototype.wireButtonEvt=function(t){t?(E.remove(this.firstBtn,"mouseleave touchleave",this.buttonFocusOut),E.remove(this.secondBtn,"mouseleave touchleave",this.buttonFocusOut),E.remove(this.firstBtn,"mousedown touchstart",this.repeatHandlerMouse),E.remove(this.firstBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp),E.remove(this.secondBtn,"mousedown touchstart",this.repeatHandlerMouse),E.remove(this.secondBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp),E.remove(this.firstBtn,"focusout",this.sliderFocusOut),E.remove(this.secondBtn,"focusout",this.sliderFocusOut)):(E.add(this.firstBtn,"mouseleave touchleave",this.buttonFocusOut,this),E.add(this.secondBtn,"mouseleave touchleave",this.buttonFocusOut,this),E.add(this.firstBtn,"mousedown touchstart",this.repeatHandlerMouse,this),E.add(this.firstBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp,this),E.add(this.secondBtn,"mousedown touchstart",this.repeatHandlerMouse,this),E.add(this.secondBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp,this),E.add(this.firstBtn,"focusout",this.sliderFocusOut,this),E.add(this.secondBtn,"focusout",this.sliderFocusOut,this))},e.prototype.rangeBarMousedown=function(t){var i,r;if(t.preventDefault(),this.focusSliderElement(),this.type==="Range"&&this.drag&&t.target===this.rangeBar){var n=void 0,s=void 0;t.type==="mousedown"?(i=[t.clientX,t.clientY],n=i[0],s=i[1]):t.type==="touchstart"&&(r=[t.changedTouches[0].clientX,t.changedTouches[0].clientY],n=r[0],s=r[1]),this.orientation==="Horizontal"?(this.firstPartRemain=n-this.rangeBar.getBoundingClientRect().left,this.secondPartRemain=this.rangeBar.getBoundingClientRect().right-n):(this.firstPartRemain=s-this.rangeBar.getBoundingClientRect().top,this.secondPartRemain=this.rangeBar.getBoundingClientRect().bottom-s),this.minDiff=this.handleVal2-this.handleVal1,this.tooltipToggle(this.rangeBar);var a=this.element.querySelector("."+me.sliderTabHandle);a&&a.classList.remove(me.sliderTabHandle),E.add(document,"mousemove touchmove",this.dragRangeBarMove,this),E.add(document,"mouseup touchend",this.dragRangeBarUp,this)}},e.prototype.elementClick=function(t){if(this.isDragComplete){this.isDragComplete=!1;return}t.preventDefault(),this.focusSliderElement(),this.sliderBarClick(t),this.focusHandle()},e.prototype.wireEvents=function(){this.onresize=this.reposition.bind(this),window.addEventListener("resize",this.onresize),this.enabled&&!this.readonly&&(E.add(this.element,"click",this.elementClick,this),this.type==="Range"&&this.drag&&E.add(this.rangeBar,"mousedown touchstart",this.rangeBarMousedown,this),E.add(this.sliderContainer,"keydown",this.keyDown,this),E.add(this.sliderContainer,"keyup",this.keyUp,this),E.add(this.element,"focusout",this.sliderFocusOut,this),E.add(this.sliderContainer,"mouseover mouseout touchstart touchend",this.hover,this),this.wireFirstHandleEvt(!1),this.type==="Range"&&this.wireSecondHandleEvt(!1),this.showButtons&&this.wireButtonEvt(!1),this.wireMaterialTooltipEvent(!1),this.isForm&&E.add(this.formElement,"reset",this.formResetHandler,this))},e.prototype.unwireEvents=function(){E.remove(this.element,"click",this.elementClick),this.type==="Range"&&this.drag&&E.remove(this.rangeBar,"mousedown touchstart",this.rangeBarMousedown),E.remove(this.sliderContainer,"keydown",this.keyDown),E.remove(this.sliderContainer,"keyup",this.keyUp),E.remove(this.element,"focusout",this.sliderFocusOut),E.remove(this.sliderContainer,"mouseover mouseout touchstart touchend",this.hover),this.wireFirstHandleEvt(!0),this.type==="Range"&&this.wireSecondHandleEvt(!0),this.showButtons&&this.wireButtonEvt(!0),this.wireMaterialTooltipEvent(!0),E.remove(this.element,"reset",this.formResetHandler)},e.prototype.formResetHandler=function(){this.setProperties({value:this.formResetValue},!0),this.setValue()},e.prototype.keyUp=function(t){if(t.keyCode===9&&t.target.classList.contains(me.sliderHandle)&&(this.focusSliderElement(),!t.target.classList.contains(me.sliderTabHandle))){this.element.querySelector("."+me.sliderTabHandle)&&this.element.querySelector("."+me.sliderTabHandle).classList.remove(me.sliderTabHandle),t.target.classList.add(me.sliderTabHandle);var i=t.target.parentElement;if(i===this.element&&(i.querySelector("."+me.sliderTrack).classList.add(me.sliderTabTrack),(this.type==="Range"||this.type==="MinRange")&&i.querySelector("."+me.rangeBar).classList.add(me.sliderTabRange)),this.type==="Range"){var r=t.target.previousSibling;r&&r.classList.contains(me.sliderHandle)?this.activeHandle=2:this.activeHandle=1}this.getHandle().focus(),this.tooltipToggle(this.getHandle())}this.closeTooltip(),this.changeEvent("changed",t)},e.prototype.hover=function(t){if(!g(t))if(t.type==="mouseover"||t.type==="touchmove"||t.type==="mousemove"||t.type==="pointermove"||t.type==="touchstart")this.sliderContainer.classList.add(me.sliderHover);else{this.sliderContainer.classList.remove(me.sliderHover);var i=t.currentTarget;this.tooltip.isVisible&&this.tooltip.showOn!=="Always"&&this.tooltipObj&&this.isMaterialTooltip&&!i.classList.contains(me.sliderHandleFocused)&&!i.classList.contains(me.sliderTabHandle)&&this.closeMaterialTooltip()}},e.prototype.sliderFocusOut=function(t){t.relatedTarget!==this.secondHandle&&t.relatedTarget!==this.firstHandle&&t.relatedTarget!==this.element&&t.relatedTarget!==this.firstBtn&&t.relatedTarget!==this.secondBtn&&(this.closeMaterialTooltip(),this.closeTooltip(),this.element.querySelector("."+me.sliderTabHandle)&&this.element.querySelector("."+me.sliderTabHandle).classList.remove(me.sliderTabHandle),this.element.querySelector("."+me.sliderTabTrack)&&(this.element.querySelector("."+me.sliderTabTrack).classList.remove(me.sliderTabTrack),(this.type==="Range"||this.type==="MinRange")&&this.element.querySelector("."+me.sliderTabRange)&&this.element.querySelector("."+me.sliderTabRange).classList.remove(me.sliderTabRange)),this.hiddenInput.focus(),this.hiddenInput.blur(),this.isElementFocused=!1)},e.prototype.removeElement=function(t){t.parentNode&&t.parentNode.removeChild(t)},e.prototype.changeSliderType=function(t,i){this.isMaterialTooltip&&this.materialHandle&&(this.sliderContainer.classList.remove(me.materialSlider),this.removeElement(this.materialHandle),this.materialHandle=void 0),this.removeElement(this.firstHandle),this.firstHandle=void 0,t!=="Default"&&(t==="Range"&&(this.removeElement(this.secondHandle),this.secondHandle=void 0),this.removeElement(this.rangeBar),this.rangeBar=void 0),this.tooltip.isVisible&&!g(this.tooltipObj)&&(this.tooltipObj.destroy(),this.tooltipElement=void 0,this.tooltipCollidedPosition=void 0),this.limits.enabled&&(t==="MinRange"||t==="Default"?g(this.limitBarFirst)||(this.removeElement(this.limitBarFirst),this.limitBarFirst=void 0):g(this.limitBarSecond)||(this.removeElement(this.limitBarSecond),this.limitBarSecond=void 0)),this.activeHandle=1,this.getThemeInitialization(),this.type==="Range"&&this.rangeValueUpdate(),this.createRangeBar(),this.limits.enabled&&this.createLimitBar(),this.setHandler(),this.setOrientClass(),this.wireFirstHandleEvt(!this.enabled),this.type==="Range"&&this.wireSecondHandleEvt(!this.enabled),this.setValue(),this.tooltip.isVisible&&(this.renderTooltip(),this.wireMaterialTooltipEvent(!1)),this.setBarColor(),i!=="tooltip"&&this.updateConfig(),this.readonly&&(this.sliderContainer.classList.remove(me.readonly),this.setReadOnly())},e.prototype.changeRtl=function(){if(!this.enableRtl&&this.type==="Range"&&(this.value=[this.handleVal2,this.handleVal1]),this.updateConfig(),this.tooltip.isVisible&&this.tooltipObj.refresh(this.firstHandle),this.showButtons){var t=this.enableRtl&&this.orientation!=="Vertical";Ie(t?this.secondBtn:this.firstBtn,{"aria-label":"Decrease",title:"Decrease"}),Ie(t?this.firstBtn:this.secondBtn,{"aria-label":"Increase",title:"Increase"})}},e.prototype.changeOrientation=function(){this.changeSliderType(this.type,"null")},e.prototype.updateConfig=function(){this.setEnableRTL(),this.setValue(),this.tooltip.isVisible&&this.refreshTooltip(this.tooltipTarget),this.ticks.placement!=="None"&&this.ul&&(this.removeElement(this.ul),this.ul=void 0,this.renderScale()),this.limitsPropertyChange()},e.prototype.limitsPropertyChange=function(){this.limits.enabled?(g(this.limitBarFirst)&&this.type!=="Range"&&this.createLimitBar(),g(this.limitBarFirst)&&g(this.limitBarSecond)&&this.type==="Range"&&this.createLimitBar(),this.setLimitBar(),this.setValue()):(g(this.limitBarFirst)||ee(this.limitBarFirst),g(this.limitBarSecond)||ee(this.limitBarSecond))},e.prototype.getPersistData=function(){var t=["value"];return this.addOnPersist(t)},e.prototype.destroy=function(){o.prototype.destroy.call(this),this.unwireEvents(),window.removeEventListener("resize",this.onresize),K([this.sliderContainer],[me.sliderDisabled]),this.firstHandle.removeAttribute("aria-orientation"),this.type==="Range"&&this.secondHandle.removeAttribute("aria-orientation"),this.sliderContainer.parentNode&&this.sliderContainer.parentNode.insertBefore(this.element,this.sliderContainer),ee(this.sliderContainer),this.tooltip.isVisible&&this.tooltipObj.destroy(),this.element.innerHTML="",this.hiddenInput=null,this.sliderContainer=null,this.sliderTrack=null,this.rangeBar=null,this.firstHandle=null,this.secondHandle=null,this.tickElementCollection=null,this.ul=null,this.firstBtn=null,this.secondBtn=null,this.materialHandle=null,this.tooltipObj=null,this.tooltipTarget=null,this.limitBarFirst=null,this.limitBarSecond=null,this.firstChild=null,this.lastChild=null,this.tooltipElement=null},e.prototype.onPropertyChanged=function(t,i){for(var r=this,n=0,s=Object.keys(t);n<s.length;n++){var a=s[n];switch(a){case"cssClass":this.setCSSClass(i.cssClass);break;case"value":if(t&&i){var l=g(t.value)?this.type==="Range"?[this.min,this.max]:this.min:t.value;this.setProperties({value:l},!0),!g(i.value)&&i.value.toString()!==l.toString()&&(this.setValue(),this.refreshTooltip(this.tooltipTarget),this.type==="Range"&&(g(t.value)||i.value[1]===l[1]?this.activeHandle=1:this.activeHandle=2))}break;case"min":case"step":case"max":this.setMinMaxValue();break;case"tooltip":!g(t.tooltip)&&!g(i.tooltip)&&(this.initialTooltip=!0,this.setTooltip(a),this.showButtons||this.wireEvents());break;case"type":!g(i)&&Object.keys(i).length&&!g(i.type)&&(this.changeSliderType(i.type,a),this.setZindex());break;case"enableRtl":i.enableRtl!==t.enableRtl&&this.orientation!=="Vertical"&&(this.rtl=i.enableRtl,this.changeRtl());break;case"limits":this.limitsPropertyChange();break;case"orientation":this.changeOrientation();break;case"ticks":g(this.sliderContainer.querySelector("."+me.scale))||(ee(this.ul),Array.prototype.forEach.call(this.sliderContainer.classList,function(h){h.match(/e-scale-/)&&r.sliderContainer.classList.remove(h)})),this.ticks.placement!=="None"&&(this.renderScale(),this.setZindex());break;case"locale":this.showButtons&&this.buttonTitle();break;case"showButtons":t.showButtons?(this.setButtons(),this.reposition(),this.enabled&&!this.readonly&&this.wireButtonEvt(!1)):this.firstBtn&&this.secondBtn&&(this.sliderContainer.removeChild(this.firstBtn),this.sliderContainer.removeChild(this.secondBtn),this.sliderContainer.classList.remove(me.sliderButtonClass),this.firstBtn=void 0,this.secondBtn=void 0,this.reposition());break;case"enabled":this.setEnabled();break;case"readonly":this.setReadOnly();break;case"customValues":this.setValue(),this.reposition();break;case"colorRange":this.reposition();break;case"width":this.setElementWidth(t.width),this.setMinMaxValue(),this.limits&&this.limitsPropertyChange();break}}},e.prototype.setReadOnly=function(){this.readonly?(this.unwireEvents(),this.sliderContainer.classList.add(me.readonly)):(this.wireEvents(),this.sliderContainer.classList.remove(me.readonly))},e.prototype.setMinMaxValue=function(){var t=this;this.setValue(),this.refreshTooltip(this.tooltipTarget),g(this.sliderContainer.querySelector("."+me.scale))||this.ul&&(ee(this.ul),Array.prototype.forEach.call(this.sliderContainer.classList,function(i){i.match(/e-scale-/)&&t.sliderContainer.classList.remove(i)})),this.ticks.placement!=="None"&&(this.renderScale(),this.setZindex())},e.prototype.setZindex=function(){this.zIndex=6,!g(this.ticks)&&this.ticks.placement!=="None"&&!g(this.ul)&&!g(this.element)&&(this.ul.style.zIndex=this.zIndex+-7+"",this.element.style.zIndex=this.zIndex+2+""),!this.isMaterial&&!this.isMaterial3&&!g(this.ticks)&&this.ticks.placement==="Both"&&(this.element.style.zIndex=this.zIndex+2+""),g(this.firstHandle)||(this.firstHandle.style.zIndex=this.zIndex+3+""),this.type==="Range"&&!g(this.secondHandle)&&(this.secondHandle.style.zIndex=this.zIndex+4+"")},e.prototype.setTooltip=function(t){this.changeSliderType(this.type,t)},e.prototype.setBarColor=function(){for(var t,i,r=this.sliderTrack.lastElementChild;r;)this.sliderTrack.removeChild(r),r=this.sliderTrack.lastElementChild;for(var n=0;n<this.colorRange.length;n++)if(!g(this.colorRange[n].start)&&!g(this.colorRange[n].end)&&this.colorRange[n].end>this.colorRange[n].start){this.colorRange[n].start<this.min&&(this.colorRange[n].start=this.min),this.colorRange[n].end>this.max&&(this.colorRange[n].end=this.max);var s=this.checkHandlePosition(this.colorRange[n].start),a=this.checkHandlePosition(this.colorRange[n].end),l=this.createElement("div");l.style.backgroundColor=this.colorRange[n].color,l.style.border="1px solid "+this.colorRange[n].color,this.orientation==="Horizontal"?(i=me.sliderHorizantalColor,this.enableRtl?g(this.customValues)?t=this.checkHandlePosition(this.max)-this.checkHandlePosition(this.colorRange[n].end):t=this.checkHandlePosition(this.customValues.length-this.colorRange[n].end-1):t=this.checkHandlePosition(this.colorRange[n].start),l.style.width=a-s+"px",l.style.left=t+"px"):(i=me.sliderVerticalColor,t=this.checkHandlePosition(this.colorRange[n].start),l.style.height=a-s+"px",l.style.bottom=t+"px"),l.classList.add(i),this.sliderTrack.appendChild(l)}},e.prototype.getModuleName=function(){return"slider"},zt([C(null)],e.prototype,"value",void 0),zt([C(null)],e.prototype,"customValues",void 0),zt([C(1)],e.prototype,"step",void 0),zt([C(null)],e.prototype,"width",void 0),zt([C(0)],e.prototype,"min",void 0),zt([C(100)],e.prototype,"max",void 0),zt([C(!1)],e.prototype,"readonly",void 0),zt([C("Default")],e.prototype,"type",void 0),zt([Wt([{}],AH)],e.prototype,"colorRange",void 0),zt([be({},EH)],e.prototype,"ticks",void 0),zt([be({},TH)],e.prototype,"limits",void 0),zt([C(!0)],e.prototype,"enabled",void 0),zt([be({},LH)],e.prototype,"tooltip",void 0),zt([C(!1)],e.prototype,"showButtons",void 0),zt([C(!0)],e.prototype,"enableAnimation",void 0),zt([C("Horizontal")],e.prototype,"orientation",void 0),zt([C("")],e.prototype,"cssClass",void 0),zt([C(!0)],e.prototype,"enableHtmlSanitizer",void 0),zt([q()],e.prototype,"created",void 0),zt([q()],e.prototype,"change",void 0),zt([q()],e.prototype,"changed",void 0),zt([q()],e.prototype,"renderingTicks",void 0),zt([q()],e.prototype,"renderedTicks",void 0),zt([q()],e.prototype,"tooltipChange",void 0),e=zt([bt],e),e}(Kt),FH=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Fn=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},pc={EMAIL:new RegExp("^[A-Za-z0-9._%+-]{1,}@[A-Za-z0-9._%+-]{1,}([.]{1}[a-zA-Z0-9]{2,}|[.]{1}[a-zA-Z0-9]{2,4}[.]{1}[a-zA-Z0-9]{2,4})$"),URL:/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/m,DATE_ISO:new RegExp("^([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$"),DIGITS:new RegExp("^[0-9]*$"),PHONE:new RegExp("^[+]?[0-9]{9,13}$"),CREDITCARD:new RegExp("^\\d{13,16}$")},VC=function(o){return o[o.Message=0]="Message",o[o.Label=1]="Label",o}(VC||{}),_C=function(o){FH(e,o);function e(i,r){var n=o.call(this,r,i)||this;if(n.validated=[],n.errorRules=[],n.allowSubmit=!1,n.required="required",n.infoElement=null,n.inputElement=null,n.selectQuery="input:not([type=reset]):not([type=button]), select, textarea",n.localyMessage={},n.defaultMessages={required:"This field is required.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateIso:"Please enter a valid date ( ISO ).",creditcard:"Please enter valid card number",number:"Please enter a valid number.",digits:"Please enter only digits.",maxLength:"Please enter no more than {0} characters.",minLength:"Please enter at least {0} characters.",rangeLength:"Please enter a value between {0} and {1} characters long.",range:"Please enter a value between {0} and {1}.",max:"Please enter a value less than or equal to {0}.",min:"Please enter a value greater than or equal to {0}.",regex:"Please enter a correct value.",tel:"Please enter a valid phone number.",pattern:"Please enter a correct pattern value.",equalTo:"Please enter the valid match text"},typeof n.rules>"u"&&(n.rules={}),n.l10n=new Li("formValidator",n.defaultMessages,n.locale),n.locale&&n.localeFunc(),tc.on("notifyExternalChange",n.afterLocalization,n),i=typeof i=="string"?X(i,document):i,n.element!=null)n.element.setAttribute("novalidate",""),n.inputElements=Oe(n.selectQuery,n.element),n.createHTML5Rules(),n.wireEvents();else return;return n}t=e,e.prototype.addRules=function(i,r){i&&(this.rules.hasOwnProperty(i)?he(this.rules[""+i],r,{}):this.rules[""+i]=r)},e.prototype.removeRules=function(i,r){if(!i&&!r)this.rules={};else if(this.rules[""+i]&&!r)delete this.rules[""+i];else{if(g(this.rules[""+i]&&r))return;for(var n=0;n<r.length;n++)delete this.rules[""+i][r[parseInt(n.toString(),10)]]}},e.prototype.validate=function(i){var r=Object.keys(this.rules);if(i&&r.length)return this.validateRules(i),r.indexOf(i)!==-1&&this.errorRules.filter(function(l){return l.name===i}).length===0;this.errorRules=[];for(var n=0,s=r;n<s.length;n++){var a=s[n];this.validateRules(a)}return this.errorRules.length===0},e.prototype.reset=function(){this.element.reset(),this.clearForm()},e.prototype.getInputElement=function(i){return this.inputElement=X('[name="'+i+'"]',this.element),this.inputElement},e.prototype.destroy=function(){this.reset(),this.unwireEvents(),this.rules={};for(var i=Oe("."+this.errorClass+", ."+this.validClass,this.element),r=0,n=i;r<n.length;r++){var s=n[r];ee(s)}o.prototype.destroy.call(this),this.infoElement=null,tc.off("notifyExternalChange",this.afterLocalization)},e.prototype.onPropertyChanged=function(i,r){for(var n=0,s=Object.keys(i);n<s.length;n++){var a=s[n];switch(a){case"locale":this.localeFunc();break}}},e.prototype.localeFunc=function(){for(var i=0,r=Object.keys(this.defaultMessages);i<r.length;i++){var n=r[i];this.l10n.setLocale(this.locale);var s=this.l10n.getConstant(n);this.localyMessage[""+n]=s}},e.prototype.getModuleName=function(){return"formvalidator"},e.prototype.afterLocalization=function(i){this.locale=i.locale,this.localeFunc()},e.prototype.refresh=function(){this.unwireEvents(),this.inputElements=Oe(this.selectQuery,this.element),this.wireEvents()},e.prototype.clearForm=function(){this.errorRules=[],this.validated=[];for(var i=Oe(this.selectQuery,this.element),r=0,n=i;r<n.length;r++){var s=n[r],a=s;a.removeAttribute("aria-invalid");var l=a.parentElement,h=l.parentElement;l.classList.contains("e-control-wrapper")||l.classList.contains("e-wrapper")||a.classList.contains("e-input")&&l.classList.contains("e-input-group")?l.classList.remove(this.errorClass):h!=null&&(h.classList.contains("e-control-wrapper")||h.classList.contains("e-wrapper"))?h.classList.remove(this.errorClass):a.classList.remove(this.errorClass),a.name.length>0&&(this.getInputElement(a.name),this.getErrorElement(a.name),this.hideMessage(a.name)),l.classList.contains("e-control-wrapper")||l.classList.contains("e-wrapper")||a.classList.contains("e-input")&&l.classList.contains("e-input-group")?l.classList.remove(this.validClass):h!=null&&(h.classList.contains("e-control-wrapper")||h.classList.contains("e-wrapper"))?h.classList.remove(this.validClass):a.classList.remove(this.validClass)}},e.prototype.createHTML5Rules=function(){for(var i=["required","validateHidden","regex","rangeLength","maxLength","minLength","dateIso","digits","pattern","data-val-required","type","data-validation","min","max","range","equalTo","data-val-minlength-min","data-val-equalto-other","data-val-maxlength-max","data-val-range-min","data-val-regex-pattern","data-val-length-max","data-val-creditcard","data-val-phone"],r=["hidden","email","url","date","number","tel"],n=0,s=this.inputElements;n<s.length;n++){for(var a=s[n],l={},h=0,u=i;h<u.length;h++){var c=u[h];if(a.getAttribute(c)!==null)switch(c){case"required":this.defRule(a,l,c,a.required);break;case"data-validation":c=a.getAttribute(c),this.defRule(a,l,c,!0);break;case"type":r.indexOf(a.type)!==-1&&this.defRule(a,l,a.type,!0);break;case"rangeLength":case"range":this.defRule(a,l,c,JSON.parse(a.getAttribute(c)));break;case"equalTo":{var d=a.getAttribute(c);this.defRule(a,l,c,d)}break;default:a.getAttribute("data-val")==="true"?this.annotationRule(a,l,c,a.getAttribute(c)):this.defRule(a,l,c,a.getAttribute(c))}}Object.keys(l).length!==0&&this.addRules(a.name,l)}},e.prototype.annotationRule=function(i,r,n,s){var a=n.split("-"),l=["required","creditcard","phone","maxlength","minlength","range","regex","equalto"],h=a[a.length-1],u=a[a.length-2];if(l.indexOf(h)!==-1)switch(h){case"required":this.defRule(i,r,"required",s);break;case"creditcard":this.defRule(i,r,"creditcard",s);break;case"phone":this.defRule(i,r,"tel",s);break}else if(l.indexOf(u)!==-1)switch(u){case"maxlength":this.defRule(i,r,"maxLength",s);break;case"minlength":this.defRule(i,r,"minLength",s);break;case"range":{var c=i.getAttribute("data-val-range-min"),d=i.getAttribute("data-val-range-max");this.defRule(i,r,"range",[c,d])}break;case"equalto":{var p=i.getAttribute(n).split(".");this.defRule(i,r,"equalTo",p[p.length-1])}break;case"regex":this.defRule(i,r,"regex",s);break}},e.prototype.defRule=function(i,r,n,s){var a=i.getAttribute("data-"+n+"-message"),l=i.getAttribute("data-val-"+n),h;this.rules[i.name]&&n!=="validateHidden"&&n!=="hidden"&&(this.getInputElement(i.name),h=this.getErrorMessage(this.rules[i.name][""+n],n)),a?s=[s,a]:l?s=[s,l]:h&&(s=[s,h]),r[""+n]=s},e.prototype.wireEvents=function(){for(var i=0,r=this.inputElements;i<r.length;i++){var n=r[i];t.isCheckable(n)?E.add(n,"click",this.clickHandler,this):n.tagName==="SELECT"?E.add(n,"change",this.changeHandler,this):(E.add(n,"focusout",this.focusOutHandler,this),E.add(n,"keyup",this.keyUpHandler,this))}E.add(this.element,"submit",this.submitHandler,this),E.add(this.element,"reset",this.resetHandler,this)},e.prototype.unwireEvents=function(){for(var i=0,r=this.inputElements;i<r.length;i++){var n=r[i];E.clearEvents(n)}E.remove(this.element,"submit",this.submitHandler),E.remove(this.element,"reset",this.resetHandler)},e.prototype.focusOutHandler=function(i){this.trigger("focusout",i);var r=i.target;this.rules[r.name]&&(this.rules[r.name][this.required]||r.value.length>0?this.validate(r.name):this.validated.indexOf(r.name)===-1&&this.validated.push(r.name))},e.prototype.keyUpHandler=function(i){this.trigger("keyup",i);var r=i.target,n=[16,17,18,20,35,36,37,38,39,40,45,144,225];i.which===9&&(!this.rules[r.name]||this.rules[r.name]&&!this.rules[r.name][this.required])||this.validated.indexOf(r.name)!==-1&&this.rules[r.name]&&n.indexOf(i.which)===-1&&this.validate(r.name)},e.prototype.clickHandler=function(i){this.trigger("click",i);var r=i.target;r.type!=="submit"?this.validate(r.name):r.getAttribute("formnovalidate")!==null&&(this.allowSubmit=!0)},e.prototype.changeHandler=function(i){this.trigger("change",i);var r=i.target;this.validate(r.name)},e.prototype.submitHandler=function(i){this.trigger("submit",i),!this.allowSubmit&&!this.validate()?i.preventDefault():this.allowSubmit=!1},e.prototype.resetHandler=function(){this.clearForm()},e.prototype.validateRules=function(i){if(this.rules[""+i]){var r=Object.keys(this.rules[""+i]),n=!1,s=!1,a=r.indexOf("validateHidden"),l=r.indexOf("hidden");if(this.getInputElement(i),l!==-1&&(n=!0),a!==-1&&(s=!0),!n||n&&s){a!==-1&&r.splice(a,1),l!==-1&&r.splice(l-1,1),this.getErrorElement(i);for(var h=0,u=r;h<u.length;h++){var c=u[h],d=this.getErrorMessage(this.rules[""+i][""+c],c),p={name:i,message:d},f={inputName:i,element:this.inputElement,message:d};if(!this.isValid(i,c)&&!this.inputElement.classList.contains(this.ignore)){this.removeErrorRules(i),this.errorRules.push(p),this.inputElement.setAttribute("aria-invalid","true"),this.inputElement.setAttribute("aria-describedby",this.inputElement.id+"-info");var v=this.inputElement.parentElement,m=v.parentElement;v.classList.contains("e-control-wrapper")||v.classList.contains("e-wrapper")||this.inputElement.classList.contains("e-input")&&v.classList.contains("e-input-group")?(v.classList.add(this.errorClass),v.classList.remove(this.validClass)):m!=null&&(m.classList.contains("e-control-wrapper")||m.classList.contains("e-wrapper"))?(m.classList.add(this.errorClass),m.classList.remove(this.validClass)):(this.inputElement.classList.add(this.errorClass),this.inputElement.classList.remove(this.validClass)),this.infoElement?this.showMessage(p):this.createErrorElement(i,p.message,this.inputElement),f.errorElement=this.infoElement,f.status="failure",v.classList.contains("e-control-wrapper")||v.classList.contains("e-wrapper")||this.inputElement.classList.contains("e-input")&&v.classList.contains("e-input-group")?(v.classList.add(this.errorClass),v.classList.remove(this.validClass)):m!=null&&(m.classList.contains("e-control-wrapper")||m.classList.contains("e-wrapper"))?(m.classList.add(this.errorClass),m.classList.remove(this.validClass)):(this.inputElement.classList.add(this.errorClass),this.inputElement.classList.remove(this.validClass)),this.optionalValidationStatus(i,f),this.trigger("validationComplete",f),c==="required"&&this.inputElement.setAttribute("aria-required","true");break}else this.hideMessage(i),f.status="success",this.trigger("validationComplete",f)}}else return}},e.prototype.optionalValidationStatus=function(i,r){!this.rules[""+i][this.required]&&!this.inputElement.value.length&&!g(this.infoElement)&&(this.infoElement.innerHTML=this.inputElement.value,this.infoElement.setAttribute("aria-invalid","false"),r.status="",this.hideMessage(i))},e.prototype.isValid=function(i,r){var n=this.rules[""+i][""+r],s=n instanceof Array&&typeof n[1]=="string"?n[0]:n,a=this.rules[""+i][""+r],l=(r==="min"||r==="max")&&this.rules[""+i].date&&typeof this.rules[""+i].date=="string"?this.rules[""+i].date:null,h={value:this.inputElement.value,param:s,element:this.inputElement,formElement:this.element,format:l,culture:this.locale};if(this.trigger("validationBegin",h),!h.param&&r==="required")return!0;if(a&&typeof a[0]=="function"){var u=a[0];return u.call(this,{element:this.inputElement,value:this.inputElement.value})}else return t.isCheckable(this.inputElement)?r!=="required"?!0:Oe('input[name="'+i+'"]:checked',this.element).length>0:t.checkValidator[""+r](h)},e.prototype.getErrorMessage=function(i,r){var n=this.inputElement.getAttribute("data-"+r+"-message")?this.inputElement.getAttribute("data-"+r+"-message"):i instanceof Array&&typeof i[1]=="string"?i[1]:Object.keys(this.localyMessage).length!==0?this.localyMessage[""+r]:this.defaultMessages[""+r],s=n.match(/{(\d)}/g);if(!g(s))for(var a=0;a<s.length;a++){var l=i instanceof Array?i[parseInt(a.toString(),10)]:i;n=n.replace(s[parseInt(a.toString(),10)],l)}return n},e.prototype.createErrorElement=function(i,r,n){var s=Xe(this.errorElement,{className:this.errorClass,innerHTML:r,attrs:{for:i}});if(this.errorOption===VC.Message&&(s.classList.remove(this.errorClass),s.classList.add("e-message"),s=Xe(this.errorContainer,{className:this.errorClass,innerHTML:s.outerHTML})),s.id=this.inputElement.name+"-info",this.element.querySelector('[data-valmsg-for="'+n.id+'"]'))this.element.querySelector('[data-valmsg-for="'+n.id+'"]').appendChild(s);else if(n.hasAttribute("data-msg-containerid")===!0){var a=n.getAttribute("data-msg-containerid"),l=X("#"+a,this.element);l.appendChild(s)}else if(this.customPlacement!=null)this.customPlacement.call(this,this.inputElement,s);else{var h=this.inputElement.parentElement,u=h.parentElement;h.classList.contains("e-control-wrapper")||h.classList.contains("e-wrapper")?u.insertBefore(s,h.nextSibling):u.classList.contains("e-control-wrapper")||u.classList.contains("e-wrapper")?u.parentElement.insertBefore(s,u.nextSibling):h.insertBefore(s,this.inputElement.nextSibling)}s.style.display="block",this.getErrorElement(i),this.validated.push(i),this.checkRequired(i)},e.prototype.getErrorElement=function(i){return this.infoElement=X(this.errorElement+"."+this.errorClass,this.inputElement.parentElement),this.infoElement||(this.infoElement=X(this.errorElement+"."+this.errorClass+'[for="'+i+'"]',this.element)),this.infoElement},e.prototype.removeErrorRules=function(i){for(var r=0;r<this.errorRules.length;r++){var n=this.errorRules[parseInt(r.toString(),10)];n.name===i&&this.errorRules.splice(r,1)}},e.prototype.showMessage=function(i){this.infoElement.style.display="block",this.infoElement.innerHTML=i.message,this.checkRequired(i.name)},e.prototype.hideMessage=function(i){if(this.infoElement){this.infoElement.style.display="none",this.removeErrorRules(i);var r=this.inputElement.parentElement,n=r.parentElement;r.classList.contains("e-control-wrapper")||r.classList.contains("e-wrapper")||this.inputElement.classList.contains("e-input")&&r.classList.contains("e-input-group")?(r.classList.add(this.validClass),r.classList.remove(this.errorClass)):n!=null&&(n.classList.contains("e-control-wrapper")||n.classList.contains("e-wrapper"))?(n.classList.add(this.validClass),n.classList.remove(this.errorClass)):(this.inputElement.classList.add(this.validClass),this.inputElement.classList.remove(this.errorClass)),this.inputElement.setAttribute("aria-invalid","false")}},e.prototype.checkRequired=function(i){!this.rules[""+i][this.required]&&!this.inputElement.value.length&&!g(this.infoElement)&&(this.infoElement.innerHTML=this.inputElement.value,this.infoElement.setAttribute("aria-invalid","false"),this.hideMessage(i))},e.isCheckable=function(i){var r=i.getAttribute("type");return r&&(r==="checkbox"||r==="radio"||r==="submit")};var t;return e.checkValidator={required:function(i){return isNaN(Date.parse(i.value))?i.value.toString().length>0:!isNaN(new Date(i.value).getTime())},email:function(i){return pc.EMAIL.test(i.value)},url:function(i){return pc.URL.test(i.value)},dateIso:function(i){return pc.DATE_ISO.test(i.value)},tel:function(i){return pc.PHONE.test(i.value)},creditcard:function(i){return pc.CREDITCARD.test(i.value)},number:function(i){return!isNaN(Number(i.value))&&String(i.value).indexOf(" ")===-1},digits:function(i){return pc.DIGITS.test(i.value)},maxLength:function(i){return i.value.length<=Number(i.param)},minLength:function(i){return i.value.length>=Number(i.param)},rangeLength:function(i){var r=i.param;return i.value.length>=r[0]&&i.value.length<=r[1]},range:function(i){var r=i.param;return!isNaN(Number(i.value))&&Number(i.value)>=r[0]&&Number(i.value)<=r[1]},date:function(i){if(!g(i.param)&&typeof i.param=="string"&&i.param!==""){var r=i.culture&&i.culture!==""?new Et(i.culture):new Et,n={format:i.param.toString(),type:"dateTime",skeleton:"yMd"},s=r.parseDate(i.value,n);return!g(s)&&s instanceof Date&&!isNaN(+s)}else return!isNaN(new Date(i.value).getTime())},max:function(i){if(!isNaN(Number(i.value)))return+i.value<=+i.param;if(i.format&&i.format!==""){var r=i.culture&&i.culture!==""?new Et(i.culture):new Et,n={format:i.format.toString(),type:"dateTime",skeleton:"yMd"},s=r.parseDate(i.value,n),a=typeof i.param=="string"?r.parseDate(JSON.parse(JSON.stringify(i.param)),n):i.param;return new Date(s).getTime()<=new Date(a).getTime()}else return new Date(i.value).getTime()<=new Date(JSON.parse(JSON.stringify(i.param))).getTime()},min:function(i){if(isNaN(Number(i.value)))if(i.value.indexOf(",")!==-1){var r=i.value.replace(/,/g,"");return parseFloat(r)>=Number(i.param)}else if(i.format&&i.format!==""){var n=i.culture&&i.culture!==""?new Et(i.culture):new Et,s={format:i.format.toString(),type:"dateTime",skeleton:"yMd"},a=n.parseDate(i.value,s),l=typeof i.param=="string"?n.parseDate(JSON.parse(JSON.stringify(i.param)),s):i.param;return new Date(a).getTime()>=new Date(l).getTime()}else return new Date(i.value).getTime()>=new Date(JSON.parse(JSON.stringify(i.param))).getTime();else return+i.value>=+i.param},regex:function(i){return new RegExp(i.param).test(i.value)},equalTo:function(i){var r=i.formElement.querySelector("#"+i.param);return i.param=r.value,i.param===i.value}},Fn([C("")],e.prototype,"locale",void 0),Fn([C("e-hidden")],e.prototype,"ignore",void 0),Fn([C()],e.prototype,"rules",void 0),Fn([C("e-error")],e.prototype,"errorClass",void 0),Fn([C("e-valid")],e.prototype,"validClass",void 0),Fn([C("label")],e.prototype,"errorElement",void 0),Fn([C("div")],e.prototype,"errorContainer",void 0),Fn([C(VC.Label)],e.prototype,"errorOption",void 0),Fn([q()],e.prototype,"focusout",void 0),Fn([q()],e.prototype,"keyup",void 0),Fn([q()],e.prototype,"click",void 0),Fn([q()],e.prototype,"change",void 0),Fn([q()],e.prototype,"submit",void 0),Fn([q()],e.prototype,"validationBegin",void 0),Fn([q()],e.prototype,"validationComplete",void 0),Fn([q()],e.prototype,"customPlacement",void 0),e=t=Fn([bt],e),e}($s);var OH=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Cr=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},wp="e-apply",fv="e-cancel",OC="e-current",RH="e-container",xp="e-ctrl-btn",fc="e-switch-ctrl-btn",iL="e-disabled",rL="e-value-switch-btn",nL="e-handler",sL="e-hex",RC="e-hide-hex-value",PC="e-hide-opacity",gc="e-hide-switchable-value",Th="e-hide-value",aL="e-hide-valueswitcher",Ip="e-hsv-color",oL="e-hsv-container",vc="e-selected-value",gv="e-mode-switch-btn",BC="e-nocolor-item",zC="e-opacity-value",Mp="e-palette",vv="e-color-palette",jC="e-color-picker",mv="e-preview-container",yv="e-previous",PH="e-rtl",mc="e-show-value",Dp="e-selected",bv="e-split-preview",Sv="e-tile",BH={default:["#000000","#f44336","#e91e63","#9c27b0","#673ab7","#2196f3","#03a9f4","#00bcd4","#009688","#ffeb3b","#ffffff","#ffebee","#fce4ec","#f3e5f5","#ede7f6","#e3f2fd","#e1f5fe","#e0f7fa","#e0f2f1","#fffde7","#f2f2f2","#ffcdd2","#f8bbd0","#e1bee7","#d1c4e9","#bbdefb","#b3e5fc","#b2ebf2","#b2dfdb","#fff9c4","#e6e6e6","#ef9a9a","#f48fb1","#ce93d8","#b39ddb","#90caf9","#81d4fa","#80deea","#80cbc4","#fff59d","#cccccc","#e57373","#f06292","#ba68c8","#9575cd","#64b5f6","#4fc3f7","#4dd0e1","#4db6ac","#fff176","#b3b3b3","#ef5350","#ec407a","#ab47bc","#7e57c2","#42a5f5","#29b6f6","#26c6da","#26a69a","#ffee58","#999999","#e53935","#d81b60","#8e24aa","#5e35b1","#1e88e5","#039be5","#00acc1","#00897b","#fdd835","#808080","#d32f2f","#c2185b","#7b1fa2","#512da8","#1976d2","#0288d1","#0097a7","#00796b","#fbc02d","#666666","#c62828","#ad1457","#6a1b9a","#4527a0","#1565c0","#0277bd","#00838f","#00695c","#f9a825","#4d4d4d","#b71c1c","#880e4f","#4a148c","#311b92","#0d47a1","#01579b","#006064","#004d40","#f57f17"]},Cv=function(o){OH(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.recentColors=[],r}return e.prototype.preRender=function(){var t=this.element;this.formElement=j(this.element,"form"),this.formElement&&E.add(this.formElement,"reset",this.formResetHandler,this);var i={Apply:"Apply",Cancel:"Cancel",ModeSwitcher:"Switch Mode",RecentColors:"Recent colors"};this.l10n=new Li("colorpicker",i,this.locale),t.getAttribute("ejs-for")&&!t.getAttribute("name")&&t.setAttribute("name",t.id)},e.prototype.render=function(){this.initWrapper(),this.inline?this.createWidget():this.createSplitBtn(),this.enableOpacity||Y([this.container.parentElement],PC),this.renderComplete()},e.prototype.initWrapper=function(){var t=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"});this.element.parentNode.insertBefore(t,this.element),t.appendChild(this.element),Ie(this.element,{tabindex:"-1",spellcheck:"false","aria-label":"colorpicker"}),this.container=this.createElement("div",{className:RH}),this.getWrapper().appendChild(this.container);var i=this.value?this.roundValue(this.value).toLowerCase():"#008000ff";this.noColor&&this.mode==="Palette"&&this.value===""&&(i="");var r=i.slice(0,7);g(this.initialInputValue)&&(this.initialInputValue=r),this.element.value=r,this.enableOpacity?this.setProperties({value:i},!0):this.setProperties({value:r},!0),this.enableRtl&&t.classList.add(PH),this.cssClass&&Y([t],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.tileRipple=Vi(this.container,{selector:"."+Sv}),this.ctrlBtnRipple=Vi(this.container,{selector:".e-btn"})},e.prototype.getWrapper=function(){return this.element.parentElement},e.prototype.createWidget=function(){this.mode==="Palette"?(this.createPalette(),this.inline||this.firstPaletteFocus()):(this.createPicker(),this.inline||this.getDragHandler().focus()),this.isRgb=!0,this.createInput(),this.createCtrlBtn(),this.disabled||this.wireEvents(),this.inline&&this.disabled&&this.toggleDisabled(!0),B.isDevice&&this.refreshPopupPos()},e.prototype.createSplitBtn=function(){var t=this,i=this.createElement("button",{className:"e-split-colorpicker"});this.getWrapper().appendChild(i),this.splitBtn=new Sp({iconCss:"e-selected-color",target:this.container,disabled:this.disabled,enableRtl:this.enableRtl,createPopupOnClick:this.createPopupOnClick,open:this.onOpen.bind(this),click:function(){var a=new MouseEvent("click",{bubbles:!0,cancelable:!1});t.trigger("change",{currentValue:{hex:t.value.slice(0,7),rgba:t.convertToRgbString(t.hexToRgb(t.value))},previousValue:{hex:null,rgba:null},value:t.value,event:a})}}),this.splitBtn.createElement=this.createElement,this.splitBtn.appendTo(i),this.splitBtn.element.setAttribute("aria-label","colorpicker");var r=this.createElement("span",{className:bv});X(".e-selected-color",i).appendChild(r),r.style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value));var n=this.getPopupEle();if(Y([n],"e-colorpicker-popup"),this.cssClass&&Y([n],this.cssClass.replace(/\s+/g," ").trim().split(" ")),B.isDevice&&!this.createPopupOnClick){var s=this.getPopupInst();s.relateTo=document.body,s.position={X:"center",Y:"center"},s.targetType="container",s.collision={X:"fit",Y:"fit"},s.offsetY=4,n.style.zIndex=Fs(this.splitBtn.element).toString()}this.bindCallBackEvent()},e.prototype.onOpen=function(){if(this.trigger("open",{element:this.container}),!B.isDevice){var t=this.getPopupInst(),i=is(t.element);i.length>0&&(t.collision={X:"flip",Y:"fit"},t.position={X:"right",Y:"bottom"},t.targetType="container")}},e.prototype.getPopupInst=function(){return fr(this.getPopupEle(),Gn)},e.prototype.bindCallBackEvent=function(){var t=this;this.splitBtn.beforeOpen=function(i){var r=new bp;return t.trigger("beforeOpen",i,function(n){if(!n.cancel){var s=t.getPopupEle();if(s.style.top=Le(0+pageYOffset),s.style.left=Le(0+pageXOffset),s.style.display="block",t.createWidget(),s.style.display="",B.isDevice){if(t.createPopupOnClick){var a=t.getPopupInst();a.relateTo=document.body,a.position={X:"center",Y:"center"},a.targetType="container",a.collision={X:"fit",Y:"fit"},a.offsetY=4,s.style.zIndex=Fs(t.splitBtn.element).toString()}t.modal=t.createElement("div"),t.modal.className="e-"+t.getModuleName()+" e-modal",t.modal.style.display="none",document.body.insertBefore(t.modal,s),document.body.className+=" e-colorpicker-overflow",t.modal.style.display="block",t.modal.style.zIndex=(Number(s.style.zIndex)-1).toString()}}i.cancel=n.cancel,r.resolve(n)}),r},this.splitBtn.beforeClose=function(i){var r=new bp;if(g(i.event))r.resolve(i);else{var n={element:t.container,event:i.event,cancel:!1};t.trigger("beforeClose",n,function(s){B.isDevice&&i.event.target===t.modal&&(s.cancel=!0),s.cancel||t.onPopupClose(),i.cancel=s.cancel,r.resolve(s)})}return r}},e.prototype.onPopupClose=function(){this.unWireEvents(),this.destroyOtherComp(),this.container.style.width="",X("."+bv,this.splitBtn.element).style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value)),this.container.innerHTML="",K([this.container],[jC,vv]),B.isDevice&&this.modal&&(K([document.body],"e-colorpicker-overflow"),this.modal.style.display="none",this.modal.outerHTML="",this.modal=null)},e.prototype.createPalette=function(){if(wi(this.container,[vv],[jC]),this.presetColors){var t=this.createElement("div",{className:"e-custom-palette"});this.appendElement(t);var i=Object.keys(this.presetColors);if(i.length===1)this.appendPalette(this.presetColors[i[0]],i[0],t);else for(var r=0,n=i.length;r<n;r++)this.appendPalette(this.presetColors[i[r]],i[r],t);Oe(".e-row",t).length>10&&Y([t],"e-palette-group")}else this.appendPalette(BH.default,"default");this.mode==="Palette"&&!this.modeSwitcher&&this.noColor&&this.setNoColor(),this.showRecentColors&&this.recentColors&&this.recentColors.length>0&&this.renderRecentColor();var s=parseInt(getComputedStyle(this.container).borderBottomWidth,10);this.container.style.width=Le(this.container.children[0].offsetWidth+s+s),this.rgb=this.hexToRgb(this.roundValue(this.value)),this.hsv=this.rgbToHsv.apply(this,this.rgb)},e.prototype.renderRecentColor=function(){var t=this,i=this.container.querySelector(".e-clr-pal-rec-wpr");i&&ee(i);var r=this.createElement("div",{className:"e-clr-pal-rec-wpr"}),n=this.container.querySelector(".e-switch-ctrl-btn");n?this.container.insertBefore(r,n):this.container.appendChild(r);var s=this.createElement("label",{className:"e-recent-clr-span"});if(s.textContent=this.l10n.getConstant("RecentColors"),r.appendChild(s),this.recentColors.length>0){for(this.recentColors=this.recentColors.filter(function(a,l){return t.recentColors.indexOf(a)===l});this.recentColors.length>10;)this.recentColors.pop();this.appendPalette(this.recentColors,"recent-color",r)}},e.prototype.firstPaletteFocus=function(){X("."+Dp,this.container.children[0])||Oe("."+Mp,this.container)[0].focus()},e.prototype.appendPalette=function(t,i,r){var n=this.createElement("div",{className:Mp,attrs:{tabindex:"0",role:"grid"}});i==="recent-color"&&n.classList.add("e-recent-palette"),r?r.appendChild(n):this.appendElement(n);for(var s,a,l,h=0,u=t.length;h<u;h++)(h===0||h%this.columns===0)&&(s=this.createElement("div",{className:"e-row",attrs:{role:"row"}}),n.appendChild(s)),l=this.roundValue(t[h]).toLowerCase(),a=this.createElement("span",{className:Sv,attrs:{role:"gridcell","aria-label":l,"aria-selected":"false"}}),this.trigger("beforeTileRender",{element:a,presetName:i,value:t[h]}),s.appendChild(a),this.value===l&&i!=="recent-color"&&(this.addTileSelection(a),n.focus()),a.style.backgroundColor=this.convertToRgbString(this.hexToRgb(l))},e.prototype.setNoColor=function(){var t=this.container.querySelector(".e-row").children[0];t.classList.add(BC),this.value||(t.classList.add(Dp),j(t,"."+Mp).focus()),["aria-selected","aria-label"].forEach(function(i){t.removeAttribute(i)}),t.style.backgroundColor=""},e.prototype.appendElement=function(t,i){i===void 0&&(i=0);var r=this.container.children[i];r?this.container.insertBefore(t,r):this.container.appendChild(t)},e.prototype.addTileSelection=function(t){t&&(t.classList.add(Dp),t.setAttribute("aria-selected","true"))},e.prototype.createPicker=function(){wi(this.container,[jC],[vv]);var t=this.createElement("div",{className:oL});this.appendElement(t),t.appendChild(this.createElement("div",{className:Ip}));var i=this.createElement("span",{className:nL,attrs:{tabindex:"0"}});t.appendChild(i),(this.value===null||this.value==="")&&(this.value="#008000ff"),this.rgb=this.hexToRgb(this.value),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.setHsvContainerBg(),this.setHandlerPosition(),this.createSlider(),this.createDragTooltip()},e.prototype.setHsvContainerBg=function(t){t===void 0&&(t=this.hsv[0]),this.getHsvContainer().style.backgroundColor=this.convertToRgbString(this.hsvToRgb(t,100,100,1))},e.prototype.getHsvContainer=function(){return X("."+oL,this.container)},e.prototype.setHandlerPosition=function(){var t=this.getDragHandler(),i=X("."+Ip,this.container);this.enableRtl?t.style.left=Le((i.offsetWidth-t.offsetWidth/2.5)*Math.abs(100-this.hsv[1])/100):t.style.left=Le((i.offsetWidth-t.offsetWidth/2.5)*this.hsv[1]/100),t.style.top=Le((i.offsetHeight-t.offsetHeight/2.5)*(100-this.hsv[2])/100)},e.prototype.createSlider=function(){var t=this.createElement("div",{className:"e-slider-preview"});this.appendElement(t,1),this.createPreview(t);var i=this.createElement("div",{className:"e-colorpicker-slider"});t.insertBefore(i,t.children[0]);var r=this.createElement("div",{className:"e-hue-slider"});i.appendChild(r),this.hueSlider=new tL({value:this.hsv[0],min:0,max:359,enableRtl:this.enableRtl,enabled:!this.disabled,change:this.hueChange.bind(this)}),this.hueSlider.createElement=this.createElement,this.hueSlider.appendTo(r),this.enableOpacity&&(r=this.createElement("div",{className:"e-opacity-slider"}),i.appendChild(r),this.createOpacitySlider(r))},e.prototype.createOpacitySlider=function(t){this.opacitySlider=new tL({value:this.rgb[3]*100,min:0,max:100,enableRtl:this.enableRtl,enabled:!this.disabled,change:this.opacityChange.bind(this)}),this.opacitySlider.createElement=this.createElement,this.opacitySlider.appendTo(t);var i=this.createElement("div",{className:"e-opacity-empty-track"});t.appendChild(i),this.updateOpacitySliderBg()},e.prototype.updateOpacitySliderBg=function(){var t=this.enableRtl?"to left":"to right",i=X(".e-opacity-empty-track",this.opacitySlider.element);i&&(i.style.background="linear-gradient("+t+", rgba("+this.rgb.slice(0,3)+", 0) 0%, "+this.convertToRgbString(this.rgb.slice(0,3))+" 100%)")},e.prototype.hueChange=function(t){this.hsv[0]=t.value,this.setHsvContainerBg(),this.convertToOtherFormat()},e.prototype.opacityChange=function(t){var i=t.value,r=this.rgbToHex(this.rgb);this.hsv[3]=i/100,this.rgb[3]=i/100;var n=this.rgbToHex(this.rgb);this.updateOpacityInput(i);var s=this.convertToRgbString(this.rgb);this.updatePreview(s),this.triggerEvent(n,r,s)},e.prototype.updateOpacityInput=function(t){if(this.enableOpacity&&!this.getWrapper().classList.contains(Th)){var i=fr(X("."+zC,this.container),ia);i.value=t,i.dataBind()}},e.prototype.createPreview=function(t){var i=this.createElement("div",{className:mv});t.appendChild(i);var r=this.createElement("span",{className:"e-preview "+OC});i.appendChild(r);var n=this.convertToRgbString(this.rgb);r.style.backgroundColor=n,r=this.createElement("span",{className:"e-preview "+yv}),i.appendChild(r),r.style.backgroundColor=n},e.prototype.isPicker=function(){return!this.container.classList.contains(vv)},e.prototype.getPopupEle=function(){return this.container.parentElement},e.prototype.createNumericInput=function(t,i,r,n){var s=this,a=new ia({value:i,placeholder:r,min:0,max:n,format:"###.##",showSpinButton:!1,floatLabelType:"Always",enableRtl:this.enableRtl,enabled:!this.disabled,readonly:!this.isPicker(),change:function(l){l.event&&s.inputHandler(l.event)}});a.createElement=this.createElement,a.appendTo(t)},e.prototype.createInput=function(){var t=this.isPicker(),i=this.getWrapper();if(t&&!i.classList.contains(Th)||!t&&i.classList.contains(mc)){var r=this.createElement("div",{className:vc});t?this.appendElement(r,2):this.appendElement(r,1);var n=this.createElement("div",{className:"e-input-container"});if(r.appendChild(n),i.classList.contains(aL)||this.appendValueSwitchBtn(r),!i.classList.contains(RC)){var s=this.createElement("input",{className:sL,attrs:{maxlength:"7",spellcheck:"false","aria-label":"HEX"}});n.appendChild(s),Ce.createInput({element:s,floatLabelType:"Always",properties:{placeholder:"HEX",enableRtl:this.enableRtl,enabled:!this.disabled,readonly:!this.isPicker()}},this.createElement),Ce.setValue(this.value.slice(0,7),s),s.addEventListener("input",this.inputHandler.bind(this))}if(!i.classList.contains(gc)){var a=void 0,l=void 0;this.isRgb?(a="RGB",l=this.rgb):(a="HSV",l=this.hsv);for(var h=["rh","gs","bv"],u=0;u<3;u++)this.createNumericInput(n.appendChild(this.createElement("input",{className:"e-"+h[u]+"-value"})),l[u],a[u],255);this.enableOpacity&&this.appendOpacityValue(n)}}},e.prototype.appendOpacityValue=function(t){this.createNumericInput(t.appendChild(this.createElement("input",{className:zC})),this.rgb[3]*100,"A",100)},e.prototype.appendValueSwitchBtn=function(t){var i=this.createElement("button",{className:"e-icons e-css e-btn e-flat e-icon-btn "+rL,attrs:{title:"Toggle format"}});t.appendChild(i),this.isPicker()&&!this.getWrapper().classList.contains(gc)&&i.addEventListener("click",this.formatSwitchHandler.bind(this))},e.prototype.createCtrlBtn=function(){if(this.modeSwitcher||this.showButtons){this.l10n.setLocale(this.locale);var t=this.createElement("div",{className:fc});if(this.container.appendChild(t),this.showButtons){var i=this.createElement("div",{className:xp});t.appendChild(i);var r=this.l10n.getConstant("Apply");i.appendChild(this.createElement("button",{innerHTML:r,className:"e-btn e-css e-flat e-primary e-small "+wp,attrs:{title:r}}));var n=this.l10n.getConstant("Cancel");i.appendChild(this.createElement("button",{innerHTML:n,className:"e-btn e-css e-flat e-small "+fv,attrs:{title:n}}))}this.modeSwitcher&&this.appendModeSwitchBtn()}},e.prototype.appendModeSwitchBtn=function(){var t=this.createElement("button",{className:"e-icons e-btn e-flat e-icon-btn "+gv,attrs:{title:this.l10n.getConstant("ModeSwitcher")}});X("."+fc,this.container).insertBefore(t,X("."+xp,this.container))},e.prototype.createDragTooltip=function(){var t=this,i=new Ol({opensOn:"Custom",showTipPointer:!1,cssClass:"e-color-picker-tooltip",htmlAttributes:{title:"tooltip"},beforeOpen:function(r){t.tooltipEle=r.element},animation:{open:{effect:"None"},close:{effect:"None"}}});i.createElement=this.createElement,i.appendTo(this.container),i.open(this.container),this.tooltipEle.style.zIndex=Fs(this.tooltipEle).toString(),this.tooltipEle.setAttribute("aria-label","colorpicker-tooltip"),X(".e-tip-content",this.tooltipEle).appendChild(this.createElement("div",{className:"e-tip-transparent"}))},e.prototype.getTooltipInst=function(){return fr(this.container,Ol)},e.prototype.setTooltipOffset=function(t){this.getTooltipInst().offsetY=t},e.prototype.toggleDisabled=function(t){t?this.getWrapper().classList.add(iL):this.getWrapper().classList.remove(iL),this.showButtons&&[].slice.call(Oe(".e-btn",this.container)).forEach(function(i){t?Ie(i,{disabled:""}):i.removeAttribute("disabled")})},e.prototype.convertToRgbString=function(t){return t.length?t.length===4?"rgba("+t.join()+")":"rgb("+t.join()+")":""},e.prototype.convertToHsvString=function(t){return t.length===4?"hsva("+t.join()+")":"hsv("+t.join()+")"},e.prototype.updateHsv=function(){this.hsv[1]=this.hsv[1]>100?100:this.hsv[1],this.hsv[2]=this.hsv[2]>100?100:this.hsv[2],this.setHandlerPosition()},e.prototype.convertToOtherFormat=function(t,i){t===void 0&&(t=!1);var r=this.rgbToHex(this.rgb);this.rgb=this.hsvToRgb.apply(this,this.hsv);var n=this.rgbToHex(this.rgb),s=this.convertToRgbString(this.rgb);this.updatePreview(s),this.updateInput(n),this.triggerEvent(n,r,s,t,i)},e.prototype.updateInput=function(t){var i=this.getWrapper();i.classList.contains(Th)||(i.classList.contains(RC)||Ce.setValue(t.substr(0,7),X("."+sL,this.container)),i.classList.contains(gc)||(this.isRgb?this.updateValue(this.rgb,!1):this.updateValue(this.hsv,!1)))},e.prototype.updatePreview=function(t){this.enableOpacity&&this.updateOpacitySliderBg(),X(".e-tip-transparent",this.tooltipEle).style.backgroundColor=t,X("."+mv+" ."+OC,this.container).style.backgroundColor=t,X("."+mv+" ."+yv,this.container).style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value))},e.prototype.getDragHandler=function(){return X("."+nL,this.container)},e.prototype.removeTileSelection=function(){var t=[].slice.call(Oe("."+Dp,this.container));t.forEach(function(i){i.classList.remove(Dp),i.setAttribute("aria-selected","false")})},e.prototype.convertRgbToNumberArray=function(t){return t.slice(t.indexOf("(")+1,t.indexOf(")")).split(",").map(function(i,r){return r!==3?parseInt(i,10):parseFloat(i)})},e.prototype.getValue=function(t,i){if(t||(t=this.value),i=i?i.toLowerCase():"hex",t[0]==="r"){var r=this.convertRgbToNumberArray(t);if(i==="hex"||i==="hexa"){var n=this.rgbToHex(r);return i==="hex"?n.slice(0,7):n}else return i==="hsv"?this.convertToHsvString(this.rgbToHsv.apply(this,r.slice(0,3))):i==="hsva"?this.convertToHsvString(this.rgbToHsv.apply(this,r)):"null"}else if(t[0]==="h"){var r=this.hsvToRgb.apply(this,this.convertRgbToNumberArray(t));if(i==="rgba")return this.convertToRgbString(r);if(i==="hex"||i==="hexa"){var n=this.rgbToHex(r);return i==="hex"?n.slice(0,7):n}else return i==="rgb"?this.convertToRgbString(r.slice(0,3)):"null"}else{t=this.roundValue(t);var s=this.hexToRgb(t);return(i==="rgb"||i==="hsv")&&(s=s.slice(0,3)),i==="rgba"||i==="rgb"?this.convertToRgbString(s):i==="hsva"||i==="hsv"?this.convertToHsvString(this.rgbToHsv.apply(this,s)):i==="hex"?t.slice(0,7):i==="a"?s[3].toString():"null"}},e.prototype.toggle=function(){this.container.parentElement.classList.contains("e-popup-close")?this.splitBtn.toggle():this.closePopup(null)},e.prototype.getModuleName=function(){return"colorpicker"},e.prototype.getPersistData=function(){return this.addOnPersist(["value"])},e.prototype.wireEvents=function(){if(this.isPicker()){var t=this.getDragHandler();E.add(t,"keydown",this.pickerKeyDown,this);var i=X("."+xp,this.container);i&&E.add(i,"keydown",this.ctrlBtnKeyDown,this),E.add(this.getHsvContainer(),"mousedown touchstart",this.handlerDown,this),(this.modeSwitcher||this.showButtons)&&this.addCtrlSwitchEvent(),E.add(X("."+yv,this.container),"click",this.previewHandler,this)}else E.add(this.container,"click",this.paletteClickHandler,this),E.add(this.container,"keydown",this.paletteKeyDown,this)},e.prototype.formResetHandler=function(){this.value=this.initialInputValue,Ie(this.element,{value:this.initialInputValue})},e.prototype.addCtrlSwitchEvent=function(){var t=X("."+fc,this.container);t&&E.add(t,"click",this.btnClickHandler,this)},e.prototype.ctrlBtnKeyDown=function(t){if(t.keyCode===13){var i=X("."+wp,this.container);if(i){var r=this.rgbToHex(this.rgb);this.triggerChangeEvent(r)}this.splitBtn.element.focus()}},e.prototype.pickerKeyDown=function(t){switch(t.keyCode){case 39:this.handlerDragPosition(1,this.enableRtl?-1:1,t);break;case 37:this.handlerDragPosition(1,this.enableRtl?1:-1,t);break;case 38:this.handlerDragPosition(2,1,t);break;case 40:this.handlerDragPosition(2,-1,t);break;case 13:{t.preventDefault();var i=this.rgbToHex(this.rgb);this.enterKeyHandler(i)}}},e.prototype.enterKeyHandler=function(t){this.triggerChangeEvent(t),this.inline||this.splitBtn.element.focus()},e.prototype.closePopup=function(t){var i=this,r={element:this.container,event:t,cancel:!1};this.trigger("beforeClose",r,function(n){n.cancel||(i.splitBtn.toggle(),i.onPopupClose())})},e.prototype.triggerChangeEvent=function(t,i){var r=t.slice(0,7);this.trigger("change",{currentValue:{hex:r,rgba:this.convertToRgbString(this.rgb)},event:i,previousValue:{hex:this.value.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(this.value))},value:this.enableOpacity?t:r}),this.showRecentColors&&(this.recentColors.unshift(r),this.inline&&this.renderRecentColor()),this.enableOpacity?this.setProperties({value:t},!0):this.setProperties({value:r},!0),this.element.value=r||"#000000"},e.prototype.handlerDragPosition=function(t,i,r){r.preventDefault(),this.hsv[t]+=i*(r.ctrlKey?1:3),this.hsv[t]<0&&(this.hsv[t]=0),this.updateHsv(),this.convertToOtherFormat(!0,r)},e.prototype.handlerDown=function(t){t.preventDefault(),t.type==="mousedown"?(this.clientX=Math.abs(t.pageX-pageXOffset),this.clientY=Math.abs(t.pageY-pageYOffset),this.setTooltipOffset(8)):(this.clientX=Math.abs(t.changedTouches[0].pageX-pageXOffset),this.clientY=Math.abs(t.changedTouches[0].pageY-pageYOffset),this.setTooltipOffset(-8)),this.setHsv(this.clientX,this.clientY),this.getDragHandler().style.transition="left .4s cubic-bezier(.25, .8, .25, 1), top .4s cubic-bezier(.25, .8, .25, 1)",this.updateHsv(),this.convertToOtherFormat(!1,t),this.getDragHandler().focus(),E.add(document,"mousemove touchmove",this.handlerMove,this),E.add(document,"mouseup touchend",this.handlerEnd,this)},e.prototype.handlerMove=function(t){t.type!=="touchmove"&&t.preventDefault();var i,r;t.type==="mousemove"?(i=Math.abs(t.pageX-pageXOffset),r=Math.abs(t.pageY-pageYOffset)):(i=Math.abs(t.changedTouches[0].pageX-pageXOffset),r=Math.abs(t.changedTouches[0].pageY-pageYOffset)),this.setHsv(i,r);var n=this.getDragHandler();this.updateHsv(),this.convertToOtherFormat(!1,t),this.getTooltipInst().refresh(n),this.tooltipEle.style.transform||(Math.abs(this.clientX-i)>8||Math.abs(this.clientY-r)>8)&&(X("."+Ip,this.container).style.cursor="pointer",n.style.transition="none",this.inline||(this.tooltipEle.style.zIndex=(parseInt(this.getPopupEle().style.zIndex,10)+1).toString()),this.tooltipEle.style.transform="rotate(45deg)",n.classList.add("e-hide-handler"))},e.prototype.setHsv=function(t,i){var r=X("."+Ip,this.container),n=r.getBoundingClientRect();this.enableRtl?t=t>n.right?0:Math.abs(t-n.right):t=t>n.left?Math.abs(t-n.left):0,i=i>n.top?Math.abs(i-n.top):0,this.hsv[2]=Math.round(Number(100*(r.offsetHeight-Math.max(0,Math.min(r.offsetHeight,i-r.offsetTop)))/r.offsetHeight)*10)/10,this.hsv[1]=Math.round(Number(100*Math.max(0,Math.min(r.offsetWidth,t-r.offsetLeft))/r.offsetWidth)*10)/10},e.prototype.handlerEnd=function(t){t.type!=="touchend"&&t.preventDefault(),E.remove(document,"mousemove touchmove",this.handlerMove),E.remove(document,"mouseup touchend",this.handlerEnd);var i=this.getDragHandler();X("."+Ip,this.container).style.cursor="",this.tooltipEle.style.transform&&(this.tooltipEle.style.transform="",i.classList.remove("e-hide-handler")),!this.inline&&!this.showButtons&&this.closePopup(t)},e.prototype.btnClickHandler=function(t){var i=t.target;j(i,"."+gv)?(t.stopPropagation(),this.switchToPalette()):(i.classList.contains(wp)||i.classList.contains(fv))&&this.ctrlBtnClick(i,t)},e.prototype.switchToPalette=function(){this.trigger("beforeModeSwitch",{element:this.container,mode:"Palette"}),this.unWireEvents(),this.destroyOtherComp(),ee(X(".e-slider-preview",this.container)),this.getWrapper().classList.contains(Th)||Ue(X("."+vc,this.container)),ee(this.getHsvContainer()),this.createPalette(),this.firstPaletteFocus(),this.createInput(),this.refreshPopupPos(),this.element.parentElement&&this.element.parentElement.parentElement&&this.element.parentElement.parentElement.classList.contains("e-ie-ddb-popup")&&this.refreshImageEditorPopupPos(),this.wireEvents(),this.trigger("onModeSwitch",{element:this.container,mode:"Palette"})},e.prototype.refreshImageEditorPopupPos=function(){if(B.isDevice){var t=this.getPopupEle();t.style.left=Le(0+pageXOffset),t.style.top=Le(0+pageYOffset);var i=document.querySelector("#"+this.element.parentElement.parentElement.id.split("-popup")[0]);i&&t.parentElement.ej2_instances[0].refreshPosition(i)}},e.prototype.refreshPopupPos=function(){if(!this.inline){var t=this.getPopupEle();t.style.left=Le(0+pageXOffset),t.style.top=Le(0+pageYOffset),this.getPopupInst().refreshPosition(this.splitBtn.element.parentElement)}},e.prototype.formatSwitchHandler=function(){this.isRgb?(this.updateValue(this.hsv,!0,3,[360,100,100]),this.isRgb=!1):(this.updateValue(this.rgb,!0,2),this.isRgb=!0)},e.prototype.updateValue=function(t,i,r,n){for(var s=["e-rh-value","e-gs-value","e-bv-value"],a,l=0,h=s.length;l<h;l++)a=fr(X("."+s[l],this.container),ia),a.value=Math.round(t[l]),i&&(a.placeholder=s[l].substr(r,1).toUpperCase(),a.max=n?n[l]:255),a.dataBind()},e.prototype.previewHandler=function(t){var i=t.target,r=this.rgbToHex(this.rgb);this.rgb=this.convertRgbToNumberArray(i.style.backgroundColor),this.rgb[3]||(this.rgb[3]=1);var n=this.rgbToHex(this.rgb),s=this.rgbToHsv.apply(this,this.rgb);s[0]!==this.hsv[0]&&(this.hueSlider.setProperties({value:s[0]},!0),this.hueSlider.refresh()),this.setHsvContainerBg(s[0]),this.enableOpacity&&s[3]!==this.hsv[3]&&(this.opacitySlider.setProperties({value:s[3]*100},!0),this.opacitySlider.refresh(),this.updateOpacitySliderBg()),this.hsv=s,this.setHandlerPosition(),this.updateInput(n),X("."+mv+" ."+OC,this.container).style.backgroundColor=this.convertToRgbString(this.rgb),this.triggerEvent(n,r,this.convertToRgbString(this.rgb),!1,t)},e.prototype.paletteClickHandler=function(t){t.preventDefault();var i=t.target;if(i.classList.contains(Sv)){if(this.removeTileSelection(),this.addTileSelection(i),i.classList.contains(BC))this.noColorTile();else{var r=i.getAttribute("aria-label"),n=this.rgbToHex(this.rgb);this.rgb=this.hexToRgb(this.roundValue(r)),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.getWrapper().classList.contains(mc)&&this.updateInput(r),this.triggerEvent(r,n,this.convertToRgbString(this.rgb),!1,t)}!this.inline&&!this.showButtons&&this.closePopup(t)}else j(i,"."+gv)?this.switchToPicker():i.classList.contains(wp)||i.classList.contains(fv)?this.ctrlBtnClick(i,t):this.getWrapper().classList.contains(mc)&&j(i,"."+rL)&&this.formatSwitchHandler()},e.prototype.noColorTile=function(t){t===void 0&&(t=!1);var i=this.rgbToHex(this.rgb);this.rgb=[],this.hsv=[],this.triggerEvent("",i,"",t)},e.prototype.switchToPicker=function(){var t=this.getWrapper();this.trigger("beforeModeSwitch",{element:this.container,mode:"Picker"}),this.unWireEvents(),[].slice.call(Oe("."+Mp,this.container)).forEach(function(r){ee(r)}),this.container.querySelector(".e-clr-pal-rec-wpr")&&ee(this.container.querySelector(".e-clr-pal-rec-wpr")),t.classList.contains(mc)&&ee(X("."+vc,this.container)),this.container.style.width="";var i=X(".e-custom-palette",this.container);this.presetColors&&Ue(i),this.createPicker(),this.getDragHandler().focus(),this.createInput(),this.refreshPopupPos(),this.element.parentElement&&this.element.parentElement.parentElement&&this.element.parentElement.parentElement.classList.contains("e-ie-ddb-popup")&&this.refreshImageEditorPopupPos(),this.wireEvents(),this.trigger("onModeSwitch",{element:this.container,mode:"Picker"})},e.prototype.ctrlBtnClick=function(t,i){if(t.classList.contains(wp)){var r=this.rgbToHex(this.rgb);this.triggerChangeEvent(r,i)}if(!this.inline)this.closePopup(i),this.splitBtn.element.focus();else if(t.classList.contains(fv)){var n={element:this.container,event:i,cancel:!1};this.trigger("beforeClose",n)}},e.prototype.paletteKeyDown=function(t){var i=t.target;if(i.classList.contains(Mp)){var r,n,s=[].slice.call(Oe("."+Sv,i)),a=s.filter(function(h){return h.classList.contains("e-selected")}).pop();switch(!t.altKey&&t.keyCode){case 39:t.preventDefault(),r=a?s[this.tilePosition(s,a,this.enableRtl?-1:1)]:s[this.enableRtl?s.length-1:0],this.keySelectionChanges(r);break;case 37:t.preventDefault(),r=a?s[this.tilePosition(s,a,this.enableRtl?1:-1)]:s[this.enableRtl?0:s.length-1],this.keySelectionChanges(r);break;case 38:t.preventDefault(),n=a?this.tilePosition(s,a,-this.columns):0,r=s[n]?s[n]:s[n-this.columns],this.keySelectionChanges(r);break;case 40:t.preventDefault(),n=a?this.tilePosition(s,a,this.columns):s.length-1,s[n]||(n%=s.length,n+=s[s.length-1].parentElement.childElementCount),r=s[n],this.keySelectionChanges(r);break;case 13:if(t.preventDefault(),a){var l=a.getAttribute("aria-label");this.enterKeyHandler(l||"")}break}}},e.prototype.keySelectionChanges=function(t){if(this.removeTileSelection(),this.addTileSelection(t),t.classList.contains(BC))this.noColorTile(!0);else{var i=t.getAttribute("aria-label"),r=this.rgbToHex(this.rgb);this.rgb=this.hexToRgb(i),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.getWrapper().classList.contains(mc)&&this.updateInput(i),this.triggerEvent(i,r,this.convertToRgbString(this.rgb),!0)}},e.prototype.tilePosition=function(t,i,r){t=Array.prototype.slice.call(t);var n=t.length,s=this.columns-t[n-1].parentElement.childElementCount,a=t.indexOf(i);return a+=r,a<0?a+=n+s:a%=n+s,a},e.prototype.inputHandler=function(t){var i=t.target;if(i.value.length){var r,n,s=X(".e-float-text",i.parentElement).textContent;switch(s){case"HEX":{var a="";if((i.value[0]==="#"&&i.value.length!==5||i.value[0]!=="#"&&i.value.length!==4)&&(a=this.roundValue(i.value)),a.length===9)n=this.rgbToHex(this.rgb),this.rgb=this.hexToRgb(a+a.substr(-2)),this.inputValueChange(this.rgbToHsv.apply(this,this.rgb),n,i.value,t);else return;break}case"R":this.rgb[0]!==Number(i.value)&&(n=this.rgbToHex(this.rgb),this.rgb[0]=Number(i.value),r=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(r,n,null,t));break;case"G":this.rgb[1]!==Number(i.value)&&(n=this.rgbToHex(this.rgb),this.rgb[1]=Number(i.value),r=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(r,n,null,t));break;case"B":this.rgb[2]!==Number(i.value)&&(n=this.rgbToHex(this.rgb),this.rgb[2]=Number(i.value),r=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(r,n,null,t));break;case"H":this.hueSlider.value=Number(i.value);break;case"S":this.hsv[1]!==Number(i.value)&&(this.hsv[1]=Number(i.value),this.updateHsv(),this.convertToOtherFormat(!1,t));break;case"V":this.hsv[2]!==Number(i.value)&&(this.hsv[2]=Number(i.value),this.updateHsv(),this.convertToOtherFormat(!1,t));break;case"A":this.opacitySlider.value=Number(i.value);break}}},e.prototype.inputValueChange=function(t,i,r,n){t[0]!==this.hsv[0]&&(this.hueSlider.setProperties({value:t[0]},!0),this.hueSlider.refresh(),this.setHsvContainerBg(t[0])),this.hsv=t;var s=this.rgbToHex(this.rgb);this.setHandlerPosition(),this.updateInput(r||s);var a=this.convertToRgbString(this.rgb);this.updatePreview(a),this.triggerEvent(s,i,a,!1,n)},e.prototype.triggerEvent=function(t,i,r,n,s){n===void 0&&(n=!1);var a=t.slice(0,7);g(s)&&(s=new MouseEvent("click",{bubbles:!0,cancelable:!1})),!this.showButtons&&!n?(this.trigger("change",{currentValue:{hex:a,rgba:r},event:s,previousValue:{hex:this.value.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(this.value))},value:t}),this.showRecentColors&&(this.recentColors.unshift(a),this.inline&&this.renderRecentColor()),this.enableOpacity?this.setProperties({value:t},!0):this.setProperties({value:a},!0),this.element.value=a||"#000000"):this.trigger("select",{currentValue:{hex:a,rgba:r},event:s,previousValue:{hex:i.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(i))}})},e.prototype.destroy=function(){var t=this,i=this.getWrapper();o.prototype.destroy.call(this),["tabindex","spellcheck"].forEach(function(r){t.element.removeAttribute(r)}),this.inline?(this.unWireEvents(),this.destroyOtherComp()):(this.isPopupOpen()&&(this.unWireEvents(),this.destroyOtherComp()),this.splitBtn.destroy(),this.splitBtn=null),this.tileRipple(),this.tileRipple=null,this.ctrlBtnRipple(),this.ctrlBtnRipple=null,this.element.nextElementSibling&&ee(this.element.nextElementSibling),i&&(i.parentElement.insertBefore(this.element,i),ee(i)),this.container=null,this.formElement&&E.remove(this.formElement,"reset",this.formResetHandler)},e.prototype.destroyOtherComp=function(){if(this.isPicker()){for(var t=j(this.hueSlider.element,".e-color-picker"),i=t.querySelectorAll(".e-numerictextbox"),r=0;r<i.length;r++)fr(i[r],ia).destroy();this.hueSlider.destroy(),this.enableOpacity&&(this.opacitySlider.destroy(),this.opacitySlider=null),this.hueSlider=null;var n=this.getTooltipInst();n.close(),n.destroy(),this.tooltipEle=null}},e.prototype.isPopupOpen=function(){return this.getPopupEle().classList.contains("e-popup-open")},e.prototype.unWireEvents=function(){if(this.isPicker()){var t=this.getDragHandler();E.remove(t,"keydown",this.pickerKeyDown);var i=X("."+xp,this.container);i&&E.remove(i,"keydown",this.ctrlBtnKeyDown),E.remove(this.getHsvContainer(),"mousedown touchstart",this.handlerDown),(this.modeSwitcher||this.showButtons)&&E.remove(X("."+fc,this.container),"click",this.btnClickHandler),E.remove(X("."+yv,this.container),"click",this.previewHandler)}else E.remove(this.container,"click",this.paletteClickHandler),E.remove(this.container,"keydown",this.paletteKeyDown)},e.prototype.roundValue=function(t){if(!t)return"";t[0]!=="#"&&(t="#"+t);var i=t.length;if(i===4&&(t+="f",i=5),i===5){for(var r="",n=1,s=t.length;n<s;n++)r+=t.charAt(n)+t.charAt(n);t="#"+r,i=9}return i===7&&(t+="ff"),t},e.prototype.hexToRgb=function(t){if(!t)return[];t=t.trim(),t.length!==9&&(t=this.roundValue(t));var i=Number((parseInt(t.slice(-2),16)/255).toFixed(2));t=t.slice(1,7);var r=parseInt(t,16),n=[];return n.push(r>>16&255),n.push(r>>8&255),n.push(r&255),n.push(i),n},e.prototype.rgbToHsv=function(t,i,r,n){if(this.rgb&&!this.rgb.length)return[];t/=255,i/=255,r/=255;var s=Math.max(t,i,r),a=Math.min(t,i,r),l,h=s,u=s-a,c=s===0?0:u/s;if(s===a)l=0;else{switch(s){case t:l=(i-r)/u+(i<r?6:0);break;case i:l=(r-t)/u+2;break;case r:l=(t-i)/u+4;break}l/=6}var d=[Math.round(l*360),Math.round(c*1e3)/10,Math.round(h*1e3)/10];return g(n)||d.push(n),d},e.prototype.hsvToRgb=function(t,i,r,n){var s,a,l;if(i/=100,r/=100,i===0)return s=a=l=r,[Math.round(s*255),Math.round(a*255),Math.round(l*255),n];t/=60;var h=Math.floor(t),u=t-h,c=r*(1-i),d=r*(1-i*u),p=r*(1-i*(1-u));switch(h){case 0:s=r,a=p,l=c;break;case 1:s=d,a=r,l=c;break;case 2:s=c,a=r,l=p;break;case 3:s=c,a=d,l=r;break;case 4:s=p,a=c,l=r;break;default:s=r,a=c,l=d}var f=[Math.round(s*255),Math.round(a*255),Math.round(l*255)];return g(n)||f.push(n),f},e.prototype.rgbToHex=function(t){return t.length?"#"+this.hex(t[0])+this.hex(t[1])+this.hex(t[2])+(g(t[3])?"":t[3]!==0?(Math.round(t[3]*255)+65536).toString(16).substr(-2):"00"):""},e.prototype.hex=function(t){return("0"+t.toString(16)).slice(-2)},e.prototype.changeModeSwitcherProp=function(t){var i=X("."+fc,this.container);t?i?this.appendModeSwitchBtn():(this.createCtrlBtn(),this.isPicker()&&!this.disabled&&this.addCtrlSwitchEvent()):i&&(this.showButtons?ee(X("."+gv,i)):Ue(i))},e.prototype.changeShowBtnProps=function(t){var i=X("."+fc,this.container);t?(i&&Ue(i),this.createCtrlBtn(),this.isPicker()&&!this.disabled&&this.addCtrlSwitchEvent()):this.modeSwitcher?ee(X("."+xp,i)):Ue(i)},e.prototype.changeValueProp=function(t){if(this.isPicker())this.rgb=this.hexToRgb(t),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.setHandlerPosition(),ee(j(this.hueSlider.element,".e-slider-preview")),this.createSlider(),this.setHsvContainerBg(),this.updateInput(t),this.rgb.length===4&&this.updateOpacityInput(this.rgb[3]*100);else{this.removeTileSelection();var i=this.container.querySelector('span[aria-label="'+this.roundValue(t)+'"]');i&&this.addTileSelection(i)}},e.prototype.setInputEleProps=function(){Ue(X("."+vc,this.container)),this.createInput()},e.prototype.changeDisabledProp=function(t){this.isPicker()&&(this.hueSlider.enabled=!t,this.opacitySlider.enabled=!t,this.setInputEleProps()),t?(this.toggleDisabled(!0),this.unWireEvents()):(this.toggleDisabled(!1),this.wireEvents())},e.prototype.changeCssClassProps=function(t,i){var r=this.getWrapper(),n=this.getPopupEle();i&&K([r,n],i.split(" ")),t&&Y([r,n],t.replace(/\s+/g," ").trim().split(" "))},e.prototype.changeRtlProps=function(t){t?Y([this.getWrapper()],"e-rtl"):K([this.getWrapper()],"e-rtl")},e.prototype.changePaletteProps=function(){ee(this.container.children[0]),this.container.style.width="",this.createPalette()},e.prototype.changeOpacityProps=function(t){var i=this.getWrapper();t?(K([this.container.parentElement],PC),this.createOpacitySlider(X(".e-colorpicker-slider",this.container).appendChild(this.createElement("div",{className:"e-opacity-slider"}))),!i.classList.contains(Th)&&!i.classList.contains(gc)&&this.appendOpacityValue(X(".e-input-container",this.container))):(Y([this.container.parentElement],PC),this.opacitySlider.destroy(),Ue(this.opacitySlider.element),this.opacitySlider=null,!i.classList.contains(Th)&&!i.classList.contains(gc)&&Ue(X("."+zC,this.container).parentElement))},e.prototype.onPropertyChanged=function(t,i){var r=this;if(!g(t.value)){var n=this.roundValue(t.value);if(n.length===9){this.element.value=this.roundValue(n).slice(0,7);var s=this.splitBtn&&X("."+bv,this.splitBtn.element);s&&(s.style.backgroundColor=this.convertToRgbString(this.hexToRgb(t.value)))}else if(this.noColor&&this.mode==="Palette"&&this.value===""){var s=this.splitBtn&&X("."+bv,this.splitBtn.element);s.style.backgroundColor=""}else this.value=i.value}if(!this.inline&&g(t.inline)){var a=["disabled","enableRtl"];if(this.splitBtn.setProperties(cc(t,a)),!this.isPopupOpen()){this.changeCssClassProps(t.cssClass,i.cssClass),this.changeRtlProps(t.enableRtl);return}}for(var l=function(p){switch(p){case"inline":t.inline?(h.getWrapper().appendChild(h.container),h.splitBtn.destroy(),ee(h.element.nextElementSibling),h.container.children.length||h.createWidget()):(h.destroyOtherComp(),h.unWireEvents(),h.container.innerHTML="",h.createSplitBtn());break;case"cssClass":{h.changeCssClassProps(t.cssClass,i.cssClass);var f=t.cssClass.split(" ").concat(i.cssClass.split(" "));f=f.reduce(function(y,S){return y.indexOf(S)<0&&y.push(S),y},[]);var v=0;f.forEach(function(y){if(v===0&&(y===Th||y===aL||y===mc||y===RC||y===gc)){var S=X("."+vc,r.container);S&&Ue(X("."+vc,r.container)),r.createInput(),v++}});break}case"enableRtl":h.isPicker()&&(h.hueSlider.enableRtl=t.enableRtl,h.enableOpacity&&(h.opacitySlider.enableRtl=t.enableRtl),h.setInputEleProps()),h.changeRtlProps(t.enableRtl);break;case"disabled":h.changeDisabledProp(t.disabled);break;case"value":h.value!==i.value&&h.changeValueProp(t.value);break;case"showButtons":h.changeShowBtnProps(t.showButtons);break;case"mode":t.mode==="Picker"?h.switchToPicker():h.switchToPalette();break;case"modeSwitcher":h.changeModeSwitcherProp(t.modeSwitcher);break;case"columns":case"presetColors":h.isPicker()||h.changePaletteProps();break;case"noColor":t.noColor?h.mode==="Palette"&&!h.modeSwitcher&&h.setNoColor():h.changePaletteProps();break;case"enableOpacity":h.changeOpacityProps(t.enableOpacity);break;case"showRecentColors":if(!t.showRecentColors){var m=h.container.querySelector(".e-clr-pal-rec-wpr");m&&ee(m)}h.recentColors=[];break}},h=this,u=0,c=Object.keys(t);u<c.length;u++){var d=c[u];l(d)}},e.prototype.focusIn=function(){this.element.parentElement.focus()},Cr([C("#008000ff")],e.prototype,"value",void 0),Cr([C("")],e.prototype,"cssClass",void 0),Cr([C(!1)],e.prototype,"disabled",void 0),Cr([C("Picker")],e.prototype,"mode",void 0),Cr([C(!0)],e.prototype,"modeSwitcher",void 0),Cr([C(null)],e.prototype,"presetColors",void 0),Cr([C(!0)],e.prototype,"showButtons",void 0),Cr([C(10)],e.prototype,"columns",void 0),Cr([C(!1)],e.prototype,"inline",void 0),Cr([C(!1)],e.prototype,"noColor",void 0),Cr([C(!1)],e.prototype,"enablePersistence",void 0),Cr([C(!0)],e.prototype,"enableOpacity",void 0),Cr([C(!1)],e.prototype,"createPopupOnClick",void 0),Cr([C(!1)],e.prototype,"showRecentColors",void 0),Cr([q()],e.prototype,"select",void 0),Cr([q()],e.prototype,"change",void 0),Cr([q()],e.prototype,"beforeTileRender",void 0),Cr([q()],e.prototype,"beforeOpen",void 0),Cr([q()],e.prototype,"open",void 0),Cr([q()],e.prototype,"beforeClose",void 0),Cr([q()],e.prototype,"beforeModeSwitch",void 0),Cr([q()],e.prototype,"onModeSwitch",void 0),Cr([q()],e.prototype,"created",void 0),e=Cr([bt],e),e}(Kt),zH=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),an=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},jH="e-clear-icon-hide",Lh=function(o){zH(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.previousValue=null,r.isHiddenInput=!1,r.isForm=!1,r.inputPreviousValue=null,r.textboxOptions=t,r}return e.prototype.onPropertyChanged=function(t,i){for(var r=0,n=Object.keys(t);r<n.length;r++){var s=n[r];switch(s){case"floatLabelType":Ce.removeFloating(this.textboxWrapper),Ce.addFloating(this.respectiveElement,this.floatLabelType,this.placeholder);break;case"enabled":Ce.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container),this.bindClearEvent();break;case"width":Ce.setWidth(t.width,this.textboxWrapper.container);break;case"value":{var a=this.isProtectedOnChange;this.isProtectedOnChange=!0,Ce.isBlank(this.value)||(this.value=this.value.toString()),this.isProtectedOnChange=a,Ce.setValue(this.value,this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value),this.inputPreviousValue=this.respectiveElement.value,(this.isAngular||this.isVue)&&this.preventChange===!0?(this.previousValue=this.isAngular?this.value:this.previousValue,this.preventChange=!1):(g(this.isAngular)||!this.isAngular||this.isAngular&&!this.preventChange||this.isAngular&&g(this.preventChange))&&this.raiseChangeEvent()}break;case"htmlAttributes":this.updateHTMLAttributesToElement(),this.updateHTMLAttributesToWrapper(),this.checkAttributes(!0),this.multiline&&!g(this.textarea)?Ce.validateInputType(this.textboxWrapper.container,this.textarea):Ce.validateInputType(this.textboxWrapper.container,this.element);break;case"readonly":Ce.setReadonly(this.readonly,this.respectiveElement);break;case"type":this.respectiveElement.tagName!=="TEXTAREA"&&(this.respectiveElement.setAttribute("type",this.type),Ce.validateInputType(this.textboxWrapper.container,this.element),this.raiseChangeEvent());break;case"showClearButton":Ce.setClearButton(this.showClearButton,this.respectiveElement,this.textboxWrapper),this.bindClearEvent();break;case"enableRtl":Ce.setEnableRtl(this.enableRtl,[this.textboxWrapper.container]);break;case"placeholder":Ce.setPlaceholder(this.placeholder,this.respectiveElement),Ce.calculateWidth(this.respectiveElement,this.textboxWrapper.container);break;case"autocomplete":this.autocomplete!=="on"&&this.autocomplete!==""?this.respectiveElement.autocomplete=this.autocomplete:this.removeAttributes(["autocomplete"]);break;case"cssClass":Ce.updateCssClass(t.cssClass,i.cssClass,this.textboxWrapper.container);break;case"locale":this.globalize=new Et(this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),Ce.setPlaceholder(this.placeholder,this.respectiveElement);break}}},e.prototype.getModuleName=function(){return"textbox"},e.prototype.preRender=function(){if(this.cloneElement=this.element.cloneNode(!0),this.formElement=j(this.element,"form"),g(this.formElement)||(this.isForm=!0),this.element.tagName==="EJS-TEXTBOX"){var t=V("ej2_instances",this.element),i=this.multiline?this.createElement("textarea"):this.createElement("input"),r=0;for(r;r<this.element.attributes.length;r++){var n=this.element.attributes[r].nodeName;n!=="id"&&n!=="class"?(i.setAttribute(n,this.element.attributes[r].nodeValue),i.innerHTML=this.element.innerHTML,n==="name"&&this.element.removeAttribute("name")):n==="class"&&i.setAttribute(n,this.element.className.split(" ").filter(function(l){return l.indexOf("ng-")!==0}).join(" "))}this.element.appendChild(i),this.element=i,Ge("ej2_instances",t,this.element)}this.updateHTMLAttributesToElement(),this.checkAttributes(!1),(g(this.textboxOptions)||this.textboxOptions.value===void 0)&&this.element.value!==""&&this.setProperties({value:this.element.value},!0),this.element.tagName!=="TEXTAREA"&&this.element.setAttribute("type",this.type),(this.type==="text"||this.element.tagName==="INPUT"&&this.multiline&&this.isReact)&&this.element.setAttribute("role","textbox"),this.globalize=new Et(this.locale);var s={placeholder:this.placeholder};if(this.l10n=new Li("textbox",s,this.locale),this.l10n.getConstant("placeholder")!==""&&this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),this.element.hasAttribute("id")||this.element.setAttribute("id",kt("textbox")),this.element.hasAttribute("name")||this.element.setAttribute("name",this.element.getAttribute("id")),this.element.tagName==="INPUT"&&this.multiline){this.isHiddenInput=!0,this.textarea=this.createElement("textarea"),this.element.parentNode.insertBefore(this.textarea,this.element),this.element.setAttribute("type","hidden"),this.textarea.setAttribute("name",this.element.getAttribute("name")),this.element.removeAttribute("name"),this.textarea.setAttribute("role",this.element.getAttribute("role")),this.element.removeAttribute("role"),this.textarea.setAttribute("id",kt("textarea"));for(var a=["placeholder","disabled","value","readonly","type","autocomplete"],r=0;r<this.element.attributes.length;r++){var n=this.element.attributes[r].nodeName;this.element.hasAttribute(n)&&HC.indexOf(n)<0&&!(n==="id"||n==="type"||n==="e-mappinguid")&&(this.textarea.setAttribute(n,this.element.attributes[r].nodeValue),a.indexOf(n)<0&&(this.element.removeAttribute(n),r--))}}},e.prototype.checkAttributes=function(t){for(var i=t?g(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["placeholder","disabled","value","readonly","type","autocomplete"],r=0,n=i;r<n.length;r++){var s=n[r];if(!g(this.element.getAttribute(s)))switch(s){case"disabled":if(g(this.textboxOptions)||this.textboxOptions.enabled===void 0||t){var a=!(this.element.getAttribute(s)==="disabled"||this.element.getAttribute(s)===""||this.element.getAttribute(s)==="true");this.setProperties({enabled:a},!t)}break;case"readonly":if(g(this.textboxOptions)||this.textboxOptions.readonly===void 0||t){var l=this.element.getAttribute(s)==="readonly"||this.element.getAttribute(s)===""||this.element.getAttribute(s)==="true";this.setProperties({readonly:l},!t)}break;case"placeholder":(g(this.textboxOptions)||this.textboxOptions.placeholder===void 0||t)&&this.setProperties({placeholder:this.element.placeholder},!t);break;case"autocomplete":if(g(this.textboxOptions)||this.textboxOptions.autocomplete===void 0||t){var h=this.element.autocomplete==="off"?"off":"on";this.setProperties({autocomplete:h},!t)}break;case"value":(g(this.textboxOptions)||this.textboxOptions.value===void 0||t)&&this.element.value!==""&&this.setProperties({value:this.element.value},!t);break;case"type":(g(this.textboxOptions)||this.textboxOptions.type===void 0||t)&&this.setProperties({type:this.element.type},!t);break}}},e.prototype.render=function(){var t=this.cssClass;!g(this.cssClass)&&this.cssClass!==""&&(t=Ce.getInputValidClassList(this.cssClass)),this.respectiveElement=this.isHiddenInput?this.textarea:this.element,this.textboxWrapper=Ce.createInput({element:this.respectiveElement,floatLabelType:this.floatLabelType,properties:{enabled:this.enabled,enableRtl:this.enableRtl,cssClass:t,readonly:this.readonly,placeholder:this.placeholder,showClearButton:this.showClearButton}}),this.updateHTMLAttributesToWrapper(),this.isHiddenInput&&this.respectiveElement.parentNode.insertBefore(this.element,this.respectiveElement),this.wireEvents(),g(this.value)||(Ce.setValue(this.value,this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value)),g(this.value)||(this.initialValue=this.value,this.setInitialValue()),this.autocomplete!=="on"&&this.autocomplete!==""?this.respectiveElement.autocomplete=this.autocomplete:!g(this.textboxOptions)&&this.textboxOptions.autocomplete!==void 0&&this.removeAttributes(["autocomplete"]),this.previousValue=this.value,this.inputPreviousValue=this.value,this.respectiveElement.defaultValue=this.respectiveElement.value,Ce.setWidth(this.width,this.textboxWrapper.container),!g(j(this.element,"fieldset"))&&j(this.element,"fieldset").disabled&&(this.enabled=!1),!this.element.hasAttribute("aria-labelledby")&&!this.element.hasAttribute("placeholder")&&!this.element.hasAttribute("aria-label")&&this.element.setAttribute("aria-label","textbox"),this.renderComplete()},e.prototype.updateHTMLAttributesToWrapper=function(){Ce.updateHTMLAttributesToWrapper(this.htmlAttributes,this.textboxWrapper.container)},e.prototype.updateHTMLAttributesToElement=function(){Ce.updateHTMLAttributesToElement(this.htmlAttributes,this.respectiveElement?this.respectiveElement:this.multiline&&!g(this.textarea)?this.textarea:this.element)},e.prototype.setInitialValue=function(){this.isAngular||this.respectiveElement.setAttribute("value",this.initialValue)},e.prototype.wireEvents=function(){E.add(this.respectiveElement,"focus",this.focusHandler,this),E.add(this.respectiveElement,"blur",this.focusOutHandler,this),E.add(this.respectiveElement,"keydown",this.keydownHandler,this),E.add(this.respectiveElement,"input",this.inputHandler,this),E.add(this.respectiveElement,"change",this.changeHandler,this),this.isForm&&E.add(this.formElement,"reset",this.resetForm,this),this.bindClearEvent(),!g(this.textboxWrapper.container.querySelector(".e-float-text"))&&this.floatLabelType==="Auto"&&this.textboxWrapper.container.classList.contains("e-autofill")&&this.textboxWrapper.container.classList.contains("e-outline")&&E.add(this.textboxWrapper.container.querySelector(".e-float-text"),"animationstart",this.animationHandler,this)},e.prototype.animationHandler=function(){this.textboxWrapper.container.classList.add("e-valid-input");var t=this.textboxWrapper.container.querySelector(".e-float-text");g(t)||(t.classList.add("e-label-top"),t.classList.contains("e-label-bottom")&&t.classList.remove("e-label-bottom"))},e.prototype.resetValue=function(t){var i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.value=t,t==null&&this.textboxWrapper.container.classList.contains("e-valid-input")&&!(this.floatLabelType==="Always"&&this.textboxWrapper.container.classList.contains("e-outline"))&&this.textboxWrapper.container.classList.remove("e-valid-input"),this.isProtectedOnChange=i},e.prototype.resetForm=function(){if(this.isAngular?this.resetValue(""):this.resetValue(this.initialValue),!g(this.textboxWrapper)){var t=this.textboxWrapper.container.querySelector(".e-float-text");!g(t)&&this.floatLabelType!=="Always"&&(g(this.initialValue)||this.initialValue===""?(t.classList.add("e-label-bottom"),t.classList.remove("e-label-top")):this.initialValue!==""&&(t.classList.add("e-label-top"),t.classList.remove("e-label-bottom")))}},e.prototype.focusHandler=function(t){var i={container:this.textboxWrapper.container,event:t,value:this.value};this.trigger("focus",i)},e.prototype.focusOutHandler=function(t){!(this.previousValue===null&&this.value===null&&this.respectiveElement.value==="")&&this.previousValue!==this.value&&this.raiseChangeEvent(t,!0);var i={container:this.textboxWrapper.container,event:t,value:this.value};this.trigger("blur",i)},e.prototype.keydownHandler=function(t){(t.keyCode===13||t.keyCode===9)&&!((this.previousValue===null||this.previousValue==="")&&(this.value===null||this.value==="")&&this.respectiveElement.value==="")&&this.setProperties({value:this.respectiveElement.value},!0)},e.prototype.inputHandler=function(t){var i=this,r={event:t,value:this.respectiveElement.value,previousValue:this.inputPreviousValue,container:this.textboxWrapper.container};this.inputPreviousValue=this.respectiveElement.value,this.isAngular&&(i.localChange({value:this.respectiveElement.value}),this.preventChange=!0),this.isVue&&(this.preventChange=!0),this.trigger("input",r),t.stopPropagation()},e.prototype.changeHandler=function(t){this.setProperties({value:this.respectiveElement.value},!0),this.previousValue!==this.value&&this.raiseChangeEvent(t,!0),t.stopPropagation()},e.prototype.raiseChangeEvent=function(t,i){var r={event:t,value:this.value,previousValue:this.previousValue,container:this.textboxWrapper.container,isInteraction:i||!1,isInteracted:i||!1};this.preventChange=!1,this.trigger("change",r),this.previousValue=this.value,this.element.tagName==="INPUT"&&this.multiline&&B.info.name==="mozilla"&&(this.element.value=this.respectiveElement.value)},e.prototype.bindClearEvent=function(){this.showClearButton&&(this.enabled?E.add(this.textboxWrapper.clearButton,"mousedown touchstart",this.resetInputHandler,this):E.remove(this.textboxWrapper.clearButton,"mousedown touchstart",this.resetInputHandler))},e.prototype.resetInputHandler=function(t){if(t.preventDefault(),!this.textboxWrapper.clearButton.classList.contains(jH)||this.textboxWrapper.container.classList.contains("e-static-clear")){Ce.setValue("",this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value),this.setProperties({value:this.respectiveElement.value},!0);var i={event:t,value:this.respectiveElement.value,previousValue:this.inputPreviousValue,container:this.textboxWrapper.container};if(this.trigger("input",i),this.inputPreviousValue=this.respectiveElement.value,this.raiseChangeEvent(t,!0),j(this.element,"form")){var r=this.element,n=document.createEvent("KeyboardEvent");n.initEvent("keyup",!1,!0),r.dispatchEvent(n)}}},e.prototype.unWireEvents=function(){E.remove(this.respectiveElement,"focus",this.focusHandler),E.remove(this.respectiveElement,"blur",this.focusOutHandler),E.remove(this.respectiveElement,"keydown",this.keydownHandler),E.remove(this.respectiveElement,"input",this.inputHandler),E.remove(this.respectiveElement,"change",this.changeHandler),this.isForm&&E.remove(this.formElement,"reset",this.resetForm),!g(this.textboxWrapper.container.querySelector(".e-float-text"))&&this.floatLabelType==="Auto"&&this.textboxWrapper.container.classList.contains("e-outline")&&this.textboxWrapper.container.classList.contains("e-autofill")&&E.remove(this.textboxWrapper.container.querySelector(".e-float-text"),"animationstart",this.animationHandler)},e.prototype.destroy=function(){this.unWireEvents(),this.showClearButton&&(this.clearButton=document.getElementsByClassName("e-clear-icon")[0]),this.element.tagName==="INPUT"&&this.multiline&&(ee(this.textboxWrapper.container.getElementsByTagName("textarea")[0]),this.respectiveElement=this.element,this.element.removeAttribute("type")),this.respectiveElement.value=this.respectiveElement.defaultValue,this.respectiveElement.classList.remove("e-input"),this.removeAttributes(["aria-disabled","aria-readonly","aria-labelledby"]),g(this.textboxWrapper)||(this.textboxWrapper.container.insertAdjacentElement("afterend",this.respectiveElement),ee(this.textboxWrapper.container)),this.textboxWrapper=null,Ce.destroy({element:this.respectiveElement,floatLabelType:this.floatLabelType,properties:this.properties},this.clearButton),o.prototype.destroy.call(this)},e.prototype.addIcon=function(t,i){Ce.addIcon(t,i,this.textboxWrapper.container,this.respectiveElement,this.createElement)},e.prototype.getPersistData=function(){var t=["value"];return this.addOnPersist(t)},e.prototype.addAttributes=function(t){for(var i=0,r=Object.keys(t);i<r.length;i++){var n=r[i];n==="disabled"?(this.setProperties({enabled:!1},!0),Ce.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container)):n==="readonly"?(this.setProperties({readonly:!0},!0),Ce.setReadonly(this.readonly,this.respectiveElement)):n==="class"?this.respectiveElement.classList.add(t[""+n]):n==="placeholder"?(this.setProperties({placeholder:t[""+n]},!0),Ce.setPlaceholder(this.placeholder,this.respectiveElement)):n==="rows"&&this.respectiveElement.tagName==="TEXTAREA"?this.respectiveElement.setAttribute(n,t[""+n]):this.respectiveElement.setAttribute(n,t[""+n])}},e.prototype.removeAttributes=function(t){for(var i=0,r=t;i<r.length;i++){var n=r[i];n==="disabled"?(this.setProperties({enabled:!0},!0),Ce.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container)):n==="readonly"?(this.setProperties({readonly:!1},!0),Ce.setReadonly(this.readonly,this.respectiveElement)):n==="placeholder"?(this.setProperties({placeholder:null},!0),Ce.setPlaceholder(this.placeholder,this.respectiveElement)):this.respectiveElement.removeAttribute(n)}},e.prototype.focusIn=function(){document.activeElement!==this.respectiveElement&&this.enabled&&(this.respectiveElement.focus(),(this.textboxWrapper.container.classList.contains("e-input-group")||this.textboxWrapper.container.classList.contains("e-outline")||this.textboxWrapper.container.classList.contains("e-filled"))&&Y([this.textboxWrapper.container],[$T]))},e.prototype.focusOut=function(){document.activeElement===this.respectiveElement&&this.enabled&&(this.respectiveElement.blur(),(this.textboxWrapper.container.classList.contains("e-input-group")||this.textboxWrapper.container.classList.contains("e-outline")||this.textboxWrapper.container.classList.contains("e-filled"))&&K([this.textboxWrapper.container],[$T]))},an([C("text")],e.prototype,"type",void 0),an([C(!1)],e.prototype,"readonly",void 0),an([C(null)],e.prototype,"value",void 0),an([C("Never")],e.prototype,"floatLabelType",void 0),an([C("")],e.prototype,"cssClass",void 0),an([C(null)],e.prototype,"placeholder",void 0),an([C("on")],e.prototype,"autocomplete",void 0),an([C({})],e.prototype,"htmlAttributes",void 0),an([C(!1)],e.prototype,"multiline",void 0),an([C(!0)],e.prototype,"enabled",void 0),an([C(!1)],e.prototype,"showClearButton",void 0),an([C(!1)],e.prototype,"enablePersistence",void 0),an([C(null)],e.prototype,"width",void 0),an([q()],e.prototype,"created",void 0),an([q()],e.prototype,"destroyed",void 0),an([q()],e.prototype,"change",void 0),an([q()],e.prototype,"blur",void 0),an([q()],e.prototype,"focus",void 0),an([q()],e.prototype,"input",void 0),e=an([bt],e),e}(Kt);var HH=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),lL=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},VH="e-hscroll",Rl="e-rtl",Pl="e-overlay",_H="e-hscroll-bar",UH="e-hscroll-content",Ap="e-nav-arrow",Tp="e-nav-right-arrow",wv="e-nav-left-arrow",kh="e-scroll-nav",UC="e-scroll-right-nav",hL="e-scroll-left-nav",uL="e-scroll-device",xv="e-scroll-overlay",WC="e-scroll-right-overlay",qC="e-scroll-left-overlay",cL=40,Qv=function(o){HH(e,o);function e(t,i){return o.call(this,t,i)||this}return e.prototype.preRender=function(){this.browser=B.info.name,this.browserCheck=this.browser==="mozilla",this.isDevice=B.isDevice,this.customStep=!0;var t=this.element;this.ieCheck=this.browser==="edge"||this.browser==="msie",this.initialize(),t.id===""&&(t.id=kt("hscroll"),this.uniqueId=!0),t.style.display="block",this.enableRtl&&t.classList.add(Rl)},e.prototype.render=function(){this.touchModule=new Fr(this.element,{scroll:this.touchHandler.bind(this),swipe:this.swipeHandler.bind(this)}),E.add(this.scrollEle,"scroll",this.scrollHandler,this),this.isDevice?(this.element.classList.add(uL),this.createOverlay(this.element)):this.createNavIcon(this.element),this.setScrollState()},e.prototype.setScrollState=function(){g(this.scrollStep)||this.scrollStep<0?(this.scrollStep=this.scrollEle.offsetWidth,this.customStep=!1):this.customStep=!0},e.prototype.initialize=function(){var t=this.createElement("div",{className:UH}),i=this.createElement("div",{className:_H});i.setAttribute("tabindex","-1");for(var r=this.element,n=[].slice.call(r.children),s=0,a=n;s<a.length;s++){var l=a[s];t.appendChild(l)}i.appendChild(t),r.appendChild(i),i.style.overflowX="hidden",this.scrollEle=i,this.scrollItems=t},e.prototype.getPersistData=function(){var t=["scrollStep"];return this.addOnPersist(t)},e.prototype.getModuleName=function(){return"hScroll"},e.prototype.destroy=function(){var t=this.element;t.style.display="",t.classList.remove(VH),t.classList.remove(uL),t.classList.remove(Rl);var i=Oe(".e-"+t.id+"_nav."+kh,t),r=Oe("."+xv,t);[].slice.call(r).forEach(function(l){ee(l)});for(var n=0,s=[].slice.call(this.scrollItems.children);n<s.length;n++){var a=s[n];t.appendChild(a)}this.uniqueId&&this.element.removeAttribute("id"),ee(this.scrollEle),i.length>0&&(ee(i[0]),g(i[1])||ee(i[1])),E.remove(this.scrollEle,"scroll",this.scrollHandler),this.touchModule.destroy(),this.touchModule=null,o.prototype.destroy.call(this)},e.prototype.disable=function(t){var i=Oe(".e-scroll-nav:not(."+Pl+")",this.element);t?this.element.classList.add(Pl):this.element.classList.remove(Pl),[].slice.call(i).forEach(function(r){r.setAttribute("tabindex",t?"-1":"0")})},e.prototype.createOverlay=function(t){var i=t.id.concat("_nav"),r=this.createElement("div",{className:xv+" "+WC}),n="e-"+t.id.concat("_nav "+kh+" "+UC),s=this.createElement("div",{id:i.concat("_right"),className:n}),a=this.createElement("div",{className:Tp+" "+Ap+" e-icons"});s.appendChild(a);var l=this.createElement("div",{className:xv+" "+qC});this.ieCheck&&s.classList.add("e-ie-align"),t.appendChild(r),t.appendChild(s),t.insertBefore(l,t.firstChild),this.eventBinding([s])},e.prototype.createNavIcon=function(t){var i=t.id.concat("_nav"),r="e-"+t.id.concat("_nav "+kh+" "+UC),n={role:"button",id:i.concat("_right"),"aria-label":"Scroll right"},s=this.createElement("div",{className:r,attrs:n});s.setAttribute("aria-disabled","false");var a=this.createElement("div",{className:Tp+" "+Ap+" e-icons"}),l="e-"+t.id.concat("_nav "+kh+" "+hL),h={role:"button",id:i.concat("_left"),"aria-label":"Scroll left"},u=this.createElement("div",{className:l+" "+Pl,attrs:h});u.setAttribute("aria-disabled","true");var c=this.createElement("div",{className:wv+" "+Ap+" e-icons"});u.appendChild(c),s.appendChild(a),t.appendChild(s),t.insertBefore(u,t.firstChild),this.ieCheck&&(s.classList.add("e-ie-align"),u.classList.add("e-ie-align")),this.eventBinding([s,u])},e.prototype.onKeyPress=function(t){var i=this;if(t.key==="Enter"){var r=function(){i.keyTimeout=!0,i.eleScrolling(10,t.target,!0)};this.keyTimer=window.setTimeout(function(){r()},100)}},e.prototype.onKeyUp=function(t){t.key==="Enter"&&(this.keyTimeout?this.keyTimeout=!1:t.target.click(),clearTimeout(this.keyTimer))},e.prototype.eventBinding=function(t){var i=this;[].slice.call(t).forEach(function(r){new Fr(r,{tapHold:i.tabHoldHandler.bind(i),tapHoldThreshold:500}),r.addEventListener("keydown",i.onKeyPress.bind(i)),r.addEventListener("keyup",i.onKeyUp.bind(i)),r.addEventListener("mouseup",i.repeatScroll.bind(i)),r.addEventListener("touchend",i.repeatScroll.bind(i)),r.addEventListener("contextmenu",function(n){n.preventDefault()}),E.add(r,"click",i.clickEventHandler,i)})},e.prototype.repeatScroll=function(){clearInterval(this.timeout)},e.prototype.tabHoldHandler=function(t){var i=this,r=t.originalEvent.target;r=this.contains(r,kh)?r.firstElementChild:r;var n=10,s=function(){i.eleScrolling(n,r,!0)};this.timeout=window.setInterval(function(){s()},50)},e.prototype.contains=function(t,i){return t.classList.contains(i)},e.prototype.eleScrolling=function(t,i,r){var n=this.element,s=i.classList;s.contains(kh)&&(s=i.querySelector("."+Ap).classList),this.contains(n,Rl)&&this.browserCheck&&(t=-t),!this.contains(n,Rl)||this.browserCheck||this.ieCheck?s.contains(Tp)?this.frameScrollRequest(t,"add",r):this.frameScrollRequest(t,"",r):s.contains(wv)?this.frameScrollRequest(t,"add",r):this.frameScrollRequest(t,"",r)},e.prototype.clickEventHandler=function(t){this.eleScrolling(this.scrollStep,t.target,!1)},e.prototype.swipeHandler=function(t){var i=this.scrollEle,r;t.velocity<=1?r=t.distanceX/(t.velocity*10):r=t.distanceX/t.velocity;var n=.5,s=function(){var a=Math.sin(n);a<=0?window.cancelAnimationFrame(a):(t.swipeDirection==="Left"?i.scrollLeft+=r*a:t.swipeDirection==="Right"&&(i.scrollLeft-=r*a),n-=.5,window.requestAnimationFrame(s))};s()},e.prototype.scrollUpdating=function(t,i){i==="add"?this.scrollEle.scrollLeft+=t:this.scrollEle.scrollLeft-=t,this.enableRtl&&this.scrollEle.scrollLeft>0&&(this.scrollEle.scrollLeft=0)},e.prototype.frameScrollRequest=function(t,i,r){var n=this,s=10;if(r){this.scrollUpdating(t,i);return}this.customStep||[].slice.call(Oe("."+xv,this.element)).forEach(function(l){t-=l.offsetWidth});var a=function(){var l,h;n.contains(n.element,Rl)&&n.browserCheck?(l=-t,h=-s):(l=t,h=s),l<s?window.cancelAnimationFrame(h):(n.scrollUpdating(h,i),t-=h,window.requestAnimationFrame(a))};a()},e.prototype.touchHandler=function(t){var i=this.scrollEle,r=t.distanceX;this.ieCheck&&this.contains(this.element,Rl)&&(r=-r),t.scrollDirection==="Left"?i.scrollLeft=i.scrollLeft+r:t.scrollDirection==="Right"&&(i.scrollLeft=i.scrollLeft-r)},e.prototype.arrowDisabling=function(t,i){if(this.isDevice){var r=g(t)?i:t,n=r.querySelector("."+Ap);g(t)?wi(n,[Tp],[wv]):wi(n,[wv],[Tp])}else t&&i&&(t.classList.add(Pl),t.setAttribute("aria-disabled","true"),t.removeAttribute("tabindex"),i.classList.remove(Pl),i.setAttribute("aria-disabled","false"),i.setAttribute("tabindex","0"));this.repeatScroll()},e.prototype.scrollHandler=function(t){var i=t.target,r=i.offsetWidth,n=this.element,s=this.element.querySelector("."+hL),a=this.element.querySelector("."+UC),l=this.element.querySelector("."+qC),h=this.element.querySelector("."+WC),u=i.scrollLeft;if(u<=0&&(u=-u),this.isDevice&&(this.enableRtl&&!(this.browserCheck||this.ieCheck)&&(l=this.element.querySelector("."+WC),h=this.element.querySelector("."+qC)),u<cL?l.style.width=u+"px":l.style.width="40px",i.scrollWidth-Math.ceil(r+u)<cL?h.style.width=i.scrollWidth-Math.ceil(r+u)+"px":h.style.width="40px"),u===0)this.arrowDisabling(s,a);else if(Math.ceil(r+u+.1)>=i.scrollWidth)this.arrowDisabling(a,s);else{var c=this.element.querySelector("."+kh+"."+Pl);c&&(c.classList.remove(Pl),c.setAttribute("aria-disabled","false"),c.setAttribute("tabindex","0"))}},e.prototype.onPropertyChanged=function(t,i){for(var r=0,n=Object.keys(t);r<n.length;r++){var s=n[r];switch(s){case"scrollStep":this.setScrollState();break;case"enableRtl":t.enableRtl?this.element.classList.add(Rl):this.element.classList.remove(Rl);break}}},lL([C(null)],e.prototype,"scrollStep",void 0),e=lL([bt],e),e}(Kt),WH=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),dL=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},qH="e-vscroll",Iv="e-rtl",Bl="e-overlay",GH="e-vscroll-bar",YH="e-vscroll-content",Lp="e-nav-arrow",Mv="e-nav-up-arrow",kp="e-nav-down-arrow",Nh="e-scroll-nav",pL="e-scroll-up-nav",GC="e-scroll-down-nav",fL="e-scroll-device",Dv="e-scroll-overlay",gL="e-scroll-up-overlay",vL="e-scroll-down-overlay",mL=40,rl=function(o){WH(e,o);function e(t,i){return o.call(this,t,i)||this}return e.prototype.preRender=function(){this.browser=B.info.name,this.browserCheck=this.browser==="mozilla",this.isDevice=B.isDevice,this.customStep=!0;var t=this.element;this.ieCheck=this.browser==="edge"||this.browser==="msie",this.initialize(),t.id===""&&(t.id=kt("vscroll"),this.uniqueId=!0),t.style.display="block",this.enableRtl&&t.classList.add(Iv)},e.prototype.render=function(){this.touchModule=new Fr(this.element,{scroll:this.touchHandler.bind(this),swipe:this.swipeHandler.bind(this)}),E.add(this.scrollEle,"scroll",this.scrollEventHandler,this),this.isDevice?(this.element.classList.add(fL),this.createOverlayElement(this.element)):this.createNavIcon(this.element),this.setScrollState(),E.add(this.element,"wheel",this.wheelEventHandler,this)},e.prototype.setScrollState=function(){g(this.scrollStep)||this.scrollStep<0?(this.scrollStep=this.scrollEle.offsetHeight,this.customStep=!1):this.customStep=!0},e.prototype.initialize=function(){var t=Xe("div",{className:YH}),i=Xe("div",{className:GH});i.setAttribute("tabindex","-1");for(var r=this.element,n=[].slice.call(r.children),s=0,a=n;s<a.length;s++){var l=a[s];t.appendChild(l)}i.appendChild(t),r.appendChild(i),i.style.overflow="hidden",this.scrollEle=i,this.scrollItems=t},e.prototype.getPersistData=function(){var t=["scrollStep"];return this.addOnPersist(t)},e.prototype.getModuleName=function(){return"vScroll"},e.prototype.destroy=function(){var t=this.element;t.style.display="",K([this.element],[qH,fL,Iv]);var i=Oe(".e-"+t.id+"_nav."+Nh,t),r=Oe("."+Dv,t);[].slice.call(r).forEach(function(l){ee(l)});for(var n=0,s=[].slice.call(this.scrollItems.children);n<s.length;n++){var a=s[n];t.appendChild(a)}this.uniqueId&&this.element.removeAttribute("id"),ee(this.scrollEle),i.length>0&&(ee(i[0]),g(i[1])||ee(i[1])),E.remove(this.scrollEle,"scroll",this.scrollEventHandler),this.touchModule.destroy(),this.touchModule=null,o.prototype.destroy.call(this)},e.prototype.disable=function(t){var i=Oe(".e-scroll-nav:not(."+Bl+")",this.element);t?this.element.classList.add(Bl):this.element.classList.remove(Bl),[].slice.call(i).forEach(function(r){r.setAttribute("tabindex",t?"-1":"0")})},e.prototype.createOverlayElement=function(t){var i=t.id.concat("_nav"),r=Xe("div",{className:Dv+" "+vL}),n="e-"+t.id.concat("_nav "+Nh+" "+GC),s=Xe("div",{id:i.concat("down"),className:n}),a=Xe("div",{className:kp+" "+Lp+" e-icons"});s.appendChild(a);var l=Xe("div",{className:Dv+" "+gL});this.ieCheck&&s.classList.add("e-ie-align"),t.appendChild(r),t.appendChild(s),t.insertBefore(l,t.firstChild),this.eventBinding([s])},e.prototype.createNavIcon=function(t){var i=t.id.concat("_nav"),r="e-"+t.id.concat("_nav "+Nh+" "+GC),n=Xe("div",{id:i.concat("_down"),className:r});n.setAttribute("aria-disabled","false");var s=Xe("div",{className:kp+" "+Lp+" e-icons"}),a="e-"+t.id.concat("_nav "+Nh+" "+pL),l=Xe("div",{id:i.concat("_up"),className:a+" "+Bl});l.setAttribute("aria-disabled","true");var h=Xe("div",{className:Mv+" "+Lp+" e-icons"});l.appendChild(h),n.appendChild(s),n.setAttribute("tabindex","0"),t.appendChild(n),t.insertBefore(l,t.firstChild),this.ieCheck&&(n.classList.add("e-ie-align"),l.classList.add("e-ie-align")),this.eventBinding([n,l])},e.prototype.onKeyPress=function(t){var i=this;if(t.key==="Enter"){var r=function(){i.keyTimeout=!0,i.eleScrolling(10,t.target,!0)};this.keyTimer=window.setTimeout(function(){r()},100)}},e.prototype.onKeyUp=function(t){t.key==="Enter"&&(this.keyTimeout?this.keyTimeout=!1:t.target.click(),clearTimeout(this.keyTimer))},e.prototype.eventBinding=function(t){var i=this;[].slice.call(t).forEach(function(r){new Fr(r,{tapHold:i.tabHoldHandler.bind(i),tapHoldThreshold:500}),r.addEventListener("keydown",i.onKeyPress.bind(i)),r.addEventListener("keyup",i.onKeyUp.bind(i)),r.addEventListener("mouseup",i.repeatScroll.bind(i)),r.addEventListener("touchend",i.repeatScroll.bind(i)),r.addEventListener("contextmenu",function(n){n.preventDefault()}),E.add(r,"click",i.clickEventHandler,i)})},e.prototype.repeatScroll=function(){clearInterval(this.timeout)},e.prototype.tabHoldHandler=function(t){var i=this,r=t.originalEvent.target;r=this.contains(r,Nh)?r.firstElementChild:r;var n=10,s=function(){i.eleScrolling(n,r,!0)};this.timeout=window.setInterval(function(){s()},50)},e.prototype.contains=function(t,i){return t.classList.contains(i)},e.prototype.eleScrolling=function(t,i,r){var n=i.classList;n.contains(Nh)&&(n=i.querySelector("."+Lp).classList),n.contains(kp)?this.frameScrollRequest(t,"add",r):n.contains(Mv)&&this.frameScrollRequest(t,"",r)},e.prototype.clickEventHandler=function(t){this.eleScrolling(this.scrollStep,t.target,!1)},e.prototype.wheelEventHandler=function(t){t.preventDefault(),this.frameScrollRequest(this.scrollStep,t.deltaY>0?"add":"",!1)},e.prototype.swipeHandler=function(t){var i=this.scrollEle,r;t.velocity<=1?r=t.distanceY/(t.velocity*10):r=t.distanceY/t.velocity;var n=.5,s=function(){var a=Math.sin(n);a<=0?window.cancelAnimationFrame(a):(t.swipeDirection==="Up"?i.scrollTop+=r*a:t.swipeDirection==="Down"&&(i.scrollTop-=r*a),n-=.02,window.requestAnimationFrame(s))};s()},e.prototype.scrollUpdating=function(t,i){i==="add"?this.scrollEle.scrollTop+=t:this.scrollEle.scrollTop-=t},e.prototype.frameScrollRequest=function(t,i,r){var n=this,s=10;if(r){this.scrollUpdating(t,i);return}this.customStep||[].slice.call(Oe("."+Dv,this.element)).forEach(function(l){t-=l.offsetHeight});var a=function(){t<s?window.cancelAnimationFrame(s):(n.scrollUpdating(s,i),t-=s,window.requestAnimationFrame(a))};a()},e.prototype.touchHandler=function(t){var i=this.scrollEle,r=t.distanceY;t.scrollDirection==="Up"?i.scrollTop=i.scrollTop+r:t.scrollDirection==="Down"&&(i.scrollTop=i.scrollTop-r)},e.prototype.arrowDisabling=function(t,i){if(this.isDevice){var r=g(t)?i:t,n=r.querySelector("."+Lp);g(t)?wi(n,[kp],[Mv]):wi(n,[Mv],[kp])}else t.classList.add(Bl),t.setAttribute("aria-disabled","true"),t.removeAttribute("tabindex"),i.classList.remove(Bl),i.setAttribute("aria-disabled","false"),i.setAttribute("tabindex","0");this.repeatScroll()},e.prototype.scrollEventHandler=function(t){var i=t.target,r=i.offsetHeight,n=this.element.querySelector("."+pL),s=this.element.querySelector("."+GC),a=this.element.querySelector("."+gL),l=this.element.querySelector("."+vL),h=i.scrollTop;if(h<=0&&(h=-h),this.isDevice&&(h<mL?a.style.height=h+"px":a.style.height="40px",i.scrollHeight-Math.ceil(r+h)<mL?l.style.height=i.scrollHeight-Math.ceil(r+h)+"px":l.style.height="40px"),h===0)this.arrowDisabling(n,s);else if(Math.ceil(r+h+.1)>=i.scrollHeight)this.arrowDisabling(s,n);else{var u=this.element.querySelector("."+Nh+"."+Bl);u&&(u.classList.remove(Bl),u.setAttribute("aria-disabled","false"),u.setAttribute("tabindex","0"))}},e.prototype.onPropertyChanged=function(t,i){for(var r=0,n=Object.keys(t);r<n.length;r++){var s=n[r];switch(s){case"scrollStep":this.setScrollState();break;case"enableRtl":t.enableRtl?this.element.classList.add(Iv):this.element.classList.remove(Iv);break}}},dL([C(null)],e.prototype,"scrollStep",void 0),e=dL([bt],e),e}(Kt);function co(o,e,t,i,r,n){var s,a,l=e.parentElement;if(i==="vscroll"?(s=n||e.getBoundingClientRect().height,a=t.getBoundingClientRect().height):(s=e.getBoundingClientRect().width,a=t.getBoundingClientRect().width),s<a)return yL(o,e,t,i,r,n);if(l){var h=l.getBoundingClientRect().width;return h<s&&i==="hscroll"?(a=h,e.style.maxWidth=h+"px",yL(o,e,t,i,r,n)):t}else return t}function yL(o,e,t,i,r,n){var s=o("div",{className:"e-menu-"+i});e.appendChild(s),s.appendChild(t),n?(s.style.overflow="hidden",s.style.height=n+"px"):(s.style.maxHeight=e.style.maxHeight,e.style.overflow="hidden");var a;return i==="vscroll"?(a=new rl({enableRtl:r},s),a.scrollStep=X(".e-"+i+"-bar",e).offsetHeight/2):(a=new Qv({enableRtl:r},s),a.scrollStep=X(".e-"+i+"-bar",e).offsetWidth),s}function Xo(o,e,t){if(o){var i=X(".e-menu-parent",e);i?(!t||t===i)&&(o.destroy(),e.parentElement.appendChild(i),ee(e)):(o.destroy(),ee(e))}}var Xv=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ui=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Ev="enter",YC="escape",wr="e-focused",Av="e-menu-header",Ki="e-selected",Np="e-separator",yc="uparrow",Ba="downarrow",Fh="leftarrow",$o="rightarrow",bc="home",Tv="end",Lv="tab",QC="e-caret",Sc="e-menu-item",XC="e-disabled",kv="e-menu-hide",$C="e-icons",KC="e-rtl",Cc="e-menu-popup",QH="Template",GL=function(o){Xv(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ui([C("id")],e.prototype,"itemId",void 0),ui([C("parentId")],e.prototype,"parentId",void 0),ui([C("text")],e.prototype,"text",void 0),ui([C("iconCss")],e.prototype,"iconCss",void 0),ui([C("url")],e.prototype,"url",void 0),ui([C("separator")],e.prototype,"separator",void 0),ui([C("items")],e.prototype,"children",void 0),e}(Re),Mc=function(o){Xv(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ui([C(null)],e.prototype,"iconCss",void 0),ui([C("")],e.prototype,"id",void 0),ui([C(!1)],e.prototype,"separator",void 0),ui([Wt([],e)],e.prototype,"items",void 0),ui([C("")],e.prototype,"text",void 0),ui([C("")],e.prototype,"url",void 0),ui([C()],e.prototype,"htmlAttributes",void 0),e}(Re),XH=function(o){Xv(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ui([C("SlideDown")],e.prototype,"effect",void 0),ui([C(400)],e.prototype,"duration",void 0),ui([C("ease")],e.prototype,"easing",void 0),e}(Re),YL=function(o){Xv(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.navIdx=[],r.animation=new It({}),r.isTapHold=!1,r.tempItem=[],r.showSubMenuOn="Auto",r.isAnimationNone=!1,r.isKBDAction=!1,r}return e.prototype.preRender=function(){if(!this.isMenu){var t=void 0;if(this.element.tagName==="EJS-CONTEXTMENU"){t=this.createElement("ul",{id:kt(this.getModuleName()),className:"e-control e-lib e-"+this.getModuleName()});var i=V("ej2_instances",this.element);K([this.element],["e-control","e-lib","e-"+this.getModuleName()]),this.clonedElement=this.element,this.element=t,Ge("ej2_instances",i,this.element)}else{t=this.createElement("ul",{id:kt(this.getModuleName())}),dt([].slice.call(this.element.cloneNode(!0).children),t);var r=this.element.nextElementSibling;r?this.element.parentElement.insertBefore(t,r):this.element.parentElement.appendChild(t),this.clonedElement=t}this.clonedElement.style.display="none"}if(this.element.tagName==="EJS-MENU"){for(var n=this.element,s=V("ej2_instances",n),t=this.createElement("ul"),a=this.createElement("EJS-MENU",{className:"e-"+this.getModuleName()+"-wrapper"}),l=0,h=n.attributes.length;l<h;l++)t.setAttribute(n.attributes[l].nodeName,n.attributes[l].nodeValue);n.parentNode.insertBefore(a,n),ee(n),n=t,a.appendChild(n),Ge("ej2_instances",s,n),this.clonedElement=a,this.element=n,this.element.id||(this.element.id=kt(this.getModuleName()))}},e.prototype.render=function(){var t=this;this.initialize(),this.renderItems(),this.wireEvents(),this.renderComplete();var i=this.getWrapper();this.template&&this.enableScrolling&&(this.isReact||this.isAngular)&&requestAnimationFrame(function(){co(t.createElement,i,t.element,"hscroll",t.enableRtl)})},e.prototype.enableTouchScroll=function(t){var i=0;this.touchStartFn=function(r){i=r.touches[0].clientY},this.touchMoveFn=function(r){var n=r.touches[0].clientY,s=i-n,a=t.scrollTop===0,l=t.scrollTop+t.clientHeight===t.scrollHeight;(a&&s<0||l&&s>0)&&r.preventDefault(),i=n},t.addEventListener("touchstart",this.touchStartFn,{passive:!1}),t.addEventListener("touchmove",this.touchMoveFn,{passive:!1})},e.prototype.touchOutsideHandler=function(t){var i=t.target;j(i,".e-"+this.getModuleName()+"-wrapper")||this.closeMenu()},e.prototype.initialize=function(){var t=this.getWrapper();t||(t=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"}),this.isMenu?this.element.parentElement.insertBefore(t,this.element):document.body.appendChild(t)),this.cssClass&&Y([t],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.enableRtl&&t.classList.add(KC),t.appendChild(this.element),this.isMenu&&this.hamburgerMode&&(this.target||this.createHeaderContainer(t)),this.defaultOption=this.showItemOnClick},e.prototype.renderItems=function(){if(!this.items.length){var t=At.createJsonFromElement(this.element,{fields:{child:"items"}});this.setProperties({items:t},!0),qe()&&!this.isMenu?this.element=this.removeChildElement(this.element):this.element.innerHTML=""}var i=this.createItems(this.items);if(dt(Array.prototype.slice.call(i.children),this.element),this.element.classList.add("e-menu-parent"),this.isMenu){if(!this.hamburgerMode&&this.element.classList.contains("e-vertical")&&this.setBlankIconStyle(this.element),this.enableScrolling){var r=this.getWrapper();this.element.classList.contains("e-vertical")?co(this.createElement,r,this.element,"vscroll",this.enableRtl):co(this.createElement,r,this.element,"hscroll",this.enableRtl)}}else this.element.parentElement.setAttribute("role","dialog"),this.element.parentElement.setAttribute("aria-label","context menu")},e.prototype.wireEvents=function(){var t=this.getWrapper();if(this.target){for(var i=void 0,r=Oe(this.target),n=0,s=r.length;n<s;n++)i=r[n],this.isMenu?E.add(i,"click",this.menuHeaderClickHandler,this):B.isIos?new Fr(i,{tapHold:this.touchHandler.bind(this)}):E.add(i,"contextmenu",this.cmenuHandler,this);if(this.targetElement=i,!this.isMenu){E.add(this.targetElement,"scroll",this.scrollHandler,this);for(var a=0,l=uv(this.targetElement);a<l.length;a++){var h=l[a];E.add(h,"scroll",this.scrollHandler,this)}}}B.isDevice||(this.delegateMoverHandler=this.moverHandler.bind(this),this.delegateMouseDownHandler=this.mouseDownHandler.bind(this),E.add(this.isMenu?document:t,"mouseover",this.delegateMoverHandler,this),E.add(document,"mousedown",this.delegateMouseDownHandler,this),E.add(document,"keydown",this.domKeyHandler,this),!this.isMenu&&!this.target&&E.add(document,"scroll",this.scrollHandler,this)),this.delegateClickHandler=this.clickHandler.bind(this),E.add(document,"click",this.delegateClickHandler,this),this.wireKeyboardEvent(t),this.rippleFn=Vi(t,{selector:"."+Sc}),!this.isMenu&&this.enableScrolling&&(this.enableTouchScroll(t),document.addEventListener("touchstart",this.touchOutsideHandler.bind(this),{passive:!0}))},e.prototype.wireKeyboardEvent=function(t){var i={downarrow:Ba,uparrow:yc,enter:Ev,leftarrow:Fh,rightarrow:$o,escape:YC};this.isMenu&&(i.home=bc,i.end=Tv,i.tab=Lv),new $i(t,{keyAction:this.keyBoardHandler.bind(this),keyConfigs:i})},e.prototype.mouseDownHandler=function(t){j(t.target,".e-"+this.getModuleName()+"-wrapper")!==this.getWrapper()&&!j(t.target,".e-"+this.getModuleName()+"-popup")&&this.closeMenu(this.isMenu?null:this.navIdx.length,t)},e.prototype.keyHandler=function(t){(t.keyCode===38||t.keyCode===40)&&t.target&&(t.target.classList.contains("e-contextmenu")||t.target.classList.contains("e-menu-item"))&&t.preventDefault()},e.prototype.domKeyHandler=function(t){t.keyCode===27&&(this.isMenuVisible()&&t.stopImmediatePropagation(),t.action=YC,this.leftEscKeyHandler(t))},e.prototype.keyBoardHandler=function(t){var i="",r=t.target,n=this.isMenu&&!this.hamburgerMode&&!this.element.classList.contains("e-vertical")&&this.navIdx.length<1;if(t.preventDefault(),this.enableScrolling&&t.keyCode===13&&r.classList.contains("e-scroll-nav")&&this.removeLIStateByClass([wr,Ki],[j(r,".e-"+this.getModuleName()+"-wrapper")]),this.isKBDAction=!0,n)switch(t.action){case $o:i=$o,t.action=Ba;break;case Fh:i=Fh,t.action=yc;break;case Ba:i=Ba,t.action=$o;break;case yc:i=yc,t.action="";break}else if(this.enableRtl)switch(t.action){case Fh:n=!0,i=Fh,t.action=$o;break;case $o:n=!0,i=$o,t.action=Fh;break}switch(t.action){case Ba:case yc:case Tv:case bc:case Lv:this.upDownKeyHandler(t);break;case $o:this.rightEnterKeyHandler(t);break;case Fh:this.leftEscKeyHandler(t);break;case Ev:this.hamburgerMode&&r.tagName==="SPAN"&&r.classList.contains("e-menu-icon")?this.menuHeaderClickHandler(t):this.rightEnterKeyHandler(t);break}this.isAnimationNone&&(this.isKBDAction=!1),n&&(t.action=i)},e.prototype.upDownKeyHandler=function(t){var i=this.getUlByNavIdx(),r=t.action===Ba||t.action===bc||t.action===Lv?0:i.childElementCount-1,n=r,s=this.getLIByClass(i,wr);s&&(t.action!==Tv&&t.action!==bc&&(n=this.getIdx(i,s)),s.classList.remove(wr),t.action!==Tv&&t.action!==bc&&(t.action===Ba?n++:n--,n===(t.action===Ba?i.childElementCount:-1)&&(n=r)));var a=i.children[n];n=this.isValidLI(a,n,t.action),i.children[n].classList.add(wr),i.children[n].focus()},e.prototype.isValidLI=function(t,i,r){var n=this.getUlByNavIdx(),s=r===Ba||r===bc||r===Lv?0:n.childElementCount-1;return(t.classList.contains(Np)||t.classList.contains(XC)||t.classList.contains(kv))&&(r===Ba&&i===n.childElementCount-1||r===yc&&i===0?i=s:r===Ba||r===$o||r==="tab"&&t.classList.contains(Np)?i++:i--),t=n.children[i],t&&(t.classList.contains(Np)||t.classList.contains(XC)||t.classList.contains(kv))&&(i=this.isValidLI(t,i,r)),i},e.prototype.getUlByNavIdx=function(t){var i=this;if(t===void 0&&(t=this.navIdx.length),this.isMenu){var r=[this.getWrapper()].concat([].slice.call(Oe("."+Cc)))[t],n=[],s=Oe("."+Cc);return s.forEach(function(a){(i.element.id===a.id.split("-")[2]||a.id.split("-")[2]+"-"+a.id.split("-")[3])&&n.push(a)}),r=[this.getWrapper()].concat([].slice.call(n))[t],g(r)?null:X(".e-menu-parent",r)}else return!document.body.contains(this.element)&&t===0?null:this.getWrapper().children[t]},e.prototype.rightEnterKeyHandler=function(t){var i,r=this.getUlByNavIdx(),n=this.getLIByClass(r,wr);if(n){var s=this.getIdx(r,n),a=this.navIdx.concat(s),l=this.getItem(a);if(l.items.length)this.navIdx.push(s),this.keyType="right",this.action=t.action,this.openMenu(n,l,-1,-1,t);else if(t.action===Ev){this.isMenu&&this.navIdx.length===0?this.removeLIStateByClass([Ki],[this.getWrapper()]):n.classList.remove(wr),n.classList.add(Ki),i={element:n,item:l,event:t},this.trigger("select",i);var h=n.querySelector(".e-menu-url");if(l.url&&h)switch(h.getAttribute("target")){case"_blank":window.open(l.url,"_blank");break;case"_parent":window.parent.location.href=l.url;break;default:window.location.href=l.url}this.closeMenu(null,t);var u=this.getLIByClass(this.getUlByNavIdx(),Ki);u&&(u.classList.add(wr),u.focus())}}},e.prototype.leftEscKeyHandler=function(t){this.navIdx.length?(this.keyType="left",this.closeMenu(this.navIdx.length,t)):t.action===YC&&this.closeMenu(null,t)},e.prototype.scrollHandler=function(t){this.closeMenu(null,t)},e.prototype.touchHandler=function(t){this.isTapHold=!0,this.cmenuHandler(t.originalEvent)},e.prototype.cmenuHandler=function(t){t.preventDefault(),this.currentTarget=t.target,this.isCMenu=!0,this.pageX=t.changedTouches?t.changedTouches[0].pageX+1:t.pageX+1,this.pageY=t.changedTouches?t.changedTouches[0].pageY+1:t.pageY+1,this.closeMenu(null,t),this.isCMenu&&(this.canOpen(t.target)&&this.openMenu(null,null,this.pageY,this.pageX,t),this.isCMenu=!1)},e.prototype.closeMenu=function(t,i,r){var n=this;if(t===void 0&&(t=0),i===void 0&&(i=null),this.isMenuVisible()){var s=void 0,a,l=this.getWrapper(),h=void 0,u,c=this.getPopups(),d=!1,p=this.isMenu?c.length+1:l.childElementCount,f=this.isMenu&&p!==1?X(".e-ul",c[p-2]):Oe(".e-menu-parent",l)[p-1];if(this.isMenu&&f.classList.contains("e-menu")&&(s=this.getLIByClass(f,Ki),s&&s.classList.remove(Ki),d=!0),!d){var v=i&&i.target&&this.getLI(i.target);v?this.cli=v:this.cli=f.children[0],a=this.navIdx.length?this.getItem(this.navIdx):null,u=a?a.items:this.items,h={element:f,parentItem:a,items:u,event:i,cancel:!1,isFocused:!0},this.trigger("beforeClose",h,function(m){var y,S,b="",w,I=!m.cancel;(I||n.isCMenu)&&(n.isMenu?(y=j(f,"."+Cc),n.hamburgerMode&&(y.parentElement.style.minHeight="",j(f,".e-menu-item").setAttribute("aria-expanded","false")),n.unWireKeyboardEvent(y),Xo(fr(y.children[0],rl),y.children[0]),w=fr(y,Gn),w.hide(),b=y.id,w.destroy(),ee(y)):(n.isContextMenuClosed=!1,n.toggleAnimation(f,!1)),S={element:f,parentItem:a,items:u},n.trigger("onClose",S),n.navIdx.pop(),n.navIdx.length===0&&i&&i.type==="keyup"&&(n.showSubMenu=!1),n.isMenu||(E.remove(f,"keydown",n.keyHandler),n.keyType==="right"&&(n.keyType=""))),n.updateReactTemplate();var x,M,D,A=n.getWrapper()&&n.getUlByNavIdx();if(n.isCMenu&&(n.canOpen(i.target)&&n.openMenu(null,null,n.pageY,n.pageX,i),n.isCMenu=!1),n.isMenu&&A&&b.length){var L=RegExp;x=new L("(.*)-ej2menu-"+n.element.id+"-popup").exec(b)[1],M=A.querySelector('[id="'+x+'"]'),D=v&&A.querySelector('[id="'+v.id+'"]')}else A&&(M=A.querySelector(".e-menu-item.e-selected"),D=v&&A.querySelector('[id="'+v.id+'"]'));var T=v&&v.querySelectorAll(".e-menu-item");if(I&&n.hamburgerMode&&t&&!T.length)n.afterCloseMenu(i);else if(I&&!n.hamburgerMode&&M&&!D&&n.keyType!=="left"&&(n.navIdx.length||!n.isMenu&&n.navIdx.length===0)){var k=i&&i.target.classList&&(i.target.classList.contains("e-vscroll")||i.target.classList.contains("e-scroll-nav"))?j(i.target,".e-menu-wrapper"):null;k?(k=k.querySelector(".e-menu-item"),(n.showItemOnClick||k&&n.getIndex(k.id,!0).length<=n.navIdx.length)&&n.closeMenu(n.navIdx[n.navIdx.length-1],i,!0)):i&&i.target.classList&&i.target.classList.contains("e-nav-arrow")||n.closeMenu(n.navIdx[n.navIdx.length-1],i)}else if(I&&!r&&!t&&(n.hamburgerMode&&n.navIdx.length||n.navIdx.length===1&&v&&A!==v.parentElement))n.closeMenu(null,i);else if(I&&g(t)&&n.navIdx.length)n.closeMenu(null,i);else if(I&&!n.isMenu&&!t&&n.navIdx.length===0&&!n.isMenusClosed&&!n.isCmenuHover)n.isMenusClosed=!0,n.closeMenu(0,i);else if(I&&n.isMenu&&i&&i.target&&n.navIdx.length!==0&&j(i.target,".e-menu-parent.e-control"))n.closeMenu(0,i);else if(I&&!n.isMenu&&Oe(".e-menu-parent",l)[t-1]&&i.which===3)n.closeMenu(null,i);else{if(I&&(n.keyType==="right"||n.keyType==="click"))n.afterCloseMenu(i);else{var F=n.getUlByNavIdx(),R=n.getLIByClass(F,Ki);if(R&&(R.setAttribute("aria-expanded","false"),R.classList.remove(Ki),(m.isFocused&&v||n.keyType==="left")&&(R.classList.add(wr),(!i.target||!i.target.classList.contains("e-edit-template"))&&R.focus())),!I&&n.hamburgerMode&&v&&v.getAttribute("aria-expanded")==="false"&&v.getAttribute("aria-haspopup")==="true"){j(v,".e-menu-parent.e-control")?n.navIdx=[]:n.navIdx.pop(),n.navIdx.push(n.cliIdx);var N=n.getItem(n.navIdx);v.setAttribute("aria-expanded","true"),n.openMenu(v,N,-1,-1,i)}}n.navIdx.length<1&&(n.showSubMenuOn==="Hover"||n.showSubMenuOn==="Click")&&(n.showItemOnClick=n.defaultOption,n.showSubMenuOn="Auto")}n.removeStateWrapper()})}}},e.prototype.updateReactTemplate=function(){if(this.isReact&&this.template&&this.navIdx.length===0){var t=void 0;this.portals&&(t=this.portals.splice(0,this.items.length)),this.clearTemplate(["template"]),this.portals=t,this.renderReactTemplates()}},e.prototype.getMenuItemModel=function(t,i){if(g(t))return null;g(i)&&(i=0);var r=this.getFields(i);return{text:t[r.text],id:t[r.id],items:t[r.child],separator:t[r.separator],iconCss:t[r.iconCss],url:t[r.url]}},e.prototype.getPopups=function(){var t=this,i=[];return[].slice.call(document.querySelectorAll("."+Cc)).forEach(function(r){!g(r.querySelector("."+Sc))&&t.getIndex(r.querySelector("."+Sc).id,!0).length&&i.push(r)}),i},e.prototype.isMenuVisible=function(){return this.navIdx.length>0||this.element.classList.contains("e-contextmenu")&&gr(this.element).valueOf()},e.prototype.canOpen=function(t){var i=!0;if(this.filter){i=!1;for(var r=this.filter.split(" "),n=0,s=r.length;n<s;n++)if(j(t,"."+r[n])){i=!0;break}}return i},e.prototype.openMenu=function(t,i,r,n,s,a){var l=this;r===void 0&&(r=0),n===void 0&&(n=0),s===void 0&&(s=null),a===void 0&&(a=this.targetElement);var h=this.getWrapper();this.lItem=t;var u=this.element.id!==""?this.element.id:"menu";if(this.isMenusClosed=!1,g(r)&&(r=-1),g(n)&&(n=-1),t){if(this.uList=this.createItems(i[this.getField("children",this.navIdx.length-1)]),!this.isMenu&&B.isDevice){h.lastChild.style.display="none";var c={text:i[this.getField("text")].toString(),iconCss:$C+" e-previous"};this.template&&(i.iconCss=(i.iconCss||"")+$C+" e-previous");var d=new Mc(this.items[0],"items",this.template?i:c,!0),p=this.createItems([d]).children[0];p.classList.add(Av),this.uList.insertBefore(p,this.uList.children[0])}this.isMenu?(this.popupWrapper=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper "+Cc,id:t.id+"-ej2menu-"+u+"-popup"}),this.popupWrapper.setAttribute("role","navigation"),this.popupWrapper.setAttribute("aria-label",i.text+"-menu-popup"),this.hamburgerMode?(r=t.offsetHeight,t.appendChild(this.popupWrapper)):document.body.appendChild(this.popupWrapper),this.isNestedOrVertical=this.element.classList.contains("e-vertical")||this.navIdx.length!==1,this.popupObj=this.generatePopup(this.popupWrapper,this.uList,t,this.isNestedOrVertical),this.template&&this.renderReactTemplates(),this.hamburgerMode?this.calculateIndentSize(this.uList,t):(this.cssClass&&Y([this.popupWrapper],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.popupObj.hide()),!this.hamburgerMode&&!this.showItemOnClick&&this.hoverDelay?(window.clearInterval(this.timer),this.timer=window.setTimeout(function(){l.triggerBeforeOpen(t,l.uList,i,s,0,0,"menu")},this.hoverDelay)):this.triggerBeforeOpen(t,this.uList,i,s,0,0,"menu")):(this.uList.style.zIndex=this.element.style.zIndex,h.appendChild(this.uList),!this.showItemOnClick&&this.hoverDelay?(window.clearInterval(this.timer),this.timer=window.setTimeout(function(){l.triggerBeforeOpen(t,l.uList,i,s,r,n,"none")},this.hoverDelay)):this.triggerBeforeOpen(t,this.uList,i,s,r,n,"none"))}else if(this.uList=this.element,this.uList.style.zIndex=Fs(a||this.element).toString(),g(s)){var f=document.createEvent("MouseEvents");f.initEvent("click",!0,!1);var v=this.copyObject(f,{});v.target=v.srcElement=a,v.currentTarget=a,this.triggerBeforeOpen(t,this.uList,i,v,r,n,"none")}else this.triggerBeforeOpen(t,this.uList,i,s,r,n,"none")},e.prototype.copyObject=function(t,i){for(var r in t)i[""+r]=t[""+r];return i},e.prototype.calculateIndentSize=function(t,i){var r=getComputedStyle(i),n=parseInt(r.textIndent,10);this.navIdx.length<2&&!i.classList.contains("e-blankicon")?n*=2:n+=n/4,t.style.textIndent=n+"px";var s=t.querySelectorAll(".e-blankicon");if(s&&s.length)for(var a=t.querySelector(".e-menu-icon"),l=getComputedStyle(a),h=parseInt(l.marginRight,10)+a.offsetWidth+n,u=0;u<s.length;u++)s[u].style.textIndent=h+"px"},e.prototype.generatePopup=function(t,i,r,n){var s=this,a=new Gn(t,{actionOnScroll:this.hamburgerMode?"none":"reposition",relateTo:r,collision:this.hamburgerMode?{X:"none",Y:"none"}:{X:n||this.enableRtl?"none":"flip",Y:"fit"},position:n&&!this.hamburgerMode?{X:"right",Y:"top"}:{X:"left",Y:"bottom"},targetType:"relative",enableRtl:this.enableRtl,content:i,open:function(){var l=X(".e-menu-vscroll",a.element);l&&(l.style.height="inherit",l.style.maxHeight="");var h=X(".e-ul",a.element);a.element.style.maxHeight="",h.focus(),s.triggerOpen(h)}});return a},e.prototype.createHeaderContainer=function(t){t=t||this.getWrapper();var i=this.createElement("span",{className:"e-"+this.getModuleName()+"-header"}),r=this.enableHtmlSanitizer?Bt.sanitize(this.title):this.title,n=this.createElement("span",{className:"e-"+this.getModuleName()+"-title",innerHTML:r}),s=this.createElement("span",{className:"e-icons e-"+this.getModuleName()+"-icon",attrs:{tabindex:"0"}});i.appendChild(n),i.appendChild(s),t.insertBefore(i,this.element)},e.prototype.openHamburgerMenu=function(t){this.hamburgerMode&&this.triggerBeforeOpen(null,this.element,null,t,0,0,"hamburger")},e.prototype.closeHamburgerMenu=function(t){var i=this,r={element:this.element,parentItem:null,event:t,items:this.items,cancel:!1};this.trigger("beforeClose",r,function(n){n.cancel||(i.closeMenu(null,t),i.element.classList.add("e-hide-menu"),i.trigger("onClose",{element:i.element,parentItem:null,items:i.items}))})},e.prototype.callFit=function(t,i,r,n,s){return hv(t,null,{X:i,Y:r},{top:n,left:s})},e.prototype.triggerBeforeOpen=function(t,i,r,n,s,a,l){var h=this,u=t?r[this.getField("children",this.navIdx.length-1)]:this.items,c={element:i,items:u,parentItem:r,event:n,cancel:!1,top:s,left:a,showSubMenuOn:"Auto"},d=l,p;this.trigger("beforeOpen",c,function(f){switch(d){case"menu":h.hamburgerMode||(f.showSubMenuOn!=="Auto"&&(h.showItemOnClick=!h.defaultOption,h.showSubMenuOn=f.showSubMenuOn),h.top=f.top,h.left=f.left),h.popupWrapper.style.display="block",h.hamburgerMode||(h.popupWrapper.style.maxHeight=h.popupWrapper.getBoundingClientRect().height+"px",h.enableScrolling&&co(h.createElement,h.popupWrapper,h.uList,"vscroll",h.enableRtl),h.checkScrollOffset(n)),!h.hamburgerMode&&!h.left&&!h.top?(h.popupObj.refreshPosition(h.lItem,!0),h.left=parseInt(h.popupWrapper.style.left,10),h.top=parseInt(h.popupWrapper.style.top,10),h.enableRtl&&(h.left=h.isNestedOrVertical?h.left-h.popupWrapper.offsetWidth-h.lItem.parentElement.offsetWidth+2:h.left-h.popupWrapper.offsetWidth+h.lItem.offsetWidth),h.template&&(h.isReact||h.isAngular)?requestAnimationFrame(function(){h.collision(),h.popupWrapper.style.display=""}):(h.collision(),h.popupWrapper.style.display="")):(h.popupObj.collision={X:"none",Y:"none"},h.popupWrapper.style.display="");break;case"none":h.top=f.top,h.left=f.left,h.isContextMenuClosed=!0,p=f.element,h.enableScrolling&&h.isCMenu&&p&&p.parentElement&&(p.style.height=p.parentElement.style.height);break;case"hamburger":f.cancel||(h.element.classList.remove("e-hide-menu"),h.triggerOpen(h.element));break}if(d!=="hamburger")if(f.cancel)h.isMenu?(h.popupObj.destroy(),ee(h.popupWrapper)):i.className.indexOf("e-ul")>-1&&ee(i),h.navIdx.pop();else if(h.isMenu)if(h.hamburgerMode)h.popupWrapper.style.top=h.top+"px",h.popupWrapper.style.left="0px",h.toggleAnimation(h.popupWrapper);else{h.setBlankIconStyle(h.popupWrapper),h.wireKeyboardEvent(h.popupWrapper),Vi(h.popupWrapper,{selector:"."+Sc}),h.popupWrapper.style.left=h.left+"px",h.popupWrapper.style.top=h.top+"px";var v=h.animationSettings.effect!=="None"?{name:h.animationSettings.effect,duration:h.animationSettings.duration,timingFunction:h.animationSettings.easing}:null;h.popupObj.show(v,h.lItem),B.isDevice&&(h.popupWrapper.style.left=h.left+"px")}else h.setBlankIconStyle(h.uList),h.setPosition(h.lItem,h.uList,h.top,h.left),h.toggleAnimation(h.uList);if(h.keyType==="right"){var m=h.getUlByNavIdx();if(t.classList.remove(wr),h.isMenu&&h.navIdx.length===1&&h.removeLIStateByClass([Ki],[h.getWrapper()]),t.classList.add(Ki),h.action===Ev){var y={element:t,item:r,event:n};h.trigger("select",y)}t.focus(),m=h.getUlByNavIdx();var S=h.isValidLI(m.children[0],0,h.action);m.children[S].classList.add(wr),m.children[S].focus()}})},e.prototype.collision=function(){var t;if(t=is(this.popupWrapper,null,this.left,this.top),(this.isNestedOrVertical||this.enableRtl)&&(t.indexOf("right")>-1||t.indexOf("left")>-1)){this.popupObj.collision.X="none";var i=j(this.lItem,".e-"+this.getModuleName()+"-wrapper").offsetWidth;this.left=this.enableRtl?br(this.lItem,this.isNestedOrVertical?"right":"left","top").left:this.left-this.popupWrapper.offsetWidth-i+2}t=is(this.popupWrapper,null,this.left,this.top),(t.indexOf("left")>-1||t.indexOf("right")>-1)&&(this.left=this.callFit(this.popupWrapper,!0,!1,this.top,this.left).left),this.popupWrapper.style.left=this.left+"px"},e.prototype.setBlankIconStyle=function(t){var i=[].slice.call(t.getElementsByClassName("e-blankicon"));if(i.length){var r=t.querySelector(".e-menu-item:not(.e-blankicon):not(.e-separator)");if(r){var n=r.querySelector(".e-menu-icon");if(n){var s=this.enableRtl?{padding:"paddingRight",margin:"marginLeft"}:{padding:"paddingLeft",margin:"marginRight"},a=getComputedStyle(n),l=parseInt(a.fontSize,10);parseInt(a.width,10)&&parseInt(a.width,10)>l&&(l=parseInt(a.width,10));var h=l+parseInt(a[s.margin],10)+parseInt(getComputedStyle(r)[s.padding],10)+"px";i.forEach(function(u){u.style[s.padding]=h})}}}},e.prototype.checkScrollOffset=function(t){var i=this.getWrapper();if(i.children[0].classList.contains("e-menu-hscroll")&&this.navIdx.length===1){var r=g(t)?this.element:j(t.target,"."+Sc),n=X(".e-hscroll-bar",i);n.scrollLeft>r.offsetLeft&&(n.scrollLeft-=n.scrollLeft-r.offsetLeft);var s=n.scrollLeft+n.offsetWidth,a=r.offsetLeft+r.offsetWidth;s<a&&(n.scrollLeft+=a-s)}},e.prototype.setPosition=function(t,i,r,n){var s="px";if(this.toggleVisiblity(i),i===this.element||n>-1&&r>-1){var a=is(i,null,n,r);if(a.indexOf("right")>-1&&(n=n-i.offsetWidth),a.indexOf("bottom")>-1){var l=this.callFit(i,!1,!0,r,n);if(r=l.top-20,r<0){var h=pageYOffset+document.documentElement.clientHeight-i.getBoundingClientRect().height;h>-1&&(r=h)}}if(a=is(i,null,n,r),a.indexOf("left")>-1){var l=this.callFit(i,!0,!1,r,n);n=l.left}}else if(B.isDevice)if(!this.isMenu&&this.enableScrolling){var u=document.querySelector(".e-menu-vscroll");r=Number(u.style.top.replace("px","")),n=Number(u.style.left.replace("px",""))}else r=Number(this.element.style.top.replace(s,"")),n=Number(this.element.style.left.replace(s,""));else{var c=this.enableRtl?"left":"right",l=br(t,c,"top");r=l.top,n=l.left;var a=is(i,null,this.enableRtl?n-i.offsetWidth:n,r),d=a.indexOf("left")>-1||a.indexOf("right")>-1;d&&(l=br(t,this.enableRtl?"right":"left","top"),n=l.left),(this.enableRtl||d)&&(n=this.enableRtl&&d?n:n-i.offsetWidth),a.indexOf("bottom")>-1&&(this.isMenu||!this.enableScrolling)&&(l=this.callFit(i,!1,!0,r,n),r=l.top)}this.toggleVisiblity(i,!1),this.isCMenu&&this.enableScrolling&&i&&(i.style.height="");var p=j(this.element,".e-"+this.getModuleName()+"-wrapper");if(!this.isMenu&&this.enableScrolling&&i&&p&&p.offsetHeight>0){var f=j(i,".e-menu-vscroll");i.style.display="block",f&&Xo(fr(f,rl),f);var v=Math.ceil(this.getMenuWidth(i,i.offsetWidth,this.enableRtl)),m=co(this.createElement,p,i,"vscroll",this.enableRtl,p.offsetHeight);Object.assign(m.style,{top:r+"px",left:n+"px",width:v+"px",position:"absolute",display:"none"})}else i.style.top=r+s,i.style.left=n+s},e.prototype.getMenuWidth=function(t,i,r){var n=t.getElementsByClassName(QC)[0];return n&&(i+=parseInt(getComputedStyle(n)[r?"marginRight":"marginLeft"],10)),i<120?120:i},e.prototype.toggleVisiblity=function(t,i){i===void 0&&(i=!0),t.style.visibility=i?"hidden":"",t.style.display=i?"block":"none"},e.prototype.createItems=function(t){var i=this,r=this.navIdx?this.navIdx.length:0,n=this.getFields(r),s=this.hasField(t,this.getField("iconCss",r)),a={showIcon:s,moduleName:"menu",fields:n,template:this.template,itemNavigable:!0,itemCreating:function(h){h.curData[h.fields[n.id]]||(h.curData[h.fields[n.id]]=kt("menuitem")),g(h.curData.htmlAttributes)&&Object.defineProperty(h.curData,"htmlAttributes",{value:{},writable:!0,enumerable:!0,configurable:!0}),B.isIE?(h.curData.htmlAttributes.role||(h.curData.htmlAttributes.role="menuitem"),h.curData.htmlAttributes.tabindex||(h.curData.htmlAttributes.tabindex="-1")):Object.assign(h.curData.htmlAttributes,{role:h.curData.htmlAttributes.role||"menuitem",tabindex:h.curData.htmlAttributes.tabindex||"-1"}),i.isMenu&&!h.curData[i.getField("separator",r)]&&(h.curData.htmlAttributes["aria-label"]||(h.curData.htmlAttributes["aria-label"]=h.curData[h.fields.text]?h.curData[h.fields.text]:h.curData[h.fields.id])),h.curData[h.fields[n.iconCss]]===""&&(h.curData[h.fields[n.iconCss]]=null)},itemCreated:function(h){if(h.curData[i.getField("separator",r)]&&(h.item.classList.add(Np),h.curData.htmlAttributes.role||h.item.setAttribute("role","separator"),h.curData.htmlAttributes.ariaLabel||h.item.setAttribute("aria-label","separator")),s&&!h.curData[h.fields.iconCss]&&!h.curData[i.getField("separator",r)]&&h.item.classList.add("e-blankicon"),h.curData[h.fields.child]&&h.curData[h.fields.child].length){var u=i.createElement("span",{className:$C+" "+QC});h.item.appendChild(u),h.item.setAttribute("aria-haspopup","true"),h.item.setAttribute("aria-expanded","false"),h.item.classList.add("e-menu-caret-icon")}i.isMenu&&i.template&&(h.item.setAttribute("id",h.curData[h.fields.id].toString()),h.item.removeAttribute("data-uid"),h.item.classList.contains("e-level-1")&&h.item.classList.remove("e-level-1"),h.item.classList.contains("e-has-child")&&h.item.classList.remove("e-has-child"),h.item.removeAttribute("aria-level"));var c={item:h.curData,element:h.item};i.trigger("beforeItemRender",c)}};this.setProperties({items:this.items},!0),this.isMenu&&(a.templateID=this.element.id+QH);var l=At.createList(this.createElement,t,a,!this.template,this);return l.setAttribute("tabindex","0"),this.isMenu?l.setAttribute("role","menu"):l.setAttribute("role","menubar"),l},e.prototype.moverHandler=function(t){var i=t.target;this.liTrgt=i,this.isMenu||(this.isCmenuHover=!0);var r=this.getLI(i),n=r?j(r,".e-"+this.getModuleName()+"-wrapper"):this.getWrapper(),s=this.getWrapper(),a=new RegExp("-ej2menu-(.*)-popup"),l,h=!1;if(n){if(n.id!==""?l=a.exec(n.id)[1]:l=n.querySelector("ul").id,l!==this.element.id)if(this.removeLIStateByClass([wr,Ki],[this.getWrapper()]),this.navIdx.length)h=!0;else return;r&&j(r,".e-"+this.getModuleName()+"-wrapper")&&!h?(this.removeLIStateByClass([wr],this.isMenu?[n].concat(this.getPopups()):[n]),this.removeLIStateByClass([wr],this.isMenu?[s].concat(this.getPopups()):[s]),r.classList.add(wr),this.showItemOnClick||this.clickHandler(t)):this.isMenu&&this.showItemOnClick&&!h&&this.removeLIStateByClass([wr],[n].concat(this.getPopups())),this.isMenu&&(!this.showItemOnClick&&i.parentElement!==n&&!j(i,".e-"+this.getModuleName()+"-popup")&&(!r||r&&!this.getIndex(r.id,!0).length)&&this.showSubMenuOn!=="Hover"?(this.removeLIStateByClass([wr],[n]),this.navIdx.length&&(this.isClosed=!0,this.closeMenu(null,t))):h&&!this.showItemOnClick&&this.navIdx.length&&(this.isClosed=!0,this.closeMenu(null,t)),this.isClosed||this.removeStateWrapper(),this.isClosed=!1),this.isMenu||(this.isCmenuHover=!1)}},e.prototype.removeStateWrapper=function(){if(this.liTrgt){var t=j(this.liTrgt,".e-menu-vscroll");this.liTrgt.tagName==="DIV"&&t&&this.removeLIStateByClass([wr,Ki],[t])}},e.prototype.removeLIStateByClass=function(t,i){for(var r,n=function(a){t.forEach(function(l){r=X("."+l,i[a]),r&&r.classList.remove(l)})},s=0;s<i.length;s++)n(s)},e.prototype.getField=function(t,i){i===void 0&&(i=0);var r=this.fields[""+t];return typeof r=="string"?r:r[i]?r[i].toString():r[r.length-1].toString()},e.prototype.getFields=function(t){return t===void 0&&(t=0),{id:this.getField("itemId",t),iconCss:this.getField("iconCss",t),text:this.getField("text",t),url:this.getField("url",t),child:this.getField("children",t),separator:this.getField("separator",t)}},e.prototype.hasField=function(t,i){for(var r=0,n=t.length;r<n;r++)if(t[r][""+i])return!0;return!1},e.prototype.menuHeaderClickHandler=function(t){var i=j(t.target,".e-menu-wrapper");i&&i.querySelector("ul.e-menu-parent").id!==this.element.id||(this.element.className.indexOf("e-hide-menu")>-1?this.openHamburgerMenu(t):this.closeHamburgerMenu(t))},e.prototype.clickHandler=function(t){this.isTapHold=this.isTapHold?!1:this.isTapHold;var i=this.getWrapper(),r=t.target,n=this.cli=this.getLI(r),s=new RegExp("-ej2menu-(.*)-popup"),a=n?j(n,".e-"+this.getModuleName()+"-wrapper"):null,l=n&&a&&(this.isMenu?this.getIndex(n.id,!0).length>0:i.firstElementChild.id===a.firstElementChild.id);if(B.isDevice&&this.isMenu&&(this.removeLIStateByClass([wr],[i].concat(this.getPopups())),this.mouseDownHandler(t)),n&&a&&this.isMenu){var h=a.id?s.exec(a.id)[1]:a.querySelector(".e-menu-parent").id;if(this.element.id!==h)return}if(l&&t.type==="click"&&!n.classList.contains(Av)){this.setLISelected(n);var u=this.getIndex(n.id,!0),c=this.getItem(u),d={element:n,item:c,event:t};this.trigger("select",d)}if(l&&(t.type==="mouseover"||B.isDevice||this.showItemOnClick)){var p=void 0;if(n.classList.contains(Av)){p=i.children[this.navIdx.length-1],this.toggleAnimation(p);var f=this.getLIByClass(p,Ki);f&&f.classList.remove(Ki);var v=this.enableScrolling&&!this.isMenu?j(n.parentElement,".e-menu-vscroll"):null;v&&Xo(fr(v,rl),v),ee(n.parentNode),this.navIdx.pop()}else if(!n.classList.contains(Np)){this.showSubMenu=!0;var m=n.parentNode;if(g(m))return;if(this.cliIdx=this.getIdx(m,n),this.isMenu||!B.isDevice){var y=this.isMenu?Array.prototype.indexOf.call([i].concat(this.getPopups()),j(m,".e-"+this.getModuleName()+"-wrapper")):this.getIdx(i,m);if(this.navIdx[y]===this.cliIdx&&(this.showSubMenu=!1),y!==this.navIdx.length&&(t.type!=="mouseover"||this.showSubMenu)){var f=this.getLIByClass(m,Ki);f&&f.classList.remove(Ki),this.isClosed=!0,this.keyType="click",this.showItemOnClick&&(this.setLISelected(n),this.isMenu||(this.isCmenuHover=!0)),this.closeMenu(y+1,t),this.showItemOnClick&&(this.setLISelected(n),this.isMenu||(this.isCmenuHover=!1))}}this.isClosed||this.afterCloseMenu(t),this.isClosed=!1}}else if(r.tagName==="DIV"&&j(r,".e-menu-vscroll")&&(this.navIdx.length||!this.isMenu&&this.enableScrolling&&this.navIdx.length===0)){var S=this.isMenu?j(r,"."+Cc):j(r,".e-menu-vscroll"),b=this.isMenu?Array.prototype.indexOf.call(this.getPopups(),S)+1:this.getIdx(i,X("ul.e-menu-parent",S));b<this.navIdx.length&&(this.closeMenu(b+1,t),S&&this.removeLIStateByClass([wr,Ki],[S]))}else this.isMenu&&this.hamburgerMode&&r.tagName==="SPAN"&&r.classList.contains("e-menu-icon")?this.menuHeaderClickHandler(t):(r.tagName!=="UL"||(this.isMenu?r.parentElement.classList.contains("e-menu-wrapper")&&!this.getIndex(r.querySelector("."+Sc).id,!0).length:r.parentElement!==i))&&(n||this.removeLIStateByClass([Ki],[i]),(!this.isAnimationNone&&!n||n&&!n.querySelector("."+QC))&&(navigator.platform.toUpperCase().indexOf("MAC")<0||navigator.platform.toUpperCase().indexOf("MAC")>=0&&!t.ctrlKey)&&this.closeMenu(null,t))},e.prototype.afterCloseMenu=function(t){if(!g(t)){var i;if(this.showSubMenu){this.showItemOnClick&&this.navIdx.length===0?i=j(t.target,".e-menu-parent.e-control"):i=j(this.element,".e-menu-parent.e-control");var r=this.navIdx.concat(this.cliIdx),n=this.getItem(r);if(n&&n[this.getField("children",r.length-1)]&&n[this.getField("children",r.length-1)].length?((t.type==="mouseover"||B.isDevice&&this.isMenu)&&this.setLISelected(this.cli),(!this.hamburgerMode&&i||this.hamburgerMode&&this.cli.getAttribute("aria-expanded")==="false")&&(this.cli.setAttribute("aria-expanded","true"),this.navIdx.push(this.cliIdx),this.openMenu(this.cli,n,null,null,t))):t.type!=="mouseover"&&this.closeMenu(null,t),!i){var s=this.getUlByNavIdx(),a=this.getLIByClass(s,Ki);a&&(a.setAttribute("aria-expanded","false"),a.classList.remove(Ki))}}this.keyType=""}},e.prototype.setLISelected=function(t){var i=this.getLIByClass(t.parentElement,Ki);i&&i.classList.remove(Ki),this.isMenu||t.classList.remove(wr),t.classList.add(Ki)},e.prototype.getLIByClass=function(t,i){if(t&&t.children){for(var r=0,n=t.children.length;r<n;r++)if(t.children[r].classList.contains(i))return t.children[r]}return null},e.prototype.getItemIndex=function(t,i){var r;typeof t=="string"?r=t:r=t.id;var n=i!==!1,s=this.getIndex(r,n);return s},e.prototype.setItem=function(t,i,r){var n;r?n=i||t.id:n=i||t.text;var s=this.getIndex(n,r),a=this.getItem(s);Object.assign(a,t)},e.prototype.getItem=function(t){t=t.slice();var i=t.pop(),r=this.getItems(t);return r[i]},e.prototype.getItems=function(t){for(var i=this.items,r=0;r<t.length;r++)i=i[t[r]][this.getField("children",r)];return i},e.prototype.setItems=function(t,i){var r=this.getItems(i);r.splice(0,r.length);for(var n=0;n<t.length;n++)r.splice(n,0,t[n])},e.prototype.getIdx=function(t,i,r){r===void 0&&(r=!0);var n=!this.isMenu&&this.enableScrolling&&X(".e-menu-vscroll",t)?Oe(".e-menu-parent",t):Array.from(t.children),s=Array.prototype.indexOf.call(n,i);return r&&t.children[0].classList.contains(Av)&&s--,s},e.prototype.getLI=function(t){return t.tagName==="LI"&&t.classList.contains("e-menu-item")?t:j(t,"li.e-menu-item")},e.prototype.updateItemsByNavIdx=function(){for(var t=this.items,i=0,r=0;r<this.navIdx.length&&(t=t[r].items,!!t);r++){i++;var n=this.getUlByNavIdx(i);if(!n)break;this.updateItem(n,t)}},e.prototype.removeChildElement=function(t){for(;t.firstElementChild;)t.removeChild(t.firstElementChild);return t},e.prototype.onPropertyChanged=function(t,i){for(var r=this,n=this.getWrapper(),s=function(c){switch(c){case"cssClass":i.cssClass&&K([n],i.cssClass.split(" ")),t.cssClass&&Y([n],t.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":a.enableRtl?n.classList.add(KC):n.classList.remove(KC);break;case"showItemOnClick":a.unWireEvents(),a.showItemOnClick=t.showItemOnClick,a.wireEvents();break;case"enableScrolling":if(t.enableScrolling){var d;a.element.classList.contains("e-vertical")?co(a.createElement,n,a.element,"vscroll",a.enableRtl):co(a.createElement,n,a.element,"hscroll",a.enableRtl),a.getPopups().forEach(function(w){d=X(".e-ul",w),co(r.createElement,w,d,"vscroll",r.enableRtl)})}else{var p=n.children[0];a.element.classList.contains("e-vertical")||!a.isMenu?Xo(fr(p,rl),p):Xo(fr(p,Qv),p),n.style.overflow="",n.appendChild(a.element),a.getPopups().forEach(function(w){p=w.children[0],Xo(fr(p,rl),p),w.style.overflow=""})}break;case"items":{var f=void 0,v=void 0,m=void 0;if(a.isReact&&a.template&&a.clearTemplate(["template"]),Object.keys(i.items).length)for(var b=Object.keys(t.items),y=0;y<b.length;y++)v=a.getChangedItemIndex(t,[],Number(b[y])),v.length<=a.getWrapper().children.length&&(f=v.pop(),m=a.getItems(v),a.insertAfter([m[f]],m[f].text),a.removeItem(m,v,f),a.setItems(m,v)),v.length=0;else{if(a.updateItem(a.element,a.items),a.enableScrolling&&a.element.parentElement.classList.contains("e-custom-scroll")&&(a.element.classList.contains("e-vertical")?co(a.createElement,n,a.element,"vscroll",a.enableRtl):co(a.createElement,n,a.element,"hscroll",a.enableRtl)),!a.hamburgerMode)for(var y=1,S=n.childElementCount;y<S;y++)ee(n.lastElementChild);a.navIdx=[]}break}}},a=this,l=0,h=Object.keys(t);l<h.length;l++){var u=h[l];s(u)}},e.prototype.updateItem=function(t,i){if(qe()&&!this.isMenu)t=this.removeChildElement(t);else{if(this.enableScrolling){var r=this.getWrapper(),n=r.children[0];this.element.classList.contains("e-vertical")?Xo(fr(n,rl),n):Xo(fr(n,Qv),n)}t.innerHTML=""}var s=[].slice.call(this.createItems(i).children);s.forEach(function(a){t.appendChild(a)})},e.prototype.getChangedItemIndex=function(t,i,r){i.push(r);var n=Object.keys(t.items[r]).pop();if(n==="items"){var s=t.items[r],a=Object.keys(s.items).pop();a&&this.getChangedItemIndex(s,i,Number(a))}else n==="isParentArray"&&i.length>1&&i.pop();return i},e.prototype.removeItem=function(t,i,r){t.splice(r,1);var n=this.getWrapper().children;i.length<n.length&&ee(n[i.length].children[r])},e.prototype.unWireEvents=function(t){t===void 0&&(t=this.target);var i=this.getWrapper();if(t){for(var r=void 0,n=void 0,s=Oe(t),a=0,l=s.length;a<l;a++)r=s[a],this.isMenu?E.remove(r,"click",this.menuHeaderClickHandler):B.isIos?(n=fr(r,Fr),n&&n.destroy()):E.remove(r,"contextmenu",this.cmenuHandler);if(!this.isMenu){E.remove(this.targetElement,"scroll",this.scrollHandler);for(var h=0,u=uv(this.targetElement);h<u.length;h++){var c=u[h];E.remove(c,"scroll",this.scrollHandler)}}}B.isDevice||(E.remove(this.isMenu?document:i,"mouseover",this.delegateMoverHandler),E.remove(document,"mousedown",this.delegateMouseDownHandler),E.remove(document,"keydown",this.domKeyHandler),!this.isMenu&&!this.target&&E.remove(document,"scroll",this.scrollHandler)),E.remove(document,"click",this.delegateClickHandler),this.unWireKeyboardEvent(i),this.rippleFn(),!this.isMenu&&this.enableScrolling&&(i.removeEventListener("touchstart",this.touchStartFn),i.removeEventListener("touchmove",this.touchMoveFn),document.removeEventListener("touchstart",this.touchOutsideHandler))},e.prototype.unWireKeyboardEvent=function(t){var i=fr(t,$i);i&&i.destroy()},e.prototype.toggleAnimation=function(t,i){var r=this;i===void 0&&(i=!0);var n,s,a=this.enableScrolling&&!this.isMenu&&j(t,".e-menu-vscroll")?j(t,".e-menu-vscroll"):t;this.animationSettings.effect==="None"||!i?(this.hamburgerMode&&t&&(t.style.top="0px"),this.isAnimationNone=this.animationSettings.effect==="None",this.end(t,i)):this.animation.animate(a,{name:this.animationSettings.effect,duration:this.animationSettings.duration,timingFunction:this.animationSettings.easing,begin:function(l){r.hamburgerMode?(s=l.element.parentElement,l.element.style.position="absolute",s&&(n=s.offsetHeight),l.element.style.maxHeight=l.element.offsetHeight+"px",s&&(s.style.maxHeight="")):(l.element.style.display="block",l.element.style.maxHeight=r.isMenu?l.element.getBoundingClientRect().height+"px":l.element.scrollHeight+"px")},progress:function(l){r.hamburgerMode&&s&&(s.style.minHeight=n+l.element.offsetHeight+"px")},end:function(l){r.hamburgerMode?(l.element.style.position="",l.element.style.maxHeight="",s&&(s.style.minHeight=""),l.element.style.top="0px",l.element.children[0].focus(),r.triggerOpen(l.element.children[0])):r.end(l.element,i),r.isKBDAction=!1}})},e.prototype.triggerOpen=function(t){var i=this.navIdx.length?this.getItem(this.navIdx):null,r={element:t,parentItem:i,items:i?i.items:this.items};this.trigger("onOpen",r),this.isMenu||E.add(t,"keydown",this.keyHandler,this)},e.prototype.end=function(t,i){if(i&&this.isContextMenuClosed){(this.isMenu||!B.isDevice||!this.isMenu&&this.isAnimationNone&&B.isDevice)&&(t.style.display="block"),t.style.maxHeight="";var r=this.enableScrolling&&!this.isMenu?j(t,".e-menu-vscroll"):null;if(r&&(r.style.display="block"),this.triggerOpen(t),t.querySelector("."+wr)&&this.isKBDAction)t.querySelector("."+wr).focus();else{var n=this.getWrapper().children[this.getIdx(this.getWrapper(),t)-1];this.currentTarget?this.currentTarget.classList.contains("e-numerictextbox")||this.currentTarget.classList.contains("e-textbox")||this.currentTarget.tagName==="INPUT"||(n&&this.isKBDAction?n.querySelector("."+Ki).focus():this.element.focus()):n&&this.isKBDAction?n.querySelector("."+Ki).focus():this.element.focus()}}else{var r=this.enableScrolling&&!this.isMenu?j(t,".e-menu-vscroll"):null;if(r&&Xo(fr(r,rl),r),t===this.element){var s=this.getLIByClass(this.element,wr);s&&s.classList.remove(wr);var a=this.getLIByClass(this.element,Ki);a&&a.classList.remove(Ki),t.style.display="none",this.isAnimationNone=!1}else ee(t)}},e.prototype.getPersistData=function(){return""},e.prototype.getWrapper=function(){return j(this.element,".e-"+this.getModuleName()+"-wrapper")},e.prototype.getIndex=function(t,i,r,n,s,a){r===void 0&&(r=this.items),n===void 0&&(n=[]),s===void 0&&(s=!1),a===void 0&&(a=0);var l;a=s?a+1:0;for(var h=0,u=r.length;h<u;h++){l=r[h];var c=i?l[this.getField("itemId",a)]:l[this.getField("text",a)],d=l.htmlAttributes&&"id"in l.htmlAttributes?l.htmlAttributes.id:c;if(d===t){n.push(h);break}else if(l[this.getField("children",a)]&&l[this.getField("children",a)].length)if(n=this.getIndex(t,i,l[this.getField("children",a)],n,!0,a),n[n.length-1]===-1)h!==u-1&&n.pop();else{n.unshift(h);break}else h===u-1&&n.push(-1)}return!s&&n[0]===-1?[]:n},e.prototype.enableItems=function(t,i,r){i===void 0&&(i=!0);for(var n,s,a,l=XC,h,u=0;u<t.length;u++){if(a=this.getIndex(t[u],r),this.navIdx.length){if(a.length!==1){h=!1;for(var c=0,d=a.length-1;c<d;c++)if(a[c]!==this.navIdx[c]){h=!0;break}if(h)continue}}else if(a.length!==1)continue;s=a.pop(),n=this.getUlByNavIdx(a.length),n&&!g(s)&&(i?this.isMenu?(n.children[s].classList.remove(l),n.children[s].removeAttribute("aria-disabled")):B.isDevice&&!n.classList.contains("e-contextmenu")?n.children[s+1].classList.remove(l):n.children[s].classList.remove(l):this.isMenu?(n.children[s].classList.add(l),n.children[s].setAttribute("aria-disabled","true")):B.isDevice&&!n.classList.contains("e-contextmenu")?n.children[s+1].classList.add(l):n.children[s].classList.add(l))}},e.prototype.showItems=function(t,i){this.showHideItems(t,!1,i)},e.prototype.hideItems=function(t,i){this.showHideItems(t,!0,i)},e.prototype.showHideItems=function(t,i,r){for(var n,s,a,l,h=0;h<t.length;h++)if(a=this.getIndex(t[h],r),s=a.pop(),n=this.getUlByNavIdx(a.length),l=this.getItems(a),n){var u=r?n.children[s].id:l[s].text.toString();i&&u===t[h]?n.children[s].classList.add(kv):!i&&u===t[h]&&n.children[s].classList.remove(kv)}},e.prototype.removeItems=function(t,i){for(var r,n,s,a=0;a<t.length;a++)n=this.getIndex(t[a],i),r=n.pop(),s=this.getItems(n),g(r)||this.removeItem(s,n,r)},e.prototype.insertAfter=function(t,i,r){this.insertItems(t,i,r)},e.prototype.insertBefore=function(t,i,r){this.insertItems(t,i,r,!1)},e.prototype.insertItems=function(t,i,r,n){n===void 0&&(n=!0);for(var s,a,l,h,u,c=0;c<t.length;c++){l=this.getIndex(i,r),a=l.pop(),h=this.getItems(l),u=new Mc(h[0],"items",t[c],!0),u.parentObj=h[0].parentObj,h.splice(n?a+1:a,0,u);var d=this.isMenu?[this.getWrapper()].concat(this.getPopups()):[].slice.call(this.getWrapper().children);if(!g(a)&&l.length<d.length){a=n?a+1:a,s=this.createItems(h).children[a];var p=this.isMenu?X(".e-menu-parent",d[l.length]):d[l.length];p.insertBefore(s,p.children[a]),c===t.length-1&&!this.isMenu&&p.style.display==="block"&&(this.setPosition(null,p,parseFloat(p.style.top),parseFloat(p.style.left)),p.style.display="block")}}},e.prototype.removeAttributes=function(){var t=this;["top","left","display","z-index"].forEach(function(i){t.element.style.removeProperty(i)}),["role","tabindex","class","style"].forEach(function(i){i==="class"&&t.element.classList.contains("e-menu-parent")&&t.element.classList.remove("e-menu-parent"),(["class","style"].indexOf(i)===-1||!t.element.getAttribute(i))&&t.element.removeAttribute(i),t.isMenu&&i==="class"&&t.element.classList.contains("e-vertical")&&t.element.classList.remove("e-vertical")})},e.prototype.destroy=function(){var t=this.getWrapper();if(t){if(this.unWireEvents(),this.isMenu)this.closeMenu(),qe()&&!this.isMenu?this.element=this.removeChildElement(this.element):this.element.innerHTML="",this.removeAttributes(),t.parentNode.insertBefore(this.element,t),this.clonedElement=null;else{if(this.clonedElement.style.display="",this.clonedElement.tagName==="EJS-CONTEXTMENU")Y([this.clonedElement],["e-control","e-lib","e-"+this.getModuleName()]),this.element=this.clonedElement;else if(this.refreshing&&this.clonedElement.childElementCount&&this.clonedElement.children[0].tagName==="LI"&&this.setProperties({items:[]},!0),document.getElementById(this.clonedElement.id)){var i=this.clonedElement.nextElementSibling;i&&i!==t?this.clonedElement.parentElement.insertBefore(this.element,i):this.clonedElement.parentElement.appendChild(this.element),qe()&&!this.isMenu?this.element=this.removeChildElement(this.element):this.element.innerHTML="",dt([].slice.call(this.clonedElement.children),this.element),ee(this.clonedElement),this.removeAttributes()}this.clonedElement=null}ee(t),o.prototype.destroy.call(this),this.template&&this.clearTemplate(["template"])}this.rippleFn=null},ui([q()],e.prototype,"beforeItemRender",void 0),ui([q()],e.prototype,"beforeOpen",void 0),ui([q()],e.prototype,"onOpen",void 0),ui([q()],e.prototype,"beforeClose",void 0),ui([q()],e.prototype,"onClose",void 0),ui([q()],e.prototype,"select",void 0),ui([q()],e.prototype,"created",void 0),ui([C("")],e.prototype,"cssClass",void 0),ui([C(0)],e.prototype,"hoverDelay",void 0),ui([C(!1)],e.prototype,"showItemOnClick",void 0),ui([C("")],e.prototype,"target",void 0),ui([C("")],e.prototype,"filter",void 0),ui([C(null)],e.prototype,"template",void 0),ui([C(!1)],e.prototype,"enableScrolling",void 0),ui([C(!0)],e.prototype,"enableHtmlSanitizer",void 0),ui([be({itemId:"id",text:"text",parentId:"parentId",iconCss:"iconCss",url:"url",separator:"separator",children:"items"},GL)],e.prototype,"fields",void 0),ui([Wt([],Mc)],e.prototype,"items",void 0),ui([be({duration:400,easing:"ease",effect:"SlideDown"},XH)],e.prototype,"animationSettings",void 0),e=ui([bt],e),e}(Kt),QL=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Mi=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},ZC="e-vertical",Zi="e-toolbar-items",Ji="e-toolbar-item",po="e-rtl",vr="e-separator",Nv="e-popup-up-icon",Fp="e-popup-down-icon",bL="e-popup-open",SL="e-template",Yn="e-overlay",CL="e-toolbar-text",JC="e-popup-text",za="e-overflow-show",Fv="e-overflow-hide",$H="e-tbar-btn",bs="e-hor-nav",wL="e-scroll-nav",KH="e-toolbar-right",ZH="e-toolbar-left",xL="e-toolbar-center",ja="e-tbar-pos",JH="e-hscroll-content",eV="e-vscroll-content",ew="e-hscroll-bar",tV="e-hor-nav",Op="e-toolbar-pop",zl="e-toolbar-popup",iV="e-tbar-btn-text",Rp="e-nav-active",Pp="e-ignore",tw="e-popup-alone",fo="e-hidden",IL="e-toolbar-multirow",ML="e-multirow-pos",iw="e-multirow-separator",rw="e-extended-separator",DL="e-extended-toolbar",Ov="e-toolbar-extended",rV="e-expended-nav",nw="e-tbar-extended",$v=function(o){QL(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Mi([C("")],e.prototype,"id",void 0),Mi([C("")],e.prototype,"text",void 0),Mi([C("auto")],e.prototype,"width",void 0),Mi([C("")],e.prototype,"cssClass",void 0),Mi([C(!1)],e.prototype,"showAlwaysInPopup",void 0),Mi([C(!1)],e.prototype,"disabled",void 0),Mi([C("")],e.prototype,"prefixIcon",void 0),Mi([C("")],e.prototype,"suffixIcon",void 0),Mi([C(!0)],e.prototype,"visible",void 0),Mi([C("None")],e.prototype,"overflow",void 0),Mi([C("")],e.prototype,"template",void 0),Mi([C("Button")],e.prototype,"type",void 0),Mi([C("Both")],e.prototype,"showTextOn",void 0),Mi([C(null)],e.prototype,"htmlAttributes",void 0),Mi([C("")],e.prototype,"tooltipText",void 0),Mi([C("Left")],e.prototype,"align",void 0),Mi([q()],e.prototype,"click",void 0),Mi([C(-1)],e.prototype,"tabIndex",void 0),e}(Re),Hl=function(o){QL(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.resizeContext=r.resize.bind(r),r.orientationChangeContext=r.orientationChange.bind(r),r.keyConfigs={moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",moveDown:"downarrow",popupOpen:"enter",popupClose:"escape",tab:"tab",home:"home",end:"end"},r}return e.prototype.destroy=function(){var t=this;(this.isReact||this.isAngular)&&this.clearTemplate();var i=this.element.querySelectorAll(".e-control.e-btn");for([].slice.call(i).forEach(function(r){!g(r)&&!g(r.ej2_instances)&&!g(r.ej2_instances[0])&&!r.ej2_instances[0].isDestroyed&&r.ej2_instances[0].destroy()}),this.unwireEvents(),this.tempId.forEach(function(r){g(t.element.querySelector(r))||(document.body.appendChild(t.element.querySelector(r)).style.display="none")}),this.destroyItems();this.element.lastElementChild;)this.element.removeChild(this.element.lastElementChild);this.trgtEle&&(this.element.appendChild(this.ctrlTem),this.trgtEle=null,this.ctrlTem=null),this.popObj&&(this.popObj.destroy(),ee(this.popObj.element)),this.activeEle&&(this.activeEle=null),this.popObj=null,this.tbarAlign=null,this.tbarItemsCol=[],this.remove(this.element,"e-toolpop"),this.cssClass&&K([this.element],this.cssClass.split(" ")),this.element.removeAttribute("style"),["aria-disabled","aria-orientation","role"].forEach(function(r){return t.element.removeAttribute(r)}),o.prototype.destroy.call(this)},e.prototype.preRender=function(){var t={enableCollision:this.enableCollision,scrollStep:this.scrollStep};this.trigger("beforeCreate",t),this.enableCollision=t.enableCollision,this.scrollStep=t.scrollStep,this.scrollModule=null,this.popObj=null,this.tempId=[],this.tbarItemsCol=this.items,this.isVertical=!!this.element.classList.contains(ZC),this.isExtendedOpen=!1,this.popupPriCount=0,this.enableRtl&&this.add(this.element,po)},e.prototype.wireEvents=function(){E.add(this.element,"click",this.clickHandler,this),window.addEventListener("resize",this.resizeContext),window.addEventListener("orientationchange",this.orientationChangeContext),this.allowKeyboard&&this.wireKeyboardEvent()},e.prototype.wireKeyboardEvent=function(){this.keyModule=new $i(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs}),E.add(this.element,"keydown",this.docKeyDown,this),this.updateTabIndex("0")},e.prototype.updateTabIndex=function(t){var i=this.element.querySelector("."+Ji+":not(."+Yn+" ):not(."+vr+" ):not(."+fo+" )");if(!g(i)&&!g(i.firstElementChild)){var r=i.firstElementChild.getAttribute("data-tabindex");r&&r==="-1"&&i.firstElementChild.tagName!=="INPUT"&&i.firstElementChild.setAttribute("tabindex",t)}},e.prototype.unwireKeyboardEvent=function(){this.keyModule&&(E.remove(this.element,"keydown",this.docKeyDown),this.keyModule.destroy(),this.keyModule=null)},e.prototype.docKeyDown=function(t){if(t.target.tagName!=="INPUT"){var i=!g(this.popObj)&&gr(this.popObj.element)&&this.overflowMode!=="Extended";t.keyCode===9&&t.target.classList.contains("e-hor-nav")===!0&&i&&this.popObj.hide({name:"FadeOut",duration:100});var r=t.keyCode===40||t.keyCode===38||t.keyCode===35||t.keyCode===36;r&&t.preventDefault()}},e.prototype.unwireEvents=function(){E.remove(this.element,"click",this.clickHandler),this.destroyScroll(),this.unwireKeyboardEvent(),window.removeEventListener("resize",this.resizeContext),window.removeEventListener("orientationchange",this.orientationChangeContext),document.removeEventListener("scroll",this.clickEvent),document.removeEventListener("click",this.scrollEvent),this.scrollEvent=null,this.clickEvent=null},e.prototype.clearProperty=function(){this.tbarEle=[],this.tbarAlgEle={lefts:[],centers:[],rights:[]}},e.prototype.docEvent=function(t){var i=j(t.target,".e-popup");this.popObj&&gr(this.popObj.element)&&!i&&this.overflowMode==="Popup"&&this.popObj.hide({name:"FadeOut",duration:100})},e.prototype.destroyScroll=function(){this.scrollModule&&(this.tbarAlign&&this.add(this.scrollModule.element,ja),this.scrollModule.destroy(),this.scrollModule=null)},e.prototype.destroyItems=function(){if(this.element&&[].slice.call(this.element.querySelectorAll("."+Ji)).forEach(function(i){ee(i)}),this.tbarAlign){var t=this.element.querySelector("."+Zi);[].slice.call(t.children).forEach(function(i){ee(i)}),this.tbarAlign=!1,this.remove(t,ja)}this.clearProperty()},e.prototype.destroyMode=function(){this.scrollModule&&(this.remove(this.scrollModule.element,po),this.destroyScroll()),this.remove(this.element,nw),this.remove(this.element,DL);var t=this.element.querySelector(".e-toolbar-multirow");t&&this.remove(t,IL),this.popObj&&this.popupRefresh(this.popObj.element,!0)},e.prototype.add=function(t,i){t.classList.add(i)},e.prototype.remove=function(t,i){t.classList.remove(i)},e.prototype.elementFocus=function(t){var i=t.firstElementChild;i?(i.focus(),this.activeEleSwitch(t)):t.focus()},e.prototype.clstElement=function(t,i){var r;return t&&this.popObj&&gr(this.popObj.element)?r=this.popObj.element.querySelector("."+Ji):this.element===i||t?r=this.element.querySelector("."+Ji+":not(."+Yn+" ):not(."+vr+" ):not(."+fo+" )"):r=j(i,"."+Ji),r},e.prototype.keyHandling=function(t,i,r,n,s){var a=this.popObj,l=this.element,h={name:"FadeOut",duration:100},u=i.action==="moveUp"?"previous":"next",c,d;switch(i.action){case"moveRight":if(this.isVertical)return;l===r?this.elementFocus(t):n||this.eleFocus(t,"next");break;case"moveLeft":if(this.isVertical)return;n||this.eleFocus(t,"previous");break;case"home":case"end":if(t){var p=j(t,".e-popup"),f=this.element.querySelector("."+Ov);this.overflowMode==="Extended"&&f&&f.classList.contains("e-popup-open")&&(p=i.action==="end"?f:null),p?gr(this.popObj.element)&&(d=[].slice.call(p.children),i.action==="home"?c=this.focusFirstVisibleEle(d):c=this.focusLastVisibleEle(d)):(d=this.element.querySelectorAll("."+Zi+" ."+Ji+":not(."+vr+")"),i.action==="home"?c=this.focusFirstVisibleEle(d):c=this.focusLastVisibleEle(d)),c&&this.elementFocus(c)}break;case"moveUp":case"moveDown":if(this.isVertical)i.action==="moveUp"?this.eleFocus(t,"previous"):this.eleFocus(t,"next");else if(a&&j(r,".e-popup")){var v=a.element,m=v.firstElementChild;u==="previous"&&m===t?v.lastElementChild.firstChild.focus():u==="next"&&v.lastElementChild===t?m.firstChild.focus():this.eleFocus(t,u)}else i.action==="moveDown"&&a&&gr(a.element)&&this.elementFocus(t);break;case"tab":if(!s&&!n){var y=t.firstElementChild;l===r&&(this.activeEle?this.activeEle.focus():(this.activeEleRemove(y),y.focus()))}break;case"popupClose":a&&this.overflowMode!=="Extended"&&a.hide(h);break;case"popupOpen":if(!n)return;a&&!gr(a.element)?(a.element.style.top=l.offsetHeight+"px",a.show({name:"FadeIn",duration:100})):a.hide(h);break}},e.prototype.keyActionHandler=function(t){var i=t.target;if(!(i.tagName==="INPUT"||i.tagName==="TEXTAREA"||this.element.classList.contains(Yn))){t.preventDefault();var r=i.classList.contains(bs),n=i.classList.contains(wL),s=this.clstElement(r,i);(s||n)&&this.keyHandling(s,t,i,r,n)}},e.prototype.disable=function(t){var i=this.element;t?i.classList.add(Yn):i.classList.remove(Yn),this.activeEle&&this.activeEle.setAttribute("tabindex",this.activeEle.getAttribute("data-tabindex")),this.scrollModule&&this.scrollModule.disable(t),this.popObj&&(gr(this.popObj.element)&&this.overflowMode!=="Extended"&&this.popObj.hide(),i.querySelector("#"+i.id+"_nav").setAttribute("tabindex",t?"-1":"0"))},e.prototype.eleContains=function(t){return t.classList.contains(vr)||t.classList.contains(Yn)||t.getAttribute("disabled")||t.classList.contains(fo)||!gr(t)||!t.classList.contains(Ji)},e.prototype.focusFirstVisibleEle=function(t){for(var i,r=0;r<t.length;){var n=t[parseInt(r.toString(),10)];if(!n.classList.contains(fo)&&!n.classList.contains(Yn))return n;r++}return i},e.prototype.focusLastVisibleEle=function(t){for(var i,r=t.length-1;r>=0;){var n=t[parseInt(r.toString(),10)];if(!n.classList.contains(fo)&&!n.classList.contains(Yn))return n;r--}return i},e.prototype.eleFocus=function(t,i){var r=Object(t)[i+"ElementSibling"];if(r){var n=this.eleContains(r);if(n){this.eleFocus(r,i);return}this.elementFocus(r)}else if(this.tbarAlign){var s=Object(t.parentElement)[i+"ElementSibling"];if(!g(s)&&s.children.length===0&&(s=Object(s)[i+"ElementSibling"]),!g(s)&&s.children.length>0)if(i==="next"){var a=s.querySelector("."+Ji);this.eleContains(a)?this.eleFocus(a,i):(a.firstElementChild.focus(),this.activeEleSwitch(a))}else{var a=s.lastElementChild;this.eleContains(a)?this.eleFocus(a,i):this.elementFocus(a)}}else if(!g(t)){var l=this.element.querySelectorAll("."+Zi+" ."+Ji+":not(."+vr+"):not(."+Yn+"):not(."+fo+")");i==="next"&&l?this.elementFocus(l[0]):i==="previous"&&l&&this.elementFocus(l[l.length-1])}},e.prototype.clickHandler=function(t){var i=this,r=t.target,n=this.element,s=!g(j(r,"."+Op)),a=r.classList,l=j(r,"."+bs);l||(l=r),!n.children[0].classList.contains("e-hscroll")&&!n.children[0].classList.contains("e-vscroll")&&a.contains(bs)&&(a=r.querySelector(".e-icons").classList),(a.contains(Nv)||a.contains(Fp))&&this.popupClickHandler(n,l,po);var h,u=j(t.target,"."+Ji);if(!((g(u)||u.classList.contains(Yn))&&!l.classList.contains(bs))){if(u){var c=this.items[this.tbarEle.indexOf(u)];h=c}var d={originalEvent:t,item:h},p=h&&!g(h.click)&&typeof h.click=="object"?!g(h.click.observers)&&h.click.observers.length>0:!g(h)&&!g(h.click);p&&this.trigger("items["+this.tbarEle.indexOf(u)+"].click",d),d.cancel||this.trigger("clicked",d,function(f){!g(i.popObj)&&s&&!f.cancel&&i.overflowMode==="Popup"&&f.item&&f.item.type!=="Input"&&i.popObj.hide({name:"FadeOut",duration:100})})}},e.prototype.popupClickHandler=function(t,i,r){var n=this.popObj;gr(n.element)?(i.classList.remove(Rp),n.hide({name:"FadeOut",duration:100})):(t.classList.contains(r)&&(n.enableRtl=!0,n.position={X:"left",Y:"top"}),n.offsetX===0&&!t.classList.contains(r)&&(n.enableRtl=!1,n.position={X:"right",Y:"top"}),this.overflowMode==="Extended"&&(n.element.style.minHeight="0px",n.width=this.getToolbarPopupWidth(this.element)),n.dataBind(),n.refreshPosition(),n.element.style.top=this.getElementOffsetY()+"px",i.classList.add(Rp),n.show({name:"FadeIn",duration:100}))},e.prototype.getToolbarPopupWidth=function(t){var i=window.getComputedStyle(t);return parseFloat(i.width)+parseFloat(i.borderRightWidth)*2},e.prototype.render=function(){var t=this;this.initialize(),this.renderControl(),this.wireEvents(),this.clickEvent=this.docEvent.bind(this),this.scrollEvent=this.docEvent.bind(this),this.renderComplete(),this.isReact&&this.portals&&this.portals.length>0&&this.renderReactTemplates(function(){t.refreshOverflow()})},e.prototype.initialize=function(){var t=Le(this.width),i=Le(this.height);(B.info.name!=="msie"||this.height!=="auto"||this.overflowMode==="MultiRow")&&Ye(this.element,{height:i}),Ye(this.element,{width:t});var r={role:"toolbar","aria-disabled":"false","aria-orientation":this.isVertical?"vertical":"horizontal"};Ie(this.element,r),this.cssClass&&Y([this.element],this.cssClass.split(" "))},e.prototype.renderControl=function(){var t=this.element;this.trgtEle=t.children.length>0?t.querySelector("div"):null,this.tbarAlgEle={lefts:[],centers:[],rights:[]},this.renderItems(),this.renderLayout()},e.prototype.renderLayout=function(){this.renderOverflowMode(),this.tbarAlign&&this.itemPositioning(),this.popObj&&this.popObj.element.childElementCount>1&&this.checkPopupRefresh(this.element,this.popObj.element)&&this.popupRefresh(this.popObj.element,!1),this.separator()},e.prototype.itemsAlign=function(t,i){var r,n;this.tbarEle||(this.tbarEle=[]);for(var s=0;s<t.length;s++)r=this.renderSubComponent(t[parseInt(s.toString(),10)],s),this.tbarEle.indexOf(r)===-1&&this.tbarEle.push(r),this.tbarAlign||this.tbarItemAlign(t[parseInt(s.toString(),10)],i,s),n=i.querySelector(".e-toolbar-"+t[parseInt(s.toString(),10)].align.toLowerCase()),n?(t[parseInt(s.toString(),10)].showAlwaysInPopup&&t[parseInt(s.toString(),10)].overflow!=="Show"||this.tbarAlgEle[(t[parseInt(s.toString(),10)].align+"s").toLowerCase()].push(r),n.appendChild(r)):i.appendChild(r);if(this.isReact){var a="portals";this.notify("render-react-toolbar-template",this[""+a]),this.renderReactTemplates()}},e.prototype.changeOrientation=function(){var t=this.element;this.isVertical?(t.classList.remove(ZC),this.isVertical=!1,(this.height==="auto"||this.height==="100%")&&(t.style.height=this.height),t.setAttribute("aria-orientation","horizontal")):(t.classList.add(ZC),this.isVertical=!0,t.setAttribute("aria-orientation","vertical"),Ye(this.element,{height:Le(this.height),width:Le(this.width)})),this.destroyMode(),this.refreshOverflow()},e.prototype.initScroll=function(t,i){if(!this.scrollModule&&this.checkOverflow(t,i[0])){this.tbarAlign&&this.element.querySelector("."+Zi+" ."+xL).removeAttribute("style"),this.isVertical?this.scrollModule=new rl({scrollStep:this.scrollStep,enableRtl:this.enableRtl},i[0]):this.scrollModule=new Qv({scrollStep:this.scrollStep,enableRtl:this.enableRtl},i[0]),this.cssClass&&Y([i[0]],this.cssClass.split(" "));var r=this.scrollModule.element.querySelector("."+ew+", .e-vscroll-bar");r&&r.removeAttribute("tabindex"),this.remove(this.scrollModule.element,ja),Ye(this.element,{overflow:"hidden"})}},e.prototype.itemWidthCal=function(t){var i=this,r=0,n;return[].slice.call(Oe("."+Ji,t)).forEach(function(s){gr(s)&&(n=window.getComputedStyle(s),r+=i.isVertical?s.offsetHeight:s.offsetWidth,r+=parseFloat(i.isVertical?n.marginTop:n.marginRight),r+=parseFloat(i.isVertical?n.marginBottom:n.marginLeft))}),r},e.prototype.getScrollCntEle=function(t){var i=this.isVertical?".e-vscroll-content":".e-hscroll-content";return t.querySelector(i)},e.prototype.checkOverflow=function(t,i){if(g(t)||g(i)||!gr(t))return!1;var r=this.isVertical?t.offsetHeight:t.offsetWidth,n=this.isVertical?i.offsetHeight:i.offsetWidth;(this.tbarAlign||this.scrollModule||r===n)&&(n=this.itemWidthCal(this.scrollModule?this.getScrollCntEle(i):i));var s=t.querySelector("."+bs),a=t.querySelector("."+wL),l=0;return s?l=this.isVertical?s.offsetHeight:s.offsetWidth:a&&(l=this.isVertical?a.offsetHeight*2:a.offsetWidth*2),r>=n&&a?!1:n>r-l},e.prototype.refreshOverflow=function(){this.resize()},e.prototype.toolbarAlign=function(t){this.tbarAlign&&(this.add(t,ja),this.itemPositioning())},e.prototype.renderOverflowMode=function(){var t=this.element,i=t.querySelector("."+Zi),r=this.popupPriCount>0;if(t&&t.children.length>0)switch(this.offsetWid=t.offsetWidth,this.remove(this.element,"e-toolpop"),B.info.name==="msie"&&this.height==="auto"&&(t.style.height=""),this.overflowMode){case"Scrollable":g(this.scrollModule)&&this.initScroll(t,[].slice.call(t.getElementsByClassName(Zi)));break;case"Popup":this.add(this.element,"e-toolpop"),this.tbarAlign&&this.removePositioning(),(this.checkOverflow(t,i)||r)&&this.setOverflowAttributes(t),this.toolbarAlign(i);break;case"MultiRow":this.add(i,IL),this.checkOverflow(t,i)&&this.tbarAlign&&(this.removePositioning(),this.add(i,ML)),t.style.overflow==="hidden"&&(t.style.overflow=""),(B.info.name==="msie"||t.style.height!=="auto")&&(t.style.height="auto");break;case"Extended":this.add(this.element,DL),(this.checkOverflow(t,i)||r)&&(this.tbarAlign&&this.removePositioning(),this.setOverflowAttributes(t)),this.toolbarAlign(i)}},e.prototype.setOverflowAttributes=function(t){this.createPopupEle(t,[].slice.call(Oe("."+Zi+" ."+Ji,t)));var i={tabindex:"0",role:"button","aria-haspopup":"true","aria-label":"overflow"};Ie(this.element.querySelector("."+bs),i)},e.prototype.separator=function(){var t=this.element,i=[].slice.call(t.querySelectorAll("."+vr)),r=t.querySelector("."+iw),n=t.querySelector("."+rw),s=this.overflowMode==="MultiRow"?r:n;s!==null&&(this.overflowMode==="MultiRow"?s.classList.remove(iw):this.overflowMode==="Extended"&&s.classList.remove(rw));for(var a=0;a<=i.length-1;a++)i[parseInt(a.toString(),10)].offsetLeft<30&&i[parseInt(a.toString(),10)].offsetLeft!==0&&(this.overflowMode==="MultiRow"?i[parseInt(a.toString(),10)].classList.add(iw):this.overflowMode==="Extended"&&i[parseInt(a.toString(),10)].classList.add(rw))},e.prototype.createPopupEle=function(t,i){var r=t.querySelector("."+bs),n=this.isVertical;r||this.createPopupIcon(t),r=t.querySelector("."+bs);var s=n?r.offsetHeight:r.offsetWidth,a=(n?t.offsetHeight:t.offsetWidth)-s;this.element.classList.remove("e-rtl"),Ye(this.element,{direction:"initial"}),this.checkPriority(t,i,a,!0),this.enableRtl&&this.element.classList.add("e-rtl"),this.element.style.removeProperty("direction"),this.createPopup()},e.prototype.pushingPoppedEle=function(t,i,r,n,s){var a=t.element,l=[].slice.call(Oe("."+zl,a.querySelector("."+Zi))),h=Oe("."+za,r),u=0,c=0;l.forEach(function(v,m){h=Oe("."+za,r),v.classList.contains(za)&&h.length>0?t.tbResize&&h.length>m?(r.insertBefore(v,h[parseInt(m.toString(),10)]),++c):(r.insertBefore(v,r.children[h.length]),++c):v.classList.contains(za)||t.tbResize&&v.classList.contains(Fv)&&r.children.length>0&&h.length===0?(r.insertBefore(v,r.firstChild),++c):v.classList.contains(Fv)?i.push(v):t.tbResize?(r.insertBefore(v,r.childNodes[u+c]),++u):r.appendChild(v),v.classList.contains(vr)?Ye(v,{display:"",height:s+"px"}):Ye(v,{display:"",height:n+"px"})}),i.forEach(function(v){r.appendChild(v)});for(var d=Oe("."+Ji,a.querySelector("."+Zi)),p=d.length-1;p>=0;p--){var f=d[parseInt(p.toString(),10)];if(f.classList.contains(vr)&&this.overflowMode!=="Extended")Ye(f,{display:"none"});else break}},e.prototype.createPopup=function(){var t=this.element,i,r;this.overflowMode==="Extended"&&(r=t.querySelector("."+vr),i=t.style.height==="auto"||t.style.height===""?null:r&&r.offsetHeight);var n=t.querySelector("."+Ji+":not(."+vr+"):not(."+zl+")"),s=t.style.height==="auto"||t.style.height===""?null:n&&n.offsetHeight,a,l=[];if(X("#"+t.id+"_popup."+Op,t))a=X("#"+t.id+"_popup."+Op,t);else{var h=this.createElement("div",{id:t.id+"_popup",className:Op+" "+Ov}),u=this.createElement("div",{id:t.id+"_popup",className:Op});a=this.overflowMode==="Extended"?h:u}this.pushingPoppedEle(this,l,a,s,i),this.popupInit(t,a)},e.prototype.getElementOffsetY=function(){return this.overflowMode==="Extended"&&window.getComputedStyle(this.element).getPropertyValue("box-sizing")==="border-box"?this.element.clientHeight:this.element.offsetHeight},e.prototype.popupInit=function(t,i){if(this.popObj){if(this.overflowMode!=="Extended"){var s=this.popObj.element;Ye(s,{maxHeight:"",display:"block"}),Ye(s,{maxHeight:s.offsetHeight+"px",display:""})}}else{t.appendChild(i),this.cssClass&&Y([i],this.cssClass.split(" ")),Ye(this.element,{overflow:""});var r=new Gn(null,{relateTo:this.element,offsetY:this.isVertical?0:this.getElementOffsetY(),enableRtl:this.enableRtl,open:this.popupOpen.bind(this),close:this.popupClose.bind(this),collision:{Y:this.enableCollision?"flip":"none"},position:this.enableRtl?{X:"left",Y:"top"}:{X:"right",Y:"top"}});if(this.overflowMode==="Extended"&&(r.width=this.getToolbarPopupWidth(this.element),r.offsetX=0),r.appendTo(i),document.addEventListener("scroll",this.clickEvent),document.addEventListener("click",this.scrollEvent),this.overflowMode!=="Extended"&&(r.element.style.maxHeight=r.element.offsetHeight+"px"),this.isVertical&&(r.element.style.visibility="hidden"),this.isExtendedOpen){var n=this.element.querySelector("."+bs);n.classList.add(Rp),wi(n.firstElementChild,[Nv],[Fp]),this.element.querySelector("."+Ov).classList.add(bL)}else r.hide();this.popObj=r}},e.prototype.tbarPopupHandler=function(t){this.overflowMode==="Extended"&&(t?this.add(this.element,nw):this.remove(this.element,nw))},e.prototype.popupOpen=function(t){var i=this.popObj;this.isVertical||(i.offsetY=this.getElementOffsetY(),i.dataBind());var r=this.popObj.element,n=this.popObj.element.parentElement,s=n.querySelector("."+bs);s.setAttribute("aria-expanded","true"),this.overflowMode==="Extended"?i.element.style.minHeight="":(Ye(i.element,{height:"auto",maxHeight:""}),i.element.style.maxHeight=i.element.offsetHeight+"px");var a=r.offsetTop+r.offsetHeight+br(n).top,l=s.firstElementChild;s.classList.add(Rp),wi(l,[Nv],[Fp]),this.tbarPopupHandler(!0);var h=g(window.scrollY)?0:window.scrollY;if(!this.isVertical&&window.innerHeight+h<a&&this.element.offsetTop<r.offsetHeight){var u=r.offsetHeight-(a-window.innerHeight-h+5);i.height=u+"px";for(var c=0;c<=r.childElementCount;c++){var d=r.children[parseInt(c.toString(),10)];if(d.offsetTop+d.offsetHeight>u){u=d.offsetTop;break}}this.overflowMode!=="Extended"&&Ye(i.element,{maxHeight:u+"px"})}else if(this.isVertical&&this.overflowMode!=="Extended"){var p=this.element.getBoundingClientRect();Ye(i.element,{maxHeight:p.top+this.element.offsetHeight+"px",bottom:0,visibility:""})}if(i){var f=r.getBoundingClientRect();f.right>document.documentElement.clientWidth&&f.width>n.getBoundingClientRect().width&&(i.collision={Y:"none"},i.dataBind()),i.refreshPosition()}},e.prototype.popupClose=function(t){var i=this.element,r=i.querySelector("."+bs);r.setAttribute("aria-expanded","false");var n=r.firstElementChild;r.classList.remove(Rp),wi(n,[Fp],[Nv]),this.tbarPopupHandler(!1)},e.prototype.checkPriority=function(t,i,r,n){for(var s=this.popupPriCount>0,a=i.length,l=r,h,u,c=0,d=0,p=0,f=function(x,M){var D=!1;return M.forEach(function(A){x.classList.contains(A)&&(D=!0)}),D},v=a-1;v>=0;v--){var m=void 0,y=window.getComputedStyle(i[parseInt(v.toString(),10)]);this.isVertical?(m=parseFloat(y.marginTop),m+=parseFloat(y.marginBottom)):(m=parseFloat(y.marginRight),m+=parseFloat(y.marginLeft));var S=i[parseInt(v.toString(),10)]===this.tbarEle[0];S&&(this.tbarEleMrgn=m),h=this.isVertical?i[parseInt(v.toString(),10)].offsetHeight:i[parseInt(v.toString(),10)].offsetWidth;var b=S?h+m:h;if(f(i[parseInt(v.toString(),10)],[tw])&&s&&(i[parseInt(v.toString(),10)].classList.add(zl),this.isVertical?Ye(i[parseInt(v.toString(),10)],{display:"none",minHeight:b+"px"}):Ye(i[parseInt(v.toString(),10)],{display:"none",minWidth:b+"px"}),p++),this.isVertical?u=i[parseInt(v.toString(),10)].offsetTop+i[parseInt(v.toString(),10)].offsetHeight+m>r:u=i[parseInt(v.toString(),10)].offsetLeft+i[parseInt(v.toString(),10)].offsetWidth+m>r,u){if(i[parseInt(v.toString(),10)].classList.contains(vr)){if(this.overflowMode==="Extended"){var w=i[parseInt(v.toString(),10)];f(w,[vr,Pp])&&(i[parseInt(v.toString(),10)].classList.add(zl),p++),d++}else if(this.overflowMode==="Popup"){if(c>0&&d===p){var w=i[v+d+(c-1)];f(w,[vr,Pp])&&Ye(w,{display:"none"})}c++,d=0,p=0}}else d++;i[parseInt(v.toString(),10)].classList.contains(za)&&n?r-=(this.isVertical?i[parseInt(v.toString(),10)].offsetHeight:i[parseInt(v.toString(),10)].offsetWidth)+m:f(i[parseInt(v.toString(),10)],[vr,Pp])?r-=(this.isVertical?i[parseInt(v.toString(),10)].offsetHeight:i[parseInt(v.toString(),10)].offsetWidth)+m:(i[parseInt(v.toString(),10)].classList.add(zl),this.isVertical?Ye(i[parseInt(v.toString(),10)],{display:"none",minHeight:b+"px"}):Ye(i[parseInt(v.toString(),10)],{display:"none",minWidth:b+"px"}),p++)}}if(n){var I=Oe("."+Ji+":not(."+zl+")",this.element);this.checkPriority(t,I,l,!1)}},e.prototype.createPopupIcon=function(t){var i=t.id.concat("_nav"),r="e-"+t.id.concat("_nav "+tV);r=this.overflowMode==="Extended"?r+" "+rV:r;var n=this.createElement("div",{id:i,className:r});(B.info.name==="msie"||B.info.name==="edge")&&n.classList.add("e-ie-align");var s=this.createElement("div",{className:Fp+" e-icons"});n.appendChild(s),n.setAttribute("tabindex","0"),n.setAttribute("role","button"),t.appendChild(n)},e.prototype.tbarPriRef=function(t,i,r,n,s,a,l,h,u){var c=h,d=this.popObj.element,p="."+Ji+":not(."+vr+"):not(."+za+")",f=Oe("."+zl+":not(."+za+")",d).length,v=function(w,I){return w.classList.contains(I)};if(Oe(p,t).length===0){var m=t.children[i-(i-r)-1],y=!g(m)&&v(m,Pp);if(!g(m)&&v(m,vr)&&!gr(m)||y){m.style.display="unset";var S=m.offsetWidth+parseFloat(window.getComputedStyle(m).marginRight)*2,b=m.previousElementSibling;a+S<l||s?(t.insertBefore(n,t.children[i+c-(i-r)]),g(b)||(b.style.display="")):(Ye(n,u),b.classList.contains(vr)&&(b.style.display="none")),m.style.display=""}else t.insertBefore(n,t.children[i+c-(i-r)])}else t.insertBefore(n,t.children[i+c-f])},e.prototype.popupRefresh=function(t,i){var r=this,n=this.element,s=this.isVertical,a=n.querySelector("."+Zi),l=n.querySelector("."+bs);if(!g(l)){a.removeAttribute("style"),t.style.display="block";var h;s?h=n.offsetHeight-(l.offsetHeight+a.offsetHeight):h=n.offsetWidth-(l.offsetWidth+a.offsetWidth);var u=0;[].slice.call(t.children).forEach(function(c){u+=r.popupEleWidth(c),Ye(c,{position:""})}),h+(s?l.offsetHeight:l.offsetWidth)>u&&this.popupPriCount===0&&(i=!0),this.popupEleRefresh(h,t,i),t.style.display="",t.children.length===0&&l&&this.popObj&&(ee(l),l=null,this.popObj.destroy(),ee(this.popObj.element),this.popObj=null)}},e.prototype.ignoreEleFetch=function(t,i){var r=[].slice.call(i.querySelectorAll("."+Pp)),n=[],s=0;if(r.length>0)r.forEach(function(a){n.push([].slice.call(i.children).indexOf(a))});else return 0;return n.forEach(function(a){a<=t&&s++}),s},e.prototype.checkPopupRefresh=function(t,i){i.style.display="block";var r=this.popupEleWidth(i.firstElementChild);i.firstElementChild.style.removeProperty("Position");var n=t.offsetWidth-t.querySelector("."+bs).offsetWidth,s=t.querySelector("."+Zi).offsetWidth;return i.style.removeProperty("display"),n>r+s},e.prototype.popupEleWidth=function(t){t.style.position="absolute";var i=this.isVertical?t.offsetHeight:t.offsetWidth,r=t.querySelector("."+iV);if(t.classList.contains("e-tbtn-align")||t.classList.contains(JC)){var n=t.children[0];!g(r)&&t.classList.contains(JC)?r.style.display="none":!g(r)&&t.classList.contains(CL)&&(r.style.display="block"),n.style.minWidth="0%",i=parseFloat(this.isVertical?t.style.minHeight:t.style.minWidth),n.style.minWidth="",n.style.minHeight="",g(r)||(r.style.display="")}return i},e.prototype.popupEleRefresh=function(t,i,r){for(var n=this.popupPriCount>0,s=this.tbarEle,a,l,h=this.element.querySelector("."+Zi),u=0,c=function(S){if(S.classList.contains(tw)&&n&&!r)return"continue";var b=d.popupEleWidth(S);if(S===d.tbarEle[0]&&(b+=d.tbarEleMrgn),S.style.position="",b<t||r){var w={minWidth:S.style.minWidth,height:S.style.height,minHeight:S.style.minHeight};if(Ye(S,{minWidth:"",height:"",minHeight:""}),S.classList.contains(Fv)||S.classList.remove(zl),l=d.tbarEle.indexOf(S),d.tbarAlign){var I=d.items[parseInt(l.toString(),10)].align;l=d.tbarAlgEle[(I+"s").toLowerCase()].indexOf(S),s=d.tbarAlgEle[(I+"s").toLowerCase()],h=d.element.querySelector("."+Zi+" .e-toolbar-"+I.toLowerCase())}var x=0;d.overflowMode!=="Extended"&&s.slice(0,l).forEach(function(M){(M.classList.contains(za)||M.classList.contains(vr))&&(M.classList.contains(vr)&&(M.style.display="",t-=M.offsetWidth),x++)}),u=d.ignoreEleFetch(l,h),S.classList.contains(za)?(d.tbarPriRef(h,l,x,S,r,b,t,u,w),t-=S.offsetWidth):l===0?(h.insertBefore(S,h.firstChild),t-=S.offsetWidth):(a=Oe("."+za,d.popObj.element).length,h.insertBefore(S,h.children[l+u-a]),t-=S.offsetWidth),S.style.height=""}else return"break"},d=this,p=0,f=[].slice.call(i.children);p<f.length;p++){var v=f[p],m=c(v);if(m==="break")break}var y=this.checkOverflow(this.element,this.element.getElementsByClassName(Zi)[0]);y&&!r&&this.renderOverflowMode()},e.prototype.removePositioning=function(){var t=this.element.querySelector("."+Zi);if(!(g(t)||!t.classList.contains(ja))){this.remove(t,ja);var i=[].slice.call(t.childNodes);i[1].removeAttribute("style"),i[2].removeAttribute("style")}},e.prototype.refreshPositioning=function(){var t=this.element.querySelector("."+Zi);this.add(t,ja),this.itemPositioning()},e.prototype.itemPositioning=function(){var t=this.element.querySelector("."+Zi),i;if(!(g(t)||!t.classList.contains(ja))){var r=this.element.querySelector("."+bs),n;if(this.scrollModule){var s=this.isVertical?eV:JH;n=[].slice.call(t.querySelector("."+s).children)}else n=[].slice.call(t.childNodes);this.isVertical?i=n[0].offsetHeight+n[2].offsetHeight:i=n[0].offsetWidth+n[2].offsetWidth;var a=this.isVertical?this.element.offsetHeight:this.element.offsetWidth;if(r){a-=this.isVertical?r.offsetHeight:r.offsetWidth;var l=(this.isVertical?r.offsetHeight:r.offsetWidth)+"px";n[2].removeAttribute("style"),this.isVertical?this.enableRtl?n[2].style.top=l:n[2].style.bottom=l:this.enableRtl?n[2].style.left=l:n[2].style.right=l}if(!(a<=i)){var h=(a-i-(this.isVertical?n[1].offsetHeight:n[1].offsetWidth))/2;n[1].removeAttribute("style");var u=(this.isVertical?n[0].offsetHeight:n[0].offsetWidth)+h+"px";this.isVertical?this.enableRtl?n[1].style.marginBottom=u:n[1].style.marginTop=u:this.enableRtl?n[1].style.marginRight=u:n[1].style.marginLeft=u}}},e.prototype.tbarItemAlign=function(t,i,r){var n=this;if(!(t.showAlwaysInPopup&&t.overflow!=="Show")){var s=[];if(s.push(this.createElement("div",{className:ZH,attrs:{role:"group"}})),s.push(this.createElement("div",{className:xL,attrs:{role:"group"}})),s.push(this.createElement("div",{className:KH,attrs:{role:"group"}})),r===0&&t.align!=="Left")s.forEach(function(h){i.appendChild(h)}),this.tbarAlign=!0,this.add(i,ja);else if(t.align!=="Left"){var a=i.childNodes,l=s[0];[].slice.call(a).forEach(function(h){n.tbarAlgEle.lefts.push(h),l.appendChild(h)}),i.appendChild(l),i.appendChild(s[1]),i.appendChild(s[2]),this.tbarAlign=!0,this.add(i,ja)}}},e.prototype.ctrlTemplate=function(){var t=this;this.ctrlTem=this.trgtEle.cloneNode(!0),this.add(this.trgtEle,Zi),this.tbarEle=[];var i=[].slice.call(this.trgtEle.children);i.forEach(function(r){r.tagName==="DIV"&&(t.tbarEle.push(r),g(r.firstElementChild)||r.firstElementChild.setAttribute("aria-disabled","false"),t.add(r,Ji))})},e.prototype.renderItems=function(){var t=this.element,i=this.items;if(this.trgtEle!=null)this.ctrlTemplate();else if(t&&i.length>0){var r=void 0;t&&t.children.length>0&&(r=t.querySelector("."+Zi)),r||(r=this.createElement("div",{className:Zi})),this.itemsAlign(i,r),t.appendChild(r)}},e.prototype.setAttr=function(t,i){for(var r=Object.keys(t),n,s=0;s<r.length;s++)n=r[parseInt(s.toString(),10)],n==="class"?this.add(i,t[""+n]):i.setAttribute(n,t[""+n])},e.prototype.enableItems=function(t,i){var r=t,n=r.length,s;g(i)&&(i=!0);var a=function(c,d){c?(d.classList.remove(Yn),g(d.firstElementChild)||d.firstElementChild.setAttribute("aria-disabled","false")):(d.classList.add(Yn),g(d.firstElementChild)||d.firstElementChild.setAttribute("aria-disabled","true"))};if(!g(n)&&n>=1){for(var l=0,h=[].slice.call(r);l<n;l++){var u=h[parseInt(l.toString(),10)];if(typeof u=="number"){if(s=this.getElementByIndex(u),g(s))return;r[parseInt(l.toString(),10)]=s}else s=u;a(i,s)}i?K(r,Yn):Y(r,Yn)}else{if(typeof r=="number"){if(s=this.getElementByIndex(r),g(s))return}else s=t;a(i,s)}},e.prototype.getElementByIndex=function(t){return this.tbarEle[parseInt(t.toString(),10)]?this.tbarEle[parseInt(t.toString(),10)]:null},e.prototype.addItems=function(t,i){var r;this.extendedOpen();var n=this.element.querySelector("."+Zi);if(g(n)){this.itemsRerender(t);return}var s,a="Left";g(i)&&(i=0),t.forEach(function(p){!g(p.align)&&p.align!=="Left"&&a==="Left"&&(a=p.align)});for(var l=0,h=t;l<h.length;l++){var u=h[l];if(g(u.type)&&(u.type="Button"),r=Oe("."+Ji,this.element),u.align=a,s=this.renderSubComponent(u,i),this.tbarEle.length>=i&&r.length>=0){g(this.scrollModule)&&this.destroyMode();var c=u.align[0]==="L"?0:u.align[0]==="C"?1:2,d=void 0;!this.tbarAlign&&a!=="Left"?(this.tbarItemAlign(u,n,1),this.tbarAlign=!0,d=j(r[0],"."+Zi).children[parseInt(c.toString(),10)],d.appendChild(s),this.tbarAlgEle[(u.align+"s").toLowerCase()].push(s),this.refreshPositioning()):this.tbarAlign?(d=j(r[0],"."+Zi).children[parseInt(c.toString(),10)],d.insertBefore(s,d.children[parseInt(i.toString(),10)]),this.tbarAlgEle[(u.align+"s").toLowerCase()].splice(i,0,s),this.refreshPositioning()):r.length===0?(r=Oe("."+Zi,this.element),r[0].appendChild(s)):r[0].parentNode.insertBefore(s,r[parseInt(i.toString(),10)]),this.items.splice(i,0,u),u.template&&this.tbarEle.splice(this.tbarEle.length-1,1),this.tbarEle.splice(i,0,s),i++,this.offsetWid=n.offsetWidth}}n.style.width="",this.renderOverflowMode(),this.isReact&&this.renderReactTemplates()},e.prototype.removeItems=function(t){var i=t,r,n=[].slice.call(Oe("."+Ji,this.element));if(typeof i=="number")r=parseInt(t.toString(),10),this.removeItemByIndex(r,n);else if(i&&i.length>1)for(var s=0,a=[].slice.call(i);s<a.length;s++){var l=a[s];r=this.tbarEle.indexOf(l),this.removeItemByIndex(r,n),n=Oe("."+Ji,this.element)}else{var l=i&&i.length&&i.length===1?i[0]:t;r=n.indexOf(l),this.removeItemByIndex(r,n)}this.resize()},e.prototype.removeItemByIndex=function(t,i){if(this.tbarEle[parseInt(t.toString(),10)]&&i[parseInt(t.toString(),10)]){var r=this.tbarEle.indexOf(i[parseInt(t.toString(),10)]);if(this.tbarAlign){var n=this.tbarAlgEle[(this.items[parseInt(r.toString(),10)].align+"s").toLowerCase()].indexOf(this.tbarEle[parseInt(r.toString(),10)]);this.tbarAlgEle[(this.items[parseInt(r.toString(),10)].align+"s").toLowerCase()].splice(parseInt(n.toString(),10),1)}this.isReact&&this.clearToolbarTemplate(i[parseInt(t.toString(),10)]);var s=i[parseInt(t.toString(),10)].querySelector(".e-control.e-btn");!g(s)&&!g(s.ej2_instances[0])&&!s.ej2_instances[0].isDestroyed&&s.ej2_instances[0].destroy(),ee(i[parseInt(t.toString(),10)]),this.items.splice(r,1),this.tbarEle.splice(r,1)}},e.prototype.templateRender=function(t,i,r,n){var s=r.type,a=t,l;if(typeof t=="object"&&(l=typeof a.appendTo=="function"),typeof t=="string"||!l){var h=void 0,u=t,c=new RegExp(/<(?=.*? .*?\/ ?>|br|hr|input|!--|wbr)[a-z]+.*?>|<([a-z]+).*?<\/\1>/i);u=typeof t=="string"?t.trim():t;try{if(typeof t=="object"&&!g(t.tagName))i.appendChild(t);else if(typeof t=="string"&&c.test(u))i.innerHTML=u;else if(document.querySelectorAll(u).length){var d=document.querySelector(u),p=d.outerHTML.trim();i.appendChild(d),d.style.display="",g(p)||this.tempId.push(u)}else h=wt(u)}catch{h=wt(u)}var f=void 0;if(!g(h)){var v=this.element.id+n+"_template";f=h({},this,"template",v,this.isStringTemplate,void 0,void 0,this.root)}!g(f)&&f.length>0&&[].slice.call(f).forEach(function(y){g(y.tagName)||(y.style.display=""),i.appendChild(y)})}else if(s==="Input"){var d=this.createElement("input");r.id?d.id=r.id:d.id=kt("tbr-ipt"),i.appendChild(d),a.appendTo(d)}this.add(i,SL);var m=i.firstElementChild;g(m)||(m.setAttribute("tabindex",g(m.getAttribute("tabIndex"))?"-1":this.getDataTabindex(m)),m.setAttribute("data-tabindex",g(m.getAttribute("tabIndex"))?"-1":this.getDataTabindex(m))),this.tbarEle.push(i)},e.prototype.buttonRendering=function(t,i){var r=this.createElement("button",{className:$H});r.setAttribute("type","button");var n=t.text,s,a;t.id?r.id=t.id:r.id=kt("e-tbr-btn");var l=this.createElement("span",{className:"e-tbar-btn-text"});n?(l.innerHTML=this.enableHtmlSanitizer?Bt.sanitize(n):n,r.appendChild(l),r.classList.add("e-tbtn-txt")):this.add(i,"e-tbtn-align"),(t.prefixIcon||t.suffixIcon)&&(t.prefixIcon&&t.suffixIcon||t.prefixIcon?(s=t.prefixIcon+" e-icons",a="Left"):(s=t.suffixIcon+" e-icons",a="Right"));var h=new bn({iconCss:s,iconPosition:a});return h.createElement=this.createElement,h.appendTo(r),t.width&&Ye(r,{width:Le(t.width)}),r},e.prototype.renderSubComponent=function(t,i){var r,n=this.createElement("div",{className:Ji}),s=this.createElement("div",{innerHTML:this.enableHtmlSanitizer&&!g(t.tooltipText)?Bt.sanitize(t.tooltipText):t.tooltipText});if(this.tbarEle||(this.tbarEle=[]),t.htmlAttributes&&this.setAttr(t.htmlAttributes,n),t.tooltipText&&n.setAttribute("title",s.textContent),t.cssClass&&(n.className=n.className+" "+t.cssClass),t.template)this.templateRender(t.template,n,t,i);else switch(t.type){case"Button":r=this.buttonRendering(t,n),r.setAttribute("tabindex",g(t.tabIndex)?"-1":t.tabIndex.toString()),r.setAttribute("data-tabindex",g(t.tabIndex)?"-1":t.tabIndex.toString()),r.setAttribute("aria-label",t.text||t.tooltipText),r.setAttribute("aria-disabled","false"),n.appendChild(r),n.addEventListener("click",this.itemClick.bind(this));break;case"Separator":this.add(n,vr);break}if(t.showTextOn){var a=t.showTextOn;a==="Toolbar"?(this.add(n,CL),this.add(n,"e-tbtn-align")):a==="Overflow"&&this.add(n,JC)}if(t.overflow){var l=t.overflow;l==="Show"?this.add(n,za):l==="Hide"&&(n.classList.contains(vr)||this.add(n,Fv))}return t.overflow!=="Show"&&t.showAlwaysInPopup&&!n.classList.contains(vr)&&(this.add(n,tw),this.popupPriCount++),t.disabled&&this.add(n,Yn),t.visible===!1&&this.add(n,fo),n},e.prototype.getDataTabindex=function(t){return g(t.getAttribute("data-tabindex"))?"-1":t.getAttribute("data-tabindex")},e.prototype.itemClick=function(t){this.activeEleSwitch(t.currentTarget)},e.prototype.activeEleSwitch=function(t){this.activeEleRemove(t.firstElementChild),this.activeEle.focus()},e.prototype.activeEleRemove=function(t){var i=this.element.querySelector("."+Ji+":not(."+Yn+" ):not(."+vr+" ):not(."+fo+" )");if(g(this.activeEle)||(this.activeEle.setAttribute("tabindex",this.getDataTabindex(this.activeEle)),i&&i.removeAttribute("tabindex"),i=this.activeEle),this.activeEle=t,this.getDataTabindex(this.activeEle)==="-1")if(g(this.trgtEle)&&!t.parentElement.classList.contains(SL)){if(!g(this.element.querySelector(".e-hor-nav"))&&this.element.querySelector(".e-hor-nav").classList.contains("e-nav-active")){this.updateTabIndex("0");var r=this.getDataTabindex(i)==="-1"?"0":this.getDataTabindex(i);i.setAttribute("tabindex",r)}else this.updateTabIndex("-1");t.removeAttribute("tabindex")}else{var n=parseInt(this.getDataTabindex(this.activeEle),10)+1;this.activeEle.setAttribute("tabindex",n.toString())}},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.getModuleName=function(){return"toolbar"},e.prototype.itemsRerender=function(t){this.items=this.tbarItemsCol,(this.isReact||this.isAngular)&&this.clearTemplate(),this.destroyMode(),this.destroyItems(),this.items=t,this.tbarItemsCol=this.items,this.renderItems(),this.renderOverflowMode(),this.isReact&&this.renderReactTemplates()},e.prototype.resize=function(){var t=this.element;this.tbResize=!0,this.tbarAlign&&this.itemPositioning(),this.popObj&&this.overflowMode==="Popup"&&this.popObj.hide();var i=this.checkOverflow(t,t.getElementsByClassName(Zi)[0]);if(!i){this.destroyScroll();var r=t.querySelector("."+Zi);g(r)||(this.remove(r,ML),this.tbarAlign&&this.add(r,ja))}i&&this.scrollModule&&this.offsetWid===t.offsetWidth||((this.offsetWid>t.offsetWidth||i)&&this.renderOverflowMode(),this.popObj&&(this.overflowMode==="Extended"&&(this.popObj.width=this.getToolbarPopupWidth(this.element)),this.tbarAlign&&this.removePositioning(),this.popupRefresh(this.popObj.element,!1),this.tbarAlign&&this.refreshPositioning()),this.element.querySelector("."+ew)&&(this.scrollStep=this.element.querySelector("."+ew).offsetWidth),this.offsetWid=t.offsetWidth,this.tbResize=!1,this.separator())},e.prototype.orientationChange=function(){var t=this;setTimeout(function(){t.resize()},500)},e.prototype.extendedOpen=function(){var t=this.element.querySelector("."+Ov);this.overflowMode==="Extended"&&t&&(this.isExtendedOpen=t.classList.contains(bL))},e.prototype.updateHideEleTabIndex=function(t,i,r,n,s){r&&(n=s.indexOf(t));for(var a=s[++n];a;){var l=this.eleContains(a);if(!l){var h=a.firstElementChild.getAttribute("data-tabindex");i&&h==="-1"?a.firstElementChild.setAttribute("tabindex","0"):h!==a.firstElementChild.getAttribute("tabindex")&&a.firstElementChild.setAttribute("tabindex",h);break}a=s[++n]}},e.prototype.clearToolbarTemplate=function(t){if(this.registeredTemplate&&this.registeredTemplate.template)for(var i=this.registeredTemplate,r=0;r<i.template.length;r++){var n=i.template[parseInt(r.toString(),10)].rootNodes[0],s=j(n,"."+Ji);if(!g(s)&&s===t){this.clearTemplate(["template"],[i.template[parseInt(r.toString(),10)]]);break}}else if(this.portals&&this.portals.length>0)for(var a=this.portals,r=0;r<a.length;r++){var l=a[parseInt(r.toString(),10)],s=j(l.containerInfo,"."+Ji);if(!g(s)&&s===t){this.clearTemplate(["template"],r);break}}},e.prototype.onPropertyChanged=function(t,i){var r=this.element;this.extendedOpen();for(var n=0,s=Object.keys(t);n<s.length;n++){var a=s[n];switch(a){case"items":if(t.items instanceof Array&&i.items instanceof Array)this.itemsRerender(t.items);else for(var l=Object.keys(t.items),h=0;h<l.length;h++){var u=parseInt(Object.keys(t.items)[parseInt(h.toString(),10)],10),c=Object.keys(t.items[parseInt(u.toString(),10)])[0],d=Object(t.items[parseInt(u.toString(),10)])[""+c];if(this.tbarAlign||c==="align"){this.refresh(),this.trigger("created");break}var p=c==="showAlwaysInPopup"&&!d,f=c==="overflow"&&this.popupPriCount!==0;(p||this.items[parseInt(u.toString(),10)].showAlwaysInPopup&&f)&&--this.popupPriCount,g(this.scrollModule)&&this.destroyMode();var v=[].slice.call(Oe("."+Zi+" ."+Ji,r));this.isReact&&this.items[parseInt(u.toString(),10)].template&&this.clearToolbarTemplate(v[parseInt(u.toString(),10)]),ee(v[parseInt(u.toString(),10)]),this.tbarEle.splice(u,1),this.addItems([this.items[parseInt(u.toString(),10)]],u),this.items.splice(u,1),this.items[parseInt(u.toString(),10)].template&&this.tbarEle.splice(this.items.length,1)}break;case"width":Ye(r,{width:Le(t.width)}),this.refreshOverflow();break;case"height":Ye(this.element,{height:Le(t.height)});break;case"overflowMode":this.destroyMode(),this.renderOverflowMode(),this.enableRtl&&this.add(r,po),this.refreshOverflow();break;case"enableRtl":t.enableRtl?this.add(r,po):this.remove(r,po),g(this.scrollModule)||(t.enableRtl?this.add(this.scrollModule.element,po):this.remove(this.scrollModule.element,po)),g(this.popObj)||(t.enableRtl?this.add(this.popObj.element,po):this.remove(this.popObj.element,po)),this.tbarAlign&&this.itemPositioning();break;case"scrollStep":this.scrollModule&&(this.scrollModule.scrollStep=this.scrollStep);break;case"enableCollision":this.popObj&&(this.popObj.collision={Y:this.enableCollision?"flip":"none"});break;case"cssClass":i.cssClass&&K([this.element],i.cssClass.split(" ")),t.cssClass&&Y([this.element],t.cssClass.split(" "));break;case"allowKeyboard":this.unwireKeyboardEvent(),t.allowKeyboard&&this.wireKeyboardEvent();break}}},e.prototype.hideItem=function(t,i){var r=typeof t=="object",n=t,s;if(!(!r&&g(n))){var a=[].slice.call(Oe("."+Ji,this.element));if(r)s=t;else if(this.tbarEle[parseInt(n.toString(),10)]){var l=[].slice.call(Oe("."+Ji,this.element));s=l[parseInt(n.toString(),10)]}s&&(i?(s.classList.add(fo),s.classList.contains(vr)||(g(s.firstElementChild.getAttribute("tabindex"))||s.firstElementChild.getAttribute("tabindex")!=="-1")&&this.updateHideEleTabIndex(s,i,r,n,a)):(s.classList.remove(fo),s.classList.contains(vr)||this.updateHideEleTabIndex(s,i,r,n,a)),this.refreshOverflow())}},Mi([Wt([],$v)],e.prototype,"items",void 0),Mi([C("auto")],e.prototype,"width",void 0),Mi([C("auto")],e.prototype,"height",void 0),Mi([C("")],e.prototype,"cssClass",void 0),Mi([C("Scrollable")],e.prototype,"overflowMode",void 0),Mi([C()],e.prototype,"scrollStep",void 0),Mi([C(!0)],e.prototype,"enableCollision",void 0),Mi([C(!0)],e.prototype,"enableHtmlSanitizer",void 0),Mi([C(!0)],e.prototype,"allowKeyboard",void 0),Mi([q()],e.prototype,"clicked",void 0),Mi([q()],e.prototype,"created",void 0),Mi([q()],e.prototype,"destroyed",void 0),Mi([q()],e.prototype,"beforeCreate",void 0),e=Mi([bt],e),e}(Kt);var nV=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),wc=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Kv=function(o){nV(e,o);function e(t,i){return o.call(this,t,i)||this}return e.prototype.preRender=function(){this.isMenu=!1,this.element.id=this.element.id||kt("ej2-contextmenu"),o.prototype.preRender.call(this)},e.prototype.initialize=function(){this.template=this.itemTemplate?this.itemTemplate:null,o.prototype.initialize.call(this),Ie(this.element,{role:"menubar",tabindex:"0"}),this.element.style.zIndex=Fs(this.element).toString()},e.prototype.open=function(t,i,r){o.prototype.openMenu.call(this,null,null,t,i,null,r)},e.prototype.close=function(){o.prototype.closeMenu.call(this)},e.prototype.onPropertyChanged=function(t,i){o.prototype.onPropertyChanged.call(this,t,i);for(var r=0,n=Object.keys(t);r<n.length;r++){var s=n[r];switch(s){case"filter":this.close(),this.filter=t.filter;break;case"target":this.unWireEvents(i.target),this.wireEvents();break;case"itemTemplate":this.itemTemplate=t.itemTemplate,this.refresh()}}},e.prototype.getModuleName=function(){return"contextmenu"},wc([C("")],e.prototype,"target",void 0),wc([C("")],e.prototype,"filter",void 0),wc([Wt([],Mc)],e.prototype,"items",void 0),wc([C(null)],e.prototype,"itemTemplate",void 0),wc([C(!1)],e.prototype,"enableScrolling",void 0),e=wc([bt],e),e}(YL),sV=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ko=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Ha="e-vertical",aV="e-scrollable",sw="e-hamburger",Ph=function(o){sV(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.tempItems=[],r}return e.prototype.getModuleName=function(){return"menu"},e.prototype.preRender=function(){if(this.isMenu=!0,this.element.id=this.element.id||kt("ej2-menu"),this.template){try{typeof this.template!="function"&&document.querySelectorAll(this.template).length&&(this.template=document.querySelector(this.template).innerHTML.trim(),this.clearChanges())}catch{}this.updateMenuItems(this.items)}else this.updateMenuItems(this.items);o.prototype.preRender.call(this)},e.prototype.initialize=function(){o.prototype.initialize.call(this),Ie(this.element,{role:"menubar",tabindex:"0"}),this.orientation==="Vertical"?(this.element.classList.add(Ha),this.hamburgerMode&&!this.target&&this.element.previousElementSibling.classList.add(Ha),this.element.setAttribute("aria-orientation","vertical")):B.isDevice&&!this.enableScrolling&&this.element.parentElement.classList.add(aV),this.hamburgerMode&&(this.element.parentElement.classList.add(sw),this.orientation==="Horizontal"&&this.element.classList.add("e-hide-menu"))},e.prototype.updateMenuItems=function(t){this.tempItems=t,this.items=[],this.tempItems.map(this.createMenuItems,this),this.setProperties({items:this.items},!0),this.tempItems=[]},e.prototype.onPropertyChanged=function(t,i){for(var r=this,n=0,s=Object.keys(t);n<s.length;n++){var a=s[n];switch(a){case"orientation":t.orientation==="Vertical"?(this.element.classList.add(Ha),this.hamburgerMode&&(this.target||this.element.previousElementSibling.classList.add(Ha),this.element.classList.remove("e-hide-menu")),this.element.setAttribute("aria-orientation","vertical")):(this.element.classList.remove(Ha),this.hamburgerMode&&(this.target||this.element.previousElementSibling.classList.remove(Ha),this.element.classList.add("e-hide-menu")),this.element.removeAttribute("aria-orientation"));break;case"items":Object.keys(i.items).length||this.updateMenuItems(t.items);break;case"hamburgerMode":this.element.previousElementSibling||o.prototype.createHeaderContainer.call(this),t.hamburgerMode?(this.element.parentElement.classList.add(sw),[].slice.call(this.element.getElementsByClassName("e-blankicon")).forEach(function(l){l.style[r.enableRtl?"paddingRight":"paddingLeft"]=""})):(this.element.parentElement.classList.remove(sw),this.orientation==="Vertical"&&this.setBlankIconStyle(this.element)),this.orientation==="Vertical"?(this.target||this.element.previousElementSibling.classList.add(Ha),this.element.classList.remove("e-hide-menu")):(this.target?this.element.previousElementSibling.classList.add(Ha):this.element.previousElementSibling.classList.remove(Ha),this.element.classList[t.hamburgerMode?"add":"remove"]("e-hide-menu"));break;case"title":this.hamburgerMode&&this.element.previousElementSibling&&(t.title=this.enableHtmlSanitizer?Bt.sanitize(t.title):t.title,this.element.previousElementSibling.querySelector(".e-menu-title").innerHTML=t.title);break;case"target":this.hamburgerMode&&(this.unWireEvents(i.target),this.wireEvents(),this.orientation==="Horizontal"&&(t.target?this.element.previousElementSibling.classList.add(Ha):(this.element.previousElementSibling||o.prototype.createHeaderContainer.call(this),this.element.previousElementSibling.classList.remove(Ha)),this.element.classList.add("e-hide-menu")));break;case"template":this.template=t.template,this.refresh();break}}o.prototype.onPropertyChanged.call(this,t,i)},e.prototype.createMenuItems=function(t){var i,r,n=this.items,s=this.getField("parentId");if(t[""+s]){for(i=this.getIndex(t[""+s].toString(),!0),r=0;r<i.length;r++)n[i[r]].items||(n[i[r]].items=[]),n=n[i[r]].items;n.push(t)}else this.items.push(t)},e.prototype.open=function(){o.prototype.openHamburgerMenu.call(this)},e.prototype.close=function(){o.prototype.closeHamburgerMenu.call(this)},Ko([C("Horizontal")],e.prototype,"orientation",void 0),Ko([C("")],e.prototype,"target",void 0),Ko([C(null)],e.prototype,"template",void 0),Ko([C(!1)],e.prototype,"enableScrolling",void 0),Ko([C(!1)],e.prototype,"hamburgerMode",void 0),Ko([C("Menu")],e.prototype,"title",void 0),Ko([C(!0)],e.prototype,"enableHtmlSanitizer",void 0),Ko([be({itemId:"id",text:"text",parentId:"parentId",iconCss:"iconCss",url:"url",separator:"separator",children:"items"},GL)],e.prototype,"fields",void 0),e=Ko([bt],e),e}(YL),Vp=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Nt=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},jl="e-tab",On="e-tab-header",oV="blazor-template",Zt="e-content",Rv="e-nested",lV="e-items",Rr="e-item",aw="e-template",Pv="e-rtl",bi="e-active",Zo="e-disable",Ii="e-hidden",ow="e-focused",lw="e-icons",hw="e-icon",EL="e-icon-tab",uw="e-close-icon",Bv="e-close-show",Bp="e-tab-text",zv="e-indicator",ra="e-tab-wrap",jv="e-text-wrap",AL="e-tab-icon",Ss="e-toolbar-items",Vt="e-toolbar-item",TL="e-toolbar-pop",Jo="e-toolbar-popup",hV="e-hor-nav",uV="e-popup-open",cV="e-popup-close",Hv="e-progress",dV="e-ignore",cw="e-overlay",pV="e-hscroll-content",fV="e-vscroll-content",dw="e-vertical-tab",pw="e-vertical",LL="e-vertical-left",kL="e-vertical-right",NL="e-horizontal-bottom",fw="e-fill-mode",FL="tabitem_",gw="e-reorder-active-item",OL=function(o){Vp(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Nt([C("SlideLeftIn")],e.prototype,"effect",void 0),Nt([C(600)],e.prototype,"duration",void 0),Nt([C("ease")],e.prototype,"easing",void 0),e}(Re),gV=function(o){Vp(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Nt([be({effect:"SlideLeftIn",duration:600,easing:"ease"},OL)],e.prototype,"previous",void 0),Nt([be({effect:"SlideRightIn",duration:600,easing:"ease"},OL)],e.prototype,"next",void 0),e}(Re),vV=function(o){Vp(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Nt([C("")],e.prototype,"text",void 0),Nt([C("")],e.prototype,"iconCss",void 0),Nt([C("left")],e.prototype,"iconPosition",void 0),e}(Re),mV=function(o){Vp(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Nt([be({},vV)],e.prototype,"header",void 0),Nt([C(null)],e.prototype,"headerTemplate",void 0),Nt([C("")],e.prototype,"content",void 0),Nt([C("")],e.prototype,"cssClass",void 0),Nt([C(!1)],e.prototype,"disabled",void 0),Nt([C(!0)],e.prototype,"visible",void 0),Nt([C()],e.prototype,"id",void 0),Nt([C(-1)],e.prototype,"tabIndex",void 0),e}(Re),Zv=function(o){Vp(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.show={},r.hide={},r.maxHeight=0,r.title="Close",r.isInteracted=!1,r.lastIndex=0,r.isAdd=!1,r.isIconAlone=!1,r.draggableItems=[],r.resizeContext=r.refreshActiveTabBorder.bind(r),r.keyConfigs={tab:"tab",home:"home",end:"end",enter:"enter",space:"space",delete:"delete",moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",moveDown:"downarrow"},r}return e.prototype.destroy=function(){if((this.isReact||this.isAngular)&&this.clearTemplate(),g(this.tbObj)||(this.tbObj.destroy(),this.tbObj=null),this.unWireEvents(),this.element.removeAttribute("aria-disabled"),this.expTemplateContent(),this.isTemplate){var t=X("."+jl+" > ."+Zt,this.element);this.element.classList.remove(aw),g(t)||(t.innerHTML=this.cnt)}else for(;this.element.firstElementChild;)Ue(this.element.firstElementChild);if(this.btnCls&&(this.btnCls=null),this.hdrEle=null,this.cntEle=null,this.tbItems=null,this.tbItem=null,this.tbPop=null,this.prevItem=null,this.popEle=null,this.bdrLine=null,this.content=null,this.dragItem=null,this.cloneElement=null,this.draggingItems=[],this.draggableItems&&this.draggableItems.length>0){for(var i=0;i<this.draggableItems.length;i++)this.draggableItems[i].destroy(),this.draggableItems[i]=null;this.draggableItems=[]}o.prototype.destroy.call(this),this.trigger("destroyed")},e.prototype.refresh=function(){this.isReact&&this.clearTemplate(),o.prototype.refresh.call(this),this.isReact&&this.renderReactTemplates()},e.prototype.refreshOverflow=function(){g(this.tbObj)||this.tbObj.refreshOverflow()},e.prototype.preRender=function(){var t=j(this.element,"."+Zt);this.prevIndex=0,this.isNested=!1,this.isPopup=!1,this.initRender=!0,this.isSwiped=!1,this.itemIndexArray=[],this.templateEle=[],this.allowDragAndDrop&&(this.dragArea=g(this.dragArea)?"#"+this.element.id+" "+("."+On):this.dragArea),g(t)||(t.parentElement.classList.add(Rv),this.isNested=!0);var i=B.info.name,r=i==="msie"?"e-ie":i==="edge"?"e-edge":i==="safari"?"e-safari":"";Ye(this.element,{width:Le(this.width),height:Le(this.height)}),this.setCssClass(this.element,this.cssClass,!0),Ie(this.element,{"aria-disabled":"false"}),this.setCssClass(this.element,r,!0),this.updatePopAnimationConfig()},e.prototype.render=function(){var t=this;this.btnCls=this.createElement("span",{className:lw+" "+uw,attrs:{title:this.title}}),this.tabId=this.element.id.length>0?"-"+this.element.id:FS(),this.renderContainer(),this.wireEvents(),this.initRender=!1,this.isReact&&this.portals&&this.portals.length>0&&this.renderReactTemplates(function(){t.refreshOverflow(),t.refreshActiveBorder()})},e.prototype.renderContainer=function(){var t=this.element;if(this.items.forEach(function(n,s){g(n.id)&&!g(n.setProperties)&&n.setProperties({id:FL+s.toString()},!0)}),this.items.length>0&&t.children.length===0)t.appendChild(this.createElement("div",{className:Zt})),this.setOrientation(this.headerPlacement,this.createElement("div",{className:On})),this.isTemplate=!1;else if(this.element.children.length>0){this.isTemplate=!0,t.classList.add(aw);var i=t.querySelector("."+On);i&&this.headerPlacement==="Bottom"&&this.setOrientation(this.headerPlacement,i)}if(!g(X("."+On,this.element))&&!g(X("."+Zt,this.element))){if(this.renderHeader(),this.tbItems=X("."+On+" ."+Ss,this.element),g(this.tbItems)||Vi(this.tbItems,{selector:".e-tab-wrap"}),this.renderContent(),Oe("."+Vt,this.element).length>0){this.tbItems=X("."+On+" ."+Ss,this.element),this.bdrLine=this.createElement("div",{className:zv+" "+Ii+" "+dV});var r=X("."+this.scrCntClass,this.tbItems);g(r)?this.tbItems.insertBefore(this.bdrLine,this.tbItems.firstChild):r.insertBefore(this.bdrLine,r.firstChild),this.setContentHeight(!0),this.select(this.selectedItem)}this.setRTL(this.enableRtl)}},e.prototype.renderHeader=function(){var t=this,i=this.headerPlacement,r=[];if(this.hdrEle=this.getTabHeader(),this.addVerticalClass(),!this.isTemplate)r=this.parseObject(this.items,0);else{this.element.children.length>1&&this.element.children[1].classList.contains(On)&&this.setProperties({headerPlacement:"Bottom"},!0);for(var n=this.hdrEle.children.length,s=[],a=0;a<n;a++)s.push(this.hdrEle.children.item(a));if(n>0){var l=this.createElement("div",{className:lV});this.hdrEle.appendChild(l),s.forEach(function(u,c){t.lastIndex=c;var d={className:Rr,id:Rr+t.tabId+"_"+c},p=t.createElement("span",{className:Bp,attrs:{role:"presentation"}}).outerHTML,f=t.createElement("div",{className:jv,innerHTML:p+t.btnCls.outerHTML}).outerHTML,v=t.createElement("div",{className:ra,innerHTML:f,attrs:{role:"tab",tabIndex:"-1","aria-selected":"false","aria-controls":Zt+t.tabId+"_"+c,"aria-disabled":"false"}});v.querySelector("."+Bp).appendChild(u),l.appendChild(t.createElement("div",d)),Oe("."+Rr,l)[c].appendChild(v)})}}this.tbObj=new Hl({width:i==="Left"||i==="Right"?"auto":"100%",height:i==="Left"||i==="Right"?"100%":"auto",overflowMode:this.overflowMode,items:r.length!==0?r:[],clicked:this.clickHandler.bind(this),scrollStep:this.scrollStep,enableHtmlSanitizer:this.enableHtmlSanitizer,cssClass:this.cssClass}),this.tbObj.isStringTemplate=!0,this.tbObj.createElement=this.createElement,this.tbObj.appendTo(this.hdrEle),Ie(this.hdrEle,{role:"tablist"}),g(this.element.getAttribute("aria-label"))?g(this.element.getAttribute("aria-labelledby"))||(this.hdrEle.setAttribute("aria-labelledby",this.element.getAttribute("aria-labelledby")),this.element.removeAttribute("aria-labelledby")):(this.hdrEle.setAttribute("aria-label",this.element.getAttribute("aria-label")),this.element.removeAttribute("aria-label")),this.setCloseButton(this.showCloseButton);var h=this.tbObj.element.querySelector("."+Ss);g(h)||(g(h.id)||h.id==="")&&(h.id=this.element.id+"_tab_header_items")},e.prototype.createContentElement=function(t){var i=this.createElement("div",{id:Zt+this.tabId+"_"+t,className:Rr,attrs:{role:"tabpanel","aria-labelledby":Rr+this.tabId+"_"+t}});return(["Dynamic","Demand"].indexOf(this.loadOn)!==-1||this.loadOn==="Init"&&t===this.selectedItem)&&Y([i],bi),i},e.prototype.renderContent=function(){this.cntEle=X("."+Zt,this.element);var t=Oe("."+Vt,this.element);if(this.isTemplate){this.cnt=this.cntEle.children.length>0?this.cntEle.innerHTML:"";for(var i=this.cntEle.children,r=0;r<t.length;r++)i.length-1>=r&&(Y([i.item(r)],Rr),Ie(i.item(r),{role:"tabpanel","aria-labelledby":Rr+this.tabId+"_"+r}),i.item(r).id=Zt+this.tabId+"_"+r)}else if(Oe("."+Vt,this.element).length>0)if(this.loadOn==="Init")for(var r=0;r<this.itemIndexArray.length;r++)this.itemIndexArray[r]&&this.cntEle.appendChild(this.createContentElement(Number(this.extIndex(this.itemIndexArray[r]))));else this.loadOn==="Dynamic"&&this.cntEle.appendChild(this.createContentElement(this.selectedItem>0?this.selectedItem:Number(this.extIndex(this.itemIndexArray[0]))))},e.prototype.reRenderItems=function(){this.renderContainer(),g(this.cntEle)||this.bindSwipeEvents()},e.prototype.parseObject=function(t,i){var r=this,n=Array.prototype.slice.call(Oe(".e-tab-header ."+Vt,this.element)),s=this.lastIndex;!this.isReplace&&n.length>0&&(s=this.getMaxIndicesFromItems(n));var a=[],l,h=[];return t.forEach(function(u,c){var d=g(u.header)||g(u.header.iconPosition)?"":u.header.iconPosition,p=g(u.header)||g(u.header.iconCss)?"":u.header.iconCss;if(g(u.headerTemplate)&&(g(u.header)||g(u.header.text)||u.header.text.length===0&&p==="")){h.push(c);return}var f=u.headerTemplate||u.header.text;typeof f=="string"&&r.enableHtmlSanitizer&&(f=Bt.sanitize(f));var v;r.isReplace&&!g(r.tbId)&&r.tbId!==""?(v=parseInt(r.tbId.substring(r.tbId.lastIndexOf("_")+1),10),r.tbId=""):v=i+c,r.lastIndex=n.length===0?c:r.isReplace?v:s+1+c;var m=u.disabled?" "+Zo+" "+cw:"",y=u.visible===!1?" "+Ii:"";l=r.createElement("div",{className:Bp,attrs:{role:"presentation"}});var S=f instanceof Object?f.outerHTML:f,b=!g(S)&&S!=="";g(f.tagName)?r.headerTextCompile(l,f,c):l.appendChild(f);var w,I=r.createElement("span",{className:lw+" "+AL+" "+hw+"-"+d+" "+p}),x=r.createElement("div",{className:jv});x.appendChild(l),f!==""&&f!==void 0&&p!==""?(d==="left"||d==="top"?x.insertBefore(I,x.firstElementChild):x.appendChild(I),w=l,r.isIconAlone=!1):(w=p===""?l:I,w===I&&(ee(l),x.appendChild(I),r.isIconAlone=!0));var M=g(u.tabIndex)?"-1":u.tabIndex.toString(),D=u.disabled?{role:"tab","aria-disabled":"true"}:{tabIndex:M,"data-tabindex":M,role:"tab","aria-selected":"false","aria-disabled":"false"};x.appendChild(r.btnCls.cloneNode(!0));var A=r.createElement("div",{className:ra,attrs:D});A.appendChild(x),r.itemIndexArray instanceof Array&&r.itemIndexArray.splice(i+c,0,Rr+r.tabId+"_"+r.lastIndex);var L={id:Rr+r.tabId+"_"+r.lastIndex,"data-id":u.id},T={htmlAttributes:L,template:A};T.cssClass=(u.cssClass!==void 0?u.cssClass:" ")+" "+m+" "+y+" "+(p!==""?"e-i"+d:"")+" "+(b?"":hw),(d==="top"||d==="bottom")&&r.element.classList.add("e-vertical-icon"),a.push(T),c++}),this.isAdd||h.forEach(function(u){r.items.splice(u,1)}),this.isIconAlone?this.element.classList.add(EL):this.element.classList.remove(EL),a},e.prototype.removeActiveClass=function(){var t=this.getTabHeader();if(t){var i=Oe("."+Vt+"."+bi,t);[].slice.call(i).forEach(function(r){return r.classList.remove(bi)}),[].slice.call(i).forEach(function(r){return r.firstElementChild.setAttribute("aria-selected","false")})}},e.prototype.checkPopupOverflow=function(t){this.tbPop=X("."+TL,this.element);var i=X(".e-hor-nav",this.element),r=X("."+Ss,this.element),n=r.lastChild,s=!1;return(!this.isVertical()&&(this.enableRtl&&i.offsetLeft+i.offsetWidth>r.offsetLeft||!this.enableRtl&&i.offsetLeft<r.offsetWidth)||this.isVertical()&&i.offsetTop<n.offsetTop+n.offsetHeight)&&(s=!0),s&&(t.classList.add(Jo),this.tbPop.insertBefore(t,Oe("."+Jo,this.tbPop)[0])),!0},e.prototype.popupHandler=function(t){var i=t.querySelector(".e-ripple-element");g(i)||(i.outerHTML="",t.querySelector("."+ra).classList.remove("e-ripple")),this.tbItem=Oe("."+Ss+" ."+Vt,this.hdrEle);var r=this.tbItem[this.tbItem.length-1];if(this.tbItem.length!==0){if(t.classList.remove(Jo),t.removeAttribute("style"),this.tbItems.appendChild(t),this.actEleId=t.id,this.checkPopupOverflow(r)){var n=this.tbItems.lastChild.previousElementSibling;this.checkPopupOverflow(n)}this.isPopup=!0}return Oe("."+Vt,this.tbItems).length-1},e.prototype.setCloseButton=function(t){var i=X("."+On,this.element);t===!0?i.classList.add(Bv):i.classList.remove(Bv),this.refreshOverflow(),this.refreshActiveTabBorder()},e.prototype.prevCtnAnimation=function(t,i){var r,n=this.enableRtl||this.element.classList.contains(Pv);return this.isPopup||t<=i?this.animation.previous.effect==="SlideLeftIn"?r={name:"SlideLeftOut",duration:this.animation.previous.duration,timingFunction:this.animation.previous.easing}:r=null:this.animation.next.effect==="SlideRightIn"?r={name:"SlideRightOut",duration:this.animation.next.duration,timingFunction:this.animation.next.easing}:r=null,r},e.prototype.triggerPrevAnimation=function(t,i){var r=this,n=this.prevCtnAnimation(i,this.selectedItem);g(n)?t.classList.remove(bi):(n.begin=function(){Ye(t,{position:"absolute"}),t.classList.add(Hv),t.classList.add("e-view")},n.end=function(){t.style.display="none",t.classList.remove(bi),t.classList.remove(Hv),t.classList.remove("e-view"),Ye(t,{display:"",position:""}),t.childNodes.length===0&&!r.isTemplate&&ee(t)},new It(n).animate(t))},e.prototype.triggerAnimation=function(t,i){var r=this,n=this.prevIndex,s,a=[].slice.call(this.element.querySelector("."+Zt).children);a.forEach(function(m){m.id===r.prevActiveEle&&(s=m)});var l=this.tbItem[n],h=this.getTrgContent(this.cntEle,this.extIndex(t));if(g(s)&&!g(l)){var u=this.extIndex(l.id);s=this.getTrgContent(this.cntEle,u)}g(h)||(this.prevActiveEle=h.id);var c=g(this.animation)||g(this.animation.next.effect)||g(this.animation.previous.effect)||this.animation.previous.effect==="None"||this.animation.next.effect==="None";if(this.initRender||i===!1||c){s&&s!==h&&s.classList.remove(bi);return}var d=X("."+Zt,this.element),p;if(this.prevIndex>this.selectedItem&&!this.isPopup){var f=this.animation.previous.effect;p={name:f==="None"?"":f!=="SlideLeftIn"?f:"SlideLeftIn",duration:this.animation.previous.duration===0&&Ut==="Enable"?600:this.animation.previous.duration,timingFunction:this.animation.previous.easing}}else if(this.isPopup||this.prevIndex<this.selectedItem||this.prevIndex===this.selectedItem){var v=this.animation.next.effect;p={name:v==="None"?"":v!=="SlideRightIn"?v:"SlideRightIn",duration:this.animation.next.duration===0&&Ut==="Enable"?600:this.animation.next.duration,timingFunction:this.animation.next.easing}}p.progress=function(){d.classList.add(Hv),r.setActiveBorder()},p.end=function(){d.classList.remove(Hv),h.classList.add(bi)},!this.initRender&&!g(s)&&this.triggerPrevAnimation(s,n),this.isPopup=!1,p.name===""?h.classList.add(bi):new It(p).animate(h)},e.prototype.keyPressed=function(t){var i=j(t,"."+On+" ."+Vt),r=this.getEleIndex(i);!g(this.popEle)&&t.classList.contains("e-hor-nav")?this.popEle.classList.contains(uV)?this.popObj.hide(this.hide):this.popObj.show(this.show):t.classList.contains("e-scroll-nav")?t.click():!g(i)&&i.classList.contains(bi)===!1&&(this.selectTab(r,null,!0),g(this.popEle)||this.popObj.hide(this.hide))},e.prototype.getTabHeader=function(){if(!g(this.element)){var t=[].slice.call(this.element.children).filter(function(r){return r.classList.contains(On)});if(t.length>0)return t[0];var i=[].slice.call(this.element.children).filter(function(r){return!r.classList.contains(oV)})[0];return i?[].slice.call(i.children).filter(function(r){return r.classList.contains(On)})[0]:void 0}},e.prototype.getEleIndex=function(t){return Array.prototype.indexOf.call(Oe("."+Vt,this.getTabHeader()),t)},e.prototype.extIndex=function(t){return t.replace(Rr+this.tabId+"_","")},e.prototype.getMaxIndicesFromItems=function(t){var i=this,r=[];return t.forEach(function(n){r.push(i.getIndexFromEle(n.id))}),Math.max.apply(Math,r)},e.prototype.expTemplateContent=function(){var t=this;this.templateEle.forEach(function(i){g(t.element.querySelector(i))||(document.body.appendChild(t.element.querySelector(i)).style.display="none")})},e.prototype.templateCompile=function(t,i,r){var n=this.createElement("div");this.compileElement(n,i,"content",r),n.childNodes.length!==0&&t.appendChild(n),this.isReact&&this.renderReactTemplates()},e.prototype.compileElement=function(t,i,r,n){var s;typeof i=="string"?(i=i.trim(),this.isVue?s=wt(this.enableHtmlSanitizer?Bt.sanitize(i):i):t.innerHTML=this.enableHtmlSanitizer?Bt.sanitize(i):i):s=wt(i);var a;g(s)||(a=s({},this,r)),!g(s)&&a.length>0&&[].slice.call(a).forEach(function(l){t.appendChild(l)})},e.prototype.headerTextCompile=function(t,i,r){this.compileElement(t,i,"headerTemplate",r)},e.prototype.getContent=function(t,i,r,n){var s;if(i=g(i)?"":i,typeof i=="string"||g(i.innerHTML))if(typeof i=="string"&&this.enableHtmlSanitizer&&(i=Bt.sanitize(i)),i[0]==="."||i[0]==="#")if(document.querySelectorAll(i).length){var a=document.querySelector(i);s=a.outerHTML.trim(),r==="clone"?t.appendChild(a.cloneNode(!0)):(t.appendChild(a),a.style.display="")}else this.templateCompile(t,i,n);else this.templateCompile(t,i,n);else t.appendChild(i);g(s)||this.templateEle.indexOf(i.toString())===-1&&this.templateEle.push(i.toString())},e.prototype.getTrgContent=function(t,i){var r;return this.element.classList.contains(Rv)?r=X("."+Rv+"> ."+Zt+" > #"+Zt+this.tabId+"_"+i,this.element):r=this.findEle(t.children,Zt+this.tabId+"_"+i),r},e.prototype.findEle=function(t,i){for(var r,n=0;n<t.length;n++)if(t[n].id===i){r=t[n];break}return r},e.prototype.isVertical=function(){var t=this.headerPlacement==="Left"||this.headerPlacement==="Right";return this.scrCntClass=t?fV:pV,t},e.prototype.addVerticalClass=function(){if(this.isVertical()){var t=this.headerPlacement==="Left"?LL:kL;Y([this.hdrEle],[pw,t]),this.element.classList.contains(Rv)?Y([this.hdrEle],[dw,t]):Y([this.element],[dw,t])}this.headerPlacement==="Bottom"&&Y([this.hdrEle],[NL])},e.prototype.updatePopAnimationConfig=function(){this.show={name:this.isVertical()?"FadeIn":"SlideDown",duration:100},this.hide={name:this.isVertical()?"FadeOut":"SlideUp",duration:100}},e.prototype.changeOrientation=function(t){this.setOrientation(t,this.hdrEle);var i=this.hdrEle.querySelector("."+bi),r=!!this.hdrEle.classList.contains(pw);K([this.element],[dw]),K([this.hdrEle],[pw,LL,kL]),r!==this.isVertical()&&(this.changeToolbarOrientation(),!g(i)&&i.classList.contains(Jo)&&this.popupHandler(i)),this.addVerticalClass(),this.setActiveBorder(),this.focusItem()},e.prototype.focusItem=function(){var t=X(" #"+Rr+this.tabId+"_"+this.selectedItem,this.hdrEle);g(t)||t.firstElementChild.focus()},e.prototype.changeToolbarOrientation=function(){this.tbObj.setProperties({height:this.isVertical()?"100%":"auto",width:this.isVertical()?"auto":"100%"},!0),this.tbObj.changeOrientation(),this.updatePopAnimationConfig()},e.prototype.setOrientation=function(t,i){var r=Array.prototype.indexOf.call(this.element.children,i),n=Array.prototype.indexOf.call(this.element.children,this.element.querySelector("."+Zt));t==="Bottom"&&n>r?this.element.appendChild(i):(K([i],[NL]),this.element.insertBefore(i,X("."+Zt,this.element)))},e.prototype.setCssClass=function(t,i,r){if(!(i===""||g(i)))for(var n=i.split(" "),s=0;s<n.length;s++)r?t.classList.add(n[s]):t.classList.remove(n[s])},e.prototype.loadContentInitMode=function(t){if(t&&this.loadOn==="Init")for(var i=0;i<this.items.length;i++)this.cntEle.children.item(i)&&this.getContent(this.cntEle.children.item(i),this.items[i].content,"render",i)},e.prototype.loadContentElement=function(){if(!this.isTemplate){var t=this.cntEle.children.item(0);this.loadContentInitMode(t)}},e.prototype.setContentHeight=function(t){if(this.element.classList.contains(fw)&&K([this.element],[fw]),!g(this.cntEle)){var i=this.getTabHeader();if(this.heightAdjustMode==="None"){if(this.loadContentElement(),this.height==="auto")return;this.isVertical()||Ye(this.cntEle,{height:this.element.clientHeight-i.offsetHeight+"px"})}else if(this.heightAdjustMode==="Fill")Y([this.element],[fw]),Ye(this.element,{height:"100%"}),this.loadContentElement(),this.cntEle.style.height="calc(100% - "+this.hdrEle.offsetHeight+"px)";else if(this.heightAdjustMode==="Auto"){if(this.isTemplate===!0)for(var r=Oe("."+Zt+" > ."+Rr,this.element),n=0;n<r.length;n++)r[n].style.display="block",r[n].style.visibility="visible",this.maxHeight=Math.max(this.maxHeight,this.getHeight(r[n])),r[n].style.removeProperty("display"),r[n].style.removeProperty("visibility");else{this.cntEle=X("."+Zt,this.element),t===!0&&this.loadOn==="Demand"&&this.cntEle.appendChild(this.createContentElement(Number(this.extIndex(this.itemIndexArray[0]))));for(var s=this.cntEle.children.item(0),n=0;n<this.items.length;n++)for(this.getContent(s,this.items[n].content,"clone",n),this.maxHeight=Math.max(this.maxHeight,this.getHeight(s));s.firstChild;)s.removeChild(s.firstChild);(this.isReact||this.isAngular||this.isVue)&&this.clearTemplate(["content"]),this.templateEle=[],this.loadOn==="Demand"&&this.getContent(s,this.items[0].content,"render",0),this.loadContentInitMode(s),this.prevIndex!==this.selectedItem&&s.classList.remove(bi)}Ye(this.cntEle,{height:this.maxHeight+"px"})}else this.loadContentElement(),Ye(this.cntEle,{height:"auto"})}},e.prototype.getHeight=function(t){var i=window.getComputedStyle(t);return t.offsetHeight+parseFloat(i.getPropertyValue("padding-top"))+parseFloat(i.getPropertyValue("padding-bottom"))+parseFloat(i.getPropertyValue("margin-top"))+parseFloat(i.getPropertyValue("margin-bottom"))},e.prototype.setActiveBorder=function(){var t=this.getTabHeader(),i=X("."+Vt+"."+bi,t);if(!g(i)){this.reorderActiveTab?t&&t.classList.remove(gw):(i.classList.contains(Jo)&&!this.bdrLine.classList.contains(Ii)&&this.bdrLine.classList.add(Ii),t&&!t.classList.contains(gw)&&t.classList.add(gw));var r=j(i,"."+jl);if(this.element===r){this.tbItems=X("."+Ss,t);var n=X("."+zv,t),s=X("."+Ss+" ."+this.scrCntClass,t);if(this.isVertical()){Ye(n,{left:"",right:""});var a=g(s)?this.tbItems.offsetHeight:s.offsetHeight;a!==0?Ye(n,{top:i.offsetTop+"px",height:i.offsetHeight+"px"}):Ye(n,{top:0,height:0})}else{if(this.overflowMode==="MultiRow"){var l=this.headerPlacement==="Bottom"?i.offsetTop:i.offsetHeight+i.offsetTop;Ye(n,{top:l+"px",height:""})}else Ye(n,{top:"",height:""});var h=g(s)?this.tbItems.offsetWidth:s.offsetWidth;h!==0?Ye(n,{left:i.offsetLeft+"px",right:h-(i.offsetLeft+i.offsetWidth)+"px"}):Ye(n,{left:"auto",right:"auto"})}!g(this.bdrLine)&&!i.classList.contains(Jo)&&this.bdrLine.classList.remove(Ii)}}},e.prototype.setActive=function(t,i,r){i===void 0&&(i=!1),r===void 0&&(r=!1),this.tbItem=Oe("."+Vt,this.getTabHeader());var n=this.tbItem[t];if(!(t<0||isNaN(t)||this.tbItem.length===0||!g(n)&&n.classList.contains(Zo))){if(t>=0&&!i&&(this.allowServerDataBinding=!1,this.setProperties({selectedItem:t},!0),this.allowServerDataBinding=!0,this.initRender||this.serverDataBind()),n.classList.contains(bi)){this.setActiveBorder();return}this.isTemplate||Ie(n.firstElementChild,{"aria-controls":Zt+this.tabId+"_"+this.extIndex(n.id)});var s=n.id;this.removeActiveClass(),n.classList.add(bi),n.firstElementChild.setAttribute("aria-selected","true");var a=Number(this.extIndex(s));if(g(this.prevActiveEle)&&(this.prevActiveEle=Zt+this.tabId+"_"+a),this.isTemplate){if(X("."+Zt,this.element).children.length>0){var l=this.findEle(X("."+Zt,this.element).children,Zt+this.tabId+"_"+a);g(l)||l.classList.add(bi),this.triggerAnimation(s,this.enableAnimation)}}else{for(this.cntEle=X("."+jl+" > ."+Zt,this.element);this.loadOn==="Dynamic"&&this.cntEle.firstElementChild;)this.cntEle.removeChild(this.cntEle.firstElementChild);var h=this.getTrgContent(this.cntEle,this.extIndex(s));if(g(h)){this.cntEle.appendChild(this.createElement("div",{id:Zt+this.tabId+"_"+this.extIndex(s),className:Rr+" "+bi,attrs:{role:"tabpanel","aria-labelledby":Rr+this.tabId+"_"+this.extIndex(s)}}));var u=this.getTrgContent(this.cntEle,this.extIndex(s)),c=Array.prototype.indexOf.call(this.itemIndexArray,s);this.getContent(u,this.items[c].content,"render",c)}else h.classList.add(bi);this.triggerAnimation(s,this.enableAnimation)}if(this.setActiveBorder(),this.refreshItemVisibility(n),!this.initRender&&!i){var d={previousItem:this.prevItem,previousIndex:this.prevIndex,selectedItem:n,selectedIndex:t,selectedContent:X("#"+Zt+this.tabId+"_"+this.selectingID,this.content),isSwiped:this.isSwiped,isInteracted:r,preventFocus:!1};this.trigger("selected",d,function(p){p.preventFocus||n.firstElementChild.focus()})}}},e.prototype.setItems=function(t){this.isReplace=!0,this.tbItems=X("."+Ss,this.getTabHeader()),this.tbObj.items=this.parseObject(t,0),this.tbObj.dataBind(),this.isReplace=!1},e.prototype.setRTL=function(t){this.tbObj.enableRtl=t,this.tbObj.dataBind(),this.setCssClass(this.element,Pv,t),this.refreshActiveBorder()},e.prototype.refreshActiveBorder=function(){g(this.bdrLine)||this.bdrLine.classList.add(Ii),this.setActiveBorder()},e.prototype.showPopup=function(t){var i=X(".e-popup.e-toolbar-pop",this.hdrEle);if(i&&i.classList.contains("e-popup-close")){var r=i&&i.ej2_instances[0];r.position.X=this.headerPlacement==="Left"||this.element.classList.contains(Pv)?"left":"right",r.dataBind(),r.show(t)}},e.prototype.bindDraggable=function(){var t=this;if(this.allowDragAndDrop){var i=this.element.querySelector("."+On);if(i){var r=Array.prototype.slice.call(i.querySelectorAll("."+Vt));r.forEach(function(n){t.initializeDrag(n)})}}},e.prototype.bindSwipeEvents=function(){this.swipeMode!=="None"&&(this.touchModule=new Fr(this.cntEle,{swipe:this.swipeHandler.bind(this)}))},e.prototype.wireEvents=function(){this.bindDraggable(),window.addEventListener("resize",this.resizeContext),E.add(this.element,"mouseover",this.hoverHandler,this),E.add(this.element,"keydown",this.spaceKeyDown,this),g(this.cntEle)||this.bindSwipeEvents(),this.keyModule=new $i(this.element,{keyAction:this.keyHandler.bind(this),keyConfigs:this.keyConfigs}),this.tabKeyModule=new $i(this.element,{keyAction:this.keyHandler.bind(this),keyConfigs:{openPopup:"shift+f10",tab:"tab",shiftTab:"shift+tab"},eventName:"keydown"})},e.prototype.unWireEvents=function(){g(this.keyModule)||this.keyModule.destroy(),g(this.tabKeyModule)||this.tabKeyModule.destroy(),!g(this.cntEle)&&!g(this.touchModule)&&(this.touchModule.destroy(),this.touchModule=null),window.removeEventListener("resize",this.resizeContext),E.remove(this.element,"mouseover",this.hoverHandler),E.remove(this.element,"keydown",this.spaceKeyDown),this.element.classList.remove(Pv),this.element.classList.remove(ow)},e.prototype.clickHandler=function(t){this.element.classList.remove(ow);var i=t.originalEvent.target,r=j(i,"."+Vt),n=this.getEleIndex(r);i.classList.contains(uw)?this.removeTab(n):this.isVertical()&&j(i,"."+hV)?this.showPopup(this.show):(this.isPopup=!1,!g(r)&&n!==this.selectedItem&&this.selectTab(n,t.originalEvent,!0))},e.prototype.swipeHandler=function(t){if(!(t.velocity<3&&g(t.originalEvent.changedTouches)||this.swipeMode==="Touch"&&(t.originalEvent.type==="mouseup"||t.originalEvent.type==="mouseleave")||this.swipeMode==="Mouse"&&t.originalEvent.type==="touchend"||this.swipeMode==="None")){this.isNested&&this.element.setAttribute("data-swipe","true");var i=this.element.querySelector('[data-swipe="true"]');if(i){i.removeAttribute("data-swipe");return}if(this.isSwiped=!0,t.swipeDirection==="Right"&&this.selectedItem!==0){for(var r=this.selectedItem-1;r>=0;r--)if(!this.tbItem[r].classList.contains(Ii)){this.selectTab(r,null,!0);break}}else if(t.swipeDirection==="Left"&&this.selectedItem!==Oe("."+Vt,this.element).length-1){for(var n=this.selectedItem+1;n<this.tbItem.length;n++)if(!this.tbItem[n].classList.contains(Ii)){this.selectTab(n,null,!0);break}}this.isSwiped=!1}},e.prototype.spaceKeyDown=function(t){if(t.keyCode===32&&t.which===32||t.keyCode===35&&t.which===35){var i=j(t.target,"."+On);g(i)||t.preventDefault()}},e.prototype.keyHandler=function(t){if(!this.element.classList.contains(Zo)){this.element.classList.add(ow);var i=t.target,r=this.getTabHeader(),n=X("."+bi,r);this.popEle=X("."+TL,r),g(this.popEle)||(this.popObj=this.popEle.ej2_instances[0]);var s=j(document.activeElement,"."+Vt),a=j(i,"."+Vt);switch(t.action){case"space":case"enter":if(i.parentElement.classList.contains(Zo))return;if(t.action==="enter"&&i.classList.contains("e-hor-nav")){this.showPopup(this.show);break}this.keyPressed(i);break;case"tab":case"shiftTab":i.classList.contains(ra)&&j(i,"."+Vt).classList.contains(bi)===!1&&i.setAttribute("tabindex",i.getAttribute("data-tabindex")),this.popObj&&gr(this.popObj.element)&&this.popObj.hide(this.hide),!g(n)&&n.children.item(0).getAttribute("tabindex")==="-1"&&n.children.item(0).setAttribute("tabindex","0");break;case"moveLeft":case"moveRight":g(s)||this.refreshItemVisibility(s);break;case"openPopup":t.preventDefault(),!g(this.popEle)&&this.popEle.classList.contains(cV)&&this.popObj.show(this.show);break;case"delete":if(this.showCloseButton===!0&&!g(a)){var l=a.nextSibling;!g(l)&&l.classList.contains(Vt)&&l.firstElementChild.focus(),this.removeTab(this.getEleIndex(a))}this.setActiveBorder();break}}},e.prototype.refreshItemVisibility=function(t){var i=X("."+this.scrCntClass,this.tbItems);if(!this.isVertical()&&!g(i)){var r=X(".e-hscroll-bar",this.tbItems),n=r.scrollLeft,s=n+r.offsetWidth,a=t.offsetLeft,l=t.offsetWidth,h=t.offsetLeft+t.offsetWidth;if(n<a&&s<h){var u=s-a;r.scrollLeft=n+(l-u)}else if(n>a&&s>h){var u=h-n;r.scrollLeft=n-(l-u)}}else return},e.prototype.getIndexFromEle=function(t){return parseInt(t.substring(t.lastIndexOf("_")+1),10)},e.prototype.hoverHandler=function(t){var i=t.target;!g(i.classList)&&i.classList.contains(uw)&&i.setAttribute("title",new Li("tab",{closeButtonTitle:this.title},this.locale).getConstant("closeButtonTitle"))},e.prototype.evalOnPropertyChangeItems=function(t,i){var r=this;if(t.items instanceof Array&&i.items instanceof Array)if(this.lastIndex=0,g(this.tbObj))this.reRenderItems();else{(this.isReact||this.isAngular)&&this.clearTemplate(),this.setItems(t.items),this.templateEle.length>0&&this.expTemplateContent(),this.templateEle=[];for(var x=X("."+jl+" > ."+Zt,this.element);x.firstElementChild;)ee(x.firstElementChild);this.select(this.selectedItem),this.draggableItems=[],this.bindDraggable()}else{for(var n=Object.keys(t.items),s=0;s<n.length;s++)for(var a=parseInt(Object.keys(t.items)[s],10),l=Object.keys(t.items[a]),h=0;h<l.length;h++){var u=Object(i.items[a])[l[h]],c=Object(t.items[a])[l[h]],d=this.element.querySelectorAll("."+Vt)[a],p=void 0;d&&!g(d.id)&&d.id!==""?p=this.getIndexFromEle(d.id):p=a;var f=X("."+Ss+" #"+Rr+this.tabId+"_"+p,this.element),v=X("."+Zt+" #"+Zt+this.tabId+"_"+p,this.element);if(l[h]==="header"||l[h]==="headerTemplate"){var m=g(this.items[a].header)||g(this.items[a].header.iconCss)?"":this.items[a].header.iconCss,y=this.items[a].headerTemplate||this.items[a].header.text;if(l[h]==="headerTemplate"&&this.clearTabTemplate(f,l[h],Vt),y===""&&m==="")this.removeTab(a);else{this.tbId=d.id;var S=[];S.push(this.items[a]),this.items.splice(a,1),this.itemIndexArray.splice(a,1),this.tbObj.items.splice(a,1);var b=f.classList.contains(Ii);ee(f),this.isReplace=!0,this.addTab(S,a),b&&this.hideTab(a),this.isReplace=!1}}if(l[h]==="content"&&!g(v)){var w=typeof c=="string"||g(c.innerHTML);if(w&&(c[0]==="."||c[0]==="#")&&c.length){var I=document.querySelector(c);v.appendChild(I),I.style.display=""}else c===""&&u[0]==="#"?(document.body.appendChild(this.element.querySelector(u)).style.display="none",v.innerHTML=c):this.isAngular||this.isReact?(this.clearTabTemplate(v,l[h],Rr),v.innerHTML="",this.templateCompile(v,c,a)):typeof c!="function"&&(v.innerHTML=c)}l[h]==="cssClass"&&(g(f)||(f.classList.remove(u),f.classList.add(c)),g(v)||(v.classList.remove(u),v.classList.add(c))),l[h]==="disabled"&&this.enableTab(a,c!==!0),l[h]==="visible"&&this.hideTab(a,c!==!0)}this.isReact&&this.portals&&this.portals.length>0&&this.renderReactTemplates(function(){r.refreshActiveTabBorder()})}},e.prototype.clearTabTemplate=function(t,i,r){if(this.clearTemplates){if(this.registeredTemplate&&this.registeredTemplate[i])for(var n=this.registeredTemplate,s=0;s<n[i].length;s++){var a=n[i][s].rootNodes[0],l=j(a,"."+r);if(!g(l)&&l===t){this.clearTemplate([i],[n[i][s]]);break}}else if(this.portals&&this.portals.length>0)for(var h=this.portals,s=0;s<h.length;s++){var u=h[s],l=j(u.containerInfo,"."+r);if(!g(l)&&l===t){this.clearTemplate([i],s);break}}}},e.prototype.initializeDrag=function(t){var i=this,r=new Dl(t,{dragArea:this.dragArea,dragTarget:"."+Vt,clone:!0,helper:this.helper.bind(this),dragStart:this.itemDragStart.bind(this),drag:function(n){var s=i.getEleIndex(i.dragItem),a,l,h={draggedItem:i.dragItem,event:n.event,target:n.target,droppedItem:n.target.closest("."+Vt),clonedElement:i.cloneElement,index:s};if(!g(n.target.closest("."+jl))&&!n.target.closest("."+jl).isEqualNode(i.element)&&i.dragArea!=="."+On)i.trigger("dragging",h);else{if(!n.target.closest(i.dragArea)&&i.overflowMode!=="Popup"?(document.body.style.cursor="not-allowed",Y([i.cloneElement],Ii),i.dragItem.classList.contains(Ii)&&K([i.dragItem],Ii),i.dragItem.querySelector("."+ra).style.visibility="visible"):(document.body.style.cursor="",i.dragItem.querySelector("."+ra).style.visibility="hidden",i.cloneElement.classList.contains(Ii)&&K([i.cloneElement],Ii)),i.overflowMode==="Scrollable"&&!g(i.element.querySelector(".e-hscroll"))){var u=i.element.querySelector(".e-scroll-right-nav"),c=i.element.querySelector(".e-scroll-left-nav"),d=i.element.querySelector(".e-hscroll-bar");!g(u)&&Math.abs(u.offsetWidth/2+u.offsetLeft)>i.cloneElement.offsetLeft+i.cloneElement.offsetWidth&&(d.scrollLeft-=10),!g(c)&&Math.abs(c.offsetLeft+c.offsetWidth-i.cloneElement.offsetLeft)>c.offsetWidth/2&&(d.scrollLeft+=10)}i.cloneElement.style.pointerEvents="none",l=j(n.target,"."+Vt+".e-draggable");var p=0;i.overflowMode==="Scrollable"&&!g(i.element.querySelector(".e-hscroll"))&&(p=i.element.querySelector(".e-hscroll-content").offsetWidth),l!=null&&!l.isSameNode(i.dragItem)&&l.closest("."+jl).isSameNode(i.dragItem.closest("."+jl))&&(a=i.getEleIndex(l),a<s&&Math.abs(l.offsetLeft+l.offsetWidth-i.cloneElement.offsetLeft)>l.offsetWidth/2&&i.dragAction(l,s,a),a>s&&Math.abs(l.offsetWidth/2)+l.offsetLeft-p<i.cloneElement.offsetLeft+i.cloneElement.offsetWidth&&i.dragAction(l,s,a)),i.droppedIndex=i.getEleIndex(i.dragItem),i.trigger("dragging",h)}},dragStop:this.itemDragStop.bind(this)});this.draggableItems.push(r)},e.prototype.helper=function(t){return this.cloneElement=this.createElement("div"),t.element&&(this.cloneElement=t.element.cloneNode(!0),Y([this.cloneElement],"e-tab-clone-element"),this.element.querySelector("."+On).classList.contains(Bv)&&Y([this.cloneElement],Bv),K([this.cloneElement.querySelector("."+ra)],"e-ripple"),g(this.cloneElement.querySelector(".e-ripple-element"))||Ue(this.cloneElement.querySelector(".e-ripple-element")),document.body.appendChild(this.cloneElement)),this.cloneElement},e.prototype.itemDragStart=function(t){var i=this;this.draggingItems=this.items.map(function(n){return n}),this.dragItem=t.element;var r={draggedItem:t.element,event:t.event,target:t.target,droppedItem:null,index:this.getEleIndex(this.dragItem),clonedElement:this.cloneElement,cancel:!1};this.trigger("onDragStart",r,function(n){if(n.cancel){var s=t.element.ej2_instances[0];g(s)||s.intDestroy(t.event),ee(i.cloneElement)}else i.removeActiveClass(),Y([i.tbItems.querySelector("."+zv)],Ii),i.dragItem.querySelector("."+ra).style.visibility="hidden"})},e.prototype.dragAction=function(t,i,r){if(this.items.length>0){var n=this.draggingItems[i];this.draggingItems.splice(i,1),this.draggingItems.splice(r,0,n)}if(this.overflowMode==="MultiRow"&&t.parentNode.insertBefore(this.dragItem,t.nextElementSibling),i>r)if(this.dragItem.parentElement.isSameNode(t.parentElement))this.dragItem.parentNode.insertBefore(this.dragItem,t);else if(this.overflowMode==="Extended")if(t.isSameNode(t.parentElement.lastChild)){var s=this.dragItem.parentNode;t.parentNode.insertBefore(this.dragItem,t),s.insertBefore(t.parentElement.lastChild,s.childNodes[0])}else this.dragItem.parentNode.insertBefore(t.parentElement.lastChild,this.dragItem.parentElement.childNodes[0]),t.parentNode.insertBefore(this.dragItem,t);else{var a=t.parentElement.lastChild;if(t.isSameNode(a)){var s=this.dragItem.parentNode;t.parentNode.insertBefore(this.dragItem,t),s.insertBefore(a,s.childNodes[0])}else this.dragItem.parentNode.insertBefore(t.parentElement.lastChild,this.dragItem.parentElement.childNodes[0]),t.parentNode.insertBefore(this.dragItem,t)}i<r&&(this.dragItem.parentElement.isSameNode(t.parentElement)?this.dragItem.parentNode.insertBefore(this.dragItem,t.nextElementSibling):this.overflowMode==="Extended"?(this.dragItem.parentElement.appendChild(t.parentElement.firstElementChild),t.parentNode.insertBefore(this.dragItem,t.nextSibling)):(this.dragItem.parentNode.insertBefore(t.parentElement.lastChild,this.dragItem.parentElement.childNodes[0]),t.parentNode.insertBefore(this.dragItem,t)))},e.prototype.itemDragStop=function(t){var i=this;ee(this.cloneElement),this.cloneElement=null,this.dragItem.querySelector("."+ra).style.visibility="visible",document.body.style.cursor="";var r={draggedItem:this.dragItem,event:t.event,target:t.target,droppedItem:this.tbItem[this.droppedIndex],clonedElement:null,index:this.droppedIndex,cancel:!1};this.trigger("dragged",r,function(n){n.cancel?i.refresh():i.items.length>0&&i.draggingItems.length>0?(i.items=i.draggingItems,i.selectedItem=g(i.droppedIndex)?i.getEleIndex(i.dragItem):i.droppedIndex,i.refresh()):(i.dragItem.querySelector("."+ra).style.visibility="",K([i.tbItems.querySelector("."+zv)],Ii),i.droppedIndex=g(i.droppedIndex)?i.getEleIndex(i.dragItem):i.droppedIndex,i.selectTab(i.droppedIndex,null,!0))}),this.dragItem=null,this.droppedIndex=null},e.prototype.enableTab=function(t,i){var r=Oe("."+Vt,this.element)[t];g(r)||(i===!0?(r.classList.remove(Zo,cw),r.firstElementChild.setAttribute("tabindex",r.firstElementChild.getAttribute("data-tabindex"))):(r.classList.add(Zo,cw),r.firstElementChild.removeAttribute("tabindex"),r.classList.contains(bi)&&this.select(t+1)),g(this.items[t])||(this.items[t].disabled=!i,this.dataBind()),r.firstElementChild.setAttribute("aria-disabled",i===!0?"false":"true"))},e.prototype.addTab=function(t,i){var r=this,n={addedItems:t,cancel:!1};if(this.isReplace)this.addingTabContent(t,i);else{for(var s=0,a=t;s<a.length;s++){var l=a[s];l.disabled=l.disabled||!1,l.visible=l.visible||!0}t&&t.length!==0&&this.element&&this.element.classList.contains(Ii)&&this.element.classList.remove(Ii),this.trigger("adding",n,function(h){h.cancel||r.addingTabContent(t,i)})}this.isReact&&this.renderReactTemplates()},e.prototype.addingTabContent=function(t,i){var r=this,n=0;if(this.hdrEle=X("."+On,this.element),g(this.hdrEle))this.items=t,this.reRenderItems(),this.bindDraggable();else{var s=Array.from(Oe(".e-tab-header ."+Vt,this.element)),a=s.length;if(a!==0&&(n=this.getMaxIndicesFromItems(s)+1),g(i)&&(i=a-1),a<i||i<0||isNaN(i))return;a===0&&!g(this.hdrEle)&&(this.hdrEle.style.display=""),g(this.bdrLine)||this.bdrLine.classList.add(Ii),this.tbItems=X("."+Ss,this.getTabHeader()),this.isAdd=!0;var l=this.parseObject(t,i);this.isAdd=!1;var h=0,u;t.forEach(function(c,d){if(u=c.headerTemplate||c.header.text,g(c.headerTemplate||c.header)||g(u)||u.length===0&&!g(c.header)&&g(c.header.iconCss)||(l[d]&&(g(c.id)&&(c.id=Rr+r.tabId+"_"+FL+(n+d).toString()),l[d].htmlAttributes["data-id"]=c.id),r.items.splice(i+h,0,c),h++),!g(c.header)&&!g(c.header.text)&&(r.isTemplate||r.loadOn==="Init")){var p=n+d,f=r.createElement("div",{id:Zt+r.tabId+"_"+p,className:Rr,attrs:{role:"tabpanel","aria-labelledby":Rr+"_"+p}});r.cntEle.insertBefore(f,r.cntEle.children[i+d]);var v=r.getTrgContent(r.cntEle,p.toString());r.getContent(v,c.content,"render",i)}}),this.tbObj.addItems(l,i),this.isReplace||this.trigger("added",{addedItems:t}),this.selectedItem===i?this.select(i):(this.setActiveBorder(),this.tbItem=Oe("."+Vt,this.getTabHeader())),this.bindDraggable()}},e.prototype.removeTab=function(t){var i=this,r=Oe("."+Vt,this.element)[t];if(!g(r)){var n={removedItem:r,removedIndex:t,cancel:!1};this.trigger("removing",n,function(s){if(!s.cancel){var a=X("#"+Rr+i.tabId+"_"+i.extIndex(r.id),X("."+Ss,i.element));g(a)||i.clearTabTemplate(a,"headerTemplate",Vt),i.tbObj.removeItems(t),i.allowDragAndDrop&&t!==Array.prototype.indexOf.call(i.itemIndexArray,r.id)&&(t=Array.prototype.indexOf.call(i.itemIndexArray,r.id));var l=i.itemIndexArray.indexOf(r.id);i.items.splice(l,1),i.itemIndexArray.splice(l,1),i.refreshActiveBorder();var h=X("#"+Zt+i.tabId+"_"+i.extIndex(r.id),X("."+Zt,i.element));if(g(h)||(i.clearTabTemplate(h,"content",Rr),ee(h)),i.trigger("removed",s),i.draggableItems&&i.draggableItems.length>0&&(i.draggableItems[t].destroy(),i.draggableItems[t]=null,i.draggableItems.splice(t,1)),r.classList.contains(bi)){t=t>Oe("."+Vt+":not(."+Jo+")",i.element).length-1?t-1:t,i.enableAnimation=!1,i.tbItem=Oe("."+Vt,i.getTabHeader()),t=i.getSelectingTabIndex(t),t=!isNaN(t)&&t>=0&&i.tbItem.length>t?t:0;var u=i.tbItem[t];if(u){u.classList.contains(Ii)&&u.classList.remove(Ii);var c=u.firstElementChild;c&&c.hasAttribute("aria-hidden")&&c.removeAttribute("aria-hidden")}i.selectedItem=t,i.select(t)}else t!==i.selectedItem&&(t<i.selectedItem&&(t=i.itemIndexArray.indexOf(i.tbItem[i.selectedItem].id),i.setProperties({selectedItem:t>-1?t:i.selectedItem},!0),i.prevIndex=i.selectedItem),i.tbItem=Oe("."+Vt,i.getTabHeader()));if(Oe("."+Vt,i.element).length===0){var d=X("."+Zt,i.element);ee(i.hdrEle),ee(d)}i.enableAnimation=!0}})}},e.prototype.hideTab=function(t,i){var r,n=Oe("."+Vt,this.element)[t];if(!g(n)){if(g(i)&&(i=!0),this.bdrLine.classList.add(Ii),i===!0)if(n.classList.add(Ii),r=Oe("."+Vt+":not(."+Ii+")",this.tbItems),r.length!==0&&n.classList.contains(bi)){if(t!==0)for(var s=t-1;s>=0;s--)if(this.tbItem[s].classList.contains(Ii)){if(s===0){for(var a=t+1;a<this.tbItem.length;a++)if(!this.tbItem[a].classList.contains(Ii)){this.select(a);break}}}else{this.select(s);break}else for(var a=t+1;a<this.tbItem.length;a++)if(!this.tbItem[a].classList.contains(Ii)){this.select(a);break}}else r.length===0&&this.element.classList.add(Ii);else this.element.classList.remove(Ii),r=Oe("."+Vt+":not(."+Ii+")",this.tbItems),n.classList.remove(Ii),r.length===0&&this.select(t);this.setActiveBorder(),g(this.items[t])||(this.items[t].visible=!i,this.dataBind()),g(n.firstElementChild)||n.firstElementChild.setAttribute("aria-hidden",""+i),this.overflowMode==="Popup"&&this.refreshOverflow()}},e.prototype.selectTab=function(t,i,r){i===void 0&&(i=null),r===void 0&&(r=!1),this.isInteracted=r,this.select(t,i)},e.prototype.select=function(t,i){var r=this,n=this.getTabHeader();this.tbItems=X("."+Ss,n),this.tbItem=Oe("."+Vt,n),this.content=X("."+Zt,this.element),this.prevItem=this.tbItem[this.prevIndex],g(this.selectedItem)||this.selectedItem<0||this.tbItem.length<=this.selectedItem||isNaN(this.selectedItem)?this.selectedItem=0:this.selectedID=this.extIndex(this.tbItem[this.selectedItem].id);var s=this.tbItem[t];g(s)?this.selectedID="0":this.selectingID=this.extIndex(s.id),!g(this.prevItem)&&!this.prevItem.classList.contains(Zo)&&this.prevItem.children.item(0).setAttribute("tabindex",this.prevItem.firstElementChild.getAttribute("tabindex"));var a={event:i,previousItem:this.prevItem,previousIndex:this.prevIndex,selectedItem:this.tbItem[this.selectedItem],selectedIndex:this.selectedItem,selectedContent:g(this.content)?null:X("#"+Zt+this.tabId+"_"+this.selectedID,this.content),selectingItem:s,selectingIndex:t,selectingContent:g(this.content)?null:X("#"+Zt+this.tabId+"_"+this.selectingID,this.content),isSwiped:this.isSwiped,isInteracted:this.isInteracted,cancel:!1};this.initRender?this.selectingContent(t,this.isInteracted):this.trigger("selecting",a,function(l){l.cancel||r.selectingContent(t,r.isInteracted)}),this.isInteracted=!1},e.prototype.getSelectingTabIndex=function(t){if(!g(this.tbItem[t])&&(this.tbItem[t].classList.contains(Zo)||this.tbItem[t].classList.contains(Ii)))for(var i=t+1;i<this.items.length;i++)if(this.items[i].disabled===!1&&this.items[i].visible===!0){t=i;break}else t=0;return t},e.prototype.selectingContent=function(t,i){if(typeof t=="number")if(t=this.getSelectingTabIndex(t),this.tbItem.length>t&&t>=0&&!isNaN(t))if(this.prevIndex=this.selectedItem,this.prevItem=this.tbItem[this.prevIndex],this.tbItem[t].classList.contains(Jo)&&this.reorderActiveTab){if(this.setActive(this.popupHandler(this.tbItem[t]),null,i),!g(this.items)&&this.items.length>0&&this.allowDragAndDrop){this.tbItem=Oe("."+Ss+" ."+Vt,this.hdrEle);var r=this.items[t];this.items.splice(t,1),this.items.splice(this.tbItem.length-1,0,r);var n=this.itemIndexArray[t];this.itemIndexArray.splice(t,1),this.itemIndexArray.splice(this.tbItem.length-1,0,n)}}else this.setActive(t,null,i);else this.setActive(0,null,i);else t instanceof HTMLElement&&this.setActive(this.getEleIndex(t),null,i)},e.prototype.getItemIndex=function(t){for(var i,r=0;r<this.tbItem.length;r++){var n=this.tbItem[r].getAttribute("data-id");if(t===n){i=r;break}}return i},e.prototype.disable=function(t){this.setCssClass(this.element,Zo,t),this.element.setAttribute("aria-disabled",""+t)},e.prototype.getPersistData=function(){return this.addOnPersist(["selectedItem","actEleId"])},e.prototype.getModuleName=function(){return"tab"},e.prototype.onPropertyChanged=function(t,i){for(var r=this,n=Object.keys(t).sort(function(u,c){return u==="items"?-1:c==="items"?1:0}),s=0,a=n;s<a.length;s++){var l=a[s];switch(l){case"width":Ye(this.element,{width:Le(t.width)});break;case"height":Ye(this.element,{height:Le(t.height)}),this.setContentHeight(!1);break;case"cssClass":var h=this.element.querySelector("."+On);i.cssClass!==""&&!g(i.cssClass)?(this.setCssClass(this.element,i.cssClass,!1),this.setCssClass(this.element,t.cssClass,!0),g(h)||(this.setCssClass(h,i.cssClass,!1),this.setCssClass(h,t.cssClass,!0))):(this.setCssClass(this.element,t.cssClass,!0),g(h)||this.setCssClass(h,t.cssClass,!0));break;case"items":this.evalOnPropertyChangeItems(t,i);break;case"showCloseButton":this.setCloseButton(t.showCloseButton);break;case"reorderActiveTab":this.refreshActiveTabBorder();break;case"selectedItem":this.selectedItem=i.selectedItem,this.select(t.selectedItem);break;case"headerPlacement":this.changeOrientation(t.headerPlacement);break;case"enableRtl":this.setRTL(t.enableRtl);break;case"overflowMode":this.tbObj.overflowMode=t.overflowMode,this.tbObj.dataBind(),this.refreshActiveTabBorder();break;case"heightAdjustMode":this.setContentHeight(!1),this.select(this.selectedItem);break;case"scrollStep":this.tbObj&&(this.tbObj.scrollStep=this.scrollStep);break;case"allowDragAndDrop":this.bindDraggable();break;case"swipeMode":this.touchModule&&(this.touchModule.destroy(),this.touchModule=null),this.bindSwipeEvents();break;case"dragArea":this.allowDragAndDrop&&(this.draggableItems.forEach(function(u){u.dragArea=r.dragArea}),this.refresh());break}}},e.prototype.refreshActiveTab=function(){if(this.isReact&&this.isTemplate&&this.clearTemplate(),this.isTemplate){var y=this.element.querySelector("."+Ss),S=this.element.querySelector("."+Vt+"."+bi),b=this.getIndexFromEle(S.id),w=S.innerText,I=this.element.querySelector("."+Zt).querySelector("."+bi).children[0],x=I.innerHTML;ee(S),ee(I);var M={className:Vt+" "+aw+" "+bi,id:Rr+this.tabId+"_"+b},D=this.createElement("span",{className:Bp,innerHTML:w,attrs:{role:"presentation"}}).outerHTML,A=this.createElement("div",{className:jv,innerHTML:D+this.btnCls.outerHTML}).outerHTML,u=S.firstElementChild.getAttribute("data-tabindex"),L=this.createElement("div",{className:ra,innerHTML:A,attrs:{tabIndex:u,"data-tabindex":u,role:"tab","aria-controls":Zt+this.tabId+"_"+b,"aria-selected":"true","aria-disabled":"false"}});y.insertBefore(this.createElement("div",M),y.children[b+1]),this.element.querySelector("."+Vt+"."+bi).appendChild(L);var p=this.createElement("div",{innerHTML:x});this.element.querySelector("."+Zt).querySelector("."+bi).appendChild(p)}else if(this.element.querySelector("."+Vt+"."+bi)){ee(this.element.querySelector("."+Vt+"."+bi).children[0]),ee(this.element.querySelector("."+Zt).querySelector("."+bi).children[0]);var t=this.items[this.selectedItem],i=g(t.header)||g(t.header.iconPosition)?"":t.header.iconPosition,r=g(t.header)||g(t.header.iconCss)?"":t.header.iconCss,n=t.headerTemplate||t.header.text,s=this.createElement("div",{className:Bp,attrs:{role:"presentation"}});g(n.tagName)?this.headerTextCompile(s,n,this.selectedItem):s.appendChild(n);var a=void 0,l=this.createElement("span",{className:lw+" "+AL+" "+hw+"-"+i+" "+r}),h=this.createElement("div",{className:jv});h.appendChild(s),n!==""&&n!==void 0&&r!==""?(i==="left"||i==="top"?h.insertBefore(l,h.firstElementChild):h.appendChild(l),a=s,this.isIconAlone=!1):(a=r===""?s:l,a===l&&(ee(s),h.appendChild(l),this.isIconAlone=!0));var u=g(t.tabIndex)?"-1":t.tabIndex.toString(),c=t.disabled?{}:{tabIndex:u,"data-tabindex":u,role:"tab","aria-selected":"true","aria-disabled":"false"};h.appendChild(this.btnCls.cloneNode(!0));var d=this.createElement("div",{className:ra,attrs:c});d.appendChild(h),(i==="top"||i==="bottom")&&this.element.classList.add("e-vertical-icon"),this.element.querySelector("."+Vt+"."+bi).appendChild(d);var p=this.createElement("div"),f=t.content,v=void 0;if(typeof f=="string"||g(f.innerHTML))if(typeof f=="string"&&this.enableHtmlSanitizer&&(f=Bt.sanitize(f)),f[0]==="."||f[0]==="#")if(document.querySelectorAll(f).length){var m=document.querySelector(f);v=m.outerHTML.trim(),p.appendChild(m),m.style.display=""}else this.compileElement(p,f,"content",this.selectedItem);else this.compileElement(p,f,"content",this.selectedItem);else p.appendChild(f);g(v)||this.templateEle.indexOf(f.toString())===-1&&this.templateEle.push(f.toString()),this.element.querySelector("."+Rr+"."+bi).appendChild(p)}this.isReact&&this.renderReactTemplates()},e.prototype.refreshActiveTabBorder=function(){if(this.heightAdjustMode==="None"&&this.height!=="auto"&&this.cntEle&&!this.isVertical()){var t=this.getTabHeader();Ye(this.cntEle,{height:this.element.clientHeight-t.offsetHeight+"px"})}var i=X("."+Vt+"."+Jo+"."+bi,this.element);!g(i)&&this.reorderActiveTab&&this.select(this.getEleIndex(i)),this.refreshActiveBorder()},Nt([Wt([],mV)],e.prototype,"items",void 0),Nt([C("100%")],e.prototype,"width",void 0),Nt([C("Both")],e.prototype,"swipeMode",void 0),Nt([C("auto")],e.prototype,"height",void 0),Nt([C("")],e.prototype,"cssClass",void 0),Nt([C(0)],e.prototype,"selectedItem",void 0),Nt([C("Top")],e.prototype,"headerPlacement",void 0),Nt([C("Content")],e.prototype,"heightAdjustMode",void 0),Nt([C("Scrollable")],e.prototype,"overflowMode",void 0),Nt([C("Demand")],e.prototype,"loadOn",void 0),Nt([C(!1)],e.prototype,"enablePersistence",void 0),Nt([C(!0)],e.prototype,"enableHtmlSanitizer",void 0),Nt([C(!1)],e.prototype,"showCloseButton",void 0),Nt([C(!0)],e.prototype,"reorderActiveTab",void 0),Nt([C()],e.prototype,"scrollStep",void 0),Nt([C()],e.prototype,"dragArea",void 0),Nt([C(!1)],e.prototype,"allowDragAndDrop",void 0),Nt([C(!0)],e.prototype,"clearTemplates",void 0),Nt([be({},gV)],e.prototype,"animation",void 0),Nt([q()],e.prototype,"created",void 0),Nt([q()],e.prototype,"adding",void 0),Nt([q()],e.prototype,"added",void 0),Nt([q()],e.prototype,"selecting",void 0),Nt([q()],e.prototype,"selected",void 0),Nt([q()],e.prototype,"removing",void 0),Nt([q()],e.prototype,"removed",void 0),Nt([q()],e.prototype,"onDragStart",void 0),Nt([q()],e.prototype,"dragging",void 0),Nt([q()],e.prototype,"dragged",void 0),Nt([q()],e.prototype,"destroyed",void 0),e=Nt([bt],e),e}(Kt),Jv=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),it=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},na="e-treeview",RL="e-control",or="e-icon-collapsible",ii="e-icon-expandable",Mt="e-list-item",Oh="e-list-text",yV="e-text-wrap",bV="e-ie-wrap",Jt="e-list-parent",Vv="e-hover",Cs="e-active",_v="e-icons-spinner",el="e-process",Yr="e-icons",on="e-text-content",Uv="e-input",PL="e-input-group",Wv="e-tree-input",vw="e-editing",BL="e-rtl",zL="e-interaction",SV="e-drag-item",jL="e-droppable",mw="e-dragging",zp="e-sibling",qv="e-drop-in",jp="e-drop-next",yw="e-drop-out",bw="e-no-drop",CV="e-fullrow-wrap",tl="e-fullrow",xc="e-selected",Gv="e-expanded",HL="e-node-collapsed",Ic="e-disable",wV="e-drop-count",Rn="e-check",sa="e-stop",ss="e-treeview-checkbox",il="e-frame",xV="e-ripple-container",VL="e-ripple",IV="e-ripple-element",Rh="e-node-focus",_L="e-list-img",MV="e-bigger",DV="e-small",EV="e-has-child",Yv="e-animation-active",UL="e-disabled",Hp="e-prevent",WL={treeRole:"group",itemRole:"treeitem",listRole:"group",itemText:"",wrapperRole:""},AV=function(o){Jv(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return it([C("child")],e.prototype,"child",void 0),it([C([])],e.prototype,"dataSource",void 0),it([C("expanded")],e.prototype,"expanded",void 0),it([C("hasChildren")],e.prototype,"hasChildren",void 0),it([C("htmlAttributes")],e.prototype,"htmlAttributes",void 0),it([C("iconCss")],e.prototype,"iconCss",void 0),it([C("id")],e.prototype,"id",void 0),it([C("imageUrl")],e.prototype,"imageUrl",void 0),it([C("isChecked")],e.prototype,"isChecked",void 0),it([C("parentID")],e.prototype,"parentID",void 0),it([C(null)],e.prototype,"query",void 0),it([C("selectable")],e.prototype,"selectable",void 0),it([C("selected")],e.prototype,"selected",void 0),it([C(null)],e.prototype,"tableName",void 0),it([C("text")],e.prototype,"text",void 0),it([C("tooltip")],e.prototype,"tooltip",void 0),it([C("navigateUrl")],e.prototype,"navigateUrl",void 0),e}(Re),qL=function(o){Jv(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return it([C("SlideDown")],e.prototype,"effect",void 0),it([C(400)],e.prototype,"duration",void 0),it([C("linear")],e.prototype,"easing",void 0),e}(Re),TV=function(o){Jv(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return it([be({effect:"SlideUp",duration:400,easing:"linear"},qL)],e.prototype,"collapse",void 0),it([be({effect:"SlideDown",duration:400,easing:"linear"},qL)],e.prototype,"expand",void 0),e}(Re),em=function(o){Jv(e,o);function e(i,r){var n=o.call(this,i,r)||this;return n.isRefreshed=!1,n.preventExpand=!1,n.checkedElement=[],n.disableNode=[],n.validArr=[],n.validNodes=[],n.expandChildren=[],n.isFieldChange=!1,n.changeDataSource=!1,n.hasTemplate=!1,n.isFirstRender=!1,n.isNodeDropped=!1,n.isInteracted=!1,n.isRightClick=!1,n.mouseDownStatus=!1,n.isDropIn=!1,n.OldCheckedData=[],n.isHiddenItem=!1,n}t=e,e.prototype.getModuleName=function(){return"treeview"},e.prototype.preRender=function(){var i=this;this.checkActionNodes=[],this.parentNodeCheck=[],this.dragStartAction=!1,this.isAnimate=!1,this.keyConfigs={escape:"escape",end:"end",enter:"enter",f2:"f2",home:"home",moveDown:"downarrow",moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",ctrlDown:"ctrl+downarrow",ctrlUp:"ctrl+uparrow",ctrlEnter:"ctrl+enter",ctrlHome:"ctrl+home",ctrlEnd:"ctrl+end",ctrlA:"ctrl+A",shiftDown:"shift+downarrow",shiftUp:"shift+uparrow",shiftEnter:"shift+enter",shiftHome:"shift+home",shiftEnd:"shift+end",csDown:"ctrl+shift+downarrow",csUp:"ctrl+shift+uparrow",csEnter:"ctrl+shift+enter",csHome:"ctrl+shift+home",csEnd:"ctrl+shift+end",space:"space",shiftSpace:"shift+space",ctrlSpace:"ctrl+space"},this.listBaseOption={expandCollapse:!0,showIcon:!0,expandIconClass:ii,ariaAttributes:WL,expandIconPosition:"Left",itemCreated:function(r){i.beforeNodeCreate(r)},enableHtmlSanitizer:this.enableHtmlSanitizer,itemNavigable:this.fullRowNavigable},this.updateListProp(this.fields),this.aniObj=new It({}),this.treeList=[],this.isLoaded=!1,this.isInitalExpand=!1,this.expandChildren=[],this.index=0,this.setTouchClass(),this.DDTTreeData=JSON.parse(JSON.stringify(this.fields.dataSource)),g(this.selectedNodes)&&this.setProperties({selectedNodes:[]},!0),g(this.checkedNodes)&&this.setProperties({checkedNodes:[]},!0),g(this.expandedNodes)?this.setProperties({expandedNodes:[]},!0):this.isInitalExpand=!0},e.prototype.getPersistData=function(){var i=["selectedNodes","checkedNodes","expandedNodes"];return this.addOnPersist(i)},e.prototype.render=function(){this.initialRender=!0,this.initialize(),this.setDataBinding(!1),this.setDisabledMode(),this.setExpandOnType(),this.disabled||this.setRipple(),this.wireEditingEvents(this.allowEditing),this.setDragAndDrop(this.allowDragAndDrop),this.disabled||this.wireEvents(),this.initialRender=!1,this.renderComplete()},e.prototype.initialize=function(){this.element.setAttribute("role","tree"),!g(this.fields.dataSource)&&Array.isArray(this.fields.dataSource)&&this.fields.dataSource.length!==0&&this.element.setAttribute("aria-activedescendant",this.element.id+"_active"),this.setCssClass(null,this.cssClass),this.setEnableRtl(),this.setFullRow(this.fullRowSelect),this.setTextWrap(),this.nodeTemplateFn=this.templateComplier(this.nodeTemplate)},e.prototype.setDisabledMode=function(){this.disabled?(this.element.classList.add(UL),this.element.setAttribute("aria-disabled","true")):(this.element.classList.remove(UL),this.element.setAttribute("aria-disabled","false"))},e.prototype.setEnableRtl=function(){(this.enableRtl?Y:K)([this.element],BL)},e.prototype.setRipple=function(){var i="."+tl+",."+on,r={selector:i,ignore:"."+on+" > ."+Yr+",."+PL+",."+Uv+", ."+ss};this.rippleFn=Vi(this.element,r);var n={selector:"."+on+" > ."+Yr,isCenterRipple:!0};this.rippleIconFn=Vi(this.element,n)},e.prototype.setFullRow=function(i){(i?Y:K)([this.element],CV)},e.prototype.setMultiSelect=function(i){i?this.element.setAttribute("aria-multiselectable","true"):this.element.setAttribute("aria-multiselectable","false")},e.prototype.templateComplier=function(i){if(i){this.hasTemplate=!0,this.element.classList.add(zL);try{return typeof i!="function"&&document.querySelectorAll(i).length?wt(document.querySelector(i).innerHTML.trim()):wt(i)}catch{return wt(i)}}this.element.classList.remove(zL)},e.prototype.setDataBinding=function(i){var r=this;this.treeList.push("false"),this.fields.dataSource instanceof re?(this.isOffline=this.fields.dataSource.dataSource.offline,this.fields.dataSource.ready?this.fields.dataSource.ready.then(function(n){r.isOffline=r.fields.dataSource.dataSource.offline,r.fields.dataSource instanceof re&&r.isOffline&&(r.treeList.pop(),r.treeData=n.result,r.isNumberTypeId=r.getType(),r.setRootData(),r.renderItems(!0),r.treeList.length===0&&!r.isLoaded&&r.finalize())}).catch(function(n){r.trigger("actionFailure",{error:n})}):this.fields.dataSource.executeQuery(this.getQuery(this.fields)).then(function(n){r.treeList.pop(),r.treeData=n.result,r.isNumberTypeId=r.getType(),r.setRootData(),i&&(r.changeDataSource=!0),r.renderItems(!0),r.changeDataSource=!1,r.treeList.length===0&&!r.isLoaded&&r.finalize()}).catch(function(n){r.trigger("actionFailure",{error:n})})):(this.treeList.pop(),g(this.fields.dataSource)?this.rootData=this.treeData=[]:(this.treeData=JSON.parse(JSON.stringify(this.fields.dataSource)),this.setRootData()),this.isNumberTypeId=this.getType(),this.renderItems(!1)),this.treeList.length===0&&!this.isLoaded&&this.finalize()},e.prototype.getQuery=function(i,r){r===void 0&&(r=null);var n=[],s;if(i.query)s=i.query.clone();else{s=new Pe;for(var a=this.getActualProperties(i),l=0,h=Object.keys(a);l<h.length;l++){var u=h[l];u!=="dataSource"&&u!=="tableName"&&u!=="child"&&i[""+u]&&u!=="url"&&n.indexOf(i[""+u])===-1&&n.push(i[""+u])}s.select(n),Object.prototype.hasOwnProperty.call(a,"tableName")&&s.from(i.tableName)}return At.addSorting(this.sortOrder,i.text,s),!g(r)&&!g(i.parentID)&&s.where(i.parentID,"equal",this.isNumberTypeId?parseFloat(r):r),s},e.prototype.getType=function(){return this.treeData[0]?typeof V(this.fields.id,this.treeData[0])=="number":!1},e.prototype.setRootData=function(){if(this.dataType=this.getDataType(this.treeData,this.fields),this.dataType===1){this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID);var i=this.getChildNodes(this.treeData,void 0,!0);g(i)?this.rootData=[]:this.rootData=i}else this.rootData=this.treeData},e.prototype.isChildObject=function(){return typeof this.fields.child=="object"},e.prototype.renderItems=function(i){this.listBaseOption.ariaAttributes.level=1;var r=this.getSortedData(this.rootData);this.ulElement=At.createList(this.createElement,i?this.rootData:r,this.listBaseOption),this.element.appendChild(this.ulElement);var n=this.ulElement.querySelectorAll(".e-list-item");if(this.loadOnDemand===!1)for(var s=0;s<n.length;)this.renderChildNodes(n[parseInt(s.toString(),10)],!0,null,!0),s++;var a=Oe("."+Jt,this.element);(a.length===1&&n&&n.length!==0||this.loadOnDemand)&&this.finalizeNode(this.element),this.parentNodeCheck=[],this.parentCheckData=[],this.updateCheckedStateFromDS(),this.autoCheck&&this.showCheckBox&&!this.isLoaded&&this.updateParentCheckState()},e.prototype.updateCheckedStateFromDS=function(){if(this.validNodes=[],this.treeData&&this.showCheckBox){if(this.dataType===1){for(var i=this.fields,r=new re(this.treeData).executeLocal(new Pe().where(i.isChecked,"equal",!0,!1)),n=0;n<r.length;n++){var s=r[parseInt(n.toString(),10)][this.fields.id]?r[parseInt(n.toString(),10)][this.fields.id].toString():null;if(this.checkedNodes.indexOf(s)===-1&&!this.isLoaded&&this.checkDisabledState(s,r[n]),r[parseInt(n.toString(),10)][this.fields.hasChildren])for(var a=r[parseInt(n.toString(),10)][this.fields.id],l=new re(this.treeData).executeLocal(new Pe().where(i.parentID,"equal",a,!1)),h=0;h<l.length;h++){var u=l[parseInt(h.toString(),10)][this.fields.id]?l[parseInt(h.toString(),10)][this.fields.id].toString():null;this.checkedNodes.indexOf(u)===-1&&this.autoCheck&&this.checkDisabledState(u,l[h])}}for(var n=0;n<this.checkedNodes.length;n++){var c=this.fields,d=new re(this.treeData).executeLocal(new Pe().where(c.id,"equal",this.checkedNodes[parseInt(n.toString(),10)],!0));if(d[0]&&this.autoCheck&&(this.getCheckedNodeDetails(c,d),this.checkIndeterminateState(d[0])),d.length>0){var p=d[0][this.fields.id]?d[0][this.fields.id].toString():null;this.checkedNodes.indexOf(p)>-1&&this.validNodes.indexOf(p)===-1&&this.validNodes.push(p)}for(var f=new re(this.treeData).executeLocal(new Pe().where(c.parentID,"equal",this.checkedNodes[parseInt(n.toString(),10)],!0)),v=0;v<f.length;v++){var p=f[parseInt(v.toString(),10)][this.fields.id]?f[parseInt(v.toString(),10)][this.fields.id].toString():null;this.checkedNodes.indexOf(p)===-1&&this.autoCheck&&this.checkDisabledState(p,f[v]),this.checkedNodes.indexOf(p)>-1&&this.validNodes.indexOf(p)===-1&&this.validNodes.push(p)}}}else if(this.dataType===2||this.fields.dataSource instanceof re&&this.isOffline){for(var v=0;v<this.treeData.length;v++){var m=this.treeData[parseInt(v.toString(),10)][this.fields.id]?this.treeData[parseInt(v.toString(),10)][this.fields.id].toString():"";this.treeData[parseInt(v.toString(),10)][this.fields.isChecked]&&!this.isLoaded&&this.checkedNodes.indexOf(m)===-1&&this.checkDisabledState(m,this.treeData[v]),this.checkedNodes.indexOf(m)>-1&&this.validNodes.indexOf(m)===-1&&this.validNodes.push(m);var y=V(this.fields.child.toString(),this.treeData[parseInt(v.toString(),10)]);y&&this.updateChildCheckState(y,this.treeData[parseInt(v.toString(),10)])}this.validNodes=this.enablePersistence?this.checkedNodes:this.validNodes}this.setProperties({checkedNodes:this.validNodes},!0)}},e.prototype.getCheckedNodeDetails=function(i,r){var n=r[0][this.fields.parentID]?r[0][this.fields.parentID].toString():null,s=0,a=this.element.querySelector('[data-uid="'+r[0][this.fields.id]+'"]'),l=this.element.querySelector('[data-uid="'+r[0][this.fields.parentID]+'"]');if(!a&&!l){this.parentNodeCheck.indexOf(n)===-1&&this.parentNodeCheck.push(n);for(var h=this.getChildNodes(this.treeData,n),u=0;u<h.length;u++){var c=h[parseInt(u.toString(),10)][this.fields.id]?h[parseInt(u.toString(),10)][this.fields.id].toString():null;this.checkedNodes.indexOf(c)!==-1&&s++,s===h.length&&this.checkedNodes.indexOf(n)===-1&&this.checkDisabledState(n)}var d=new re(this.treeData).executeLocal(new Pe().where(i.id,"equal",n,!0));this.getCheckedNodeDetails(i,d)}else if(l){var p=X("."+Rn,l);p||this.changeState(l,"indeterminate",null,!0,!0)}},e.prototype.updateParentCheckState=function(){var i=Oe("."+sa,this.element),r,n=this.treeData;this.element.classList.contains("e-filtering")&&(n=this.DDTTreeData);for(var s=0;s<i.length;s++){var a=j(i[parseInt(s.toString(),10)],"."+Mt),l=a.getAttribute("data-uid").toString(),h=void 0;this.element.classList.contains("e-filtering")&&(h=new re(this.OldCheckedData).executeLocal(new Pe().where("parentID","equal",l,!0))),this.dataType===1?r=new re(n).executeLocal(new Pe().where(this.fields.parentID,"equal",l,!0)):r=this.getChildNodes(n,l);var u=0;if(r){for(var c=function(v){var m=r[parseInt(v.toString(),10)][d.fields.id].toString();(d.checkedNodes.indexOf(m)!==-1||d.element.classList.contains("e-filtering")&&h.findIndex(function(y){return y.id===m})!==-1)&&u++},d=this,p=0;p<r.length;p++)c(p);if(u===r.length){var f=a.getAttribute("data-uid");this.checkedNodes.indexOf(f)===-1&&this.checkDisabledState(f),this.changeState(a,"check",null,!0,!0)}else u===0&&this.checkedNodes.length===0&&this.changeState(a,"uncheck",null,!0,!0)}}},e.prototype.checkIndeterminateState=function(i){var r;if(this.dataType===1?r=this.element.querySelector('[data-uid="'+i[this.fields.parentID]+'"]'):r=this.element.querySelector('[data-uid="'+i[this.fields.id]+'"]'),r){var n=r.getAttribute("aria-checked");n!=="true"&&this.changeState(r,"indeterminate",null,!0,!0)}else this.dataType===2&&this.parentNodeCheck.indexOf(i[this.fields.id].toString())===-1&&this.parentNodeCheck.push(i[this.fields.id].toString())},e.prototype.updateChildCheckState=function(i,r){for(var n=0,s=r[this.fields.id]?r[this.fields.id].toString():"",a=0;a<i.length;a++){var l=i[parseInt(a.toString(),10)][this.fields.id]?i[parseInt(a.toString(),10)][this.fields.id].toString():"";i[parseInt(a.toString(),10)][this.fields.isChecked]&&!this.isLoaded&&this.checkedNodes.indexOf(l)===-1&&this.checkDisabledState(l,i[a]),this.checkedNodes.indexOf(s)!==-1&&this.checkedNodes.indexOf(l)===-1&&this.autoCheck&&this.checkDisabledState(l,i[a]),this.checkedNodes.indexOf(l)!==-1&&this.autoCheck&&n++,this.checkedNodes.indexOf(l)>-1&&this.validNodes.indexOf(l)===-1&&this.validNodes.push(l);var h=V(this.fields.child.toString(),i[parseInt(a.toString(),10)]);h&&h.length&&(this.parentCheckData.indexOf(r)===-1&&this.parentCheckData.push(r),this.updateChildCheckState(h,i[parseInt(a.toString(),10)])),n===i.length&&this.autoCheck&&this.checkedNodes.indexOf(s)===-1&&this.checkDisabledState(s,r)}if(n!==0&&this.autoCheck){this.checkIndeterminateState(r);for(var u=0;u<this.parentCheckData.length;u++)r!==this.parentCheckData[parseInt(u.toString(),10)]&&this.parentCheckData[parseInt(u.toString(),10)]&&this.checkIndeterminateState(this.parentCheckData[parseInt(u.toString(),10)])}this.parentCheckData=[]},e.prototype.beforeNodeCreate=function(i){if(this.showCheckBox){var r=Uo(this.createElement,!0,{cssClass:this.touchClass});r.classList.add(ss);var n=X("div."+ii+", div."+or,i.item),s=i.item.getAttribute("data-uid");i.item.childNodes[0].insertBefore(r,i.item.childNodes[0].childNodes[g(n)?0:1]);var a=V(i.fields.isChecked,i.curData);this.checkedNodes.indexOf(s)>-1?(X("."+il,r).classList.add(Rn),i.item.setAttribute("aria-checked","true"),this.addCheck(i.item)):!g(a)&&a.toString()==="true"?(X("."+il,r).classList.add(Rn),i.item.setAttribute("aria-checked","true"),this.addCheck(i.item)):i.item.setAttribute("aria-checked","false");var l=X("."+il,r);E.add(l,"mousedown",this.frameMouseHandler,this),E.add(l,"mouseup",this.frameMouseHandler,this)}this.fullRowSelect&&this.createFullRow(i.item),this.allowMultiSelection&&!i.item.classList.contains(xc)&&i.item.setAttribute("aria-selected","false");var h=i.fields;if(this.addActionClass(i,h.selected,xc),this.addActionClass(i,h.expanded,Gv),i.item.setAttribute("tabindex","-1"),E.add(i.item,"focus",this.focusIn,this),!g(this.nodeTemplateFn)){var u=i.item.querySelector("."+Oh),c=i.item.getAttribute("data-uid");u.innerHTML="",this.renderNodeTemplate(i.curData,u,c)}var d={node:i.item,nodeData:i.curData,text:i.text};if(!this.isRefreshed&&(this.trigger("drawNode",d),i.curData[this.fields.selectable]===!1&&!this.showCheckBox)){i.item.classList.add(Hp);var p=i.item.firstElementChild;p.style.cursor="not-allowed"}},e.prototype.frameMouseHandler=function(i){var r=X("."+xV,i.target.parentElement);Tl(i,r)},e.prototype.addActionClass=function(i,r,n){var s=i.curData,a=V(r,s);!g(a)&&a.toString()!=="false"&&i.item.classList.add(n)},e.prototype.getDataType=function(i,r){if(this.fields.dataSource instanceof re){for(var n=0;n<i.length;n++)if(this.isOffline){if(typeof r.child=="string"&&g(V(r.child,i[parseInt(n.toString(),10)]))&&!g(V(r.parentID,i[parseInt(n.toString(),10)])))return 1}else if(typeof r.child=="string"&&g(V(r.child,i[parseInt(n.toString(),10)])))return 1;return 2}for(var n=0,s=i.length;n<s;n++){if(typeof r.child=="string"&&(!g(V(r.child,i[parseInt(n.toString(),10)]))||Object.prototype.hasOwnProperty.call(i[parseInt(n.toString(),10)],r.child))||this.isChildObject())return 2;if(!g(V(r.parentID,i[parseInt(n.toString(),10)]))||!g(V(r.hasChildren,i[parseInt(n.toString(),10)])))return 1}return 1},e.prototype.getGroupedData=function(i,r){for(var n=new Pe().group(r),s=At.getDataSource(i,n),a=[],l=0;l<s.length;l++){var h=s[parseInt(l.toString(),10)].items;a.push(h)}return a},e.prototype.getSortedData=function(i){return i&&this.sortOrder!=="None"&&(i=At.getDataSource(i,At.addSorting(this.sortOrder,this.fields.text))),i},e.prototype.finalizeNode=function(i,r,n){var s=this;if(r||this.updateAttributes(i),!n){var a=Oe("."+Gv,i);if(!this.loadOnDemand&&this.fields.dataSource instanceof re&&(this.isInitalExpand=this.treeData.filter(function(h){return h[s.fields.expanded]===!0}).length>0?!0:this.isInitalExpand),!this.isInitalExpand)for(var l=0;l<a.length;l++)this.renderChildNodes(a[parseInt(l.toString(),10)]);K(a,Gv)}r||this.updateList(),this.isLoaded&&this.updateCheckedProp()},e.prototype.updateAttributes=function(i){for(var r=Oe("."+_L,i),n=0;n<r.length;n++)r[parseInt(n.toString(),10)].setAttribute("alt",_L);if(this.isLoaded){for(var s=Oe("."+xc,i),a=0;a<s.length;a++){this.selectNode(s[parseInt(a.toString(),10)],null);break}K(s,xc)}for(var l=Oe("."+Mt+":not(."+Gv+")",i),h=0;h<l.length;h++){var u=X("div."+Yr,l[parseInt(h.toString(),10)]);u&&u.classList.contains(ii)&&this.disableExpandAttr(l[parseInt(h.toString(),10)])}},e.prototype.updateCheckedProp=function(){if(this.showCheckBox){var i=[].concat([],this.checkedNodes);this.setProperties({checkedNodes:i},!0)}},e.prototype.ensureIndeterminate=function(){if(this.autoCheck)for(var i=Oe("li",this.element),r=void 0,n=0;n<i.length;n++)i[parseInt(n.toString(),10)].classList.contains(Mt)&&(r=X("."+Jt,i[parseInt(n.toString(),10)]),r?this.ensureParentCheckState(i[parseInt(n.toString(),10)]):this.ensureChildCheckState(i[parseInt(n.toString(),10)]));else for(var s=Oe("."+sa,this.element),n=0;n<s.length;n++)s[parseInt(n.toString(),10)].classList.remove(sa)},e.prototype.ensureParentCheckState=function(i){if(!g(i)){if(i.classList.contains(na))return;var r=i;i.classList.contains(Mt)&&(r=X("."+Jt,i));var n=Oe("."+ss+" ."+Rn,r),s=Oe("."+sa,r),a=Oe(this.checkDisabledChildren?"."+Mt:"."+Mt+":not(."+Ic+")",r),l=i.getElementsByClassName(ss)[0],h=a.length,u=n.length,c=[],d=[],p=i.getAttribute("data-uid"),f=!0,v=!1;a.forEach(function(M){if(M instanceof HTMLElement){var D=M.getAttribute("aria-checked");D==="true"?v=!0:f=!1}});var m=!1;if(this.element.classList.contains("e-filtering")){var y=new re(this.OldCheckedData).executeLocal(new Pe().where("parentID","equal",p,!0));u=y.length;var S=new re(this.OldCheckedData).executeLocal(new Pe().where("hasChildren","equal",!0,!0));S.length>0&&this.OldCheckedData.some(function(M){return M.id===p})&&v&&(u=S.length,m=!0);var b=[];this.dataType===1?b=new re(this.DDTTreeData).executeLocal(new Pe().where(this.fields.parentID,"equal",p,!0)):b=this.getChildNodes(this.DDTTreeData,p),h=b.length}if(this.autoCheck&&this.showCheckBox&&!(this.fields.dataSource instanceof re)){var w=this.getSelectedChildNodeDetails(p);c=w,d=new re(this.checkActionNodes).executeLocal(new Pe().where("parentID","equal",p,!0))}if(h===0&&u===0)return;h===u||m&&h>0&&d.length===c.length&&d.length!==0&&c.length!==0&&f&&this.autoCheck&&this.showCheckBox?this.changeState(l,"check",null,!0,!0):u>0&&!m&&this.autoCheck&&this.showCheckBox?this.changeState(l,"indeterminate",null,!0,!0):u>0||s.length>0?this.changeState(l,"indeterminate",null,!0,!0):u===0&&this.changeState(l,"uncheck",null,!0,!0);var I=j(i,"."+Jt);if(!g(I)){var x=j(I,"."+Mt);this.ensureParentCheckState(x)}}},e.prototype.getSelectedChildNodeDetails=function(i){var r=this,n=typeof this.fields.child=="string"?this.fields.child:null,s=this.fields.id,a=this.fields.parentID;return this.checkedNodes.map(function(l){return new re(r.DDTTreeData).executeLocal(new Pe().where("id","equal",l,!0))[0]}).filter(function(l){if(l&&typeof l=="object"&&(a in l||n in l))if(!g(n)&&n in l&&Array.isArray(l[n])){var h=l[s];if(!g(h))return h.toString()===i}else{var u=l[a];if(!g(u))return u.toString()===i}return!1})},e.prototype.ensureChildCheckState=function(i,r,n){var s=this;if(!g(i)){var a=X("."+Jt,i),l=void 0;if(!g(a)){var h=Array.from(a.querySelectorAll("li"));l=Oe("."+ss,a),this.isFilter&&(l=Array.from(l).filter(function(m){var y=m.closest("li").getAttribute("data-uid");return y!==null&&s.checkedNodes.indexOf(y)!==-1}),h=Array.from(h).filter(function(m){var y=m.getAttribute("data-uid");return y!==null&&s.checkedNodes.indexOf(y)!==-1}),l.length===0&&(l=Oe("."+ss,a),h=Array.from(a.querySelectorAll("li"))));for(var u=i.getElementsByClassName(il)[0].classList.contains(Rn),c=i.getElementsByClassName(il)[0].classList.contains(sa),d=void 0,p=0;p<l.length;p++){var f=h[parseInt(p.toString(),10)].getAttribute("data-uid");if(!g(this.currentLoadData)&&!g(V(this.fields.isChecked,this.currentLoadData[parseInt(p.toString(),10)])))d=V(this.fields.isChecked,this.currentLoadData[parseInt(p.toString(),10)])?"check":"uncheck",this.ele!==-1&&(d=u?"check":"uncheck"),d==="uncheck"&&!Ee(this.parentNodeCheck)&&this.autoCheck&&this.parentNodeCheck.indexOf(f)!==-1&&(this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(f),1),d="indeterminate");else{var v=l[parseInt(p.toString(),10)].getElementsByClassName(il)[0].classList.contains(Rn);u||v&&!this.isLoaded||this.checkedNodes.indexOf(f)!==-1&&this.isLoaded&&(c||u)?d="check":h[parseInt(p.toString(),10)].classList.contains(EV)&&!Ee(this.parentNodeCheck)&&this.autoCheck&&(u||c)&&this.parentNodeCheck.indexOf(f)!==-1?(d="indeterminate",this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(f),1)):this.dataType===1&&!Ee(this.parentNodeCheck)&&this.autoCheck&&(u||c)&&this.parentNodeCheck.indexOf(f)!==-1?(d="indeterminate",this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(f),1)):d="uncheck"}this.changeState(l[parseInt(p.toString(),10)],d,r,!0,!0)}}this.autoCheck&&this.isLoaded&&!n&&this.updateParentCheckState()}},e.prototype.doCheckBoxAction=function(i,r){if(g(i)){var p=Oe("."+ss,this.element);if(this.loadOnDemand)for(var f=0;f<p.length;f++){var s=j(p[parseInt(f.toString(),10)],"."+Mt);this.updateFieldChecked(p[parseInt(f.toString(),10)],r),this.changeState(p[parseInt(f.toString(),10)],r?"check":"uncheck",null,null,null,r),this.updateOldCheckedData([this.getNodeData(s)])}else for(var f=0;f<p.length;f++){var s=j(p[parseInt(f.toString(),10)],"."+Mt);this.updateFieldChecked(p[parseInt(f.toString(),10)],r),this.changeState(p[parseInt(f.toString(),10)],r?"check":"uncheck"),this.updateOldCheckedData([this.getNodeData(s)])}}else{i.reverse();for(var n=i.length-1;n>=0;n--){var s=this.getElement(i[parseInt(n.toString(),10)]);if(g(s)){var a=i[n-i.length]?i[n-i.length].toString():i[parseInt(n.toString(),10)]?i[parseInt(n.toString(),10)].toString():null;if(a!==""&&r&&a)this.setValidCheckedNode(a,i),this.dynamicCheckState(a,r);else if(this.checkedNodes.indexOf(a)!==-1&&a!==""&&!r){this.checkedNodes.splice(this.checkedNodes.indexOf(a),1);var l=this.getChildNodes(this.treeData,a);if(l){for(var h=0;h<l.length;h++){var u=l[parseInt(h.toString(),10)][this.fields.id]?l[parseInt(h.toString(),10)][this.fields.id].toString():null;if(this.checkedNodes.indexOf(u)!==-1){this.checkedNodes.splice(this.checkedNodes.indexOf(u),1);var c=this.element.querySelector('[data-uid="'+u+'"]');c&&this.changeState(c,"uncheck",null)}}this.parentNodeCheck.indexOf(a)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(a),1)}a&&this.dynamicCheckState(a,r),this.updateField(this.treeData,this.fields,a,"isChecked",null)}continue}var d=X("."+Jt+" ."+ss,s);this.validateCheckNode(d,!r,s,null)}}if(i)for(var v=0;v<i.length-1;v++){var a=i[parseInt(v.toString(),10)]?i[parseInt(v.toString(),10)].toString():"";r||this.updateField(this.treeData,this.fields,a,"isChecked",null)}this.autoCheck&&this.updateParentCheckState()},e.prototype.updateFieldChecked=function(i,r){var n=j(i,"."+Mt),s=n.getAttribute("data-uid"),a=this.getNodeData(n);a.isChecked==="true"&&!r&&this.updateField(this.treeData,this.fields,s,"isChecked",null)},e.prototype.dynamicCheckState=function(i,r){if(this.dataType===1){var n=0,s=new re(this.treeData).executeLocal(new Pe().where(this.fields.id,"equal",i,!0));if(s[0]){var a=s[0][this.fields.id]?s[0][this.fields.id].toString():null,l=s[0][this.fields.parentID]?s[0][this.fields.parentID].toString():null,h=this.element.querySelector('[data-uid="'+l+'"]'),u=this.element.querySelector('[data-uid="'+a+'"]'),c=this.getChildNodes(this.treeData,l);if(c)for(var d=0;d<c.length;d++){var p=c[parseInt(d.toString(),10)][this.fields.id]?c[parseInt(d.toString(),10)][this.fields.id].toString():null;this.checkedNodes.indexOf(p)!==-1&&n++}this.checkedNodes.indexOf(i)!==-1&&h&&a===i&&this.autoCheck?this.changeState(h,"indeterminate",null):this.checkedNodes.indexOf(i)===-1&&u&&a===i&&!r?this.changeState(u,"uncheck",null):this.checkedNodes.indexOf(i)!==-1&&u&&a===i&&r?this.changeState(u,"check",null):this.checkedNodes.indexOf(i)===-1&&!u&&h&&a===i&&this.autoCheck&&n!==0?this.changeState(h,"indeterminate",null):this.checkedNodes.indexOf(i)===-1&&!u&&h&&a===i&&this.autoCheck&&n===0?this.changeState(h,"uncheck",null):!u&&!h&&a===i&&this.autoCheck&&this.updateIndeterminate(i,r)}}else if(this.dataType===2||this.fields.dataSource instanceof re&&this.isOffline)for(var a=void 0,h=void 0,f=void 0,d=0;d<this.treeData.length;d++){a=this.treeData[parseInt(d.toString(),10)][this.fields.id]?this.treeData[parseInt(d.toString(),10)][this.fields.id].toString():"",h=this.element.querySelector('[data-uid="'+a+'"]'),f=h?X("."+Rn,h):null,this.checkedNodes.indexOf(a)===-1&&h&&f&&!r&&this.changeState(h,"uncheck",null);var v=V(this.fields.child.toString(),this.treeData[parseInt(d.toString(),10)]);v&&this.updateChildIndeterminate(v,a,i,r,a)}},e.prototype.updateIndeterminate=function(i,r){var n=this.getTreeData(i),s=0,a;this.dataType===1&&(a=n[0][this.fields.parentID]?n[0][this.fields.parentID].toString():null);var l=this.getChildNodes(this.treeData,a);if(l)for(var h=0;h<l.length;h++){var u=l[parseInt(h.toString(),10)][this.fields.id]?l[parseInt(h.toString(),10)][this.fields.id].toString():null;this.checkedNodes.indexOf(u)!==-1&&s++}var c=this.element.querySelector('[data-uid="'+a+'"]');c&&r?this.changeState(c,"indeterminate",null):!r&&c&&this.parentNodeCheck.indexOf(a)===-1&&s!==0?this.changeState(c,"indeterminate",null):!r&&c&&this.parentNodeCheck.indexOf(a)===-1&&s===0?this.changeState(c,"uncheck",null):c||(!r&&this.checkedNodes.indexOf(a)===-1&&this.parentNodeCheck.indexOf(a)!==-1?this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(a),1):r&&this.checkedNodes.indexOf(a)===-1&&this.parentNodeCheck.indexOf(a)===-1?this.parentNodeCheck.push(a):!r&&this.checkedNodes.indexOf(a)!==-1&&this.parentNodeCheck.indexOf(a)===-1&&s!==0&&this.parentNodeCheck.push(a),this.updateIndeterminate(a,r),this.checkedNodes.indexOf(a)!==-1&&!r&&this.checkedNodes.splice(this.checkedNodes.indexOf(a),1))},e.prototype.updateChildIndeterminate=function(i,r,n,s,a){for(var l=0,h=0;h<i.length;h++){var u=i[parseInt(h.toString(),10)][this.fields.id]?i[parseInt(h.toString(),10)][this.fields.id].toString():"";this.checkedNodes.indexOf(u)!==-1&&l++;var c=this.element.querySelector('[data-uid="'+r+'"]'),d=c?X("."+sa,c):null,p=c?X("."+Rn,c):null,f=this.element.querySelector('[data-uid="'+u+'"]'),v=f?X("."+Rn,f):null;if(this.checkedNodes.indexOf(n)!==-1&&c&&u===n&&this.autoCheck)this.changeState(c,"indeterminate",null);else if(this.checkedNodes.indexOf(n)===-1&&c&&!f&&u===n&&!s)this.autoCheck?this.changeState(c,"uncheck",null):l!==0?this.changeState(c,"indeterminate",null):this.changeState(c,"uncheck",null);else if(this.checkedNodes.indexOf(n)===-1&&f&&u===n&&!s)this.changeState(f,"uncheck",null);else if(this.checkedNodes.indexOf(n)===-1&&d&&u===n&&this.autoCheck&&l===0&&!s)d.classList.remove(sa);else if(this.checkedNodes.indexOf(n)===-1&&!f&&p&&u===n&&l===0)this.changeState(c,"uncheck",null);else if(this.checkedNodes.indexOf(u)===-1&&f&&v&&l===0)this.changeState(f,"uncheck",null);else if(!f&&!c&&u===n||this.parentNodeCheck.indexOf(r)!==-1&&this.autoCheck){var m=this.element.querySelector('[data-uid="'+a+'"]');s&&l!==0?this.changeState(m,"indeterminate",null):s&&l===i.length&&this.checkedNodes.indexOf(r)===-1?this.checkDisabledState(r):!s&&l===0&&this.parentNodeCheck.indexOf(r)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(r)),this.parentNodeCheck.indexOf(r)===-1&&this.parentNodeCheck.push(r)}var y=V(this.fields.child.toString(),i[parseInt(h.toString(),10)]);y&&this.updateChildIndeterminate(y,u,n,s,a)}},e.prototype.changeState=function(i,r,n,s,a,l){var h=this,u,c=j(i,"."+Mt);!this.checkDisabledChildren&&c&&(c.classList.contains(Ic)||this.disableNode&&this.disableNode.indexOf(c.getAttribute("data-uid"))!==-1)||(i===c&&(i=X("."+ss,c)),s?this.nodeCheckAction(i,r,c,u,n,s,a,l):(this.checkActionNodes=[],u=this.getCheckEvent(c,r,n),this.trigger("nodeChecking",u,function(d){d.cancel||h.nodeCheckAction(i,r,c,d,n,s,a,l)})))},e.prototype.nodeCheckAction=function(i,r,n,s,a,l,h,u){var c,d=i.getElementsByClassName(il)[0];if(r==="check"&&!d.classList.contains(Rn)?(d.classList.remove(sa),d.classList.add(Rn),this.addCheck(n),c="true"):r==="uncheck"&&(d.classList.contains(Rn)||d.classList.contains(sa))?(K([d],[Rn,sa]),this.removeCheck(n),c="false"):r==="indeterminate"&&this.autoCheck&&(d.classList.remove(Rn),d.classList.add(sa),this.removeCheck(n),c="mixed"),c=r==="check"?"true":r==="uncheck"?"false":c,g(c)||n.setAttribute("aria-checked",c),h){var p=[].concat([],this.checkActionNodes);s=this.getCheckEvent(n,r,a),Ee(l)&&(s.data=p)}u!==void 0&&this.ensureStateChange(n,u),l||g(c)||(n.setAttribute("aria-checked",c),s.data[0].checked=c,this.trigger("nodeChecked",s),this.checkActionNodes=[])},e.prototype.addCheck=function(i){var r=i.getAttribute("data-uid");!g(r)&&this.checkedNodes.indexOf(r)===-1&&this.checkDisabledState(r)},e.prototype.removeCheck=function(i){var r=this.checkedNodes.indexOf(i.getAttribute("data-uid"));r>-1&&this.checkedNodes.splice(r,1)},e.prototype.getCheckEvent=function(i,r,n){this.checkActionNodes.push(this.getNodeData(i));var s=this.checkActionNodes;return{action:r,cancel:!1,isInteracted:!g(n),node:i,data:s}},e.prototype.finalize=function(){var i=X("."+Jt,this.element);g(i)||(i.setAttribute("role",WL.treeRole),this.setMultiSelect(this.allowMultiSelection),this.setNodeFocusable(),this.allowTextWrap&&this.updateWrap(),this.renderReactTemplates(),this.hasPid=this.rootData[0]?Object.prototype.hasOwnProperty.call(this.rootData[0],this.fields.parentID):!1,this.doExpandAction())},e.prototype.setTextWrap=function(){(this.allowTextWrap?Y:K)([this.element],yV),B.isIE&&(this.allowTextWrap?Y:K)([this.element],bV)},e.prototype.updateWrap=function(i){if(this.fullRowSelect)for(var r=i?Oe("."+Mt,i):this.liList,n=r.length,s=0;s<n;s++)this.calculateWrap(r[parseInt(s.toString(),10)])},e.prototype.calculateWrap=function(i){var r=X("."+tl,i);r&&r.nextElementSibling&&(r.style.height=this.allowTextWrap?r.nextElementSibling.offsetHeight+"px":"")},e.prototype.doExpandAction=function(){var i=this,r=this.expandedNodes;if(!this.loadOnDemand&&this.fields.dataSource instanceof re&&(this.isInitalExpand=this.treeData.filter(function(l){return l[i.fields.expanded]===!0}).length>0?!0:this.isInitalExpand),this.isInitalExpand&&r.length>0)if(this.setProperties({expandedNodes:[]},!0),this.fields.dataSource instanceof re)this.expandGivenNodes(r);else{for(var n=0;n<r.length;n++){var s=X('[data-uid="'+r[parseInt(n.toString(),10)]+'"]',this.element);if(g(s)){r[parseInt(n.toString(),10)]&&this.expandChildren.indexOf(r[parseInt(n.toString(),10)])===-1&&this.expandChildren.push(r[parseInt(n.toString(),10)].toString());continue}else{var a=X("."+ii,X("."+on,s));g(a)||this.expandAction(s,a,null)}}this.afterFinalized()}else this.afterFinalized()},e.prototype.expandGivenNodes=function(i){var r=this;this.expandCallback(i[this.index],function(){r.index++,r.index<i.length?r.expandGivenNodes(i):r.afterFinalized()}),this.index>0&&(this.index=0)},e.prototype.expandCallback=function(i,r){var n=X('[data-uid="'+i+'"]',this.element);if(g(n))r();else{var s=X("."+ii,X("."+on,n));g(s)||this.expandAction(n,s,null,!1,r),r()}},e.prototype.afterFinalized=function(){if(this.doSelectionAction(),this.updateCheckedProp(),this.isAnimate=!0,this.isInitalExpand=!1,(!this.isLoaded||this.isFieldChange)&&!this.isNodeDropped){var i={data:this.treeData};this.trigger("dataBound",i)}this.isLoaded=!0,this.isNodeDropped=!1},e.prototype.doSelectionAction=function(){var i=Oe("."+xc,this.element),r=this.selectedNodes;if(r.length>0){this.setProperties({selectedNodes:[]},!0);for(var n=0;n<r.length;n++){var s=X('[data-uid="'+r[parseInt(n.toString(),10)]+'"]',this.element);if(s&&!s.classList.contains("e-active")?this.selectNode(s,null,!0):this.selectedNodes.push(r[parseInt(n.toString(),10)]),!this.allowMultiSelection)break}}else this.selectGivenNodes(i);K(i,xc)},e.prototype.selectGivenNodes=function(i){for(var r=0;r<i.length&&(i[parseInt(r.toString(),10)].classList.contains("e-disable")||this.selectNode(i[parseInt(r.toString(),10)],null,!0),!!this.allowMultiSelection);r++);},e.prototype.clickHandler=function(i){var r=B.isDevice&&i.originalEvent.changedTouches&&!B.isIos?document.elementFromPoint(i.originalEvent.changedTouches[0].clientX,i.originalEvent.changedTouches[0].clientY):i.originalEvent.target;if(E.remove(this.element,"contextmenu",this.preventContextMenu),!(!r||this.dragStartAction)){var n=r.classList,s=j(r,"."+Mt);if(!s||s.classList.contains(Hp)&&!(n.contains(ii)||n.contains(or)))return;if(i.originalEvent.which!==3){var a=X("."+IV,s),l=X("."+Yr,s);if(this.removeHover(),this.setFocusElement(s),this.showCheckBox&&!s.classList.contains("e-disable")){var h=j(r,"."+ss);if(!g(h)){var u=X("."+il,h);this.validateCheckNode(h,u.classList.contains(Rn),s,i.originalEvent),this.triggerClickEvent(i.originalEvent,s);return}}n.contains(ii)?this.expandAction(s,r,i):n.contains(or)?this.collapseNode(s,r,i):a&&l?l.classList.contains(VL)&&l.classList.contains(ii)?this.expandAction(s,l,i):l.classList.contains(VL)&&l.classList.contains(or)?this.collapseNode(s,l,i):!n.contains(Jt)&&!n.contains(Mt)&&this.toggleSelect(s,i.originalEvent,!1):!n.contains(Jt)&&!n.contains(Mt)&&this.toggleSelect(s,i.originalEvent,!1)}i.originalEvent.which===3&&(this.isRightClick=!0),this.triggerClickEvent(i.originalEvent,s)}},e.prototype.nodeCheckedEvent=function(i,r,n){var s=this.getCheckEvent(i,r?"uncheck":"check",n);s.data=s.data.splice(0,s.data.length-1),this.trigger("nodeChecked",s)},e.prototype.updateOldCheckedData=function(i){var r=this,n=new re(i),s=n.executeLocal(new Pe().where("isChecked","equal","true",!0)),a=n.executeLocal(new Pe().where("isChecked","equal","false",!0));if(a.length>0){var l=this.OldCheckedData.findIndex(function(u){return u.id===a[0].id});if(l!==-1){this.OldCheckedData.splice(l,1);var h=this.OldCheckedData.filter(function(u){return u.parentID===a[0].id});h.length>0&&h.forEach(function(u){var c=r.OldCheckedData.findIndex(function(d){return d.id===u.id});c!==-1&&r.OldCheckedData.splice(c,1)});return}}if(s.length>0){var l=this.OldCheckedData.findIndex(function(c){return c.id===s[0].id});if(l===-1){this.OldCheckedData.push(s[0]);return}}},e.prototype.triggerClickEvent=function(i,r){var n={event:i,node:r};this.trigger("nodeClicked",n)},e.prototype.expandNode=function(i,r,n){var s=this;if(this.renderReactTemplates(),r.classList.contains(_v)&&this.hideSpinner(r),this.initialRender||r.classList.add("interaction"),n!==!0||n===!0&&i.classList.contains("e-expanded")){if(this.preventExpand!==!0){K([r],ii),Y([r],or);var a=0,l=0,h=X("."+Jt,i),u=i;if(this.isAnimate&&!this.isRefreshed){this.setHeight(u,h);var c=X("."+Mt+"."+Cs,i);this.aniObj.animate(h,{name:this.animation.expand.effect,duration:this.animation.expand.duration===0&&Ut==="Enable"?400:this.animation.expand.duration,timingFunction:this.animation.expand.easing,begin:function(){u.style.overflow="hidden",!g(c)&&c instanceof HTMLElement&&c.classList.add(Yv),a=u.offsetHeight,l=X("."+on,i).offsetHeight},progress:function(p){p.element.style.display="block",s.animateHeight(p,a,l)},end:function(p){p.element.style.display="block",!g(c)&&c instanceof HTMLElement&&c.classList.remove(Yv),s.expandedNode(u,h,r)}})}else this.expandedNode(u,h,r)}}else{var d=X("."+Jt,i);d.style.display="none",this.fields.dataSource instanceof re&&(this.preventExpand=!1)}this.initialRender&&r.classList.add("interaction")},e.prototype.expandedNode=function(i,r,n){r.style.display="block",i.style.display="block",i.style.overflow="",i.style.height="",K([n],el),this.addExpand(i),this.allowTextWrap&&this.isLoaded&&this.isFirstRender&&(this.updateWrap(i),this.isFirstRender=!1),this.isLoaded&&this.expandArgs&&!this.isRefreshed&&(this.expandArgs=this.getExpandEvent(i,null),this.expandArgs.isInteracted=this.isInteracted,this.trigger("nodeExpanded",this.expandArgs)),this.isHiddenItem&&this.collapseAll([this.getNodeData(i).id])},e.prototype.addExpand=function(i){i.setAttribute("aria-expanded","true"),K([i],HL);var r=i.getAttribute("data-uid");!g(r)&&this.expandedNodes.indexOf(r)===-1&&this.expandedNodes.push(r)},e.prototype.collapseNode=function(i,r,n){var s=this;if(!r.classList.contains(el)){Y([r],el);var a;this.isLoaded?(a=this.getExpandEvent(i,n),this.isInteracted=a.isInteracted,this.trigger("nodeCollapsing",a,function(l){l.cancel?K([r],el):s.nodeCollapseAction(i,r,l)})):this.nodeCollapseAction(i,r,a)}},e.prototype.nodeCollapseAction=function(i,r,n){var s=this;K([r],or),Y([r],ii);var a=0,l=0,h=X("."+Jt,i),u=i,c=X("."+Mt+"."+Cs,i);this.isAnimate?this.aniObj.animate(h,{name:this.animation.collapse.effect,duration:this.animation.collapse.duration===0&&Ut==="Enable"?400:this.animation.collapse.duration,timingFunction:this.animation.collapse.easing,begin:function(){u.style.overflow="hidden",!g(c)&&c instanceof HTMLElement&&c.classList.add(Yv),a=X("."+on,i).offsetHeight,l=u.offsetHeight},progress:function(d){s.animateHeight(d,a,l)},end:function(d){d.element.style.display="none",!g(c)&&c instanceof HTMLElement&&c.classList.remove(Yv),s.collapsedNode(u,h,r,n)}}):this.collapsedNode(u,h,r,n)},e.prototype.collapsedNode=function(i,r,n,s){r.style.display="none",i.style.overflow="",i.style.height="",K([n],el),this.removeExpand(i),this.isLoaded&&(s=this.getExpandEvent(i,null),s.isInteracted=this.isInteracted,this.trigger("nodeCollapsed",s))},e.prototype.removeExpand=function(i,r){r?i.removeAttribute("aria-expanded"):this.disableExpandAttr(i);var n=this.expandedNodes.indexOf(i.getAttribute("data-uid"));n>-1&&this.expandedNodes.splice(n,1)},e.prototype.disableExpandAttr=function(i){i.setAttribute("aria-expanded","false"),Y([i],HL)},e.prototype.setHeight=function(i,r){r.style.display="block",r.style.visibility="hidden",i.style.height=i.offsetHeight+"px",r.style.display="none",r.style.visibility=""},e.prototype.animateHeight=function(i,r,n){if(!g(i.element.parentElement)){var s=(i.duration-i.timeStamp)/i.duration,a=(n-r)*s+r;i.element.parentElement.style.height=a+"px"}},e.prototype.renderChildNodes=function(i,r,n,s,a){var l=this,h=X("div."+Yr,i);if(!g(h)){this.showSpinner(h);var u;if(this.fields.dataSource instanceof re){var c=this.parents(i,"."+Jt).length,d=this.getChildFields(this.fields,c,1);if(g(d)||g(d.dataSource)){ee(h),this.removeExpand(i,!0);return}this.treeList.push("false"),this.fields.dataSource instanceof re&&this.isOffline?(this.treeList.pop(),u=this.getChildNodes(this.treeData,i.getAttribute("data-uid")),this.loadChild(u,d,h,i,r,n,s)):d.dataSource.executeQuery(this.getQuery(d,i.getAttribute("data-uid"))).then(function(p){l.treeList.pop(),u=p.result,l.dataType===1&&(l.dataType=2),l.loadChild(u,d,h,i,r,n,s)}).catch(function(p){l.trigger("actionFailure",{error:p})})}else if(u=this.getChildNodes(this.treeData,i.getAttribute("data-uid"),!1,parseFloat(i.getAttribute("aria-level"))+1),this.currentLoadData=this.getSortedData(u),g(u)||u.length===0){ee(h),h.classList.contains(_v)&&this.hideSpinner(h),this.removeExpand(i,!0);return}else this.listBaseOption.ariaAttributes.level=parseFloat(i.getAttribute("aria-level"))+1,i.appendChild(At.createList(this.createElement,this.currentLoadData,this.listBaseOption)),this.expandNode(i,h,s),this.setSelectionForChildNodes(u),this.ensureCheckNode(i,a),this.finalizeNode(i,a,r),this.disableTreeNodes(u),this.renderSubChild(i,r,s,a)}},e.prototype.loadChild=function(i,r,n,s,a,l,h){if(this.currentLoadData=i,g(i)||i.length===0)ee(n),this.removeExpand(s,!0);else{if(this.updateListProp(r),this.fields.dataSource instanceof re&&!this.isOffline){var u=s.getAttribute("data-uid"),c=this.getNodeObject(u);Ge("child",i,c)}this.listBaseOption.ariaAttributes.level=parseFloat(s.getAttribute("aria-level"))+1,s.appendChild(At.createList(this.createElement,i,this.listBaseOption)),this.expandNode(s,n,h),this.setSelectionForChildNodes(i),this.ensureCheckNode(s),this.finalizeNode(s),this.disableTreeNodes(i),this.renderSubChild(s,a,h)}l&&l(),a&&this.expandedNodes.push(s.getAttribute("data-uid")),this.treeList.length===0&&!this.isLoaded&&this.finalize()},e.prototype.disableTreeNodes=function(i){if(!(g(this.disableNode)||this.disableNode.length===0))for(var r=0;r<i.length;){var n=i[parseInt(r.toString(),10)][this.fields.id]?i[parseInt(r.toString(),10)][this.fields.id].toString():null;this.disableNode!==void 0&&this.disableNode.indexOf(n)!==-1&&this.doDisableAction([n]),r++}},e.prototype.setSelectionForChildNodes=function(i){if(!(g(this.selectedNodes)||this.selectedNodes.length===0)){var r;for(r=0;r<i.length;r++){var n=i[parseInt(r.toString(),10)][this.fields.id]?i[parseInt(r.toString(),10)][this.fields.id].toString():null;this.selectedNodes!==void 0&&this.selectedNodes.indexOf(n)!==-1&&this.doSelectionAction()}}},e.prototype.ensureCheckNode=function(i,r){this.showCheckBox&&(this.ele=this.checkedElement?this.checkedElement.indexOf(i.getAttribute("data-uid")):null,this.autoCheck&&(this.ensureChildCheckState(i,null,r),(!r||X("."+Rn,this.element)||X("."+sa,this.element))&&this.ensureParentCheckState(i))),this.currentLoadData=null},e.prototype.getFields=function(i,r,n){return r===n?i:this.getFields(this.getChildMapper(i),r,n+1)},e.prototype.getChildFields=function(i,r,n){return r===n?this.getChildMapper(i):this.getChildFields(this.getChildMapper(i),r,n+1)},e.prototype.getChildMapper=function(i){return typeof i.child=="string"||g(i.child)?i:i.child},e.prototype.getChildNodes=function(i,r,n,s){var a=this;n===void 0&&(n=!1);var l;if(g(i))return l;if(this.dataType===1)return this.getChildGroup(this.groupedData,r,n);if(typeof this.fields.child=="string")return this.findChildNodes(i,this.fields.id,r)||this.findNestedChildNodes(i,r,s)||[];if(this.isChildObject()){for(var h=g(s)?this.fields.child:this.fields,u=1;u<s&&!g(h.child);){h=h.child;u++}this.updateListProp(h);var c=i.findIndex(function(m){return V(a.fields.id,m)&&V(a.fields.id,m).toString()===r});if(c!==-1)return V("child",i[parseInt(c.toString(),10)]);if(c===-1)for(var d=0,p=i.length;d<p;d++){var f=V("child",i[parseInt(d.toString(),10)]),v=g(f)?-1:f.findIndex(function(m){return V(a.fields.child.id,m)&&V(a.fields.child.id,m).toString()===r});if(v!==-1)return V("child",f[parseInt(v.toString(),10)]);if(!g(f)&&(l=this.getChildNodes(f,r,!1,s),l!==void 0))break}}return l},e.prototype.findChildNodes=function(i,r,n){var s=i.findIndex(function(a){var l=V(r,a);return l&&l.toString()===n});return s!==-1?V(this.fields.child,i[s]):null},e.prototype.findNestedChildNodes=function(i,r,n){for(var s=0,a=i;s<a.length;s++){var l=a[s],h=V(this.fields.child,l);if(!g(h)){var u=this.findChildNodes(h,this.fields.id,r);if(u)return u;var c=this.getChildNodes(h,r,!1,n);if(c&&c.length>0)return c}}},e.prototype.getChildGroup=function(i,r,n){var s;if(g(i))return s;for(var a=0,l=i.length;a<l;a++)if(!g(i[parseInt(a.toString(),10)][0])&&!g(V(this.fields.parentID,i[parseInt(a.toString(),10)][0]))){if(V(this.fields.parentID,i[parseInt(a.toString(),10)][0]).toString()===r)return i[parseInt(a.toString(),10)]}else return n?i[parseInt(a.toString(),10)]:[];return s},e.prototype.renderSubChild=function(i,r,n,s){if(r)for(var a=Oe("."+ii,i),l=0,h=a.length;l<h;l++){var u=a[parseInt(l.toString(),10)];if(i.querySelector(".e-icons")!==a[parseInt(l.toString(),10)]){var c=j(u,"."+Mt);this.expandArgs=this.getExpandEvent(c,null),n!==!0&&this.trigger("nodeExpanding",this.expandArgs),this.renderChildNodes(c,r,null,n,s)}}},e.prototype.toggleSelect=function(i,r,n){i.classList.contains("e-disable")||(this.allowMultiSelection&&(r&&r.ctrlKey||n)&&this.isActive(i)?this.unselectNode(i,r):this.selectNode(i,r,n))},e.prototype.isActive=function(i){return!!i.classList.contains(Cs)},e.prototype.selectNode=function(i,r,n){var s=this;if(g(i)||!this.allowMultiSelection&&this.isActive(i)&&!g(r)){this.setFocusElement(i);return}var a;this.isLoaded?(a=this.getSelectEvent(i,"select",r),this.trigger("nodeSelecting",a,function(l){!l.cancel&&!l.node.classList.contains(Hp)&&s.nodeSelectAction(i,r,l,n)})):this.nodeSelectAction(i,r,a,n)},e.prototype.nodeSelectAction=function(i,r,n,s){if((!this.allowMultiSelection||!s&&(!r||r&&!(r.ctrlKey||r.metaKey)))&&this.removeSelectAll(),this.allowMultiSelection&&r&&r.shiftKey){this.startNode||(this.startNode=i);var a=this.liList.indexOf(this.startNode),l=this.liList.indexOf(i);if(a>l){var h=a;a=l,l=h}for(var u=a;u<=l;u++){var c=this.liList[parseInt(u.toString(),10)];gr(c)&&!c.classList.contains("e-disable")&&this.addSelect(c)}}else this.startNode=i,this.addSelect(i);this.isLoaded&&(n.nodeData=this.getNodeData(i),this.trigger("nodeSelected",n),this.isRightClick=!1),this.isRightClick=!1},e.prototype.unselectNode=function(i,r){var n=this,s;this.isLoaded?(s=this.getSelectEvent(i,"un-select",r),this.trigger("nodeSelecting",s,function(a){a.cancel||n.nodeUnselectAction(i,a)})):this.nodeUnselectAction(i,s)},e.prototype.nodeUnselectAction=function(i,r){this.removeSelect(i),this.setFocusElement(i),this.isLoaded&&(r.nodeData=this.getNodeData(i),this.trigger("nodeSelected",r))},e.prototype.setFocusElement=function(i){if(!g(i)){var r=this.getFocusedNode();r&&(K([r],Rh),r.setAttribute("tabindex","-1")),Y([i],Rh),i.setAttribute("tabindex","0"),E.add(i,"blur",this.focusOut,this),this.updateIdAttr(r,i)}},e.prototype.addSelect=function(i){i.setAttribute("aria-selected","true"),Y([i],Cs);var r=i.getAttribute("data-uid");!g(r)&&this.selectedNodes.indexOf(r)===-1&&this.selectedNodes.push(r)},e.prototype.removeSelect=function(i){this.allowMultiSelection?i.setAttribute("aria-selected","false"):i.removeAttribute("aria-selected"),K([i],Cs);var r=this.selectedNodes.indexOf(i.getAttribute("data-uid"));r>-1&&this.selectedNodes.splice(r,1)},e.prototype.removeSelectAll=function(){for(var i=this.element.querySelectorAll("."+Cs),r=0,n=i;r<n.length;r++){var s=n[r];this.allowMultiSelection?s.setAttribute("aria-selected","false"):s.removeAttribute("aria-selected")}K(i,Cs),this.setProperties({selectedNodes:[]},!0)},e.prototype.getSelectEvent=function(i,r,n){var s=this.getNodeData(i);return{action:r,cancel:!1,isInteracted:!g(n),node:i,nodeData:s}},e.prototype.setExpandOnType=function(){this.expandOnType=this.expandOn==="Auto"?B.isDevice?"Click":"DblClick":this.expandOn},e.prototype.expandHandler=function(i){var r=B.isDevice&&i.originalEvent.changedTouches&&!B.isIos?document.elementFromPoint(i.originalEvent.changedTouches[0].clientX,i.originalEvent.changedTouches[0].clientY):i.originalEvent.target;!r||r.classList.contains(Uv)||r.classList.contains(na)||r.classList.contains(Jt)||r.classList.contains(Mt)||r.classList.contains(Yr)||this.showCheckBox&&j(r,"."+ss)||this.expandCollapseAction(j(r,"."+Mt),i)},e.prototype.expandCollapseAction=function(i,r){var n=X("div."+Yr,i);if(!(!n||n.classList.contains(el))){var s=n.classList;s.contains(ii)?this.expandAction(i,n,r):s.contains(or)&&this.collapseNode(i,n,r)}},e.prototype.expandAction=function(i,r,n,s,a,l){var h=this;r.classList.contains(el)||(Y([r],el),this.isLoaded&&!this.isRefreshed?(this.expandArgs=this.getExpandEvent(i,n),this.isInteracted=this.expandArgs.isInteracted,this.trigger("nodeExpanding",this.expandArgs,function(u){u.cancel?K([r],el):h.nodeExpandAction(i,r,s,a,l)})):this.nodeExpandAction(i,r,s,a,l))},e.prototype.nodeExpandAction=function(i,r,n,s,a){var l=X("."+Jt,i);if(l&&l.nodeName==="UL")this.expandNode(i,r);else{this.isFirstRender=!0,this.renderChildNodes(i,n,s,null,a);for(var h=Oe("."+Mt,i),u=0;u<h.length;u++){var c=this.getId(h[parseInt(u.toString(),10)]);if(this.expandChildren.indexOf(c)!==-1&&this.expandChildren!==void 0){var d=X("."+ii,X("."+on,h[parseInt(u.toString(),10)]));g(d)||this.expandAction(h[parseInt(u.toString(),10)],d,null),this.expandChildren.splice(this.expandChildren.indexOf(c),1)}}}},e.prototype.keyActionHandler=function(i){var r=this,n=i.target,s=this.getFocusedNode();if(n&&n.classList.contains(Uv)){var a=n;i.action==="enter"?a.blur():i.action==="escape"&&(a.value=this.oldText,a.blur());return}i.preventDefault();var l={cancel:!1,event:i,node:s};this.trigger("keyPress",l,function(h){if(!h.cancel)switch(i.action){case"space":r.showCheckBox?r.checkNode(i):r.toggleSelect(s,i);break;case"moveRight":r.openNode(!r.enableRtl,i);break;case"moveLeft":r.openNode(!!r.enableRtl,i);break;case"shiftDown":r.shiftKeySelect(!0,i);break;case"moveDown":case"ctrlDown":case"csDown":r.navigateNode(!0);break;case"shiftUp":r.shiftKeySelect(!1,i);break;case"moveUp":case"ctrlUp":case"csUp":r.navigateNode(!1);break;case"home":case"shiftHome":case"ctrlHome":case"csHome":r.navigateRootNode(!0);break;case"end":case"shiftEnd":case"ctrlEnd":case"csEnd":r.navigateRootNode(!1);break;case"enter":case"ctrlEnter":case"shiftEnter":case"csEnter":case"shiftSpace":case"ctrlSpace":r.toggleSelect(s,i);break;case"f2":r.allowEditing&&!s.classList.contains("e-disable")&&r.createTextbox(s);break;case"ctrlA":if(r.allowMultiSelection){var u=Oe("."+Mt+":not(."+Cs+")",r.element);r.selectGivenNodes(u)}break}})},e.prototype.navigateToFocus=function(i){var r=this.getFocusedNode().querySelector("."+on),n=r.getBoundingClientRect(),s=this.getScrollParent(this.element);if(!g(s)){var a=s.getBoundingClientRect();n.bottom>a.bottom?s.scrollTop+=n.bottom-a.bottom:n.top<a.top&&(s.scrollTop-=a.top-n.top)}var l=this.isVisibleInViewport(r);l||r.scrollIntoView(i)},e.prototype.isVisibleInViewport=function(i){var r=i.getBoundingClientRect();return r.top>=0&&r.left>=0&&r.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&r.right<=(window.innerWidth||document.documentElement.clientWidth)},e.prototype.getScrollParent=function(i){return g(i)?null:i.scrollHeight>i.clientHeight?i:this.getScrollParent(i.parentElement)},e.prototype.shiftKeySelect=function(i,r){if(this.allowMultiSelection){var n=this.getFocusedNode(),s=i?this.getNextNode(n):this.getPrevNode(n);this.removeHover(),this.setFocusElement(s),this.toggleSelect(s,r,!1),this.navigateToFocus(!i)}else this.navigateNode(i)},e.prototype.checkNode=function(i){var r=this.getFocusedNode(),n=X("."+ss,r),s=X(" ."+il,n).classList.contains(Rn);r.classList.contains("e-disable")||r.getElementsByClassName("e-checkbox-disabled").length===0&&this.validateCheckNode(n,s,r,i)},e.prototype.validateCheckNode=function(i,r,n,s){var a=this,l=j(i,"."+Mt);this.checkActionNodes=[];var h=r?"false":"true";g(h)||l.setAttribute("aria-checked",h);var u=this.getCheckEvent(l,r?"uncheck":"check",s);this.trigger("nodeChecking",u,function(c){c.cancel||a.nodeCheckingAction(i,r,n,c,s)})},e.prototype.nodeCheckingAction=function(i,r,n,s,a){if(this.checkedElement.indexOf(n.getAttribute("data-uid"))===-1&&(this.checkedElement.push(n.getAttribute("data-uid")),this.autoCheck)){var l=this.getChildNodes(this.treeData,n.getAttribute("data-uid"));l!==null?this.allCheckNode(l,this.checkedElement,null,null,!1):l=null}if(this.changeState(i,r?"uncheck":"check",a,!0),this.autoCheck){this.ensureChildCheckState(n),this.updateOldCheckedData([this.getNodeData(n)]),this.ensureParentCheckState(j(j(n,"."+Jt),"."+Mt));var h=void 0;s.action==="check"?h=!0:s.action==="uncheck"&&(h=!1),this.ensureStateChange(n,h)}this.nodeCheckedEvent(i,r,a)},e.prototype.ensureStateChange=function(i,r){var n=this,s=X("."+Jt,i),a=i.getAttribute("data-uid"),l=this.fields;if(this.dataType===1&&this.autoCheck){var h=new re(this.treeData).executeLocal(new Pe().where(l.parentID,"equal",a,!0)),u=h.filter(function(w){return n.checkedNodes.indexOf(w[l.id].toString())!==-1},this);this.checkedNodes.indexOf(a)!==-1&&u.length!==h.length&&this.isFilter&&u.length>0&&(h=u);for(var c=0;c<h.length;c++){var d=h[parseInt(c.toString(),10)][this.fields.id]?h[parseInt(c.toString(),10)][this.fields.id].toString():null,p=h[parseInt(c.toString(),10)][this.fields.isChecked]?h[parseInt(c.toString(),10)][this.fields.isChecked].toString():null;if(this.checkedNodes.indexOf(a)!==-1&&this.checkedNodes.indexOf(d)===-1){this.checkDisabledState(d,h[c]);var f=this.getChildNodes(this.treeData,d);this.getChildItems(f,r),this.parentNodeCheck.indexOf(d)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(d),1)}else if(this.checkedNodes.indexOf(a)===-1&&s===null&&this.checkedNodes.indexOf(d)!==-1){if(this.checkedNodes.splice(this.checkedNodes.indexOf(d),1),p==="true"&&this.updateField(this.treeData,this.fields,d,"isChecked",null),this.checkedNodes.indexOf(a)===-1&&s===null||this.parentNodeCheck.indexOf(d)!==-1){var v=this.getChildNodes(this.treeData,d);this.getChildItems(v,r),this.parentNodeCheck.indexOf(d)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(d),1)}}else{var f=this.getChildNodes(this.treeData,d);this.getChildItems(f,r)}}}else if(this.dataType===1&&!this.autoCheck)if(r)for(var c=0;c<this.treeData.length;c++){var S=this.treeData[parseInt(c.toString(),10)][this.fields.id]?this.treeData[parseInt(c.toString(),10)][this.fields.id].toString():null;this.checkedNodes.indexOf(S)===-1&&this.checkDisabledState(S,this.treeData[c])}else{for(var m=new re(this.treeData).executeLocal(new Pe().where(l.isChecked,"equal",!0,!1)),c=0;c<m.length;c++){var y=m[parseInt(c.toString(),10)][this.fields.id]?m[parseInt(c.toString(),10)][this.fields.id].toString():null;this.checkedNodes.indexOf(y)!==-1&&this.checkedNodes.splice(this.checkedNodes.indexOf(y),1),this.updateField(this.treeData,this.fields,y,"isChecked",null)}this.checkedNodes=[]}else{var f=this.getChildNodes(this.treeData,a);if(f){var b=f.filter(function(I){var x=String(I[Object.keys(I)[0]]);return n.checkedNodes.indexOf(x)!==-1});b.length>0&&f.length&&this.isFilter&&(f=b),this.childStateChange(f,a,s,r)}}},e.prototype.checkDisabledState=function(i,r){var n=this.checkDisabledChildren;if(!n){var s=!0;if(this.loadOnDemand&&this.fields.htmlAttributes&&(r=g(r)?r:this.getNodeObject(i),!g(r))){var a=r[this.fields.htmlAttributes];a&&!g(a.class)&&a.class.indexOf(Ic)!==-1&&(s=!1)}var l=X('[data-uid="'+i+'"]',this.element);n=l?!l.classList.contains(Ic):this.disableNode.indexOf(i)===-1&&s}n&&this.checkedNodes.push(i)},e.prototype.getChildItems=function(i,r){for(var n=0;n<i.length;n++){var s=i[parseInt(n.toString(),10)][this.fields.id]?i[parseInt(n.toString(),10)][this.fields.id].toString():null,a=i[parseInt(n.toString(),10)][this.fields.isChecked]?i[parseInt(n.toString(),10)][this.fields.isChecked].toString():null;this.checkedNodes.indexOf(s)!==-1&&!r&&this.checkedNodes.splice(this.checkedNodes.indexOf(s),1),this.checkedNodes.indexOf(s)===-1&&r&&this.checkDisabledState(s,i[n]),a==="true"&&!r&&this.updateField(this.treeData,this.fields,s,"isChecked",null);var l=this.getChildNodes(this.treeData,s);l.length>0&&this.getChildItems(l,r)}},e.prototype.childStateChange=function(i,r,n,s){for(var a=0;a<i.length;a++){var l=i[parseInt(a.toString(),10)][this.fields.id]?i[parseInt(a.toString(),10)][this.fields.id].toString():"",h=i[parseInt(a.toString(),10)][this.fields.isChecked]?i[parseInt(a.toString(),10)][this.fields.isChecked].toString():null;this.autoCheck?this.checkedNodes.indexOf(r)!==-1&&this.checkedNodes.indexOf(l)===-1?(this.checkDisabledState(l,i[a]),this.parentNodeCheck.indexOf(l)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(l),1)):this.checkedNodes.indexOf(r)===-1&&this.checkedNodes.indexOf(l)!==-1&&!s&&(this.checkedNodes.splice(this.checkedNodes.indexOf(l),1),h==="true"&&this.updateField(this.treeData,this.fields,l,"isChecked",null)):this.autoCheck||(s?this.checkedNodes.indexOf(l)===-1&&this.checkDisabledState(l,i[a]):(this.checkedNodes.indexOf(l)!==-1&&this.checkedNodes.splice(this.checkedNodes.indexOf(l),1),this.updateField(this.treeData,this.fields,l,"isChecked",null),this.checkedNodes=[]));var u=this.getChildNodes([i[parseInt(a.toString(),10)]],l);u&&this.childStateChange(u,r,n,s)}},e.prototype.allCheckNode=function(i,r,n,s,a){if(i)for(var l=0;l<i.length;l++){var h=V(this.fields.id,i[parseInt(l.toString(),10)]),u=this.element.querySelector('[data-uid="'+h+'"]');a!==!1&&this.checkedElement.indexOf(h.toString())===-1&&(u===null&&!g(i[parseInt(l.toString(),10)][this.fields.isChecked])&&r.indexOf(h.toString())===-1||s===0||n===2)&&(i[parseInt(l.toString(),10)][this.fields.isChecked]!==!1||n===2?r.push(h.toString()):s=null,s=i[parseInt(l.toString(),10)][this.fields.isChecked]!==!1||n===2?0:null),r.indexOf(h.toString())===-1&&g(n)&&r.push(h.toString());var c=V(this.fields.child.toString(),i[parseInt(l.toString(),10)]);if(V(this.fields.hasChildren,i[parseInt(l.toString(),10)])===!0||c){var d=V(this.fields.id,i[parseInt(l.toString(),10)]),p=void 0;this.dataType===1?p=this.getChildNodes(this.treeData,d.toString()):p=c,p&&(g(a)?this.allCheckNode(p,r,n,s):this.allCheckNode(p,r,n,s,a),s=null)}s=null}},e.prototype.openNode=function(i,r){var n=this.getFocusedNode(),s=X("div."+Yr,n);if(i)if(s)s.classList.contains(ii)?this.expandAction(n,s,r):this.focusNextNode(n,!0);else return;else if(s&&s.classList.contains(or))this.collapseNode(n,s,r);else{var a=j(j(n,"."+Jt),"."+Mt);if(a)a.classList.contains("e-disable")||(this.setFocus(n,a),this.navigateToFocus(!0));else return}},e.prototype.navigateNode=function(i){var r=this.getFocusedNode();this.focusNextNode(r,i)},e.prototype.navigateRootNode=function(i){var r=this.getFocusedNode(),n=i?this.getRootNode():this.getEndNode();n.classList.contains("e-disable")||(this.setFocus(r,n),this.navigateToFocus(i))},e.prototype.getFocusedNode=function(){var i,r=X("."+Mt+'[tabindex="0"]',this.element);if(!g(r)){var n=r.getAttribute("aria-checked");(n==="mixed"||n==="false")&&(this.isFilter=!1)}return g(r)&&(i=X("."+Mt,this.element)),g(r)?g(i)?this.element.firstElementChild:i:r},e.prototype.focusNextNode=function(i,r){var n=r?this.getNextNode(i):this.getPrevNode(i);if(this.setFocus(i,n),this.navigateToFocus(!r),n.classList.contains("e-disable")){var s=n.lastChild;n.previousSibling==null&&n.classList.contains("e-level-1")?this.focusNextNode(n,!0):n.nextSibling==null&&n.classList.contains("e-node-collapsed")?this.focusNextNode(n,!1):n.nextSibling==null&&s.classList.contains(on)?this.focusNextNode(n,!1):this.focusNextNode(n,r)}},e.prototype.getNextNode=function(i){var r=this.liList.indexOf(i),n;do if(r++,n=this.liList[parseInt(r.toString(),10)],g(n))return i;while(!gr(n));return n},e.prototype.getPrevNode=function(i){var r=this.liList.indexOf(i),n;do if(r--,n=this.liList[parseInt(r.toString(),10)],g(n))return i;while(!gr(n));return n},e.prototype.getRootNode=function(){var i=0,r;do r=this.liList[parseInt(i.toString(),10)],i++;while(!gr(r));return r},e.prototype.getEndNode=function(){var i=this.liList.length-1,r;do r=this.liList[parseInt(i.toString(),10)],i--;while(!gr(r));return r},e.prototype.setFocus=function(i,r){K([i],Rh),i.setAttribute("tabindex","-1"),r.classList.contains("e-disable")||(Y([r],Rh),r.setAttribute("tabindex","0"),r.focus(),E.add(r,"blur",this.focusOut,this),this.updateIdAttr(i,r))},e.prototype.updateIdAttr=function(i,r){this.element.removeAttribute("aria-activedescendant"),i&&i.removeAttribute("id"),r.setAttribute("id",this.element.id+"_active"),this.element.setAttribute("aria-activedescendant",this.element.id+"_active")},e.prototype.focusIn=function(){if(!this.mouseDownStatus){var i=this.getFocusedNode();i.classList.contains("e-disable")?(i.setAttribute("tabindex","-1"),this.navigateNode(!0)):(i.setAttribute("tabindex","0"),Y([i],Rh),E.add(i,"blur",this.focusOut,this)),this.mouseDownStatus=!1}},e.prototype.focusOut=function(i){var r=this.getFocusedNode();i.target===r&&(K([r],Rh),E.remove(r,"blur",this.focusOut))},e.prototype.onMouseOver=function(i){if(!B.isDevice){var r=i.target,n=r.classList,s=j(r,"."+Mt);if(!s||n.contains(Jt)||n.contains(Mt)){this.removeHover();return}else s&&!s.classList.contains("e-disable")&&this.setHover(s)}},e.prototype.setHover=function(i){!i.classList.contains(Vv)&&!i.classList.contains(Hp)&&(this.removeHover(),Y([i],Vv))},e.prototype.onMouseLeave=function(){this.removeHover()},e.prototype.removeHover=function(){var i=Oe("."+Vv,this.element);i&&i.length&&K(i,Vv)},e.prototype.getNodeData=function(i,r){if(!g(i)&&i.classList.contains(Mt)&&!g(j(i,"."+RL))&&j(i,"."+RL).classList.contains(na)){var n=i.getAttribute("data-uid"),s=this.getText(i,r),a=j(i.parentNode,"."+Mt),l=a?a.getAttribute("data-uid"):null,h=i.classList.contains(Cs),u=!i.classList.contains(Hp),c=i.getAttribute("aria-expanded")==="true",d=i.getAttribute("aria-expanded")!==null?!0:(X("."+ii,i)||X("."+or,i))!=null,p=null,f=X("."+ss,i);return this.showCheckBox&&f&&(p=i.getAttribute("aria-checked")),{id:n,text:s,parentID:l,selected:h,selectable:u,expanded:c,isChecked:p,hasChildren:d}}return{id:"",text:"",parentID:"",selected:!1,expanded:!1,isChecked:"",hasChildren:!1}},e.prototype.getText=function(i,r){if(r){var n=this.getNodeObject(i.getAttribute("data-uid")),s=parseFloat(i.getAttribute("aria-level")),a=this.getFields(this.fields,s,1);return V(a.text,n)}return X("."+Oh,i).textContent},e.prototype.getExpandEvent=function(i,r){var n=this.getNodeData(i);return{cancel:!1,isInteracted:!g(r),node:i,nodeData:n,event:r}},e.prototype.renderNodeTemplate=function(i,r,n){var s=this.nodeTemplateFn(i,this,"nodeTemplate"+n,this.element.id+"nodeTemplate",this.isStringTemplate,void 0,r,this.root);s&&(s=Array.prototype.slice.call(s),dt(s,r))},e.prototype.destroyTemplate=function(i){this.clearTemplate(["nodeTemplate"+i.getAttribute("data-uid")])},e.prototype.reRenderNodes=function(){this.updateListProp(this.fields),B.isIE?(this.ulElement=this.element.querySelector(".e-list-parent.e-ul"),this.ulElement.parentElement.removeChild(this.ulElement)):this.element.innerHTML="",g(this.nodeTemplateFn)||this.clearTemplate(),this.setTouchClass(),this.setProperties({selectedNodes:[],checkedNodes:[],expandedNodes:[]},!0),this.checkedElement=[],this.isLoaded=!1,this.setDataBinding(!0)},e.prototype.setCssClass=function(i,r){!g(i)&&i!==""&&K([this.element],i.split(" ")),!g(r)&&r!==""&&Y([this.element],r.split(" "))},e.prototype.editingHandler=function(i){var r=i.target;if(!(!r||r.classList.contains(na)||r.classList.contains(Jt)||r.classList.contains(Mt)||r.classList.contains(Yr)||r.classList.contains(Uv)||r.classList.contains(PL))){var n=j(r,"."+Mt);this.createTextbox(n)}},e.prototype.createTextbox=function(i){var r=this,n=X("."+Wv,this.element);n&&n.blur();var s=X("."+Oh,i);this.updateOldText(i);var a=this.createElement("input",{className:Wv,attrs:{value:this.oldText}}),l=this.getEditEvent(i,null,a.outerHTML);this.trigger("nodeEditing",l,function(h){if(!h.cancel){var u=s.offsetWidth+5,c=u+"px";Y([i],vw),g(r.nodeTemplateFn)||r.destroyTemplate(i),r.isReact?setTimeout(function(){r.renderTextBox(l,s,c)},5):r.renderTextBox(l,s,c)}})},e.prototype.renderTextBox=function(i,r,n){r.innerHTML=i.innerHtml;var s=X("."+Wv,r);this.inputObj=Ce.createInput({element:s,properties:{enableRtl:this.enableRtl}},this.createElement),this.inputObj.container.style.width=n,s.focus();var a=s;a.setSelectionRange(0,a.value.length),this.wireInputEvents(s)},e.prototype.updateOldText=function(i){var r=i.getAttribute("data-uid");this.editData=this.getNodeObject(r);var n=parseFloat(i.getAttribute("aria-level"));this.editFields=this.getFields(this.fields,n,1),this.oldText=V(this.editFields.text,this.editData)},e.prototype.inputFocusOut=function(i){if(X("."+Wv,this.element)){var r=i.target,n=r.value,s=j(r,"."+Oh),a=j(r,"."+Mt);ee(this.inputObj.container),Ce.destroy({element:r,properties:this.properties}),this.fields.dataSource instanceof re&&!this.isOffline?this.crudOperation("update",null,a,n,null,null,!0):this.appendNewText(a,s,n,!0),E.remove(r,"blur",this.inputFocusOut),this.inputObj=null,ee(r),r=null}},e.prototype.appendNewText=function(i,r,n,s){var a=this,l=this.getEditEvent(i,n,null);this.trigger("nodeEdited",l,function(h){n=h.cancel?h.oldText:h.newText,a.updateText(i,r,n,s),h.oldText!==n&&a.triggerEvent("nodeEdited",[a.getNode(i)])})},e.prototype.updateText=function(i,r,n,s){var a=Ge(this.editFields.text,n,this.editData);if(g(this.nodeTemplateFn))this.enableHtmlSanitizer?r.innerText=Bt.sanitize(n):r.innerHTML=n;else{r.innerText="";var l=i.getAttribute("data-uid");this.renderNodeTemplate(a,r,l),this.renderReactTemplates()}s&&(K([i],vw),i.focus(),E.add(i,"blur",this.focusOut,this),Y([i],Rh)),this.allowTextWrap&&this.calculateWrap(i)},e.prototype.getElement=function(i){return g(i)?null:typeof i=="string"?this.element.querySelector('[data-uid="'+i+'"]'):typeof i=="object"?LS(i):null},e.prototype.getId=function(i){return g(i)?null:typeof i=="string"?i:typeof i=="object"?LS(i).getAttribute("data-uid"):null},e.prototype.getEditEvent=function(i,r,n){var s=this.getNodeData(i);return{cancel:!1,newText:r,node:i,nodeData:s,oldText:this.oldText,innerHtml:n}},e.prototype.getNodeObject=function(i){var r;if(g(i))return r;if(this.dataType===1)for(var n=0,s=this.treeData.length;n<s;n++){var a=V(this.fields.id,this.treeData[parseInt(n.toString(),10)]);if(!g(this.treeData[parseInt(n.toString(),10)])&&!g(a)&&a.toString()===i)return this.treeData[parseInt(n.toString(),10)]}else return this.getChildNodeObject(this.treeData,this.fields,i);return r},e.prototype.getChildNodeObject=function(i,r,n){var s;if(g(i))return s;for(var a=0,l=i.length;a<l;a++){var h=V(r.id,i[parseInt(a.toString(),10)]);if(i[parseInt(a.toString(),10)]&&h&&h.toString()===n)return i[parseInt(a.toString(),10)];if(typeof r.child=="string"&&!g(V(r.child,i[parseInt(a.toString(),10)]))){var u=V(r.child,i[parseInt(a.toString(),10)]);if(s=this.getChildNodeObject(u,this.getChildMapper(r),n),s!==void 0)break}else if(this.fields.dataSource instanceof re&&!g(V("child",i[parseInt(a.toString(),10)]))){var c="child";if(s=this.getChildNodeObject(V(c,i[parseInt(a.toString(),10)]),this.getChildMapper(r),n),s!==void 0)break}else if(this.isChildObject()){var d="child",u=V(d,i[parseInt(a.toString(),10)]);if(s=this.getChildNodeObject(u,this.getChildMapper(r),n),s!==void 0)break}}return s},e.prototype.setDragAndDrop=function(i){i&&!this.disabled?this.initializeDrag():this.destroyDrag()},e.prototype.initializeDrag=function(){var i=this,r;this.dragObj=new Dl(this.element,{enableTailMode:!0,enableAutoScroll:!0,dragArea:this.dragArea,dragTarget:"."+on,enableTapHold:!0,tapHoldThreshold:100,helper:function(n){i.dragTarget=n.sender.target;var s=j(i.dragTarget,"."+na),a=j(i.dragTarget,"."+on);if(i.dragLi=j(i.dragTarget,"."+Mt),i.fullRowSelect&&!a&&i.dragTarget.classList.contains(tl)&&(a=i.dragTarget.nextElementSibling),!i.dragTarget||!n.element.isSameNode(s)||!a||i.dragTarget.classList.contains(na)||i.dragTarget.classList.contains(Jt)||i.dragTarget.classList.contains(Mt)||i.dragLi.classList.contains("e-disable"))return!1;var l=a.cloneNode(!0);if(g(X("div."+Yr,l))){var h=i.createElement("div",{className:Yr+" "+ii});l.insertBefore(h,l.children[0])}var u=SV+" "+na+" "+i.cssClass+" "+(i.enableRtl?BL:"");r=i.createElement("div",{className:u}),r.appendChild(l);var c=i.selectedNodes.length;if(c>1&&i.allowMultiSelection&&i.dragLi.classList.contains(Cs)){var d=i.createElement("span",{className:wV,innerHTML:""+c});r.appendChild(d)}return document.body.appendChild(r),document.body.style.cursor="",i.dragData=i.getNodeData(i.dragLi),r},dragStart:function(n){Y([i.element],mw);var s=j(n.target,".e-list-item"),a;s&&(a=parseInt(s.getAttribute("aria-level"),10));var l=i.getDragEvent(n.event,i,null,n.target,null,r,a);l.draggedNode.classList.contains(vw)?(i.dragObj.intDestroy(n.event),i.dragCancelAction(r)):i.trigger("nodeDragStart",l,function(h){h.cancel?(i.dragObj.intDestroy(n.event),i.dragCancelAction(r)):i.dragStartAction=!0})},drag:function(n){i.dragObj.setProperties({cursorAt:{top:!g(n.event.targetTouches)||B.isDevice?60:-20}}),i.dragAction(n,r)},dragStop:function(n){K([i.element],mw),n.target.classList.contains("e-sibling")||i.removeVirtualEle();var s=n.target,a=!1,l=j(s,"."+jL);(!s||!l)&&(ee(n.helper),document.body.style.cursor="");var h=j(s,".e-list-item"),u;h&&(u=parseInt(h.getAttribute("aria-level"),10));var c=i.getDragEvent(n.event,i,s,s,null,n.helper,u);c.preventTargetExpand=a,i.trigger("nodeDragStop",c,function(d){i.dragParent=d.draggedParentNode,i.preventExpand=d.preventTargetExpand,d.cancel&&(n.helper.parentNode&&ee(n.helper),document.body.style.cursor="",s.classList.contains("e-sibling")&&i.removeVirtualEle()),i.dragStartAction=!1})}}),this.dropObj=new kS(this.element,{out:function(n){!g(n)&&!n.target.classList.contains(zp)&&i.dropObj.dragData.default&&i.dropObj.dragData.default.helper.classList.contains(na)&&(document.body.style.cursor="not-allowed")},over:function(){document.body.style.cursor=""},drop:function(n){i.dropAction(n),i.removeVirtualEle()}})},e.prototype.dragCancelAction=function(i){ee(i),K([this.element],mw),this.dragStartAction=!1},e.prototype.getOffsetX=function(i,r){var n=i.changedTouches;return n&&n.length>0?n[0].clientX-r.getBoundingClientRect().left:i.offsetX},e.prototype.getOffsetY=function(i,r){var n=i.changedTouches;return n&&n.length>0?n[0].clientY-r.getBoundingClientRect().top:i.offsetY},e.prototype.dragAction=function(i,r){var n=j(i.target,"."+jL),s=j(i.target,"."+on),a=X("div."+Yr,r);K([a],[qv,jp,yw,bw]),this.isDropIn=!1,this.removeVirtualEle(),document.body.style.cursor="";var l=i.target.classList,h=i.event,u=this.getOffsetY(h,i.target),c=this.getOffsetX(h,i.target);if(this.fullRowSelect&&!s&&!g(l)&&l.contains(tl)&&(s=i.target.nextElementSibling),n){var d=j(i.target,"."+Mt),p=j(i.target,"."+ss),f=j(i.target,"."+or),v=j(i.target,"."+ii);if(!n.classList.contains(na)||s&&!d.isSameNode(this.dragLi)&&!this.isDescendant(this.dragLi,d))if(this.hasTemplate&&d){var m=X(this.fullRowSelect?"."+tl:"."+on,d);if(i&&!v&&!f&&u<7&&!p||v&&u<5||f&&c<3){var y=this.fullRowSelect?1:0;this.appendIndicator(d,a,y)}else if(i&&!v&&!f&&!p&&m&&u>m.offsetHeight-10||v&&u>19||f&&c>19){var y=this.fullRowSelect?2:1;this.appendIndicator(d,a,y)}else Y([a],qv),this.isDropIn=!0}else if(d&&i&&!v&&!f&&u<7&&!p||v&&u<5||f&&c<3){var y=this.fullRowSelect?1:0;this.appendIndicator(d,a,y)}else if(d&&i&&!v&&!f&&i.target.offsetHeight>0&&u>i.target.offsetHeight-10&&!p||v&&u>19||f&&c>19){var y=this.fullRowSelect?2:1;this.appendIndicator(d,a,y)}else Y([a],qv),this.isDropIn=!0;else i.target.nodeName==="LI"&&!d.isSameNode(this.dragLi)&&!this.isDescendant(this.dragLi,d)?(Y([a],jp),this.renderVirtualEle(i)):i.target.classList.contains(zp)?Y([a],jp):Y([a],yw)}else Y([a],bw),document.body.style.cursor="not-allowed";var S=j(i.target,".e-list-item"),b;S&&(b=parseInt(S.getAttribute("aria-level"),10));var w=this.getDragEvent(i.event,this,i.target,i.target,null,r,b);w.dropIndicator&&K([a],w.dropIndicator),this.trigger("nodeDragging",w),w.dropIndicator&&Y([a],w.dropIndicator)},e.prototype.appendIndicator=function(i,r,n){Y([r],jp);var s=this.createElement("div",{className:zp});i.insertBefore(s,i.children[parseInt(n.toString(),10)])},e.prototype.dropAction=function(i){for(var r=i.event,n=this.getOffsetY(r,i.target),s=i.target,a,l,h=!1,u=[],c=[],d=i.dragData.draggable,p=0;p<d.ej2_instances.length;p++)if(d.ej2_instances[parseInt(p.toString(),10)]instanceof t){a=d.ej2_instances[parseInt(p.toString(),10)];break}if(a&&a.dragTarget){var f=a.dragTarget,v=j(f,"."+Mt),m=j(s,"."+Mt);if(c.push(v),m==null&&s.classList.contains(na)&&(m=s.firstElementChild),ee(i.droppedElement),document.body.style.cursor="",!m||m.isSameNode(v)||this.isDescendant(v,m)){this.fields.dataSource instanceof re||(this.preventExpand=!1);return}if(a.allowMultiSelection&&v.classList.contains(Cs)){var y=Oe("."+Cs,a.element);if(c=y,i.target.offsetHeight<=33&&n>i.target.offsetHeight-10&&n>6)for(var p=y.length-1;p>=0;p--)m.isSameNode(y[parseInt(p.toString(),10)])||this.isDescendant(y[parseInt(p.toString(),10)],m)||this.appendNode(s,y[parseInt(p.toString(),10)],m,i,a,n);else for(var p=0;p<y.length;p++)m.isSameNode(y[parseInt(p.toString(),10)])||this.isDescendant(y[parseInt(p.toString(),10)],m)||this.appendNode(s,y[parseInt(p.toString(),10)],m,i,a,n)}else this.appendNode(s,v,m,i,a,n);l=parseInt(v.getAttribute("aria-level"),10),h=!0}this.fields.dataSource instanceof re||(this.preventExpand=!1);for(var p=0;p<c.length;p++)u.push(this.getNode(c[parseInt(p.toString(),10)]));this.trigger("nodeDropped",this.getDragEvent(i.event,a,s,i.target,i.dragData.draggedElement,null,l,h)),a.element.id!==this.element.id&&(a.triggerEvent("nodeDropped",u),this.isNodeDropped=!0,this.fields.dataSource=this.treeData),this.triggerEvent("nodeDropped",u)},e.prototype.appendNode=function(i,r,n,s,a,l){var h=j(i,"."+ss),u=j(s.target,"."+or),c=j(s.target,"."+ii);!r.classList.contains("e-disable")&&!h&&(c&&s.event.offsetY<5||u&&s.event.offsetX<3||c&&s.event.offsetY>19||u&&s.event.offsetX>19||!c&&!u)?i.nodeName==="LI"?this.dropAsSiblingNode(r,n,s,a):i.firstElementChild&&i.classList.contains(na)?i.firstElementChild.nodeName==="UL"&&this.dropAsSiblingNode(r,n,s,a):i.classList.contains("e-icon-collapsible")||i.classList.contains("e-icon-expandable")?this.dropAsSiblingNode(r,n,s,a):this.dropAsChildNode(r,n,a,null,s,l,null,i):this.dropAsChildNode(r,n,a,null,s,l,!0,i),this.showCheckBox&&this.ensureIndeterminate()},e.prototype.dropAsSiblingNode=function(i,r,n,s){var a=j(r,"."+Jt),l=j(i,"."+Jt),h=j(l,"."+Mt),u;if(n.target.offsetHeight>0&&n.event.offsetY>n.target.offsetHeight-2?u=!1:n.event.offsetY<2?u=!0:(n.target.classList.contains("e-icon-expandable")||n.target.classList.contains("e-icon-collapsible"))&&(n.event.offsetY<5||n.event.offsetX<3?u=!0:(n.event.offsetY>15||n.event.offsetX>17)&&(u=!1)),n.target.classList.contains("e-icon-expandable")||n.target.classList.contains("e-icon-collapsible")){var c=n.target.closest("li");a.insertBefore(i,u?c:c.nextElementSibling)}else a.insertBefore(i,u?n.target:n.target.nextElementSibling);this.moveData(i,r,a,u,s),this.updateElement(l,h),this.updateAriaLevel(i),s.element.id===this.element.id?this.updateList():(s.updateInstance(),this.updateInstance())},e.prototype.dropAsChildNode=function(i,r,n,s,a,l,h,u){var c=j(i,"."+Jt),d=j(c,"."+Mt),p=j(r,"."+Jt),f;if(a&&a.target&&(f=X(this.fullRowSelect?"."+tl:"."+on,r)),a&&(l<7&&!u.classList.contains("e-sibling")||u.classList.contains("e-sibling")&&!r.lastChild.classList.contains("e-sibling"))&&!h)p.insertBefore(i,r),this.moveData(i,r,p,!0,n);else if(a&&a.target.offsetHeight>0&&l>a.target.offsetHeight-10&&!h&&!this.hasTemplate)p.insertBefore(i,r.nextElementSibling),this.moveData(i,r,p,!1,n);else if(this.hasTemplate&&f&&l>f.offsetHeight-10&&!h)p.insertBefore(i,r.nextElementSibling),this.moveData(i,r,p,!1,n);else{var v=this.expandParent(r),m=g(s)?null:v.childNodes[parseInt(s.toString(),10)];v.insertBefore(i,m),this.moveData(i,m,v,!0,n)}this.updateElement(c,d),this.updateAriaLevel(i),n.element.id===this.element.id?this.updateList():(n.updateInstance(),this.updateInstance())},e.prototype.moveData=function(i,r,n,s,a){var l=j(n,"."+Mt),h=this.getId(i),u=a.updateChildField(a.treeData,a.fields,h,null,null,!0),c=this.getId(r),d=this.getDataPos(this.treeData,this.fields,c),p=this.getId(l);if(this.dataType===1){this.updateField(this.treeData,this.fields,p,"hasChildren",!0);var f=g(d)?this.treeData.length:s?d:d+1;if(g(p)&&!this.hasPid)delete u[0][this.fields.parentID];else{var v=this.isNumberTypeId?parseFloat(p):p;Ge(this.fields.parentID,v,u[0])}if(this.treeData.splice(f,0,u[0]),a.element.id!==this.element.id){var m=a.removeChildNodes(h);f++;for(var y=0,S=m.length;y<S;y++)this.treeData.splice(f,0,m[parseInt(y.toString(),10)]),f++;a.groupedData=a.getGroupedData(a.treeData,a.fields.parentID)}this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)}else this.addChildData(this.treeData,this.fields,p,u,s?d:d+1)},e.prototype.expandParent=function(i){var r=X("div."+ii+", div."+or,i);r&&r.classList.contains(ii)&&this.preventExpand!==!0&&this.expandAction(i,r,null);var n=X("."+Jt,i);if(this.preventExpand===!0&&!n&&r&&this.renderChildNodes(i),n=X("."+Jt,i),!g(n)&&this.preventExpand&&i.getAttribute("aria-expanded")!=="true"&&(n.style.display="none"),!g(n)&&this.preventExpand===!1&&(n.style.display="block"),g(n)&&this.preventExpand===!0){g(r)&&At.generateIcon(this.createElement,i,ii,this.listBaseOption);var s=X("div."+ii+", div."+or,i);s&&s.classList.add("e-icon-expandable"),n=At.generateUL(this.createElement,[],null,this.listBaseOption),i.appendChild(n),s?K([s],or):At.generateIcon(this.createElement,i,ii,this.listBaseOption),i.setAttribute("aria-expanded","false"),n.style.display="none"}if(g(n)){var a=this.expandArgs;(g(a)||a&&a.name!=="nodeExpanding")&&this.trigger("nodeExpanding",this.getExpandEvent(i,null)),g(r)&&At.generateIcon(this.createElement,i,or,this.listBaseOption);var s=X("div."+ii+", div."+or,i);s?K([s],ii):(At.generateIcon(this.createElement,i,or,this.listBaseOption),s=X("div."+Yr,i),K([s],ii)),n=At.generateUL(this.createElement,[],null,this.listBaseOption),i.appendChild(n),this.addExpand(i),this.trigger("nodeExpanded",this.getExpandEvent(i,null))}var l=X("div."+or,i);return!g(n)&&l&&this.preventExpand&&i.getAttribute("aria-expanded")!=="true"&&(K([l],or),i.setAttribute("aria-expanded","false"),Y([l],ii)),n},e.prototype.updateElement=function(i,r){if(r&&i.childElementCount===0){var n=X("div."+Yr,r);ee(i),ee(n);var s=this.getId(r);this.updateField(this.treeData,this.fields,s,"hasChildren",!1),this.removeExpand(r,!0)}},e.prototype.updateAriaLevel=function(i){var r=this.parents(i,"."+Jt).length;i.setAttribute("aria-level",""+r),this.updateChildAriaLevel(X("."+Jt,i),r+1)},e.prototype.updateChildAriaLevel=function(i,r){if(!g(i))for(var n=i.childNodes,s=0,a=n.length;s<a;s++){var l=n[parseInt(s.toString(),10)];l.setAttribute("aria-level",""+r),this.updateChildAriaLevel(X("."+Jt,l),r+1)}},e.prototype.renderVirtualEle=function(i){var r,n=i.event,s=this.getOffsetY(n,i.target);s>i.target.offsetHeight-2?r=!1:s<2&&(r=!0);var a=this.createElement("div",{className:zp}),l=this.fullRowSelect?r?1:2:r?0:1;i.target.insertBefore(a,i.target.children[parseInt(l.toString(),10)])},e.prototype.removeVirtualEle=function(){var i=X("."+zp);i&&ee(i)},e.prototype.destroyDrag=function(){this.dragObj&&this.dropObj&&(this.dragObj.destroy(),this.dropObj.destroy())},e.prototype.getDragEvent=function(i,r,n,s,a,l,h,u){var c=n?j(n,"."+Mt):null,d=c?this.getNodeData(c):null,p=r?r.dragLi:a,f=r?r.dragData:null,v=n?this.parents(n,"."+Mt):null,m=r.dragLi.parentElement,y=r.dragLi?j(m,"."+Mt):null,S=null,b=null,w=[jp,qv,yw,bw],I=null,x=u===!0?p:c,M=x?j(x,".e-list-parent"):null,D=0,A=null;if(y=r.dragLi&&y===null?j(m,"."+na):y,y=u===!0?this.dragParent:y,l)for(;D<4;){if(X("."+Yr,l).classList.contains(w[parseInt(D.toString(),10)])){I=w[parseInt(D.toString(),10)];break}D++}if(M){var L=0;for(D=0;D<M.childElementCount;D++)if(L=u!==!0&&M.children[parseInt(D.toString(),10)]===p&&c!==p?++L:L,u!==!0&&M.children[parseInt(D.toString(),10)].classList.contains("e-hover")){b=i.offsetY>=23?D+1:D;break}else if(M.children[parseInt(D.toString(),10)]===x){b=(i.offsetY>=23,D);break}b=L!==0?--b:b,A=this.isDropIn?"Inside":i.offsetY<7?"Before":"After"}if(n&&(v.length===0?S=null:n.classList.contains(Mt)?S=v[0]:S=v[1]),c===p&&(S=c),n&&s.offsetHeight<=33&&i.offsetY<s.offsetHeight-10&&i.offsetY>6&&(S=c,u!==!0)){h=++h;var T=S?X(".e-list-parent",S):null;if(b=T?T.children.length:0,!(this.fields.dataSource instanceof re)&&T===null&&S){var k=S.hasAttribute("data-uid")?this.getChildNodes(this.fields.dataSource,S.getAttribute("data-uid").toString()):null;b=k?k.length:0}}return{cancel:!1,clonedNode:l,event:i,draggedNode:p,draggedNodeData:f,droppedNode:c,droppedNodeData:d,dropIndex:b,dropLevel:h,draggedParentNode:y,dropTarget:S,dropIndicator:I,target:s,position:A}},e.prototype.addFullRow=function(i){var r=this.liList.length;if(i)for(var n=0;n<r;n++)this.createFullRow(this.liList[parseInt(n.toString(),10)]);else for(var n=0;n<r;n++){var s=X("."+tl,this.liList[parseInt(n.toString(),10)]);ee(s)}},e.prototype.createFullRow=function(i){var r=this.createElement("div",{className:tl});i.insertBefore(r,i.childNodes[0])},e.prototype.addMultiSelect=function(i){if(i)for(var r=Oe("."+Mt+':not([aria-selected="true"])',this.element),n=0,s=r;n<s.length;n++){var a=s[n];a.setAttribute("aria-selected","false")}else for(var r=Oe("."+Mt+'[aria-selected="false"]',this.element),l=0,h=r;l<h.length;l++){var a=h[l];a.removeAttribute("aria-selected")}},e.prototype.collapseByLevel=function(i,r,n,s){if(s=g(s)?1:s,r>0&&!g(i))for(var a=this.getVisibleNodes(n,i.childNodes),l=0,h=a.length;l<h;l++){var u=a[parseInt(l.toString(),10)],c=X("."+or,X("."+on,u));s>=r&&!g(c)&&this.collapseNode(u,c,null),this.collapseByLevel(X("."+Jt,u),r,n,s+1)}},e.prototype.collapseAllNodes=function(i){for(var r=this.getVisibleNodes(i,Oe("."+or,this.element)),n=0,s=r.length;n<s;n++){var a=r[parseInt(n.toString(),10)],l=j(a,"."+Mt);this.collapseNode(l,a,null)}},e.prototype.expandByLevel=function(i,r,n){if(r>0&&!g(i))for(var s=this.getVisibleNodes(n,i.childNodes),a=0,l=s.length;a<l;a++){var h=s[parseInt(a.toString(),10)],u=X("."+ii,X("."+on,h));g(u)||this.expandAction(h,u,null),this.expandByLevel(X("."+Jt,h),r-1,n)}},e.prototype.expandAllNodes=function(i){for(var r=this.getVisibleNodes(i,Oe("."+ii,this.element)),n=0,s=r;n<s.length;n++){var a=s[n],l=j(a,"."+Mt);this.expandAction(l,a,null,!0,null,!0)}},e.prototype.getVisibleNodes=function(i,r){var n=Array.prototype.slice.call(r);if(i)for(var s=0;s<n.length;s++)gr(n[parseInt(s.toString(),10)])||(n.splice(s,1),s--);return n},e.prototype.removeNode=function(i){var r=j(i,"."+Jt),n=j(r,"."+Mt);g(this.nodeTemplateFn)||this.destroyTemplate(i),ee(i),this.updateElement(r,n),this.removeData(i)},e.prototype.updateInstance=function(){this.updateList(),this.updateSelectedNodes(),this.updateExpandedNodes()},e.prototype.updateList=function(){this.liList=Array.prototype.slice.call(Oe("."+Mt,this.element))},e.prototype.updateSelectedNodes=function(){this.setProperties({selectedNodes:[]},!0);var i=Oe("."+Cs,this.element);this.selectGivenNodes(i)},e.prototype.updateExpandedNodes=function(){this.setProperties({expandedNodes:[]},!0);for(var i=Oe('[aria-expanded="true"]',this.element),r=0,n=i.length;r<n;r++)this.addExpand(i[parseInt(r.toString(),10)])},e.prototype.removeData=function(i){if(this.dataType===1){var r=new re(this.treeData),n=this.getId(i),s={},a=this.isNumberTypeId?parseFloat(n):n;s[this.fields.id]=a,r.remove(this.fields.id,s),this.removeChildNodes(n)}else{var n=this.getId(i);this.updateChildField(this.treeData,this.fields,n,null,null,!0)}},e.prototype.removeChildNodes=function(i){var r=this.getChildGroup(this.groupedData,i,!1),n=[];if(r)for(var s=0,a=r.length;s<a;s++){var l=new re(this.treeData),h=V(this.fields.id,r[parseInt(s.toString(),10)]).toString(),u={},c=this.isNumberTypeId?parseFloat(h):h;u[this.fields.id]=c;var d=l.remove(this.fields.id,u);n.push(d[0]),this.removeChildNodes(h)}return n},e.prototype.doGivenAction=function(i,r,n){for(var s=0,a=i.length;s<a;s++){var l=this.getElement(i[parseInt(s.toString(),10)]);if(!g(l)){var h=X("."+r,X("."+on,l));g(h)||(n?this.expandAction(l,h,null):this.collapseNode(l,h,null))}}},e.prototype.addGivenNodes=function(i,r,n,s,a){if(i.length!==0){var l=this.getSortedData(i),h=r?parseFloat(r.getAttribute("aria-level"))+1:1;s&&this.updateMapper(h);var u=At.createListItemFromJson(this.createElement,l,this.listBaseOption,h),c=this.getId(r),d;g(r)||(d=X("div."+Yr,r)),this.dataType===1&&d&&d.classList.contains(ii)&&this.preventExpand&&!g(this.element.offsetParent)&&!this.element.offsetParent.parentElement.classList.contains("e-filemanager")&&(this.preventExpand=!0),this.dataType!==1&&(this.addChildData(this.treeData,this.fields,c,i,n),this.isFirstRender=!1);var p;a?p=a:p=r?this.expandParent(r):X("."+Jt,this.element);var f=g(n)?null:p.childNodes[parseInt(n.toString(),10)];if(!this.isFirstRender||this.dataType===1){var v=this.expandArgs;if(f||this.sortOrder==="None"){for(var m=0;m<u.length;m++)p.insertBefore(u[parseInt(m.toString(),10)],f);if(this.dataType===1&&!g(r)&&!this.preventExpand&&!g(this.element.offsetParent)&&!this.element.offsetParent.parentElement.classList.contains("e-filemanager")){this.preventExpand=!1;var y=X("div."+Yr,r);y&&y.classList.contains(ii)&&(g(v)||v.name!=="nodeExpanding")&&this.expandAction(r,y,null)}}if(!f&&(this.sortOrder==="Ascending"||this.sortOrder==="Descending"))if(p.childNodes.length===0){for(var m=0;m<u.length;m++)p.insertBefore(u[parseInt(m.toString(),10)],f);if(this.dataType===1&&!g(r)&&!this.preventExpand&&!g(this.element.offsetParent)&&!this.element.offsetParent.parentElement.classList.contains("e-filemanager")){this.preventExpand=!1;var y=X("div."+Yr,r);y&&y.classList.contains(ii)&&(g(v)||v.name!=="nodeExpanding")&&this.expandAction(r,y,null)}}else for(var S=p.childNodes,m=0;m<u.length;m++)for(var b=0;b<S.length;b++){var w=this.sortOrder==="Ascending"?S[parseInt(b.toString(),10)].textContent.toUpperCase()>u[parseInt(m.toString(),10)].innerText.toUpperCase():S[parseInt(b.toString(),10)].textContent.toUpperCase()<u[parseInt(m.toString(),10)].innerText.toUpperCase();if(w){p.insertBefore(u[parseInt(m.toString(),10)],S[parseInt(b.toString(),10)]);break}p.insertBefore(u[parseInt(m.toString(),10)],S[S.length])}}if(this.dataType===1){this.updateField(this.treeData,this.fields,c,"hasChildren",!0);for(var I=this.getId(f),x=g(I)?this.treeData.length:this.getDataPos(this.treeData,this.fields,I),b=0;b<i.length;b++){if(!g(c)){var M=this.isNumberTypeId?parseFloat(c):c;Ge(this.fields.parentID,M,i[parseInt(b.toString(),10)])}this.treeData.splice(x,0,i[parseInt(b.toString(),10)]),x++}}this.finalizeNode(p)}},e.prototype.updateMapper=function(i){var r=i===1?this.fields:this.getChildFields(this.fields,i-1,1);this.updateListProp(r)},e.prototype.updateListProp=function(i){var r=this.getActualProperties(i);this.listBaseOption.fields=r,this.listBaseOption.fields.url=Object.prototype.hasOwnProperty.call(r,"navigateUrl")?r.navigateUrl:"navigateUrl"},e.prototype.getDataPos=function(i,r,n){for(var s=null,a=0,l=i.length;a<l;a++){var h=V(r.id,i[parseInt(a.toString(),10)]);if(i[parseInt(a.toString(),10)]&&h&&h.toString()===n)return a;if(typeof r.child=="string"&&!g(V(r.child,i[parseInt(a.toString(),10)]))){var u=V(r.child,i[parseInt(a.toString(),10)]);if(s=this.getDataPos(u,this.getChildMapper(r),n),s!==null)break}else if(this.fields.dataSource instanceof re&&!g(V("child",i[parseInt(a.toString(),10)]))){var c=V("child",i[parseInt(a.toString(),10)]);if(s=this.getDataPos(c,this.getChildMapper(r),n),s!==null)break}}return s},e.prototype.addChildData=function(i,r,n,s,a){var l;if(g(n)){a=g(a)?i.length:a;for(var h=0,u=s.length;h<u;h++)i.splice(a,0,s[parseInt(h.toString(),10)]),a++;return l}for(var c=0,d=i.length;c<d;c++){var p=V(r.id,i[parseInt(c.toString(),10)]);if(i[parseInt(c.toString(),10)]&&p&&p.toString()===n){if(typeof r.child=="string"&&Object.prototype.hasOwnProperty.call(i[parseInt(c.toString(),10)],r.child)&&i[parseInt(c.toString(),10)][r.child]!==null||this.fields.dataSource instanceof re&&Object.prototype.hasOwnProperty.call(i[parseInt(c.toString(),10)],"child")){var f=typeof r.child=="string"?r.child:"child",v=V(f,i[parseInt(c.toString(),10)]);g(v)&&(v=[]),a=g(a)?v.length:a;for(var h=0,u=s.length;h<u;h++)v.splice(a,0,s[parseInt(h.toString(),10)]),a++}else{var f=typeof r.child=="string"?r.child:"child";i[parseInt(c.toString(),10)][""+f]=s}return!0}else if(typeof r.child=="string"&&!g(V(r.child,i[parseInt(c.toString(),10)]))){var m=V(r.child,i[parseInt(c.toString(),10)]);if(l=this.addChildData(m,this.getChildMapper(r),n,s,a),l!==void 0)break}else if(this.fields.dataSource instanceof re&&!g(V("child",i[parseInt(c.toString(),10)]))){var v=V("child",i[parseInt(c.toString(),10)]);if(l=this.addChildData(v,this.getChildMapper(r),n,s,a),l!==void 0)break}}return l},e.prototype.doDisableAction=function(i){var r=this.nodeType(i),n=this.checkValidId(r);this.validArr=[];for(var s=0,a=n.length;s<a;s++){var l=n[parseInt(s.toString(),10)][this.fields.id].toString();l&&this.disableNode.indexOf(l)===-1&&this.disableNode.push(l);var h=this.getElement(l);h&&(h.setAttribute("aria-disabled","true"),Y([h],Ic))}},e.prototype.doEnableAction=function(i){for(var r=this.nodeType(i),n=0,s=r.length;n<s;n++){var a=this.getElement(r[parseInt(n.toString(),10)]),l=r[parseInt(n.toString(),10)];l&&this.disableNode.indexOf(l)!==-1&&this.disableNode.splice(this.disableNode.indexOf(l),1),a&&(a.removeAttribute("aria-disabled"),K([a],Ic))}},e.prototype.nodeType=function(i){for(var r=[],n=0,s=i.length;n<s;n++){var a=void 0;typeof i[parseInt(n.toString(),10)]=="string"?a=i[parseInt(n.toString(),10)]?i[parseInt(n.toString(),10)].toString():null:typeof i[parseInt(n.toString(),10)]=="object"&&(a=i[parseInt(n.toString(),10)]?i[parseInt(n.toString(),10)].getAttribute("data-uid").toString():null),r.indexOf(a)===-1&&r.push(a)}return r},e.prototype.checkValidId=function(i){var r=this;if(this.dataType===1)this.validArr=this.treeData.filter(function(l){return i.indexOf(l[r.fields.id]?l[r.fields.id].toString():null)!==-1});else if(this.dataType===2)for(var n=0;n<this.treeData.length;n++){var s=this.treeData[parseInt(n.toString(),10)][this.fields.id]?this.treeData[parseInt(n.toString(),10)][this.fields.id].toString():null;i.indexOf(s)!==-1&&this.validArr.push(this.treeData[parseInt(n.toString(),10)]);var a=V(this.fields.child.toString(),this.treeData[parseInt(n.toString(),10)]);a&&this.filterNestedChild(a,i)}return this.validArr},e.prototype.filterNestedChild=function(i,r){for(var n=0;n<i.length;n++){var s=i[parseInt(n.toString(),10)][this.fields.id]?i[parseInt(n.toString(),10)][this.fields.id].toString():null;r.indexOf(s)!==-1&&this.validArr.push(i[parseInt(n.toString(),10)]);var a=V(this.fields.child.toString(),i[parseInt(n.toString(),10)]);a&&this.filterNestedChild(a,r)}},e.prototype.setTouchClass=function(){var i=j(this.element,"."+MV);this.touchClass=g(i)?"":DV},e.prototype.updatePersistProp=function(){this.removeField(this.treeData,this.fields,["selected","expanded"]);for(var i=this.selectedNodes,r=0,n=i.length;r<n;r++)this.updateField(this.treeData,this.fields,i[parseInt(r.toString(),10)],"selected",!0);for(var s=this.expandedNodes,a=0,l=s.length;a<l;a++)this.updateField(this.treeData,this.fields,s[parseInt(a.toString(),10)],"expanded",!0);if(this.showCheckBox){this.removeField(this.treeData,this.fields,["isChecked"]);for(var h=this.checkedNodes,u=0,l=h.length;u<l;u++)this.updateField(this.treeData,this.fields,h[parseInt(u.toString(),10)],"isChecked",!0)}},e.prototype.removeField=function(i,r,n){if(!(g(i)||g(r)))for(var s=0,a=i.length;s<a;s++){for(var l=0;l<n.length;l++){var h=this.getMapperProp(r,n[parseInt(l.toString(),10)]);g(i[parseInt(s.toString(),10)][""+h])||delete i[parseInt(s.toString(),10)][""+h]}typeof r.child=="string"&&!g(V(r.child,i[parseInt(s.toString(),10)]))?this.removeField(V(r.child,i[parseInt(s.toString(),10)]),this.getChildMapper(r),n):this.fields.dataSource instanceof re&&!g(V("child",i[parseInt(s.toString(),10)]))&&this.removeField(V("child",i[parseInt(s.toString(),10)]),this.getChildMapper(r),n)}},e.prototype.getMapperProp=function(i,r){switch(r){case"selected":return g(i.selected)?"selected":i.selected;case"expanded":return g(i.expanded)?"expanded":i.expanded;case"isChecked":return g(i.isChecked)?"isChecked":i.isChecked;case"hasChildren":return g(i.hasChildren)?"hasChildren":i.hasChildren;default:return r}},e.prototype.updateField=function(i,r,n,s,a){if(!g(n))if(this.dataType===1){var l=this.isNumberTypeId?parseFloat(n):n,h=new re(this.treeData).executeLocal(new Pe().where(r.id,"equal",l,!1));Ge(this.getMapperProp(r,s),a,h[0])}else this.updateChildField(i,r,n,s,a)},e.prototype.updateChildField=function(i,r,n,s,a,l){var h;if(g(i))return h;for(var u=0,c=i.length;u<c;u++){var d=V(r.id,i[parseInt(u.toString(),10)]);if(i[parseInt(u.toString(),10)]&&!g(d)&&d.toString()===n)return l?h=i.splice(u,1):(Ge(this.getMapperProp(r,s),a,i[parseInt(u.toString(),10)]),h=[]),h;if(typeof r.child=="string"&&!g(V(r.child,i[parseInt(u.toString(),10)]))){var p=V(r.child,i[parseInt(u.toString(),10)]);if(h=this.updateChildField(p,this.getChildMapper(r),n,s,a,l),h!==void 0)break}else if(this.fields.dataSource instanceof re&&!g(V("child",i[parseInt(u.toString(),10)]))){var f=V("child",i[parseInt(u.toString(),10)]);if(h=this.updateChildField(f,this.getChildMapper(r),n,s,a,l),h!==void 0)break}}return h},e.prototype.triggerEvent=function(i,r){if(this.renderReactTemplates(),i==="addNodes"){for(var n=[],s=0;s<r.length;s++)n.push(this.getNode(this.getElement(g(r[parseInt(s.toString(),10)][this.fields.id])?V(this.fields.id,r[parseInt(s.toString(),10)]).toString():null)));r=n}var a={data:this.treeData,action:i,nodeData:r};this.trigger("dataSourceChanged",a)},e.prototype.wireInputEvents=function(i){E.add(i,"blur",this.inputFocusOut,this)},e.prototype.wireEditingEvents=function(i){var r=this;i&&!this.disabled?this.touchEditObj=new Fr(this.element,{tap:function(n){r.isDoubleTapped(n)&&n.tapCount===2&&(n.originalEvent.preventDefault(),r.editingHandler(n.originalEvent))}}):this.touchEditObj&&this.touchEditObj.destroy()},e.prototype.wireClickEvent=function(i){var r=this;i?this.touchClickObj=new Fr(this.element,{tap:function(n){r.clickHandler(n)}}):this.touchClickObj&&this.touchClickObj.destroy()},e.prototype.wireExpandOnEvent=function(i){var r=this;i?this.touchExpandObj=new Fr(this.element,{tap:function(n){(r.expandOnType==="Click"||r.expandOnType==="DblClick"&&r.isDoubleTapped(n)&&n.tapCount===2)&&n.originalEvent.which!==3&&r.expandHandler(n)}}):this.touchExpandObj&&this.touchExpandObj.destroy()},e.prototype.mouseDownHandler=function(i){this.mouseDownStatus=!0,(i.shiftKey||i.ctrlKey)&&i.preventDefault(),i.ctrlKey&&this.allowMultiSelection&&E.add(this.element,"contextmenu",this.preventContextMenu,this)},e.prototype.preventContextMenu=function(i){i.preventDefault()},e.prototype.wireEvents=function(){E.add(this.element,"mousedown",this.mouseDownHandler,this),this.wireClickEvent(!0),this.expandOnType!=="None"&&this.wireExpandOnEvent(!0),E.add(this.element,"mouseover",this.onMouseOver,this),E.add(this.element,"mouseout",this.onMouseLeave,this),this.keyboardModule=new $i(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})},e.prototype.unWireEvents=function(){E.remove(this.element,"mousedown",this.mouseDownHandler),this.wireClickEvent(!1),this.wireExpandOnEvent(!1),E.remove(this.element,"mouseover",this.onMouseOver),E.remove(this.element,"mouseout",this.onMouseLeave),this.disabled||this.keyboardModule.destroy()},e.prototype.parents=function(i,r){for(var n=[],s=i.parentNode;!g(s);)ic(s,r)&&n.push(s),s=s.parentNode;return n},e.prototype.isDoubleTapped=function(i){var r=i.originalEvent.target,n;return r&&i.tapCount&&(i.tapCount===1?this.firstTap=j(r,"."+Mt):i.tapCount===2&&(n=j(r,"."+Mt))),this.firstTap===n},e.prototype.isDescendant=function(i,r){for(var n=r.parentNode;!g(n);){if(n===i)return!0;n=n.parentNode}return!1},e.prototype.showSpinner=function(i){Y([i],_v),Os({target:i,width:B.isDevice?16:14},this.createElement),rs(i)},e.prototype.hideSpinner=function(i){Rs(i),i.innerHTML="",K([i],_v)},e.prototype.setCheckedNodes=function(i){i=JSON.parse(JSON.stringify(i)),i.length>1&&typeof this.nodeChecked=="function"&&this.nodeChecked.length>0&&(this.isFilter=!0),this.uncheckAll(this.checkedNodes),this.setIndeterminate(i),i.length>0&&this.checkAll(i)},e.prototype.setValidCheckedNode=function(i,r){if(r===void 0&&(r=[]),this.dataType===1){var n=this.fields,s=new re(this.treeData).executeLocal(new Pe().where(n.id,"equal",i,!0));if(s[0]&&(this.setChildCheckState(s,i,s[0],r),this.autoCheck)){for(var a=s[0][this.fields.parentID]?s[0][this.fields.parentID].toString():null,l=this.getChildNodes(this.treeData,a),h=0,u=0;u<l.length;u++){var c=l[parseInt(u.toString(),10)][this.fields.id].toString();this.checkedNodes.indexOf(c)!==-1&&h++}h===l.length&&this.checkedNodes.indexOf(a)===-1&&a&&this.checkDisabledState(a)}}else if(this.dataType===2)for(var d=0;d<this.treeData.length;d++){var p=this.treeData[parseInt(d.toString(),10)][this.fields.id]?this.treeData[parseInt(d.toString(),10)][this.fields.id].toString():"";if(p===i&&this.checkedNodes.indexOf(i)===-1){this.checkDisabledState(i);break}var f=V(this.fields.child.toString(),this.treeData[parseInt(d.toString(),10)]);f&&this.setChildCheckState(f,i,this.treeData[parseInt(d.toString(),10)],r)}},e.prototype.setChildCheckState=function(i,r,n,s){s===void 0&&(s=[]);var a,l=0;if(this.dataType===1){n&&(a=n[this.fields.id]?n[this.fields.id].toString():null);for(var h=0;h<i.length;h++){var u=i[parseInt(h.toString(),10)][this.fields.id]?i[parseInt(h.toString(),10)][this.fields.id].toString():null;n&&a&&this.autoCheck&&this.checkedNodes.indexOf(a)!==-1&&this.checkedNodes.indexOf(u)===-1&&this.checkDisabledState(u,i[h]),u===r&&this.checkedNodes.indexOf(r)===-1&&this.checkDisabledState(r);var c=this.getChildNodes(this.treeData,u),d=s.length===1&&s[0]===u;(c.length===r.length||d)&&this.setChildCheckState(c,r,n)}}else{n&&(a=n[this.fields.id]?n[this.fields.id].toString():"");for(var h=0;h<i.length;h++){var p=i[parseInt(h.toString(),10)][this.fields.id]?i[parseInt(h.toString(),10)][this.fields.id].toString():"",d=[r].length===1&&s.length===0;n&&a&&this.autoCheck&&this.checkedNodes.indexOf(a)!==-1&&this.checkedNodes.indexOf(p)===-1&&(p===r||d)&&this.checkDisabledState(p,i[h]),p===r&&this.checkedNodes.indexOf(r)===-1&&this.checkDisabledState(r);var c=V(this.fields.child.toString(),i[parseInt(h.toString(),10)]);c&&this.setChildCheckState(c,r,i[parseInt(h.toString(),10)]),this.checkedNodes.indexOf(p)!==-1&&this.autoCheck&&l++,l===i.length&&this.checkedNodes.indexOf(a)===-1&&this.autoCheck&&this.checkDisabledState(a,n)}}},e.prototype.setIndeterminate=function(i){for(var r=0;r<i.length;r++)this.setValidCheckedNode(i[parseInt(r.toString(),10)],i)},e.prototype.updatePosition=function(i,r,n,s){if(this.dataType===1){var a=this.getDataPos(this.treeData,this.fields,i);if(this.treeData.splice(a,1,r),n){this.removeChildNodes(i);for(var l=0;l<s.length;l++)this.treeData.splice(a,0,s[parseInt(l.toString(),10)]),a++}this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)}else this.updateChildPosition(this.treeData,this.fields,i,[r],void 0)},e.prototype.updateChildPosition=function(i,r,n,s,a){for(var l,h=0,u=i.length;h<u;h++){var c=V(r.id,i[parseInt(h.toString(),10)]);if(i[parseInt(h.toString(),10)]&&c&&c.toString()===n)return i[parseInt(h.toString(),10)]=s[0],!0;if(typeof r.child=="string"&&!g(V(r.child,i[parseInt(h.toString(),10)]))){var d=V(r.child,i[parseInt(h.toString(),10)]);if(l=this.updateChildPosition(d,this.getChildMapper(r),n,s,a),l!==void 0)break}else if(this.fields.dataSource instanceof re&&!g(V("child",i[parseInt(h.toString(),10)]))){var p=V("child",i[parseInt(h.toString(),10)]);if(l=this.updateChildPosition(p,this.getChildMapper(r),n,s,a),l!==void 0)break}}return l},e.prototype.dynamicState=function(){this.setDragAndDrop(this.allowDragAndDrop),this.wireEditingEvents(this.allowEditing),this.disabled?(this.unWireEvents(),this.rippleFn(),this.rippleIconFn()):(this.wireEvents(),this.setRipple())},e.prototype.crudOperation=function(i,r,n,s,a,l,h){var u=this,c=this.fields.dataSource,d=[],p=this.getQuery(this.fields),f=this.fields.id,v,m={addedRecords:[],deletedRecords:[],changedRecords:[]},y=[];r?y=this.nodeType(r):n&&(typeof n=="string"?y[0]=n.toString():typeof n=="object"&&(y[0]=n.getAttribute("data-uid").toString()));for(var S=0,b=y.length;S<b;S++){var w=this.getElement(y[parseInt(S.toString(),10)]);if(!g(w)){var I=this.getNodeObject(y[parseInt(S.toString(),10)]);d.push(I)}}switch(i){case"delete":r.length===1?v=c.remove(f,d[0],p.fromTable,p):(m.deletedRecords=d,v=c.saveChanges(m,f,p.fromTable,p)),v.then(function(){return u.deleteSuccess(y)}).catch(function(M){return u.dmFailure(M)});break;case"update":d[0][this.fields.text]=s,v=c.update(f,d[0],p.fromTable,p),v.then(function(){return u.editSucess(n,s,h)}).catch(function(M){return u.dmFailure(M,n,h)});break;case"insert":if(a.length===1)v=c.insert(a[0],p.fromTable,p);else{for(var x=[],S=0,b=a.length;S<b;S++)x.push(a[parseInt(S.toString(),10)]);m.addedRecords=x,v=c.saveChanges(m,f,p.fromTable,p)}v.then(function(){var M=u.getElement(n);u.addSuccess(a,M,l),u.preventExpand=!1}).catch(function(M){return u.dmFailure(M)});break}},e.prototype.deleteSuccess=function(i){for(var r=[],n=0,s=i.length;n<s;n++){var a=this.getElement(i[parseInt(n.toString(),10)]);r.push(this.getNode(a)),!g(a)&&this.removeNode(a)}this.updateInstance(),this.dataType===1&&(this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)),this.triggerEvent("removeNode",r)},e.prototype.editSucess=function(i,r,n){var s=this.getElement(i),a=X("."+Oh,s);this.appendNewText(s,a,r,n)},e.prototype.addSuccess=function(i,r,n){var s=this,a,l=r?r.querySelector("."+Yr):null;r&&l&&l.classList.contains(ii)&&r.querySelector("."+Jt)===null?this.renderChildNodes(r,null,function(){a=r.querySelector("."+Jt),s.addGivenNodes(i,r,n,!0,a),s.triggerEvent("addNodes",i)}):(this.addGivenNodes(i,r,n,!0),this.triggerEvent("addNodes",i))},e.prototype.dmFailure=function(i,r,n){r&&this.updatePreviousText(r,n),this.trigger("actionFailure",{error:i})},e.prototype.updatePreviousText=function(i,r){var n=this.getElement(i),s=X("."+Oh,n);this.updateText(n,s,this.oldText,r)},e.prototype.getHierarchicalParentId=function(i,r,n){var s=this,a=r.findIndex(function(u){return u[s.fields.id]&&u[s.fields.id].toString()===i});if(a===-1)for(var l=0;l<r.length;l++){var h=V(this.fields.child.toString(),r[parseInt(l.toString(),10)]);if(!g(h))if(a=h.findIndex(function(u){return u[s.fields.id]&&u[s.fields.id].toString()===i}),a===-1)this.getHierarchicalParentId(i,h,n);else{n.push(r[parseInt(l.toString(),10)][this.fields.id].toString()),this.getHierarchicalParentId(r[parseInt(l.toString(),10)][this.fields.id].toString(),this.treeData,n);break}}return n},e.prototype.onPropertyChanged=function(i,r){for(var n=0,s=Object.keys(i);n<s.length;n++){var a=s[n];switch(a){case"allowDragAndDrop":this.setDragAndDrop(this.allowDragAndDrop);break;case"dragArea":this.allowDragAndDrop&&(this.dragObj.dragArea=this.dragArea);break;case"allowEditing":this.wireEditingEvents(this.allowEditing);break;case"allowMultiSelection":if(this.selectedNodes.length>1){var l=this.getElement(this.selectedNodes[0]);this.isLoaded=!1,this.removeSelectAll(),this.selectNode(l,null),this.isLoaded=!0}this.setMultiSelect(this.allowMultiSelection),this.addMultiSelect(this.allowMultiSelection);break;case"allowTextWrap":this.setTextWrap(),this.updateWrap();break;case"checkedNodes":JSON.stringify(r.checkedNodes)!==JSON.stringify(i.checkedNodes)&&this.showCheckBox&&(this.checkedNodes=r.checkedNodes,this.setCheckedNodes(i.checkedNodes));break;case"autoCheck":this.showCheckBox&&(this.autoCheck=i.autoCheck,this.ensureIndeterminate());break;case"cssClass":this.setCssClass(r.cssClass,i.cssClass);break;case"enableRtl":this.setEnableRtl();break;case"expandedNodes":this.isAnimate=!1,this.setProperties({expandedNodes:[]},!0),this.collapseAll(),this.isInitalExpand=!0,this.setProperties({expandedNodes:g(i.expandedNodes)?[]:i.expandedNodes},!0),this.doExpandAction(),this.isInitalExpand=!1,this.isAnimate=!0;break;case"expandOn":this.wireExpandOnEvent(!1),this.setExpandOnType(),this.expandOnType!=="None"&&!this.disabled&&this.wireExpandOnEvent(!0);break;case"disabled":this.setDisabledMode(),this.dynamicState();break;case"fields":this.isAnimate=!1,this.isFieldChange=!0,this.initialRender=!0,(!this.isReact||this.isReact&&!(this.fields.dataSource instanceof re))&&(this.element.classList.contains("e-filtering")||(this.DDTTreeData=JSON.parse(JSON.stringify(this.fields.dataSource))),this.reRenderNodes()),this.initialRender=!1,this.isAnimate=!0,this.isFieldChange=!1;break;case"fullRowSelect":this.setFullRow(this.fullRowSelect),this.addFullRow(this.fullRowSelect),this.allowTextWrap&&(this.setTextWrap(),this.updateWrap());break;case"loadOnDemand":if(this.loadOnDemand===!1&&!this.onLoaded){for(var h=this.element.querySelectorAll("li"),u=0;u<h.length;)h[parseInt(u.toString(),10)].getAttribute("aria-expanded")!=="true"&&this.renderChildNodes(h[parseInt(u.toString(),10)],!0,null,!0),u++;this.onLoaded=!0}break;case"nodeTemplate":this.hasTemplate=!1,this.nodeTemplateFn=this.templateComplier(this.nodeTemplate),this.reRenderNodes();break;case"selectedNodes":this.removeSelectAll(),this.setProperties({selectedNodes:i.selectedNodes},!0),this.doSelectionAction();break;case"showCheckBox":case"checkDisabledChildren":this.reRenderNodes();break;case"sortOrder":this.reRenderNodes();break;case"fullRowNavigable":this.setProperties({fullRowNavigable:i.fullRowNavigable},!0),this.listBaseOption.itemNavigable=i.fullRowNavigable,this.reRenderNodes();break}}},e.prototype.destroy=function(){this.clearTemplate(),this.element.removeAttribute("aria-activedescendant"),this.unWireEvents(),this.wireEditingEvents(!1),this.disabled||(this.rippleFn(),this.rippleIconFn()),this.setCssClass(this.cssClass,null),this.setDragAndDrop(!1),this.setFullRow(!1),this.ulElement&&this.ulElement.parentElement&&this.ulElement.parentElement.removeChild(this.ulElement),this.ulElement=null,this.liList=null,this.startNode=null,this.firstTap=null,this.expandArgs=null,this.dragLi=null,this.dragTarget=null,this.dragParent=null,this.dragObj=null,this.dropObj=null,this.inputObj=null,this.touchEditObj=null,this.touchExpandObj=null,this.touchClickObj=null,o.prototype.destroy.call(this)},e.prototype.addNodes=function(i,r,n,s){if(!g(i)){i=JSON.parse(JSON.stringify(i));var a=this.getElement(r);if(this.preventExpand=s,this.fields.dataSource instanceof re)this.isOffline?this.addSuccess(i,a,n):this.crudOperation("insert",null,r,null,i,n,this.preventExpand);else if(this.dataType===2)this.addGivenNodes(i,a,n);else{if(a)this.addGivenNodes(i,a,n);else{i=this.getSortedData(i);for(var l=0;l<i.length;l++){var h=V(this.fields.parentID,i[parseInt(l.toString(),10)]);a=h&&this.getElement(h.toString()),!g(h)&&g(a)&&(this.isHiddenItem=!0,this.preventExpand=!1,this.ensureVisible(h),this.preventExpand=s,this.isHiddenItem=!1,a=this.getElement(h.toString())),this.addGivenNodes([i[parseInt(l.toString(),10)]],a,n)}}this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)}this.setNodeFocusable(),this.updateCheckedStateFromDS(),this.showCheckBox&&a&&this.ensureParentCheckState(a),this.fields.dataSource instanceof re||(this.preventExpand=!1,this.triggerEvent("addNodes",i))}},e.prototype.beginEdit=function(i){var r=this.getElement(i);g(r)||this.disabled||this.createTextbox(r)},e.prototype.checkAll=function(i){this.showCheckBox&&this.doCheckBoxAction(i,!0)},e.prototype.collapseAll=function(i,r,n){g(i)?r>0?this.collapseByLevel(X("."+Jt,this.element),r,n):this.collapseAllNodes(n):this.doGivenAction(i,or,!1)},e.prototype.disableNodes=function(i){g(i)||this.doDisableAction(i)},e.prototype.enableNodes=function(i){g(i)||this.doEnableAction(i)},e.prototype.ensureVisible=function(i){var r=[];if(this.dataType===1)for(var n=this.getTreeData(i);n.length!==0&&!g(n[0][this.fields.parentID]);)r.push(n[0][this.fields.parentID].toString()),n=this.getTreeData(n[0][this.fields.parentID].toString());else this.dataType===2&&(r=this.getHierarchicalParentId(i,this.treeData,r));this.expandAll(r.reverse(),null,null,this.isHiddenItem);var s=this.getElement(i);if(!g(s)){if(typeof i=="object"){var a=this.parents(s,"."+Mt);this.expandAll(a)}setTimeout(function(){s.scrollIntoView({behavior:"smooth"})},450)}},e.prototype.expandAll=function(i,r,n,s){this.isAnimate=!s,g(i)?r>0?this.expandByLevel(X("."+Jt,this.element),r,n):(this.expandAllNodes(n),(!this.loadOnDemand||this.element.classList.contains("e-filtering"))&&(this.updateAttributes(this.element),this.updateList())):this.doGivenAction(i,ii,!0),this.isAnimate=!0},e.prototype.getAllCheckedNodes=function(){var i=this.checkedNodes;return i},e.prototype.getDisabledNodes=function(){var i=this.disableNode;return i},e.prototype.getNode=function(i){var r=this.getElement(i);return this.getNodeData(r,!0)},e.prototype.getTreeData=function(i){var r=this.getId(i);if(this.updatePersistProp(),g(r))return this.treeData;var n=this.getNodeObject(r);return g(n)?[]:[n]},e.prototype.moveNodes=function(i,r,n,s){if(!(g(i)||i.length===0)){var a=this.getElement(r),l=[];g(a)&&(this.isHiddenItem=!0,this.ensureVisible(r),this.isHiddenItem=!1,a=this.getElement(r));for(var h=0;h<i.length;h++){var u=this.getElement(i[parseInt(h.toString(),10)]);l.push(this.getNode(u)),!(g(u)||a.isSameNode(u)||this.isDescendant(u,a))&&(this.preventExpand=s,this.dropAsChildNode(u,a,this,n,null,null,null,a))}this.fields.dataSource instanceof re||(this.preventExpand=!1),this.triggerEvent("moveNodes",l)}},e.prototype.refreshNode=function(i,r){if(!(g(i)||g(r))){var n=!1;if(this.dataType===1&&r.length>1)n=!0;else if(this.dataType===2&&r.length===1){var s=V(this.fields.child.toString(),r[0]);g(s)||(n=!0)}var a=this.getElement(i),l=a?a.getAttribute("data-uid"):i?i.toString():null;this.refreshData=this.getNodeObject(l),r=JSON.parse(JSON.stringify(r));var h,u;if(this.dataType===1&&n){for(var c=0;c<r.length;c++)if(g(r[parseInt(c.toString(),10)][this.fields.parentID])){u=r[parseInt(c.toString(),10)],r.splice(c,1);break}h=he({},this.refreshData,u)}else h=he({},this.refreshData,r[0]);if(g(a)){this.updatePosition(l,h,n,r);return}this.isRefreshed=!0;var d=parseFloat(a.getAttribute("aria-level")),p=At.createListItemFromJson(this.createElement,[h],this.listBaseOption,d),f=X("."+Jt,a),v=V(this.fields.child.toString(),h);if(n&&f||n&&!g(v)){var m=a.parentElement,y=Array.prototype.indexOf.call(m.childNodes,a);Ue(a),m.insertBefore(p[0],m.childNodes[parseInt(y.toString(),10)]),this.updatePosition(l,h,n,r),n&&f&&this.expandAll([l])}else{var S=X("."+on,a),b=X("."+on,p[0]),w=X("div."+Yr,S),I=X("div."+Yr,b);w&&I&&(I.classList.contains(ii)&&w.classList.contains(or)?(K([I],ii),Y([I],or)):I.classList.contains(or)&&w.classList.contains(ii)?(K([I],or),Y([I],ii)):w.classList.contains("interaction")&&Y([I],"interaction")),Ue(S);var x=X("."+tl,a);x.parentNode.insertBefore(b,x.nextSibling),this.updatePosition(l,h,n,r)}if(a=this.getElement(i),h[this.fields.tooltip]&&a.setAttribute("title",h[this.fields.tooltip]),Object.prototype.hasOwnProperty.call(h,this.fields.htmlAttributes)&&h[this.fields.htmlAttributes]){var M={};ht(M,h[this.fields.htmlAttributes]),M.class?(Y([a],M.class.split(" ")),delete M.class):Ie(a,M)}this.selectedNodes.indexOf(l)!==-1&&(a.setAttribute("aria-selected","true"),Y([a],Cs)),this.isRefreshed=!1,this.triggerEvent("refreshNode",[this.getNode(a)])}},e.prototype.removeNodes=function(i){g(i)||(this.fields.dataSource instanceof re&&!this.isOffline?this.crudOperation("delete",i):this.deleteSuccess(i))},e.prototype.updateNode=function(i,r){var n=this;if(!(g(i)||g(r)||!this.allowEditing)){var s=this.getElement(i);if(!g(s)){var a=X("."+Oh,s);this.updateOldText(s);var l=this.getEditEvent(s,null,null);this.trigger("nodeEditing",l,function(h){h.cancel||(n.fields.dataSource instanceof re&&!n.isOffline?n.crudOperation("update",null,i,r,null,null,!1):n.appendNewText(s,a,r,!1))})}}},e.prototype.uncheckAll=function(i){this.showCheckBox&&this.doCheckBoxAction(i,!1)},e.prototype.setNodeFocusable=function(){var i=X("."+Mt,this.element);i&&(i.setAttribute("tabindex","0"),this.updateIdAttr(null,i))};var t;return it([C(!1)],e.prototype,"allowDragAndDrop",void 0),it([C(!1)],e.prototype,"allowEditing",void 0),it([C(!1)],e.prototype,"allowMultiSelection",void 0),it([C(!1)],e.prototype,"allowTextWrap",void 0),it([be({},TV)],e.prototype,"animation",void 0),it([C()],e.prototype,"checkedNodes",void 0),it([C(!0)],e.prototype,"checkDisabledChildren",void 0),it([C("")],e.prototype,"cssClass",void 0),it([C(!1)],e.prototype,"disabled",void 0),it([C(null)],e.prototype,"dragArea",void 0),it([C(!0)],e.prototype,"enableHtmlSanitizer",void 0),it([C(!1)],e.prototype,"enablePersistence",void 0),it([C()],e.prototype,"expandedNodes",void 0),it([C("Auto")],e.prototype,"expandOn",void 0),it([be({},AV)],e.prototype,"fields",void 0),it([C(!0)],e.prototype,"fullRowSelect",void 0),it([C(!0)],e.prototype,"loadOnDemand",void 0),it([C()],e.prototype,"locale",void 0),it([C()],e.prototype,"nodeTemplate",void 0),it([C()],e.prototype,"selectedNodes",void 0),it([C("None")],e.prototype,"sortOrder",void 0),it([C(!1)],e.prototype,"showCheckBox",void 0),it([C(!0)],e.prototype,"autoCheck",void 0),it([C(!1)],e.prototype,"fullRowNavigable",void 0),it([q()],e.prototype,"actionFailure",void 0),it([q()],e.prototype,"created",void 0),it([q()],e.prototype,"dataBound",void 0),it([q()],e.prototype,"dataSourceChanged",void 0),it([q()],e.prototype,"drawNode",void 0),it([q()],e.prototype,"destroyed",void 0),it([q()],e.prototype,"keyPress",void 0),it([q()],e.prototype,"nodeChecked",void 0),it([q()],e.prototype,"nodeChecking",void 0),it([q()],e.prototype,"nodeClicked",void 0),it([q()],e.prototype,"nodeCollapsed",void 0),it([q()],e.prototype,"nodeCollapsing",void 0),it([q()],e.prototype,"nodeDragging",void 0),it([q()],e.prototype,"nodeDragStart",void 0),it([q()],e.prototype,"nodeDragStop",void 0),it([q()],e.prototype,"nodeDropped",void 0),it([q()],e.prototype,"nodeEdited",void 0),it([q()],e.prototype,"nodeEditing",void 0),it([q()],e.prototype,"nodeExpanded",void 0),it([q()],e.prototype,"nodeExpanding",void 0),it([q()],e.prototype,"nodeSelected",void 0),it([q()],e.prototype,"nodeSelecting",void 0),e=t=it([bt],e),e}(Kt);var _p=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ci=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},ws="e-toast",Dc="e-toast-container",XL="e-toast-title",$L="e-toast-full-width",KL="e-toast-content",tm="e-toast-message",LV="e-toast-icon",im="e-toast-progress",kV="e-toast-actions",Sw="e-toast-close-icon",Cw="e-rtl",NV="e-blazor-toast-hidden",FV=function(o){_p(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ci([C("Left")],e.prototype,"X",void 0),ci([C("Top")],e.prototype,"Y",void 0),e}(Re),OV=function(o){_p(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ci([C(null)],e.prototype,"model",void 0),ci([C(null)],e.prototype,"click",void 0),e}(Re),ZL=function(o){_p(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ci([C("FadeIn")],e.prototype,"effect",void 0),ci([C(600)],e.prototype,"duration",void 0),ci([C("ease")],e.prototype,"easing",void 0),e}(Re),RV=function(o){_p(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ci([be({effect:"FadeIn",duration:600,easing:"ease"},ZL)],e.prototype,"show",void 0),ci([be({effect:"FadeOut",duration:600,easing:"ease"},ZL)],e.prototype,"hide",void 0),e}(Re),PV=function(o){_p(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.toastCollection=[],r.needsID=!0,r}return e.prototype.getModuleName=function(){return"toast"},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.destroy=function(){this.hide("All"),this.element.classList.remove(Dc),Ye(this.element,{position:"","z-index":""}),!g(this.refElement)&&!g(this.refElement.parentElement)&&(this.refElement.parentElement.insertBefore(this.element,this.refElement),ee(this.refElement),this.refElement=void 0),this.isBlazorServer()||o.prototype.destroy.call(this)},e.prototype.preRender=function(){this.isDevice=B.isDevice,this.width==="300px"&&(this.width=this.isDevice&&screen.width<768?"100%":"300px"),g(this.target)&&(this.target=document.body),this.enableRtl&&!this.isBlazorServer()&&this.element.classList.add(Cw)},e.prototype.render=function(){this.progressObj=[],this.intervalId=[],this.contentTemplate=null,this.toastTemplate=null,this.renderComplete(),this.initRenderClass=this.element.className},e.prototype.show=function(t){var i;if(g(t)||(this.templateChanges(t),i=JSON.parse(JSON.stringify(t)),he(this,this,t)),g(this.toastContainer)){this.toastContainer=this.getContainer();var r=typeof this.target=="string"?document.querySelector(this.target):typeof this.target=="object"?this.target:document.body;if(g(r))return;r.tagName==="BODY"?this.toastContainer.style.position="fixed":(this.toastContainer.style.position="absolute",r.style.position="relative"),this.setPositioning(this.position),r.appendChild(this.toastContainer)}if(this.isBlazorServer()&&this.element.classList.contains("e-control")){this.isToastModel(t);return}this.toastEle=this.createElement("div",{className:ws,id:kt("toast")}),this.setWidthHeight(),this.setCSSClass(this.cssClass),g(this.template)||this.template===""?this.personalizeToast():this.templateRendering(),this.setProgress(),this.setCloseButton(),this.setAria(),this.appendToTarget(t),this.isDevice&&screen.width<768&&new Fr(this.toastEle,{swipe:this.swipeHandler.bind(this)}),g(i)||(he(i,{element:[this.toastEle]},!0),this.toastCollection.push(i)),this.isReact&&this.renderReactTemplates()},e.prototype.showToast=function(t,i){this.toastEle=this.element.querySelector("#"+t),this.show(i)},e.prototype.isToastModel=function(t){this.toastContainer=this.element,this.setPositioning(this.position);var i=this;g(i.element.lastElementChild)||this.setProgress(),this.setAria(),this.appendToTarget(t)},e.prototype.swipeHandler=function(t){var i=j(t.originalEvent.target,"."+ws+":not(."+Dc+")"),r=this.animation.hide.effect;g(i)||(t.swipeDirection==="Right"?(this.animation.hide.effect="SlideRightOut",this.hideToast("swipe",i)):t.swipeDirection==="Left"&&(this.animation.hide.effect="SlideLeftOut",this.hideToast("swipe",i)),this.animation.hide.effect=r)},e.prototype.templateChanges=function(t){!Ee(t.content)&&!g(this.contentTemplate)&&this.content!==t.content&&this.clearContentTemplate(),!Ee(t.template)&&!g(this.toastTemplate)&&this.template!==t.template&&this.clearToastTemplate()},e.prototype.setCSSClass=function(t){if(t){var i=t.indexOf(",")!==-1?",":" ";wi(this.toastEle,t.split(i),[]),this.toastContainer&&wi(this.toastContainer,t.split(i),[])}},e.prototype.setWidthHeight=function(){this.width==="300px"?this.toastEle.style.width=Le(this.width):this.width==="100%"?this.toastContainer.classList.add($L):(this.toastEle.style.width=Le(this.width),this.toastContainer.classList.remove($L)),this.toastEle.style.height=Le(this.height)},e.prototype.templateRendering=function(){this.fetchEle(this.toastEle,this.template,"template")},e.prototype.sanitizeHelper=function(t){if(this.enableHtmlSanitizer){var i=Bt.beforeSanitize(),r={cancel:!1,helper:null};he(i,i,r),this.trigger("beforeSanitizeHtml",i),i.cancel&&!g(i.helper)?t=i.helper(t):i.cancel||(t=Bt.serializeValue(i,t))}return t},e.prototype.hide=function(t){this.hideToast("",t)},e.prototype.hideToast=function(t,i){if(!(g(this.toastContainer)||this.toastContainer.childElementCount===0)){if(typeof i=="string"&&i==="All"){for(var r=0;r<this.toastContainer.childElementCount;r++)this.destroyToast(this.toastContainer.children[r],t);return}g(i)&&(i=this.newestOnTop?this.toastContainer.lastElementChild:this.toastContainer.firstElementChild),this.destroyToast(i,t)}},e.prototype.fetchEle=function(t,i,r){i=typeof i=="string"?this.sanitizeHelper(i):i;var n,s,a,l;if(t.classList.contains(XL)?l=this.element.id+"title":t.classList.contains(KL)?l=this.element.id+"content":l=this.element.id+"template",r==="content"?s=this.contentTemplate:s=this.toastTemplate,!g(s))return t.appendChild(s.cloneNode(!0)),t;try{if(typeof i!="function"&&document.querySelectorAll(i).length>0){var h=null;r!=="title"&&(h=document.querySelector(i),t.appendChild(h),h.style.display="");var u=g(h)?s:h.cloneNode(!0);r==="content"?this.contentTemplate=u:this.toastTemplate=u}else n=wt(i)}catch{n=typeof i=="object"?wt(i):wt(Ks(function(){return i}))}if(!g(n))if(!this.isBlazorServer())a=n({},this,r,null,!0);else{var c=!0;a=n({},this,r,l,c)}return!g(a)&&a.length>0&&!(g(a[0].tagName)&&a.length===1)?[].slice.call(a).forEach(function(d){g(d.tagName)||(d.style.display=""),t.appendChild(d)}):typeof i!="function"&&t.childElementCount===0&&(t.innerHTML=i),t},e.prototype.clearProgress=function(t){g(this.intervalId[t])||(clearInterval(this.intervalId[t]),delete this.intervalId[t]),g(this.progressObj[t])||(clearInterval(this.progressObj[t].intervalId),delete this.progressObj[t])},e.prototype.removeToastContainer=function(t){t&&this.toastContainer.classList.contains("e-toast-util")&&ee(this.toastContainer)},e.prototype.clearContainerPos=function(t){var i=this;if(this.isBlazorServer()){this.toastContainer=null;return}this.customPosition?(Ye(this.toastContainer,{left:"",top:""}),this.removeToastContainer(t),this.toastContainer=null,this.customPosition=!1):([ws+"-top-left",ws+"-top-right",ws+"-bottom-left",ws+"-bottom-right",ws+"-bottom-center",ws+"-top-center",ws+"-full-width"].forEach(function(r){!g(i.toastContainer)&&i.toastContainer.classList.contains(r)&&i.toastContainer.classList.remove(r)}),this.removeToastContainer(t),this.toastContainer=null),g(this.contentTemplate)||this.clearContentTemplate(),g(this.toastTemplate)||this.clearToastTemplate()},e.prototype.clearContentTemplate=function(){this.contentTemplate.style.display="none",document.body.appendChild(this.contentTemplate),this.contentTemplate=null},e.prototype.clearToastTemplate=function(){this.toastTemplate.style.display="none",document.body.appendChild(this.toastTemplate),this.toastTemplate=null},e.prototype.isBlazorServer=function(){return qe()&&this.isServerRendered},e.prototype.destroyToast=function(t,i){for(var r=this,n,s=0;s<this.toastCollection.length;s++)this.toastCollection[s].element[0]===t&&(n=this.toastCollection[s],this.toastCollection.splice(s,1));var a={options:this,cancel:!1,type:i,element:t,toastContainer:this.toastContainer},l=this.animation.hide,h={duration:l.duration,name:l.effect==="None"&&Ut==="Enable"?"FadeOut":l.effect,timingFunction:l.easing},u=parseInt(t.id.split("toast_")[1],10),c=this.isBlazorServer()?{options:n,toastContainer:this.toastContainer}:{options:n,toastContainer:this.toastContainer,toastObj:this};this.trigger("beforeClose",a,function(d){d.cancel||(!g(r.progressObj[u])&&!g(t.querySelector("."+im))&&(r.progressObj[u].progressEle.style.width="0%"),h.end=function(){r.clearProgress(u),(!r.isBlazorServer()||g(n))&&ee(t),r.trigger("close",c),r.toastContainer.childElementCount===0&&r.clearContainerPos(!0),l=null,h=null},new It(h).animate(t))})},e.prototype.personalizeToast=function(){this.setIcon(),this.setTitle(),this.setContent(),this.actionButtons()},e.prototype.setAria=function(){Ie(this.toastEle,{role:"alert"})},e.prototype.setPositioning=function(t){this.isBlazorServer()||(!isNaN(parseFloat(t.X))||!isNaN(parseFloat(t.Y))?(this.customPosition=!0,Ye(this.toastContainer,{left:Le(t.X),top:Le(t.Y)})):this.toastContainer.classList.add(ws+"-"+t.Y.toString().toLowerCase()+"-"+t.X.toString().toLowerCase()))},e.prototype.setCloseButton=function(){if(this.showCloseButton){var t={close:"Close"};this.l10n=new Li("toast",t,this.locale),this.l10n.setLocale(this.locale);var i=this.l10n.getConstant("close"),r=this.createElement("div",{className:Sw+" e-icons ",attrs:{tabindex:"0","aria-label":i,role:"button"}});this.toastEle.classList.add("e-toast-header-close-icon"),this.toastEle.appendChild(r)}},e.prototype.setProgress=function(){if(this.timeOut>0){var t=parseInt(this.toastEle.id.split("toast_")[1],10);this.intervalId[t]=window.setTimeout(this.destroyToast.bind(this,this.toastEle),this.timeOut),this.progressObj[t]={hideEta:null,intervalId:null,maxHideTime:null,element:null,timeOutId:null,progressEle:null},this.progressObj[t].maxHideTime=parseFloat(this.timeOut+""),this.progressObj[t].hideEta=new Date().getTime()+this.progressObj[t].maxHideTime,this.progressObj[t].element=this.toastEle,this.extendedTimeout>0&&(E.add(this.toastEle,"mouseover",this.toastHoverAction.bind(this,t)),E.add(this.toastEle,"mouseleave",this.delayedToastProgress.bind(this,t)),this.progressObj[t].timeOutId=this.intervalId[t]),this.showProgressBar&&(this.progressBarEle=this.createElement("div",{className:im}),this.toastEle.insertBefore(this.progressBarEle,this.toastEle.children[0]),this.progressObj[t].intervalId=setInterval(this.updateProgressBar.bind(this,this.progressObj[t]),10),this.progressObj[t].progressEle=this.progressBarEle)}},e.prototype.toastHoverAction=function(t){clearTimeout(this.progressObj[t].timeOutId),clearInterval(this.progressObj[t].intervalId),this.progressObj[t].hideEta=0;var i=this.progressObj[t].element;g(i.querySelector("."+im))||(this.progressObj[t].progressEle.style.width="0%")},e.prototype.delayedToastProgress=function(t){var i=this.progressObj[t];if(!g(i)){var r=i.element;i.timeOutId=window.setTimeout(this.destroyToast.bind(this,r),this.extendedTimeout),i.maxHideTime=parseFloat(this.extendedTimeout+""),i.hideEta=new Date().getTime()+i.maxHideTime,g(r.querySelector("."+im))||(i.intervalId=setInterval(this.updateProgressBar.bind(this,i),10))}},e.prototype.updateProgressBar=function(t){var i=(t.hideEta-new Date().getTime())/t.maxHideTime*100;i=this.progressDirection==="Ltr"?100-i:i,t.progressEle.style.width=i+"%"},e.prototype.setIcon=function(){if(!(g(this.icon)||this.icon.length===0)){var t=this.createElement("div",{className:LV+" e-icons "+this.icon});this.toastEle.classList.add("e-toast-header-icon"),this.toastEle.appendChild(t)}},e.prototype.setTitle=function(){if(!g(this.title)){var t=this.createElement("div",{className:XL});t=this.fetchEle(t,this.title,"title");var i=this.createElement("div",{className:tm});i.appendChild(t),this.toastEle.appendChild(i)}},e.prototype.setContent=function(){var t=this.createElement("div",{className:KL}),i=this.element;if(g(this.content)||this.content===""){var r=this.element.innerHTML.replace(/\s/g,"")!=="";if((i.children.length>0||r)&&!(i.firstElementChild&&i.firstElementChild.classList.contains(ws))){this.innerEle=document.createDocumentFragment();for(var n=this.createElement("div");i.childNodes.length!==0;)this.innerEle.appendChild(this.element.childNodes[0]);t.appendChild(this.innerEle),[].slice.call(t.children).forEach(function(s){n.appendChild(s.cloneNode(!0))}),this.content=n,this.appendMessageContainer(t)}}else typeof this.content=="object"&&!g(this.content.tagName)?(t.appendChild(this.content),this.content=this.content.cloneNode(!0),this.appendMessageContainer(t)):(t=this.fetchEle(t,this.content,"content"),this.appendMessageContainer(t))},e.prototype.appendMessageContainer=function(t){if(this.toastEle.querySelectorAll("."+tm).length>0)this.toastEle.querySelector("."+tm).appendChild(t);else{var i=this.createElement("div",{className:tm});i.appendChild(t),this.toastEle.appendChild(i)}},e.prototype.actionButtons=function(){var t=this,i=this.createElement("div",{className:kV});[].slice.call(this.buttons).forEach(function(r){if(!g(r.model)){var n=t.createElement("button");n.setAttribute("type","button"),(g(r.model.cssClass)||r.model.cssClass.length===0)&&(r.model.cssClass="e-primary "+t.cssClass),n.classList.add("e-small"),new bn(r.model,n),!g(r.click)&&typeof r.click=="function"&&E.add(n,"click",r.click),i.appendChild(n)}}),i.childElementCount>0&&this.appendMessageContainer(i)},e.prototype.appendToTarget=function(t){var i=this,r=this.isBlazorServer()?{options:t,element:this.toastEle,cancel:!1}:{options:t,toastObj:this,element:this.toastEle,cancel:!1};this.trigger("beforeOpen",r,function(n){if(!n.cancel)i.isBlazorServer()||(i.toastEle.style.display="none"),i.newestOnTop&&i.toastContainer.childElementCount!==0?i.toastContainer.insertBefore(i.toastEle,i.toastContainer.children[0]):i.isBlazorServer()||i.toastContainer.appendChild(i.toastEle),K([i.toastEle],NV),E.add(i.toastEle,"click",i.clickHandler,i),E.add(i.toastEle,"keydown",i.keyDownHandler,i),i.toastContainer.style.zIndex=Fs(i.toastContainer)+"",i.displayToast(i.toastEle,t);else if(i.isBlazorServer()){var s=parseInt(i.toastEle.id.split("toast_")[1],10);i.clearProgress(s),ee(i.toastEle),i.toastContainer.childElementCount===0&&i.clearContainerPos()}})},e.prototype.clickHandler=function(t){var i=this;this.isBlazorServer()||t.stopPropagation();var r=t.target,n=j(r,"."+ws),s=this.isBlazorServer()?{element:n,cancel:!1,clickToClose:!1,originalEvent:t}:{element:n,cancel:!1,clickToClose:!1,originalEvent:t,toastObj:this},a=r.classList.contains(Sw);this.trigger("click",s,function(l){(a&&!l.cancel||l.clickToClose)&&i.destroyToast(n,"click")})},e.prototype.keyDownHandler=function(t){if(t.target.classList.contains(Sw)&&(t.keyCode===13||t.keyCode===32)){var i=t.target,r=j(i,"."+ws);this.destroyToast(r,"key")}},e.prototype.displayToast=function(t,i){var r=this,n=this.animation.show,s={duration:n.duration,name:n.effect==="None"&&Ut==="Enable"?"FadeIn":n.effect,timingFunction:n.easing},a=this.isBlazorServer()?{options:i,element:this.toastEle}:{options:i,toastObj:this,element:this.toastEle};s.begin=function(){t.style.display=""},s.end=function(){r.trigger("open",a)},new It(s).animate(t)},e.prototype.getContainer=function(){return this.element.classList.add(Dc),this.element},e.prototype.onPropertyChanged=function(t,i){for(var r=this.element,n=0,s=Object.keys(t);n<s.length;n++){var a=s[n];switch(a){case"enableRtl":t.enableRtl?r.classList.add(Cw):r.classList.remove(Cw);break}}},ci([C("300px")],e.prototype,"width",void 0),ci([C("auto")],e.prototype,"height",void 0),ci([C(null)],e.prototype,"title",void 0),ci([C(null)],e.prototype,"content",void 0),ci([C(!0)],e.prototype,"enableHtmlSanitizer",void 0),ci([C(null)],e.prototype,"icon",void 0),ci([C(null)],e.prototype,"cssClass",void 0),ci([C(null)],e.prototype,"template",void 0),ci([C(!0)],e.prototype,"newestOnTop",void 0),ci([C(!1)],e.prototype,"showCloseButton",void 0),ci([C(!1)],e.prototype,"showProgressBar",void 0),ci([C(5e3)],e.prototype,"timeOut",void 0),ci([C("Rtl")],e.prototype,"progressDirection",void 0),ci([C(1e3)],e.prototype,"extendedTimeout",void 0),ci([be({},RV)],e.prototype,"animation",void 0),ci([be({},FV)],e.prototype,"position",void 0),ci([Wt([{}],OV)],e.prototype,"buttons",void 0),ci([C(null)],e.prototype,"target",void 0),ci([q()],e.prototype,"created",void 0),ci([q()],e.prototype,"beforeSanitizeHtml",void 0),ci([q()],e.prototype,"destroyed",void 0),ci([q()],e.prototype,"open",void 0),ci([q()],e.prototype,"beforeOpen",void 0),ci([q()],e.prototype,"beforeClose",void 0),ci([q()],e.prototype,"close",void 0),ci([q()],e.prototype,"click",void 0),e=ci([bt],e),e}(Kt),JL;(function(o){function e(t,i,r){var n;document.querySelector("."+Dc)?n=document.querySelector("."+Dc):(n=Xe("div",{className:ws+" "+Dc+" e-toast-util"}),document.body.appendChild(n));var s;if(typeof t=="string"){var a=void 0,l=void 0;if(g(i))a="",l="";else switch(i){case"Warning":a="e-toast-warning",l="e-toast-warning-icon";break;case"Success":a="e-toast-success",l="e-toast-success-icon";break;case"Error":a="e-toast-danger",l="e-toast-error-icon";break;case"Information":a="e-toast-info",l="e-toast-info-icon";break}s={content:t,cssClass:a,icon:l,timeOut:g(r)?5e3:r}}else s=t;var h=new PV(s);return h.appendTo(n),h.show(),h}o.show=e})(JL||(JL={}));var BV=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Vl=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},ww={TEXTSHAPE:"e-skeleton-text",CIRCLESHAPE:"e-skeleton-circle",SQUARESHAPE:"e-skeleton-square",RECTANGLESHAPE:"e-skeleton-rectangle",WAVEEFFECT:"e-shimmer-wave",PULSEEFFECT:"e-shimmer-pulse",FADEEFFECT:"e-shimmer-fade",VISIBLENONE:"e-visible-none"};var ek=function(o){BV(e,o);function e(t,i){return o.call(this,t,i)||this}return e.prototype.getModuleName=function(){return"skeleton"},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.preRender=function(){this.element.id||(this.element.id=kt("e-"+this.getModuleName())),this.updateCssClass(),Ie(this.element,{role:"alert","aria-busy":"true","aria-live":"polite","aria-label":this.label})},e.prototype.render=function(){this.initialize()},e.prototype.onPropertyChanged=function(t,i){for(var r=0,n=Object.keys(t);r<n.length;r++){var s=n[r];switch(s){case"width":case"height":this.updateDimension();break;case"shape":this.updateShape();break;case"shimmerEffect":this.updateEffect();break;case"visible":this.updateVisibility();break;case"label":this.element.setAttribute("aria-label",this.label);break;case"cssClass":i.cssClass&&K([this.element],i.cssClass.split(" ")),this.updateCssClass();break}}},e.prototype.destroy=function(){o.prototype.destroy.call(this);var t=["role","aria-live","aria-busy","aria-label"],i=[];this.cssClass&&(i=i.concat(this.cssClass.split(" ")));for(var r=0;r<t.length;r++)this.element.removeAttribute(t[parseInt(r.toString(),10)]);i=i.concat(this.element.classList.value.match(/(e-skeleton-[^\s]+)/g)||[]),i=i.concat(this.element.classList.value.match(/(e-shimmer-[^\s]+)/g)||[]),K([this.element],i)},e.prototype.initialize=function(){this.updateShape(),this.updateEffect(),this.updateVisibility()},e.prototype.updateShape=function(){if(!g(this.shape)){var t=ww[this.shape.toUpperCase()+"SHAPE"],i=this.element.classList.value.match(/(e-skeleton-[^\s]+)/g)||[];this.updateDimension(),i&&K([this.element],i),Y([this.element],[t])}},e.prototype.updateDimension=function(){var t=!this.width&&["Text","Rectangle"].indexOf(this.shape)>-1?"100%":Le(this.width),i=["Circle","Square"].indexOf(this.shape)>-1?t:Le(this.height);this.element.style.width=t,this.element.style.height=i},e.prototype.updateEffect=function(){var t=this.element.classList.value.match(/(e-shimmer-[^\s]+)/g)||[];t&&K([this.element],t),g(this.shimmerEffect)||Y([this.element],[ww[this.shimmerEffect.toUpperCase()+"EFFECT"]])},e.prototype.updateVisibility=function(){this.element.classList[this.visible?"remove":"add"](ww.VISIBLENONE)},e.prototype.updateCssClass=function(){this.cssClass&&Y([this.element],this.cssClass.split(" "))},Vl([C("")],e.prototype,"width",void 0),Vl([C("")],e.prototype,"height",void 0),Vl([C(!0)],e.prototype,"visible",void 0),Vl([C("Text")],e.prototype,"shape",void 0),Vl([C("Wave")],e.prototype,"shimmerEffect",void 0),Vl([C("Loading...")],e.prototype,"label",void 0),Vl([C("")],e.prototype,"cssClass",void 0),e=Vl([bt],e),e}(Kt);var xs="",lm="",Up="",ln=[],zV="e-active",hm="";function Wp(o,e,t,i,r,n,s,a,l){!n||xs===""?Up!==""?(xs=Up+String.fromCharCode(o),Up=""):xs+=String.fromCharCode(o):xs===lm&&(Up=String.fromCharCode(o)),a?(setTimeout(function(){Up=""},700),setTimeout(function(){xs=""},3e3)):setTimeout(function(){xs=""},1e3);var h;if(xs=i?xs.toLowerCase():xs,hm===r&&lm===xs&&!l){for(var u=0;u<ln.length;u++){if(ln[u].classList.contains(zV)){h=u;break}if(s&&ln[u].textContent.toLowerCase()===s.toLowerCase()){h=u;break}}return h=h+1,a?ln[h]&&ln.length-1!==h?ln[h]:ln[ln.length]:ln[h]?ln[h]:ln[0]}else{var c=e,d=xs.length,p=void 0,f=void 0;t=t?t+1:0;var u=t;ln=[];do u===c.length&&(u=-1),u===-1?h=0:h=u,f=c[h],p=i?f.innerText.toLowerCase():f.innerText,p.substr(0,d)===xs&&ln.push(c[h]),u++;while(u!==t);if(lm=xs,hm=r,a){for(var v=!1,m=0;m<ln.length;m++)if(s&&ln[m].textContent.toLowerCase()===s.toLowerCase()){h=m,v=!0;break}return s&&v&&(h=h+1),ln[h]?ln[h]:ln[0]}return ln[0]}}function aa(o,e,t,i,r,n,s,a){var l=e;i=i??!0;var h={item:null,index:null};if(o&&o.length){var u=o.length,c=i?o.toLocaleLowerCase():o;c=jV(c);for(var d=function(m,y){var S=y[m],b;if(e&&r){var w=S,I=n.text.split(".");r.filter(function(M){Array.prototype.slice.call(I).forEach(function(D){(s==="object"&&!M.isHeader&&w.textContent.toString().indexOf(M[D])!==-1&&w.getAttribute("data-value")===M[n.value].toString()||s==="string"&&w.textContent.toString().indexOf(M)!==-1)&&(b=s==="object"?M[D]:M)})})}var x=r&&b?(i?b.toString().toLocaleLowerCase():b).replace(/^\s+|\s+$/g,""):(i?S.textContent.toLocaleLowerCase():S.textContent).replace(/^\s+|\s+$/g,"");if(a&&x&&c&&(x=x.normalize("NFD").replace(/[\u0300-\u036f]/g,""),c=c.normalize("NFD").replace(/[\u0300-\u036f]/g,"")),t==="Equal"&&x===c||t==="StartsWith"&&x.substr(0,u)===c||t==="EndsWith"&&x.substr(x.length-c.length)===c||t==="Contains"&&new RegExp(c,"g").test(x))return h.item=S,h.index=m,{value:{item:S,index:m}}},p=0,f=l;p<f.length;p++){var v=d(p,f);if(typeof v=="object")return v.value}return h}return h}function jV(o){return o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function HV(o){hm===o&&(hm="",lm="",xs="",ln=[])}function rm(o,e,t,i){var r=/<[^>]*>/g.test(o.innerText);if(r&&(o.innerText=o.innerText.replace(/[\u00A0-\u9999<>&]/g,function(a){return"&#"+a.charCodeAt(0)+";"})),e!==""){var n=t?"gim":"gm";e=/^[a-zA-Z0-9- ]*$/.test(e)?e:e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var s=i==="StartsWith"?"^("+e+")":i==="EndsWith"?"("+e+")$":"("+e+")";mk(o,new RegExp(s,n))}}function mk(o,e){for(var t=0;o.childNodes&&t<o.childNodes.length;t++)if(o.childNodes[t].nodeType===3&&o.childNodes[t].textContent.trim()!==""){var i=o.childNodes[t].nodeValue.trim().replace(e,'<span class="e-highlight">$1</span>');o.childNodes[t].nodeValue="",o.innerHTML=o.innerHTML.trim()+i;break}else mk(o.childNodes[t],e)}function VV(o){for(var e=o.querySelectorAll(".e-highlight"),t=e.length-1;t>=0;t--){var i=e[t].parentNode,r=document.createTextNode(e[t].textContent);i.replaceChild(r,e[t])}}var yk=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),er=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Aw=function(o){yk(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return er([C()],e.prototype,"text",void 0),er([C()],e.prototype,"value",void 0),er([C()],e.prototype,"iconCss",void 0),er([C()],e.prototype,"groupBy",void 0),er([C()],e.prototype,"htmlAttributes",void 0),er([C()],e.prototype,"disabled",void 0),e}(Re),le={root:"e-dropdownbase",rtl:"e-rtl",content:"e-content",selected:"e-active",hover:"e-hover",noData:"e-nodata",fixedHead:"e-fixed-head",focus:"e-item-focus",li:"e-list-item",group:"e-list-group-item",disabled:"e-disabled",grouping:"e-dd-group",virtualList:"e-list-item e-virtual-list"},_V="ItemTemplate",UV="DisplayTemplate",WV="SpinnerTemplate",qV="ValueTemplate",GV="GroupTemplate",YV="HeaderTemplate",QV="FooterTemplate",XV="NoRecordsTemplate",$V="ActionFailureTemplate",KV="e-hide-group-header",bk=function(o){yk(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.preventChange=!1,r.isPreventChange=!1,r.isDynamicDataChange=!1,r.addedNewItem=!1,r.isAddNewItemTemplate=!1,r.isRequesting=!1,r.isVirtualizationEnabled=!1,r.isCustomDataUpdated=!1,r.isAllowFiltering=!1,r.virtualizedItemsCount=0,r.isCheckBoxSelection=!1,r.totalItemCount=0,r.dataCount=0,r.remoteDataCount=-1,r.isRemoteDataUpdated=!1,r.isIncrementalRequest=!1,r.itemCount=30,r.virtualListHeight=0,r.isVirtualScrolling=!1,r.isPreventScrollAction=!1,r.scrollPreStartIndex=0,r.isScrollActionTriggered=!1,r.previousStartIndex=0,r.isMouseScrollAction=!1,r.isKeyBoardAction=!1,r.isScrollChanged=!1,r.isUpwardScrolling=!1,r.startIndex=0,r.currentPageNumber=0,r.pageCount=0,r.isPreventKeyAction=!1,r.generatedDataObject={},r.skeletonCount=32,r.isVirtualTrackHeight=!1,r.virtualSelectAll=!1,r.incrementalQueryString="",r.incrementalEndIndex=0,r.incrementalStartIndex=0,r.incrementalPreQueryString="",r.isObjectCustomValue=!1,r.appendUncheckList=!1,r.getInitialData=!1,r.preventPopupOpen=!0,r.virtualSelectAllState=!1,r.CurrentEvent=null,r.isDynamicData=!1,r.isPrimitiveData=!1,r.isCustomFiltering=!1,r.virtualListInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:0},r.viewPortInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:0},r.selectedValueInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:0},r}return e.prototype.getPropObject=function(t,i,r){var n=new Object,s=new Object,a=function(h){return h};n[a(t)]=i[a(t)],s[a(t)]=r[a(t)];var l=new Object;return l.newProperty=n,l.oldProperty=s,l},e.prototype.getValueByText=function(t,i,r){var n=null;return g(this.listData)||(i?n=this.checkValueCase(t,!0,r):n=this.checkValueCase(t,!1,r)),n},e.prototype.checkValueCase=function(t,i,r,n){var s=this,a=null;if(n&&(a=t),!g(this.listData)){var l=this.listData,h=this.fields,u=this.typeOfData(l).typeof;if(u==="string"||u==="number"||u==="boolean")for(var c=0,d=l;c<d.length;c++){var p=d[c];g(p)||(r?a=this.checkingAccent(String(p),t,i):i?this.checkIgnoreCase(String(p),t)&&(a=this.getItemValue(String(p),t,i)):this.checkNonIgnoreCase(String(p),t)&&(a=this.getItemValue(String(p),t,i,n)))}else if(i)l.filter(function(v){var m=V(h.value,v);!g(m)&&s.checkIgnoreCase(V(h.text,v).toString(),t)&&(a=V(h.value,v))});else if(n){var f=null;f=a,l.filter(function(v){var m=V(h.value,v);!g(m)&&!g(a)&&m.toString()===f.toString()&&(a=V(h.text,v))})}else l.filter(function(v){s.checkNonIgnoreCase(V(h.text,v),t)&&(a=V(h.value,v))})}return a},e.prototype.checkingAccent=function(t,i,r){var n=de.ignoreDiacritics(String(t)),s=de.ignoreDiacritics(i.toString()),a=null;return r?this.checkIgnoreCase(n,s)&&(a=this.getItemValue(String(t),i,r)):this.checkNonIgnoreCase(String(t),i)&&(a=this.getItemValue(String(t),i,r)),a},e.prototype.checkIgnoreCase=function(t,i){return String(t).toLowerCase()===i.toString().toLowerCase()},e.prototype.checkNonIgnoreCase=function(t,i){return String(t)===i.toString()},e.prototype.getItemValue=function(t,i,r,n){var s=null,a=this.listData,l=this.typeOfData(a).typeof;return n?s=t.toString():r?s=l==="string"?String(t):this.getFormattedValue(String(t)):s=l==="string"?i:this.getFormattedValue(i),s},e.prototype.templateCompiler=function(t){var i=!1;if(typeof t!="function"&&t)try{i=!!Oe(t,document).length}catch{i=!1}return i},e.prototype.l10nUpdate=function(t){var i=this.getModuleName()==="listbox"?this.ulElement:this.list;if(!g(this.noRecordsTemplate)&&this.noRecordsTemplate!=="No records found"||this.actionFailureTemplate!=="Request failed"){var r=t?this.actionFailureTemplate:this.noRecordsTemplate,n=void 0,s=t?this.actionFailureTemplateId:this.noRecordsTemplateId;i.innerHTML="";var a=this.templateCompiler(r);typeof r!="function"&&a?n=wt(X(r,document).innerHTML.trim()):n=wt(r);var l=t?"actionFailureTemplate":"noRecordsTemplate",h=void 0;if(this.isReact&&typeof r=="function"?h=n({},this,l,s,this.isStringTemplate,null):h=n({},this,l,s,this.isStringTemplate,null,i),h&&h.length>0)for(var u=0;u<h.length;u++)if(this.getModuleName()==="listbox"&&l==="noRecordsTemplate")if(h[u].nodeName==="#text"){var c=this.createElement("li");c.textContent=h[u].textContent,c.classList.add("e-list-nrt"),c.setAttribute("role","option"),i.appendChild(c)}else h[u].classList.add("e-list-nr-template"),i.appendChild(h[u]);else(h[u]instanceof HTMLElement||h[u]instanceof Text&&h[u].textContent!=="")&&i.appendChild(h[u]);this.renderReactTemplates()}else{var d={noRecordsTemplate:"No records found",actionFailureTemplate:"Request failed"},p=new Li(this.getLocaleName(),{},this.locale);p.getConstant("actionFailureTemplate")!==""||p.getConstant("noRecordsTemplate")!==""?this.l10n=p:this.l10n=new Li(this.getModuleName()==="listbox"?"listbox":this.getModuleName()==="mention"?"mention":"dropdowns",d,this.locale);var f=t?this.l10n.getConstant("actionFailureTemplate"):this.l10n.getConstant("noRecordsTemplate");if(this.getModuleName()==="listbox"){var c=this.createElement("li");c.textContent=f,i.appendChild(c),c.classList.add("e-list-nrt"),c.setAttribute("role","option")}else g(i)||(i.innerHTML=f)}},e.prototype.checkAndResetCache=function(){this.isVirtualizationEnabled&&(this.generatedDataObject={},this.virtualItemStartIndex=this.virtualItemEndIndex=0,this.viewPortInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:this.itemCount},this.selectedValueInfo=null)},e.prototype.updateIncrementalInfo=function(t,i){this.viewPortInfo.startIndex=t,this.viewPortInfo.endIndex=i,this.updateVirtualItemIndex(),this.isIncrementalRequest=!0,this.resetList(this.dataSource,this.fields,this.query),this.isIncrementalRequest=!1},e.prototype.updateIncrementalView=function(t,i){this.viewPortInfo.startIndex=t,this.viewPortInfo.endIndex=i,this.updateVirtualItemIndex(),this.resetList(this.dataSource,this.fields,this.query),this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+le.li),this.ulElement=this.list.querySelector("ul")},e.prototype.updateVirtualItemIndex=function(){this.virtualItemStartIndex=this.viewPortInfo.startIndex,this.virtualItemEndIndex=this.viewPortInfo.endIndex,this.virtualListInfo=this.viewPortInfo},e.prototype.getFilteringSkeletonCount=function(){var t=this.skeletonCount;this.getSkeletonCount(!0),this.skeletonCount=this.dataCount<this.itemCount*2&&(!(this.dataSource instanceof re)||this.dataSource instanceof re&&this.totalItemCount<=this.itemCount)?0:this.skeletonCount;var i=!0;if((this.getModuleName()==="autocomplete"||this.getModuleName()==="multiselect")&&this.totalItemCount<this.itemCount*2&&(!(this.dataSource instanceof re)||this.dataSource instanceof re&&this.totalItemCount<=this.itemCount)&&(this.skeletonCount=0,i=!1),!this.list.classList.contains(le.noData)){if(t!==this.skeletonCount&&i?this.UpdateSkeleton(!0,Math.abs(t-this.skeletonCount)):this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll(".e-list-item"),this.list.getElementsByClassName("e-virtual-ddl").length>0)this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight();else if(!this.list.querySelector(".e-virtual-ddl")&&this.skeletonCount>0&&this.list.querySelector(".e-dropdownbase")){var r=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl",styles:this.GetVirtualTrackHeight()});this.list.querySelector(".e-dropdownbase").appendChild(r)}this.list.getElementsByClassName("e-virtual-ddl-content").length>0&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues())}},e.prototype.getSkeletonCount=function(t){this.virtualListHeight=this.listContainerHeight!=null?parseInt(this.listContainerHeight,10):this.virtualListHeight;var i=this.virtualListHeight>0&&this.listItemHeight>0?Math.floor(this.virtualListHeight/this.listItemHeight):0;this.skeletonCount=i*4<this.itemCount?this.itemCount:i*4,this.itemCount=t?this.itemCount:this.skeletonCount,this.virtualItemCount=this.itemCount,this.skeletonCount=Math.floor(this.skeletonCount/2)},e.prototype.GetVirtualTrackHeight=function(){var t=this.totalItemCount===this.viewPortInfo.endIndex?this.totalItemCount*this.listItemHeight-this.itemCount*this.listItemHeight:this.totalItemCount*this.listItemHeight;t=this.isVirtualTrackHeight?0:t;var i="height: "+(t-this.itemCount*this.listItemHeight)+"px;";return(this.getModuleName()==="autocomplete"||this.getModuleName()==="multiselect")&&this.skeletonCount===0?"height: 0px;":i},e.prototype.getTransformValues=function(){var t=this.viewPortInfo.startIndex*this.listItemHeight;t=t-this.skeletonCount*this.listItemHeight,t=this.viewPortInfo.startIndex===0&&this.listData&&this.listData.length===0||this.skeletonCount===0?0:t;var i="transform: translate(0px, "+t+"px);";return i},e.prototype.UpdateSkeleton=function(t,i){var r=this.list.querySelector(".e-virtual-ddl-content"),n=this.list.querySelector(".e-virtual-list");if(r&&(!n||t)&&this.isVirtualizationEnabled)for(var s=t?i:this.skeletonCount,a=0;a<s;a++){var l=this.createElement("li",{className:le.virtualList,styles:"overflow: inherit"});this.isVirtualizationEnabled&&this.itemTemplate&&(l.style.height=this.listItemHeight-parseInt(window.getComputedStyle(this.getItems()[1]).marginBottom,10)+"px");var h=new ek({shape:"Text",height:"10px",width:"95%",cssClass:"e-skeleton-text"});h.appendTo(this.createElement("div")),l.appendChild(h.element),r.firstChild&&r.firstChild.insertBefore(l,r.firstChild.children[0])}},e.prototype.getLocaleName=function(){return"drop-down-base"},e.prototype.getTextByValue=function(t){var i=this.checkValueCase(t,!1,!1,!0);return i},e.prototype.getFormattedValue=function(t){if(this.listData&&this.listData.length){var i=void 0;if(this.properties.allowCustomValue&&this.properties.value&&this.properties.value instanceof Array&&this.properties.value.length>0?i=this.typeOfData(this.properties.value):i=this.typeOfData(this.listData),typeof V(this.fields.value?this.fields.value:"value",i.item)=="number"||i.typeof==="number")return parseFloat(t);if(typeof V(this.fields.value?this.fields.value:"value",i.item)=="boolean"||i.typeof==="boolean")return t==="true"||""+t=="true"}return t},e.prototype.setEnableRtl=function(){g(this.enableRtlElements)||(this.list&&this.enableRtlElements.push(this.list),this.enableRtl?Y(this.enableRtlElements,le.rtl):K(this.enableRtlElements,le.rtl))},e.prototype.initialize=function(t){if(this.bindEvent=!0,this.preventPopupOpen=!0,this.actionFailureTemplateId=""+this.element.id+$V,this.element.tagName==="UL"){var i=At.createJsonFromElement(this.element);this.setProperties({fields:{text:"text",value:"text"}},!0),this.resetList(i,this.fields)}else if(this.element.tagName==="SELECT"){var r=this.dataSource instanceof Array?this.dataSource.length>0:!g(this.dataSource);r?this.isDynamicDataChange&&this.setListData(this.dataSource,this.fields,this.query):this.renderItemsBySelect()}else this.setListData(this.dataSource,this.fields,this.query,t)},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.updateDataAttribute=function(t){for(var i=["class","style","id","type","aria-expanded","aria-autocomplete","aria-readonly"],r={},n=0;n<this.element.attributes.length;n++)i.indexOf(this.element.attributes[n].name)===-1&&!(this.getModuleName()==="dropdownlist"&&this.element.attributes[n].name==="readonly")&&(r[this.element.attributes[n].name]=this.element.getAttribute(this.element.attributes[n].name));he(r,t,r),this.setProperties({htmlAttributes:r},!0)},e.prototype.renderItemsBySelect=function(){var t=this.element,i=t.querySelectorAll("select>optgroup"),r,n=this.getModuleName()==="multiselect"&&this.isGroupChecking&&i.length>0;r=n?{value:"value",text:"text",groupBy:"categeory"}:r={value:"value",text:"text"};var s=[],a=t.querySelectorAll("select>option");if(this.getJSONfromOption(s,a,r),i.length){for(var l=0;l<i.length;l++){var h=i[l],u={};u[r.text]=h.label,u.isHeader=!0;var c=h.querySelectorAll("option");n?this.getJSONfromOption(s,c,r,h.label):(s.push(u),this.getJSONfromOption(s,c,r))}t.querySelectorAll("select>option")}this.updateFields(r.text,r.value,n?r.groupBy:this.fields.groupBy,this.fields.htmlAttributes,this.fields.iconCss,this.fields.disabled),this.resetList(s,r)},e.prototype.updateFields=function(t,i,r,n,s,a){var l={fields:{text:t,value:i,groupBy:g(r)?this.fields&&this.fields.groupBy:r,htmlAttributes:g(n)?this.fields&&this.fields.htmlAttributes:n,iconCss:g(s)?this.fields&&this.fields.iconCss:s,disabled:g(a)?this.fields&&this.fields.disabled:a}};this.setProperties(l,!0)},e.prototype.getJSONfromOption=function(t,i,r,n){n===void 0&&(n=null);for(var s=0,a=i;s<a.length;s++){var l=a[s],h={};h[r.text]=l.innerText,h[r.value]=g(l.getAttribute(r.value))?l.innerText:l.getAttribute(r.value),g(n)||(h[r.groupBy]=n),t.push(h)}},e.prototype.preRender=function(){this.scrollTimer=-1,this.enableRtlElements=[],this.isRequested=!1,this.isDataFetched=!1,this.itemTemplateId=""+this.element.id+_V,this.displayTemplateId=""+this.element.id+UV,this.spinnerTemplateId=""+this.element.id+WV,this.valueTemplateId=""+this.element.id+qV,this.groupTemplateId=""+this.element.id+GV,this.headerTemplateId=""+this.element.id+YV,this.footerTemplateId=""+this.element.id+QV,this.noRecordsTemplateId=""+this.element.id+XV},e.prototype.setListData=function(t,i,r,n){var s=this;i=i||this.fields;var a;this.isActive=!0;var l={cancel:!1,data:t,query:r};this.isPreventChange=this.isAngular&&this.preventChange?!0:this.isPreventChange,this.isRequesting||this.trigger("actionBegin",l,function(h){if(!h.cancel)if(s.isRequesting=!0,s.showSpinner(),t instanceof re){s.isRequested=!0;var u=!1;if(s.isDataFetched){s.emptyDataRequest(i);return}h.data.executeQuery(s.getQuery(h.query)).then(function(S){s.isPreventChange=s.isAngular&&s.preventChange?!0:s.isPreventChange;var b=!0;if(!s.virtualSelectAll){for(var w=s.getQuery(h.query),I=0;I<w.queries.length;I++)w.queries[I].fn==="onWhere"&&(u=!0);if(s.isVirtualizationEnabled&&S.count!==0&&S.count<s.itemCount*2){if(w)for(var I=0;I<w.queries.length;I++)w.queries[I].fn==="onTake"&&(w.queries[I].e.nos=S.count),s.getModuleName()==="multiselect"&&(w.queries[I].e.condition==="or"||w.queries[I].e.operator==="equal")&&!s.isCustomFiltering&&(b=!1)}else if(s.isVirtualTrackHeight=!1,w)for(var I=0;I<w.queries.length;I++)s.getModuleName()==="multiselect"&&(w.queries[I].e&&w.queries[I].e.condition==="or"||w.queries[I].e&&w.queries[I].e.operator==="equal")&&(b=!1)}b&&(s.dataCount=s.totalItemCount=S.count),s.trigger("actionComplete",S,function(x){if(!x.cancel){s.isRequesting=!1,s.isCustomFiltering=!1;var M=x.result;if(s.isIncrementalRequest){a=s.renderItems(M,i);return}if((!s.isVirtualizationEnabled&&M.length===0||s.isVirtualizationEnabled&&M.length===0&&!u)&&(s.isDataFetched=!0),u||(s.remoteDataCount=x.count),s.dataCount=s.virtualSelectAll?s.dataCount:x.count,s.totalItemCount=s.virtualSelectAll?s.totalItemCount:x.count,a=s.renderItems(M,i),s.appendUncheckList=!1,s.onActionComplete(a,M,x),s.groupTemplate&&s.renderGroupTemplate(a),s.isRequested=!1,s.bindChildItems(M,a,i,x),s.getInitialData){s.getInitialData=!1,s.preventPopupOpen=!1;return}s.isVirtualizationEnabled&&s.setCurrentView&&s.notify("setCurrentViewDataAsync",{module:"VirtualScroll"}),s.keyboardEvent!=null&&s.handleVirtualKeyboardActions(s.keyboardEvent,s.pageCount),s.isVirtualizationEnabled&&(s.getFilteringSkeletonCount(),s.updatePopupPosition()),s.virtualSelectAll&&s.virtualSelectAllData&&(s.virtualSelectionAll(s.virtualSelectAllState,s.liCollections,s.CurrentEvent),s.virtualSelectAllState=!1,s.CurrentEvent=null,s.virtualSelectAll=!1)}})}).catch(function(S){s.isRequested=!1,s.isRequesting=!1,s.onActionFailure(S),s.hideSpinner()})}else{s.isRequesting=!1;var c=!0,d=void 0;if(s.isVirtualizationEnabled&&!s.virtualGroupDataSource&&s.fields.groupBy){var p=new re(s.dataSource).executeLocal(new Pe().group(s.fields.groupBy));s.virtualGroupDataSource=p.records}var f=s.isVirtualizationEnabled&&s.virtualGroupDataSource&&!s.isCustomDataUpdated?new re(s.virtualGroupDataSource):new re(h.data);if(d=s.getQuery(h.query).executeLocal(f),!s.virtualSelectAll){var v=s.getQuery(h.query);if(s.isVirtualizationEnabled&&d.count!==0&&d.count<s.itemCount*2){if(v){for(var m=0;m<v.queries.length;m++)v.queries[m].fn==="onTake"&&(v.queries[m].e.nos=d.count,d=v.executeLocal(f)),s.getModuleName()==="multiselect"&&(v.queries[m].e.condition==="or"||v.queries[m].e.operator==="equal")&&!s.isCustomFiltering&&(c=!1);c&&(d=v.executeLocal(f),s.isVirtualTrackHeight=!(s.dataSource instanceof re)&&!s.isCustomDataUpdated)}}else if(s.isVirtualTrackHeight=!1,v)for(var m=0;m<v.queries.length;m++)s.getModuleName()==="multiselect"&&(v.queries[m].e&&v.queries[m].e.condition==="or"||v.queries[m].e&&v.queries[m].e.operator==="equal")&&(c=!1)}c&&!(s.dataSource instanceof re)&&!s.isCustomDataUpdated&&!s.virtualSelectAll&&(s.dataCount=s.totalItemCount=s.virtualSelectAll?d.length:d.count),d=s.isVirtualizationEnabled?d.result:d;var y={cancel:!1,result:d};s.isPreventChange=s.isAngular&&s.preventChange?!0:s.isPreventChange,s.trigger("actionComplete",y,function(S){if(s.isCustomFiltering=!1,s.isIncrementalRequest){a=s.renderItems(S.result,i);return}if(!S.cancel){if(a=s.renderItems(S.result,i),s.onActionComplete(a,S.result,n),s.groupTemplate&&s.renderGroupTemplate(a),s.bindChildItems(S.result,a,i),s.getInitialData){s.getInitialData=!1,s.preventPopupOpen=!1;return}setTimeout(function(){s.getModuleName()==="multiselect"&&s.itemTemplate!=null&&a.childElementCount>0&&(a.children[0].childElementCount>0||s.fields.groupBy&&a.children[1]&&a.children[1].childElementCount>0)&&s.updateDataList()})}})}})},e.prototype.handleVirtualKeyboardActions=function(t,i){},e.prototype.updatePopupState=function(){},e.prototype.updatePopupPosition=function(){},e.prototype.virtualSelectionAll=function(t,i,r){},e.prototype.updateRemoteData=function(){this.setListData(this.dataSource,this.fields,this.query)},e.prototype.bindChildItems=function(t,i,r,n){var s=this;t.length>=100&&this.getModuleName()==="autocomplete"?setTimeout(function(){var a=s.remainingItems(s.sortedData,r);dt(a,i),s.liCollections=s.list.querySelectorAll("."+le.li),s.updateListValues(),s.raiseDataBound(t,n)},0):this.raiseDataBound(t,n)},e.prototype.isObjectInArray=function(t,i){return i.some(function(r){return Object.keys(t).every(function(n){return Object.prototype.hasOwnProperty.call(r,n)&&r[n]===t[n]})})},e.prototype.updateListValues=function(){},e.prototype.findListElement=function(t,i,r,n){var s=null;if(t){for(var a=[].slice.call(t.querySelectorAll(i)),l=0;l<a.length;l++)if(a[l].getAttribute(r)===n+""){s=a[l];break}}return s},e.prototype.raiseDataBound=function(t,i){this.hideSpinner();var r={items:t,e:i};this.trigger("dataBound",r)},e.prototype.remainingItems=function(t,i){var r=new re(t).executeLocal(new Pe().skip(100));if(this.itemTemplate){var n=this.templateListItem(r,i);return[].slice.call(n.childNodes)}var s=this.typeOfData(r).typeof;return s==="string"||s==="number"||s==="boolean"?At.createListItemFromArray(this.createElement,r,!0,this.listOption(r,i),this):At.createListItemFromJson(this.createElement,r,this.listOption(r,i),1,!0,this)},e.prototype.emptyDataRequest=function(t){var i=[];this.onActionComplete(this.renderItems(i,t),i),this.isRequested=!1,this.isRequesting=!1,this.hideSpinner()},e.prototype.showSpinner=function(){},e.prototype.hideSpinner=function(){},e.prototype.onActionFailure=function(t){this.liCollections=[],this.trigger("actionFailure",t),this.l10nUpdate(!0),g(this.list)||Y([this.list],le.noData)},e.prototype.onActionComplete=function(t,i,r){if(this.listData=i,this.isVirtualizationEnabled&&!this.isCustomDataUpdated&&!this.virtualSelectAll&&this.notify("setGeneratedData",{module:"VirtualScroll"}),this.getModuleName()!=="listbox"&&t.setAttribute("tabindex","0"),this.isReact&&this.clearTemplate(["itemTemplate","groupTemplate","actionFailureTemplate","noRecordsTemplate"]),this.isVirtualizationEnabled||(this.fixedHeaderElement=g(this.fixedHeaderElement)?this.fixedHeaderElement:null),this.getModuleName()==="multiselect"&&this.properties.allowCustomValue&&this.fields.groupBy)for(var n=0;n<t.childElementCount;n++)t.children[n].classList.contains("e-list-group-item")&&(g(t.children[n].innerHTML)||t.children[n].innerHTML==="")&&Y([t.children[n]],KV),t.children[0].classList.contains("e-hide-group-header")&&Ye(t.children[1],{zIndex:11});g(this.list)||this.isVirtualizationEnabled||(this.list.innerHTML="",this.list.appendChild(t),this.liCollections=this.list.querySelectorAll("."+le.li),this.ulElement=this.list.querySelector("ul"),this.postRender(this.list,i,this.bindEvent))},e.prototype.postRender=function(t,i,r){if(this.fields.disabled){for(var n=t.querySelectorAll("."+le.li),s=0;s<n.length;s++)if(JSON.parse(JSON.stringify(this.listData[s]))[this.fields.disabled])if(g(this.fields.groupBy))this.disableListItem(n[s]);else{var a=this.listData[s],l=V(this.fields.value?this.fields.value:"value",a),h=t.querySelector('li[data-value="'+l+'"]');g(h)||this.disableListItem(h)}}var u=this.fields.disabled?t.querySelector("."+le.li+":not(.e-disabled"):t.querySelector("."+le.li),c=t.querySelector("."+le.selected);if(u&&!c){if(this.isVirtualizationEnabled&&this.viewPortInfo.startIndex!==0){var d=this.ulElement.querySelectorAll("li."+le.li+":not(.e-virtual-list):not(.e-hide-listitem)");u=d&&d.length>0?d[2]:u}u&&u.classList.add(le.focus)}i.length<=0?(this.l10nUpdate(),Y([t],le.noData)):t.classList.remove(le.noData)},e.prototype.getQuery=function(t){return t||(this.query?this.query:new Pe)},e.prototype.updateVirtualizationProperties=function(t,i,r){this.isVirtualizationEnabled=!0,this.virtualizedItemsCount=t,this.isAllowFiltering=i,this.isCheckBoxSelection=r},e.prototype.renderGroupTemplate=function(t){if(this.fields.groupBy!==null&&this.dataSource||this.element.querySelector("."+le.group)){var i=this.dataSource,r={groupTemplateID:this.groupTemplateId,isStringTemplate:this.isStringTemplate},n=t.querySelectorAll("."+le.group),s=this.templateCompiler(this.groupTemplate);if(typeof this.groupTemplate!="function"&&s){var a=X(this.groupTemplate,document).innerHTML.trim(),l=At.renderGroupTemplate(a,i,this.fields.properties,n,r,this);if(this.isGroupChecking)for(var h=0;h<l.length;h++)this.notify("addItem",{module:"CheckBoxSelection",item:l[h]})}else{var l=At.renderGroupTemplate(this.groupTemplate,i,this.fields.properties,n,r,this);if(this.isGroupChecking)for(var h=0;h<l.length;h++)this.notify("addItem",{module:"CheckBoxSelection",item:l[h]})}this.renderReactTemplates()}},e.prototype.createListItems=function(t,i){if(t){i.groupBy||this.element.querySelector("optgroup")?(i.groupBy&&(this.sortOrder!=="None"&&(t=this.getSortedDataSource(t)),this.element.querySelector("optgroup")&&this.isGroupChecking&&this.getModuleName()==="multiselect"?t=At.groupDataSource(t,i,this.sortOrder):t=At.groupDataSource(t,i.properties,this.sortOrder)),Y([this.list],le.grouping)):(this.getModuleName()!=="listbox"||this.getModuleName()==="listbox"&&!this.preventDefActionFilter)&&(t=this.getSortedDataSource(t));var r=this.listOption(t,i),n=t.length>100?new re(t).executeLocal(new Pe().take(100)):t;return this.sortedData=t,At.createList(this.createElement,this.getModuleName()==="autocomplete"?n:t,r,!0,this)}return null},e.prototype.listOption=function(t,i){var r=!g(i.iconCss),n=g(i.properties)?i:i.properties,s=i.text!==null||i.value!==null?{fields:n,showIcon:r,ariaAttributes:{groupItemRole:"presentation"}}:{fields:{value:"text"}};return he({},s,i,!0)},e.prototype.setFloatingHeader=function(t){!g(this.list)&&!this.list.classList.contains(le.noData)&&(g(this.fixedHeaderElement)&&(this.fixedHeaderElement=this.createElement("div",{className:le.fixedHead}),!g(this.list)&&!this.list.querySelector("li").classList.contains(le.group)&&(this.fixedHeaderElement.style.display="none"),!g(this.fixedHeaderElement)&&!g(this.list)&&jr([this.fixedHeaderElement],this.list),this.setFixedHeader()),!g(this.fixedHeaderElement)&&this.fixedHeaderElement.style.zIndex==="0"&&this.setFixedHeader(),this.scrollStop(t))},e.prototype.scrollStop=function(t,i){for(var r=g(t)?this.list:t.target,n=getComputedStyle(this.getValidLi(),null).getPropertyValue("height"),s=getComputedStyle(this.getValidLi(),null).getPropertyValue("margin-bottom"),a=parseInt(s,10),l=this.getModuleName()==="multiselect"?parseFloat(n):parseInt(n,10),h=Math.round(r.scrollTop/(l+a)),u=this.list.querySelectorAll("li:not(.e-hide-listitem)"),c=this.list.querySelectorAll(".e-virtual-list").length,d=h;d>-1;d--){var p=this.isVirtualizationEnabled?d+c:d;if(this.isVirtualizationEnabled){if(this.fixedHeaderElement&&this.updateGroupHeader(p,u,r))break;i&&(!g(u[p])&&u[p].classList.contains(le.selected)&&this.getModuleName()!=="autocomplete"||!g(u[p])&&u[p].classList.contains(le.focus)&&this.getModuleName())}else if(this.updateGroupHeader(p,u,r))break}},e.prototype.getPageCount=function(t){if(this.list){var i=this.list.classList.contains(le.noData)?null:getComputedStyle(this.getItems()[0],null).getPropertyValue("height"),r=Math.round(this.list.getBoundingClientRect().height/parseInt(i,10));return t?r:Math.round(r)}else return 0},e.prototype.updateGroupHeader=function(t,i,r){return!g(i[t])&&i[t].classList.contains(le.group)?(this.updateGroupFixedHeader(i[t],r),!0):(this.fixedHeaderElement.style.display="none",this.fixedHeaderElement.style.top="none",!1)},e.prototype.updateGroupFixedHeader=function(t,i){this.fixedHeaderElement&&(g(t.innerHTML)||(this.fixedHeaderElement.innerHTML=t.innerHTML),this.fixedHeaderElement.style.position="fixed",this.fixedHeaderElement.style.top=this.list.parentElement.offsetTop+this.list.offsetTop-window.scrollY+"px",this.fixedHeaderElement.style.display="block")},e.prototype.getValidLi=function(){return this.isVirtualizationEnabled?this.liCollections[0].classList.contains("e-virtual-list")?this.liCollections[this.skeletonCount]:this.liCollections[0]:this.liCollections[0]},e.prototype.renderItems=function(t,i,r){var n;if(this.itemTemplate&&t){this.getModuleName()==="multiselect"&&this.virtualSelectAll&&(this.virtualSelectAllData=t,t=t.slice(this.virtualItemStartIndex,this.virtualItemEndIndex));var s=t;s&&i.groupBy?(this.sortOrder!=="None"&&(s=this.getSortedDataSource(s)),s=At.groupDataSource(s,i.properties,this.sortOrder)):(this.getModuleName()!=="listbox"||this.getModuleName()==="listbox"&&!this.preventDefActionFilter)&&(s=this.getSortedDataSource(s)),this.sortedData=s;var a=s.length>100?new re(s).executeLocal(new Pe().take(100)):s;if(n=this.templateListItem(this.getModuleName()==="autocomplete"?a:s,i),this.isIncrementalRequest)return this.incrementalLiCollections=n.querySelectorAll("."+le.li),this.incrementalUlElement=n,this.incrementalListData=t,n;if(this.isVirtualizationEnabled){var l=this.list.querySelector(".e-list-parent"),h=this.list.querySelector(".e-virtual-ddl-content");if(t.length>=this.virtualizedItemsCount&&l&&h||l&&h&&this.isAllowFiltering||l&&h&&this.getModuleName()==="autocomplete"){this.getModuleName()==="multiselect"&&this.isCheckBoxSelection&&this.appendUncheckList&&this.list&&this.list.querySelector(".e-active")?(h.appendChild(n),r=!0):h.replaceChild(n,l);var u=this.list.querySelectorAll(".e-reorder");this.list.querySelector(".e-virtual-ddl-content")&&u&&u.length>0&&!r&&this.list.querySelector(".e-virtual-ddl-content").removeChild(u[0]),this.updateListElements(t)}else h||(this.list.innerHTML="",this.createVirtualContent(),this.list.querySelector(".e-virtual-ddl-content").appendChild(n),this.updateListElements(t))}}else{if(this.getModuleName()==="multiselect"&&this.virtualSelectAll&&(this.virtualSelectAllData=t,t=t.slice(this.virtualItemStartIndex,this.virtualItemEndIndex)),n=this.createListItems(t,i),this.isIncrementalRequest)return this.incrementalLiCollections=n.querySelectorAll("."+le.li),this.incrementalUlElement=n,this.incrementalListData=t,n;if(this.isVirtualizationEnabled){var l=this.list.querySelector(".e-list-parent:not(.e-reorder)"),h=this.list.querySelector(".e-virtual-ddl-content"),c=!1;!l&&this.list.querySelector(".e-list-parent.e-reorder")&&(l=this.list.querySelector(".e-list-parent.e-reorder")),t.length>=this.virtualizedItemsCount&&l&&h||l&&h&&this.isAllowFiltering||l&&h&&(this.getModuleName()==="autocomplete"||this.getModuleName()==="multiselect")||c?(this.appendUncheckList?h.appendChild(n):h.replaceChild(n,l),this.updateListElements(t)):(!h||!h.firstChild)&&(this.list.innerHTML="",this.createVirtualContent(),this.list.querySelector(".e-virtual-ddl-content").appendChild(n),this.updateListElements(t))}}return n},e.prototype.createVirtualContent=function(){this.list.querySelector(".e-virtual-ddl-content")||this.list.appendChild(this.createElement("div",{className:"e-virtual-ddl-content"}))},e.prototype.updateListElements=function(t){this.liCollections=this.list.querySelectorAll("."+le.li),this.ulElement=this.list.querySelector("ul"),this.listData=t,this.postRender(this.list,t,this.bindEvent)},e.prototype.templateListItem=function(t,i){var r=this.listOption(t,i);r.templateID=this.itemTemplateId,r.isStringTemplate=this.isStringTemplate;var n=this.templateCompiler(this.itemTemplate),s;if(typeof this.itemTemplate!="function"&&n){var a=X(this.itemTemplate,document).innerHTML.trim();return s=At.renderContentTemplate(this.createElement,a,t,i.properties,r,this),this.isVirtualizationEnabled&&this.isReact&&this.renderReactTemplates(),s}else return s=At.renderContentTemplate(this.createElement,this.itemTemplate,t,i.properties,r,this),this.isVirtualizationEnabled&&this.isReact&&this.renderReactTemplates(),s},e.prototype.typeOfData=function(t){for(var i={typeof:null,item:null},r=0;!g(t)&&r<t.length;r++)if(!g(t[r])){var n=typeof t[r]=="string"||typeof t[r]=="number"||typeof t[r]=="boolean",s=n?g(t[r]):g(V(this.fields.value?this.fields.value:"value",t[r]));if(!s)return i={typeof:typeof t[r],item:t[r]}}return i},e.prototype.setFixedHeader=function(){g(this.list)||(this.list.parentElement.style.display="block");var t=0;if(this.list&&this.list.parentElement&&(t=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-width"),10),isNaN(t))){var i=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-top-width"),10),r=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-bottom-width"),10),n=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-left-width"),10),s=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-right-width"),10);t=i+r+n+s}if(!g(this.liCollections)){var a=this.getValidLi().offsetWidth-t;this.fixedHeaderElement.style.width=a.toString()+"px"}Ye(this.fixedHeaderElement,{zIndex:10});var l=this.ulElement.querySelector("."+le.group+":not(.e-hide-listitem)");this.fixedHeaderElement.innerHTML=l.innerHTML},e.prototype.getSortedDataSource=function(t){if(t&&this.sortOrder!=="None"){var i=this.fields.text?this.fields.text:"text";(this.typeOfData(t).typeof==="string"||this.typeOfData(t).typeof==="number"||this.typeOfData(t).typeof==="boolean")&&(i=""),t=At.getDataSource(t,At.addSorting(this.sortOrder,i))}return t},e.prototype.getIndexByValue=function(t){var i,r=[];this.fields.disabled&&this.getModuleName()==="multiselect"&&this.liCollections?r=this.liCollections:r=this.getItems();for(var n=0;n<r.length;n++)if(!g(t)&&r[n].getAttribute("data-value")===t.toString()){i=n;break}return i},e.prototype.getIndexByValueFilter=function(t,i){var r;if(!i)return null;var n=i.querySelectorAll("li:not(.e-list-group-item)");if(n){for(var s=0;s<n.length;s++)if(!g(t)&&n[s].getAttribute("data-value")===t.toString()){r=s;break}}return r},e.prototype.dispatchEvent=function(t,i){var r=document.createEvent("HTMLEvents");r.initEvent(i,!1,!0),t&&t.dispatchEvent(r)},e.prototype.setFields=function(){this.fields.value&&!this.fields.text?this.updateFields(this.fields.value,this.fields.value):!this.fields.value&&this.fields.text?this.updateFields(this.fields.text,this.fields.text):!this.fields.value&&!this.fields.text&&(this.isPrimitiveData=!0,this.updateFields("text","text"))},e.prototype.resetList=function(t,i,r,n){if(this.list){if(this.element.tagName==="SELECT"&&this.element.options.length>0||this.element.tagName==="UL"&&this.element.childNodes.length>0){var s=t instanceof Array?t.length>0:!g(t);!s&&this.selectData&&this.selectData.length>0&&(t=this.selectData)}t=this.getModuleName()==="combobox"&&this.selectData&&t instanceof Array&&t.length<this.selectData.length&&this.addedNewItem?this.selectData:t,this.addedNewItem=!1,this.setListData(t,i,r,n)}},e.prototype.updateSelectElementData=function(t){(t||this.isVirtualizationEnabled)&&g(this.selectData)&&this.listData&&this.listData.length>0&&(this.selectData=this.listData)},e.prototype.updateSelection=function(){},e.prototype.renderList=function(){this.render()},e.prototype.updateDataSource=function(t,i){this.resetList(this.dataSource),this.totalItemCount=this.dataSource instanceof re?this.dataSource.dataSource.json.length:0},e.prototype.setUpdateInitial=function(t,i,r){this.isDataFetched=!1,this.isPrimitiveData=!1;for(var n={},s=0;t.length>s;s++)i[t[s]]&&t[s]==="fields"?(this.setFields(),n[t[s]]=i[t[s]]):i[t[s]]&&(n[t[s]]=i[t[s]]);Object.keys(n).length>0&&(Object.keys(n).indexOf("dataSource")===-1&&(n.dataSource=this.dataSource),this.getModuleName()==="listbox"?(!this.isReact||this.isReact&&(!g(i.dataSource)||!g(i.sortOrder)))&&this.updateDataSource(n,r):(this.isDynamicData=!0,this.updateDataSource(n,r)))},e.prototype.onPropertyChanged=function(t,i){this.getModuleName()==="dropdownbase"&&this.setUpdateInitial(["fields","query","dataSource"],t),this.setUpdateInitial(["sortOrder","itemTemplate"],t);for(var r=0,n=Object.keys(t);r<n.length;r++){var s=n[r];switch(s){case"query":case"sortOrder":case"dataSource":case"itemTemplate":break;case"enableRtl":this.setEnableRtl();break;case"groupTemplate":if(this.renderGroupTemplate(this.list),this.ulElement&&this.fixedHeaderElement){var a=this.ulElement.querySelector("."+le.group);this.fixedHeaderElement.innerHTML=a.innerHTML}break;case"locale":this.list&&!g(this.liCollections)&&this.liCollections.length===0&&this.l10nUpdate();break;case"zIndex":this.setProperties({zIndex:t.zIndex},!0),this.setZIndex();break}}},e.prototype.render=function(t,i){this.getModuleName()==="listbox"?this.list=this.createElement("div",{className:le.content,attrs:{tabindex:"0"}}):this.list=this.createElement("div",{className:le.content}),this.list.classList.add(le.root),this.setFields();var r={duration:300,selector:"."+le.li};this.rippleFun=Vi(this.list,r);var n=this.element.querySelector("select>optgroup");if((this.fields.groupBy||!g(n))&&!this.isGroupChecking&&(E.add(this.list,"scroll",this.setFloatingHeader,this),E.add(document,"scroll",this.updateGroupFixedHeader,this)),this.getModuleName()==="dropdownbase"){this.element.getAttribute("tabindex")&&this.list.setAttribute("tabindex",this.element.getAttribute("tabindex")),K([this.element],le.root),this.element.style.display="none";var s=this.createElement("div");this.element.parentElement.insertBefore(s,this.element),s.appendChild(this.element),s.appendChild(this.list)}this.setEnableRtl(),i||this.initialize(t)},e.prototype.removeScrollEvent=function(){this.list&&E.remove(this.list,"scroll",this.setFloatingHeader)},e.prototype.getModuleName=function(){return"dropdownbase"},e.prototype.getItems=function(){return this.ulElement.querySelectorAll("."+le.li)},e.prototype.addItem=function(t,i){if((!this.list||this.list.textContent===this.noRecordsTemplate&&this.getModuleName()!=="listbox")&&this.renderList(),this.sortOrder!=="None"&&g(i)){var r=[].slice.call(this.listData);r.push(t),r=this.getSortedDataSource(r),this.fields.groupBy&&(r=At.groupDataSource(r,this.fields.properties,this.sortOrder)),i=r.indexOf(t)}var n=this.getItems().length,s=n===0,a=this.list.querySelector("."+le.selected);t=t instanceof Array?t:[t];var l;l=g(i)||i<0||i>n-1?n:i;var h=this.fields;t&&h.groupBy&&(t=At.groupDataSource(t,h.properties));for(var u=[],c=0;c<t.length;c++){var d=t[c],p=d.isHeader,f=this.createElement("li",{className:p?le.group:le.li,id:"option-add-"+c}),v=d instanceof Object?V(h.text,d):d;if(p&&(f.innerText=v),this.itemTemplate&&!p){var m=this.templateCompiler(this.itemTemplate),y=typeof this.itemTemplate!="function"&&m?wt(X(this.itemTemplate,document).innerHTML.trim()):wt(this.itemTemplate),S=y(d,this,"itemTemplate",this.itemTemplateId,this.isStringTemplate,null,f);S&&dt(S,f)}else p||f.appendChild(document.createTextNode(v));f.setAttribute("data-value",d instanceof Object?V(h.value,d):d),f.setAttribute("role","option"),this.notify("addItem",{module:"CheckBoxSelection",item:f}),u.push(f),this.getModuleName()==="listbox"?(this.listData.splice(s?this.listData.length:l,0,d),this.listData.length!==this.sortedData.length&&(this.sortedData=this.listData)):this.listData.push(d),this.sortOrder==="None"&&g(i)&&l===0&&(l=null),this.getModuleName()==="listbox"?this.updateActionCompleteData(f,d,s?null:l+c):this.updateActionCompleteData(f,d,l),this.trigger("beforeItemRender",{element:f,item:d})}if(n===0&&g(this.list.querySelector("ul")))g(this.list)||(this.list.innerHTML="",this.list.classList.remove(le.noData),this.isAddNewItemTemplate=!0,g(this.ulElement)||this.list.appendChild(this.ulElement)),this.liCollections=u,!g(u)&&!g(this.ulElement)&&dt(u,this.ulElement),this.updateAddItemList(this.list,n);else{this.getModuleName()==="listbox"&&n===0&&(this.ulElement.innerHTML="");for(var b=[],c=0;c<t.length;c++){for(var w=this.ulElement.querySelectorAll(".e-list-group-item"),I=0;I<w.length;I++)b[I]=w[I].innerText;if(b.indexOf(u[c].innerText)>-1&&h.groupBy){for(var I=0;I<w.length;I++)if(b[I]===u[c].innerText){this.sortOrder==="None"?this.ulElement.insertBefore(u[c+1],w[I+1]):this.ulElement.insertBefore(u[c+1],this.ulElement.childNodes[i]),c=c+1;break}}else this.liCollections[l]&&this.liCollections[l].parentNode?this.liCollections[l].parentNode.insertBefore(u[c],this.liCollections[l]):i&&this.getModuleName()==="listbox"?this.ulElement.insertBefore(u[c],this.ulElement.childNodes[i+c]):this.ulElement.appendChild(u[c]);var x=[].slice.call(this.liCollections);x.splice(l,0,u[c]),this.liCollections=x,l+=1,this.getModuleName()==="multiselect"&&this.updateDataList()}}this.getModuleName()==="listbox"&&this.isReact&&this.renderReactTemplates(),(a||i===0)&&this.updateSelection(),this.addedNewItem=!0},e.prototype.isDisabledElement=function(t){return!!(t&&t.classList.contains("e-disabled"))},e.prototype.isDisabledItemByIndex=function(t){return this.fields.disabled&&this.liCollections?this.isDisabledElement(this.liCollections[t]):!1},e.prototype.disableListItem=function(t){t.classList.add("e-disabled"),t.setAttribute("aria-disabled","true"),t.setAttribute("aria-selected","false")},e.prototype.validationAttribute=function(t,i){var r=t.getAttribute("name")?t.getAttribute("name"):t.getAttribute("id");i.setAttribute("name",r),t.removeAttribute("name");for(var n=["required","aria-required","form"],s=0;s<n.length;s++)if(t.getAttribute(n[s])){var a=t.getAttribute(n[s]);i.setAttribute(n[s],a),t.removeAttribute(n[s])}},e.prototype.setZIndex=function(){},e.prototype.updateActionCompleteData=function(t,i,r){},e.prototype.updateAddItemList=function(t,i){},e.prototype.updateDataList=function(){},e.prototype.getDataByValue=function(t){if(!g(this.listData)){var i=this.typeOfData(this.listData).typeof;if(i==="string"||i==="number"||i==="boolean")for(var r=0,n=this.listData;r<n.length;r++){var s=n[r];if(!g(s)&&s===t)return s}else for(var a=0,l=this.listData;a<l.length;a++){var s=l[a];if(!g(s)&&V(this.fields.value?this.fields.value:"value",s)===t)return s}}return null},e.prototype.destroy=function(){document&&(E.remove(document,"scroll",this.updateGroupFixedHeader),document.body.contains(this.list)&&(E.remove(this.list,"scroll",this.setFloatingHeader),g(this.rippleFun)||this.rippleFun(),ee(this.list))),this.liCollections=null,this.ulElement=null,this.list=null,this.enableRtlElements=null,this.rippleFun=null,o.prototype.destroy.call(this)},er([be({text:null,value:null,iconCss:null,groupBy:null,disabled:null},Aw)],e.prototype,"fields",void 0),er([C(null)],e.prototype,"itemTemplate",void 0),er([C(null)],e.prototype,"groupTemplate",void 0),er([C("No records found")],e.prototype,"noRecordsTemplate",void 0),er([C("Request failed")],e.prototype,"actionFailureTemplate",void 0),er([C("None")],e.prototype,"sortOrder",void 0),er([C([])],e.prototype,"dataSource",void 0),er([C(null)],e.prototype,"query",void 0),er([C("StartsWith")],e.prototype,"filterType",void 0),er([C(!0)],e.prototype,"ignoreCase",void 0),er([C(1e3)],e.prototype,"zIndex",void 0),er([C(!1)],e.prototype,"ignoreAccent",void 0),er([C()],e.prototype,"locale",void 0),er([q()],e.prototype,"actionBegin",void 0),er([q()],e.prototype,"actionComplete",void 0),er([q()],e.prototype,"actionFailure",void 0),er([q()],e.prototype,"select",void 0),er([q()],e.prototype,"dataBound",void 0),er([q()],e.prototype,"created",void 0),er([q()],e.prototype,"destroyed",void 0),e=er([bt],e),e}(Kt),ZV=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),vi=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Qe={root:"e-dropdownlist",hover:le.hover,selected:le.selected,rtl:le.rtl,li:le.li,disable:le.disabled,base:le.root,focus:le.focus,content:le.content,input:"e-input-group",inputFocus:"e-input-focus",icon:"e-input-group-icon e-ddl-icon",iconAnimation:"e-icon-anim",value:"e-input-value",device:"e-ddl-device",backIcon:"e-input-group-icon e-back-icon e-icons",filterBarClearIcon:"e-input-group-icon e-clear-icon e-icons",filterInput:"e-input-filter",resizeIcon:"e-resizer-right e-icons",filterParent:"e-filter-parent",mobileFilter:"e-ddl-device-filter",footer:"e-ddl-footer",header:"e-ddl-header",clearIcon:"e-clear-icon",clearIconHide:"e-clear-icon-hide",popupFullScreen:"e-popup-full-page",disableIcon:"e-ddl-disable-icon",hiddenElement:"e-ddl-hidden",virtualList:"e-list-item e-virtual-list"},JV={container:null,buttons:[]},Ps=function(o){ZV(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.isListSearched=!1,r.preventChange=!1,r.isTouched=!1,r.isFocused=!1,r.autoFill=!1,r.isUpdateHeaderHeight=!1,r.isUpdateFooterHeight=!1,r.isReactTemplateUpdate=!1,r}return e.prototype.preRender=function(){this.valueTempElement=null,this.element.style.opacity="0",this.initializeData(),o.prototype.preRender.call(this),this.activeIndex=this.index,this.queryString=""},e.prototype.initializeData=function(){this.isPopupOpen=!1,this.isDocumentClick=!1,this.isInteracted=!1,this.isFilterFocus=!1,this.beforePopupOpen=!1,this.initial=!0,this.initialRemoteRender=!1,this.isNotSearchList=!1,this.isTyped=!1,this.isSelected=!1,this.preventFocus=!1,this.preventAutoFill=!1,this.isValidKey=!1,this.typedString="",this.isEscapeKey=!1,this.isPreventBlur=!1,this.isTabKey=!1,this.actionCompleteData={isUpdated:!1},this.actionData={isUpdated:!1},this.prevSelectPoints={},this.isSelectCustom=!1,this.isDropDownClick=!1,this.preventAltUp=!1,this.isCustomFilter=!1,this.isSecondClick=!1,this.previousValue=null,this.keyConfigure={tab:"tab",enter:"13",escape:"27",end:"35",home:"36",down:"40",up:"38",pageUp:"33",pageDown:"34",open:"alt+40",close:"shift+tab",hide:"alt+38",space:"32"},this.viewPortInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:this.itemCount}},e.prototype.setZIndex=function(){this.popupObj&&this.popupObj.setProperties({zIndex:this.zIndex})},e.prototype.requiredModules=function(){var t=[];return this.enableVirtualization&&t.push({args:[this],member:"VirtualScroll"}),t},e.prototype.renderList=function(t,i){o.prototype.render.call(this,t,i),this.dataSource instanceof re||(this.totalItemCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0),this.enableVirtualization&&this.isFiltering()&&this.getModuleName()==="combobox"&&(this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+le.li),this.ulElement=this.list.querySelector("ul")),this.unWireListEvents(),this.wireListEvents()},e.prototype.floatLabelChange=function(){if(this.getModuleName()==="dropdownlist"&&this.floatLabelType==="Auto"){var t=this.inputWrapper.container.querySelector(".e-float-text");this.inputElement.value!==""||this.isInteracted?wi(t,["e-label-top"],["e-label-bottom"]):wi(t,["e-label-bottom"],["e-label-top"])}},e.prototype.resetHandler=function(t){t.preventDefault(),this.clearAll(t),this.enableVirtualization&&(this.list.scrollTop=0,this.virtualListInfo=null,this.previousStartIndex=0,this.previousEndIndex=0)},e.prototype.resetFocusElement=function(){if(this.removeHover(),this.removeSelection(),this.removeFocus(),this.list.scrollTop=0,this.getModuleName()!=="autocomplete"&&!g(this.ulElement)){var t=this.fields.disabled?this.ulElement.querySelector("."+Qe.li+":not(.e-disabled)"):this.ulElement.querySelector("."+Qe.li);this.enableVirtualization&&(t=this.liCollections[this.skeletonCount]),t&&t.classList.add(Qe.focus)}},e.prototype.clearAll=function(t,i){this.previousItemData=g(this.itemData)?null:this.itemData,(g(i)||!g(i)&&(g(i.dataSource)||!(i.dataSource instanceof re)&&i.dataSource.length===0))&&(this.isActive=!0,this.resetSelection(i));var r=this.getItemData();if(!this.allowObjectBinding&&this.previousValue===r.value||this.allowObjectBinding&&this.previousValue&&this.isObjectInArray(this.previousValue,[this.allowCustom?this.value?this.value:r:r.value?this.getDataByValue(r.value):r])){this.checkAndResetCache(),this.enableVirtualization&&this.list&&this.updateInitialData();return}this.onChangeEvent(t),this.checkAndResetCache(),this.enableVirtualization&&this.updateInitialData()},e.prototype.resetSelection=function(t){this.list&&(!g(t)&&(g(t.dataSource)||!(t.dataSource instanceof re)&&t.dataSource.length===0)?(this.selectedLI=null,this.actionCompleteData.isUpdated=!1,this.actionCompleteData.ulElement=null,this.actionCompleteData.list=null,this.resetList(t.dataSource)):(this.allowFiltering&&this.getModuleName()!=="autocomplete"&&!g(this.actionCompleteData.ulElement)&&!g(this.actionCompleteData.list)&&this.actionCompleteData.list.length>0&&this.onActionComplete(this.actionCompleteData.ulElement.cloneNode(!0),this.actionCompleteData.list),this.resetFocusElement())),g(this.hiddenElement)||(this.hiddenElement.innerHTML=""),g(this.inputElement)||(this.inputElement.value=""),this.value=null,this.itemData=null,this.text=null,this.index=null,this.activeIndex=null,this.item=null,this.queryString="",this.valueTempElement&&(ee(this.valueTempElement),this.inputElement.style.display="block",this.valueTempElement=null),this.setSelection(null,null),this.isSelectCustom=!1,this.updateIconState(),this.cloneElements()},e.prototype.setHTMLAttributes=function(){if(Object.keys(this.htmlAttributes).length)for(var t=0,i=Object.keys(this.htmlAttributes);t<i.length;t++){var r=i[t];if(r==="class"){var n=this.htmlAttributes[""+r].replace(/\s+/g," ").trim();n!==""&&Y([this.inputWrapper.container],n.split(" "))}else if(r==="disabled"&&this.htmlAttributes[""+r]==="disabled")this.enabled=!1,this.setEnable();else if(r==="readonly"&&!g(this.htmlAttributes[""+r]))this.readonly=!0,this.dataBind();else if(r==="style")this.inputWrapper.container.setAttribute("style",this.htmlAttributes[""+r]);else if(r==="aria-label")(this.getModuleName()==="autocomplete"||this.getModuleName()==="combobox")&&!this.readonly?this.inputElement.setAttribute("aria-label",this.htmlAttributes[""+r]):this.getModuleName()==="dropdownlist"&&this.inputWrapper.container.setAttribute("aria-label",this.htmlAttributes[""+r]);else{var s=["title","id","placeholder","role","autocomplete","autocapitalize","spellcheck","minlength","maxlength"],a=["name","required"];(this.getModuleName()==="autocomplete"||this.getModuleName()==="combobox")&&s.push("tabindex"),a.indexOf(r)>-1||r.indexOf("data")===0?this.hiddenElement.setAttribute(r,this.htmlAttributes[""+r]):s.indexOf(r)>-1?r==="placeholder"?Ce.setPlaceholder(this.htmlAttributes[""+r],this.inputElement):this.inputElement.setAttribute(r,this.htmlAttributes[""+r]):this.inputWrapper.container.setAttribute(r,this.htmlAttributes[""+r])}}(this.getModuleName()==="autocomplete"||this.getModuleName()==="combobox")&&this.inputWrapper.container.removeAttribute("tabindex")},e.prototype.getAriaAttributes=function(){return{"aria-disabled":"false",role:"combobox","aria-expanded":"false","aria-live":"polite","aria-labelledby":this.hiddenElement.id}},e.prototype.setEnableRtl=function(){!g(this.inputElement)&&!g(this.inputElement.parentElement)&&Ce.setEnableRtl(this.enableRtl,[this.inputElement.parentElement]),this.popupObj&&(this.popupObj.enableRtl=this.enableRtl,this.popupObj.dataBind())},e.prototype.setEnable=function(){Ce.setEnabled(this.enabled,this.inputElement),this.enabled?(K([this.inputWrapper.container],Qe.disable),this.inputElement.setAttribute("aria-disabled","false"),this.targetElement().setAttribute("tabindex",this.tabIndex),this.inputWrapper&&this.inputWrapper.container&&(this.inputWrapper.container.setAttribute("aria-disabled","false"),this.inputWrapper.container.removeAttribute("disabled"))):(this.hidePopup(),Y([this.inputWrapper.container],Qe.disable),this.inputElement.setAttribute("aria-disabled","true"),this.targetElement().tabIndex=-1,this.inputWrapper&&this.inputWrapper.container&&(this.inputWrapper.container.setAttribute("aria-disabled","true"),this.inputWrapper.container.setAttribute("disabled","")))},e.prototype.getPersistData=function(){return this.addOnPersist(["value"])},e.prototype.getLocaleName=function(){return"drop-down-list"},e.prototype.preventTabIndex=function(t){this.getModuleName()==="dropdownlist"&&(t.tabIndex=-1)},e.prototype.targetElement=function(){return g(this.inputWrapper)?null:this.inputWrapper.container},e.prototype.getNgDirective=function(){return"EJS-DROPDOWNLIST"},e.prototype.getElementByText=function(t){return this.getElementByValue(this.getValueByText(t))},e.prototype.getElementByValue=function(t){for(var i,r=this.getItems(),n=0,s=r;n<s.length;n++){var a=s[n];if(this.getFormattedValue(a.getAttribute("data-value"))===t){i=a;break}}return i},e.prototype.initValue=function(){this.viewPortInfo.startIndex=this.virtualItemStartIndex=0,this.viewPortInfo.endIndex=this.virtualItemEndIndex=this.itemCount,this.renderList(),this.dataSource instanceof re?this.initialRemoteRender=!0:this.updateValues()},e.prototype.isDisableItemValue=function(t){if(typeof t=="object"){var i=JSON.parse(JSON.stringify(t))[this.fields.value];return this.isDisabledItemByIndex(this.getIndexByValue(i))}return this.isDisabledItemByIndex(this.getIndexByValue(t))},e.prototype.updateValues=function(){if(this.fields.disabled&&(this.value!=null&&(this.value=this.isDisableItemValue(this.value)?null:this.value),this.text!=null&&(this.text=this.isDisabledItemByIndex(this.getIndexByValue(this.getValueByText(this.text)))?null:this.text),this.index!=null&&(this.index=this.isDisabledItemByIndex(this.index)?null:this.index,this.activeIndex=this.index)),this.selectedValueInfo=this.viewPortInfo,g(this.value))if(this.text&&g(this.value)){var i=this.getElementByText(this.text);if(g(i)){this.setProperties({text:null});return}else this.setSelection(i,null)}else this.setSelection(this.liCollections[this.activeIndex],null);else{var t=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value;this.setSelection(this.getElementByValue(t),null)}this.setHiddenValue(),Ce.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton)},e.prototype.onBlurHandler=function(t){if(this.enabled){var i=t.relatedTarget,r=t.target,n=this.isPreventBlur;if(this.isPreventBlur=!1,n&&!this.isDocumentClick&&this.isPopupOpen&&(!g(r)||!this.isFilterLayout()&&g(i))){this.getModuleName()==="dropdownlist"&&this.allowFiltering&&this.isPopupOpen?this.filterInput.focus():this.targetElement().focus();return}if(this.isDocumentClick||!g(this.popupObj)&&document.body.contains(this.popupObj.element)&&this.popupObj.element.classList.contains(Qe.mobileFilter)){this.beforePopupOpen||(this.isDocumentClick=!1);return}(this.getModuleName()==="dropdownlist"&&!this.isFilterFocus&&i!==this.inputElement&&(document.activeElement!==i||document.activeElement===i&&r.classList.contains(Qe.inputFocus))||g(i)&&this.getModuleName()==="dropdownlist"&&this.allowFiltering&&r!==this.inputWrapper.container||this.getModuleName()!=="dropdownlist"&&!this.inputWrapper.container.contains(i)||this.isTabKey)&&(this.isDocumentClick=!!this.isPopupOpen,this.focusOutAction(t),this.isTabKey=!1),this.isRequested&&!this.isPopupOpen&&!this.isPreventBlur&&(this.isActive=!1,this.beforePopupOpen=!1),this.isFocused=!1}},e.prototype.focusOutAction=function(t){this.isInteracted=!1,this.focusOut(t),this.onFocusOut(t)},e.prototype.onFocusOut=function(t){this.enabled&&(this.isSelected&&(this.isSelectCustom=!1,this.onChangeEvent(t)),this.floatLabelChange(),this.dispatchEvent(this.hiddenElement,"change"),this.getModuleName()==="dropdownlist"&&this.element.tagName!=="INPUT"&&this.dispatchEvent(this.inputElement,"blur"),this.inputWrapper.clearButton&&Y([this.inputWrapper.clearButton],Qe.clearIconHide),this.trigger("blur"))},e.prototype.onFocus=function(t){if(!this.isInteracted){this.isInteracted=!0;var i={isInteracted:!!t,event:t};this.trigger("focus",i)}this.updateIconState(),this.isFocused=!0},e.prototype.resizingWireEvent=function(){E.add(document,"mousemove",this.resizePopup,this),E.add(document,"mouseup",this.stopResizing,this),E.add(document,"touchmove",this.resizePopup,this),E.add(document,"touchend",this.stopResizing,this)},e.prototype.resizingUnWireEvent=function(){E.remove(document,"mousemove",this.resizePopup),E.remove(document,"mouseup",this.stopResizing),E.remove(document,"touchmove",this.resizePopup),E.remove(document,"touchend",this.stopResizing)},e.prototype.resetValueHandler=function(t){var i=j(this.inputElement,"form");if(i&&t.target===i){var r=this.element.tagName===this.getNgDirective()?null:this.inputElement.getAttribute("value");this.text=r}},e.prototype.wireEvent=function(){E.add(this.inputWrapper.container,"mousedown",this.dropDownClick,this),E.add(this.inputWrapper.container,"focus",this.focusIn,this),E.add(this.inputWrapper.container,"keypress",this.onSearch,this),E.add(window,"resize",this.windowResize,this),this.bindCommonEvent()},e.prototype.bindCommonEvent=function(){E.add(this.targetElement(),"blur",this.onBlurHandler,this);var t=j(this.inputElement,"form");t&&E.add(t,"reset",this.resetValueHandler,this),B.isDevice?this.keyboardModule=new $i(this.targetElement(),{keyAction:this.mobileKeyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}):this.keyboardModule=new $i(this.targetElement(),{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}),this.bindClearEvent()},e.prototype.windowResize=function(){this.isPopupOpen&&this.popupObj.refreshPosition(this.inputWrapper.container)},e.prototype.bindClearEvent=function(){this.showClearButton&&E.add(this.inputWrapper.clearButton,"mousedown",this.resetHandler,this)},e.prototype.unBindCommonEvent=function(){!g(this.inputWrapper)&&this.targetElement()&&E.remove(this.targetElement(),"blur",this.onBlurHandler);var t=this.inputElement&&j(this.inputElement,"form");t&&E.remove(t,"reset",this.resetValueHandler),B.isDevice||this.keyboardModule.destroy(),this.showClearButton&&E.remove(this.inputWrapper.clearButton,"mousedown",this.resetHandler)},e.prototype.updateIconState=function(){this.showClearButton&&(this.inputElement.value!==""&&!this.readonly?K([this.inputWrapper.clearButton],Qe.clearIconHide):Y([this.inputWrapper.clearButton],Qe.clearIconHide))},e.prototype.wireListEvents=function(){g(this.list)||(E.add(this.list,"click",this.onMouseClick,this),E.add(this.list,"mouseover",this.onMouseOver,this),E.add(this.list,"mouseout",this.onMouseLeave,this))},e.prototype.onSearch=function(t){t.charCode!==32&&t.charCode!==13&&(this.list===void 0&&this.renderList(),this.searchKeyEvent=t,this.onServerIncrementalSearch(t))},e.prototype.onServerIncrementalSearch=function(t){!this.isRequested&&!g(this.list)&&!g(this.list.querySelector("li"))&&this.enabled&&!this.readonly&&this.incrementalSearch(t)},e.prototype.startResizing=function(t){this.isResizing=!0,this.trigger("resizeStart",t);var i=t instanceof MouseEvent?t.clientX:t.touches[0].clientX,r=t instanceof MouseEvent?t.clientY:t.touches[0].clientY;this.list&&this.list.parentElement&&(this.originalWidth=this.list.parentElement.offsetWidth,this.originalHeight=this.list.parentElement.offsetHeight,this.originalMouseX=i,this.originalMouseY=r),this.resizingWireEvent(),t&&t.preventDefault()},e.prototype.resizePopup=function(t){if(this.isResizing){this.trigger("resizing",t);var i=t instanceof MouseEvent?t.clientX:t.touches[0].clientX,r=t instanceof MouseEvent?t.clientY:t.touches[0].clientY,n=i-this.originalMouseX,s=r-this.originalMouseY;if(this.list&&this.list.parentElement){var a=parseInt(window.getComputedStyle(this.list.parentElement).minWidth,10),l=parseInt(window.getComputedStyle(this.list.parentElement).minHeight,10);a=a||100,l=l||120,this.resizeWidth=Math.max(this.originalWidth+n,a),this.resizeHeight=Math.max(this.originalHeight+s,l),this.list.parentElement.style.width=this.resizeWidth+"px",this.list.parentElement.style.height=this.resizeHeight+"px",this.list.parentElement.style.maxHeight=this.resizeHeight+"px",this.list.style.maxHeight=this.resizeHeight+"px",this.fixedHeaderElement&&this.ulElement&&(this.fixedHeaderElement.style.width=this.ulElement.offsetWidth+"px")}t&&t.preventDefault()}},e.prototype.stopResizing=function(t){this.isResizing&&(this.isResizing=!1,this.trigger("resizeStop",t),this.resizingUnWireEvent()),t&&t.preventDefault()},e.prototype.onMouseClick=function(t){var i=t.target;this.keyboardEvent=null;var r=j(i,"."+le.li);if(!(!this.isValidLI(r)||this.isDisabledElement(r)))if(this.setSelection(r,t),B.isDevice&&this.isFilterLayout())history.back();else{var n=100;this.closePopup(n,t)}},e.prototype.onMouseOver=function(t){var i=j(t.target,"."+le.li);this.setHover(i)},e.prototype.setHover=function(t){this.enabled&&this.isValidLI(t)&&!t.classList.contains(le.hover)&&(this.removeHover(),Y([t],le.hover))},e.prototype.onMouseLeave=function(){this.removeHover()},e.prototype.removeHover=function(){if(this.list){var t=this.list.querySelectorAll("."+le.hover);t&&t.length&&K(t,le.hover)}},e.prototype.isValidLI=function(t){return t&&t.hasAttribute("role")&&t.getAttribute("role")==="option"},e.prototype.updateIncrementalItemIndex=function(t,i){this.incrementalStartIndex=t,this.incrementalEndIndex=i},e.prototype.incrementalSearch=function(t){if(this.liCollections.length>0)if(this.enableVirtualization){var i=!1,r=!1,n=this.ulElement.getElementsByClassName("e-active")[0],s=n?n.textContent:null;this.incrementalQueryString===""?(this.incrementalQueryString=String.fromCharCode(t.charCode),this.incrementalPreQueryString=this.incrementalQueryString):String.fromCharCode(t.charCode).toLocaleLowerCase()===this.incrementalPreQueryString.toLocaleLowerCase()?r=!0:this.incrementalQueryString=String.fromCharCode(t.charCode),(this.viewPortInfo.endIndex>=this.incrementalEndIndex&&this.incrementalEndIndex<=this.totalItemCount||this.incrementalEndIndex===0)&&(i=!0,this.incrementalStartIndex=this.incrementalEndIndex,this.incrementalEndIndex===0?this.incrementalEndIndex=100>this.totalItemCount?this.totalItemCount:100:this.incrementalEndIndex=this.incrementalEndIndex+100>this.totalItemCount?this.totalItemCount:this.incrementalEndIndex+100,this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),i=!0),(this.viewPortInfo.startIndex!==0||i)&&this.updateIncrementalView(0,this.itemCount);for(var a=Wp(t.charCode,this.incrementalLiCollections,this.activeIndex,!0,this.element.id,r,s,!0);g(a)&&this.incrementalEndIndex<this.totalItemCount&&(this.updateIncrementalItemIndex(this.incrementalEndIndex,this.incrementalEndIndex+100>this.totalItemCount?this.totalItemCount:this.incrementalEndIndex+100),this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),i=!0,(this.viewPortInfo.startIndex!==0||i)&&this.updateIncrementalView(0,this.itemCount),a=Wp(t.charCode,this.incrementalLiCollections,0,!0,this.element.id,r,s,!0,!0),!!g(a));)if(g(a)&&this.incrementalEndIndex>=this.totalItemCount){this.updateIncrementalItemIndex(0,100>this.totalItemCount?this.totalItemCount:100);break}g(a)&&this.incrementalEndIndex>=this.totalItemCount&&(this.updateIncrementalItemIndex(0,100>this.totalItemCount?this.totalItemCount:100),this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),i=!0,(this.viewPortInfo.startIndex!==0||i)&&this.updateIncrementalView(0,this.itemCount),a=Wp(t.charCode,this.incrementalLiCollections,0,!0,this.element.id,r,s,!0,!0));var l=a&&this.getIndexByValue(a.getAttribute("data-value"));if(l)l=l-this.skeletonCount;else for(var h=0;h<this.incrementalLiCollections.length;h++)if(!g(a)&&!g(a.getAttribute("data-value"))&&this.incrementalLiCollections[h].getAttribute("data-value")===a.getAttribute("data-value").toString()){l=h,l=this.incrementalStartIndex+l;break}if(l&&(!(this.viewPortInfo.startIndex>=l)||!(l>=this.viewPortInfo.endIndex))){var u=l-(this.itemCount/2-2)>0?l-(this.itemCount/2-2):0,c=this.viewPortInfo.startIndex+this.itemCount>this.totalItemCount?this.totalItemCount:this.viewPortInfo.startIndex+this.itemCount;this.updateIncrementalView(u,c)}if(g(a))this.updateIncrementalView(0,this.itemCount),this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues(),this.list.scrollTop=0;else{var d=this.getIndexByValue(a.getAttribute("data-value"))-this.skeletonCount;if(d>this.itemCount/2){var u=this.viewPortInfo.startIndex+(this.itemCount/2-2)<this.totalItemCount?this.viewPortInfo.startIndex+(this.itemCount/2-2):this.totalItemCount,c=this.viewPortInfo.startIndex+this.itemCount>this.totalItemCount?this.totalItemCount:this.viewPortInfo.startIndex+this.itemCount;this.updateIncrementalView(u,c)}if(a=this.getElementByValue(a.getAttribute("data-value")),this.setSelection(a,t),this.setScrollPosition(),this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues(),this.enableVirtualization&&!this.fields.groupBy){var p=this.virtualListInfo&&this.virtualListInfo.startIndex?this.selectedLI.offsetTop+this.virtualListInfo.startIndex*this.selectedLI.offsetHeight:this.selectedLI.offsetTop;this.list.scrollTop=p-this.list.querySelectorAll(".e-virtual-list").length*this.selectedLI.offsetHeight}this.incrementalPreQueryString=this.incrementalQueryString}}else{var a=void 0;if(this.fields.disabled){var f=this.list.querySelectorAll("."+le.li+":not(.e-disabled)");a=Wp(t.charCode,f,this.activeIndex,!0,this.element.id)}else a=Wp(t.charCode,this.liCollections,this.activeIndex,!0,this.element.id);g(a)||(this.setSelection(a,t),this.setScrollPosition())}},e.prototype.hideSpinner=function(){g(this.spinnerElement)||(Rs(this.spinnerElement),K([this.spinnerElement],Qe.disableIcon),this.spinnerElement.innerHTML="",this.spinnerElement=null)},e.prototype.showSpinner=function(){g(this.spinnerElement)&&(this.spinnerElement=B.isDevice&&!g(this.filterInputObj)&&this.filterInputObj.buttons[1]||!g(this.filterInputObj)&&this.filterInputObj.buttons[0]||this.inputWrapper.buttons[0],Y([this.spinnerElement],Qe.disableIcon),Os({target:this.spinnerElement,width:B.isDevice?"16px":"14px"},this.createElement),rs(this.spinnerElement))},e.prototype.keyActionHandler=function(t){if(this.enabled){this.keyboardEvent=t,this.isPreventKeyAction&&this.enableVirtualization&&t.preventDefault();var i=t.action==="pageUp"||t.action==="pageDown",r=this.getModuleName()!=="dropdownlist"&&(t.action==="home"||t.action==="end");this.isEscapeKey=t.action==="escape",this.isTabKey=!this.isPopupOpen&&t.action==="tab";var n=t.action==="down"||t.action==="up"||t.action==="pageUp"||t.action==="pageDown"||t.action==="home"||t.action==="end";if(!((this.isEditTextBox()||i||r)&&!this.isPopupOpen)&&!this.readonly){var s=t.action==="tab"||t.action==="close";if(g(this.list)&&!this.isRequested&&!s&&t.action!=="escape"&&(this.searchKeyEvent=t,(!this.enableVirtualization||this.enableVirtualization&&this.getModuleName()!=="autocomplete"&&t.type!=="mousedown"&&(t.keyCode===40||t.keyCode===38))&&(this.renderList(t),this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+le.li),this.ulElement=this.list.querySelector("ul"))),g(this.list)||!g(this.liCollections)&&n&&this.liCollections.length===0||this.isRequested)return;switch((s&&this.getModuleName()!=="autocomplete"&&this.isPopupOpen||t.action==="escape")&&t.preventDefault(),this.isSelected=t.action==="escape"?!1:this.isSelected,this.isTyped=n||t.action==="escape"?!1:this.isTyped,t.action){case"down":case"up":this.updateUpDownAction(t);break;case"pageUp":this.pageUpSelection(this.activeIndex-this.getPageCount(),t),t.preventDefault();break;case"pageDown":this.pageDownSelection(this.activeIndex+this.getPageCount(),t),t.preventDefault();break;case"home":this.isMouseScrollAction=!0,this.updateHomeEndAction(t);break;case"end":this.isMouseScrollAction=!0,this.updateHomeEndAction(t);break;case"space":this.getModuleName()==="dropdownlist"&&(this.beforePopupOpen||(this.showPopup(),t.preventDefault()));break;case"open":this.showPopup(t);break;case"hide":this.preventAltUp=this.isPopupOpen,this.hidePopup(t),this.focusDropDown(t);break;case"enter":this.selectCurrentItem(t);break;case"tab":this.selectCurrentValueOnTab(t);break;case"escape":case"close":this.isPopupOpen&&(this.hidePopup(t),this.focusDropDown(t));break}}}},e.prototype.updateUpDownAction=function(t,i){if(!(this.fields.disabled&&this.list&&this.list.querySelectorAll(".e-list-item:not(.e-disabled)").length===0)){if(this.allowFiltering&&!this.enableVirtualization&&this.getModuleName()!=="autocomplete"){var r=this.getItemData().value;g(r)&&(r="null");var n=this.getIndexByValue(r);g(n)||(this.activeIndex=n)}var s=this.list.querySelector("."+Qe.focus);if(this.isSelectFocusItem(s)&&!i){if(this.setSelection(s,t),this.enableVirtualization){var a=this.virtualListInfo&&this.virtualListInfo.startIndex?this.selectedLI.offsetTop+this.virtualListInfo.startIndex*this.selectedLI.offsetHeight:this.selectedLI.offsetTop;this.fields.groupBy&&(a=this.virtualListInfo&&this.virtualListInfo.startIndex===0?this.selectedLI.offsetHeight-a:a-this.selectedLI.offsetHeight),this.list.scrollTop=a-this.list.querySelectorAll(".e-virtual-list").length*this.selectedLI.offsetHeight}}else if(!g(this.liCollections)){var l=this.activeIndex,h=t.action==="down"?this.activeIndex+1:this.activeIndex-1;h=i?l:h;var u=0;this.getModuleName()==="autocomplete"&&(u=t.action==="down"&&g(this.activeIndex)?0:this.liCollections.length-1,h=h<0?this.liCollections.length-1:h===this.liCollections.length?0:h);var c=void 0;if(this.getModuleName()!=="autocomplete"||this.getModuleName()==="autocomplete"&&this.isPopupOpen)if(!this.enableVirtualization)c=g(this.activeIndex)?this.liCollections[u]:this.liCollections[h];else if(!i)c=g(this.activeIndex)?this.liCollections[this.skeletonCount]:this.liCollections[h],c=!g(c)&&!c.classList.contains("e-virtual-list")?c:null;else if(this.getModuleName()==="autocomplete"){var r=this.getFormattedValue(this.selectedLI.getAttribute("data-value"));c=this.getElementByValue(r)}else c=this.getElementByValue(this.getItemData().value);if(g(c)){if(this.enableVirtualization&&!this.isPopupOpen&&this.getModuleName()!=="autocomplete"&&(this.viewPortInfo.endIndex!==this.totalItemCount&&t.action==="down"||this.viewPortInfo.startIndex!==0&&t.action==="up")){if(t.action==="down"){this.viewPortInfo.startIndex=this.viewPortInfo.startIndex+this.itemCount<this.totalItemCount-this.itemCount?this.viewPortInfo.startIndex+this.itemCount:this.totalItemCount-this.itemCount,this.viewPortInfo.endIndex=this.viewPortInfo.startIndex+this.itemCount,this.updateVirtualItemIndex(),this.isCustomFilter=this.getModuleName()==="combobox"?!0:this.isCustomFilter,this.resetList(this.dataSource,this.fields,this.query),this.isCustomFilter=this.getModuleName()==="combobox"?!1:this.isCustomFilter;var r=this.liCollections[0].getAttribute("data-value")!=="null"?this.getFormattedValue(this.liCollections[0].getAttribute("data-value")):null,p=this.getDataByValue(r);p&&(this.itemData=p)}else if(t.action==="up"){this.viewPortInfo.startIndex=this.viewPortInfo.startIndex-this.itemCount>0?this.viewPortInfo.startIndex-this.itemCount:0,this.viewPortInfo.endIndex=this.viewPortInfo.startIndex+this.itemCount,this.updateVirtualItemIndex(),this.isCustomFilter=this.getModuleName()==="combobox"?!0:this.isCustomFilter,this.resetList(this.dataSource,this.fields,this.query),this.isCustomFilter=this.getModuleName()==="combobox"?!1:this.isCustomFilter;var r=this.liCollections[this.liCollections.length-1].getAttribute("data-value")!=="null"?this.getFormattedValue(this.liCollections[this.liCollections.length-1].getAttribute("data-value")):null,p=this.getDataByValue(r);p&&(this.itemData=p)}this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+le.li),this.ulElement=this.list.querySelector("ul"),this.handleVirtualKeyboardActions(t,this.pageCount)}}else{var d=this.liCollections[this.skeletonCount]&&this.liCollections[this.skeletonCount].classList.contains("e-item-focus");if(this.setSelection(c,t),d&&this.enableVirtualization&&this.getModuleName()==="autocomplete"&&!i){var a=this.virtualListInfo&&this.virtualListInfo.startIndex?this.selectedLI.offsetTop+this.virtualListInfo.startIndex*this.selectedLI.offsetHeight:this.selectedLI.offsetTop;a=this.virtualListInfo&&this.virtualListInfo.startIndex===0&&this.fields.groupBy?this.selectedLI.offsetHeight-a:a-this.selectedLI.offsetHeight,this.list.scrollTop=a-this.list.querySelectorAll(".e-virtual-list").length*this.selectedLI.offsetHeight}}}if(this.allowFiltering&&!this.enableVirtualization&&this.getModuleName()!=="autocomplete"){var r=this.getItemData().value,n=this.getIndexByValueFilter(r,this.actionCompleteData.ulElement);g(n)||(this.activeIndex=n)}this.allowFiltering&&this.getModuleName()==="dropdownlist"&&this.filterInput&&(!g(this.ulElement)&&!g(this.ulElement.getElementsByClassName("e-item-focus")[0])?Ie(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id}):!g(this.ulElement)&&!g(this.ulElement.getElementsByClassName("e-active")[0])&&Ie(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-active")[0].id}));for(var f,h=0;h<this.liCollections.length;h++)if(this.liCollections[h].classList.contains(Qe.focus)||this.liCollections[h].classList.contains(Qe.selected)){f=h;break}f!=null&&this.isDisabledElement(this.liCollections[f])&&(this.getModuleName()!=="autocomplete"&&(this.liCollections.length-1===f&&t.action==="down"&&(t.action="up"),f===0&&t.action==="up"&&(t.action="down")),this.updateUpDownAction(t)),t.preventDefault()}},e.prototype.updateHomeEndAction=function(t,i){if(this.getModuleName()==="dropdownlist"){var r=0;if(t.action==="home"?(r=0,this.enableVirtualization&&this.isPopupOpen?r=this.skeletonCount:this.enableVirtualization&&!this.isPopupOpen&&this.viewPortInfo.startIndex!==0&&(this.viewPortInfo.startIndex=0,this.viewPortInfo.endIndex=this.itemCount,this.updateVirtualItemIndex(),this.resetList(this.dataSource,this.fields,this.query))):(this.enableVirtualization&&!this.isPopupOpen&&this.viewPortInfo.endIndex!==this.totalItemCount&&(this.viewPortInfo.startIndex=this.totalItemCount-this.itemCount,this.viewPortInfo.endIndex=this.totalItemCount,this.updateVirtualItemIndex(),this.resetList(this.dataSource,this.fields,this.query)),r=this.getItems().length-1),t.preventDefault(),this.activeIndex===r){i&&this.setSelection(this.liCollections[r],t);return}if(!this.enableVirtualization&&this.liCollections[r]&&this.liCollections[r].classList.contains("e-disabled"))return;this.setSelection(this.liCollections[r],t)}},e.prototype.selectCurrentValueOnTab=function(t){this.getModuleName()==="autocomplete"?this.selectCurrentItem(t):this.isPopupOpen&&(this.hidePopup(t),this.focusDropDown(t))},e.prototype.mobileKeyActionHandler=function(t){if(this.enabled&&!(this.isEditTextBox()&&!this.isPopupOpen)&&!this.readonly){if(this.list===void 0&&!this.isRequested&&(this.searchKeyEvent=t,this.renderList()),g(this.list)||!g(this.liCollections)&&this.liCollections.length===0||this.isRequested)return;t.action==="enter"&&this.selectCurrentItem(t)}},e.prototype.handleVirtualKeyboardActions=function(t,i){switch(t.action){case"down":case"up":(this.itemData!=null||this.getModuleName()==="autocomplete")&&this.updateUpDownAction(t,!0);break;case"pageUp":this.activeIndex=this.getModuleName()==="autocomplete"?this.getIndexByValue(this.selectedLI.getAttribute("data-value"))+this.getPageCount()-1:this.getIndexByValue(this.previousValue),this.pageUpSelection(this.activeIndex-this.getPageCount(),t,!0),t.preventDefault();break;case"pageDown":this.activeIndex=this.getModuleName()==="autocomplete"?this.getIndexByValue(this.selectedLI.getAttribute("data-value"))-this.getPageCount():this.getIndexByValue(this.previousValue),this.pageDownSelection(g(this.activeIndex)?2*this.getPageCount():this.activeIndex+this.getPageCount(),t,!0),t.preventDefault();break;case"home":this.isMouseScrollAction=!0,this.updateHomeEndAction(t,!0);break;case"end":this.isMouseScrollAction=!0,this.updateHomeEndAction(t,!0);break}this.keyboardEvent=null},e.prototype.selectCurrentItem=function(t){if(this.isPopupOpen){var i=this.list.querySelector("."+Qe.focus);if(this.isDisabledElement(i))return;i&&(this.setSelection(i,t),this.isTyped=!1),this.isSelected&&(this.isSelectCustom=!1,this.onChangeEvent(t)),this.hidePopup(t),this.focusDropDown(t)}else this.showPopup()},e.prototype.isSelectFocusItem=function(t){return!g(t)},e.prototype.pageUpSelection=function(t,i,r){var n=t>=0?this.liCollections[t+1]:this.liCollections[0];if(!this.enableVirtualization&&n&&n.classList.contains("e-disabled")){for(var s=t>=0?t+1:0;s<this.liCollections.length&&(n=this.liCollections[s],!(n&&!n.classList.contains("e-disabled")));)if(s--,s<0)return}this.enableVirtualization&&this.activeIndex==null&&(n=this.liCollections.length>=t&&t>=0?this.liCollections[t+this.skeletonCount+1]:this.liCollections[0]),!g(n)&&n.classList.contains("e-virtual-list")&&(n=this.liCollections[this.skeletonCount]),this.PageUpDownSelection(n,i),this.allowFiltering&&this.getModuleName()==="dropdownlist"&&(!g(this.ulElement)&&!g(this.ulElement.getElementsByClassName("e-item-focus")[0])?Ie(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id}):!g(this.ulElement)&&!g(this.ulElement.getElementsByClassName("e-active")[0])&&Ie(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-active")[0].id}))},e.prototype.PageUpDownSelection=function(t,i){this.enableVirtualization?!g(t)&&(this.getModuleName()!=="autocomplete"&&!t.classList.contains("e-active")||this.getModuleName()==="autocomplete"&&!t.classList.contains("e-item-focus"))&&this.setSelection(t,i):this.setSelection(t,i)},e.prototype.pageDownSelection=function(t,i,r){var n=this.getItems(),s=t<=n.length?this.liCollections[t-1]:this.liCollections[n.length-1];if(!this.enableVirtualization&&s&&s.classList.contains("e-disabled"))for(;t>=0&&t<this.liCollections.length&&(s=t<=n.length?this.liCollections[t-1]:this.liCollections[n.length-1],!(s&&!s.classList.contains("e-disabled")));)t++;this.enableVirtualization&&this.skeletonCount>0&&(t=this.getModuleName()==="dropdownlist"&&this.allowFiltering?t+1:t,s=t<n.length?this.liCollections[t]:this.liCollections[n.length-1]),this.enableVirtualization&&this.activeIndex==null&&(s=t<=n.length?this.liCollections[t+this.skeletonCount-1]:this.liCollections[n.length-1]),this.PageUpDownSelection(s,i),this.allowFiltering&&this.getModuleName()==="dropdownlist"&&(!g(this.ulElement)&&!g(this.ulElement.getElementsByClassName("e-item-focus")[0])?Ie(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id}):!g(this.ulElement)&&!g(this.ulElement.getElementsByClassName("e-active")[0])&&Ie(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-active")[0].id}))},e.prototype.unWireEvent=function(){g(this.inputWrapper)||(E.remove(this.inputWrapper.container,"mousedown",this.dropDownClick),E.remove(this.inputWrapper.container,"keypress",this.onSearch),E.remove(this.inputWrapper.container,"focus",this.focusIn),E.remove(window,"resize",this.windowResize)),this.unBindCommonEvent()},e.prototype.unWireListEvents=function(){this.list&&(E.remove(this.list,"click",this.onMouseClick),E.remove(this.list,"mouseover",this.onMouseOver),E.remove(this.list,"mouseout",this.onMouseLeave))},e.prototype.checkSelector=function(t){return'[id="'+t.replace(/(:|\.|\[|\]|,|=|@|\\|\/|#)/g,"\\$1")+'"]'},e.prototype.onDocumentClick=function(t){var i=t.target;if(!(!g(this.popupObj)&&j(i,this.checkSelector(this.popupObj.element.id)))&&!g(this.inputWrapper)&&!this.inputWrapper.container.contains(t.target)){if(this.inputWrapper.container.classList.contains(Qe.inputFocus)||this.isPopupOpen){this.isDocumentClick=!0;var r=this.isRequested;this.getModuleName()==="combobox"&&this.isTyped&&(this.isInteracted=!1),this.hidePopup(t),this.isInteracted=!1,r||(this.onFocusOut(t),this.inputWrapper.container.classList.remove(Qe.inputFocus))}}else i!==this.inputElement&&!(this.allowFiltering&&i===this.filterInput)&&!(this.getModuleName()==="combobox"&&!this.allowFiltering&&B.isDevice&&i===this.inputWrapper.buttons[0])&&(this.isPreventBlur=(B.isIE||B.info.name==="edge")&&(document.activeElement===this.targetElement()||document.activeElement===this.filterInput),t.preventDefault())},e.prototype.activeStateChange=function(){this.isDocumentClick&&(this.hidePopup(),this.onFocusOut(),this.inputWrapper.container.classList.remove(Qe.inputFocus))},e.prototype.focusDropDown=function(t){!this.initial&&this.isFilterLayout()&&this.focusIn(t)},e.prototype.dropDownClick=function(t){if(!(t.which===3||t.button===2)&&(this.keyboardEvent=null,!(this.targetElement().classList.contains(Qe.disable)||this.inputWrapper.clearButton===t.target))){var i=t.target;if(i!==this.inputElement&&!(this.allowFiltering&&i===this.filterInput)&&this.getModuleName()!=="combobox"&&t.preventDefault(),this.readonly)this.focusIn(t);else{this.isPopupOpen?(this.hidePopup(t),this.isFilterLayout()&&this.focusDropDown(t)):(this.focusIn(t),this.floatLabelChange(),this.queryString=this.inputElement.value.trim()===""?null:this.inputElement.value,this.isDropDownClick=!0,this.showPopup(t));var r=this,n=this.element.tagName===this.getNgDirective()&&this.itemTemplate?500:100;this.isSecondClick||setTimeout(function(){r.cloneElements(),r.isSecondClick=!0,r.isSecondClick=!(r.isReact&&r.isFiltering()&&r.dataSource instanceof re&&!r.list.querySelector("ul"))},n)}}},e.prototype.cloneElements=function(){if(this.list){var t=this.list.querySelector("ul");t&&(t=t.cloneNode?t.cloneNode(!0):t,this.actionCompleteData.ulElement=t)}},e.prototype.updateSelectedItem=function(t,i,r,n){var s=this;this.removeSelection(),t.classList.add(le.selected),this.removeHover();var a=t.getAttribute("data-value")!==null?this.getFormattedValue(t.getAttribute("data-value")):null,l=this.getDataByValue(a);if(!this.initial&&!r&&!g(i)){var h=this.detachChanges(l);this.isSelected=!0;var u={e:i,item:t,itemData:h,isInteracted:!!i,cancel:!1};this.trigger("select",u,function(c){c.cancel?t.classList.remove(le.selected):(s.selectEventCallback(t,i,r,l,a),n&&s.setSelectOptions(t,i))})}else this.selectEventCallback(t,i,r,l,a),n&&this.setSelectOptions(t,i)},e.prototype.selectEventCallback=function(t,i,r,n,s){this.previousItemData=g(this.itemData)?null:this.itemData,this.itemData!==n&&(this.previousValue=g(this.itemData)?null:typeof this.itemData=="object"&&!this.allowObjectBinding?this.checkFieldValue(this.itemData,this.fields.value.split(".")):this.itemData),this.item=t,this.itemData=n;var a=this.list.querySelector("."+le.focus);if(a&&K([a],le.focus),t.setAttribute("aria-selected","true"),g(s)&&(s="null"),this.allowFiltering&&!this.enableVirtualization&&this.getModuleName()!=="autocomplete"){var l=this.getIndexByValueFilter(s,this.actionCompleteData.ulElement);g(l)?this.activeIndex=this.getIndexByValue(s):this.activeIndex=l}else this.enableVirtualization&&this.activeIndex==null&&this.dataSource instanceof re&&(this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+le.li),this.ulElement=this.list.querySelector("ul")),this.activeIndex=this.getIndexByValue(s)},e.prototype.activeItem=function(t){this.isValidLI(t)&&!t.classList.contains(le.selected)&&(this.removeSelection(),t.classList.add(le.selected),this.removeHover(),t.setAttribute("aria-selected","true"))},e.prototype.setValue=function(t){var i=this.getItemData();this.isTouched=!g(t),i.value===null?Ce.setValue(null,this.inputElement,this.floatLabelType,this.showClearButton):Ce.setValue(i.text,this.inputElement,this.floatLabelType,this.showClearButton),this.valueTemplate&&this.itemData!==null?this.setValueTemplate():!g(this.valueTempElement)&&this.inputElement.previousSibling===this.valueTempElement&&(ee(this.valueTempElement),this.inputElement.style.display="block"),!g(i.value)&&!this.enableVirtualization&&this.allowFiltering&&(this.activeIndex=this.getIndexByValueFilter(i.value,this.actionCompleteData.ulElement));var r=Qe.clearIcon,n=this.isFiltering()&&this.filterInput&&this.getModuleName()==="combobox",s=n&&this.filterInput.parentElement.querySelector("."+r);return this.isFiltering()&&s&&s.style.removeProperty("visibility"),!this.allowObjectBinding&&this.previousValue===i.value||this.allowObjectBinding&&this.previousValue!=null&&this.isObjectInArray(this.previousValue,[this.allowCustom&&this.isObjectCustomValue?this.value?this.value:i:i.value?this.getDataByValue(i.value):i])?(this.isSelected=!1,!0):(this.isSelected=!this.initial,this.isSelectCustom=!1,this.getModuleName()==="dropdownlist"&&this.updateIconState(),!1)},e.prototype.setSelection=function(t,i){if(this.isValidLI(t)&&(!t.classList.contains(le.selected)||this.isPopupOpen&&this.isSelected&&t.classList.contains(le.selected)))this.updateSelectedItem(t,i,!1,!0);else if(this.setSelectOptions(t,i),this.enableVirtualization&&this.value){var r=this.isPrimitiveData?"":this.fields.value,n=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value;if(this.dataSource instanceof re){var s=new re(this.virtualGroupDataSource).executeLocal(new Pe().where(new St(r,"equal",n)));if(s&&s.length>0){this.itemData=s[0];var a=this.getItemData(),l=this.allowObjectBinding?this.getDataByValue(a.value):a.value;(this.value===a.value&&this.text!==a.text||this.value!==a.value&&this.text===a.text)&&this.setProperties({text:a.text?a.text.toString():a.text,value:l})}}else{var s=new re(this.dataSource).executeLocal(new Pe().where(new St(r,"equal",n)));if(s&&s.length>0){this.itemData=s[0];var a=this.getItemData(),l=this.allowObjectBinding?this.getDataByValue(a.value):a.value;(this.value===a.value&&this.text!==a.text||this.value!==a.value&&this.text===a.text)&&this.setProperties({text:a.text?a.text.toString():a.text,value:l})}}}},e.prototype.setSelectOptions=function(t,i){this.list&&this.removeHover(),this.previousSelectedLI=g(this.selectedLI)?null:this.selectedLI,this.selectedLI=t,!this.setValue(i)&&((!this.isPopupOpen&&!g(t)||this.isPopupOpen&&!g(i)&&(i.type!=="keydown"||i.type==="keydown"&&i.action==="enter"))&&(this.isSelectCustom=!1,this.onChangeEvent(i)),this.isPopupOpen&&!g(this.selectedLI)&&this.itemData!==null&&(!i||i.type!=="click")&&this.setScrollPosition(i),B.info.name!=="mozilla"&&this.targetElement()&&(Ie(this.targetElement(),{"aria-describedby":this.inputElement.id!==""?this.inputElement.id:this.element.id}),this.targetElement().removeAttribute("aria-live")),this.isPopupOpen&&!g(this.ulElement)&&!g(this.ulElement.getElementsByClassName("e-item-focus")[0])?Ie(this.targetElement(),{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id}):this.isPopupOpen&&!g(this.ulElement)&&!g(this.ulElement.getElementsByClassName("e-active")[0])&&Ie(this.targetElement(),{"aria-activedescendant":this.ulElement.getElementsByClassName("e-active")[0].id}))},e.prototype.dropdownCompiler=function(t){var i=!1;if(typeof t!="function"&&t)try{i=!!document.querySelectorAll(t).length}catch{i=!1}return i},e.prototype.setValueTemplate=function(){var t;this.isReact&&(this.clearTemplate(["valueTemplate"]),this.valueTempElement&&(ee(this.valueTempElement),this.inputElement.style.display="block",this.valueTempElement=null)),this.valueTempElement||(this.valueTempElement=this.createElement("span",{className:Qe.value}),this.inputElement.parentElement.insertBefore(this.valueTempElement,this.inputElement),this.inputElement.style.display="none"),this.isReact||(this.valueTempElement.innerHTML="");var i=this.dropdownCompiler(this.valueTemplate);typeof this.valueTemplate!="function"&&i?t=wt(document.querySelector(this.valueTemplate).innerHTML.trim()):t=wt(this.valueTemplate);var r=t(this.itemData,this,"valueTemplate",this.valueTemplateId,this.isStringTemplate,null,this.valueTempElement);r&&r.length>0&&dt(r,this.valueTempElement),this.renderReactTemplates()},e.prototype.removeSelection=function(){if(this.list){var t=this.list.querySelectorAll("."+le.selected);t.length&&(K(t,le.selected),t[0].removeAttribute("aria-selected"))}},e.prototype.getItemData=function(){var t=this.fields,i=null;i=this.itemData;var r,n;g(i)||(r=V(t.value,i),n=V(t.text,i));var s=!g(i)&&!Ee(r)?r:i,a=!g(i)&&!Ee(r)?n:i;return{value:s,text:a}},e.prototype.onChangeEvent=function(t,i){var r=this,n=this.getItemData(),s=this.isSelectCustom?null:this.activeIndex;if(this.enableVirtualization){var a=this.dataSource instanceof re?this.virtualGroupDataSource:this.dataSource;if(n.value&&a&&a.length>0){var l=a.findIndex(function(u){return!g(n.value)&&V(r.fields.value,u)===n.value});l!==-1&&(s=l)}}var h=this.allowObjectBinding?i?this.value:this.getDataByValue(n.value):n.value;this.setProperties({index:s,text:n.text?n.text.toString():n.text,value:h},!0),this.detachChangeEvent(t)},e.prototype.detachChanges=function(t){var i;return typeof t=="string"||typeof t=="boolean"||typeof t=="number"?i=Object.defineProperties({},{value:{value:t,enumerable:!0},text:{value:t,enumerable:!0}}):i=t,i},e.prototype.detachChangeEvent=function(t){if(this.isSelected=!1,this.previousValue=this.value,this.activeIndex=this.enableVirtualization?this.getIndexByValue(this.value):this.index,this.typedString=g(this.text)?"":this.text,!this.initial){var i=this.detachChanges(this.itemData),r=void 0;typeof this.previousItemData=="string"||typeof this.previousItemData=="boolean"||typeof this.previousItemData=="number"?r=Object.defineProperties({},{value:{value:this.previousItemData,enumerable:!0},text:{value:this.previousItemData,enumerable:!0}}):r=this.previousItemData,this.setHiddenValue();var n={e:t,item:this.item,itemData:i,previousItem:this.previousSelectedLI,previousItemData:r,isInteracted:!!t,value:this.value,element:this.element,event:t};this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",n)}(g(this.value)||this.value==="")&&this.floatLabelType!=="Always"&&K([this.inputWrapper.container],"e-valid-input")},e.prototype.setHiddenValue=function(){if(g(this.value))this.hiddenElement.innerHTML="";else{var t=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value;if(this.hiddenElement.querySelector("option")){var i=this.hiddenElement.querySelector("option");i.textContent=this.text,i.setAttribute("value",t.toString())}else if(!g(this.hiddenElement)){var r=document.createElement("option");r.text=this.text,r.setAttribute("selected",""),this.hiddenElement.appendChild(r);var i=this.hiddenElement.querySelector("option");i.setAttribute("value",t.toString())}}},e.prototype.onFilterUp=function(t){if(!(t.ctrlKey&&t.keyCode===86)&&(this.isValidKey||t.keyCode===40||t.keyCode===38))switch(this.isValidKey=!1,this.filterArgs=t,this.firstItem=this.dataSource&&this.dataSource.length>0?this.dataSource[0]:null,t.keyCode){case 38:case 40:this.getModuleName()==="autocomplete"&&!this.isPopupOpen&&!this.preventAltUp&&!this.isRequested?(this.preventAutoFill=!0,this.searchLists(t)):this.preventAutoFill=!1,this.preventAltUp=!1,this.getModuleName()==="autocomplete"&&!g(this.ulElement)&&!g(this.ulElement.getElementsByClassName("e-item-focus")[0])&&Ie(this.targetElement(),{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id}),t.preventDefault();break;case 46:case 8:this.typedString=this.filterInput.value,!this.isPopupOpen&&this.typedString!==""||this.isPopupOpen&&this.queryString.length>0?(this.preventAutoFill=!0,this.searchLists(t)):this.typedString===""&&this.queryString===""&&this.getModuleName()!=="autocomplete"?(this.preventAutoFill=!0,this.searchLists(t)):this.typedString===""&&(this.list&&this.resetFocusElement(),this.activeIndex=null,this.getModuleName()!=="dropdownlist"&&(this.preventAutoFill=!0,this.searchLists(t),this.getModuleName()==="autocomplete"&&this.hidePopup())),t.preventDefault();break;default:this.isFiltering()&&this.getModuleName()==="combobox"&&g(this.list)&&(this.getInitialData=!0,this.renderList(),!this.isSecondClick&&!this.isDropDownClick&&this.executeCloneElements()),this.typedString=this.filterInput.value,this.preventAutoFill=!1,this.getInitialData||this.searchLists(t),(this.enableVirtualization&&this.getModuleName()!=="autocomplete"||this.getModuleName()==="autocomplete"&&!(this.dataSource instanceof re)||this.getModuleName()==="autocomplete"&&this.dataSource instanceof re&&this.totalItemCount!==0)&&this.getFilteringSkeletonCount();break}else this.isValidKey=!1},e.prototype.onFilterDown=function(t){switch(t.keyCode){case 13:break;case 40:case 38:this.queryString=this.filterInput.value,t.preventDefault();break;case 9:this.isPopupOpen&&this.getModuleName()!=="autocomplete"&&t.preventDefault();break;default:this.prevSelectPoints=this.getSelectionPoints(),this.queryString=this.filterInput.value;break}},e.prototype.removeFillSelection=function(){if(this.isInteracted){var t=this.getSelectionPoints();this.inputElement.setSelectionRange(t.end,t.end)}},e.prototype.getQuery=function(t){var i;if(!this.isCustomFilter&&this.allowFiltering&&this.filterInput){i=t?t.clone():this.query?this.query.clone():new Pe;var r=this.typedString===""?"contains":this.filterType,n=this.typeOfData(this.dataSource).typeof;if(!(this.dataSource instanceof re)&&n==="string"||n==="number")i.where("",r,this.typedString,this.ignoreCase,this.ignoreAccent);else if(this.getModuleName()!=="combobox"||this.isFiltering()&&this.getModuleName()==="combobox"&&this.typedString!==""){var s=this.fields.text?this.fields.text:"";i.where(s,r,this.typedString,this.ignoreCase,this.ignoreAccent)}}else i=this.enableVirtualization&&!g(this.customFilterQuery)?this.customFilterQuery.clone():t?t.clone():this.query?this.query.clone():new Pe;if(this.enableVirtualization&&this.viewPortInfo.endIndex!==0){var a=this.getTakeValue(),l=!1;if(i){for(var h=0;h<i.queries.length;h++)if(i.queries[h].fn==="onSkip"){l=!0;break}}var u=0,c=0;if(i&&i.queries.length>0)for(var h=0;h<i.queries.length;h++)i.queries[h].fn==="onSkip"&&(c=i.queries[h].e.nos),i.queries[h].fn==="onTake"&&(u=a<=i.queries[h].e.nos?i.queries[h].e.nos:a);if(u<=0&&this.query&&this.query.queries.length>0)for(var h=0;h<this.query.queries.length;h++)this.query.queries[h].fn==="onTake"&&(u=a<=this.query.queries[h].e.nos?this.query.queries[h].e.nos:a);var d=!1;if(i&&i.queries.length>0)for(var h=0;h<i.queries.length;h++){if(i.queries[h].fn==="onSkip"){c=i.queries[h].e.nos,i.queries.splice(h,1),l=!1,--h;continue}i.queries[h].fn==="onTake"&&(u=i.queries[h].e.nos<=u?u:i.queries[h].e.nos,i.queries.splice(h,1),--h)}!d&&(this.allowFiltering||!this.isPopupOpen||!l)&&(c>0?i.skip(c):i.skip(this.virtualItemStartIndex)),this.isIncrementalRequest?i.take(this.incrementalEndIndex):u>0?i.take(u):i.take(a),i.requiresCount()}return i},e.prototype.getSelectionPoints=function(){var t=this.inputElement;return{start:Math.abs(t.selectionStart),end:Math.abs(t.selectionEnd)}},e.prototype.searchLists=function(t){var i=this;if(this.isTyped=!0,this.activeIndex=null,this.isListSearched=!0,this.filterInput.parentElement.querySelector("."+Qe.clearIcon)){var r=this.filterInput.parentElement.querySelector("."+Qe.clearIcon);r.style.visibility=this.filterInput.value===""?"hidden":"visible"}if(this.isDataFetched=!1,this.isFiltering()){this.checkAndResetCache(),this.isRequesting=!1;var n={preventDefaultAction:!1,text:this.filterInput.value,updateData:function(s,a,l){n.cancel||(i.isCustomFilter=!0,i.customFilterQuery=a&&a.clone(),i.filteringAction(s,a,l))},baseEventArgs:t,cancel:!1};this.trigger("filtering",n,function(s){!s.cancel&&!i.isCustomFilter&&!s.preventDefaultAction&&i.filteringAction(i.dataSource,null,i.fields)})}},e.prototype.filter=function(t,i,r){this.isCustomFilter=!0,this.filteringAction(t,i,r)},e.prototype.filteringAction=function(t,i,r){if(!g(this.filterInput)){this.beforePopupOpen=!(!this.isPopupOpen&&this.getModuleName()==="combobox"&&this.filterInput.value===""||this.getInitialData);var n=this.list.classList.contains(le.noData);if(this.filterInput.value.trim()===""&&!this.itemTemplate){if(this.actionCompleteData.isUpdated=!1,this.isTyped=!1,!g(this.actionCompleteData.ulElement)&&!g(this.actionCompleteData.list)){if(this.enableVirtualization&&(this.isFiltering()&&(this.isPreventScrollAction=!0,this.list.scrollTop=0,this.previousStartIndex=0,this.virtualListInfo=null),this.totalItemCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.resetList(t,r,i),n&&!this.list.classList.contains(le.noData))){if(!this.list.querySelector(".e-virtual-ddl-content")){var s=this.createElement("div",{className:"e-virtual-ddl-content"});s.style.cssText=this.getTransformValues(),this.list.appendChild(s).appendChild(this.list.querySelector(".e-list-parent"))}if(!this.list.querySelector(".e-virtual-ddl")){var a=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});a.style.cssText=this.GetVirtualTrackHeight(),this.list.parentElement.querySelector(".e-dropdownbase").appendChild(a)}}this.onActionComplete(this.actionCompleteData.ulElement,this.actionCompleteData.list)}this.isTyped=!0,!g(this.itemData)&&this.getModuleName()==="dropdownlist"&&(this.focusIndexItem(),this.setScrollPosition()),this.isNotSearchList=!0}else if(this.isNotSearchList=!1,i=this.filterInput.value.trim()===""?null:i,this.enableVirtualization&&this.isFiltering()&&this.isTyped&&(this.isPreventScrollAction=!0,this.list.scrollTop=0,this.previousStartIndex=0,this.virtualListInfo=null),this.resetList(t,r,i),this.getModuleName()==="dropdownlist"&&this.list.classList.contains(le.noData)&&(this.popupContentElement.setAttribute("role","status"),this.popupContentElement.setAttribute("id","no-record"),Ie(this.filterInputObj.container,{"aria-activedescendant":"no-record"})),this.enableVirtualization&&n&&!this.list.classList.contains(le.noData)){if(!this.list.querySelector(".e-virtual-ddl-content")){var s=this.createElement("div",{className:"e-virtual-ddl-content"});s.style.cssText=this.getTransformValues(),this.list.appendChild(s).appendChild(this.list.querySelector(".e-list-parent"))}if(!this.list.querySelector(".e-virtual-ddl")){var a=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});a.style.cssText=this.GetVirtualTrackHeight(),this.list.parentElement.querySelector(".e-dropdownbase").appendChild(a)}}this.enableVirtualization&&this.getFilteringSkeletonCount(),this.renderReactTemplates(),this.filterInput&&this.filterInput.value===""&&this.getModuleName()==="combobox"&&this.executeCloneElements()}},e.prototype.setSearchBox=function(t){if(this.isFiltering()){var i=t.querySelector("."+Qe.filterParent)?t.querySelector("."+Qe.filterParent):this.createElement("span",{className:Qe.filterParent});this.filterInput=this.createElement("input",{attrs:{type:"text"},className:Qe.filterInput}),this.element.parentNode.insertBefore(this.filterInput,this.element);var r=!1;return B.isDevice&&this.isDeviceFullScreen&&(r=!0),this.filterInputObj=Ce.createInput({element:this.filterInput,buttons:r?[Qe.backIcon,Qe.filterBarClearIcon]:[Qe.filterBarClearIcon],properties:{placeholder:this.filterBarPlaceholder}},this.createElement),g(this.cssClass)||(this.cssClass.split(" ").indexOf("e-outline")!==-1?Y([this.filterInputObj.container],"e-outline"):this.cssClass.split(" ").indexOf("e-filled")!==-1&&Y([this.filterInputObj.container],"e-filled")),dt([this.filterInputObj.container],i),jr([i],t),Ie(this.filterInput,{"aria-disabled":"false",role:"combobox",autocomplete:"off",autocapitalize:"off",spellcheck:"false"}),this.clearIconElement=this.filterInput.parentElement.querySelector("."+Qe.clearIcon),!B.isDevice&&this.clearIconElement&&(E.add(this.clearIconElement,"click",this.clearText,this),this.clearIconElement.style.visibility="hidden"),B.isDevice?this.searchKeyModule=new $i(this.filterInput,{keyAction:this.mobileKeyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}):this.searchKeyModule=new $i(this.filterInput,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}),E.add(this.filterInput,"input",this.onInput,this),E.add(this.filterInput,"keyup",this.onFilterUp,this),E.add(this.filterInput,"keydown",this.onFilterDown,this),E.add(this.filterInput,"blur",this.onBlurHandler,this),E.add(this.filterInput,"paste",this.pasteHandler,this),this.filterInputObj}else return JV},e.prototype.onInput=function(t){!g(t)&&!g(t.data)&&t.data.length>1&&this.autoFill&&(this.getModuleName()==="combobox"||this.getModuleName()==="autocomplete")&&(this.inputElement.value=t.data),this.isValidKey=!0,this.getModuleName()==="combobox"&&this.updateIconState(),B.isDevice&&B.info.name==="mozilla"&&(this.typedString=this.filterInput.value,this.preventAutoFill=!0,this.searchLists(t))},e.prototype.pasteHandler=function(t){var i=this;setTimeout(function(){i.typedString=i.filterInput.value,i.getModuleName()==="combobox"&&i.isFiltering()&&g(i.list)&&i.renderList(),i.searchLists(t)})},e.prototype.onActionFailure=function(t){o.prototype.onActionFailure.call(this,t),this.beforePopupOpen&&this.renderPopup()},e.prototype.getTakeValue=function(){return this.allowFiltering&&this.getModuleName()==="dropdownlist"&&B.isDevice?Math.round(window.outerHeight/this.listItemHeight):this.itemCount},e.prototype.onActionComplete=function(t,i,r,n){var s=this;if(this.dataSource instanceof re&&!g(r)&&!this.virtualGroupDataSource&&(this.totalItemCount=r.count),this.isNotSearchList&&!this.enableVirtualization){this.isNotSearchList=!1;return}if(this.getInitialData){this.updateActionCompleteDataValues(t,i),this.getInitialData=!1,this.isReactTemplateUpdate=!0,this.searchLists(this.filterArgs);return}var a=this.itemCount;if(this.isActive||!g(t)){var l=this.selectedLI?this.selectedLI.cloneNode(!0):null;if(o.prototype.onActionComplete.call(this,t,i,r),this.skeletonCount=this.totalItemCount!==0&&this.totalItemCount<this.itemCount*2&&(!(this.dataSource instanceof re)||this.dataSource instanceof re&&this.totalItemCount<=this.itemCount)?0:this.skeletonCount,this.updateSelectElementData(this.allowFiltering),this.isRequested&&!g(this.searchKeyEvent)&&this.searchKeyEvent.type==="keydown"&&(this.isRequested=!1,this.keyActionHandler(this.searchKeyEvent),this.searchKeyEvent=null),this.isRequested&&!g(this.searchKeyEvent)&&(this.incrementalSearch(this.searchKeyEvent),this.searchKeyEvent=null),this.enableVirtualization||(this.list.scrollTop=0),g(t)||Ie(t,{id:this.element.id+"_options",role:"listbox","aria-hidden":"false","aria-label":"listbox"}),this.initialRemoteRender){if(this.initial=!0,this.activeIndex=this.index,this.initialRemoteRender=!1,this.value&&this.dataSource instanceof re){var h=g(this.fields.value)?this.fields.text:this.fields.value,u=this.allowObjectBinding&&!g(this.value)?V(h,this.value):this.value,c=this.fields.value.split("."),d=i.some(function(y){return g(y[h])&&c.length>1?s.checkFieldValue(y,c)===u:y[h]===u});this.enableVirtualization&&this.virtualGroupDataSource&&(d=this.virtualGroupDataSource.some(function(y){return g(y[h])&&c.length>1?s.checkFieldValue(y,c)===u:y[h]===u})),d?this.updateValues():this.dataSource.executeQuery(this.getQuery(this.query).where(new St(h,"equal",u))).then(function(y){y.result.length>0&&s.addItem(y.result,i.length),s.updateValues()})}else this.updateValues();this.initial=!1}else this.getModuleName()==="autocomplete"&&this.value&&this.setInputValue();if(this.getModuleName()!=="autocomplete"&&this.isFiltering()&&!this.isTyped){if((!this.actionCompleteData.isUpdated||!this.isCustomFilter&&!this.isFilterFocus||g(this.itemData)&&this.allowFiltering&&(this.dataSource instanceof re||!g(this.dataSource)&&!g(this.dataSource.length)&&this.dataSource.length!==0))&&(this.itemTemplate&&(this.element.tagName==="EJS-COMBOBOX"||this.isReact)&&this.allowFiltering?setTimeout(function(){s.updateActionCompleteDataValues(t,i)},0):this.updateActionCompleteDataValues(t,i)),this.isDynamicData){var p=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value;this.itemData=this.getDataByValue(p),this.selectedLI=this.getElementByValue(p),this.isDynamicData=!1}if((this.allowCustom||this.allowFiltering&&!this.isValueInList(i,this.value)&&this.dataSource instanceof re)&&!this.enableVirtualization)this.addNewItem(i,l);else if((this.allowCustom||this.allowFiltering&&this.isValueInList(i,this.value))&&!this.enableVirtualization){var f=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value,v=!g(this.value)&&l&&l.getAttribute("data-value")===f.toString();v&&this.addNewItem(i,l)}(!g(this.itemData)||g(this.itemData)&&this.enableVirtualization)&&(this.getSkeletonCount(),this.skeletonCount=this.totalItemCount!==0&&this.totalItemCount<this.itemCount*2&&(!(this.dataSource instanceof re)||this.dataSource instanceof re&&this.totalItemCount<=this.itemCount)?0:this.skeletonCount,this.UpdateSkeleton(),this.focusIndexItem()),this.enableVirtualization&&this.updateActionCompleteDataValues(t,i)}else if(this.enableVirtualization&&this.getModuleName()!=="autocomplete"&&!this.isFiltering()){var f=this.getItemData().value;this.activeIndex=this.getIndexByValue(f);var m=this.findListElement(this.list,"li","data-value",f);this.selectedLI=m}else this.enableVirtualization&&this.getModuleName()==="autocomplete"&&(this.activeIndex=this.skeletonCount);this.beforePopupOpen&&(this.renderPopup(r),this.enableVirtualization&&(this.list.querySelector(".e-virtual-list")||(this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll(".e-list-item"))),this.enableVirtualization&&a!==this.itemCount&&this.resetList(this.dataSource,this.fields))}},e.prototype.isValueInList=function(t,i){if(Array.isArray(t)){for(var r=0;r<t.length;r++)if(t[r]===i)return!0}else if(typeof t=="object"&&t!==null){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&t[n]===i)return!0}return!1},e.prototype.checkFieldValue=function(t,i){var r=t;return i.forEach(function(n){r=r[n]}),r},e.prototype.updateActionCompleteDataValues=function(t,i){this.actionCompleteData={ulElement:t.cloneNode(!0),list:i,isUpdated:!0},this.actionData.list!==this.actionCompleteData.list&&this.actionCompleteData.ulElement&&this.actionCompleteData.list&&(this.actionData=this.actionCompleteData)},e.prototype.addNewItem=function(t,i){var r=this;if(!g(this.itemData)&&!g(i)){var n=this.getItemData().value,s=t.some(function(a){return(typeof a=="string"||typeof a=="number"||typeof a=="boolean")&&a===n||V(r.fields.value,a)===n});s||this.addItem(this.itemData)}},e.prototype.updateActionCompleteData=function(t,i,r){var n=this;this.getModuleName()!=="autocomplete"&&this.actionCompleteData.ulElement&&(this.itemTemplate&&this.element.tagName==="EJS-COMBOBOX"&&this.allowFiltering?setTimeout(function(){n.actionCompleteDataUpdate(t,i,r)},0):this.actionCompleteDataUpdate(t,i,r))},e.prototype.actionCompleteDataUpdate=function(t,i,r){r!==null?this.actionCompleteData.ulElement.insertBefore(t.cloneNode(!0),this.actionCompleteData.ulElement.childNodes[r]):this.actionCompleteData.ulElement.appendChild(t.cloneNode(!0)),this.isFiltering()&&this.actionCompleteData.list&&this.actionCompleteData.list.indexOf(i)<0&&this.actionCompleteData.list.push(i)},e.prototype.focusIndexItem=function(){var t=this.getItemData().value;this.activeIndex=this.enableVirtualization&&!g(t)||!this.enableVirtualization?this.getIndexByValue(t):this.activeIndex;var i=this.findListElement(this.list,"li","data-value",t);this.selectedLI=i,this.activeItem(i),this.enableVirtualization&&g(i)||this.removeFocus()},e.prototype.updateSelection=function(){var t=this.list.querySelector("."+le.selected);t?(this.setProperties({index:this.getIndexByValue(t.getAttribute("data-value"))}),this.activeIndex=this.index):(this.removeFocus(),this.list.querySelector("."+le.li).classList.add(Qe.focus))},e.prototype.updateSelectionList=function(){var t=this.list&&this.list.querySelector(".e-active");if(!t&&!g(this.value)&&this.getModuleName()!=="autocomplete"){var i=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value):this.value,r=this.findListElement(this.list,"li","data-value",i);r&&r.classList.add("e-active")}},e.prototype.removeFocus=function(){var t=this.list.querySelectorAll("."+Qe.focus);t&&t.length&&K(t,Qe.focus)},e.prototype.renderPopup=function(t){var i=this;if(this.popupObj&&document.body.contains(this.popupObj.element)){this.refreshPopup();return}var r={cancel:!1};this.trigger("beforeOpen",r,function(n){var s;if(n.cancel)i.beforePopupOpen=!1;else{var a=i.createElement("div",{id:i.element.id+"_popup",className:"e-ddl e-popup "+(i.cssClass!==null?i.cssClass:"")});a.setAttribute("aria-label",i.element.id),a.setAttribute("role","dialog");var l=i.setSearchBox(a);if(i.listContainerHeight=i.allowFiltering&&i.getModuleName()==="dropdownlist"&&B.isDevice?Le(Math.round(window.outerHeight).toString()+"px"):Le(i.popupHeight),i.headerTemplate&&(i.setHeaderTemplate(a),i.isUpdateHeaderHeight=i.header.offsetHeight!==0),dt([i.list],a),i.footerTemplate&&(i.setFooterTemplate(a),i.isUpdateFooterHeight=i.footer.offsetHeight!==0),document.body.appendChild(a),a.style.top="0px",s=a.clientHeight,i.enableVirtualization&&i.itemTemplate){var h=a.querySelectorAll("li.e-list-item:not(.e-virtual-list)");i.listItemHeight=h.length>0?Math.ceil(h[0].getBoundingClientRect().height)+parseInt(window.getComputedStyle(h[0]).marginBottom,10):0}if(i.enableVirtualization&&!i.list.classList.contains(le.noData)){if(i.getSkeletonCount(),i.skeletonCount=i.totalItemCount<i.itemCount*2&&(!(i.dataSource instanceof re)||i.dataSource instanceof re&&i.totalItemCount<=i.itemCount)?0:i.skeletonCount,i.list.querySelector(".e-virtual-ddl-content"))i.list.getElementsByClassName("e-virtual-ddl-content")[0].style=i.getTransformValues();else{var u=i.createElement("div",{className:"e-virtual-ddl-content"});u.style.cssText=i.getTransformValues(),i.list.appendChild(u).appendChild(i.list.querySelector(".e-list-parent"))}if(i.UpdateSkeleton(),i.liCollections=i.list.querySelectorAll("."+le.li),i.virtualItemCount=i.itemCount,i.list.querySelector(".e-virtual-ddl"))i.list.getElementsByClassName("e-virtual-ddl")[0].style=i.GetVirtualTrackHeight();else{var c=i.createElement("div",{id:i.element.id+"_popup",className:"e-virtual-ddl"});c.style.cssText=i.GetVirtualTrackHeight(),a.querySelector(".e-dropdownbase").appendChild(c)}}if(a.style.visibility="hidden",i.popupHeight!=="auto"){if(i.searchBoxHeight=0,!g(l.container)&&i.getModuleName()!=="combobox"&&i.getModuleName()!=="autocomplete"&&(i.searchBoxHeight=l.container.parentElement.getBoundingClientRect().height,i.listContainerHeight=(parseInt(i.listContainerHeight,10)-i.searchBoxHeight).toString()+"px"),i.headerTemplate){i.header=i.header?i.header:a.querySelector(".e-ddl-header");var d=Math.round(i.header.getBoundingClientRect().height);i.listContainerHeight=(parseInt(i.listContainerHeight,10)-(d+i.searchBoxHeight)).toString()+"px"}if(i.footerTemplate){i.footer=i.footer?i.footer:a.querySelector(".e-ddl-footer");var d=Math.round(i.footer.getBoundingClientRect().height);i.listContainerHeight=(parseInt(i.listContainerHeight,10)-(d+i.searchBoxHeight)).toString()+"px"}i.list.style.maxHeight=(parseInt(i.listContainerHeight,10)-2).toString()+"px",a.style.maxHeight=Le(i.popupHeight)}else a.style.height="auto";var p=0,f=void 0;if(i.isPreventScrollAction=!0,!g(i.selectedLI)&&!g(i.activeIndex)&&i.activeIndex>=0||i.enableVirtualization?i.setScrollPosition():i.list.scrollTop=0,B.isDevice&&i.isDeviceFullScreen&&!i.allowFiltering&&(i.getModuleName()==="dropdownlist"||i.isDropDownClick&&i.getModuleName()==="combobox")){p=i.getOffsetValue(a);var v=i.isEmptyList()?i.list:i.liCollections[0];g(i.inputElement)||(f=-(parseInt(getComputedStyle(v).textIndent,10)-parseInt(getComputedStyle(i.inputElement).paddingLeft,10)+parseInt(getComputedStyle(i.inputElement.parentElement).borderLeftWidth,10)))}i.createPopup(a,p,f),i.popupContentElement=i.popupObj.element.querySelector(".e-content"),i.getFocusElement(),i.checkCollision(a),B.isDevice&&(parseInt(i.popupWidth.toString(),10)>window.outerWidth&&!(i.getModuleName()==="dropdownlist"&&i.allowFiltering)&&i.popupObj.element.classList.add("e-wide-popup"),i.popupObj.element.classList.add(Qe.device),(i.getModuleName()==="dropdownlist"||i.getModuleName()==="combobox"&&!i.allowFiltering&&i.isDropDownClick)&&(i.popupObj.collision={X:"fit",Y:"fit"}),i.isFilterLayout()&&i.isDeviceFullScreen&&(i.popupObj.element.classList.add(Qe.mobileFilter),i.popupObj.position={X:0,Y:0},i.popupObj.dataBind(),Ie(i.popupObj.element,{style:"left:0px;right:0px;top:0px;bottom:0px;"}),Y([document.body,i.popupObj.element],Qe.popupFullScreen),i.setSearchBoxPosition(),i.backIconElement=l.container.querySelector(".e-back-icon"),i.clearIconElement=l.container.querySelector("."+Qe.clearIcon),E.add(i.backIconElement,"click",i.clickOnBackIcon,i),E.add(i.clearIconElement,"click",i.clearText,i))),a.style.visibility="visible",Y([a],"e-popup-close");for(var m=i.popupObj.getScrollableParent(i.inputWrapper.container),y=0,S=m;y<S.length;y++){var b=S[y];E.add(b,"scroll",i.scrollHandler,i)}g(i.list)||(i.unWireListEvents(),i.wireListEvents()),i.selectedElementID=i.selectedLI?i.selectedLI.id:null,i.enableVirtualization&&(i.notify("bindScrollEvent",{module:"VirtualScroll",component:i.getModuleName(),enable:i.enableVirtualization}),setTimeout(function(){(i.value||i.list.querySelector(".e-active"))&&(i.updateSelectionList(),i.selectedValueInfo&&i.viewPortInfo&&i.viewPortInfo.offsets.top?i.list.scrollTop=i.viewPortInfo.offsets.top:i.scrollBottom(!0,!0))},5)),Ie(i.targetElement(),{"aria-expanded":"true","aria-owns":i.element.id+"_popup","aria-controls":i.element.id}),i.getModuleName()!=="dropdownlist"&&i.list.classList.contains("e-nodata")&&(Ie(i.targetElement(),{"aria-activedescendant":"no-record"}),i.popupContentElement.setAttribute("role","status"),i.popupContentElement.setAttribute("id","no-record")),i.inputElement.setAttribute("aria-expanded","true"),i.inputElement.setAttribute("aria-controls",i.element.id+"_popup");var w=i.isFiltering()?i.filterInput.parentElement:i.inputWrapper.container;Y([w],[Qe.inputFocus]);var I={name:"FadeIn",duration:100};i.beforePopupOpen=!0;var x=i.popupObj,M={popup:x,event:t,cancel:!1,animation:I};if(i.trigger("open",M,function(A){A.cancel?(i.beforePopupOpen=!1,i.destroyPopup()):(g(i.inputWrapper)||Y([i.inputWrapper.container],[Qe.iconAnimation]),i.renderReactTemplates(),i.isReact&&i.isFiltering()&&i.dataSource instanceof re&&i.list.querySelector("ul")&&!i.isSecondClick&&i.executeCloneElements(),g(i.popupObj)||i.popupObj.show(new It(A.animation),i.zIndex===1e3?i.element:null),i.isReact&&setTimeout(function(){if(i.popupHeight&&i.list&&i.popupHeight!=="auto"&&!(i.getModuleName()==="dropdownlist"&&i.allowFiltering)){var L=typeof i.popupHeight=="string"?parseInt(i.popupHeight,10):i.popupHeight;if(!i.isUpdateHeaderHeight&&i.headerTemplate&&i.header){var T=i.list.style.maxHeight===""?L:parseInt(i.list.style.maxHeight,10);i.list.style.maxHeight=(T-i.header.offsetHeight).toString()+"px",i.isUpdateHeaderHeight=!0}if(!i.isUpdateFooterHeight&&i.footerTemplate&&i.footer){var T=i.list.style.maxHeight===""?L:parseInt(i.list.style.maxHeight,10);i.list.style.maxHeight=(T-i.footer.offsetHeight).toString()+"px",i.isUpdateFooterHeight=!0}}},15))}),i.allowResize&&(i.getModuleName()!=="dropdownlist"||!(B.isDevice&&i.isDeviceFullScreen&&i.allowFiltering))){var D=16;i.resizer=i.createElement("div",{id:i.element.id+"_resize-popup",className:Qe.resizeIcon}),i.list&&i.list.parentElement&&(i.list.parentElement.classList.add("e-resize"),i.popupHeight.toString().toLowerCase()!=="auto"&&s>=parseInt(i.popupHeight.toString(),10)-2&&(i.list.parentElement.style.height="100%"),i.list.parentElement.style.paddingBottom=i.getModuleName()==="dropdownlist"&&i.allowFiltering&&i.searchBoxHeight?(i.searchBoxHeight+D).toString()+"px":D.toString()+"px",(i.header||i.footer||i.itemTemplate)&&(i.list.parentElement.style.paddingBottom=(parseInt(i.list.parentElement.style.maxHeight,10)-parseInt(i.list.style.maxHeight,10)+D).toString()+"px"),i.list.parentElement.appendChild(i.resizer),i.list.parentElement.style.width=i.resizeWidth+"px",i.list.parentElement.style.height=i.resizeHeight+"px",i.list.parentElement.style.maxHeight=i.resizeHeight+"px",i.list.style.maxHeight=i.resizeHeight+"px"),E.add(i.resizer,"mousedown",i.startResizing,i),E.add(i.resizer,"touchstart",i.startResizing,i)}}})},e.prototype.checkCollision=function(t){if(!B.isDevice||B.isDevice&&!(this.getModuleName()==="dropdownlist"||this.isDropDownClick)){var i=is(t);i.length>0&&(t.style.marginTop=-parseInt(getComputedStyle(t).marginTop,10)+"px"),this.popupObj.resolveCollision()}},e.prototype.getOffsetValue=function(t){var i=getComputedStyle(t),r=parseInt(i.borderTopWidth,10),n=parseInt(i.borderBottomWidth,10);return this.setPopupPosition(r+n)},e.prototype.createPopup=function(t,i,r){var n=this;this.popupObj=new Gn(t,{width:this.setWidth(),targetType:"relative",relateTo:this.inputWrapper.container,collision:this.enableRtl?{X:"fit",Y:"flip"}:{X:"flip",Y:"flip"},offsetY:i,enableRtl:this.enableRtl,offsetX:r,position:this.enableRtl?{X:"right",Y:"bottom"}:{X:"left",Y:"bottom"},zIndex:this.zIndex,close:function(){n.isDocumentClick||n.focusDropDown(),n.isReact&&n.clearTemplate(["headerTemplate","footerTemplate"]),n.isNotSearchList=!1,n.isDocumentClick=!1,n.destroyPopup(),n.isFiltering()&&n.actionCompleteData.list&&n.actionCompleteData.list.length>0?(n.isActive=!0,n.isReactTemplateUpdate&&n.isReact&&n.itemTemplate&&!n.enableVirtualization&&(n.actionCompleteData.ulElement=n.renderItems(n.actionCompleteData.list,n.fields),n.isReactTemplateUpdate=!1),n.enableVirtualization?n.onActionComplete(n.ulElement,n.listData,null,!0):n.onActionComplete(n.actionCompleteData.ulElement,n.actionCompleteData.list,null,!0)):n.enableVirtualization&&n.focusIndexItem()},open:function(){E.add(document,"mousedown",n.onDocumentClick,n),n.isPopupOpen=!0;var s=n.actionCompleteData&&n.actionCompleteData.ulElement&&n.actionCompleteData.ulElement.querySelector("li"),a=n.list.querySelector("ul li");!g(n.ulElement)&&!g(n.ulElement.getElementsByClassName("e-item-focus")[0])?Ie(n.targetElement(),{"aria-activedescendant":n.ulElement.getElementsByClassName("e-item-focus")[0].id}):!g(n.ulElement)&&!g(n.ulElement.getElementsByClassName("e-active")[0])&&Ie(n.targetElement(),{"aria-activedescendant":n.ulElement.getElementsByClassName("e-active")[0].id}),n.isFiltering()&&n.itemTemplate&&n.element.tagName===n.getNgDirective()&&s&&a&&s.textContent!==a.textContent&&n.element.tagName!=="EJS-COMBOBOX"&&n.cloneElements(),n.isFilterLayout()&&(K([n.inputWrapper.container],[Qe.inputFocus]),n.isFilterFocus=!0,n.filterInput.focus(),n.inputWrapper.clearButton&&Y([n.inputWrapper.clearButton],Qe.clearIconHide)),n.activeStateChange()},targetExitViewport:function(){B.isDevice||n.hidePopup()}})},e.prototype.isEmptyList=function(){return!g(this.liCollections)&&this.liCollections.length===0},e.prototype.getFocusElement=function(){},e.prototype.isFilterLayout=function(){return this.getModuleName()==="dropdownlist"&&this.allowFiltering},e.prototype.scrollHandler=function(){B.isDevice&&(this.getModuleName()==="dropdownlist"&&!this.isFilterLayout()||this.getModuleName()==="combobox"&&!this.allowFiltering&&this.isDropDownClick)&&this.element&&!this.isElementInViewport(this.element)&&this.hidePopup()},e.prototype.isElementInViewport=function(t){var i=t.getBoundingClientRect();return i.top>=0&&i.left>=0&&i.bottom<=window.innerHeight&&i.right<=window.innerWidth},e.prototype.setSearchBoxPosition=function(){var t=this.filterInput.parentElement.getBoundingClientRect().height;this.popupObj.element.style.maxHeight="100%",this.popupObj.element.style.width="100%",this.list.style.maxHeight=window.innerHeight-t+"px",this.list.style.height=window.innerHeight-t+"px";var i=this.filterInput.parentElement.querySelector("."+Qe.clearIcon);ee(this.filterInput),i.parentElement.insertBefore(this.filterInput,i)},e.prototype.setPopupPosition=function(t){var i,r=t,n=this.list.querySelector("."+Qe.focus)||this.selectedLI,s=this.isEmptyList()?this.list:this.liCollections[0],a=this.isEmptyList()?this.list:this.liCollections[this.getItems().length-1],l=s.getBoundingClientRect().height;this.listItemHeight=l+parseInt(window.getComputedStyle(s).marginBottom,10);var h=this.list.offsetHeight/2,u=g(n)?s.offsetTop:n.offsetTop,c=a.offsetTop;if(c-h<u&&!g(this.liCollections)&&this.liCollections.length>0&&!g(n)){var d=this.list.offsetHeight/l,p=parseInt(getComputedStyle(this.list).paddingBottom,10);i=(d-(this.liCollections.length-this.activeIndex))*l-r+p,this.list.scrollTop=n.offsetTop}else u>h&&!this.enableVirtualization?(i=h-l/2,this.list.scrollTop=u-h+l/2):i=u;var f=this.inputWrapper.container.offsetHeight;return i=i+l+r-(l-f)/2,-i},e.prototype.setWidth=function(){var t=Le(this.popupWidth);if(t.indexOf("%")>-1){var i=this.inputWrapper.container.offsetWidth*parseFloat(t)/100;t=i.toString()+"px"}if(B.isDevice&&t.indexOf("px")>-1&&!this.allowFiltering&&(this.getModuleName()==="dropdownlist"||this.isDropDownClick&&this.getModuleName()==="combobox")){var r=this.isEmptyList()?this.list:this.liCollections[0];t=parseInt(t,10)+(parseInt(getComputedStyle(r).textIndent,10)-parseInt(getComputedStyle(this.inputElement).paddingLeft,10)+parseInt(getComputedStyle(this.inputElement.parentElement).borderLeftWidth,10))*2+"px"}return t},e.prototype.scrollBottom=function(t,i,r){var n=this;if(i===void 0&&(i=!1),r===void 0&&(r=null),g(this.selectedLI)&&this.enableVirtualization&&(this.selectedLI=this.list.querySelector("."+le.li),!g(this.selectedLI)&&this.selectedLI.classList.contains("e-virtual-list")&&(this.selectedLI=this.liCollections[this.skeletonCount])),!g(this.selectedLI)){var s=this.selectedLI&&!isNaN(parseInt(window.getComputedStyle(this.selectedLI).marginBottom,10))?parseInt(window.getComputedStyle(this.selectedLI).marginBottom,10):0;this.isUpwardScrolling=!1;var a=this.list.querySelectorAll(".e-virtual-list").length,l=this.list.querySelector("li:last-of-type")?this.list.querySelector("li:last-of-type").getAttribute("data-value"):null,h=this.virtualListInfo&&this.virtualListInfo.startIndex?this.selectedLI.offsetTop+this.virtualListInfo.startIndex*(this.selectedLI.offsetHeight+s):this.selectedLI.offsetTop,u=this.list.offsetHeight,c=h-a*(this.selectedLI.offsetHeight+s)+(this.selectedLI.offsetHeight+s)-this.list.scrollTop,d=this.list.scrollTop+c-u,p=!1;d=t?d+parseInt(getComputedStyle(this.list).paddingTop,10)*2:d+parseInt(getComputedStyle(this.list).paddingTop,10);var f=h-a*(this.selectedLI.offsetHeight+s)+(this.selectedLI.offsetHeight+s)-this.list.scrollTop;if(f=this.fields.groupBy&&!g(this.fixedHeaderElement)?f-this.fixedHeaderElement.offsetHeight:f,this.activeIndex===0&&!this.enableVirtualization)this.list.scrollTop=0,p=this.isKeyBoardAction;else if(c>u||!(f>0&&this.list.offsetHeight>f)){var v=this.selectedLI?this.selectedLI.getAttribute("data-value"):null,m=r==="pageDown"?this.getPageCount()-2:1;!this.enableVirtualization||this.isKeyBoardAction||i?this.isKeyBoardAction&&this.enableVirtualization&&l&&v===l&&r!=="end"&&!this.isVirtualScrolling?(this.isPreventKeyAction=!0,this.enableVirtualization&&this.itemTemplate?this.list.scrollTop+=d:(this.enableVirtualization&&(m=r==="pageDown"?this.getPageCount()+1:m),this.list.scrollTop+=(this.selectedLI.offsetHeight+s)*m),this.isPreventKeyAction=this.IsScrollerAtEnd()?!1:this.isPreventKeyAction,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1):this.enableVirtualization&&r==="end"?(this.isPreventKeyAction=!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1,this.list.scrollTop=this.list.scrollHeight):(r==="pageDown"&&this.enableVirtualization&&!this.isVirtualScrolling&&(this.isPreventKeyAction=!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1),this.list.scrollTop=d):this.list.scrollTop=this.virtualListInfo&&this.virtualListInfo.startIndex?t&&this.virtualListInfo.startIndex?this.virtualListInfo.startIndex*this.listItemHeight+this.listItemHeight*2:this.virtualListInfo.startIndex*this.listItemHeight:0,p=this.isKeyBoardAction}this.isKeyBoardAction=p,this.enableVirtualization&&this.fields.groupBy&&this.fixedHeaderElement&&r==="down"&&setTimeout(function(){n.scrollStop(null,!0)},100)}},e.prototype.scrollTop=function(t){if(t===void 0&&(t=null),!g(this.selectedLI)){var i=this.selectedLI&&!isNaN(parseInt(window.getComputedStyle(this.selectedLI).marginBottom,10))?parseInt(window.getComputedStyle(this.selectedLI).marginBottom,10):0,r=this.list.querySelectorAll(".e-virtual-list").length,n=this.virtualListInfo&&this.virtualListInfo.startIndex?this.selectedLI.offsetTop+this.virtualListInfo.startIndex*(this.selectedLI.offsetHeight+i):this.selectedLI.offsetTop,s=n-r*(this.selectedLI.offsetHeight+i)-this.list.scrollTop,a=this.list.querySelector("li.e-list-item:not(.e-virtual-list)")?this.list.querySelector("li.e-list-item:not(.e-virtual-list)").getAttribute("data-value"):null;s=this.fields.groupBy&&!g(this.fixedHeaderElement)?s-this.fixedHeaderElement.offsetHeight:s;var l=n-r*(this.selectedLI.offsetHeight+i)+(this.selectedLI.offsetHeight+i)-this.list.scrollTop,h=this.enableVirtualization&&this.getModuleName()==="autocomplete"&&s<=0;if(this.activeIndex===0&&!this.enableVirtualization)this.list.scrollTop=0;else if(s<0||h){var u=this.selectedLI?this.selectedLI.getAttribute("data-value"):null,c=t==="pageUp"?this.getPageCount()-2:1;this.enableVirtualization&&(c=t==="pageUp"?this.getPageCount():c),this.enableVirtualization&&this.isKeyBoardAction&&a&&u===a&&t!=="home"&&!this.isVirtualScrolling?(this.isUpwardScrolling=!0,this.isPreventKeyAction=!0,this.list.scrollTop-=(this.selectedLI.offsetHeight+i)*c,this.isPreventKeyAction=this.list.scrollTop!==0?this.isPreventKeyAction:!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1):this.enableVirtualization&&t==="home"?(this.isPreventScrollAction=!1,this.isPreventKeyAction=!0,this.isKeyBoardAction=!1,this.list.scrollTo(0,0)):(t==="pageUp"&&this.enableVirtualization&&!this.isVirtualScrolling&&(this.isPreventKeyAction=!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1),this.list.scrollTop=this.list.scrollTop+s)}else l>0&&this.list.offsetHeight>l||(this.list.scrollTop=this.selectedLI.offsetTop-(this.fields.groupBy&&!g(this.fixedHeaderElement)?this.fixedHeaderElement.offsetHeight:0))}},e.prototype.IsScrollerAtEnd=function(){return this.list&&this.list.scrollTop+this.list.clientHeight>=this.list.scrollHeight},e.prototype.isEditTextBox=function(){return!1},e.prototype.isFiltering=function(){return this.allowFiltering},e.prototype.isPopupButton=function(){return!0},e.prototype.setScrollPosition=function(t){if(this.isPreventScrollAction=!0,g(t))this.scrollBottom(!0);else switch(t.action){case"pageDown":case"down":case"end":this.isKeyBoardAction=!0,this.scrollBottom(!1,!1,t.action);break;default:this.isKeyBoardAction=t.action==="up"||t.action==="pageUp"||t.action==="open",this.scrollTop(t.action);break}this.isKeyBoardAction=!1},e.prototype.clearText=function(){this.filterInput.value=this.typedString="",this.searchLists(null),this.enableVirtualization&&(this.list.scrollTop=0,this.totalItemCount=this.dataCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.list.getElementsByClassName("e-virtual-ddl")[0]&&(this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight()),this.getSkeletonCount(),this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll(".e-list-item"),this.list.getElementsByClassName("e-virtual-ddl-content")[0]&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues()))},e.prototype.setEleWidth=function(t){g(t)||(typeof t=="number"?this.inputWrapper.container.style.width=Le(t):typeof t=="string"&&(this.inputWrapper.container.style.width=t.match(/px|%|em/)?t:Le(t)))},e.prototype.closePopup=function(t,i){var r=this,n=!g(this.filterInput)&&!g(this.filterInput.value)&&this.filterInput.value!=="",s=this.getModuleName()==="combobox"?this.typedString:null;if(this.isTyped=!1,this.isVirtualTrackHeight=!1,!!(this.popupObj&&document.body.contains(this.popupObj.element)&&this.beforePopupOpen)){this.keyboardEvent=null,E.remove(document,"mousedown",this.onDocumentClick),this.isActive=!1,this.isDropDownClick=!1,this.preventAutoFill=!1;for(var a=this.popupObj.getScrollableParent(this.inputWrapper.container),l=0,h=a;l<h.length;l++){var u=h[l];E.remove(u,"scroll",this.scrollHandler)}B.isDevice&&this.isFilterLayout()&&this.isDeviceFullScreen&&K([document.body,this.popupObj.element],Qe.popupFullScreen),this.isFilterLayout()&&(B.isDevice||(this.searchKeyModule.destroy(),this.clearIconElement&&E.remove(this.clearIconElement,"click",this.clearText)),this.backIconElement&&(E.remove(this.backIconElement,"click",this.clickOnBackIcon),E.remove(this.clearIconElement,"click",this.clearText)),g(this.filterInput)||(E.remove(this.filterInput,"input",this.onInput),E.remove(this.filterInput,"keyup",this.onFilterUp),E.remove(this.filterInput,"keydown",this.onFilterDown),E.remove(this.filterInput,"blur",this.onBlurHandler),E.remove(this.filterInput,"paste",this.pasteHandler)),this.allowFiltering&&this.getModuleName()==="dropdownlist"&&(this.filterInput.removeAttribute("aria-activedescendant"),this.filterInput.removeAttribute("aria-disabled"),this.filterInput.removeAttribute("role"),this.filterInput.removeAttribute("autocomplete"),this.filterInput.removeAttribute("autocapitalize"),this.filterInput.removeAttribute("spellcheck")),this.filterInput=null),Ie(this.targetElement(),{"aria-expanded":"false"}),this.inputElement.setAttribute("aria-expanded","false"),this.targetElement().removeAttribute("aria-owns"),this.targetElement().removeAttribute("aria-activedescendant"),this.inputWrapper.container.classList.remove(Qe.iconAnimation),this.isFiltering()&&(this.actionCompleteData.isUpdated=!1),this.enableVirtualization&&(this.value==null||this.isTyped?(this.viewPortInfo.endIndex=this.viewPortInfo&&this.viewPortInfo.endIndex>0?this.viewPortInfo.endIndex:this.itemCount,(this.getModuleName()==="autocomplete"||this.getModuleName()==="dropdownlist"&&!g(this.typedString)&&this.typedString!==""||this.getModuleName()==="combobox"&&this.allowFiltering&&!g(this.typedString)&&this.typedString!=="")&&this.checkAndResetCache()):this.getModuleName()==="autocomplete"&&this.checkAndResetCache(),(this.getModuleName()==="dropdownlist"||this.getModuleName()==="combobox")&&this.skeletonCount!==0&&this.getSkeletonCount(!0)),this.beforePopupOpen=!1;var c={name:"FadeOut",duration:100,delay:t||0},d=this.popupObj,p={popup:d,cancel:!1,animation:c,event:i||null};this.trigger("close",p,function(v){if(r.getModuleName()==="dropdownlist"&&Ce.destroy({element:r.filterInput,floatLabelType:r.floatLabelType,properties:{placeholder:r.filterBarPlaceholder},buttons:r.clearIconElement},r.clearIconElement),r.filterInputObj=null,!g(r.popupObj)&&!g(r.popupObj.element.querySelector(".e-fixed-head"))){var m=r.popupObj.element.querySelector(".e-fixed-head");m.parentNode.removeChild(m),r.fixedHeaderElement=null}v.cancel||(r.getModuleName()==="autocomplete"&&r.rippleFun(),r.isPopupOpen?r.popupObj.hide(new It(v.animation)):r.destroyPopup())}),B.isDevice&&!p.cancel&&this.popupObj.element.classList.contains("e-wide-popup")&&this.popupObj.element.classList.remove("e-wide-popup");var f;this.dataSource instanceof re?f=this.virtualGroupDataSource&&this.virtualGroupDataSource.length?this.virtualGroupDataSource.length:0:f=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.enableVirtualization&&this.isFiltering()&&n&&this.totalItemCount!==f&&(this.updateInitialData(),this.checkAndResetCache())}},e.prototype.updateInitialData=function(){var t=this.selectData;if(!g(t)){var i=this.renderItems(t,this.fields);if(this.list.scrollTop=0,this.virtualListInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:this.itemCount},this.getModuleName()==="combobox"&&(this.typedString=""),this.previousStartIndex=0,this.previousEndIndex=0,this.dataSource instanceof re?this.remoteDataCount>=0?this.totalItemCount=this.dataCount=this.remoteDataCount:this.resetList(this.dataSource):this.totalItemCount=this.dataCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.list.getElementsByClassName("e-virtual-ddl")[0])this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight();else if(!this.list.querySelector(".e-virtual-ddl")&&this.list.parentElement){var r=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});r.style.cssText=this.GetVirtualTrackHeight(),this.list.parentElement.querySelector(".e-dropdownbase").appendChild(r)}this.getModuleName()!=="autocomplete"&&this.totalItemCount!==0&&this.totalItemCount>this.itemCount*2&&this.getSkeletonCount(),this.UpdateSkeleton(),this.listData=t,this.updateActionCompleteDataValues(i,t),this.liCollections=this.list.querySelectorAll(".e-list-item"),this.list.getElementsByClassName("e-virtual-ddl-content")[0]&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues())}},e.prototype.destroyPopup=function(){this.isPopupOpen=!1,this.isFilterFocus=!1,this.inputElement.removeAttribute("aria-controls"),this.popupObj&&(this.resizer&&(E.remove(this.resizer,"mousedown",this.startResizing),E.remove(this.resizer,"touchstart",this.startResizing)),this.popupObj.destroy(),ee(this.popupObj.element))},e.prototype.clickOnBackIcon=function(){this.hidePopup(),this.focusIn()},e.prototype.render=function(){this.preselectedIndex=g(this.index)?null:this.index,this.element.tagName==="INPUT"?(this.inputElement=this.element,g(this.inputElement.getAttribute("role"))&&this.inputElement.setAttribute("role","combobox"),g(this.inputElement.getAttribute("type"))&&this.inputElement.setAttribute("type","text"),this.inputElement.setAttribute("aria-expanded","false")):(this.inputElement=this.createElement("input",{attrs:{role:"combobox",type:"text"}}),this.element.tagName!==this.getNgDirective()&&(this.element.style.display="none"),this.element.parentElement.insertBefore(this.inputElement,this.element),this.preventTabIndex(this.inputElement));var t=this.cssClass;!g(this.cssClass)&&this.cssClass!==""&&(t=this.cssClass.replace(/\s+/g," ").trim()),!g(j(this.element,"fieldset"))&&j(this.element,"fieldset").disabled&&(this.enabled=!1),this.inputWrapper=Ce.createInput({element:this.inputElement,buttons:this.isPopupButton()?[Qe.icon]:null,floatLabelType:this.floatLabelType,properties:{readonly:this.getModuleName()==="dropdownlist"?!0:this.readonly,placeholder:this.placeholder,cssClass:t,enabled:this.enabled,enableRtl:this.enableRtl,showClearButton:this.showClearButton}},this.createElement),this.element.tagName===this.getNgDirective()?this.element.appendChild(this.inputWrapper.container):this.inputElement.parentElement.insertBefore(this.element,this.inputElement),this.hiddenElement=this.createElement("select",{attrs:{"aria-hidden":"true",tabindex:"-1",class:Qe.hiddenElement}}),jr([this.hiddenElement],this.inputWrapper.container),this.hiddenElement.hasAttribute("aria-label")||this.hiddenElement.setAttribute("aria-label",this.getModuleName()),this.validationAttribute(this.element,this.hiddenElement),this.setReadOnly(),this.setFields(),this.inputWrapper.container.style.width=Le(this.width),this.inputWrapper.container.classList.add("e-ddl"),this.floatLabelType!=="Never"&&Ce.calculateWidth(this.inputElement,this.inputWrapper.container),!g(this.inputWrapper.buttons[0])&&this.inputWrapper.container.getElementsByClassName("e-float-text-content")[0]&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-content")[0].classList.add("e-icon"),this.wireEvent(),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex");var i=this.element.getAttribute("id")?this.element.getAttribute("id"):kt("ej2_dropdownlist");if(this.element.id=i,this.hiddenElement.id=i+"_hidden",this.targetElement().setAttribute("tabindex",this.tabIndex),(this.getModuleName()==="autocomplete"||this.getModuleName()==="combobox")&&!this.readonly?this.inputElement.hasAttribute("aria-label")||this.inputElement.setAttribute("aria-label",this.getModuleName()):this.getModuleName()==="dropdownlist"&&(this.targetElement().hasAttribute("aria-label")||Ie(this.targetElement(),{"aria-label":this.getModuleName()}),this.inputElement.hasAttribute("aria-label")||this.inputElement.setAttribute("aria-label",this.getModuleName()),this.inputElement.setAttribute("aria-expanded","false")),Ie(this.targetElement(),this.getAriaAttributes()),this.updateDataAttribute(this.htmlAttributes),this.setHTMLAttributes(),this.targetElement()===this.inputElement&&this.inputElement.removeAttribute("aria-labelledby"),this.value!==null||this.activeIndex!==null||this.text!==null)this.enableVirtualization&&(this.listItemHeight=this.getListHeight(),this.getSkeletonCount(),this.updateVirtualizationProperties(this.itemCount,this.allowFiltering),this.index!==null&&(this.activeIndex=this.index+this.skeletonCount)),this.initValue(),this.selectedValueInfo=this.viewPortInfo,this.enableVirtualization&&(this.activeIndex=this.activeIndex+this.skeletonCount);else if(this.element.tagName==="SELECT"&&this.element.options[0]){var r=this.element;this.value=this.allowObjectBinding?this.getDataByValue(r.options[r.selectedIndex].value):r.options[r.selectedIndex].value,this.text=g(this.value)?null:r.options[r.selectedIndex].textContent,this.initValue()}this.setEnabled(),this.preventTabIndex(this.element),this.enabled||(this.targetElement().tabIndex=-1),this.initial=!1,this.element.style.opacity="",this.inputElement.onselect=function(s){s.stopImmediatePropagation()},this.inputElement.onchange=function(s){s.stopImmediatePropagation()},this.element.hasAttribute("autofocus")&&this.focusIn(),g(this.text)||this.inputElement.setAttribute("value",this.text),this.element.hasAttribute("data-val")&&this.element.setAttribute("data-val","false");var n=this.inputWrapper.container.getElementsByClassName("e-float-text")[0];!g(this.element.id)&&this.element.id!==""&&!g(n)&&(n.id="label_"+this.element.id.replace(/ /g,"_"),Ie(this.inputElement,{"aria-labelledby":n.id})),this.renderComplete(),this.listItemHeight=this.getListHeight(),this.getSkeletonCount(),this.enableVirtualization&&this.updateVirtualizationProperties(this.itemCount,this.allowFiltering),this.viewPortInfo.startIndex=this.virtualItemStartIndex=0,this.viewPortInfo.endIndex=this.virtualItemEndIndex=this.viewPortInfo.startIndex>0?this.viewPortInfo.endIndex:this.itemCount},e.prototype.getListHeight=function(){var t=this.createElement("div",{className:"e-dropdownbase"}),i=this.createElement("li",{className:"e-list-item"}),r=Le(this.popupHeight);t.style.height=parseInt(r,10).toString()+"px",t.appendChild(i),document.body.appendChild(t),this.virtualListHeight=t.getBoundingClientRect().height;var n=Math.ceil(i.getBoundingClientRect().height)+parseInt(window.getComputedStyle(i).marginBottom,10);return t.remove(),n},e.prototype.setFooterTemplate=function(t){var i;this.footer?this.isReact&&typeof this.footerTemplate=="function"?this.clearTemplate(["footerTemplate"]):this.footer.innerHTML="":(this.footer=this.createElement("div"),Y([this.footer],Qe.footer));var r=this.dropdownCompiler(this.footerTemplate);typeof this.footerTemplate!="function"&&r?i=wt(X(this.footerTemplate,document).innerHTML.trim()):i=wt(this.footerTemplate);var n=i({},this,"footerTemplate",this.footerTemplateId,this.isStringTemplate,null,this.footer);n&&n.length>0&&dt(n,this.footer),dt([this.footer],t)},e.prototype.setHeaderTemplate=function(t){var i;this.header?this.header.innerHTML="":(this.header=this.createElement("div"),Y([this.header],Qe.header));var r=this.dropdownCompiler(this.headerTemplate);typeof this.headerTemplate!="function"&&r?i=wt(X(this.headerTemplate,document).innerHTML.trim()):i=wt(this.headerTemplate);var n=i({},this,"headerTemplate",this.headerTemplateId,this.isStringTemplate,null,this.header);n&&n.length&&dt(n,this.header);var s=t.querySelector("div.e-content");t.insertBefore(this.header,s)},e.prototype.setEnabled=function(){this.element.setAttribute("aria-disabled",this.enabled?"false":"true")},e.prototype.setOldText=function(t){this.text=t},e.prototype.setOldValue=function(t){this.value=t},e.prototype.refreshPopup=function(){!g(this.popupObj)&&document.body.contains(this.popupObj.element)&&(this.allowFiltering&&!(B.isDevice&&this.isFilterLayout())||this.getModuleName()==="autocomplete")&&(K([this.popupObj.element],"e-popup-close"),this.popupObj.refreshPosition(this.inputWrapper.container),this.popupObj.resolveCollision())},e.prototype.checkData=function(t){t.dataSource&&!g(Object.keys(t.dataSource))&&this.itemTemplate&&this.allowFiltering&&!(this.isListSearched&&t.dataSource instanceof re)&&(this.list&&!this.isReact?this.list.innerHTML="":this.list=null,this.actionCompleteData={ulElement:null,list:null,isUpdated:!1}),this.isListSearched=!1;var i=Object.keys(t).indexOf("value")!==-1&&g(t.value),r=Object.keys(t).indexOf("text")!==-1&&g(t.text);this.getModuleName()!=="autocomplete"&&this.allowFiltering&&(i||r)&&(this.itemData=null),this.allowFiltering&&t.dataSource&&!g(Object.keys(t.dataSource))?(this.actionCompleteData={ulElement:null,list:null,isUpdated:!1},this.actionData=this.actionCompleteData):this.allowFiltering&&t.query&&!g(Object.keys(t.query))&&(this.actionCompleteData=this.getModuleName()==="combobox"?{ulElement:null,list:null,isUpdated:!1}:this.actionCompleteData,this.actionData=this.actionCompleteData)},e.prototype.updateDataSource=function(t,i){(this.inputElement.value!==""||!g(t)&&(g(t.dataSource)||!(t.dataSource instanceof re)&&t.dataSource.length===0))&&this.clearAll(null,t),this.fields.groupBy&&t.fields&&!this.isGroupChecking&&this.list&&(E.remove(this.list,"scroll",this.setFloatingHeader),E.add(this.list,"scroll",this.setFloatingHeader,this)),(!(!g(t)&&(g(t.dataSource)||!(t.dataSource instanceof re)&&t.dataSource.length===0))||t.dataSource instanceof re||!g(t)&&Array.isArray(t.dataSource)&&!g(i)&&Array.isArray(i.dataSource)&&t.dataSource.length!==i.dataSource.length)&&(this.typedString="",this.resetList(this.dataSource)),!this.isCustomFilter&&!this.isFilterFocus&&document.activeElement!==this.filterInput&&this.checkCustomValue()},e.prototype.checkCustomValue=function(){var t=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value;this.itemData=this.getDataByValue(t);var i=this.getItemData(),r=this.allowObjectBinding?this.itemData:i.value,n=g(r)?null:this.index;g(n)&&t===r||this.isAngular?this.setProperties({text:i.text?i.text.toString():i.text,value:r}):this.setProperties({text:i.text?i.text.toString():i.text,index:n,value:r})},e.prototype.updateInputFields=function(){this.getModuleName()==="dropdownlist"&&Ce.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton)},e.prototype.onPropertyChanged=function(t,i){var r=this;!g(t.dataSource)&&!this.isTouched&&g(t.value)&&g(t.index)&&!g(this.preselectedIndex)&&!g(this.index)&&(t.index=this.index),(!g(t.value)||!g(t.index))&&(this.isTouched=!0),this.getModuleName()==="dropdownlist"&&(this.checkData(t),this.setUpdateInitial(["fields","query","dataSource"],t));for(var n=function(c){switch(c){case"query":case"dataSource":s.getSkeletonCount(),s.checkAndResetCache();break;case"htmlAttributes":s.setHTMLAttributes();break;case"width":s.setEleWidth(t.width),Ce.calculateWidth(s.inputElement,s.inputWrapper.container);break;case"placeholder":Ce.setPlaceholder(t.placeholder,s.inputElement);break;case"filterBarPlaceholder":s.filterInput&&Ce.setPlaceholder(t.filterBarPlaceholder,s.filterInput);break;case"readonly":s.getModuleName()!=="dropdownlist"&&Ce.setReadonly(t.readonly,s.inputElement),s.setReadOnly();break;case"cssClass":s.setCssClass(t.cssClass,i.cssClass),Ce.calculateWidth(s.inputElement,s.inputWrapper.container);break;case"enableRtl":s.setEnableRtl();break;case"enabled":s.setEnable();break;case"text":if(s.fields.disabled&&(t.text=t.text&&!s.isDisabledItemByIndex(s.getIndexByValue(s.getValueByText(t.text)))?t.text:null),t.text===null){s.clearAll();break}if(s.enableVirtualization){s.updateValues(),s.updateInputFields(),s.notify("setCurrentViewDataAsync",{module:"VirtualScroll"});break}if(s.list||(s.dataSource instanceof re&&(s.initialRemoteRender=!0),s.renderList()),!s.initialRemoteRender){var d=s.getElementByText(t.text);if(!s.checkValidLi(d))if(s.liCollections&&s.liCollections.length===100&&s.getModuleName()==="autocomplete"&&s.listData.length>100)s.setSelectionData(t.text,i.text,"text");else if(t.text&&s.dataSource instanceof re){var p=s.getItems().length,f=g(s.fields.text)?s.fields.value:s.fields.text;s.typedString="",s.dataSource.executeQuery(s.getQuery(s.query).where(new St(f,"equal",t.text))).then(function(I){I.result.length>0?(r.addItem(I.result,p),r.updateValues()):r.setOldText(i.text)})}else s.getModuleName()==="autocomplete"?s.setInputValue(t,i):s.setOldText(i.text);s.updateInputFields()}break;case"value":if(s.fields.disabled&&(t.value=t.value!=null&&!s.isDisableItemValue(t.value)?t.value:null),t.value===null){s.clearAll();break}if(s.allowObjectBinding&&!g(t.value)&&!g(i.value)&&s.isObjectInArray(t.value,[i.value]))return{value:void 0};if(s.enableVirtualization){s.updateValues(),s.updateInputFields(),s.notify("setCurrentViewDataAsync",{module:"VirtualScroll"}),s.preventChange=s.isAngular&&s.preventChange?!s.preventChange:s.preventChange;break}if(s.notify("beforeValueChange",{newProp:t}),s.list||(s.dataSource instanceof re&&(s.initialRemoteRender=!0),s.renderList()),!s.initialRemoteRender){var v=s.allowObjectBinding&&!g(t.value)?V(s.fields.value?s.fields.value:"",t.value):t.value,m=s.getElementByValue(v);if(!s.checkValidLi(m))if(s.liCollections&&s.liCollections.length===100&&s.getModuleName()==="autocomplete"&&s.listData.length>100)s.setSelectionData(t.value,i.value,"value");else if(t.value&&s.dataSource instanceof re){var y=s.getItems().length,f=g(s.fields.value)?s.fields.text:s.fields.value;s.typedString="";var S=s.allowObjectBinding&&!g(t.value)?V(f,t.value):t.value;s.dataSource.executeQuery(s.getQuery(s.query).where(new St(f,"equal",S))).then(function(x){x.result.length>0?(r.addItem(x.result,y),r.updateValues()):r.setOldValue(i.value)})}else s.getModuleName()==="autocomplete"?s.setInputValue(t,i):s.setOldValue(i.value);s.updateInputFields(),s.preventChange=s.isAngular&&s.preventChange?!s.preventChange:s.preventChange}break;case"index":if(s.fields.disabled&&(t.index=t.index!=null&&!s.isDisabledItemByIndex(t.index)?t.index:null),t.index===null){s.clearAll();break}if(s.list||(s.dataSource instanceof re&&(s.initialRemoteRender=!0),s.renderList()),!s.initialRemoteRender&&s.liCollections){var b=s.liCollections[t.index];s.checkValidLi(b)||(s.liCollections&&s.liCollections.length===100&&s.getModuleName()==="autocomplete"&&s.listData.length>100?s.setSelectionData(t.index,i.index,"index"):s.index=i.index),s.updateInputFields()}break;case"footerTemplate":s.popupObj&&s.setFooterTemplate(s.popupObj.element);break;case"headerTemplate":s.popupObj&&s.setHeaderTemplate(s.popupObj.element);break;case"valueTemplate":!g(s.itemData)&&s.valueTemplate!==null&&s.setValueTemplate();break;case"allowFiltering":s.allowFiltering&&(s.actionCompleteData={ulElement:s.ulElement,list:s.listData,isUpdated:!0},s.actionData=s.actionCompleteData,s.updateSelectElementData(s.allowFiltering));break;case"floatLabelType":Ce.removeFloating(s.inputWrapper),Ce.addFloating(s.inputElement,t.floatLabelType,s.placeholder,s.createElement),!g(s.inputWrapper.buttons[0])&&s.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0]&&s.floatLabelType!=="Never"&&s.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon");break;case"showClearButton":s.inputWrapper.clearButton||(Ce.setClearButton(t.showClearButton,s.inputElement,s.inputWrapper,null,s.createElement),s.bindClearEvent());break;default:{var w=s.getPropObject(c,t,i);o.prototype.onPropertyChanged.call(s,w.newProperty,w.oldProperty)}break}},s=this,a=0,l=Object.keys(t);a<l.length;a++){var h=l[a],u=n(h);if(typeof u=="object")return u.value}},e.prototype.checkValidLi=function(t){return this.isValidLI(t)?(this.setSelection(t,null),!0):!1},e.prototype.setSelectionData=function(t,i,r){var n=this,s;this.updateListValues=function(){if(r==="text")s=n.getElementByText(t),n.checkValidLi(s)||n.setOldText(i);else if(r==="value"){var a=n.fields.value?n.fields.value:"",l=n.allowObjectBinding&&!g(t)?V(a,t):t;s=n.getElementByValue(t),n.checkValidLi(s)||n.setOldValue(i)}else r==="index"&&(s=n.liCollections[t],n.checkValidLi(s)||(n.index=i))}},e.prototype.updatePopupState=function(){this.beforePopupOpen&&(this.beforePopupOpen=!1,this.showPopup())},e.prototype.setReadOnly=function(){this.readonly?Y([this.inputWrapper.container],["e-readonly"]):K([this.inputWrapper.container],["e-readonly"])},e.prototype.setInputValue=function(t,i){},e.prototype.setCssClass=function(t,i){g(i)||(i=i.replace(/\s+/g," ").trim()),g(t)||(t=t.replace(/\s+/g," ").trim()),Ce.setCssClass(t,[this.inputWrapper.container],i),this.popupObj&&Ce.setCssClass(t,[this.popupObj.element],i)},e.prototype.getModuleName=function(){return"dropdownlist"},e.prototype.showPopup=function(t){if(this.enabled){if(this.firstItem=this.dataSource&&this.dataSource.length>0?this.dataSource[0]:null,this.isReact&&this.getModuleName()==="combobox"&&this.itemTemplate&&this.isCustomFilter&&this.isAddNewItemTemplate&&(this.renderList(),this.isAddNewItemTemplate=!1),this.isFiltering()&&this.dataSource instanceof re&&this.actionData.list!==this.actionCompleteData.list&&this.actionData.list&&this.actionData.ulElement&&(this.actionCompleteData=this.actionData,this.onActionComplete(this.actionCompleteData.ulElement,this.actionCompleteData.list,null,!0)),this.beforePopupOpen){this.refreshPopup();return}this.beforePopupOpen=!0,this.isFiltering()&&!this.isActive&&this.actionCompleteData.list&&this.actionCompleteData.list[0]?(this.isActive=!0,this.onActionComplete(this.actionCompleteData.ulElement,this.actionCompleteData.list,null,!0)):(g(this.list)||!Ee(this.list)&&(this.list.classList.contains(le.noData)||this.list.querySelectorAll("."+le.li).length<=0))&&(this.isReact&&this.isFiltering()&&this.itemTemplate!=null&&(this.isSecondClick=!1),this.renderList(t)),this.enableVirtualization&&this.listData&&this.listData.length&&(!g(this.value)&&(this.getModuleName()==="dropdownlist"||this.getModuleName()==="combobox")&&this.removeHover(),this.beforePopupOpen||this.notify("setCurrentViewDataAsync",{module:"VirtualScroll"})),this.beforePopupOpen&&this.invokeRenderPopup(t),this.enableVirtualization&&!this.allowFiltering&&this.selectedValueInfo!=null&&this.selectedValueInfo.startIndex>0&&this.value!=null&&this.notify("dataProcessAsync",{module:"VirtualScroll",isOpen:!0}),!this.isSecondClick&&!this.isDropDownClick&&this.executeCloneElements()}},e.prototype.executeCloneElements=function(){var t=this,i=this.element.tagName===this.getNgDirective()&&this.itemTemplate?500:100;this.isReact&&this.isFiltering()&&this.itemTemplate!=null&&setTimeout(function(){t.cloneElements(),t.isSecondClick=!(t.isReact&&t.isFiltering()&&t.dataSource instanceof re&&!t.list.querySelector("ul"))},i)},e.prototype.invokeRenderPopup=function(t){if(B.isDevice&&this.isFilterLayout()){var i=this;window.onpopstate=function(){i.hidePopup()},history.pushState({},"")}!g(this.list)&&(!g(this.list.children[0])||this.list.classList.contains(le.noData))&&this.renderPopup(t)},e.prototype.renderHightSearch=function(){},e.prototype.hidePopup=function(t){if(this.isEscapeKey&&this.getModuleName()==="dropdownlist")if(g(this.inputElement)||Ce.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton),this.isEscapeKey=!1,g(this.index))this.resetSelection();else{var i=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value):this.value,r=this.findListElement(this.ulElement,"li","data-value",i);this.selectedLI=this.liCollections[this.index]||r,this.selectedLI&&(this.updateSelectedItem(this.selectedLI,null,!0),this.valueTemplate&&this.itemData!==null&&this.setValueTemplate())}this.isVirtualTrackHeight=!1,this.customFilterQuery=null,this.closePopup(0,t);var n=this.getItemData(),s=!g(this.selectedLI);s&&this.enableVirtualization&&this.selectedLI.classList&&(s=this.selectedLI.classList.contains("e-active")),this.inputElement&&this.inputElement.value===""&&!this.isInteracted&&(this.isSelectCustom||s&&this.inputElement.value!==n.text)&&(this.isSelectCustom=!1,this.clearAll(t))},e.prototype.focusIn=function(t){if(this.enabled&&!this.targetElement().classList.contains(Qe.disable)){var i=!1;this.preventFocus&&B.isDevice&&(this.inputWrapper.container.tabIndex=1,this.inputWrapper.container.focus(),this.preventFocus=!1,i=!0),i||this.targetElement().focus(),Y([this.inputWrapper.container],[Qe.inputFocus]),this.onFocus(t),this.floatLabelType!=="Never"&&Ce.calculateWidth(this.inputElement,this.inputWrapper.container)}},e.prototype.focusOut=function(t){this.enabled&&(!this.enableVirtualization&&(this.getModuleName()==="combobox"||this.getModuleName()==="autocomplete")&&(this.isTyped=!0),this.hidePopup(t),this.targetElement()&&this.targetElement().blur(),K([this.inputWrapper.container],[Qe.inputFocus]),this.floatLabelType!=="Never"&&Ce.calculateWidth(this.inputElement,this.inputWrapper.container))},e.prototype.disableItem=function(t){if(this.fields.disabled){this.list||this.renderList();var i=-1;if(this.liCollections&&this.liCollections.length>0&&this.listData&&this.fields.disabled){if(typeof t=="string")i=this.getIndexByValue(t);else if(typeof t=="object"){if(t instanceof HTMLLIElement){for(var r=0;r<this.liCollections.length;r++)if(this.liCollections[r]===t){i=this.getIndexByValue(t.getAttribute("data-value"));break}}else for(var n=JSON.parse(JSON.stringify(t))[this.fields.value],r=0;r<this.listData.length;r++)if(JSON.parse(JSON.stringify(this.listData[r]))[this.fields.value]===n){i=this.getIndexByValue(n);break}}else i=t;var s=i<this.liCollections.length&&i>-1;if(s&&!JSON.parse(JSON.stringify(this.listData[i]))[this.fields.disabled]){var a=this.liCollections[i];if(a){this.disableListItem(a);var l=JSON.parse(JSON.stringify(this.listData[i]));l[this.fields.disabled]=!0,this.listData[i]=l,this.dataSource=this.listData,a.classList.contains(Qe.focus)&&this.removeFocus(),a.classList.contains(Qe.selected)&&this.clear()}}}}},e.prototype.destroy=function(){if(this.isActive=!1,this.showClearButton&&(this.clearButton=document.getElementsByClassName("e-clear-icon")[0]),HV(this.element.id),this.isReact&&this.clearTemplate(),this.hidePopup(),this.popupObj&&this.popupObj.hide(),this.unWireEvent(),this.list&&this.unWireListEvents(),!(this.element&&!this.element.classList.contains("e-"+this.getModuleName()))){if(this.inputElement){for(var t=["readonly","aria-disabled","placeholder","aria-labelledby","aria-expanded","autocomplete","aria-readonly","autocapitalize","spellcheck","aria-autocomplete","aria-live","aria-describedby","aria-label"],i=0;i<t.length;i++)this.inputElement.removeAttribute(t[i]);this.inputElement.setAttribute("tabindex",this.tabIndex),this.inputElement.classList.remove("e-input"),Ce.setValue("",this.inputElement,this.floatLabelType,this.showClearButton)}this.element.style.display="block",this.inputWrapper.container&&this.inputWrapper.container.parentElement&&(this.inputWrapper.container.parentElement.tagName===this.getNgDirective()?ee(this.inputWrapper.container):(this.inputWrapper.container.parentElement.insertBefore(this.element,this.inputWrapper.container),ee(this.inputWrapper.container))),delete this.hiddenElement,this.filterInput=null,this.keyboardModule=null,this.ulElement=null,this.list=null,this.clearIconElement=null,this.popupObj=null,this.popupContentElement=null,this.rippleFun=null,this.selectedLI=null,this.liCollections=null,this.item=null,this.footer=null,this.header=null,this.previousSelectedLI=null,this.valueTempElement=null,this.actionData.ulElement=null,this.inputElement&&!g(this.inputElement.onchange)&&(this.inputElement.onchange=null),this.inputElement&&!g(this.inputElement.onselect)&&(this.inputElement.onselect=null),Ce.destroy({element:this.inputElement,floatLabelType:this.floatLabelType,properties:this.properties,buttons:this.inputWrapper.container.querySelectorAll(".e-input-group-icon")[0]},this.clearButton),this.clearButton=null,this.inputElement=null,this.inputWrapper=null,o.prototype.destroy.call(this)}},e.prototype.getItems=function(){return this.list||(this.dataSource instanceof re&&(this.initialRemoteRender=!0),this.renderList()),this.ulElement?o.prototype.getItems.call(this):[]},e.prototype.getDataByValue=function(t){return o.prototype.getDataByValue.call(this,t)},e.prototype.clear=function(){this.value=null},vi([C(null)],e.prototype,"cssClass",void 0),vi([C("100%")],e.prototype,"width",void 0),vi([C(!0)],e.prototype,"enabled",void 0),vi([C(!1)],e.prototype,"enablePersistence",void 0),vi([C("300px")],e.prototype,"popupHeight",void 0),vi([C("100%")],e.prototype,"popupWidth",void 0),vi([C(null)],e.prototype,"placeholder",void 0),vi([C(null)],e.prototype,"filterBarPlaceholder",void 0),vi([C({})],e.prototype,"htmlAttributes",void 0),vi([C(null)],e.prototype,"query",void 0),vi([C(null)],e.prototype,"valueTemplate",void 0),vi([C(null)],e.prototype,"headerTemplate",void 0),vi([C(null)],e.prototype,"footerTemplate",void 0),vi([C(!1)],e.prototype,"allowFiltering",void 0),vi([C(!0)],e.prototype,"isDeviceFullScreen",void 0),vi([C(!1)],e.prototype,"readonly",void 0),vi([C(!1)],e.prototype,"enableVirtualization",void 0),vi([C(!1)],e.prototype,"allowResize",void 0),vi([C(null)],e.prototype,"text",void 0),vi([C(null)],e.prototype,"value",void 0),vi([C(!1)],e.prototype,"allowObjectBinding",void 0),vi([C(null)],e.prototype,"index",void 0),vi([C("Never")],e.prototype,"floatLabelType",void 0),vi([C(!1)],e.prototype,"showClearButton",void 0),vi([q()],e.prototype,"filtering",void 0),vi([q()],e.prototype,"change",void 0),vi([q()],e.prototype,"beforeOpen",void 0),vi([q()],e.prototype,"open",void 0),vi([q()],e.prototype,"close",void 0),vi([q()],e.prototype,"blur",void 0),vi([q()],e.prototype,"focus",void 0),vi([q()],e.prototype,"resizeStop",void 0),vi([q()],e.prototype,"resizing",void 0),vi([q()],e.prototype,"resizeStart",void 0),e=vi([bt],e),e}(bk);var e5=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),lr=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},tk="e-atc-spinner-icon";Qe.root="e-combobox";var t5={container:null,buttons:[]},um=function(o){e5(e,o);function e(t,i){return o.call(this,t,i)||this}return e.prototype.preRender=function(){o.prototype.preRender.call(this)},e.prototype.getLocaleName=function(){return"combo-box"},e.prototype.wireEvent=function(){this.getModuleName()==="combobox"&&(E.add(this.inputWrapper.buttons[0],"mousedown",this.preventBlur,this),E.add(this.inputWrapper.container,"blur",this.onBlurHandler,this)),g(this.inputWrapper.buttons[0])||E.add(this.inputWrapper.buttons[0],"mousedown",this.dropDownClick,this),E.add(this.inputElement,"focus",this.targetFocus,this),this.readonly||(E.add(this.inputElement,"input",this.onInput,this),E.add(this.inputElement,"keyup",this.onFilterUp,this),E.add(this.inputElement,"keydown",this.onFilterDown,this),E.add(this.inputElement,"paste",this.pasteHandler,this),E.add(window,"resize",this.windowResize,this)),this.bindCommonEvent()},e.prototype.preventBlur=function(t){(!this.allowFiltering&&document.activeElement!==this.inputElement&&!document.activeElement.classList.contains(Qe.input)&&B.isDevice||!B.isDevice)&&t.preventDefault()},e.prototype.onBlurHandler=function(t){var i=this.inputElement&&this.inputElement.value===""?null:this.inputElement&&this.inputElement.value;!g(this.listData)&&!g(i)&&i!==this.text&&this.customValue(t),o.prototype.onBlurHandler.call(this,t)},e.prototype.targetElement=function(){return this.inputElement},e.prototype.setOldText=function(t){Ce.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton),this.customValue(),this.removeSelection()},e.prototype.setOldValue=function(t){this.allowCustom?(this.selectedLI=this.getElementByValue(this.value),this.valueMuteChange(this.value)):this.valueMuteChange(null),this.removeSelection(),this.setHiddenValue()},e.prototype.valueMuteChange=function(t){t=this.allowObjectBinding&&!g(t)?V(this.fields.value?this.fields.value:"",t):t;var i=g(t)?null:t.toString();Ce.setValue(i,this.inputElement,this.floatLabelType,this.showClearButton);var r={};if(this.allowObjectBinding&&(t=this.getDataByValue(t),g(t))){var n=this.fields,s=!1,a=!1;if(this.allowObjectBinding){var l=Object.keys(this.value);l.forEach(function(c){if(c===n.value){a=!0;return}}),l.forEach(function(c){if(c===n.text){s=!0;return}})}r={text:a?s?V(n.text,this.value):V(n.value,this.value):null,value:a?this.value:null,index:null}}this.allowObjectBinding?this.setProperties(r,!0):this.setProperties({value:t,text:t&&t.toString(),index:null},!0),this.activeIndex=this.index;var h=this.fields,u={};u[h.text]=g(t)?null:t.toString(),u[h.value]=g(t)?null:t.toString(),this.itemData=u,this.item=null,(!this.allowObjectBinding&&this.previousValue!==this.value||this.allowObjectBinding&&this.previousValue&&this.value&&!this.isObjectInArray(this.previousValue,[this.value]))&&this.detachChangeEvent(null)},e.prototype.updateValues=function(){if(this.fields.disabled&&(this.value!=null&&(this.value=this.isDisableItemValue(this.value)?null:this.value),this.text!=null&&(this.text=this.isDisabledItemByIndex(this.getIndexByValue(this.getValueByText(this.text)))?null:this.text),this.index!=null&&(this.index=this.isDisabledItemByIndex(this.index)?null:this.index,this.activeIndex=this.index)),g(this.value))if(this.text&&g(this.value)){var i=this.getElementByText(this.text);i?this.setSelection(i,null):(Ce.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton),this.customValue())}else this.setSelection(this.liCollections[this.activeIndex],null);else{var t=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value,i=this.getElementByValue(t),r=!g(i);if(this.enableVirtualization&&this.value){var n=this.fields.value?this.fields.value:"",s=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value;if(this.dataSource instanceof re){var a=new re(this.virtualGroupDataSource).executeLocal(new Pe().where(new St(n,"equal",s)));if(a&&a.length>0){this.itemData=a[0],r=!0;var l=this.getItemData(),h=this.allowObjectBinding?this.getDataByValue(l.value):l.value;(this.value===l.value&&this.text!==l.text||this.value!==l.value&&this.text===l.text)&&this.setProperties({text:l.text?l.text.toString():l.text,value:h})}}else{var a=new re(this.dataSource).executeLocal(new Pe().where(new St(n,"equal",s)));if(a&&a.length>0){this.itemData=a[0],r=!0;var l=this.getItemData(),h=this.allowObjectBinding?this.getDataByValue(l.value):l.value;(this.value===l.value&&this.text!==l.text||this.value!==l.value&&this.text===l.text)&&this.setProperties({text:l.text?l.text.toString():l.text,value:h})}}}i?this.setSelection(i,null):!this.enableVirtualization&&this.allowCustom||this.allowCustom&&this.enableVirtualization&&!r?this.valueMuteChange(this.value):(!this.enableVirtualization||this.enableVirtualization&&!r)&&this.valueMuteChange(null)}this.setHiddenValue(),Ce.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton)},e.prototype.updateIconState=function(){this.showClearButton&&(this.inputElement&&this.inputElement.value!==""&&!this.readonly?K([this.inputWrapper.clearButton],Qe.clearIconHide):Y([this.inputWrapper.clearButton],Qe.clearIconHide))},e.prototype.getAriaAttributes=function(){var t={role:"combobox","aria-autocomplete":"both","aria-labelledby":this.hiddenElement.id,"aria-expanded":"false","aria-readonly":this.readonly?this.readonly.toString():"false",autocomplete:"off",autocapitalize:"off",spellcheck:"false"};return t},e.prototype.searchLists=function(t){this.isTyped=!0,this.isFiltering()?(o.prototype.searchLists.call(this,t),this.ulElement&&this.filterInput.value.trim()===""&&this.setHoverList(this.ulElement.querySelector("."+Qe.li))):(this.ulElement&&this.inputElement.value===""&&this.preventAutoFill&&this.setHoverList(this.ulElement.querySelector("."+Qe.li)),this.incrementalSearch(t))},e.prototype.getNgDirective=function(){return"EJS-COMBOBOX"},e.prototype.setSearchBox=function(){this.filterInput=this.inputElement;var t=this.isFiltering()||this.isReact&&this.getModuleName()==="combobox"?this.inputWrapper:t5;return t},e.prototype.onActionComplete=function(t,i,r,n){var s=this;o.prototype.onActionComplete.call(this,t,i,r),this.isSelectCustom&&this.removeSelection(),!this.preventAutoFill&&this.getModuleName()==="combobox"&&this.isTyped&&!this.enableVirtualization&&setTimeout(function(){s.inlineSearch()})},e.prototype.getFocusElement=function(){var t=this.isSelectCustom?{text:""}:this.getItemData(),i=g(this.list)?this.list:this.list.querySelector("."+Qe.selected),r=t.text&&t.text.toString()===this.inputElement.value&&!g(i);if(r)return i;if((B.isDevice&&!this.isDropDownClick||!B.isDevice)&&!g(this.liCollections)&&this.liCollections.length>0){var n=this.inputElement.value,s=this.sortedData,a=this.typeOfData(s).typeof,l=aa(n,this.liCollections,this.filterType,!0,s,this.fields,a,this.ignoreAccent);if(this.enableVirtualization&&n!==""&&this.getModuleName()!=="autocomplete"&&this.isTyped&&!this.allowFiltering){var h=!1,u=this.viewPortInfo.endIndex>=this.incrementalEndIndex&&this.incrementalEndIndex<=this.totalItemCount,c=this.incrementalEndIndex===0;for((u||c)&&(h=!0,this.incrementalStartIndex=this.incrementalEndIndex,c?this.incrementalEndIndex=Math.min(100,this.totalItemCount):this.incrementalEndIndex=Math.min(this.incrementalEndIndex+100,this.totalItemCount),this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),h=!0),(this.viewPortInfo.startIndex!==0||h)&&this.updateIncrementalView(0,this.itemCount),l=aa(n,this.incrementalLiCollections,this.filterType,!0,s,this.fields,a);g(l.item)&&this.incrementalEndIndex<this.totalItemCount;){if(this.incrementalStartIndex=this.incrementalEndIndex,this.incrementalEndIndex=this.incrementalEndIndex+100>this.totalItemCount?this.totalItemCount:this.incrementalEndIndex+100,this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),h=!0,(this.viewPortInfo.startIndex!==0||h)&&this.updateIncrementalView(0,this.itemCount),l=aa(n,this.incrementalLiCollections,this.filterType,!0,s,this.fields,a),!g(l)){l.index=l.index+this.incrementalStartIndex;break}if(g(l)&&this.incrementalEndIndex>=this.totalItemCount){this.incrementalStartIndex=0,this.incrementalEndIndex=100>this.totalItemCount?this.totalItemCount:100;break}}var d=l.index-(this.itemCount/2-2)>0?l.index-(this.itemCount/2-2):0,p=this.viewPortInfo.startIndex+this.itemCount>this.totalItemCount?this.totalItemCount:this.viewPortInfo.startIndex+this.itemCount;if(d!==this.viewPortInfo.startIndex&&this.updateIncrementalView(d,p),g(l.item))this.updateIncrementalView(0,this.itemCount),this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues(),this.list.scrollTop=0;else{var f=this.viewPortInfo.startIndex+(this.itemCount/2-2)<this.totalItemCount?this.viewPortInfo.startIndex+(this.itemCount/2-2):this.totalItemCount,v=this.viewPortInfo.startIndex+this.itemCount>this.totalItemCount?this.totalItemCount:this.viewPortInfo.startIndex+this.itemCount;this.updateIncrementalView(f,v),l.item=this.getElementByValue(l.item.getAttribute("data-value"))}l&&l.item&&(l.item=this.getElementByValue(l.item.getAttribute("data-value")))}var m=l.item;if(g(m))this.isSelectCustom&&this.inputElement.value.trim()!==""&&(this.removeFocus(),this.enableVirtualization||(this.list.scrollTop=0));else{var y=this.getIndexByValue(m.getAttribute("data-value"))-1,S=parseInt(getComputedStyle(this.liCollections[0],null).getPropertyValue("height"),10);if(!isNaN(S)&&this.getModuleName()!=="autocomplete"){this.removeFocus();var b=this.fields.groupBy?this.liCollections[0].offsetHeight:0;if(!this.enableVirtualization)this.list.scrollTop=y*S+b;else{var w=this.list.getElementsByClassName("e-virtual-ddl-content")[0];if(w.style=this.getTransformValues(),this.enableVirtualization&&!this.fields.groupBy){var I=m.offsetTop,x=this.virtualListInfo&&this.virtualListInfo.startIndex?this.virtualListInfo.startIndex:0,M=m.offsetHeight,D=I+x*M,A=this.list.querySelectorAll(".e-virtual-list").length,L=A*M;this.list.scrollTop=D-L}}Y([m],Qe.focus)}}return m}else return null},e.prototype.setValue=function(t){return(t&&t.type==="keydown"&&t.action==="enter"||t&&t.type==="click")&&this.removeFillSelection(),this.autofill&&this.getModuleName()==="combobox"&&t&&t.type==="keydown"&&t.action!=="enter"?(this.preventAutoFill=!1,this.inlineSearch(t),!1):o.prototype.setValue.call(this,t)},e.prototype.checkCustomValue=function(){var t=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value;this.itemData=this.getDataByValue(t);var i=this.getItemData(),r=this.allowObjectBinding?this.itemData:i.value;this.allowCustom&&g(i.value)&&g(i.text)||this.setProperties({value:r},!this.allowCustom)},e.prototype.showSpinner=function(){g(this.spinnerElement)&&(this.spinnerElement=this.getModuleName()==="autocomplete"?this.inputWrapper.buttons[0]||this.inputWrapper.clearButton||Ce.appendSpan("e-input-group-icon "+tk,this.inputWrapper.container,this.createElement):this.inputWrapper.buttons[0]||this.inputWrapper.clearButton,Y([this.spinnerElement],Qe.disableIcon),Os({target:this.spinnerElement,width:B.isDevice?"16px":"14px"},this.createElement),rs(this.spinnerElement))},e.prototype.hideSpinner=function(){g(this.spinnerElement)||(Rs(this.spinnerElement),K([this.spinnerElement],Qe.disableIcon),this.spinnerElement.classList.contains(tk)?ee(this.spinnerElement):this.spinnerElement.innerHTML="",this.spinnerElement=null)},e.prototype.setAutoFill=function(t,i){if(i||this.setHoverList(t),this.autofill&&!this.preventAutoFill){var r=this.getTextByValue(t.getAttribute("data-value")).toString(),n=this.getFormattedValue(t.getAttribute("data-value"));this.getModuleName()==="combobox"&&(!this.isSelected&&!this.allowObjectBinding&&this.previousValue!==n||this.allowObjectBinding&&this.previousValue&&n&&!this.isObjectInArray(this.previousValue,[this.getDataByValue(n)])?(this.updateSelectedItem(t,null),this.isSelected=!0,this.previousValue=this.allowObjectBinding?this.getDataByValue(this.getFormattedValue(t.getAttribute("data-value"))):this.getFormattedValue(t.getAttribute("data-value"))):this.updateSelectedItem(t,null,!0)),this.isAndroidAutoFill(r)||this.setAutoFillSelection(r,i)}},e.prototype.isAndroidAutoFill=function(t){if(B.isAndroid){var i=this.getSelectionPoints(),r=this.prevSelectPoints.end,n=i.end,s=this.prevSelectPoints.start,a=i.start;return r!==0&&(r===t.length&&s===t.length||s>a&&r>n||r===n&&s===a)}else return!1},e.prototype.clearAll=function(t,i){(g(i)||!g(i)&&g(i.dataSource))&&o.prototype.clearAll.call(this,t),this.isFiltering()&&!g(t)&&t.target===this.inputWrapper.clearButton&&(this.typedString=this.filterInput.value,this.searchLists(t))},e.prototype.isSelectFocusItem=function(t){return!g(t)},e.prototype.inlineSearch=function(t){var i=t&&(t.action==="down"||t.action==="up"||t.action==="home"||t.action==="end"||t.action==="pageUp"||t.action==="pageDown"),r=i?this.liCollections[this.activeIndex]:this.getFocusElement();if(g(r))if(!g(this.inputElement)&&this.inputElement.value===""){if(this.activeIndex=null,!g(this.list)){this.enableVirtualization||(this.list.scrollTop=0);var s=this.list.querySelector("."+Qe.li);this.setHoverList(s)}}else this.activeIndex=null,this.removeSelection(),this.liCollections&&this.liCollections.length>0&&!this.isCustomFilter&&this.removeFocus();else{if(!i){var n=this.getFormattedValue(r.getAttribute("data-value"));this.activeIndex=this.getIndexByValue(n),this.activeIndex=g(this.activeIndex)?null:this.activeIndex}this.preventAutoFill=this.inputElement.value===""?!1:this.preventAutoFill,this.setAutoFill(r,i)}},e.prototype.incrementalSearch=function(t){this.showPopup(t),g(this.listData)||(this.inlineSearch(t),t.preventDefault())},e.prototype.setAutoFillSelection=function(t,i){i===void 0&&(i=!1);var r=this.getSelectionPoints(),n=this.inputElement.value.substr(0,r.start);if(n&&n.toLowerCase()===t.substr(0,r.start).toLowerCase()){var s=n+t.substr(n.length,t.length);Ce.setValue(s,this.inputElement,this.floatLabelType,this.showClearButton),this.inputElement.setSelectionRange(r.start,this.inputElement.value.length)}else i&&(Ce.setValue(t,this.inputElement,this.floatLabelType,this.showClearButton),this.inputElement.setSelectionRange(0,this.inputElement.value.length))},e.prototype.getValueByText=function(t){return o.prototype.getValueByText.call(this,t,!0,this.ignoreAccent)},e.prototype.unWireEvent=function(){this.getModuleName()==="combobox"&&(E.remove(this.inputWrapper.buttons[0],"mousedown",this.preventBlur),E.remove(this.inputWrapper.container,"blur",this.onBlurHandler)),g(this.inputWrapper.buttons[0])||E.remove(this.inputWrapper.buttons[0],"mousedown",this.dropDownClick),this.inputElement&&(E.remove(this.inputElement,"focus",this.targetFocus),this.readonly||(E.remove(this.inputElement,"input",this.onInput),E.remove(this.inputElement,"keyup",this.onFilterUp),E.remove(this.inputElement,"keydown",this.onFilterDown),E.remove(this.inputElement,"paste",this.pasteHandler),E.remove(window,"resize",this.windowResize))),this.unBindCommonEvent()},e.prototype.setSelection=function(t,i){o.prototype.setSelection.call(this,t,i),!g(t)&&!this.autofill&&!this.isDropDownClick&&this.removeFocus()},e.prototype.selectCurrentItem=function(t){var i;if(this.isPopupOpen){if(this.isSelected?i=this.list.querySelector("."+Qe.selected):i=this.list.querySelector("."+Qe.focus),this.isDisabledElement(i))return;i&&(this.setSelection(i,t),this.isTyped=!1),this.isSelected&&(this.isSelectCustom=!1,this.onChangeEvent(t))}t.action==="enter"&&this.inputElement.value===""?this.clearAll(t):this.isTyped&&!this.isSelected&&g(i)&&this.customValue(t),this.hidePopup(t)},e.prototype.setHoverList=function(t){this.removeSelection(),this.isValidLI(t)&&!t.classList.contains(Qe.selected)&&(this.removeFocus(),t.classList.add(Qe.focus))},e.prototype.targetFocus=function(t){B.isDevice&&!this.allowFiltering&&(this.preventFocus=!1),this.onFocus(t),Ce.calculateWidth(this.inputElement,this.inputWrapper.container)},e.prototype.dropDownClick=function(t){t.preventDefault(),B.isDevice&&!this.isFiltering()&&(this.preventFocus=!0),o.prototype.dropDownClick.call(this,t)},e.prototype.customValue=function(t){var i=this,r=this.getValueByText(this.inputElement.value);if(!this.allowCustom&&this.inputElement.value!==""){var n=this.previousValue,s=this.value;r=this.allowObjectBinding?this.getDataByValue(r):r,this.setProperties({value:r}),g(this.value)&&Ce.setValue("",this.inputElement,this.floatLabelType,this.showClearButton),this.autofill&&(!this.allowObjectBinding&&n===this.value||this.allowObjectBinding&&n&&this.isObjectInArray(n,[this.value]))&&(!this.allowObjectBinding&&s!==this.value||this.allowObjectBinding&&s&&!this.isObjectInArray(s,[this.value]))&&this.onChangeEvent(null)}else if(this.inputElement.value!==""){var a=this.value;if(g(r)){var l=this.inputElement.value===""?null:this.inputElement.value,h={text:l,item:{}};this.isObjectCustomValue=!0,this.initial?this.updateCustomValueCallback(l,h,a):this.trigger("customValueSpecifier",h,function(u){i.updateCustomValueCallback(l,u,a,t)})}else this.isSelectCustom=!1,r=this.allowObjectBinding?this.getDataByValue(r):r,this.setProperties({value:r}),(!this.allowObjectBinding&&a!==this.value||this.allowObjectBinding&&a&&this.value&&!this.isObjectInArray(a,[this.value]))&&this.onChangeEvent(t)}else this.allowCustom&&this.isFocused&&(this.isSelectCustom=!0)},e.prototype.updateCustomValueCallback=function(t,i,r,n){var s=this,a=this.fields,l=i.item,h={};l&&V(a.text,l)&&V(a.value,l)?h=l:(Ge(a.text,t,h),Ge(a.value,t,h)),this.itemData=h;var u={};if(this.allowObjectBinding){var c=this.listData&&this.listData.length>0?Object.keys(this.listData[0]):Object.keys(this.itemData);!(this.listData&&this.listData.length>0)&&(this.getModuleName()==="autocomplete"||this.getModuleName()==="combobox"&&this.allowFiltering)&&(c=this.firstItem?Object.keys(this.firstItem):Object.keys(this.itemData)),c.forEach(function(p){u[p]=p===a.value||p===a.text?V(a.value,s.itemData):null})}var d={text:V(a.text,this.itemData),value:this.allowObjectBinding?u:V(a.value,this.itemData),index:null};this.setProperties(d,!0),this.setSelection(null,null),this.isSelectCustom=!0,this.isObjectCustomValue=!1,(!this.allowObjectBinding&&r!==this.value||this.allowObjectBinding&&(r==null&&this.value!==null||r&&!this.isObjectInArray(r,[this.value])))&&this.onChangeEvent(n,!0)},e.prototype.onPropertyChanged=function(t,i){this.getModuleName()==="combobox"&&(this.checkData(t),this.setUpdateInitial(["fields","query","dataSource"],t,i));for(var r=0,n=Object.keys(t);r<n.length;r++){var s=n[r];switch(s){case"readonly":Ce.setReadonly(this.readonly,this.inputElement),this.readonly?(E.remove(this.inputElement,"input",this.onInput),E.remove(this.inputElement,"keyup",this.onFilterUp),E.remove(this.inputElement,"keydown",this.onFilterDown)):(E.add(this.inputElement,"input",this.onInput,this),E.add(this.inputElement,"keyup",this.onFilterUp,this),E.add(this.inputElement,"keydown",this.onFilterDown,this)),this.setReadOnly();break;case"allowFiltering":this.setSearchBox(),this.isFiltering()&&this.getModuleName()==="combobox"&&g(this.list)&&o.prototype.renderList.call(this);break;case"allowCustom":break;default:{var a=this.getPropObject(s,t,i);o.prototype.onPropertyChanged.call(this,a.newProperty,a.oldProperty),this.isFiltering()&&s==="dataSource"&&g(this.list)&&this.itemTemplate&&this.getModuleName()==="combobox"&&o.prototype.renderList.call(this);break}}}},e.prototype.render=function(){o.prototype.render.call(this),this.setSearchBox(),this.renderComplete(),this.autoFill=this.autofill},e.prototype.getModuleName=function(){return"combobox"},e.prototype.addItem=function(t,i){o.prototype.addItem.call(this,t,i)},e.prototype.filter=function(t,i,r){o.prototype.filter.call(this,t,i,r)},e.prototype.showPopup=function(t){o.prototype.showPopup.call(this,t)},e.prototype.hidePopup=function(t){var i=this.inputElement&&this.inputElement.value===""?null:this.inputElement&&this.inputElement.value;if(!g(this.listData)){var r=this.isEscapeKey;this.isEscapeKey&&(Ce.setValue(this.typedString,this.inputElement,this.floatLabelType,this.showClearButton),this.isEscapeKey=!1),this.autofill&&this.removeFillSelection();var n=this.isSelectCustom?{text:""}:this.getItemData(),s=g(this.list)?null:this.list.querySelector("."+Qe.selected);if(this.inputElement&&n.text===this.inputElement.value&&!g(s)){this.isSelected&&(this.onChangeEvent(t),this.isSelectCustom=!1),o.prototype.hidePopup.call(this,t);return}if(this.getModuleName()==="combobox"&&this.inputElement.value.trim()!==""){var a=this.sortedData,l=this.typeOfData(a).typeof,h=aa(this.inputElement.value,this.liCollections,"Equal",!0,a,this.fields,l);this.selectedLI=h.item,g(h.index)&&(h.index=aa(this.inputElement.value,this.liCollections,"StartsWith",!0,a,this.fields,l).index),this.activeIndex=h.index,g(this.selectedLI)?r&&(this.isSelectCustom=!0,this.removeSelection()):this.updateSelectedItem(this.selectedLI,null,!0)}!this.isEscapeKey&&this.isTyped&&!this.isInteracted&&this.customValue(t)}var u=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value;g(this.listData)&&this.allowCustom&&!g(i)&&i!==u&&this.customValue(),o.prototype.hidePopup.call(this,t)},e.prototype.focusIn=function(){this.enabled&&(B.isDevice&&!this.isFiltering()&&(this.preventFocus=!0),o.prototype.focusIn.call(this))},e.prototype.clear=function(){this.value=null},e.prototype.focusOut=function(t){o.prototype.focusOut.call(this,t)},e.prototype.getItems=function(){return o.prototype.getItems.call(this)},e.prototype.getDataByValue=function(t){return o.prototype.getDataByValue.call(this,t)},e.prototype.renderHightSearch=function(){},lr([C(!1)],e.prototype,"autofill",void 0),lr([C(!0)],e.prototype,"allowCustom",void 0),lr([C({})],e.prototype,"htmlAttributes",void 0),lr([C(!1)],e.prototype,"allowFiltering",void 0),lr([C(!0)],e.prototype,"isDeviceFullScreen",void 0),lr([C(null)],e.prototype,"query",void 0),lr([C(null)],e.prototype,"index",void 0),lr([C(!0)],e.prototype,"showClearButton",void 0),lr([C(!1)],e.prototype,"enableRtl",void 0),lr([q()],e.prototype,"customValueSpecifier",void 0),lr([q()],e.prototype,"filtering",void 0),lr([C(null)],e.prototype,"valueTemplate",void 0),lr([C("Never")],e.prototype,"floatLabelType",void 0),lr([C(null)],e.prototype,"filterBarPlaceholder",void 0),lr([C(null)],e.prototype,"cssClass",void 0),lr([C(null)],e.prototype,"headerTemplate",void 0),lr([C(null)],e.prototype,"footerTemplate",void 0),lr([C(null)],e.prototype,"placeholder",void 0),lr([C("100%")],e.prototype,"width",void 0),lr([C("300px")],e.prototype,"popupHeight",void 0),lr([C("100%")],e.prototype,"popupWidth",void 0),lr([C(!1)],e.prototype,"readonly",void 0),lr([C(null)],e.prototype,"text",void 0),lr([C(null)],e.prototype,"value",void 0),lr([C(!1)],e.prototype,"allowObjectBinding",void 0),e=lr([bt],e),e}(Ps),i5=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Pn=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n};Qe.root="e-autocomplete";Qe.icon="e-input-group-icon e-ddl-icon e-search-icon";var cm=function(o){i5(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.isFiltered=!1,r.searchList=!1,r}return e.prototype.preRender=function(){o.prototype.preRender.call(this)},e.prototype.getLocaleName=function(){return"auto-complete"},e.prototype.getNgDirective=function(){return"EJS-AUTOCOMPLETE"},e.prototype.getQuery=function(t){var i=t?t.clone():this.query?this.query.clone():new Pe,r=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value,n=this.queryString===""&&!g(r)?"equal":this.filterType,s=this.queryString===""&&!g(r)?r:this.queryString;if(this.isFiltered){if(this.enableVirtualization&&!g(this.customFilterQuery))i=this.customFilterQuery.clone();else if(!this.enableVirtualization)return i}if(this.queryString!==null&&this.queryString!==""){var a=this.typeOfData(this.dataSource).typeof;if(!(this.dataSource instanceof re)&&a==="string"||a==="number")i.where("",n,s,this.ignoreCase,this.ignoreAccent);else{var l=g(this.fields.value)?"":this.fields.value;i.where(l,n,s,this.ignoreCase,this.ignoreAccent)}}if(!g(this.suggestionCount)&&!this.enableVirtualization){if(this.suggestionCount!==20)for(var h=0;h<i.queries.length;h++)i.queries[h].fn==="onTake"&&i.queries.splice(h,1);i.take(this.suggestionCount)}if(this.enableVirtualization){var u=0,c=0,d=this.getTakeValue();if(i&&i.queries.length>0)for(var h=0;h<i.queries.length;h++)i.queries[h].fn==="onSkip"&&(c=i.queries[h].e.nos),i.queries[h].fn==="onTake"&&(u=d<=i.queries[h].e.nos?i.queries[h].e.nos:d);if(u<=0&&this.query&&this.query.queries.length>0){for(var h=0;h<this.query.queries.length;h++)if(this.query.queries[h].fn==="onTake"){var p=this.query.queries[h].e.nos;u=d<=p?p:d}}if(i&&i.queries.length>0)for(var h=0;h<i.queries.length;h++){if(i.queries[h].fn==="onSkip"){c=i.queries[h].e.nos,i.queries.splice(h,1),--h;continue}if(i.queries[h].fn==="onTake"){var f=i.queries[h].e.nos;u=f<=u?u:f,i.queries.splice(h,1),--h}}c>0&&this.virtualItemStartIndex<=c?i.skip(c):i.skip(this.virtualItemStartIndex),u>0&&d<=u?i.take(u):i.take(d),i.requiresCount()}return i},e.prototype.searchLists=function(t){var i=this;if(this.isTyped=!0,this.isDataFetched=this.isSelectCustom=!1,this.firstItem=this.dataSource&&this.dataSource.length>0?this.dataSource[0]:null,this.checkAndResetCache(),g(this.list)&&o.prototype.renderList.call(this,t,!0),this.queryString=this.filterInput.value,t.type!=="mousedown"&&(t.keyCode===40||t.keyCode===38)){this.queryString=this.queryString===""?null:this.queryString,this.beforePopupOpen=!0,this.resetList(this.dataSource,this.fields,null,t);return}this.isSelected=!1,this.activeIndex=null,this.isRequesting=!1;var r={preventDefaultAction:!1,text:this.filterInput.value,updateData:function(n,s,a){r.cancel||(i.isFiltered=!0,i.customFilterQuery=s,i.filterAction(n,s,a))},cancel:!1};this.trigger("filtering",r,function(n){!n.cancel&&!i.isFiltered&&!n.preventDefaultAction&&(i.searchList=!0,i.filterAction(i.dataSource,null,i.fields,t))})},e.prototype.filter=function(t,i,r){this.isFiltered=!0,this.filterAction(t,i,r)},e.prototype.filterAction=function(t,i,r,n){this.beforePopupOpen=!0;var s=this.list.classList.contains("e-nodata");if(this.queryString!==""&&this.queryString.length>=this.minLength){if(this.enableVirtualization&&this.isFiltering()&&this.isTyped&&(this.isPreventScrollAction=!0,this.list.scrollTop=0,this.previousStartIndex=0,this.virtualListInfo=null),this.resetList(t,r,i,n),s=this.list.classList.contains("e-nodata"),this.enableVirtualization&&!s){if(!this.list.querySelector(".e-virtual-ddl-content")&&this.list.querySelector(".e-list-parent")){var a=this.createElement("div",{className:"e-virtual-ddl-content"});a.style.cssText=this.getTransformValues(),this.list.appendChild(a).appendChild(this.list.querySelector(".e-list-parent"))}if(!this.list.querySelector(".e-virtual-ddl")&&this.list.parentElement){var a=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});a.style.cssText=this.GetVirtualTrackHeight(),this.list.parentElement.querySelector(".e-dropdownbase").appendChild(a)}}(this.getModuleName()==="autocomplete"&&!(this.dataSource instanceof re)||this.getModuleName()==="autocomplete"&&this.dataSource instanceof re&&this.totalItemCount!==0)&&this.getFilteringSkeletonCount()}else this.hidePopup(n),this.beforePopupOpen=!1;this.renderReactTemplates()},e.prototype.clearAll=function(t,i){(g(i)||!g(i)&&g(i.dataSource))&&(o.prototype.clearAll.call(this,t),this.checkAndResetCache()),this.beforePopupOpen&&this.hidePopup()},e.prototype.onActionComplete=function(t,i,r,n){this.enableVirtualization||(this.fixedHeaderElement=null),(this.getModuleName()==="autocomplete"&&!(this.dataSource instanceof re)||this.getModuleName()==="autocomplete"&&this.dataSource instanceof re&&this.totalItemCount!==0)&&this.getFilteringSkeletonCount(),o.prototype.onActionComplete.call(this,t,i,r);var s=this.list.querySelector("."+Qe.li);g(s)||K([s],Qe.focus),!g(this.itemData)&&!this.enableVirtualization&&this.focusIndexItem(),this.postBackAction()},e.prototype.postBackAction=function(){if(this.autofill&&!g(this.liCollections[0])&&this.searchList){var t=[this.liCollections[0]],i=this.listData,r=this.typeOfData(i).typeof,n=aa(this.inputElement.value,t,"StartsWith",this.ignoreCase,i,this.fields,r);this.searchList=!1,g(n.item)||o.prototype.setAutoFill.call(this,this.liCollections[0],!0)}},e.prototype.setSelection=function(t,i){if(!this.isValidLI(t)){this.selectedLI=t;return}if(!g(i)&&i.type==="keydown"&&i.action!=="enter"&&i.action!=="tab"&&this.isValidLI(t)){var r=this.getFormattedValue(t.getAttribute("data-value"));if(this.activeIndex=this.getIndexByValue(r),this.setHoverList(t),this.selectedLI=t,this.setScrollPosition(i),this.autofill&&this.isPopupOpen){this.preventAutoFill=!1;var n=i&&i.action==="down"||i.action==="up"||i.action==="home"||i.action==="end"||i.action==="pageUp"||i.action==="pageDown";o.prototype.setAutoFill.call(this,t,n)}}else o.prototype.setSelection.call(this,t,i),this.isFiltered=!1},e.prototype.listOption=function(t,i){var r=this,n=o.prototype.listOption.call(this,t,i);if(g(n.itemCreated))n.itemCreated=function(a){r.highlight&&(r.element.tagName===r.getNgDirective()&&r.itemTemplate?setTimeout(function(){rm(a.item,r.queryString,r.ignoreCase,r.filterType)},0):rm(a.item,r.queryString,r.ignoreCase,r.filterType))};else{var s=n.itemCreated;n.itemCreated=function(a){r.highlight&&rm(a.item,r.queryString,r.ignoreCase,r.filterType),s.apply(r,[a])}}return n},e.prototype.isFiltering=function(){return!0},e.prototype.renderPopup=function(t){this.enableVirtualization||(this.list.scrollTop=0),o.prototype.renderPopup.call(this,t)},e.prototype.isEditTextBox=function(){return!1},e.prototype.isPopupButton=function(){return this.showPopupButton},e.prototype.isSelectFocusItem=function(t){return!1},e.prototype.setInputValue=function(t,i){var r=i&&i.text?i.text:i&&i.value,n=t&&t.text?t.text:t&&t.value?t.value:this.value;if(this.allowObjectBinding&&(r=g(r)?r:V(this.fields.value?this.fields.value:"",r),n=g(n)?n:V(this.fields.value?this.fields.value:"",n)),n&&this.typedString===""&&!this.allowCustom&&!(this.dataSource instanceof re)){var s=this.typeOfData(this.dataSource).typeof==="string"?"":this.fields.value,a=this.getItems().length,l=new Pe,h=this;new re(this.dataSource).executeQuery(l.where(new St(s,"equal",n))).then(function(u){u.result.length>0?(h.value=s!==""?h.allowObjectBinding?u.result[0]:u.result[0][h.fields.value].toString():u.result[0].toString(),h.addItem(u.result,a),h.updateValues()):t&&t.text?h.setOldText(r):t&&t.value?h.setOldValue(r):h.updateValues()})}else t&&(t.text?this.setOldText(r):this.setOldValue(r))},e.prototype.showPopup=function(t){if(this.enabled){if(this.beforePopupOpen){this.refreshPopup();return}this.beforePopupOpen=!0,this.preventAutoFill=!0,g(this.list)?this.renderList(t):this.resetList(this.dataSource,this.fields,null,t)}},e.prototype.hidePopup=function(t){o.prototype.hidePopup.call(this,t),this.activeIndex=null,this.virtualListInfo=this.viewPortInfo,this.previousStartIndex=this.viewPortInfo.startIndex,this.startIndex=this.viewPortInfo.startIndex,this.previousEndIndex=this.viewPortInfo.endIndex},e.prototype.onPropertyChanged=function(t,i){this.getModuleName()==="autocomplete"&&this.setUpdateInitial(["fields","query","dataSource"],t);for(var r=0,n=Object.keys(t);r<n.length;r++){var s=n[r];switch(s){case"showPopupButton":if(this.showPopupButton){var a=Ce.appendSpan(Qe.icon,this.inputWrapper.container,this.createElement);this.inputWrapper.buttons[0]=a,Ce.calculateWidth(this.inputElement,this.inputWrapper.container),!g(this.inputWrapper.buttons[0])&&!g(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon"),this.inputWrapper&&this.inputWrapper.buttons&&this.inputWrapper.buttons[0]&&E.add(this.inputWrapper.buttons[0],"click",this.dropDownClick,this)}else ee(this.inputWrapper.buttons[0]),this.inputWrapper.buttons[0]=null;break;default:{var l=this.getPropObject(s,t,i);o.prototype.onPropertyChanged.call(this,l.newProperty,l.oldProperty);break}}}},e.prototype.renderHightSearch=function(){if(this.highlight)for(var t=0;t<this.liCollections.length;t++){var i=this.ulElement.querySelector(".e-active");i||(VV(this.liCollections[t]),rm(this.liCollections[t],this.queryString,this.ignoreCase,this.filterType)),i=null}},e.prototype.getModuleName=function(){return"autocomplete"},e.prototype.render=function(){o.prototype.render.call(this)},Pn([be({value:null,iconCss:null,groupBy:null,disabled:null},Aw)],e.prototype,"fields",void 0),Pn([C(!0)],e.prototype,"ignoreCase",void 0),Pn([C(!1)],e.prototype,"showPopupButton",void 0),Pn([C(!1)],e.prototype,"highlight",void 0),Pn([C(20)],e.prototype,"suggestionCount",void 0),Pn([C({})],e.prototype,"htmlAttributes",void 0),Pn([C(null)],e.prototype,"query",void 0),Pn([C(1)],e.prototype,"minLength",void 0),Pn([C("Contains")],e.prototype,"filterType",void 0),Pn([q()],e.prototype,"filtering",void 0),Pn([C(null)],e.prototype,"index",void 0),Pn([C("Never")],e.prototype,"floatLabelType",void 0),Pn([C(null)],e.prototype,"valueTemplate",void 0),Pn([C(null)],e.prototype,"filterBarPlaceholder",void 0),Pn([C(!1)],e.prototype,"allowFiltering",void 0),Pn([C(null)],e.prototype,"text",void 0),e=Pn([bt],e),e}(um),Dw="e-float-line",Yp="e-float-text",Ac="e-label-top",jh="e-label-bottom";function ik(o,e,t,i,r,n,s){var a=Xe("span",{className:Dw}),l=Xe("label",{className:Yp}),h=t.getAttribute("id")?t.getAttribute("id"):kt("ej2_multiselect");t.id=h,!g(t.id)&&t.id!==""&&(l.id="label_"+t.id.replace(/ /g,"_"),l.setAttribute("for",t.id),Ie(i,{"aria-labelledby":l.id})),!g(i.placeholder)&&i.placeholder!==""&&(l.innerText=Ew(i.placeholder),i.removeAttribute("placeholder")),l.innerText=Ew(s),e.appendChild(a),e.appendChild(l),o.classList.add("e-float-input"),r5(r,l),n==="Always"&&(l.classList.contains(jh)&&K([l],jh),Y([l],Ac))}function r5(o,e){o&&o.length>0?(Y([e],Ac),K([e],jh)):(K([e],Ac),Y([e],jh))}function n5(o,e,t,i,r,n,s){var a=e.querySelector("."+Yp),l=e.querySelector("."+Dw),h;g(a)?(h=s!==null?s:"",rk(r,i,h)):(h=a.innerText,ee(t.querySelector("."+Yp)),rk(r,i,h),g(l)||ee(t.querySelector("."+Dw))),o.classList.remove("e-float-input")}function rk(o,e,t){o&&o.length?e.placeholder="":e.placeholder=t}function s5(o,e){o.classList.add("e-input-focus");var t=e.querySelector("."+Yp);g(t)||(Y([t],Ac),t.classList.contains(jh)&&K([t],jh))}function a5(o,e,t,i,r){o.classList.remove("e-input-focus");var n=e.querySelector("."+Yp);t&&t.length<=0&&i==="Auto"&&!g(n)&&(n.classList.contains(Ac)&&K([n],Ac),Y([n],jh))}function Ew(o){var e="";if(!g(o)&&o!==""){var t=document.createElement("span");t.innerHTML='<input  placeholder="'+o+'"/>';var i=t.children[0];e=i.placeholder}return e}var o5=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),rt=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Bh="e-input-focus",qp="e-disabled",l5="e-multiselect e-input-group e-control-wrapper",h5="e-multi-select-wrapper",u5="e-mob-wrapper",Si="e-hide-listitem",c5="e-delim-view",d5="e-chips-collection",Ec="e-chips",p5="e-chipcontent",nm="e-chips-close",_l="e-chip-selected",f5="e-searcher",nk="e-delimiter",sm="e-zero-size",g5="e-remain",sk="e-chips-close e-close-hooker",ak="e-delim-values",v5="e-ddl e-popup e-multi-select-list-wrapper",m5="e-dropdownbase",ok="e-rtl",xw="e-close-icon-hide",y5="e-mob-chip",b5="e-ddl-footer",S5="e-ddl-header",lk="e-ddl-disable-icon",hk="e-ms-spinner-icon",C5="e-multi-hidden",w5="destroy",uk="e-input-group-icon e-ddl-icon",ck="e-icon-anim",am="e-delim-total",x5="e-multiselect-box",I5="e-filter-parent",dk="e-search-custom-width",Iw="e-input-filter",M5="e-resizer-right e-icons",dm=function(o){o5(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.clearIconWidth=0,r.previousFilterText="",r.storedSelectAllHeight=0,r.isUpdateHeaderHeight=!1,r.isUpdateFooterHeight=!1,r.isBlurDispatching=!1,r.isFilterPrevented=!1,r.isFilteringAction=!1,r.isVirtualReorder=!1,r.isValidKey=!1,r.selectAllEventData=[],r.selectAllEventEle=[],r.preventSetCurrentData=!1,r.isSelectAllLoop=!1,r.scrollFocusStatus=!1,r.keyDownStatus=!1,r}return e.prototype.enableRTL=function(t){t?this.overAllWrapper.classList.add(ok):this.overAllWrapper.classList.remove(ok),this.popupObj&&(this.popupObj.enableRtl=t,this.popupObj.dataBind())},e.prototype.requiredModules=function(){var t=[];if(this.enableVirtualization&&t.push({args:[this],member:"VirtualScroll"}),this.mode==="CheckBox"){if(this.isGroupChecking=this.enableGroupCheckBox,this.enableGroupCheckBox){var i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.enableSelectionOrder=!1,this.isProtectedOnChange=i}this.allowCustomValue=!1,this.hideSelectedItem=!1,this.closePopupOnSelect=!1,t.push({member:"CheckBoxSelection",args:[this]})}return t},e.prototype.updateHTMLAttribute=function(){if(Object.keys(this.htmlAttributes).length)for(var t=0,i=Object.keys(this.htmlAttributes);t<i.length;t++){var r=i[t];switch(r){case"class":{var n=this.htmlAttributes[""+r].replace(/\s+/g," ").trim();n!==""&&(Y([this.overAllWrapper],n.split(" ")),Y([this.popupWrapper],n.split(" ")));break}case"disabled":this.enable(!1);break;case"placeholder":this.placeholder||(this.inputElement.setAttribute(r,this.htmlAttributes[""+r]),this.setProperties({placeholder:this.inputElement.placeholder},!0),this.refreshPlaceHolder());break;default:{var s=["id"],a=["name","required","aria-required","form"],l=["title","role","style","class"];s.indexOf(r)>-1?this.element.setAttribute(r,this.htmlAttributes[""+r]):r.indexOf("data")===0||a.indexOf(r)>-1?this.hiddenElement.setAttribute(r,this.htmlAttributes[""+r]):l.indexOf(r)>-1?this.overAllWrapper.setAttribute(r,this.htmlAttributes[""+r]):r!=="size"&&!g(this.inputElement)&&this.inputElement.setAttribute(r,this.htmlAttributes[""+r]);break}}}},e.prototype.updateReadonly=function(t){g(this.inputElement)||(t||this.mode==="CheckBox"?this.inputElement.setAttribute("readonly","true"):this.inputElement.removeAttribute("readonly"))},e.prototype.updateClearButton=function(t){t?(this.overAllClear.parentNode?this.overAllClear.style.display="":this.componentWrapper.appendChild(this.overAllClear),this.componentWrapper.classList.remove(xw)):(this.overAllClear.style.display="none",this.componentWrapper.classList.add(xw))},e.prototype.updateCssClass=function(){if(!g(this.cssClass)&&this.cssClass!==""){var t=this.cssClass;t=this.cssClass.replace(/\s+/g," ").trim(),t!==""&&(Y([this.overAllWrapper],t.split(" ")),Y([this.popupWrapper],t.split(" ")))}},e.prototype.updateOldPropCssClass=function(t){!g(t)&&t!==""&&(t=t.replace(/\s+/g," ").trim(),t!==""&&(K([this.overAllWrapper],t.split(" ")),K([this.popupWrapper],t.split(" "))))},e.prototype.onPopupShown=function(t){var i=this;if(B.isDevice&&this.mode==="CheckBox"&&this.allowFiltering){var r=this;window.onpopstate=function(){r.hidePopup(),r.inputElement.focus()},history.pushState({},"")}var n={name:"FadeIn",duration:100},s={popup:this.popupObj,event:t,cancel:!1,animation:n};this.trigger("open",s,function(a){a.cancel||(i.focusAtFirstListItem(!0),i.popupObj&&document.body.appendChild(i.popupObj.element),i.mode==="CheckBox"&&i.enableGroupCheckBox&&!g(i.fields.groupBy)&&i.updateListItems(i.list.querySelectorAll("li.e-list-item"),i.mainList.querySelectorAll("li.e-list-item")),(i.mode==="CheckBox"||i.showDropDownIcon)&&Y([i.overAllWrapper],[ck]),i.refreshPopup(),i.renderReactTemplates(),i.popupObj&&i.popupObj.show(a.animation,i.zIndex===1e3?i.element:null),i.isReact&&setTimeout(function(){if(i.popupHeight&&i.list&&i.popupHeight!=="auto"){var l=typeof i.popupHeight=="string"?parseInt(i.popupHeight,10):i.popupHeight;if(!i.isUpdateHeaderHeight&&i.headerTemplate&&i.header){var h=i.list.style.maxHeight===""?l:parseInt(i.list.style.maxHeight,10);i.list.style.maxHeight=(h-i.header.offsetHeight).toString()+"px",i.isUpdateHeaderHeight=!0}if(!i.isUpdateFooterHeight&&i.footerTemplate&&i.footer){var h=i.list.style.maxHeight===""?l:parseInt(i.list.style.maxHeight,10);i.list.style.maxHeight=(h-i.footer.offsetHeight).toString()+"px",i.isUpdateFooterHeight=!0}}},15),Ie(i.inputElement,{"aria-expanded":"true","aria-owns":i.element.id+"_popup","aria-controls":i.element.id}),i.updateAriaActiveDescendant(),i.isFirstClick&&(i.enableVirtualization||i.loadTemplate()),i.mode==="CheckBox"&&i.showSelectAll&&E.add(i.popupObj.element,"click",i.clickHandler,i))})},e.prototype.updateVirtualReOrderList=function(t){var i=this.getForQuery(this.value,!0).clone();if(this.isVirtualReorder=!0,this.enableVirtualization&&this.dataSource instanceof re?this.resetList(this.selectedListData,this.fields,i):this.resetList(this.dataSource,this.fields,i),this.isVirtualReorder=!1,this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+le.li),this.virtualItemCount=this.itemCount,this.mode!=="CheckBox"&&(this.totalItemCount=this.value&&this.value.length?this.totalItemCount-this.value.length:this.totalItemCount),this.list.querySelector(".e-virtual-ddl"))this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight();else{var r=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});r.style.cssText=this.GetVirtualTrackHeight(),this.popupWrapper.querySelector(".e-dropdownbase").appendChild(r)}this.list.querySelector(".e-virtual-ddl-content")&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues()),t&&this.loadTemplate()},e.prototype.updateListItems=function(t,i){for(var r=0;r<t.length;r++)this.findGroupStart(t[r]),this.findGroupStart(i[r]);this.deselectHeader()},e.prototype.loadTemplate=function(){if(this.refreshListItems(null),this.enableVirtualization&&this.list&&this.mode==="CheckBox"){var t=this.list.querySelectorAll(".e-reorder")[0];this.list.querySelector(".e-virtual-ddl-content")&&t&&this.list.querySelector(".e-virtual-ddl-content").removeChild(t)}this.mode==="CheckBox"&&this.removeFocus(),this.notify("reOrder",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",e:this}),this.isPreventScrollAction=!0},e.prototype.setScrollPosition=function(){if((!this.hideSelectedItem&&this.mode!=="CheckBox"||this.mode==="CheckBox"&&!this.enableSelectionOrder)&&!g(this.value)&&this.value.length>0){var t=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[this.value.length-1]):this.value[this.value.length-1],i=this.findListElement(this.hideSelectedItem?this.ulElement:this.list,"li","data-value",t);g(i)||this.scrollBottom(i,void 0,!1,null,!0)}if(this.enableVirtualization){var r=this.list.querySelector("."+le.focus);this.isKeyBoardAction=!1,this.scrollBottom(r,void 0,!1,null,!0)}},e.prototype.focusAtFirstListItem=function(t){if(this.ulElement&&this.ulElement.querySelector("li."+le.li)){var i=void 0;if(this.mode==="CheckBox"){this.removeFocus();return}else if(this.enableVirtualization){if(this.fields.disabled){if(i=this.ulElement.querySelector("li."+le.li+":not(.e-virtual-list):not(.e-hide-listitem):not(."+qp+")"),t&&this.viewPortInfo&&this.viewPortInfo.startIndex!==0){var r=this.ulElement.querySelectorAll("li."+le.li+":not(.e-virtual-list):not(.e-hide-listitem)");i=r&&r.length>0?r[2]:i}}else if(i=this.ulElement.querySelector("li."+le.li+":not(.e-virtual-list):not(.e-hide-listitem)"),t&&this.viewPortInfo&&this.viewPortInfo.startIndex!==0){var r=this.ulElement.querySelectorAll("li."+le.li+":not(.e-virtual-list):not(.e-hide-listitem)");i=r&&r.length>0?r[2]:i}}else this.fields.disabled?i=this.ulElement.querySelector("li."+le.li+":not(."+Si+"):not(."+qp+")"):i=this.ulElement.querySelector("li."+le.li+":not(."+Si+")");i!==null&&(this.removeFocus(),this.addListFocus(i))}},e.prototype.focusAtLastListItem=function(t){var i;if(t)i=aa(t,this.liCollections,"StartsWith",this.ignoreCase);else if(this.value&&this.value.length){var r=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[this.value.length-1]):this.value[this.value.length-1];aa(r,this.liCollections,"StartsWith",this.ignoreCase)}else i=null;i&&i.item!==null&&(this.addListFocus(i.item),((this.allowCustomValue||this.allowFiltering)&&this.isPopupOpen()&&this.closePopupOnSelect&&!this.enableVirtualization||this.closePopupOnSelect&&!this.enableVirtualization)&&this.scrollBottom(i.item,i.index))},e.prototype.getAriaAttributes=function(){var t={"aria-disabled":"false",role:"combobox","aria-expanded":"false"};return t},e.prototype.updateListARIA=function(){g(this.ulElement)||Ie(this.ulElement,{id:this.element.id+"_options",role:"listbox","aria-hidden":"false","aria-label":"list"});var t=!!(!g(this.inputElement)&&this.inputElement.disabled);!this.isPopupOpen()&&!g(this.inputElement)&&Ie(this.inputElement,this.getAriaAttributes()),t&&Ie(this.inputElement,{"aria-disabled":"true"}),this.ensureAriaDisabled(t?"true":"false")},e.prototype.ensureAriaDisabled=function(t){if(this.htmlAttributes&&this.htmlAttributes["aria-disabled"]){var i=this.htmlAttributes;he(i,{"aria-disabled":t},i),this.setProperties({htmlAttributes:i},!0)}},e.prototype.removelastSelection=function(t){var i=this.chipCollectionWrapper.querySelector("span."+_l);if(i!==null){this.removeSelectedChip(t);return}var r=this.chipCollectionWrapper.querySelectorAll("span."+Ec),n=r[r.length-1].getAttribute("data-value");g(this.value)||(this.tempValues=this.allowObjectBinding?this.value.slice():this.value.slice());var s=this.allowObjectBinding?this.getDataByValue(this.getFormattedValue(n)):this.getFormattedValue(n);this.allowCustomValue&&(n!=="false"&&s===!1||!g(s)&&s.toString()==="NaN")&&(s=n),this.removeValue(s,t),this.removeChipSelection(),this.updateDelimeter(this.delimiterChar,t),this.makeTextBoxEmpty(),this.mainList&&this.listData&&this.refreshSelection(),this.checkPlaceholderSize()},e.prototype.onActionFailure=function(t){o.prototype.onActionFailure.call(this,t),this.renderPopup(),this.onPopupShown()},e.prototype.targetElement=function(){return this.targetInputElement=this.inputElement,this.mode==="CheckBox"&&this.allowFiltering&&this.notify("targetElement",{module:"CheckBoxSelection",enable:this.mode==="CheckBox"}),this.targetInputElement.value},e.prototype.getForQuery=function(t,i){var r,n=this.isPrimitiveData?"":this.fields.value;if(this.enableVirtualization&&t)if(i){for(var s=this.viewPortInfo.startIndex,a=s+this.viewPortInfo.endIndex<=t.length&&t[s+this.viewPortInfo.endIndex]?s+this.viewPortInfo.endIndex:t.length,l=s;l<a;l++){var h=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",t[l]):t[l];l===s?r=new St(n,"equal",h):r=r.or(n,"equal",h)}return new Pe().where(r)}else{for(var l=0;l<t.length;l++){var h=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",t[l]):t[l];this.isaddNonPresentItems?r=l===0?new St(n,"equal",t[l]):r.or(n,"equal",t[l]):r=l===0?r=new St(n,"notequal",h):r.and(n,"notequal",h)}return new Pe().where(r)}else for(var l=0;l<t.length;l++)l===0?r=new St(n,"equal",t[l]):r=r.or(n,"equal",t[l]);return this.dataSource instanceof re&&this.dataSource.adaptor instanceof np?new Pe().where(r):this.getQuery(this.query).clone().where(r)},e.prototype.onActionComplete=function(t,i,r,n){var s=this;if(this.dataSource instanceof re&&!g(r)&&!this.virtualGroupDataSource&&(this.totalItemCount=r.count),this.value&&i&&i.length>0&&this.allowFiltering&&this.mode!=="CheckBox"&&!this.enableVirtualization&&!this.isFilterPrevented&&!this.allowCustomValue&&this.isFilteringAction){var a=i.every(function(f){var v=V(s.fields.value?s.fields.value:"",f);return s.value.some(function(m){var y=s.allowObjectBinding?V(s.fields.value?s.fields.value:"",m):m;return v===y})});a&&(t.innerHTML="",i=[])}o.prototype.onActionComplete.call(this,t,i,r),this.skeletonCount=this.totalItemCount!==0&&this.totalItemCount<this.itemCount*2&&(!(this.dataSource instanceof re)||this.dataSource instanceof re&&this.totalItemCount<=this.itemCount)?0:this.skeletonCount,this.updateSelectElementData(this.allowFiltering);var l=this;if(!g(this.value)&&!this.allowCustomValue&&!this.enableVirtualization&&this.listData&&this.listData.length>0)for(var h=0;h<this.value.length;h++){var u=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",l.value[h]):l.value[h],c=this.findListElement(this.allowFiltering&&!g(this.mainList)?this.mainList:t,"li","data-value",u);!c&&!(this.dataSource instanceof re)&&(this.value.splice(h,1),h-=1)}var d=[];if(g(this.value)||(d=this.presentItemValue(this.ulElement)),d.length>0&&this.dataSource instanceof re&&!g(this.value)&&this.listData!=null?(this.isaddNonPresentItems=!0,this.addNonPresentItems(d,this.ulElement,this.listData),this.isaddNonPresentItems=!1):this.updateActionList(t,i,r),this.dataSource instanceof re&&this.allowCustomValue&&!this.isCustomRendered&&this.inputElement.value&&this.inputElement.value!==""){var p=new Pe;p=this.allowFiltering?p.where(this.fields.text,"startswith",this.inputElement.value,this.ignoreCase,this.ignoreAccent):p,this.checkForCustomValue(p,this.fields),this.isCustomRendered=!0,this.remoteCustomValue=this.enableVirtualization?!1:this.remoteCustomValue}this.mode==="CheckBox"&&this.enableGroupCheckBox&&!g(this.fields.groupBy)&&!g(this.fields.disabled)&&this.disableGroupHeader(),this.dataSource instanceof re&&this.mode==="CheckBox"&&this.allowFiltering&&this.removeFocus()},e.prototype.updateActionList=function(t,i,r,n){this.mode==="CheckBox"&&this.showSelectAll&&this.notify("selectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox"}),!this.mainList&&!this.mainData?(this.mainList=t.cloneNode?t.cloneNode(!0):t,this.mainData=i,this.mainListCollection=this.liCollections):(g(this.mainData)||this.mainData.length===0)&&(this.mainData=i),!((this.remoteCustomValue||i.length<=0)&&this.allowCustomValue&&this.inputFocus&&this.allowFiltering&&this.inputElement.value&&this.inputElement.value!==""&&(this.checkForCustomValue(this.tempQuery,this.fields),this.isCustomRendered))&&(this.value&&this.value.length&&(this.mode!=="CheckBox"&&!g(this.inputElement)&&this.inputElement.value.trim()!==""||this.mode==="CheckBox"||(this.keyCode===8||this.keyCode===46)&&this.allowFiltering&&this.allowCustomValue&&this.dataSource instanceof re&&this.inputElement.value==="")&&this.refreshSelection(),this.updateListARIA(),this.unwireListEvents(),this.wireListEvents(),g(this.setInitialValue)||this.setInitialValue(),g(this.selectAllAction)||this.selectAllAction(),this.setDynValue&&(!g(this.text)&&(g(this.value)||this.value.length===0)&&this.initialTextUpdate(),!this.enableVirtualization||this.enableVirtualization&&!(this.dataSource instanceof re)?this.initialValueUpdate():this.initialValueUpdate(this.listData,!0),this.initialUpdate(),this.refreshPlaceHolder(),this.mode!=="CheckBox"&&this.changeOnBlur&&this.updateValueState(null,this.value,null)),this.renderPopup(),this.beforePopupOpen&&(this.beforePopupOpen=!1,this.onPopupShown(r)))},e.prototype.refreshSelection=function(){var t,i,r=this.hideSelectedItem?Si:le.selected;if(!g(this.value)){for(var n=0;!g(this.value[n]);n++)if(t=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[n]):this.value[n],i=this.findListElement(this.list,"li","data-value",t),i){if(Y([i],r),this.hideSelectedItem&&i.previousSibling&&i.previousElementSibling.classList.contains(le.group)&&(!i.nextElementSibling||i.nextElementSibling.classList.contains(le.group))&&Y([i.previousElementSibling],r),this.hideSelectedItem&&this.fields.groupBy&&!i.previousElementSibling.classList.contains(Si)&&this.hideGroupItem(t),this.hideSelectedItem&&i.classList.contains(le.focus)){K([i],le.focus);var s=i.parentElement.querySelectorAll("."+le.li+":not(."+Si+"):not(."+qp+")");s.length>0?(Y([s[0]],le.focus),this.updateAriaActiveDescendant()):this.list&&this.list.querySelectorAll("."+le.li).length>0||(this.l10nUpdate(),Y([this.list],le.noData))}if(i.setAttribute("aria-selected","true"),this.mode==="CheckBox"&&i.classList.contains("e-active")){var a=i.getElementsByClassName("e-check").length;if(a===0){var l={module:"CheckBoxSelection",enable:this.mode==="CheckBox",li:i,e:null};this.notify("updatelist",l)}}}}this.checkSelectAll(),this.checkMaxSelection()},e.prototype.hideGroupItem=function(t){var i,r,n=this.hideSelectedItem?Si:le.selected;r=i=this.findListElement(this.ulElement,"li","data-value",t);var s=0,a=0,l=!0,h=!0;do i&&i.previousElementSibling&&!i.previousElementSibling.classList.contains(Si)&&i.previousElementSibling.classList.contains(le.li)&&(l=!1),!l||!i||i.previousElementSibling&&i.previousElementSibling.classList.contains(le.group)?s=10:i=i.previousElementSibling,r&&r.nextElementSibling&&!r.nextElementSibling.classList.contains(Si)&&r.nextElementSibling.classList.contains(le.li)&&(h=!1),!h||!r||r.nextElementSibling&&r.nextElementSibling.classList.contains(le.group)?a=10:r=r.nextElementSibling;while(s<10||a<10);l&&h&&!i.previousElementSibling.classList.contains(Si)?Y([i.previousElementSibling],n):l&&h&&i.previousElementSibling.classList.contains(Si)&&K([i.previousElementSibling],n)},e.prototype.getValidLi=function(){var t=this.ulElement.querySelector("li."+le.li+":not(."+Si+")");return g(t)?this.liCollections[0]:t},e.prototype.checkSelectAll=function(){var t=g(this.fields.disabled)?this.list.querySelectorAll("li.e-list-group-item.e-active").length:this.list.querySelectorAll("li.e-list-group-item.e-active:not(.e-disabled)").length,i=this.list.querySelectorAll("li.e-list-item"),r=this.enableVirtualization?this.list.querySelectorAll("li."+le.li+":not(.e-virtual-list)").length:g(this.fields.disabled)?this.list.querySelectorAll("li."+le.li).length:this.list.querySelectorAll("li."+le.li+":not(.e-disabled)").length,n=this.list.querySelectorAll("li."+le.selected).length;if(this.enableGroupCheckBox&&!g(this.fields.groupBy)&&(n=n-t),!this.enableVirtualization&&(r===n||n===this.maximumSelectionLength)&&this.mode==="CheckBox"&&this.showSelectAll||this.enableVirtualization&&this.mode==="CheckBox"&&this.showSelectAll&&this.virtualSelectAll&&this.value&&this.value.length===this.totalItemCount?this.notify("checkSelectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",value:"check"}):r!==n&&this.mode==="CheckBox"&&this.showSelectAll&&(!this.enableVirtualization||this.enableVirtualization&&!this.virtualSelectAll)&&this.notify("checkSelectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",value:"uncheck"}),this.enableGroupCheckBox&&this.fields.groupBy&&!this.enableSelectionOrder){for(var s=0;s<i.length;s++)this.findGroupStart(i[s]);this.deselectHeader()}},e.prototype.openClick=function(t){!this.openOnClick&&this.mode!=="CheckBox"&&!this.isPopupOpen()?this.targetElement()!==""?this.showPopup():this.hidePopup(t):!this.openOnClick&&this.mode==="CheckBox"&&!this.isPopupOpen()&&this.showPopup()},e.prototype.keyUp=function(t){if(this.mode==="CheckBox"&&!this.openOnClick){var i=String.fromCharCode(t.keyCode),r=i.match(/\w/);g(r)||(this.isValidKey=!0)}if(this.isValidKey=this.isPopupOpen()&&t.keyCode===8||this.isValidKey,this.isValidKey=t.ctrlKey&&t.keyCode===86?!1:this.isValidKey,this.isValidKey&&this.inputElement)switch(this.isValidKey=!1,this.expandTextbox(),this.showOverAllClear(),t.keyCode){default:this.search(t)}},e.prototype.filter=function(t,i,r){this.isFiltered=!0,this.remoteFilterAction=!0,this.dataUpdater(t,i,r)},e.prototype.getQuery=function(t){var i=t?t.clone():this.query?this.query.clone():new Pe;if(this.isFiltered){if(this.enableVirtualization&&!g(this.customFilterQuery))return i=this.customFilterQuery.clone(),this.virtualFilterQuery(i);if(!this.enableVirtualization)return i}if(this.filterAction){if(this.targetElement()!==null&&!this.enableVirtualization||this.enableVirtualization&&this.targetElement()!==null&&this.targetElement().trim()!==""){var r=this.typeOfData(this.dataSource).typeof;if(!(this.dataSource instanceof re)&&r==="string"||r==="number")i.where("",this.filterType,this.targetElement(),this.ignoreCase,this.ignoreAccent);else if(this.enableVirtualization&&this.targetElement()!==""&&!this.isClearAllAction||!this.enableVirtualization){var n=this.fields;i.where(g(n.text)?"":n.text,this.filterType,this.targetElement(),this.ignoreCase,this.ignoreAccent)}}return this.enableVirtualization&&this.viewPortInfo.endIndex!==0&&!this.virtualSelectAll?this.virtualFilterQuery(i):this.virtualSelectAll?t?t.take(this.maximumSelectionLength).requiresCount():this.query?this.query.take(this.maximumSelectionLength).requiresCount():new Pe().take(this.maximumSelectionLength).requiresCount():i}else return this.enableVirtualization&&this.viewPortInfo.endIndex!==0&&!this.virtualSelectAll?this.virtualFilterQuery(i):this.virtualSelectAll?t?t.take(this.maximumSelectionLength).requiresCount():this.query?this.query.take(this.maximumSelectionLength).requiresCount():new Pe().take(this.maximumSelectionLength).requiresCount():t||(this.query?this.query:new Pe)},e.prototype.virtualFilterQuery=function(t){for(var i=this.getTakeValue(),r=!0,n=!0,s=0;s<t.queries.length;s++)this.getModuleName()==="multiselect"&&(t.queries[s].e&&t.queries[s].e.condition==="or"||t.queries[s].e&&t.queries[s].e.operator==="equal")&&(r=!1),t.queries[s].fn==="onSkip"&&(n=!1),t.queries[s].fn;var a=0;if(t&&t.queries.length>0)for(var s=0;s<t.queries.length;s++)t.queries[s].fn==="onTake"&&(a=i<=t.queries[s].e.nos?t.queries[s].e.nos:i);if(a<=0&&this.query&&this.query.queries.length>0)for(var s=0;s<this.query.queries.length;s++)this.query.queries[s].fn==="onTake"&&(a=i<=this.query.queries[s].e.nos?this.query.queries[s].e.nos:i);if(t&&t.queries.length>0)for(var s=0;s<t.queries.length;s++)t.queries[s].fn==="onTake"&&(a=t.queries[s].e.nos<=a?a:t.queries[s].e.nos,t.queries.splice(s,1),--s);return(this.allowFiltering&&n||!r||!this.allowFiltering&&n&&!this.isVirtualReorder)&&(r?t.skip(this.virtualItemStartIndex):t.skip(this.viewPortInfo.startIndex)),this.isIncrementalRequest?t.take(this.incrementalEndIndex):a>0?t.take(a):t.take(i),t.requiresCount(),this.customFilterQuery=null,t},e.prototype.getTakeValue=function(){return this.allowFiltering&&B.isDevice?Math.round(window.outerHeight/this.listItemHeight):this.itemCount},e.prototype.dataUpdater=function(t,i,r){this.isDataFetched=!1;var n=this.list.classList.contains(le.noData);if(this.targetElement().trim()===""){var s=this.enableVirtualization?this.list.cloneNode(!0):this.mainList.cloneNode?this.mainList.cloneNode(!0):this.mainList;if(this.backCommand||this.enableVirtualization&&this.mode==="CheckBox"&&this.value&&this.value.length>0){this.remoteCustomValue=!1;var a=!1;if(this.allowCustomValue&&s.querySelectorAll("li").length===0&&this.mainData.length>0&&(this.mainData=[]),this.enableVirtualization){if(this.allowFiltering&&(this.isPreventScrollAction=!0,this.list.scrollTop=0,this.previousStartIndex=0,this.virtualListInfo=null),this.value&&this.value.length>0&&this.mode==="CheckBox")this.notify("setCurrentViewDataAsync",{component:this.getModuleName(),module:"VirtualScroll"}),a=!0;else if(this.totalItemCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.resetList(t,r,i),this.mode!=="CheckBox"&&(this.totalItemCount=this.value&&this.value.length?this.totalItemCount-this.value.length:this.totalItemCount),this.UpdateSkeleton(),(n||this.allowCustomValue)&&!this.list.classList.contains(le.noData)){if(!this.list.querySelector(".e-virtual-ddl-content")){var l=this.createElement("div",{className:"e-virtual-ddl-content"});l.style.cssText=this.getTransformValues(),this.list.appendChild(l).appendChild(this.list.querySelector(".e-list-parent"))}if(!this.list.querySelector(".e-virtual-ddl")){var h=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});h.style.cssText=this.GetVirtualTrackHeight(),document.getElementsByClassName("e-multi-select-list-wrapper")[0].querySelector(".e-dropdownbase").appendChild(h)}}}this.onActionComplete(s,this.mainData),this.value&&this.value.length&&this.refreshSelection(),this.keyCode!==8&&this.focusAtFirstListItem(),a||this.notify("reOrder",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",e:this})}}else{if(this.enableVirtualization&&this.allowFiltering&&(this.isPreventScrollAction=!0,this.list.scrollTop=0,this.previousStartIndex=0,this.virtualListInfo=null,this.list.querySelector(".e-list-parent.e-reorder")&&this.list.querySelector(".e-list-parent.e-reorder").remove()),this.resetList(t,r,i),this.enableVirtualization&&(n||this.allowCustomValue)&&!this.list.classList.contains(le.noData)){if(!this.list.querySelector(".e-virtual-ddl-content")){var l=this.createElement("div",{className:"e-virtual-ddl-content"});l.style.cssText=this.getTransformValues(),this.list.appendChild(l).appendChild(this.list.querySelector(".e-list-parent"))}if(this.mode!=="CheckBox"&&(this.totalItemCount=this.value&&this.value.length?this.totalItemCount-this.value.length:this.totalItemCount),!this.list.querySelector(".e-virtual-ddl")){var h=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});h.style.cssText=this.GetVirtualTrackHeight(),document.getElementsByClassName("e-multi-select-list-wrapper")[0].querySelector(".e-dropdownbase").appendChild(h)}}this.allowCustomValue&&(t instanceof re?(this.remoteCustomValue=!0,this.tempQuery=i):this.checkForCustomValue(i,r))}this.enableVirtualization&&this.allowFiltering&&this.getFilteringSkeletonCount(),this.refreshPopup(),this.allowResize&&this.setResize(),this.mode==="CheckBox"&&this.removeFocus()},e.prototype.checkForCustomValue=function(t,i){var r=!this.getValueByText(this.inputElement.value,this.ignoreCase),n=i||this.fields;if(this.allowCustomValue&&r){var s=this.inputElement.value,a=!g(this.mainData)&&this.mainData.length>0?this.mainData[0]:this.mainData;if(a&&typeof a!="string"&&typeof a!="number"&&typeof a!="boolean"){var l={};Ge(n.text,s,l),typeof V(this.fields.value?this.fields.value:"value",a)=="number"&&this.fields.value!==this.fields.text?Ge(n.value,Math.random(),l):Ge(n.value,s,l);var h={};if(this.allowObjectBinding){var u=this.listData&&this.listData.length>0?Object.keys(this.listData[0]):this.firstItem?Object.keys(this.firstItem):Object.keys(l);u.forEach(function(m){h[m]=m===i.value||m===i.text?V(i.value,l):null})}if(l=this.allowObjectBinding?h:l,this.enableVirtualization){this.virtualCustomData=l;var c=this.dataSource instanceof re?JSON.parse(JSON.stringify(this.listData)):JSON.parse(JSON.stringify(this.dataSource)),d=[];this.virtualCustomSelectData&&this.virtualCustomSelectData.length>0&&(d=c.concat(this.virtualCustomSelectData)),c.splice(0,0,l),this.isCustomDataUpdated=!0;var p=this.totalItemCount;this.viewPortInfo.startIndex=this.virtualItemStartIndex=0,this.viewPortInfo.endIndex=this.virtualItemEndIndex=this.itemCount,this.resetList(c,n,t),this.isCustomDataUpdated=!1,this.totalItemCount=this.enableVirtualization&&this.dataSource instanceof re?p:this.totalItemCount}else{this.dataSource instanceof re&&this.allowCustomValue&&this.allowFiltering&&(this.remoteCustomValue=!1);var c=JSON.parse(JSON.stringify(this.listData));c.splice(0,0,l),this.resetList(c,n,t)}}else if(this.listData){var c=JSON.parse(JSON.stringify(this.listData));c.splice(0,0,this.inputElement.value),c[0]=typeof a=="number"&&!isNaN(parseFloat(c[0]))?parseFloat(c[0]):c[0],c[0]=typeof a=="boolean"?c[0]==="true"?!0:c[0]==="false"?!1:c[0]:c[0],this.resetList(c,n)}}else if(this.listData&&this.mainData&&!r&&this.allowCustomValue){if(this.allowFiltering&&this.isRemoteSelection&&this.remoteCustomValue)this.isRemoteSelection=!1,this.enableVirtualization||this.resetList(this.listData,n,t);else if(!this.allowFiltering&&this.list){var f=this.list.querySelectorAll("li."+le.li+":not(.e-hide-listitem)"),v=aa(this.targetElement(),f,"StartsWith",this.ignoreCase);v&&v.item!==null&&this.addListFocus(v.item)}}this.value&&this.value.length&&this.refreshSelection()},e.prototype.getNgDirective=function(){return"EJS-MULTISELECT"},e.prototype.wrapperClick=function(t){if(this.setDynValue=!1,this.keyboardEvent=null,this.isKeyBoardAction=!1,!!this.enabled){if(t.target===this.overAllClear){t.preventDefault();return}if(this.inputFocus||this.inputElement.focus(),!this.readonly){if(t.target&&t.target.classList.toString().indexOf(nm)!==-1){this.isPopupOpen()&&this.refreshPopup();return}!this.isPopupOpen()&&(this.openOnClick||this.showDropDownIcon&&t.target&&t.target.className===uk)?this.showPopup(t):(this.hidePopup(t),this.mode==="CheckBox"&&(this.showOverAllClear(),this.inputFocus=!0,this.overAllWrapper.classList.contains(Bh)||this.overAllWrapper.classList.add(Bh)))}this.targetElement()&&this.targetElement()!==""||t.preventDefault()}},e.prototype.enable=function(t){t?(this.overAllWrapper.classList.remove(qp),this.inputElement.removeAttribute("disabled"),Ie(this.inputElement,{"aria-disabled":"false"}),this.ensureAriaDisabled("false")):(this.overAllWrapper.classList.add(qp),this.inputElement.setAttribute("disabled","true"),Ie(this.inputElement,{"aria-disabled":"true"}),this.ensureAriaDisabled("true")),this.enabled!==t&&(this.enabled=t),this.hidePopup()},e.prototype.onBlurHandler=function(t,i){var r;if(this.isBlurDispatching&&this.isAngular){this.isBlurDispatching=!1;return}if(g(t)||(r=t.relatedTarget),this.popupObj&&document.body.contains(this.popupObj.element)&&this.popupObj.element.contains(r)){this.mode!=="CheckBox"?this.inputElement.focus():this.floatLabelType==="Auto"&&(this.overAllWrapper.classList.contains("e-outline")||this.overAllWrapper.classList.contains("e-filled"))&&Y([this.overAllWrapper],"e-valid-input");return}if(this.floatLabelType==="Auto"&&this.overAllWrapper.classList.contains("e-outline")&&this.mode==="CheckBox"&&(g(this.value)||this.value.length===0)&&K([this.overAllWrapper],"e-valid-input"),this.mode==="CheckBox"&&B.isIE&&!g(t)&&!i){this.inputFocus=!1,this.overAllWrapper.classList.remove(Bh);return}if(this.scrollFocusStatus){g(t)||t.preventDefault(),this.inputElement.focus(),this.scrollFocusStatus=!1;return}if(this.inputFocus=!1,this.overAllWrapper.classList.remove(Bh),this.addTagOnBlur){var n=this.getValueByText(this.inputElement.value,this.ignoreCase,this.ignoreAccent),s=this.findListElement(this.list,"li","data-value",n),a=this.hideSelectedItem?Si:le.selected,l=!!(s&&!s.classList.contains(a));l&&(this.updateListSelection(s,t),this.mode==="Delimiter"&&this.updateDelimeter(this.delimiterChar))}this.updateDataList(),this.refreshListItems(null),this.mode!=="Box"&&this.mode!=="CheckBox"&&this.updateDelimView(),this.changeOnBlur&&(this.updateValueState(t,this.value,this.tempValues),this.dispatchEvent(this.hiddenElement,"change")),this.overAllClear.style.display="none",this.isPopupOpen()&&this.hidePopup(t),this.makeTextBoxEmpty(),this.trigger("blur"),this.focused=!0,B.isDevice&&this.mode!=="Delimiter"&&this.mode!=="CheckBox"&&this.removeChipFocus(),this.removeChipSelection(),this.refreshInputHight(),a5(this.overAllWrapper,this.componentWrapper,this.value,this.floatLabelType,this.placeholder),this.refreshPlaceHolder(),(this.allowFiltering||this.enableSelectionOrder===!0&&this.mode==="CheckBox")&&!g(this.mainList)&&(this.ulElement=this.mainList),this.checkPlaceholderSize(),Ce.createSpanElement(this.overAllWrapper,this.createElement),this.calculateWidth(),!g(this.overAllWrapper)&&!g(this.overAllWrapper.getElementsByClassName("e-ddl-icon")[0]&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0]&&this.floatLabelType!=="Never")&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0].classList.add("e-icon"),this.isBlurDispatching=!0,this.isAngular&&this.dispatchEvent(this.inputElement,"blur")},e.prototype.calculateWidth=function(){var t;if(this.overAllWrapper){if(!this.showDropDownIcon||this.overAllWrapper.querySelector(".e-label-top"))t=this.overAllWrapper.clientWidth-2*parseInt(getComputedStyle(this.inputElement).paddingRight,10);else{var i=this.dropIcon.offsetWidth+parseInt(getComputedStyle(this.dropIcon).marginRight,10);t=this.overAllWrapper.clientWidth-(i+2*parseInt(getComputedStyle(this.inputElement).paddingRight,10))}this.floatLabelType!=="Never"&&Ce.calculateWidth(t,this.overAllWrapper,this.getModuleName())}},e.prototype.checkPlaceholderSize=function(){if(this.showDropDownIcon){var t=this.dropIcon.offsetWidth+parseInt(window.getComputedStyle(this.dropIcon).marginRight,10);this.setPlaceholderSize(t)}else g(this.dropIcon)||this.setPlaceholderSize(this.showDropDownIcon?this.dropIcon.offsetWidth:0)},e.prototype.setPlaceholderSize=function(t){g(this.value)||this.value.length===0?this.dropIcon.offsetWidth!==0?this.searchWrapper.style.width="calc(100% - "+(t+10)+"px":Y([this.searchWrapper],dk):g(this.value)||(this.searchWrapper.removeAttribute("style"),K([this.searchWrapper],dk))},e.prototype.refreshInputHight=function(){g(this.searchWrapper)||((!this.value||!this.value.length)&&(g(this.text)||this.text==="")?this.searchWrapper.classList.remove(sm):this.searchWrapper.classList.add(sm))},e.prototype.validateValues=function(t,i){return JSON.stringify(t.slice().sort())!==JSON.stringify(i.slice().sort())},e.prototype.updateValueState=function(t,i,r){var n=i||[],s=r||[];if(this.initStatus&&this.validateValues(n,s)){var a={e:t,oldValue:(this.allowObjectBinding,r),value:(this.allowObjectBinding,i),isInteracted:!!t,element:this.element,event:t};this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",a),this.updateTempValue(),this.changeOnBlur||this.dispatchEvent(this.hiddenElement,"change")}this.selectedValueInfo=this.viewPortInfo},e.prototype.updateTempValue=function(){this.value?this.tempValues=this.allowObjectBinding?this.value.slice():this.value.slice():this.tempValues=this.value},e.prototype.updateAriaActiveDescendant=function(){!g(this.ulElement)&&!g(this.ulElement.getElementsByClassName("e-item-focus")[0])&&Ie(this.inputElement,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id})},e.prototype.pageUpSelection=function(t,i){var r=this.list.querySelectorAll("li."+le.li+":not(."+Si+"):not(.e-reorder-hide)"),n=t>=0?r[t+1]:r[0];if(this.fields.disabled&&n&&!this.enableVirtualization){for(;n&&(n.classList.contains("e-disabled")||n.classList.contains(Si)||n.classList.contains(".e-reorder-hide")||n.classList.contains("e-list-group-item"));)n=n.previousElementSibling;if(!n)return}this.enableVirtualization&&i&&(n=this.liCollections.length>=t&&t>=0?this.liCollections[t]:this.liCollections[this.skeletonCount]),!g(n)&&n.classList.contains("e-virtual-list")&&(n=this.liCollections[this.skeletonCount]),this.enableVirtualization?(!g(n)&&!n.classList.contains("e-item-focus")?(this.isKeyBoardAction=!0,this.addListFocus(n),this.scrollTop(n,this.getIndexByValue(n.getAttribute("data-value")),this.keyboardEvent.keyCode)):this.viewPortInfo.startIndex===0&&(this.isKeyBoardAction=!0,this.scrollTop(n,this.getIndexByValue(n.getAttribute("data-value")),this.keyboardEvent.keyCode)),this.previousFocusItem=n):(this.isKeyBoardAction=!0,this.addListFocus(n),this.scrollTop(n,this.getIndexByValue(n.getAttribute("data-value")),this.keyboardEvent.keyCode))},e.prototype.pageDownSelection=function(t,i){var r=this.getItems(),n=this.list.querySelectorAll("li."+le.li+":not(."+Si+"):not(.e-reorder-hide)"),s=t<=n.length?n[t-1]:n[n.length-1];if(this.fields.disabled&&s&&!this.enableVirtualization){for(;s&&(s.classList.contains("e-disabled")||s.classList.contains(Si)||s.classList.contains(".e-reorder-hide")||s.classList.contains("e-list-group-item"));)s=s.nextElementSibling;if(!s)return}this.enableVirtualization&&this.skeletonCount>0&&(s=t<r.length?this.liCollections[t]:this.liCollections[r.length-1]),this.enableVirtualization&&i&&(s=t<=r.length?this.liCollections[t]:this.liCollections[r.length-1]),this.isKeyBoardAction=!0,this.addListFocus(s),this.previousFocusItem=s,this.scrollBottom(s,this.getIndexByValue(s.getAttribute("data-value")),!1,this.keyboardEvent.keyCode)},e.prototype.getItems=function(){return this.list||o.prototype.render.call(this),this.ulElement&&this.ulElement.querySelectorAll("."+le.li).length>0?this.ulElement.querySelectorAll("."+le.li+":not(."+Si+")"):[]},e.prototype.focusInHandler=function(t){var i=this;if(this.enabled){if(this.showOverAllClear(),this.inputFocus=!0,this.value&&this.value.length&&(this.mode!=="Delimiter"&&this.mode!=="CheckBox"?this.chipCollectionWrapper.style.display="":this.showDelimWrapper(),this.mode!=="CheckBox"&&(this.viewWrapper.style.display="none")),this.mode!=="CheckBox"&&this.searchWrapper.classList.remove(sm),this.checkPlaceholderSize(),this.focused){var r={isInteracted:!!t,event:t};this.trigger("focus",r),this.focused=!1}return this.overAllWrapper.classList.contains(Bh)||this.overAllWrapper.classList.add(Bh),s5(this.overAllWrapper,this.componentWrapper),this.isPopupOpen()&&this.refreshPopup(),this.allowResize&&this.setResize(),setTimeout(function(){i.calculateWidth()},150),!0}else return!1},e.prototype.showDelimWrapper=function(){this.mode==="CheckBox"?this.viewWrapper.style.display="":this.delimiterWrapper.style.display="",this.componentWrapper.classList.add(nk)},e.prototype.hideDelimWrapper=function(){this.delimiterWrapper.style.display="none",this.componentWrapper.classList.remove(nk)},e.prototype.expandTextbox=function(){var t=5;if(this.placeholder){var i=this.placeholder.charCodeAt(0),r=44032<=i&&i<=55215?1.5:19968<=i&&i<=40959?2:1;t=t>this.inputElement.placeholder.length?t:this.inputElement.placeholder.length*r}this.inputElement.value.length>t?this.inputElement.size=this.inputElement.value.length:this.inputElement.size=t},e.prototype.isPopupOpen=function(){return this.popupWrapper!==null&&this.popupWrapper.parentElement!==null},e.prototype.refreshPopup=function(){this.popupObj&&this.mobFilter&&(this.popupObj.setProperties({width:this.calcPopupWidth()}),this.popupObj.refreshPosition(this.overAllWrapper),this.popupObj.resolveCollision())},e.prototype.checkTextLength=function(){return this.targetElement().length<1},e.prototype.popupKeyActions=function(t){switch(t.keyCode){case 38:this.hidePopup(t),this.mode==="CheckBox"&&this.inputElement.focus(),t.preventDefault();break;case 40:this.isPopupOpen()||(this.showPopup(t),t.preventDefault());break}},e.prototype.updatePopupPosition=function(){this.refreshPopup()},e.prototype.updateAriaAttribute=function(){var t=this.list.querySelector("."+le.focus);if(!g(t))if(this.inputElement.setAttribute("aria-activedescendant",t.id),this.allowFiltering){var i=this.popupWrapper.querySelector("."+Iw);i&&i.setAttribute("aria-activedescendant",t.id)}else this.mode==="CheckBox"&&this.overAllWrapper.setAttribute("aria-activedescendant",t.id)},e.prototype.homeNavigation=function(t,i){if(this.removeFocus(),this.enableVirtualization){if(t)this.enableVirtualization&&this.viewPortInfo.startIndex!==0&&(this.viewPortInfo.startIndex=0,this.viewPortInfo.endIndex=this.itemCount,this.updateVirtualItemIndex(),this.resetList(this.dataSource,this.fields,this.query));else if(this.enableVirtualization&&(!this.value&&this.viewPortInfo.endIndex!==this.totalItemCount||this.value&&this.value.length>0&&this.viewPortInfo.endIndex!==this.totalItemCount+this.value.length)){this.viewPortInfo.startIndex=this.totalItemCount-this.itemCount,this.viewPortInfo.endIndex=this.totalItemCount,this.updateVirtualItemIndex();var r=new Pe().clone();this.value&&this.value.length>0&&(r=this.getForQuery(this.value).clone(),r=r.skip(this.totalItemCount-this.itemCount)),this.resetList(this.dataSource,this.fields,r)}}this.UpdateSkeleton();var n=this.ulElement.querySelectorAll("li."+le.li+":not(."+Si+"):not(.e-reorder-hide)");if(n.length>0){var s=n[t?0:n.length-1];this.enableVirtualization&&t&&(s=n[this.skeletonCount]),this.removeFocus(),s.classList.add(le.focus),this.enableVirtualization&&t?this.scrollTop(s,void 0,this.keyboardEvent.keyCode):i||this.scrollBottom(s,void 0,!1,this.keyboardEvent.keyCode),this.updateAriaActiveDescendant()}},e.prototype.updateSelectionList=function(){if(!g(this.value)&&this.value.length)for(var t=0;t<this.value.length;t++){var i=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[t]):this.value[t],r=this.getElementByValue(i);r&&!r.classList.contains(le.selected)&&r.classList.add("e-active")}},e.prototype.handleVirtualKeyboardActions=function(t,i){var r=this.list.querySelector("."+le.focus),n;switch(this.isKeyBoardAction=!0,t.keyCode){case 40:this.arrowDown(t,!0);break;case 38:this.arrowUp(t,!0);break;case 33:t.preventDefault(),r&&(n=this.getIndexByValue(this.previousFocusItem.getAttribute("data-value"))-1,this.pageUpSelection(n,!0),this.updateAriaAttribute());break;case 34:t.preventDefault(),r&&(n=this.getIndexByValue(this.previousFocusItem.getAttribute("data-value")),this.pageDownSelection(n,!0),this.updateAriaAttribute());break;case 35:case 36:this.isMouseScrollAction=!0,this.homeNavigation(t.keyCode===36,!0),this.isPreventScrollAction=!0;break}this.keyboardEvent=null,this.isScrollChanged=!0,this.isKeyBoardAction=!1},e.prototype.onKeyDown=function(t){if(!(this.readonly||!this.enabled&&this.mode!=="CheckBox")&&(this.preventSetCurrentData=!1,this.keyboardEvent=t,this.isPreventKeyAction&&this.enableVirtualization&&t.preventDefault(),this.keyCode=t.keyCode,this.keyDownStatus=!0,!(t.keyCode>111&&t.keyCode<124))){if(t.altKey){this.popupKeyActions(t);return}else if(this.isPopupOpen()){var i=this.list.querySelector("."+le.focus),r=void 0;switch(t.keyCode){case 36:case 35:this.isMouseScrollAction=!0,this.isKeyBoardAction=!0,this.homeNavigation(t.keyCode===36);break;case 33:t.preventDefault(),i&&(r=this.getIndexByValue(i.getAttribute("data-value")),this.pageUpSelection(r-this.getPageCount()-1),this.updateAriaAttribute());return;case 34:t.preventDefault(),i&&(r=this.getIndexByValue(i.getAttribute("data-value")),this.pageDownSelection(r+this.getPageCount()),this.updateAriaAttribute());return;case 38:this.isKeyBoardAction=!0,this.arrowUp(t);break;case 40:this.isKeyBoardAction=!0,this.arrowDown(t);break;case 27:t.preventDefault(),this.isKeyBoardAction=!0,this.hidePopup(t),this.mode==="CheckBox"&&this.inputElement.focus(),this.isKeyBoardAction=!1;return;case 13:t.preventDefault(),this.isKeyBoardAction=!0,this.mode!=="CheckBox"&&this.selectByKey(t),this.checkPlaceholderSize(),this.isKeyBoardAction=!1;return;case 32:this.isKeyBoardAction=!0,this.spaceKeySelection(t),this.isKeyBoardAction=!1;return;case 9:t.preventDefault(),this.isKeyBoardAction=!0,this.hidePopup(t),this.inputElement.focus(),this.overAllWrapper.classList.add(Bh)}}else switch(t.keyCode){case 13:case 9:case 16:case 17:case 20:return;case 40:this.openOnClick&&this.showPopup();break;case 27:t.preventDefault(),this.escapeAction();return}this.checkTextLength()&&this.keyNavigation(t),this.mode==="CheckBox"&&this.enableSelectionOrder&&(this.allowFiltering&&(this.previousFilterText=this.targetElement()),this.checkBackCommand(t)),this.expandTextbox(),this.mode==="CheckBox"&&this.showSelectAll||this.refreshPopup(),this.allowResize&&this.setResize(),this.isKeyBoardAction=!1}},e.prototype.arrowDown=function(t,i){t.preventDefault(),this.moveByList(1,i),this.keyAction=!0,(document.activeElement.classList.contains(Iw)||this.mode==="CheckBox"&&!this.allowFiltering&&document.activeElement!==this.list)&&E.add(this.list,"keydown",this.onKeyDown,this),this.updateAriaAttribute()},e.prototype.arrowUp=function(t,i){t.preventDefault(),this.keyAction=!0;var r=this.list.querySelectorAll("li."+le.li+":not(."+Si+"):not(.e-reorder-hide)");this.enableGroupCheckBox&&this.mode==="CheckBox"&&!g(this.fields.groupBy)&&(r=this.list.querySelectorAll("li."+le.li+",li."+le.group+":not(."+Si+"):not(.e-reorder-hide)"));var n=this.list.querySelector("li."+le.focus);this.focusFirstListItem=g(this.liCollections[0])?!1:this.liCollections[0].classList.contains("e-item-focus");var s=Array.prototype.slice.call(r).indexOf(n);s<=0&&this.mode==="CheckBox"&&this.allowFiltering&&(this.keyAction=!1,this.notify("inputFocus",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",value:"focus"})),this.moveByList(-1,i),this.updateAriaAttribute()},e.prototype.spaceKeySelection=function(t){if(this.mode==="CheckBox"){var i=this.list.querySelector("li."+le.focus),r=document.getElementsByClassName("e-selectall-parent")[0];if((!g(i)||r&&r.classList.contains("e-item-focus"))&&(t.preventDefault(),this.keyAction=!0),this.selectByKey(t),this.keyAction){var n=this.list.querySelector("li."+le.focus);!g(n)&&r&&r.classList.contains("e-item-focus")&&n.classList.remove("e-item-focus")}}this.checkPlaceholderSize()},e.prototype.checkBackCommand=function(t){(t.keyCode===8&&this.allowFiltering?this.targetElement()!==this.previousFilterText:this.targetElement()==="")?this.backCommand=!1:this.backCommand=!0},e.prototype.keyNavigation=function(t){if(this.mode!=="Delimiter"&&this.mode!=="CheckBox"&&this.value&&this.value.length)switch(t.keyCode){case 37:t.preventDefault(),this.moveBy(-1,t);break;case 39:t.preventDefault(),this.moveBy(1,t);break;case 8:this.removelastSelection(t);break;case 46:this.removeSelectedChip(t);break}else if(t.keyCode===8&&this.mode==="Delimiter"&&this.value&&this.value.length){t.preventDefault();var i=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[this.value.length-1]):this.value[this.value.length-1];this.removeValue(this.value[this.value.length-1],t),this.updateDelimeter(this.delimiterChar,t),this.focusAtLastListItem(i)}},e.prototype.selectByKey=function(t){this.removeChipSelection(),this.selectListByKey(t),this.hideSelectedItem&&this.focusAtFirstListItem()},e.prototype.escapeAction=function(){var t=this.tempValues?this.tempValues.slice():[];this.allowObjectBinding&&(t=this.tempValues?this.tempValues.slice():[]),this.value&&this.validateValues(this.value,t)&&(this.mode!=="CheckBox"&&(this.value=t,this.initialValueUpdate()),this.mode!=="Delimiter"&&this.mode!=="CheckBox"?this.chipCollectionWrapper.style.display="":this.showDelimWrapper(),this.refreshPlaceHolder(),this.value.length?this.showOverAllClear():this.hideOverAllClear()),this.makeTextBoxEmpty()},e.prototype.scrollBottom=function(t,i,r,n,s){r===void 0&&(r=!1),n===void 0&&(n=null),s===void 0&&(s=!1),(!g(t)&&t.classList.contains("e-virtual-list")||this.enableVirtualization&&g(t))&&(t=this.liCollections[this.skeletonCount]);var a=t&&!isNaN(parseInt(window.getComputedStyle(t).marginBottom,10))?parseInt(window.getComputedStyle(t).marginBottom,10):0;this.isUpwardScrolling=!1;var l=this.list.querySelectorAll(".e-virtual-list").length,h=this.list.querySelector("li:last-of-type")?this.list.querySelector("li:last-of-type").getAttribute("data-value"):null,u=this.virtualListInfo&&this.virtualListInfo.startIndex?t.offsetTop+this.virtualListInfo.startIndex*(t.offsetHeight+a):t.offsetTop,c=this.list.offsetHeight,d=u-l*(t.offsetHeight+a)+(t.offsetHeight+a)-this.list.scrollTop,p=this.list.scrollTop+d-c,f=!1,v=u-l*(t.offsetHeight+a)+(t.offsetHeight+a)-this.list.scrollTop;if(v=this.fields.groupBy&&!g(this.fixedHeaderElement)?v-this.fixedHeaderElement.offsetHeight:v,i===0&&!this.enableVirtualization)this.list.scrollTop=0;else if(d>c||!(v>0&&this.list.offsetHeight>v)){var m=t?t.getAttribute("data-value"):null,y=n===34?this.getPageCount()-1:1;!this.enableVirtualization||this.isKeyBoardAction||r?this.isKeyBoardAction&&this.enableVirtualization&&h&&m===h&&n!==35&&!this.isVirtualScrolling?(this.isPreventKeyAction=!0,this.list.scrollTop+=(t.offsetHeight+a)*y,this.isPreventKeyAction=this.isScrollerAtEnd()?!1:this.isPreventKeyAction,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1):this.enableVirtualization&&n===35?(this.isPreventKeyAction=!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1,this.list.scrollTop=this.list.scrollHeight):(n===34&&this.enableVirtualization&&!this.isVirtualScrolling&&(this.isPreventKeyAction=!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1),this.list.scrollTop=p):this.list.scrollTop=this.virtualListInfo&&this.virtualListInfo.startIndex?s&&this.virtualListInfo.startIndex?this.virtualListInfo.startIndex*this.listItemHeight+this.listItemHeight*2:this.virtualListInfo.startIndex*this.listItemHeight:0,f=this.isKeyBoardAction}this.isKeyBoardAction=f},e.prototype.scrollTop=function(t,i,r){r===void 0&&(r=null);var n=this.list.querySelectorAll(".e-virtual-list").length,s=t&&!isNaN(parseInt(window.getComputedStyle(t).marginBottom,10))?parseInt(window.getComputedStyle(t).marginBottom,10):0,a=this.virtualListInfo&&this.virtualListInfo.startIndex?t.offsetTop+this.virtualListInfo.startIndex*(t.offsetHeight+s):t.offsetTop,l=a-n*(t.offsetHeight+s)-this.list.scrollTop,h=this.list.querySelector("li.e-list-item:not(.e-virtual-list)")?this.list.querySelector("li.e-list-item:not(.e-virtual-list)").getAttribute("data-value"):null;l=this.fields.groupBy&&!Ee(this.fixedHeaderElement)?l-this.fixedHeaderElement.offsetHeight:l;var u=a-n*(t.offsetHeight+s)+(t.offsetHeight+s)-this.list.scrollTop,c=this.enableVirtualization&&this.getModuleName()==="autocomplete"&&l<=0;if(i===0&&!this.enableVirtualization)this.list.scrollTop=0;else if(l<0||c){var d=t?t.getAttribute("data-value"):null,p=r===33?this.getPageCount()-2:1;this.enableVirtualization&&this.isKeyBoardAction&&h&&d===h&&r!==36&&!this.isVirtualScrolling?(this.isUpwardScrolling=!0,this.isPreventKeyAction=!0,this.isKeyBoardAction=!1,this.list.scrollTop-=(t.offsetHeight+s)*p,this.isPreventKeyAction=this.list.scrollTop!==0?this.isPreventKeyAction:!1,this.isPreventScrollAction=!1):this.enableVirtualization&&r===36?(this.isPreventScrollAction=!1,this.isPreventKeyAction=!0,this.isKeyBoardAction=!1,this.list.scrollTo(0,0)):(r===33&&this.enableVirtualization&&!this.isVirtualScrolling&&(this.isPreventKeyAction=!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1),this.list.scrollTop=this.list.scrollTop+l)}else u>0&&this.list.offsetHeight>u||(this.list.scrollTop=t.offsetTop-(this.fields.groupBy&&!g(this.fixedHeaderElement)?this.fixedHeaderElement.offsetHeight:0))},e.prototype.isScrollerAtEnd=function(){return this.list&&this.list.scrollTop+this.list.clientHeight>=this.list.scrollHeight},e.prototype.selectListByKey=function(t){var i=this.list.querySelector("li."+le.focus),r=this.value&&this.value.length?this.value.length:0,n;if(i!==null){if(t.preventDefault(),i.classList.contains("e-active")&&(r=r-1),this.isValidLI(i)&&r<this.maximumSelectionLength){this.updateListSelection(i,t),this.addListFocus(i),this.mode==="CheckBox"?(this.updateDelimView(),this.updateDelimeter(this.delimiterChar,t),this.refreshInputHight(),this.checkPlaceholderSize(),this.enableGroupCheckBox&&!g(this.fields.groupBy)&&(n=i.firstElementChild.lastElementChild,this.findGroupStart(n),this.deselectHeader())):this.updateDelimeter(this.delimiterChar,t);var s=this.targetElement().trim()!=="";this.makeTextBoxEmpty(),this.mode!=="CheckBox"&&this.refreshListItems(i.textContent,s),this.changeOnBlur||this.updateValueState(t,this.value,this.tempValues),this.refreshPopup()}else!this.isValidLI(i)&&r<this.maximumSelectionLength&&(n=i.firstElementChild.lastElementChild,n.classList.contains("e-check")?this.selectAllItem(!1,t,i):this.selectAllItem(!0,t,i));this.refreshSelection(),this.closePopupOnSelect&&this.hidePopup(t)}var a=document.getElementsByClassName("e-selectall-parent")[0];if(a&&a.classList.contains("e-item-focus")){var l=a.childNodes[0];if(l.classList.contains("e-check")){l.classList.remove("e-check");var h={module:"CheckBoxSelection",enable:this.mode==="CheckBox",value:"check",name:"checkSelectAll"};this.notify("checkSelectAll",h),this.selectAllItem(!1,t,i)}else{l.classList.add("e-check");var h={module:"CheckBoxSelection",enable:this.mode==="CheckBox",value:"check",name:"checkSelectAll"};this.notify("checkSelectAll",h),this.selectAllItem(!0,t,i)}}this.refreshPlaceHolder()},e.prototype.refreshListItems=function(t,i){if((this.allowFiltering||this.mode==="CheckBox"&&this.enableSelectionOrder===!0||this.allowCustomValue)&&this.mainList&&this.listData){var r=this.mainList.cloneNode?this.mainList.cloneNode(!0):this.mainList;if(this.enableVirtualization)if(this.allowCustomValue&&this.virtualCustomData&&t==null&&this.virtualCustomData&&this.viewPortInfo&&this.viewPortInfo.startIndex===0&&this.viewPortInfo.endIndex===this.itemCount)this.virtualCustomData=null,this.renderItems(this.mainData,this.fields);else if(this.allowFiltering&&i){if(this.updateInitialData(),this.onActionComplete(r,this.mainData),this.isVirtualTrackHeight=!1,this.list.getElementsByClassName("e-virtual-ddl")[0])this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight();else if(!this.list.querySelector(".e-virtual-ddl")&&this.skeletonCount>0){var n=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});n.style.cssText=this.GetVirtualTrackHeight(),this.popupWrapper.querySelector(".e-dropdownbase").appendChild(n)}}else this.onActionComplete(this.list,this.listData);else this.onActionComplete(r,this.mainData);this.focusAtLastListItem(t),this.value&&this.value.length&&this.refreshSelection()}else!g(this.fields.groupBy)&&this.value&&this.value.length&&this.refreshSelection()},e.prototype.removeSelectedChip=function(t){var i=this.chipCollectionWrapper.querySelector("span."+_l),r;if(i!==null){g(this.value)||(this.tempValues=this.allowObjectBinding?this.value.slice():this.value.slice()),r=i.nextElementSibling,r!==null&&(this.removeChipSelection(),this.addChipSelection(r,t));var n=this.allowObjectBinding?this.getDataByValue(this.getFormattedValue(i.getAttribute("data-value"))):i.getAttribute("data-value");this.removeValue(n,t),this.updateDelimeter(this.delimiterChar,t),this.makeTextBoxEmpty()}this.closePopupOnSelect&&this.hidePopup(t),this.checkPlaceholderSize()},e.prototype.moveByTop=function(t){var i=this.list.querySelectorAll("li."+le.li),r;i.length>1&&(this.removeFocus(),r=t?0:i.length-1,this.addListFocus(i[r]),this.scrollBottom(i[r],r)),this.updateAriaAttribute()},e.prototype.clickHandler=function(t){var i=t.target,r=i.className,n=document.getElementsByClassName("e-selectall-parent")[0];(r==="e-input-filter e-input"||r==="e-input-group e-control-wrapper e-input-focus")&&n.classList.contains("e-item-focus")&&n.classList.remove("e-item-focus")},e.prototype.moveByList=function(t,i){if(this.list){var r=this.list.querySelectorAll("li."+le.li+":not(."+Si+"):not(.e-reorder-hide)");this.mode==="CheckBox"&&this.enableGroupCheckBox&&!g(this.fields.groupBy)&&(r=this.list.querySelectorAll("li."+le.li+",li."+le.group+":not(."+Si+"):not(.e-reorder-hide)"));var n=this.list.querySelector("li."+le.focus);this.enableVirtualization&&i&&!g(this.currentFocuedListElement)&&(n=this.getElementByValue(this.getFormattedValue(this.currentFocuedListElement.getAttribute("data-value"))));var s=-1,a=document.getElementsByClassName("e-selectall-parent")[0];if(this.mode==="CheckBox"&&this.showSelectAll&&t===1&&!g(a)&&!a.classList.contains("e-item-focus")&&this.list.getElementsByClassName("e-item-focus").length===0&&this.liCollections.length>1)!this.focusFirstListItem&&a.classList.contains("e-item-focus")?a.classList.remove("e-item-focus"):a.classList.contains("e-item-focus")||a.classList.add("e-item-focus");else if(r.length){this.mode==="CheckBox"&&this.showSelectAll&&!g(a&&t===-1)&&(!this.focusFirstListItem&&a.classList.contains("e-item-focus")?a.classList.remove("e-item-focus"):this.focusFirstListItem&&!a.classList.contains("e-item-focus")&&a.classList.add("e-item-focus"));for(var l=0;l<r.length;l++)if(r[l]===n){s=l;break}if(t>0)s<r.length-1&&(this.removeFocus(),this.enableVirtualization&&i?this.addListFocus(r[s]):this.enableVirtualization&&r[s+1].classList.contains("e-virtual-list")?this.addListFocus(r[this.skeletonCount]):this.addListFocus(r[++s]),s>-1&&(this.updateCheck(r[s]),this.scrollBottom(r[s],s),this.currentFocuedListElement=r[s]));else if(s>0)if(this.enableVirtualization){var h=r[s-1].classList.contains("e-virtual-list"),u=i?s:s-1;(i||!h)&&this.removeFocus(),(i||!h)&&(this.addListFocus(r[u]),this.updateCheck(r[u]),this.scrollTop(r[u],s),this.currentFocuedListElement=r[u])}else this.removeFocus(),this.addListFocus(r[--s]),this.updateCheck(r[s]),this.scrollTop(r[s],s)}}var c=this.list?this.list.querySelector(".e-item-focus"):null;if(this.isDisabledElement(c)){if(this.list.querySelectorAll(".e-list-item:not(.e-hide-listitem):not(.e-disabled)").length===0||this.keyCode===38&&this.mode==="CheckBox"&&this.enableGroupCheckBox&&!g(this.fields.groupBy)&&c===this.list.querySelector("li.e-list-group-item")){this.removeFocus();return}var l=this.getIndexByValue(c.getAttribute("data-value"));l===0&&(t=1),l===this.list.querySelectorAll(".e-list-item:not(.e-hide-listitem)").length-1&&(t=-1),this.moveByList(t)}},e.prototype.getElementByValue=function(t){for(var i,r=this.getItems(),n=0,s=r;n<s.length;n++){var a=s[n];if(this.getFormattedValue(a.getAttribute("data-value"))===t){i=a;break}}return i},e.prototype.updateCheck=function(t){if(this.mode==="CheckBox"&&this.enableGroupCheckBox&&!g(this.fields.groupBy)){var i=t.firstElementChild.lastElementChild;i.classList.contains("e-check")?t.classList.add("e-active"):t.classList.remove("e-active")}},e.prototype.moveBy=function(t,i){var r,n=this.chipCollectionWrapper.querySelectorAll("span."+Ec),s=this.chipCollectionWrapper.querySelector("span."+_l);s===null?t<0&&this.addChipSelection(n[n.length-1],i):t<0?(r=s.previousElementSibling,r!==null&&(this.removeChipSelection(),this.addChipSelection(r,i))):(r=s.nextElementSibling,this.removeChipSelection(),r!==null&&this.addChipSelection(r,i))},e.prototype.chipClick=function(t){if(this.enabled){var i=j(t.target,"."+Ec);this.removeChipSelection(),this.addChipSelection(i,t)}},e.prototype.removeChipSelection=function(){this.chipCollectionWrapper&&this.removeChipFocus()},e.prototype.addChipSelection=function(t,i){Y([t],_l),this.trigger("chipSelection",i)},e.prototype.onChipRemove=function(t){if(!(t.which===3||t.button===2)&&this.enabled&&!this.readonly){var i=t.target.parentElement,r=i.getAttribute("data-value"),n=this.allowObjectBinding?this.getDataByValue(this.getFormattedValue(r)):this.getFormattedValue(r);if(this.allowCustomValue&&(r!=="false"&&n===!1||!g(n)&&n.toString()==="NaN")&&(n=r),this.isPopupOpen()&&this.mode!=="CheckBox"&&this.hidePopup(t),this.inputFocus||this.inputElement.focus(),this.removeValue(n,t),n=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",n):n,g(this.findListElement(this.list,"li","data-value",n))&&this.mainList&&this.listData){var s=this.mainList.cloneNode?this.mainList.cloneNode(!0):this.mainList;this.onActionComplete(s,this.mainData)}this.updateDelimeter(this.delimiterChar,t),this.placeholder&&this.floatLabelType==="Never"?(this.makeTextBoxEmpty(),this.checkPlaceholderSize()):this.inputElement.value="",t.preventDefault()}},e.prototype.makeTextBoxEmpty=function(){this.inputElement.value="",this.refreshPlaceHolder()},e.prototype.refreshPlaceHolder=function(){this.placeholder&&this.floatLabelType==="Never"?this.value&&this.value.length||!g(this.text)&&this.text!==""?this.inputElement.placeholder="":this.inputElement.placeholder=Ew(this.placeholder):this.setFloatLabelType(),this.expandTextbox()},e.prototype.removeAllItems=function(t,i,r,n,s){var a=this.allowObjectBinding?this.indexOfObjectInArray(t,this.value):this.value.indexOf(t),l=this.value.slice(0);l.splice(a,1),this.setProperties({value:[].concat([],l)},!0),n.setAttribute("aria-selected","false");var h=this.hideSelectedItem?Si:le.selected;K([n],h),this.notify("activeList",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",li:n,e:this,index:a}),this.invokeCheckboxSelection(n,i,r);var u=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",t):t;this.updateMainList(!0,u,s),this.updateChipStatus()},e.prototype.invokeCheckboxSelection=function(t,i,r){this.notify("updatelist",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",li:t,e:i}),this.updateAriaActiveDescendant(),this.value&&this.value.length!==this.mainData.length&&this.mode==="CheckBox"&&this.showSelectAll&&!(this.isSelectAll||r)&&this.notify("checkSelectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",value:"uncheck"})},e.prototype.removeValue=function(t,i,r,n){var s=this,a=this.allowObjectBinding?this.indexOfObjectInArray(t,this.value):this.value.indexOf(this.getFormattedValue(t));a===-1&&this.allowCustomValue&&!g(t)&&(a=this.allowObjectBinding?this.indexOfObjectInArray(t,this.value):this.value.indexOf(t.toString()));var l=i&&i.target;n=n||l&&l.classList.contains("e-close-hooker")?!0:null;var h=this.hideSelectedItem?Si:le.selected;if(a!==-1){var u=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",t):t,c=this.virtualSelectAll?null:this.findListElement(this.list,"li","data-value",u),d=this.allowObjectBinding?t:this.getDataByValue(t),p={e:i,item:c,itemData:d,isInteracted:!!i,cancel:!1};this.trigger("removing",p,function(f){if(f.cancel)s.removeIndex++;else{s.isRemoveSelection=s.enableVirtualization?!0:s.isRemoveSelection,s.currentRemoveValue=s.allowObjectBinding?V(s.fields.value?s.fields.value:"",t):t,s.virtualSelectAll=!1;var v=s.value.slice(0);if(v.splice(a,1),s.enableVirtualization&&s.mode==="CheckBox"&&s.selectedListData.splice(a,1),s.setProperties({value:[].concat([],v)},!0),s.enableVirtualization){var m=a===0&&s.text.split(s.delimiterChar)&&s.text.split(s.delimiterChar).length===1?s.text.replace(s.text.split(s.delimiterChar)[a],""):a===0?s.text.replace(s.text.split(s.delimiterChar)[a]+s.delimiterChar,""):s.text.replace(s.delimiterChar+s.text.split(s.delimiterChar)[a],"");s.setProperties({text:m.toString()},!0)}if(c!==null){var y=s.allowObjectBinding?V(s.fields.value?s.fields.value:"",t):t,S=s.findListElement(s.mainList,"li","data-value",y);c.setAttribute("aria-selected","false"),K([c],h),S&&(S.setAttribute("aria-selected","false"),K([c,S],h)),s.notify("activeList",{module:"CheckBoxSelection",enable:s.mode==="CheckBox",li:c,e:s,index:a}),s.invokeCheckboxSelection(c,i,n)}var b=s.allowObjectBinding?V(s.fields.value?s.fields.value:"",t):t;s.hideSelectedItem&&s.fields.groupBy&&c&&s.hideGroupItem(b),s.hideSelectedItem&&s.fixedHeaderElement&&s.fields.groupBy&&s.mode!=="CheckBox"&&s.isPopupOpen()&&o.prototype.scrollStop.call(s),s.updateMainList(!0,b),s.removeChip(b,n),s.updateChipStatus();var w=s.value&&s.value.length?s.value.length:0;if(w<s.maximumSelectionLength){var I=s.list.querySelectorAll("li."+le.li+":not(.e-active)");K(I,"e-disable")}s.trigger("removed",f);var x=i&&i.currentTarget,M=x&&x.classList.contains("e-selectall-parent")?!0:null;if(!s.changeOnBlur&&!n&&i&&r&&!M&&s.isSelectAllTarget&&s.updateValueState(i,s.value,s.tempValues),r&&(s.selectAllEventData.push(d),s.selectAllEventEle.push(c)),r===1){s.changeOnBlur||s.updateValueState(i,s.value,s.tempValues);var D={event:i,items:s.selectAllEventEle,itemData:s.selectAllEventData,isInteracted:!!i,isChecked:!1};s.trigger("selectedAll",D),s.selectAllEventData=[],s.selectAllEventEle=[]}n&&(r===1||r===null)&&s.clearAllCallback(i,n),s.isPopupOpen()&&c&&c.parentElement.classList.contains("e-reorder")&&(s.hideSelectedItem&&s.value&&Array.isArray(s.value)&&s.value.length>0&&s.totalItemsCount(),s.notify("setCurrentViewDataAsync",{module:"VirtualScroll"}))}})}},e.prototype.updateMainList=function(t,i,r){if(this.allowFiltering||this.mode==="CheckBox"){var n=r||this.findListElement(this.mainList,"li","data-value",i);n&&(t?(n.setAttribute("aria-selected","false"),K([n],this.hideSelectedItem?Si:le.selected),this.mode==="CheckBox"&&K([n.firstElementChild.lastElementChild],"e-check")):(n.setAttribute("aria-selected","true"),Y([n],this.hideSelectedItem?Si:le.selected),this.mode==="CheckBox"&&Y([n.firstElementChild.lastElementChild],"e-check")))}},e.prototype.removeChip=function(t,i){if(this.chipCollectionWrapper&&!(this.enableVirtualization&&i)){var r=this.findListElement(this.chipCollectionWrapper,"span","data-value",t);r&&Ue(r)}},e.prototype.setWidth=function(t){g(t)||(typeof t=="number"?this.overAllWrapper.style.width=Le(t):typeof t=="string"&&(this.overAllWrapper.style.width=t.match(/px|%|em/)?t:Le(t)))},e.prototype.updateChipStatus=function(){this.value&&this.value.length?(g(this.chipCollectionWrapper)||(this.chipCollectionWrapper.style.display=""),(this.mode==="Delimiter"||this.mode==="CheckBox")&&this.showDelimWrapper(),this.showOverAllClear()):(g(this.chipCollectionWrapper)||(this.chipCollectionWrapper.style.display="none"),g(this.delimiterWrapper)||(this.delimiterWrapper.style.display="none"),this.hideOverAllClear())},e.prototype.indexOfObjectInArray=function(t,i){for(var r=function(a){var l=i[a];if(Object.keys(t).every(function(h){return l.hasOwnProperty(h)&&l[h]===t[h]}))return{value:a}},n=0;n<i.length;n++){var s=r(n);if(typeof s=="object")return s.value}return-1},e.prototype.addValue=function(t,i,r){this.value||(this.value=[]);var n=this.allowObjectBinding?this.getDataByValue(t):t;if(this.allowObjectBinding&&!this.isObjectInArray(this.getDataByValue(t),this.value)||!this.allowObjectBinding&&this.value.indexOf(n)<0){if(this.setProperties({value:[].concat([],this.value,[n])},!0),this.enableVirtualization&&!this.isSelectAllLoop){var s=this.viewWrapper.innerHTML,a=void 0;s+=this.value.length===1?"":this.delimiterChar+" ",a=this.getOverflowVal(this.value.length-1),s+=a,a=this.viewWrapper.innerHTML,this.updateWrapperText(this.viewWrapper,s)}if(this.enableVirtualization&&this.mode==="CheckBox"){var l=[],h=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[this.value.length-1]):this.value[this.value.length-1],a=i,u=this.text!=null&&this.text!==""?this.text+this.delimiterChar+a:a;l.push(u),this.setProperties({text:l.toString()},!0)}}var c=this.findListElement(this.list,"li","data-value",t);this.removeFocus(),c&&(this.addListFocus(c),this.addListSelection(c)),this.mode!=="Delimiter"&&this.mode!=="CheckBox"&&this.addChip(i,t,r),this.hideSelectedItem&&this.fields.groupBy&&this.hideGroupItem(t),this.updateChipStatus(),this.checkMaxSelection()},e.prototype.checkMaxSelection=function(){var t=this.value&&this.value.length?this.value.length:0;if(t===this.maximumSelectionLength){var i=this.list.querySelectorAll("li."+le.li+".e-active");K(i,"e-disable");var r=this.list.querySelectorAll("li."+le.li+":not(.e-active)");Y(r,"e-disable")}if(t<this.maximumSelectionLength){var n=this.list.querySelectorAll("li."+le.li);K(n,"e-disable")}},e.prototype.dispatchSelect=function(t,i,r,n,s,a,l){var h=this,u=this.listData;if(this.initStatus&&!n){t=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",t):t;var c=a||this.getDataByValue(t),d={e:i,item:r,itemData:c,isInteracted:!!i,cancel:!1};this.trigger("select",d,function(p){if(!p.cancel){if(s&&(h.selectAllEventData.push(c),h.selectAllEventEle.push(r)),s===1){var f={event:i,items:h.selectAllEventEle,itemData:h.selectAllEventData,isInteracted:!!i,isChecked:!0};h.trigger("selectedAll",f),h.selectAllEventData=[]}h.allowCustomValue&&h.isServerRendered&&h.listData!==u&&(h.listData=u),t=h.allowObjectBinding?h.getDataByValue(t):t,h.enableVirtualization&&(g(h.selectedListData)?h.selectedListData=[h.getDataByValue(t)]:a?Array.isArray(h.selectedListData)?h.selectedListData.push(a):h.selectedListData=[h.selectedListData,a]:Array.isArray(h.selectedListData)?h.selectedListData.push(h.getDataByValue(t)):h.selectedListData=[h.selectedListData,h.getDataByValue(t)]),(h.enableVirtualization&&t||!h.enableVirtualization)&&h.updateListSelectEventCallback(t,r,i,l),h.hideSelectedItem&&h.fixedHeaderElement&&h.fields.groupBy&&h.mode!=="CheckBox"&&o.prototype.scrollStop.call(h)}})}},e.prototype.addChip=function(t,i,r){this.chipCollectionWrapper&&this.getChip(t,i,r)},e.prototype.removeChipFocus=function(){var t=this.chipCollectionWrapper.querySelectorAll("span."+Ec+"."+_l);if(K(t,_l),B.isDevice)for(var i=this.chipCollectionWrapper.querySelectorAll("span."+nm.split(" ")[0]),r=0;r<i.length;r++)i[r].style.display="none"},e.prototype.onMobileChipInteraction=function(t){var i=j(t.target,"."+Ec),r=i.querySelector("span."+nm.split(" ")[0]);this.enabled&&!this.readonly&&(i.classList.contains(_l)||(this.removeChipFocus(),r.style.display="",i.classList.add(_l)),this.refreshPopup(),t.preventDefault())},e.prototype.multiCompiler=function(t){var i=!1;if(typeof t!="function"&&t)try{i=!!Oe(t,document).length}catch{i=!1}return i},e.prototype.encodeHtmlEntities=function(t){return t.replace(/[\u00A0-\u9999<>&]/g,function(i){return"&#"+i.charCodeAt(0)+";"})},e.prototype.getChip=function(t,i,r){var n=this,s={text:i,value:i},a=this.createElement("span",{className:Ec,attrs:{"data-value":i,title:t}}),l,h=this.createElement("span",{className:p5}),u=this.createElement("span",{className:nm});if(this.mainData&&(s=this.getDataByValue(i)),this.valueTemplate&&!g(s)){var c=this.multiCompiler(this.valueTemplate);typeof this.valueTemplate!="function"&&c?l=wt(X(this.valueTemplate,document).innerHTML.trim()):l=wt(this.valueTemplate);var d=l(s,this,"valueTemplate",this.valueTemplateId,this.isStringTemplate,null,h);d&&d.length>0&&dt(d,h),this.renderReactTemplates()}else this.enableHtmlSanitizer?h.innerText=t:h.innerHTML=this.encodeHtmlEntities(t.toString());a.appendChild(h);var p={isInteracted:!!r,itemData:s,e:r,setClass:function(f){Y([a],f)},cancel:!1};this.isPreventChange=this.isAngular&&this.preventChange,this.trigger("tagging",p,function(f){f.cancel||(B.isDevice?(a.classList.add(y5),dt([u],a),u.style.display="none",E.add(a,"click",n.onMobileChipInteraction,n)):(E.add(a,"mousedown",n.chipClick,n),n.showClearButton&&a.appendChild(u)),E.add(u,"mousedown",n.onChipRemove,n),n.chipCollectionWrapper.appendChild(a),!n.changeOnBlur&&r&&n.updateValueState(r,n.value,n.tempValues))})},e.prototype.calcPopupWidth=function(){var t=Le(this.popupWidth);if(t.indexOf("%")>-1){var i=this.componentWrapper.offsetWidth*parseFloat(t)/100;t=i.toString()+"px"}return t},e.prototype.mouseIn=function(){this.enabled&&!this.readonly&&this.showOverAllClear()},e.prototype.mouseOut=function(){this.inputFocus||(this.overAllClear.style.display="none")},e.prototype.listOption=function(t,i){var r=!g(i.iconCss),n=g(i.properties)?i:i.properties;return this.listCurrentOptions=i.text!==null||i.value!==null?{fields:n,showIcon:r,ariaAttributes:{groupItemRole:"presentation"}}:{fields:{value:"text"}},he(this.listCurrentOptions,this.listCurrentOptions,i,!0),this.mode==="CheckBox"&&this.notify("listoption",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",dataSource:t,fieldProperty:n}),this.listCurrentOptions},e.prototype.renderPopup=function(){var t=this;if(this.list||o.prototype.render.call(this),this.popupObj&&document.body.contains(this.popupObj.element)&&this.allowFiltering){this.refreshPopup();return}if(!this.popupObj&&!g(this.popupWrapper)){document.body.appendChild(this.popupWrapper);var i=this.popupWrapper.querySelector("."+I5);this.mode==="CheckBox"&&!this.allowFiltering&&i&&this.filterParent&&(i.remove(),this.filterParent=null);var r=parseInt(this.popupHeight,10);if(this.popupWrapper.style.visibility="hidden",this.headerTemplate&&(this.setHeaderTemplate(),r-=this.header.offsetHeight,this.isUpdateHeaderHeight=this.header.offsetHeight!==0),dt([this.list],this.popupWrapper),!this.list.classList.contains(le.noData)&&this.getItems()[1]&&(this.listItemHeight=this.getItems()[1].offsetHeight+parseInt(window.getComputedStyle(this.getItems()[1]).marginBottom,10)),this.enableVirtualization&&!this.list.classList.contains(le.noData)){if(!this.list.querySelector(".e-virtual-ddl-content")&&this.list.querySelector(".e-list-parent")){var n=this.createElement("div",{className:"e-virtual-ddl-content"});n.style.cssText=this.getTransformValues(),this.list.appendChild(n).appendChild(this.list.querySelector(".e-list-parent"))}else this.list.querySelector(".e-virtual-ddl-content")&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues());if(this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+le.li),this.virtualItemCount=this.itemCount,this.mode!=="CheckBox"&&this.totalItemsCount(),this.list.querySelector(".e-virtual-ddl"))this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight();else{var s=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});s.style.cssText=this.GetVirtualTrackHeight(),this.popupWrapper.querySelector(".e-dropdownbase").appendChild(s)}}if(this.footerTemplate&&(this.setFooterTemplate(),r-=this.footer.offsetHeight,this.isUpdateFooterHeight=this.footer.offsetHeight!==0),this.mode==="CheckBox"&&this.showSelectAll?(this.notify("selectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox"}),r-=this.selectAllHeight):this.mode==="CheckBox"&&!this.showSelectAll&&!this.headerTemplate&&!this.footerTemplate?(this.notify("selectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox"}),r=parseInt(this.popupHeight,10)):this.mode==="CheckBox"&&!this.showSelectAll&&(this.notify("selectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox"}),r=parseInt(this.popupHeight,10),this.headerTemplate&&this.header&&(r-=this.header.offsetHeight),this.footerTemplate&&this.footer&&(r-=this.footer.offsetHeight)),this.mode==="CheckBox"){var a={module:"CheckBoxSelection",enable:this.mode==="CheckBox",popupElement:this.popupWrapper};this.allowFiltering&&(this.notify("searchBox",a),r-=this.searchBoxHeight),Y([this.popupWrapper],"e-checkbox")}this.popupHeight!=="auto"?(this.list.style.maxHeight=Le(r),this.popupWrapper.style.maxHeight=Le(this.popupHeight)):this.list.style.maxHeight=Le(this.popupHeight),this.popupObj=new Gn(this.popupWrapper,{width:this.calcPopupWidth(),targetType:"relative",position:this.enableRtl?{X:"right",Y:"bottom"}:{X:"left",Y:"bottom"},relateTo:this.overAllWrapper,collision:this.enableRtl?{X:"fit",Y:"flip"}:{X:"flip",Y:"flip"},offsetY:1,enableRtl:this.enableRtl,zIndex:this.zIndex,close:function(){if(t.popupObj.element.parentElement){t.popupObj.unwireScrollEvents();var l=t.popupWrapper.querySelector("."+Iw);t.mode==="CheckBox"&&l&&document.activeElement===l&&l.blur(),ee(t.popupObj.element)}},open:function(){if(t.popupObj.resolveCollision(),!t.isFirstClick){var l=t.list.querySelector("ul");l&&(t.mode!=="CheckBox"&&(t.allowFiltering||t.allowCustomValue)&&t.targetElement().trim()!==""||(t.mainList=l.cloneNode?l.cloneNode(!0):l)),t.isFirstClick=!0}t.popupObj.wireScrollEvents(),!(t.mode!=="CheckBox"&&(t.allowFiltering||t.allowCustomValue)&&t.targetElement().trim()!=="")&&!t.enableVirtualization&&(t.loadTemplate(),t.enableVirtualization&&t.mode==="CheckBox"&&t.UpdateSkeleton()),t.isPreventScrollAction=!0,t.setScrollPosition(),!t.list.classList.contains(le.noData)&&t.getItems()[1]&&t.getItems()[1].offsetHeight!==0&&(t.listItemHeight=t.getItems()[1].offsetHeight+parseInt(window.getComputedStyle(t.getItems()[1]).marginBottom,10),t.list.getElementsByClassName("e-virtual-ddl-content")[0]&&(t.list.getElementsByClassName("e-virtual-ddl-content")[0].style=t.getTransformValues())),t.allowFiltering&&t.notify("inputFocus",{module:"CheckBoxSelection",enable:t.mode==="CheckBox",value:"focus"}),t.enableVirtualization&&(t.notify("bindScrollEvent",{module:"VirtualScroll",component:t.getModuleName(),enable:t.enableVirtualization}),setTimeout(function(){t.value?t.updateSelectionList():t.viewPortInfo&&t.viewPortInfo.offsets.top&&(t.list.scrollTop=t.viewPortInfo.offsets.top)},5))},targetExitViewport:function(){B.isDevice||t.hidePopup()}}),this.checkCollision(this.popupWrapper),this.popupContentElement=this.popupObj.element.querySelector(".e-content"),this.mode==="CheckBox"&&B.isDevice&&this.allowFiltering&&this.isDeviceFullScreen&&this.notify("deviceSearchBox",{module:"CheckBoxSelection",enable:this.mode==="CheckBox"}),this.allowResize&&this.setResize(),this.popupObj.close(),this.popupWrapper.style.visibility=""}},e.prototype.checkCollision=function(t){if(!(this.mode==="CheckBox"&&B.isDevice&&this.allowFiltering&&this.isDeviceFullScreen)){var i=is(t);i.length>0&&(t.style.marginTop=-parseInt(getComputedStyle(t).marginTop,10)+"px"),this.popupObj.resolveCollision()}},e.prototype.setHeaderTemplate=function(){var t;this.header&&this.header.remove(),this.header=this.createElement("div"),Y([this.header],S5);var i=this.multiCompiler(this.headerTemplate);typeof this.headerTemplate!="function"&&i?t=wt(X(this.headerTemplate,document).innerHTML.trim()):t=wt(this.headerTemplate);var r=t({},this,"headerTemplate",this.headerTemplateId,this.isStringTemplate,null,this.header);r&&r.length>0&&dt(r,this.header),this.mode==="CheckBox"&&this.showSelectAll?jr([this.header],this.popupWrapper):dt([this.header],this.popupWrapper),E.add(this.header,"mousedown",this.onListMouseDown,this)},e.prototype.setFooterTemplate=function(){var t;this.footer&&this.footer.remove(),this.footer=this.createElement("div"),Y([this.footer],b5);var i=this.multiCompiler(this.footerTemplate);typeof this.footerTemplate!="function"&&i?t=wt(X(this.footerTemplate,document).innerHTML.trim()):t=wt(this.footerTemplate);var r=t({},this,"footerTemplate",this.footerTemplateId,this.isStringTemplate,null,this.footer);r&&r.length>0&&dt(r,this.footer),dt([this.footer],this.popupWrapper),E.add(this.footer,"mousedown",this.onListMouseDown,this)},e.prototype.updateInitialData=function(){var t=this.selectData,i=this.renderItems(t,this.fields);if(this.list.scrollTop=0,this.virtualListInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:this.itemCount},this.previousStartIndex=0,this.previousEndIndex=this.itemCount,this.dataSource instanceof re?this.remoteDataCount>=0?this.totalItemCount=this.dataCount=this.remoteDataCount:this.resetList(this.dataSource):this.totalItemCount=this.dataCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.mode!=="CheckBox"&&(this.totalItemCount=this.value&&this.value.length?this.totalItemCount-this.value.length:this.totalItemCount),this.getSkeletonCount(),this.skeletonCount=this.totalItemCount!==0&&this.totalItemCount<this.itemCount*2&&(!(this.dataSource instanceof re)||this.dataSource instanceof re&&this.totalItemCount<=this.itemCount)?0:this.skeletonCount,this.UpdateSkeleton(),this.list.getElementsByClassName("e-virtual-ddl")[0])this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight();else if(!this.list.querySelector(".e-virtual-ddl")&&this.skeletonCount>0){var r=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});r.style.cssText=this.GetVirtualTrackHeight(),this.popupWrapper.querySelector(".e-dropdownbase").appendChild(r)}this.listData=t,this.liCollections=this.list.querySelectorAll(".e-list-item"),this.list.getElementsByClassName("e-virtual-ddl-content")[0]&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues()),this.enableVirtualization&&this.notify("setGeneratedData",{module:"VirtualScroll"})},e.prototype.clearAll=function(t){if(this.enabled&&!this.readonly){var i=void 0;if(this.setDynValue=!1,this.isClearAllAction=!0,this.value&&this.value.length>0){this.allowFiltering&&(this.refreshListItems(null),this.mode==="CheckBox"&&this.targetInputElement&&(this.targetInputElement.value=""));var r=this.list&&this.list.querySelectorAll("li.e-list-item");if(r&&r.length>0)this.selectAllItems(!1,t);else for(this.removeIndex=0,i=this.value[this.removeIndex];this.removeIndex<this.value.length;i=this.value[this.removeIndex])this.removeValue(i,t,null,!0);this.selectedElementID=null,this.inputElement.removeAttribute("aria-activedescendant")}else this.clearAllCallback(t);this.checkAndResetCache(),Ce.createSpanElement(this.overAllWrapper,this.createElement),this.calculateWidth(),!g(this.overAllWrapper)&&!g(this.overAllWrapper.getElementsByClassName("e-ddl-icon")[0]&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0]&&this.floatLabelType!=="Never")&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0].classList.add("e-icon"),this.enableVirtualization&&(this.updateInitialData(),this.chipCollectionWrapper&&(this.chipCollectionWrapper.innerHTML=""),this.isCustomDataUpdated||this.notify("setGeneratedData",{module:"VirtualScroll"})),this.enableVirtualization&&(this.list.scrollTop=0,this.virtualListInfo=null,this.previousStartIndex=0,this.previousEndIndex=this.itemCount),this.isClearAllAction=!1}this.isClearAllItem=!0,E.add(document,"mouseup",this.preventSelection,this)},e.prototype.preventSelection=function(t){this.isClearAllItem&&t.stopPropagation(),this.isClearAllItem=!1,E.remove(document,"mouseup",this.preventSelection)},e.prototype.clearAllCallback=function(t,i){var r=this.value?this.value.slice():[];if(this.mainList&&this.listData&&(this.allowFiltering&&this.mode!=="CheckBox"||this.allowCustomValue)){var n=this.mainList.cloneNode?this.mainList.cloneNode(!0):this.mainList;this.onActionComplete(n,this.mainData)}this.focusAtFirstListItem(),this.updateDelimeter(this.delimiterChar,t),this.mode!=="Box"&&(!this.inputFocus||this.mode==="CheckBox")&&this.updateDelimView(),this.inputElement.value!==""&&(this.makeTextBoxEmpty(),this.search(null)),this.checkPlaceholderSize(),this.isPopupOpen()&&this.refreshPopup(),this.allowResize&&this.setResize(),this.inputFocus||(this.changeOnBlur&&this.updateValueState(t,this.value,r),this.mode!=="CheckBox"&&this.inputElement.focus()),this.mode==="CheckBox"&&(this.refreshPlaceHolder(),this.refreshInputHight(),this.changeOnBlur&&i&&(g(this.value)||this.value.length===0)&&this.updateValueState(t,this.value,this.tempValues)),!this.changeOnBlur&&i&&(g(this.value)||this.value.length===0)&&this.updateValueState(t,this.value,this.tempValues),this.mode==="CheckBox"&&this.enableGroupCheckBox&&!g(this.fields.groupBy)&&this.updateListItems(this.list.querySelectorAll("li.e-list-item"),this.mainList.querySelectorAll("li.e-list-item")),t.preventDefault()},e.prototype.windowResize=function(){this.refreshPopup(),(!this.inputFocus||this.mode==="CheckBox")&&this.viewWrapper&&this.viewWrapper.parentElement&&this.updateDelimView()},e.prototype.resetValueHandler=function(t){if(!g(this.inputElement)){var i=j(this.inputElement,"form");if(i&&t.target===i){var r=this.element.tagName===this.getNgDirective()?null:this.element.getAttribute("data-initial-value");this.text=r}}},e.prototype.wireEvent=function(){E.add(this.componentWrapper,"mousedown",this.wrapperClick,this),E.add(window,"resize",this.windowResize,this),E.add(this.inputElement,"focus",this.focusInHandler,this),E.add(this.inputElement,"keydown",this.onKeyDown,this),E.add(this.inputElement,"keyup",this.keyUp,this),this.mode!=="CheckBox"&&E.add(this.inputElement,"input",this.onInput,this),E.add(this.inputElement,"blur",this.onBlurHandler,this),E.add(this.componentWrapper,"mouseover",this.mouseIn,this);var t=j(this.inputElement,"form");t&&E.add(t,"reset",this.resetValueHandler,this),E.add(this.componentWrapper,"mouseout",this.mouseOut,this),E.add(this.overAllClear,"mousedown",this.clearAll,this),E.add(this.inputElement,"paste",this.pasteHandler,this)},e.prototype.onInput=function(t){this.keyDownStatus?this.isValidKey=!0:this.isValidKey=!1,this.keyDownStatus=!1,B.isDevice&&B.info.name==="mozilla"&&this.search(t)},e.prototype.pasteHandler=function(t){var i=this;setTimeout(function(){i.expandTextbox(),i.search(t)})},e.prototype.search=function(t){var i=this;if(this.preventSetCurrentData=!1,this.firstItem=this.dataSource&&this.dataSource.length>0?this.dataSource[0]:null,g(t)||(this.keyCode=t.keyCode),!this.isPopupOpen()&&this.openOnClick&&this.showPopup(t),this.openClick(t),this.checkTextLength()&&!this.allowFiltering&&!g(t)&&t.keyCode!==8)this.focusAtFirstListItem();else{var r=this.targetElement();if(this.allowFiltering){this.allowCustomValue&&(this.isRemoteSelection=!0),this.checkAndResetCache(),this.isRequesting=!1;var n={preventDefaultAction:!1,text:this.targetElement(),updateData:function(f,v,m){n.cancel||(i.isFiltered=!0,i.customFilterQuery=v,i.remoteFilterAction=!0,i.isCustomFiltering=!0,i.dataUpdater(f,v,m))},event:t,cancel:!1};this.trigger("filtering",n,function(f){i.isFilterPrevented=f.cancel,f.cancel||!i.isFiltered&&!f.preventDefaultAction&&(i.filterAction=!0,i.isFilteringAction=!0,i.dataSource instanceof re&&i.allowCustomValue&&(i.isCustomRendered=!1),i.dataUpdater(i.dataSource,null,i.fields),i.isFilteringAction=!1)})}else if(this.allowCustomValue){var s=new Pe;s=this.allowFiltering&&r!==""?s.where(this.fields.text,"startswith",r,this.ignoreCase,this.ignoreAccent):s,this.enableVirtualization?this.dataUpdater(this.dataSource,s,this.fields):this.dataUpdater(this.mainData,s,this.fields),this.UpdateSkeleton()}else{var a=this.list.querySelectorAll("li."+le.li+":not(.e-hide-listitem)"),l=this.typeOfData(this.listData).typeof,h=aa(this.targetElement(),a,"StartsWith",this.ignoreCase);if(this.enableVirtualization&&this.targetElement().trim()!==""&&!this.allowFiltering){var u=!1;for((this.viewPortInfo.endIndex>=this.incrementalEndIndex&&this.incrementalEndIndex<=this.totalItemCount||this.incrementalEndIndex===0)&&(u=!0,this.incrementalStartIndex=0,this.incrementalEndIndex=100>this.totalItemCount?this.totalItemCount:100,this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),u=!1),(this.viewPortInfo.startIndex!==0||u)&&this.updateIncrementalView(0,this.itemCount),h=aa(this.targetElement(),this.incrementalLiCollections,this.filterType,!0,this.listData,this.fields,l);g(h)&&this.incrementalEndIndex<this.totalItemCount&&(this.incrementalStartIndex=this.incrementalEndIndex,this.incrementalEndIndex=this.incrementalEndIndex+100>this.totalItemCount?this.totalItemCount:this.incrementalEndIndex+100,this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),u=!0,(this.viewPortInfo.startIndex!==0||u)&&this.updateIncrementalView(0,this.itemCount),h=aa(this.targetElement(),this.incrementalLiCollections,this.filterType,!0,this.listData,this.fields,l),!!g(h));)if(g(h)&&this.incrementalEndIndex>=this.totalItemCount){this.incrementalStartIndex=0,this.incrementalEndIndex=100>this.totalItemCount?this.totalItemCount:100;break}if(h.index&&(!(this.viewPortInfo.startIndex>=h.index)||!(h.index>=this.viewPortInfo.endIndex))){var c=h.index-(this.itemCount/2-2)>0?h.index-(this.itemCount/2-2):0,d=c+this.itemCount>this.totalItemCount?this.totalItemCount:c+this.itemCount;c!==this.viewPortInfo.startIndex&&this.updateIncrementalView(c,d)}if(g(h.item))this.updateIncrementalView(0,this.itemCount),this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues(),this.list.scrollTop=0;else{var p=this.getIndexByValue(h.item.getAttribute("data-value"))-this.skeletonCount;if(p>this.itemCount/2){var c=this.viewPortInfo.startIndex+(this.itemCount/2-2)<this.totalItemCount?this.viewPortInfo.startIndex+(this.itemCount/2-2):this.totalItemCount,d=this.viewPortInfo.startIndex+this.itemCount>this.totalItemCount?this.totalItemCount:this.viewPortInfo.startIndex+this.itemCount;this.updateIncrementalView(c,d)}h.item=this.getElementByValue(h.item.getAttribute("data-value"))}h&&h.item&&(h.item=this.getElementByValue(h.item.getAttribute("data-value")))}h&&h.item?(this.addListFocus(h.item),this.list.scrollTop=h.item.offsetHeight*h.index):this.targetElement()!==""?this.removeFocus():this.focusAtFirstListItem()}}this.enableVirtualization&&this.allowFiltering&&this.getFilteringSkeletonCount()},e.prototype.preRender=function(){this.allowFiltering===null&&(this.allowFiltering=this.mode==="CheckBox"),this.preventSetCurrentData=!1,this.initializeData(),this.updateDataAttribute(this.htmlAttributes),o.prototype.preRender.call(this)},e.prototype.getLocaleName=function(){return"multi-select"},e.prototype.initializeData=function(){this.mainListCollection=[],this.beforePopupOpen=!1,this.filterAction=!1,this.remoteFilterAction=!1,this.isFirstClick=!1,this.mobFilter=!0,this.isFiltered=!1,this.focused=!0,this.initial=!0,this.backCommand=!0,this.isCustomRendered=!1,this.isRemoteSelection=!1,this.isSelectAllTarget=!0,this.isaddNonPresentItems=!1,this.viewPortInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:this.itemCount}},e.prototype.updateData=function(t,i,r){var n="",s=this.mode==="Delimiter"||this.mode==="CheckBox",a=[],l,h=this.listData;if(this.enableVirtualization||(this.listData=this.mainData),!g(this.hiddenElement)&&!this.enableVirtualization&&(this.hiddenElement.innerHTML=""),!g(this.value)){for(var u=this.value.length,c="",d=function(w){var I=p.allowObjectBinding?V(p.fields.value?p.fields.value:"",p.value[w]):p.value[w],x=p.findListElement(g(p.mainList)?p.ulElement:p.mainList,"li","data-value",I);if(p.enableVirtualization&&(x=p.findListElement(g(p.list)?p.ulElement:p.list,"li","data-value",I)),g(x)&&!p.allowCustomValue&&!p.enableVirtualization&&p.listData&&p.listData.length>0)p.value.splice(w,1),w-=1,u-=1;else{if(p.listData)if(p.enableVirtualization){s&&!p.isDynamicRemoteVirtualData&&(n=p.delimiterWrapper&&p.delimiterWrapper.innerHTML===""?n:p.delimiterWrapper.innerHTML);var M=p.allowObjectBinding?V(p.fields.value?p.fields.value:"",p.value[p.value.length-1]):p.value[p.value.length-1];if(p.isRemoveSelection)n=p.text.replace(/,/g,t+" ")+t+" ",a=p.text.split(t);else{l=r&&s?p.text:p.getTextByValue(M);var D=p.isDynamicRemoteVirtualData&&M!=null&&M!==""&&!r?p.getTextByValue(M):r?p.text:p.text&&p.text!==""?p.text+p.delimiterChar+l:l;n+=l+t+" ",a.push(D),c=p.hiddenElement.innerHTML}if(i&&i.currentTarget&&i.currentTarget.classList.contains("e-chips-close")||i&&i.key==="Backspace"){var A=i.target.parentElement.getAttribute("data-value");if(i.key==="Backspace"){var L=p.hiddenElement.lastChild;L&&p.hiddenElement.removeChild(L)}else p.hiddenElement.childNodes.forEach(function(T){T.value===A&&T.parentNode.removeChild(T)});c=p.hiddenElement.innerHTML}else c+="<option selected value='"+M+"'>"+w+"</option>";return f=w,"break"}else l=p.getTextByValue(I);else l=I;n+=l+t+" ",a.push(l)}c+='<option selected value="'+I+'">'+w+"</option>",f=w},p=this,f,v=0;v<u;v++){var m=d(v);if(v=f,m==="break")break}g(this.hiddenElement)||(this.isRemoveSelection?(this.findListElement(this.hiddenElement,"option","value",this.currentRemoveValue)&&this.hiddenElement.removeChild(this.findListElement(this.hiddenElement,"option","value",this.currentRemoveValue)),this.isRemoveSelection=!1):this.hiddenElement.innerHTML=c)}var y=i&&i.target&&i.target.classList.contains("e-chips-close");(!this.enableVirtualization||this.enableVirtualization&&this.mode!=="CheckBox"&&!y)&&this.setProperties({text:a.toString()},!0),s&&(this.updateWrapperText(this.delimiterWrapper,n),this.delimiterWrapper.setAttribute("id",kt("delim_val")),this.inputElement.setAttribute("aria-describedby",this.delimiterWrapper.id));var S=i&&i.target,b=S&&S.classList.contains("e-close-hooker")?!0:null;(!this.changeOnBlur&&i&&!b||this.isSelectAll)&&(this.isSelectAll=!1,this.updateValueState(i,this.value,this.tempValues)),this.listData=h,this.addValidInputClass()},e.prototype.initialTextUpdate=function(){if(g(this.text))this.setProperties({value:null},!0);else{for(var t=this.text.split(this.delimiterChar),i=[],r=0;t.length>r;r++){var n=this.getValueByText(t[r]);g(n)?this.allowCustomValue&&i.push(t[r]):i.push(n)}if(i&&i.length){var s=this.allowObjectBinding?this.getDataByValue(i):i;this.setProperties({value:s},!0)}}},e.prototype.renderList=function(t){!t&&this.allowCustomValue&&this.list&&(this.list.textContent===this.noRecordsTemplate||this.list.querySelector(".e-ul")&&this.list.querySelector(".e-ul").childElementCount===0)&&(t=!0),o.prototype.render.call(this,null,t),this.totalItemCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.unwireListEvents(),this.wireListEvents()},e.prototype.initialValueUpdate=function(t,i){if(this.list){var r=void 0,n=void 0,s=void 0;if(this.chipCollectionWrapper&&(this.chipCollectionWrapper.innerHTML=""),this.removeListSelection(),!g(this.value))for(var a=0;!g(this.value[a]);a++){s=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[a]):this.value[a],n=this.findListElement(this.hideSelectedItem?this.ulElement:this.list,"li","data-value",s);var l=!1;if(this.enableVirtualization){if(r=null,t!=null&&t.length>0){for(var h=0;h<t.length;h++)if(this.isPrimitiveData&&t[h]===s||!this.isPrimitiveData&&V(this.fields.value?this.fields.value:"value",t[h])===s){r=this.isPrimitiveData?t[h]:V(this.fields.text,t[h]),this.enableVirtualization&&(g(this.selectedListData)?this.selectedListData=[t[h]]:Array.isArray(this.selectedListData)?this.selectedListData.push(t[h]):this.selectedListData=[this.selectedListData,t[h]]);break}}g(r)&&this.allowCustomValue&&(!(this.dataSource instanceof re)||this.dataSource instanceof re&&i)&&(r=this.getTextByValue(s),l=!0)}else r=this.getTextByValue(s);if(n&&n.getAttribute("aria-selected")!=="true"||n&&n.getAttribute("aria-selected")==="true"&&this.hideSelectedItem&&(this.mode==="Box"||this.mode==="Default")||this.enableVirtualization&&s!=null&&r!=null&&!l){var u=[],c=this.isDynamicRemoteVirtualData&&r!=null&&r!==""&&a===0?r:this.text!=null&&this.text!==""&&!this.text.includes(r)?this.text+this.delimiterChar+r:r;u.push(c),this.setProperties({text:u.toString()},!0),this.addChip(r,s),this.addListSelection(n)}else if(!this.enableVirtualization&&s&&this.allowCustomValue||this.enableVirtualization&&s&&this.allowCustomValue&&(!(this.dataSource instanceof re)||this.dataSource instanceof re&&i)){var d=this.listData.length,p={};Ge(this.fields.text,s,p),Ge(this.fields.value,s,p);var f=this.popupWrapper.querySelector("."+le.noData);this.enableVirtualization||this.addItem(p,d),this.enableVirtualization&&(this.virtualCustomSelectData&&this.virtualCustomSelectData.length>=0?this.virtualCustomSelectData.push(p):this.virtualCustomSelectData=[p]),n=n||this.findListElement(this.hideSelectedItem?this.ulElement:this.list,"li","data-value",s),this.popupWrapper.contains(f)&&(this.list.setAttribute("style",f.getAttribute("style")),this.popupWrapper.replaceChild(this.list,f),this.wireListEvents());var u=[],c=this.text!=null&&this.text!==""?this.text+this.delimiterChar+r:r;u.push(c),this.setProperties({text:u.toString()},!0),this.addChip(r,s),this.addListSelection(n)}}this.mode==="CheckBox"?(this.updateDelimView(),this.changeOnBlur&&this.updateValueState(null,this.value,this.tempValues),this.updateDelimeter(this.delimiterChar),this.refreshInputHight()):this.updateDelimeter(this.delimiterChar,null,i),this.mode==="CheckBox"&&this.showSelectAll&&(g(this.value)||!this.value.length)&&this.notify("checkSelectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",value:"uncheck"}),this.mode==="Box"||this.mode==="Default"&&this.inputFocus?this.chipCollectionWrapper.style.display="":(this.mode==="Delimiter"||this.mode==="CheckBox")&&this.showDelimWrapper()}},e.prototype.updateActionCompleteData=function(t,i){this.value&&(!this.allowObjectBinding&&this.value.indexOf(t.getAttribute("data-value"))>-1||this.allowObjectBinding&&this.isObjectInArray(this.getDataByValue(t.getAttribute("data-value")),this.value))&&(this.mainList=this.ulElement,this.hideSelectedItem&&Y([t],Si))},e.prototype.updateAddItemList=function(t,i){this.popupObj&&this.popupObj.element&&this.popupObj.element.querySelector("."+le.noData)&&t?(this.list=t,this.mainList=this.ulElement=t.querySelector("ul"),Ue(this.popupWrapper.querySelector(".e-content")),this.popupObj=null,this.renderPopup()):this.allowCustomValue&&(this.list=t,this.mainList=this.ulElement=t.querySelector("ul"))},e.prototype.updateDataList=function(){if(this.mainList&&this.ulElement&&!(this.isFiltered||this.filterAction||this.targetElement().trim())){var t=this.mainList.childElementCount<this.ulElement.childElementCount,i=this.ulElement.childElementCount>0&&this.ulElement.children[0].childElementCount>0&&this.mainList.children[0]&&this.mainList.children[0].childElementCount<this.ulElement.children[0].childElementCount,r=this.itemTemplate&&this.ulElement.childElementCount>0&&!(this.ulElement.childElementCount<this.mainList.childElementCount)&&(this.ulElement.children[0].childElementCount>0||this.fields.groupBy&&this.ulElement.children[1]&&this.ulElement.children[1].childElementCount>0);(t||i||r)&&(this.mainList=this.ulElement)}},e.prototype.isValidLI=function(t){return t&&!t.classList.contains(le.disabled)&&!t.classList.contains(le.group)&&t.classList.contains(le.li)},e.prototype.updateListSelection=function(t,i,r){var n=t.getAttribute("data-value"),s=this.allowObjectBinding?this.getDataByValue(this.getFormattedValue(n)):this.getFormattedValue(n);this.allowCustomValue&&(n!=="false"&&s===!1||!g(s)&&s.toString()==="NaN")&&(s=n),this.removeHover(),!this.value||!this.allowObjectBinding&&this.value.indexOf(s)===-1||this.allowObjectBinding&&this.indexOfObjectInArray(s,this.value)===-1?this.dispatchSelect(s,i,t,t.getAttribute("aria-selected")==="true",r):this.removeValue(s,i,r)},e.prototype.updateListSelectEventCallback=function(t,i,r,n){var s=this;t=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",t):t;var a=n||this.getTextByValue(t);if((this.allowCustomValue||this.allowFiltering)&&!this.findListElement(this.mainList,"li","data-value",t)&&(!this.enableVirtualization||this.enableVirtualization&&this.virtualCustomData)){var l=i&&i.cloneNode(!0),h=this.fields.value?this.fields.value:"value";this.allowCustomValue&&this.mainData.length&&typeof V(h,this.mainData[0])=="number"&&(t=isNaN(parseFloat(t.toString()))?t:parseFloat(t.toString()));var u=this.getDataByValue(t),c={newData:u,cancel:!1};this.trigger("customValueSelection",c,function(d){d.cancel||(s.enableVirtualization&&s.virtualCustomData?(s.virtualCustomSelectData&&s.virtualCustomSelectData.length>=0?s.virtualCustomSelectData.push(u):s.virtualCustomSelectData=[u],s.remoteCustomValue=!1,s.addValue(t,a,r)):(dt([l],s.mainList),s.mainData.push(u),s.remoteCustomValue=!1,s.addValue(t,a,r)))})}else this.remoteCustomValue=!1,this.addValue(t,a,r)},e.prototype.removeListSelection=function(){var t=this.hideSelectedItem?Si:le.selected,i=this.list.querySelectorAll("."+t),r=i.length;if(i&&i.length)for(K(i,t);r>0;)i[r-1].setAttribute("aria-selected","false"),r--;if(!g(this.mainList)){var n=this.mainList.querySelectorAll("."+t),s=n.length;if(n&&n.length)for(K(n,t);s>0;)n[s-1].setAttribute("aria-selected","false"),this.mode==="CheckBox"&&(i&&i.length>s-1&&K([i[s-1].firstElementChild.lastElementChild],"e-check"),K([n[s-1].firstElementChild.lastElementChild],"e-check")),s--}},e.prototype.removeHover=function(){var t=this.list.querySelectorAll("."+le.hover);t&&t.length&&K(t,le.hover)},e.prototype.removeFocus=function(){if(this.list&&this.mainList){var t=this.list.querySelectorAll("."+le.focus),i=this.mainList.querySelectorAll("."+le.focus);t&&t.length&&(K(t,le.focus),K(i,le.focus))}},e.prototype.addListHover=function(t){this.enabled&&this.isValidLI(t)?(this.removeHover(),Y([t],le.hover)):t!==null&&t.classList.contains("e-list-group-item")&&this.enableGroupCheckBox&&this.mode==="CheckBox"&&!g(this.fields.groupBy)&&(this.removeHover(),Y([t],le.hover))},e.prototype.addListFocus=function(t){this.enabled&&(this.isValidLI(t)||this.fields.disabled&&this.isDisabledElement(t))?(this.removeFocus(),Y([t],le.focus),this.updateAriaActiveDescendant()):this.enableGroupCheckBox&&this.mode==="CheckBox"&&!g(this.fields.groupBy)&&(Y([t],le.focus),this.updateAriaActiveDescendant())},e.prototype.addListSelection=function(t,i){var r=this.hideSelectedItem?Si:le.selected;if(this.isValidLI(t)&&!t.classList.contains(le.hover)){if(Y([t],r),this.updateMainList(!1,t.getAttribute("data-value"),i),t.setAttribute("aria-selected","true"),this.mode==="CheckBox"&&t.classList.contains("e-active")){var n=t.getElementsByClassName("e-check").length;n===0&&this.notify("updatelist",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",li:t,e:this})}this.notify("activeList",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",li:t,e:this}),this.chipCollectionWrapper&&this.removeChipSelection(),this.selectedElementID=t.id}},e.prototype.updateDelimeter=function(t,i,r){this.updateData(t,i,r)},e.prototype.onMouseClick=function(t){var i=this;if(!this.isClearAllItem){this.keyCode=null,this.scrollFocusStatus=!1,this.keyboardEvent=null;var r=t.target,n=j(r,"."+le.li);if(this.enableVirtualization&&n&&n.classList.contains("e-virtual-list"))return;var s=j(r,"."+le.group);if(s&&this.enableGroupCheckBox&&this.mode==="CheckBox"&&this.fields.groupBy)r=r.classList.contains("e-list-group-item")?r.firstElementChild.lastElementChild:t.target,r.classList.contains("e-check")?(this.selectAllItem(!1,t),r.classList.remove("e-check"),r.classList.remove("e-stop"),j(r,".e-list-group-item").classList.remove("e-active"),r.setAttribute("aria-selected","false")):(this.selectAllItem(!0,t),r.classList.remove("e-stop"),r.classList.add("e-check"),j(r,".e-list-group-item").classList.add("e-active"),r.setAttribute("aria-selected","true")),this.refreshSelection(),this.checkSelectAll();else{if(this.isValidLI(n)){var a=this.value&&this.value.length?this.value.length:0;n.classList.contains("e-active")&&(a=a-1),a<this.maximumSelectionLength&&(this.updateListSelection(n,t),this.checkPlaceholderSize(),this.addListFocus(n),(this.allowCustomValue||this.allowFiltering)&&this.mainList&&this.listData?this.mode!=="CheckBox"&&(this.focusAtLastListItem(n.getAttribute("data-value")),this.refreshSelection()):this.makeTextBoxEmpty()),this.mode==="CheckBox"?(this.updateDelimView(),this.value&&this.value.length>50?setTimeout(function(){i.updateDelimeter(i.delimiterChar,t)},0):this.updateDelimeter(this.delimiterChar,t),this.refreshInputHight()):this.updateDelimeter(this.delimiterChar,t),this.checkSelectAll(),this.refreshPopup(),this.allowResize&&this.setResize(),this.hideSelectedItem&&this.focusAtFirstListItem(),this.closePopupOnSelect?this.hidePopup(t):t.preventDefault();var l=this.targetElement().trim()!=="";this.makeTextBoxEmpty(),this.findGroupStart(r),this.mode!=="CheckBox"&&this.refreshListItems(g(n)?null:n.textContent,l)}else t.preventDefault();if(this.enableVirtualization&&this.hideSelectedItem){var h=this.list.querySelectorAll("li."+le.li+":not(."+Si+"):not(.e-reorder-hide):not(.e-virtual-list)");if(h.length){var u=this.virtualListHeight>0?Math.floor(this.virtualListHeight/this.listItemHeight):0;if(h.length<u+2){var c=this.getForQuery(this.value).clone();if(c=c.skip(this.virtualItemStartIndex),this.resetList(this.dataSource,this.fields,c),this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+le.li),this.virtualItemCount=this.itemCount,this.mode!=="CheckBox"&&(this.totalItemCount=this.value&&this.value.length?this.totalItemCount-this.value.length:this.totalItemCount),this.list.querySelector(".e-virtual-ddl"))this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight();else{var d=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});d.style.cssText=this.GetVirtualTrackHeight(),this.popupWrapper.querySelector(".e-dropdownbase").appendChild(d)}this.list.querySelector(".e-virtual-ddl-content")&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues())}}}this.refreshPlaceHolder(),this.deselectHeader()}}},e.prototype.findGroupStart=function(t){if(this.enableGroupCheckBox&&this.mode==="CheckBox"&&!g(this.fields.groupBy)){var i=0,r=0,n=0,s=void 0;if(this.itemTemplate&&!t.getElementsByClassName("e-frame").length)for(;!t.getElementsByClassName("e-frame").length;)t=t.parentElement;for(t.classList.contains("e-frame")&&(t=t.parentElement.parentElement),s=this.findGroupAttrtibutes(t,r,n,i,0),s=this.findGroupAttrtibutes(t,s[0],s[1],s[2],1);!t.classList.contains("e-list-group-item")&&(t.classList.contains("e-list-icon")&&(t=t.parentElement),t=t.previousElementSibling,t!=null););this.updateCheckBox(t,s[0],s[1],s[2])}},e.prototype.findGroupAttrtibutes=function(t,i,r,n,s){for(;!t.classList.contains("e-list-group-item")&&(this.fields.disabled&&this.isDisabledElement(t)||(t.classList.contains("e-list-icon")&&(t=t.parentElement),t.getElementsByClassName("e-frame")[0].classList.contains("e-check")&&t.classList.contains("e-list-item")?i++:t.classList.contains("e-list-item")&&r++,n++),t=s?t.nextElementSibling:t.previousElementSibling,t!=null););return[i,r,n]},e.prototype.updateCheckBox=function(t,i,r,n){if(!(t===null||!g(this.fields.disabled)&&n===0)){var s=t.getElementsByClassName("e-frame")[0];n===i?(s.classList.remove("e-stop"),s.classList.add("e-check"),j(s,".e-list-group-item").classList.add("e-active"),t.setAttribute("aria-selected","true")):n===r?(s.classList.remove("e-check"),s.classList.remove("e-stop"),j(s,".e-list-group-item").classList.remove("e-active"),t.setAttribute("aria-selected","false")):this.maximumSelectionLength===i-1?(s.classList.remove("e-stop"),t.setAttribute("aria-selected","true"),j(s,".e-list-group-item").classList.add("e-active"),s.classList.add("e-check")):(s.classList.remove("e-check"),s.classList.add("e-stop"),j(s,".e-list-group-item").classList.add("e-active"),t.setAttribute("aria-selected","false"))}},e.prototype.disableGroupHeader=function(){var t=this.list.querySelectorAll("li.e-list-group-item");if(t)for(var i=0;i<t.length;i++){for(var r=!0,n=t[i].nextElementSibling;!n.classList.contains("e-list-group-item");){if(!this.isDisabledElement(n)){r=!1;break}if(n=n.nextElementSibling,n==null)break}r&&this.disableListItem(t[i])}},e.prototype.deselectHeader=function(){var t=this.value&&this.value.length?this.value.length:0,i=this.list.querySelectorAll("li.e-list-group-item:not(.e-active)");t<this.maximumSelectionLength&&K(i,"e-disable"),t===this.maximumSelectionLength&&Y(i,"e-disable")},e.prototype.onMouseOver=function(t){var i=j(t.target,"."+le.li);i===null&&this.mode==="CheckBox"&&!g(this.fields.groupBy)&&this.enableGroupCheckBox&&(i=j(t.target,"."+le.group)),this.addListHover(i)},e.prototype.onMouseLeave=function(){this.removeHover()},e.prototype.onListMouseDown=function(t){t.preventDefault(),this.scrollFocusStatus=!0},e.prototype.onDocumentClick=function(t){if(this.mode!=="CheckBox"){var i=t.target;!(!g(this.popupObj)&&j(i,'[id="'+this.popupObj.element.id+'"]'))&&!this.overAllWrapper.contains(t.target)?this.scrollFocusStatus=!1:this.scrollFocusStatus=(B.isIE||B.info.name==="edge")&&document.activeElement===this.inputElement}},e.prototype.wireListEvents=function(){g(this.list)||(E.add(document,"mousedown",this.onDocumentClick,this),E.add(this.list,"mousedown",this.onListMouseDown,this),E.add(this.list,"mouseup",this.onMouseClick,this),E.add(this.list,"mouseover",this.onMouseOver,this),E.add(this.list,"mouseout",this.onMouseLeave,this))},e.prototype.unwireListEvents=function(){E.remove(document,"mousedown",this.onDocumentClick),this.list&&(E.remove(this.list,"mousedown",this.onListMouseDown),E.remove(this.list,"mouseup",this.onMouseClick),E.remove(this.list,"mouseover",this.onMouseOver),E.remove(this.list,"mouseout",this.onMouseLeave))},e.prototype.hideOverAllClear=function(){(!this.value||!this.value.length||this.inputElement.value==="")&&(this.overAllClear.style.display="none")},e.prototype.showOverAllClear=function(){(this.value&&this.value.length||this.inputElement.value!=="")&&this.showClearButton&&this.readonly!==!0?this.overAllClear.style.display="":this.overAllClear.style.display="none"},e.prototype.focusIn=function(){document.activeElement!==this.inputElement&&this.enabled&&this.inputElement.focus()},e.prototype.focusOut=function(){document.activeElement===this.inputElement&&this.enabled&&this.inputElement.blur()},e.prototype.showSpinner=function(){if(g(this.spinnerElement)){var t=this.filterParent&&this.filterParent.querySelector(".e-clear-icon.e-icons");this.overAllClear.style.display!=="none"||t?this.spinnerElement=t||this.overAllClear:(this.spinnerElement=this.createElement("span",{className:sk+" "+hk}),this.componentWrapper.appendChild(this.spinnerElement)),Os({target:this.spinnerElement,width:B.isDevice?"16px":"14px"},this.createElement),Y([this.spinnerElement],lk),rs(this.spinnerElement)}},e.prototype.hideSpinner=function(){g(this.spinnerElement)||(Rs(this.spinnerElement),K([this.spinnerElement],lk),this.spinnerElement.classList.contains(hk)?ee(this.spinnerElement):this.spinnerElement.innerHTML="",this.spinnerElement=null)},e.prototype.updateWrapperText=function(t,i){this.valueTemplate||!this.enableHtmlSanitizer?t.innerHTML=this.encodeHtmlEntities(i):t.innerText=i},e.prototype.updateDelimView=function(){if(this.delimiterWrapper&&this.hideDelimWrapper(),this.chipCollectionWrapper&&(this.chipCollectionWrapper.style.display="none"),g(this.viewWrapper)||(this.viewWrapper.style.display="",this.viewWrapper.style.width="",this.viewWrapper.classList.remove(am)),this.value&&this.value.length){var t="",i=void 0,r=void 0,n=1,s=void 0,a=void 0,l=0,h=void 0;this.enableVirtualization||this.updateWrapperText(this.viewWrapper,t);var u={noRecordsTemplate:"No records found",actionFailureTemplate:"Request failed",overflowCountTemplate:"+${count} more..",totalCountTemplate:"${count} selected"},c=new Li(this.getLocaleName(),u,this.locale);c.getConstant("actionFailureTemplate")===""&&(c=new Li("dropdowns",u,this.locale)),c.getConstant("noRecordsTemplate")===""&&(c=new Li("dropdowns",u,this.locale));var d=c.getConstant("overflowCountTemplate"),p=c.getConstant("totalCountTemplate"),f=this.createElement("span",{className:g5}),v=d.replace("${count}",this.value.length.toString());f.innerText=v,this.viewWrapper.appendChild(f),this.renderReactTemplates();var m=f.offsetWidth;if(Ue(f),this.showDropDownIcon&&(l=this.dropIcon.offsetWidth+parseInt(window.getComputedStyle(this.dropIcon).marginRight,10)),this.checkClearIconWidth(),!g(this.value)&&(this.allowCustomValue||this.listData&&this.listData.length>0))for(var y=0;!g(this.value[y]);y++){var S=this.text&&this.text.split(this.delimiterChar);if(this.enableVirtualization?S&&(t+=y===0?"":this.delimiterChar+" ",i=S[y],t+=i,i=this.viewWrapper.innerHTML,this.updateWrapperText(this.viewWrapper,t)):(t+=y===0?"":this.delimiterChar+" ",i=this.getOverflowVal(y),t+=i,i=this.viewWrapper.innerHTML,this.updateWrapperText(this.viewWrapper,t)),s=this.viewWrapper.offsetWidth+parseInt(window.getComputedStyle(this.viewWrapper).paddingRight,10),h=this.componentWrapper.offsetWidth-parseInt(window.getComputedStyle(this.componentWrapper).paddingLeft,10)-parseInt(window.getComputedStyle(this.componentWrapper).paddingRight,10),s+l+this.clearIconWidth>h){for(r!==void 0&&r!==""&&(i=r,y=n+1),this.updateWrapperText(this.viewWrapper,i),a=this.value.length-y,s=this.viewWrapper.offsetWidth+parseInt(window.getComputedStyle(this.viewWrapper).paddingRight,10);s+m+l+this.clearIconWidth>h&&s!==0&&this.viewWrapper.innerHTML!=="";){var b=[];this.viewWrapper.innerHTML=b.join(this.delimiterChar),a=this.value.length,s=this.viewWrapper.offsetWidth+parseInt(window.getComputedStyle(this.viewWrapper).paddingRight,10)}break}else s+m+l+this.clearIconWidth<=h?(r=t,n=y):y===0&&(r="",n=-1)}if(a>0){var w=h-l-this.clearIconWidth;this.viewWrapper.appendChild(this.updateRemainTemplate(f,this.viewWrapper,a,d,p,w)),this.updateRemainWidth(this.viewWrapper,w),this.updateRemainingText(f,l,a,d,p)}}else g(this.viewWrapper)||(this.viewWrapper.innerHTML="",this.viewWrapper.style.display="none")},e.prototype.checkClearIconWidth=function(){this.showClearButton&&(this.clearIconWidth=this.overAllClear.offsetWidth)},e.prototype.updateRemainWidth=function(t,i){t.classList.contains(am)&&i<t.offsetWidth+parseInt(window.getComputedStyle(t).paddingLeft,10)+parseInt(window.getComputedStyle(t).paddingLeft,10)&&(t.style.width=i+"px")},e.prototype.updateRemainTemplate=function(t,i,r,n,s,a){i.firstChild&&i.firstChild.nodeType===3&&i.firstChild.nodeValue===""&&i.removeChild(i.firstChild),t.innerHTML="";var l=n.replace("${count}",r.toString()),h=s.replace("${count}",r.toString());return t.innerText=i.firstChild&&i.firstChild.nodeType===3?l:h,i.firstChild&&i.firstChild.nodeType===3?i.classList.remove(am):(i.classList.add(am),this.updateRemainWidth(i,a)),t},e.prototype.updateRemainingText=function(t,i,r,n,s){var a=this.componentWrapper.offsetWidth-parseInt(window.getComputedStyle(this.componentWrapper).paddingLeft,10)-parseInt(window.getComputedStyle(this.componentWrapper).paddingRight,10),l=this.viewWrapper.offsetWidth+parseInt(window.getComputedStyle(this.viewWrapper).paddingRight,10);if(l+i>=a&&l!==0&&this.viewWrapper.firstChild&&this.viewWrapper.firstChild.nodeType===3){for(;l+i>a&&l!==0&&this.viewWrapper.firstChild&&this.viewWrapper.firstChild.nodeType===3;){var h=this.viewWrapper.firstChild.nodeValue.split(this.delimiterChar);h.pop(),this.viewWrapper.firstChild.nodeValue=h.join(this.delimiterChar),this.viewWrapper.firstChild.nodeValue===""&&this.viewWrapper.removeChild(this.viewWrapper.firstChild),r++,l=this.viewWrapper.offsetWidth}var u=a-i;this.updateRemainTemplate(t,this.viewWrapper,r,n,s,u)}},e.prototype.getOverflowVal=function(t){var i;if(this.mainData&&this.mainData.length){var r=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[t]):this.value[t];if(this.mode==="CheckBox"){var n=this.listData;this.listData=this.mainData,i=this.getTextByValue(r),this.listData=n}else i=this.getTextByValue(r)}else i=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[t]):this.value[t];return i},e.prototype.unWireEvent=function(){if(g(this.componentWrapper)||E.remove(this.componentWrapper,"mousedown",this.wrapperClick),E.remove(window,"resize",this.windowResize),!g(this.inputElement)){E.remove(this.inputElement,"focus",this.focusInHandler),E.remove(this.inputElement,"keydown",this.onKeyDown),this.mode!=="CheckBox"&&E.remove(this.inputElement,"input",this.onInput),E.remove(this.inputElement,"keyup",this.keyUp);var t=j(this.inputElement,"form");t&&E.remove(t,"reset",this.resetValueHandler),E.remove(this.inputElement,"blur",this.onBlurHandler)}g(this.componentWrapper)||(E.remove(this.componentWrapper,"mouseover",this.mouseIn),E.remove(this.componentWrapper,"mouseout",this.mouseOut)),g(this.overAllClear)||E.remove(this.overAllClear,"mousedown",this.clearAll),g(this.inputElement)||E.remove(this.inputElement,"paste",this.pasteHandler)},e.prototype.resizingWireEvent=function(){E.add(document,"mousemove",this.resizePopup,this),E.add(document,"mouseup",this.stopResizing,this),E.add(document,"touchmove",this.resizePopup,this),E.add(document,"touchend",this.stopResizing,this)},e.prototype.resizingUnWireEvent=function(){E.remove(document,"mousemove",this.resizePopup),E.remove(document,"mouseup",this.stopResizing),E.remove(document,"touchmove",this.resizePopup),E.remove(document,"touchend",this.stopResizing)},e.prototype.selectAllItem=function(t,i,r){var n;if(g(this.list)||(n=this.list.querySelectorAll(t?'li.e-list-item:not([aria-selected="true"]):not(.e-reorder-hide):not(.e-disabled):not(.e-virtual-list)':'li.e-list-item[aria-selected="true"]:not(.e-reorder-hide):not(.e-disabled):not(.e-virtual-list)')),this.value&&this.value.length&&i&&i.target&&j(i.target,".e-close-hooker")&&this.allowFiltering&&(n=this.mainList.querySelectorAll(t?'li.e-list-item:not([aria-selected="true"]):not(.e-reorder-hide):not(.e-disabled):not(.e-virtual-list)':'li.e-list-item[aria-selected="true"]:not(.e-reorder-hide):not(.e-disabled):not(.e-virtual-list)')),this.enableGroupCheckBox&&this.mode==="CheckBox"&&!g(this.fields.groupBy)){var s=i?this.groupTemplate?j(i.target,".e-list-group-item"):i.target:null;if(s=i&&i.keyCode===32?r:s,s=s&&s.classList.contains("e-frame")?s.parentElement.parentElement:s,s&&s.classList.contains("e-list-group-item")){var a=s.nextElementSibling;if(g(a))return;for(;a.classList.contains("e-list-item");){if(!(this.fields.disabled&&this.isDisabledElement(a)))if(t){if(!a.firstElementChild.lastElementChild.classList.contains("e-check")){var l=this.value&&this.value.length?this.value.length:0;a.classList.contains("e-active")&&(l-=1),l<this.maximumSelectionLength&&this.updateListSelection(a,i)}}else a.firstElementChild.lastElementChild.classList.contains("e-check")&&this.updateListSelection(a,i);if(a=a.nextElementSibling,a==null)break}if(s.classList.contains("e-list-group-item")){var h=this.list.getElementsByClassName("e-item-focus")[0];h&&h.classList.remove("e-item-focus"),t?s.classList.add("e-active"):s.classList.remove("e-active"),s.classList.add("e-item-focus"),this.updateAriaActiveDescendant()}this.textboxValueUpdate(),this.checkPlaceholderSize(),!this.changeOnBlur&&i&&this.updateValueState(i,this.value,this.tempValues)}else this.updateValue(i,n,t)}else this.updateValue(i,n,t);this.addValidInputClass()},e.prototype.virtualSelectionAll=function(t,i,r){var n=this,s=0,a=i.length,l=this.maximumSelectionLength;if(t){this.virtualSelectAll=!0,a=this.virtualSelectAllData&&this.virtualSelectAllData.length!==0?this.virtualSelectAllData.length:a,this.listData=this.virtualSelectAllData;var h=this.createListItems(this.virtualSelectAllData.slice(0,30),this.fields),u=h.querySelectorAll("li"),c=document.createDocumentFragment();u.forEach(function(m){c.appendChild(m.cloneNode(!0))}),i.forEach(function(m){c.appendChild(m.cloneNode(!0))});var d=c.childNodes;if(this.virtualSelectAllData instanceof Array){for(;s<a&&s<=50&&s<l;){if(this.isSelectAllTarget=a===s+1,d[s]){var p=this.allowObjectBinding?this.getDataByValue(d[s].getAttribute("data-value")):this.getFormattedValue(d[s].getAttribute("data-value"));if(!this.allowObjectBinding&&this.value&&this.value.indexOf(p)>=0||this.allowObjectBinding&&this.indexOfObjectInArray(p,this.value)>=0){s++;continue}this.updateListSelection(d[s],r,a-s)}else{var p=V(this.fields.value?this.fields.value:"",this.virtualSelectAllData[s]);if(p=this.allowObjectBinding?this.getDataByValue(p):p,!this.allowObjectBinding&&this.value&&this.value.indexOf(p)>=0||this.allowObjectBinding&&this.indexOfObjectInArray(p,this.value)>=0){s++;continue}this.value&&p!=null&&Array.isArray(this.value)&&(!this.allowObjectBinding&&this.value.indexOf(p)<0||this.allowObjectBinding&&!this.isObjectInArray(p,this.value))&&this.dispatchSelect(p,r,null,!1,a)}s++}a>50&&setTimeout(function(){if(n.virtualSelectAllData&&n.virtualSelectAllData.length>0&&n.virtualSelectAllData.map(function(y){if(n.value&&y[n.fields.value]!=null&&Array.isArray(n.value)&&(!n.allowObjectBinding&&n.value.indexOf(y[n.fields.value])<0||n.allowObjectBinding&&!n.isObjectInArray(y[n.fields.value],n.value))){var S=y[n.fields.value],b=y[n.fields.text].toString();n.dispatchSelect(S,r,null,!1,a,y,b)}}),n.updatedataValueItems(r),n.isSelectAllLoop=!1,n.changeOnBlur||(n.updateValueState(r,n.value,n.tempValues),n.isSelectAll=n.isSelectAll?!n.isSelectAll:n.isSelectAll),n.updateHiddenElement(!0),n.popupWrapper&&i[s-1]&&i[s-1].classList.contains("e-item-focus")){var m=document.getElementsByClassName("e-selectall-parent")[0];m&&m.classList.contains("e-item-focus")&&i[s-1].classList.remove("e-item-focus")}},0)}}else this.virtualSelectAllData&&this.virtualSelectAllData.length>0&&this.virtualSelectAllData.map(function(m){n.virtualSelectAll=!0,n.removeValue(n.value[s],r,n.value.length-s)}),this.updatedataValueItems(r),this.changeOnBlur||(this.updateValueState(r,this.value,this.tempValues),this.isSelectAll=this.isSelectAll?!this.isSelectAll:this.isSelectAll),this.updateHiddenElement(),this.setProperties({value:[]},!0),this.virtualSelectAll=!1,!g(this.viewPortInfo.startIndex)&&!g(this.viewPortInfo.endIndex)&&this.notify("setCurrentViewDataAsync",{component:this.getModuleName(),module:"VirtualScroll"});var f=this.list.getElementsByClassName("e-virtual-ddl")[0];f&&(f.style=this.GetVirtualTrackHeight()),this.UpdateSkeleton();var v=this.list.getElementsByClassName("e-virtual-ddl-content")[0];v&&(v.style=this.getTransformValues())},e.prototype.updateValue=function(t,i,r){var n=this,s=i.length,a={event:t,items:r?i:[],itemData:r?this.listData:[],isInteracted:!!t,isChecked:r,preventSelectEvent:!1};if(this.trigger("beforeSelectAll",a),i&&i.length||this.enableVirtualization&&!r){var l=0,h=0;if(this.enableGroupCheckBox?h=r?this.maximumSelectionLength-(this.value?this.value.length:0):i.length:h=r?this.maximumSelectionLength-(this.value?this.value.length:0):this.maximumSelectionLength,a.preventSelectEvent){for(var u=0;u<i.length&&u<h;u++){this.removeHover();var c=i[u].getAttribute("data-value"),d=this.getFormattedValue(c);d=this.allowObjectBinding?this.getDataByValue(d):d;var p=this.mainList?this.mainList.querySelectorAll(r?'li.e-list-item:not([aria-selected="true"]):not(.e-reorder-hide)':'li.e-list-item[aria-selected="true"]:not(.e-reorder-hide)')[u]:null;r?(this.value=this.value?this.value:[],(!this.allowObjectBinding&&this.value.indexOf(d)<0||this.allowObjectBinding&&!this.isObjectInArray(d,this.value))&&this.setProperties({value:[].concat([],this.value,[d])},!0),this.removeFocus(),this.addListSelection(i[u],p),this.updateChipStatus(),this.checkMaxSelection()):this.removeAllItems(d,t,!1,i[u],p),this.enableGroupCheckBox&&this.findGroupStart(i[u])}if(!r){var f=this.value&&this.value.length?this.value.length:0;if(f<this.maximumSelectionLength){var v=this.list.querySelectorAll("li."+le.li+":not(.e-active)");K(v,"e-disable")}}var m={event:t,items:r?i:[],itemData:r?this.listData:[],isInteracted:!!t,isChecked:r};this.trigger("selectedAll",m)}else if(this.enableVirtualization)this.virtualSelectAllState=r,this.virtualSelectAll=!0,this.CurrentEvent=t,this.virtualSelectAllData||this.resetList(this.dataSource,this.fields,new Pe),this.virtualSelectAllData&&this.virtualSelectionAll(r,i,t);else{for(;l<s&&l<=50&&l<h;)this.isSelectAllTarget=s===l+1,this.updateListSelection(i[l],t,s-l),this.enableGroupCheckBox&&this.findGroupStart(i[l]),l++;s>50&&setTimeout(function(){for(;l<s&&l<h;)n.isSelectAllTarget=s===l+1,n.updateListSelection(i[l],t,s-l),n.enableGroupCheckBox&&n.findGroupStart(i[l]),l++;if(n.updatedataValueItems(t),n.changeOnBlur||(n.updateValueState(t,n.value,n.tempValues),n.isSelectAll=n.isSelectAll?!n.isSelectAll:n.isSelectAll),n.updateHiddenElement(),n.popupWrapper&&i[l-1].classList.contains("e-item-focus")){var y=document.getElementsByClassName("e-selectall-parent")[0];y&&y.classList.contains("e-item-focus")&&i[l-1].classList.remove("e-item-focus")}},0)}}this.updatedataValueItems(t),this.checkPlaceholderSize(),s<=50&&!a.preventSelectEvent&&(this.changeOnBlur||(this.updateValueState(t,this.value,this.tempValues),this.isSelectAll=this.isSelectAll?!this.isSelectAll:this.isSelectAll),(this.enableVirtualization&&this.value&&this.value.length>0||!this.enableVirtualization)&&this.updateHiddenElement())},e.prototype.updateHiddenElement=function(t){var i=this,r="",n="",s="",a=[];this.mode==="CheckBox"&&(this.value.map(function(l,h){r+='<option selected value ="'+l+'">'+h+"</option>",t||(i.listData?s=i.getTextByValue(l):s=l,n+=s+i.delimiterChar+" ",a.push(s))}),this.hiddenElement.innerHTML=r,t||(this.updateWrapperText(this.delimiterWrapper,n),this.setProperties({text:a.toString()},!0)),this.delimiterWrapper.setAttribute("id",kt("delim_val")),this.inputElement.setAttribute("aria-describedby",this.delimiterWrapper.id),this.refreshInputHight(),this.refreshPlaceHolder())},e.prototype.updatedataValueItems=function(t){this.deselectHeader(),this.textboxValueUpdate(t)},e.prototype.textboxValueUpdate=function(t){var i=t&&t.target&&(j(t.target,".e-selectall-parent")||j(t.target,".e-close-hooker"));this.mode!=="Box"&&!this.isPopupOpen()&&!(this.mode==="CheckBox"&&(this.isSelectAll||i))?this.updateDelimView():this.searchWrapper.classList.remove(sm),this.mode==="CheckBox"?(this.updateDelimView(),(!(i||this.isSelectAll)&&this.isSelectAllTarget||this.isSelectAll&&this.isSelectAllTarget)&&this.updateDelimeter(this.delimiterChar,t),this.refreshInputHight()):this.updateDelimeter(this.delimiterChar,t),this.refreshPlaceHolder()},e.prototype.setZIndex=function(){this.popupObj&&this.popupObj.setProperties({zIndex:this.zIndex})},e.prototype.updateDataSource=function(t){g(this.list)?this.renderPopup():this.resetList(this.dataSource),this.value&&this.value.length&&(this.setProperties({value:this.value}),this.refreshSelection())},e.prototype.onLoadSelect=function(){this.setDynValue=!0,this.renderPopup()},e.prototype.selectAllItems=function(t,i){var r=this;if(g(this.list))this.selectAllAction=function(){if(r.mode==="CheckBox"&&r.showSelectAll){var s={module:"CheckBoxSelection",enable:r.mode==="CheckBox",value:t?"check":"uncheck"};r.notify("checkSelectAll",s)}r.selectAllItem(t,i),r.selectAllAction=null},o.prototype.render.call(this);else{if(this.selectAllAction=null,this.mode==="CheckBox"&&this.showSelectAll){var n={value:t?"check":"uncheck",enable:this.mode==="CheckBox",module:"CheckBoxSelection"};this.notify("checkSelectAll",n)}this.selectAllItem(t,i)}(!(this.dataSource instanceof re)||this.dataSource instanceof re&&this.virtualSelectAllData)&&(this.virtualSelectAll=!1)},e.prototype.getPersistData=function(){return this.addOnPersist(["value"])},e.prototype.onPropertyChanged=function(t,i){(t.dataSource&&!g(Object.keys(t.dataSource))||t.query&&!g(Object.keys(t.query)))&&(this.mainList=null,this.mainData=null,this.isFirstClick=!1,this.isDynamicDataChange=!0),this.getModuleName()==="multiselect"&&(this.filterAction=!1,this.setUpdateInitial(["fields","query","dataSource"],t));for(var r=0,n=Object.keys(t);r<n.length;r++){var s=n[r];switch(s){case"query":case"dataSource":this.mode==="CheckBox"&&this.showSelectAll&&(g(this.popupObj)||(this.popupObj.destroy(),this.popupObj=null),this.renderPopup());break;case"htmlAttributes":this.updateHTMLAttribute();break;case"showClearButton":this.updateClearButton(t.showClearButton);break;case"text":this.fields.disabled&&(this.text=this.text&&!this.isDisabledItemByIndex(this.getIndexByValue(this.getValueByText(this.text)))?this.text:null),this.updateVal(this.value,this.value,"text");break;case"value":if(this.fields.disabled&&this.removeDisabledItemsValue(this.value),this.updateVal(this.value,i.value,"value"),this.addValidInputClass(),!this.closePopupOnSelect&&this.isPopupOpen()&&this.refreshPopup(),this.isPopupOpen()&&this.mode==="CheckBox"&&this.list&&this.list.querySelector(".e-active.e-disable")){var a=this.list.querySelectorAll("li."+le.li+".e-active.e-disable");K(a,"e-disable")}this.preventChange=this.isAngular&&this.preventChange?!this.preventChange:this.preventChange;break;case"width":this.setWidth(t.width),this.popupObj.setProperties({width:this.calcPopupWidth()});break;case"placeholder":this.refreshPlaceHolder();break;case"filterBarPlaceholder":this.allowFiltering&&this.notify("filterBarPlaceholder",{filterBarPlaceholder:t.filterBarPlaceholder});break;case"delimiterChar":this.mode!=="Box"&&this.updateDelimView(),this.updateData(t.delimiterChar);break;case"cssClass":this.updateOldPropCssClass(i.cssClass),this.updateCssClass(),this.calculateWidth();break;case"enableRtl":this.enableRTL(t.enableRtl),o.prototype.onPropertyChanged.call(this,t,i);break;case"allowResize":if(this.allowResize=t.allowResize,!this.allowResize&&this.popupObj){var l=parseInt(this.popupHeight,10);this.popupHeight!=="auto"?(this.list.style.maxHeight=Le(l),this.popupWrapper.style.height=Le(this.popupHeight),this.popupWrapper.style.maxHeight=Le(this.popupHeight)):this.list.style.maxHeight=Le(this.popupHeight)}break;case"readonly":this.updateReadonly(t.readonly),this.hidePopup();break;case"enabled":this.hidePopup(),this.enable(t.enabled);break;case"showSelectAll":this.popupObj&&(this.popupObj.destroy(),this.popupObj=null),this.renderPopup();break;case"showDropDownIcon":this.dropDownIcon();break;case"floatLabelType":this.setFloatLabelType(),this.addValidInputClass(),Ce.createSpanElement(this.overAllWrapper,this.createElement),this.calculateWidth(),!g(this.overAllWrapper)&&!g(this.overAllWrapper.getElementsByClassName("e-ddl-icon")[0]&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0]&&this.floatLabelType!=="Never")&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0].classList.add("e-icon");break;case"enableSelectionOrder":break;case"selectAllText":this.notify("selectAllText",!1);break;case"popupHeight":if(this.popupObj){var l=parseInt(this.popupHeight,10);this.popupHeight!=="auto"?(this.list.style.maxHeight=Le(l),this.popupWrapper.style.maxHeight=Le(this.popupHeight)):this.list.style.maxHeight=Le(this.popupHeight)}break;case"headerTemplate":case"footerTemplate":this.reInitializePoup();break;case"allowFiltering":this.mode==="CheckBox"&&this.popupObj&&this.reInitializePoup(),this.updateSelectElementData(this.allowFiltering);break;case"fields":g(this.fields.groupBy)&&this.removeScrollEvent();break;default:{var h=this.getPropObject(s,t,i);o.prototype.onPropertyChanged.call(this,h.newProperty,h.oldProperty)}break}}},e.prototype.reInitializePoup=function(){this.popupObj&&(this.popupObj.destroy(),this.popupObj=null),this.renderPopup()},e.prototype.totalItemsCount=function(){var t;if(this.dataSource instanceof re?this.remoteDataCount>=0?t=this.totalItemCount=this.dataCount=this.remoteDataCount:this.resetList(this.dataSource):t=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.mode==="CheckBox")this.totalItemCount=t!==0?t:this.totalItemCount;else if(this.hideSelectedItem){if(this.totalItemCount=t!==0&&this.value?t-this.value.length:this.totalItemCount,this.allowCustomValue&&this.virtualCustomSelectData&&this.virtualCustomSelectData.length>0)for(var i=0;i<this.virtualCustomSelectData.length;i++)for(var r=0;r<this.value.length;r++){var n=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[r]):this.value[r],s=V(this.fields.value?this.fields.value:"",this.virtualCustomSelectData[i]);n===s&&(this.totalItemCount+=1)}}else this.totalItemCount=t!==0?t:this.totalItemCount,this.allowCustomValue&&this.virtualCustomSelectData&&this.virtualCustomSelectData.length>0&&(this.totalItemCount+=this.virtualCustomSelectData.length)},e.prototype.presentItemValue=function(t){for(var i=[],r=0;r<this.value.length;r++){var n=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[r]):this.value[r],s=this.findListElement(this.allowFiltering&&!g(this.mainList)?this.mainList:t,"li","data-value",n);if(!s){var a=this.allowObjectBinding?this.getDataByValue(this.value[r]):this.value[r];i.push(a)}}return i},e.prototype.addNonPresentItems=function(t,i,r,n){var s=this;this.dataSource.executeQuery(this.getForQuery(t)).then(function(a){a.result.length>0&&s.addItem(a.result,r.length),s.updateActionList(i,r,n)})},e.prototype.updateVal=function(t,i,r){if(!this.list)this.onLoadSelect();else if(this.dataSource instanceof re&&(!this.listData||!(this.mainList&&this.mainData)))this.onLoadSelect();else{var n=[];if(!g(this.value)&&!this.allowCustomValue&&(n=this.presentItemValue(this.ulElement)),r==="value"&&n.length>0&&this.dataSource instanceof re&&!g(this.value)&&this.listData!=null)this.mainData=null,this.setDynValue=!0,this.isaddNonPresentItems=!0,this.addNonPresentItems(n,this.ulElement,this.listData),this.isaddNonPresentItems=!1;else{if(r==="text"&&(this.initialTextUpdate(),t=this.value),(g(this.value)||this.value.length===0)&&(this.tempValues=i),this.allowCustomValue&&(this.mode==="Default"||this.mode==="Box")&&this.isReact&&this.inputFocus&&this.isPopupOpen()&&this.mainData!==this.listData){var s=this.mainList.cloneNode?this.mainList.cloneNode(!0):this.mainList;this.onActionComplete(s,this.mainData)}this.enableVirtualization?this.enableVirtualization&&!(this.dataSource instanceof re)?this.initialValueUpdate(this.dataSource,!0):this.isInitRemoteVirtualData||(this.isDynamicRemoteVirtualData=!0,this.initialValueUpdate(this.listData,!0),this.isDynamicRemoteVirtualData=!1,this.initialUpdate()):this.initialValueUpdate(),this.mode!=="Box"&&!this.inputFocus&&this.updateDelimView(),this.inputFocus||this.refreshInputHight(),this.refreshPlaceHolder(),this.mode!=="CheckBox"&&this.changeOnBlur&&this.updateValueState(null,t,i),this.checkPlaceholderSize()}}this.changeOnBlur||this.updateValueState(null,t,i)},e.prototype.addItem=function(t,i){o.prototype.addItem.call(this,t,i)},e.prototype.hidePopup=function(t){var i=this,r=100;if(this.isPopupOpen()){var n={name:"FadeOut",duration:100,delay:r};this.customFilterQuery=null;var s={popup:this.popupObj,cancel:!1,animation:n,event:t||null};this.trigger("close",s,function(a){if(!a.cancel){i.fields.groupBy&&i.mode!=="CheckBox"&&i.fixedHeaderElement&&(Ue(i.fixedHeaderElement),i.fixedHeaderElement=null),i.beforePopupOpen=!1,i.overAllWrapper.classList.remove(ck);var l=i.mode==="CheckBox"?i.targetElement():null;if(i.popupObj.hide(new It(a.animation)),Ie(i.inputElement,{"aria-expanded":"false"}),i.inputElement.removeAttribute("aria-owns"),i.inputElement.removeAttribute("aria-activedescendant"),i.allowFiltering&&i.notify("inputFocus",{module:"CheckBoxSelection",enable:i.mode==="CheckBox",value:"clear"}),i.popupObj.hide(),K([document.body,i.popupObj.element],"e-popup-full-page"),E.remove(i.list,"keydown",i.onKeyDown),i.mode==="CheckBox"&&i.showSelectAll&&E.remove(i.popupObj.element,"click",i.clickHandler),i.list&&i.list.parentElement&&i.allowResize){i.resizer&&i.list.parentElement.contains(i.resizer)&&i.list.parentElement.removeChild(i.resizer),i.list.parentElement.classList.contains("e-resize")&&i.list.parentElement.classList.remove("e-resize"),i.list.parentElement.style.boxSizing="",i.list.parentElement.style.paddingBottom="";var h=parseInt(i.popupHeight,10);i.list.style.maxHeight=Le(h),i.list.parentElement.style.height=Le(i.popupHeight),i.list.parentElement.style.maxHeight=Le(i.popupHeight)}i.resizer&&(E.remove(i.resizer,"mousedown",i.startResizing),i.resizer.remove()),i.enableVirtualization&&i.mode==="CheckBox"&&i.value&&i.value.length>0&&i.enableSelectionOrder&&(i.viewPortInfo.startIndex=i.virtualItemStartIndex=0,i.viewPortInfo.endIndex=i.virtualItemEndIndex=i.viewPortInfo.startIndex>0?i.viewPortInfo.endIndex:i.itemCount,i.virtualListInfo=i.viewPortInfo,i.previousStartIndex=0,i.previousEndIndex=i.itemCount);var u=void 0;i.dataSource instanceof re?i.remoteDataCount>=0?i.totalItemCount=i.dataCount=i.remoteDataCount:i.resetList(i.dataSource):u=i.dataSource&&i.dataSource.length?i.dataSource.length:0,i.enableVirtualization&&(i.allowFiltering||i.allowCustomValue)&&(i.targetElement()||l)&&i.totalItemCount!==u&&(i.checkAndResetCache(),i.updateInitialData()),i.virtualCustomData&&i.viewPortInfo&&i.viewPortInfo.startIndex===0&&i.viewPortInfo.endIndex===i.itemCount&&i.renderItems(i.mainData,i.fields),i.virtualCustomData=null,i.isVirtualTrackHeight=!1}})}},e.prototype.showPopup=function(t){var i=this;if(this.enabled){this.firstItem=this.dataSource&&this.dataSource.length>0?this.dataSource[0]:null;var r={cancel:!1};this.trigger("beforeOpen",r,function(n){if(!n.cancel){if(!i.ulElement){i.beforePopupOpen=!0,i.mode==="CheckBox"&&B.isDevice&&i.allowFiltering&&i.isDeviceFullScreen&&i.notify("popupFullScreen",{module:"CheckBoxSelection",enable:i.mode==="CheckBox"}),o.prototype.render.call(i,t);return}i.mode==="CheckBox"&&B.isDevice&&i.allowFiltering&&i.isDeviceFullScreen&&i.notify("popupFullScreen",{module:"CheckBoxSelection",enable:i.mode==="CheckBox"});var s=i.ulElement.querySelectorAll("li.e-list-item").length,a=i.ulElement.querySelectorAll("li."+le.li+"."+Si).length;if(s>0&&s===a&&a===i.mainData.length&&!(i.targetElement()!==""&&i.allowCustomValue)){i.beforePopupOpen=!1;return}if(i.onPopupShown(t),i.enableVirtualization&&i.listData&&i.listData.length&&(!g(i.value)&&(i.getModuleName()==="dropdownlist"||i.getModuleName()==="combobox")&&i.removeHover(),i.beforePopupOpen||(i.hideSelectedItem&&i.value&&Array.isArray(i.value)&&i.value.length>0&&i.totalItemsCount(),!i.preventSetCurrentData&&!g(i.viewPortInfo.startIndex)&&!g(i.viewPortInfo.endIndex)&&i.notify("setCurrentViewDataAsync",{component:i.getModuleName(),module:"VirtualScroll"}))),i.enableVirtualization&&!i.allowFiltering&&i.selectedValueInfo!=null&&i.selectedValueInfo.startIndex>0&&i.value!=null&&i.notify("dataProcessAsync",{module:"VirtualScroll",isOpen:!0}),i.enableVirtualization)i.updatevirtualizationList();else if(i.value&&i.value.length)for(var l=void 0,h=i.getItems(),u=0,c=i.value;u<c.length;u++){var d=c[u],p=i.allowObjectBinding?V(i.fields.value?i.fields.value:"",d):d;l=i.getElementByValue(p),l&&i.addListSelection(l)}i.allowResize&&i.setResize(),i.preventSetCurrentData=!0}})}},e.prototype.selectAll=function(t){this.isSelectAll=!0,this.selectAllItems(t)},e.prototype.getModuleName=function(){return"multiselect"},e.prototype.clear=function(){var t=this;this.selectAll(!1),this.value&&this.value.length?setTimeout(function(){t.setProperties({value:null},!0)},0):this.setProperties({value:null},!0)},e.prototype.render=function(){!g(this.value)&&this.value.length>0&&(this.value=this.value.slice()),this.setDynValue=this.initStatus=!1,this.isSelectAll=!1,this.selectAllEventEle=[],this.searchWrapper=this.createElement("span",{className:f5+" "+(this.mode==="Box"?x5:"")}),this.viewWrapper=this.createElement("span",{className:c5+" "+ak}),this.viewWrapper.style.display="none",this.overAllClear=this.createElement("span",{className:sk}),this.overAllClear.style.display="none",this.componentWrapper=this.createElement("div",{className:h5}),this.overAllWrapper=this.createElement("div",{className:l5}),this.mode==="CheckBox"&&Y([this.overAllWrapper],"e-checkbox"),B.isDevice&&this.componentWrapper.classList.add(u5),this.setWidth(this.width),this.overAllWrapper.appendChild(this.componentWrapper),this.popupWrapper=this.createElement("div",{id:this.element.id+"_popup",className:v5}),this.popupWrapper.setAttribute("aria-label",this.element.id),this.popupWrapper.setAttribute("role","dialog"),this.mode==="Delimiter"||this.mode==="CheckBox"?(this.delimiterWrapper=this.createElement("span",{className:ak}),this.delimiterWrapper.style.display="none",this.componentWrapper.appendChild(this.delimiterWrapper)):(this.chipCollectionWrapper=this.createElement("span",{className:d5}),this.chipCollectionWrapper.style.display="none",this.mode==="Default"?this.chipCollectionWrapper.setAttribute("id",kt("chip_default")):this.mode==="Box"&&this.chipCollectionWrapper.setAttribute("id",kt("chip_box")),this.componentWrapper.appendChild(this.chipCollectionWrapper)),this.mode!=="Box"&&this.componentWrapper.appendChild(this.viewWrapper),this.componentWrapper.appendChild(this.searchWrapper),this.showClearButton&&!B.isDevice?this.componentWrapper.appendChild(this.overAllClear):this.componentWrapper.classList.add(xw),this.dropDownIcon(),this.inputElement=this.createElement("input",{className:m5,attrs:{spellcheck:"false",type:"text",autocomplete:"off",tabindex:"0",role:"combobox"}}),(this.mode==="Default"||this.mode==="Box")&&this.inputElement.setAttribute("aria-describedby",this.chipCollectionWrapper.id),g(this.inputElement)||(Ie(this.inputElement,{"aria-expanded":"false"}),this.inputElement.hasAttribute("aria-label")||this.inputElement.setAttribute("aria-label",this.getModuleName())),this.element.tagName!==this.getNgDirective()&&(this.element.style.display="none"),this.element.tagName===this.getNgDirective()?(this.element.appendChild(this.overAllWrapper),this.searchWrapper.appendChild(this.inputElement)):(this.element.parentElement.insertBefore(this.overAllWrapper,this.element),this.searchWrapper.appendChild(this.inputElement),this.searchWrapper.appendChild(this.element),this.element.removeAttribute("tabindex")),this.floatLabelType!=="Never"?ik(this.overAllWrapper,this.searchWrapper,this.element,this.inputElement,this.value,this.floatLabelType,this.placeholder):this.floatLabelType==="Never"&&this.refreshPlaceHolder(),this.addValidInputClass(),this.element.style.opacity="";var t=this.element.getAttribute("id")?this.element.getAttribute("id"):kt("ej2_dropdownlist");this.element.id=t,this.hiddenElement=this.createElement("select",{attrs:{"aria-hidden":"true",class:C5,tabindex:"-1",multiple:""}}),this.componentWrapper.appendChild(this.hiddenElement),this.validationAttribute(this.element,this.hiddenElement),this.mode!=="CheckBox"&&this.hideOverAllClear(),!g(j(this.element,"fieldset"))&&j(this.element,"fieldset").disabled&&(this.enabled=!1),this.wireEvent(),this.enable(this.enabled),this.enableRTL(this.enableRtl),this.enableVirtualization&&this.updateVirtualizationProperties(this.itemCount,this.allowFiltering,this.mode==="CheckBox"),this.listItemHeight=this.getListHeight(),this.getSkeletonCount(),this.viewPortInfo.startIndex=this.virtualItemStartIndex=0,this.viewPortInfo.endIndex=this.virtualItemEndIndex=this.viewPortInfo.startIndex>0?this.viewPortInfo.endIndex:this.itemCount,this.checkInitialValue(),this.element.hasAttribute("data-val")&&this.element.setAttribute("data-val","false"),Ce.createSpanElement(this.overAllWrapper,this.createElement),this.calculateWidth(),!g(this.overAllWrapper)&&!g(this.overAllWrapper.getElementsByClassName("e-ddl-icon")[0]&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0]&&this.floatLabelType!=="Never")&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0].classList.add("e-icon"),this.renderComplete()},e.prototype.setResize=function(){var t=16;if(this.list&&this.list.parentElement&&g(this.list.parentElement.querySelector(".e-resizer-right.e-icons"))&&(this.resizer=this.createElement("div",{id:this.element.id+"_resize-popup",className:M5})),this.mode==="CheckBox"&&this.showSelectAll&&this.selectAllHeight&&this.selectAllHeight!==0&&(this.storedSelectAllHeight=this.selectAllHeight),this.list&&this.list.parentElement){this.list.parentElement.classList.add("e-resize"),this.popupHeight.toString().toLowerCase()!=="auto"&&(this.list.parentElement.style.height="100%"),this.list.parentElement.style.boxSizing="border-box";var i=this.mode==="CheckBox"&&this.searchBoxHeight?this.searchBoxHeight+t+(this.showSelectAll?this.storedSelectAllHeight:0):t;this.list.parentElement.style.paddingBottom=i+"px",this.list.parentElement.appendChild(this.resizer),this.list.parentElement.style.width=this.resizeWidth+"px",this.list.parentElement.style.height=this.resizeHeight+"px",this.list.parentElement.style.maxHeight=this.resizeHeight+"px",this.list.style.maxHeight=this.resizeHeight+"px"}this.resizer&&(E.add(this.resizer,"mousedown",this.startResizing,this),E.add(this.resizer,"touchstart",this.startResizing,this))},e.prototype.startResizing=function(t){this.isResizing=!0,this.trigger("resizeStart",t);var i=t instanceof MouseEvent?t.clientX:t.touches[0].clientX,r=t instanceof MouseEvent?t.clientY:t.touches[0].clientY;this.list&&this.list.parentElement&&(this.originalWidth=this.list.parentElement.offsetWidth,this.originalHeight=this.list.parentElement.offsetHeight,this.originalMouseX=i,this.originalMouseY=r),this.resizingWireEvent(),t&&t.preventDefault()},e.prototype.resizePopup=function(t){if(this.isResizing){this.trigger("resizing",t);var i=t instanceof MouseEvent?t.clientX:t.touches[0].clientX,r=t instanceof MouseEvent?t.clientY:t.touches[0].clientY,n=i-this.originalMouseX,s=r-this.originalMouseY,a=100,l=130;if(this.resizeWidth=Math.max(this.originalWidth+n,a),this.resizeHeight=Math.max(this.originalHeight+s,l),this.list&&this.list.parentElement){var h=parseInt(window.getComputedStyle(this.list.parentElement).minWidth,10),u=parseInt(window.getComputedStyle(this.list.parentElement).minHeight,10);h=h||100,u=u||120,this.resizeWidth=Math.max(this.originalWidth+n,h),this.resizeHeight=Math.max(this.originalHeight+s,u),this.list.parentElement.style.width=this.resizeWidth+"px",this.list.parentElement.style.height=this.resizeHeight+"px",this.list.parentElement.style.maxHeight=this.resizeHeight+"px",this.list.style.maxHeight=this.resizeHeight+"px",this.fixedHeaderElement&&this.ulElement&&(this.fixedHeaderElement.style.width=this.ulElement.offsetWidth+"px")}t&&t.preventDefault()}},e.prototype.stopResizing=function(t){this.isResizing&&(this.isResizing=!1,this.trigger("resizeStop",t),this.resizingUnWireEvent()),t&&t.preventDefault()},e.prototype.getListHeight=function(){var t=this.createElement("div",{className:"e-dropdownbase"}),i=this.createElement("li",{className:"e-list-item"}),r=Le(this.popupHeight);t.style.height=parseInt(r,10).toString()+"px",t.appendChild(i),document.body.appendChild(t),this.virtualListHeight=t.getBoundingClientRect().height;var n=Math.ceil(i.getBoundingClientRect().height)+parseInt(window.getComputedStyle(i).marginBottom,10);return t.remove(),n},e.prototype.removeDisabledItemsValue=function(t){if(t){for(var i=[],r=0,n=0;n<t.length;n++){var s=t[n];typeof s=="object"&&(s=JSON.parse(JSON.stringify(s))[this.fields.value]),s!=null&&!this.isDisabledItemByIndex(this.getIndexByValue(s))&&(i[r++]=t[n])}this.value=i.length>0?i:null}},e.prototype.checkInitialValue=function(){var t=this;this.fields.disabled&&this.removeDisabledItemsValue(this.value);var i=this.dataSource instanceof Array?this.dataSource.length>0:!g(this.dataSource);if(!(this.value&&this.value.length)&&g(this.text)&&!i&&this.element.tagName==="SELECT"&&this.element.options.length>0){for(var r=this.element.options,n=[],s="",a=0,l=r.length;a<l;a++){var h=r[a];if(!g(h.getAttribute("selected")))if(h.getAttribute("value")){var u=this.allowObjectBinding?this.getDataByValue(h.getAttribute("value")):h.getAttribute("value");n.push(u)}else s+=h.text+this.delimiterChar}n.length>0?this.setProperties({value:n},!0):s!==""&&this.setProperties({text:s},!0),(n.length>0||s!=="")&&(this.refreshInputHight(),this.refreshPlaceHolder())}if((this.value&&this.value.length||!g(this.text))&&(this.list||o.prototype.render.call(this)),this.fields.disabled&&(this.text=this.text&&!this.isDisabledItemByIndex(this.getIndexByValue(this.getValueByText(this.text)))?this.text:null),!g(this.text)&&(g(this.value)||this.value.length===0)&&this.initialTextUpdate(),this.value&&this.value.length){var c;if(this.enableVirtualization){for(var d=this.isPrimitiveData?"":this.fields.value,p=void 0,f=0;f<this.value.length;f++){var u=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[f]):this.value[f];f===0?p=new St(d,"equal",u):p=p.or(d,"equal",u)}this.dataSource instanceof re?this.dataSource.executeQuery(new Pe().where(p)).then(function(v){v.result.length>0&&(c=v.result,t.initStatus=!1,t.isInitRemoteVirtualData=!0,setTimeout(function(){t.initialValueUpdate(c,!0),t.initialUpdate(),t.isInitRemoteVirtualData=!1},100),t.initStatus=!0)}):c=new re(this.dataSource).executeLocal(new Pe().where(p))}this.dataSource instanceof re?this.setInitialValue=function(){t.initStatus=!1,(!t.enableVirtualization||t.enableVirtualization&&!(t.dataSource instanceof re))&&t.initialValueUpdate(c),t.initialUpdate(),t.setInitialValue=null,t.initStatus=!0}:(this.initialValueUpdate(c,!0),this.initialUpdate()),this.updateTempValue()}else this.initialUpdate();this.initStatus=!0,this.checkAutoFocus(),g(this.text)||this.element.setAttribute("data-initial-value",this.text)},e.prototype.checkAutoFocus=function(){this.element.hasAttribute("autofocus")&&this.inputElement.focus()},e.prototype.updatevirtualizationList=function(){if(this.value&&this.value.length){for(var t=void 0,i=0,r=this.value;i<r.length;i++){var n=r[i],s=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",n):n;t=this.getElementByValue(s),t&&this.addListSelection(t)}if(this.enableVirtualization&&this.hideSelectedItem){var a=this.list.querySelectorAll("li."+le.li+":not(."+Si+"):not(.e-reorder-hide):not(.e-virtual-list)");if(a.length){var l=this.virtualListHeight>0?Math.floor(this.virtualListHeight/this.listItemHeight):0;if(a.length<l+2){var h=this.getForQuery(this.value).clone();h=h.skip(this.viewPortInfo.startIndex),this.resetList(this.dataSource,this.fields,h)}}}}},e.prototype.setFloatLabelType=function(){n5(this.overAllWrapper,this.componentWrapper,this.searchWrapper,this.inputElement,this.value,this.floatLabelType,this.placeholder),this.floatLabelType!=="Never"&&ik(this.overAllWrapper,this.searchWrapper,this.element,this.inputElement,this.value,this.floatLabelType,this.placeholder)},e.prototype.addValidInputClass=function(){g(this.overAllWrapper)||(!g(this.value)&&this.value.length||this.floatLabelType==="Always"?Y([this.overAllWrapper],"e-valid-input"):K([this.overAllWrapper],"e-valid-input"))},e.prototype.dropDownIcon=function(){this.showDropDownIcon?(this.dropIcon=this.createElement("span",{className:uk}),this.componentWrapper.appendChild(this.dropIcon),Y([this.componentWrapper],["e-down-icon"])):g(this.dropIcon)||(this.dropIcon.parentElement.removeChild(this.dropIcon),K([this.componentWrapper],["e-down-icon"]))},e.prototype.initialUpdate=function(){this.mode!=="Box"&&!(this.setDynValue&&this.mode==="Default"&&this.inputFocus)&&this.updateDelimView(),this.viewPortInfo.startIndex=this.virtualItemStartIndex=0,this.viewPortInfo.endIndex=this.virtualItemEndIndex=this.itemCount,this.updateCssClass(),this.updateHTMLAttribute(),this.updateReadonly(this.readonly),this.refreshInputHight(),this.checkPlaceholderSize()},e.prototype.disableItem=function(t){if(this.fields.disabled){this.list||this.renderList();var i=-1;if(this.liCollections&&this.liCollections.length>0&&this.listData&&this.fields.disabled){if(typeof t=="string")i=this.getIndexByValue(t);else if(typeof t=="object"){if(t instanceof HTMLLIElement){for(var r=0;r<this.liCollections.length;r++)if(this.liCollections[r]===t){i=this.getIndexByValue(t.getAttribute("data-value"));break}}else for(var n=JSON.parse(JSON.stringify(t))[this.fields.value],r=0;r<this.listData.length;r++)if(JSON.parse(JSON.stringify(this.listData[r]))[this.fields.value]===n){i=this.getIndexByValue(n);break}}else i=t;var s=i<this.liCollections.length&&i>-1;if(s&&!JSON.parse(JSON.stringify(this.listData[i]))[this.fields.disabled]){var a=this.liCollections[i];if(a){this.disableListItem(a);var l=JSON.parse(JSON.stringify(this.listData[i]));if(l[this.fields.disabled]=!0,this.listData[i]=l,a.classList.contains(le.focus)&&this.removeFocus(),a.classList.contains(Si)||a.classList.contains(le.selected)){var h=this.value;this.removeDisabledItemsValue(this.value),this.updateVal(this.value,h,"value")}this.mode==="CheckBox"&&this.enableGroupCheckBox&&!g(this.fields.groupBy)&&this.disableGroupHeader()}}}}},e.prototype.destroy=function(){this.isReact&&this.clearTemplate(),g(this.popupObj)||(this.popupObj.hide(),this.popupObj.destroy()),this.notify(w5,{}),this.unwireListEvents(),this.unWireEvent();var t=["readonly","aria-disabled","placeholder","aria-label","aria-expanded"],i=t.length;if(!g(this.inputElement))for(;i>0;)this.inputElement.removeAttribute(t[i-1]),i--;for(g(this.element)||(this.element.removeAttribute("data-initial-value"),this.element.style.display="block"),this.overAllWrapper&&this.overAllWrapper.parentElement&&(this.overAllWrapper.parentElement.tagName===this.getNgDirective()?Ue(this.overAllWrapper):(this.overAllWrapper.parentElement.insertBefore(this.element,this.overAllWrapper),Ue(this.overAllWrapper))),this.popupWrapper&&this.popupWrapper.parentElement&&this.popupWrapper.parentElement.remove();this.searchWrapper&&this.searchWrapper.firstChild;)this.searchWrapper.removeChild(this.searchWrapper.firstChild);this.searchWrapper&&this.searchWrapper.parentElement&&this.searchWrapper.parentElement.remove(),this.viewWrapper&&this.viewWrapper.parentElement&&this.viewWrapper.parentElement.remove(),this.overAllClear&&this.overAllClear.parentElement&&this.overAllClear.parentElement.remove(),this.delimiterWrapper&&this.delimiterWrapper.parentElement&&this.delimiterWrapper.parentElement.remove();var r=this.overAllWrapper.querySelector("select.e-multi-hidden");for(r&&r.parentElement&&r.parentElement.remove();this.componentWrapper&&this.componentWrapper.firstChild;)this.componentWrapper.removeChild(this.componentWrapper.firstChild);for(this.componentWrapper&&this.componentWrapper.parentElement&&(this.componentWrapper.removeAttribute("class"),this.componentWrapper.parentElement.remove());this.popupWrapper&&this.popupWrapper.firstChild;)this.popupWrapper.removeChild(this.popupWrapper.firstChild);if(this.inputElement)for(var n=["readonly","aria-disabled","placeholder","aria-labelledby","aria-expanded","autocomplete","aria-readonly","autocapitalize","spellcheck","aria-autocomplete","aria-live","aria-label","aria-hidden","tabindex","aria-controls","aria-describedby","size","role","type","class"],s=0;s<n.length;s++)this.inputElement.removeAttribute(n[s]);this.inputElement&&this.inputElement.remove(),this.list=null,this.popupObj=null,this.mainData=null,this.filterParent=null,this.ulElement=null,this.componentWrapper=null,this.overAllClear=null,this.overAllWrapper=null,this.hiddenElement=null,this.searchWrapper=null,this.viewWrapper=null,this.chipCollectionWrapper=null,this.targetInputElement=null,this.popupWrapper=null,this.inputElement=null,this.delimiterWrapper=null,this.liCollections=null,this.popupContentElement=null,this.header=null,this.mainList=null,this.mainListCollection=null,this.footer=null,this.selectAllEventEle=null,o.prototype.destroy.call(this)},rt([be({text:null,value:null,iconCss:null,groupBy:null,disabled:null},Aw)],e.prototype,"fields",void 0),rt([C(!1)],e.prototype,"enablePersistence",void 0),rt([C(null)],e.prototype,"groupTemplate",void 0),rt([C("No records found")],e.prototype,"noRecordsTemplate",void 0),rt([C("Request failed")],e.prototype,"actionFailureTemplate",void 0),rt([C("None")],e.prototype,"sortOrder",void 0),rt([C(!0)],e.prototype,"enabled",void 0),rt([C(!0)],e.prototype,"enableHtmlSanitizer",void 0),rt([C(!1)],e.prototype,"enableVirtualization",void 0),rt([C([])],e.prototype,"dataSource",void 0),rt([C(null)],e.prototype,"query",void 0),rt([C("StartsWith")],e.prototype,"filterType",void 0),rt([C(1e3)],e.prototype,"zIndex",void 0),rt([C(!1)],e.prototype,"ignoreAccent",void 0),rt([C()],e.prototype,"locale",void 0),rt([C(!1)],e.prototype,"enableGroupCheckBox",void 0),rt([C(null)],e.prototype,"cssClass",void 0),rt([C("100%")],e.prototype,"width",void 0),rt([C("300px")],e.prototype,"popupHeight",void 0),rt([C("100%")],e.prototype,"popupWidth",void 0),rt([C(null)],e.prototype,"placeholder",void 0),rt([C(null)],e.prototype,"filterBarPlaceholder",void 0),rt([C({})],e.prototype,"htmlAttributes",void 0),rt([C(null)],e.prototype,"valueTemplate",void 0),rt([C(null)],e.prototype,"headerTemplate",void 0),rt([C(null)],e.prototype,"footerTemplate",void 0),rt([C(null)],e.prototype,"itemTemplate",void 0),rt([C(null)],e.prototype,"allowFiltering",void 0),rt([C(!0)],e.prototype,"isDeviceFullScreen",void 0),rt([C(!0)],e.prototype,"changeOnBlur",void 0),rt([C(!1)],e.prototype,"allowCustomValue",void 0),rt([C(!0)],e.prototype,"showClearButton",void 0),rt([C(1e3)],e.prototype,"maximumSelectionLength",void 0),rt([C(!1)],e.prototype,"readonly",void 0),rt([C(!1)],e.prototype,"allowResize",void 0),rt([C(null)],e.prototype,"text",void 0),rt([C(null)],e.prototype,"value",void 0),rt([C(!1)],e.prototype,"allowObjectBinding",void 0),rt([C(!0)],e.prototype,"hideSelectedItem",void 0),rt([C(!0)],e.prototype,"closePopupOnSelect",void 0),rt([C("Default")],e.prototype,"mode",void 0),rt([C(",")],e.prototype,"delimiterChar",void 0),rt([C(!0)],e.prototype,"ignoreCase",void 0),rt([C(!1)],e.prototype,"showDropDownIcon",void 0),rt([C("Never")],e.prototype,"floatLabelType",void 0),rt([C(!1)],e.prototype,"showSelectAll",void 0),rt([C("Select All")],e.prototype,"selectAllText",void 0),rt([C("Unselect All")],e.prototype,"unSelectAllText",void 0),rt([C(!0)],e.prototype,"enableSelectionOrder",void 0),rt([C(!0)],e.prototype,"openOnClick",void 0),rt([C(!1)],e.prototype,"addTagOnBlur",void 0),rt([q()],e.prototype,"change",void 0),rt([q()],e.prototype,"removing",void 0),rt([q()],e.prototype,"removed",void 0),rt([q()],e.prototype,"beforeSelectAll",void 0),rt([q()],e.prototype,"selectedAll",void 0),rt([q()],e.prototype,"beforeOpen",void 0),rt([q()],e.prototype,"open",void 0),rt([q()],e.prototype,"close",void 0),rt([q()],e.prototype,"blur",void 0),rt([q()],e.prototype,"focus",void 0),rt([q()],e.prototype,"chipSelection",void 0),rt([q()],e.prototype,"resizeStop",void 0),rt([q()],e.prototype,"resizing",void 0),rt([q()],e.prototype,"resizeStart",void 0),rt([q()],e.prototype,"filtering",void 0),rt([q()],e.prototype,"tagging",void 0),rt([q()],e.prototype,"customValueSelection",void 0),e=rt([bt],e),e}(bk),D5="e-icons",om="e-frame",zh="e-check",pk="e-checkbox-wrapper",Gp="e-stop",E5="e-selectall-parent",A5="e-input-group-icon e-back-icon e-icons",fk="e-input-group-icon e-clear-icon e-icons",T5="e-input-filter",L5="e-filter-parent",k5="e-ddl-device-filter",Mw="e-clear-icon",gk="e-popup-full-page",N5="e-ddl-device",vk="e-input-focus",pm=function(){function o(e){this.activeLi=[],this.activeEle=[],this.parent=e,this.removeEventListener(),this.addEventListener()}return o.prototype.getModuleName=function(){return"CheckBoxSelection"},o.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on("updatelist",this.listSelection,this),this.parent.on("listoption",this.listOption,this),this.parent.on("selectAll",this.setSelectAll,this),this.parent.on("checkSelectAll",this.checkSelectAll,this),this.parent.on("searchBox",this.setSearchBox,this),this.parent.on("blur",this.onBlurHandler,this),this.parent.on("targetElement",this.targetElement,this),this.parent.on("deviceSearchBox",this.setDeviceSearchBox,this),this.parent.on("inputFocus",this.getFocus,this),this.parent.on("reOrder",this.setReorder,this),this.parent.on("activeList",this.getActiveList,this),this.parent.on("selectAllText",this.setLocale,this),this.parent.on("filterBarPlaceholder",this.setPlaceholder,this),E.add(document,"mousedown",this.onDocumentClick,this),this.parent.on("addItem",this.checboxCreate,this),this.parent.on("popupFullScreen",this.setPopupFullScreen,this))},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("updatelist",this.listSelection),this.parent.off("listoption",this.listOption),this.parent.off("selectAll",this.setSelectAll),this.parent.off("checkSelectAll",this.checkSelectAll),this.parent.off("searchBox",this.setSearchBox),this.parent.off("blur",this.onBlurHandler),this.parent.off("targetElement",this.targetElement),this.parent.off("deviceSearchBox",this.setDeviceSearchBox),this.parent.off("inputFocus",this.getFocus),this.parent.off("reOrder",this.setReorder),this.parent.off("activeList",this.getActiveList),this.parent.off("selectAllText",this.setLocale),this.parent.off("filterBarPlaceholder",this.setPlaceholder),this.parent.off("addItem",this.checboxCreate),this.parent.off("popupFullScreen",this.setPopupFullScreen))},o.prototype.listOption=function(e){var t=this;if(g(this.parent.listCurrentOptions.itemCreated))this.parent.listCurrentOptions.itemCreated=function(r){t.checboxCreate(r)};else{var i=this.parent.listCurrentOptions.itemCreated;this.parent.listCurrentOptions.itemCreated=function(r){t.checboxCreate(r),i.apply(t,[r])}}},o.prototype.setPlaceholder=function(e){Ce.setPlaceholder(e.filterBarPlaceholder,this.filterInput)},o.prototype.checboxCreate=function(e){var t;if(g(e.item)?t=e:t=e.item,this.parent.enableGroupCheckBox||t.className!=="e-list-group-item "&&t.className!=="e-list-group-item"){var i=Uo(this.parent.createElement,!0),r=X("div."+D5,t);return t.insertBefore(i,t.childNodes[g(r)?0:1]),X("."+om,i),this.parent.enableGroupCheckBox&&this.parent.popupWrapper.classList.add("e-multiselect-group"),t}else return t},o.prototype.setSelectAll=function(){this.parent.showSelectAll?(g(this.checkAllParent)&&(this.checkAllParent=this.parent.createElement("div",{className:E5}),this.selectAllSpan=this.parent.createElement("span",{className:"e-all-text"}),this.selectAllSpan.textContent="",this.checkAllParent.appendChild(this.selectAllSpan),this.setLocale(),this.checboxCreate(this.checkAllParent),this.parent.headerTemplate&&(g(this.parent.filterParent)?dt([this.checkAllParent],this.parent.popupWrapper):dt([this.checkAllParent],this.parent.filterParent)),this.parent.headerTemplate||(g(this.parent.filterParent)?jr([this.checkAllParent],this.parent.popupWrapper):this.parent.filterParent.parentNode.insertBefore(this.checkAllParent,this.parent.filterParent.nextSibling)),E.add(this.checkAllParent,"mousedown",this.clickHandler,this)),this.parent.list.classList.contains("e-nodata")||this.parent.listData&&this.parent.listData.length<=1&&!this.parent.enableVirtualization&&!this.parent.isDynamicDataChange||this.parent.isDynamicDataChange&&this.parent.listData&&this.parent.listData.length<=1?this.checkAllParent.style.display="none":this.checkAllParent.style.display="block",this.parent.selectAllHeight=this.checkAllParent.getBoundingClientRect().height):g(this.checkAllParent)||(this.checkAllParent.parentElement.removeChild(this.checkAllParent),this.checkAllParent=null)},o.prototype.destroy=function(){this.removeEventListener(),E.remove(document,"mousedown",this.onDocumentClick),this.checkAllParent=null,this.clearIconElement=null,this.filterInput=null,this.filterInputObj=null,this.checkWrapper=null,this.selectAllSpan=null},o.prototype.listSelection=function(e){var t;if(g(e.e)){var r=e.li.querySelector(".e-checkbox-wrapper");t=r?r.childNodes[1]:e.li.lastElementChild.childNodes[1]}else{var i=e.li.querySelector(".e-checkbox-wrapper .e-frame");t=g(e.e.target)?e.li.querySelector(".e-checkbox-wrapper").childNodes[1]:e.e.target.classList.contains("e-frame")&&(!this.parent.showSelectAll||this.checkAllParent&&!this.checkAllParent.contains(e.e.target))?e.e.target:e.li.querySelector(".e-checkbox-wrapper").childNodes[1]}if((this.parent.itemTemplate||this.parent.enableGroupCheckBox)&&(t=e.li.firstElementChild.childNodes[1]),g(t)||(this.checkWrapper=j(t,"."+pk)),!g(this.checkWrapper)){var n=X("."+om,this.checkWrapper),s=!1;this.validateCheckNode(this.checkWrapper,n.classList.contains(zh),e.li,e.e,s)}},o.prototype.validateCheckNode=function(e,t,i,r,n){this.changeState(e,t?"uncheck":"check",r,!0,n)},o.prototype.clickHandler=function(e){var t;e.currentTarget.classList.contains(this.checkAllParent.className)||e.currentTarget.classList.value===this.checkAllParent.className?t=e.currentTarget.firstElementChild.lastElementChild:t=e.currentTarget,this.checkWrapper=j(t,"."+pk);var i=!0;if(!g(this.checkWrapper)){var r=X("."+om,this.checkWrapper);this.validateCheckNode(this.checkWrapper,r.classList.contains(zh),null,e,i)}e.preventDefault()},o.prototype.changeState=function(e,t,i,r,n){var s=e.getElementsByClassName(om)[0];t==="check"&&!s.classList.contains(zh)?(s.classList.remove(Gp),s.classList.add(zh),n&&(this.parent.selectAllItems(!0,i),this.setLocale(!0))):t==="uncheck"&&(s.classList.contains(zh)||s.classList.contains(Gp))?(K([s],[zh,Gp]),n&&(this.parent.selectAllItems(!1,i),this.setLocale())):t==="indeterminate"&&!s.classList.contains(Gp)&&(K([s],[zh]),s.classList.add(Gp),n&&(this.parent.selectAllItems(!1,i),this.setLocale()))},o.prototype.setSearchBox=function(e){if(g(this.parent.filterParent)){this.parent.filterParent=this.parent.createElement("span",{className:L5}),this.filterInput=this.parent.createElement("input",{attrs:{type:"text"},className:T5}),this.parent.element.parentNode.insertBefore(this.filterInput,this.parent.element);var t=!1;return B.isDevice&&this.parent.isDeviceFullScreen&&(t=!0,this.parent.mobFilter=!1),this.filterInputObj=Ce.createInput({element:this.filterInput,buttons:t?[A5,fk]:[fk],properties:{placeholder:this.parent.filterBarPlaceholder}},this.parent.createElement),g(this.parent.cssClass)||(this.parent.cssClass.split(" ").indexOf("e-outline")!==-1?Y([this.filterInputObj.container],"e-outline"):this.parent.cssClass.split(" ").indexOf("e-filled")!==-1&&Y([this.filterInputObj.container],"e-filled")),dt([this.filterInputObj.container],this.parent.filterParent),jr([this.parent.filterParent],e.popupElement),Ie(this.filterInput,{"aria-disabled":"false",role:"combobox",autocomplete:"off",autocapitalize:"off",spellcheck:"false","aria-label":"multiselect","aria-expanded":"true","aria-controls":e.popupElement.id}),this.clearIconElement=this.filterInput.parentElement.querySelector("."+Mw),!B.isDevice&&this.clearIconElement&&(E.add(this.clearIconElement,"mousedown",this.clearText,this),this.clearIconElement.style.visibility="hidden"),E.add(this.filterInput,"input",this.parent.onInput,this.parent),E.add(this.filterInput,"keyup",this.parent.keyUp,this.parent),E.add(this.filterInput,"keydown",this.parent.onKeyDown,this.parent),E.add(this.filterInput,"blur",this.onBlurHandler,this),E.add(this.filterInput,"paste",this.parent.pasteHandler,this.parent),this.parent.searchBoxHeight=this.filterInputObj.container.parentElement.getBoundingClientRect().height,this.filterInputObj}},o.prototype.clickOnBackIcon=function(e){this.parent.hidePopup(),K([document.body,this.parent.popupObj.element],gk),this.parent.inputElement.focus()},o.prototype.clearText=function(e){this.parent.targetInputElement.value="",this.parent.allowFiltering&&this.parent.targetInputElement.value===""&&this.parent.search(null),this.parent.refreshListItems(null),this.parent.refreshPopup(),this.clearIconElement.style.visibility="hidden",this.filterInput.focus(),(!this.parent.enableVirtualization||this.parent.enableVirtualization&&(g(this.parent.value)||this.parent.value&&this.parent.value.length===0))&&this.setReorder(e),this.boundPreventListSelection=this.preventListSelection.bind(this),this.parent.popupWrapper.addEventListener("mouseup",this.boundPreventListSelection,!0),e.preventDefault()},o.prototype.preventListSelection=function(e){e.stopPropagation(),this.parent.popupWrapper.removeEventListener("mouseup",this.boundPreventListSelection,!0),this.boundPreventListSelection=null},o.prototype.setDeviceSearchBox=function(){this.parent.popupObj.element.classList.add(N5),this.parent.popupObj.element.classList.add(k5),this.parent.popupObj.position={X:0,Y:0},this.parent.popupObj.dataBind(),this.setSearchBoxPosition(),this.backIconElement=this.filterInputObj.container.querySelector(".e-back-icon"),this.clearIconElement=this.filterInputObj.container.querySelector("."+Mw),this.clearIconElement.style.visibility="hidden",E.add(this.backIconElement,"click",this.clickOnBackIcon,this),E.add(this.clearIconElement,"click",this.clearText,this)},o.prototype.setSearchBoxPosition=function(){var e=this.filterInput.parentElement.getBoundingClientRect().height,t=0,i=0,r=0;this.checkAllParent&&(t=this.checkAllParent.getBoundingClientRect().height),this.parent.header&&(r=this.parent.header.getBoundingClientRect().height),this.parent.footer&&(i=this.parent.footer.getBoundingClientRect().height),this.parent.popupObj.element.style.maxHeight="100%",this.parent.popupObj.element.style.width="100%",this.parent.list.style.maxHeight=window.innerHeight-e-t-r-i+"px",this.parent.list.style.height=window.innerHeight-e-t-r-i+"px";var n=this.filterInput.parentElement.querySelector("."+Mw);ee(this.filterInput),n.parentElement.insertBefore(this.filterInput,n)},o.prototype.setPopupFullScreen=function(){this.parent&&this.parent.popupObj&&(Ie(this.parent.popupObj.element,{style:"left:0px;right:0px;top:0px;bottom:0px;"}),Y([document.body,this.parent.popupObj.element],gk),this.parent.popupObj.element.style.maxHeight="100%",this.parent.popupObj.element.style.width="100%")},o.prototype.targetElement=function(){return g(this.clearIconElement)||(this.parent.targetInputElement=this.filterInput,this.clearIconElement.style.visibility=this.parent.targetInputElement.value===""?"hidden":"visible"),this.parent.targetInputElement.value},o.prototype.onBlurHandler=function(e){if(!this.parent.element.classList.contains("e-listbox")){var t=void 0;if(this.parent.keyAction)return;if(B.isIE&&(t=!g(e)&&e.target),B.isIE||(t=!g(e)&&e.relatedTarget),this.parent.popupObj&&document.body.contains(this.parent.popupObj.element)&&this.parent.popupObj.element.contains(t)&&!B.isIE&&this.filterInput){this.filterInput.focus();return}if(this.parent.scrollFocusStatus&&this.filterInput){e.preventDefault(),this.filterInput.focus(),this.parent.scrollFocusStatus=!1;return}this.parent.popupObj&&document.body.contains(this.parent.popupObj.element)&&!this.parent.popupObj.element.classList.contains("e-popup-close")&&(this.parent.inputFocus=!1,this.parent.updateValueState(e,this.parent.value,this.parent.tempValues),this.parent.dispatchEvent(this.parent.hiddenElement,"change")),this.parent.popupObj&&document.body.contains(this.parent.popupObj.element)&&!this.parent.popupObj.element.classList.contains("e-popup-close")&&(this.parent.inputFocus=!1,this.parent.overAllWrapper.classList.remove(vk),this.parent.trigger("blur"),this.parent.focused=!0),this.parent.popupObj&&document.body.contains(this.parent.popupObj.element)&&!this.parent.popupObj.element.classList.contains("e-popup-close")&&!B.isDevice&&this.parent.hidePopup()}},o.prototype.onDocumentClick=function(e){if(this.parent.getLocaleName()!=="listbox"){var t=e.target;!g(this.parent.popupObj)&&j(t,'[id="'+this.parent.popupObj.element.id+'"]')&&(this.filterInput&&this.filterInput.value!==""||e.preventDefault()),!(!g(this.parent.popupObj)&&j(t,'[id="'+this.parent.popupObj.element.id+'"]'))&&!g(this.parent.overAllWrapper)&&!this.parent.overAllWrapper.contains(e.target)?(this.parent.overAllWrapper.classList.contains(le.focus)||this.parent.isPopupOpen())&&(this.parent.inputFocus=!1,this.parent.scrollFocusStatus=!1,this.parent.hidePopup(),this.parent.onBlurHandler(e,!0),this.parent.focused=!0):this.parent.scrollFocusStatus=(B.isIE||B.info.name==="edge")&&document.activeElement===this.filterInput,!g(this.parent.overAllWrapper)&&!this.parent.overAllWrapper.contains(e.target)&&this.parent.overAllWrapper.classList.contains("e-input-focus")&&!this.parent.isPopupOpen()&&(B.isIE?this.parent.onBlurHandler():this.parent.onBlurHandler(e)),this.filterInput===t&&this.filterInput.focus()}},o.prototype.getFocus=function(e){if(this.parent.overAllWrapper.classList.remove(vk),this.parent.keyAction&&e.value!=="clear"&&e.value!=="focus"){this.parent.keyAction=!1;return}e.value==="focus"&&(this.filterInput.focus(),this.parent.removeFocus(),E.remove(this.parent.list,"keydown",this.parent.onKeyDown)),e.value==="clear"&&(this.filterInput.value="",this.clearIconElement.style.visibility="hidden")},o.prototype.checkSelectAll=function(e){e.value==="check"&&(this.changeState(this.checkAllParent,e.value,null,null,!1),this.setLocale(!0)),e.value==="uncheck"&&(this.changeState(this.checkAllParent,e.value,null,null,!1),this.setLocale()),e.value==="indeterminate"&&(this.changeState(this.checkAllParent,e.value,null,null,!1),this.setLocale())},o.prototype.setLocale=function(e){if(this.parent.selectAllText!=="Select All"||this.parent.unSelectAllText!=="Unselect All"){var t=e?this.parent.unSelectAllText:this.parent.selectAllText;this.selectAllSpan.textContent="";for(var i=wt(t),r=e?"unSelectAllText":"selectAllText",n=0,s=i({},this.parent,r,null,!this.parent.isStringTemplate);n<s.length;n++){var a=s[n];this.selectAllSpan.textContent=a.textContent}}else{var l={selectAllText:"Select All",unSelectAllText:"Unselect All"},h=new Li(this.parent.getLocaleName(),{},this.parent.locale);h.getConstant("selectAllText")===""&&(h=new Li("dropdowns",l,this.parent.locale)),g(this.selectAllSpan)||(this.selectAllSpan.textContent=e?h.getConstant("unSelectAllText"):h.getConstant("selectAllText"))}},o.prototype.getActiveList=function(e){e.li.classList.contains("e-active")?this.activeLi.push(e.li.cloneNode(!0)):this.activeLi.splice(e.index,1)},o.prototype.setReorder=function(e){if(this.parent.enableSelectionOrder&&!g(this.parent.value)){var t=this.parent.ulElement.querySelectorAll("li.e-active").length,i=void 0,r=this.parent.createElement("ul",{className:"e-list-parent e-ul e-reorder"});if(t>0){var n=this.parent.ulElement.querySelectorAll("li.e-active");if(n.forEach(function(a){r.appendChild(a)}),i=this.parent.ulElement.querySelectorAll("li.e-active"),Y(i,"e-reorder-hide"),this.parent.enableVirtualization){var s=this.parent.list.querySelector(".e-virtual-ddl-content");jr([r],s)}else jr([r],this.parent.list)}this.parent.focusAtFirstListItem()}},o}();var jk=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),mr=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},oa="e-other-month",Tw="e-other-year",Qp="e-calendar",Sk="e-device",F5="e-header",Ck="e-rtl",O5="e-content",R5="e-calendar-content-table",Lw="e-year",kw="e-month",wk="e-decade",xk="e-icons",P5="e-prev",B5="e-next",z5="e-date-icon-prev",j5="e-date-icon-next ",H5="e-icon-container",tr="e-disabled",Ul="e-overlay",V5="e-weekend",Xp="e-week-number",Cn="e-selected",Is="e-focused-date",Hh="e-focused-cell",fm="e-month-hide",Ik="e-today",_5="e-title",Mk="e-day",Dk="e-cell",U5="e-week-header",gm="e-zoomin",W5="e-footer-container",q5="e-btn",G5="e-flat",Y5="e-css",Q5="e-primary",Ek="e-calendar-day-header-lg",Nw=864e5,X5=6e4,$5=function(o){jk(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.effect="",r.isPopupClicked=!1,r.isDateSelected=!0,r.isTodayClicked=!1,r.preventChange=!1,r.previousDates=!1,r}return e.prototype.render=function(){this.rangeValidation(this.min,this.max),this.calendarEleCopy=this.element.cloneNode(!0),this.calendarMode==="Islamic"&&(+this.min.setSeconds(0)==+new Date(1900,0,1,0,0,0)&&(this.min=new Date(1944,2,18)),+this.max==+new Date(2099,11,31)&&(this.max=new Date(2069,10,16))),this.globalize=new Et(this.locale),(g(this.firstDayOfWeek)||this.firstDayOfWeek>6||this.firstDayOfWeek<0)&&this.setProperties({firstDayOfWeek:this.globalize.getFirstDayOfWeek()},!0),this.todayDisabled=!1,this.todayDate=new Date(new Date().setHours(0,0,0,0)),this.getModuleName()==="calendar"?(this.element.classList.add(Qp),this.enableRtl&&this.element.classList.add(Ck),B.isDevice&&this.element.classList.add(Sk),Ie(this.element,{"data-role":"calendar"}),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.setAttribute("tabindex",this.tabIndex)):(this.calendarElement=this.createElement("div"),this.calendarElement.classList.add(Qp),this.enableRtl&&this.calendarElement.classList.add(Ck),B.isDevice&&this.calendarElement.classList.add(Sk),Ie(this.calendarElement,{"data-role":"calendar"})),!g(j(this.element,"fieldset"))&&j(this.element,"fieldset").disabled&&(this.enabled=!1),this.createHeader(),this.createContent(),this.wireEvents()},e.prototype.rangeValidation=function(t,i){g(t)&&this.setProperties({min:new Date(1900,0,1)},!0),g(i)&&this.setProperties({max:new Date(2099,11,31)},!0)},e.prototype.getDefaultKeyConfig=function(){return this.defaultKeyConfigs={controlUp:"ctrl+38",controlDown:"ctrl+40",moveDown:"downarrow",moveUp:"uparrow",moveLeft:"leftarrow",moveRight:"rightarrow",select:"enter",home:"home",end:"end",pageUp:"pageup",pageDown:"pagedown",shiftPageUp:"shift+pageup",shiftPageDown:"shift+pagedown",controlHome:"ctrl+home",controlEnd:"ctrl+end",altUpArrow:"alt+uparrow",spacebar:"space",altRightArrow:"alt+rightarrow",altLeftArrow:"alt+leftarrow"},this.defaultKeyConfigs},e.prototype.validateDate=function(t){this.setProperties({min:this.checkDateValue(new Date(this.checkValue(this.min)))},!0),this.setProperties({max:this.checkDateValue(new Date(this.checkValue(this.max)))},!0),this.currentDate=this.currentDate?this.currentDate:new Date(new Date().setHours(0,0,0,0)),!g(t)&&this.min<=this.max&&t>=this.min&&t<=this.max&&(this.currentDate=new Date(this.checkValue(t)))},e.prototype.setOverlayIndex=function(t,i,r,n){if(n&&!g(i)&&!g(r)&&!g(t)){var s=parseInt(i.style.zIndex,10)?parseInt(i.style.zIndex,10):1e3;r.style.zIndex=(s-1).toString(),t.style.zIndex=s.toString()}},e.prototype.minMaxUpdate=function(t){+this.min<=+this.max?K([this.element],Ul):(this.setProperties({min:this.min},!0),Y([this.element],Ul)),this.min=g(this.min)||!+this.min?this.min=new Date(1900,0,1):this.min,this.max=g(this.max)||!+this.max?this.max=new Date(2099,11,31):this.max,+this.min<=+this.max&&t&&+t<=+this.max&&+t>=+this.min?this.currentDate=new Date(this.checkValue(t)):+this.min<=+this.max&&!t&&+this.currentDate>+this.max?this.currentDate=new Date(this.checkValue(this.max)):+this.currentDate<+this.min&&(this.currentDate=new Date(this.checkValue(this.min)))},e.prototype.createHeader=function(){var t={"aria-disabled":"false","aria-label":"previous month"},i={"aria-disabled":"false","aria-label":"next month"},r={"aria-atomic":"true","aria-live":"assertive","aria-label":"title"},n={tabindex:"0"};this.headerElement=this.createElement("div",{className:F5});var s=this.createElement("div",{className:H5});this.previousIcon=this.createElement("button",{className:""+P5,attrs:{type:"button"}}),Vi(this.previousIcon,{duration:400,selector:".e-prev",isCenterRipple:!0}),Ie(this.previousIcon,t),Ie(this.previousIcon,n),this.nextIcon=this.createElement("button",{className:""+B5,attrs:{type:"button"}}),Vi(this.nextIcon,{selector:".e-next",duration:400,isCenterRipple:!0}),this.getModuleName()==="daterangepicker"&&(Ie(this.previousIcon,{tabIndex:"-1"}),Ie(this.nextIcon,{tabIndex:"-1"})),Ie(this.nextIcon,i),Ie(this.nextIcon,n),this.headerTitleElement=this.createElement("div",{className:""+Mk+" "+_5}),Ie(this.headerTitleElement,r),Ie(this.headerTitleElement,n),this.headerElement.appendChild(this.headerTitleElement),this.previousIcon.appendChild(this.createElement("span",{className:""+z5+" "+xk})),this.nextIcon.appendChild(this.createElement("span",{className:""+j5+" "+xk})),s.appendChild(this.previousIcon),s.appendChild(this.nextIcon),this.headerElement.appendChild(s),this.getModuleName()==="calendar"?this.element.appendChild(this.headerElement):this.calendarElement.appendChild(this.headerElement),this.adjustLongHeaderSize()},e.prototype.createContent=function(){this.contentElement=this.createElement("div",{className:O5}),this.table=this.createElement("table",{attrs:{class:R5,tabIndex:"0",role:"grid","aria-activedescendant":"","aria-labelledby":this.element.id}}),this.getModuleName()==="calendar"?this.element.appendChild(this.contentElement):this.calendarElement.appendChild(this.contentElement),this.contentElement.appendChild(this.table),this.createContentHeader(),this.createContentBody(),this.showTodayButton&&this.createContentFooter(),this.getModuleName()!=="daterangepicker"&&(E.add(this.table,"focus",this.addContentFocus,this),E.add(this.table,"blur",this.removeContentFocus,this))},e.prototype.addContentFocus=function(t){var i=this.tableBodyElement.querySelector("tr td.e-focused-date"),r=this.tableBodyElement.querySelector("tr td.e-selected");g(r)?g(i)||i.classList.add(Hh):r.classList.add(Hh)},e.prototype.removeContentFocus=function(t){var i=g(this.tableBodyElement)?null:this.tableBodyElement.querySelector("tr td.e-focused-date"),r=g(this.tableBodyElement)?null:this.tableBodyElement.querySelector("tr td.e-selected");g(r)?g(i)||i.classList.remove(Hh):r.classList.remove(Hh)},e.prototype.getCultureValues=function(){var t=[],i,r=g(this.dayHeaderFormat)?null:"days.stand-alone."+this.dayHeaderFormat.toLowerCase();if((this.locale==="en"||this.locale==="en-US")&&!g(r)?i=V(r,Vg()):i=this.getCultureObjects(zr,""+this.locale),!g(i))for(var n=0,s=Object.keys(i);n<s.length;n++){var a=s[n];t.push(V(a,i))}return t},e.prototype.toCapitalize=function(t){return!g(t)&&t.length?t[0].toUpperCase()+t.slice(1):t},e.prototype.createContentHeader=function(){this.getModuleName()==="calendar"?g(this.element.querySelectorAll(".e-content .e-week-header")[0])||ee(this.element.querySelectorAll(".e-content .e-week-header")[0]):g(this.calendarElement.querySelectorAll(".e-content .e-week-header")[0])||ee(this.calendarElement.querySelectorAll(".e-content .e-week-header")[0]);var t=6,i="";(this.firstDayOfWeek>6||this.firstDayOfWeek<0)&&this.setProperties({firstDayOfWeek:0},!0),this.tableHeadElement=this.createElement("thead",{className:U5}),this.weekNumber&&(i+='<th class="e-week-number" aria-hidden="true"></th>',this.getModuleName()==="calendar"?Y([this.element],""+Xp):Y([this.calendarElement],""+Xp));var r=this.getCultureValues().length>0&&this.getCultureValues()?this.shiftArray(this.getCultureValues().length>0&&this.getCultureValues(),this.firstDayOfWeek):null;if(!g(r))for(var n=0;n<=t;n++)i+='<th  class="">'+this.toCapitalize(r[n])+"</th>";i="<tr>"+i+"</tr>",this.tableHeadElement.innerHTML=i,this.table.appendChild(this.tableHeadElement)},e.prototype.createContentBody=function(){switch(this.getModuleName()==="calendar"?g(this.element.querySelectorAll(".e-content tbody")[0])||ee(this.element.querySelectorAll(".e-content tbody")[0]):g(this.calendarElement.querySelectorAll(".e-content tbody")[0])||ee(this.calendarElement.querySelectorAll(".e-content tbody")[0]),this.start){case"Year":this.renderYears();break;case"Decade":this.renderDecades();break;default:this.renderMonths()}},e.prototype.updateFooter=function(){this.todayElement.textContent=this.l10.getConstant("today"),this.todayElement.setAttribute("aria-label",this.l10.getConstant("today")),this.todayElement.setAttribute("tabindex","0")},e.prototype.createContentFooter=function(){if(this.showTodayButton){var t=new Date(+this.min),i=new Date(+this.max),r={today:"Today"};this.globalize=new Et(this.locale),this.l10=new Li(this.getModuleName(),r,this.locale),this.todayElement=this.createElement("button",{attrs:{role:"button"}}),Vi(this.todayElement),this.updateFooter(),Y([this.todayElement],[q5,Ik,G5,Q5,Y5]),(!(+new Date(t.setHours(0,0,0,0))<=+this.todayDate&&+this.todayDate<=+new Date(i.setHours(0,0,0,0)))||this.todayDisabled)&&Y([this.todayElement],tr),this.footer=this.createElement("div",{className:W5}),this.footer.appendChild(this.todayElement),this.getModuleName()==="calendar"&&this.element.appendChild(this.footer),this.getModuleName()==="datepicker"&&this.calendarElement.appendChild(this.footer),this.getModuleName()==="datetimepicker"&&this.calendarElement.appendChild(this.footer),this.todayElement.classList.contains(tr)||E.add(this.todayElement,"click",this.todayButtonClick,this)}},e.prototype.wireEvents=function(t,i,r,n){E.add(this.headerTitleElement,"click",this.navigateTitle,this),this.defaultKeyConfigs=he(this.defaultKeyConfigs,this.keyConfigs),this.getModuleName()==="calendar"?this.keyboardModule=new $i(this.element,{eventName:"keydown",keyAction:this.keyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs}):this.keyboardModule=new $i(this.calendarElement,{eventName:"keydown",keyAction:this.keyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})},e.prototype.dateWireEvents=function(t,i,r,n){this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.defaultKeyConfigs=he(this.defaultKeyConfigs,r),this.serverModuleName=n},e.prototype.todayButtonClick=function(t,i,r){this.showTodayButton&&(this.currentView()===this.depth?this.effect="":this.effect="e-zoomin",this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?this.navigateTo(this.depth,new Date(this.checkValue(i)),r):this.navigateTo("Month",new Date(this.checkValue(i)),r))},e.prototype.resetCalendar=function(){this.calendarElement&&ee(this.calendarElement),this.tableBodyElement&&ee(this.tableBodyElement),this.table&&ee(this.table),this.tableHeadElement&&ee(this.tableHeadElement),this.nextIcon&&ee(this.nextIcon),this.previousIcon&&ee(this.previousIcon),this.footer&&ee(this.footer),this.todayElement=null,this.renderDayCellArgs=null,this.calendarElement=this.tableBodyElement=this.footer=this.tableHeadElement=this.nextIcon=this.previousIcon=this.table=null},e.prototype.keyActionHandle=function(t,i,r){if(!(this.calendarElement===null&&t.action==="escape")){var n=this.tableBodyElement.querySelector("tr td.e-focused-date"),s;r?!g(n)&&+i===parseInt(n.getAttribute("id").split("_")[0],10)?s=n:s=this.tableBodyElement.querySelector("tr td.e-selected"):s=this.tableBodyElement.querySelector("tr td.e-selected");var a=this.getViewNumber(this.currentView()),l=this.getViewNumber(this.depth),h=a===l&&this.getViewNumber(this.start)>=l;switch(this.effect="",t.action){case"moveLeft":this.getModuleName()!=="daterangepicker"&&!g(t.target)&&(this.keyboardNavigate(-1,a,t,this.max,this.min),t.preventDefault());break;case"moveRight":this.getModuleName()!=="daterangepicker"&&!g(t.target)&&(this.keyboardNavigate(1,a,t,this.max,this.min),t.preventDefault());break;case"moveUp":this.getModuleName()!=="daterangepicker"&&!g(t.target)&&(a===0?this.keyboardNavigate(-7,a,t,this.max,this.min):this.keyboardNavigate(-4,a,t,this.max,this.min),t.preventDefault());break;case"moveDown":this.getModuleName()!=="daterangepicker"&&!g(t.target)&&(a===0?this.keyboardNavigate(7,a,t,this.max,this.min):this.keyboardNavigate(4,a,t,this.max,this.min),t.preventDefault());break;case"select":if(t.target===this.headerTitleElement)this.navigateTitle(t);else if(t.target===this.previousIcon&&!t.target.className.includes(tr))this.navigatePrevious(t);else if(t.target===this.nextIcon&&!t.target.className.includes(tr))this.navigateNext(t);else if(t.target===this.todayElement&&!t.target.className.includes(tr))this.todayButtonClick(t,i),(this.getModuleName()==="datepicker"||this.getModuleName()==="datetimepicker")&&(this.isAngular?this.inputElement.focus():this.element.focus());else{var u=g(n)?s:n;if(!g(u)&&!u.classList.contains(tr))if(h){var c=new Date(parseInt(""+u.id,0));this.selectDate(t,c,u),(this.getModuleName()==="datepicker"||this.getModuleName()==="datetimepicker")&&(this.isAngular?this.inputElement.focus():this.element.focus())}else t.target.className.includes(tr)||this.contentClick(null,--a,u,i)}break;case"controlUp":this.title(),t.preventDefault();break;case"controlDown":(!g(n)&&!h||!g(s)&&!h)&&this.contentClick(null,--a,n||s,i),t.preventDefault();break;case"home":this.currentDate=this.firstDay(this.currentDate),ee(this.tableBodyElement),a===0?this.renderMonths(t):a===1?this.renderYears(t):this.renderDecades(t),t.preventDefault();break;case"end":this.currentDate=this.lastDay(this.currentDate,a),ee(this.tableBodyElement),a===0?this.renderMonths(t):a===1?this.renderYears(t):this.renderDecades(t),t.preventDefault();break;case"pageUp":this.addMonths(this.currentDate,-1),this.navigateTo("Month",this.currentDate),t.preventDefault();break;case"pageDown":this.addMonths(this.currentDate,1),this.navigateTo("Month",this.currentDate),t.preventDefault();break;case"shiftPageUp":this.addYears(this.currentDate,-1),this.navigateTo("Month",this.currentDate),t.preventDefault();break;case"shiftPageDown":this.addYears(this.currentDate,1),this.navigateTo("Month",this.currentDate),t.preventDefault();break;case"controlHome":this.navigateTo("Month",new Date(this.currentDate.getFullYear(),0,1)),t.preventDefault();break;case"controlEnd":this.navigateTo("Month",new Date(this.currentDate.getFullYear(),11,31)),t.preventDefault();break;case"tab":(this.getModuleName()==="datepicker"||this.getModuleName()==="datetimepicker")&&t.target===this.todayElement&&(t.preventDefault(),this.isAngular?this.inputElement.focus():this.element.focus(),this.hide());break;case"shiftTab":(this.getModuleName()==="datepicker"||this.getModuleName()==="datetimepicker")&&t.target===this.headerTitleElement&&(t.preventDefault(),this.isAngular?this.inputElement.focus():this.element.focus(),this.hide());break;case"escape":(this.getModuleName()==="datepicker"||this.getModuleName()==="datetimepicker")&&(t.target===this.headerTitleElement||t.target===this.previousIcon||t.target===this.nextIcon||t.target===this.todayElement)&&this.hide();break}}},e.prototype.keyboardNavigate=function(t,i,r,n,s){var a=new Date(this.checkValue(this.currentDate));switch(i){case 2:this.addYears(this.currentDate,t),this.isMonthYearRange(this.currentDate)?(ee(this.tableBodyElement),this.renderDecades(r)):this.currentDate=a;break;case 1:this.addMonths(this.currentDate,t),this.calendarMode==="Gregorian"?this.isMonthYearRange(this.currentDate)?(ee(this.tableBodyElement),this.renderYears(r)):this.currentDate=a:this.isMonthYearRange(this.currentDate)?(ee(this.tableBodyElement),this.renderYears(r)):this.currentDate=a;break;case 0:this.addDay(this.currentDate,t,r,n,s),this.isMinMaxRange(this.currentDate)?(ee(this.tableBodyElement),this.renderMonths(r)):this.currentDate=a;break}},e.prototype.preRender=function(t){var i=this;this.navigatePreviousHandler=this.navigatePrevious.bind(this),this.navigateNextHandler=this.navigateNext.bind(this),this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.navigateHandler=function(r){i.triggerNavigate(r)}},e.prototype.minMaxDate=function(t){var i=new Date(new Date(+t).setHours(0,0,0,0)),r=new Date(new Date(+this.min).setHours(0,0,0,0)),n=new Date(new Date(+this.max).setHours(0,0,0,0));return(+i==+r||+i==+n)&&(+t<+this.min&&(t=new Date(+this.min)),+t>+this.max&&(t=new Date(+this.max))),t},e.prototype.renderMonths=function(t,i,r){var n=this.weekNumber?8:7,s;this.calendarMode==="Gregorian"?s=this.renderDays(this.currentDate,i,null,null,r,t):s=g(this.islamicModule)?null:this.islamicModule.islamicRenderDays(this.currentDate,i),this.createContentHeader(),this.calendarMode==="Gregorian"?this.renderTemplate(s,n,kw,t,i):g(this.islamicModule)||this.islamicModule.islamicRenderTemplate(s,n,kw,t,i)},e.prototype.renderDays=function(t,i,r,n,s,a){var l=[],h=42,u=s?new Date(+t):this.getDate(new Date,this.timezone),c=new Date(this.checkValue(t)),d,p=c.getMonth();this.titleUpdate(t,"days");var f=c;for(c=new Date(f.getFullYear(),f.getMonth(),0,f.getHours(),f.getMinutes(),f.getSeconds(),f.getMilliseconds());c.getDay()!==this.firstDayOfWeek;)this.setStartDate(c,-1*Nw);for(var v=0;v<h;++v){var m=this.createElement("td",{className:Dk}),y=this.createElement("span");if(v%7===0&&this.weekNumber){var S=this.weekRule==="FirstDay"?6:this.weekRule==="FirstFourDayWeek"?3:0,b=new Date(c.getFullYear(),c.getMonth(),c.getDate()+S);y.textContent=""+this.getWeek(b),m.appendChild(y),Y([m],""+Xp),l.push(m)}d=new Date(+c),c=this.minMaxDate(c);var w={type:"dateTime",skeleton:"full"},I=this.globalize.parseDate(this.globalize.formatDate(c,w),w),x=this.dayCell(c),M=this.globalize.formatDate(c,{type:"date",skeleton:"full"}),D=this.createElement("span");D.textContent=this.globalize.formatDate(c,{format:"d",type:"date",skeleton:"yMd"});var A=this.min>c||this.max<c;A?(Y([x],tr),Y([x],Ul)):D.setAttribute("title",""+M),p!==c.getMonth()&&(Y([x],oa),D.setAttribute("aria-disabled","true")),(c.getDay()===0||c.getDay()===6)&&Y([x],V5),x.appendChild(D),this.renderDayCellArgs={date:c,isDisabled:!1,element:x,isOutOfRange:A};var L=this.renderDayCellArgs;if(this.renderDayCellEvent(L),L.isDisabled){var T=new Date(this.checkValue(i)),k=new Date(this.checkValue(L.date));if(r){if(!g(n)&&n.length>0)for(var F=0;F<n.length;F++){var R=+new Date(this.globalize.formatDate(L.date,{type:"date",skeleton:"yMd"})),N=+new Date(this.globalize.formatDate(n[F],{type:"date",skeleton:"yMd"}));R===N&&(n.splice(F,1),F=-1)}}else T&&+T==+k&&this.setProperties({value:null},!0)}this.renderDayCellArgs.isDisabled&&!x.classList.contains(Cn)&&(Y([x],tr),Y([x],Ul),D.setAttribute("aria-disabled","true"),+this.renderDayCellArgs.date==+this.todayDate&&(this.todayDisabled=!0));var P=x.classList.contains(oa),O=x.classList.contains(tr);O||E.add(x,"click",this.clickHandler,this);var z=void 0;if(!g(a)&&a.type==="click"&&(z=a.currentTarget),r&&!g(n)&&!O){for(var H=0;H<n.length;H++){var Q=this.calendarMode==="Gregorian"?"gregorian":"islamic",$={format:null,type:"date",skeleton:"short",calendar:Q},R=this.globalize.formatDate(c,$),N=this.globalize.formatDate(n[H],$);if((R===N&&this.getDateVal(c,n[H])||this.getDateVal(c,i))&&Y([x],Cn),!g(z)&&z.innerText===x.innerText&&this.previousDates&&x.classList.contains(Cn)&&z.classList.contains(Cn)){K([x],Cn),this.previousDates=!1;for(var U=this.copyValues(n),ie=0;ie<U.length;ie++){var ne=this.calendarMode==="Gregorian"?"gregorian":"islamic",te={format:null,type:"date",skeleton:"short",calendar:ne},oe=this.globalize.formatDate(I,te),ae=this.globalize.formatDate(U[ie],te);if(oe===ae){var F=U.indexOf(U[ie]);U.splice(F,1),n.splice(F,1)}}this.setProperties({values:U},!0)}else this.updateFocus(P,O,c,x,t)}n.length<=0&&this.updateFocus(P,O,c,x,t)}else!O&&this.getDateVal(c,i)&&Y([x],Cn);this.updateFocus(P,O,c,x,t),!g(I)&&I.getFullYear()===u.getFullYear()&&I.getMonth()===u.getMonth()&&I.getDate()===u.getDate()&&Y([x],Ik),l.push(this.renderDayCellArgs.element),c=new Date(+d),this.addDay(c,1,null,this.max,this.min)}return l},e.prototype.updateFocus=function(t,i,r,n,s){s.getDate()===r.getDate()&&!t&&!i?Y([n],Is):(s>=this.max&&parseInt(n.id,0)===+this.max&&!t&&!i&&Y([n],Is),s<=this.min&&parseInt(n.id,0)===+this.min&&!t&&!i&&Y([n],Is))},e.prototype.renderYears=function(t,i){this.removeTableHeadElement();var r=4,n=[],s=g(i),a=new Date(this.checkValue(this.currentDate)),l=a.getMonth(),h=a.getFullYear(),u=a,c=u.getFullYear(),d=new Date(this.checkValue(this.min)).getFullYear(),p=new Date(this.checkValue(this.min)).getMonth(),f=new Date(this.checkValue(this.max)).getFullYear(),v=new Date(this.checkValue(this.max)).getMonth();u.setMonth(0),this.titleUpdate(this.currentDate,"months"),u.setDate(1);for(var m=0;m<12;++m){var y=this.dayCell(u),S=this.createElement("span"),b=i&&i.getMonth()===u.getMonth(),w=i&&i.getFullYear()===h&&b,I=this.globalize.formatDate(u,{type:"date",format:"MMM y"});S.textContent=this.toCapitalize(this.globalize.formatDate(u,{format:null,type:"dateTime",skeleton:"MMM"})),this.min&&(c<d||m<p&&c===d)||this.max&&(c>f||m>v&&c>=f)?Y([y],tr):!s&&w?Y([y],Cn):u.getMonth()===l&&this.currentDate.getMonth()===l&&Y([y],Is),u.setDate(1),u.setMonth(u.getMonth()+1),y.classList.contains(tr)||(E.add(y,"click",this.clickHandler,this),S.setAttribute("title",""+I)),y.appendChild(S),n.push(y)}this.renderTemplate(n,r,Lw,t,i)},e.prototype.renderDecades=function(t,i){this.removeTableHeadElement();var r=4,n=12,s=[],a=new Date(this.checkValue(this.currentDate));a.setMonth(0),a.setDate(1);var l=a.getFullYear(),h=new Date(a.setFullYear(l-l%10)),u=new Date(a.setFullYear(l-l%10+9)),c=h.getFullYear(),d=u.getFullYear(),p=this.globalize.formatDate(h,{format:null,type:"dateTime",skeleton:"y"}),f=this.globalize.formatDate(u,{format:null,type:"dateTime",skeleton:"y"});this.headerTitleElement.textContent=p+" - "+f;for(var v=new Date(l-l%10-1,0,1),m=v.getFullYear(),y=0;y<n;++y){var S=m+y;a.setFullYear(S);var b=this.dayCell(a),w=this.createElement("span");w.textContent=this.globalize.formatDate(a,{format:null,type:"dateTime",skeleton:"y"}),S<c||S>d?(Y([b],Tw),w.setAttribute("aria-disabled","true"),!g(i)&&a.getFullYear()===i.getFullYear()&&Y([b],Cn),(S<new Date(this.checkValue(this.min)).getFullYear()||S>new Date(this.checkValue(this.max)).getFullYear())&&Y([b],tr)):S<new Date(this.checkValue(this.min)).getFullYear()||S>new Date(this.checkValue(this.max)).getFullYear()?Y([b],tr):!g(i)&&a.getFullYear()===i.getFullYear()?Y([b],Cn):a.getFullYear()===this.currentDate.getFullYear()&&!b.classList.contains(tr)&&Y([b],Is),b.classList.contains(tr)||(E.add(b,"click",this.clickHandler,this),w.setAttribute("title",""+w.textContent)),b.appendChild(w),s.push(b)}this.renderTemplate(s,r,"e-decade",t,i)},e.prototype.dayCell=function(t){var i=this.calendarMode==="Gregorian"?"gregorian":"islamic",r={skeleton:"full",type:"dateTime",calendar:i},n=this.globalize.parseDate(this.globalize.formatDate(t,r),r),s;g(n)||(s=n.valueOf());var a={className:Dk,attrs:{id:""+kt(""+s),"aria-selected":"false"}};return this.createElement("td",a)},e.prototype.firstDay=function(t){var i=this.currentView()!=="Decade"?this.tableBodyElement.querySelectorAll("td:not(."+oa+"):not(."+Xp+")"):this.tableBodyElement.querySelectorAll("td:not(."+Tw);if(i.length){for(var r=0;r<i.length;r++)if(!i[r].classList.contains(tr)){t=new Date(parseInt(i[r].id,0));break}}return t},e.prototype.lastDay=function(t,i){var r=new Date(t.getFullYear(),t.getMonth()+1,0);if(i!==2){var n=Math.abs(r.getTimezoneOffset()-this.firstDay(t).getTimezoneOffset());return n&&r.setHours(this.firstDay(t).getHours()+n/60),this.findLastDay(r)}else return this.findLastDay(this.firstDay(r))},e.prototype.checkDateValue=function(t){return!g(t)&&t instanceof Date&&!isNaN(+t)?t:null},e.prototype.findLastDay=function(t){var i=this.currentView()==="Decade"?this.tableBodyElement.querySelectorAll("td:not(."+Tw):this.tableBodyElement.querySelectorAll("td:not(."+oa+"):not(."+Xp+")");if(i.length){for(var r=i.length-1;r>=0;r--)if(!i[r].classList.contains(tr)){t=new Date(parseInt(i[r].id,0));break}}return t},e.prototype.removeTableHeadElement=function(){this.getModuleName()==="calendar"?g(this.element.querySelectorAll(".e-content table thead")[0])||ee(this.tableHeadElement):g(this.calendarElement.querySelectorAll(".e-content table thead")[0])||ee(this.tableHeadElement)},e.prototype.renderTemplate=function(t,i,r,n,s){var a=this.getViewNumber(this.currentView()),l;this.tableBodyElement=this.createElement("tbody"),this.table.appendChild(this.tableBodyElement),K([this.contentElement,this.headerElement],[kw,wk,Lw]),Y([this.contentElement,this.headerElement],[r]);for(var h=41,u=35,c=6,d=i,p=0,f=0;f<t.length/i;++f){for(l=this.createElement("tr"),p=0+p;p<d;p++)!t[p].classList.contains("e-week-number")&&!g(t[p].children[0])&&(Y([t[p].children[0]],[Mk]),Vi(t[p].children[0],{duration:600,isCenterRipple:!0})),l.appendChild(t[p]),this.weekNumber&&p===c+1&&t[c+1].classList.contains(oa)&&Y([l],fm),!this.weekNumber&&p===c&&t[c].classList.contains(oa)&&Y([l],fm),this.weekNumber?p===h&&t[h].classList.contains(oa)&&Y([l],fm):p===u&&t[u].classList.contains(oa)&&Y([l],fm);d=d+i,p=p+0,this.tableBodyElement.appendChild(l)}this.table.querySelector("tbody").className=this.effect,this.calendarMode==="Gregorian"?this.iconHandler():this.islamicModule.islamicIconHandler(),(a!==this.getViewNumber(this.currentView())||a===0&&a!==this.getViewNumber(this.currentView()))&&this.navigateHandler(n),this.setAriaActiveDescendant()},e.prototype.clickHandler=function(t,i){this.clickEventEmitter(t);var r=t.currentTarget,n=this.getViewNumber(this.currentView());r.classList.contains(oa)?this.contentClick(t,0,null,i):n===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?this.contentClick(t,1,null,i):n===2?this.contentClick(t,1,null,i):!r.classList.contains(oa)&&n===0?this.selectDate(t,this.getIdValue(t,null),null):this.contentClick(t,0,r,i),this.getModuleName()==="calendar"&&this.table.focus()},e.prototype.clickEventEmitter=function(t){t.preventDefault()},e.prototype.contentClick=function(t,i,r,n){var s=this.getViewNumber(this.currentView()),a=this.getIdValue(t,r);switch(i){case 0:s===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?(ee(this.tableBodyElement),this.currentDate=a,this.effect=gm,this.renderMonths(t)):(this.calendarMode==="Gregorian"?(this.currentDate.setMonth(a.getMonth()),a.getMonth()>0&&this.currentDate.getMonth()!==a.getMonth()&&this.currentDate.setDate(0),this.currentDate.setFullYear(a.getFullYear())):this.currentDate=a,this.effect=gm,ee(this.tableBodyElement),this.renderMonths(t));break;case 1:if(s===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth))this.selectDate(t,a,null);else{if(this.calendarMode==="Gregorian")this.currentDate.setFullYear(a.getFullYear());else{this.islamicPreviousHeader=this.headerElement.textContent;var l=this.islamicModule.getIslamicDate(a);this.currentDate=this.islamicModule.toGregorian(l.year,l.month,1)}this.effect=gm,ee(this.tableBodyElement),this.renderYears(t)}}},e.prototype.switchView=function(t,i,r,n){switch(t){case 0:ee(this.tableBodyElement),this.renderMonths(i,null,n);break;case 1:ee(this.tableBodyElement),this.renderYears(i);break;case 2:ee(this.tableBodyElement),this.renderDecades(i)}},e.prototype.getModuleName=function(){return"calendar"},e.prototype.requiredModules=function(){var t=[];return this.calendarMode==="Islamic"&&t.push({args:[this],member:"islamic",name:"Islamic"}),t},e.prototype.getPersistData=function(){var t=["value"];return this.addOnPersist(t)},e.prototype.onPropertyChanged=function(t,i,r,n){this.effect="";for(var s=0,a=Object.keys(t);s<a.length;s++){var l=a[s];switch(l){case"enableRtl":t.enableRtl?this.getModuleName()==="calendar"?this.element.classList.add("e-rtl"):this.calendarElement.classList.add("e-rtl"):this.getModuleName()==="calendar"?this.element.classList.remove("e-rtl"):this.calendarElement.classList.remove("e-rtl");break;case"dayHeaderFormat":this.getCultureValues(),this.getModuleName()!=="datepicker"?this.createContentHeader():this.calendarElement&&this.createContentHeader(),this.adjustLongHeaderSize();break;case"min":case"max":this.rangeValidation(this.min,this.max),l==="min"?this.setProperties({min:this.checkDateValue(new Date(this.checkValue(t.min)))},!0):this.setProperties({max:this.checkDateValue(new Date(this.checkValue(t.max)))},!0),this.setProperties({start:this.currentView()},!0),this.tableBodyElement&&ee(this.tableBodyElement),this.minMaxUpdate(),r&&this.validateValues(r,n),this.getModuleName()!=="datepicker"?this.createContentBody():this.calendarElement&&this.createContentBody(),(this.todayDate<this.min||this.max<this.todayDate)&&this.footer&&this.todayElement?(ee(this.todayElement),ee(this.footer),this.todayElement=this.footer=null,this.createContentFooter()):this.footer&&this.todayElement&&this.todayElement.classList.contains("e-disabled")&&(K([this.todayElement],tr),ee(this.todayElement),ee(this.footer),this.todayElement=this.footer=null,this.createContentFooter());break;case"start":case"depth":case"weekNumber":case"firstDayOfWeek":case"weekRule":this.checkView(),this.getModuleName()!=="datepicker"?(this.createContentHeader(),this.createContentBody()):this.calendarElement&&(this.createContentHeader(),this.createContentBody());break;case"locale":if(this.globalize=new Et(this.locale),this.getModuleName()!=="datepicker"?(this.createContentHeader(),this.createContentBody()):this.calendarElement&&(this.createContentHeader(),this.createContentBody()),this.getModuleName()==="calendar"){var h={today:"Today"};this.l10=new Li(this.getModuleName(),h,this.locale)}this.l10.setLocale(this.locale),this.showTodayButton&&this.updateFooter();break;case"showTodayButton":t.showTodayButton?this.createContentFooter():!g(this.todayElement)&&!g(this.footer)&&(ee(this.todayElement),ee(this.footer),this.todayElement=this.footer=void 0),this.setProperties({showTodayButton:t.showTodayButton},!0);break}}},e.prototype.validateValues=function(t,i){if(t&&!g(i)&&i.length>0){for(var r=this.copyValues(i),n=0;n<r.length;n++){var s=r[n],a=this.calendarMode==="Gregorian"?"gregorian":"islamic",l=void 0;this.calendarMode==="Gregorian"?l=this.globalize.formatDate(s,{type:"date",skeleton:"yMd"}):l=this.globalize.formatDate(s,{type:"dateTime",skeleton:"full",calendar:"islamic"});var h={type:"date",skeleton:"yMd",calendar:a},u=this.globalize.formatDate(this.min,h),c=u,d={type:"date",skeleton:"yMd",calendar:a},p=this.globalize.formatDate(this.max,d),f=p;(+new Date(l)<+new Date(c)||+new Date(l)>+new Date(f))&&(r.splice(n,1),n=-1)}this.setProperties({values:r},!0)}},e.prototype.setValueUpdate=function(){g(this.tableBodyElement)||(ee(this.tableBodyElement),this.setProperties({start:this.currentView()},!0),this.createContentBody())},e.prototype.copyValues=function(t){var i=[];if(!g(t)&&t.length>0)for(var r=0;r<t.length;r++)i.push(new Date(+t[r]));return i},e.prototype.titleUpdate=function(t,i){var r=new Et(this.locale),n,s,a=this.calendarMode==="Gregorian"?"gregorian":"islamic";switch(this.calendarMode==="Gregorian"?(n=r.formatDate(t,{type:"dateTime",skeleton:"yMMMM",calendar:a}),s=r.formatDate(t,{format:null,type:"dateTime",skeleton:"y",calendar:a})):(n=r.formatDate(t,{type:"dateTime",format:"MMMM y",calendar:a}),s=r.formatDate(t,{type:"dateTime",format:"y",calendar:a})),i){case"days":this.headerTitleElement.textContent=this.toCapitalize(n);break;case"months":this.headerTitleElement.textContent=s}},e.prototype.setActiveDescendant=function(){var t,i=this.tableBodyElement.querySelector("tr td.e-focused-date"),r=this.tableBodyElement.querySelector("tr td.e-selected"),n=this.calendarMode==="Gregorian"?"gregorian":"islamic",s,a=this.currentView();return a==="Month"?s=this.globalize.formatDate(this.currentDate,{type:"date",skeleton:"full",calendar:n}):a==="Year"?n!=="islamic"?s=this.globalize.formatDate(this.currentDate,{type:"date",skeleton:"yMMMM",calendar:n}):s=this.globalize.formatDate(this.currentDate,{type:"date",skeleton:"GyMMM",calendar:n}):s=this.globalize.formatDate(this.currentDate,{format:null,type:"date",skeleton:"y",calendar:n}),(r||i)&&(g(r)||r.setAttribute("aria-selected","true"),(i||r).setAttribute("aria-label",s),t=(i||r).getAttribute("id")),t},e.prototype.iconHandler=function(){switch(new Date(this.checkValue(this.currentDate)).setDate(1),this.currentView()){case"Month":this.previousIconHandler(this.compareMonth(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareMonth(new Date(this.checkValue(this.currentDate)),this.max)>-1);break;case"Year":this.previousIconHandler(this.compareYear(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareYear(new Date(this.checkValue(this.currentDate)),this.max)>-1);break;case"Decade":this.previousIconHandler(this.compareDecade(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareDecade(new Date(this.checkValue(this.currentDate)),this.max)>-1)}},e.prototype.destroy=function(){this.getModuleName()==="calendar"&&this.element?K([this.element],[Qp]):this.calendarElement&&this.element&&K([this.element],[Qp]),this.getModuleName()==="calendar"&&this.element&&(g(this.headerTitleElement)||E.remove(this.headerTitleElement,"click",this.navigateTitle),this.todayElement&&E.remove(this.todayElement,"click",this.todayButtonClick),this.previousIconHandler(!0),this.nextIconHandler(!0),this.keyboardModule.destroy(),this.element.removeAttribute("data-role"),g(this.calendarEleCopy.getAttribute("tabindex"))?this.element.removeAttribute("tabindex"):this.element.setAttribute("tabindex",this.tabIndex)),this.element&&(this.element.innerHTML=""),this.todayElement=null,this.tableBodyElement=null,this.todayButtonEvent=null,this.renderDayCellArgs=null,this.headerElement=null,this.nextIcon=null,this.table=null,this.tableHeadElement=null,this.previousIcon=null,this.headerTitleElement=null,this.footer=null,this.contentElement=null,o.prototype.destroy.call(this)},e.prototype.title=function(t){var i=this.getViewNumber(this.currentView());this.effect=gm,this.switchView(++i,t)},e.prototype.getViewNumber=function(t){return t==="Month"?0:t==="Year"?1:2},e.prototype.navigateTitle=function(t){t.preventDefault(),this.title(t)},e.prototype.previous=function(){this.effect="";var t=this.getViewNumber(this.currentView());switch(this.currentView()){case"Month":this.addMonths(this.currentDate,-1),this.switchView(t);break;case"Year":this.addYears(this.currentDate,-1),this.switchView(t);break;case"Decade":this.addYears(this.currentDate,-10),this.switchView(t);break}},e.prototype.navigatePrevious=function(t){!B.isDevice&&t.preventDefault(),this.calendarMode==="Gregorian"?this.previous():this.islamicModule.islamicPrevious(),this.triggerNavigate(t)},e.prototype.next=function(){this.effect="";var t=this.getViewNumber(this.currentView());switch(this.currentView()){case"Month":this.addMonths(this.currentDate,1),this.switchView(t);break;case"Year":this.addYears(this.currentDate,1),this.switchView(t);break;case"Decade":this.addYears(this.currentDate,10),this.switchView(t);break}},e.prototype.navigateNext=function(t){!B.isDevice&&t.preventDefault(),this.calendarMode==="Gregorian"?this.next():this.islamicModule.islamicNext(),this.triggerNavigate(t)},e.prototype.navigateTo=function(t,i,r){+i>=+this.min&&+i<=+this.max&&(this.currentDate=i),+i<=+this.min&&(this.currentDate=new Date(this.checkValue(this.min))),+i>=+this.max&&(this.currentDate=new Date(this.checkValue(this.max))),this.getViewNumber(this.depth)>=this.getViewNumber(t)&&(this.getViewNumber(this.depth)<=this.getViewNumber(this.start)||this.getViewNumber(this.depth)===this.getViewNumber(t))&&(t=this.depth),this.switchView(this.getViewNumber(t),null,null,r)},e.prototype.currentView=function(){return!g(this.contentElement)&&this.contentElement.classList.contains(Lw)?"Year":!g(this.contentElement)&&this.contentElement.classList.contains(wk)?"Decade":"Month"},e.prototype.getDateVal=function(t,i){return!g(i)&&t.getDate()===i.getDate()&&t.getMonth()===i.getMonth()&&t.getFullYear()===i.getFullYear()},e.prototype.getCultureObjects=function(t,i){var r=g(this.dayHeaderFormat)?null:".dates.calendars.gregorian.days.format."+this.dayHeaderFormat.toLowerCase(),n=g(this.dayHeaderFormat)?null:".dates.calendars.islamic.days.format."+this.dayHeaderFormat.toLowerCase(),s="main.";return this.calendarMode==="Gregorian"?V(s+""+this.locale+r,t):V("main."+this.locale+n,t)},e.prototype.getWeek=function(t){var i=new Date(this.checkValue(t)).valueOf(),r=new Date(t.getFullYear(),0,1).valueOf();return Math.ceil((i-r+Nw)/Nw/7)},e.prototype.setStartDate=function(t,i){var r=t.getTimezoneOffset(),n=new Date(t.getTime()+i),s=n.getTimezoneOffset()-r;t.setTime(n.getTime()+s*X5)},e.prototype.addMonths=function(t,i){if(this.calendarMode==="Gregorian"){var r=t.getDate();t.setDate(1),t.setMonth(t.getMonth()+i),t.setDate(Math.min(r,this.getMaxDays(t)))}else{var n=this.islamicModule.getIslamicDate(t);this.currentDate=this.islamicModule.toGregorian(n.year,n.month+i,1)}},e.prototype.addYears=function(t,i){if(this.calendarMode==="Gregorian"){var r=t.getDate();t.setDate(1),t.setFullYear(t.getFullYear()+i),t.setDate(Math.min(r,this.getMaxDays(t)))}else{var n=this.islamicModule.getIslamicDate(t);this.currentDate=this.islamicModule.toGregorian(n.year+i,n.month,1)}},e.prototype.getIdValue=function(t,i){var r;t?r=t.currentTarget:r=i;var n=this.calendarMode==="Gregorian"?"gregorian":"islamic",s={type:"dateTime",skeleton:"full",calendar:n},a=this.globalize.formatDate(new Date(parseInt(""+r.getAttribute("id"),0)),s),l=this.globalize.parseDate(a,s),h=l.valueOf()-l.valueOf()%1e3;return new Date(h)},e.prototype.adjustLongHeaderSize=function(){K([this.element],Ek),this.dayHeaderFormat==="Wide"&&Y([this.getModuleName()==="calendar"?this.element:this.calendarElement],Ek)},e.prototype.selectDate=function(t,i,r,n,s){var a=r||t.currentTarget;if(this.isDateSelected=!1,this.currentView()==="Decade")this.setDateDecade(this.currentDate,i.getFullYear());else if(this.currentView()==="Year")this.setDateYear(this.currentDate,i);else{if(n&&!this.checkPresentDate(i,s)){var l=this.copyValues(s);!g(s)&&l.length>0?(l.push(new Date(this.checkValue(i))),this.setProperties({values:l},!0),this.setProperties({value:s[s.length-1]},!0)):this.setProperties({values:[new Date(this.checkValue(i))]},!0)}else this.setProperties({value:new Date(this.checkValue(i))},!0);this.currentDate=new Date(this.checkValue(i))}var h=j(a,"."+Qp);if(g(h)&&(h=this.tableBodyElement),!n&&!g(h.querySelector("."+Cn))&&K([h.querySelector("."+Cn)],Cn),!n&&!g(h.querySelector("."+Is))&&K([h.querySelector("."+Is)],Is),!n&&!g(h.querySelector("."+Hh))&&K([h.querySelector("."+Hh)],Hh),n){for(var l=this.copyValues(s),u=Array.prototype.slice.call(this.tableBodyElement.querySelectorAll("td")),c=0;c<u.length;c++){var d=h.querySelectorAll("td."+Is)[0],p=h.querySelectorAll("td."+Cn)[0];u[c]===d&&K([u[c]],Is),u[c]===p&&!this.checkPresentDate(new Date(parseInt(p.getAttribute("id").split("_")[0],10)),s)&&K([u[c]],Cn)}if(a.classList.contains(Cn)){K([a],Cn);for(var f=0;f<l.length;f++){var v=this.calendarMode==="Gregorian"?"gregorian":"islamic",m={format:null,type:"date",skeleton:"short",calendar:v},y=this.globalize.formatDate(i,m),S=this.globalize.formatDate(l[f],m);if(y===S){var c=l.indexOf(l[f]);l.splice(c,1),Y([a],Is)}}this.setProperties({values:l},!0)}else Y([a],Cn)}else Y([a],Cn);this.isDateSelected=!0},e.prototype.checkPresentDate=function(t,i){var r=!1;if(!g(i))for(var n=0;n<i.length;n++){var s=this.calendarMode==="Gregorian"?"gregorian":"islamic",a=this.globalize.formatDate(t,{format:null,type:"date",skeleton:"short",calendar:s}),l=this.globalize.formatDate(i[n],{format:null,type:"date",skeleton:"short",calendar:s});a===l&&(r=!0)}return r},e.prototype.setAriaActiveDescendant=function(){Ie(this.table,{"aria-activedescendant":""+this.setActiveDescendant()})},e.prototype.previousIconHandler=function(t){t?g(this.previousIcon)||(E.remove(this.previousIcon,"click",this.navigatePreviousHandler),Y([this.previousIcon],""+tr),Y([this.previousIcon],""+Ul),this.previousIcon.setAttribute("aria-disabled","true")):(E.add(this.previousIcon,"click",this.navigatePreviousHandler),K([this.previousIcon],""+tr),K([this.previousIcon],""+Ul),this.previousIcon.setAttribute("aria-disabled","false"))},e.prototype.renderDayCellEvent=function(t){he(this.renderDayCellArgs,{name:"renderDayCell"}),this.trigger("renderDayCell",t)},e.prototype.navigatedEvent=function(t){he(this.navigatedArgs,{name:"navigated",event:t}),this.trigger("navigated",this.navigatedArgs)},e.prototype.triggerNavigate=function(t){this.navigatedArgs={view:this.currentView(),date:this.currentDate},this.navigatedEvent(t)},e.prototype.nextIconHandler=function(t){t?g(this.previousIcon)||(E.remove(this.nextIcon,"click",this.navigateNextHandler),Y([this.nextIcon],tr),Y([this.nextIcon],Ul),this.nextIcon.setAttribute("aria-disabled","true")):(E.add(this.nextIcon,"click",this.navigateNextHandler),K([this.nextIcon],tr),K([this.nextIcon],Ul),this.nextIcon.setAttribute("aria-disabled","false"))},e.prototype.compare=function(t,i,r){var n=i.getFullYear(),s,a;return s=n,a=0,r&&(n=n-n%r,s=n-n%r+r-1),t.getFullYear()>s?a=1:t.getFullYear()<n&&(a=-1),a},e.prototype.isMinMaxRange=function(t){return+t>=+this.min&&+t<=+this.max},e.prototype.isMonthYearRange=function(t){if(this.calendarMode==="Gregorian")return t.getMonth()>=this.min.getMonth()&&t.getFullYear()>=this.min.getFullYear()&&t.getMonth()<=this.max.getMonth()&&t.getFullYear()<=this.max.getFullYear();var i=this.islamicModule.getIslamicDate(t);return i.month>=this.islamicModule.getIslamicDate(new Date(1944,1,18)).month&&i.year>=this.islamicModule.getIslamicDate(new Date(1944,1,18)).year&&i.month<=this.islamicModule.getIslamicDate(new Date(2069,1,16)).month&&i.year<=this.islamicModule.getIslamicDate(new Date(2069,1,16)).year},e.prototype.compareYear=function(t,i){return this.compare(t,i,0)},e.prototype.compareDecade=function(t,i){return this.compare(t,i,10)},e.prototype.shiftArray=function(t,i){return t.slice(i).concat(t.slice(0,i))},e.prototype.addDay=function(t,i,r,n,s){var a=i,l=new Date(+t);if(!g(this.tableBodyElement)&&!g(r)){for(;this.findNextTD(new Date(+t),a,n,s);)a+=i;var h=new Date(l.setDate(l.getDate()+a));a=+h>+n||+h<+s?a===i?i-i:i:a}t.setDate(t.getDate()+a)},e.prototype.findNextTD=function(t,i,r,n){var s=new Date(t.setDate(t.getDate()+i)),a=[],l=!1;if((!g(s)&&s.getMonth())===(!g(this.currentDate)&&this.currentDate.getMonth())){var h=void 0;this.calendarMode==="Gregorian"?h=this.renderDays(s):h=this.islamicModule.islamicRenderDays(this.currentDate,s),a=h.filter(function(c){return c.classList.contains(tr)})}else a=this.tableBodyElement.querySelectorAll("td."+tr);if(+s<=+r&&+s>=+n&&a.length)for(var u=0;u<a.length&&(l=+s==+new Date(parseInt(a[u].id,0)),!l);u++);return l},e.prototype.getMaxDays=function(t){var i,r=new Date(this.checkValue(t));i=28;for(var n=r.getMonth();r.getMonth()===n;)++i,r.setDate(i);return i-1},e.prototype.setDateDecade=function(t,i){t.setFullYear(i),this.setProperties({value:new Date(this.checkValue(t))},!0)},e.prototype.setDateYear=function(t,i){t.setFullYear(i.getFullYear(),i.getMonth(),t.getDate()),i.getMonth()!==t.getMonth()&&(t.setDate(0),this.currentDate=new Date(this.checkValue(i))),this.setProperties({value:new Date(this.checkValue(t))},!0)},e.prototype.compareMonth=function(t,i){var r;return t.getFullYear()>i.getFullYear()?r=1:t.getFullYear()<i.getFullYear()?r=-1:r=t.getMonth()===i.getMonth()?0:t.getMonth()>i.getMonth()?1:-1,r},e.prototype.checkValue=function(t){return t instanceof Date?t.toUTCString():""+t},e.prototype.checkView=function(){this.start!=="Decade"&&this.start!=="Year"&&this.setProperties({start:"Month"},!0),this.depth!=="Decade"&&this.depth!=="Year"&&this.setProperties({depth:"Month"},!0),this.getViewNumber(this.depth)>this.getViewNumber(this.start)&&this.setProperties({depth:"Month"},!0)},e.prototype.getDate=function(t,i){return i&&(t=new Date(t.toLocaleString("en-US",{timeZone:i}))),t},mr([C(new Date(1900,0,1))],e.prototype,"min",void 0),mr([C(!0)],e.prototype,"enabled",void 0),mr([C(null)],e.prototype,"cssClass",void 0),mr([C(new Date(2099,11,31))],e.prototype,"max",void 0),mr([C(null)],e.prototype,"firstDayOfWeek",void 0),mr([C("Gregorian")],e.prototype,"calendarMode",void 0),mr([C("Month")],e.prototype,"start",void 0),mr([C("Month")],e.prototype,"depth",void 0),mr([C(!1)],e.prototype,"weekNumber",void 0),mr([C("FirstDay")],e.prototype,"weekRule",void 0),mr([C(!0)],e.prototype,"showTodayButton",void 0),mr([C("Short")],e.prototype,"dayHeaderFormat",void 0),mr([C(!1)],e.prototype,"enablePersistence",void 0),mr([C(null)],e.prototype,"keyConfigs",void 0),mr([C(null)],e.prototype,"serverTimezoneOffset",void 0),mr([q()],e.prototype,"created",void 0),mr([q()],e.prototype,"destroyed",void 0),mr([q()],e.prototype,"navigated",void 0),mr([q()],e.prototype,"renderDayCell",void 0),e=mr([bt],e),e}(Kt),K5=function(o){jk(e,o);function e(t,i){return o.call(this,t,i)||this}return e.prototype.render=function(){if(this.calendarMode==="Islamic"&&this.islamicModule===void 0&&Dh("Requires the injectable Islamic modules to render Calendar in Islamic mode"),this.isMultiSelection&&typeof this.values=="object"&&!g(this.values)&&this.values.length>0){for(var t=[],i=[],r=0;r<this.values.length;r++)t.indexOf(+this.values[r])===-1&&(t.push(+this.values[r]),i.push(this.values[r]));this.setProperties({values:i},!0);for(var n=0;n<this.values.length;n++)if(!this.checkDateValue(this.values[n]))if(typeof this.values[n]=="string"&&this.checkDateValue(new Date(this.checkValue(this.values[n])))){var s=new Date(this.checkValue(this.values[n]));this.values.splice(n,1),this.values.splice(n,0,s)}else this.values.splice(n,1);this.setProperties({value:this.values[this.values.length-1]},!0),this.previousValues=this.values.length}if(this.validateDate(),this.minMaxUpdate(),this.getModuleName()==="calendar"&&(this.setEnable(this.enabled),this.setClass(this.cssClass)),o.prototype.render.call(this),this.getModuleName()==="calendar"){var a=j(this.element,"form");a&&E.add(a,"reset",this.formResetHandler.bind(this)),this.setTimeZone(this.serverTimezoneOffset)}this.renderComplete()},e.prototype.setEnable=function(t){t?K([this.element],tr):Y([this.element],tr)},e.prototype.setClass=function(t,i){g(i)||(i=i.replace(/\s+/g," ").trim()),g(t)||(t=t.replace(/\s+/g," ").trim()),!g(i)&&i!==""&&K([this.element],i.split(" ")),g(t)||Y([this.element],t.split(" "))},e.prototype.isDayLightSaving=function(){var t=new Date(this.value.getFullYear(),6,1).getTimezoneOffset(),i=new Date(this.value.getFullYear(),0,1).getTimezoneOffset();return this.value.getTimezoneOffset()<Math.max(i,t)},e.prototype.setTimeZone=function(t){if(!g(this.serverTimezoneOffset)&&this.value){var i=t,r=new Date().getTimezoneOffset()/60,n=i+r;n=this.isDayLightSaving()?n--:n,this.value=new Date(this.value.getTime()+n*60*60*1e3)}},e.prototype.formResetHandler=function(){this.setProperties({value:null},!0)},e.prototype.validateDate=function(){typeof this.value=="string"&&this.setProperties({value:this.checkDateValue(new Date(this.checkValue(this.value)))},!0),o.prototype.validateDate.call(this,this.value),!g(this.value)&&this.min<=this.max&&this.value>=this.min&&this.value<=this.max&&(this.currentDate=new Date(this.checkValue(this.value))),isNaN(+this.value)&&this.setProperties({value:null},!0)},e.prototype.minMaxUpdate=function(){this.getModuleName()==="calendar"&&(!g(this.value)&&this.value<=this.min&&this.min<=this.max?(this.setProperties({value:this.min},!0),this.changedArgs={value:this.value}):!g(this.value)&&this.value>=this.max&&this.min<=this.max&&(this.setProperties({value:this.max},!0),this.changedArgs={value:this.value})),this.getModuleName()!=="calendar"&&!g(this.value)?!g(this.value)&&this.value<this.min&&this.min<=this.max?o.prototype.minMaxUpdate.call(this,this.min):!g(this.value)&&this.value>this.max&&this.min<=this.max&&o.prototype.minMaxUpdate.call(this,this.max):o.prototype.minMaxUpdate.call(this,this.value)},e.prototype.generateTodayVal=function(t){var i=new Date;return g(this.timezone)||(i=o.prototype.getDate.call(this,i,this.timezone)),t&&g(this.timezone)?(i.setHours(t.getHours()),i.setMinutes(t.getMinutes()),i.setSeconds(t.getSeconds()),i.setMilliseconds(t.getMilliseconds())):i=new Date(i.getFullYear(),i.getMonth(),i.getDate(),0,0,0,0),i},e.prototype.todayButtonClick=function(t){if(this.showTodayButton){var i=this.generateTodayVal(this.value);if(this.setProperties({value:i},!0),this.isTodayClicked=!0,this.todayButtonEvent=t,this.isMultiSelection){var r=this.copyValues(this.values);o.prototype.checkPresentDate.call(this,i,this.values)||(r.push(i),this.setProperties({values:r}))}o.prototype.todayButtonClick.call(this,t,new Date(+this.value))}},e.prototype.keyActionHandle=function(t){o.prototype.keyActionHandle.call(this,t,this.value,this.isMultiSelection)},e.prototype.preRender=function(){var t=this;this.changeHandler=function(i){t.triggerChange(i)},this.checkView(),o.prototype.preRender.call(this,this.value)},e.prototype.createContent=function(){this.previousDate=this.value,this.previousDateTime=this.value,o.prototype.createContent.call(this)},e.prototype.minMaxDate=function(t){return o.prototype.minMaxDate.call(this,t)},e.prototype.renderMonths=function(t,i,r){o.prototype.renderMonths.call(this,t,this.value,r)},e.prototype.renderDays=function(t,i,r,n,s,a){var l=o.prototype.renderDays.call(this,t,this.value,this.isMultiSelection,this.values,s,a);return this.isMultiSelection&&o.prototype.validateValues.call(this,this.isMultiSelection,this.values),l},e.prototype.renderYears=function(t){this.calendarMode==="Gregorian"?o.prototype.renderYears.call(this,t,this.value):this.islamicModule.islamicRenderYears(t,this.value)},e.prototype.renderDecades=function(t){this.calendarMode==="Gregorian"?o.prototype.renderDecades.call(this,t,this.value):this.islamicModule.islamicRenderDecade(t,this.value)},e.prototype.renderTemplate=function(t,i,r,n){this.calendarMode==="Gregorian"?o.prototype.renderTemplate.call(this,t,i,r,n,this.value):this.islamicModule.islamicRenderTemplate(t,i,r,n,this.value),this.changedArgs={value:this.value,values:this.values},n&&n.type==="click"&&n.currentTarget.classList.contains(oa)?this.changeHandler(n):this.changeHandler()},e.prototype.clickHandler=function(t){var i=t.currentTarget;if(this.isPopupClicked=!0,i.classList.contains(oa))if(this.isMultiSelection){var r=this.copyValues(this.values);r.toString().indexOf(this.getIdValue(t,null).toString())===-1?(r.push(this.getIdValue(t,null)),this.setProperties({values:r},!0),this.setProperties({value:this.values[this.values.length-1]},!0)):this.previousDates=!0}else this.setProperties({value:this.getIdValue(t,null)},!0);var n=this.currentView();o.prototype.clickHandler.call(this,t,this.value),this.isMultiSelection&&this.currentDate!==this.value&&!g(this.tableBodyElement.querySelectorAll("."+Is)[0])&&n==="Year"&&this.tableBodyElement.querySelectorAll("."+Is)[0].classList.remove(Is)},e.prototype.switchView=function(t,i,r,n){o.prototype.switchView.call(this,t,i,this.isMultiSelection,n)},e.prototype.getModuleName=function(){return o.prototype.getModuleName.call(this),"calendar"},e.prototype.getPersistData=function(){o.prototype.getPersistData.call(this);var t=["value","values"];return this.addOnPersist(t)},e.prototype.onPropertyChanged=function(t,i){this.effect="",this.rangeValidation(this.min,this.max);for(var r=0,n=Object.keys(t);r<n.length;r++){var s=n[r];switch(s){case"value":this.isDateSelected&&(typeof t.value=="string"?this.setProperties({value:new Date(this.checkValue(t.value))},!0):t.value=new Date(this.checkValue(t.value)),isNaN(+this.value)&&this.setProperties({value:i.value},!0),this.update());break;case"values":if(this.isDateSelected){if(typeof t.values=="string"||typeof t.values=="number")this.setProperties({values:null},!0);else{for(var a=this.copyValues(this.values),l=0;l<a.length;l++){var h=a[l];this.checkDateValue(h)&&!o.prototype.checkPresentDate.call(this,h,a)&&a.push(h)}this.setProperties({values:a},!0),this.values.length>0&&this.setProperties({value:t.values[t.values.length-1]},!0)}this.validateValues(this.isMultiSelection,this.values),this.update()}break;case"isMultiSelection":this.isDateSelected&&(this.setProperties({isMultiSelection:t.isMultiSelection},!0),this.update());break;case"enabled":this.setEnable(this.enabled);break;case"cssClass":this.getModuleName()==="calendar"&&this.setClass(t.cssClass,i.cssClass);break;default:o.prototype.onPropertyChanged.call(this,t,i,this.isMultiSelection,this.values)}}this.preventChange=this.isAngular&&this.preventChange?!this.preventChange:this.preventChange},e.prototype.destroy=function(){if(o.prototype.destroy.call(this),this.getModuleName()==="calendar"){this.changedArgs=null;var t=j(this.element,"form");t&&E.remove(t,"reset",this.formResetHandler.bind(this))}},e.prototype.navigateTo=function(t,i,r){this.minMaxUpdate(),o.prototype.navigateTo.call(this,t,i,r)},e.prototype.currentView=function(){return o.prototype.currentView.call(this)},e.prototype.addDate=function(t){if(typeof t!="string"&&typeof t!="number"){var i=this.copyValues(this.values);if(typeof t=="object"&&t.length>0)for(var r=t,n=0;n<r.length;n++)this.checkDateValue(r[n])&&!o.prototype.checkPresentDate.call(this,r[n],i)&&(!g(i)&&i.length>0?i.push(r[n]):i=[new Date(+r[n])]);else this.checkDateValue(t)&&!o.prototype.checkPresentDate.call(this,t,i)&&(!g(i)&&i.length>0?i.push(t):i=[new Date(+t)]);this.setProperties({values:i},!0),this.isMultiSelection&&this.setProperties({value:this.values[this.values.length-1]},!0),this.validateValues(this.isMultiSelection,i),this.update(),this.changedArgs={value:this.value,values:this.values},this.changeHandler()}},e.prototype.removeDate=function(t){if(typeof t!="string"&&typeof t!="number"&&!g(this.values)&&this.values.length>0){var i=this.copyValues(this.values);if(typeof t=="object"&&t.length>0)for(var r=t,n=0;n<r.length;n++)for(var s=0;s<i.length;s++)+i[s]==+r[n]&&i.splice(s,1);else for(var s=0;s<i.length;s++)+i[s]==+t&&i.splice(s,1);this.setProperties({values:i},!1),this.update(),this.isMultiSelection&&this.setProperties({value:this.values[this.values.length-1]},!0),this.changedArgs={value:this.value,values:this.values},this.changeHandler()}},e.prototype.setTodayDate=function(t){var i=new Date(+t);this.setProperties({value:i},!0),o.prototype.todayButtonClick.call(this,null,i,!0)},e.prototype.update=function(){this.validateDate(),this.minMaxUpdate(),o.prototype.setValueUpdate.call(this)},e.prototype.selectDate=function(t,i,r){o.prototype.selectDate.call(this,t,i,r,this.isMultiSelection,this.values),this.isMultiSelection&&!g(this.values)&&this.values.length>0&&this.setProperties({value:this.values[this.values.length-1]},!0),this.changedArgs={value:this.value,values:this.values},this.changeHandler(t)},e.prototype.changeEvent=function(t){((this.value&&this.value.valueOf())!==(this.previousDate&&+this.previousDate.valueOf())||this.isMultiSelection)&&(this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",this.changedArgs),this.previousDate=new Date(+this.value))},e.prototype.triggerChange=function(t){!g(this.todayButtonEvent)&&this.isTodayClicked&&(t=this.todayButtonEvent,this.isTodayClicked=!1),this.changedArgs.event=t||null,this.changedArgs.isInteracted=!g(t),g(this.value)||this.setProperties({value:this.value},!0),!this.isMultiSelection&&+this.value!==Number.NaN&&(!g(this.value)&&!g(this.previousDate)||this.previousDate===null&&!isNaN(+this.value))?this.changeEvent(t):!g(this.values)&&this.previousValues!==this.values.length&&(this.changeEvent(t),this.previousValues=this.values.length)},mr([C(null)],e.prototype,"value",void 0),mr([C(null)],e.prototype,"values",void 0),mr([C(!1)],e.prototype,"isMultiSelection",void 0),mr([q()],e.prototype,"change",void 0),e=mr([bt],e),e}($5);var Z5=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ki=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},J5="e-date-wrapper",vm="e-datepicker",e_="e-lib",t_="e-control",Ak="e-popup-wrapper",i_="e-input-group-icon",r_="e-popup",n_="e-input-group",Fw="e-input-focus",s_="e-input",Tk="e-error",mm="e-active",Lk="e-date-overflow",a_="e-date-icon",o_="e-icons",l_=300,h_=4,ym="e-selected",u_="e-focused-date",Ow="e-non-edit",kk=["title","class","style"],zw=function(o){Z5(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.isDateIconClicked=!1,r.isAltKeyPressed=!1,r.isInteracted=!0,r.invalidValueString=null,r.checkPreviousValue=null,r.maskedDateValue="",r.preventChange=!1,r.isIconClicked=!1,r.isDynamicValueChanged=!1,r.moduleName=r.getModuleName(),r.isFocused=!1,r.isBlur=!1,r.isKeyAction=!1,r.datepickerOptions=t,r}return e.prototype.render=function(){this.initialize(),this.bindEvents(),this.floatLabelType!=="Never"&&Ce.calculateWidth(this.inputElement,this.inputWrapper.container),!g(this.inputWrapper.buttons[0])&&!g(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon"),!g(j(this.element,"fieldset"))&&j(this.element,"fieldset").disabled&&(this.enabled=!1),this.renderComplete(),this.setTimeZone(this.serverTimezoneOffset)},e.prototype.setTimeZone=function(t){if(!g(this.serverTimezoneOffset)&&this.value){var i=new Date().getTimezoneOffset()/60,r=t,n=r+i;n=this.isDayLightSaving()?n--:n,this.value=new Date(this.value.getTime()+n*60*60*1e3),this.updateInput()}},e.prototype.isDayLightSaving=function(){var t=new Date(this.value.getFullYear(),0,1).getTimezoneOffset(),i=new Date(this.value.getFullYear(),6,1).getTimezoneOffset();return this.value.getTimezoneOffset()<Math.max(t,i)},e.prototype.setAllowEdit=function(){this.allowEdit?this.readonly||this.inputElement.removeAttribute("readonly"):Ie(this.inputElement,{readonly:""}),this.updateIconState()},e.prototype.updateIconState=function(){!this.allowEdit&&this.inputWrapper&&!this.readonly?this.inputElement.value===""?K([this.inputWrapper.container],[Ow]):Y([this.inputWrapper.container],[Ow]):this.inputWrapper&&K([this.inputWrapper.container],[Ow])},e.prototype.initialize=function(){this.checkInvalidValue(this.value),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"}),this.createInput(),this.updateHtmlAttributeToWrapper(),this.setAllowEdit(),this.enableMask&&!this.value&&this.maskedDateValue&&(this.floatLabelType==="Always"||!this.floatLabelType||!this.placeholder)?(this.updateInput(!0),this.updateInputValue(this.maskedDateValue)):this.enableMask||this.updateInput(!0),this.previousElementValue=this.inputElement.value,this.previousDate=g(this.value)?null:new Date(+this.value),this.inputElement.setAttribute("value",this.inputElement.value),this.inputValueCopy=this.value},e.prototype.createInput=function(){var t={"aria-atomic":"true","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-invalid":"false"};if(this.getModuleName()==="datepicker"){var i={placeholder:this.placeholder};this.globalize=new Et(this.locale),this.l10n=new Li("datepicker",i,this.locale),this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0)}this.fullScreenMode&&B.isDevice&&(this.cssClass+=" e-popup-expand");var r=this.cssClass;!g(this.cssClass)&&this.cssClass!==""&&(r=this.cssClass.replace(/\s+/g," ").trim());var n=!this.enableMask;this.inputWrapper=Ce.createInput({element:this.inputElement,floatLabelType:this.floatLabelType,bindClearAction:n,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:r,enabled:this.enabled,enableRtl:this.enableRtl,showClearButton:this.showClearButton},buttons:[i_+" "+a_+" "+o_]},this.createElement),this.setWidth(this.width),this.inputElement.name!==""?this.inputElement.setAttribute("name",""+this.inputElement.getAttribute("name")):this.inputElement.setAttribute("name",""+this.element.id),Ie(this.inputElement,t),this.inputElement.hasAttribute("aria-label")||this.inputElement.setAttribute("aria-label",this.getModuleName()),this.enabled?(this.inputElement.setAttribute("aria-disabled","false"),this.inputElement.setAttribute("tabindex",this.tabIndex)):(this.inputElement.setAttribute("aria-disabled","true"),this.inputElement.tabIndex=-1),Ce.addAttributes({"aria-label":"select",role:"button"},this.inputWrapper.buttons[0]),Y([this.inputWrapper.container],J5)},e.prototype.updateInput=function(t,i){t===void 0&&(t=!1),i===void 0&&(i=!1);var r;if(this.value&&!this.isCalendar()&&this.disabledDates(t,i),isNaN(+new Date(this.checkValue(this.value)))&&this.setProperties({value:null},!0),this.strictMode&&(o.prototype.validateDate.call(this),this.minMaxUpdates(),o.prototype.minMaxUpdate.call(this)),!g(this.value)){var n=this.value,s=void 0,a=g(this.formatString)?this.dateTimeFormat:this.formatString;if(this.getModuleName()==="datetimepicker"?this.calendarMode==="Gregorian"?s=this.globalize.formatDate(this.value,{format:a,type:"dateTime",skeleton:"yMd"}):s=this.globalize.formatDate(this.value,{format:a,type:"dateTime",skeleton:"yMd",calendar:"islamic"}):(this.calendarMode==="Gregorian"?r={format:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"},s=this.globalize.formatDate(this.value,r)),+n<=+this.max&&+n>=+this.min)this.updateInputValue(s);else{var l=+n>=+this.max||!+this.value||!+this.value||+n<=+this.min;!this.strictMode&&l&&this.updateInputValue(s)}}g(this.value)&&this.strictMode&&(this.enableMask?(this.updateInputValue(this.maskedDateValue),this.notify("createMask",{module:"MaskedDateTime"})):this.updateInputValue("")),!this.strictMode&&g(this.value)&&this.invalidValueString&&this.updateInputValue(this.invalidValueString),this.changedArgs={value:this.value},this.errorClass(),this.updateIconState()},e.prototype.minMaxUpdates=function(){!g(this.value)&&this.value<this.min&&this.min<=this.max&&this.strictMode?(this.setProperties({value:this.min},!0),this.changedArgs={value:this.value}):!g(this.value)&&this.value>this.max&&this.min<=this.max&&this.strictMode&&(this.setProperties({value:this.max},!0),this.changedArgs={value:this.value})},e.prototype.checkStringValue=function(t){var i=null,r=null,n=null;if(this.getModuleName()==="datetimepicker"){var s=new Et(this.locale);this.calendarMode==="Gregorian"?(r={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd"},n={format:s.getDatePattern({skeleton:"yMd"}),type:"dateTime"}):(r={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd",calendar:"islamic"},n={format:s.getDatePattern({skeleton:"yMd"}),type:"dateTime",calendar:"islamic"})}else this.calendarMode==="Gregorian"?r={format:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};return i=this.checkDateValue(this.globalize.parseDate(this.getAmPmValue(t),r)),g(i)&&this.getModuleName()==="datetimepicker"&&(i=this.checkDateValue(this.globalize.parseDate(this.getAmPmValue(t),n))),i},e.prototype.checkInvalidValue=function(t){if(!(t instanceof Date)&&!g(t)){var i=null,r=t;typeof t=="number"&&(r=t.toString());var n=null,s=null;if(this.getModuleName()==="datetimepicker"){var a=new Et(this.locale);this.calendarMode==="Gregorian"?(n={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd"},s={format:a.getDatePattern({skeleton:"yMd"}),type:"dateTime"}):(n={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd",calendar:"islamic"},s={format:a.getDatePattern({skeleton:"yMd"}),type:"dateTime",calendar:"islamic"})}else this.calendarMode==="Gregorian"?n={format:this.formatString,type:"dateTime",skeleton:"yMd"}:n={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};var l=!1;if(typeof r!="string")r=null,l=!0;else if(typeof r=="string"&&(r=r.trim()),i=this.checkStringValue(r),!i){var h=null,u=null;h=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,u=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,!h.test(r)&&!u.test(r)||/^[a-zA-Z0-9- ]*$/.test(r)||isNaN(+new Date(this.checkValue(r)))?l=!0:i=new Date(r)}l?(this.strictMode||(this.invalidValueString=r),this.setProperties({value:null},!0)):this.setProperties({value:i},!0)}},e.prototype.bindInputEvent=function(){(!g(this.formatString)||this.enableMask)&&(this.enableMask||this.formatString.indexOf("y")===-1?E.add(this.inputElement,"input",this.inputHandler,this):E.remove(this.inputElement,"input",this.inputHandler))},e.prototype.bindEvents=function(){E.add(this.inputWrapper.buttons[0],"mousedown",this.dateIconHandler,this),E.add(this.inputElement,"mouseup",this.mouseUpHandler,this),E.add(this.inputElement,"focus",this.inputFocusHandler,this),E.add(this.inputElement,"blur",this.inputBlurHandler,this),E.add(this.inputElement,"keyup",this.keyupHandler,this),this.enableMask&&E.add(this.inputElement,"keydown",this.keydownHandler,this),this.bindInputEvent(),E.add(this.inputElement,"change",this.inputChangeHandler,this),this.showClearButton&&this.inputWrapper.clearButton&&E.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this),this.formElement&&E.add(this.formElement,"reset",this.resetFormHandler,this),this.defaultKeyConfigs=he(this.defaultKeyConfigs,this.keyConfigs),this.keyboardModules=new $i(this.inputElement,{eventName:"keydown",keyAction:this.inputKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})},e.prototype.keydownHandler=function(t){switch(t.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":case"Home":case"End":case"Backspace":case"Delete":this.enableMask&&!this.popupObj&&!this.readonly&&(t.code!=="Delete"&&t.code!=="Backspace"&&t.preventDefault(),this.notify("keyDownHandler",{module:"MaskedDateTime",e:t}));break}},e.prototype.unBindEvents=function(){g(this.inputWrapper)||E.remove(this.inputWrapper.buttons[0],"mousedown",this.dateIconHandler),E.remove(this.inputElement,"mouseup",this.mouseUpHandler),E.remove(this.inputElement,"focus",this.inputFocusHandler),E.remove(this.inputElement,"blur",this.inputBlurHandler),E.remove(this.inputElement,"change",this.inputChangeHandler),E.remove(this.inputElement,"keyup",this.keyupHandler),this.enableMask&&E.remove(this.inputElement,"keydown",this.keydownHandler),this.showClearButton&&this.inputWrapper.clearButton&&E.remove(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler),this.formElement&&E.remove(this.formElement,"reset",this.resetFormHandler)},e.prototype.resetFormHandler=function(){if(this.enabled&&!this.inputElement.disabled){var t=this.inputElement.getAttribute("value");(this.element.tagName==="EJS-DATEPICKER"||this.element.tagName==="EJS-DATETIMEPICKER")&&(t="",this.inputValueCopy=null,this.inputElement.setAttribute("value","")),this.setProperties({value:this.inputValueCopy},!0),this.restoreValue(),this.inputElement&&(this.updateInputValue(t),this.errorClass())}},e.prototype.restoreValue=function(){this.currentDate=this.value?this.value:new Date,this.previousDate=this.value,this.previousElementValue=g(this.inputValueCopy)?"":this.globalize.formatDate(this.inputValueCopy,{format:this.formatString,type:"dateTime",skeleton:"yMd"})},e.prototype.inputChangeHandler=function(t){this.enabled&&t.stopPropagation()},e.prototype.bindClearEvent=function(){this.showClearButton&&this.inputWrapper.clearButton&&E.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this)},e.prototype.resetHandler=function(t){this.enabled&&(t.preventDefault(),this.clear(t))},e.prototype.mouseUpHandler=function(t){this.enableMask&&(t.preventDefault(),this.notify("setMaskSelection",{module:"MaskedDateTime"}))},e.prototype.clear=function(t){this.setProperties({value:null},!0),this.enableMask||this.updateInputValue("");var i={event:t};if(this.trigger("cleared",i),this.invalidValueString="",this.updateInput(),this.popupUpdate(),this.changeEvent(t),this.enableMask&&this.notify("clearHandler",{module:"MaskedDateTime"}),j(this.element,"form")){var r=this.element,n=document.createEvent("KeyboardEvent");n.initEvent("keyup",!1,!0),r.dispatchEvent(n)}},e.prototype.preventEventBubbling=function(t){t.preventDefault(),this.interopAdaptor.invokeMethodAsync("OnDateIconClick")},e.prototype.updateInputValue=function(t){Ce.setValue(t,this.inputElement,this.floatLabelType,this.showClearButton)},e.prototype.dateIconHandler=function(t){this.enabled&&(this.isIconClicked=!0,B.isDevice&&(this.inputElement.setAttribute("readonly",""),this.inputElement.blur()),t.preventDefault(),this.readonly||(this.isCalendar()?this.hide(t):(this.isDateIconClicked=!0,this.show(null,t),this.getModuleName()==="datetimepicker"&&this.inputElement.focus(),this.inputElement.focus(),Y([this.inputWrapper.container],[Fw]),Y(this.inputWrapper.buttons,mm))),this.isIconClicked=!1)},e.prototype.updateHtmlAttributeToWrapper=function(){if(!g(this.htmlAttributes))for(var t=0,i=Object.keys(this.htmlAttributes);t<i.length;t++){var r=i[t];if(!g(this.htmlAttributes[""+r])&&kk.indexOf(r)>-1)if(r==="class"){var n=this.htmlAttributes[""+r].replace(/\s+/g," ").trim();n!==""&&Y([this.inputWrapper.container],n.split(" "))}else if(r==="style"){var s=this.inputWrapper.container.getAttribute(r);g(s)?s=this.htmlAttributes[""+r]:s.charAt(s.length-1)===";"?s=s+this.htmlAttributes[""+r]:s=s+";"+this.htmlAttributes[""+r],this.inputWrapper.container.setAttribute(r,s)}else this.inputWrapper.container.setAttribute(r,this.htmlAttributes[""+r])}},e.prototype.updateHtmlAttributeToElement=function(){if(!g(this.htmlAttributes))for(var t=0,i=Object.keys(this.htmlAttributes);t<i.length;t++){var r=i[t];kk.indexOf(r)<0&&this.inputElement.setAttribute(r,this.htmlAttributes[""+r])}},e.prototype.updateCssClass=function(t,i){g(i)||(i=i.replace(/\s+/g," ").trim()),g(t)||(t=t.replace(/\s+/g," ").trim()),Ce.setCssClass(t,[this.inputWrapper.container],i),this.popupWrapper&&Ce.setCssClass(t,[this.popupWrapper],i)},e.prototype.calendarKeyActionHandle=function(t){switch(t.action){case"escape":this.isCalendar()?this.hide(t):this.inputWrapper.container.children[this.index].blur();break;case"enter":this.isCalendar()?+this.value!=+this.currentDate&&!this.isCalendar()&&this.inputWrapper.container.children[this.index].focus():this.show(null,t),this.getModuleName()==="datetimepicker"&&this.inputElement.focus();break}},e.prototype.inputFocusHandler=function(){if(this.isFocused=!0,!!this.enabled){this.enableMask&&!this.inputElement.value&&this.placeholder&&this.maskedDateValue&&!this.value&&(this.floatLabelType==="Auto"||this.floatLabelType==="Never"||this.placeholder)&&(this.updateInputValue(this.maskedDateValue),this.inputElement.selectionStart=0,this.inputElement.selectionEnd=this.inputElement.value.length),this.enableMask&&this.showClearButton&&this.inputElement&&this.inputElement.value===this.maskedDateValue&&this.inputWrapper&&this.inputWrapper.clearButton&&!this.inputWrapper.clearButton.classList.contains("e-clear-icon-hide")&&this.inputWrapper.clearButton.classList.add("e-clear-icon-hide");var t={model:this};this.isDateIconClicked=!1,this.trigger("focus",t),this.updateIconState(),this.openOnFocus&&!this.isIconClicked&&this.show()}},e.prototype.inputHandler=function(t){this.isPopupClicked=!1,this.enableMask&&(!g(t)&&!g(t.inputType)&&t.inputType==="insertFromPaste"?this.notify("maskPasteInputHandler",{module:"MaskedDateTime"}):this.notify("inputHandler",{module:"MaskedDateTime"}))},e.prototype.inputBlurHandler=function(t){if(this.enabled){if(this.strictModeUpdate(),this.inputElement.value===""&&g(this.value)&&(this.invalidValueString=null,this.updateInputValue("")),this.isBlur=!0,this.updateInput(!1,!0),this.isBlur=!1,this.popupUpdate(),this.changeTrigger(t),this.enableMask&&this.maskedDateValue&&this.placeholder&&this.floatLabelType!=="Always"&&this.inputElement.value===this.maskedDateValue&&!this.value&&(this.floatLabelType==="Auto"||this.floatLabelType==="Never"||this.placeholder)&&this.updateInputValue(""),this.errorClass(),this.isCalendar()&&document.activeElement===this.inputElement&&this.hide(t),this.getModuleName()==="datepicker"){var i={model:this};this.trigger("blur",i)}this.isCalendar()&&(this.defaultKeyConfigs=he(this.defaultKeyConfigs,this.keyConfigs),this.calendarKeyboardModules=new $i(this.calendarElement.children[1].firstElementChild,{eventName:"keydown",keyAction:this.calendarKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})),this.isPopupClicked=!1}},e.prototype.documentHandler=function(t){!g(this.popupObj)&&!g(this.inputWrapper)&&(this.inputWrapper.container.contains(t.target)&&t.type!=="mousedown"||this.popupObj.element&&this.popupObj.element.contains(t.target))&&t.type!=="touchstart"&&t.preventDefault();var i=t.target;!j(i,".e-datepicker.e-popup-wrapper")&&!g(this.inputWrapper)&&j(i,"."+n_)!==this.inputWrapper.container&&!i.classList.contains("e-day")&&!i.classList.contains("e-dlg-overlay")?(this.hide(t),this.focusOut()):j(i,".e-datepicker.e-popup-wrapper")&&(i.classList.contains("e-day")&&!g(t.target.parentElement)&&t.target.parentElement.classList.contains("e-selected")&&j(i,".e-content")&&j(i,".e-content").classList.contains("e-"+this.depth.toLowerCase())?this.hide(t):j(i,".e-footer-container")&&i.classList.contains("e-today")&&i.classList.contains("e-btn")&&+new Date(+this.value)==+o.prototype.generateTodayVal.call(this,this.value)&&this.hide(t))},e.prototype.inputKeyActionHandle=function(t){var i=this.currentView();switch(t.action){case"altUpArrow":this.isAltKeyPressed=!1,this.hide(t),this.inputElement.focus();break;case"altDownArrow":this.isAltKeyPressed=!0,this.strictModeUpdate(),this.updateInput(),this.changeTrigger(t),this.getModuleName()==="datepicker"&&this.show(null,t);break;case"escape":this.hide(t);break;case"enter":this.strictModeUpdate(),this.updateInput(),this.popupUpdate(),this.changeTrigger(t),this.errorClass(),!this.isCalendar()&&document.activeElement===this.inputElement&&this.hide(t),this.isCalendar()&&(t.preventDefault(),t.stopPropagation());break;case"tab":case"shiftTab":{var r=this.inputElement.selectionStart,n=this.inputElement.selectionEnd;if(this.enableMask&&!this.popupObj&&!this.readonly){var s=this.inputElement.value.length;(r===0&&n===s||n!==s&&t.action==="tab"||r!==0&&t.action==="shiftTab")&&t.preventDefault(),this.notify("keyDownHandler",{module:"MaskedDateTime",e:t}),r=this.inputElement.selectionStart,n=this.inputElement.selectionEnd}this.strictModeUpdate(),this.updateInput(),this.popupUpdate(),this.changeTrigger(t),this.errorClass(),this.enableMask&&(this.inputElement.selectionStart=r,this.inputElement.selectionEnd=n),t.action==="tab"&&t.target===this.inputElement&&this.isCalendar()&&document.activeElement===this.inputElement&&(t.preventDefault(),this.headerTitleElement.focus()),t.action==="shiftTab"&&t.target===this.inputElement&&this.isCalendar()&&document.activeElement===this.inputElement&&this.hide(t);break}default:this.defaultAction(t),t.action==="select"&&i===this.depth&&this.hide(t)}},e.prototype.defaultAction=function(t){this.previousDate=!g(this.value)&&new Date(+this.value)||null,this.isCalendar()&&(o.prototype.keyActionHandle.call(this,t),this.isCalendar()&&Ie(this.inputElement,{"aria-activedescendant":""+this.setActiveDescendant()}))},e.prototype.popupUpdate=function(){if((g(this.value)&&!g(this.previousDate)||this.getModuleName()!=="datetimepicker"&&+this.value!=+this.previousDate||this.getModuleName()==="datetimepicker"&&+this.value!=+this.previousDateTime)&&(this.popupObj&&this.popupObj.element.querySelectorAll("."+ym).length>0&&K(this.popupObj.element.querySelectorAll("."+ym),[ym]),!g(this.value)&&+this.value>=+this.min&&+this.value<=+this.max)){var t=new Date(this.checkValue(this.value));o.prototype.navigateTo.call(this,"Month",t)}},e.prototype.strictModeUpdate=function(){var t,i=/^y/,r=/[^a-zA-Z]/,n;if(this.getModuleName()==="datetimepicker"?t=g(this.formatString)?this.dateTimeFormat:this.formatString:(!i.test(this.formatString)||r.test(this.formatString))&&(t=g(this.formatString)?this.formatString:this.formatString.replace("dd","d")),g(t))t=this.formatString;else{var s=t.split("M").length-1;s<3&&(t=t.replace("MM","M"))}var a;this.getModuleName()==="datetimepicker"?this.calendarMode==="Gregorian"?a={format:g(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd"}:a={format:g(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}:(this.calendarMode==="Gregorian"?n={format:t,type:"dateTime",skeleton:"yMd"}:n={format:t,type:"dateTime",skeleton:"yMd",calendar:"islamic"},a=n);var l;if(typeof this.inputElement.value=="string"&&(this.inputElement.value=this.inputElement.value.trim()),this.getModuleName()==="datetimepicker"){if(this.checkDateValue(this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),a))?l=this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),a):(this.calendarMode==="Gregorian"?n={format:t,type:"dateTime",skeleton:"yMd"}:n={format:t,type:"dateTime",skeleton:"yMd",calendar:"islamic"},l=this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),n)),(g(l)||typeof l=="object"&&isNaN(l.getTime()))&&!g(this.inputFormatsString))for(var h=0,u=this.inputFormatsString;h<u.length;h++){var c=u[h],d=void 0;if(this.calendarMode==="Gregorian"?d={format:c,type:"dateTime",skeleton:"yMd"}:d={format:c,type:"dateTime",skeleton:"yMd",calendar:"islamic"},l=this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),d),!g(l)&&l instanceof Date&&!isNaN(l.getTime()))break}}else{if(l=this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),a),(g(l)||typeof l=="object"&&isNaN(l.getTime()))&&!g(this.inputFormatsString))for(var p=0,f=this.inputFormatsString;p<f.length;p++){var v=f[p],d=void 0;if(this.calendarMode==="Gregorian"?d={format:v,type:"dateTime",skeleton:"yMd"}:d={format:v,type:"dateTime",skeleton:"yMd",calendar:"islamic"},l=this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),d),!g(l)&&l instanceof Date&&!isNaN(l.getTime()))break}l=!g(l)&&isNaN(+l)?null:l,!g(this.formatString)&&this.inputElement.value!==""&&this.strictMode&&(this.isPopupClicked||!this.isPopupClicked&&this.inputElement.value===this.previousElementValue)&&this.formatString.indexOf("y")===-1&&l.setFullYear(this.value.getFullYear())}this.getModuleName()==="datepicker"&&this.value&&!isNaN(+this.value)&&l&&l.setHours(this.value.getHours(),this.value.getMinutes(),this.value.getSeconds(),this.value.getMilliseconds()),this.strictMode&&l?(this.updateInputValue(this.globalize.formatDate(l,a)),this.inputElement.value!==this.previousElementValue&&this.setProperties({value:l},!0)):this.strictMode||this.inputElement.value!==this.previousElementValue&&this.setProperties({value:l},!0),this.strictMode&&!l&&this.inputElement.value===(this.enableMask?this.maskedDateValue:"")&&this.setProperties({value:null},!0),isNaN(+this.value)&&this.setProperties({value:null},!0),g(this.value)&&(this.currentDate=new Date(new Date().setHours(0,0,0,0)))},e.prototype.createCalendar=function(){var t=this;this.popupWrapper=this.createElement("div",{className:""+vm+" "+Ak,id:this.inputElement.id+"_options"}),this.popupWrapper.setAttribute("aria-label",this.element.id),this.popupWrapper.setAttribute("role","dialog"),g(this.cssClass)||(this.popupWrapper.className+=" "+this.cssClass),B.isDevice&&(this.modelHeader(),this.modal=this.createElement("div"),this.modal.className=""+vm+" e-date-modal",document.body.className+=" "+Lk,this.modal.style.display="block",document.body.appendChild(this.modal)),this.calendarElement.querySelector("table tbody").className="",this.popupObj=new Gn(this.popupWrapper,{content:this.calendarElement,relateTo:B.isDevice?document.body:this.inputWrapper.container,position:B.isDevice?{X:"center",Y:"center"}:this.enableRtl?{X:"right",Y:"bottom"}:{X:"left",Y:"bottom"},offsetY:h_,targetType:"container",enableRtl:this.enableRtl,zIndex:this.zIndex,collision:B.isDevice?{X:"fit",Y:"fit"}:this.enableRtl?{X:"fit",Y:"flip"}:{X:"flip",Y:"flip"},open:function(){B.isDevice&&t.fullScreenMode&&(t.iconRight=parseInt(window.getComputedStyle(t.calendarElement.querySelector(".e-header.e-month .e-prev")).marginRight,10)>16,t.touchModule=new Fr(t.calendarElement.querySelector(".e-content.e-month"),{swipe:t.CalendarSwipeHandler.bind(t)}),E.add(t.calendarElement.querySelector(".e-content.e-month"),"touchstart",t.TouchStartHandler,t)),t.getModuleName()!=="datetimepicker"&&document.activeElement!==t.inputElement&&(t.defaultKeyConfigs=he(t.defaultKeyConfigs,t.keyConfigs),t.calendarElement.children[1].firstElementChild.focus(),t.calendarKeyboardModules=new $i(t.calendarElement.children[1].firstElementChild,{eventName:"keydown",keyAction:t.calendarKeyActionHandle.bind(t),keyConfigs:t.defaultKeyConfigs}),t.calendarKeyboardModules=new $i(t.inputWrapper.container.children[t.index],{eventName:"keydown",keyAction:t.calendarKeyActionHandle.bind(t),keyConfigs:t.defaultKeyConfigs}))},close:function(){t.isDateIconClicked&&t.inputWrapper.container.children[t.index].focus(),t.value&&t.disabledDates(),t.popupObj&&t.popupObj.destroy(),t.resetCalendar(),ee(t.popupWrapper),t.popupObj=t.popupWrapper=null,t.preventArgs=null,t.calendarKeyboardModules=null,t.setAriaAttributes()},targetExitViewport:function(){B.isDevice||t.hide()}}),this.popupObj.element.className+=" "+this.cssClass,this.setAriaAttributes()},e.prototype.getAmPmValue=function(t){try{return typeof t=="string"&&t.trim()!==""?t.replace(/(am|pm|Am|aM|pM|Pm)/g,function(i){return i.toLocaleUpperCase()}):""}catch(i){return console.error("Error occurred while processing date:",i),""}},e.prototype.CalendarSwipeHandler=function(t){var i=0;if(this.iconRight)switch(t.swipeDirection){case"Left":i=1;break;case"Right":i=-1;break}else switch(t.swipeDirection){case"Up":i=1;break;case"Down":i=-1;break}this.touchStart&&(i===1?this.navigateNext(t):i===-1&&this.navigatePrevious(t),this.touchStart=!1)},e.prototype.TouchStartHandler=function(t){this.touchStart=!0},e.prototype.setAriaDisabled=function(){this.enabled?(this.inputElement.setAttribute("aria-disabled","false"),this.inputElement.setAttribute("tabindex",this.tabIndex)):(this.inputElement.setAttribute("aria-disabled","true"),this.inputElement.tabIndex=-1)},e.prototype.modelHeader=function(){var t,i=this.createElement("div",{className:"e-model-header"}),r=this.createElement("h1",{className:"e-model-year"}),n=this.createElement("div"),s=this.createElement("span",{className:"e-model-day"}),a=this.createElement("span",{className:"e-model-month"});if(this.calendarMode==="Gregorian"?t={format:"y",skeleton:"dateTime"}:t={format:"y",skeleton:"dateTime",calendar:"islamic"},r.textContent=""+this.globalize.formatDate(this.value||new Date,t),this.calendarMode==="Gregorian"?t={format:"E",skeleton:"dateTime"}:t={format:"E",skeleton:"dateTime",calendar:"islamic"},s.textContent=""+this.globalize.formatDate(this.value||new Date,t)+", ",this.calendarMode==="Gregorian"?t={format:"MMM d",skeleton:"dateTime"}:t={format:"MMM d",skeleton:"dateTime",calendar:"islamic"},a.textContent=""+this.globalize.formatDate(this.value||new Date,t),this.fullScreenMode){var l=this.createElement("span",{className:"e-popup-close"});E.add(l,"mousedown touchstart",this.modelCloseHandler,this);var h=this.calendarElement.querySelector("button.e-today");n.classList.add("e-day-wrapper"),h.classList.add("e-outline"),i.appendChild(l),i.appendChild(h)}this.fullScreenMode||i.appendChild(r),n.appendChild(s),n.appendChild(a),i.appendChild(n),this.calendarElement.insertBefore(i,this.calendarElement.firstElementChild)},e.prototype.modelCloseHandler=function(t){this.hide()},e.prototype.changeTrigger=function(t){this.inputElement.value!==this.previousElementValue&&(this.previousDate&&this.previousDate.valueOf())!==(this.value&&this.value.valueOf())&&(this.isDynamicValueChanged&&this.isCalendar()&&this.popupUpdate(),this.changedArgs.value=this.value,this.changedArgs.event=t||null,this.changedArgs.element=this.element,this.changedArgs.isInteracted=!g(t),this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",this.changedArgs),this.previousElementValue=this.inputElement.value,this.previousDate=isNaN(+new Date(this.checkValue(this.value)))?null:new Date(this.checkValue(this.value)),this.isInteracted=!0),this.isKeyAction=!1},e.prototype.navigatedEvent=function(t){he(this.navigatedArgs,{name:"navigated",event:t}),this.trigger("navigated",this.navigatedArgs)},e.prototype.keyupHandler=function(t){this.isKeyAction=this.inputElement.value!==this.previousElementValue,this.enableMask&&this.showClearButton&&this.inputElement&&this.inputElement.value===this.maskedDateValue&&this.inputWrapper&&this.inputWrapper.clearButton&&!this.inputWrapper.clearButton.classList.contains("e-clear-icon-hide")&&this.inputWrapper.clearButton.classList.add("e-clear-icon-hide")},e.prototype.changeEvent=function(t){!this.isIconClicked&&!(this.isBlur||this.isKeyAction)&&this.selectCalendar(t),(this.previousDate&&this.previousDate.valueOf())!==(this.value&&this.value.valueOf())?(this.changedArgs.event=t||null,this.changedArgs.element=this.element,this.changedArgs.isInteracted=this.isInteracted,this.isDynamicValueChanged||this.trigger("change",this.changedArgs),this.previousDate=this.value&&new Date(+this.value),this.isDynamicValueChanged||this.hide(t),this.previousElementValue=this.inputElement.value,this.errorClass()):t&&this.hide(t),this.isKeyAction=!1},e.prototype.requiredModules=function(){var t=[];return this.calendarMode==="Islamic"&&t.push({args:[this],member:"islamic",name:"Islamic"}),this.enableMask&&t.push({args:[this],member:"MaskedDateTime"}),t},e.prototype.selectCalendar=function(t){var i,r,n;this.getModuleName()==="datetimepicker"?r=g(this.formatString)?this.dateTimeFormat:this.formatString:r=this.formatString,this.value&&(this.getModuleName()==="datetimepicker"?(this.calendarMode==="Gregorian"?n={format:r,type:"dateTime",skeleton:"yMd"}:n={format:r,type:"dateTime",skeleton:"yMd",calendar:"islamic"},i=this.globalize.formatDate(this.changedArgs.value,n)):(this.calendarMode==="Gregorian"?n={format:this.formatString,type:"dateTime",skeleton:"yMd"}:n={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"},i=this.globalize.formatDate(this.changedArgs.value,n)),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"})),g(i)||(this.updateInputValue(i),this.enableMask&&this.notify("setMaskSelection",{module:"MaskedDateTime"}))},e.prototype.isCalendar=function(){return!!(this.popupWrapper&&this.popupWrapper.classList.contains(""+Ak))},e.prototype.setWidth=function(t){typeof t=="number"?this.inputWrapper.container.style.width=Le(this.width):typeof t=="string"?this.inputWrapper.container.style.width=t.match(/px|%|em/)?this.width:Le(this.width):this.inputWrapper.container.style.width="100%"},e.prototype.show=function(t,i){var r=this;if(!(this.enabled&&this.readonly||!this.enabled||this.popupObj)){var n=!0,s=void 0;!g(this.value)&&!(+this.value>=+new Date(this.checkValue(this.min))&&+this.value<=+new Date(this.checkValue(this.max)))?(s=new Date(this.checkValue(this.value)),this.setProperties({value:null},!0)):s=this.value||null,this.isCalendar()||(o.prototype.render.call(this),this.setProperties({value:s||null},!0),this.previousDate=s,this.createCalendar()),B.isDevice&&(this.mobilePopupWrapper=this.createElement("div",{className:"e-datepick-mob-popup-wrap"}),document.body.appendChild(this.mobilePopupWrapper)),this.preventArgs={preventDefault:function(){n=!1},popup:this.popupObj,event:i||null,cancel:!1,appendTo:B.isDevice?this.mobilePopupWrapper:document.body};var a=this.preventArgs;this.trigger("open",a,function(l){if(r.preventArgs=l,n&&!r.preventArgs.cancel){Y(r.inputWrapper.buttons,mm),r.preventArgs.appendTo.appendChild(r.popupWrapper),r.popupObj.refreshPosition(r.inputElement);var h={name:"FadeIn",duration:B.isDevice?0:l_};if(r.zIndex===1e3?r.popupObj.show(new It(h),r.element):r.popupObj.show(new It(h),null),o.prototype.setOverlayIndex.call(r,r.mobilePopupWrapper,r.popupObj.element,r.modal,B.isDevice),r.setAriaAttributes(),B.isDevice){var u=r.createElement("div",{className:"e-dlg-overlay"});u.style.zIndex=(r.zIndex-1).toString(),r.mobilePopupWrapper.appendChild(u)}}else r.popupObj.destroy(),r.popupWrapper=r.popupObj=null;!g(r.inputElement)&&r.inputElement.value===""&&!g(r.tableBodyElement)&&r.tableBodyElement.querySelectorAll("td.e-selected").length>0&&(Y([r.tableBodyElement.querySelector("td.e-selected")],u_),K(r.tableBodyElement.querySelectorAll("td.e-selected"),ym)),E.add(document,"mousedown touchstart",r.documentHandler,r)})}},e.prototype.hide=function(t){var i=this;if(g(this.popupWrapper))B.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit();else{var r=!0;this.preventArgs={preventDefault:function(){r=!1},popup:this.popupObj,event:t||null,cancel:!1},K(this.inputWrapper.buttons,mm),K([document.body],Lk);var n=this.preventArgs;this.isCalendar()?this.trigger("close",n,function(s){i.closeEventCallback(r,s)}):this.closeEventCallback(r,n)}},e.prototype.closeEventCallback=function(t,i){this.preventArgs=i,this.isCalendar()&&t&&!this.preventArgs.cancel&&(this.popupObj.hide(),this.isAltKeyPressed=!1,this.keyboardModule.destroy(),K(this.inputWrapper.buttons,mm)),this.setAriaAttributes(),B.isDevice&&this.modal&&(this.modal.style.display="none",this.modal.outerHTML="",this.modal=null),B.isDevice&&!g(this.mobilePopupWrapper)&&t&&(g(this.preventArgs)||!this.preventArgs.cancel)&&(this.mobilePopupWrapper.remove(),this.mobilePopupWrapper=null),E.remove(document,"mousedown touchstart",this.documentHandler),B.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit()},e.prototype.focusIn=function(t){document.activeElement!==this.inputElement&&this.enabled&&(this.inputElement.focus(),Y([this.inputWrapper.container],[Fw]))},e.prototype.focusOut=function(){document.activeElement===this.inputElement&&(K([this.inputWrapper.container],[Fw]),this.inputElement.blur())},e.prototype.currentView=function(){var t;return this.calendarElement&&(t=o.prototype.currentView.call(this)),t},e.prototype.navigateTo=function(t,i){this.calendarElement&&o.prototype.navigateTo.call(this,t,i)},e.prototype.destroy=function(){this.unBindEvents(),this.showClearButton&&(this.clearButton=document.getElementsByClassName("e-clear-icon")[0]),o.prototype.destroy.call(this),Ce.destroy({element:this.inputElement,floatLabelType:this.floatLabelType,properties:this.properties},this.clearButton),g(this.keyboardModules)||this.keyboardModules.destroy(),this.popupObj&&this.popupObj.element.classList.contains(r_)&&o.prototype.destroy.call(this);var t={"aria-atomic":"true","aria-disabled":"true","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"};this.inputElement.hasAttribute("aria-label")&&this.inputElement.removeAttribute("aria-label"),this.inputElement&&(Ce.removeAttributes(t,this.inputElement),g(this.inputElementCopy.getAttribute("tabindex"))?this.inputElement.removeAttribute("tabindex"):this.inputElement.setAttribute("tabindex",this.tabIndex),E.remove(this.inputElement,"blur",this.inputBlurHandler),E.remove(this.inputElement,"focus",this.inputFocusHandler),this.ensureInputAttribute()),this.isCalendar()&&(this.popupWrapper&&ee(this.popupWrapper),this.popupObj=this.popupWrapper=null,this.keyboardModule.destroy()),this.ngTag===null&&(this.inputElement&&(g(this.inputWrapper)||this.inputWrapper.container.insertAdjacentElement("afterend",this.inputElement),K([this.inputElement],[s_])),K([this.element],[vm]),g(this.inputWrapper)||ee(this.inputWrapper.container)),this.formElement&&E.remove(this.formElement,"reset",this.resetFormHandler),this.inputWrapper=null,this.keyboardModules=null},e.prototype.ensureInputAttribute=function(){for(var t=[],i=0;i<this.inputElement.attributes.length;i++)t[i]=this.inputElement.attributes[i].name;for(var i=0;i<t.length;i++)g(this.inputElementCopy.getAttribute(t[i]))?(t[i].toLowerCase()==="value"&&(this.inputElement.value=""),this.inputElement.removeAttribute(t[i])):(t[i].toLowerCase()==="value"&&(this.inputElement.value=this.inputElementCopy.getAttribute(t[i])),this.inputElement.setAttribute(t[i],this.inputElementCopy.getAttribute(t[i])))},e.prototype.preRender=function(){this.inputElementCopy=this.element.cloneNode(!0),K([this.inputElementCopy],[vm,t_,e_]),this.inputElement=this.element,this.formElement=j(this.inputElement,"form"),this.index=this.showClearButton?2:1,this.ngTag=null,(this.element.tagName==="EJS-DATEPICKER"||this.element.tagName==="EJS-DATETIMEPICKER")&&(this.ngTag=this.element.tagName,this.inputElement=this.createElement("input"),this.element.appendChild(this.inputElement)),this.element.getAttribute("id")?this.ngTag!==null&&(this.inputElement.id=this.element.getAttribute("id")+"_input"):this.getModuleName()==="datetimepicker"?(this.element.id=kt("ej2-datetimepicker"),this.ngTag!==null&&Ie(this.inputElement,{id:this.element.id+"_input"})):(this.element.id=kt("ej2-datepicker"),this.ngTag!==null&&Ie(this.inputElement,{id:this.element.id+"_input"})),this.ngTag!==null&&this.validationAttribute(this.element,this.inputElement),this.updateHtmlAttributeToElement(),this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.checkHtmlAttributes(!1),this.inputFormats&&this.checkInputFormats(),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex"),o.prototype.preRender.call(this)},e.prototype.getDefaultKeyConfig=function(){return this.defaultKeyConfigs={altUpArrow:"alt+uparrow",altDownArrow:"alt+downarrow",escape:"escape",enter:"enter",controlUp:"ctrl+38",controlDown:"ctrl+40",moveDown:"downarrow",moveUp:"uparrow",moveLeft:"leftarrow",moveRight:"rightarrow",select:"enter",home:"home",end:"end",pageUp:"pageup",pageDown:"pagedown",shiftPageUp:"shift+pageup",shiftPageDown:"shift+pagedown",controlHome:"ctrl+home",controlEnd:"ctrl+end",shiftTab:"shift+tab",tab:"tab"},this.defaultKeyConfigs},e.prototype.validationAttribute=function(t,i){var r=t.getAttribute("name")?t.getAttribute("name"):t.getAttribute("id");i.setAttribute("name",r),t.removeAttribute("name");for(var n=["required","aria-required","form"],s=0;s<n.length;s++)if(!g(t.getAttribute(n[s]))){var a=t.getAttribute(n[s]);i.setAttribute(n[s],a),t.removeAttribute(n[s])}},e.prototype.checkFormat=function(){var t=new Et(this.locale);if(this.format)if(typeof this.format=="string")this.formatString=this.format;else if(this.format.skeleton!==""&&!g(this.format.skeleton)){var i=this.format.skeleton;this.getModuleName()==="datetimepicker"?this.formatString=t.getDatePattern({skeleton:i,type:"dateTime"}):this.formatString=t.getDatePattern({skeleton:i,type:"date"})}else this.getModuleName()==="datetimepicker"?this.formatString=this.dateTimeFormat:this.formatString=null;else this.formatString=null},e.prototype.checkInputFormats=function(){var t=new Et(this.locale);if(this.inputFormatsString=[],this.inputFormats){for(var i=0,r=this.inputFormats;i<r.length;i++){var n=r[i],s="";if(typeof n=="string")s=n;else if(n.skeleton!==""&&!g(n.skeleton)){var a=n.skeleton;this.getModuleName()==="datetimepicker"?s=t.getDatePattern({skeleton:a,type:"dateTime"}):s=t.getDatePattern({skeleton:a,type:"date"})}s&&this.inputFormatsString.push(s)}this.inputFormatsString.length===0&&(this.inputFormatsString=null)}else this.inputFormatsString=null},e.prototype.checkHtmlAttributes=function(t){this.globalize=new Et(this.locale),this.checkFormat(),this.checkView();var i=t?g(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["value","min","max","disabled","readonly","style","name","placeholder","type"],r;this.getModuleName()==="datetimepicker"?this.calendarMode==="Gregorian"?r={format:g(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:g(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}:this.calendarMode==="Gregorian"?r={format:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};for(var n=0,s=i;n<s.length;n++){var a=s[n];if(!g(this.inputElement.getAttribute(a)))switch(a){case"disabled":if(g(this.datepickerOptions)||this.datepickerOptions.enabled===void 0||t){var l=!(this.inputElement.getAttribute(a)==="disabled"||this.inputElement.getAttribute(a)===""||this.inputElement.getAttribute(a)==="true");this.setProperties({enabled:l},!t)}break;case"readonly":if(g(this.datepickerOptions)||this.datepickerOptions.readonly===void 0||t){var h=this.inputElement.getAttribute(a)==="readonly"||this.inputElement.getAttribute(a)===""||this.inputElement.getAttribute(a)==="true";this.setProperties({readonly:h},!t)}break;case"placeholder":(g(this.datepickerOptions)||this.datepickerOptions.placeholder===void 0||t)&&this.setProperties({placeholder:this.inputElement.getAttribute(a)},!t);break;case"style":this.inputElement.setAttribute("style",""+this.inputElement.getAttribute(a));break;case"name":this.inputElement.setAttribute("name",""+this.inputElement.getAttribute(a));break;case"value":if(g(this.datepickerOptions)||this.datepickerOptions.value===void 0||t){var u=this.inputElement.getAttribute(a);this.setProperties(Ge(a,this.globalize.parseDate(this.getAmPmValue(u),r),{}),!t)}break;case"min":if(+this.min==+new Date(1900,0,1)||t){var c=this.inputElement.getAttribute(a);this.setProperties(Ge(a,this.globalize.parseDate(this.getAmPmValue(c),r),{}),!t)}break;case"max":if(+this.max==+new Date(2099,11,31)||t){var d=this.inputElement.getAttribute(a);this.setProperties(Ge(a,this.globalize.parseDate(this.getAmPmValue(d),r),{}),!t)}break;case"type":this.inputElement.getAttribute(a)!=="text"&&this.inputElement.setAttribute("type","text");break}}},e.prototype.getModuleName=function(){return"datepicker"},e.prototype.disabledDates=function(t,i){t===void 0&&(t=!1),i===void 0&&(i=!1);var r,n,s=this.checkDateValue(this.value)?new Date(+this.value):new Date(this.checkValue(this.value)),a=this.previousDate;this.minMaxUpdates(),(!t||t&&!g(this.renderDayCell))&&o.prototype.render.call(this),this.previousDate=a;var l=s&&+s,h='*[id^="/id"]'.replace("/id",""+l);this.strictMode||(typeof this.value=="string"||typeof this.value=="object"&&+this.value!=+s)&&this.setProperties({value:s},!0),!g(this.calendarElement)&&!g(this.calendarElement.querySelectorAll(h)[0])&&this.calendarElement.querySelectorAll(h)[0].classList.contains("e-disabled")&&(this.strictMode||(this.currentDate=new Date(new Date().setHours(0,0,0,0))));var u;this.getModuleName()==="datetimepicker"?(this.calendarMode==="Gregorian"?n=this.globalize.formatDate(s,{format:g(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd"}):n=this.globalize.formatDate(s,{format:g(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}),u=n):(this.calendarMode==="Gregorian"?r={format:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"},u=this.globalize.formatDate(s,r)),this.popupObj||(this.updateInputValue(u),this.enableMask&&(this.updateInputValue(this.maskedDateValue),this.notify("createMask",{module:"MaskedDateTime",isBlur:i})))},e.prototype.setAriaAttributes=function(){this.isCalendar()?(Ce.addAttributes({"aria-expanded":"true"},this.inputElement),Ie(this.inputElement,{"aria-owns":this.inputElement.id+"_options"}),Ie(this.inputElement,{"aria-controls":this.inputElement.id}),this.value&&Ie(this.inputElement,{"aria-activedescendant":""+this.setActiveDescendant()})):(Ce.addAttributes({"aria-expanded":"false"},this.inputElement),this.inputElement.removeAttribute("aria-owns"),this.inputElement.removeAttribute("aria-controls"),this.inputElement.removeAttribute("aria-activedescendant"))},e.prototype.errorClass=function(){var t='*[id^="/id"]'.replace("/id",""+ +this.value),i=this.calendarElement&&this.calendarElement.querySelectorAll(t)[0]&&this.calendarElement.querySelectorAll(t)[0].classList.contains("e-disabled");!g(this.value)&&!g(this.min)&&!g(this.max)&&!(new Date(this.value).setMilliseconds(0)>=new Date(this.min).setMilliseconds(0)&&new Date(this.value).setMilliseconds(0)<=new Date(this.max).setMilliseconds(0))||!this.strictMode&&this.inputElement.value!==""&&this.inputElement.value!==this.maskedDateValue&&g(this.value)||i||!this.isValidTime(this.value)?(Y([this.inputWrapper.container],Tk),Ie(this.inputElement,{"aria-invalid":"true"})):g(this.inputWrapper)||(K([this.inputWrapper.container],Tk),Ie(this.inputElement,{"aria-invalid":"false"}))},e.prototype.isValidTime=function(t){return!0},e.prototype.onPropertyChanged=function(t,i){for(var r=0,n=Object.keys(t);r<n.length;r++){var s=n[r],a=["blur","change","cleared","close","created","destroyed","focus","navigated","open","renderDayCell"];switch(a.indexOf(s)>0&&this.isReact&&(this.isDynamicValueChanged=!0),s){case"value":this.isDynamicValueChanged=!0,this.isInteracted=!1,this.invalidValueString=null,this.checkInvalidValue(t.value),t.value=this.value,this.previousElementValue=this.inputElement.value,g(this.value)&&(this.enableMask?this.updateInputValue(this.maskedDateValue):this.updateInputValue(""),this.currentDate=new Date(new Date().setHours(0,0,0,0))),this.updateInput(!0),+this.previousDate!=+this.value&&this.changeTrigger(null),this.isInteracted=!0,this.preventChange=this.isAngular&&this.preventChange?!this.preventChange:this.preventChange,this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"});break;case"format":this.checkFormat(),this.bindInputEvent(),this.updateInput(),this.enableMask&&(this.notify("createMask",{module:"MaskedDateTime"}),this.value||this.updateInputValue(this.maskedDateValue));break;case"inputFormats":this.checkInputFormats();break;case"allowEdit":this.setAllowEdit();break;case"placeholder":Ce.setPlaceholder(this.placeholder,this.inputElement);break;case"readonly":Ce.setReadonly(this.readonly,this.inputElement);break;case"enabled":Ce.setEnabled(this.enabled,this.inputElement),this.setAriaDisabled();break;case"htmlAttributes":this.updateHtmlAttributeToElement(),this.updateHtmlAttributeToWrapper(),this.checkHtmlAttributes(!0);break;case"locale":this.globalize=new Et(this.locale),this.l10n.setLocale(this.locale),this.datepickerOptions&&this.datepickerOptions.placeholder==null&&(this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),Ce.setPlaceholder(this.placeholder,this.inputElement)),this.updateInput(),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"});break;case"enableRtl":Ce.setEnableRtl(this.enableRtl,[this.inputWrapper.container]);break;case"start":case"depth":this.checkView(),this.calendarElement&&o.prototype.onPropertyChanged.call(this,t,i);break;case"zIndex":this.setProperties({zIndex:t.zIndex},!0);break;case"cssClass":this.updateCssClass(t.cssClass,i.cssClass);break;case"showClearButton":Ce.setClearButton(this.showClearButton,this.inputElement,this.inputWrapper),this.bindClearEvent(),this.index=this.showClearButton?2:1;break;case"strictMode":this.invalidValueString=null,this.updateInput();break;case"width":this.setWidth(t.width),Ce.calculateWidth(this.inputElement,this.inputWrapper.container),!g(this.inputWrapper.buttons[0])&&!g(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon");break;case"floatLabelType":this.floatLabelType=t.floatLabelType,Ce.removeFloating(this.inputWrapper),Ce.addFloating(this.inputElement,this.floatLabelType,this.placeholder),!g(this.inputWrapper.buttons[0])&&!g(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon");break;case"enableMask":this.enableMask?(this.notify("createMask",{module:"MaskedDateTime"}),this.updateInputValue(this.maskedDateValue),this.bindInputEvent()):this.inputElement.value===this.maskedDateValue&&this.updateInputValue("");break;default:this.calendarElement&&this.isCalendar()&&o.prototype.onPropertyChanged.call(this,t,i),s==="min"&&g(this.min)&&(this.min=new Date(1900,0,1)),s==="max"&&g(this.max)&&(this.max=new Date(2099,11,31));break}this.isDynamicValueChanged||this.hide(null),this.isDynamicValueChanged=!1}},e.prototype.addDate=function(t){},ki([C(null)],e.prototype,"width",void 0),ki([C(null)],e.prototype,"value",void 0),ki([C(null)],e.prototype,"cssClass",void 0),ki([C(!1)],e.prototype,"strictMode",void 0),ki([C(null)],e.prototype,"format",void 0),ki([C(null)],e.prototype,"inputFormats",void 0),ki([C(!0)],e.prototype,"enabled",void 0),ki([C(!1)],e.prototype,"fullScreenMode",void 0),ki([C({})],e.prototype,"htmlAttributes",void 0),ki([C(null)],e.prototype,"values",void 0),ki([C(!1)],e.prototype,"isMultiSelection",void 0),ki([C(!0)],e.prototype,"showClearButton",void 0),ki([C(!0)],e.prototype,"allowEdit",void 0),ki([C(null)],e.prototype,"keyConfigs",void 0),ki([C(!1)],e.prototype,"enablePersistence",void 0),ki([C(1e3)],e.prototype,"zIndex",void 0),ki([C(!1)],e.prototype,"readonly",void 0),ki([C(null)],e.prototype,"placeholder",void 0),ki([C("Never")],e.prototype,"floatLabelType",void 0),ki([C(null)],e.prototype,"serverTimezoneOffset",void 0),ki([C(!1)],e.prototype,"openOnFocus",void 0),ki([C(!1)],e.prototype,"enableMask",void 0),ki([C({day:"day",month:"month",year:"year",hour:"hour",minute:"minute",second:"second",dayOfTheWeek:"day of the week"})],e.prototype,"maskPlaceholder",void 0),ki([q()],e.prototype,"open",void 0),ki([q()],e.prototype,"cleared",void 0),ki([q()],e.prototype,"close",void 0),ki([q()],e.prototype,"blur",void 0),ki([q()],e.prototype,"focus",void 0),ki([q()],e.prototype,"created",void 0),ki([q()],e.prototype,"destroyed",void 0),e=ki([bt],e),e}(K5);var zY=new Date().getDate(),jY=new Date().getMonth(),HY=new Date().getFullYear();var Bw;(function(o){function e(t,i,r,n,s,a){this.calendarMode;var l,h=a*6e4,u=[],c=[];l=+i.setMilliseconds(0);for(var d=+r.setMilliseconds(0);d>=l;)c.push(l),u.push(n.formatDate(new Date(l),{format:s,type:"time"})),l+=h;var p=At.createList(t,u,null,!0);return{collection:c,list:p}}o.createListItems=e})(Bw||(Bw={}));var c_=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ri=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},d_="e-date-wrapper",p_="e-datepicker",f_="e-datetime-wrapper",g_=new Date().getDate(),v_=new Date().getMonth(),m_=new Date().getFullYear(),y_=new Date().getHours(),b_=new Date().getMinutes(),S_=new Date().getSeconds(),C_=new Date().getMilliseconds(),$p="e-datetimepicker",Nk="e-datetimepopup-wrapper",w_="e-input-group-icon",Fk="e-popup",x_="e-time-icon",Kp="e-input-focus",Ok="250px",Rk="e-icon-anim",Rw="e-disabled",Pk="e-error",I_="e-content",M_="e-navigation",Wl="e-active",Pw="e-hover",D_="e-icons",bm=2,ql="e-list-item",Bk=100,zk="e-time-overflow",Hk=function(o){c_(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.valueWithMinutes=null,r.scrollInvoked=!1,r.moduleName=r.getModuleName(),r.formatRegex=/dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|'[^']*'|'[^']*'/g,r.dateFormatString="",r.dateTimeOptions=t,r}return e.prototype.focusHandler=function(){this.enabled&&Y([this.inputWrapper.container],Kp)},e.prototype.focusIn=function(){o.prototype.focusIn.call(this)},e.prototype.focusOut=function(){document.activeElement===this.inputElement&&(this.inputElement.blur(),K([this.inputWrapper.container],[Kp]))},e.prototype.blurHandler=function(t){if(this.enabled){if(this.isTimePopupOpen()&&this.isPreventBlur){this.inputElement.focus();return}K([this.inputWrapper.container],Kp);var i={model:this};this.isTimePopupOpen()&&this.hide(t),this.trigger("blur",i)}},e.prototype.destroy=function(){this.showClearButton&&(this.clearButton=document.getElementsByClassName("e-clear-icon")[0]),this.popupObject&&this.popupObject.element.classList.contains(Fk)&&(this.popupObject.destroy(),ee(this.dateTimeWrapper),this.dateTimeWrapper=void 0,this.liCollections=this.timeCollections=[],g(this.rippleFn)||this.rippleFn());var t={"aria-live":"assertive","aria-atomic":"true","aria-invalid":"false",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-expanded":"false",role:"combobox",autocomplete:"off"};this.inputElement&&Ce.removeAttributes(t,this.inputElement),this.isCalendar()&&(this.popupWrapper&&ee(this.popupWrapper),this.popupObject=this.popupWrapper=null,this.keyboardHandler.destroy()),this.unBindInputEvents(),this.liCollections=null,this.rippleFn=null,this.selectedElement=null,this.listTag=null,this.timeIcon=null,this.popupObject=null,this.preventArgs=null,this.keyboardModule=null,Ce.destroy({element:this.inputElement,floatLabelType:this.floatLabelType,properties:this.properties},this.clearButton),o.prototype.destroy.call(this)},e.prototype.render=function(){this.timekeyConfigure={enter:"enter",escape:"escape",end:"end",tab:"tab",home:"home",down:"downarrow",up:"uparrow",left:"leftarrow",right:"rightarrow",open:"alt+downarrow",close:"alt+uparrow"},this.valueWithMinutes=null,this.previousDateTime=null,this.isPreventBlur=!1,this.cloneElement=this.element.cloneNode(!0),this.dateTimeFormat=this.cldrDateTimeFormat(),this.initValue=this.value,typeof this.min=="string"&&(this.min=this.checkDateValue(new Date(this.min))),typeof this.max=="string"&&(this.max=this.checkDateValue(new Date(this.max))),typeof this.minTime=="string"&&(this.minTime=this.checkDateValue(new Date(this.minTime))),typeof this.maxTime=="string"&&(this.maxTime=this.checkDateValue(new Date(this.maxTime))),!g(j(this.element,"fieldset"))&&j(this.element,"fieldset").disabled&&(this.enabled=!1),o.prototype.updateHtmlAttributeToElement.call(this),this.checkAttributes(!1);var t={placeholder:this.placeholder};this.l10n=new Li("datetimepicker",t,this.locale),this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),o.prototype.render.call(this),this.createInputElement(),o.prototype.updateHtmlAttributeToWrapper.call(this),this.bindInputEvents(),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"}),this.setValue(!0),this.enableMask&&!this.value&&this.maskedDateValue&&(this.floatLabelType==="Always"||!this.floatLabelType||!this.placeholder)&&Ce.setValue(this.maskedDateValue,this.inputElement,this.floatLabelType,this.showClearButton),this.setProperties({scrollTo:this.checkDateValue(new Date(this.checkValue(this.scrollTo)))},!0),this.previousDateTime=this.value&&new Date(+this.value),this.element.tagName==="EJS-DATETIMEPICKER"&&(this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex"),this.enabled||(this.inputElement.tabIndex=-1)),this.floatLabelType!=="Never"&&Ce.calculateWidth(this.inputElement,this.inputWrapper.container),!g(this.inputWrapper.buttons[0])&&!g(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-date-time-icon"),this.renderComplete()},e.prototype.setValue=function(t){if(t===void 0&&(t=!1),this.initValue=this.validateMinMaxRange(this.value),!this.strictMode&&this.isDateObject(this.initValue)){var i=this.validateMinMaxRange(this.initValue);Ce.setValue(this.getFormattedValue(i),this.inputElement,this.floatLabelType,this.showClearButton),this.setProperties({value:i},!0)}else g(this.value)&&(this.initValue=null,this.setProperties({value:null},!0));this.valueWithMinutes=this.value,o.prototype.updateInput.call(this,t)},e.prototype.validateMinMaxRange=function(t){var i=t;return this.isDateObject(t)?i=this.validateValue(t):+this.min>+this.max&&this.disablePopupButton(!0),this.checkValidState(i),i},e.prototype.checkValidState=function(t){this.isValidState=!0,this.strictMode||(+t>+this.max||+t<+this.min||!this.isValidTime(t))&&(this.isValidState=!1),this.checkErrorState()},e.prototype.checkErrorState=function(){this.isValidState?K([this.inputWrapper.container],Pk):Y([this.inputWrapper.container],Pk),Ie(this.inputElement,{"aria-invalid":this.isValidState?"false":"true"})},e.prototype.isValidTime=function(t){if(t!=null&&(this.minTime||this.maxTime)){var i=void 0,r=void 0,n=void 0,s=void 0,a=t.getHours()*36e5+t.getMinutes()*6e4+t.getSeconds()*1e3+t.getMilliseconds();if(this.minTime&&(i=this.minTime.getHours()*36e5+this.minTime.getMinutes()*6e4+this.minTime.getSeconds()*1e3+this.minTime.getMilliseconds()),this.maxTime&&(r=this.maxTime.getHours()*36e5+this.maxTime.getMinutes()*6e4+this.maxTime.getSeconds()*1e3+this.maxTime.getMilliseconds()),this.min&&+t.getDate()==+this.min.getDate()&&+t.getMonth()==+this.min.getMonth()&&+t.getFullYear()==+this.min.getFullYear()&&(s=this.min.getHours()*36e5+this.min.getMinutes()*6e4+this.min.getSeconds()*1e3+this.min.getMilliseconds(),i=i<s?s:i),this.max&&+t.getDate()==+this.max.getDate()&&+t.getMonth()==+this.max.getMonth()&&+this.max.getFullYear()==+this.max.getFullYear()&&(n=this.max.getHours()*36e5+this.max.getMinutes()*6e4+this.max.getSeconds()*1e3+this.max.getMilliseconds(),r=r>n?n:r),this.strictMode){var l=void 0;return i&&a<i?(l=new Date(t.getFullYear(),t.getMonth(),t.getDate(),this.minTime.getHours(),this.minTime.getMinutes(),this.minTime.getSeconds(),this.minTime.getMilliseconds()),this.setProperties({value:l},!0),this.changedArgs={value:this.value}):r&&a>r&&(l=new Date(t.getFullYear(),t.getMonth(),t.getDate(),this.maxTime.getHours(),this.maxTime.getMinutes(),this.maxTime.getSeconds(),this.maxTime.getMilliseconds()),this.setProperties({value:l},!0),this.changedArgs={value:this.value}),!0}else return!(i&&a<i||r&&a>r)}return!0},e.prototype.validateValue=function(t){var i=t;return this.strictMode?+this.min>+this.max?(this.disablePopupButton(!0),i=this.max):+t<+this.min?i=this.min:+t>+this.max&&(i=this.max):+this.min>+this.max&&(this.disablePopupButton(!0),i=t),i},e.prototype.disablePopupButton=function(t){t?(Y([this.inputWrapper.buttons[0],this.timeIcon],Rw),this.hide()):K([this.inputWrapper.buttons[0],this.timeIcon],Rw)},e.prototype.getFormattedValue=function(t){var i;return g(t)?null:(this.calendarMode==="Gregorian"?i={format:this.cldrDateTimeFormat(),type:"dateTime",skeleton:"yMd"}:i={format:this.cldrDateTimeFormat(),type:"dateTime",skeleton:"yMd",calendar:"islamic"},this.globalize.formatDate(t,i))},e.prototype.isDateObject=function(t){return!g(t)&&!isNaN(+t)},e.prototype.createInputElement=function(){K([this.inputElement],p_),K([this.inputWrapper.container],d_),Y([this.inputWrapper.container],f_),Y([this.inputElement],$p),this.renderTimeIcon()},e.prototype.renderTimeIcon=function(){this.timeIcon=Ce.appendSpan(w_+" "+x_+" "+D_,this.inputWrapper.container)},e.prototype.bindInputEvents=function(){E.add(this.timeIcon,"mousedown",this.timeHandler,this),E.add(this.inputWrapper.buttons[0],"mousedown",this.dateHandler,this),E.add(this.inputElement,"blur",this.blurHandler,this),E.add(this.inputElement,"focus",this.focusHandler,this),this.defaultKeyConfigs=he(this.defaultKeyConfigs,this.keyConfigs),this.keyboardHandler=new $i(this.inputElement,{eventName:"keydown",keyAction:this.inputKeyAction.bind(this),keyConfigs:this.defaultKeyConfigs})},e.prototype.unBindInputEvents=function(){E.remove(this.timeIcon,"mousedown touchstart",this.timeHandler),E.remove(this.inputWrapper.buttons[0],"mousedown touchstart",this.dateHandler),this.inputElement&&(E.remove(this.inputElement,"blur",this.blurHandler),E.remove(this.inputElement,"focus",this.focusHandler)),this.keyboardHandler&&this.keyboardHandler.destroy()},e.prototype.cldrTimeFormat=function(){var t;return this.isNullOrEmpty(this.timeFormat)?this.locale==="en"||this.locale==="en-US"?t=V("timeFormats.short",Vg()):t=this.getCultureTimeObject(zr,""+this.locale):t=this.timeFormat,t},e.prototype.cldrDateTimeFormat=function(){var t,i=new Et(this.locale),r=i.getDatePattern({skeleton:"yMd"});return this.isNullOrEmpty(this.formatString)?t=r+" "+this.getCldrFormat("time"):t=this.formatString,t},e.prototype.getCldrFormat=function(t){var i;return this.locale==="en"||this.locale==="en-US"?i=V("timeFormats.short",Vg()):i=this.getCultureTimeObject(zr,""+this.locale),i},e.prototype.isNullOrEmpty=function(t){return!!(g(t)||typeof t=="string"&&t.trim()==="")},e.prototype.getCultureTimeObject=function(t,i){return this.calendarMode==="Gregorian"?V("main."+this.locale+".dates.calendars.gregorian.timeFormats.short",t):V("main."+this.locale+".dates.calendars.islamic.timeFormats.short",t)},e.prototype.timeHandler=function(t){this.enabled&&(this.isIconClicked=!0,B.isDevice&&this.inputElement.setAttribute("readonly",""),t.currentTarget===this.timeIcon&&t.preventDefault(),this.enabled&&!this.readonly&&(this.isDatePopupOpen()&&o.prototype.hide.call(this,t),this.isTimePopupOpen()?this.closePopup(t):(this.inputElement.focus(),this.popupCreation("time",t),Y([this.inputWrapper.container],[Kp]))),this.isIconClicked=!1)},e.prototype.dateHandler=function(t){this.enabled&&(t.currentTarget===this.inputWrapper.buttons[0]&&t.preventDefault(),this.enabled&&!this.readonly&&(this.isTimePopupOpen()&&this.closePopup(t),g(this.popupWrapper)||this.popupCreation("date",t)))},e.prototype.show=function(t,i){this.enabled&&this.readonly||!this.enabled||(t==="time"&&!this.dateTimeWrapper?(this.isDatePopupOpen()&&this.hide(i),this.popupCreation("time",i)):this.popupObj||(this.isTimePopupOpen()&&this.hide(i),o.prototype.show.call(this),this.popupCreation("date",i)))},e.prototype.toggle=function(t){this.isDatePopupOpen()?(o.prototype.hide.call(this,t),this.show("time",null)):this.isTimePopupOpen()?(this.hide(t),o.prototype.show.call(this,null,t),this.popupCreation("date",null)):this.show(null,t)},e.prototype.listCreation=function(){var t;this.calendarMode==="Gregorian"?(this.cldrDateTimeFormat().replace(this.formatRegex,this.TimePopupFormat()),this.dateFormatString===""&&(this.dateFormatString=this.cldrDateTimeFormat()),t=this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),{format:this.dateFormatString,type:"datetime"})):t=this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),{format:this.cldrDateTimeFormat(),type:"datetime",calendar:"islamic"});var i=g(this.value)?this.inputElement.value!==""?t:new Date:this.value;this.valueWithMinutes=i,this.listWrapper=Xe("div",{className:I_,attrs:{tabindex:"0"}});var r=this.startTime(i),n=this.endTime(i),s=Bw.createListItems(this.createElement,r,n,this.globalize,this.cldrTimeFormat(),this.step);this.timeCollections=s.collection,this.listTag=s.list,Ie(this.listTag,{role:"listbox","aria-hidden":"false",id:this.element.id+"_options"}),dt([s.list],this.listWrapper),this.wireTimeListEvents();var a={duration:300,selector:"."+ql};this.rippleFn=Vi(this.listWrapper,a),this.liCollections=this.listWrapper.querySelectorAll("."+ql)},e.prototype.popupCreation=function(t,i){if(B.isDevice&&this.element.setAttribute("readonly","readonly"),t==="date")!this.readonly&&this.popupWrapper&&(Y([this.popupWrapper],Nk),Ie(this.popupWrapper,{id:this.element.id+"_options"}));else if(!this.readonly){var r=Xe("div",{className:$p+" "+Fk,attrs:{id:this.element.id+"_timepopup"}});r.style.cssText="visibility: hidden; display: block;",this.dateTimeWrapper=r,g(this.cssClass)||(this.dateTimeWrapper.className+=" "+this.cssClass),!g(this.step)&&this.step>0&&(this.listCreation(),dt([this.listWrapper],this.dateTimeWrapper)),document.body.appendChild(this.dateTimeWrapper),this.addTimeSelection(),this.renderPopup(),this.setTimeScrollPosition(),this.openPopup(i),(!B.isDevice||B.isDevice&&!this.fullScreenMode)&&this.popupObject.refreshPosition(this.inputElement),B.isDevice&&(this.modelWrapper.style.zIndex=(this.popupObject.zIndex-1).toString(),this.fullScreenMode&&(this.dateTimeWrapper.style.left="0px"))}},e.prototype.openPopup=function(t){var i=this;this.preventArgs={cancel:!1,popup:this.popupObject,event:t||null};var r=this.preventArgs;this.trigger("open",r,function(n){if(i.preventArgs=n,!i.preventArgs.cancel&&!i.readonly){var s={name:"FadeIn",duration:Bk};i.zIndex===1e3?i.popupObject.show(new It(s),i.element):i.popupObject.show(new It(s),null),Y([i.inputWrapper.container],[Rk]),Ie(i.inputElement,{"aria-expanded":"true"}),Ie(i.inputElement,{"aria-owns":i.inputElement.id+"_options"}),Ie(i.inputElement,{"aria-controls":i.inputElement.id}),E.add(document,"mousedown touchstart",i.documentClickHandler,i)}})},e.prototype.documentClickHandler=function(t){var i=t.target;!g(this.popupObject)&&(this.inputWrapper.container.contains(i)&&t.type!=="mousedown"||this.popupObject.element&&this.popupObject.element.contains(i))&&t.type!=="touchstart"&&t.preventDefault(),!j(i,'[id="'+(this.popupObject&&this.popupObject.element.id+'"]'))&&i!==this.inputElement&&i!==this.timeIcon&&!g(this.inputWrapper)&&i!==this.inputWrapper.container&&!i.classList.contains("e-dlg-overlay")?this.isTimePopupOpen()&&(this.hide(t),this.focusOut()):i!==this.inputElement&&(B.isDevice||(this.isPreventBlur=document.activeElement===this.inputElement&&(B.isIE||B.info.name==="edge")&&i===this.popupObject.element))},e.prototype.isTimePopupOpen=function(){return!!(this.dateTimeWrapper&&this.dateTimeWrapper.classList.contains(""+$p))},e.prototype.isDatePopupOpen=function(){return!!(this.popupWrapper&&this.popupWrapper.classList.contains(""+Nk))},e.prototype.renderPopup=function(){var t=this;if(this.containerStyle=this.inputWrapper.container.getBoundingClientRect(),B.isDevice&&(this.timeModal=Xe("div"),this.timeModal.className=""+$p+" e-time-modal",document.body.className+=" "+zk,this.timeModal.style.display="block",document.body.appendChild(this.timeModal)),B.isDevice){this.modelWrapper=Xe("div",{className:"e-datetime-mob-popup-wrap"}),this.modelWrapper.appendChild(this.dateTimeWrapper);var i=Xe("div",{className:"e-dlg-overlay"});i.style.zIndex=(this.zIndex-1).toString(),this.modelWrapper.appendChild(i),document.body.appendChild(this.modelWrapper)}var r=4;if(this.popupObject=new Gn(this.dateTimeWrapper,{width:this.setPopupWidth(),zIndex:this.zIndex,targetType:"container",collision:B.isDevice?{X:"fit",Y:"fit"}:{X:"flip",Y:"flip"},relateTo:B.isDevice?document.body:this.inputWrapper.container,position:B.isDevice?{X:"center",Y:"center"}:{X:"left",Y:"bottom"},enableRtl:this.enableRtl,offsetY:r,open:function(){t.dateTimeWrapper.style.visibility="visible",Y([t.timeIcon],Wl),B.isDevice||(t.timekeyConfigure=he(t.timekeyConfigure,t.keyConfigs),t.inputEvent=new $i(t.inputWrapper.container,{keyAction:t.timeKeyActionHandle.bind(t),keyConfigs:t.timekeyConfigure,eventName:"keydown"}))},close:function(){K([t.timeIcon],Wl),t.unWireTimeListEvents(),t.inputElement.removeAttribute("aria-activedescendant"),Ue(t.popupObject.element),t.popupObject.destroy(),t.dateTimeWrapper.innerHTML="",t.modelWrapper&&Ue(t.modelWrapper),t.listWrapper=t.dateTimeWrapper=void 0,t.inputEvent&&t.inputEvent.destroy()},targetExitViewport:function(){B.isDevice||t.hide()}}),B.isDevice&&this.fullScreenMode?(this.popupObject.element.style.maxHeight="100%",this.popupObject.element.style.width="100%"):this.popupObject.element.style.maxHeight=Ok,B.isDevice&&this.fullScreenMode){var n=this.createElement("div",{className:"e-model-header"}),s=this.createElement("span",{className:"e-model-title"});s.textContent="Select time";var a=this.createElement("span",{className:"e-popup-close"});E.add(a,"mousedown touchstart",this.dateTimeCloseHandler,this),n.appendChild(a),n.appendChild(s),this.dateTimeWrapper.insertBefore(n,this.dateTimeWrapper.firstElementChild)}},e.prototype.dateTimeCloseHandler=function(t){this.hide()},e.prototype.setDimension=function(t){return typeof t=="number"?t=Le(t):typeof t=="string"?t=t:t="100%",t},e.prototype.setPopupWidth=function(){var t=this.setDimension(this.width);if(t.indexOf("%")>-1){var i=this.containerStyle.width*parseFloat(t)/100;t=i.toString()+"px"}return t},e.prototype.wireTimeListEvents=function(){E.add(this.listWrapper,"click",this.onMouseClick,this),B.isDevice||(E.add(this.listWrapper,"mouseover",this.onMouseOver,this),E.add(this.listWrapper,"mouseout",this.onMouseLeave,this))},e.prototype.unWireTimeListEvents=function(){this.listWrapper&&(E.remove(this.listWrapper,"click",this.onMouseClick),E.remove(document,"mousedown touchstart",this.documentClickHandler),B.isDevice||(E.add(this.listWrapper,"mouseover",this.onMouseOver,this),E.add(this.listWrapper,"mouseout",this.onMouseLeave,this)))},e.prototype.onMouseOver=function(t){var i=j(t.target,"."+ql);this.setTimeHover(i,Pw)},e.prototype.onMouseLeave=function(){this.removeTimeHover(Pw)},e.prototype.setTimeHover=function(t,i){this.enabled&&this.isValidLI(t)&&!t.classList.contains(i)&&(this.removeTimeHover(i),Y([t],i))},e.prototype.getPopupHeight=function(){var t=parseInt(Ok,10),i=this.dateTimeWrapper.getBoundingClientRect().height;return B.isDevice&&this.fullScreenMode?i:i>t?t:i},e.prototype.changeEvent=function(t){o.prototype.changeEvent.call(this,t),(this.value&&this.value.valueOf())!==(this.previousDateTime&&+this.previousDateTime.valueOf())&&(this.valueWithMinutes=this.value,this.setInputValue("date"),this.previousDateTime=this.value&&new Date(+this.value))},e.prototype.updateValue=function(t){this.setInputValue("time"),+this.previousDateTime!=+this.value&&(this.changedArgs={value:this.value,event:t||null,isInteracted:!g(t),element:this.element},this.addTimeSelection(),this.trigger("change",this.changedArgs),this.previousDateTime=this.previousDate=this.value)},e.prototype.setTimeScrollPosition=function(){var t=this.selectedElement;g(t)?this.dateTimeWrapper&&this.checkDateValue(this.scrollTo)&&this.setScrollTo():this.findScrollTop(t)},e.prototype.findScrollTop=function(t){var i=this.getPopupHeight(),r=t.nextElementSibling,n=r?r.offsetTop:t.offsetTop,s=t.getBoundingClientRect().height;if(n+t.offsetTop>i)if(B.isDevice&&this.fullScreenMode){var a=this.dateTimeWrapper.querySelector(".e-content");a.scrollTop=r?n-(i/bm+s/bm):n}else this.dateTimeWrapper.scrollTop=r?n-(i/bm+s/bm):n;else this.dateTimeWrapper.scrollTop=0},e.prototype.setScrollTo=function(){var t,i=this.dateTimeWrapper.querySelectorAll("."+ql);if(i.length>=0){this.scrollInvoked=!0;var r=this.timeCollections[0],n=this.getDateObject(this.checkDateValue(this.scrollTo)).getTime();t=i[Math.round((n-r)/(this.step*6e4))]}else this.dateTimeWrapper.scrollTop=0;g(t)?this.dateTimeWrapper.scrollTop=0:this.findScrollTop(t)},e.prototype.setInputValue=function(t){if(t==="date")this.inputElement.value=this.previousElementValue=this.getFormattedValue(this.getFullDateTime()),this.setProperties({value:this.getFullDateTime()},!0);else{var i=this.getFormattedValue(new Date(this.timeCollections[this.activeIndex]));Ce.setValue(i,this.inputElement,this.floatLabelType,this.showClearButton),this.previousElementValue=this.inputElement.value,this.setProperties({value:new Date(this.timeCollections[this.activeIndex])},!0),this.enableMask&&this.createMask()}this.updateIconState()},e.prototype.getFullDateTime=function(){var t=null;return this.isDateObject(this.valueWithMinutes)?t=this.combineDateTime(this.valueWithMinutes):t=this.previousDate,this.validateMinMaxRange(t)},e.prototype.createMask=function(){this.notify("createMask",{module:"MaskedDateTime"})},e.prototype.combineDateTime=function(t){if(this.isDateObject(t)){var i=this.previousDate.getDate(),r=this.previousDate.getMonth(),n=this.previousDate.getFullYear(),s=t.getHours(),a=t.getMinutes(),l=t.getSeconds();return new Date(n,r,i,s,a,l)}else return this.previousDate},e.prototype.onMouseClick=function(t){var i=t.target,r=this.selectedElement=j(i,"."+ql);r&&r.classList.contains(ql)&&(this.timeValue=r.getAttribute("data-value"),this.hide(t)),this.setSelection(r,t)},e.prototype.setSelection=function(t,i){if(this.isValidLI(t)&&!t.classList.contains(Wl)){this.selectedElement=t;var r=Array.prototype.slice.call(this.liCollections).indexOf(t);this.activeIndex=r,this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),Y([this.selectedElement],Wl),this.selectedElement.setAttribute("aria-selected","true"),this.updateValue(i)}},e.prototype.setTimeActiveClass=function(){var t=g(this.dateTimeWrapper)?this.listWrapper:this.dateTimeWrapper;if(!g(t)){var i=t.querySelectorAll("."+ql);if(i.length){for(var r=0;r<i.length;r++)if(this.timeCollections[r]===+this.valueWithMinutes){i[r].setAttribute("aria-selected","true"),this.selectedElement=i[r],this.activeIndex=r,this.setTimeActiveDescendant();break}}}},e.prototype.setTimeActiveDescendant=function(){!g(this.selectedElement)&&this.value?Ie(this.inputElement,{"aria-activedescendant":this.selectedElement.getAttribute("id")}):this.inputElement.removeAttribute("aria-activedescendant")},e.prototype.addTimeSelection=function(){this.selectedElement=null,this.removeTimeSelection(),this.setTimeActiveClass(),g(this.selectedElement)||(Y([this.selectedElement],Wl),this.selectedElement.setAttribute("aria-selected","true"))},e.prototype.removeTimeSelection=function(){if(this.removeTimeHover(Pw),!g(this.dateTimeWrapper)){var t=this.dateTimeWrapper.querySelectorAll("."+Wl);t.length&&(K(t,Wl),t[0].removeAttribute("aria-selected"))}},e.prototype.removeTimeHover=function(t){var i=this.getTimeHoverItem(t);i&&i.length&&K(i,t)},e.prototype.getTimeHoverItem=function(t){var i=g(this.dateTimeWrapper)?this.listWrapper:this.dateTimeWrapper,r;return g(i)||(r=i.querySelectorAll("."+t)),r},e.prototype.isValidLI=function(t){return t&&t.classList.contains(ql)&&!t.classList.contains(Rw)},e.prototype.calculateStartEnd=function(t,i,r){var n=t.getDate(),s=t.getMonth(),a=t.getFullYear(),l=t.getHours(),h=t.getMinutes(),u=t.getSeconds(),c=t.getMilliseconds();return i?r==="starttime"?new Date(a,s,n,0,0,0):new Date(a,s,n,23,59,59):new Date(a,s,n,l,h,u,c)},e.prototype.startTime=function(t){var i,r,n=this.min,s=this.max,a=t===null?new Date:t,l=!1,h;return this.minTime?(h=new Date(a.getFullYear(),a.getMonth(),a.getDate(),this.minTime.getHours(),this.minTime.getMinutes(),this.minTime.getSeconds(),this.minTime.getMilliseconds()),l=!0):h=a,+h.getDate()==+n.getDate()&&+h.getMonth()==+n.getMonth()&&+h.getFullYear()==+n.getFullYear()||+new Date(h.getFullYear(),h.getMonth(),h.getDate())<=+new Date(n.getFullYear(),n.getMonth(),n.getDate())?(r=!1,i=n,l&&+new Date(h.getFullYear(),h.getMonth(),h.getDate(),h.getHours(),h.getMinutes(),h.getSeconds(),h.getMilliseconds())>=+new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())&&i.setHours(h.getHours(),h.getMinutes(),h.getSeconds(),h.getMilliseconds())):+h<+s&&+h>+n?(r=!l,i=h):+h>=+s&&(r=!0,i=s),this.calculateStartEnd(i,r,"starttime")},e.prototype.TimePopupFormat=function(){var t="",i=0,r=this;function n(s){switch(s){case"d":case"dd":case"ddd":case"dddd":case"M":case"MM":case"MMM":case"MMMM":case"y":case"yy":case"yyy":case"yyyy":t===""?t=t+s:t=t+"/"+s,i=i+1;break}return i>2&&(r.dateFormatString=t),t}return n},e.prototype.endTime=function(t){var i,r,n=this.max,s=t===null?new Date:t,a=!1,l;return this.maxTime?(l=new Date(s.getFullYear(),s.getMonth(),s.getDate(),this.maxTime.getHours(),this.maxTime.getMinutes(),this.maxTime.getSeconds(),this.maxTime.getMilliseconds()),a=!0):l=s,+l.getDate()==+n.getDate()&&+l.getMonth()==+n.getMonth()&&+l.getFullYear()==+n.getFullYear()||+new Date(l.getUTCFullYear(),l.getMonth(),l.getDate())>=+new Date(n.getFullYear(),n.getMonth(),n.getDate())?(r=!1,i=this.max,a&&+new Date(l.getUTCFullYear(),l.getMonth(),l.getDate(),l.getHours(),l.getMinutes(),l.getSeconds(),l.getMilliseconds())<=+new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())&&i.setHours(l.getHours(),l.getMinutes(),l.getSeconds(),l.getMilliseconds())):+l<+this.max&&+l>+this.min?(r=!a,i=l):+l<=+this.min&&(r=!0,i=this.min),this.calculateStartEnd(i,r,"endtime")},e.prototype.hide=function(t){var i=this;if(this.popupObj||this.dateTimeWrapper){this.preventArgs={cancel:!1,popup:this.popupObj||this.popupObject,event:t||null};var r=this.preventArgs;g(this.popupObj)?this.trigger("close",r,function(n){i.dateTimeCloseEventCallback(t,n)}):this.dateTimeCloseEventCallback(t,r)}else B.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit()},e.prototype.dateTimeCloseEventCallback=function(t,i){this.preventArgs=i,this.preventArgs.cancel||(this.isDatePopupOpen()?o.prototype.hide.call(this,t):this.isTimePopupOpen()&&(this.closePopup(t),K([document.body],zk),B.isDevice&&this.timeModal&&(this.timeModal.style.display="none",this.timeModal.outerHTML="",this.timeModal=null),this.setTimeActiveDescendant())),B.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit()},e.prototype.closePopup=function(t){if(this.isTimePopupOpen()&&this.popupObject){var i={name:"FadeOut",duration:Bk,delay:0};this.popupObject.hide(new It(i)),this.inputWrapper.container.classList.remove(Rk),Ie(this.inputElement,{"aria-expanded":"false"}),this.inputElement.removeAttribute("aria-owns"),this.inputElement.removeAttribute("aria-controls"),E.remove(document,"mousedown touchstart",this.documentClickHandler)}},e.prototype.preRender=function(){this.checkFormat(),this.dateTimeFormat=this.cldrDateTimeFormat(),o.prototype.preRender.call(this),K([this.inputElementCopy],[$p])},e.prototype.getProperty=function(t,i){i==="min"?this.setProperties({min:this.validateValue(t.min)},!0):this.setProperties({max:this.validateValue(t.max)},!0)},e.prototype.checkAttributes=function(t){for(var i=t?g(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["style","name","step","disabled","readonly","value","min","max","placeholder","type"],r,n=0,s=i;n<s.length;n++){var a=s[n];if(!g(this.inputElement.getAttribute(a)))switch(a){case"name":this.inputElement.setAttribute("name",this.inputElement.getAttribute(a));break;case"step":this.step=parseInt(this.inputElement.getAttribute(a),10);break;case"readonly":if(g(this.dateTimeOptions)||this.dateTimeOptions.readonly===void 0||t){var l=this.inputElement.getAttribute(a)==="disabled"||this.inputElement.getAttribute(a)===""||this.inputElement.getAttribute(a)==="true";this.setProperties({readonly:l},!t)}break;case"placeholder":(g(this.dateTimeOptions)||this.dateTimeOptions.placeholder===void 0||t)&&this.setProperties({placeholder:this.inputElement.getAttribute(a)},!t);break;case"min":(g(this.dateTimeOptions)||this.dateTimeOptions.min===void 0||t)&&(r=new Date(this.inputElement.getAttribute(a)),!this.isNullOrEmpty(r)&&!isNaN(+r)&&this.setProperties({min:r},!t));break;case"disabled":if(g(this.dateTimeOptions)||this.dateTimeOptions.enabled===void 0||t){var h=!(this.inputElement.getAttribute(a)==="disabled"||this.inputElement.getAttribute(a)==="true"||this.inputElement.getAttribute(a)==="");this.setProperties({enabled:h},!t)}break;case"value":(g(this.dateTimeOptions)||this.dateTimeOptions.value===void 0||t)&&(r=new Date(this.inputElement.getAttribute(a)),!this.isNullOrEmpty(r)&&!isNaN(+r)&&this.setProperties({value:r},!t));break;case"max":(g(this.dateTimeOptions)||this.dateTimeOptions.max===void 0||t)&&(r=new Date(this.inputElement.getAttribute(a)),!this.isNullOrEmpty(r)&&!isNaN(+r)&&this.setProperties({max:r},!t));break}}},e.prototype.requiredModules=function(){var t=[];return this.calendarMode==="Islamic"&&t.push({args:[this],member:"islamic",name:"Islamic"}),this.enableMask&&t.push(this.maskedDateModule()),t},e.prototype.maskedDateModule=function(){var t={args:[this],member:"MaskedDateTime"};return t},e.prototype.getTimeActiveElement=function(){return g(this.dateTimeWrapper)?null:this.dateTimeWrapper.querySelectorAll("."+Wl)},e.prototype.createDateObj=function(t){return t instanceof Date?t:null},e.prototype.getDateObject=function(t){if(!this.isNullOrEmpty(t)){var i=this.createDateObj(t),r=this.valueWithMinutes,n=!g(r);if(this.checkDateValue(i)){var s=n?r.getDate():g_,a=n?r.getMonth():v_,l=n?r.getFullYear():m_,h=n?r.getHours():y_,u=n?r.getMinutes():b_,c=n?r.getSeconds():S_,d=n?r.getMilliseconds():C_;return this.scrollInvoked?(this.scrollInvoked=!1,new Date(l,a,s,i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds())):new Date(l,a,s,h,u,c,d)}}return null},e.prototype.findNextTimeElement=function(t){var i=this.inputElement.value,r=g(this.valueWithMinutes)?this.createDateObj(i):this.getDateObject(this.valueWithMinutes),n=null,s=this.liCollections.length;if(!g(this.activeIndex)||!g(this.checkDateValue(r))){if(t.action==="home")n=+this.createDateObj(new Date(this.timeCollections[0])),this.activeIndex=0;else if(t.action==="end")n=+this.createDateObj(new Date(this.timeCollections[this.timeCollections.length-1])),this.activeIndex=this.timeCollections.length-1;else if(t.action==="down"){for(var a=0;a<s;a++)if(+r<this.timeCollections[a]){n=+this.createDateObj(new Date(this.timeCollections[a])),this.activeIndex=a;break}}else for(var a=s-1;a>=0;a--)if(+r>this.timeCollections[a]){n=+this.createDateObj(new Date(this.timeCollections[a])),this.activeIndex=a;break}this.selectedElement=this.liCollections[this.activeIndex],this.timeElementValue(g(n)?null:new Date(n))}},e.prototype.setTimeValue=function(t,i){var r,n,s=this.validateMinMaxRange(i),a=this.createDateObj(s);return this.getFormattedValue(a)!==(g(this.value)?null:this.getFormattedValue(this.value))?(this.valueWithMinutes=g(a)?null:a,n=new Date(+this.valueWithMinutes)):(this.strictMode&&(t=a),this.valueWithMinutes=this.checkDateValue(t),n=new Date(+this.valueWithMinutes)),this.calendarMode==="Gregorian"?r=this.globalize.formatDate(n,{format:g(this.formatString)?this.cldrDateTimeFormat():this.formatString,type:"dateTime",skeleton:"yMd"}):r=this.globalize.formatDate(n,{format:g(this.formatString)?this.cldrDateTimeFormat():this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}),!this.strictMode&&g(n)?Ce.setValue(r,this.inputElement,this.floatLabelType,this.showClearButton):Ce.setValue(r,this.inputElement,this.floatLabelType,this.showClearButton),n},e.prototype.timeElementValue=function(t){if(!g(this.checkDateValue(t))&&!this.isNullOrEmpty(t)){var i=t instanceof Date?t:this.getDateObject(t);return this.setTimeValue(i,t)}return null},e.prototype.timeKeyHandler=function(t){if(!(g(this.step)||this.step<=0)){var i=this.timeCollections.length;if(g(this.getTimeActiveElement())||this.getTimeActiveElement().length===0)this.liCollections.length>0&&(g(this.value)&&g(this.activeIndex)?(this.activeIndex=0,this.selectedElement=this.liCollections[0],this.timeElementValue(new Date(this.timeCollections[0]))):this.findNextTimeElement(t));else{var r=void 0;if(t.keyCode>=37&&t.keyCode<=40){var n=t.keyCode===40||t.keyCode===39?++this.activeIndex:--this.activeIndex;this.activeIndex=n=this.activeIndex===i?0:this.activeIndex,this.activeIndex=n=this.activeIndex<0?i-1:this.activeIndex,r=g(this.timeCollections[n])?this.timeCollections[0]:this.timeCollections[n]}else t.action==="home"?(this.activeIndex=0,r=this.timeCollections[0]):t.action==="end"&&(this.activeIndex=i-1,r=this.timeCollections[i-1]);this.selectedElement=this.liCollections[this.activeIndex],this.timeElementValue(new Date(r))}this.isNavigate=!0,this.setTimeHover(this.selectedElement,M_),this.setTimeActiveDescendant(),this.isTimePopupOpen()&&this.selectedElement!==null&&(!t||t.type!=="click")&&this.setTimeScrollPosition()}},e.prototype.timeKeyActionHandle=function(t){if(this.enabled)switch(t.action!=="right"&&t.action!=="left"&&t.action!=="tab"&&t.preventDefault(),t.action){case"up":case"down":case"home":case"end":this.timeKeyHandler(t);break;case"enter":this.isNavigate?(this.selectedElement=this.liCollections[this.activeIndex],this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),this.setInputValue("time"),+this.previousDateTime!=+this.value&&(this.changedArgs.value=this.value,this.addTimeSelection(),this.previousDateTime=this.value)):this.updateValue(t),this.hide(t),Y([this.inputWrapper.container],Kp),this.isNavigate=!1,t.stopPropagation();break;case"escape":this.hide(t);break;default:this.isNavigate=!1;break}},e.prototype.inputKeyAction=function(t){switch(t.action){case"altDownArrow":this.strictModeUpdate(),this.updateInput(),this.toggle(t);break}},e.prototype.onPropertyChanged=function(t,i){for(var r=0,n=Object.keys(t);r<n.length;r++){var s=n[r],a=["blur","change","cleared","close","created","destroyed","focus","navigated","open","renderDayCell"];switch(a.indexOf(s)>0&&this.isReact&&(this.isDynamicValueChanged=!0),s){case"value":this.isDynamicValueChanged=!0,this.invalidValueString=null,this.checkInvalidValue(t.value),t.value=this.value,t.value=this.validateValue(t.value),this.enableMask?Ce.setValue(this.maskedDateValue,this.inputElement,this.floatLabelType,this.showClearButton):Ce.setValue(this.getFormattedValue(t.value),this.inputElement,this.floatLabelType,this.showClearButton),this.valueWithMinutes=t.value,this.setProperties({value:t.value},!0),this.popupObj&&this.popupUpdate(),this.previousDateTime=new Date(this.inputElement.value),this.updateInput(),this.changeTrigger(null),this.preventChange=this.isAngular&&this.preventChange?!this.preventChange:this.preventChange,this.enableMask&&this.value&&this.notify("createMask",{module:"MaskedDateTime"});break;case"min":case"max":this.getProperty(t,s),this.updateInput();break;case"enableRtl":Ce.setEnableRtl(this.enableRtl,[this.inputWrapper.container]);break;case"cssClass":g(i.cssClass)||(i.cssClass=i.cssClass.replace(/\s+/g," ").trim()),g(t.cssClass)||(t.cssClass=t.cssClass.replace(/\s+/g," ").trim()),Ce.setCssClass(t.cssClass,[this.inputWrapper.container],i.cssClass),this.dateTimeWrapper&&Ce.setCssClass(t.cssClass,[this.dateTimeWrapper],i.cssClass);break;case"locale":this.globalize=new Et(this.locale),this.l10n.setLocale(this.locale),this.dateTimeOptions&&this.dateTimeOptions.placeholder==null&&(this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),Ce.setPlaceholder(this.l10n.getConstant("placeholder"),this.inputElement)),this.dateTimeFormat=this.cldrDateTimeFormat(),o.prototype.updateInput.call(this);break;case"htmlAttributes":this.updateHtmlAttributeToElement(),this.updateHtmlAttributeToWrapper(),this.checkAttributes(!0);break;case"format":this.setProperties({format:t.format},!0),this.checkFormat(),this.dateTimeFormat=this.formatString,this.setValue(),this.enableMask&&(this.notify("createMask",{module:"MaskedDateTime"}),this.value||Ce.setValue(this.maskedDateValue,this.inputElement,this.floatLabelType,this.showClearButton));break;case"placeholder":Ce.setPlaceholder(t.placeholder,this.inputElement);break;case"enabled":Ce.setEnabled(this.enabled,this.inputElement),this.enabled?this.inputElement.setAttribute("tabindex",this.tabIndex):this.inputElement.tabIndex=-1;break;case"strictMode":this.invalidValueString=null,this.updateInput();break;case"width":this.setWidth(t.width),Ce.calculateWidth(this.inputElement,this.inputWrapper.container),!g(this.inputWrapper.buttons[0])&&!g(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-date-time-icon");break;case"readonly":Ce.setReadonly(this.readonly,this.inputElement);break;case"floatLabelType":this.floatLabelType=t.floatLabelType,Ce.removeFloating(this.inputWrapper),Ce.addFloating(this.inputElement,this.floatLabelType,this.placeholder),!g(this.inputWrapper.buttons[0])&&!g(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-date-time-icon");break;case"scrollTo":this.checkDateValue(new Date(this.checkValue(t.scrollTo)))?(this.dateTimeWrapper&&this.setScrollTo(),this.setProperties({scrollTo:this.checkDateValue(new Date(this.checkValue(t.scrollTo)))},!0)):this.setProperties({scrollTo:null},!0);break;case"enableMask":this.enableMask?(this.notify("createMask",{module:"MaskedDateTime"}),Ce.setValue(this.maskedDateValue,this.inputElement,this.floatLabelType,this.showClearButton)):this.inputElement.value===this.maskedDateValue&&(this.maskedDateValue="",Ce.setValue(this.maskedDateValue,this.inputElement,this.floatLabelType,this.showClearButton));break;default:o.prototype.onPropertyChanged.call(this,t,i);break}this.isDynamicValueChanged||this.hide(null),this.isDynamicValueChanged=!1}},e.prototype.getModuleName=function(){return"datetimepicker"},e.prototype.restoreValue=function(){this.previousDateTime=this.previousDate,this.currentDate=this.value?this.value:new Date,this.valueWithMinutes=this.value,this.previousDate=this.value,this.previousElementValue=this.previousElementValue=g(this.inputValueCopy)?"":this.getFormattedValue(this.inputValueCopy)},ri([C(null)],e.prototype,"timeFormat",void 0),ri([C(30)],e.prototype,"step",void 0),ri([C(null)],e.prototype,"scrollTo",void 0),ri([C(1e3)],e.prototype,"zIndex",void 0),ri([C(null)],e.prototype,"value",void 0),ri([C(null)],e.prototype,"keyConfigs",void 0),ri([C({})],e.prototype,"htmlAttributes",void 0),ri([C(!1)],e.prototype,"enablePersistence",void 0),ri([C(!0)],e.prototype,"allowEdit",void 0),ri([C(!1)],e.prototype,"isMultiSelection",void 0),ri([C(null)],e.prototype,"values",void 0),ri([C(!0)],e.prototype,"showClearButton",void 0),ri([C(null)],e.prototype,"placeholder",void 0),ri([C(!1)],e.prototype,"strictMode",void 0),ri([C(!1)],e.prototype,"fullScreenMode",void 0),ri([C(null)],e.prototype,"serverTimezoneOffset",void 0),ri([C(new Date(1900,0,1))],e.prototype,"min",void 0),ri([C(new Date(2099,11,31))],e.prototype,"max",void 0),ri([C(null)],e.prototype,"minTime",void 0),ri([C(null)],e.prototype,"maxTime",void 0),ri([C(null)],e.prototype,"firstDayOfWeek",void 0),ri([C("Gregorian")],e.prototype,"calendarMode",void 0),ri([C("Month")],e.prototype,"start",void 0),ri([C("Month")],e.prototype,"depth",void 0),ri([C(!1)],e.prototype,"weekNumber",void 0),ri([C(!0)],e.prototype,"showTodayButton",void 0),ri([C("Short")],e.prototype,"dayHeaderFormat",void 0),ri([C(!1)],e.prototype,"openOnFocus",void 0),ri([C(!1)],e.prototype,"enableMask",void 0),ri([C({day:"day",month:"month",year:"year",hour:"hour",minute:"minute",second:"second",dayOfTheWeek:"day of the week"})],e.prototype,"maskPlaceholder",void 0),ri([q()],e.prototype,"open",void 0),ri([q()],e.prototype,"close",void 0),ri([q()],e.prototype,"cleared",void 0),ri([q()],e.prototype,"blur",void 0),ri([q()],e.prototype,"focus",void 0),ri([q()],e.prototype,"created",void 0),ri([q()],e.prototype,"destroyed",void 0),e=ri([bt],e),e}(zw);var qY=new Int16Array(286),GY=new Uint8Array(286),YY=new Int16Array(30),QY=new Uint8Array(30);var _k;(function(o){var e;(function(i){i[i.None=0]="None",i[i.Ascii=1]="Ascii",i[i.Unicode=2]="Unicode"})(e=o.ForceEncoding||(o.ForceEncoding={}));var t=function(i){return i[i.StringValue=0]="StringValue",i[i.ByteBuffer=1]="ByteBuffer",i}(t||{})})(_k||(_k={}));var P_=function(){function o(e){this.intl=new Et,g(e)||(this.intl.culture=e)}return o.prototype.getFormatFunction=function(e){return!g(e)&&(e.type==="dateTime"||e.type==="datetime"||e.type==="date"||e.type==="time")?this.intl.getDateFormat(e):this.intl.getNumberFormat(e)},o.prototype.getParserFunction=function(e){return e.type?this.intl.getDateParser(e):this.intl.getNumberParser(e)},o.prototype.fromView=function(e,t,i){return(i==="date"||i==="datetime"||i==="number")&&!g(t)?t(e):e},o.prototype.toView=function(e,t){var i=e;return!g(t)&&!g(e)&&(i=t(e)),i},o.prototype.setCulture=function(e){g(e)||CA(e)},o}();var Uk="actionBegin",Sm="actionComplete";var jw="filterchoicerequest",B_="filterAfterOpen",z_="filterBeforeOpen",j_="filterSearchBegin";var ef="filterDialogCreated",H_="filter-menu-close";var Hw="generateQuery";var V_="foreignKeyData";var iN="dataStateChange";var Am="beforeCustomFilterOpen";var __="cbox-filter-begin",Wk="cbox-filter-complete",_h="filter-Prevent",Tm="before-filter-cmenu-open";var Lm="filter-cbox-value";var U_="beforeCheckboxRenderer";var Yl="filter-dialog-close",qk="refresh-cutsom-filter-ok-button",W_="refresh-cutsom-filter-clear-button",Gk="render-responsive-cmenu",km="filter-cmenu-select",q_="custom-filter-close";var G_="before-checkbox-renderer-query";var Y_="after-filter-column-menu-close",Q_="beforeCheckboxfilterRenderer";var X_="e-gridheader",$_="e-gridcontent";var K_="colgroup",Cm="open",wm="change",xm="focus";function Z_(o,e,t){return g(o)||o===""?"":de.getObject(o,e)}function Zp(o,e,t,i){for(var r=he(o,e,t),n=Object.keys(r),s=0;s<n.length;s++)i&&i.indexOf(n[parseInt(s.toString(),10)])!==-1&&delete r[n[parseInt(s.toString(),10)]];return r}function Yk(o){return o instanceof Re?V("properties",o):o}function xr(o,e,t){for(var i=o;i&&!(t?i.id===e:i.classList.contains(e));)i=i.parentElement;return i}var J_=0;function go(o){return o+J_++}function Tc(o,e){for(var t=0,i=e.length;t<i;t++)i===e.length?o.appendChild(e[parseInt(t.toString(),10)]):o.appendChild(e[0]);return o}function nl(o){return o.split(".").length>1}function Gl(o){return o===void 0&&(o=""),o.replace(/\./g,"___")}function eU(o){for(var e={},t=[],i=0;i<o.length;i++)o[parseInt(i.toString(),10)]in e||(t.push(o[parseInt(i.toString(),10)].toString()),e[o[parseInt(i.toString(),10)]]=1);return t}function tU(o,e){var t=e.element.style.display;e.element.style.display="block";var i=e.width,r=lv(o,e.element);e.element.style.display=t,e.element.style.top=r.top+o.getBoundingClientRect().height-5+"px";var n=r.left-i+o.clientWidth;n<1?e.element.style.left=i+n-16+"px":e.element.style.left=n+-4+"px"}function Vh(o){var e=o.querySelector(".e-frame"),t=e.previousSibling;e.classList.contains("e-check")?(t.checked=!1,wi(e,["e-uncheck"],["e-check"])):(t.checked=!0,wi(e,["e-check"],["e-uncheck"]))}function Im(o,e){o.checked=e}function sl(o,e,t){var i=Xe("div",{className:t});return i.appendChild(e),i.setAttribute("uid",o),i}function iU(o,e){K([o],["e-check","e-stop","e-uncheck"]),e?o.classList.add("e-check"):o.classList.add("e-uncheck")}function Qk(o,e,t,i){var r=o.foreignKeyField,n=g(t)?Z_(o.field,e):t;n=g(n)?"":n;var s=new Pe,a=i||(o.dataSource instanceof re&&o.dataSource.dataSource.json.length?o.dataSource.dataSource.json:o.columnData);return n.getDay?s.where(Lc({field:r,operator:"equal",value:n,matchCase:!1})):s.where(r,"==",n,!1),new re(a).executeLocal(s)}function rU(o,e){var t;return e.some(function(i){return t=i,i.foreignKeyValue===o})&&t}function Em(o){return o<10?"0"+o:String(o)}function Lc(o,e,t){var i,r,n,s=he({},Yk(o)),a=he({},Yk(o));if(g(o.value)||o.value==="")return i=new St(s.field,s.operator,s.value,!1),i;var l=new Date(o.value);if(e==="dateonly"&&!t){typeof s.value=="string"&&(s.value=new Date(s.value));var h=s.value.getFullYear()+"-"+Em(s.value.getMonth()+1)+"-"+Em(s.value.getDate()),u=new St(s.field,s.operator,h,!1);i=u}else if(o.operator=o.operator.toLowerCase(),o.operator==="equal"||o.operator==="notequal"){e==="datetime"?(r=new Date(l.setSeconds(l.getSeconds()-1)),n=new Date(l.setSeconds(l.getSeconds()+2)),o.value=new Date(l.setSeconds(n.getSeconds()-1))):(r=new Date(l.setHours(0)-1),n=new Date(l.setHours(24))),s.value=r,a.value=n,o.operator==="equal"?(s.operator="greaterthan",a.operator="lessthan"):o.operator==="notequal"&&(s.operator="lessthanorequal",a.operator="greaterthanorequal");var c=new St(s.field,s.operator,s.value,!1),d=new St(a.field,a.operator,a.value,!1);i=o.operator==="equal"?c.and(d):c.or(d)}else{e==="date"&&(o.operator==="lessthanorequal"||o.operator==="greaterthan")&&(s.value=new Date(l.setHours(24)-1)),typeof s.value=="string"&&(s.value=new Date(s.value));var u=new St(s.field,s.operator,s.value,!1);i=u}return o.setProperties?o.setProperties({ejpredicate:i},!0):o.ejpredicate=i,i}function Xk(o,e){if(o===void 0&&(o=""),o){for(var t=e,i=o.split("."),r=0;r<i.length&&!g(t);r++)if(t=t[i[parseInt(r.toString(),10)]],Ee(t)){var n=i[parseInt(r.toString(),10)].charAt(0).toUpperCase()+i[parseInt(r.toString(),10)].slice(1);t=e[""+n]||e[(""+n).charAt(0).toLowerCase()+(""+n).slice(1)]}return t}}function $k(o,e){var t=new Et,i,r="format",n="type";return e==="date"?i=typeof o=="object"?t.getDatePattern({type:o[""+n]?o[""+n]:"date",format:o[""+r]},!1):t.getDatePattern({type:"dateTime",skeleton:o},!1):i=typeof o=="object"?t.getDatePattern({type:o[""+n]?o[""+n]:"dateTime",format:o[""+r]},!1):t.getDatePattern({type:"dateTime",skeleton:o},!1),i}function nU(o,e,t,i){var r=o||{},n=arguments.length;i&&(n=n-1);for(var s=1;s<n;s++)if(arguments[parseInt(s.toString(),10)])for(var a=arguments[parseInt(s.toString(),10)],l=Object.keys(Object.getPrototypeOf(a)).length?Object.keys(a).concat(sU(a)):Object.keys(a),h=0;h<l.length;h++){var u=r[l[parseInt(h.toString(),10)]],c=a[l[parseInt(h.toString(),10)]],d=void 0;i&&(ms(c)||Array.isArray(c))?ms(c)?(d=u||{},r[l[parseInt(h.toString(),10)]]=he({},d,c,i)):(d=u||[],r[l[parseInt(h.toString(),10)]]=he([],d,c,i)):r[l[parseInt(h.toString(),10)]]=c}return r}function sU(o){for(var e=[];Object.getPrototypeOf(o)&&Object.keys(Object.getPrototypeOf(o)).length;)e=e.concat(Object.keys(Object.getPrototypeOf(o))),o=Object.getPrototypeOf(o);return e}var Jp=function(o){return o.timer=null,o}(Jp||{});function Kk(o,e){o.classList.contains("e-bigger")&&e.classList.add("e-bigger")}function rN(o,e){var t=aU(e),i=new kn;return t.dataSource=i.resolve,t.action=o,{state:t,deffered:i}}function aU(o){var e=new Al,t=new re({url:"",adaptor:new Al}),i=e.processQuery(t,o),r=JSON.parse(i.data);return r}function nN(o,e){var t=o.createElement("div",{className:"e-grid-popup",id:o.element.id+"_e-popup"}),i=br(o.element,"left","Top");document.getElementById(o.element.id+"_e-popup")&&(t=document.getElementById(o.element.id+"_e-popup")),t.style.top=i.top+"px",t.style.left=i.left+"px",t.style.zIndex=e.zIndex.toString(),t.style.width=e.element.offsetWidth+"px",t.appendChild(e.element);var r=document.querySelector(".sb-demo-section,.e-grid-dialog-fixed");if(r){var n=lv(o.element,r);t.style.top=n.top+"px",t.style.left=n.left+"px",r.insertBefore(t,r.firstChild)}else document.body.insertBefore(t,document.body.firstChild)}function Zk(o,e){for(var t,i=o.split(".").length,r=o.split("."),n=e,s=0;s<i;s++)t=n[r[parseInt(s.toString(),10)]],n=t;return t}function Jk(o,e,t,i){i.eventHandlers[""+o]={};for(var r=0;r<e.length;r++)i.eventHandlers[""+o][e[parseInt(r.toString(),10)]]=t[e[parseInt(r.toString(),10)]]}function eN(o,e,t){for(var i=0;i<e.length&&!o.isDestroyed;i++)o.removeEventListener(e[parseInt(i.toString(),10)],t.eventHandlers[o.element.id][e[parseInt(i.toString(),10)]])}function sN(o,e){o.destroyTemplate(e),o.isReact&&o.renderTemplates()}function Mm(o){for(var e=0;e<o.length;e++)Ue(o[e])}function tN(o,e){for(var t=0;t<o.length;t++)e.insertBefore(o[t],e.children[t])}function Dm(o,e){var t=e?Xe("li",{className:"e-cclist"}):Xe("div",{className:"e-ftrchk"});t.style.visibility="hidden",e&&(t.style.listStyle="none"),t.innerHTML=e?'<div class="e-ccheck"><div class="e-checkbox-wrapper"><span class="e-frame e-icons e-check"></span><span class="e-label">A</span></div></div>':'<div class="e-checkbox-wrapper"><span class="e-frame e-icons e-check"></span><span class="e-label e-checkboxfiltertext">A</div></span>',o.appendChild(t);var i=t.getBoundingClientRect();o.removeChild(t);var r=Math.round(i.height);return r}var Nm=function(){function o(e){this.searchInputArgs=null,this.isExecuteLocal=!1,this.queryFilteredColumn=[],this.existingPredicate={},this.foreignKeyQuery=new Pe,this.filterState=!0,this.values={},this.renderEmpty=!1,this.isCheckboxFilterTemplate=!1,this.infiniteRenderMod=!1,this.infiniteInitialLoad=!1,this.infiniteSearchValChange=!1,this.infinitePermenantLocalData=[],this.infiniteQueryExecutionPending=!1,this.infiniteSkipCnt=0,this.infiniteScrollAppendDiff=0,this.prevInfiniteScrollDirection="",this.infiniteLoadedElem=[],this.infiniteDataCount=0,this.infiniteLocalSelectAll=!0,this.localInfiniteSelectAllClicked=!1,this.localInfiniteSelectionInteracted=!1,this.infiniteManualSelectMaintainPred=[],this.parent=e,this.id=this.parent.element.id,this.valueFormatter=new P_(this.parent.locale),this.cBoxTrue=Uo(this.parent.createElement,!1,{checked:!0,label:" "}),this.cBoxFalse=Uo(this.parent.createElement,!1,{checked:!1,label:" "}),this.cBoxTrue.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxTrue.firstChild),this.cBoxFalse.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxFalse.firstChild),this.cBoxFalse.querySelector(".e-frame").classList.add("e-uncheck"),this.parent.enableRtl&&Y([this.cBoxTrue,this.cBoxFalse],["e-rtl"]),this.parent.cssClass&&(this.parent.cssClass.indexOf(" ")!==-1?Y([this.cBoxTrue,this.cBoxFalse],this.parent.cssClass.split(" ")):Y([this.cBoxTrue,this.cBoxFalse],[this.parent.cssClass]))}return o.prototype.destroy=function(){this.closeDialog()},o.prototype.wireEvents=function(){E.add(this.dlg,"click",this.clickHandler,this),E.add(this.dlg,"keyup",this.keyupHandler,this),this.searchHandler=Bg(this.searchBoxKeyUp,200);var e=this.dialogObj.element.querySelector(".e-searchinput");e&&(E.add(e,"keyup",this.searchHandler,this),E.add(e,"input",this.searchHandler,this))},o.prototype.unWireEvents=function(){E.remove(this.dlg,"click",this.clickHandler),E.remove(this.dlg,"keyup",this.keyupHandler);var e=this.dialogObj.element.querySelector(".e-searchinput");e&&(E.remove(e,"keyup",this.searchHandler),E.remove(e,"input",this.searchHandler))},o.prototype.foreignKeyFilter=function(e,t,i){var r=this,n={},s=[],a=this.foreignKeyQuery.clone();this.options.column.dataSource.executeQuery(a.where(i)).then(function(l){r.options.column.columnData=l.result,r.parent.notify(Hw,{predicate:n,column:r.options.column}),e.ejpredicate=n.predicate.predicates;for(var h=n.predicate.predicates,u=0;u<h.length;u++)s.push({field:h[parseInt(u.toString(),10)].field,predicate:"or",matchCase:h[parseInt(u.toString(),10)].ignoreCase,ignoreAccent:h[parseInt(u.toString(),10)].ignoreAccent,operator:h[parseInt(u.toString(),10)].operator,value:h[parseInt(u.toString(),10)].value,type:r.options.type});e.filterCollection=s.length?s:t.filter(function(c){return c.field=r.options.field}),r.options.handler(e)})},o.prototype.searchBoxClick=function(e){var t=e.target;t.classList.contains("e-searchclear")&&(this.sInput.value=t.classList.contains("e-chkcancel-icon")?"":this.sInput.value,this.isCheckboxFilterTemplate?this.parent.notify("refreshCheckbox",{event:e}):this.refreshCheckboxes(),this.updateSearchIcon(),this.sInput.focus())},o.prototype.searchBoxKeyUp=function(e){g(this.sInput)||(g(e)||e.key!=="ArrowUp"&&e.key!=="ArrowDown"&&e.key!=="Tab"&&!(e.key==="Tab"&&e.shiftKey))&&(!g(this.parent.loadingIndicator)&&this.parent.loadingIndicator.indicatorType==="Shimmer"&&this.parent.showMaskRow(void 0,this.dialogObj.element),this.isCheckboxFilterTemplate?this.parent.notify("refreshCheckbox",{event:e}):this.refreshCheckboxes(),this.updateSearchIcon())},o.prototype.updateSearchIcon=function(){this.sInput.value.length?(wi(this.sIcon,["e-chkcancel-icon"],["e-search-icon"]),g(document.body.querySelector(".e-chkcancel-icon"))||document.body.querySelector(".e-chkcancel-icon").setAttribute("title",this.localeObj.getConstant("Clear"))):(wi(this.sIcon,["e-search-icon"],["e-chkcancel-icon"]),g(document.body.querySelector(".e-searchclear.e-search-icon"))||document.body.querySelector(".e-searchclear.e-search-icon").setAttribute("title",this.localeObj.getConstant("Search")))},o.prototype.getLocalizedLabel=function(e){return this.localeObj.getConstant(e)},o.prototype.updateDataSource=function(){var e=this.options.dataSource,t="object";if(!(e instanceof re)){for(var i=0;i<e.length;i++)if(typeof e!==t){var r={};r[this.options.field]=e[parseInt(i.toString(),10)],e[parseInt(i.toString(),10)]=r}}},o.prototype.updateModel=function(e){this.options=e,this.existingPredicate=e.actualPredicate||{},this.options.dataSource=e.dataSource,this.options.dataManager=e.dataManager?e.dataManager:e.dataSource,this.updateDataSource(),this.options.type=e.type,this.options.format=e.format||"",this.options.ignoreAccent=e.ignoreAccent||!1,this.options.filteredColumns=e.filteredColumns||this.parent.filterSettings.columns,this.options.query=e.query||new Pe,this.options.allowCaseSensitive=e.allowCaseSensitive||!1,this.options.uid=e.column.uid,this.options.disableHtmlEncode=e.column.disableHtmlEncode||!1,this.values={},this.localeObj=e.localeObj,this.isFiltered=e.filteredColumns.length,this.infiniteRenderMod=!!(this.parent.filterSettings&&this.parent.filterSettings.enableInfiniteScrolling),this.infiniteUnloadParentExistPred=this.infiniteRenderMod&&this.existingPredicate[this.options.column.field]?this.existingPredicate[this.options.column.field].slice():[]},o.prototype.getAndSetChkElem=function(e){return this.dlg=this.parent.createElement("div",{id:this.id+this.options.type+"_excelDlg",attrs:{uid:this.options.column.uid},className:"e-checkboxfilter e-filter-popup"}),this.sBox=this.parent.createElement("div",{className:"e-searchcontainer"}),e.hideSearchbox||(this.sInput=this.parent.createElement("input",{id:this.id+"_SearchBox",className:"e-searchinput"}),this.sIcon=this.parent.createElement("span",{className:"e-searchclear e-search-icon e-icons e-input-group-icon",attrs:{type:"text",title:this.getLocalizedLabel("Search")}}),this.searchBox=this.parent.createElement("span",{className:"e-searchbox e-fields"}),this.searchBox.appendChild(this.sInput),this.sBox.appendChild(this.searchBox),this.searchInputArgs={element:this.sInput,floatLabelType:"Never",properties:{placeholder:this.getLocalizedLabel("Search"),cssClass:this.parent.cssClass}},Ce.createInput(this.searchInputArgs,this.parent.createElement),this.searchBox.querySelector(".e-input-group").appendChild(this.sIcon)),this.spinner=this.parent.createElement("div",{className:"e-spinner"}),this.cBox=this.parent.createElement("div",{id:this.id+this.options.type+"_CheckBoxList",className:"e-checkboxlist e-fields"}),this.spinner.appendChild(this.cBox),this.sBox.appendChild(this.spinner),this.sBox},o.prototype.showDialog=function(e){var t={requestType:z_,columnName:this.options.field,columnType:this.options.type,cancel:!1},i="filterModel";if(t[""+i]=this,this.parent.notify(__,t),t.cancel){e.cancel=t.cancel;return}this.dialogObj=new Ah({visible:!1,content:this.sBox,close:this.closeDialog.bind(this),enableRtl:this.parent.enableRtl,width:!g(xr(e.target,"e-bigger"))||this.parent.element.classList.contains("e-device")?260:255,target:this.parent.element,animationSettings:{effect:"None"},buttons:[{click:this.btnClick.bind(this),buttonModel:{content:this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton"),cssClass:this.parent.cssClass?"e-primary "+this.parent.cssClass:"e-primary",isPrimary:!0}},{click:this.btnClick.bind(this),buttonModel:{cssClass:this.parent.cssClass?"e-flat "+this.parent.cssClass:"e-flat",content:this.getLocalizedLabel(this.isExcel?"CancelButton":"ClearButton")}}],created:this.dialogCreated.bind(this),open:this.dialogOpen.bind(this),cssClass:this.parent.cssClass?this.parent.cssClass:""});var r="isStringTemplate";this.dialogObj[""+r]=!0,this.renderResponsiveFilter(e);var n=this.parent.filterSettings&&this.parent.filterSettings.type==="CheckBox"?this.getLocalizedLabel("CheckBoxFilterDialogARIA"):this.getLocalizedLabel("ExcelFilterDialogARIA");if(this.dlg.setAttribute("aria-label",n),e.isResponsiveFilter){var s=document.querySelector(".e-responsive-dialog > .e-dlg-content > .e-mainfilterdiv");s.appendChild(this.dlg)}else this.parent.element.appendChild(this.dlg);this.dialogObj.appendTo(this.dlg),this.dialogObj.element.style.maxHeight=e.isResponsiveFilter?"none":this.options.height+"px",this.dialogObj.show(),this.parent&&this.parent.filterSettings&&(this.parent.filterSettings.type==="CheckBox"||this.options.column&&this.options.column.filter&&this.options.column.filter.type==="CheckBox")&&this.parent.getContent().firstElementChild.offsetHeight<this.dialogObj.element.offsetHeight&&!xr(this.parent.element,"e-gantt-dialog")&&nN(this.parent,this.dialogObj);var a=this.dialogObj.element.querySelector(".e-dlg-content");if(a.appendChild(this.sBox),this.wireEvents(),!this.parent.enableAdaptiveUI)!g(this.parent.loadingIndicator)&&this.parent.loadingIndicator.indicatorType==="Shimmer"&&!this.infiniteRenderMod&&this.parent.showMaskRow(void 0,this.dialogObj.element),this.infiniteRenderMod&&this.parent.filterSettings&&this.parent.filterSettings.loadingIndicator==="Shimmer"&&this.showMask();else{if(this.infiniteRenderMod&&this.parent.filterSettings&&this.parent.filterSettings.loadingIndicator==="Shimmer"){this.getAllData();return}this.infiniteRenderMod&&(this.cBox.style.marginTop=Dm(this.cBox)+"px")}this.infiniteRenderMod&&this.parent.filterSettings&&this.parent.filterSettings.loadingIndicator==="Shimmer"||(Os({target:this.spinner,cssClass:this.parent.cssClass?this.parent.cssClass:null},this.parent.createElement),rs(this.spinner)),this.getAllData()},o.prototype.renderResponsiveFilter=function(e){e.isResponsiveFilter&&(this.dialogObj.buttons=[{}],this.dialogObj.position={X:"",Y:""},this.dialogObj.target=document.querySelector(".e-resfilter > .e-dlg-content > .e-mainfilterdiv"),this.dialogObj.width="100%")},o.prototype.dialogCreated=function(e){this.options.isResponsiveFilter?this.dialogObj.element.style.left="0px":B.isDevice?this.dialogObj.position={X:"center",Y:"center"}:tU(this.options.target,this.dialogObj),this.options.column.showColumnMenu&&this.parent.notify(ef,e)},o.prototype.openDialog=function(e){this.updateModel(e),this.getAndSetChkElem(e),this.showDialog(e)},o.prototype.closeDialog=function(){if(this.infiniteRenderMod&&this.infinitePermenantLocalData.length&&!this.options.isRemote&&(this.options.dataSource.dataSource.json=this.infinitePermenantLocalData),this.dialogObj&&!this.dialogObj.isDestroyed){this.isBlanks=!1;var e=this.options.columns.filter(function(i){return i.getFilterItemTemplate()}),t=this.parent.registeredTemplate;e.length&&!g(t)&&t.filterItemTemplate&&this.parent.destroyTemplate(["filterItemTemplate"]),(this.parent.isReact||this.parent.isVue)&&this.parent.destroyTemplate!==void 0&&sN(this.parent,["filterItemTemplate"]),this.parent.notify(H_,{field:this.options.field}),this.unWireEvents(),this.searchInputArgs&&this.searchInputArgs.element&&this.searchInputArgs.element.parentElement&&(Ce.destroy(this.searchInputArgs),Ue(this.searchInputArgs.element)),this.searchInputArgs=null,this.sInput=null,this.parent.isReact&&this.options.column.filter&&typeof this.options.column.filter.itemTemplate!="string"&&(this.options.column.filter.type==="CheckBox"||this.options.column.filter.type==="Excel")&&(this.dialogObj.element.querySelector(".e-dlg-content").innerHTML=""),this.dialogObj.destroy(),this.dialogObj.dlgClosedBy==="escape"&&(this.parent.isColumnMenuFilterClosing=!0),this.dlg&&this.dlg.parentElement&&Ue(this.dlg),this.dlg=null,this.parent.notify(Yl,{})}},o.prototype.clearFilter=function(e){var t={instance:this,handler:this.clearFilter,cancel:!1};this.parent.notify(_h,t),!t.cancel&&this.options.handler({action:"clear-filter",field:e?e.field:this.options.field})},o.prototype.btnClick=function(e){if(this.filterState){if(e.target.tagName.toLowerCase()==="input"&&e.target.classList.contains("e-searchinput")||e.keyCode===13)this.isCheckboxFilterTemplate||this.fltrBtnHandler();else{var t=e.target.firstChild.textContent.toLowerCase();this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton").toLowerCase()===t?this.isCheckboxFilterTemplate||this.fltrBtnHandler():this.getLocalizedLabel("ClearButton").toLowerCase()===t&&this.clearFilter()}this.closeDialog()}else e.target&&e.target.firstChild&&e.target.firstChild.textContent.toLowerCase()===this.getLocalizedLabel("CancelButton").toLowerCase()?this.closeDialog():e.target.tagName.toLowerCase()!=="input"&&(this.clearFilter(),this.closeDialog());this.options.column.showColumnMenu&&this.parent.notify(Y_,{}),g(this.parent.focusModule)||this.parent.focusModule.filterfocus()},o.prototype.fltrBtnHandler=function(){var e=this;this.infiniteRenderMod&&(this.cBox.innerHTML="",Tc(this.cBox,this.infiniteLoadedElem.slice()));var t=[].slice.call(this.cBox.querySelectorAll(".e-check:not(.e-selectall):not(.e-add-current)")),i=t,r="equal",n=this.dialogObj.element.querySelector(".e-dropdownlist");n&&(this.options.operator=r=n.ej2_instances[0].value),this.isMenuNotEqual=this.options.operator==="notequal";var s;this.options.hideSearchbox||(s=this.searchBox.querySelector(".e-searchinput"));var a=this.options.allowCaseSensitive,l={field:this.options.field,predicate:this.isMenuNotEqual?"and":"or",uid:this.options.uid,operator:r,type:this.options.type,matchCase:a,ignoreAccent:this.options.ignoreAccent},h=this.itemsCnt!==t.length&&this.itemsCnt-t.length<t.length;h&&s&&s.value===""&&(r=this.isMenuNotEqual?"equal":"notequal",t=[].slice.call(this.cBox.querySelectorAll(".e-uncheck:not(.e-selectall)")),l.predicate=this.isMenuNotEqual?"or":"and",l.operator=r);var u,c,d=[];if(t.length!==this.itemsCnt||s&&s.value&&s.value!==""||this.infiniteRenderMod){this.infiniteRenderMod?this.infiniteRenderMod&&(!this.infiniteSearchPred||this.infiniteSearchPred&&!this.infiniteSearchPred.isComplex)?this.infiniteFltrBtnHandler(d):this.infiniteSearchPred.isComplex&&(d=this.complexQueryPredicate(t,l,h)):d=this.complexQueryPredicate(t,l,h),(this.options.type==="date"||this.options.type==="datetime")&&i.length&&(c=i.length-1,u=this.values[xr(i[parseInt(c.toString(),10)],"e-ftrchk").getAttribute("uid")],g(u)&&h&&d.push({field:l.field,matchCase:l.matchCase,operator:"equal",predicate:"or",value:null}));var p=this.infiniteRenderMod?this.sBox.querySelector(".e-add-current"):this.cBox.querySelector(".e-add-current");if(p&&p.classList.contains("e-check")){var f=this.existingPredicate[this.options.field];if(f)for(var v=function(S){d.some(function(b){return b.value===f[parseInt(S.toString(),10)].value})||d.push(f[parseInt(S.toString(),10)])},m=0;m<f.length;m++)v(m);else return}if(!this.infiniteRenderMod)this.initiateFilter(d);else if(d.length)this.initiateFilter(d);else if(this.sBox.querySelector(".e-selectall").classList.contains("e-check")&&!d.length){var y=this.options.filteredColumns.some(function(S){return e.options.field===S.field});y&&this.clearFilter()}}else{var y=this.options.filteredColumns.some(function(b){return e.options.field===b.field});y&&this.clearFilter()}},o.prototype.complexQueryPredicate=function(e,t,i){for(var r,n,s=[],a=0;a<e.length;a++)r=this.values[xr(e[parseInt(a.toString(),10)],"e-ftrchk").getAttribute("uid")],n=he({},{value:r},t),r&&!r.toString().length&&(n.operator=i?"notequal":"equal"),r===""||g(r)?s=s.concat(o.generateNullValuePredicates(t)):s.push(n),this.notifyFilterPrevEvent(n);return s},o.prototype.infiniteFltrBtnHandler=function(e){var t;if(this.infiniteManualSelectMaintainPred.length)for(var i=0;i<this.infiniteManualSelectMaintainPred.length;i++){var r=this.infiniteManualSelectMaintainPred[i];if(t=r.value+"",t===""||g(t)){var n={predicate:r.predicate,field:r.field,type:r.type,uid:r.uid,operator:r.operator,matchCase:r.matchCase,ignoreAccent:r.ignoreAccent};e.push.apply(e,o.generateNullValuePredicates(n))}else e.push(this.infiniteManualSelectMaintainPred[i]);this.notifyFilterPrevEvent(this.infiniteManualSelectMaintainPred[i])}if(!this.localInfiniteSelectAllClicked&&this.sInput.value===""&&!(!this.options.parentCurrentViewDataCount&&e.length))for(var i=0;i<this.infiniteUnloadParentExistPred.length;i++)e.unshift(this.infiniteUnloadParentExistPred[i]),this.notifyFilterPrevEvent(this.existingPredicate[this.options.field][i]);this.sInput.value!==""&&(!this.localInfiniteSelectAllClicked||this.infiniteLocalSelectAll)&&(this.infiniteSearchPred.predicate="or",e.unshift(this.infiniteSearchPred),this.notifyFilterPrevEvent(this.infiniteSearchPred))},o.prototype.notifyFilterPrevEvent=function(e){var t={instance:this,handler:this.fltrBtnHandler,arg1:e.field,arg2:e.predicate,arg3:e.operator,arg4:e.matchCase,arg5:e.ignoreAccent,arg6:e.value,cancel:!1};this.parent.notify(_h,t),t.cancel},o.generateNullValuePredicates=function(e){var t=[];return e.type==="string"&&t.push({field:e.field,ignoreAccent:e.ignoreAccent,matchCase:e.matchCase,operator:e.operator,predicate:e.predicate,value:""}),t.push({field:e.field,matchCase:e.matchCase,operator:e.operator,predicate:e.predicate,value:null}),t.push({field:e.field,matchCase:e.matchCase,operator:e.operator,predicate:e.predicate,value:void 0}),t},o.prototype.initiateFilter=function(e){var t=e[0],i;if(!g(t)){i=t.ejpredicate?t.ejpredicate:new St(t.field,t.operator,t.value,!t.matchCase,t.ignoreAccent);for(var r=1;r<e.length;r++)i=e[parseInt(r.toString(),10)].ejpredicate!==void 0?i[e[parseInt(r.toString(),10)].predicate](e[parseInt(r.toString(),10)].ejpredicate):i[e[parseInt(r.toString(),10)].predicate](e[parseInt(r.toString(),10)].field,e[parseInt(r.toString(),10)].operator,e[parseInt(r.toString(),10)].value,!e[parseInt(r.toString(),10)].matchCase,e[parseInt(r.toString(),10)].ignoreAccent);var n={action:"filtering",filterCollection:e,field:this.options.field,ejpredicate:St.or(i)};this.options.handler(n)}},o.prototype.isForeignColumn=function(e){return e.isForeignColumn?e.isForeignColumn():!1},o.prototype.refreshCheckboxes=function(){var e=this,t=this.sInput.value,i=this.options.column,r=this.isForeignColumn(i)?this.foreignKeyQuery.clone():this.options.query.clone(),n=this.options.query.clone(),s=r.queries.filter(function(b){return b&&b.fn==="onWhere"})[0];r.queries=[],n.queries=[];var a=this.options.type!=="string"&&parseFloat(t)?parseFloat(t):t,l=this.options.isRemote?this.options.type==="string"?"contains":"equal":this.options.type?"contains":"equal",h=!0,u=this.options.ignoreAccent,c=this.isForeignColumn(i)?i.foreignKeyValue:i.field;a=a===""||a===void 0?void 0:a;var d=[],p={field:c,predicate:"or",uid:this.options.uid,operator:"equal",type:this.options.type,matchCase:h,ignoreAccent:u},f,v=this.options.dataManager.adaptor.getModuleName;if(this.options.type==="boolean"&&(a!==void 0&&this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(a.toLowerCase())!==-1?a="true":a!==void 0&&this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(a.toLowerCase())!==-1&&(a="false"),a!==void 0&&this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(a.toLowerCase())!==-1&&v?a=(v(),!0):a!==void 0&&this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(a.toLowerCase())!==-1&&v&&(a=(v(),!1)),l="equal"),(this.options.type==="date"||this.options.type==="datetime"||this.options.type==="dateonly")&&this.options.format){var m=new Et,y=typeof this.options.format=="string"?this.options.format:this.options.format.format;y?a=m.parseDate(t,{format:y})||new Date(t):a=new Date(t),this.options.type==="dateonly"&&(a=a.getFullYear()+"-"+Em(a.getMonth()+1)+"-"+Em(a.getDate()))}this.infiniteSearchValChange=!0,this.infiniteLoadedElem=[],this.infiniteLocalSelectAll=!0,this.localInfiniteSelectAllClicked=!1,this.localInfiniteSelectionInteracted=!1,this.infiniteSkipCnt=0,this.infiniteDataCount=0,this.infiniteManualSelectMaintainPred=[],this.sInput.value===""?this.infiniteUnloadParentExistPred=this.infiniteRenderMod&&this.existingPredicate[this.options.column.field]?this.existingPredicate[this.options.column.field].slice():[]:this.infiniteUnloadParentExistPred=[],this.addDistinct(r);var S={requestType:j_,filterModel:this,columnName:c,column:i,operator:l,matchCase:h,ignoreAccent:u,filterChoiceCount:null,query:r,value:a};this.infiniteRenderMod&&this.parent.filterSettings.itemsCount&&(S.filterChoiceCount=this.parent.filterSettings.itemsCount),this.parent.trigger(Uk,S,function(b){if(b.operator=b.operator,f=new St(c,b.operator,S.value,b.matchCase,b.ignoreAccent),e.options.type==="date"||e.options.type==="datetime"||e.options.type==="dateonly"){l="equal";var w={field:c,operator:l,value:a,matchCase:h,ignoreAccent:u};g(a)||(f=Lc(w,e.options.type))}if(t&&typeof t=="string"&&e.isBlanks&&e.getLocalizedLabel("Blanks").toLowerCase().indexOf(t.toLowerCase())>=0){d=d.concat(o.generateNullValuePredicates(p));var I=o.generatePredicate(d);I.predicates.push(f),f=I,r.where(I)}else t.length?(f=g(s)?f:f.and(s.e),r.where(f)):g(s)||(f=s.e,r.where(s.e));e.infiniteSearchPred=f,b.filterChoiceCount=g(b.filterChoiceCount)?1e3:b.filterChoiceCount,e.infiniteRenderMod&&e.parent.filterSettings.itemsCount!==b.filterChoiceCount&&(e.parent.filterSettings.itemsCount=S.filterChoiceCount);var x={};if(rs(e.spinner),e.renderEmpty=!1,e.isForeignColumn(i)&&t.length){var M="result"in i.dataSource?new re(i.dataSource.result):i.dataSource;M.executeQuery(r).then(function(D){var A=e.options.column.columnData;e.options.column.columnData=D.result,e.parent.notify(Hw,{predicate:x,column:i}),x.predicate.predicates.length?n.where(x.predicate):e.renderEmpty=!0,e.options.column.columnData=A,e.infiniteRenderMod?(e.infiniteInitialLoad=!!g(e.fullData),e.makeInfiniteScrollRequest(n),n.requiresCount()):n.take(b.filterChoiceCount),e.search(b,n)})}else e.infiniteRenderMod&&e.parent.filterSettings.itemsCount?(e.infiniteInitialLoad=!!g(e.fullData),e.makeInfiniteScrollRequest(r),r.requiresCount()):r.take(b.filterChoiceCount),e.search(b,r)})},o.prototype.search=function(e,t){this.parent.dataSource&&"result"in this.parent.dataSource?this.filterEvent(e,t):this.processSearch(t)},o.prototype.getPredicateFromCols=function(e,t){for(var i=o.getPredicate(e,t),r=[],n={},s=this.parent.getForeignKeyColumns!==void 0,a=s?this.parent.getForeignKeyColumns():[],l=0,h=Object.keys(i);l<h.length;l++){var u=h[l],c=void 0;s&&!this.parent.getColumnByField(u)&&(c=rU(u,a)),c?(this.parent.notify(Hw,{predicate:n,column:c}),n.predicate.predicates.length&&r.push(St.or(n.predicate.predicates))):r.push(i[""+u])}return r.length&&St.and(r)},o.prototype.getQuery=function(){return this.parent.getQuery?this.parent.getQuery().clone():new Pe},o.prototype.getAllData=function(){var e=this;this.customQuery=!1;var t=this.getQuery(),i=this.options.dataManager.adaptor.getModuleName;!g(this.parent.getDataModule)&&i&&i()==="ODataV4Adaptor"||t.requiresCount(),this.addDistinct(t);var r={requestType:jw,query:t,filterChoiceCount:null},n="filterModel";r[""+n]=this,this.infiniteRenderMod&&this.parent.filterSettings.itemsCount&&(r.filterChoiceCount=this.parent.filterSettings.itemsCount),this.parent.trigger(Uk,r,function(s){s.filterChoiceCount=g(s.filterChoiceCount)?1e3:s.filterChoiceCount,e.infiniteRenderMod&&e.parent.filterSettings.itemsCount!==s.filterChoiceCount&&(e.parent.filterSettings.itemsCount=s.filterChoiceCount),e.infiniteRenderMod||t.take(s.filterChoiceCount),(!s.query.distincts.length||e.infiniteRenderMod)&&(e.customQuery=!0,e.queryGenerate(t)),e.infiniteRenderMod&&(e.infiniteInitialLoad=!!g(e.fullData),e.makeInfiniteScrollRequest(t)),e.parent.dataSource&&"result"in e.parent.dataSource?e.filterEvent(s,t):e.processDataOperation(t,!0)})},o.prototype.addDistinct=function(e){var t=this,i=de.distinct(this.options.filteredColumns,"field");i.indexOf(this.options.column.field)<=-1&&(i=i.concat(this.options.column.field));var r=this.options.dataManager.adaptor.getModuleName;if(r&&r()==="ODataV4Adaptor"&&this.parent&&this.parent.query instanceof Pe)for(var n=this.parent.query,s=0;s<n.queries.length;s++){var a=n.queries[parseInt(s.toString(),10)];a.fn==="onWhere"&&(this.getPredicateFields(a.e),this.queryFilteredColumn.map(function(c){i.indexOf(c)===-1&&i.push(c)}),this.queryFilteredColumn=[])}if(this.infiniteRenderMod||e.distinct(i),this.infiniteRenderMod&&!this.options.isRemote&&this.sInput.value===""){this.options.dataSource=this.options.dataSource instanceof re?this.options.dataSource:new re(this.options.dataSource),this.infinitePermenantLocalData=this.options.dataSource.dataSource.json.slice();var l=new Pe;this.queryGenerate(l);var h=new re(this.options.dataSource.dataSource).executeLocal(l);this.options.dataSource.dataSource.json=de.distinct(h,this.options.column.field,!0),this.isForeignColumn(this.options.column)&&(this.options.column.dataSource=this.options.column.dataSource instanceof re?this.options.column.dataSource:new re(this.options.column.dataSource),this.options.dataSource.dataSource.json=this.options.dataSource.dataSource.json.map(function(c,d){return Object.assign({},c,t.options.column.dataSource.dataSource.json[d])}))}else if(this.infiniteRenderMod&&this.options.isRemote){e.select(this.options.column.field),e.sortBy(this.options.column.field,"ascending");var u=this.options.dataManager.adaptor.getModuleName;u&&u()&&(u()==="ODataV4Adaptor"||u()==="WebApiAdaptor"||u()==="CustomDataAdaptor"||u()==="GraphQLAdaptor"||u()==="ODataAdaptor")&&e.distinct(i)}return e},o.prototype.getPredicateFields=function(e){var t=this;e.isComplex&&e.predicates?e.predicates.forEach(function(i){Array.isArray(i)?i.forEach(function(r){return t.getPredicateFields(r)}):t.getPredicateFields(i)}):e.field&&!e.isComplex&&this.queryFilteredColumn.indexOf(e.field)<=-1&&(this.queryFilteredColumn=this.queryFilteredColumn.concat(de.distinct([e.field],"field")))},o.prototype.filterEvent=function(e,t){var i=this,r=rN(e,t);this.parent.trigger(iN,r.state),this.addInfiniteScrollEvent(t);var n=r.deffered;n.promise.then(function(s){i.infiniteDataCount=i.infiniteRenderMod&&!i.infiniteDataCount?s.count:i.infiniteDataCount;var a=i.infiniteRenderMod?s.result:s;i.dataSuccess(a)})},o.prototype.addInfiniteScrollEvent=function(e){this.infiniteRenderMod&&(this.infiniteQuery=e.clone(),this.infiniteInitialLoad?(this.cBox.classList.add("e-checkbox-infinitescroll"),E.add(this.cBox,"scroll",this.infiniteScrollHandler,this),E.add(this.cBox,"mouseup",this.infiniteScrollMouseKeyUpHandler,this),E.add(this.cBox,"mousedown",this.infiniteScrollMouseKeyDownHandler,this)):this.infiniteSearchValChange&&(this.cBox.innerHTML=""))},o.prototype.infiniteScrollMouseKeyDownHandler=function(){E.remove(this.cBox,"scroll",this.infiniteScrollHandler)},o.prototype.infiniteScrollMouseKeyUpHandler=function(e){var t=this;E.add(this.cBox,"scroll",this.infiniteScrollHandler,this);var i=this.cBox;i.children.length>1&&(i.scrollTop>=i.scrollHeight-i.offsetHeight||i.scrollTop<=0)&&this.infiniteScrollHandler(),Jp.timer=setTimeout(function(){t.clickHandler(e),Jp.timer=null},0)},o.prototype.getShimmerTemplate=function(){return'<span class="e-mask e-skeleton e-skeleton-text e-shimmer-wave"></span>'},o.prototype.showMask=function(){var e=5,t,i=this.parent.createElement("div",{id:this.id+this.options.type+"_CheckBoxMaskList",className:"e-checkboxlist e-fields e-infinite-list e-masklist"});i.style.zIndex="10";var r=this.cBox;if(this.removeMask(),r){var n=getComputedStyle(r),s=Dm(r),a=r.children.length?parseInt(n.height,10):Math.floor(parseInt(n.height.split("px")[0],10))-5;this.parent.enableAdaptiveUI&&this.infiniteRenderMod&&(i.style.height=a-s+"px",this.dlg.querySelector(".e-dlg-content").style.overflow="hidden");var l=this.isExcel&&!r.children.length&&!this.dlg.classList.contains("e-excelfilter")?"":getComputedStyle(this.dlg.querySelector(".e-dlg-content")).backgroundColor;i.style.cssText="width: "+n.width+"; min-height: "+n.minHeight+"; height: "+a+"px; margin: "+n.margin+"; border-style: "+n.borderStyle+"; border-width: "+n.borderWidth+"; border-color: "+n.borderColor+"; position: absolute; background-color: "+l+";",e=Math.floor(a/s),e=r.children.length>e?r.children.length:e,t=s+"px"}var h='<div class="e-ftrchk e-mask-ftrchk"><div class="e-checkbox-wrapper"><input class="e-chk-hidden">'+this.getShimmerTemplate()+this.getShimmerTemplate()+"</div></div>";if(i.innerHTML="",!r.children.length){this.spinner.insertAdjacentHTML("beforebegin",h),this.spinner.parentElement.querySelector(".e-ftrchk.e-mask-ftrchk").style.cssText="width: 100%; height: "+t+";",this.spinner.parentElement.querySelector(".e-checkbox-wrapper").style.width="100%";var u=[].slice.call(this.spinner.parentElement.querySelectorAll(".e-mask:not(.e-mask-checkbox-filter-intent):not(.e-mask-checkbox-filter-span-intent)"));u[0].classList.add("e-mask-checkbox-filter-intent"),u[1].classList.add("e-mask-checkbox-filter-span-intent")}this.spinner.insertBefore(i,this.cBox);for(var c=0;e&&c<e;c++){i.innerHTML+=h,i.querySelector(".e-ftrchk.e-mask-ftrchk").style.cssText="width: 100%; height: "+t+";",i.querySelector(".e-checkbox-wrapper").style.width="100%";var u=[].slice.call(i.querySelectorAll(".e-mask:not(.e-mask-checkbox-filter-intent):not(.e-mask-checkbox-filter-span-intent)"));u[0].classList.add("e-mask-checkbox-filter-intent"),u[1].classList.add("e-mask-checkbox-filter-span-intent")}this.cBox&&(i.scrollTop=this.cBox.scrollTop)},o.prototype.removeMask=function(){var e=this.dialogObj.element.querySelectorAll(".e-mask-ftrchk");if(e.length)for(var t=0;t<e.length;t++)Ue(e[t]);var i=this.dialogObj.element.querySelector(".e-checkboxlist.e-masklist");i&&Ue(this.dialogObj.element.querySelector(".e-checkboxlist.e-masklist"))},o.prototype.infiniteScrollHandler=function(){var e=this.cBox;e.scrollTop>=e.scrollHeight-e.offsetHeight&&!this.infiniteQueryExecutionPending&&this.infiniteLoadedElem.length<=this.infiniteSkipCnt+this.parent.filterSettings.itemsCount&&this.cBox.children.length===this.parent.filterSettings.itemsCount*3&&(!this.infiniteDataCount||this.infiniteDataCount>this.infiniteSkipCnt+this.parent.filterSettings.itemsCount)?(this.makeInfiniteScrollRequest(),this.prevInfiniteScrollDirection="down"):e.scrollTop>=e.scrollHeight-e.offsetHeight&&!this.infiniteQueryExecutionPending&&this.infiniteLoadedElem.length>this.infiniteSkipCnt+this.parent.filterSettings.itemsCount&&this.cBox.children.length===this.parent.filterSettings.itemsCount*3?(Mm([].slice.call(this.cBox.children).splice(0,this.parent.filterSettings.itemsCount)),this.infiniteSkipCnt+=this.prevInfiniteScrollDirection==="down"?this.parent.filterSettings.itemsCount:this.parent.filterSettings.itemsCount*3,Tc(this.cBox,this.infiniteLoadedElem.slice(this.infiniteSkipCnt,this.parent.filterSettings.itemsCount+this.infiniteSkipCnt)),this.prevInfiniteScrollDirection="down"):e.scrollTop===0&&!this.infiniteInitialLoad&&!this.infiniteSearchValChange&&this.infiniteSkipCnt&&this.infiniteLoadedElem.length&&this.infiniteLoadedElem.length>this.parent.filterSettings.itemsCount*3&&this.cBox.children.length===this.parent.filterSettings.itemsCount*3?(Mm([].slice.call(this.cBox.children).splice(this.parent.filterSettings.itemsCount*2,this.parent.filterSettings.itemsCount)),this.infiniteSkipCnt-=this.prevInfiniteScrollDirection==="up"?this.parent.filterSettings.itemsCount:this.parent.filterSettings.itemsCount*3,tN([].slice.call(this.infiniteLoadedElem.slice(this.infiniteSkipCnt,this.infiniteSkipCnt+this.parent.filterSettings.itemsCount)),this.cBox),this.cBox.scrollTop=this.infiniteScrollAppendDiff,this.prevInfiniteScrollDirection="up"):e.scrollTop===0&&!this.infiniteInitialLoad&&!this.infiniteSearchValChange&&this.infiniteSkipCnt&&this.infiniteLoadedElem.length&&this.cBox.children.length<this.parent.filterSettings.itemsCount*3&&(Mm([].slice.call(this.cBox.children).splice(this.parent.filterSettings.itemsCount*2,this.infiniteDataCount%this.parent.filterSettings.itemsCount)),this.infiniteSkipCnt=(Math.floor(this.infiniteDataCount/this.parent.filterSettings.itemsCount)-3)*this.parent.filterSettings.itemsCount,tN([].slice.call(this.infiniteLoadedElem.slice(this.infiniteSkipCnt,this.infiniteSkipCnt+this.parent.filterSettings.itemsCount)),this.cBox),this.cBox.scrollTop=this.infiniteScrollAppendDiff,this.prevInfiniteScrollDirection="up")},o.prototype.makeInfiniteScrollRequest=function(e){var t=this;!this.infiniteInitialLoad&&this.parent.filterSettings&&this.parent.filterSettings.loadingIndicator==="Shimmer"?setTimeout(function(){t.infiniteQueryExecutionPending&&t.showMask()},500):this.infiniteInitialLoad||(Os({target:this.spinner,cssClass:this.parent.cssClass?this.parent.cssClass:null},this.parent.createElement),rs(this.spinner));var i="fn";if(this.infiniteQuery&&this.infiniteQuery.queries&&this.infiniteQuery.queries.length)for(var r=0;r<this.infiniteQuery.queries.length;r++)(this.infiniteQuery.queries[r][""+i]==="onTake"||this.infiniteQuery.queries[r][""+i]==="onSkip")&&(this.infiniteQuery.queries.splice(r,1),r--);var n=!!e;if(e=e||this.infiniteQuery,this.infiniteInitialLoad||this.infiniteSearchValChange?this.infiniteSkipCnt=0:this.infiniteSkipCnt+=this.parent.filterSettings.itemsCount,e.skip(this.infiniteSkipCnt),this.infiniteInitialLoad||this.infiniteSearchValChange?(e.take(this.parent.filterSettings.itemsCount*3),this.infiniteSkipCnt+=this.parent.filterSettings.itemsCount*2):e.take(this.parent.filterSettings.itemsCount),!n)if(this.parent.dataSource&&"result"in this.parent.dataSource){var s={requestType:jw,query:e,filterChoiceCount:null,filterModel:this};this.infiniteRenderMod&&this.parent.filterSettings.itemsCount&&(s.filterChoiceCount=this.parent.filterSettings.itemsCount),this.filterEvent(s,e)}else this.processDataOperation(e),this.infiniteQueryExecutionPending=!0},o.prototype.processDataOperation=function(e,t){var i=this;this.options.dataSource=this.options.dataSource instanceof re?this.options.dataSource:new re(this.options.dataSource);var r=[],n=[];if(this.isForeignColumn(this.options.column)&&t){var s="result"in this.options.column.dataSource?new re(this.options.column.dataSource.result):this.options.column.dataSource;this.foreignKeyQuery.params=e.params,r.push(s.executeQuery(this.foreignKeyQuery)),n.push(function(l){return i.foreignKeyData=l})}if(this.addInfiniteScrollEvent(e),this.infiniteRenderMod&&this.infiniteInitialLoad&&!this.options.isRemote){var a=this.isForeignColumn(this.options.column)?this.options.foreignKeyValue:this.options.column.field;this.options.dataSource.executeQuery(new Pe().sortBy(a,de.fnAscending)).then(function(l){i.options.dataSource.dataSource.json=l.result,i.executeQueryOperations(e,r,n)})}else this.executeQueryOperations(e,r,n)},o.prototype.executeQueryOperations=function(e,t,i){var r=this;t.push(this.options.dataSource.executeQuery(e)),i.push(this.dataSuccess.bind(this));var n=0;Promise.all(t).then(function(s){r.infiniteQueryExecutionPending=r.infiniteRenderMod?!1:r.infiniteQueryExecutionPending;for(var a=0;a<s.length;a++)r.infiniteDataCount=r.infiniteRenderMod&&!r.infiniteDataCount?s[a].count:r.infiniteDataCount,i[n++](s[parseInt(a.toString(),10)].result)}).catch(function(){r.infiniteRenderMod&&r.parent.filterSettings&&r.parent.filterSettings.loadingIndicator==="Shimmer"&&r.parent.showMaskRow(void 0,r.dialogObj.element)})},o.prototype.dataSuccess=function(e){if(!(!this.infiniteInitialLoad&&this.infiniteDataCount&&(this.infiniteSkipCnt>=this.infiniteDataCount&&!this.infiniteSearchValChange||e.length===0))){this.fullData=e;var t={dataSource:this.fullData,executeQuery:!0,field:this.options.field};if(this.parent.notify(U_,t),t.executeQuery){var i=new Pe;this.customQuery||(this.isExecuteLocal=!0,this.queryGenerate(i),this.isExecuteLocal=!1);var r=new re(t.dataSource).executeLocal(i),n=this.options.column;this.filteredData=o.getDistinct(r,this.options.field,n,this.foreignKeyData,this).records||[]}var s=t.executeQuery?this.filteredData:t.dataSource;this.processDataSource(null,!0,s,t),this.sInput&&(this.infiniteRenderMod&&this.infiniteInitialLoad||!this.infiniteRenderMod)&&this.sInput.focus(),(this.infiniteInitialLoad||this.infiniteSearchValChange)&&(this.infiniteInitialLoad=!1,this.infiniteSearchValChange=!1);var a={requestType:B_,columnName:this.options.field,columnType:this.options.type},l="filterModel";a[""+l]=this,this.parent.notify(Wk,a),this.isCheckboxFilterTemplate&&Rs(this.spinner)}},o.prototype.queryGenerate=function(e){if(this.parent.searchSettings&&this.parent.searchSettings.key.length){var t=this.options.dataManager.adaptor.getModuleName;if(!g(this.parent.getDataModule)&&t&&t()==="ODataV4Adaptor")this.parent.getDataModule().searchQuery(e);else{var i=this.parent.searchSettings,r=i.fields.length?i.fields:this.options.columns.map(function(h){return h.field});e.search(i.key,r,i.operator,i.ignoreCase,i.ignoreAccent)}}if(this.options.filteredColumns.length){for(var n=[],s=0;s<this.options.filteredColumns.length;s++){var a=this.options.filteredColumns[parseInt(s.toString(),10)];this.options.uid?(a.uid=a.uid||this.parent.getColumnByField(a.field).uid,a.uid!==this.options.uid&&n.push(this.options.filteredColumns[parseInt(s.toString(),10)])):a.field!==this.options.field&&n.push(this.options.filteredColumns[parseInt(s.toString(),10)])}var l=this.getPredicateFromCols(n,this.isExecuteLocal);l&&e.where(l)}},o.prototype.processDataSource=function(e,t,i,r){rs(this.spinner),this.isExecuteLocal=!0,this.updateResult(),this.isExecuteLocal=!1;var n={dataSource:this.fullData,isCheckboxFilterTemplate:!1,column:this.options.column,element:this.cBox,type:this.options.type,format:this.options.type,btnObj:this.options.isResponsiveFilter?null:this.dialogObj.btnObj[0],searchBox:this.searchBox};this.parent.notify(Q_,n),this.isCheckboxFilterTemplate=n.isCheckboxFilterTemplate,this.isCheckboxFilterTemplate?this.infiniteRenderMod&&this.parent.filterSettings&&this.parent.filterSettings.loadingIndicator==="Shimmer"&&this.removeMask():this.createFilterItems(i,t,r)},o.prototype.processSearch=function(e){this.processDataOperation(e)},o.prototype.updateResult=function(){this.result={};var e=this.infiniteRenderMod&&this.existingPredicate[this.options.field]?this.getPredicateFromCols(this.existingPredicate[this.options.field],this.isExecuteLocal):this.getPredicateFromCols(this.options.filteredColumns,this.isExecuteLocal),t=new Pe;e&&t.where(e),this.parent.notify(G_,{query:t});for(var i=new re(this.fullData).executeLocal(t),r=0,n=i;r<n.length;r++){var s=n[r];this.result[Xk(this.options.field,s)]=!0}},o.prototype.clickHandler=function(e){var t;g(Jp.timer)||clearTimeout(Jp.timer);var i=e.target;if(!(!g(this.parent.loadingIndicator)&&this.parent.loadingIndicator.indicatorType==="Shimmer"&&xr(i,"e-mask-ftrchk"))){var r=xr(i,"e-checkbox-wrapper");if(xr(i,"e-searchbox")&&this.searchBoxClick(e),r&&!this.isCheckboxFilterTemplate){var n=r.querySelector(".e-selectall");if(n)this.updateAllCBoxes(!n.classList.contains("e-check"));else if(Vh(r.parentElement),this.infiniteRenderMod&&!r.parentElement.querySelector(".e-add-current")){this.localInfiniteSelectionInteracted=!0;var s=this.options.allowCaseSensitive,a=r.parentElement.querySelector(".e-frame"),l=a.previousSibling,h=l.checked?"equal":"notequal",u=l.checked?"or":"and",c={field:this.options.field,predicate:u,uid:this.options.uid,operator:h,type:this.options.type,matchCase:s,ignoreAccent:this.options.ignoreAccent},d=this.values[xr(l,"e-ftrchk").getAttribute("uid")];if(this.updateInfiniteManualSelectPred(c,d),this.infiniteRenderMod&&!this.options.isRemote&&this.options.parentTotalDataCount&&this.infiniteUnloadParentExistPred.length){var p=this.getPredicateFromCols((t=this.options.filteredColumns).concat.apply(t,this.infiniteManualSelectMaintainPred),!0),f=new Pe;p&&f.where(p);var v=new re(this.infinitePermenantLocalData).executeLocal(f);this.options.parentTotalDataCount!==v.length&&(this.options.parentTotalDataCount=v.length),!this.options.parentTotalDataCount&&this.infiniteUnloadParentExistPred.length&&(this.infiniteUnloadParentExistPred=[])}this.infiniteUnloadParentExistPred.length&&(this.options.parentTotalDataCount===this.infiniteDataCount||!this.options.parentTotalDataCount)&&(this.infiniteUnloadParentExistPred=[])}this.updateIndeterminatenBtn(),r.querySelector(".e-chk-hidden").focus()}this.setFocus(xr(r,"e-ftrchk"))}},o.prototype.updateInfiniteManualSelectPred=function(e,t){for(var i=0;i<this.infiniteManualSelectMaintainPred.length;i++){var r=this.infiniteManualSelectMaintainPred[i];if(r.value+""==t+""&&(r.operator==="equal"||r.operator==="notequal")){this.infiniteManualSelectMaintainPred.splice(i,1);break}}(e.predicate==="or"&&(!this.localInfiniteSelectAllClicked||!this.infiniteLocalSelectAll)||e.predicate==="and"&&(!this.localInfiniteSelectAllClicked||this.infiniteLocalSelectAll))&&(this.infiniteManualSelectMaintainPred.push(he({},{value:t},e)),e.predicate==="or"?this.options.parentTotalDataCount++:this.options.parentTotalDataCount--)},o.prototype.focusNextOrPrev=function(e,t){var i=e.key==="ArrowUp"?t.indexOf(document.activeElement)-1:t.indexOf(document.activeElement)+1,r=t[(i+t.length)%t.length];if(r){r.focus();var n=r.classList.contains("e-chk-hidden")?xr(r,"e-ftrchk"):r;this.setFocus(n)}},o.prototype.keyupHandler=function(e){if((e.key==="Tab"||(e.key==="ArrowUp"||e.key==="ArrowDown")&&!e.altKey)&&this.setFocus(xr(e.target,"e-ftrchk")),(e.key==="ArrowUp"||e.key==="ArrowDown")&&!e.altKey&&this.parent.filterSettings&&this.parent.filterSettings.type==="CheckBox"){e.preventDefault();var t=Array.from(this.dlg.querySelectorAll('input, button, [tabindex]:not([tabindex="-1"])'));this.focusNextOrPrev(e,t)}},o.prototype.setFocus=function(e){var t=this.dlg.querySelector(".e-chkfocus");t&&t.classList.remove("e-chkfocus"),e&&e!==t&&e.classList.add("e-chkfocus")},o.prototype.updateAllCBoxes=function(e){this.infiniteRenderMod&&(this.localInfiniteSelectAllClicked=!0,this.infiniteLocalSelectAll=e,this.infiniteUnloadParentExistPred=[],this.infiniteManualSelectMaintainPred=[]);for(var t=this.infiniteRenderMod?this.infiniteLoadedElem.map(function(s){return s.querySelector(".e-frame")}):[].slice.call(this.cBox.querySelectorAll(".e-frame:not(.e-add-current)")),i=0,r=t;i<r.length;i++){var n=r[i];iU(n,e),Im(n.previousSibling,e)}},o.prototype.dialogOpen=function(){this.parent.element.classList.contains("e-device")&&(this.dialogObj.element.querySelector(".e-input-group").classList.remove("e-input-focus"),this.options.isResponsiveFilter||this.dialogObj.element.querySelector(".e-btn").focus())},o.prototype.createCheckbox=function(e,t,i){var r=t?this.cBoxTrue.cloneNode(!0):this.cBoxFalse.cloneNode(!0);Im(r.querySelector("input"),t);var n=r.querySelector(".e-label"),s=nU({},i,{column:this.options.column,parent:this.parent}),a=this.options.disableHtmlEncode?"textContent":"innerHTML";n[""+a]=!g(e)&&e.toString().length?this.parent.enableHtmlSanitizer?Bt.sanitize(e):e:this.getLocalizedLabel("Blanks");var l=go("cbox");if(n.setAttribute("id",l+"cboxLabel"),r.querySelector("input").setAttribute("aria-labelledby",n.id),n.innerHTML===this.getLocalizedLabel("Blanks")&&(this.isBlanks=!0),typeof e=="boolean"&&(n.innerHTML=e===!0?this.getLocalizedLabel("FilterTrue"):this.getLocalizedLabel("FilterFalse")),Y([n],["e-checkboxfiltertext"]),this.options.template&&i[this.options.column.field]!==this.getLocalizedLabel("SelectAll")&&i[this.options.column.field]!==this.getLocalizedLabel("AddCurrentSelection")){n.innerHTML="";var h=this.parent.isReact&&this.options.column.filter&&typeof this.options.column.filter.itemTemplate!="string"&&!(this.options.column.filter.itemTemplate.prototype&&this.options.column.filter.itemTemplate.prototype.CSPTemplate),u=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact;h||u?(this.options.template(s,this.parent,"filterItemTemplate",null,null,null,n),this.parent.renderTemplates()):Tc(n,this.options.template(s,this.parent,"filterItemTemplate",null,null,null,null,this.parent.root))}return r},o.prototype.updateIndeterminatenBtn=function(){var e=this.infiniteRenderMod?this.infiniteLoadedElem.length:this.cBox.children.length-1,t=[],i=!1,r=this.infiniteRenderMod?this.sBox.querySelector(".e-selectall"):this.cBox.querySelector(".e-selectall"),n=this.infiniteRenderMod?this.infiniteLoadedElem.filter(function(l){return l.querySelector(".e-check")}).length:this.cBox.querySelectorAll(".e-check:not(.e-selectall):not(.e-add-current)").length;this.cBox.querySelector(".e-add-current")&&(e-=1);var s;this.options.isResponsiveFilter||(s=this.dialogObj.btnObj[0],s.disabled=!1);var a=r.previousSibling;Im(a,!1),a.indeterminate=!1,this.infiniteRenderMod&&this.sInput.value===""&&!this.options.parentCurrentViewDataCount&&!this.localInfiniteSelectionInteracted&&(!this.localInfiniteSelectAllClicked||!this.infiniteLocalSelectAll&&!n)&&(e!==n||e===n)?n=0:this.infiniteRenderMod&&this.infiniteLoadedElem.length<this.infiniteDataCount&&this.infiniteUnloadParentExistPred.length&&(!n||e===n)&&this.infiniteLocalSelectAll&&(n?e+=this.infiniteUnloadParentExistPred.length:n+=this.infiniteUnloadParentExistPred.length),e===n?(this.infiniteRenderMod&&(this.infiniteLocalSelectAll=!0,this.localInfiniteSelectAllClicked=!0,this.infiniteManualSelectMaintainPred=[]),t=["e-check"],Im(a,!0)):n?(t=["e-stop"],a.indeterminate=!0):(this.infiniteRenderMod&&(this.infiniteLocalSelectAll=!1,this.localInfiniteSelectAllClicked=!0,this.infiniteManualSelectMaintainPred=[]),t=["e-uncheck"],i=!0,s&&(s.disabled=!0)),s&&(this.filterState=!s.disabled,s.dataBind()),K([r],["e-check","e-stop","e-uncheck"]),Y([r],t),this.parent.notify(qk,{disabled:i})},o.prototype.createFilterItems=function(e,t,i){var r,n,s,a=this.parent.createElement("div"),l,h=!1;this.options.isResponsiveFilter||(l=this.dialogObj.btnObj[0]);var u=-1,c="ejValue";i.executeQuery||(c=i.field);for(var d=0;d<e.length;d++){var p=V(c,e[parseInt(d.toString(),10)]);(p===""||g(p))&&(u=u+1)}if(this.infiniteRenderMod||(this.itemsCnt=u!==-1?e.length-u:e.length),this.infiniteRenderMod&&this.parent.filterSettings&&this.parent.filterSettings.loadingIndicator==="Shimmer"&&this.removeMask(),e.length&&!this.renderEmpty){var f=this.getLocalizedLabel("SelectAll"),v=this.cBox.querySelector(".e-checkfltrnmdiv");v&&v.classList.remove("e-checkfltrnmdiv");var m=this.createCheckbox(f,!1,(r={},r[this.options.field]=f,r));if(this.parent.cssClass&&(this.parent.cssClass.indexOf(" ")!==-1?Y([m],this.parent.cssClass.split(" ")):Y([m],[this.parent.cssClass])),this.infiniteInitialLoad||!this.infiniteRenderMod){var y=sl(go("cbox"),m,"e-ftrchk");y.querySelector(".e-frame").classList.add("e-selectall"),this.infiniteRenderMod?(y.classList.add("e-infinitescroll"),this.parent.enableAdaptiveUI&&(this.spinner.style.height=this.spinner.offsetHeight-Dm(this.cBox)+"px"),this.sBox.insertBefore(y,this.spinner)):a.appendChild(y)}else this.sBox.querySelector(".e-ftrchk .e-selectall")&&(this.sBox.querySelector(".e-ftrchk .e-selectall").previousSibling.disabled=!1,this.sBox.querySelector(".e-ftrchk .e-selectall").parentElement.classList.remove("e-checkbox-disabled"));var S=new St("field","equal",this.options.field);this.options.foreignKeyValue&&(S=S.or("field","equal",this.options.foreignKeyValue));var b=new re(this.options.filteredColumns).executeLocal(new Pe().where(S)).length;if(this.sInput.value){var w=this.createCheckbox(this.getLocalizedLabel("AddCurrentSelection"),!1,(n={},n[this.options.field]=this.getLocalizedLabel("AddCurrentSelection"),n));if(this.parent.cssClass&&(this.parent.cssClass.indexOf(" ")!==-1?Y([w],this.parent.cssClass.split(" ")):Y([w],[this.parent.cssClass])),this.infiniteRenderMod&&!g(this.sBox.children[2])&&this.sBox.children[2].innerText!==this.getLocalizedLabel("AddCurrentSelection")||!this.infiniteRenderMod){var I=sl(go("cbox"),w,"e-ftrchk");if(I.querySelector(".e-frame").classList.add("e-add-current"),this.infiniteRenderMod){I.classList.add("e-infinitescroll"),this.sBox.insertBefore(I,this.spinner);var x=this.spinner.querySelector(".e-checkboxlist"),M=Math.ceil(I.getBoundingClientRect().height);x.style.height=parseInt(getComputedStyle(x).height.split("px")[0],10)-M+"px",x.style.minHeight=x.style.height}else a.appendChild(I)}else this.sBox.querySelector(".e-ftrchk .e-add-current")&&(this.sBox.querySelector(".e-ftrchk .e-add-current").previousSibling.disabled=!1,this.sBox.querySelector(".e-ftrchk .e-add-current").parentElement.classList.remove("e-checkbox-disabled"))}else if(this.infiniteRenderMod&&!g(this.sBox.children[2])&&this.sBox.children[2].innerText===this.getLocalizedLabel("AddCurrentSelection")){var x=this.spinner.querySelector(".e-checkboxlist"),D=Math.ceil(this.sBox.children[2].getBoundingClientRect().height);x.style.height=parseInt(getComputedStyle(x).height.split("px")[0],10)+D+"px",x.style.minHeight=x.style.height,Ue(this.sBox.children[2])}for(var A=void 0,d=0;d<e.length;d++){var L=go("cbox");this.values[""+L]=V(c,e[parseInt(d.toString(),10)]);var T=V(this.options.field,e[parseInt(d.toString(),10)]);this.options.formatFn&&(T=this.valueFormatter.toView(T,this.options.formatFn));var k={value:T,column:this.options.column,data:e[parseInt(d.toString(),10)]};if(this.parent.notify(Lm,k),T=k.value,T===""||g(T)){if(A)continue;A=!0}this.infiniteRenderMod&&this.updateInfiniteUnLoadedCheckboxExistPred(T,this.infiniteUnloadParentExistPred);var F=this.localInfiniteSelectAllClicked?this.createCheckbox(T,this.infiniteLocalSelectAll,V("dataObj",e[d])):this.createCheckbox(T,this.getCheckedState(b,this.values[""+L]),V("dataObj",e[d]));a.appendChild(sl(L,F,"e-ftrchk")),this.infiniteRenderMod&&(a.lastChild.style.height=Dm(this.cBox)+"px")}var R=this.cBox.scrollTop;!this.infiniteRenderMod||this.infiniteSearchValChange?this.cBox.innerHTML="":this.infiniteRenderMod&&this.cBox.children.length&&Mm([].slice.call(this.cBox.children).splice(0,this.parent.filterSettings.itemsCount)),this.infiniteRenderMod&&((s=this.infiniteLoadedElem).push.apply(s,[].slice.call(a.children)),this.itemsCnt=u!==-1?this.infiniteLoadedElem.length-u:this.infiniteLoadedElem.length),this.infiniteUnloadParentExistPred.length&&(this.infiniteLoadedElem.length>=this.infiniteDataCount||!this.options.parentCurrentViewDataCount||this.options.parentTotalDataCount===this.infiniteDataCount&&this.options.parentCurrentViewDataCount)&&(this.infiniteUnloadParentExistPred=[]),Tc(this.cBox,[].slice.call(a.children)),this.infiniteRenderMod&&!this.infiniteScrollAppendDiff&&(this.infiniteScrollAppendDiff=Math.round(R-this.cBox.scrollTop)),this.updateIndeterminatenBtn(),this.infiniteRenderMod?l&&l.disabled?h=!0:h=!1:(l&&(l.disabled=!1),h=!1)}else{if(a.appendChild(this.parent.createElement("span",{innerHTML:this.getLocalizedLabel("NoResult")})),this.cBox.innerHTML="",this.infiniteRenderMod){var y=this.sBox.querySelector(".e-ftrchk .e-selectall");if(y){var N=y.parentElement.parentElement;y.classList.contains("e-check")?Vh(N):y.classList.contains("e-stop")&&(Vh(N),y.classList.remove("e-stop"),Vh(N)),y.previousSibling.disabled=!0,y.parentElement.classList.add("e-checkbox-disabled")}var P=this.sBox.querySelector(".e-ftrchk .e-add-current");if(P){var O=P.parentElement.parentElement;P.classList.contains("e-check")&&Vh(O),P.previousSibling.disabled=!0,P.parentElement.classList.add("e-checkbox-disabled")}}this.cBox.appendChild(this.parent.createElement("div",{className:"e-checkfltrnmdiv"})),Tc(this.cBox.children[0],[].slice.call(a.children)),l&&(l.disabled=!0),h=!0,this.filterState=!h}l&&e.length&&(this.filterState=!l.disabled,l.dataBind());var z={requestType:jw,dataSource:this.renderEmpty?[]:e},H="filterModel";z[""+H]=this,this.parent.notify(Wk,z),this.parent.notify(qk,{disabled:h}),this.infiniteRenderMod&&this.infiniteInitialLoad&&(this.cBox.style.marginTop="0px"),Rs(this.spinner)},o.prototype.updateInfiniteUnLoadedCheckboxExistPred=function(e,t){for(var i=0;i<t.length;i++){var r=t[i],n=r.value instanceof Date?this.valueFormatter.toView(r.value,this.options.formatFn):r.value,s=this.options.column;if(s.isForeignColumn()){var a=Qk(s,{},n,this.foreignKeyData)[0];e=V(s.foreignKeyField,a)}e===n&&(r.operator==="equal"||r.operator==="notequal")&&(this.infiniteManualSelectMaintainPred.push(t[i]),t.splice(i,1),i--)}},o.prototype.getCheckedState=function(e,t){if(!this.isFiltered||!e)return!0;var i=this.sInput.value?!0:this.result[""+t];return this.infiniteRenderMod?i:this.options.operator==="notequal"?!i:i},o.getDistinct=function(e,t,i,r,n){for(var s=e.length,a=[],l,h="ejValue",u={},c=i&&i.isForeignColumn?i.isForeignColumn():!1;s--;){if(l=e[parseInt(s.toString(),10)],i&&i.type==="dateonly"&&typeof l[""+t]=="string"&&l[""+t]){var d=l[""+t].split(/[^0-9.]/);l[""+t]=new Date(parseInt(d[0],10),parseInt(d[1],10)-1,parseInt(d[2],10))}l=Xk(t,l);var p=typeof l=="string"&&!g(n)&&!g(n.parent)&&!g(n.parent.filterSettings)&&!g(n.parent.filterSettings.enableCaseSensitivity)?l.toLowerCase():l;if(!(p in u)){var f={};if(f[""+h]=l,u[""+p]=!0,c){var v=Qk(i,{},l,r)[0];Ge(V_,v,e[parseInt(s.toString(),10)]),l=V(i.foreignKeyValue,v)}Ge(t,g(l)?null:l,f),Ge("dataObj",e[parseInt(s.toString(),10)],f),a.push(f)}}return de.group(de.sort(a,t,de.fnAscending),"ejValue")},o.getPredicate=function(e,t){for(var i=de.distinct(e,"field",!0)||[],r=[],n={},s=0;s<i.length;s++)r=new re(e).executeLocal(new Pe().where("field","equal",i[parseInt(s.toString(),10)].field)),r.length!==0&&(n[i[parseInt(s.toString(),10)].field]=o.generatePredicate(r,t));return n},o.generatePredicate=function(e,t){var i=e?e.length:0,r,n="or",s=o.updateDateFilter(e[0]);s.ignoreAccent=g(s.ignoreAccent)?!1:s.ignoreAccent,s.type==="date"||s.type==="datetime"||s.type==="dateonly"?r=Lc(s,s.type,t):r=s.ejpredicate?s.ejpredicate:new St(s.field,s.operator,s.value,!o.getCaseValue(s),s.ignoreAccent);for(var a=1;a<i;a++)e[parseInt(a.toString(),10)]=o.updateDateFilter(e[parseInt(a.toString(),10)]),i>2&&a>1&&(e[a].predicate==="or"&&e[a-1].predicate==="or"||e[a].predicate==="and"&&e[a-1].predicate==="and")?e[a].type==="date"||e[a].type==="datetime"||e[a].type==="dateonly"?r.predicates.push(Lc(e[parseInt(a.toString(),10)],e[a].type,t)):r.predicates.push(new St(e[a].field,e[parseInt(a.toString(),10)].operator,e[parseInt(a.toString(),10)].value,!o.getCaseValue(e[parseInt(a.toString(),10)]),e[parseInt(a.toString(),10)].ignoreAccent)):e[a].type==="date"||e[a].type==="datetime"||e[a].type==="dateonly"?e[parseInt(a.toString(),10)].predicate==="and"&&e[parseInt(a.toString(),10)].operator==="equal"?r=r[""+n](Lc(e[parseInt(a.toString(),10)],e[parseInt(a.toString(),10)].type,t),e[parseInt(a.toString(),10)].type,e[parseInt(a.toString(),10)].ignoreAccent):r=r[e[parseInt(a.toString(),10)].predicate](Lc(e[parseInt(a.toString(),10)],e[parseInt(a.toString(),10)].type,t),e[parseInt(a.toString(),10)].type,e[parseInt(a.toString(),10)].ignoreAccent):r=e[parseInt(a.toString(),10)].ejpredicate?r[e[parseInt(a.toString(),10)].predicate](e[parseInt(a.toString(),10)].ejpredicate):r[e[parseInt(a.toString(),10)].predicate](e[parseInt(a.toString(),10)].field,e[parseInt(a.toString(),10)].operator,e[parseInt(a.toString(),10)].value,!o.getCaseValue(e[parseInt(a.toString(),10)]),e[parseInt(a.toString(),10)].ignoreAccent);return r||null},o.getCaseValue=function(e){return g(e.matchCase)?!(e.type==="string"||g(e.type)&&typeof e.value=="string"):e.matchCase},o.updateDateFilter=function(e){return(e.type==="date"||e.type==="datetime"||e.type==="dateonly"||e.value instanceof Date)&&(e.type=e.type||"date"),e},o}(),oU=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),aN=function(o){oU(e,o);function e(t,i){var r=o.call(this,t)||this;return r.childRefs=[],r.eventHandlers={},r.isDevice=!1,r.focusedMenuItem=null,r.customFilterOperators=i,r.isExcel=!0,r}return e.prototype.getCMenuDS=function(t,i){var r={number:["Equal","NotEqual","","LessThan","LessThanOrEqual","GreaterThan","GreaterThanOrEqual","Between","","CustomFilter"],string:["Equal","NotEqual","","StartsWith","EndsWith","","Contains","NotContains","","CustomFilter"]};r.date=r.number,r.datetime=r.number,r.dateonly=r.number;for(var n=[],s=0;s<r[""+t].length;s++)r[""+t][parseInt(s.toString(),10)].length?i?n.push({text:this.getLocalizedLabel(r[""+t][parseInt(s.toString(),10)])+"...",iconCss:"e-icons e-icon-check "+(i===r[""+t][parseInt(s.toString(),10)].toLowerCase()?"":"e-emptyicon")}):n.push({text:this.getLocalizedLabel(r[""+t][parseInt(s.toString(),10)])+"..."}):n.push({separator:!0});return n},e.prototype.destroy=function(){if(this.dlg&&(this.unwireExEvents(),o.prototype.closeDialog.call(this)),!this.isDevice&&this.menuObj){var t=this.menuObj.element.querySelector("li.e-focused");t&&xr(t,"e-excel-menu")||this.destroyCMenu()}this.dlgObj&&!this.dlgObj.isDestroyed&&this.removeDialog()},e.prototype.createMenu=function(t,i,r,n){var s={string:"TextFilter",date:"DateFilter",dateonly:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"};this.menu=this.parent.createElement("div",{className:"e-contextmenu-wrapper"}),this.parent.enableRtl?this.menu.classList.add("e-rtl"):this.menu.classList.remove("e-rtl"),this.parent.cssClass&&this.menu.classList.add(this.parent.cssClass);var a=this.parent.createElement("ul"),l=i?"e-excl-filter-icon e-filtered":"e-excl-filter-icon";if(this.parent.allowSorting&&this.parent.getModuleName()==="grid"&&!this.options.isResponsiveFilter){var h=this.parent.getColumnHeaderByUid(n.uid).getAttribute("aria-sort"),u=this.parent.getColumnByField(n.field).allowSorting,c=!u||h==="ascending"?"e-disabled e-excel-ascending":"e-excel-ascending",d=!u||h==="descending"?"e-disabled e-excel-descending":"e-excel-descending",p=t==="string"?this.getLocalizedLabel("SortAtoZ"):t==="datetime"||t==="date"?this.getLocalizedLabel("SortByOldest"):this.getLocalizedLabel("SortSmallestToLargest"),f=t==="string"?this.getLocalizedLabel("SortZtoA"):t==="datetime"||t==="date"?this.getLocalizedLabel("SortByNewest"):this.getLocalizedLabel("SortLargestToSmallest");a.appendChild(this.createMenuElem(p,c,"e-sortascending")),a.appendChild(this.createMenuElem(f,d,"e-sortdescending"));var v=this.parent.createElement("li",{className:"e-separator e-menu-item e-excel-separator"});a.appendChild(v)}this.options.isResponsiveFilter||a.appendChild(this.createMenuElem(this.getLocalizedLabel("ClearFilter"),i?"":"e-disabled",l)),t!=="boolean"&&a.appendChild(this.createMenuElem(this.getLocalizedLabel(s[""+t]),"e-submenu",r&&this.ensureTextFilter()?"e-icon-check":l+" e-emptyicon",!0)),this.menu.appendChild(a),this.parent.notify(Tm,{element:this.menu}),this.parent.notify(W_,{isFiltered:i})},e.prototype.createMenuElem=function(t,i,r,n){var s=this.parent.createElement("li",{className:i+" e-menu-item"});return s.innerHTML=t,s.tabIndex=s.classList.contains("e-disabled")?-1:0,s.insertBefore(this.parent.createElement("span",{className:"e-menu-icon e-icons "+r,attrs:{"aria-hidden":"true"}}),s.firstChild),n&&s.appendChild(this.parent.createElement("span",{className:"e-icons e-caret"})),s},e.prototype.wireExEvents=function(){B.isDevice||E.add(this.dlg,"mouseover",this.hoverHandler,this),E.add(this.dlg,"click",this.clickExHandler,this),E.add(this.dlg,"keyup",this.keyUp,this),E.add(this.dlg,"keydown",this.keyDown,this)},e.prototype.unwireExEvents=function(){B.isDevice||E.remove(this.dlg,"mouseover",this.hoverHandler),E.remove(this.dlg,"click",this.clickExHandler),E.remove(this.dlg,"keyup",this.keyUp),E.remove(this.dlg,"keydown",this.keyDown)},e.prototype.clickExHandler=function(t){var i={string:"TextFilter",date:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"},r=xr(t.target,"e-menu-item");r&&(this.getLocalizedLabel("ClearFilter")===r.innerText.trim()?(this.clearFilter(),this.closeDialog()):(this.options.isResponsiveFilter||B.isDevice)&&this.getLocalizedLabel(i[this.options.type])===r.innerText.trim()&&this.hoverHandler(t))},e.prototype.focusNextOrPrevElement=function(t,i,r){var n=t.key==="ArrowUp"||t.key==="Tab"&&t.shiftKey?i.indexOf(document.activeElement)-1:i.indexOf(document.activeElement)+1,s=i[(n+i.length)%i.length];if(s){s.focus();var a=s.classList.contains("e-chk-hidden")?"e-chkfocus":r,l=s.classList.contains("e-chk-hidden")?xr(s,"e-ftrchk"):xr(s,"e-menu-item");this.excelSetFocus(l,a)}},e.prototype.keyUp=function(t){if(t.key==="Tab"&&t.shiftKey||t.key==="Tab"){var i=t.target.classList.contains("e-chk-hidden")?"e-chkfocus":"e-menufocus",r=t.target.classList.contains("e-menu-item")?xr(t.target,"e-menu-item"):xr(t.target,"e-ftrchk");this.excelSetFocus(r,i)}else if((t.key==="ArrowUp"||t.key==="ArrowDown")&&!t.altKey){t.preventDefault();var n=Array.from(this.dlg.querySelectorAll('input, button, [tabindex]:not([tabindex="-1"]), .e-menu-item:not(.e-disabled):not(.e-separator)'));this.focusNextOrPrevElement(t,n,"e-menufocus")}else(t.key==="Enter"||t.code==="ArrowRight")&&t.target.classList.contains("e-menu-item")&&(t.preventDefault(),t.target.click(),t.target.classList.contains("e-submenu")&&(this.hoverHandler(t),this.menuObj.element.querySelector(".e-menu-item").focus(),this.excelSetFocus(xr(this.menuObj.element.querySelector(".e-menu-item"),"e-menu-item"),"e-focused"),this.focusedMenuItem=this.menuObj.element.querySelector(".e-menu-item")))},e.prototype.keyDown=function(t){(t.key==="ArrowUp"||t.key==="ArrowDown")&&t.preventDefault()},e.prototype.excelSetFocus=function(t,i){var r=this.cmenu.querySelector("."+i),n=this.menu.querySelector("."+i);r&&r.classList.remove(i),n&&n.classList.contains("e-menufocus")&&n.classList.remove(i),t&&t.classList.add(i)},e.prototype.destroyCMenu=function(){this.isCMenuOpen=!1,this.menuObj&&!this.menuObj.isDestroyed&&(this.menuObj.destroy(),E.remove(this.menuObj.element,"keydown",this.contextKeyDownHandler),Ue(this.cmenu),this.parent.notify(Gk,{target:null,header:"",isOpen:!1,col:this.options.column}))},e.prototype.hoverHandler=function(t){if(!(this.options.isResponsiveFilter&&t.type==="mouseover")){var i=t.target.querySelector(".e-contextmenu"),r=xr(t.target,"e-menu-item"),n=this.menu.querySelector(".e-focused"),s;if(n&&n.classList.remove("e-focused"),r&&(r.classList.add("e-focused"),s=r.classList.contains("e-submenu")),!i){if(!s){var a=this.menu.querySelector(".e-submenu");g(a)||a.classList.remove("e-selected"),this.destroyCMenu()}var l=this.ensureTextFilter();if(!this.isCMenuOpen&&s){r.classList.add("e-selected"),this.isCMenuOpen=!0;var h={items:this.getCMenuDS(this.options.type,l?l.replace(/\s/g,""):void 0),select:this.selectHandler.bind(this),onClose:this.destroyCMenu.bind(this),enableRtl:this.parent.enableRtl,animationSettings:{effect:B.isDevice?"ZoomIn":"None"},beforeClose:this.preventClose.bind(this),cssClass:this.options.isResponsiveFilter&&this.parent.cssClass?"e-res-contextmenu-wrapper "+this.parent.cssClass:this.options.isResponsiveFilter?"e-res-contextmenu-wrapper":this.parent.cssClass?this.parent.cssClass:""};this.parent.element.appendChild(this.cmenu),this.menuObj=new Kv(h,this.cmenu),E.add(this.menuObj.element,"keydown",this.contextKeyDownHandler,this);var u=this.menu.querySelector(".e-submenu").getBoundingClientRect(),c={top:0,left:0};if(this.options.isResponsiveFilter){var d={string:"TextFilter",date:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"},p=document.querySelector(".e-responsive-dialog > .e-dlg-header-content"),f=p.offsetHeight+4;this.menuObj.element.style.height="calc(100% - "+f+"px)",this.menuObj.open(f,0,document.body);var v=this.getLocalizedLabel(d[this.options.type]);this.parent.notify(Gk,{target:this.menuObj.element.parentElement,header:v,isOpen:!0})}else{if(B.isDevice){this.isDevice=!0;var m=this.getContextBounds();c.top=(window.innerHeight-m.height)/2,c.left=(window.innerWidth-m.width)/2,this.closeDialog(),this.isDevice=!1}else c.top=B.isIE?window.pageYOffset+u.top:window.scrollY+u.top,c.left=this.getCMenuYPosition(this.dlg);this.menuObj.open(c.top,c.left,t.target)}Kk(this.parent.element,this.menuObj.element.parentElement)}}}},e.prototype.contextKeyDownHandler=function(t){if(t.key==="Tab"&&t.shiftKey||t.key==="Tab"){t.preventDefault();var i=Array.from(this.menuObj.element.querySelectorAll('[tabindex]:not([tabindex="-1"]), .e-menu-item:not(.e-disabled):not(.e-separator)'));this.focusNextOrPrevElement(t,i,"e-focused")}else(t.key==="ArrowLeft"||t.key==="Escape")&&(t.preventDefault(),this.menuObj.close(),this.focusedMenuItem=null,document.querySelector(".e-submenu.e-menu-item").classList.remove("e-selected"),document.querySelector(".e-submenu.e-menu-item").focus())},e.prototype.ensureTextFilter=function(){var t,i=this.existingPredicate[this.options.field];return i&&i.length===2?i[0].operator==="greaterthanorequal"&&i[1].operator==="lessthanorequal"?t="between":t="customfilter":i&&i.length===1&&(this.optrData=this.customFilterOperators[this.options.type+"Operator"],t=i[0].operator),t},e.prototype.preventClose=function(t){if(this.options&&this.options.isResponsiveFilter&&t.event){var i=t.event.target,r=i.classList&&(i.classList.contains("e-resfilterback")||i.classList.contains("e-res-back-btn")||i.classList.contains("e-menu-item"));t.cancel=!r}else t.event instanceof MouseEvent&&t.event.target&&t.event.target.classList&&t.event.target.classList.contains("e-submenu")&&(t.cancel=!0)},e.prototype.getContextBounds=function(){return this.menuObj.element.style.display="block",this.menuObj.element.getBoundingClientRect()},e.prototype.getCMenuYPosition=function(t){var i=this.getContextBounds().width,r=t.getBoundingClientRect(),n=r.right+i-this.parent.element.clientWidth,s=t.offsetWidth-t.clientWidth;return s=s?s+1:0,n<1?r.right+1-s:r.left-i-1+s},e.prototype.openDialog=function(t){var i=this;if(this.updateModel(t),this.getAndSetChkElem(t),this.showDialog(t),!t.cancel){this.dialogObj.dataBind();var r=this.existingPredicate[t.field]&&this.existingPredicate[t.field].length||this.options.filteredColumns.filter(function(s){return i.options.field===s.field}).length;this.createMenu(t.type,r>0,r===1||r===2,t),this.dlg.insertBefore(this.menu,this.dlg.firstChild),this.dlg.classList.add("e-excelfilter"),this.parent&&!g(this.parent.getContent)&&this.parent.getContent()&&this.parent.getContent().firstElementChild.offsetHeight<this.dlg.offsetHeight&&!xr(this.parent.element,"e-gantt-dialog")&&nN(this.parent,this.dialogObj),this.parent.enableRtl&&this.dlg.classList.add("e-rtl"),this.dlg.classList.remove("e-checkboxfilter"),this.cmenu=this.parent.createElement("ul",{className:"e-excel-menu"});var n=this.dlg.querySelectorAll(".e-menu-item");n.forEach(function(s){s.scrollWidth>s.clientWidth&&s.setAttribute("title",s.textContent)}),t.column.showColumnMenu&&this.parent.notify(ef,{}),this.wireExEvents()}},e.prototype.closeDialog=function(){this.destroy()},e.prototype.selectHandler=function(t){t.item&&(this.parent.notify(km,{}),this.menuItem=t.item,this.closeDialog(),this.renderDialogue(t))},e.prototype.renderDialogue=function(t){var i=this,r=t?t.element:void 0,n=this.options.field,s=!g(n)&&nl(n),a=!g(n)&&Gl(n),l=this.parent.createElement("div",{className:"e-xlfl-maindiv",id:s?a+"-xlflmenu":n+"-xlflmenu"});if(this.dlgDiv=this.parent.createElement("div",{className:"e-xlflmenu",id:s?a+"-xlfldlg":n+"-xlfldlg"}),this.options.isResponsiveFilter){var h=document.querySelector(".e-resfilter > .e-dlg-content > .e-xl-customfilterdiv");h.appendChild(this.dlgDiv)}else this.parent.element.appendChild(this.dlgDiv);this.dlgObj=new Ah({header:this.getLocalizedLabel("CustomFilter"),isModal:!0,overlayClick:this.removeDialog.bind(this),showCloseIcon:!0,locale:this.parent.locale,closeOnEscape:!0,target:document.body,visible:!1,enableRtl:this.parent.enableRtl,open:function(){for(var c=[].slice.call(i.dlgObj.element.querySelectorAll("table.e-xlfl-table tr.e-xlfl-fields")),d=0;d<c.length;d++){var p=c[d].children[1].querySelector(".e-control"),f=c[d].querySelector(".e-dropdownlist.e-control").ej2_instances[0];f.value==="isempty"||f.value==="isnotempty"||f.value==="isnull"||f.value==="isnotnull"?p.ej2_instances[0].enabled=!1:p&&!g(p.getAttribute("disabled"))&&(p.ej2_instances[0].enabled=!0)}var v=i.dlgObj.element.querySelector("table.e-xlfl-table>tr");if(i.options.column.filterTemplate){var m=nl(i.options.column.field)?Gl(i.options.column.field):i.options.column.field,y=i.parent.isReact&&typeof i.options.column.filterTemplate!="string"&&!(i.options.column.filterTemplate.prototype&&i.options.column.filterTemplate.prototype.CSPTemplate),S=i.parent.parentDetails&&i.parent.parentDetails.parentInstObj&&i.parent.parentDetails.parentInstObj.isReact;y||S?i.parent.renderTemplates(function(){v.querySelector("#"+m+"-xlfl-frstvalue").focus()}):v.querySelector("#"+m+"-xlfl-frstvalue").focus()}},close:this.removeDialog.bind(this),created:this.createdDialog.bind(this,r,n),buttons:[{click:this.filterBtnClick.bind(this,n),buttonModel:{content:this.getLocalizedLabel("OKButton"),isPrimary:!0,cssClass:this.parent.cssClass?"e-xlfl-okbtn "+this.parent.cssClass:"e-xlfl-okbtn"}},{click:this.removeDialog.bind(this),buttonModel:{content:this.getLocalizedLabel("CancelButton"),cssClass:this.parent.cssClass?"e-xlfl-cancelbtn "+this.parent.cssClass:"e-xlfl-cancelbtn"}}],content:l,width:430,animationSettings:{effect:"None"},cssClass:this.parent.cssClass?this.parent.cssClass:""});var u="isStringTemplate";this.dlgObj[""+u]=!0,this.renderResponsiveDialog(),this.dlgDiv.setAttribute("aria-label",this.getLocalizedLabel("CustomFilterDialogARIA")),this.childRefs.unshift(this.dlgObj),this.dlgObj.appendTo(this.dlgDiv)},e.prototype.renderResponsiveDialog=function(){if(this.options.isResponsiveFilter){var t=document.querySelector(".e-row-responsive-filter");t&&t.classList.remove("e-row-responsive-filter"),this.dlgObj.buttons=[{}],this.dlgObj.header=void 0,this.dlgObj.position={X:"",Y:""},this.dlgObj.target=document.querySelector(".e-resfilter > .e-dlg-content > .e-xl-customfilterdiv"),this.dlgObj.width="100%",this.dlgObj.isModal=!1,this.dlgObj.showCloseIcon=!1}},e.prototype.removeDialog=function(){this.parent.notify(q_,{}),(this.parent.isReact||this.parent.isVue)&&this.parent.destroyTemplate!==void 0&&sN(this.parent,["filterTemplate"]),this.removeObjects(this.childRefs),Ue(this.dlgDiv),this.parent.notify(Yl,{})},e.prototype.createdDialog=function(t,i){if(this.renderCustomFilter(t,i),this.dlgObj.element.style.left="0px",!this.options.isResponsiveFilter)this.dlgObj.element.style.top="0px";else{var r=document.querySelector(".e-responsive-dialog > .e-dlg-header-content"),n=r.offsetHeight+4;this.dlgObj.element.style.top=n+"px"}!this.options.isResponsiveFilter&&B.isDevice&&window.innerWidth<440&&(this.dlgObj.element.style.width="90%"),this.parent.notify(Am,{column:i,dialog:this.dialogObj}),this.dlgObj.show(),Kk(this.parent.element,this.dlgObj.element.parentElement)},e.prototype.renderCustomFilter=function(t,i){var r=this.dlgObj.element.querySelector(".e-xlfl-maindiv"),n=this.parent.createElement("div",{innerHTML:this.getLocalizedLabel("ShowRowsWhere"),className:"e-xlfl-dlgfields"});r.appendChild(n);var s=this.parent.createElement("div",{innerHTML:this.options.displayName,className:"e-xlfl-fieldset"});r.appendChild(s),this.renderFilterUI(i,r)},e.prototype.filterBtnClick=function(t){var i=!g(t)&&nl(t),r=!g(t)&&Gl(t),n=i?r:t,s=this.dlgDiv.querySelector("#"+n+"-xlfl-frstvalue").ej2_instances[0],a=this.dlgDiv.querySelector("#"+n+"-xlfl-frstoptr").ej2_instances[0],l=this.dlgDiv.querySelector("#"+n+"-xlfl-secndvalue").ej2_instances[0],h=this.dlgDiv.querySelector("#"+n+"-xlfl-secndoptr").ej2_instances[0],u;if(this.options.type==="string"){var c=this.dlgDiv.querySelector("#"+n+"-xlflmtcase").ej2_instances[0];u=c.checked}var d=this.dlgDiv.querySelector("#"+n+"e-xlfl-frstpredicate").ej2_instances[0],p=d.checked?"and":"or";this.filterByColumn(this.options.field,a.value,s.value,p,u,this.options.ignoreAccent,h.value,l.value),this.removeDialog()},e.prototype.filterByColumn=function(t,i,r,n,s,a,l,h){var u=this.parent.getColumnByField?this.parent.getColumnByField(t):this.options.column,c=this.isForeignColumn(u)?u.foreignKeyValue:t,d=[],p,f={instance:this,handler:this.filterByColumn,arg1:t,arg2:i,arg3:r,arg4:n,arg5:s,arg6:a,arg7:l,arg8:h,cancel:!1};if(this.parent.notify(_h,f),!f.cancel){d.push({field:c,predicate:n,matchCase:s,ignoreAccent:a,operator:i,value:f.arg3,type:this.options.type}),p=new St(c,i.toLowerCase(),f.arg3,!s,a),g(l)||(d.push({field:c,predicate:n,matchCase:s,ignoreAccent:a,operator:l,value:f.arg8,type:this.options.type}),p=p[""+n](c,l.toLowerCase(),h,!s,a));var v={action:"filtering",filterCollection:d,field:this.options.field,ejpredicate:p,actualPredicate:d};this.isForeignColumn(u)?this.foreignKeyFilter(v,d,p):this.options.handler(v)}},e.prototype.renderOperatorUI=function(t,i,r,n,s){var a=this.parent.createElement("tr",{className:"e-xlfl-fields",attrs:{role:"row"}});i.appendChild(a);var l=this.parent.createElement("td",{className:"e-xlfl-optr"});a.appendChild(l);var h=this.parent.createElement("div",{className:"e-xlfl-optrdiv"}),u=!g(t)&&nl(t),c=!g(t)&&Gl(t),d=this.parent.createElement("input",{id:u?c+r:t+r});h.appendChild(d),l.appendChild(h);var p=this.options.type+"Operator",f=this.customFilterOperators[""+p];this.optrData=f;var v=this.dropSelectedVal(this.options.column,n,s),m="";this.menuItem&&(m=this.menuItem.text.slice(0,-3),m!==this.getLocalizedLabel("CustomFilter")&&(v=s?m:void 0),m===this.getLocalizedLabel("Between")&&(v=this.getLocalizedLabel(s?"GreaterThanOrEqual":"LessThanOrEqual")));var y=this.options.column,S=new Ps(Zp({dataSource:f,fields:{text:"text",value:"value"},text:v,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass?this.parent.cssClass:null},y.filter.params));this.childRefs.unshift(S);var b={open:this.dropDownOpen.bind(this),change:this.dropDownValueChange.bind(this)};Jk(d.id,[Cm,wm],b,this),S.addEventListener(Cm,this.eventHandlers[d.id][Cm]),S.addEventListener(wm,this.eventHandlers[d.id][wm]),S.appendTo(d);var w=this.getSelectedValue(v);return{fieldElement:a,operator:w}},e.prototype.removeHandlersFromComponent=function(t){t.element.classList.contains("e-dropdownlist")?eN(t,[Cm,wm],this):t.element.classList.contains("e-autocomplete")&&eN(t,[Sm,xm],this)},e.prototype.dropDownOpen=function(t){t.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()},e.prototype.dropDownValueChange=function(t){t.element.id.includes("-xlfl-frstoptr")?this.firstOperator=t.value.toString():this.secondOperator=t.value.toString();var i=t.element.closest(".e-xlfl-fields").children[1].querySelector(".e-control"),r=t.element.ej2_instances[0];r.value==="isempty"||r.value==="isnotempty"||r.value==="isnull"||r.value==="isnotnull"?i.ej2_instances[0].enabled=!1:g(i.getAttribute("disabled"))||(i.ej2_instances[0].enabled=!0)},e.prototype.getFilterUIInfo=function(){return{firstOperator:this.firstOperator,secondOperator:this.secondOperator,field:this.options.field}},e.prototype.getSelectedValue=function(t){var i=new re(this.optrData).executeLocal(new Pe().where("text","equal",t));return g(i[0])?"":i[0].value},e.prototype.dropSelectedVal=function(t,i,r){var n;return i&&i.length>0?n=i.length===2?r?i[0].operator:i[1].operator:r?i[0].operator:void 0:r&&t.type==="string"&&!t.filter.operator?n="startswith":n=r?t.filter.operator||"equal":void 0,this.getSelectedText(n)},e.prototype.getSelectedText=function(t){var i=new re(this.optrData).executeLocal(new Pe().where("value","equal",t));return g(i[0])?"":i[0].text},e.prototype.renderFilterUI=function(t,i){var r=this.existingPredicate[""+t],n=this.parent.createElement("table",{className:"e-xlfl-table",attrs:{role:"grid"}});i.appendChild(n);var s=this.parent.createElement(K_);s.innerHTML='<col style="width: 50%"></col><col style="width: 50%"></col>',n.appendChild(s);var a=this.renderOperatorUI(t,n,"-xlfl-frstoptr",r,!0);this.firstOperator=a.operator,this.renderFlValueUI(t,a,"-xlfl-frstvalue",r,!0);var l=this.parent.createElement("tr",{className:"e-xlfl-predicate",attrs:{role:"row"}});n.appendChild(l),this.renderRadioButton(t,l,r),a=this.renderOperatorUI(t,n,"-xlfl-secndoptr",r,!1),this.secondOperator=a.operator,this.renderFlValueUI(t,a,"-xlfl-secndvalue",r,!1)},e.prototype.renderRadioButton=function(t,i,r){var n=this.parent.createElement("td",{className:"e-xlfl-radio",attrs:{colSpan:"2"}});i.appendChild(n);var s=this.parent.createElement("div",{className:"e-xlfl-radiodiv"});s.style.display="inline-block";var a=!g(t)&&nl(t),l=!g(t)&&Gl(t),h=this.parent.createElement("input",{id:a?l+"e-xlfl-frstpredicate":t+"e-xlfl-frstpredicate",attrs:{type:"radio"}}),u=this.parent.createElement("input",{id:a?l+"e-xlfl-secndpredicate":t+"e-xlfl-secndpredicate",attrs:{type:"radio"}});s.appendChild(h),s.appendChild(u),n.appendChild(s),this.options.type==="string"&&this.renderMatchCase(t,i,n,"-xlflmtcase",r);var c=new sc({label:this.getLocalizedLabel("AND"),name:"default",checked:!0,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass?this.parent.cssClass:""});this.childRefs.unshift(c);var d=new sc({label:this.getLocalizedLabel("OR"),name:"default",enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass?this.parent.cssClass:""});this.childRefs.unshift(d);var p=r&&r.length===2?r[1].predicate:"and";p==="and"?(c.checked=!0,d.checked=!1):(d.checked=!0,c.checked=!1),c.appendTo(h),d.appendTo(u),c.element.nextElementSibling.classList.add("e-xlfl-radio-and"),d.element.nextElementSibling.classList.add("e-xlfl-radio-or")},e.prototype.removeObjects=function(t){for(var i=0,r=t;i<r.length;i++){var n=r[i];n&&!n.isDestroyed&&(this.removeHandlersFromComponent(n),n.destroy())}},e.prototype.renderFlValueUI=function(t,i,r,n,s){var a=this.parent.createElement("td",{className:"e-xlfl-value"});i.fieldElement.appendChild(a);var l=!g(t)&&nl(t),h=!g(t)&&Gl(t),u=this.parent.createElement("div",{className:"e-xlfl-valuediv"}),c=this.options.filteredColumns.some(function(M){return t===M.field}),d=this.options.filteredColumns.filter(function(M){return M.field===t});if(this.options.column.filterTemplate){var p={},f=this.options.column;c&&r&&(p=this.getExcelFilterData(r,p,f,n,d));var v=this.parent.isReact&&typeof this.options.column.filterTemplate!="string"&&!(this.options.column.filterTemplate.prototype&&this.options.column.filterTemplate.prototype.CSPTemplate),m=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,y=this.parent.element.id+f.uid+"filterTemplate";if(v||m)this.options.column.getFilterTemplate()(p,this.parent,"filterTemplate",y,null,null,u);else{var S=this.options.column.getFilterTemplate()(p,this.parent,"filterTemplate",y,null,null,null,this.parent.root);Tc(u,S)}v||m?this.parent.renderTemplates(function(){u.querySelector("input").id=l?h+r:t+r,a.appendChild(u)}):((this.parent.isAngular?u.children[0]:u.querySelector("input")).id=l?h+r:t+r,a.appendChild(u))}else{var b=this.parent.createElement("input",{id:l?h+r:t+r});u.appendChild(b),a.appendChild(u);var w=void 0,I=void 0;n&&n.length>0&&(I=n.length===2?s?n[0]:n[1]:s?n[0]:void 0,w=I&&I.operator===i.operator?I.value:void 0,g(w)&&(w=void 0));var x={string:this.renderAutoComplete.bind(this),number:this.renderNumericTextBox.bind(this),date:this.renderDate.bind(this),dateonly:this.renderDate.bind(this),datetime:this.renderDateTime.bind(this)};x[this.options.type](this.options,t,b,w,this.parent.enableRtl)}},e.prototype.getExcelFilterData=function(t,i,r,n,s){var a=t==="-xlfl-frstvalue"?0:1;if(t==="-xlfl-frstvalue"||s.length>1){i={column:n instanceof Array?n[parseInt(a.toString(),10)]:n};var l=this.options.column.columnData&&s.length>1?this.options.column.columnData.length===1?0:1:a;i[this.options.field]=r.foreignKeyValue?this.options.column.columnData[parseInt(l.toString(),10)][r.foreignKeyValue]:s[parseInt(l.toString(),10)].value,this.options.foreignKeyValue&&(i[this.options.foreignKeyValue]=this.options.column.columnData[parseInt(l.toString(),10)][r.foreignKeyValue])}return i},e.prototype.renderMatchCase=function(t,i,r,n,s){var a=this.parent.createElement("div",{className:"e-xlfl-matchcasediv"});a.style.display="inline-block";var l=!g(t)&&nl(t),h=!g(t)&&Gl(t),u=this.parent.createElement("input",{id:l?h+n:t+n,attrs:{type:"checkbox"}});a.appendChild(u),r.appendChild(a);var c=s&&s.length>0?s&&s.length===2?s[1].matchCase:s[0].matchCase:!1,d=new ea({label:this.getLocalizedLabel("MatchCase"),enableRtl:this.parent.enableRtl,checked:c,cssClass:this.parent.cssClass?this.parent.cssClass:""});this.childRefs.unshift(d),d.appendTo(u)},e.prototype.renderDate=function(t,i,r,n,s){var a=$k(t.format,t.type)||t.format,l=new zw(Zp({format:a,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:s,value:new Date(n),locale:this.parent.locale},t.column.filter.params));this.childRefs.unshift(l),l.appendTo(r)},e.prototype.renderDateTime=function(t,i,r,n,s){var a=$k(t.format,t.type),l=new Hk(Zp({format:a,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:s,value:new Date(n),locale:this.parent.locale},t.column.filter.params));this.childRefs.unshift(l),l.appendTo(r)},e.prototype.completeAction=function(t){t.result=eU(t.result)},e.prototype.renderNumericTextBox=function(t,i,r,n,s){var a=new ia(Zp({format:t.format,placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:s,value:n,locale:this.parent.locale,cssClass:this.parent.cssClass?this.parent.cssClass:null},t.column.filter.params));this.childRefs.unshift(a),a.appendTo(r)},e.prototype.renderAutoComplete=function(t,i,r,n,s){var a=this.options.column,l=this.isForeignColumn(a),h=l?a.dataSource:t.dataSource,u={value:l?a.foreignKeyValue:i},c=new cm(Zp({dataSource:h instanceof re?h:new re(h),fields:u,query:this.getQuery(),sortOrder:"Ascending",locale:this.parent.locale,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",autofill:!0,placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:s,text:n},a.filter.params));if(h&&"result"in h){var d=rN({requestType:"stringfilterrequest"},this.getQuery());this.parent.trigger(iN,d.state);var p=d.deffered;p.promise.then(function(v){c.dataSource=new re(v)})}this.childRefs.unshift(c);var f={actionComplete:this.acActionComplete(c,i),focus:this.acFocus(c,i,t,r)};Jk(r.id,[Sm,xm],f,this),c.addEventListener(xm,this.eventHandlers[r.id][xm]),c.addEventListener(Sm,this.eventHandlers[r.id][Sm]),c.appendTo(r)},e.prototype.acActionComplete=function(t,i){return function(r){var n=!g(i)&&nl(i);r.result=r.result.filter(function(s,a,l){return l.map(function(h){return n?Zk(t.fields.value,h):h[t.fields.value]}).indexOf(n?Zk(t.fields.value,s):s[t.fields.value])===a})}},e.prototype.acFocus=function(t,i,r,n){var s=this;return function(){var a=!g(i)&&nl(i),l=!g(i)&&Gl(i),h=a?l:i;t.filterType=s.dlgDiv.querySelector("#"+h+(n.id===h+"-xlfl-frstvalue"?"-xlfl-frstoptr":"-xlfl-secndoptr")).ej2_instances[0].value,t.ignoreCase=r.type==="string"?!s.dlgDiv.querySelector("#"+h+"-xlflmtcase").ej2_instances[0].checked:!0,t.filterType=g(t.filterType)?"equal":t.filterType}},e}(Nm);dm.Inject(pm);dm.Inject(pm);dm.Inject(pm);var UQ={header:"."+X_,content:"."+$_,edit:".e-inline-edit",batchEdit:".e-editedbatchcell",editIcon:"e-edit",pager:".e-gridpager",delete:"e-delete",save:"e-save",cancel:"e-cancel",copy:"e-copy",pdf:"e-pdfexport",group:"e-icon-group",ungroup:"e-icon-ungroup",csv:"e-csvexport",excel:"e-excelexport",fPage:"e-icon-first",nPage:"e-icon-next",lPage:"e-icon-last",pPage:"e-icon-prev",ascending:"e-icon-ascending",descending:"e-icon-descending",groupHeader:"e-groupdroparea",touchPop:"e-gridpopup",autofit:"e-icon-autofit",autofitall:"e-icon-autofitall"};var Ql=function(){function o(e){this.svgLink="http://www.w3.org/2000/svg",this.rootId=e}return o.prototype.getOptionValue=function(e,t){return e[t]},o.prototype.createSvg=function(e){return g(e.id)&&(e.id=this.rootId+"_svg"),this.svgObj=document.getElementById(e.id),g(document.getElementById(e.id))&&(this.svgObj=document.createElementNS(this.svgLink,"svg")),this.svgObj=this.setElementAttributes(e,this.svgObj),this.setSVGSize(e.width,e.height),this.svgObj},o.prototype.setSVGSize=function(e,t){var i=document.getElementById(this.rootId),r=g(i)?null:i.getBoundingClientRect();g(this.width)||this.width<=0?this.svgObj.setAttribute("width",e?e.toString():r.width.toString()):this.svgObj.setAttribute("width",this.width.toString()),g(this.height)||this.height<=0?this.svgObj.setAttribute("height",t?t.toString():"450"):this.svgObj.setAttribute("height",this.height.toString())},o.prototype.drawPath=function(e){var t=document.getElementById(e.id);return t===null&&(t=document.createElementNS(this.svgLink,"path")),t=this.setElementAttributes(e,t),t},o.prototype.drawLine=function(e){var t=document.getElementById(e.id);return t===null&&(t=document.createElementNS(this.svgLink,"line")),t=this.setElementAttributes(e,t),t},o.prototype.drawRectangle=function(e){var t=document.getElementById(e.id);return t===null&&(t=document.createElementNS(this.svgLink,"rect")),t=this.setElementAttributes(e,t),t},o.prototype.drawCircle=function(e){var t=document.getElementById(e.id);return t===null&&(t=document.createElementNS(this.svgLink,"circle")),t=this.setElementAttributes(e,t),t},o.prototype.drawPolyline=function(e){var t=document.getElementById(e.id);return t===null&&(t=document.createElementNS(this.svgLink,"polyline")),t=this.setElementAttributes(e,t),t},o.prototype.drawEllipse=function(e){var t=document.getElementById(e.id);return t===null&&(t=document.createElementNS(this.svgLink,"ellipse")),t=this.setElementAttributes(e,t),t},o.prototype.drawPolygon=function(e){var t=document.getElementById(e.id);return t===null&&(t=document.createElementNS(this.svgLink,"polygon")),t=this.setElementAttributes(e,t),t},o.prototype.drawImage=function(e){var t=document.createElementNS(this.svgLink,"image");return t.setAttributeNS(null,"height",e.height.toString()),t.setAttributeNS(null,"width",e.width.toString()),t.setAttributeNS("http://www.w3.org/1999/xlink","href",e.href),t.setAttributeNS(null,"x",e.x.toString()),t.setAttributeNS(null,"y",e.y.toString()),t.setAttributeNS(null,"id",e.id),t.setAttributeNS(null,"visibility",e.visibility),g(this.getOptionValue(e,"clip-path"))||t.setAttributeNS(null,"clip-path",this.getOptionValue(e,"clip-path")),g(e.preserveAspectRatio)||t.setAttributeNS(null,"preserveAspectRatio",e.preserveAspectRatio),t},o.prototype.createText=function(e,t){var i=document.createElementNS(this.svgLink,"text");return i=this.setElementAttributes(e,i),g(t)||(i.textContent=t),i},o.prototype.createTSpan=function(e,t){var i=document.createElementNS(this.svgLink,"tspan");return i=this.setElementAttributes(e,i),g(t)||(i.textContent=t),i},o.prototype.createTitle=function(e){var t=document.createElementNS(this.svgLink,"title");return t.textContent=e,t},o.prototype.createDefs=function(){var e=document.createElementNS(this.svgLink,"defs");return e},o.prototype.createClipPath=function(e){var t=document.createElementNS(this.svgLink,"clipPath");return t=this.setElementAttributes(e,t),t},o.prototype.createForeignObject=function(e){var t=document.createElementNS(this.svgLink,"foreignObject");return t=this.setElementAttributes(e,t),t},o.prototype.createGroup=function(e){var t=document.createElementNS(this.svgLink,"g");return t=this.setElementAttributes(e,t),t},o.prototype.createPattern=function(e,t){var i=document.createElementNS(this.svgLink,t);return i=this.setElementAttributes(e,i),i},o.prototype.createRadialGradient=function(e,t,i){var r;if(g(e[0].colorStop))r=e[0].color.toString();else{var n={id:this.rootId+"_"+t+"radialGradient",cx:i.cx+"%",cy:i.cy+"%",r:i.r+"%",fx:i.fx+"%",fy:i.fy+"%"};this.drawGradient("radialGradient",n,e),r="url(#"+this.rootId+"_"+t+"radialGradient)"}return r},o.prototype.createLinearGradient=function(e,t,i){var r;if(g(e[0].colorStop))r=e[0].color.toString();else{var n={id:this.rootId+"_"+t+"linearGradient",x1:i.x1+"%",y1:i.y1+"%",x2:i.x2+"%",y2:i.y2+"%"};this.drawGradient("linearGradient",n,e),r="url(#"+this.rootId+"_"+t+"linearGradient)"}return r},o.prototype.drawGradient=function(e,t,i){var r=this.createDefs(),n=document.createElementNS(this.svgLink,e);n=this.setElementAttributes(t,n);for(var s=0;s<i.length;s++){var a=document.createElementNS(this.svgLink,"stop");a.setAttribute("offset",i[s].colorStop),a.setAttribute("stop-color",i[s].color),a.setAttribute("stop-opacity",i[s].opacity?i[s].opacity:"1"),g(i[s].style)||(a.style.cssText=i[s].style),n.appendChild(a)}return r.appendChild(n),r},o.prototype.drawClipPath=function(e){var t=this.createDefs(),i=this.createClipPath({id:e.id});e.id=e.id+"_Rect";var r=this.drawRectangle(e);return i.appendChild(r),t.appendChild(i),t},o.prototype.drawCircularClipPath=function(e){var t=this.createDefs(),i=this.createClipPath({id:e.id});e.id=e.id+"_Circle";var r=this.drawCircle(e);return i.appendChild(r),t.appendChild(i),t},o.prototype.setElementAttributes=function(e,t){for(var i=Object.keys(e),r=0;r<i.length;r++)i[r]==="style"?t.style.cssText=e[i[r]]:t.setAttribute(i[r],e[i[r]]);return t},o.prototype.createCanvas=function(){return null},o}(),Vw=function(){function o(e){this.rootId=e}return o.prototype.getOptionValue=function(e,t){return e[t]},o.prototype.createCanvas=function(e){var t=document.createElement("canvas");return t.setAttribute("id",this.rootId+"_canvas"),this.ctx=t.getContext("2d"),this.canvasObj=t,this.setCanvasSize(e.width,e.height),this.canvasObj},o.prototype.setCanvasSize=function(e,t){var i=document.getElementById(this.rootId),r=g(i)?null:i.getBoundingClientRect();g(this.width)?this.canvasObj.setAttribute("width",e?e.toString():r.width.toString()):this.canvasObj.setAttribute("width",this.width.toString()),g(this.height)?this.canvasObj.setAttribute("height",t?t.toString():"450"):this.canvasObj.setAttribute("height",this.height.toString())},o.prototype.setAttributes=function(e){this.ctx.lineWidth=this.getOptionValue(e,"stroke-width");var t=this.getOptionValue(e,"stroke-dasharray");if(!g(t)){var i=t.split(",");this.ctx.setLineDash([parseInt(i[0],10),parseInt(i[1],10)])}this.ctx.strokeStyle=this.getOptionValue(e,"stroke")},o.prototype.drawLine=function(e){this.ctx.save(),this.ctx.beginPath(),this.ctx.lineWidth=this.getOptionValue(e,"stroke-width"),this.ctx.strokeStyle=e.stroke,this.ctx.moveTo(e.x1,e.y1),this.ctx.lineTo(e.x2,e.y2),this.ctx.stroke(),this.ctx.restore()},o.prototype.drawRectangle=function(e,t){var i=this.ctx,r=e.rx;return this.ctx.save(),this.ctx.beginPath(),t&&this.ctx.translate(t[0],t[1]),this.ctx.globalAlpha=this.getOptionValue(e,"opacity"),this.setAttributes(e),this.ctx.rect(e.x,e.y,e.width,e.height),r!==null&&r>=0?this.drawCornerRadius(e):(e.fill==="none"&&(e.fill="transparent"),this.ctx.fillStyle=e.fill,this.ctx.fillRect(e.x,e.y,e.width,e.height),this.ctx.stroke()),this.ctx.restore(),this.ctx=i,this.canvasObj},o.prototype.drawCornerRadius=function(e){var t=e.rx,i=e.x,r=e.y,n=e.width,s=e.height;e.fill==="none"&&(e.fill="transparent"),this.ctx.fillStyle=e.fill,n<2*t&&(t=n/2),s<2*t&&(t=s/2),this.ctx.beginPath(),this.ctx.moveTo(i+n-t,r),this.ctx.arcTo(i+n,r,i+n,r+s,t),this.ctx.arcTo(i+n,r+s,i,r+s,t),this.ctx.arcTo(i,r+s,i,r,t),this.ctx.arcTo(i,r,i+n,r,t),this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke()},o.prototype.drawPath=function(e,t){var i=e.d,r=i.split(" "),n=this.getOptionValue(e,"stroke-width"),s=this.ctx,a=!0;this.ctx.save(),this.ctx.beginPath(),t&&this.ctx.translate(t[0],t[1]),this.ctx.globalAlpha=e.opacity?e.opacity:this.getOptionValue(e,"fill-opacity"),this.setAttributes(e);for(var l=0;l<r.length;l=l+3){var h=parseFloat(r[l+1]),u=parseFloat(r[l+2]);switch(r[l]){case"M":!e.innerR&&!e.cx&&this.ctx.moveTo(h,u);break;case"L":e.innerR||this.ctx.lineTo(h,u);break;case"Q":var c=parseFloat(r[l+3]),d=parseFloat(r[l+4]);this.ctx.quadraticCurveTo(h,u,c,d),l=l+2;break;case"C":var p=parseFloat(r[l+3]),f=parseFloat(r[l+4]),v=parseFloat(r[l+5]),m=parseFloat(r[l+6]);this.ctx.bezierCurveTo(h,u,p,f,v,m),l=l+4;break;case"A":e.innerR?a&&(this.ctx.arc(e.x,e.y,e.radius,e.start,e.end,e.counterClockWise),this.ctx.arc(e.x,e.y,e.innerR,e.end,e.start,!e.counterClockWise),a=!1):e.cx?this.ctx.arc(e.cx,e.cy,e.radius,0,2*Math.PI,e.counterClockWise):(this.ctx.moveTo(e.x,e.y),this.ctx.arc(e.x,e.y,e.radius,e.start,e.end,e.counterClockWise),this.ctx.lineTo(e.x,e.y)),l=l+5;break;case"z":case"Z":this.ctx.closePath(),l=l-2;break}}return e.fill!=="none"&&e.fill!==void 0&&(this.ctx.fillStyle=e.fill,this.ctx.fill()),n>0&&this.ctx.stroke(),this.ctx.restore(),this.ctx=s,this.canvasObj},o.prototype.createText=function(e,t,i,r,n,s){var a=this.getOptionValue(e,"font-weight");!g(a)&&a.toLowerCase()==="regular"&&(a="normal");var l=this.getOptionValue(e,"font-size"),h=this.getOptionValue(e,"font-family"),u=this.getOptionValue(e,"font-style").toLowerCase(),c=u+" "+a+" "+l+" "+h,d=this.getOptionValue(e,"text-anchor"),p=e.opacity!==void 0?e.opacity:1;if(d==="middle"&&(d="center"),this.ctx.save(),this.ctx.fillStyle=e.fill,this.ctx.font=c,this.ctx.textAlign=d,this.ctx.globalAlpha=p,e.baseline&&(this.ctx.textBaseline=e.baseline),!s){var f=0;this.ctx.translate(e.x+f/2+(i||0),e.y+(r||0)),this.ctx.rotate(e.labelRotation*Math.PI/180)}return this.ctx.fillText(t,s?e.x:0,s?n:0),this.ctx.restore(),this.canvasObj},o.prototype.drawCircle=function(e,t){var i=this.ctx;return this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(e.cx,e.cy,e.r,0,2*Math.PI),this.ctx.fillStyle=e.fill,this.ctx.globalAlpha=e.opacity,this.ctx.fill(),t&&this.ctx.translate(t[0],t[1]),this.setAttributes(e),this.ctx.stroke(),this.ctx.restore(),this.ctx=i,this.canvasObj},o.prototype.drawPolyline=function(e){this.ctx.save(),this.ctx.beginPath();for(var t=e.points.split(" "),i=0;i<t.length-1;i++){var r=t[i].split(","),n=parseFloat(r[0]),s=parseFloat(r[1]);i===0?this.ctx.moveTo(n,s):this.ctx.lineTo(n,s)}this.ctx.lineWidth=this.getOptionValue(e,"stroke-width"),this.ctx.strokeStyle=e.stroke,this.ctx.stroke(),this.ctx.restore()},o.prototype.drawEllipse=function(e,t){var i=this.ctx,r=Math.max(e.rx,e.ry),n=e.rx/r,s=e.ry/r;this.ctx.save(),this.ctx.beginPath(),this.ctx.translate(e.cx,e.cy),t&&this.ctx.translate(t[0],t[1]),this.ctx.save(),this.ctx.scale(n,s),this.ctx.arc(0,0,r,0,2*Math.PI,!1),this.ctx.fillStyle=e.fill,this.ctx.fill(),this.ctx.restore(),this.ctx.lineWidth=this.getOptionValue(e,"stroke-width"),this.ctx.strokeStyle=e.stroke,this.ctx.stroke(),this.ctx.restore(),this.ctx=i},o.prototype.drawImage=function(e){this.ctx.save();var t=new Image;g(e.href)||(t.src=e.href,this.ctx.drawImage(t,e.x,e.y,e.width,e.height)),this.ctx.restore()},o.prototype.createLinearGradient=function(e){var t;g(e[0].colorStop)||(t=this.ctx.createLinearGradient(0,0,0,this.canvasObj.height));var i=this.setGradientValues(e,t);return i},o.prototype.createRadialGradient=function(e){var t;g(e[0].colorStop)||(t=this.ctx.createRadialGradient(0,0,0,0,0,this.canvasObj.height));var i=this.setGradientValues(e,t);return i},o.prototype.setGradientValues=function(e,t){var i;if(g(e[0].colorStop))i=e[0].color.toString();else{for(var r=0;r<=e.length-1;r++){var n=e[r].color,s=e[r].colorStop.slice(0,-1),a=parseInt(s,10)/100;t.addColorStop(a,n)}i=t.toString()}return i},o.prototype.setElementAttributes=function(e,t){for(var i=Object.keys(e),r=Object.keys(e).map(function(s){return e[s]}),n=0;n<i.length;n++)t.setAttribute(i[n],r[n]);return null},o.prototype.updateCanvasAttributes=function(e){this.setElementAttributes(e,this.canvasObj);var t=this.ctx;if(!g(this.dataUrl)){var i=new Image;i.onload=function(){t.drawImage(i,0,0)},i.src=this.dataUrl}},o.prototype.clearRect=function(e){this.ctx.restore(),this.ctx.clearRect(e.x,e.y,e.width,e.height)},o.prototype.createGroup=function(){return null},o.prototype.drawClipPath=function(){return null},o.prototype.drawCircularClipPath=function(){return null},o.prototype.canvasClip=function(e){this.ctx.save(),this.ctx.fillStyle="transparent",this.ctx.rect(e.x,e.y,e.width,e.height),this.ctx.fill(),this.ctx.clip()},o.prototype.canvasRestore=function(){this.ctx.restore()},o.prototype.drawPolygon=function(){return null},o.prototype.createDefs=function(){return null},o.prototype.createClipPath=function(){return null},o.prototype.createSvg=function(){return null},o}();function lU(o){var e;switch(o){case"Highcontrast":case"HighContrast":e={tooltipFill:"#ffffff",tooltipBoldLabel:"#000000",tooltipLightLabel:"#000000",tooltipHeaderLine:"#969696",textStyle:{fontFamily:"Segoe UI",color:"#000000",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"MaterialDark":case"FabricDark":case"BootstrapDark":e={tooltipFill:o==="MaterialDark"?"#F4F4F4":o==="FabricDark"?"#A19F9D":"#F0F0F0",tooltipBoldLabel:o==="MaterialDark"?"rgba(18, 18, 18, 1)":o==="FabricDark"?"#DADADA":"#1A1A1A",tooltipLightLabel:o==="MaterialDark"?"rgba(18, 18, 18, 1)":o==="FabricDark"?"#DADADA":"#1A1A1A",tooltipHeaderLine:"#9A9A9A",textStyle:o==="MaterialDark"?{fontFamily:"Roboto",color:"rgba(18, 18, 18, 1)",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}:o==="FabricDark"?{fontFamily:"Segoe UI",color:"#DADADA",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}:{fontFamily:"Helvetica",color:"#1A1A1A",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"Bootstrap4":e={tooltipFill:"#212529",tooltipBoldLabel:"#F9FAFB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"rgba(255, 255, 255, 0.2)",textStyle:{fontFamily:"Helvetica",color:"#F9FAFB",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"Tailwind3":e={tooltipFill:"#111827",tooltipBoldLabel:"#F9FAFB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#D1D5DB",textStyle:{fontFamily:"Inter",color:"#F9FAFB",fontWeight:"500",size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"Tailwind3Dark":e={tooltipFill:"#F9FAFB",tooltipBoldLabel:"#1F2937",tooltipLightLabel:"#1F2937",tooltipHeaderLine:"#374151",textStyle:{fontFamily:"Inter",color:"#1F2937",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"Tailwind":e={tooltipFill:"#111827",tooltipBoldLabel:"#F9FAFB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280",textStyle:{fontFamily:"Inter",color:"#F9FAFB",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"TailwindDark":e={tooltipFill:"#E9ECEF",tooltipBoldLabel:"#1F2937",tooltipLightLabel:"#1F2937",tooltipHeaderLine:"#9CA3AF",textStyle:{fontFamily:"Inter",color:"#1F2937",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"Bootstrap5":e={tooltipFill:"#000000E5",tooltipBoldLabel:"#FFFFFF",tooltipLightLabel:"#FFFFFF",tooltipHeaderLine:"#FFFFFF",textStyle:{fontFamily:"Segoe UI",color:"#FFFFFF",fontWeight:null,size:"12px",headerTextSize:"16px",boldTextSize:"14px"}};break;case"Bootstrap5Dark":e={tooltipFill:"#FFFFFFE5",tooltipBoldLabel:"#212529",tooltipLightLabel:"#212529",tooltipHeaderLine:"#212529",textStyle:{fontFamily:"Helvetica",color:"#212529",fontWeight:null,size:"12px",headerTextSize:"16px",boldTextSize:"14px"}};break;case"Fluent":e={tooltipFill:"#FFFFFF",tooltipBoldLabel:"#323130",tooltipLightLabel:"#323130",tooltipHeaderLine:"#D2D0CE",textStyle:{fontFamily:"Segoe UI",color:"#323130",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"FluentDark":e={tooltipFill:"#323130",tooltipBoldLabel:"#F3F2F2",tooltipLightLabel:"#F3F2F1",tooltipHeaderLine:"#3B3A39",textStyle:{fontFamily:"Segoe UI",color:"#F3F2F1",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"Fluent2":e={tooltipFill:"#FFFFFF",tooltipBoldLabel:"#242424",tooltipLightLabel:"#242424",tooltipHeaderLine:"#D2D0CE",textStyle:{fontFamily:"Segoe UI",color:"#242424",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"Fluent2Dark":e={tooltipFill:"#292929",tooltipBoldLabel:"#FFFFFF",tooltipLightLabel:"#FFFFFF",tooltipHeaderLine:"#3B3A39",textStyle:{fontFamily:"Segoe UI",color:"#FFFFFF",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"Fluent2HighContrast":e={tooltipFill:"#000000",tooltipBoldLabel:"#FFFFFF",tooltipLightLabel:"#FFFFFF",tooltipHeaderLine:"#3B3A39",textStyle:{fontFamily:"Segoe UI",color:"#FFFFFF",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"Material3":e={tooltipFill:"#313033",tooltipBoldLabel:"#F4EFF4",tooltipLightLabel:"#F4EFF4",tooltipHeaderLine:"#F4EFF4",textStyle:{fontFamily:"Roboto",color:"#F4EFF4",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"Material3Dark":e={tooltipFill:"#E6E1E5",tooltipBoldLabel:"#313033",tooltipLightLabel:"#313033",tooltipHeaderLine:"#313033",textStyle:{fontFamily:"Roboto",color:"#313033",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;default:e={tooltipFill:o==="Material"?"#000816":o==="Fabric"?"#FFFFFF":"#212529",tooltipBoldLabel:o==="Material"?"rgba(249, 250, 251, 1)":o==="Fabric"?"#333333":"#F9FAFB",tooltipLightLabel:o==="Material"?"rgba(249, 250, 251, 1)":o==="Fabric"?"#333333":"#F9FAFB",tooltipHeaderLine:o==="Fabric"?"#D2D0CE":"#ffffff",textStyle:o==="Material"?{fontFamily:"Roboto",color:"rgba(249, 250, 251, 1)",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}:o==="Fabric"?{fontFamily:"Segoe UI",color:"#333333",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}:{fontFamily:"Helvetica",color:"#F9FAFB",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break}return e}var hN=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();function Ze(o,e,t,i){var r=o||"",n=document.getElementById("chartmeasuretext");if(n===null&&(n=Xe("text",{id:"chartmeasuretext"}),document.body.appendChild(n)),typeof o=="string"&&(o.indexOf("<")>-1||o.indexOf(">")>-1)){for(var s=o.split(" "),a=0;a<s.length;a++)s[a].indexOf("<br/>")===-1&&(s[a]=s[a].replace(/[<>]/g,"&"));o=s.join(" ")}n.innerHTML=r.indexOf("<br>")>-1||r.indexOf("<br/>")>-1?r:o,n.style.position="fixed",n.style.fontSize=e.size||(i?t.headerTextSize:t.size),n.style.fontStyle=e.fontStyle||t.fontStyle,n.style.fontFamily=e.fontFamily||t.fontFamily,n.style.visibility="hidden",n.style.top="-100",n.style.left="0",n.style.whiteSpace="nowrap",n.style.lineHeight="normal";var l=n.clientWidth,h=n.clientHeight,u=n.style.fontWeight;return n.style.fontWeight=e.fontWeight||t.fontWeight,new _t(n.style.fontWeight==="bold"&&u==="normal"?Math.max(l,n.clientWidth):n.clientWidth,n.style.fontWeight==="bold"&&u==="normal"?Math.max(h,n.clientHeight):n.clientHeight)}function oN(o,e,t,i,r){return i===void 0&&(i=0),r===void 0&&(r=0),o>=t.x-i&&o<=t.x+t.width+i&&e>=t.y-r&&e<=t.y+t.height+r}function hU(o,e,t,i,r,n,s,a,l,h,u){u===void 0&&(u="");var c="",d=t.x,p=t.y,f=t.x+t.width,v=t.y+t.height;return n?(c=c.concat("M "+d+" "+(p+e)+" Q "+d+" "+p+" "+(d+o)+" "+p+"  L "+(f-o)+" "+p+" Q "+f+" "+p+" "+f+" "+(p+e)),c=c.concat(" L "+f+" "+(v-e)+" Q "+f+" "+v+" "+(f-o)+" "+v),r!==0&&(u==="RangeNavigator"?i.x-r>f/2?(c=c.concat(" L "+(i.x+r)+" "+v),c=c.concat(" L "+(l+r)+" "+(v+r)+" L "+i.x+" "+v)):(c=c.concat(" L "+i.x+" "+v),c=c.concat(" L "+(l-r)+" "+(v+r)+" L "+(i.x-r)+" "+v)):(c=c.concat(" L "+(i.x+r)+" "+v),c=c.concat(" L "+l+" "+(v+r)+" L "+(i.x-r)+" "+v))),i.x-r>d||r===0?c=c.concat(" L "+(d+o)+" "+v+" Q "+d+" "+v+" "+d+" "+(v-e)+" z"):c=c.concat(" L "+d+" "+(v+e)+" z")):s?(c=c.concat("M "+d+" "+(p+e)+" Q "+d+" "+p+" "+(d+o)+" "+p+" L "+(i.x-r)+" "+p),c=c.concat(" L "+l+" "+i.y),c=c.concat(" L "+(i.x+r)+" "+p),c=c.concat(" L "+(f-o)+" "+p+" Q "+f+" "+p+" "+f+" "+(p+e)),c=c.concat(" L "+f+" "+(v-e)+" Q "+f+" "+v+" "+(f-o)+" "+v+" L "+(d+o)+" "+v+" Q "+d+" "+v+" "+d+" "+(v-e)+" z")):a?(c=c.concat("M "+d+" "+(p+e)+" Q "+d+" "+p+" "+(d+o)+" "+p),c=c.concat(" L "+(f-o)+" "+p+" Q "+f+" "+p+" "+f+" "+((u==="RangeNavigator"?0:p+e)+" L "+f+" "+(u==="RangeNavigator"?0:i.y-r))),c=u==="RangeNavigator"?c.concat(" L "+(f+r)+" 0"):c.concat(" L "+(f+r)+" "+h),c=u==="RangeNavigator"?c.concat(" L "+f+" "+(i.y-e)):c.concat(" L "+f+" "+(i.y+r)),c=c.concat(" L "+f+" "+(v-e)+" Q "+f+" "+v+" "+(f-o)+" "+v),c=c.concat(" L "+(d+o)+" "+v+" Q "+d+" "+v+" "+d+" "+(v-e)+" z")):(c=c.concat("M "+(d+o)+" "+p+" Q "+d+" "+p+" "+d+" "+((u==="RangeNavigator"?0:p+e)+" L "+d+" "+(u==="RangeNavigator"?0:i.y-r))),c=u==="RangeNavigator"?c.concat(" L "+(d-r)+" 0"):c.concat(" L "+(d-r)+" "+h),c=u==="RangeNavigator"?c.concat(" L "+d+" "+(i.y-e)):c.concat(" L "+d+" "+(i.y+r)),c=c.concat(" L "+d+" "+(v-e)+" Q "+d+" "+v+" "+(d+o)+" "+v),c=c.concat(" L "+(f-o)+" "+v+" Q "+f+" "+v+" "+f+" "+(v-e)+" L "+f+" "+(p+e)+" Q "+f+" "+p+" "+(f-o)+" "+p+" z")),c}var _t=function(){function o(e,t){this.width=e,this.height=t}return o}(),Ae=function(){function o(e,t,i,r){this.x=e,this.y=t,this.width=i,this.height=r}return o}(),uU=function(){function o(e,t){this.isRight=t,this.isBottom=e}return o}(),uN=function(){function o(e){this.id=e}return o}(),gn=function(o){hN(e,o);function e(t,i,r,n,s,a,l,h){a===void 0&&(a="");var u=o.call(this,t)||this;return u.transform="",u.baseLine="auto",u.labelRotation=0,u.x=i,u.y=r,u.anchor=n,u.text=s,u.transform=a,u.baseLine=l,u.labelRotation=h,u}return e}(uN);function Xn(o){return document.getElementById(o)}function tf(o){var e=Xn(o);e&&Ue(e)}function cU(o,e,t,i,r,n,s){var a=new Ql(""),l=dU(o,t,e,r,i),h=a["draw"+l.functionName](l.renderOption);return h.setAttribute("role",n),h.setAttribute("aria-label",s),h}function dU(o,e,t,i,r){var n,s="Path",a=e.width,l=e.height,h=o.x,u=o.y,c=o.x+-a/2,d=o.y+-l/2;switch(t){case"Circle":case"Bubble":s="Ellipse",ht(i,{rx:a/2,ry:l/2,cx:h,cy:u});break;case"Plus":n="M "+c+" "+u+" L "+(h+a/2)+" "+u+" M "+h+" "+(u+l/2)+" L "+h+" "+(u+-l/2),ht(i,{d:n,stroke:i.fill});break;case"Cross":n="M "+c+" "+(u+-l/2)+" L "+(h+a/2)+" "+(u+l/2)+" M "+c+" "+(u+l/2)+" L "+(h+a/2)+" "+(u+-l/2),ht(i,{d:n,stroke:i.fill});break;case"HorizontalLine":n="M "+c+" "+u+" L "+(h+a/2)+" "+u,ht(i,{d:n,stroke:i.fill});break;case"VerticalLine":n="M "+h+" "+(u+l/2)+" L "+h+" "+(u+-l/2),ht(i,{d:n,stroke:i.fill});break;case"Diamond":n="M "+c+" "+u+" L "+h+" "+(u+-l/2)+" L "+(h+a/2)+" "+u+" L "+h+" "+(u+l/2)+" L "+c+" "+u+" z",ht(i,{d:n});break;case"Rectangle":n="M "+c+" "+(u+-l/2)+" L "+(h+a/2)+" "+(u+-l/2)+" L "+(h+a/2)+" "+(u+l/2)+" L "+c+" "+(u+l/2)+" L "+c+" "+(u+-l/2)+" z",ht(i,{d:n});break;case"Triangle":n="M "+c+" "+(u+l/2)+" L "+h+" "+(u+-l/2)+" L "+(h+a/2)+" "+(u+l/2)+" L "+c+" "+(u+l/2)+" z",ht(i,{d:n});break;case"InvertedTriangle":n="M "+(h+a/2)+" "+(u-l/2)+" L "+h+" "+(u+l/2)+" L "+(h-a/2)+" "+(u-l/2)+" L "+(h+a/2)+" "+(u-l/2)+" z",ht(i,{d:n});break;case"Pentagon":for(var p=72,f=void 0,v=void 0,m=0;m<=5;m++)f=a/2*Math.cos(Math.PI/180*(m*p)),v=l/2*Math.sin(Math.PI/180*(m*p)),m===0?n="M "+(h+f)+" "+(u+v)+" ":n=n.concat("L "+(h+f)+" "+(u+v)+" ");n=n.concat("Z"),ht(i,{d:n});break;case"Image":s="Image",ht(i,{href:r,height:l,width:a,x:c,y:d});break;case"Star":{for(var y=5,S=Math.min(a,l)/2,b=S/2,w=Math.PI/y,I="",m=0;m<2*y;m++){var x=m%2===0?S:b,M=h+x*Math.cos(m*w-Math.PI/2),D=u+x*Math.sin(m*w-Math.PI/2);I+=(m===0?"M":"L")+M+","+D}I+="Z",ht(i,{d:I});break}}return{renderOption:i,functionName:s}}var Ir=function(o){hN(e,o);function e(t,i,r,n,s,a,l){var h=o.call(this,t)||this;return h.opacity=s,h.fill=i,h.stroke=n,h["stroke-width"]=r,h["stroke-dasharray"]=a,h.d=l,h}return e}(uN);function cN(o,e,t,i,r){var n={},s=new Ql("");n={id:o.id,x:o.x,y:o.y,fill:t,"font-size":e.size||r.size,"font-style":e.fontStyle||r.fontStyle,"font-family":e.fontFamily||r.fontFamily,"font-weight":e.fontWeight||r.fontWeight,"text-anchor":o.anchor,transform:o.transform,opacity:e.opacity,"dominant-baseline":o.baseLine};var a=typeof o.text=="string"?o.text:o.text[0],l=s.createText(n,a);return i&&i.appendChild(l),l}var Qn=function(){function o(e,t){this.x=e,this.y=t}return o}(),rf=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),pt=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},pU=function(o){rf(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return pt([C(null)],e.prototype,"size",void 0),pt([C("")],e.prototype,"color",void 0),pt([C("Segoe UI")],e.prototype,"fontFamily",void 0),pt([C("Normal")],e.prototype,"fontWeight",void 0),pt([C("Normal")],e.prototype,"fontStyle",void 0),pt([C(1)],e.prototype,"opacity",void 0),pt([C(null)],e.prototype,"headerTextSize",void 0),pt([C(null)],e.prototype,"boldTextSize",void 0),e}(Re),fU=function(o){rf(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return pt([C("")],e.prototype,"color",void 0),pt([C(1)],e.prototype,"width",void 0),pt([C("")],e.prototype,"dashArray",void 0),e}(Re),gU=function(o){rf(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return pt([C(0)],e.prototype,"x",void 0),pt([C(0)],e.prototype,"y",void 0),pt([C(0)],e.prototype,"width",void 0),pt([C(0)],e.prototype,"height",void 0),e}(Re),lN=function(o){rf(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return pt([C(0)],e.prototype,"x",void 0),pt([C(0)],e.prototype,"y",void 0),e}(Re),dN=function(o){rf(e,o);function e(t,i){return o.call(this,t,i)||this}return e.prototype.preRender=function(){this.allowServerDataBinding=!1,this.initPrivateVariable(),this.isCanvas||this.removeSVG(),this.createTooltipElement()},e.prototype.initPrivateVariable=function(){this.renderer=new Ql(this.element.id),this.themeStyle=lU(this.theme),this.formattedText=[],this.padding=5,this.highlightPadding=3,this.areaMargin=10,this.isFirst=!0,this.markerPoint=[]},e.prototype.removeSVG=function(){var t=document.getElementById(this.element.id+"_svg"),i=document.getElementById(this.element.id+"parent_template");this.blazorTemplate&&El(this.element.id+"parent_template_blazorTemplate"),t&&t.parentNode&&Ue(t),i&&i.parentNode&&Ue(i)},e.prototype.render=function(){if(this.fadeOuted=!1,this.template)this.updateTemplateFn(),this.createTemplate(this.areaBounds,this.location);else{this.renderText(this.isFirst);var t={cancel:!1,name:"tooltipRender",tooltip:this};this.trigger("tooltipRender",t);var i=this.renderTooltipElement(this.areaBounds,this.location);this.drawMarker(i.isBottom,i.isRight,this.markerSize)}this.trigger("loaded",{tooltip:this});var r=document.getElementById("chartmeasuretext");r&&Ue(r),this.allowServerDataBinding=!0},e.prototype.createTooltipElement=function(){if(this.textElements=[],!this.template||this.shared){this.enableRTL&&this.element.setAttribute("dir","ltr");var t=this.renderer.createSvg({id:this.element.id+"_svg"});this.element.appendChild(t);var i=document.getElementById(this.element.id+"_group");i||(i=this.renderer.createGroup({id:this.element.id+"_group"}),i.setAttribute("transform","translate(0,0)")),t.appendChild(i);var r=this.renderer.drawPath({id:this.element.id+"_path","stroke-width":(this.theme==="Fabric"||this.theme==="Fluent"||this.theme==="Fluent2"||this.theme==="Fluent2HighContrast")&&!this.border.width?1:this.border.width,fill:this.fill||this.themeStyle.tooltipFill,opacity:(this.theme==="TailwindDark"||this.theme==="Tailwind"||this.theme==="Tailwind3Dark"||this.theme==="Tailwind3"||this.theme==="Bootstrap5"||this.theme==="Bootstrap5Dark"||this.theme.indexOf("Fluent2")>-1)&&this.opacity===.75?1:this.opacity,stroke:this.border.color||(this.theme==="Fabric"||this.theme==="Fluent"||this.theme==="Fluent2"?"#D2D0CE":this.border.color)});i.appendChild(r)}},e.prototype.drawMarker=function(t,i,r){if(this.shapes.length<=0)return null;var n,s=0,a=this.renderer.createGroup({id:this.element.id+"_trackball_group"}),l=Xn(this.element.id+"_group");if(!l)return null;for(var h=(this.enableRTL?this.elementSize.width-r/2:this.marginX*2+r/2)+(i?this.arrowPadding:0),u=0,c=this.shapes;u<c.length;u++){var d=c[u];if(d!=="None"){if(n=new Ir(this.element.id+"_Trackball_"+s,this.palette[s],1,"#cccccc",1,null),this.markerPoint[s]){var p=0;this.header.indexOf("<br")>-1&&(p=this.header.split(/<br.*?>/g).length+s);var f=this.formattedText&&this.formattedText.length>=2?this.getTooltipTextContent(this.formattedText[1])+", "+this.getTooltipTextContent(this.formattedText[0]):"";a.appendChild(cU(new Qn(h,this.markerPoint[s]-this.padding+(t?this.arrowPadding:p)),d,new _t(r,r),"",n,"img",f))}s++}}l.appendChild(a)},e.prototype.renderTooltipElement=function(t,i){var r=Xn(this.element.id),n=new Qn(0,0),s=new Qn(0,0),a=Xn(this.element.id+"_svg"),l=Xn(this.element.id+"_group"),h=Xn(this.element.id+"_path"),u,c=!1,d=!1,p=!1,f=0,v=0;if(!g(l)){if(this.header!==""&&this.showHeaderLine&&(this.elementSize.height+=this.marginY),this.isFixed){var m=this.elementSize.width+2*this.marginX,y=this.elementSize.height+2*this.marginY;u=new Ae(i.x,i.y,m,y)}else this.content.length>1?(u=this.sharedTooltipLocation(t,this.location.x,this.location.y),c=!0):(u=this.tooltipLocation(t,i,n,s),this.inverted?(d=u.x<i.x+this.clipBounds.x,f=d?0:this.arrowPadding,this.allowHighlight&&(u.x+=d?this.highlightPadding:-(2*this.highlightPadding))):(c=u.y<i.y+this.clipBounds.y,p=!c,v=c?0:this.arrowPadding));if(this.header!==""&&this.showHeaderLine){var S=2,b=0,w=this.isWrap?this.wrappedText:this.header;if(this.isWrap&&typeof w=="string"&&(w.indexOf("<")>-1||w.indexOf(">")>-1)){var I=w.split("<br>");S=I.length}this.header.indexOf("<br")>-1&&(b=5*(this.header.split(/<br.*?>/g).length-1));var x="properties",M=he({},this.textStyle,null,!0)[x],D=Ze(this.isWrap?this.wrappedText:this.header,M,this.themeStyle.textStyle).height+this.marginY*S+(p?this.arrowPadding:0)+(this.isWrap?5:b),A=this.marginX*3+(!d&&!c&&!p?this.arrowPadding:0),L="M "+A+" "+D+"L "+(u.width+(!d&&!c&&!p?this.arrowPadding:0)-this.marginX*2)+" "+D,T=this.renderer.drawPath({id:this.element.id+"_header_path","stroke-width":1,fill:null,opacity:this.theme==="Material3"||this.theme==="Material3Dark"?.2:.8,stroke:this.themeStyle.tooltipHeaderLine,d:L});l.appendChild(T)}var k=this.border.width/2,F=new Ae(k+f,k+v,u.width-k,u.height-k);if(l.setAttribute("opacity","1"),this.enableAnimation&&!this.isFirst&&!this.crosshair?this.animateTooltipDiv(r,u):this.updateDiv(r,u.x,u.y),a.setAttribute("height",(u.height+this.border.width+(this.inverted?0:this.arrowPadding)+5).toString()),a.setAttribute("width",(u.width+this.border.width+(this.inverted?this.arrowPadding:0)+5).toString()),a.setAttribute("opacity","1"),g(this.tooltipPlacement)||(c=this.tooltipPlacement.indexOf("Top")>-1,p=this.tooltipPlacement.indexOf("Bottom")>-1,d=this.tooltipPlacement.indexOf("Left")>-1),h.setAttribute("d",hU(this.rx,this.ry,F,n,this.arrowPadding,c,p,d,s.x,s.y,this.controlName)),this.enableShadow&&this.theme!=="Bootstrap4"||this.theme.indexOf("Fluent2")>-1){var R=this.element.id+"_shadow";this.theme==="Tailwind"||this.theme==="TailwindDark"||this.theme==="Tailwind3"||this.theme==="Tailwind3Dark"||this.theme==="Bootstrap5"||this.theme==="Bootstrap5Dark"?h.setAttribute("box-shadow","0px 1px 2px rgba(0, 0, 0, 0.06), 0px 1px 3px rgba(0, 0, 0, 0.1)"):h.setAttribute("filter",B.isIE?"":"url(#"+R+")");var N='<filter id="'+R+'" height="130%"><feGaussianBlur in="SourceAlpha" stdDeviation="3"/>';this.theme.indexOf("Fluent2")>-1?N+='<feOffset dx="-1" dy="3.6" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="0.2"/>':N+='<feOffset dx="3" dy="3" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="0.5"/>',N+='</feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';var P=this.renderer.createDefs();P.setAttribute("id",this.element.id+"SVG_tooltip_definition"),l.appendChild(P),P.innerHTML=N}var O=(this.theme==="Fabric"||this.theme==="Fluent"||this.theme==="Fluent2")&&!this.border.color?"#D2D0CE":this.theme==="Fluent2HighContrast"?"#FFFFFF":this.border.color;h.setAttribute("stroke",O),g(this.border.dashArray)||h.setAttribute("stroke-dasharray",this.border.dashArray),this.changeText(new Qn(f,v),p,!d&&!c&&!p),this.revert&&(this.inverted=!this.inverted,this.revert=!1)}return new uU(p,!d&&!c&&!p)},e.prototype.changeText=function(t,i,r){var n=document.getElementById(this.element.id+"_text");i&&n.setAttribute("transform","translate(0,"+this.arrowPadding+")"),r&&n.setAttribute("transform","translate("+this.arrowPadding+" 0)")},e.prototype.findFormattedText=function(){this.formattedText=[],this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()!==""&&(this.formattedText=this.formattedText.concat(this.header)),this.formattedText=this.formattedText.concat(this.content)},e.prototype.renderText=function(t){var i=0,r=0,n=0,s,a="properties",l=he({},this.textStyle,null,!0)[a],h=Xn(this.element.id+"_group"),u,c,d="",p,f;this.findFormattedText(),this.isWrap=!1;var v=document.body.getAttribute("dir")==="rtl",m=v&&!this.enableRTL?"end":"start";this.leftSpace=this.areaBounds.x+this.location.x,this.rightSpace=this.areaBounds.x+this.areaBounds.width-this.leftSpace;var y=this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim(),S=this.header.indexOf("<b>")>-1&&this.header.indexOf("</b>")>-1,b=Ze(this.formattedText[0],l,this.themeStyle.textStyle).width+2*this.marginX+this.arrowPadding,w=this.location.x-b<this.location.x,I=this.areaBounds.x+this.areaBounds.width<this.location.x+b,x,M=y!==""&&this.showHeaderLine?this.marginY:0,D=!0,A=!0;this.markerPoint=[];var L=this.shapes.length>0?10:0,T=this.shapes.length>0?5:0,k=4,F,R="12px",N="400",P=this.themeStyle.tooltipLightLabel,O=22/parseFloat(R)*parseFloat(l.size||this.themeStyle.textStyle.size),z=[],H=0;(!t||this.isCanvas)&&(tf(this.element.id+"_text"),tf(this.element.id+"_header_path"),tf(this.element.id+"_trackball_group"),tf(this.element.id+"SVG_tooltip_definition")),this.controlName==="Chart"&&parseFloat(R)<parseFloat(l.size||this.themeStyle.textStyle.headerTextSize)&&(H=parseFloat(l.size||this.themeStyle.textStyle.size)-parseFloat(R));for(var Q=new gn(this.element.id+"_text",this.marginX*2,H+this.marginY*2+this.padding*2+(this.marginY===2?this.controlName==="RangeNavigator"?5:3:0),m,""),$=cN(Q,l,l.color||this.themeStyle.tooltipBoldLabel,h,this.themeStyle.textStyle),U=this.formattedText.length===1&&this.formattedText[0].indexOf(" : <b>")>-1,ie=this.header!=="",ne=ie&&S?16:13,te=0,oe=this.formattedText.length;te<oe;te++)if(c=this.formattedText[te].replace(/<(b|strong)>/g,"<b>").replace(/<\/(b|strong)>/g,"</b>").split(/<br.*?>/g),this.isTextWrap&&this.header!==this.formattedText[te]&&this.formattedText[te].indexOf("<br")===-1&&(F=Math.round(this.leftSpace>this.rightSpace?this.leftSpace/ne:this.rightSpace/ne),c=this.formattedText[te].match(new RegExp(".{1,"+F+"}","g"))),te===0&&!U&&this.isTextWrap&&(this.leftSpace<b||w)&&(this.rightSpace<b||I)&&(F=Math.round(this.leftSpace>this.rightSpace?this.leftSpace/ne:this.rightSpace/ne),x=y!==""?y:this.formattedText[te],c=x.match(new RegExp(".{1,"+F+"}","g")),this.wrappedText=S?"<b>"+c.join("<br>")+"</b>":c.join("<br>"),this.isWrap=c.length>1),c[0]!==""){(te!==0||y==="")&&this.markerPoint.push((y!==""&&this.showHeaderLine?this.marginY:0)+Q.y+i-(H!==0?H/this.markerSize*(parseFloat(l.size||this.themeStyle.textStyle.headerTextSize)/this.markerSize):0));for(var ae=0,ye=c.length;ae<ye;ae++){s=c[ae].replace(/<b>/g,"<br><b>").replace(/<\/b>/g,"</b><br>").replace(/:/g,this.enableRTL?"<br>\u200E: <br>":"<br>\u200E:<br>").split("<br>"),this.enableRTL&&s.length>0&&c[ae].match(/:/g)&&(s[0]=s[0].trim(),s.reverse()),n=0,A=!0,i+=O;for(var De=0,ve=s.length;De<ve;De++)if(p=s[De],this.enableRTL&&p!==""&&this.isRTLText(p)&&(p=p.concat("\u200E")),!/\S/.test(p)&&p!==""&&(p=" "),!A&&p===" "||p.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()!==""){n+=p!==" "?k:0,A&&!D?(this.header.indexOf("<br")>-1&&te!==0&&(M+=this.header.split(/<br.*?>/g).length),f={x:this.marginX*2+(L+T),dy:O+(A?M:0),fill:""},M=null):D&&A?f={x:y===""?this.marginX*2+(L+T):this.marginX*2+(this.isWrap?L+T:0)}:f={},A=!1,u=this.renderer.createTSpan(f,""),$.appendChild(u),p.indexOf("<b>")>-1||S&&De===0&&te===0&&(ie||this.isWrap)?(N="600",P=this.themeStyle.tooltipBoldLabel,d="font-weight:"+N,l.fontWeight=N,u.setAttribute("fill",this.textStyle.color||P)):(d=N==="600"?"font-weight:"+N:"",l.fontWeight=N,u.setAttribute("fill",this.textStyle.color||P)),(p.indexOf("</b>")>-1||S&&De===ve-1&&te===0&&(ie||this.isWrap))&&(N="Normal",P=this.themeStyle.tooltipLightLabel),d!==""&&(u.style.fontWeight=d.split("font-weight:")[1],u.style.color=u.getAttribute("fill")),u.style.fontFamily="inherit",u.style.fontStyle="inherit",u.style.fontSize=this.header===this.formattedText[te]?l.size||this.themeStyle.textStyle.headerTextSize:p.indexOf("<b>")>-1||p.indexOf("</b>")>-1?l.size||this.themeStyle.textStyle.boldTextSize:l.size||this.themeStyle.textStyle.size,u.style.fontWeight=this.header===this.formattedText[te]&&(this.header.indexOf("<b>")===-1||this.header.indexOf("</b>")===-1)?this.textStyle.fontWeight||(this.theme.indexOf("Tailwind3")>-1?"500":"600"):p.indexOf("<b>")>-1||p.indexOf("</b>")>-1?this.theme.indexOf("Bootstrap5")>-1?this.textStyle.fontWeight||"600":"bold":(p.indexOf("<b>")===-1||p.indexOf("</b>")===-1)&&(this.theme.indexOf("Bootstrap5")>-1||this.theme.indexOf("Tailwind3")>-1)?this.textStyle.fontWeight||(this.theme.indexOf("Tailwind3")>-1?"500":"600"):this.textStyle.fontWeight||l.fontWeight;var ue=he({},this.textStyle,null,!0)[a];ue.fontWeight=u.style.fontWeight,ue.size=u.style.fontSize,D=!1,u.textContent=p=this.getTooltipTextContent(p),n+=Ze(p,ue,this.themeStyle.textStyle).width}n-=k,r=Math.max(r,n),z.push(n)}}this.elementSize=new _t(r+(r>0?2*this.marginX:0),i),this.elementSize.width+=L+T;var Tt=$.childNodes[0];if(y!==""&&Tt&&!this.isWrap){l.fontWeight="600";var _e=(this.elementSize.width+2*this.padding)/2-Ze(y,l,this.themeStyle.textStyle,!0).width/2;Tt.setAttribute("x",_e.toString())}this.renderContentRTL($,ie,L+T,z)},e.prototype.renderContentRTL=function(t,i,r,n){if(this.enableRTL)for(var s=void 0,a=i?1:0,l=0;l<t.childNodes.length;l++)s=t.childNodes[l],(!i||l>0)&&!g(s.getAttribute("x"))&&(s.setAttribute("x",(this.elementSize.width-(r+n[a])).toString()),a++)},e.prototype.getTooltipTextContent=function(t){var i=t.match(/<[a-zA-Z\/](.|\n)*?>/g);if(g(i))return t;for(var r=this.isRTLText(t),n=0;n<i.length;n++)this.isValidHTMLElement(i[n].replace("<","").replace("/","").replace(">","").trim())&&(t=t.replace(i[n],r?"\u200E":""));return t},e.prototype.isValidHTMLElement=function(t){return document.createElement(t).toString()!=="[object HTMLUnknownElement]"},e.prototype.isRTLText=function(t){return/[\u0590-\u07FF\u200F\u202B\u202E\uFB1D-\uFDFD\uFE70-\uFEFC]/.test(t)},e.prototype.createTemplate=function(t,i){var r={cancel:!1,name:"tooltipRender",tooltip:this};this.trigger("tooltipRender",r);var n=document.getElementById(this.element.id);this.isCanvas&&this.removeSVG();var s=g(n)?null:n.firstElementChild;if(s&&Ue(s),r.cancel)Ue(Xn(this.element.id+"_tooltip"));else{var a=Xe("div",{id:this.element.id+"parent_template"}),l=void 0;if(this.controlName==="Chart"&&this.shared)for(var h=0;h<this.data.length;h++){var u=this.templateFn(this.data[h],this.controlInstance,a.id,a.id+"_blazorTemplate","");h===0?l=u:u.length>1?l[h].outerHTML=u[h].outerHTML||u[h].textContent:l[l.length-1].outerHTML+=u[0].outerHTML}else l=this.templateFn(this.data,this.controlInstance,a.id,a.id+"_blazorTemplate","");for(;l&&l.length>0;)qe()||l.length===1?(a.appendChild(l[0]),l=null):a.appendChild(l[0]);g(n)||n.appendChild(a);var c=this.isCanvas?a:this.element,d=c.getBoundingClientRect();this.padding=0,this.elementSize=new _t(d.width,d.height);var p=this.shared?this.sharedTooltipLocation(t,this.location.x,this.location.y):this.tooltipLocation(t,i,new Qn(0,0),new Qn(0,0));if(this.enableAnimation&&!this.isFirst&&!this.crosshair?this.animateTooltipDiv(this.element,p):this.updateDiv(c,p.x,p.y),this.blazorTemplate){var f=function(){var m=Xn(v.element.id).getBoundingClientRect();v.elementSize=new _t(m.width,m.height);var y=v.tooltipLocation(t,i,new Qn(0,0),new Qn(0,0));v.updateDiv(Xn(v.element.id),y.x,y.y)},v=this;f.bind(v,t,i),rc(this.element.id+"parent_template_blazorTemplate",this.blazorTemplate.name,this.blazorTemplate.parent,void 0,f)}}},e.prototype.sharedTooltipLocation=function(t,i,r){var n=this.elementSize.width+2*this.marginX,s=this.elementSize.height+2*this.marginY,a=new Ae(i+2*this.padding,r-s-this.padding,n,s);return a.y<t.y&&(a.y+=a.height+2*this.padding),a.y+a.height>t.y+t.height&&(a.y=Math.max(t.y+t.height-(a.height+2*this.padding),t.y)),a.x+a.width>t.x+t.width&&(a.x=t.x+this.location.x-(a.width+4*this.padding)),a.x<t.x&&(a.x=t.x),a},e.prototype.getCurrentPosition=function(t,i,r,n){var s=this.tooltipPlacement,a=this.clipBounds.x,l=this.clipBounds.y,h=this.offset,u=this.elementSize.width+2*this.marginX,c=this.elementSize.height+2*this.marginY,d=new Qn(i.x,i.y);return s==="Top"||s==="Bottom"?(d=new Qn(d.x+a-this.elementSize.width/2-this.padding,d.y+l-this.elementSize.height-2*this.padding-this.arrowPadding-h),r.x=n.x=u/2,s==="Bottom"&&(d.y=i.y+l+h),t.x+t.width<d.x+u?(d.x=t.width>u?t.x+t.width-u+6:t.x,r.x=n.x=t.width>u?t.x+i.x-d.x:i.x):t.x>d.x&&(d.x=t.x,r.x=n.x=i.x)):(d=new Qn(d.x+a+h,d.y+l-this.elementSize.height/2-this.padding),r.y=n.y=c/2,s==="Left"&&(d.x=i.x+a-h-(u+this.arrowPadding)),t.y+t.height<d.y+c?(d.y=t.height>c?t.y+t.height-c+6:t.y,r.y=n.y=t.height>c?t.y+i.y-d.y:i.y):t.y>d.y&&(d.y=t.y,r.y=n.y=i.y)),new Ae(d.x,d.y,u,c)},e.prototype.tooltipLocation=function(t,i,r,n){if(!g(this.tooltipPlacement)){var s=this.getCurrentPosition(t,i,r,n);return s}var a=new Qn(i.x,i.y),l=this.elementSize.width+2*this.marginX,h=this.elementSize.height+2*this.marginY,u=this.offset,c=this.clipBounds.x,d=this.clipBounds.y,p=t.x,f=t.y;return this.outOfBounds=!1,this.inverted?(a=new Qn(a.x+c+u,a.y+d-this.elementSize.height/2-this.padding),r.y=n.y=h/2,(a.x+l+this.arrowPadding>p+t.width||this.isNegative)&&(a.x=(i.x>t.width+t.x?t.width:i.x)+c-u-(l+this.arrowPadding)),a.x<p&&(a.x=(i.x<0?0:i.x)+c+u),a.x+l+this.arrowPadding>p+t.width&&(a.x=(i.x>t.width+t.x?t.width:i.x)+c-u-(l+this.arrowPadding)),a.y<=f&&(r.y-=f-a.y,n.y-=f-a.y,a.y=f),a.y+h>=f+t.height&&(r.y+=a.y+h-(f+t.height),n.y+=a.y+h-(f+t.height),a.y-=a.y+h-(f+t.height)),r.y+this.arrowPadding>h-this.ry&&(r.y=h-this.ry-this.arrowPadding,n.y=h),r.y-this.arrowPadding<this.ry&&(r.y=n.y=this.ry+this.arrowPadding),this.controlName==="Chart"&&((a.y+r.y<this.areaMargin+this.arrowPadding||t.y+t.height-(a.y+r.y)<this.areaMargin+this.arrowPadding)&&(this.outOfBounds=!0),(!oN(a.x,a.y,t)||this.outOfBounds)&&(this.inverted=!this.inverted,a=new Qn(i.x+c-this.padding-this.elementSize.width/2,i.y+d-this.elementSize.height-2*this.padding-u-this.arrowPadding),this.revert=!0,n.x=r.x=l/2,n.y=r.y=0,(a.y<f||this.isNegative)&&(a.y=(i.y<0?0:i.y)+u+d),a.y+this.arrowPadding+h>f+t.height&&(a.y=Math.min(i.y,f+t.height)+d-this.elementSize.height-2*this.padding-u-this.arrowPadding),n.x=l/2,a.x<p&&(n.x-=p-a.x,r.x-=p-a.x,a.x=p),a.x+l>t.width+p&&(r.x+=a.x+l-(t.width+p),n.x+=a.x+l-(t.width+p),a.x-=a.x+l-(t.width+p)),this.arrowPadding+r.x>l-this.rx&&(n.x=l-this.rx-this.arrowPadding,r.x=l-this.rx-this.arrowPadding),r.x-this.arrowPadding<this.rx&&(r.x=n.x=this.rx+this.arrowPadding)))):(a=new Qn(a.x+c-this.elementSize.width/2-this.padding,a.y+d-this.elementSize.height-2*(this.allowHighlight?this.highlightPadding:this.padding)-this.arrowPadding-u),r.x=n.x=l/2,(a.y<f||this.isNegative)&&this.controlName!=="Progressbar"&&(a.y=(i.y<0?0:i.y)+d+u),a.y+h+this.arrowPadding>f+t.height&&(a.y=Math.min(i.y,f+t.height)+d-this.elementSize.height-2*this.padding-this.arrowPadding-u),(a.x+l>p+t.width&&a.y<f||this.isNegative)&&this.controlName!=="Progressbar"&&(a.y=(i.y<0?0:i.y)+d+u),n.x=l/2,a.x<p&&this.controlName!=="Progressbar"&&(r.x-=p-a.x,n.x-=p-a.x,a.x=p),a.x+l>p+t.width&&this.controlName!=="Progressbar"&&(r.x+=a.x+l-(p+t.width),n.x+=a.x+l-(p+t.width),a.x-=a.x+l-(p+t.width)),a.x<p&&this.controlName!=="Progressbar"&&(r.x-=p-a.x,n.x-=p-a.x,a.x=p),r.x+this.arrowPadding>l-this.rx&&(r.x=l-this.rx-this.arrowPadding,n.x=l-this.rx-this.arrowPadding),r.x-this.arrowPadding<this.rx&&(r.x=n.x=this.rx+this.arrowPadding),this.controlName==="Chart"&&((t.x+t.width-(a.x+r.x)<this.areaMargin+this.arrowPadding||a.x+r.x<this.areaMargin+this.arrowPadding)&&(this.outOfBounds=!0),this.template&&a.y<0&&(a.y=i.y+d+u),(!oN(a.x,a.y,t)||this.outOfBounds)&&(this.inverted=!this.inverted,this.revert=!0,a=new Qn(i.x+u+c,i.y+d-this.elementSize.height/2-this.padding),n.x=r.x=0,n.y=r.y=h/2,(a.x+this.arrowPadding+l>p+t.width||this.isNegative)&&(a.x=(i.x>p+t.width?t.width:i.x)+c-u-(this.arrowPadding+l)),a.x<p&&(a.x=(i.x<0?0:i.x)+u+c),a.y<=f&&(n.y-=f-a.y,r.y-=f-a.y,a.y=f),a.y+h>=t.height+f&&(r.y+=a.y+h-(t.height+f),n.y+=a.y+h-(t.height+f),a.y-=a.y+h-(t.height+f)),this.arrowPadding+r.y>h-this.ry&&(r.y=h-this.arrowPadding-this.ry,n.y=h),r.y-this.arrowPadding<this.ry&&(r.y=this.arrowPadding+this.ry,n.y=0)))),new Ae(a.x,a.y,l,h)},e.prototype.animateTooltipDiv=function(t,i){var r=this,n=parseFloat(t.style.left),s=parseFloat(t.style.top),a=this.duration===0&&Ut==="Enable"?300:this.duration;if(this.controlName==="Chart"&&this.shared&&!this.enableRTL){var l=this.element.style.transform.split(/[(),\s]+/);n=parseFloat(l[1]),s=parseFloat(l[2]),t.style.transition="transform "+a+"ms ease"}var h;new It({}).animate(t,{duration:a,progress:function(u){h=u.timeStamp/u.duration,t.style.animation=null,r.controlName==="Chart"&&r.shared&&!r.enableRTL?(t.style.transform="translate("+(n+(i.x-n))+"px,"+(s+i.y-s)+"px)",t.style.left="",t.style.top=""):r.controlName==="Chart"&&r.showNearestTooltip?(t.style.transition="left "+u.duration+"ms ease-out, top "+u.duration+"ms ease-out",t.style.left=i.x+"px",t.style.top=i.y+"px"):(t.style.left=n+h*(i.x-n)+"px",t.style.top=s+h*(i.y-s)+"px",t.style.transform=r.controlName==="RangeNavigator"?t.style.transform:"")},end:function(u){r.updateDiv(t,i.x,i.y),r.trigger("animationComplete",{tooltip:r})}})},e.prototype.updateDiv=function(t,i,r){this.controlName==="Chart"&&this.shared&&!this.crosshair&&!this.enableRTL?(t.style.transform="translate("+i+"px,"+r+"px)",t.style.left="",t.style.top=""):(t.style.left=i+"px",t.style.top=r+"px",t.style.transform=this.controlName==="RangeNavigator"?t.style.transform:"")},e.prototype.updateTemplateFn=function(){if(this.template)try{typeof this.template!="function"&&document.querySelectorAll(this.template).length?this.templateFn=wt(document.querySelector(this.template).innerHTML.trim()):this.templateFn=wt(this.template)}catch{this.templateFn=wt(this.template)}},e.prototype.fadeOut=function(){var t=this,i=this.isCanvas&&!this.template?Xn(this.element.id+"_svg"):Xn(this.element.id),r=Xn(this.element.id);if(i){var n=i.firstChild;if(n.nodeType!==Node.ELEMENT_NODE&&(n=i.firstElementChild),this.isCanvas&&!this.template&&(n=document.getElementById(this.element.id+"_group")?document.getElementById(this.element.id+"_group"):n),!n)return null;var s=parseFloat(n.getAttribute("opacity"));s=g(s)?1:s,new It({}).animate(n,{duration:200,progress:function(a){t.progressAnimation(n,s,a.timeStamp/a.duration)},end:function(){t.fadeOuted=!0,t.endAnimation(n),r.style.transition=""}})}},e.prototype.progressAnimation=function(t,i,r){t.style.animation="",t.setAttribute("opacity",(i-r).toString())},e.prototype.endAnimation=function(t){t.setAttribute("opacity","0"),this.template&&(t.style.display="none"),this.trigger("animationComplete",{tooltip:this})},e.prototype.getPersistData=function(){var t=[];return this.addOnPersist(t)},e.prototype.getModuleName=function(){return"tooltip"},e.prototype.destroy=function(){o.prototype.destroy.call(this),this.element.classList.remove("e-tooltip")},e.prototype.onPropertyChanged=function(t,i){this.blazorTemplate&&El(this.element.id+"parent_template_blazorTemplate"),this.isFirst=!1,this.render()},pt([C(!1)],e.prototype,"enable",void 0),pt([C(!1)],e.prototype,"shared",void 0),pt([C(!1)],e.prototype,"crosshair",void 0),pt([C(!1)],e.prototype,"enableShadow",void 0),pt([C(null)],e.prototype,"fill",void 0),pt([C("")],e.prototype,"header",void 0),pt([C(.75)],e.prototype,"opacity",void 0),pt([be({size:"12px",fontWeight:null,color:null,fontStyle:"Normal",fontFamily:null},pU)],e.prototype,"textStyle",void 0),pt([C(null)],e.prototype,"template",void 0),pt([C(!0)],e.prototype,"enableAnimation",void 0),pt([C(300)],e.prototype,"duration",void 0),pt([C(!1)],e.prototype,"inverted",void 0),pt([C(!1)],e.prototype,"isNegative",void 0),pt([be({color:null,width:null},fU)],e.prototype,"border",void 0),pt([C([])],e.prototype,"content",void 0),pt([C(10)],e.prototype,"markerSize",void 0),pt([be({x:0,y:0},lN)],e.prototype,"clipBounds",void 0),pt([C([])],e.prototype,"palette",void 0),pt([C([])],e.prototype,"shapes",void 0),pt([be({x:0,y:0},lN)],e.prototype,"location",void 0),pt([C(0)],e.prototype,"offset",void 0),pt([C(4)],e.prototype,"rx",void 0),pt([C(4)],e.prototype,"ry",void 0),pt([C(5)],e.prototype,"marginX",void 0),pt([C(5)],e.prototype,"marginY",void 0),pt([C(7)],e.prototype,"arrowPadding",void 0),pt([C(null)],e.prototype,"data",void 0),pt([C("Material")],e.prototype,"theme",void 0),pt([be({x:0,y:0,width:0,height:0},gU)],e.prototype,"areaBounds",void 0),pt([C(null)],e.prototype,"availableSize",void 0),pt([C()],e.prototype,"blazorTemplate",void 0),pt([C(!1)],e.prototype,"isCanvas",void 0),pt([C(!1)],e.prototype,"isTextWrap",void 0),pt([C(!1)],e.prototype,"isFixed",void 0),pt([C(null)],e.prototype,"tooltipPlacement",void 0),pt([C(null)],e.prototype,"controlInstance",void 0),pt([C("")],e.prototype,"controlName",void 0),pt([C(!1)],e.prototype,"showNearestTooltip",void 0),pt([q()],e.prototype,"tooltipRender",void 0),pt([q()],e.prototype,"loaded",void 0),pt([q()],e.prototype,"animationComplete",void 0),pt([C(!1)],e.prototype,"enableRTL",void 0),pt([C(!1)],e.prototype,"allowHighlight",void 0),pt([C(!0)],e.prototype,"showHeaderLine",void 0),e=pt([bt],e),e}(Kt);var Kr=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ze=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Fc=function(o){Kr(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ze([C("Line")],e.prototype,"type",void 0),ze([C(null)],e.prototype,"color",void 0),ze([C(1)],e.prototype,"width",void 0),ze([C(null)],e.prototype,"length",void 0),ze([C("")],e.prototype,"dashArray",void 0),e}(Re),NN=function(o){Kr(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ze([C(0)],e.prototype,"x",void 0),ze([C(0)],e.prototype,"y",void 0),e}(Re),So=function(o){Kr(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ze([C(null)],e.prototype,"accessibilityDescription",void 0),ze([C(null)],e.prototype,"accessibilityRole",void 0),ze([C(!0)],e.prototype,"focusable",void 0),ze([C(0)],e.prototype,"tabIndex",void 0),e}(Re),vU=function(o){Kr(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ze([C(null)],e.prototype,"accessibilityDescriptionFormat",void 0),e}(So),ua=function(o){Kr(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ze([C("Normal")],e.prototype,"fontStyle",void 0),ze([C("16px")],e.prototype,"size",void 0),ze([C("Normal")],e.prototype,"fontWeight",void 0),ze([C("")],e.prototype,"color",void 0),ze([C("Center")],e.prototype,"textAlignment",void 0),ze([C("Segoe UI")],e.prototype,"fontFamily",void 0),ze([C(1)],e.prototype,"opacity",void 0),ze([C("Wrap")],e.prototype,"textOverflow",void 0),e}(Re),mU=function(o){Kr(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ze([C("Normal")],e.prototype,"fontStyle",void 0),ze([C("16px")],e.prototype,"size",void 0),ze([C("Normal")],e.prototype,"fontWeight",void 0),ze([C("")],e.prototype,"color",void 0),ze([C("Center")],e.prototype,"textAlignment",void 0),ze([C("Segoe UI")],e.prototype,"fontFamily",void 0),ze([C(1)],e.prototype,"opacity",void 0),e}(Re),yU=function(o){Kr(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ze([C(null)],e.prototype,"text",void 0),ze([be({fontFamily:null,size:"16px",fontStyle:"Normal",fontWeight:"600",color:null},ua)],e.prototype,"textStyle",void 0),ze([C(null)],e.prototype,"hoverTextFormat",void 0),e}(Re),Zn=function(o){Kr(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ze([C("")],e.prototype,"color",void 0),ze([C(1)],e.prototype,"width",void 0),ze([C("")],e.prototype,"dashArray",void 0),e}(Re),bU=function(o){Kr(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ze([C(0)],e.prototype,"x",void 0),ze([C(0)],e.prototype,"y",void 0),e}(Re),Hc=function(o){Kr(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ze([C(B.isDevice?5:10)],e.prototype,"left",void 0),ze([C(B.isDevice?5:10)],e.prototype,"right",void 0),ze([C(B.isDevice?5:10)],e.prototype,"top",void 0),ze([C(B.isDevice?5:10)],e.prototype,"bottom",void 0),e}(Re),$w=function(o){Kr(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ze([C(!0)],e.prototype,"enable",void 0),ze([C(1e3)],e.prototype,"duration",void 0),ze([C(0)],e.prototype,"delay",void 0),e}(Re),FN=function(o){Kr(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ze([C(!1)],e.prototype,"enable",void 0),ze([C(!0)],e.prototype,"enableMarker",void 0),ze([C(!1)],e.prototype,"shared",void 0),ze([C(null)],e.prototype,"fill",void 0),ze([C(null)],e.prototype,"header",void 0),ze([C(null)],e.prototype,"opacity",void 0),ze([be({fontFamily:null,size:null,fontStyle:"Normal",fontWeight:null,color:null},ua)],e.prototype,"textStyle",void 0),ze([C(null)],e.prototype,"format",void 0),ze([C(null)],e.prototype,"template",void 0),ze([C(!0)],e.prototype,"enableAnimation",void 0),ze([C(300)],e.prototype,"duration",void 0),ze([C(1e3)],e.prototype,"fadeOutDuration",void 0),ze([C("Move")],e.prototype,"fadeOutMode",void 0),ze([C(!1)],e.prototype,"enableTextWrap",void 0),ze([C(!0)],e.prototype,"showNearestPoint",void 0),ze([be({color:null,width:null},Zn)],e.prototype,"border",void 0),ze([be({x:null,y:null},NN)],e.prototype,"location",void 0),ze([C(!1)],e.prototype,"enableHighlight",void 0),ze([C(!1)],e.prototype,"showNearestTooltip",void 0),ze([C(!0)],e.prototype,"showHeaderLine",void 0),e}(Re),ON=function(o){Kr(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ze([C(null)],e.prototype,"fill",void 0),ze([be({color:"",width:0},Zn)],e.prototype,"border",void 0),ze([C("Gap")],e.prototype,"mode",void 0),e}(Re),RN=function(o){Kr(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ze([C(0)],e.prototype,"series",void 0),ze([C(0)],e.prototype,"point",void 0),e}(Re),SU=function(o){Kr(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ze([C(0)],e.prototype,"topLeft",void 0),ze([C(0)],e.prototype,"topRight",void 0),ze([C(0)],e.prototype,"bottomLeft",void 0),ze([C(0)],e.prototype,"bottomRight",void 0),e}(Re),CU=function(o){Kr(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ze([C(0)],e.prototype,"left",void 0),ze([C(0)],e.prototype,"right",void 0),ze([C(0)],e.prototype,"top",void 0),ze([C(0)],e.prototype,"bottom",void 0),e}(Re),wU=function(o){Kr(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ze([C("transparent")],e.prototype,"color",void 0),ze([C(0)],e.prototype,"width",void 0),ze([C(.8)],e.prototype,"cornerRadius",void 0),e}(Re),pN=function(o){Kr(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ze([C("Normal")],e.prototype,"fontStyle",void 0),ze([C("15px")],e.prototype,"size",void 0),ze([C("500")],e.prototype,"fontWeight",void 0),ze([C("")],e.prototype,"color",void 0),ze([C("Center")],e.prototype,"textAlignment",void 0),ze([C("Segoe UI")],e.prototype,"fontFamily",void 0),ze([C(1)],e.prototype,"opacity",void 0),ze([C("Wrap")],e.prototype,"textOverflow",void 0),ze([C("Top")],e.prototype,"position",void 0),ze([C(0)],e.prototype,"x",void 0),ze([C(0)],e.prototype,"y",void 0),ze([C("transparent")],e.prototype,"background",void 0),ze([be({},wU)],e.prototype,"border",void 0),ze([be({},So)],e.prototype,"accessibility",void 0),e}(Re),fN=function(o){Kr(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ze([C("Top")],e.prototype,"position",void 0),ze([C(0)],e.prototype,"x",void 0),ze([C(0)],e.prototype,"y",void 0),e}(ua),xU=function(o){Kr(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ze([be({},Zn)],e.prototype,"border",void 0),ze([C("transparent")],e.prototype,"background",void 0),ze([C(1)],e.prototype,"opacity",void 0),ze([C(null)],e.prototype,"backgroundImage",void 0),ze([C(null)],e.prototype,"width",void 0),ze([be({left:0,right:0,top:0,bottom:0},Hc)],e.prototype,"margin",void 0),e}(Re),IU=function(o){Kr(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ze([C(!1)],e.prototype,"enable",void 0),ze([C(null)],e.prototype,"minY",void 0),ze([C(null)],e.prototype,"maxY",void 0),ze([C(null)],e.prototype,"fill",void 0),e}(Re);var Wh=function(){function o(e,t){this.series=e,this.point=t}return o}(),mo=function(){function o(e,t){e<t?(this.mStart=e,this.mEnd=t):(this.mStart=t,this.mEnd=e)}return Object.defineProperty(o.prototype,"start",{get:function(){return this.mStart},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"end",{get:function(){return this.mEnd},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"delta",{get:function(){return this.mEnd-this.mStart},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"median",{get:function(){return this.mStart+(this.mEnd-this.mStart)/2},enumerable:!0,configurable:!0}),o}(),PN=function(){function o(e){this.isColumn=0,this.isStacking=!1,this.chart=e}return o.prototype.calculateNumericNiceInterval=function(e,t,i){var r=eF(i,e),n=t/r;if(!g(e.desiredIntervals)&&this.isAutoIntervalOnBothAxis(e))return n;for(var s=Math.pow(10,Math.floor(Jl(n,10))),a=0,l=e.intervalDivs;a<l.length;a++){var h=l[a],u=s*h;if(r<t/u)break;n=u}return n},o.prototype.isAutoIntervalOnBothAxis=function(e){return!((e.zoomFactor<1||e.zoomPosition>0)&&e.enableAutoIntervalOnZooming)},o.prototype.getActualRange=function(e,t){this.initializeDoubleRange(e),!e.startFromZero&&this.isColumn>0?(e.actualRange.interval=e.interval||this.calculateNumericNiceInterval(e,e.doubleRange.delta,t),e.actualRange.max=e.doubleRange.end+e.actualRange.interval,e.doubleRange.start-e.actualRange.interval<0&&e.doubleRange.start>0?e.actualRange.min=0:e.actualRange.min=e.doubleRange.start-(this.isStacking?0:e.actualRange.interval)):(e.actualRange.interval=e.interval||this.calculateNumericNiceInterval(e,e.doubleRange.delta,t),e.actualRange.min=e.doubleRange.start,e.actualRange.max=e.doubleRange.end)},o.prototype.initializeDoubleRange=function(e){e.minimum!==null?this.min=e.minimum:(this.min===null||this.min===Number.POSITIVE_INFINITY)&&(this.min=0),e.maximum!==null?this.max=e.maximum:(this.max===null||this.max===Number.NEGATIVE_INFINITY)&&(this.max=5),this.min===this.max&&(this.max=e.valueType.indexOf("Category")>-1?this.max:this.min+1),e.doubleRange=new mo(this.min,this.max),e.actualRange={}},o.prototype.calculateRangeAndInterval=function(e,t){this.calculateRange(t),this.getActualRange(t,e),this.applyRangePadding(t,e),this.calculateVisibleLabels(t,this.chart)},o.prototype.calculateRange=function(e){if(this.min=null,this.max=null,!Bs(e))for(var t=0,i=e.series;t<i.length;t++){var r=i[t];r.visible&&(this.paddingInterval=0,g(r.points)||(e.maxPointLength=r.points.length),e.maxPointLength=r.points.length,((r.type.indexOf("Column")>-1||r.type.indexOf("Histogram")>-1)&&e.orientation==="Horizontal"||r.type.indexOf("Bar")>-1&&e.orientation==="Vertical")&&(r.xAxis.valueType==="Double"||r.xAxis.valueType==="DateTime")&&r.xAxis.rangePadding==="Auto"&&(this.paddingInterval=JN(r.xAxis,e.series)*.5),e.orientation==="Horizontal"&&(this.chart.requireInvertedAxis?this.yAxisRange(e,r):this.findMinMax(r.xMin-this.paddingInterval,r.xMax+this.paddingInterval)),e.orientation==="Vertical"&&(this.isColumn+=r.type.indexOf("Column")!==-1||r.type.indexOf("Bar")!==-1||r.drawType==="Column"?1:0,this.isStacking=r.type.indexOf("Stacking")!==-1,this.chart.requireInvertedAxis?this.findMinMax(r.xMin-this.paddingInterval,r.xMax+this.paddingInterval):this.yAxisRange(e,r)))}},o.prototype.yAxisRange=function(e,t){if(t.dragSettings.enable&&this.chart.dragY&&(this.chart.dragY>=e.visibleRange.max&&(t.yMax=this.chart.dragY+e.visibleRange.interval),this.chart.dragY<=e.visibleRange.min&&(t.yMin=this.chart.dragY-e.visibleRange.interval)),t.type==="Waterfall"){for(var i=0,r=0,n=0;n<t.yData.length;n++)!(t.intermediateSumIndexes&&t.intermediateSumIndexes.indexOf(n)!==-1)&&!(t.sumIndexes&&t.sumIndexes.indexOf(n)!==-1)&&(r+=t.yData[n]),r>i&&(i=r);this.findMinMax(t.yMin,i)}else this.findMinMax(t.yMin,t.yMax)},o.prototype.findMinMax=function(e,t){(this.min===null||this.min>e)&&(this.min=e),(this.max===null||this.max<t)&&(this.max=t),this.max===this.min&&this.max<0&&this.min<0&&(this.max=0)},o.prototype.applyRangePadding=function(e,t){var i=e.actualRange.min,r=e.actualRange.max;if(!Bs(e)){var n=e.actualRange.interval,s=e.getRangePadding(this.chart);s==="Additional"||s==="Round"?this.findAdditional(e,i,r,n,t):s==="Normal"?this.findNormal(e,i,r,n,t):this.updateActualRange(e,i,r,n)}e.actualRange.delta=e.actualRange.max-e.actualRange.min,this.calculateVisibleRange(t,e)},o.prototype.updateActualRange=function(e,t,i,r){e.actualRange={min:e.minimum!=null?e.minimum:t,max:e.maximum!=null?e.maximum:i,interval:e.interval!=null?e.interval:r,delta:e.actualRange.delta}},o.prototype.findAdditional=function(e,t,i,r,n){var s,a;if(s=Math.floor(t/r)*r,a=Math.ceil(i/r)*r,e.rangePadding==="Additional"&&(s-=r,a+=r),!g(e.desiredIntervals)){var l=a-s;r=this.calculateNumericNiceInterval(e,l,n)}this.updateActualRange(e,s,a,r)},o.prototype.findNormal=function(e,t,i,r,n){var s,a,l,h=t;t<0?(h=0,a=t+t*.05,s=r+a%r,.365*r>=s&&(a-=r),a%r<0&&(a=a-r-a%r)):(a=t<5/6*i?0:t-(i-t)*.5,a%r>0&&(a-=a%r)),l=i>0?i+(i-h)*.05:i-(i-h)*.05,s=r-l%r,.365*r>=s&&(l+=r),l%r>0&&(l=l+r-l%r),e.doubleRange=new mo(a,l),(a===0||a<0&&l<0)&&(r=this.calculateNumericNiceInterval(e,e.doubleRange.delta,n),l=Math.ceil(l/r)*r),this.updateActualRange(e,a,l,r)},o.prototype.calculateVisibleRange=function(e,t){if(t.visibleRange={max:t.actualRange.max,min:t.actualRange.min,delta:t.actualRange.delta,interval:t.actualRange.interval},this.chart.chartAreaType==="Cartesian"){var i=g(t.zoomingScrollBar)?!1:t.zoomingScrollBar.isLazyLoad;(t.zoomFactor<1||t.zoomPosition>0)&&!i&&(t.calculateVisibleRangeOnZooming(),t.visibleRange.interval=t.enableAutoIntervalOnZooming?this.calculateNumericNiceInterval(t,t.doubleRange.delta,e):t.visibleRange.interval)}var r=(t.visibleRange.max-t.visibleRange.min)%t.visibleRange.interval;if(r!==0&&!isNaN(r)&&t.valueType==="Double"&&t.orientation==="Vertical"&&t.rangePadding==="Auto"){for(var n=void 0,s=t.visibleRange.min;s<=t.visibleRange.max&&n!==s;s+=t.visibleRange.interval)n=s;n<t.visibleRange.max&&(t.visibleRange.max=n+t.visibleRange.interval)}t.triggerRangeRender(this.chart,t.visibleRange.min,t.visibleRange.max,t.visibleRange.interval)},o.prototype.calculateVisibleLabels=function(e,t){e.visibleLabels=[];var i=e.visibleRange.min,r,n=t.getModuleName(),s=n==="chart"&&t.chartAreaType==="PolarRadar";!s&&(e.zoomFactor<1||e.zoomPosition>0||this.paddingInterval)&&(i=e.visibleRange.min-e.visibleRange.min%e.visibleRange.interval);var a=this.getFormat(e),l=a.match("{value}")!==null,h=0,u=0;e.labelFormat&&e.labelFormat.indexOf("n")>-1&&(u=parseInt(e.labelFormat.substring(1,e.labelFormat.length),10)),e.format=t.intl.getNumberFormat({format:l?"":a,useGrouping:t.useGroupingSeparator}),e.startLabel=e.format(e.visibleRange.min),e.endLabel=e.format(e.visibleRange.max),e.visibleRange.interval&&(e.visibleRange.interval+"").indexOf(".")>=0&&(h=(e.visibleRange.interval+"").split(".")[1].length);for(var c;i<=e.visibleRange.max&&c!==i;i+=e.visibleRange.interval)c=i,r=he({},V("properties",e.labelStyle),null,!0),Yh(i,e.visibleRange)&&Gw(t,i,this.formatValue(e,l,a,i),r,e);i&&(i+"").indexOf(".")>=0&&(i+"").split(".")[1].length>10&&(i=(i+"").split(".")[1].length>(u||h)?+i.toFixed(u||h):i,i<=e.visibleRange.max&&Gw(t,i,this.formatValue(e,l,a,i),r,e)),e.getMaxLabelWidth&&e.getMaxLabelWidth(this.chart)},o.prototype.getFormat=function(e){return e.labelFormat?e.labelFormat.indexOf("p")===0&&e.labelFormat.indexOf("{value}")===-1&&e.isStack100?"{value}%":e.labelFormat:e.isStack100?"{value}%":""},o.prototype.formatValue=function(e,t,i,r){var n=r%1?Number(r.toLocaleString("en-US").split(",").join("")):r;return t?i.replace("{value}",e.format(n)):i?e.format(r):e.format(n)},o.prototype.getModuleName=function(){return"Double"},o.prototype.destroy=function(){},o}();var Xl="legendClick",zm="load",MU="animationComplete",gN="legendRender",jm="textRender",Zl="pointRender",_w="sharedTooltipRender",Hm="seriesRender",vN="axisLabelRender",DU="axisLabelClick",mN="axisRangeCalculated";var Vm="tooltipRender",BN="chartMouseMove",zN="chartMouseClick",jN="chartDoubleClick",HN="pointClick",EU="pointDoubleClick",VN="pointMove",_N="chartMouseLeave",UN="chartMouseDown",WN="chartMouseUp";var yN="dragComplete",bN="selectionComplete",_m="resized",qN="beforeResize",SN="beforePrint";var Um=/~\d+~/g,CN=/\^\d+\^/g;var ll=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ke=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},AU=function(o){ll(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Ke([C("0")],e.prototype,"x",void 0),Ke([C("0")],e.prototype,"y",void 0),Ke([C(null)],e.prototype,"content",void 0),Ke([C("Center")],e.prototype,"horizontalAlignment",void 0),Ke([C("Pixel")],e.prototype,"coordinateUnits",void 0),Ke([C("Chart")],e.prototype,"region",void 0),Ke([C("Middle")],e.prototype,"verticalAlignment",void 0),Ke([C(null)],e.prototype,"xAxisName",void 0),Ke([C(null)],e.prototype,"yAxisName",void 0),Ke([C(null)],e.prototype,"description",void 0),Ke([be({},So)],e.prototype,"accessibility",void 0),e}(Re),GN=function(o){ll(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Ke([C("")],e.prototype,"color",void 0),Ke([C(1)],e.prototype,"width",void 0),Ke([C("Rectangle")],e.prototype,"type",void 0),e}(Re),TU=function(o){ll(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Ke([C(null)],e.prototype,"start",void 0),Ke([C(null)],e.prototype,"end",void 0),Ke([C("")],e.prototype,"text",void 0),Ke([C(null)],e.prototype,"maximumTextWidth",void 0),Ke([C(null)],e.prototype,"customAttributes",void 0),Ke([C("")],e.prototype,"type",void 0),e}(Re),LU=function(o){ll(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Ke([C(!0)],e.prototype,"visible",void 0),Ke([C(!1)],e.prototype,"startFromAxis",void 0),Ke([C(null)],e.prototype,"start",void 0),Ke([C(null)],e.prototype,"end",void 0),Ke([C(null)],e.prototype,"size",void 0),Ke([C("#808080")],e.prototype,"color",void 0),Ke([C(null)],e.prototype,"dashArray",void 0),Ke([C("Auto")],e.prototype,"sizeType",void 0),Ke([C(!1)],e.prototype,"isRepeat",void 0),Ke([C(null)],e.prototype,"repeatEvery",void 0),Ke([C(null)],e.prototype,"repeatUntil",void 0),Ke([C(!1)],e.prototype,"isSegmented",void 0),Ke([C(null)],e.prototype,"segmentStart",void 0),Ke([C(null)],e.prototype,"segmentEnd",void 0),Ke([C(null)],e.prototype,"segmentAxisName",void 0),Ke([be({color:"transparent",width:1},Zn)],e.prototype,"border",void 0),Ke([C("")],e.prototype,"text",void 0),Ke([C(null)],e.prototype,"rotation",void 0),Ke([C("Middle")],e.prototype,"horizontalAlignment",void 0),Ke([C("Middle")],e.prototype,"verticalAlignment",void 0),Ke([be({size:"12px",color:null,fontStyle:"Normal",fontWeight:"400",fontFamily:null},ua)],e.prototype,"textStyle",void 0),Ke([C("Behind")],e.prototype,"zIndex",void 0),Ke([C(1)],e.prototype,"opacity",void 0),Ke([C("")],e.prototype,"imageUrl",void 0),e}(Re),kU=function(o){ll(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Ke([C("Center")],e.prototype,"alignment",void 0),Ke([C("Wrap")],e.prototype,"overflow",void 0),Ke([be({fontFamily:null,size:"12px",fontStyle:"Normal",fontWeight:"400",color:null},ua)],e.prototype,"textStyle",void 0),Ke([be({color:null,width:1,type:"Rectangle"},GN)],e.prototype,"border",void 0),Ke([Wt([],TU)],e.prototype,"categories",void 0),e}(Re),NU=function(o){ll(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Ke([C(null)],e.prototype,"minimum",void 0),Ke([C(null)],e.prototype,"maximum",void 0),e}(Re),FU=function(o){ll(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Ke([C(!1)],e.prototype,"enable",void 0),Ke([C(null)],e.prototype,"pointsLength",void 0),Ke([be({},NU)],e.prototype,"range",void 0),Ke([C(null)],e.prototype,"trackColor",void 0),Ke([C(0)],e.prototype,"scrollbarRadius",void 0),Ke([C(null)],e.prototype,"scrollbarColor",void 0),Ke([C(0)],e.prototype,"trackRadius",void 0),Ke([C(null)],e.prototype,"gripColor",void 0),Ke([C(16)],e.prototype,"height",void 0),Ke([C(!0)],e.prototype,"enableZoom",void 0),Ke([C("PlaceNextToAxisLine")],e.prototype,"position",void 0),e}(Re),OU=function(o){ll(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Ke([C("Far")],e.prototype,"horizontalAlignment",void 0),Ke([C("Top")],e.prototype,"verticalAlignment",void 0),Ke([C(0)],e.prototype,"x",void 0),Ke([C(0)],e.prototype,"y",void 0),Ke([C(!1)],e.prototype,"draggable",void 0),e}(Re),RU=function(o){ll(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Ke([C(!1)],e.prototype,"visible",void 0),Ke([C("transparent")],e.prototype,"fill",void 0),Ke([C(null)],e.prototype,"format",void 0),Ke([C(0)],e.prototype,"angle",void 0),Ke([C(5)],e.prototype,"rx",void 0),Ke([C(5)],e.prototype,"ry",void 0),Ke([be({left:5,right:5,top:5,bottom:5},Hc)],e.prototype,"margin",void 0),Ke([be({width:null,color:null},Zn)],e.prototype,"border",void 0),Ke([be({size:null,color:null,fontStyle:null,fontWeight:"Bold",fontFamily:null},mU)],e.prototype,"font",void 0),e}(Re),hl=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ve=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},PU=function(o){hl(e,o);function e(){var t=o!==null&&o.apply(this,arguments)||this;return t.axes=[],t.nearSizes=[],t.farSizes=[],t.insideFarSizes=[],t.insideNearSizes=[],t}return e.prototype.computeSize=function(t,i,r,n){var s=0,a=5;t.visible&&t.internalVisibility&&(s+=t.findTickSize(t.crossInAxis)+(t.scrollbarSettings.position==="Right"||t.scrollbarSettings.position==="Left"?0:i)+t.findLabelSize(t.crossInAxis,a,r,n)+t.lineStyle.width*.5),t.isAxisOpposedPosition?this.farSizes.push(s):this.nearSizes.push(s)},Ve([C("100%")],e.prototype,"height",void 0),Ve([be({},Zn)],e.prototype,"border",void 0),e}(Re),BU=function(o){hl(e,o);function e(){var t=o!==null&&o.apply(this,arguments)||this;return t.axes=[],t.nearSizes=[],t.farSizes=[],t.insideFarSizes=[],t.insideNearSizes=[],t.padding=0,t}return e.prototype.computeSize=function(t,i,r,n){var s=0,a=5;t.visible&&t.internalVisibility&&(s+=t.findTickSize(t.crossInAxis)+(t.scrollbarSettings.position==="Top"||t.scrollbarSettings.position==="Bottom"?0:i)+t.findLabelSize(t.crossInAxis,a,r,n)+t.lineStyle.width*.5),t.isAxisOpposedPosition?this.farSizes.push(s):this.nearSizes.push(s)},Ve([C("100%")],e.prototype,"width",void 0),Ve([be({},Zn)],e.prototype,"border",void 0),e}(Re),zU=function(o){hl(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Ve([C(1)],e.prototype,"width",void 0),Ve([C("")],e.prototype,"dashArray",void 0),Ve([C(null)],e.prototype,"color",void 0),e}(Re),jU=function(o){hl(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Ve([C(.7)],e.prototype,"width",void 0),Ve([C("")],e.prototype,"dashArray",void 0),Ve([C(null)],e.prototype,"color",void 0),e}(Re),HU=function(o){hl(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Ve([C(1)],e.prototype,"width",void 0),Ve([C("")],e.prototype,"dashArray",void 0),Ve([C(null)],e.prototype,"color",void 0),e}(Re),VU=function(o){hl(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Ve([C(1)],e.prototype,"width",void 0),Ve([C(5)],e.prototype,"height",void 0),Ve([C(null)],e.prototype,"color",void 0),e}(Re),_U=function(o){hl(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Ve([C(.7)],e.prototype,"width",void 0),Ve([C(5)],e.prototype,"height",void 0),Ve([C(null)],e.prototype,"color",void 0),e}(Re),UU=function(o){hl(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Ve([C(!1)],e.prototype,"enable",void 0),Ve([C(null)],e.prototype,"fill",void 0),Ve([be({fontFamily:null,size:null,fontStyle:null,fontWeight:null,color:null},ua)],e.prototype,"textStyle",void 0),e}(Re),Fm=function(o){hl(e,o);function e(t,i,r,n){var s=o.call(this,t,i,r,n)||this;return s.visibleLabels=[],s.series=[],s.rect=new Ae(void 0,void 0,0,0),s.axisBottomLine=null,s.intervalDivs=[10,5,2,1],s.isStack100=!1,s.crossAt=null,s.updatedRect=null,s.multiLevelLabelHeight=0,s.isChart=!0,s.isIntervalInDecimal=!0,s.titleCollection=[],s.titleSize=new _t(0,0),s.internalVisibility=!0,s.isRTLEnabled=!1,s.angle=s.labelRotation,s}return e.prototype.findTickSize=function(t){return this.tickPosition==="Inside"||t&&(!t.visibleRange||this.isInside(t.visibleRange))?0:this.majorTickLines.height},e.prototype.isInside=function(t){return nf(this.crossAt,t)||!this.isAxisOpposedPosition&&this.crossAt>=t.max||this.isAxisOpposedPosition&&this.crossAt<=t.min},e.prototype.findLabelSize=function(t,i,r,n){var s=0,a=this.orientation==="Horizontal";if(this.title){var l=this.titleRotation;if(g(l)?(this.titleSize=Ze(this.title,this.titleStyle,n.themeStyle.axisTitleFont),s=this.titleSize.height+i):(this.titleSize=Oc(this.titleStyle,this.title,l,n,n.themeStyle.axisTitleFont),s=(this.orientation==="Vertical"?this.titleSize.width:this.titleSize.height)+i),this.rect.width||this.rect.height){var h=a?this.rect.width:this.rect.height;this.titleCollection=jc(this.title,this.titleStyle,h,n.enableRtl,n.themeStyle.axisTitleFont),s=s*this.titleCollection.length}}var u,c,d=s+i+this.titlePadding+this.labelPadding+(this.orientation==="Vertical"?this.maxLabelSize.width:this.maxLabelSize.height)+this.multiLevelLabelHeight;if(t&&this.placeNextToAxisLine){var p=t.visibleRange,f=t.orientation==="Horizontal"?t.rect.width:t.rect.height;if(!p||!f)return 0;this.isInside(p)&&(c=this.findDifference(t),u=c*(f/p.delta),u=c*((f-(u<d?d-u:0))/p.delta),d=u<d?d-u:0)}var v=this.title!==""&&this.titlePadding!==5?this.titlePadding:0;return this.isAxisOpposedPosition?r.insideFarSizes.push(d):r.insideNearSizes.push(d),this.labelPosition==="Inside"?this.isAxisOpposedPosition&&r.farSizes.length<1||!this.isAxisOpposedPosition&&r.nearSizes.length<1?(i=this.labelPosition==="Inside"&&n.axes.indexOf(this)>-1?-5:5,s+i+v):s+i+v+this.labelPadding+(this.orientation==="Vertical"?this.maxLabelSize.width:this.maxLabelSize.height)+this.multiLevelLabelHeight:d},e.prototype.updateCrossValue=function(){var t=this.crossAt;if(t===null||!this.isInside(this.crossInAxis.visibleRange))return this.updatedRect=this.rect,null;var i=this.crossInAxis.visibleRange;this.isAxisOpposedPosition?this.crossAt<i.min&&(t=i.min):this.crossAt>i.max&&(t=i.max),this.updatedRect=he({},this.rect,null,!0),this.orientation==="Horizontal"?(t=this.crossInAxis.rect.height-zn(t,this.crossInAxis)*this.crossInAxis.rect.height,this.updatedRect.y=this.crossInAxis.rect.y+t):(t=zn(t,this.crossInAxis)*this.crossInAxis.rect.width,this.updatedRect.x=this.crossInAxis.rect.x+t)},e.prototype.findDifference=function(t){var i=0;return this.isAxisOpposedPosition?i=t.isAxisInverse?t.visibleRange.min:t.visibleRange.max:i=t.isAxisInverse?t.visibleRange.max:t.visibleRange.min,Math.abs(this.crossAt-i)},e.prototype.calculateVisibleRangeOnZooming=function(){if(sf(this)){var t=this.actualRange,i=void 0,r=void 0;this.isAxisInverse?(i=this.actualRange.max-this.zoomPosition*this.actualRange.delta,r=i-this.zoomFactor*this.actualRange.delta):(i=this.actualRange.min+this.zoomPosition*this.actualRange.delta,r=i+this.zoomFactor*this.actualRange.delta),i<t.min&&(r=r+(t.min-i),i=t.min),r>t.max&&(i=i-(r-t.max),r=t.max),this.doubleRange=new mo(i,r),this.visibleRange={min:this.doubleRange.start,max:this.doubleRange.end,delta:this.doubleRange.delta,interval:this.visibleRange.interval}}},e.prototype.triggerRangeRender=function(t,i,r,n){var s={cancel:!1,name:mN,axis:this,minimum:i,maximum:r,interval:n};t.trigger(mN,s),s.cancel||(this.visibleRange={min:s.minimum,max:s.maximum,interval:s.interval,delta:s.maximum-s.minimum})},e.prototype.getRangePadding=function(t){var i=this.rangePadding;if(i!=="Auto")return i;switch(this.orientation){case"Horizontal":t.requireInvertedAxis?i=this.isStack100||this.baseModule.chart.stockChart?"Round":"Normal":i="None";break;case"Vertical":t.requireInvertedAxis?i="None":i=this.isStack100||this.baseModule.chart.stockChart?"Round":"Normal";break}return i},e.prototype.getMaxLabelWidth=function(t){var i=this,r,n=0,s=!1,a;this.angle=this.labelRotation,this.maxLabelSize=new _t(0,0);for(var l=this.labelIntersectAction,h,u=function(v,m){if(h=c.visibleLabels[v],a=Gh(h.originalText),a)h.size=Ze(h.originalText.replace(/<br>/g," "),c.labelStyle,t.themeStyle.axisLabelFont),h.breakLabelSize=Ze(c.enableTrim?h.text.join("<br>"):h.originalText,c.labelStyle,t.themeStyle.axisLabelFont);else if(c.enableWrap){var y=t.initialClipRect.height/c.visibleLabels.length;h.text=ol(h.text,c.maximumLabelWidth,c.labelStyle,t.enableRtl,null,null,t.themeStyle.axisLabelFont,c.orientation==="Vertical"?y:null);var S=0,b=0;h.text.forEach(function(F){var R=Ze(F,i.labelStyle,t.themeStyle.axisLabelFont);S=Math.max(S,R.width),b+=R.height}),h.size.width=S,h.size.height=b}else(c.angle===-90||c.angle===90||c.angle===270||c.angle===-270)&&c.orientation==="Vertical"?h.size=Oc(c.labelStyle,h.text,c.angle,t,t.themeStyle.axisLabelFont):h.size=Ze(h.text,c.labelStyle,t.themeStyle.axisLabelFont);var w=a?h.breakLabelSize.width:h.size.width;w>c.maxLabelSize.width&&(c.maxLabelSize.width=w,c.rotatedLabel=h.text);var I=a?h.breakLabelSize.height:h.size.height;if(I>c.maxLabelSize.height&&(c.maxLabelSize.height=I),a&&(h.text=c.enableTrim?h.text:h.originalText.split("<br>")),l==="None"||l==="Hide"||l==="Trim")return"continue";if((l!=="None"||c.angle%360===0)&&c.orientation==="Horizontal"&&c.rect.width>0&&!s){var x=a?h.breakLabelSize.width:h.size.width;switch(r=zn(h.value,c)*c.rect.width+c.rect.x,r-=x/2,c.edgeLabelPlacement==="Shift"&&(v===0&&r<c.rect.x&&(r=c.rect.x),v===c.visibleLabels.length-1&&r+x>c.rect.x+c.rect.width&&(r=c.rect.x+c.rect.width-x)),l){case"MultipleRows":v>0&&c.findMultiRows(v,r,h,a);break;case"Rotate45":case"Rotate90":v>0&&(c.isAxisInverse?r+x>=n:r<=n)&&(c.angle=l==="Rotate45"?45:90,s=!0);break;default:{if(a){for(var M=void 0,D=[],A=void 0,L=0;L<h.text.length;L++)if(M=ol(h.text[L],c.rect.width/c.visibleLabels.length,c.labelStyle,t.enableRtl,null,null,t.themeStyle.axisLabelFont),M.length>1)for(var T=0;T<M.length;T++)A=M[T],D.push(A);else D.push(M[0]);h.text=D}else h.text=ol(h.text,c.rect.width/c.visibleLabels.length,c.labelStyle,t.enableRtl,null,null,t.themeStyle.axisLabelFont);var k=h.size.height*h.text.length;k>c.maxLabelSize.height&&(c.maxLabelSize.height=k);break}}n=c.isAxisInverse?r:r+x}},c=this,d=0,p=this.visibleLabels.length;d<p;d++)u(d);if(this.angle!==0&&this.orientation==="Horizontal"){this.rotatedLabel=g(this.rotatedLabel)?"":this.rotatedLabel;var f=this.angle===-360||this.angle===0||this.angle===-180||this.angle===180||this.angle===360;this.labelPosition==="Outside"&&!f&&Gh(this.rotatedLabel)?this.maxLabelSize=new _t(this.maxLabelSize.height,this.maxLabelSize.width):this.maxLabelSize=Oc(this.labelStyle,this.rotatedLabel,this.angle,t,t.themeStyle.axisLabelFont)}else if(this.angle!==0&&this.orientation==="Vertical"){this.rotatedLabel=g(this.rotatedLabel)?"":this.rotatedLabel;var f=this.angle===-360||this.angle===0||this.angle===-180||this.angle===180||this.angle===360;this.labelPosition==="Outside"&&!f&&Gh(this.rotatedLabel)?this.maxLabelSize=new _t(this.maxLabelSize.height,this.maxLabelSize.width):this.maxLabelSize=Oc(this.labelStyle,this.rotatedLabel,this.angle,t,t.themeStyle.axisLabelFont)}t.multiLevelLabelModule&&this.multiLevelLabels.length>0&&t.multiLevelLabelModule.getMultilevelLabelsHeight(this)},e.prototype.findMultiRows=function(t,i,r,n){for(var s,a,l,h=[],u,c=t-1;c>=0;c--)s=this.visibleLabels[c],l=n?s.breakLabelSize.width:s.size.width,a=zn(s.value,this)*this.rect.width+this.rect.x,u=this.isAxisInverse?i+r.size.width>a-l*.5:i<a+l*.5,u?(h.push(s.index),r.index=r.index>s.index?r.index:s.index+1):r.index=h.indexOf(s.index)>-1?r.index:s.index;var d=(n?r.breakLabelSize.height:r.size.height)*r.index+5*(r.index-1);d>this.maxLabelSize.height&&(this.maxLabelSize.height=d)},e.prototype.getModule=function(t){this.valueType==="Double"?this.baseModule=new PN(t):this.baseModule=t[$r(this.valueType)+"Module"]},e.prototype.setIsInversedAndOpposedPosition=function(t){t===void 0&&(t=!1),this.isAxisOpposedPosition=this.opposedPosition||!t&&this.isRTLEnabled&&this.orientation==="Vertical",this.opposedPosition&&!t&&this.isRTLEnabled&&this.orientation==="Vertical"&&(this.isAxisOpposedPosition=!1),this.isAxisInverse=this.isInversed||this.isRTLEnabled&&this.orientation==="Horizontal",this.isInversed&&!t&&this.isRTLEnabled&&this.orientation==="Horizontal"&&(this.isAxisInverse=!1)},e.prototype.updateAxis=function(){var t=this.baseModule.chart,i=t.chartAxisLayoutPanel,r=t.axisCollections.indexOf(this),n=ce(t.element.id+"AxisInsideCollection"),s=ce(t.element.id+"AxisOutsideCollection");i.element=t.renderer.createGroup({id:t.element.id+"AxisGroup"+r+"Inside"});var a=t.renderer.createGroup({id:t.element.id+"AxisGroup"+r+"Outside"}),l=i.findAxisPosition(this);i.drawAxis(this,r,l,a,n,s),t.enableCanvas||vt(t.enableCanvas,n,i.element,t.redraw)},Ve([be({fontFamily:null,size:"12px",fontStyle:"Normal",fontWeight:"400",color:null},ua)],e.prototype,"labelStyle",void 0),Ve([be({},UU)],e.prototype,"crosshairTooltip",void 0),Ve([C("")],e.prototype,"title",void 0),Ve([be({fontFamily:null,size:null,fontStyle:null,fontWeight:null,color:null},ua)],e.prototype,"titleStyle",void 0),Ve([C("")],e.prototype,"labelFormat",void 0),Ve([C("")],e.prototype,"skeleton",void 0),Ve([C("DateTime")],e.prototype,"skeletonType",void 0),Ve([C("Center")],e.prototype,"lineBreakAlignment",void 0),Ve([C(0)],e.prototype,"plotOffset",void 0),Ve([C(null)],e.prototype,"plotOffsetLeft",void 0),Ve([C(null)],e.prototype,"plotOffsetTop",void 0),Ve([C(null)],e.prototype,"plotOffsetRight",void 0),Ve([C(null)],e.prototype,"plotOffsetBottom",void 0),Ve([C(!1)],e.prototype,"isIndexed",void 0),Ve([C(10)],e.prototype,"logBase",void 0),Ve([C(0)],e.prototype,"columnIndex",void 0),Ve([C(0)],e.prototype,"rowIndex",void 0),Ve([C(1)],e.prototype,"span",void 0),Ve([C(null)],e.prototype,"desiredIntervals",void 0),Ve([C(3)],e.prototype,"maximumLabels",void 0),Ve([C(1)],e.prototype,"zoomFactor",void 0),Ve([C(0)],e.prototype,"zoomPosition",void 0),Ve([C(!0)],e.prototype,"enableScrollbarOnZooming",void 0),Ve([C(!1)],e.prototype,"opposedPosition",void 0),Ve([C(!0)],e.prototype,"enableAutoIntervalOnZooming",void 0),Ve([C("Auto")],e.prototype,"rangePadding",void 0),Ve([C("Double")],e.prototype,"valueType",void 0),Ve([C("Shift")],e.prototype,"edgeLabelPlacement",void 0),Ve([C("Auto")],e.prototype,"intervalType",void 0),Ve([C("BetweenTicks")],e.prototype,"labelPlacement",void 0),Ve([C("Outside")],e.prototype,"tickPosition",void 0),Ve([C("Outside")],e.prototype,"labelPosition",void 0),Ve([C("")],e.prototype,"name",void 0),Ve([C(!0)],e.prototype,"visible",void 0),Ve([C(0)],e.prototype,"minorTicksPerInterval",void 0),Ve([C(0)],e.prototype,"labelRotation",void 0),Ve([C(null)],e.prototype,"titleRotation",void 0),Ve([C(null)],e.prototype,"crossesAt",void 0),Ve([C(!0)],e.prototype,"placeNextToAxisLine",void 0),Ve([C(null)],e.prototype,"crossesInAxis",void 0),Ve([C(null)],e.prototype,"minimum",void 0),Ve([C(null)],e.prototype,"maximum",void 0),Ve([C(null)],e.prototype,"interval",void 0),Ve([C(34)],e.prototype,"maximumLabelWidth",void 0),Ve([C(!1)],e.prototype,"enableTrim",void 0),Ve([C(!1)],e.prototype,"enableWrap",void 0),Ve([C(5)],e.prototype,"labelPadding",void 0),Ve([C(5)],e.prototype,"titlePadding",void 0),Ve([be({},VU)],e.prototype,"majorTickLines",void 0),Ve([be({},_U)],e.prototype,"minorTickLines",void 0),Ve([be({},zU)],e.prototype,"majorGridLines",void 0),Ve([be({},jU)],e.prototype,"minorGridLines",void 0),Ve([be({},HU)],e.prototype,"lineStyle",void 0),Ve([C(B.isDevice?"Rotate45":"Trim")],e.prototype,"labelIntersectAction",void 0),Ve([C(!1)],e.prototype,"isInversed",void 0),Ve([C(100)],e.prototype,"coefficient",void 0),Ve([C(0)],e.prototype,"startAngle",void 0),Ve([C(!0)],e.prototype,"startFromZero",void 0),Ve([C(null)],e.prototype,"description",void 0),Ve([C(2)],e.prototype,"tabIndex",void 0),Ve([Wt([],LU)],e.prototype,"stripLines",void 0),Ve([Wt([],kU)],e.prototype,"multiLevelLabels",void 0),Ve([be({color:null,width:0,type:"Rectangle"},GN)],e.prototype,"border",void 0),Ve([be({},FU)],e.prototype,"scrollbarSettings",void 0),e}(Re),WU=function(){function o(e,t,i,r,n,s,a){n===void 0&&(n=new _t(0,0)),s===void 0&&(s=new _t(0,0)),a===void 0&&(a=1),this.text=e,this.originalText=r,this.value=t,this.labelStyle=i,this.size=n,this.breakLabelSize=s,this.index=a}return o}(),YN=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();function qU(o,e,t){for(var i=he([],o,null),r=0;r<i.length;r++)for(var n=0;n<e.length;n++)i[r][e[n]]instanceof Date&&(i[r][e[n]]=i[r][e[n]].getTime());return i.sort(function(s,a){for(var l=0,h=0,u=0;u<e.length;u++)l+=s[e[u]],h+=a[e[u]];return!t&&l<h||t&&l>h?-1:l===h?0:1}),i}function Gh(o){return o.indexOf("<br>")!==-1}function Kl(o){for(var e=he([],o.points,null,!0),t=[],i,r=0,n=0;n<e.length;n++)i=e[n],!g(i.x)&&(i.index=r++,t.push(i));return t}function wN(o,e){var t=5,i=o.component,r=0,n=0,s=i.titleStyle.position==="Top"||i.titleStyle.position==="Bottom"&&!i.legendSettings.visible?15:5;i.title&&(r=Ze(i.title,i.titleStyle,i.themeStyle.chartTitleFont).height*i.titleCollection.length+s,i.subTitle&&(n=Ze(i.subTitle,i.subTitleStyle,i.themeStyle.chartSubTitleFont).height*i.subTitleCollection.length));var a;return e?o.axis.scrollbarSettings.position==="Top"?(a=i.margin.top+t+(o.height+t)*i.scrollBarModule.topScrollBarCount+(i.titleStyle.position==="Top"?r+i.titleStyle.border.width:0)+(i.subTitleStyle.position==="Top"?i.subTitleStyle.border.width+n:0),i.scrollBarModule.topScrollBarCount++):o.axis.scrollbarSettings.position==="Bottom"&&(a=i.availableSize.height-((o.height+t)*i.scrollBarModule.bottomScrollBarCount+o.height+i.margin.bottom+t+(i.titleStyle.position==="Bottom"?r+i.titleStyle.border.width:0)+(i.subTitleStyle.position==="Bottom"?i.subTitleStyle.border.width+n:0)),i.scrollBarModule.bottomScrollBarCount++):o.axis.scrollbarSettings.position==="Right"?(a=i.availableSize.width-((o.height+t)*i.scrollBarModule.rightScrollBarCount+o.height+t+i.margin.right+(i.titleStyle.position==="Right"?r+i.titleStyle.border.width:0)+(i.subTitleStyle.position==="Right"?i.subTitleStyle.border.width+n:0)),i.scrollBarModule.rightScrollBarCount++):o.axis.scrollbarSettings.position==="Left"&&(a=i.margin.left+t+(o.height+t)*i.scrollBarModule.leftScrollBarCount+(i.titleStyle.position==="Left"?r+i.titleStyle.border.width:0)+(i.subTitleStyle.position==="Left"?i.subTitleStyle.border.width+n:0),i.scrollBarModule.leftScrollBarCount++),a}function Oc(o,e,t,i,r){var n=i.element.style.transform;n&&(i.element.style.transform="");var s=new Ql(i.element.id),a,l=[],h,u,c,d,p={id:"rotate_text",x:i.initialClipRect.x,y:i.initialClipRect.y,"font-size":o.size||r.size,"font-style":o.fontStyle||r.fontStyle,"font-family":o.fontFamily,"font-weight":o.fontWeight||r.fontWeight,transform:"rotate("+t+", 0, 0)","text-anchor":"middle"};Gh(e)?(l=e.split("<br>"),a=l[0]):a=e;var f=s.createText(p,a);if(!i.delayRedraw&&!i.redraw&&!i.stockChart&&i.element.appendChild(i.svgObject),typeof l!="string"&&l.length>1)for(var v=1,m=l.length;v<m;v++)h=Ze(l[v],o,i.themeStyle.axisLabelFont).height,u=p.y+v*h,c=l[v],d=s.createTSpan({x:p.x,id:p.id,y:u},c),f.appendChild(d);var y=i.svgRenderer.createSvg({id:"AxisLabelMax_svg"});document.body.appendChild(y),y.appendChild(f);var S=f.getBoundingClientRect();if(n&&(i.element.style.transform=n),Ue(y),!i.delayRedraw&&!i.redraw&&!i.stockChart&&!i.pointsAdded&&Ue(i.svgObject),i.enableCanvas){var b=Ze(e,o,i.themeStyle.axisLabelFont).width,w=Ze(e,o,i.themeStyle.axisLabelFont).height,I=t*Math.PI/180,x=Math.abs(Math.cos(I)*b)+Math.abs(Math.sin(I)*w),M=Math.abs(Math.sin(I)*b)+Math.abs(Math.cos(I)*w);return new _t(x,M)}return new _t(S.right-S.left,S.bottom-S.top)}function ni(o){if(!o)return null;var e=typeof o=="string"?ce(o):o;e&&Ue(e)}function Jl(o,e){return Math.log(o)/Math.log(e)}function Pc(o,e,t,i,r,n,s,a,l){var h=document.getElementById(r),u=Ze(o,{fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"Regular"}),c=u.width+5;if(e=e+c>i?e-(c+15):e,l&&e<l.x&&(e=l.x),t=a?t-u.height/2:t+15,h)h.innerText=o,h.style.top=t.toString()+"px",h.style.left=(e+15).toString()+"px";else{h=Xe("div",{id:r,styles:"top:"+t.toString()+"px;left:"+(e+15).toString()+'px;background-color: rgb(255, 255, 255) !important; color:black !important; position:absolute;border:1px solid rgb(112, 112, 112); padding-left : 3px; padding-right : 2px;padding-bottom : 2px; padding-top : 2px; font-size:12px; font-family: "Segoe UI"'}),h.innerText=o,n.appendChild(h);var d=parseInt(h.style.left.replace("px",""),10);d<0&&(h.style.left="0px")}s&&setTimeout(function(){ni(r)},1500)}function nf(o,e){return o<e.max&&o>e.min}function Yh(o,e){return o<=e.max&&o>=e.min}function af(o,e){return e.valueType==="Logarithmic"?Jl(o,e.logBase):o}function ul(o,e,t,i){if(i.chart.zoomModule&&i.chart.zoomSettings.enableAnimation)return!0;var r=af(e.xValue,i.xAxis),n=o?af(o.xValue,i.xAxis):r,s=t?af(t.xValue,i.xAxis):r,a=Math.floor(i.xAxis.visibleRange.min),l=Math.ceil(i.xAxis.visibleRange.max);return n>=a&&n<=l||r>=a&&r<=l||s>=a&&s<=l||a>=n&&a<=s}function Qr(o){for(var e=0,t=0,i=o;t<i.length;t++){var r=i[t];e+=r}return e}function yo(o,e){return o.x+=e.left,o.y+=e.top,o.width-=e.left+e.right,o.height-=e.top+e.bottom,o}function QN(o,e){return o.x+=e.x,o.y+=e.y,o.width-=e.x+e.width,o.height-=e.y+e.height,o}function wn(o,e,t){var i=o*Math.PI/180;return new Je(Math.cos(i)*e+t.x,Math.sin(i)*e+t.y)}function Om(o){return o*(Math.PI/180)}function xN(o,e,t,i){for(var r=[],n=0;n<4;n++){var s=o[n],a=s.x-e,l=s.y-t,h=a*Math.cos(Om(i))-l*Math.sin(Om(i)),u=a*Math.sin(Om(i))+l*Math.cos(Om(i));s.x=h+e,s.y=u+t,r.push(new Je(s.x,s.y))}return r}function XN(o,e){var t=[o,e],i,r,n,s,a,l,h,u;for(s=0;s<t.length;s++){var c=t[s];for(a=0;a<c.length;a++){var d=(a+1)%c.length,p=c[a],f=c[d],v=new Je(f.y-p.y,p.x-f.x);for(i=r=void 0,l=0;l<o.length;l++)n=v.x*o[l].x+v.y*o[l].y,(g(i)||n<i)&&(i=n),(g(r)||n>r)&&(r=n);for(h=u=void 0,l=0;l<e.length;l++)n=v.x*e[l].x+v.y*e[l].y,(g(h)||n<h)&&(h=n),(g(u)||n>u)&&(u=n);if(r<h||u<i)return!1}}return!0}function GU(o,e,t,i,r){var n=wn(270,t,new Je(o,e)),s=wn(270,t,new Je(o+r/10,e));return"M "+o+" "+e+" L "+(o+t)+" "+e+" A "+t+" "+t+" 0 1 1 "+n.x+" "+n.y+" Z M "+(o+r/10)+" "+(e-i/10)+" L"+(o+t)+" "+(e-i/10)+" A "+t+" "+t+" 0 0 0 "+s.x+" "+s.y+" Z"}function YU(o,e){var t=Math.atan2(e.y-o.y,e.x-o.x);return t=t<0?6.283+t:t,t*(180/Math.PI)}function la(o,e){for(var t=[],i=0;i<=e-1;i++)t.push(o[i]);return t}function zn(o,e){var t=e.visibleRange,i=(o-t.min)/t.delta,r=e.isChart?e.isAxisInverse:e.isInversed;return r?1-i:i}function Bc(o,e,t,i,r,n){o=t.valueType==="Logarithmic"?Jl(o>1?o:1,t.logBase):o,e=i.valueType==="Logarithmic"?Jl(e>1?e:1,i.logBase):e,o+=t.valueType==="Category"&&t.labelPlacement==="BetweenTicks"&&n.type!=="Radar"?.5:0;var s=n.chart.radius*zn(e,i),a=QU($N(o,t),n.chart.primaryXAxis.startAngle);return{x:n.clipRect.width/2+n.clipRect.x+s*a.x,y:n.clipRect.height/2+n.clipRect.y+s*a.y}}function $h(o,e){e===void 0&&(e=!1);var t=["NaN","NaN"];return o.indexOf("_polygon")>-1?t=["NaN","NaN"]:o.indexOf("_Point_")>-1?t=o.split("_Series_")[1].split("_Point_"):o.indexOf("_shape_")>-1&&(!e||e&&o.indexOf("_legend_")===-1)?(t=o.split("_shape_"),t[0]="0"):o.indexOf("_text_")>-1&&(!e||e&&o.indexOf("_legend_")===-1)?(t=o.split("_text_"),t[0]="0"):o.indexOf("_datalabel_")>-1?(t=o.split("_datalabel_")[1].split("_g_"),t[0]=t[0].replace("Series_","")):o.indexOf("TextGroup")>-1?(t=o.split("TextGroup"),t[0]=t[1]):o.indexOf("ShapeGroup")>-1&&(t=o.split("ShapeGroup"),t[0]=t[1]),new Wh(parseInt(t[0],10),parseInt(t[1],10))}function QU(o,e){e=e<0?e+360:e;var t=Math.PI*(1.5-2*o);return t=t+e*Math.PI/180,{x:Math.cos(t),y:Math.sin(t)}}function $N(o,e){var t=e.visibleRange,i,r;return e.valueType!=="Category"?(i=t.max-(e.valueType==="DateTime"?e.dateTimeInterval:t.interval)-t.min,r=e.visibleLabels.length-1,i=i===0?1:i):(i=e.visibleLabels.length===1?1:e.visibleLabels[e.visibleLabels.length-1].value-e.visibleLabels[0].value,r=e.visibleLabels.length),e.isAxisInverse?(o-t.min)/i*(1-1/r):1-(o-t.min)/i*(1-1/r)}function XU(o,e,t,i,r,n){for(var s=5,a=e.isAxisOpposedPosition,l=o.enableRtl?"end":r?"start":"auto",h,u=o.availableSize.width,c,d,p,f=3,v,m,y=e.scrollbarSettings.enable||e.zoomingScrollBar&&e.zoomingScrollBar.svgObject?e.scrollBarHeight:0,S=o.enableRtl&&!r&&!e.isInversed||e.isInversed&&!(o.enableRtl&&!r),b=0;b<2;b++){if(h=Ze(b?S?e.startLabel:e.endLabel:S?e.endLabel:e.startLabel,e.labelStyle,o.themeStyle.axisLabelFont),r?(v=b?new Je(n.x-y,n.y+f):new Je(e.rect.x-y,n.y+n.height-f),d=n.x+(a?n.width+s+y:-(h.width+s+s+y)),p=n.y+(b?0:n.height-h.height-s),d+=d<0||u<d+h.width+s?a?-(h.width/2):h.width/2:0,m=IN(f,f,new Ae(d,p,h.width+s,h.height+s),v,s,!1,!1,!a,v.x,v.y+(b?-f:f))):(v=b?new Je(n.x+n.width-f,n.y+n.height+y):new Je(n.x+f,n.y+n.height+y),d=n.x+(b?n.width-h.width-s:0),p=a?n.y-h.height-10-y:n.y+n.height+s+y,m=IN(f,f,new Ae(d,p,h.width+s,h.height+s),v,s,a,!a,!1,v.x+(b?f:-f),v.y)),d=d+s/2,p=p+3*(h.height/4)+s/2,c=o.renderer.drawPath({id:o.element.id+"_Zoom_"+i+"_AxisLabel_Shape_"+b,fill:o.themeStyle.crosshairFill,width:2,color:o.themeStyle.crosshairFill,opacity:1,"stroke-dasharray":null,d:m},null),t.appendChild(c),o.theme==="Fluent"||o.theme==="FluentDark"){var w=o.element.id+"_shadow";c.setAttribute("filter",B.isIE?"":"url(#"+w+")");var I='<filter id="'+w+'" height="130%"><feGaussianBlur in="SourceAlpha" stdDeviation="3"/>';I+='<feOffset dx="3" dy="3" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="0.5"/>',I+='</feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';var x=o.renderer.createDefs();x.setAttribute("id",o.element.id+"SVG_tooltip_definition"),t.appendChild(x),x.innerHTML=I,c.setAttribute("stroke","#cccccc"),c.setAttribute("stroke-width","0.5")}hn(o.renderer,new gn(o.element.id+"_Zoom_"+i+"_AxisLabel_"+b,d,p,l,b?S?e.startLabel:e.endLabel:S?e.endLabel:e.startLabel),{color:o.themeStyle.crosshairLabelFont.color,fontFamily:"Segoe UI",fontWeight:"Regular",size:"11px"},o.themeStyle.crosshairLabelFont.color,t,null,null,null,null,null,null,null,null,null,null,o.themeStyle.crosshairLabelFont)}return t}function IN(o,e,t,i,r,n,s,a,l,h){var u="",c=t.x,d=t.y,p=t.x+t.width,f=t.y+t.height;return n?(u=u.concat("M "+c+" "+(d+e)+" Q "+c+" "+d+" "+(c+o)+" "+d),u=u.concat(" L "+(p-o)+" "+d+" Q "+p+" "+d+" "+p+" "+(d+e)),u=u.concat(" L "+p+" "+(f-e)+" Q "+p+" "+f+" "+(p-o)+" "+f),r!==0&&(u=u.concat(" L "+(i.x+r/2)+" "+f),u=u.concat(" L "+l+" "+(f+r)+" L "+(i.x-r/2)+" "+f)),i.x-r/2>c||r===0?u=u.concat(" L "+(c+o)+" "+f+" Q "+c+" "+f+" "+c+" "+(f-e)+" z"):u=u.concat(" L "+c+" "+(f+e)+" z")):s?(u=u.concat("M "+c+" "+(d+e)+" Q "+c+" "+d+" "+(c+o)+" "+d+" L "+(i.x-r/2)+" "+d),u=u.concat(" L "+l+" "+i.y),u=u.concat(" L "+(i.x+r/2)+" "+d),u=u.concat(" L "+(p-o)+" "+d+" Q "+p+" "+d+" "+p+" "+(d+e)),u=u.concat(" L "+p+" "+(f-e)+" Q "+p+" "+f+" "+(p-o)+" "+f),u=u.concat(" L "+(c+o)+" "+f+" Q "+c+" "+f+" "+c+" "+(f-e)+" z")):a?(u=u.concat("M "+c+" "+(d+e)+" Q "+c+" "+d+" "+(c+o)+" "+d),u=u.concat(" L "+(p-o)+" "+d+" Q "+p+" "+d+" "+p+" "+(d+e)+" L "+p+" "+(i.y-r/2)),u=u.concat(" L "+(p+r)+" "+h),u=u.concat(" L "+p+" "+(i.y+r/2)),u=u.concat(" L "+p+" "+(f-e)+" Q "+p+" "+f+" "+(p-o)+" "+f),u=u.concat(" L "+(c+o)+" "+f+" Q "+c+" "+f+" "+c+" "+(f-e)+" z")):(u=u.concat("M "+(c+o)+" "+d+" Q "+c+" "+d+" "+c+" "+(d+e)+" L "+c+" "+(i.y-r/2)),u=u.concat(" L "+(c-r)+" "+h),u=u.concat(" L "+c+" "+(i.y+r/2)),u=u.concat(" L "+c+" "+(f-e)+" Q "+c+" "+f+" "+(c+o)+" "+f),u=u.concat(" L "+(p-o)+" "+f+" Q "+p+" "+f+" "+p+" "+(f-e)),u=u.concat(" L "+p+" "+(d+e)+" Q "+p+" "+d+" "+(p-o)+" "+d+" z")),u}function Oi(o,e,t,i,r){return i===void 0&&(i=0),r===void 0&&(r=0),o>=t.x-i&&o<=t.x+t.width+i&&e>=t.y-r&&e<=t.y+t.height+r}function KN(o,e,t){var i=t.isAxisInverse?1-o/e:o/e;return i*t.visibleRange.delta+t.visibleRange.min}function ZN(o,e,t){var i=t.isAxisInverse?o/e:1-o/e;return i*t.visibleRange.delta+t.visibleRange.min}function qw(o,e){e===void 0&&(e=!1);var t=o.clipRect;e&&(o.type==="Polar"||o.type==="Radar")?o.drawType==="Scatter"?(t.x=o.xAxis.rect.x,t.y=o.yAxis.rect.y,t.width=o.xAxis.rect.width,t.height=o.yAxis.rect.height):(t.x=o.xAxis.rect.x/2,t.y=o.yAxis.rect.y/2,t.width=o.xAxis.rect.width,t.height=o.yAxis.rect.height):o.chart.requireInvertedAxis?(t.x=o.yAxis.rect.x,t.y=o.xAxis.rect.y,t.width=o.yAxis.rect.width,t.height=o.xAxis.rect.height):(t.x=o.xAxis.rect.x,t.y=o.yAxis.rect.y,t.width=o.xAxis.rect.width,t.height=o.yAxis.rect.height)}function $r(o){return o.substr(0,1).toLowerCase()+o.substr(1)}function JN(o,e){for(var t=Number.MAX_VALUE,i,r,n,s=[],a=0;a<e.length;a++){var l=e[a];if(i=[],l.visible&&(o.name===l.xAxisName||o.name==="primaryXAxis"&&l.xAxisName===null||o.name===l.chart.primaryXAxis.name&&!l.xAxisName))if(l.type.indexOf("Stacking")>-1&&s.indexOf(l.stackingGroup)===-1&&s.push(l.stackingGroup),i=l.points.map(function(d){return d.xValue}),i.sort(function(d,p){return d-p}),i.length===1){var h=e.length===1?2592e4:2592e6;n=o.valueType==="DateTime"&&l.xMin===l.xMax?l.xMin-h:l.xMin,r=i[0]-(g(n)?o.visibleRange.min:n),r!==0&&(t=Math.min(t,r))}else for(var u=0;u<i.length;u++){var c=i[u];u>0&&c&&(r=l.type.indexOf("Stacking")>-1&&o.valueType==="Category"?s.length:c-i[u-1],r!==0&&(t=Math.min(t,r)))}}return t===Number.MAX_VALUE&&(t=1),t}function Kw(o){var e;switch(o){case"Linear":e=Pr;break}return e}function Pr(o,e,t,i){return-t*Math.cos(o/i*(Math.PI/2))+t+e}function zc(o,e,t,i,r,n,s){var a=!!i.accumulation;o.style.visibility="hidden";var l=o.getAttribute("transform");new It({}).animate(o,{duration:t,delay:e,progress:function(h){if(h.timeStamp>h.delay&&(h.element.style.visibility="visible"),a?h.element.id.indexOf("_datalabel_Series_")>-1:h.element.parentElement.parentElement.id.indexOf("DataLabel")>-1&&!(i.chart.stackLabels.visible&&o.getAttribute("data-collide"))){h.element.style.visibility="visible";var u=a?i.opacity:i.marker.dataLabel.opacity,c=h.timeStamp/500*u;a?o.setAttribute("opacity",Math.min(c,u).toString()):(i.textElement.setAttribute("opacity",Math.min(c,u).toString()),i.shapeElement.setAttribute("opacity",Math.min(c,u).toString()))}},end:function(){var h=document.getElementById(i.chart.element.id+"_Annotation_Collections");h&&i.type!=="Line"&&(h.style.visibility="visible"),(o.parentElement.parentElement.id.indexOf("DataLabel")>-1||o.id.indexOf("_datalabel_Series_")>-1)&&(a?o.setAttribute("opacity",i.opacity.toString()):(i.textElement.setAttribute("opacity",i.marker.dataLabel.opacity.toString()),i.shapeElement.setAttribute("opacity",i.marker.dataLabel.opacity.toString()))),i.chart.stackLabels.visible&&o.getAttribute("data-collide")||(o.style.visibility=""),o.setAttribute("transform",l||""),(i.type==="Scatter"||i.type==="Bubble")&&!s&&r===i.points.length-1&&i.chart.trigger("animationComplete",{series:i.chart.isBlazor?{}:i})}})}function $U(o,e,t,i,r){var n=function(s){o.setAttribute("x",s.x+""),o.setAttribute("y",s.y+""),o.setAttribute("width",s.width+""),o.setAttribute("height",s.height+"")};new It({}).animate(Xe("div"),{duration:t,delay:e,progress:function(s){n(new Ae(Pr(s.timeStamp,r.x,i.x-r.x,s.duration),Pr(s.timeStamp,r.y,i.y-r.y,s.duration),Pr(s.timeStamp,r.width,i.width-r.width,s.duration),Pr(s.timeStamp,r.height,i.height-r.height,s.duration)))},end:function(){n(i)}})}function Qm(o,e,t,i,r){if(!t||!i&&!o)return null;var n=300;g(r)||(n=r);var s=i||o.getAttribute("d"),a=s.split(/(?=[LMCZAQ])/),l=e.split(/(?=[LMCZAQ])/),h,u=[],c=[],d,p;o.setAttribute("d",s),new It({}).animate(Xe("div"),{duration:n,progress:function(f){h="",a.map(function(v,m){if(u=v.split(" "),c=l[m]?l[m].split(" "):u,u[0]==="Z"?h+="Z ":u[0]===""?h="":h+=u[0]+" "+Pr(f.timeStamp,+u[1],+c[1]-+u[1],f.duration)+" "+Pr(f.timeStamp,+u[2],+c[2]-+u[2],f.duration)+" ",u[0]==="C"||u[0]==="Q")for(d=3,p=u[0]==="Q"?4:6;d<p;)h+=Pr(f.timeStamp,+u[d],+c[d]-+u[d],f.duration)+" "+Pr(f.timeStamp,+u[++d],+c[d]-+u[d],f.duration)+" ",++d;u[0]==="A"&&(h+="0 0 1 "+Pr(f.timeStamp,+u[6],+c[6]-+u[6],f.duration)+" "+Pr(f.timeStamp,+u[7],+c[7]-+u[7],f.duration)+" ")}),o.setAttribute("d",h)},end:function(){o.setAttribute("d",e)}})}function ha(o,e,t,i,r,n){if(!t||!i&&!o)return null;var s=300;g(r)||(s=r);var a=i||o.getAttribute("d"),l=e,h="";o.setAttribute("d",a),new It({}).animate(Xe("div"),{duration:s,progress:function(u){h="";for(var c=a.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/g),d=l.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/g),p=Math.max(c.length,d.length),f=0;f<p;f++){for(var v=c[f]||"",m=d[f]||"",y=v.trim().split(/\s+/),S=m.trim().split(/\s+/),b=[],w=1;w<y.length;w++){var I=parseFloat(y[w]),x=parseFloat(S[w]);if(!isNaN(I)&&!isNaN(x)&&y.length===S.length){var M=Pr(u.timeStamp,I,x-I,s);p-1,b.push(M)}}y.length!==S.length?h+="L":h+=y[0],h+=" "+b.join(" "),h+=" "}o.setAttribute("d",h)},end:function(){o.setAttribute("d",n||e)}})}function Kh(o,e,t,i){i===void 0&&(i="drawClipPath");var r=Va(o,e.id,e,t);if(r){var n=t.createDefs();return n.appendChild(r),n}else return t[i](e)}function Gw(o,e,t,i,r){var n={cancel:!1,name:vN,axis:r,text:t,value:e,labelStyle:i};if(o.trigger(vN,n),!n.cancel){var s=n.text.indexOf("<br>")!==-1,a=r.enableTrim?s?oW(r.maximumLabelWidth,n.text,r.labelStyle,o.themeStyle.axisLabelFont):js(r.maximumLabelWidth,n.text,r.labelStyle,o.enableRtl,o.themeStyle.axisLabelFont):n.text;r.visibleLabels.push(new WU(a,n.value,n.labelStyle,n.text))}}function Bs(o){return o.minimum!=null&&o.maximum!=null}function sf(o){return o.zoomFactor<1&&o.zoomPosition>=0}function eF(o,e){var t=e.orientation==="Horizontal"?o.width:o.height;if(g(e.desiredIntervals)){var i=(e.orientation==="Horizontal"?.533:1)*e.maximumLabels;return i=Math.max(t*(i/100),1),i}else return e.desiredIntervals}function Zw(o,e,t,i,r){new It({}).animate(o,{duration:t,delay:e,name:i,progress:function(n){n.element.style.visibility="visible"},end:function(n){r?Ue(n.element):n.element.style.visibility="visible"}})}function zs(o,e,t,i,r,n,s,a,l,h){var u=s||new Ql(""),c=KU(o,t,e,r,i,l,h),d=u["draw"+c.functionName](c.renderOption,a?new Int32Array([a.x,a.y]):null);return d}function KU(o,e,t,i,r,n,s){var a,l="Path",h=n,u=h&&t==="Circle"?e.width-2:e.width,c=h&&t==="Circle"?e.height-2:e.height,d=h?s.targetWidth:0,p=o.x,f=o.y,v=o.y+-c/2,m=o.x+-u/2,y=72,S,b;switch(t){case"Bubble":case"Circle":l="Ellipse",ht(i,{rx:u/2,ry:c/2,cx:p,cy:f});break;case"Plus":a="M "+m+" "+f+" L "+(p+u/2)+" "+f+" M "+p+" "+(f+c/2)+" L "+p+" "+(f+-c/2),ht(i,{d:a});break;case"Cross":a="M "+m+" "+(f+-c/2)+" L "+(p+u/2)+" "+(f+c/2)+" M "+m+" "+(f+c/2)+" L "+(p+u/2)+" "+(f+-c/2),ht(i,{d:a});break;case"Multiply":a="M "+(p-d)+" "+(f-d)+" L "+(p+d)+" "+(f+d)+" M "+(p-d)+" "+(f+d)+" L "+(p+d)+" "+(f-d),ht(i,{d:a,stroke:i.fill});break;case"HorizontalLine":a="M "+m+" "+f+" L "+(p+u/2)+" "+f,ht(i,{d:a});break;case"VerticalLine":a="M "+p+" "+(f+c/2)+" L "+p+" "+(f+-c/2),ht(i,{d:a});break;case"Diamond":a="M "+m+" "+f+" L "+p+" "+(f+-c/2)+" L "+(p+u/2)+" "+f+" L "+p+" "+(f+c/2)+" L "+m+" "+f+" z",ht(i,{d:a});break;case"ActualRect":a="M "+m+" "+(f+-c/8)+" L "+(p+d)+" "+(f+-c/8)+" L "+(p+d)+" "+(f+c/8)+" L "+m+" "+(f+c/8)+" L "+m+" "+(f+-c/8)+" z",ht(i,{d:a});break;case"TargetRect":a="M "+(m+d)+" "+(f+-c/2)+" L "+(p+d/2)+" "+(f+-c/2)+" L "+(p+d/2)+" "+(f+c/2)+" L "+(m+d)+" "+(f+c/2)+" L "+(m+d)+" "+(f+-c/2)+" z",ht(i,{d:a});break;case"Rectangle":case"Hilo":case"HiloOpenClose":case"Candle":case"Waterfall":case"BoxAndWhisker":case"StepArea":case"RangeStepArea":case"StackingStepArea":case"Square":case"Flag":a="M "+m+" "+(f+-c/2)+" L "+(p+u/2)+" "+(f+-c/2)+" L "+(p+u/2)+" "+(f+c/2)+" L "+m+" "+(f+c/2)+" L "+m+" "+(f+-c/2)+" z",ht(i,{d:a});break;case"Pyramid":case"Triangle":a="M "+m+" "+(f+c/2)+" L "+p+" "+(f+-c/2)+" L "+(p+u/2)+" "+(f+c/2)+" L "+m+" "+(f+c/2)+" z",ht(i,{d:a});break;case"Funnel":case"InvertedTriangle":a="M "+(p+u/2)+" "+(f-c/2)+" L "+p+" "+(f+c/2)+" L "+(p-u/2)+" "+(f-c/2)+" L "+(p+u/2)+" "+(f-c/2)+" z",ht(i,{d:a});break;case"Pentagon":for(var w=0;w<=5;w++)S=u/2*Math.cos(Math.PI/180*(w*y)),b=c/2*Math.sin(Math.PI/180*(w*y)),w===0?a="M "+(p+S)+" "+(f+b)+" ":a=a.concat("L "+(p+S)+" "+(f+b)+" ");a=a.concat("Z"),ht(i,{d:a});break;case"Image":l="Image",ht(i,{href:r,height:c,width:u,x:m,y:v});break;case"Star":{for(var I=5,x=Math.min(u,c)/2,M=x/2,D=Math.PI/I,A="",w=0;w<2*I;w++){var L=w%2===0?x:M,T=p+L*Math.cos(w*D-Math.PI/2),k=f+L*Math.sin(w*D-Math.PI/2);A+=(w===0?"M":"L")+T+","+k}A+="Z",ht(i,{d:A});break}}return i=aW(o,new _t(u,c),t,i).renderOption,{renderOption:i,functionName:l}}function ce(o){return document.getElementById(o)}function ZU(o){var e=null;try{typeof o!="function"&&document.querySelectorAll(o).length?e=wt(document.querySelector(o).innerHTML.trim()):e=wt(o)}catch{e=wt(o)}return e}function JU(o,e,t,i,r,n,s,a,l,h){var u=o.getBoundingClientRect();e.accumulationDataLabelModule.calculateLabelSize(t,o,n,i,r,s,a,l,h,u,!0)}function eW(o,e,t,i,r,n){var s=document.getElementById(e.element.id+"_Series_"+(i.index===void 0?i.category:i.index)+"_DataLabelCollections");s&&(t.index===0&&(e.dataLabelCollections=[]),e.dataLabelModule.calculateTemplateLabelSize(s,o,t,i,i.marker.dataLabel,r,i.clipRect,n,!0))}function tF(o,e,t,i,r,n,s,a,l,h,u,c,d,p,f){var v=ZU(t),m;try{var y="Blazor",S=window[y]?s?r:{point:r}:{chart:i,series:n,point:r},b=s?s+"_template":"template",w=v?v(S,i,b,s||o.id.replace(/[^a-zA-Z0-9]/g,"")):[];if(w.length){m=Array.prototype.slice.call(w);for(var I=m.length,x=0;x<I;x++)o.appendChild(m[x])}var M=void 0;i.getModuleName()==="accumulationchart"?(M=JU.bind(this,o,i,h,u,l,u[e],c,d,p,f),i.isReact&&i.renderReactTemplates(M)):i.getModuleName()==="chart"&&(M=r&&n?eW.bind(this,o,i,r,n,a,f):M,i.isReact&&i.renderReactTemplates(M))}catch{return o}return o}function iF(o,e){var t="";return t="font-size:"+(o.size||e.size)+"; font-style:"+(o.fontStyle||e.fontStyle)+"; font-weight:"+(o.fontWeight||e.fontWeight)+"; font-family:"+o.fontFamily+";opacity:"+o.opacity+"; color:"+o.color+";",t}function rF(o,e,t){e===void 0&&(e=!1),t||document.body.appendChild(o);var i=o.getBoundingClientRect();return e?Ue(o):t||ni(o.id),i}function tW(o,e){for(var t,i=0,r=o.length;i<r;i++)if(o[i].id.indexOf(e)>-1){t=o[i];continue}return t}function jn(o,e,t,i,r){o=t.valueType==="Logarithmic"?Jl(o>0?o:Math.pow(t.logBase,t.visibleRange.min),t.logBase):o,e=i.valueType==="Logarithmic"?Jl(e>0?e:Math.pow(i.logBase,i.visibleRange.min),i.logBase):e,o=zn(o,t),e=zn(e,i);var n=r?t.rect.height:t.rect.width,s=r?i.rect.width:i.rect.height,a=r?e*s:o*n,l=r?(1-o)*n:(1-e)*s;return new Je(a,l)}function vt(o,e,t,i,r,n,s,a,l,h,u,c,d,p,f,v,m){if(r===void 0&&(r=!1),n===void 0&&(n="x"),s===void 0&&(s="y"),h===void 0&&(h=!1),u===void 0&&(u=!1),c===void 0&&(c=null),p===void 0&&(p=!1),f===void 0&&(f=0),o)return null;var y=p?null:e.querySelector("#"+t.id),S=y||ce(t.id),b=t,w=g(d)?300:d;if(i&&r&&S)if(a=a||(S.tagName==="DIV"?new Je(+S.style[n].split("px")[0],+S.style[s].split("px")[0]):new Je(+S.getAttribute(n),+S.getAttribute(s))),l&&l!=="undefined")Qm(t,t.getAttribute("d"),i,l,w);else if(u&&c)$U(b,0,w,new Ae(+S.getAttribute("x"),+S.getAttribute("y"),+S.getAttribute("width"),+S.getAttribute("height")),c);else{var I=b.tagName==="DIV"?new Je(+b.style[n].split("px")[0],+b.style[s].split("px")[0]):new Je(+b.getAttribute(n),+b.getAttribute(s)),x=S.getAttribute("transform");lW(b,w,a,I,n,s,f,v,m!==void 0?new Je(m.match(/\d+/g).map(Number)[0],m.match(/\d+/g).map(Number)[1]):x?new Je(parseFloat(x.split(",")[1]),parseFloat(x.split(",")[2])):new Je(0,0),m!==void 0)}else i&&r&&!S&&h&&Zw(b,0,600,"FadeIn");y?e.replaceChild(b,S):e.appendChild(b)}function Uw(o,e,t,i,r){var n=Math.abs(o-t),s=Math.abs(e-i),a=Math.max(MN(Math.min(o,t),n,r.x,r.width),r.x),l=Math.max(MN(Math.min(e,i),s,r.y,r.height),r.y);return new Ae(a,l,Math.min(n,r.width),Math.min(s,r.height))}function MN(o,e,t,i){return o<t?o=t:o+e>i+t&&(o=i+t-e),o}function iW(o,e,t){var i=e.marker.dataLabel.format?e.marker.dataLabel.format:e.yAxis.labelFormat,r=[],n=i.match("{value}")!==null;switch(e.seriesType){case"XY":e.chart.chartAreaType==="PolarRadar"?e.drawType.indexOf("Stacking")!==-1?(e.yAxis.valueType==="Logarithmic"&&af(e.stackedValues.endValues[o.index],e.yAxis)||Yh(e.stackedValues.endValues[o.index],e.yAxis.visibleRange))&&r.push(o.text||o.yValue.toString()):(e.yAxis.valueType==="Logarithmic"&&af(o.yValue,e.yAxis)||Yh(o.yValue,e.yAxis.visibleRange))&&r.push(o.text||o.yValue.toString()):r.push(o.text||o.yValue.toString());break;case"HighLow":r.push(o.text||Math.max(o.high,o.low).toString()),r.push(o.text||Math.min(o.high,o.low).toString());break;case"HighLowOpenClose":r.push(o.text||Math.max(o.high,o.low).toString()),r.push(o.text||Math.min(o.high,o.low).toString()),r.push(o.text||Math.max(o.open,o.close).toString()),r.push(o.text||Math.min(o.open,o.close).toString());break;case"BoxPlot":r.push(o.text||o.median.toString()),r.push(o.text||o.maximum.toString()),r.push(o.text||o.minimum.toString()),r.push(o.text||o.upperQuartile.toString()),r.push(o.text||o.lowerQuartile.toString());for(var s=0,a=o.outliers;s<a.length;s++){var l=a[s];r.push(o.text||l.toString())}break}if((i||t.useGroupingSeparator)&&!o.text){e.yAxis.format=t.intl.getNumberFormat({format:n?"":i,useGrouping:t.useGroupingSeparator});for(var h=0;h<r.length;h++)r[h]=n?i.replace("{value}",e.yAxis.format(parseFloat(r[h]))):e.yAxis.format(parseFloat(r[h]))}return r}function nF(o){window.clearInterval(o)}function kc(o,e,t){var i=new Ae(o.x+t.x,o.y+t.y,o.width,o.height),r=e.some(function(n){return i.x<n.x+n.width&&i.x+i.width>n.x&&i.y<n.y+n.height&&i.height+i.y>n.y});return r}function $n(o,e){return o.x<e.x+e.width&&o.x+o.width>e.x&&o.y<e.y+e.height&&o.height+o.y>e.y}function rW(o,e){return o.x<=e.x&&o.x+o.width>=e.x+e.width&&o.y<=e.y&&o.height+o.y>=e.y+e.height}function Rm(o,e,t){return new Ae(o.x-e.width/2-t.left,o.y-e.height/2-t.top,e.width+t.left+t.right,e.height+t.top+t.bottom)}function sF(o){return"#"+Rc(o.r)+Rc(o.g)+Rc(o.b)}function Rc(o){var e=o.toString(16);return e.length===1?"0"+e:e}function hf(o){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(o);return e?new Wm(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)):new Wm(255,255,255)}function Bn(o){o=o==="transparent"?"white":o;var e=document.getElementById("chartmeasuretext");e||(e=Xe("text",{id:"chartmeasuretext"}),document.body.appendChild(e)),e.style.color=o,o=window.getComputedStyle(e).color,e.style.color="";var t;if((o.indexOf("rgb")===0||o.indexOf("hsl")===0)&&(o=o.replace(/\s/g,"").replace(/[()]/g,""),t=o.slice(3).split(",")),t&&t.length){var i=t.map(function(a){return parseInt(a,10)}),r=i[0],n=i[1],s=i[2];return sF(new Wm(r,n,s))}return""}function nW(o){if(o.indexOf("rgba(")===0||o.indexOf("rgb(")===0){var e=o.substring(o.indexOf("(")+1,o.lastIndexOf(")")).split(",");if(e.length===3||e.length===4)return e.every(function(i){var r=parseFloat(i);return!isNaN(r)&&r>=0&&r<=255})}else if(o.indexOf("#")===0){var t=o.substring(1);return(t.length===3||t.length===6)&&/^[0-9A-Fa-f]{3,6}$/.test(t)}return!1}function sW(o,e){o=Bn(o),o=o.replace(/[^0-9a-f]/gi,""),o.length<6&&(o=o[0]+o[0]+o[1]+o[1]+o[2]+o[2]),e=e||0;for(var t="#",i,r=0;r<3;r++)i=parseInt(o.substr(r*2,2),16),i=Math.round(Math.min(Math.max(0,i+i*e),255)),t+=("00"+i.toString(16)).substr(i.toString(16).length);return t}function Uh(o,e){var t=hf(o);return t.r=parseInt(Math.floor(t.r*e).toString(),10),t.g=parseInt(Math.floor(t.g*e).toString(),10),t.b=parseInt(Math.floor(t.b*e).toString(),10),"#"+Rc(t.r).toUpperCase()+Rc(t.g).toUpperCase()+Rc(t.b).toUpperCase()}function aW(o,e,t,i){var r=10,n="",s=2,a=e.height,l=e.width,h=o.x,u=o.y;switch(t){case"MultiColoredLine":case"Line":case"StackingLine":case"StackingLine100":n="M "+(h+-l*(3/4))+" "+u+" L "+(h+l*(3/4))+" "+u,ht(i,{d:n});break;case"StepLine":i.fill="transparent",n="M "+(h+-l/2-r/4)+" "+(u+a/2)+" L "+(h+-l/2+l/10)+" "+(u+a/2)+" L "+(h+-l/2+l/10)+" "+u+" L "+(h+-l/10)+" "+u+" L "+(h+-l/10)+" "+(u+a/2)+" L "+(h+l/5)+" "+(u+a/2)+" L "+(h+l/5)+" "+(u+-a/2)+" L "+(h+l/2)+" "+(u+-a/2)+"L "+(h+l/2)+" "+(u+a/2)+" L"+(h+l/2+r/4)+" "+(u+a/2),ht(i,{d:n});break;case"UpArrow":i.fill=i.stroke,i.stroke="transparent",n="M "+(h+-l/2)+" "+(u+a/2)+" L "+h+" "+(u-a/2)+" L "+(h+l/2)+" "+(u+a/2)+"L "+(h+l/2-s)+" "+(u+a/2)+" L "+h+" "+(u-a/2+2*s)+"L"+(h-l/2+s)+" "+(u+a/2)+" Z",ht(i,{d:n});break;case"DownArrow":n="M "+(h-l/2)+" "+(u-a/2)+" L "+h+" "+(u+a/2)+" L "+(h+l/2)+" "+(u-a/2)+"L "+(h+l/2-s)+" "+(u-a/2)+" L "+h+" "+(u+a/2-2*s)+"L"+(h-l/2+s)+" "+(u-a/2)+" Z",ht(i,{d:n});break;case"RightArrow":n="M "+(h+-l/2)+" "+(u-a/2)+" L "+(h+l/2)+" "+u+" L "+(h+-l/2)+" "+(u+a/2)+" L "+(h+-l/2)+" "+(u+a/2-s)+" L "+(h+l/2-2*s)+" "+u+" L"+(h+-l/2)+" "+(u-a/2+s)+" Z",ht(i,{d:n});break;case"LeftArrow":i.fill=i.stroke,i.stroke="transparent",n="M "+(h+l/2)+" "+(u-a/2)+" L "+(h+-l/2)+" "+u+" L "+(h+l/2)+" "+(u+a/2)+" L "+(h+l/2)+" "+(u+a/2-s)+" L "+(h+-l/2+2*s)+" "+u+" L"+(h+l/2)+" "+(u-a/2+s)+" Z",ht(i,{d:n});break;case"Column":case"Pareto":case"StackingColumn":case"StackingColumn100":case"RangeColumn":case"Histogram":n="M "+(h-3*(l/5))+" "+(u-a/5)+" L "+(h+3*(-l/10))+" "+(u-a/5)+" L "+(h+3*(-l/10))+" "+(u+a/2)+" L "+(h-3*(l/5))+" "+(u+a/2)+" Z M "+(h+-l/10-l/20)+" "+(u-a/4-r/2)+" L "+(h+l/10+l/20)+" "+(u-a/4-r/2)+" L "+(h+l/10+l/20)+" "+(u+a/2)+" L "+(h+-l/10-l/20)+" "+(u+a/2)+" Z M "+(h+3*(l/10))+" "+u+" L "+(h+3*(l/5))+" "+u+" L "+(h+3*(l/5))+" "+(u+a/2)+" L "+(h+3*(l/10))+" "+(u+a/2)+" Z",ht(i,{d:n});break;case"Bar":case"StackingBar":case"StackingBar100":n="M "+(h+-l/2+-r/4)+" "+(u-3*(a/5))+" L "+(h+3*(l/10))+" "+(u-3*(a/5))+" L "+(h+3*(l/10))+" "+(u-3*(a/10))+" L "+(h-l/2+-r/4)+" "+(u-3*(a/10))+" Z M "+(h+-l/2+-r/4)+" "+(u-a/5+r/20)+" L "+(h+l/2+r/4)+" "+(u-a/5+r/20)+" L "+(h+l/2+r/4)+" "+(u+a/10+r/20)+" L "+(h-l/2+-r/4)+" "+(u+a/10+r/20)+" Z M "+(h-l/2+-r/4)+" "+(u+a/5+r/10)+" L "+(h+-l/4)+" "+(u+a/5+r/10)+" L "+(h+-l/4)+" "+(u+a/2+r/10)+" L "+(h-l/2+-r/4)+" "+(u+a/2+r/10)+" Z",ht(i,{d:n});break;case"Spline":i.fill="transparent",n="M "+(h-l/2)+" "+(u+a/5)+" Q "+h+" "+(u-a)+" "+h+" "+(u+a/5)+" M "+h+" "+(u+a/5)+" Q "+(h+l/2)+" "+(u+a/2)+" "+(h+l/2)+" "+(u-a/2),ht(i,{d:n});break;case"Area":case"MultiColoredArea":case"RangeArea":case"StackingArea":case"StackingArea100":n="M "+(h-l/2-r/4)+" "+(u+a/2)+" L "+(h+-l/4+-r/8)+" "+(u-a/2)+" L "+h+" "+(u+a/4)+" L "+(h+l/4+r/8)+" "+(u+-a/2+a/4)+" L "+(h+a/2+r/4)+" "+(u+a/2)+" Z",ht(i,{d:n});break;case"SplineArea":case"SplineRangeArea":n="M "+(h-l/2)+" "+(u+a/5)+" Q "+h+" "+(u-a)+" "+h+" "+(u+a/5)+" Z M "+h+" "+(u+a/5)+" Q "+(h+l/2)+" "+(u+a/2)+" "+(h+l/2)+" "+(u-a/2)+"  Z",ht(i,{d:n});break;case"Pie":case"Doughnut":{i.stroke="transparent";var c=Math.min(a,l)/2;n=GU(h,u,c,a,l),ht(i,{d:n});break}}return{renderOption:i}}function js(o,e,t,i,r){var n=e,s=Ze(e,t,r).width;if(s>o){for(var a=e.length,l=a-1;l>=0;--l)if(n=i?"..."+e.substring(0,l):e.substring(0,l)+"...",s=Ze(n,t,r).width,s<=o)return n}return n}function oW(o,e,t,i){for(var r=[],n=e.split("<br>"),s=0;s<n.length;s++){e=n[s];var a=Ze(e,t,i).width;if(a>o){for(var l=e.length,h=l-1;h>=0;--h)if(e=e.substring(0,h)+"...",a=Ze(e,t,i).width,a<=o){r.push(e);break}}else r.push(e)}return r}function Ni(o,e){return o!=null?o.indexOf("%")!==-1?e/100*parseInt(o,10):parseInt(o,10):null}function Va(o,e,t,i){if(!o)return null;var r=ce(e);return r&&t&&i.setElementAttributes(t,r.tagName==="clipPath"?r.childNodes[0]:r),r}function lW(o,e,t,i,r,n,s,a,l,h){r===void 0&&(r="x"),n===void 0&&(n="y"),s===void 0&&(s=0),a===void 0&&(a=new Je(0,0)),l===void 0&&(l=new Je(0,0));var u=o.tagName==="DIV",c=function(d,p,f,v){u?(o.style[r]=d+"px",o.style[n]=p+"px"):(o.setAttribute(r,d+""),o.setAttribute(n,p+""),s&&a.x&&a.y&&l.x&&l.y&&f&&v&&o.setAttribute("transform","rotate("+s+","+f+","+v+")"),h&&o.setAttribute("transform","translate("+f+","+v+")"))};c(t.x,t.y,l.x,l.y),new It({}).animate(Xe("div"),{duration:e,progress:function(d){c(Pr(d.timeStamp,t.x,i.x-t.x,d.duration),Pr(d.timeStamp,t.y,i.y-t.y,d.duration),Pr(d.timeStamp,l.x,a.x-l.x,d.duration),Pr(d.timeStamp,l.y,a.y-l.y,d.duration))},end:function(){c(i.x,i.y,a.x,a.y)}})}function hW(o,e,t,i,r){if(o&&t&&i){var n=function(s){return r?r.replace("{value}",s.toString()):s.toString()};new It({}).animate(Xe("div"),{duration:e,progress:function(s){o.style.animation="";var a=s.timeStamp/s.duration,l=t+(i-t)*a;t%1!==0||i%1!==0?l=parseFloat(l.toFixed(1)):l=Math.round(l),o.textContent=n(l)},end:function(){o.textContent=n(i)}})}}function hn(o,e,t,i,r,n,s,a,l,h,u,c,d,p,f,v,m,y){n===void 0&&(n=!1),l===void 0&&(l=!1);var S={},b,w,I,x,M=0,D,A=0;if(e.text.length>1&&f){for(var L=0,T=e.text.length;L<T;L++)A=Math.max(A,Ze(e.text[L],t,v).width);M=Ze(e.text[0],t,v).width}D=e.text.length>1&&f?e.x+A/2-M/2:e.x,S={id:e.id,x:D,y:e.y,fill:i||"black","font-size":t.size||v.size,"font-style":t.fontStyle||v.fontStyle,"font-family":t.fontFamily||v.fontFamily,"font-weight":t.fontWeight||v.fontWeight,"text-anchor":e.anchor,labelRotation:e.labelRotation,transform:e.transform,opacity:t.opacity,"dominant-baseline":e.baseLine};var k=typeof e.text=="string"?e.text:n?e.text[e.text.length-1]:e.text[0],F=u?u.x:0,R=u?u.y:0,N=o.createText(S,k,F,R);if(typeof e.text!="string"&&e.text.length>1)for(var L=1,T=e.text.length;L<T;L++)w=Ze(e.text[L],t,v).height,M=Ze(e.text[L],t,v).width,I=e.y+(n?-(L*w):L*w),D=f?e.x+A/2-M/2:e.x,x=n?e.text[e.text.length-(L+1)]:e.text[L],p?b=o.createText(S,x,null,null,I,!0):(b=o.createTSpan({x:D,id:e.id,y:I},x),N.appendChild(b));return d||vt(o instanceof Vw,r,N,s,a,"x","y",null,null,l,!1,null,h,!1,e.labelRotation,m,y),N}function aF(o){var e=o.element.clientWidth||o.element.offsetWidth,t=o.element.clientHeight;o.stockChart&&(e=o.stockChart.availableSize.width,t=o.stockChart.availableSize.height);var i=450,r;if(o.getModuleName()==="rangeNavigator"){var n=o,s=n.tooltip.enable?35:0,a=n.periodSelectorSettings.periods.length?n.periodSelectorSettings.height:0;r=n.margin.top+n.margin.bottom+s;var l=Ze("tempString",n.labelStyle,n.themeStyle.axisLabelFont).height,h=15;if(i=(o.series.length?B.isDevice?80:120:(n.enableGrouping?40+h+l:40)+r)+a,n.disableRangeSelector&&(i=a),o.stockChart&&o.stockChart.chart&&o.stockChart.chart.axisCollections[1].labelPosition==="Outside"){var u=o.stockChart.chart.axisCollections[1].labelPadding+o.stockChart.chart.axisCollections[1].lineStyle.width*.5;o.width=(o.stockChart.availableSize.width-(o.stockChart.chart.axisCollections[1].maxLabelSize.width+u)).toString()}}o.availableSize=new _t(Ni(o.width,e)||e||600,Ni(o.height,t||i)||t||i),o.getModuleName()==="chart"&&(o.scaleX=1,o.scaleY=1)}function oF(o){o.canvasRender=new Vw(o.element.id),o.renderer=o.enableCanvas?o.canvasRender:new Ql(o.element.id),aF(o),o.stockChart&&o.getModuleName()==="chart"?o.svgObject=o.stockChart.chartObject:o.stockChart&&o.getModuleName()==="rangeNavigator"&&o.stockChart.selectorObject?o.svgObject=o.stockChart.selectorObject:o.enableCanvas?o.svgObject=o.renderer.createCanvas({id:o.element.id+"_canvas",width:o.availableSize.width,height:o.availableSize.height}):o.svgObject=o.renderer.createSvg({id:o.element.id+"_svg",width:o.availableSize.width,height:o.availableSize.height}),o.enableCanvas&&(o.renderer.ctx.direction=o.enableRtl?"rtl":"ltr")}function jc(o,e,t,i,r){var n=[];switch(e.textOverflow){case"Wrap":n=ol(o,t,e,i,o.indexOf(" ")<0?!0:null,null,r);break;case"Trim":n.push(js(t,o,e,i,r));break;default:n.push(o);break}return n}function Qh(o,e){var t;return e.textAlignment==="Near"?t=o.x:e.textAlignment==="Center"?t=o.x+o.width/2:t=o.x+o.width,t}function ol(o,e,t,i,r,n,s,a){if(r)return uW(o,e,t,s);for(var l=o.split(" "),h="",u=[],c,d=Ze("chartMeasureText",t,s).height,p=0,f=0,v=l.length;f<v;f++){if(c=l[f],Ze(h.concat(h===""?"":" "+c),t,s).width<e)h=h.concat((h===""?"":" ")+c);else if(h!==""){if(p+=d,a&&p>a)return u[u.length-1]+="...",u;u.push(n?h:js(e,h,t,i,s)),h=c}else{if(p+=d,a&&p>a)return u[u.length-1]+="...",u;u.push(n?c:js(e,c,t,i,s))}if(h&&f===v-1){if(p+=d,a&&p>a)return u[u.length-1]+="...",u;u.push(n?h:js(e,h,t,i,s))}}return u}function uW(o,e,t,i){var r=Ze(o,t,i).width,n=[];if(r>e){for(var s="",a=0,l=1;l<o.length;)s=o.substring(a,l),r=Ze(s,t,i).width,r<e?l++:r===e?(a=l,n.push(s),l++,s=""):r>e&&(s=s.slice(0,-1),a=l-1,n.push(s),s="");s.length>0&&n.push(s)}else n.push(o);return n}function DN(o,e){for(var t=o.replace(e," "),i=o.match(e),r=" ",n=" ",s=0,a={0:"\u2080",1:"\u2081",2:"\u2082",3:"\u2083",4:"\u2084",5:"\u2085",6:"\u2086",7:"\u2087",8:"\u2088",9:"\u2089"},l={0:"\u2070",1:"\xB9",2:"\xB2",3:"\xB3",4:"\u2074",5:"\u2075",6:"\u2076",7:"\u2077",8:"\u2078",9:"\u2079"},h=0;h<=t.length-1;h++)if(t[h]===" "){r=e===Um?i[s].replace(/~/g,""):i[s].replace(/\^/g,"");for(var u=0;u<r.length;u++)n+=e===Um?a[r[u]]:l[r[u]];s++}else n+=t[h];return n.trim()}function Xm(o){for(var e=0;e<o.annotations.length;e++)El((o.element.id+"_Annotation_"+e).replace(/[^a-zA-Z0-9]/g,""),"ContentTemplate");El(o.element.id+"_tooltipparent_template_blazorTemplate","Template"),El(o.element.id+"_DataLabel")}var cW=function(){function o(e,t){this.startValues=e,this.endValues=t}return o}(),as=function(o){YN(e,o);function e(t,i,r,n,s,a,l,h,u){var c=o.call(this,t,i,r.width,r.color,n,u)||this;return c.y=s.y,c.x=s.x,c.height=s.height,c.width=s.width,c.rx=a||0,c.ry=l||0,c.transform=h||"",c.stroke=r.width!==0&&c.stroke!==""?r.color===null?"":r.color:"transparent",c}return e}(Ir),Yw=function(){function o(e,t,i,r,n,s,a,l){this.height=e,this.width=t,this.href=i,this.x=r,this.y=n,this.id=s,this.visibility=a,this.preserveAspectRatio=l}return o}(),$m=function(o){YN(e,o);function e(t,i,r,n,s,a,l){var h=o.call(this,t,i,r.width,r.color,n)||this;return h.cy=a,h.cx=s,h.r=l,h}return e}(Ir);var Je=function(){function o(e,t){this.x=e,this.y=t}return o}();var bo=function(){function o(e,t,i,r){this.left=e,this.right=t,this.top=i,this.bottom=r}return o}(),Wm=function(){function o(e,t,i){this.r=e,this.g=t,this.b=i}return o}(),of=function(){function o(e,t,i){i===void 0&&(i=0),this.point=e,this.series=t,this.lierIndex=i}return o}(),lf=function(){function o(e,t,i){i===void 0&&(i=0),this.point=e,this.series=t,this.index=i}return o}();function dW(o,e){var t="",i;return Number(e)===o.start?t=o.colors[0]:Number(e)===o.end?t=o.colors[o.colors.length-1]:(i=pW(Number(e),o),t=sF(i)),t}function pW(o,e){var t=e.start,i=e.end,r=0,n=i-t,s;r=(o-t)/n;var a,l;if(e.colors.length<=2)a=e.colors[0].charAt(0)==="#"?e.colors[0]:Bn(e.colors[0]),l=e.colors[e.colors.length-1].charAt(0)==="#"?e.colors[e.colors.length-1]:Bn(e.colors[e.colors.length-1]);else{a=e.colors[0].charAt(0)==="#"?e.colors[0]:Bn(e.colors[0]),l=e.colors[e.colors.length-1].charAt(0)==="#"?e.colors[e.colors.length-1]:Bn(e.colors[e.colors.length-1]);for(var h=n/(e.colors.length-1),u=void 0,c=void 0,d=e.colors.length-1,p=[],f={},v=1;v<d;v++)c=v*h,u=t+c,f={b:u,color:e.colors[v]},p.push(f);for(var m=0;m<p.length;m++)t<=o&&o<=p[m].b&&m===0?(s=p[m].color.charAt(0)==="#"?p[m].color:Bn(p[m].color),l=s,r=o<=p[m].b?1-Math.abs((o-p[m].b)/h):(o-p[m].b)/h):p[m].b<=o&&o<=i&&m===p.length-1&&(s=p[m].color.charAt(0)==="#"?p[m].color:Bn(p[m].color),a=s,r=o<p[m].b?1-Math.abs((o-p[m].b)/h):(o-p[m].b)/h),m!==p.length-1&&m<p.length&&p[m].b<=o&&o<=p[m+1].b&&(s=p[m].color.charAt(0)==="#"?p[m].color:Bn(p[m].color),a=s,l=p[m+1].color.charAt(0)==="#"?p[m+1].color:Bn(p[m+1].color),r=Math.abs(o-p[m+1].b)/h)}return fW(r,a,l)}function fW(o,e,t){var i=t.split("#")[1],r=e.split("#")[1],n=Ww(o,parseInt(r.substr(0,2),16),parseInt(i.substr(0,2),16)),s=Ww(o,parseInt(r.substr(2,2),16),parseInt(i.substr(2,2),16)),a=Ww(o,parseInt(r.substr(4,2),16),parseInt(i.substr(4,2),16));return new Wm(n,s,a)}function Ww(o,e,t){var i=t-e;return Math.round(e+i*o)}function Xh(o,e){switch(o){case"Near":return e?"end":"start";case"Far":return e?"start":"end";default:return"middle"}}function Qw(o){var e;switch(o){case"Fabric":e=["#4472c4","#ed7d31","#ffc000","#70ad47","#5b9bd5","#c1c1c1","#6f6fe2","#e269ae","#9e480e","#997300"];break;case"Bootstrap4":e=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"Bootstrap":e=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"HighContrastLight":case"HighContrast":e=["#79ECE4","#E98272","#DFE6B6","#C6E773","#BA98FF","#FA83C3","#00C27A","#43ACEF","#D681EF","#D8BC6E"];break;case"MaterialDark":e=["#9ECB08","#56AEFF","#C57AFF","#61EAA9","#EBBB3E","#F45C5C","#8A77FF","#63C7FF","#FF84B0","#F7C928"];break;case"FabricDark":e=["#4472c4","#ed7d31","#ffc000","#70ad47","#5b9bd5","#c1c1c1","#6f6fe2","#e269ae","#9e480e","#997300"];break;case"BootstrapDark":e=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"Tailwind3":e=["#2F4074","#03B4B4","#0D72DE","#FF5733","#D63384","#F39C12","#EF291F","#91C822"];break;case"Tailwind3Dark":e=["#8029F1","#1ABC9C","#0D72DE","#FF5733","#D63384","#F39C12","#EF291F","#91C822"];break;case"Tailwind":e=["#5A61F6","#65A30D","#334155","#14B8A6","#8B5CF6","#0369A1","#F97316","#9333EA","#F59E0B","#15803D"];break;case"TailwindDark":e=["#8B5CF6","#22D3EE","#F87171","#4ADE80","#E879F9","#FCD34D","#F97316","#2DD4BF","#F472B6","#10B981"];break;case"Bootstrap5Dark":case"Bootstrap5":e=["#FD7E14","#6610F2","#6F42C1","#D63384","#DC3545","#FFC107","#198754","#0DCAF0"];break;case"FluentDark":e=["#1AC9E6","#DA4CB2","#EDBB40","#AF4BCF","#FF7266","#1BD565","#EE993D","#5887FF","#EC548D","#7D39C0"];break;case"Fluent":e=["#1AC9E6","#DA4CB2","#EDBB40","#AF4BCF","#FF7266","#1BD565","#EE993D","#5887FF","#EC548D","#7D39C0"];break;case"Fluent2":e=["#6200EE","#09AF74","#0076E5","#CB3587","#E7910F","#0364DE","#66CD15","#F3A93C","#107C10","#C19C00"];break;case"Fluent2Dark":e=["#9BB449","#2A72D5","#43B786","#3F579A","#584EC6","#E85F9C","#6E7A89","#EA6266","#0B6A0B","#C19C00"];break;case"Fluent2HighContrast":e=["#9BB449","#2A72D5","#43B786","#3F579A","#584EC6","#E85F9C","#6E7A89","#EA6266","#0B6A0B","#C19C00"];break;case"Material3":e=["#6355C7","#00AEE0","#FFB400","#F7523F","#963C70","#FD7400","#4BE0BC","#2196F5","#DE3D8A","#162F88"];break;case"Material3Dark":e=["#4EAAFF","#FA4EAB","#FFF500","#17EA58","#38FFE7","#FF9E45","#B3F32F","#B93CE4","#FC5664","#9B55FF"];break;default:e=["#00bdae","#404041","#357cd2","#e56590","#f8b883","#70ad47","#dd8abd","#7f84e8","#7bb4eb","#ea7a57"];break}return e}function lF(o,e,t){var i,r=o==="MaterialDark"?"#383838":o==="FabricDark"?"#242424":"#1b1b1b";switch(o){case"HighContrastLight":case"HighContrast":i={axisLabel:"#ffffff",axisTitle:"#ffffff",axisLine:"#ffffff",majorGridLine:"#BFBFBF",minorGridLine:"#969696",majorTickLine:"#BFBFBF",minorTickLine:"#969696",chartTitle:"#ffffff",legendLabel:"#ffffff",background:e?"#000000":"transparent",areaBorder:"#ffffff",errorBar:"#ffffff",crosshairLine:"#ffffff",crosshairBackground:"rgba(255, 255, 255, 0.1)",crosshairFill:"#ffffff",crosshairLabel:"#000000",tooltipFill:"#ffffff",tooltipBoldLabel:"#000000",tooltipLightLabel:"#000000",tooltipHeaderLine:"#969696",markerShadow:"#BFBFBF",selectionRectFill:"rgba(255, 217, 57, 0.3)",selectionRectStroke:"#ffffff",selectionCircleStroke:"#FFD939",tabColor:"#FFD939",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:"#FFD939",toolkitFill:"#737373",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Ae(0,0,16,16),chartTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"16px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#969696",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#969696",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#000000",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#969696",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"400"},crosshairLabelFont:{color:"#000000",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},stripLineLabelFont:{color:"#969696",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"MaterialDark":case"FabricDark":case"BootstrapDark":i={axisLabel:"#DADADA",axisTitle:"#ffffff",axisLine:" #6F6C6C",majorGridLine:"#414040",minorGridLine:"#514F4F",majorTickLine:"#414040",minorTickLine:" #4A4848",chartTitle:"#ffffff",legendLabel:"#DADADA",background:e?r:"transparent",areaBorder:" #9A9A9A",errorBar:"#ffffff",crosshairLine:"#F4F4F4",crosshairBackground:"rgba(255, 255, 255, 0.1)",crosshairFill:o==="MaterialDark"?"#F4F4F4":o==="FabricDark"?"#A19F9D":"#F0F0F0",crosshairLabel:"#282727",tooltipFill:"#F4F4F4",tooltipBoldLabel:"#282727",tooltipLightLabel:"#333232",tooltipHeaderLine:"#9A9A9A",markerShadow:null,selectionRectFill:"rgba(56,169,255, 0.1)",selectionRectStroke:"#38A9FF",selectionCircleStroke:"#282727",tabColor:o==="MaterialDark"?"#00B0FF":o==="FabricDark"?"#0074CC":"#0070F0",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:o==="MaterialDark"?"#00B0FF":o==="FabricDark"?"#0074CC":"#0070F0",toolkitFill:"#737373",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Ae(0,0,16,16),chartTitleFont:{color:o==="MaterialDark"?"rgba(255, 255, 255, 0.87)":o==="FabricDark"?"#DADADA":"#FFFFFF",fontFamily:o==="MaterialDark"?"Roboto":o==="FabricDark"?"Segoe UI":"Helvetica",size:"16px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:o==="MaterialDark"?"rgba(255, 255, 255, 0.6)":o==="FabricDark"?"#A19F9D":"#CED4DA",fontFamily:o==="MaterialDark"?"Roboto":o==="FabricDark"?"Segoe UI":"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:o==="MaterialDark"?"rgba(255, 255, 255, 0.87)":o==="FabricDark"?"#DADADA":"#FFFFFF",fontFamily:o==="MaterialDark"?"Roboto":o==="FabricDark"?"Segoe UI":"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:o==="MaterialDark"?"rgba(255, 255, 255, 0.6)":o==="FabricDark"?"#A19F9D":"#676767",fontFamily:o==="MaterialDark"?"Roboto":o==="FabricDark"?"Segoe UI":"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:o==="MaterialDark"?"rgba(18, 18, 18, 1)":o==="FabricDark"?"#DADADA":"#1A1A1A",fontFamily:o==="MaterialDark"?"Roboto":o==="FabricDark"?"Segoe UI":"Helvetica",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:o==="MaterialDark"?"rgba(255, 255, 255, 0.87)":o==="FabricDark"?"#DADADA":"#FFFFFF",fontFamily:o==="MaterialDark"?"Roboto":o==="FabricDark"?"Segoe UI":"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:o==="MaterialDark"?"rgba(255, 255, 255, 0.6)":o==="FabricDark"?"#A19F9D":"#676767",fontFamily:o==="MaterialDark"?"Roboto":o==="FabricDark"?"Segoe UI":"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:o==="MaterialDark"?"rgba(255, 255, 255, 0.87)":o==="FabricDark"?"#DADADA":"#FFFFFF",fontFamily:o==="MaterialDark"?"Roboto":o==="FabricDark"?"Segoe UI":"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"400"},crosshairLabelFont:{color:o==="MaterialDark"?"rgba(18, 18, 18, 1)":o==="FabricDark"?"#DADADA":"#1A1A1A",fontFamily:o==="MaterialDark"?"Roboto":o==="FabricDark"?"Segoe UI":"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"},stripLineLabelFont:{color:o==="MaterialDark"?"rgba(255, 255, 255, 0.24)":o==="FabricDark"?"#6F6C6C":"#414141",fontFamily:o==="MaterialDark"?"Roboto":o==="FabricDark"?"Segoe UI":"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Bootstrap4":i={axisLabel:"#212529",axisTitle:"#212529",axisLine:"#CED4DA",majorGridLine:"#CED4DA",minorGridLine:"#DEE2E6",majorTickLine:"#ADB5BD",minorTickLine:"#CED4DA",chartTitle:"#212529",legendLabel:"#212529",background:e?"#FFFFFF":"transparent",areaBorder:"#DEE2E6",errorBar:"#000000",crosshairLine:"#6C757D",crosshairBackground:"rgba(0, 0, 0, 0.1)",crosshairFill:"#212529",crosshairLabel:"#FFFFFF",tooltipFill:"#020202",tooltipBoldLabel:"rgba(255,255,255)",tooltipLightLabel:"rgba(255,255,255, 0.9)",tooltipHeaderLine:"rgba(255,255,255, 0.2)",markerShadow:null,selectionRectFill:"rgba(255,255,255, 0.1)",selectionRectStroke:"rgba(0, 123, 255)",selectionCircleStroke:"#495057",tabColor:"#007BFF",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:"#007BFF",toolkitFill:"#495057",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Ae(-5,-5,26,26),chartTitleFont:{color:"#212529",fontFamily:"Helvetica",size:"16px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#495057",fontFamily:"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#212529",fontFamily:"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#666666",fontFamily:"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#F9FAFB",fontFamily:"Helvetica",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#212529",fontFamily:"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#495057",fontFamily:"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#212529",fontFamily:"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"400"},crosshairLabelFont:{color:"#F9FAFB",fontFamily:"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"},stripLineLabelFont:{color:"#6C757D",fontFamily:"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Tailwind3":i={axisLabel:"#4B5563",axisTitle:"#6B7280",axisLine:"#D1D5DB",majorGridLine:"#E5E7EB",minorGridLine:"#E5E7EB",majorTickLine:"#D1D5DB",minorTickLine:"#D1D5DB",chartTitle:"#111827",legendLabel:"#4B5563",background:e?"rgba(255,255,255, 0.0)":"transparent",areaBorder:"#D1D5DB",errorBar:"#1F2937",crosshairLine:"#1F2937",crosshairBackground:"rgba(107, 114, 128, 0.1)",crosshairFill:"#111827",crosshairLabel:"#F9FAFB",tooltipFill:"#111827",tooltipBoldLabel:"#F9FAFB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#D1D5DB",markerShadow:null,selectionRectFill:"rgba(224, 231, 255, 0.25)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280",tabColor:"#4F46E5",bearFillColor:"#EF291F",bullFillColor:"#0D72DE",toolkitSelectionColor:"#212529",toolkitFill:"#6B7280",toolkitIconRectOverFill:"#F9FAFB",toolkitIconRectSelectionFill:"#F3F4F6",toolkitIconRect:new Ae(-6,-8,32,32),chartTitleFont:{color:"#111827",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"500"},axisLabelFont:{color:"#4B5563",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#374151",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"500"},legendLabelFont:{color:"#4B5563",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"500"},tooltipLabelFont:{color:"#F9FAFB",fontFamily:"Inter",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#6B7280",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"500"},datalabelFont:{color:"#111827",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#6B7280",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"600"},crosshairLabelFont:{color:"#F9FAFB",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"500"},stripLineLabelFont:{color:"#374151",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Tailwind3Dark":i={axisLabel:"#D1D5DB",axisTitle:"#9CA3AF",axisLine:" #374151",majorGridLine:"#282F3C",minorGridLine:"#282F3C",majorTickLine:"#374151",minorTickLine:" #374151",chartTitle:"#FFFFFF",legendLabel:"#D1D5DB",background:e?"#1f2937":"transparent",areaBorder:" #374151",errorBar:"#6B7280",crosshairLine:"#6B7280",crosshairBackground:"rgba(107, 114, 128, 0.1)",crosshairFill:"#F9FAFB",crosshairLabel:"#1F2937",tooltipFill:"#F9FAFB",tooltipBoldLabel:"#1F2937",tooltipLightLabel:"#1F2937",tooltipHeaderLine:"#374151",markerShadow:null,selectionRectFill:"rgba(30, 27, 75, 0.25)",selectionRectStroke:"#6366F1",selectionCircleStroke:"#282727",tabColor:"#22D3EE",bearFillColor:"#EF291F",bullFillColor:"#0D72DE",toolkitSelectionColor:"#FFFFFF",toolkitFill:"#FFFFFF",toolkitIconRectOverFill:"#242A38",toolkitIconRectSelectionFill:"#242A38",toolkitIconRect:new Ae(-6,-8,32,32),chartTitleFont:{color:"#FFFFFF",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"500"},axisLabelFont:{color:"#D1D5DB",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#E5E7EB",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"500"},legendLabelFont:{color:"#D1D5DB",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"500"},tooltipLabelFont:{color:"#1F2937",fontFamily:"Inter",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#9CA3AF",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"500"},datalabelFont:{color:"#FFFFFF",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#9CA3AF",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"600"},crosshairLabelFont:{color:"#1F2937",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"500"},stripLineLabelFont:{color:"#E5E7EB",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Tailwind":i={axisLabel:"#6B728",axisTitle:"#374151",axisLine:" #D1D5DB",majorGridLine:"#E5E7EB",minorGridLine:"#E5E7EB",majorTickLine:"#D1D5DB",minorTickLine:" #D1D5DB",chartTitle:"#374151",legendLabel:"#374151",background:e?"rgba(255,255,255, 0.0)":"transparent",areaBorder:" #E5E7EB",errorBar:"#374151",crosshairLine:"#1F2937",crosshairBackground:"rgba(90, 97, 246, 0.1)",crosshairFill:"#111827",crosshairLabel:"#F9FAFB",tooltipFill:"#111827",tooltipBoldLabel:"#D1D5DB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280",tabColor:"#4F46E5",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:"#4F46E5",toolkitFill:"#6B7280",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Ae(0,0,16,16),chartTitleFont:{color:"#374151",fontFamily:"Inter",size:"16px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#6B7280",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#374151",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#374151",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#F9FAFB",fontFamily:"Inter",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#374151",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#6B7280",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#374151",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"400"},crosshairLabelFont:{color:"#F9FAFB",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"},stripLineLabelFont:{color:"#D1D5DB",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"TailwindDark":i={axisLabel:"#9CA3AF",axisTitle:"#9CA3AF",axisLine:" #4B5563",majorGridLine:"#374151",minorGridLine:"#374151",majorTickLine:"#4B5563",minorTickLine:" #4B5563",chartTitle:"#D1D5DB",legendLabel:"#D1D5DB",background:e?"#1f2937":"transparent",areaBorder:" #374151",errorBar:"#ffffff",crosshairLine:"#9CA3AF",crosshairBackground:"rgba(90, 97, 246, 0.1)",crosshairFill:"#F9FAFB",crosshairLabel:"#1F2937",tooltipFill:"#F9FAFB",tooltipBoldLabel:"#6B7280",tooltipLightLabel:"#1F2937",tooltipHeaderLine:"#9CA3AF",markerShadow:null,selectionRectFill:"rgba(34,211,238, 0.1)",selectionRectStroke:"#22D3EE",selectionCircleStroke:"#282727",tabColor:"#22D3EE",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:"#22D3EE",toolkitFill:"#D1D5DB",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Ae(0,0,16,16),chartTitleFont:{color:"#D1D5DB",fontFamily:"Inter",size:"16px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#9CA3AF",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#D1D5DB",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#D1D5DB",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#1F2937",fontFamily:"Inter",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#D1D5DB",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#9CA3AF",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#D1D5DB",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"400"},crosshairLabelFont:{color:"#1F2937",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"},stripLineLabelFont:{color:"#6B7280",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Bootstrap5":i={axisLabel:"#212529",axisTitle:"#212529",axisLine:"#DEE2E6",majorGridLine:"#E9ECEF",minorGridLine:"#E9ECEF",majorTickLine:"#DEE2E6",minorTickLine:"#E9ECEF",chartTitle:"#212529",legendLabel:"#212529",background:e?"#212529":"transparent",areaBorder:"#E9ECEF",errorBar:"#343A40",crosshairLine:"#343A40",crosshairBackground:"rgba(52, 58, 64, 0.1)",crosshairFill:"#000000",crosshairLabel:"#FFFFFF",tooltipFill:"#E9ECEF",tooltipBoldLabel:"#FFFFFF",tooltipLightLabel:"#FFFFFF",tooltipHeaderLine:"#FFFFFF",markerShadow:null,selectionRectFill:"rgba(134,183,254, 0.1)",selectionRectStroke:"#0D6EFD",selectionCircleStroke:"#6B7280",tabColor:"#0D6EFD",bearFillColor:"#DC3545",bullFillColor:"#6F42C1",toolkitSelectionColor:"#6E757D",toolkitFill:"#6E757D",toolkitIconRectOverFill:"#F8F9FA",toolkitIconRectSelectionFill:"#F8F9FA",toolkitIconRect:new Ae(-6,-8,32,32),chartTitleFont:{color:"#212529",fontFamily:"Segoe UI",size:t.getModuleName()==="accumulationchart"?"16px":"14px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#212529",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#212529",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#212529",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#212529",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#212529",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#212529",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:t.getModuleName()==="accumulationchart"?"#21252980":"#212529",fontFamily:"Segoe UI",size:t.getModuleName()==="accumulationchart"?"14px":"12px",fontStyle:"Normal",fontWeight:"600"},crosshairLabelFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},stripLineLabelFont:{color:"#6C757D",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Bootstrap5Dark":i={axisLabel:"#DEE2E6",axisTitle:"#DEE2E6",axisLine:"#495057",majorGridLine:"#343A40",minorGridLine:"#343A40",majorTickLine:"#495057",minorTickLine:"#343A40",chartTitle:"#DEE2E6",legendLabel:"#DEE2E6",background:e?"#212529":"transparent",areaBorder:"#343A40",errorBar:"#ADB5BD",crosshairLine:"#ADB5BD",crosshairBackground:"rgba(138, 136, 134, 0.1)",crosshairFill:"#FFFFFF",crosshairLabel:"#212529",tooltipFill:"#FFFFFF",tooltipBoldLabel:"#212529",tooltipLightLabel:"#212529",tooltipHeaderLine:"#212529",markerShadow:null,selectionRectFill:"rgba(134,183,254, 0.25)",selectionRectStroke:"#0D6EFD",selectionCircleStroke:"#0D6EFD",tabColor:"#0D6EFD",bearFillColor:"#DC3545",bullFillColor:"#6F42C1",toolkitSelectionColor:"#F8F9FA",toolkitFill:"#ADB5BD",toolkitIconRectOverFill:"#2B3035",toolkitIconRectSelectionFill:"#343A40",toolkitIconRect:new Ae(-6,-8,32,32),chartTitleFont:{color:"#DEE2E6",fontFamily:"Segoe UI",size:t.getModuleName()==="accumulationchart"?"16px":"14px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#DEE2E6",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#DEE2E6",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#DEE2E6",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#212529",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#DEE2E6",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#DEE2E6",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:t.getModuleName()==="accumulationchart"?"#DEE2E680":"#DEE2E6",fontFamily:"Segoe UI",size:t.getModuleName()==="accumulationchart"?"14px":"12px",fontStyle:"Normal",fontWeight:"600"},crosshairLabelFont:{color:"#212529",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},stripLineLabelFont:{color:"#DEE2E6",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Fluent":i={axisLabel:"#3B3A39",axisTitle:"#201F1E",axisLine:"#D2D0CE",majorGridLine:"#EDEBE9",minorGridLine:"#EDEBE9",majorTickLine:"#D2D0CE",minorTickLine:" #D2D0CE",chartTitle:"#201F1E",legendLabel:"#323130",background:e?"#FFFFFF":"transparent",areaBorder:"#EDEBE9",errorBar:"#A19F9D",crosshairLine:"#A19F9D",crosshairBackground:"rgba(161, 159, 157, 0.1)",crosshairFill:"#FFFFFF",crosshairLabel:"#323130",tooltipFill:"#FFFFFF",tooltipBoldLabel:"#323130",tooltipLightLabel:"#323130",tooltipHeaderLine:"#D2D0CE",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280",tabColor:"#0078D4",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:"#0078D4",toolkitFill:"#A19F9D",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Ae(0,0,16,16),chartTitleFont:{color:"#201F1E",fontFamily:"Segoe UI",size:"16px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#3B3A39",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#201F1E",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#49454E",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#323130",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#201F1E",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#3B3A39",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#323129",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"400"},crosshairLabelFont:{color:"#323130",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},stripLineLabelFont:{color:"#A19F9D",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"FluentDark":i={axisLabel:"#C8C6C4",axisTitle:"#F3F2F1",axisLine:"#3B3A39",majorGridLine:"#414040",minorGridLine:"#414040",majorTickLine:"#3B3A39",minorTickLine:"#3B3A39",chartTitle:"#F3F2F1",legendLabel:"#D2D0CE",background:e?"#383838":"transparent",areaBorder:"#414040",errorBar:"#D2D0CE",crosshairLine:"#D2D0CE",crosshairBackground:"rgba(161, 159, 157, 0.1)",crosshairFill:"#323130",crosshairLabel:"#F3F2F1",tooltipFill:"#252423",tooltipBoldLabel:"#F3F2F1",tooltipLightLabel:"#F3F2F1",tooltipHeaderLine:"#3B3A39",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280",tabColor:"#0078D4",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:"#0078D4",toolkitFill:"#484644",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Ae(0,0,16,16),chartTitleFont:{color:"#C8C6C4",fontFamily:"Segoe UI",size:"16px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#C8C6C4",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#F3F2F1",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#D2D0CE",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#F3F2F1",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#F3F2F2",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#D2D0CE",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#F3F2F1",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"400"},crosshairLabelFont:{color:"#F3F2F1",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},stripLineLabelFont:{color:"#484644",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Fluent2":i={axisLabel:"#616161",axisTitle:"#242424",axisLine:"#D2D0CE",majorGridLine:"#EDEBE9",minorGridLine:"#EDEBE9",majorTickLine:"#D2D0CE",minorTickLine:"#D2D0CE",chartTitle:"#242424",legendLabel:"#242424",background:e?"#383838":"transparent",areaBorder:"#EDEBE9",errorBar:"#A19F9D",crosshairLine:"#A19F9D",crosshairBackground:"rgba(138, 136, 134, 0.1)",crosshairFill:"#FFFFFF",crosshairLabel:"#242424",tooltipFill:"#FFFFFF",tooltipBoldLabel:"#242424",tooltipLightLabel:"#242424",tooltipHeaderLine:"#D2D0CE",markerShadow:null,selectionRectFill:"rgba(180, 214, 250, 0.1)",selectionRectStroke:"#0F6CBD",selectionCircleStroke:"#0F6CBD",tabColor:"#0078D4",bearFillColor:"#E7910F",bullFillColor:"#0076E5",toolkitSelectionColor:"#424242",toolkitFill:"#424242",toolkitIconRectOverFill:"#E6E6E6",toolkitIconRectSelectionFill:"#E6E6E6",toolkitIconRect:new Ae(-6,-8,32,32),chartTitleFont:{color:"#242424",fontFamily:"Segoe UI",size:t.getModuleName()==="accumulationchart"?"16px":"14px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#616161",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#242424",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#242424",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#242424",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#242424",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#242424",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#616161",fontFamily:"Segoe UI",size:t.getModuleName()==="chart"?"12px":"14px",fontStyle:"Normal",fontWeight:"600"},crosshairLabelFont:{color:"#242424",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"700"},stripLineLabelFont:{color:"#616161",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Fluent2HighContrast":i={axisLabel:"#FFFFFF",axisTitle:"#FFFFFF",axisLine:"#3B3A39",majorGridLine:"#292827",minorGridLine:"#3B3A39",majorTickLine:"#292827",minorTickLine:"#292827",chartTitle:"#FFFFFF",legendLabel:"#FFFFFF",background:e?"#383838":"transparent",areaBorder:"#292827",errorBar:"#8A8886",crosshairLine:"#8A8886",crosshairBackground:"rgba(255, 255, 255, 0.1)",crosshairFill:"#000000",crosshairLabel:"#FFFFFF",tooltipFill:"#292929",tooltipBoldLabel:"#FFFFFF",tooltipLightLabel:"#FFFFFF",tooltipHeaderLine:"#3B3A39",markerShadow:null,selectionRectFill:"rgba(26, 235, 255, 0.2)",selectionRectStroke:"#1AEBFF",selectionCircleStroke:"#1AEBFF",tabColor:"#0078D4",bearFillColor:"#584EC6",bullFillColor:"#43B786",toolkitSelectionColor:"#FFFFFF",toolkitFill:"#FFFFFF",toolkitIconRectOverFill:"#1AEBFF",toolkitIconRectSelectionFill:"#1AEBFF",toolkitIconRect:new Ae(-6,-8,32,32),chartTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:t.getModuleName()==="accumulationchart"?"16px":"14px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:t.getModuleName()==="chart"?"12px":"14px",fontStyle:"Normal",fontWeight:"600"},crosshairLabelFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"700"},stripLineLabelFont:{color:"#ADADAD",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Fluent2Dark":i={axisLabel:"#ADADAD",axisTitle:"#FFFFFF",axisLine:"#3B3A39",majorGridLine:"#3B3A39",minorGridLine:"#3B3A39",majorTickLine:"#292827",minorTickLine:"#292827",chartTitle:"#FFFFFF",legendLabel:"#FFFFFF",background:e?"#383838":"transparent",areaBorder:"#292827",errorBar:"#8A8886",crosshairLine:"#8A8886",crosshairBackground:"rgba(138, 136, 134, 0.1)",crosshairFill:"#292929",crosshairLabel:"#FFFFFF",tooltipFill:"#292929",tooltipBoldLabel:"#FFFFFF",tooltipLightLabel:"#FFFFFF",tooltipHeaderLine:"#3B3A39",markerShadow:null,selectionRectFill:"rgba(14, 71, 117, 0.1)",selectionRectStroke:"#115EA3",selectionCircleStroke:"#115EA3",tabColor:"#0078D4",bearFillColor:"#584EC6",bullFillColor:"#43B786",toolkitSelectionColor:"#D6D6D6",toolkitFill:"#D6D6D6",toolkitIconRectOverFill:"#333333",toolkitIconRectSelectionFill:"#333333",toolkitIconRect:new Ae(-6,-8,32,32),chartTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:t.getModuleName()==="accumulationchart"?"16px":"14px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#ADADAD",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#ADADAD",fontFamily:"Segoe UI",size:t.getModuleName()==="chart"?"12px":"14px",fontStyle:"Normal",fontWeight:"600"},crosshairLabelFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"700"},stripLineLabelFont:{color:"#ADADAD",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Material3":i={axisLabel:"#1E192B",axisTitle:"#1C1B1F",axisLine:"#C4C7C5",majorGridLine:"#C4C7C5",minorGridLine:"#C4C7C5",majorTickLine:"#C4C7C5",minorTickLine:" #C4C7C5",chartTitle:"#1C1B1F",legendLabel:"#49454E",background:e?"#FFFFFF":"transparent",areaBorder:"#E7E0EC",errorBar:"#79747E",crosshairLine:"#49454E",crosshairBackground:"rgba(73, 69, 78, 0.1)",crosshairFill:"#313033",crosshairLabel:"#F4EFF4",tooltipFill:"#313033",tooltipBoldLabel:"#F4EFF4",tooltipLightLabel:"#F4EFF4",tooltipHeaderLine:"#F4EFF4",markerShadow:null,selectionRectFill:"rgb(98, 0, 238, 0.06)",selectionRectStroke:"#6200EE",selectionCircleStroke:"#79747E",tabColor:"#49454E",bearFillColor:"#5887FF",bullFillColor:"#F7523F",toolkitSelectionColor:"#49454E",toolkitFill:"#49454E",toolkitIconRectOverFill:"#EADDFF",toolkitIconRectSelectionFill:"#EADDFF",toolkitIconRect:new Ae(-4,-5,26,26),histogram:"#D21020",chartTitleFont:{color:"#1C1B1F",fontFamily:"Roboto",size:"16px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#1E192B",fontFamily:"Roboto",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#1C1B1F",fontFamily:"Roboto",size:"14px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#49454E",fontFamily:"Roboto",size:"14px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#F4EFF4",fontFamily:"Roboto",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#1C1B1F",fontFamily:"Roboto",size:"14px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#49454E",fontFamily:"Roboto",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#49454E",fontFamily:"Roboto",size:"14px",fontStyle:"Normal",fontWeight:"400"},crosshairLabelFont:{color:"#F4EFF4",fontFamily:"Roboto",size:"12px",fontStyle:"Normal",fontWeight:"400"},stripLineLabelFont:{color:"#79747E",fontFamily:"Roboto",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Material3Dark":i={axisLabel:"#E6E1E5",axisTitle:"#E6E1E5",axisLine:"#49454F",majorGridLine:"#444746",minorGridLine:"#444746",majorTickLine:"#444746",minorTickLine:" #444746",chartTitle:"#E6E1E5",legendLabel:"#CAC4D0",background:e?"#FFFFFF":"transparent",areaBorder:"#49454F",errorBar:"#938F99",crosshairLine:"#CAC4D0",crosshairBackground:"rgba(73, 69, 78, 0.1)",crosshairFill:"#E6E1E5",crosshairLabel:"#313033",tooltipFill:"#E6E1E5",tooltipBoldLabel:"#313033",tooltipLightLabel:"#313033",tooltipHeaderLine:"#313033",markerShadow:null,selectionRectFill:"rgba(78, 170, 255, 0.06)",selectionRectStroke:"#4EAAFF",selectionCircleStroke:"#938F99",tabColor:"#CAC4D0",bearFillColor:"#B3F32F",bullFillColor:"#FF9E45",toolkitSelectionColor:"#CAC4D0",toolkitFill:"#CAC4D0",toolkitIconRectOverFill:"#4F378B",toolkitIconRectSelectionFill:"#4F378B",toolkitIconRect:new Ae(-4,-5,26,26),histogram:"#FF9E45",chartTitleFont:{color:"#E6E1E5",fontFamily:"Roboto",size:"16px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#CAC4D0",fontFamily:"Roboto",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#E6E1E5",fontFamily:"Roboto",size:"14px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#CAC4D0",fontFamily:"Roboto",size:"14px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#313033",fontFamily:"Roboto",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#E6E1E5",fontFamily:"Roboto",size:"14px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#CAC4D0",fontFamily:"Roboto",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#CAC4D0",fontFamily:"Roboto",size:"14px",fontStyle:"Normal",fontWeight:"400"},crosshairLabelFont:{color:"#313033",fontFamily:"Roboto",size:"12px",fontStyle:"Normal",fontWeight:"400"},stripLineLabelFont:{color:"#938F99",fontFamily:"Roboto",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;default:i={axisLabel:"#686868",axisTitle:"#424242",axisLine:"#b5b5b5",majorGridLine:"#dbdbdb",minorGridLine:"#eaeaea",majorTickLine:"#b5b5b5",minorTickLine:"#d6d6d6",chartTitle:"#424242",legendLabel:"#353535",background:e?"#FFFFFF":"transparent",areaBorder:"Gray",errorBar:"#000000",crosshairLine:"#4f4f4f",crosshairBackground:"rgba(0, 0, 0, 0.1)",crosshairFill:o==="Material"?"#000816":o==="Fabric"?"#FFFFFF":"#212529",crosshairLabel:"#e5e5e5",tooltipFill:"#000816",tooltipBoldLabel:"#ffffff",tooltipLightLabel:"#dbdbdb",tooltipHeaderLine:"#ffffff",markerShadow:null,selectionRectFill:"rgba(41, 171, 226, 0.1)",selectionRectStroke:"#29abe2",selectionCircleStroke:"#29abe2",tabColor:o==="Material"?"#ff4081":o==="Fabric"?"#0078D6":"#317AB9",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:o==="Material"?"#ff4081":o==="Fabric"?"#0078D6":"#317AB9",toolkitFill:"#737373",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Ae(0,0,16,16),chartTitleFont:{color:o==="Material"?"rgba(0, 0, 0, 1)":o==="Fabric"?"#333333":"#212529",fontFamily:o==="Material"?"Roboto":o==="Fabric"?"Segoe UI":"Helvetica",size:"16px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:o==="Material"?"rgba(97, 97, 97, 1)":o==="Fabric"?"#666666":"#676767",fontFamily:o==="Material"?"Roboto":o==="Fabric"?"Segoe UI":"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:o==="Material"?"rgba(0, 0, 0, 1)":o==="Fabric"?"#333333":"#212529",fontFamily:o==="Material"?"Roboto":o==="Fabric"?"Segoe UI":"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:o==="Material"?"rgba(97, 97, 97, 1)":"#666666",fontFamily:o==="Material"?"Roboto":o==="Fabric"?"Segoe UI":"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:o==="Material"?"rgba(249, 250, 251, 1)":o==="Fabric"?"#333333":"#F9FAFB",fontFamily:o==="Material"?"Roboto":o==="Fabric"?"Segoe UI":"Helvetica",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:o==="Material"?"rgba(0, 0, 0, 1)":o==="Fabric"?"#333333":"#212529",fontFamily:o==="Material"?"Roboto":o==="Fabric"?"Segoe UI":"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:o==="Material"?"rgba(97, 97, 97, 1)":o==="Fabric"?"#666666":"#676767",fontFamily:o==="Material"?"Roboto":o==="Fabric"?"Segoe UI":"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:o==="Material"?"rgba(0, 0, 0, 1)":o==="Fabric"?"#333333":"#212529",fontFamily:o==="Material"?"Roboto":o==="Fabric"?"Segoe UI":"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"400"},crosshairLabelFont:{color:o==="Material"?"rgba(249, 250, 251, 1)":o==="Fabric"?"#333333":"#F9FAFB",fontFamily:o==="Material"?"Roboto":o==="Fabric"?"Segoe UI":"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"},stripLineLabelFont:{color:o==="Material"?"rgba(158, 158, 158, 1)":o==="Fabric"?"#A6A6A6":"#676767",fontFamily:o==="Material"?"Roboto":o==="Fabric"?"Segoe UI":"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break}return i}var EN=10,gW=function(){function o(e){this.chart=e,this.padding=5}return o.prototype.measureAxis=function(e){var t=this.chart,i=t.chartArea.width?Ni(t.chartArea.width,t.availableSize.width):null;this.crossAt(t),this.seriesClipRect=new Ae(e.x,e.y,e.width,e.height),this.initialClipRect=e,this.leftSize=0,this.rightSize=0,this.topSize=0,this.bottomSize=0,this.measureRowAxis(t,this.initialClipRect),this.initialClipRect=yo(this.initialClipRect,new bo(this.leftSize,this.rightSize,0,0)),this.measureColumnAxis(t,this.initialClipRect),this.initialClipRect=yo(this.initialClipRect,new bo(0,0,this.topSize,this.bottomSize)),this.chart.delayRedraw||this.calculateAxisSize(this.initialClipRect),this.leftSize=0,this.rightSize=0,this.topSize=0,this.bottomSize=0,this.measureRowAxis(t,this.initialClipRect),this.seriesClipRect=yo(this.seriesClipRect,new bo(this.leftSize,this.rightSize,0,0)),this.measureColumnAxis(t,this.initialClipRect),this.seriesClipRect=yo(this.seriesClipRect,new bo(0,0,this.topSize,this.bottomSize)),i&&this.calculateFixedChartArea(t,i),this.chart.delayRedraw||(t.refreshAxis(),this.calculateAxisSize(this.seriesClipRect))},o.prototype.calculateFixedChartArea=function(e,t){this.seriesClipRect.width=t,this.seriesClipRect.x=e.availableSize.width-e.margin.right-t-(e.legendSettings.position==="Right"?e.legendModule.legendBounds.width:0);for(var i=0,r=e.rows;i<r.length;i++){var n=r[i];this.seriesClipRect.x-=Qr(n.farSizes)}},o.prototype.measureRowAxis=function(e,t){var i;this.calculateRowSize(t);for(var r=0,n=e.rows;r<n.length;r++){var s=n[r];i=s,i.nearSizes=[],i.farSizes=[],i.insideNearSizes=[],i.insideFarSizes=[],this.arrangeAxis(i),this.measureDefinition(i,e,new _t(e.availableSize.width,i.computedHeight)),this.leftSize<Qr(i.nearSizes)&&(this.leftSize=Qr(i.nearSizes)),this.rightSize<Qr(i.farSizes)&&(this.rightSize=Qr(i.farSizes))}},o.prototype.measureColumnAxis=function(e,t){var i;this.calculateColumnSize(t);for(var r=0,n=e.columns;r<n.length;r++){var s=n[r];i=s,i.farSizes=[],i.nearSizes=[],i.insideNearSizes=[],i.insideFarSizes=[],this.arrangeAxis(i),this.measureDefinition(i,e,new _t(i.computedWidth,e.availableSize.height)),this.bottomSize<Qr(i.nearSizes)&&(this.bottomSize=Qr(i.nearSizes)),this.topSize<Qr(i.farSizes)&&(this.topSize=Qr(i.farSizes))}},o.prototype.measureDefinition=function(e,t,i){for(var r,n=0,s=e.axes;n<s.length;n++){var a=s[n];r=a.scrollbarSettings.height,a.scrollBarHeight=t.scrollBarModule&&t.zoomModule&&t.zoomSettings.enableScrollbar&&a.enableScrollbarOnZooming&&t.zoomModule.isZoomed&&(a.zoomFactor<1||a.zoomPosition>0)?r:0,a.scrollBarHeight=t.scrollBarModule&&(t.zoomModule&&t.zoomSettings.enableScrollbar&&a.enableScrollbarOnZooming&&t.zoomModule.isZoomed&&(a.zoomFactor<1||a.zoomPosition>0)||a.scrollbarSettings.enable)?r:0,a.getModule(t),a.baseModule.calculateRangeAndInterval(i,a),e.computeSize(a,a.scrollBarHeight,e,t)}e.farSizes.length>0&&(e.farSizes[e.farSizes.length-1]-=EN),e.nearSizes.length>0&&(e.nearSizes[e.nearSizes.length-1]-=EN)},o.prototype.calculateAxisSize=function(e){var t=this.chart,i,r,n,s,a=0,l=0,h=0,u,c,d;this.calculateRowSize(e);for(var p=0,f=t.rows.length;p<f;p++){i=t.rows[p],a=0,l=0;for(var v=0,m=i.axes.length;v<m;v++){if(s=i.axes[v],d=s.plotOffset,s.rect.height===0){s.rect.height=i.computedHeight,h=0;for(var y=p+1,S=p+s.span;y<S;y++)n=t.rows[y],h+=n.computedHeight;s.rect.y=i.computedTop-h+(s.plotOffsetTop?s.plotOffsetTop:d),s.rect.height=s.rect.height+h-this.getAxisOffsetValue(s.plotOffsetTop,s.plotOffsetBottom,s.plotOffset),s.rect.width=0}s.isAxisOpposedPosition?(s.labelPosition==="Inside"&&s.orientation==="Vertical"?l>0?u=e.x+e.width+Qr(la(i.farSizes,l))+s.maxLabelSize.width+s.multiLevelLabelHeight+(s.tickPosition==="Inside"?s.majorTickLines.height:0)+s.labelPadding:u=e.x+e.width-Qr(la(i.insideFarSizes,l)):u=e.x+e.width+Qr(la(i.farSizes,l)),s.rect.x=s.rect.x>=u?s.rect.x:u,l++):(s.labelPosition==="Inside"&&s.orientation==="Vertical"?a>0?u=e.x-Qr(la(i.nearSizes,a))-s.maxLabelSize.width-s.multiLevelLabelHeight-(s.tickPosition==="Inside"?s.majorTickLines.height:0)-s.labelPadding:u=e.x+Qr(la(i.insideNearSizes,a)):u=e.x-Qr(la(i.nearSizes,a)),s.rect.x=s.rect.x<=u?s.rect.x:u,a++)}}this.calculateColumnSize(e);for(var p=0,f=t.columns.length;p<f;p++){r=t.columns[p],a=0,l=0;for(var v=0,b=r.axes.length;v<b;v++){if(s=r.axes[v],d=s.plotOffset,s.rect.width===0){for(var y=p,w=p+s.span;y<w;y++)n=t.columns[y],s.rect.width+=n.computedWidth;s.rect.x=r.computedLeft+(s.plotOffsetLeft?s.plotOffsetLeft:d),s.rect.width-=this.getAxisOffsetValue(s.plotOffsetLeft,s.plotOffsetRight,s.plotOffset),s.rect.height=0}s.isAxisOpposedPosition?(s.labelPosition==="Inside"&&s.orientation==="Horizontal"?l>0?c=e.y-Qr(la(r.farSizes,l))-s.maxLabelSize.height-s.multiLevelLabelHeight-(s.tickPosition==="Inside"?s.majorTickLines.height:0)-s.labelPadding:c=e.y+Qr(la(r.insideFarSizes,l)):c=e.y-Qr(la(r.farSizes,l)),s.rect.y=s.rect.y<=c?s.rect.y:c,l++):(s.labelPosition==="Inside"&&s.orientation==="Horizontal"?a>0?c=e.y+e.height+Qr(la(r.nearSizes,a))+s.maxLabelSize.height+s.multiLevelLabelHeight+(s.tickPosition==="Inside"?s.majorTickLines.height:0)+s.labelPadding:c=e.y+e.height-Qr(la(r.insideNearSizes,a)):c=e.y+e.height+Qr(la(r.nearSizes,a)),s.rect.y=s.rect.y>=c?s.rect.y:c,a++)}}},o.prototype.measure=function(){for(var e=this.chart,t,i,r,n,s,a=0,l=e.axisCollections;a<l.length;a++){var h=l[a];if(h.orientation==="Vertical"){e.verticalAxes.push(h),n=this.getActualRow(h),t=e.rows[n],this.pushAxis(t,h),s=n+h.span>e.rows.length?e.rows.length:n+h.span;for(var u=n+1;u<s;u++)r=e.rows[u],r.axes[t.axes.length-1]=h,e.rows[u]=r;e.rows[n]=t}else{e.horizontalAxes.push(h),n=this.getActualColumn(h),i=e.columns[n],this.pushAxis(i,h),s=n+h.span>e.columns.length?e.columns.length:n+h.span;for(var u=n+1;u<s;u++)r=e.columns[u],r.axes[i.axes.length-1]=h,e.columns[u]=r;e.columns[n]=i}h.isRTLEnabled=e.enableRtl,h.setIsInversedAndOpposedPosition()}},o.prototype.getAxisOffsetValue=function(e,t,i){var r=e?e+(t||i):t?t+i:2*i;return r},o.prototype.crossAt=function(e){for(var t=0,i=e.axisCollections;t<i.length;t++){var r=i[t];if(r.crossesAt!==null)if(r.crossesInAxis){for(var n=2,s=e.axisCollections.length;n<s;n++)if(r.crossesInAxis===e.axisCollections[n].name){r.crossInAxis=e.axisCollections[n],r.crossAt=this.updateCrossAt(r.crossInAxis,r.crossesAt);continue}}else{e.requireInvertedAxis?r.crossInAxis=r.orientation==="Horizontal"?e.primaryXAxis:e.primaryYAxis:r.crossInAxis=r.orientation==="Horizontal"?e.primaryYAxis:e.primaryXAxis,r.crossAt=this.updateCrossAt(r.crossInAxis,r.crossesAt);continue}}},o.prototype.updateCrossAt=function(e,t){switch(e.valueType){case"DateTime":{var i={skeleton:"full",type:"dateTime"},r=this.chart.intl.getDateParser(i),n=this.chart.intl.getDateFormat(i);return Date.parse(r(n(new Date(de.parse.parseJson({val:t}).val))))}case"Category":return parseFloat(t)?parseFloat(t):e.labels.indexOf(t);case"Logarithmic":return Jl(t,e.logBase);default:return t}},o.prototype.pushAxis=function(e,t){for(var i=0,r=e.axes.length;i<=r;i++)if(!e.axes[i]){e.axes[i]=t;break}},o.prototype.arrangeAxis=function(e){for(var t=[],i=0,r=e.axes.length;i<=r;i++)e.axes[i]&&t.push(e.axes[i]);e.axes=t},o.prototype.getActualColumn=function(e){var t=this.chart.columns.length,i=e.columnIndex,r=i>=t?t-1:i<0?0:i;return r},o.prototype.getActualRow=function(e){var t=this.chart.rows.length,i=e.rowIndex,r=i>=t?t-1:i<0?0:i;return r},o.prototype.calculateRowSize=function(e){for(var t=this.chart,i,r=e.y+e.height,n=0,s=Math.max(0,e.height),a=0,l=t.rows.length;a<l;a++)i=t.rows[a],i.height.indexOf("%")!==-1?n=Math.min(s,e.height*parseInt(i.height,10)/100):n=Math.min(s,parseInt(i.height,10)),n=a!==l-1?n:s,i.computedHeight=n,r-=n,i.computedTop=r,s-=n},o.prototype.calculateColumnSize=function(e){for(var t=this.chart,i,r=e.x,n=0,s=Math.max(0,e.width),a=0,l=t.columns.length;a<l;a++)i=t.columns[a],i.width.indexOf("%")!==-1?n=Math.min(s,e.width*parseInt(i.width,10)/100):n=Math.min(s,parseInt(i.width,10)),n=a!==l-1?n:s,i.computedWidth=n,i.computedLeft=r,r+=n,s-=n},o.prototype.renderAxes=function(){var e=this.chart,t,i=e.renderer.createGroup({id:e.element.id+"AxisInsideCollection"}),r=e.renderer.createGroup({id:e.element.id+"AxisOutsideCollection"});r&&r.setAttribute("aria-hidden","true");var n,s;e.scrollBarModule&&(e.scrollBarModule.topScrollBarCount=0,e.scrollBarModule.bottomScrollBarCount=0,e.scrollBarModule.leftScrollBarCount=0,e.scrollBarModule.rightScrollBarCount=0);for(var a=0,l=e.axisCollections.length;a<l;a++){var h=!0;t=e.axisCollections[a],this.element=e.renderer.createGroup({id:e.element.id+"AxisGroup"+a+"Inside"}),this.element&&this.element.setAttribute("aria-hidden","true"),n=e.renderer.createGroup({id:e.element.id+"AxisGroup"+a+"Outside"}),n&&n.setAttribute("aria-hidden","true");for(var u=0,c=t.series;u<c.length;u++){var d=c[u];if(t.name===d.yAxisName||t.name===d.xAxisName){if(h=d.visible,d.category==="Pareto"&&!d.paretoOptions.showAxis&&d.type==="Line"&&(h=!1),h)break;continue}}if(!h){t.zoomingScrollBar&&t.zoomingScrollBar.removeScrollSvg();continue}s=this.findAxisPosition(t),this.drawAxis(t,a,s,n,i,r)}return this.drawPaneLines(e,i),vt(e.enableCanvas,e.svgObject,i,e.redraw),r},o.prototype.renderScrollbar=function(e,t){var i=g(e.zoomModule)?!1:e.zoomModule.isZoomed;if(t.zoomingScrollBar||e.scrollBarModule.injectTo(t,e),(i&&(t.zoomFactor<1||t.zoomPosition>0)||t.scrollbarSettings.enable&&(t.zoomFactor<=1||t.zoomPosition>=0))&&!t.zoomingScrollBar.isScrollUI)e.scrollElement||(e.scrollElement=Va(e.redraw,e.element.id+"_scrollElement")||Xe("div",{id:e.element.id+"_scrollElement"})),vt(!1,e.scrollElement,t.zoomingScrollBar.render(!0),!0);else if(t.zoomFactor===1&&t.zoomPosition===0&&t.zoomingScrollBar.svgObject&&!t.scrollbarSettings.enable)t.zoomingScrollBar.destroy();else if(t.zoomingScrollBar.svgObject){var r=(t.isAxisOpposedPosition&&t.orientation==="Horizontal"?-16:0)+t.rect.y+Math.max(.5,t.lineStyle.width/2),n=(t.isAxisOpposedPosition&&t.orientation!=="Horizontal"?16:0)+t.rect.x-(t.orientation==="Vertical"?t.scrollbarSettings.height:0);t.orientation!=="Horizontal"&&(t.scrollbarSettings.position==="Left"||t.scrollbarSettings.position==="Right")?n=wN(t.zoomingScrollBar,!1):t.orientation==="Horizontal"&&(t.scrollbarSettings.position==="Top"||t.scrollbarSettings.position==="Bottom")&&(r=wN(t.zoomingScrollBar,!0)),t.zoomingScrollBar.svgObject.style.top=r+"px",t.zoomingScrollBar.svgObject.style.left=n+"px"}t.zoomingScrollBar.isScrollUI&&(t.zoomingScrollBar.isScrollUI=!1)},o.prototype.drawPaneLines=function(e,t){this.element=e.renderer.createGroup({id:e.element.id+"DefinitionLine"});for(var i=0,r=e.rows.length;i<r;i++){var n=e.rows[i];n.border.color&&this.drawBottomLine(n,i,!0)}for(var i=0,r=e.columns.length;i<r;i++){var s=e.columns[i];s.border.color&&this.drawBottomLine(s,i,!1)}t=t||ce(e.element.id+"AxisInsideCollection"),this.chart.enableCanvas||t.appendChild(this.element)},o.prototype.drawAxis=function(e,t,i,r,n,s){e.updateCrossValue();var a="";e.orientation==="Horizontal"?(e.visible&&e.internalVisibility&&e.lineStyle.width>0&&this.drawAxisLine(e,t,e.plotOffset,0,0,0,e.plotOffsetLeft,e.plotOffsetRight,i?r:this.element,e.updatedRect),a="X"):(e.visible&&e.internalVisibility&&e.lineStyle.width>0&&this.drawAxisLine(e,t,0,e.plotOffset,e.plotOffsetBottom,e.plotOffsetTop,0,0,i?r:this.element,e.updatedRect),a="Y"),(e.majorGridLines.width>0||e.majorTickLines.width>0||e.minorTickLines.width>0||e.minorGridLines.width>0)&&this["draw"+a+"AxisGridLine"](e,t,i||e.tickPosition==="Inside"?r:this.element,e.updatedRect),e.visible&&e.internalVisibility&&(this["draw"+a+"AxisLabels"](e,t,i||e.labelPosition==="Inside"?r:this.element,e.placeNextToAxisLine?e.updatedRect:e.rect),this["draw"+a+"AxisBorder"](e,t,i||e.labelPosition==="Inside"?r:this.element,e.placeNextToAxisLine?e.updatedRect:e.rect),this["draw"+a+"AxisTitle"](e,t,i?r:this.element,e.placeNextToAxisLine?e.updatedRect:e.rect)),this.chart.enableCanvas||(n.appendChild(this.element),r&&r.childNodes.length>0&&s.appendChild(r)),this.chart.scrollBarModule&&(this.chart.zoomSettings.enableScrollbar&&e.enableScrollbarOnZooming||e.scrollbarSettings.enable)?this.renderScrollbar(this.chart,e):e.zoomingScrollBar&&e.zoomingScrollBar.destroy()},o.prototype.findAxisPosition=function(e){return e.crossAt!==null&&e.isInside(e.crossInAxis.visibleRange)},o.prototype.drawBottomLine=function(e,t,i){var r=this.chart,n={},s,a,l,h,u;i?(e=e,l=h=e.computedTop+e.computedHeight,s=this.seriesClipRect.x,a=s+this.seriesClipRect.width,u="Row"):(e=e,s=a=e.computedLeft,l=this.seriesClipRect.y,h=l+this.seriesClipRect.height,u="Column"),n={id:r.element.id+"_AxisBottom_"+u+t,x1:s,y1:l,x2:a,y2:h,"stroke-width":e.border.width,stroke:e.border.color},this.htmlObject=r.renderer.drawLine(n),vt(r.enableCanvas,this.element,this.htmlObject)},o.prototype.drawAxisLine=function(e,t,i,r,n,s,a,l,h,u){var c=this.chart,d={},p=ce(c.element.id+"AxisLine_"+t),f=p?p.getAttribute("d"):"";p=null,d={id:c.element.id+"AxisLine_"+t,d:"M "+(u.x-i-a)+" "+(u.y-r-s)+" L "+(u.x+u.width+i+l)+" "+(u.y+u.height+r+n),"stroke-dasharray":e.lineStyle.dashArray,"stroke-width":e.lineStyle.width,stroke:e.lineStyle.color||c.themeStyle.axisLine},this.htmlObject=c.renderer.drawPath(d),vt(c.enableCanvas,h,this.htmlObject,c.redraw,!0,"x","y",null,f,null,null,null,c.duration)},o.prototype.drawYAxisGridLine=function(e,t,i,r){var n=e.valueType==="Logarithmic",s=e.valueType.indexOf("Category")>-1,a,l=0,h="",u="",c,d=e.isAxisOpposedPosition,p=d?e.majorTickLines.height:-e.majorTickLines.height,f=d?e.lineStyle.width*.5:-e.lineStyle.width*.5,v=e.valueType==="Category"&&e.labelPlacement==="BetweenTicks"?.5:0,m=g(e.crossesAt)&&e.scrollbarSettings.position!=="Right"&&e.scrollbarSettings.position!=="Left"?d?e.scrollBarHeight:-e.scrollBarHeight:0,y=e.tickPosition==="Inside",S=y?r.x-p-f:r.x+p+f+m,b=e.visibleLabels.length,w=this.chart.themeStyle,I=1;e.valueType.indexOf("Category")>-1&&e.labelPlacement==="BetweenTicks"&&b>0&&!this.chart.stockChart&&(b+=1);for(var x=e.minorGridLines,M=e.minorTickLines,D=0;D<b;D++)a=e.visibleLabels[D]?e.visibleLabels[D].value-v:e.visibleLabels[D-1].value+e.visibleRange.interval-v,l=zn(a,e)*r.height,l=l*-1+(r.y+r.height),l>=r.y&&r.y+r.height>=l&&(this.chart.redraw&&!this.chart.enableCanvas&&this.chart.zoomRedraw&&e.visible&&e.majorGridLines.width&&D!==0&&!ce(this.chart.element.id+"_MajorGridLine_"+t+"_"+D)&&(h="M "+this.seriesClipRect.x+" "+(this.seriesClipRect.y+(e.isInversed?this.seriesClipRect.height+this.seriesClipRect.height/(D||1)*I:-(this.seriesClipRect.height/(D||1)*I)))+" L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+(this.seriesClipRect.y+(e.isInversed?this.seriesClipRect.height+this.seriesClipRect.height/(D||1)*I:-(this.seriesClipRect.height/(D||1)*I))),this.updateAxisElement(e,t,h,D,"_MajorGridLine_",this.element,!1),ce(i.id).appendChild(this.element.childNodes[this.element.childNodes.length-1])),(nf(a,e.visibleRange)||this.isBorder(e,D,l))&&(h="M "+this.seriesClipRect.x+" "+l+" L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+l,this.renderGridLine(e,t,h,e.majorGridLines,"_MajorGridLine_",D,this.element,w.majorGridLine,e.majorGridLines.dashArray)),this.chart.redraw&&this.chart.zoomRedraw&&e.majorTickLines.width&&D!==0&&!ce(this.chart.element.id+"_MajorTickLine_"+t+"_"+D)&&!this.chart.enableCanvas&&e.visible&&(u="M "+this.seriesClipRect.x+" "+(this.seriesClipRect.y+(e.isInversed?this.seriesClipRect.height+this.seriesClipRect.height/(D||1)*I:-(this.seriesClipRect.height/(D||1)*I)))+" L "+S+" "+(this.seriesClipRect.y+(e.isInversed?this.seriesClipRect.height+this.seriesClipRect.height/(D||1)*I:-(this.seriesClipRect.height/(D||1)*I))),this.updateAxisElement(e,t,u,D,"_MajorTickLine_",i,!1),ce(i.id).appendChild(this.element.childNodes[this.element.childNodes.length-1]),I+=1),u="M "+(r.x+f+(y?m:0))+" "+l+" L "+S+" "+l,this.renderGridLine(e,t,u,e.majorTickLines,"_MajorTickLine_",D,i,w.majorTickLine),(x.width>0||M.width>0)&&e.minorTicksPerInterval>0&&(D===0&&sf(e)&&!n&&!s&&this.renderMinorGridOnZooming(e,a,r,D,t,w,i),c=this.drawAxisMinorLine(e,a,r,D),this.renderGridLine(e,t,c[0],x,"_MinorGridLine_",D,this.element,w.minorGridLine,x.dashArray),this.renderGridLine(e,t,c[1],M,"_MinorTickLine_",D,i,w.minorTickLine),D===b-1&&sf(e)&&n&&!s&&this.renderMinorGridOnZooming(e,a+e.visibleRange.interval,r,D,t,w,i)));if(b&&this.previousYLabel>b&&!this.chart.enableCanvas&&e.visible&&this.chart.zoomRedraw&&this.chart.redraw)for(var D=b;D<this.previousYLabel;D++){var A=this.seriesClipRect.y+(e.isInversed?this.seriesClipRect.height/b*(D-b+1)+this.seriesClipRect.height:-(this.seriesClipRect.height/b*(D-b+1)));e.majorGridLines.width&&(h="M "+this.seriesClipRect.x+" "+ +A+" L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+A,this.updateAxisElement(e,t,h,D,"_MajorGridLine_",this.element,!0)),e.majorTickLines.width&&(u="M "+this.seriesClipRect.x+" "+A+" L "+S+" "+A,this.updateAxisElement(e,t,u,D,"_MajorTickLine_",i,!0))}},o.prototype.isBorder=function(e,t,i){var r=this.chart.chartArea.border,n=this.seriesClipRect,s=e.orientation,a=s==="Horizontal"?n.x:n.y,l=s==="Horizontal"?n.width:n.height,h=s==="Horizontal"?0:e.visibleLabels.length-1,u=s==="Horizontal"?e.visibleLabels.length-1:0;return e.plotOffset>0||(i===a||i===a+l)&&(r.width<=0||r.color==="transparent")?!0:i!==a&&t===h||i!==a+l&&t===u},o.prototype.drawYAxisLabels=function(e,t,i,r){var n=this.chart,s,a=0,l=0,h,u=e.labelPadding,c,d,p=e.labelPosition==="Inside",f=e.isAxisOpposedPosition,v,m=e.labelPosition===e.tickPosition?e.majorTickLines.height:0,y=m+u+e.lineStyle.width*.5,S=e.angle%360,b=S===-90||S===90||S===270||S===-270;y+=b?p?5:-5:0,y=f?y:-y;var w=n.renderer.createGroup({id:n.element.id+"AxisLabels"+t}),I=g(e.crossesAt)&&e.scrollbarSettings.position!=="Left"&&e.scrollbarSettings.position!=="Right"?e.scrollBarHeight*(f?1:-1):0,x,M,D,A=10,L=e.isAxisInverse,T=1,k=L?r.y:r.y+r.height,F,R,N,P,O=!f&&!p||f&&p;p?F=O?y:-y:F=O?y+(n.enableRtl?-I:I):-y+(n.enableRtl?-I:I);var z=[],H=[];e.visibleLabels.map(function(ae){z.push(ae.size.width),H.push(ae.breakLabelSize.width)});var Q=Math.max.apply(Math,z),$=Math.max.apply(Math,H);v=Q,S>=-45&&S<=45&&S!==0&&(v=Q*Math.cos(S*Math.PI/180),v<0&&(v=-v));for(var U=0,ie=e.visibleLabels.length;U<ie;U++){switch(s=e.visibleLabels[U],d=Gh(e.visibleLabels[U].originalText),h=d?e.visibleLabels[U].breakLabelSize:e.visibleLabels[U].size,l=zn(e.visibleLabels[U].value,e)*r.height+(n.stockChart?7:0),l=Math.floor(l*-1+(r.y+r.height)),x=h.height/8*e.visibleLabels[U].text.length/2,M=n.requireInvertedAxis&&e.labelPosition==="Inside"?0:h.height/4*3+3,R=r.height/e.visibleLabels.length,N=(e.labelIntersectAction==="Trim"||e.labelIntersectAction==="Wrap")&&S!==0&&h.width>R?R:h.width,l=d?e.labelPosition==="Inside"?l-h.height/2-x+M:l-x:e.labelPosition==="Inside"?l+M:l,e.labelPosition==="Inside"&&(U===0&&!e.isInversed||U===ie-1&&e.isInversed)&&(n.stockChart?l-=M:l-=M-(n.requireInvertedAxis&&e.labelPosition==="Inside"?0:e.opposedPosition?-y:y)),e.majorGridLines.width>e.majorTickLines.width?D=e.majorGridLines.width:D=e.majorTickLines.width,e.labelStyle.textAlignment==="Far"?l=l-D-A:e.labelStyle.textAlignment==="Near"&&(l=l+D+A),p?P=F+(S===0?h.width:d?$:Q)/2:P=F-(S===0?h.width:d?$:v)/2,e.enableWrap&&n.requireInvertedAxis&&S&&(!e.opposedPosition&&e.labelPosition==="Inside"||e.opposedPosition&&e.labelPosition==="Outside")&&(P=e.opposedPosition?P-Q/2:P+Q/2),a=f?e.scrollBarHeight!==0&&e.scrollbarSettings.position!=="Right"&&e.scrollbarSettings.position!=="Left"?r.x+e.scrollBarHeight+y-P:r.x-P:r.x+P,b&&(a+=f?5:-5),P=F,c=new gn(n.element.id+t+"_AxisLabel_"+U,a,l,"middle",s.text,"","middle",S),e.edgeLabelPlacement){case"None":break;case"Hide":((U===0||L&&U===ie-1)&&c.y>r.y||(U===ie-1||L&&U===0)&&c.y-h.height*.5<r.y)&&(c.text="");break;case"Shift":(U===0||L&&U===ie-1)&&c.y>r.y+r.height?c.y=l=r.y+r.height:(U===ie-1||L&&U===0)&&c.y<=0&&(c.y=l=r.y+h.height*.5);break}var ne=c.y,te=c.y-N;if(d&&(ne=c.y-N/2,te=c.y+N/2),!((S===90||S===270)&&e.labelIntersectAction==="Hide"&&U!==0&&(L?te<=k:ne>=k))){if(k=L?ne:te,c.transform="rotate("+S+","+a+","+l+")",this.chart.redraw&&this.chart.zoomRedraw&&!ce(c.id)&&!this.chart.enableCanvas&&e.visible){var oe=c.y;c.y=this.seriesClipRect.y+(e.isInversed?this.seriesClipRect.height+this.seriesClipRect.height/(U||1)*T:-(this.seriesClipRect.height/(U||1)*T)),this.updateAxisElement(e,t,"",U,"_AxisLabel_",w,!1,c,s),c.y=oe,T+=1}hn(n.renderer,c,s.labelStyle,s.labelStyle.color||n.themeStyle.axisLabelFont.color,w,!1,n.redraw,!0,!0,n.duration,null,null,null,n.enableCanvas,null,n.themeStyle.axisLabelFont,new Je(a,l))}}if(this.previousYLabel&&e.visibleLabels.length&&this.previousYLabel>e.visibleLabels.length&&!this.chart.enableCanvas&&e.visible&&this.chart.zoomRedraw&&n.redraw&&c.text)for(var U=e.visibleLabels.length;U<this.previousYLabel;U++)c.y=this.seriesClipRect.y+(e.isInversed?this.seriesClipRect.height+this.seriesClipRect.height/e.visibleLabels.length*(U-e.visibleLabels.length+1):-(this.seriesClipRect.height/e.visibleLabels.length*(U-e.visibleLabels.length+1))),c.id=n.element.id+t+"_AxisLabel_"+U,this.updateAxisElement(e,t,"",U,"_AxisLabel_",w,!0,c,s);else this.previousYLabel=e.visibleLabels.length;this.chart.enableCanvas||(n.delayRedraw?e.visible&&e.internalVisibility&&this.createZoomingLabel(this.chart,w,e,t,r):vt(n.enableCanvas,i,w,n.redraw))},o.prototype.rangeAnimate=function(e,t,i,r,n,s,a){var l=this;t&&new It({}).animate(t,{duration:i,progress:function(){var h=ce(t.id);if(h.style.animation="",r)Oi(parseFloat(h.getAttribute("x")),parseFloat(h.getAttribute("y")),n)?h.style.visibility="visible":h.style.visibility="hidden";else{var u=h.getAttribute("d").split(" ");Oi(parseFloat(u[1]),parseFloat(u[2]),n)?h.style.visibility="visible":h.style.visibility="hidden"}},end:function(){var h=ce(t.id);h.style.visibility="",s&&a>=e.visibleLabels.length&&(ni(h),r&&(e.orientation==="Vertical"?l.previousYLabel=e.visibleLabels.length:l.previousXLabel=e.visibleLabels.length))}})},o.prototype.getAxisLabelXvalue=function(e,t,i){var r=t.lineBreakAlignment,n=t.labelPosition==="Inside",s=t.isAxisOpposedPosition;return s&&n||!s&&!n?r==="Right"?e:r==="Center"?e-i/2:e-i:r==="Left"?e:r==="Center"?e+i/2:e+i},o.prototype.drawYAxisBorder=function(e,t,i,r){if(e.border.width>0){var n=void 0,s=void 0,a=e.labelPosition==="Outside"&&e.scrollbarSettings.position!=="Right"&&e.scrollbarSettings.position!=="Left"?e.scrollBarHeight:0,l=e.isAxisOpposedPosition;a=(l?1:-1)*a;for(var h=r.height/e.visibleRange.delta*(e.valueType==="DateTime"?e.dateTimeInterval:e.visibleRange.interval),u=void 0,c=e.maxLabelSize.width+10+(e.tickPosition===e.labelPosition?e.majorTickLines.height:0),d="",p=e.valueType==="Category"&&e.labelPlacement==="BetweenTicks"?-.5:0,f=l&&e.labelPosition==="Inside"||!l&&e.labelPosition==="Outside"?r.x-c+a:r.x+c+a,v=0,m=e.visibleLabels.length;v<m;v++)switch(s=zn(e.visibleLabels[v].value+p,e),s=(e.isAxisInverse?1-s:s)*r.height,e.valueType==="Category"&&e.labelPlacement==="BetweenTicks"?(n=s*-1+(r.y+r.height),u=s*-1-h+(r.y+r.height)):(n=s*-1+h/2+(r.y+r.height),u=s*-1-h/2+(r.y+r.height)),e.border.type){case"Rectangle":case"WithoutTopBorder":n>r.y+r.height?d+="M "+f+" "+(r.y+r.height)+" L "+f+" "+u+" ":Math.floor(r.y)>u?d+="M "+(r.x+a)+" "+n+" L "+f+" "+n+" L "+f+" "+r.y+" ":(d+="M "+(r.x+a)+" "+n+" L "+f+" "+n+" L "+f+" "+u+" ",v===e.visibleLabels.length-1&&(d+="M "+(r.x+a)+" "+u+" L "+f+" "+u+" "));break;case"WithoutTopandBottomBorder":!(n>r.y+r.height)&&!(u<Math.floor(r.y))&&(d+="M "+(r.x+a)+" "+n+" L "+f+" "+n+" M "+f+" "+u+" L "+(r.x+a)+" "+u);break}d+=e.border.type==="Rectangle"?"M "+(r.x+a)+" "+r.y+" L "+(r.x+a)+" "+(r.y+r.height)+" ":"",d!==""&&this.createAxisBorderElement(e,t,d,i)}for(var v=0;v<this.chart.visibleSeries.length;v++)if(e.multiLevelLabels.length>0&&this.chart.multiLevelLabelModule&&this.chart.visibleSeries[v].visible){this.chart.multiLevelLabelModule.renderYAxisMultiLevelLabels(e,t,i,r);break}},o.prototype.drawYAxisTitle=function(e,t,i,r){if(e.title){var n=this.chart,s=!1,a=e.isAxisOpposedPosition,l=(e.titleRotation==null?a?90:-90:e.titleRotation)%360,h=(e.tickPosition==="Inside"?0:e.majorTickLines.height+e.titlePadding)+(e.labelPosition==="Inside"?0:e.maxLabelSize.width+e.multiLevelLabelHeight+this.padding);h=e.tickPosition!=="Outside"&&(e.tickPosition==="Inside"||e.labelPosition==="Inside")?e.titlePadding===5?h:h+e.titlePadding:h,h=a?h+(e.scrollbarSettings.position==="Right"||e.scrollbarSettings.position==="Left"?0:e.scrollBarHeight):-h-(e.scrollbarSettings.position==="Right"||e.scrollbarSettings.position==="Left"?0:e.scrollBarHeight),(l!==-90&&!a||l!==90&&a)&&(h+=e.isAxisOpposedPosition?e.titleSize.width/2+(e.labelPosition==="Inside"&&e.labelPadding!==5?0:e.labelPadding):-e.titleSize.width/2-(e.labelPosition==="Inside"&&e.labelPadding!==5?0:e.labelPadding),s=!0);var u=r.x+h,c=void 0,d=void 0;e.titleStyle.textAlignment==="Center"?(d="middle",c=r.y+r.height*.5):e.titleStyle.textAlignment==="Near"?(d=e.opposedPosition?"end":"start",c=r.height+r.y):(d=e.opposedPosition?"start":"end",c=r.y);var p=e.titleSize.height*(e.titleCollection.length-1),f=new gn(n.element.id+"_AxisTitle_"+t,u,c+(s?-p:-(e.labelPosition==="Inside"&&e.labelPadding!==5?0:e.labelPadding)-p),d,e.titleCollection,"rotate("+l+","+u+","+c+")",null,l),v=hn(n.renderer,f,e.titleStyle,e.titleStyle.color||n.themeStyle.axisTitleFont.color,i,null,null,null,null,null,null,null,null,n.enableCanvas,null,n.themeStyle.axisTitleFont,new Je(u,c));v.setAttribute("aria-hidden","true")}},o.prototype.drawXAxisGridLine=function(e,t,i,r){var n=e.valueType==="Logarithmic",s=e.valueType.indexOf("Category")>-1,a,l=0,h="",u="",c,d=1,p=e.isAxisOpposedPosition,f=p?-e.majorTickLines.height:e.majorTickLines.height,v=p?-e.lineStyle.width*.5:e.lineStyle.width*.5,m=g(e.crossesAt)&&e.scrollbarSettings.position!=="Top"&&e.scrollbarSettings.position!=="Bottom"?p?-e.scrollBarHeight:e.scrollBarHeight:0,y=e.valueType.indexOf("Category")>-1&&e.labelPlacement==="BetweenTicks"&&!this.chart.stockChart?.5:0,S=e.visibleLabels.length,b=e.tickPosition==="Inside",w=b?r.y-f-v:r.y+f+v+m,I=this.chart.themeStyle;e.valueType.indexOf("Category")>-1&&S>0&&e.labelPlacement==="BetweenTicks"&&!this.chart.stockChart&&(S+=1);for(var x=this.calculateGridLineId(i,S),M=0;M<S;M++)if(e.valueType!=="DateTimeCategory"?a=e.visibleLabels[M]?e.visibleLabels[M].value-y:e.visibleLabels[M-1].value+e.visibleRange.interval-y:a=e.visibleLabels[M]?e.visibleLabels[M].value-y:e.visibleRange.max,l=zn(a,e)*r.width+r.x,l>=r.x&&r.x+r.width>=l){if(nf(a,e.visibleRange)||this.isBorder(e,M,l)){if(this.chart.redraw&&(this.chart.pointsAdded&&!this.chart.pointsRemoved||this.chart.zoomRedraw)&&e.majorGridLines.width&&M!==0&&e.visible&&!ce(this.chart.element.id+"_MajorGridLine_"+t+"_"+M)&&!this.chart.enableCanvas){var D=this.seriesClipRect.x+(this.chart.enableRtl!==e.isInversed?-(this.seriesClipRect.width/S*d):this.seriesClipRect.width+this.seriesClipRect.width/(M||1)*d);h="M "+D+" "+(this.seriesClipRect.y+this.seriesClipRect.height)+" L "+D+" "+this.seriesClipRect.y,this.renderGridLine(e,t,h,e.majorGridLines,"_MajorGridLine_",M,this.element,I.majorGridLine,e.majorGridLines.dashArray,x.MajorGridLine&&x.MajorGridLine.ids?x.MajorGridLine.ids[M]:null,x.MajorGridLine?x.MajorGridLine.isPointRemoved:!1),this.rangeAnimate(e,this.element.childNodes[this.element.childNodes.length-1],this.chart.duration,!1,new Ae(this.seriesClipRect.x,e.rect.y,this.seriesClipRect.x+this.seriesClipRect.width,this.chart.availableSize.height),!1,M),ce(i.id)&&ce(i.id).appendChild(this.element.childNodes[this.element.childNodes.length-1])}h="M "+l+" "+(this.seriesClipRect.y+this.seriesClipRect.height)+" L "+l+" "+this.seriesClipRect.y,this.renderGridLine(e,t,h,e.majorGridLines,"_MajorGridLine_",M,this.element,I.majorGridLine,e.majorGridLines.dashArray,x.MajorGridLine&&x.MajorGridLine.ids?x.MajorGridLine.ids[M]:null,x.MajorGridLine?x.MajorGridLine.isPointRemoved:!1)}this.chart.redraw&&this.chart.zoomRedraw&&e.majorTickLines.width&&!ce(this.chart.element.id+"_MajorTickLine_"+t+"_"+M)&&!this.chart.enableCanvas&&e.visible&&(u="M "+(this.seriesClipRect.x+(this.chart.enableRtl!==e.isInversed?-(this.seriesClipRect.width/S*d):this.seriesClipRect.width+this.seriesClipRect.width/(M||1)*d))+" "+(r.y+v+(b?m:0))+" L "+(this.seriesClipRect.x+(this.chart.enableRtl!==e.isInversed?-(this.seriesClipRect.width/S*d):this.seriesClipRect.width+this.seriesClipRect.width/(M||1)*d))+" "+w,this.updateAxisElement(e,t,u,M,"_MajorTickLine_",i,!1),ce(i.id).appendChild(this.element.childNodes[this.element.childNodes.length-1]),d+=1),u="M "+l+" "+(r.y+v+(b?m:0))+" L "+l+" "+w,this.renderGridLine(e,t,u,e.majorTickLines,"_MajorTickLine_",M,i,I.majorTickLine,null,x.MajorTickLine&&x.MajorTickLine.ids?x.MajorTickLine.ids[M]:null,x.MajorTickLine?x.MajorTickLine.isPointRemoved:!1),e.minorTicksPerInterval>0&&(e.minorGridLines.width>0||e.minorTickLines.width>0)&&(M===0&&sf(e)&&!n&&!s&&this.renderMinorGridOnZooming(e,a,r,M,t,I,i),c=this.drawAxisMinorLine(e,a,r,M),this.renderGridLine(e,t,c[0],e.minorGridLines,"_MinorGridLine_",M,this.element,I.minorGridLine,e.minorGridLines.dashArray,x.MinorGridLine&&x.MinorGridLine.ids?x.MinorGridLine.ids[M]:null,x.MinorGridLine?x.MinorGridLine.isPointRemoved:!1),this.renderGridLine(e,t,c[1],e.minorTickLines,"_MinorTickLine_",M,i,I.minorTickLine,null,x.MinorTickLine&&x.MinorTickLine.ids?x.MinorTickLine.ids[M]:null,x.MinorTickLine?x.MinorTickLine.isPointRemoved:!1),M===S-1&&sf(e)&&n&&!s&&this.renderMinorGridOnZooming(e,a+e.visibleRange.interval,r,M,t,I,i))}if(S&&this.previousXLabel>S&&!this.chart.enableCanvas&&e.visible&&this.chart.zoomRedraw&&this.chart.redraw)for(var M=S;M<this.previousXLabel;M++){var D=this.seriesClipRect.x+(this.chart.enableRtl!==e.isInversed?-(this.seriesClipRect.width/S*(M-S+1)):this.seriesClipRect.width+this.seriesClipRect.width/S*(M-S+1));e.majorGridLines.width&&(h="M "+D+" "+(this.seriesClipRect.y+this.seriesClipRect.height)+" L "+D+" "+this.seriesClipRect.y,this.updateAxisElement(e,t,h,M,"_MajorGridLine_",this.element,!0)),e.majorTickLines.width&&(u="M "+D+" "+(r.y+v+(b?m:0))+" L "+D+" "+w,this.updateAxisElement(e,t,u,M,"_MajorTickLine_",i,!0))}},o.prototype.calculateGridLineId=function(e,t){var i=this,r={};if(this.chart.pointsRemoved){var n=["MajorGridLine","MajorTickLine","MinorGridLine","MinorTickLine"];n.forEach(function(s){for(var a=ce(e.id),l=a.querySelectorAll('[id*="_'+s+'_"]'),h=[],u=0;u<l.length;u++)h.push(l[u]);var c=s==="MajorGridLine"&&i.chart.chartArea.border.width?t-2:t;if(c=s==="MinorGridLine"||s==="MinorTickLine"?t-1:c,h.length>0&&h.length>c){for(var d=h.length,p=0;p<d-c;p++)h[p]&&a.removeChild(h[p]),h.shift();var f=h.map(function(v){var m=v.id.split("_");return parseInt(m[m.length-1],10)});r[s]={ids:f,isPointRemoved:!0}}})}return r},o.prototype.renderMinorGridOnZooming=function(e,t,i,r,n,s,a){var l=this.drawAxisMinorLine(e,t,i,r,!0);this.renderGridLine(e,n,l[0],e.minorGridLines,"_MinorGridLine_",-1,this.element,s.minorGridLine,e.minorGridLines.dashArray),this.renderGridLine(e,n,l[1],e.minorTickLines,"_MinorTickLine_",-1,a,s.minorTickLine)},o.prototype.drawAxisMinorLine=function(e,t,i,r,n){var s=t,a=0,l=0,h=e.visibleRange,u=e.tickPosition==="Inside",c=[],d=e.isAxisOpposedPosition?-e.minorTickLines.height:e.minorTickLines.height,p,f,v=1,m=1,y=u?i.y-d:i.y+d,S=u?i.x+d:i.x-d,b="",w="",I=e.isAxisInverse;if(e.valueType==="Logarithmic"&&(p=Math.pow(e.logBase,s-h.interval),f=Math.pow(e.logBase,s),v=(f-p)/(e.minorTicksPerInterval+1),m=p+v),e.orientation==="Horizontal")for(var x=0;x<e.minorTicksPerInterval;x++)s=this.findLogNumeric(e,m,s,r,n),m+=v,nf(s,h)&&(l=(s-h.min)/(h.max-h.min),l=Math.ceil((I?1-l:l)*i.width),a=Math.floor(l+i.x),this.chart.enableCanvas?(b===""?b="M "+a+" "+this.seriesClipRect.y+" L "+a+" "+(this.seriesClipRect.y+this.seriesClipRect.height):b=b+" M "+a+" "+this.seriesClipRect.y+" L "+a+" "+(this.seriesClipRect.y+this.seriesClipRect.height),a=Math.floor(l+i.x),w===""?w=w.concat("M "+a+" "+i.y+" L "+a+" "+(y+e.scrollBarHeight)):w=w.concat(" M "+a+" "+i.y+" L "+a+" "+(y+e.scrollBarHeight))):(b=b.concat("M "+a+" "+this.seriesClipRect.y+"L "+a+" "+(this.seriesClipRect.y+this.seriesClipRect.height)),a=Math.floor(l+i.x),w=w.concat("M "+a+" "+i.y+"L "+a+" "+(y+e.scrollBarHeight))));else for(var x=0;x<e.minorTicksPerInterval;x++)s=this.findLogNumeric(e,m,s,r,n),nf(s,h)&&(l=(s-h.min)/(h.max-h.min),l=Math.ceil((I?1-l:l)*i.height)*-1,a=Math.floor(l+i.y+i.height),this.chart.enableCanvas?(b===""?b="M "+this.seriesClipRect.x+" "+a+" L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+a:b=b+" M "+this.seriesClipRect.x+" "+a+" L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+a,a=Math.floor(l+i.y+i.height),w===""?w=w.concat("M "+i.x+" "+a+" L "+(S-e.scrollBarHeight)+" "+a+" "):w=w.concat(" M "+i.x+" "+a+" L "+(S-e.scrollBarHeight)+" "+a+" ")):(b=b.concat("M "+this.seriesClipRect.x+" "+a+"L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+a+" "),a=Math.floor(l+i.y+i.height),w=w.concat("M "+i.x+" "+a+"L "+(S-e.scrollBarHeight)+" "+a+" "))),m+=v;return c.push(b),c.push(w),c},o.prototype.findLogNumeric=function(e,t,i,r,n){var s=e.visibleRange,a;if(e.valueType==="Logarithmic")i=Jl(t,e.logBase);else if(e.valueType==="DateTime")a=e.dateTimeInterval/(e.minorTicksPerInterval+1),i=n?i-a:i+a;else if(e.valueType==="DateTimeCategory"){var l=e.labelPlacement==="BetweenTicks"?.5:0;i+=((e.visibleLabels[r+1]?e.visibleLabels[r+1].value-l:e.visibleRange.max)-(e.visibleLabels[r]?e.visibleLabels[r].value-l:e.visibleRange.min))/(e.minorTicksPerInterval+1)}else a=s.interval/(e.minorTicksPerInterval+1),i=n?i-a:i+a;return i},o.prototype.drawXAxisLabels=function(e,t,i,r){var n=this.chart,s=0,a=0,l=0,h=e.labelPadding,u,c,d,p,f=10,v=n.renderer.createGroup({id:n.element.id+"AxisLabels"+t}),m=e.labelPosition==="Inside",y=e.isAxisOpposedPosition,S=e.labelPosition===e.tickPosition?e.majorTickLines.height:0,b=S+h+e.lineStyle.width*.5,w=e.angle%360,I=w===0||w===-180||w===180,x,M,D=e.isAxisInverse,A,L=1,T=D?r.x+r.width:r.x,k=0,F=e.visibleLabels.length,R,N,P,O=e.scrollbarSettings.enable||!m&&g(e.crossesAt)&&(e.zoomFactor<1||e.zoomPosition>0)?e.scrollbarSettings.position==="Top"||e.scrollbarSettings.position==="Bottom"?0:e.scrollBarHeight:0,z=[],H=!1,Q=[],$=new _t(0,0);b+=w===90||w===270||w===-90||w===-270?m?5:-5:0;for(var U=!y&&!m||y&&m,ie=ce(n.element.id+"AxisLabels"+t),ne=this.removeAxisLabelElements(e,ie),te=n.legendModule&&n.legendSettings.position==="Right"&&n.legendModule.legendBounds.height+n.legendModule.legendBounds.y>=e.rect.y?n.legendModule.legendBounds.width:0,oe=U?360>=w&&w>=180||-1>=w&&w>=-180:1<=w&&w<=180||-181>=w&&w>=-360,ae=0,ye=F;ae<ye;ae++){N=e.visibleLabels[ae],P=Gh(N.originalText)||e.labelIntersectAction==="Wrap"&&N.text.length>1,s=zn(N.value,e)*r.width+r.x,c=N.size,e.enableWrap&&(c.height=Ze(N.text,e.labelStyle,n.themeStyle.axisLabelFont).height),R=r.width/F,M=P?N.breakLabelSize.width:c.width,k=(e.labelIntersectAction==="Trim"||e.labelIntersectAction==="Wrap")&&w===0&&M>R?R:M,u=c.height/4,s-=P||w!==0?0:k/2,w!==0&&(P?s-=e.lineBreakAlignment==="Left"?N.breakLabelSize.width/2:e.lineBreakAlignment==="Right"?-(N.breakLabelSize.width/2):0:s-=w===-90||w===270?-u:w===90||w===-270?u:0),e.labelStyle.textAlignment==="Far"?s=s+k-f:e.labelStyle.textAlignment==="Near"&&(s=s-k+f),P&&e.lineBreakAlignment!=="Center"&&w===0&&(s+=e.lineBreakAlignment==="Left"?-(k/2):k/2);var De=P?I?e.opposedPosition||m?0:c.height:N.breakLabelSize.width/2:0;if(b=P?S+h+e.lineStyle.width*.5:b,m&&w?P?a=y?r.y+b+De:r.y-b-De:a=y?r.y+b+u:r.y-b-u:(P?d=U?b+O+(w?De:3*u):-(b+O+De):d=U?b+O+(w?1:3)*u:-(b+O+(w?u:N.index>1?2*u:0)),a=r.y+d*N.index),P?p=this.getAnchor(e):p=n.enableRtl?oe?"":"end":n.isRtlEnabled||oe?"end":"",x=new gn(n.element.id+t+"_AxisLabel_"+ae,s,a,p),x.id=ne&&ie&&ie.children[ae]?ie.children[ae].id:x.id,w!==0&&($=Oc(N.labelStyle,N.originalText,w,n,n.themeStyle.axisLabelFont),A=w<0&&w>-90||w<-180&&w>-270||w>90&&w<180||w>270&&w<360),e.edgeLabelPlacement)switch(e.edgeLabelPlacement){case"None":break;case"Hide":if((ae===0||D&&ae===ye-1)&&x.x<r.x||(ae===ye-1||D&&ae===0)&&x.x+(w===0?k:$.width)>r.x+r.width)continue;break;case"Shift":if(ae===ye-2&&e.labelIntersectAction!=="MultipleRows"&&(p==="start"||p===""?l=x.x+k:p==="middle"?l=x.x+k/2:l=x.x),(ae===0||D&&ae===ye-1)&&(x.x<r.x||w!==0&&A&&x.x<r.x||e.lineBreakAlignment==="Center"&&x.x-N.size.width/N.text.length/2<r.x&&w===0))if(R-=r.x-x.x,p==="")x.x<=0?s=x.x=0:s=x.x,R=r.width/F;else if(A&&w!==0)R=r.width/F,r.x+R>x.x+$.width?x.x=s=r.x+b:x.x=s=r.x+R-b;else if(P&&e.lineBreakAlignment==="Center"&&e.labelPlacement==="OnTicks"&&w===0){for(var ve=0,ue=0;ue<N.text.length;ue++){var Tt=Ze(N.text[ue],e.labelStyle,n.themeStyle.axisLabelFont).width;Tt>ve&&(ve=Tt)}x.x=s=r.x+ve/2}else p==="start"&&x.x>0||(x.x=s=I?r.x:r.x+b);else if((ae===ye-1||D&&ae===0)&&(x.x+k>n.availableSize.width-n.border.width-te&&(p==="start"||p==="")&&w===0||p==="start"&&w!==0&&!A&&x.x+$.width>n.availableSize.width-n.border.width-te||p==="middle"&&w!==0&&!A&&x.x+$.width/2>n.availableSize.width-n.border.width-te||p==="end"&&w!==0&&!A&&x.x>n.availableSize.width-n.border.width-te||p==="end"&&x.x>n.availableSize.width-n.border.width-te&&w===0||p==="middle"&&x.x+k/2>n.availableSize.width-n.border.width-te&&w===0)){var _e=w!==0?$.width:k,lt=void 0,We=5;if(p==="start"||p===""?lt=x.x-(x.x+_e-n.availableSize.width+n.border.width+We+te):p==="middle"?lt=x.x-(x.x+_e/2-n.availableSize.width+n.border.width+We+te):lt=x.x-(x.x-(n.availableSize.width+n.border.width+We+te)),l!==0&&lt<l){var ct=n.availableSize.width-l;N.text=js(ct,N.originalText,e.labelStyle,n.isRtlEnabled,n.themeStyle.axisLabelFont)}else x.x=s=lt}break}x.text=this.getLabelText(N,e,R),x.labelRotation=w;var Dt=void 0,Xt=void 0;if(P&&w===0?e.lineBreakAlignment==="Right"?(Dt=x.x-k,Xt=x.x):e.lineBreakAlignment==="Center"?(Dt=x.x-k/2,Xt=x.x+k/2):(Dt=x.x,Xt=x.x+k):(Dt=x.x,Xt=x.x+k),!(w===0&&e.labelIntersectAction==="Hide"&&ae!==0&&(D?Xt>=T:Dt<=T))){if(P?e.lineBreakAlignment==="Right"?T=D?x.x-k:x.x:e.lineBreakAlignment==="Center"?T=D?x.x-k/2:x.x+k/2:T=D?x.x:x.x+k:T=D?x.x:x.x+k,w!==0){var Lt=void 0,Bi=void 0;if(P){var zi=0,Ct=0;Lt=N.breakLabelSize.height,Ct=N.breakLabelSize.height-4,e.lineBreakAlignment==="Center"?zi=-(N.breakLabelSize.width/2):e.lineBreakAlignment==="Right"&&(zi=-N.breakLabelSize.width),U&&(Ct=N.breakLabelSize.height/(x.text.length+1)),Bi=new Ae(x.x+zi,x.y-Ct,N.breakLabelSize.width,Lt)}else Lt=a-(x.y-N.size.height/2),Bi=new Ae(x.x,x.y-(N.size.height/2-5),N.size.width,Lt);var Ei=this.getRectanglePoints(Bi),ji=P?Bi.x+Bi.width/2:s,Ur=P?Bi.y+Bi.height/2:a-Lt/2;if(P?x.transform="rotate("+w+","+ji+","+Ur+")":x.transform="rotate("+w+","+s+","+a+")",z.push(xN(Ei,ji,Ur,w)),H=!1,e.labelIntersectAction!=="None"){for(var Fi=ae;Fi>0;Fi--)if(z[ae]&&z[Fi-1]&&XN(z[ae],z[Fi-1])){H=!0,z[ae]=null;break}}var Tr=w>0&&w<90||w>180&&w<270||w<-90&&w>-180||w<-270&&w>-360,_=new Ae(x.x,x.y-(c.height/2+b/2),N.size.width,Lt),Z=this.getRectanglePoints(_),we=[];we.push(new Je(Tr?this.chart.availableSize.width:this.padding,e.rect.y)),we.push(new Je(Tr?this.chart.availableSize.width:this.padding,e.rect.y+e.maxLabelSize.height)),Q.push(xN(Z,ji,Ur,w));for(var Te=new Ae(0,e.rect.y,this.chart.availableSize.width,e.maxLabelSize.height*2),je=0;je<Q[ae].length;je++)if(!e.opposedPosition&&!Oi(Q[ae][je].x,Q[ae][je].y,Te)&&typeof x.text=="string"){var He=this.calculateIntersection(Q[ae][0],Q[ae][1],we[0],we[1]),gt=Tr?this.chart.availableSize.width-s:s,Lr=He.y-e.rect.y,Ai=Math.sqrt(gt*gt+Lr*Lr);x.text=js(Ai,N.text,N.labelStyle,n.enableRtl,n.themeStyle.axisLabelFont)}}if(this.chart.redraw&&(n.pointsAdded&&!n.pointsRemoved||this.chart.zoomRedraw)&&!ce(x.id)&&ae!==0&&!this.chart.enableCanvas&&e.visible){var dn=x.x;x.x=this.seriesClipRect.x+(n.enableRtl!==e.isInversed?-(this.seriesClipRect.width/(ae||1)*L):this.seriesClipRect.width+this.seriesClipRect.width/(ae||1)*L);var tn=x.transform;x.transform=w?"rotate("+w+","+x.x+","+parseFloat(x.transform.split(",")[2])+")":"";var mn=hn(n.renderer,x,N.labelStyle,N.labelStyle.color||n.themeStyle.axisLabelFont.color,v,e.isAxisOpposedPosition!==(e.labelPosition==="Inside"),n.redraw,!0,null,n.duration,null,N.size,H,n.enableCanvas,null,n.themeStyle.axisLabelFont);this.rangeAnimate(e,mn,this.chart.duration,!0,new Ae(this.seriesClipRect.x,e.rect.y,this.seriesClipRect.x+this.seriesClipRect.width,this.chart.availableSize.height),!1,ae),x.x=dn,x.transform=tn,L+=1}var Sa=hn(n.renderer,x,N.labelStyle,N.labelStyle.color||n.themeStyle.axisLabelFont.color,v,e.isAxisOpposedPosition!==(e.labelPosition==="Inside"),n.redraw,!0,null,n.duration,null,N.size,H,n.enableCanvas,null,n.themeStyle.axisLabelFont,new Je(parseFloat(x.transform.split(",")[1]),parseFloat(x.transform.split(",")[2])));ne&&(Sa.id=n.element.id+t+"_AxisLabel_"+ae)}}if(this.previousXLabel&&F&&this.previousXLabel>F&&!this.chart.enableCanvas&&e.visible&&this.chart.zoomRedraw&&this.chart.redraw&&x.text)for(var ae=F;ae<this.previousXLabel;ae++)x.x=this.seriesClipRect.x+(n.enableRtl!==e.isInversed?-(this.seriesClipRect.width/F*(ae-F+1)):this.seriesClipRect.width+this.seriesClipRect.width/F*(ae-F+1)),x.id=n.element.id+t+"_AxisLabel_"+ae,x.transform=w?"rotate("+w+","+x.x+","+parseFloat(x.transform.split(",")[2])+")":"",this.updateAxisElement(e,t,"",ae,"_AxisLabel_",v,!0,x,N);else this.previousXLabel=F;this.chart.enableCanvas||(n.delayRedraw?e.visible&&e.internalVisibility&&this.createZoomingLabel(this.chart,v,e,t,r):i.appendChild(v))},o.prototype.updateAxisElement=function(e,t,i,r,n,s,a,l,h){var u,c=n.indexOf("Grid")>-1,d=n.indexOf("Label")>-1;d?u=hn(this.chart.renderer,l,h.labelStyle,h.labelStyle.color||this.chart.themeStyle.axisLabelFont.color,s,e.isAxisOpposedPosition!==(e.labelPosition==="Inside"),this.chart.redraw,!0,null,this.chart.duration,null,null,null,this.chart.enableCanvas,null,this.chart.themeStyle.axisLabelFont):(this.renderGridLine(e,t,i,c?e.majorGridLines:e.majorTickLines,n,r,this.element,c?this.chart.themeStyle.majorGridLine:this.chart.themeStyle.majorTickLine,c?e.majorGridLines.dashArray:null),this.element&&s.childNodes&&(u=this.element.childNodes[s.childNodes.length-1])),this.rangeAnimate(e,u,this.chart.duration,d,new Ae(e.orientation==="Vertical"?0:this.seriesClipRect.x,e.orientation==="Vertical"?this.seriesClipRect.y:e.rect.y,this.seriesClipRect.width,this.seriesClipRect.height),a,r)},o.prototype.removeAxisLabelElements=function(e,t){if(this.chart.pointsRemoved&&t&&t.childNodes.length){var i=!1;if(e.valueType.indexOf("Category")>-1){var r=[];e.visibleLabels.map(function(l){typeof l.text!="string"?r.push(l.text.join("")):r.push(l.text)});for(var n=t.childNodes.length-1;n>=0;n--){var s=t.childNodes[n];r.indexOf(s.textContent.trim())===-1&&(t.removeChild(s),i=!0)}}else if(t.childNodes.length>e.visibleLabels.length)for(var a=0;a<t.childNodes.length-e.visibleLabels.length;a++)t.removeChild(t.childNodes[a]),i=!0;return i}return!1},o.prototype.calculateIntersection=function(e,t,i,r){var n=i.x-r.x,s=e.x-t.x,a=i.y-r.y,l=e.y-t.y,h=s*a-l*n,u=e.x*t.y-e.y*t.x,c=i.x*r.y-i.y*r.x,d=(u*n-s*c)/h,p=(u*a-l*c)/h,f={x:d,y:p};return f},o.prototype.getAnchor=function(e){return e.lineBreakAlignment==="Center"?"middle":this.chart.enableRtl?e.lineBreakAlignment==="Left"?"end":"start":e.lineBreakAlignment==="Left"?"start":"end"},o.prototype.getRectanglePoints=function(e){var t=new Je(e.x,e.y),i=new Je(e.x+e.width,e.y),r=new Je(e.x+e.width,e.y+e.height),n=new Je(e.x,e.y+e.height);return[t,i,r,n]},o.prototype.getLabelText=function(e,t,i){if(Gh(e.originalText)){for(var r=[],n=void 0,s=0;s<e.text.length;s++)n=this.findAxisLabel(t,e.text[s],i),r.push(n);return r}else return this.findAxisLabel(t,e.text,i)},o.prototype.drawXAxisBorder=function(e,t,i,r){if(e.border.width>0){for(var n=e.labelPosition==="Outside"&&e.scrollbarSettings.position!=="Top"&&e.scrollbarSettings.position!=="Bottom"?e.scrollBarHeight:0,s=e.isAxisOpposedPosition,a=void 0,l=r.y+(s?-1:1)*n,h=10,u=void 0,c=r.width/e.visibleRange.delta*(e.valueType==="DateTime"?e.dateTimeInterval:e.visibleRange.interval),d=void 0,p=e.maxLabelSize.height+(e.tickPosition===e.labelPosition?e.majorTickLines.height:0),f="",v=e.valueType==="Category"&&e.labelPlacement==="BetweenTicks"?-.5:0,m=s&&e.labelPosition==="Inside"||!s&&e.labelPosition==="Outside"?r.y+p+h+n:r.y-p-h-n,y=0,S=e.visibleLabels.length;y<S;y++)switch(u=zn(e.visibleLabels[y].value+v,e),u=(e.isAxisInverse?1-u:u)*r.width,e.valueType==="Category"&&e.labelPlacement==="BetweenTicks"?(a=u+r.x,d=u+c+r.x):(a=u-c*.5+r.x,d=u+c*.5+r.x),e.border.type){case"Rectangle":case"WithoutTopBorder":a<r.x&&e.labelPlacement!=="OnTicks"?f+="M "+r.x+" "+m+" L "+d+" "+m+" ":Math.floor(d)>r.width+r.x&&e.visibleLabels.length!==1&&y!==e.visibleLabels.length-1?f+="M "+a+" "+l+" L "+a+" "+m+" L "+(r.width+r.x)+" "+m+" ":(a=y===0&&e.labelPlacement==="OnTicks"?r.x:a,d=y===e.visibleLabels.length-1&&e.labelPlacement==="OnTicks"?d-c*.5:d,f+="M "+a+" "+l+" L "+a+" "+m+" L "+d+" "+m+" ",y===0&&(f+="M "+a+" "+l+" L "+a+" "+m+" M "+a+" "+m+" L "+r.x+" "+m),y===e.visibleLabels.length-1&&(f+="M "+d+" "+l+" L "+d+" "+m+" M "+d+" "+m+" L "+(r.width+r.x)+" "+m));break;case"WithoutTopandBottomBorder":!(a<r.x)&&!(Math.floor(d)>r.width+r.x)&&(f+="M "+a+" "+l+" L "+a+" "+m+" M "+d+" "+l+" L "+d+" "+m);break}f+=e.border.type==="Rectangle"?"M  "+r.x+" "+l+"L "+(r.x+r.width)+" "+l:"",f!==""&&this.createAxisBorderElement(e,t,f,i)}for(var y=0;y<this.chart.visibleSeries.length;y++)if(this.chart.multiLevelLabelModule&&e.multiLevelLabels.length>0&&this.chart.visibleSeries[y].visible){this.chart.multiLevelLabelModule.renderXAxisMultiLevelLabels(e,t,i,r);break}},o.prototype.createAxisBorderElement=function(e,t,i,r){var n=ce(this.chart.element.id+"_BorderLine_"+t),s=n?n.getAttribute("d"):"",a=this.chart.renderer.drawPath(new Ir(this.chart.element.id+"_BorderLine_"+t,"transparent",e.border.width,e.border.color||this.chart.themeStyle.axisLine,1,"",i));a.style.pointerEvents="none",vt(this.chart.enableCanvas,r,a,this.chart.redraw,!1,"x","y",null,s,!0,null,null,this.chart.duration)},o.prototype.findAxisLabel=function(e,t,i){return e.labelIntersectAction==="Trim"&&e.angle%360===0&&!e.enableTrim?js(i,t,e.labelStyle,this.chart.enableRtl,this.chart.themeStyle.axisLabelFont):t},o.prototype.drawXAxisTitle=function(e,t,i,r){if(e.title){var n=this.chart,s=Ze(e.title,e.titleStyle,this.chart.themeStyle.axisTitleFont),a=g(e.crossesAt)&&e.scrollbarSettings.position!=="Top"&&e.scrollbarSettings.position!=="Bottom"?e.scrollBarHeight:0,l=(e.tickPosition==="Inside"?0:e.majorTickLines.height+e.titlePadding)+(e.labelPosition==="Inside"?0:e.maxLabelSize.height+e.multiLevelLabelHeight+e.labelPadding);l=e.tickPosition!=="Outside"&&(e.tickPosition==="Inside"||e.labelPosition==="Inside")?e.titlePadding===5?l:l+e.titlePadding:l;var h=e.titleSize.height*(e.titleCollection.length-1);l=e.isAxisOpposedPosition?-(l+s.height/4+a+h):l+3*s.height/4+a;var u=e.titleRotation?e.titleRotation:0,c=void 0,d=r.y+l,p=void 0;e.titleStyle.textAlignment==="Center"?(p="middle",c=r.x+r.width*.5):e.titleStyle.textAlignment==="Near"?(p="start",c=r.x):(p="end",c=r.x+r.width),u!==0&&(d+=e.opposedPosition?-(e.titleSize.height/2+s.height/4):e.titleSize.height/2-s.height/4);var f=new gn(n.element.id+"_AxisTitle_"+t,c,d,p,e.titleCollection,"rotate("+u+","+c+","+d+")",null,u),v=hn(n.renderer,f,e.titleStyle,e.titleStyle.color||n.themeStyle.axisTitleFont.color,i,null,n.redraw,n.redraw,null,null,null,null,null,n.enableCanvas,null,n.themeStyle.axisTitleFont,new Je(c,d));v.setAttribute("aria-hidden","true")}},o.prototype.renderGridLine=function(e,t,i,r,n,s,a,l,h,u,c){h===void 0&&(h=null),u===void 0&&(u=null),c===void 0&&(c=!1);var d=this.chart,p,f;r.width>0&&e.visible&&e.internalVisibility&&i&&(f=ce(d.element.id+n+t+"_"+(c?u:s)),p=f?f.getAttribute("d"):null,f=null,this.htmlObject=d.renderer.drawPath(new Ir(d.element.id+n+t+"_"+(c?u:s),"transparent",r.width,r.color||l,null,h,i)),vt(d.enableCanvas,a,this.htmlObject,d.redraw,!0,"x","y",null,p,!0,null,null,d.duration),c&&(this.htmlObject.id=d.element.id+n+t+"_"+s))},o.prototype.findParentNode=function(e,t,i){return document.getElementById(e+"AxisGroup"+i+"Inside").contains(document.getElementById(t.id))?document.getElementById(e+"AxisGroup"+i+"Inside"):document.getElementById(e+"AxisGroup"+i+"Outside")},o.prototype.createZoomingLabel=function(e,t,i,r,n){var s=this.findParentNode(e.element.id,t,r);t.setAttribute("opacity","0.3");var a=e.renderer.createGroup({id:e.element.id+"AxisLabels_Zoom"+r});a=XU(e,i,a,r,i.orientation==="Vertical",n),s.replaceChild(t,document.getElementById(t.id)),ce(e.element.id+"AxisLabels_Zoom"+r)?s.replaceChild(a,document.getElementById(a.id)):s.appendChild(a)},o}(),Jw=function(){function o(e){this.currentPoints=[],this.previousPoints=[],this.insideRegion=!1,this.commonXvalues=[],this.chart=e,this.lierIndex=0}return o.prototype.getData=function(){for(var e=this.chart,t=null,i=null,r,n,s,a,l=e.visibleSeries.length,h=l-1;h>=0;h--){if(i=e.visibleSeries[h],r=i.type==="Scatter"||i.drawType==="Scatter"||i.marker.visible?(i.marker.height+5)/2:0,n=i.type==="Scatter"||i.drawType==="Scatter"||i.marker.visible?(i.marker.width+5)/2:0,s=e.mouseX,a=e.mouseY,i.dragSettings.enable&&i.isRectSeries)if(!(i.type==="Bar"&&e.isTransposed)&&(e.isTransposed||i.type==="Bar")){var u=i.marker.width/2;s=i.yAxis.isAxisInverse?s+u:s-u}else{var c=i.marker.height/2;a=i.yAxis.isAxisInverse?a-c:a+c}if(i.visible&&Oi(s,a,i.clipRect,r,n)&&(t=this.getRectPoint(i,i.clipRect,s,a)),t)return new of(t,i)}return new of(t,i)},o.prototype.isSelected=function(e){return(e.selectionMode.indexOf("Drag")>-1||e.selectionMode.indexOf("Lasso")>-1)&&e.selectionModule&&e.selectionModule.rectPoints!==null},o.prototype.getRectPoint=function(e,t,i,r){var n=this.chart,s,a,l,h=0,u,c,d;if(n.isScrolling)return null;for(var p=0,f=e.points;p<f.length;p++){var v=f[p];if(!(!v.regionData&&(!v.regions||!v.regions.length))){if(v.regionData&&this.chart.chartAreaType==="PolarRadar"&&e.drawType.indexOf("Column")>-1&&(s=i-(e.clipRect.width/2+e.clipRect.x),a=r-(e.clipRect.height/2+e.clipRect.y),h=2*Math.PI*(v.regionData.currentXPosition<0?1+v.regionData.currentXPosition:v.regionData.currentXPosition),l=(Math.atan2(a,s)+.5*Math.PI-h)%(2*Math.PI),l=l<0?2*Math.PI+l:l,l=l+2*Math.PI*e.chart.primaryXAxis.startAngle,u=v.regionData.startAngle,u-=h,u=u<0?2*Math.PI+u:u,c=v.regionData.endAngle,c-=h,c=c<0?2*Math.PI+c:c,d=Math.sqrt(Math.pow(Math.abs(s),2)+Math.pow(Math.abs(a),2)),l>=u&&l<=c&&(d>=v.regionData.innerRadius&&d<=v.regionData.radius||d<=v.regionData.innerRadius&&d>=v.regionData.radius)&&d<=e.chart.radius))return v;if((e.dragSettings.enable&&e.isRectSeries||e.isRectSeries&&e.marker.visible&&this.chart.chartAreaType!=="PolarRadar")&&this.isPointInThresholdRegion(i,r,v,t,e))return this.insideRegion=!0,v;if(!this.insideRegion&&this.checkRegionContainsPoint(v.regions,t,i,r))return v;if(this.insideRegion&&this.checkRegionContainsPoint(v.regions,t,i,r))return v}}return null},o.prototype.checkRegionContainsPoint=function(e,t,i,r){var n=this;return e.some(function(s,a){return n.lierIndex=a,Oi(i,r,new Ae((n.chart.chartAreaType==="Cartesian"?t.x:0)+s.x,(n.chart.chartAreaType==="Cartesian"?t.y:0)+s.y,s.width,s.height))})},o.prototype.isPointInThresholdRegion=function(e,t,i,r,n){var s=this,a=n.type==="Bar",l=n.yAxis.isAxisInverse,h=n.chart.isTransposed,u=10,c=0,d=0,p,f=p=2*u;return l&&h?a?(c=i.regions[0].height-u,p=i.regions[0].width):(d=-u,f=i.regions[0].height):l||i.yValue<0?a?(d=-u,f=i.regions[0].height):(c=i.regions[0].height-u,p=i.regions[0].width):h?a?(c=-u,p=i.regions[0].width):(d=i.regions[0].width-u,f=i.regions[0].height):a?(d=i.regions[0].width-u,f=i.regions[0].height):(c=-u,p=i.regions[0].width),i.regions.some(function(v){return Oi(e,t,new Ae((s.chart.chartAreaType==="Cartesian"?r.x:0)+v.x+d,(s.chart.chartAreaType==="Cartesian"?r.y:0)+v.y+c,p,f))})},o.prototype.getClosest=function(e,t,i){var r,n,s=i||e.xData,a=s.length,l=.5,h=.5;if(e.xAxis.valueType==="DateTime"&&e.points.length===1){l=e.xAxis.visibleRange.min,h=e.xAxis.visibleRange.max;for(var u=0;u<e.chart.visibleSeries.length;u++){var c=e.chart.visibleSeries[u];c.xMin>=l&&c.xMin<e.xMin&&(l=c.xMin+.1),c.xMax<=h&&c.xMax>e.xMax&&(h=c.xMax-.1),c.visible&&c.points.length>1&&(c.xMax>=l&&c.xMax<e.xMin&&(l=c.xMax+.1),c.xMin<=h&&c.xMin>e.xMax&&(h=c.xMin-.1))}l!==e.xAxis.visibleRange.min&&(l=Math.abs(e.xMin-l)/2),h!==e.xAxis.visibleRange.max&&(h=Math.abs(e.xMax-h)/2)}if(t>=e.xMin-l&&t<=e.xMax+h)for(var d=0;d<a;d++)n=s[d],(r==null||Math.abs(n-t)<Math.abs(r-t))&&(r=n);var p=e.xData.indexOf(r)!==-1;return p?r:null},o.prototype.binarySearch=function(e,t){for(var i=0,r=t.length,n=-1,s=!1,a;s===!1&&i<=r;)a=Math.floor((i+r)/2),t[a].xValue===e?(s=!0,n=a):t[a].xValue>e?r=a-1:i=a+1;return n!==-1?t[n]:null},o.prototype.getClosestX=function(e,t,i){var r,n=t.clipRect;e.mouseX<=n.x+n.width&&e.mouseX>=n.x&&(e.requireInvertedAxis?r=ZN(e.mouseY-n.y,n.height,t.xAxis):r=KN(e.mouseX-n.x,n.width,t.xAxis));var s=this.getClosest(t,r,i),a=(s||s===0)&&t.points.length>0?this.binarySearch(s,qU(t.points,["xValue"])):null;return a&&a.visible&&this.chart.chartAreaType==="Cartesian"&&(t.category==="Indicator"&&t.name==="Histogram"||a.symbolLocations&&a.symbolLocations.length>0&&a.symbolLocations[0].x>=0&&a.symbolLocations[0].x<=n.width)?new of(a,t):null},o.prototype.mergeXvalues=function(e){if(e.length&&(!this.commonXvalues.length||this.commonXvalues.length!==e[0].xData.length)){this.commonXvalues=e[0].xData;for(var t=1;t<e.length;t++)this.commonXvalues=this.getDistinctValues(this.commonXvalues,e[t].xData)}return this.commonXvalues},o.prototype.commonXValue=function(e){for(var t=[],i=0;i<e.length;i++)for(var r=0;e[i].points&&r<e[i].points.length;r++){var n=e[i].points[r];n&&(n.index===0||n.index===e[i].points.length-1||n.symbolLocations&&n.symbolLocations.length>0)&&t.push(n.xValue)}return t},o.prototype.getDistinctValues=function(e,t){e===void 0&&(e=[]),t===void 0&&(t=[]);var i={},r=[],n;for(n=0;n<e.length;n++){var s=e[n];i[s]||(i[s]=!0,r.push(s))}for(n=0;n<t.length;n++){var s=t[n];i[s]||(i[s]=!0,r.push(s))}return r},o.prototype.findMouseValues=function(e,t,i){t.requireInvertedAxis?(i.valueY=(1-zn(e.point.xValue,e.series.xAxis))*e.series.xAxis.rect.height+e.series.xAxis.rect.y,i.valueX=t.mouseX,t.crosshair.snapToData&&(e.series.type==="BoxAndWhisker"&&e.point.regions.length?i.valueX=e.point.regions[0].x+e.series.clipRect.x:t.tooltip.shared?t.crosshairModule.valueX=e.point.symbolLocations[0].x+e.series.clipRect.x:i.valueX=e.point.symbolLocations[0].x+e.series.clipRect.x)):(t.chartAreaType==="PolarRadar"?i.valueX=$N(e.point.xValue,e.series.xAxis)*e.series.xAxis.rect.width+e.series.xAxis.rect.x:i.valueX=e.series.category==="TrendLine"&&t.tooltip.shared?i.valueX:zn(e.point.xValue,e.series.xAxis)*e.series.xAxis.rect.width+e.series.xAxis.rect.x,i.valueY=t.mouseY,t.crosshair.snapToData&&(e.series.type==="BoxAndWhisker"&&e.point.regions.length?i.valueY=e.point.regions[0].y+e.series.clipRect.y:i.valueY=e.point.symbolLocations[0].y+e.series.clipRect.y))},o}(),cl=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),xe=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},vW=function(o){cl(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return xe([C(!1)],e.prototype,"visible",void 0),xe([C(!0)],e.prototype,"showZero",void 0),xe([C(null)],e.prototype,"name",void 0),xe([C("transparent")],e.prototype,"fill",void 0),xe([C(null)],e.prototype,"format",void 0),xe([C(1)],e.prototype,"opacity",void 0),xe([C(0)],e.prototype,"angle",void 0),xe([C(!1)],e.prototype,"enableRotation",void 0),xe([C("Auto")],e.prototype,"position",void 0),xe([C(5)],e.prototype,"rx",void 0),xe([C(5)],e.prototype,"ry",void 0),xe([C("Center")],e.prototype,"alignment",void 0),xe([be({width:null,color:null},Zn)],e.prototype,"border",void 0),xe([be({left:5,right:5,top:5,bottom:5},Hc)],e.prototype,"margin",void 0),xe([be({size:null,color:null,fontStyle:null,fontWeight:null,fontFamily:null},ua)],e.prototype,"font",void 0),xe([C(null)],e.prototype,"template",void 0),xe([C("Hide")],e.prototype,"labelIntersectAction",void 0),e}(Re),ex=function(o){cl(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return xe([C(!1)],e.prototype,"visible",void 0),xe([C(null)],e.prototype,"shape",void 0),xe([C("")],e.prototype,"imageUrl",void 0),xe([C(5)],e.prototype,"height",void 0),xe([C(!1)],e.prototype,"isFilled",void 0),xe([C(5)],e.prototype,"width",void 0),xe([be({width:2,color:null},Zn)],e.prototype,"border",void 0),xe([be({x:0,y:0},bU)],e.prototype,"offset",void 0),xe([C(null)],e.prototype,"fill",void 0),xe([C(!0)],e.prototype,"allowHighlight",void 0),xe([C(1)],e.prototype,"opacity",void 0),xe([be({},vW)],e.prototype,"dataLabel",void 0),e}(Re),mW=function(o){cl(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return xe([C(null)],e.prototype,"fill",void 0),xe([C(1)],e.prototype,"width",void 0),xe([C("0")],e.prototype,"dashArray",void 0),xe([be(null,ex)],e.prototype,"marker",void 0),xe([C(!0)],e.prototype,"showAxis",void 0),e}(Re),Xw=function(){function o(){this.symbolLocations=null,this.regions=null,this.percentage=null,this.regionData=null,this.isSelect=!1,this.marker={visible:!1},this.isPointInRange=!0,this.verticalError=null,this.verticalNegativeError=null,this.horizontalError=null,this.horizontalNegativeError=null,this.verticalPositiveError=null,this.horizontalPositiveError=null}return o}(),yW=function(o){cl(e,o);function e(){var t=o!==null&&o.apply(this,arguments)||this;return t.clipRect=new Ae(0,0,0,0),t}return e.prototype.setDataSource=function(t,i){t&&(this.points=t.points),i.trendLineModule.initDataSource(this),i.visibleSeriesCount++},xe([C("")],e.prototype,"name",void 0),xe([C("")],e.prototype,"dashArray",void 0),xe([C(!0)],e.prototype,"visible",void 0),xe([C("Linear")],e.prototype,"type",void 0),xe([C(2)],e.prototype,"period",void 0),xe([C(2)],e.prototype,"polynomialOrder",void 0),xe([C(0)],e.prototype,"backwardForecast",void 0),xe([C(0)],e.prototype,"forwardForecast",void 0),xe([be({},$w)],e.prototype,"animation",void 0),xe([be({},ex)],e.prototype,"marker",void 0),xe([C(!0)],e.prototype,"enableTooltip",void 0),xe([C(null)],e.prototype,"intercept",void 0),xe([C("")],e.prototype,"fill",void 0),xe([C(1)],e.prototype,"width",void 0),xe([C("SeriesType")],e.prototype,"legendShape",void 0),xe([be({},So)],e.prototype,"accessibility",void 0),e}(Re),bW=function(o){cl(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return xe([C(1)],e.prototype,"width",void 0),xe([C(10)],e.prototype,"length",void 0),xe([C(null)],e.prototype,"color",void 0),xe([C(1)],e.prototype,"opacity",void 0),e}(Re),SW=function(o){cl(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return xe([C(null)],e.prototype,"value",void 0),xe([C(null)],e.prototype,"color",void 0),xe([C("0")],e.prototype,"dashArray",void 0),e}(Re),CW=function(o){cl(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return xe([C(!1)],e.prototype,"visible",void 0),xe([C("Fixed")],e.prototype,"type",void 0),xe([C("Both")],e.prototype,"direction",void 0),xe([C("Vertical")],e.prototype,"mode",void 0),xe([C(null)],e.prototype,"color",void 0),xe([C(1)],e.prototype,"verticalError",void 0),xe([C(1)],e.prototype,"width",void 0),xe([C(1)],e.prototype,"horizontalError",void 0),xe([C(3)],e.prototype,"verticalPositiveError",void 0),xe([C(3)],e.prototype,"verticalNegativeError",void 0),xe([C(1)],e.prototype,"horizontalPositiveError",void 0),xe([C(1)],e.prototype,"horizontalNegativeError",void 0),xe([be(null,bW)],e.prototype,"errorBarCap",void 0),xe([C("")],e.prototype,"errorBarColorMapping",void 0),e}(Re),hF=function(o){cl(e,o);function e(){var t=o!==null&&o.apply(this,arguments)||this;return t.rangeColorPoints=[],t.isAdvancedColor=void 0,t.currentViewData=[],t.clipRect=new Ae(0,0,0,0),t.seriesType="XY",t.isRectTypeSeries=!1,t.removedPointIndex=null,t.isLegendClicked=!1,t}return e.prototype.processJsonData=function(){var t=0,i=new Xw,r=this instanceof Hr&&this.type==="Histogram"?"x":this.xName,n=this instanceof Hr&&this.marker.dataLabel.name?this.marker.dataLabel.name:"";this instanceof Hr&&((this.type==="Waterfall"||this.type==="Histogram")&&(this.currentViewData=this.chart[$r(this.type)+"SeriesModule"].processInternalData(he([],this.currentViewData,null,!0),this)),this.category==="Pareto"&&(this.currentViewData=he([],this.currentViewData,null,!0),this.type==="Line"&&(this.currentViewData=this.chart.paretoSeriesModule.performCumulativeCalculation(this.currentViewData,this))),this.isRectTypeSeries=this.type.indexOf("Column")>-1||this.type.indexOf("Bar")>-1||this.type.indexOf("Histogram")>-1);var s=(this.currentViewData||[]).length;if(this.points=[],this.xMin=1/0,this.xMax=-1/0,this.yMin=1/0,this.yMax=-1/0,this.sizeMax=-1/0,this.getSeriesType(),this.xAxis.valueType==="Category")for(;t<s;)this.pushCategoryPoint(i,t,n,r),t++;else if(this.xAxis.valueType.indexOf("DateTime")>-1)for(var a={skeleton:"full",type:"dateTime"},l=this.chart.intl.getDateParser(a),h=this.chart.intl.getDateFormat(a);t<s;)this.pushDateTimePoint(i,t,n,r,l,h),t++;else for(;t<s;)this.pushDoublePoint(i,t,n,r),t++;this.updateSplineValue(),this.updateYAxisForErrorBars(),this instanceof Hr&&this.type==="Waterfall"&&g(this.yAxis.minimum)&&(this.yMin=Math.min.apply(Math,this.chart.waterfallSeriesModule.cumulativeSums))},e.prototype.updateYAxisForErrorBars=function(){if(this instanceof Hr&&this.chart.errorBarModule){var t=void 0,i=void 0;if(this.errorBar.verticalError)for(var r=0;r<this.points.length;r++){for(var n=[],s=[],a=0;a<this.points.length;a++){var l=this.points[a];l.verticalError&&(n.push(l.verticalError),s.push(l.yValue-l.verticalError))}t=n&&n.length>0?Math.max.apply(Math,n):0,i=n&&n.length>0?Math.min.apply(Math,s):0}this.yMax+=!isNaN(t)&&g(this.yAxis.maximum)?t:0,this.yMin=!isNaN(i)&&i<0&&g(this.yAxis.minimum)?i:0}},e.prototype.pushCategoryPoint=function(t,i,r,n){t=this.dataPoint(i,r,n),this.pushCategoryData(t,i,t.x),this.pushData(t,i),this.setEmptyPoint(t,i),this.rangeColorsInterior(t)},e.prototype.pushDoublePoint=function(t,i,r,n){t=this.dataPoint(i,r,n),t.xValue=t.x,this.pushData(t,i),this.setEmptyPoint(t,i)},e.prototype.pushDateTimePoint=function(t,i,r,n,s,a){t=this.dataPoint(i,r,n),!g(t.x)&&t.x!==""?(t.x=new Date(de.parse.parseJson({val:t.x}).val),this.xAxis.valueType==="DateTime"?t.xValue=Date.parse(t.x.toString()):this.chart.isBlazor?this.pushCategoryData(t,i,Date.parse(t.x.toString()).toString()):this.pushCategoryData(t,i,Date.parse(s(a(t.x))).toString()),this.pushData(t,i),this.setEmptyPoint(t,i)):t.visible=!1},e.prototype.updateSplineValue=function(){if(this instanceof Hr&&!(this.chart.stockChart&&this.xAxis.valueType==="DateTimeCategory")){if(this.type.indexOf("Spline")>-1||this.drawType.indexOf("Spline")>-1&&this.chart.chartAreaType==="PolarRadar"){var t=this.type.indexOf("Area")>-1||this.drawType.indexOf("Area")>-1,i=this.type.indexOf("Range")>-1;this.chart["spline"+(t?i?"RangeArea":"Area":"")+"SeriesModule"].findSplinePoint(this)}else this.type.indexOf("Histogram")>-1&&(this.xAxis.maximum||this.xAxis.minimum)&&this.chart.histogramSeriesModule.calculateBinValues(this);this.type.indexOf("Histogram")>-1&&this.points.length===1&&(this.xMin=this.xMin-this.histogramValues.binWidth,this.xMax=this.xMax+this.histogramValues.binWidth)}},e.prototype.rangeColorsInterior=function(t){this.chart.rangeColorSettings&&this.chart.rangeColorSettings.length>0&&this.chart.visibleSeries.length===1&&(this.chart.series[0].type==="Column"||this.chart.series[0].type==="Bar"||this.chart.series[0].type==="Scatter"||this.chart.series[0].type==="Bubble")&&(this.rangeColorPoints[t.interior]?this.rangeColorPoints[t.interior]!==void 0&&this.rangeColorPoints[t.interior].push(t):this.rangeColorPoints[t.interior]=[])},e.prototype.pushData=function(t,i){t.index=i,t.yValue=t.y,t.series=this,this.xMin=Math.min(this.xMin,t.xValue),this.xMax=Math.max(this.xMax,t.xValue),this.xData.push(t.xValue)},e.prototype.dataPoint=function(t,i,r){this.points[t]=new Xw;var n=this.points[t],s=this.currentViewData[t],a=this.enableComplexProperty?V:this.getObjectValue;return n.x=a(r,s),n.high=a(this.high,s),n.low=a(this.low,s),n.open=a(this.open,s),n.close=a(this.close,s),n.volume=a(this.volume,s),n.interior=a(this.pointColorMapping,s),this instanceof Hr&&(this.errorBar.visible&&(n.errorBarColor=a(this.errorBar.errorBarColorMapping,s),n.verticalError=typeof this.errorBar.verticalError=="string"?a(this.errorBar.verticalError,s):this.errorBar.verticalError,n.horizontalError=typeof this.errorBar.horizontalError=="string"?a(this.errorBar.horizontalError,s):this.errorBar.horizontalError,n.verticalNegativeError=typeof this.errorBar.verticalNegativeError=="string"?a(this.errorBar.verticalNegativeError,s):this.errorBar.verticalNegativeError,n.verticalPositiveError=typeof this.errorBar.verticalPositiveError=="string"?a(this.errorBar.verticalPositiveError,s):this.errorBar.verticalPositiveError,n.horizontalNegativeError=typeof this.errorBar.horizontalNegativeError=="string"?a(this.errorBar.horizontalNegativeError,s):this.errorBar.horizontalNegativeError,n.horizontalPositiveError=typeof this.errorBar.horizontalPositiveError=="string"?a(this.errorBar.horizontalPositiveError,s):this.errorBar.horizontalPositiveError),n.y=a(this.yName,s),n.size=a(this.size,s),n.text=a(i,s),n.tooltip=a(this.tooltipMappingName,s),this.isAdvancedColorSupported()&&(this.rangeColorName=this.colorName.length>0?this.colorName:this.yName,n.colorValue=a(this.rangeColorName,s),n.interior=this.getPointFillColor(n.interior,n.colorValue))),n},e.prototype.isAdvancedColorSupported=function(){return g(this.isAdvancedColor)&&(this.chart.rangeColorSettings&&this.chart.rangeColorSettings.length>0&&(this.chart.series[0].type==="Column"||this.chart.series[0].type==="Bar"||this.chart.series[0].type==="Scatter"||this.chart.series[0].type==="Bubble")?this.isAdvancedColor=!0:this.isAdvancedColor=!1),this.isAdvancedColor},e.prototype.getPointFillColor=function(t,i){var r=t;if(i&&this.chart.rangeColorSettings&&this.chart.rangeColorSettings.length>0)for(var n=0,s=this.chart.rangeColorSettings;n<s.length;n++){var a=s[n];i>=a.start&&i<=a.end&&(a.colors.length>1?r=dW(a,i):r=a.colors[0])}return r},e.prototype.getObjectValue=function(t,i){return i[t]},e.prototype.setEmptyPoint=function(t,i){if(!this.findVisibility(t))return t.visible=!0,null;t.isEmpty=!0;var r=this instanceof Hr&&t.isPointInRange?this.emptyPointSettings.mode:"Drop";switch(r){case"Zero":t.visible=!0,this instanceof Hr&&this.seriesType.indexOf("HighLow")>-1?(t.high=t.low=0,this.seriesType.indexOf("HighLowOpenClose")>-1&&(t.open=t.close=0)):t.y=t.yValue=this.yData[i]=0;break;case"Average":this instanceof Hr&&(this.seriesType.indexOf("HighLow")>-1?(t.high=g(t.high)||isNaN(+t.high)?this.getAverage(this.high,i):t.high,t.low=g(t.low)||isNaN(+t.low)?this.getAverage(this.low,i):t.low,this.seriesType.indexOf("HighLowOpenClose")>-1&&(t.open=g(t.open)||isNaN(+t.open)?this.getAverage(this.open,i):t.open,t.close=g(t.close)||isNaN(+t.close)?this.getAverage(this.close,i):t.close)):t.y=t.yValue=this.yData[i]=this.getAverage(this.yName,i)),t.visible=!0;break;case"Drop":case"Gap":this.yData[i]=null,t.visible=!1;break}},e.prototype.findVisibility=function(t){var i=this instanceof Hr?this.seriesType:"HighLowOpenClose",r,n=this.yAxis.minimum,s=this.yAxis.maximum;switch(i){case"XY":return this.chart.chartAreaType==="PolarRadar"&&(!g(n)&&t.yValue<n||!g(s)&&t.yValue>s)?(t.isPointInRange=!1,!0):(this.setXYMinMax(t.yValue),this.yData.push(t.yValue),this instanceof Hr&&this.type==="Bubble"&&(this.sizeMax=Math.max(this.sizeMax,g(t.size)||isNaN(+t.size)?this.sizeMax:t.size)),g(t.x)||g(t.y)||isNaN(+t.y));case"HighLow":return this.setHiloMinMax(t.high,t.low),g(t.x)||g(t.low)||isNaN(+t.low)||g(t.high)||isNaN(+t.high);case"HighLowOpenClose":return this.setHiloMinMax(t.high,t.low),g(t.x)||g(t.low)||isNaN(+t.low)||g(t.open)||isNaN(+t.open)||g(t.close)||isNaN(+t.close)||g(t.high)||isNaN(+t.high);case"BoxPlot":return r=(t.y||[null]).filter(function(a){return!g(a)&&!isNaN(a)}).sort(function(a,l){return a-l}),t.y=r,this.yMin=Math.min(this.yMin,Math.min.apply(Math,r)),this.yMax=Math.max(this.yMax,Math.max.apply(Math,r)),!r.length}},e.prototype.setXYMinMax=function(t){var i=this.yAxis.valueType==="Logarithmic"||this.xAxis.valueType==="Logarithmic",r=t<0||this.yAxis.rangePadding==="None",n;this.isRectTypeSeries&&!Bs(this.yAxis)?n=i||r?t:0:n=t,this.yMin=i?Math.min(this.yMin,g(n)||isNaN(n)||n===0||n.toString()==="0"||n.toString()===""?this.yMin:n):Math.min(this.yMin,g(n)||isNaN(n)?this.yMin:n),this.yMax=Math.max(this.yMax,g(t)||isNaN(t)?this.yMax:t)},e.prototype.setHiloMinMax=function(t,i){this.yMin=Math.min(this.yMin,Math.min(g(i)||isNaN(i)?this.yMin:i,g(t)||isNaN(t)?this.yMin:t)),this.yMax=Math.max(this.yMax,Math.max(g(i)||isNaN(i)?this.yMax:i,g(t)||isNaN(t)?this.yMax:t))},e.prototype.getSeriesType=function(){var t;if(this instanceof Hr){var i=this.chart.chartAreaType==="PolarRadar"?this.drawType:this.type;if(i)switch(i){case"RangeColumn":case"RangeArea":case"RangeStepArea":case"SplineRangeArea":case"Hilo":t="HighLow";break;case"HiloOpenClose":case"Candle":t="HighLowOpenClose";break;case"BoxAndWhisker":t="BoxPlot";break;default:t="XY"}}this.seriesType=t},e.prototype.pushCategoryData=function(t,i,r){if(!this.chart.tooltip.shared&&!this.visible)return null;this.xAxis.isIndexed?(this.xAxis.labels[i]?this.xAxis.labels[i]+=", "+r:this.xAxis.labels.push(r),t.xValue=i):(this.xAxis.indexLabels[r]===void 0&&(this.xAxis.indexLabels[r]=this.xAxis.labels.length,this.xAxis.labels.push(r)),t.xValue=this.xAxis.indexLabels[r])},e.prototype.getAverage=function(t,i,r){r===void 0&&(r=this.currentViewData);var n=r[i-1]&&r[i-1][t]||0,s=r[i+1]&&r[i+1][t]||0;return(n+s)/2},e.prototype.refreshDataManager=function(t){var i=this;this.chart=t;var r,n="isAngular";if(t[n]?r=Object.keys(this.dataSource).length?this.dataSource:t.dataSource:r=this.dataSource||t.dataSource,!(r instanceof re)&&g(this.query)){this.dataManagerSuccess({result:r,count:r.length},!1);return}var s=this.dataModule.getData(this.dataModule.generateQuery().requiresCount());s.then(function(a){return i.dataManagerSuccess(a)})},e.prototype.dataManagerSuccess=function(t,i){if(i===void 0&&(i=!0),this.currentViewData=t.count?t.result:[],this.chart.allowServerDataBinding=!1,this instanceof Hr){this.chart.stockChart&&(this.chart.stockChart.series[this.index].localData=this.currentViewData);var r={name:Hm,series:this,data:this.currentViewData,fill:this.interior};this.chart.trigger(Hm,r),this.interior=r.fill,this.currentViewData=r.data}this.chart.stockChart&&!(this instanceof Hr)&&(this.currentViewData=this.chart.stockChart.findCurrentData(this.chart.stockChart.series[0].localData,this.chart.stockChart.series[0].xName)),this.processJsonData(),this.recordsCount=t.count,this.refreshChart(i),this.currentViewData=null},e.prototype.refreshChart=function(t){var i=this.chart;if(this instanceof Hr&&(i.visibleSeriesCount+=t?1:0),i.refreshTechnicalIndicator(this),this instanceof Hr&&this.category!=="TrendLine")for(var r=0,n=this.trendlines;r<n.length;r++){var s=n[r];s.setDataSource(this,i)}i.visibleSeries.length===i.visibleSeriesCount&&(i.refreshBound(),i.trigger("loaded",{chart:i.isBlazor?{}:i}),this.chart.stockChart&&this.chart.stockChart.initialRender&&(this.chart.stockChart.initialRender=!1,this.chart.stockChart.stockChartDataManagerSuccess())),this instanceof Hr&&(i.visibleSeriesCount+=t?0:1)},xe([C("")],e.prototype,"xName",void 0),xe([C("")],e.prototype,"colorName",void 0),xe([C("")],e.prototype,"high",void 0),xe([C("")],e.prototype,"low",void 0),xe([C("")],e.prototype,"open",void 0),xe([C("")],e.prototype,"close",void 0),xe([C("")],e.prototype,"volume",void 0),xe([C("")],e.prototype,"pointColorMapping",void 0),xe([C(!0)],e.prototype,"visible",void 0),xe([C(null)],e.prototype,"xAxisName",void 0),xe([C(null)],e.prototype,"yAxisName",void 0),xe([be(null,$w)],e.prototype,"animation",void 0),xe([C(null)],e.prototype,"fill",void 0),xe([C(1)],e.prototype,"width",void 0),xe([C("")],e.prototype,"dashArray",void 0),xe([C("")],e.prototype,"dataSource",void 0),xe([C()],e.prototype,"query",void 0),xe([Wt([],SW)],e.prototype,"segments",void 0),xe([C("X")],e.prototype,"segmentAxis",void 0),xe([C(!1)],e.prototype,"enableComplexProperty",void 0),e}(Re),Hr=function(o){cl(e,o);function e(t,i,r,n){var s=o.call(this,t,i,r,n)||this;return s.visibleSeriesCount=0,s.category="Series",s.isRectSeries=!1,s.drawPoints=[],s.lowDrawPoints=[],s.delayedAnimation=!1,s.rangeColorName=s.colorName.length>0?s.colorName:s.yName,s.currentData=[],s}return e.prototype.refreshAxisLabel=function(){if(this.xAxis.valueType.indexOf("Category")===-1)return null;this.xAxis.labels=[],this.xAxis.indexLabels={};for(var t={skeleton:"full",type:"dateTime"},i=this.chart.intl.getDateParser(t),r=this.chart.intl.getDateFormat(t),n=0,s=this.xAxis.series;n<s.length;n++){var a=s[n];if(a.visible&&a.category!=="TrendLine"){a.xMin=1/0,a.xMax=-1/0;for(var l=0,h=a.points;l<h.length;l++){var u=h[l];a.pushCategoryData(u,u.index,this.xAxis.valueType==="DateTimeCategory"?Date.parse(i(r(u.x))).toString():u.x),a.xMin=Math.min(a.xMin,u.xValue),a.xMax=Math.max(a.xMax,u.xValue)}}}},e.prototype.findSeriesCollection=function(t,i,r){for(var n=[],s=0,a=i.axes;s<a.length;s++)for(var l=a[s],h=0,u=l.series;h<u.length;h++)for(var c=u[h],d=0,p=t.axes;d<p.length;d++)for(var f=p[d],v=0,m=f.series;v<m.length;v++){var y=m[v];y===c&&y.visible&&this.rectSeriesInChart(y,r)&&n.push(y)}return n},e.prototype.rectSeriesInChart=function(t,i){var r=t.type.toLowerCase();return r.indexOf("column")!==-1||r.indexOf("bar")!==-1||r.indexOf("histogram")!==-1||r.indexOf("hiloopenclose")!==-1||r.indexOf("candle")!==-1||r.indexOf("pareto")!==-1||r.indexOf("hilo")!==-1||t.drawType.indexOf("Column")!==-1||r.indexOf("waterfall")!==-1||r.indexOf("boxandwhisker")!==-1||i},e.prototype.calculateStackedValue=function(t,i){for(var r=0,n=i.columns;r<n.length;r++)for(var s=n[r],a=0,l=i.rows;a<l.length;a++){var h=l[a];this.calculateStackingValues(this.findSeriesCollection(s,h,!0),t)}},e.prototype.calculateStackingValues=function(t,i){var r,n,s=[],a=[],l=[],h,u,c,d=[];i&&(d=this.findFrequencies(t));for(var p=[],f=[],v=0;v<t.length;v++){var m=t[v];p[m.stackingGroup]?p[m.stackingGroup]!==void 0&&p[m.stackingGroup].push(m):(p[m.stackingGroup]=[],p[m.stackingGroup].push(m))}for(var y=Object.keys(p),S=0;S<y.length;S++){for(var b=[],w=[],I=p[y[S]],x=0,M=I;x<M.length;x++){var m=M[x];if(m.type.indexOf("Stacking")!==-1||m.drawType.indexOf("Stacking")!==-1&&m.chart.chartAreaType==="PolarRadar"){h=m.type.indexOf("StackingArea")!==-1?"StackingArea100":m.type.indexOf("StackingLine")!==-1?"StackingLine100":m.stackingGroup,a[h]||(a[h]=[],l[h]=[]),s=m.yData,r=[],n=[],b.push(m),f=Kl(m);for(var D=0,A=f.length;D<A;D++)u=0,c=+s[D],a[h][f[D].xValue]===void 0&&(a[h][f[D].xValue]=0),l[h][f[D].xValue]===void 0&&(l[h][f[D].xValue]=0),i?(c=c/d[h][f[D].xValue]*100,c=isNaN(c)?0:c,f[D].percentage=+c.toFixed(2)):w[D]=w[D]?w[D]+Math.abs(c):Math.abs(c),c>=0?(u=a[h][f[D].xValue],a[h][f[D].xValue]+=c):(u=l[h][f[D].xValue],l[h][f[D].xValue]+=c),r.push(u),n.push(c+u),i&&n[D]>100&&(n[D]=100);m.stackedValues=new cW(r,n);var L=m.yAxis.valueType==="Logarithmic",T=m.type.indexOf("Column")!==-1||m.type.indexOf("Bar")!==-1;m.yMin=L&&T&&m.yMin<1?m.yMin:m.yAxis.startFromZero&&m.yAxis.rangePadding==="Auto"&&m.yMin>=0?0:parseFloat(Math.min.apply(0,i?r:n).toFixed(10)),m.yMax=Math.max.apply(0,n),m.yMin>Math.min.apply(0,n)&&(m.yMin=i?-100:L&&T&&m.yMin<1?m.yMin:Math.min.apply(0,n)),m.yMax<Math.max.apply(0,r)&&(m.yMax=0)}}this.findPercentageOfStacking(b,w,i)}},e.prototype.findPercentageOfStacking=function(t,i,r){for(var n=0,s=t;n<s.length;n++){var a=s[n];if(r)return null;for(var l=0,h=Kl(a);l<h.length;l++){var u=h[l];u.percentage=Math.abs(+(u.y/i[u.index]*100).toFixed(2))}}},e.prototype.findFrequencies=function(t){for(var i=[],r,n=[],s=0,a=t;s<a.length;s++){var l=a[s];if(l.yAxis.isStack100=l.type.indexOf("100")!==-1,n=Kl(l),l.type.indexOf("Stacking")!==-1){r=l.type.indexOf("StackingArea")!==-1?"StackingArea100":l.type.indexOf("StackingLine")!==-1?"StackingLine100":l.stackingGroup,i[r]||(i[r]=[]);for(var h=0,u=n.length;h<u;h++)i[r][n[h].xValue]===void 0&&(i[r][n[h].xValue]=0),l.yData[h]>0?i[r][n[h].xValue]+=l.yData[h]:i[r][n[h].xValue]-=l.yData[h]}}return i},e.prototype.renderSeries=function(t){if(this.chart.stockChart&&this.xAxis.valueType==="DateTimeCategory"){for(var i=0;i<this.points.length;i++){var r=this.xAxis.labels.indexOf(Date.parse(this.points[i].x.toString()).toString());this.points[i].xValue=r,t.series.length>1&&(this.xData[i]=r,this.xMin=this.xMin>r?r:this.xMin,this.xMax=this.xMax<r?r:this.xMax)}if(this instanceof e&&this.type.indexOf("Spline")>-1){var n=this.type.indexOf("Area")>-1,s=this.type.indexOf("Range")>-1;this.chart["spline"+(n?s?"RangeArea":"Area":"")+"SeriesModule"].findSplinePoint(this)}}var a=$r(this.type);a=a.replace("100",""),t[a+"SeriesModule"]&&(this.category!=="Indicator"&&this.category!=="TrendLine"&&this.createSeriesElements(t),this.visiblePoints=Kl(this),this.chart.enableCanvas?(this.chart.canvasRender.ctx.save(),this.chart.canvasRender.ctx.beginPath(),t.requireInvertedAxis?this.chart.canvasRender.ctx.rect(this.yAxis.rect.x,this.xAxis.rect.y,this.yAxis.rect.width,this.xAxis.rect.height):this.chart.canvasRender.ctx.rect(this.xAxis.rect.x,this.yAxis.rect.y,this.xAxis.rect.width,this.yAxis.rect.height),this.chart.canvasRender.ctx.clip(),t[a+"SeriesModule"].render(this,this.xAxis,this.yAxis,t.requireInvertedAxis),this.chart.canvasRender.ctx.restore()):t[a+"SeriesModule"].render(this,this.xAxis,this.yAxis,t.requireInvertedAxis),this.category!=="Indicator"&&(this.errorBar.visible&&this.chart.errorBarModule.render(this),this.marker.dataLabel.visible&&(this.chart.enableCanvas?(this.chart.canvasRender.ctx.save(),this.chart.canvasRender.ctx.beginPath(),t.requireInvertedAxis?this.chart.canvasRender.ctx.rect(this.yAxis.rect.x,this.xAxis.rect.y,this.yAxis.rect.width,this.xAxis.rect.height):this.chart.canvasRender.ctx.rect(this.xAxis.rect.x,this.yAxis.rect.y,this.xAxis.rect.width,this.yAxis.rect.height),this.chart.canvasRender.ctx.clip(),t.dataLabelModule.render(this,this.chart,this.marker.dataLabel),this.chart.canvasRender.ctx.restore()):t.dataLabelModule.render(this,this.chart,this.marker.dataLabel)),this.appendSeriesElement(t.seriesElements,t)),this.chart.enableCanvas||this.performAnimation(t,a,this.errorBar,this.marker,this.marker.dataLabel))},e.prototype.createSeriesElements=function(t){if(this.category!=="Indicator"){var i=t.element.id,r=this.marker.border.width+8+5,n=this.type==="Bubble"||!this.marker.visible&&t.tooltip.shared&&t.enableCanvas?t.svgRenderer:t.renderer,s=this.index===void 0?this.category:this.index,a=void 0,l=void 0,h=void 0;if(this.type==="Scatter"||this.drawType==="Scatter"?(a=(this.marker.height+r)/2,l=(this.marker.width+r)/2):(a=0,l=0),t.chartAreaType==="PolarRadar"){var u=this.drawType==="Scatter"?Math.max(this.marker.width,this.marker.height):0;h=new $m(i+"_ChartSeriesClipRect_"+s,"transparent",{width:1,color:"Gray"},1,this.clipRect.width/2+this.clipRect.x,this.clipRect.height/2+this.clipRect.y,t.radius+u),this.clipRectElement=Kh(t.redraw,h,n,"drawCircularClipPath")}else h=new as(i+"_ChartSeriesClipRect_"+s,"transparent",{width:1,color:"Gray"},1,{x:this.xAxis.columnIndex===0?-l:0,y:this.yAxis.rowIndex===t.rows.length-1?-a:0,width:this.clipRect.width+(this.xAxis.columnIndex===t.columns.length-1?l*2:l),height:this.clipRect.height+(this.yAxis.rowIndex===0?a*2:a)}),this.clipRectElement=Kh(t.redraw,h,n);var c=t.chartAreaType==="Cartesian"?"translate("+this.clipRect.x+","+this.clipRect.y+")":"";this.symbolElement=null,this.seriesElement=n.createGroup({id:i+"SeriesGroup"+s,transform:c,"clip-path":"url(#"+i+"_ChartSeriesClipRect_"+s+")"}),this.seriesElement&&(this.seriesElement.setAttribute("role",this.accessibility.accessibilityRole?this.accessibility.accessibilityRole:"region"),this.seriesElement.setAttribute("tabindex",this.accessibility.focusable?String(this.accessibility.tabIndex):"-1"),this.seriesElement.style.outline="none",this.seriesElement.setAttribute("aria-label",this.accessibility.accessibilityDescription?this.accessibility.accessibilityDescription:this.name+","+this.type+" series with "+this.points.length+" data points"),this.seriesElement.setAttribute("aria-hidden","false")),(!this.chart.enableCanvas||this.type==="Bubble")&&(this.seriesElement.setAttribute("tabindex",this.accessibility.focusable?s===0?"0":this.checkTabindex(t.visibleSeries,s)?"":String(this.accessibility.tabIndex):"-1"),this.seriesElement.style.outline="none",this.seriesElement.appendChild(this.clipRectElement))}},e.prototype.checkTabindex=function(t,i){for(var r=0;r<i;r++)if(t[r].visible)return!0;return!1},e.prototype.appendSeriesElement=function(t,i){var r=this.marker,n=r.dataLabel,s=i.redraw;if(this.category!=="TrendLine"){vt(i.enableCanvas,i.seriesElements,this.seriesElement,s);var a=this.errorBar;a.visible&&(i.chartAreaType==="PolarRadar"?vt(i.enableCanvas,i.seriesElements,this.seriesElement,s):vt(i.enableCanvas,i.seriesElements,this.errorBarElement,s))}r.visible&&(i.chartAreaType==="Cartesian"||this.drawType!=="Scatter"&&i.chartAreaType==="PolarRadar")&&this.type!=="Scatter"&&this.type!=="Bubble"&&this.type!=="Candle"&&this.type!=="Hilo"&&this.type!=="HiloOpenClose"&&this.symbolElement&&vt(i.enableCanvas,i.seriesElements,this.symbolElement,s),n.visible&&this.textElement&&(vt(i.enableCanvas,i.dataLabelElements,this.shapeElement,s),vt(i.enableCanvas,i.dataLabelElements,this.textElement,s)),!i.enableCanvas&&i.dataLabelElements.hasChildNodes()&&i.seriesElements.appendChild(i.dataLabelElements)},e.prototype.performAnimation=function(t,i,r,n,s){(this.animation.enable&&Ut!=="Disable"||Ut==="Enable")&&t.animateSeries&&(!t.stockChart||!t.stockChart.isStockChartRendered)&&(t[i+"SeriesModule"].doAnimation(this),r.visible&&t.errorBarModule.doErrorBarAnimation(this),n.visible&&(this.isRectSeries||this.type==="Line"||this.type==="Polar"||this.type==="Radar")&&t.markerRender.doMarkerAnimation(this),s.visible&&B.info.name!=="edge"&&!B.isIE&&t.dataLabelModule.doDataLabelAnimation(this))},e.prototype.setPointColor=function(t,i){return i=t.interior||i,t.isEmpty&&this.emptyPointSettings.fill||i},e.prototype.setBorderColor=function(t,i){return i.width=t.isEmpty&&this.emptyPointSettings.border.width||i.width,i.color=t.isEmpty&&this.emptyPointSettings.border.color||i.color,i},e.prototype.addPoint=function(t,i){var r=this.yMin,n=this.yMax;if(this.removeTrackballElements(),this.dataSource.push(t),this.type==="Radar"||this.type==="Polar")return this.chart.refresh();if(this.type==="Histogram"){this.currentViewData=this.chart[$r(this.type)+"SeriesModule"].processInternalData(he([],this.dataSource,null,!0),this);for(var s=0;s<this.currentViewData.length;s++)this.updatePoint(s)}else{this.currentViewData=this.dataSource;var a=this.points.length===0?0:this.points[this.points.length-1].index+1;this.updatePoint(a)}if(this.category==="Pareto"){var l=he([],this.dataSource,null,!0),h=this.chart.visibleSeries[this.index+this.chart.series.length];h.currentViewData=this.chart.paretoSeriesModule.performCumulativeCalculation(l,this);for(var s=0;s<h.currentViewData.length;s++)h.points[s]||h.updatePoint(s),h.points[s].y=h.points[s].yValue=h.currentViewData[s][h.yName]}this.updateSplineValue(),this.chart.calculateStackValues(),this.chart.redraw=this.chart.enableAnimation;var u=this.chart.duration;if(this.chart.duration=g(i)?500:i,this.chart.animateSeries=!1,this.chart.pointsAdded=!0,this.chart.enableAnimation&&!(this.isRectSeries||this.type==="Bubble"||this.type==="Scatter")&&this.type.indexOf("step")===-1&&this.marker&&this.marker.visible&&this.visible){for(var s=this.points.length-2;s>=0;s--)if(this.points[s]&&!g(this.points[this.points.length-2].y)&&this.points[s].symbolLocations&&this.points[s].symbolLocations[0]!==void 0){this.chart.markerRender.renderMarker(this,this.points[this.points.length-2],this.points[s].symbolLocations[0],null,!0);break}}this.yMin>=r&&this.yMax<=n&&(Bs(this.xAxis)||(this.xAxis.baseModule.calculateRangeAndInterval(new _t(this.xAxis.rect.width,this.chart.availableSize.height),this.xAxis),this.xAxis.updateAxis()),this.chart.pointsAdded=!1,this.updateSeries(!0,!1)),(this.yMin<r||this.yMax>n)&&(this.updateChartAxis(),this.chart.pointsAdded=!1,this.updateSeries(!0,!0)),this.chart.redraw=!1,this.chart.duration=u},e.prototype.removePoint=function(t,i){var r=he([],this.dataSource,null,!0),n=this.chart.duration;if(r.length>0&&t>=0&&t<r.length){if(r.splice(t,1),this.dataSource.splice(t,1),this.removeTrackballElements(t),this.type==="Radar"||this.type==="Polar")return this.chart.refresh();if(this.chart.redraw=this.chart.enableAnimation,this.chart.animateSeries=!1,this.chart.pointsAdded=!0,this.chart.duration=g(i)?500:i,this.type==="Histogram"){var s=this.points.length;this.points=[],this.visiblePoints=[],this.currentViewData=this.chart[$r(this.type)+"SeriesModule"].processInternalData(he([],this.dataSource,null,!0),this);for(var a=0;a<this.currentViewData.length;a++)this.updatePoint(a);s>this.points.length&&(this.removedPointIndex=t)}else this.removedPointIndex=t,this.points.splice(t,1),this.visiblePoints.splice(t,1);this.yData=[],this.xData=[];var l=this.yMin,h=this.yMax;this.yMin=1/0,this.xMin=1/0,this.yMax=-1/0,this.xMax=-1/0,this.xAxis.valueType.indexOf("Category")>-1&&this.chart.series.length===1&&(this.xAxis.labels=[],this.xAxis.indexLabels={}),t===0&&(this.chart.pointsRemoved=this.chart.enableAnimation);for(var a=0;a<this.points.length;a++)this.updatePointsAfterRemoval(a);if(this.category==="Pareto"){var u=this.chart.visibleSeries[this.index+this.chart.series.length];u.yMin=1/0,u.xMin=1/0,u.yMax=-1/0,u.xMax=-1/0,u.points.splice(t,1),u.visiblePoints.splice(t,1),u.currentViewData=this.chart.paretoSeriesModule.performCumulativeCalculation(this.dataSource,this);for(var a=0;a<u.currentViewData.length;a++)u.points[a].y=u.points[a].yValue=u.currentViewData[a][u.yName],u.updatePointsAfterRemoval(a)}this.updateSplineValue(),this.chart.calculateStackValues(),!Bs(this.xAxis)&&h===this.yMax&&l===this.yMin?(this.xAxis.baseModule.calculateRangeAndInterval(new _t(this.xAxis.rect.width,this.chart.availableSize.height),this.xAxis),this.xAxis.updateAxis(),this.createSeriesElements(this.chart),this.chart.pointsAdded=!1,this.updateSeries(!0,!1)):(h<this.yMax||l>this.yMin||h>this.yMax||l<this.yMin)&&(this.updateChartAxis(),this.createSeriesElements(this.chart),this.chart.pointsAdded=!1,this.updateSeries(!0,!0))}vt(this.chart.enableCanvas,this.chart.seriesElements,this.seriesElement,!0),this.chart.redraw=!1,this.chart.duration=n,this.chart.pointsRemoved=!1,this.removedPointIndex=null},e.prototype.updatePointsAfterRemoval=function(t){var i=this.points[t],r={skeleton:"full",type:"dateTime"},n=this.chart.intl.getDateParser(r),s=this.chart.intl.getDateFormat(r);this.xAxis.valueType==="Category"&&this.chart.series.length===1?this.pushCategoryData(i,t,i.x):this.xAxis.valueType==="DateTimeCategory"&&this.chart.series.length===1&&this.pushCategoryData(i,t,Date.parse(n(s(i.x))).toString()),this.pushData(i,t),this.setEmptyPoint(this.points[t],t)},e.prototype.removeTrackballElements=function(t){if(this.marker.visible)if(t!==void 0){var i=this.chart.element.id+"_Series_"+this.index+"_Point_"+t+"_Trackball_",r=ce(i+"0");r&&r.remove();var n=ce(i+"1");n&&n.remove();var s=ce(this.chart.element.id+"_Series_"+this.index+"_Point_"+t+"_Symbol");s&&s.setAttribute("visibility","visible")}else{var a=this.chart.element.id+"_EJ2-Trackball_Series_"+this.index+"_Point_",l=document.querySelectorAll('[class*="'+a+'"]');if(l[0]){var h=l[0].id.match(/_Point_(\d+)_/),u=h?parseInt(h[1],10):null;l[0].remove();var s=ce(this.chart.element.id+"_Series_"+this.index+"_Point_"+u+"_Symbol");s&&s.setAttribute("visibility","visible")}l[1]&&l[1].remove()}if(this.chart.tooltip.enable){this.chart.tooltipModule.previousPoints=[];var c=ce(this.chart.element.id+"_tooltip");c&&c.remove()}},e.prototype.setData=function(t,i){var r=this;if(!t)return null;var n=[];if(this.dataSource.length===t.length){for(var s=0;s<t.length;s++)if(t[s][this.xName]instanceof Date?n.push(t[s][this.xName].getTime()):n.push(t[s][this.xName]),this.currentData.length<this.dataSource.length){var a=he([],this.dataSource,null,!0);a[s][this.xName]instanceof Date?this.currentData.push(a[s][this.xName].getTime()):this.currentData.push(a[s][this.xName])}}var l=n.every(function(A){return r.currentData.indexOf(A)!==-1});this.currentViewData&&(l=!0);var h=!1,u=this.yMin,c=this.yMax;this.yMin=1/0,this.yMax=-1/0;var d=[];this.chart.dataLabelCollections=[],this.chart.rotatedDataLabelCollections=[];var p=!1,f=null;if(this.dataSource.length===t.length&&!(this.type==="Radar"||this.type==="Polar")&&l)if(p=!0,this.yData=[],this.type==="Histogram"&&this.dataSource.length===t.length){var v=this.chart[$r(this.type)+"SeriesModule"].processInternalData(he([],t,null,!0),this);this.currentViewData=v;for(var m=0;m<v.length;m++)this.updatePoint(m)}else for(var s=0;s<t.length;s++){var y=t[s][this.xName],S=this.dataSource[s][this.xName];t[s][this.xName]instanceof Date&&(y=t[s][this.xName].getTime(),S=this.dataSource[s][this.xName].getTime()),this.currentData[s]!==y&&(h=!0);var b=this.points[s],w=this.enableComplexProperty?V:this.getObjectValue,I=this.dataSource[s],x=t[s];this.seriesType==="XY"||this.seriesType==="BoxPlot"?(b.y=w(this.yName,x),this.type==="Bubble"&&I[this.size]!==x[this.size]&&(b.size=w(this.size,x)),d.push(s)):(I[this.high]!==x[this.high]||I[this.low]!==x[this.low]||I[this.open]!==x[this.open]||I[this.close]!==x[this.close]||I[this.volume]!==x[this.volume])&&(b.high=w(this.high,x),b.low=w(this.low,x),b.open=w(this.open,x),b.close=w(this.close,x),b.volume=w(this.volume,x),d.push(s)),b.yValue=b.y,b.x=w(this.xName,x),this.currentViewData||(b.index=this.xAxis.valueType==="DateTime"&&typeof b.x!="number"?this.currentData.indexOf(b.x.getTime()):this.currentData.indexOf(b.x)),(this.xAxis.valueType==="Category"||this.xAxis.valueType==="DateTimeCategory")&&s<this.xAxis.visibleLabels.length&&(this.xAxis.visibleLabels[s].value=n.indexOf(this.currentData[s*this.xAxis.visibleRange.interval]),this.xAxis.labels[s]=String(n[s])),this.setEmptyPoint(b,s),this.dataSource[s]=t[s]}if(!p)this.dataSource=t;else{this.chart.redraw=this.chart.enableAnimation,this.chart.animateSeries=!1,this.chart.pointsAdded=!0;var M=this.chart.duration;if(this.chart.duration=g(i)?500:i,this.type.indexOf("Stacking")!==-1&&this.chart.calculateStackValues(),this.updateSplineValue(),c===this.yMax&&u===this.yMin&&this.visible)this.chart.pointsAdded=!1,this.chart[$r(this.category==="Pareto"?"Column":this.type.replace("100",""))+"SeriesModule"].updateDirection(this,d,this.chart.requireInvertedAxis),this.chart.annotationModule&&this.chart.annotationModule.renderAnnotations(ce(this.chart.element.id+"_Secondary_Element")),!Bs(this.xAxis)&&h&&this.xAxis.updateAxis();else if((c<this.yMax||u>this.yMin||c>this.yMax||u<this.yMin)&&this.visible){var D=this.yAxis.maxLabelSize.width;this.yAxis.baseModule.calculateRangeAndInterval(new _t(this.chart.availableSize.width,this.yAxis.rect.height),this.yAxis),D<this.yAxis.maxLabelSize.width?(this.chart.calculateBounds(),this.chart.axisCollections.forEach(function(A){Bs(A)||A.updateAxis()}),this.chart.chartAxisLayoutPanel.drawPaneLines(this.chart),this.chart.renderAreaBorder()):(Bs(this.yAxis)||this.yAxis.updateAxis(),!Bs(this.xAxis)&&h&&this.xAxis.updateAxis(),this.type==="Histogram"&&!Bs(this.xAxis)&&(this.xAxis.baseModule.calculateRangeAndInterval(new _t(this.xAxis.rect.width,this.chart.availableSize.height),this.xAxis),this.xAxis.updateAxis())),this.chart.pointsAdded=!1,h&&(this.chart[$r(this.category==="Pareto"?"Column":this.type.replace("100",""))+"SeriesModule"].updateDirection(this,d,this.chart.requireInvertedAxis),f=this.index),this.updateSeries(!1,!0,f),this.chart.stripLineModule&&this.chart.stripLineModule.renderStripLine(this.chart,"Behind",this.chart.axisCollections)}this.chart.redraw=!1,this.chart.pointsRemoved=!1,this.chart.duration=M}},e.prototype.updateChartAxis=function(){var t=this.yAxis.maxLabelSize.width;this.yAxis.baseModule.calculateRangeAndInterval(new _t(this.chart.availableSize.width,this.yAxis.rect.height),this.yAxis),t<this.yAxis.maxLabelSize.width?(this.chart.calculateBounds(),this.chart.axisCollections.forEach(function(i){Bs(i)||i.updateAxis()}),this.chart.chartAxisLayoutPanel.drawPaneLines(this.chart),this.chart.renderAreaBorder()):(Bs(this.xAxis)||(this.xAxis.baseModule.calculateRangeAndInterval(new _t(this.xAxis.rect.width,this.chart.availableSize.height),this.xAxis),this.xAxis.updateAxis()),Bs(this.yAxis)||this.yAxis.updateAxis()),this.chart.stripLineModule&&this.chart.stripLineModule.renderStripLine(this.chart,"Behind",this.chart.axisCollections)},e.prototype.updateSeries=function(t,i,r){var n=[];if(t&&i){var s=new Set(this.xAxis.series.concat(this.yAxis.series));s.forEach(function(c){n.push(c)})}else n=t?this.xAxis.series.slice():this.yAxis.series.slice();for(var a=0,l=n;a<l.length;a++){var h=l[a];if(h.visible&&h.index!==r){qw(h,this.chart.enableCanvas);var u="translate("+this.clipRect.x+","+this.clipRect.y+")";h.seriesElement.setAttribute("transform",u),h.chart[$r(h.type.replace("100",""))+"SeriesModule"].render(h,h.xAxis,h.yAxis,h.chart.requireInvertedAxis,h.chart.enableAnimation),h.marker.visible&&h.chart.chartAreaType==="Cartesian"&&h.type!=="Scatter"&&h.type!=="Bubble"&&h.type!=="Candle"&&h.type!=="Hilo"&&h.type!=="HiloOpenClose"&&h.symbolElement&&(h.symbolElement.setAttribute("transform",u),vt(h.chart.enableCanvas,h.chart.seriesElements,h.symbolElement,!0)),h.marker.dataLabel.visible&&h.chart.dataLabelModule&&(h.chart.dataLabelCollections=[],h.chart.dataLabelModule.render(h,h.chart,h.marker.dataLabel),h.textElement&&(h.shapeElement&&h.shapeElement.setAttribute("transform",u),vt(h.chart.enableCanvas,h.chart.dataLabelElements,h.shapeElement,!0),h.textElement.setAttribute("transform",u),vt(h.chart.enableCanvas,h.chart.dataLabelElements,h.textElement,!0))),h.chart.annotationModule&&h.chart.annotationModule.renderAnnotations(ce(h.chart.element.id+"_Secondary_Element"))}}},e.prototype.updatePoint=function(t){var i=new Xw,r=this instanceof e&&this.marker.dataLabel.name?this.marker.dataLabel.name:"",n=this instanceof e&&this.type==="Histogram"?"x":this.xName;if(this.xAxis.valueType==="Category")this.pushCategoryPoint(i,t,r,n);else if(this.xAxis.valueType.indexOf("DateTime")>-1){var s=this.points[t],a={skeleton:"full",type:"dateTime"},l=this.chart.intl.getDateParser(a),h=this.chart.intl.getDateFormat(a);this.pushDateTimePoint(s,t,r,n,l,h)}else this.pushDoublePoint(i,t,r,n)},e.prototype.formatAccessibilityDescription=function(t,i){var r=i.accessibility.accessibilityDescriptionFormat;return r.replace("${series.name}",i&&i.name?i.name:"").replace("${point.x}",t&&t.x?t.x.toString():"").replace("${point.y}",t&&t.y?t.y.toString():"").replace("${point.high}",t&&t.high?t.high.toString():"").replace("${point.low}",t&&t.low?t.low.toString():"").replace("${point.close}",t&&t.close?t.close.toString():"").replace("${point.open}",t&&t.open?t.open.toString():"").replace("${point.maximum}",t&&t.maximum?t.maximum.toString():"").replace("${point.minimum}",t&&t.minimum?t.minimum.toString():"").replace("${point.median}",t&&t.median?t.median.toString():"").replace("${point.lowerQuartile}",t&&t.lowerQuartile?t.lowerQuartile.toString():"").replace("${point.upperQuartile}",t&&t.upperQuartile?t.upperQuartile.toString():"")},xe([C("")],e.prototype,"name",void 0),xe([C("")],e.prototype,"yName",void 0),xe([C("Line")],e.prototype,"drawType",void 0),xe([C(!0)],e.prototype,"isClosed",void 0),xe([C(null)],e.prototype,"bearFillColor",void 0),xe([C(null)],e.prototype,"bullFillColor",void 0),xe([C(!1)],e.prototype,"enableSolidCandles",void 0),xe([C("")],e.prototype,"size",void 0),xe([C(null)],e.prototype,"binInterval",void 0),xe([C(!1)],e.prototype,"showNormalDistribution",void 0),xe([C("")],e.prototype,"stackingGroup",void 0),xe([be({color:null,width:0},Zn)],e.prototype,"border",void 0),xe([C(1)],e.prototype,"opacity",void 0),xe([C(0)],e.prototype,"zOrder",void 0),xe([C("")],e.prototype,"groupName",void 0),xe([C("Line")],e.prototype,"type",void 0),xe([be(null,CW)],e.prototype,"errorBar",void 0),xe([be(null,ex)],e.prototype,"marker",void 0),xe([be(null,mW)],e.prototype,"paretoOptions",void 0),xe([be({},IU)],e.prototype,"dragSettings",void 0),xe([Wt([],yW)],e.prototype,"trendlines",void 0),xe([C(!0)],e.prototype,"enableTooltip",void 0),xe([C(!0)],e.prototype,"showNearestTooltip",void 0),xe([C("")],e.prototype,"tooltipFormat",void 0),xe([C("")],e.prototype,"tooltipMappingName",void 0),xe([C("SeriesType")],e.prototype,"legendShape",void 0),xe([C("")],e.prototype,"legendImageUrl",void 0),xe([C(null)],e.prototype,"selectionStyle",void 0),xe([C(null)],e.prototype,"unSelectedStyle",void 0),xe([C(null)],e.prototype,"nonHighlightStyle",void 0),xe([C(1)],e.prototype,"minRadius",void 0),xe([C(3)],e.prototype,"maxRadius",void 0),xe([C("Natural")],e.prototype,"splineType",void 0),xe([C(.5)],e.prototype,"cardinalSplineTension",void 0),xe([be(null,ON)],e.prototype,"emptyPointSettings",void 0),xe([C(!0)],e.prototype,"showMean",void 0),xe([C("Normal")],e.prototype,"boxPlotMode",void 0),xe([C(!0)],e.prototype,"showOutliers",void 0),xe([C(null)],e.prototype,"columnWidth",void 0),xe([C(null)],e.prototype,"columnWidthInPixel",void 0),xe([C("Rectangle")],e.prototype,"columnFacet",void 0),xe([C(0)],e.prototype,"columnSpacing",void 0),xe([C("#C64E4A")],e.prototype,"negativeFillColor",void 0),xe([C("#4E81BC")],e.prototype,"summaryFillColor",void 0),xe([C()],e.prototype,"intermediateSumIndexes",void 0),xe([C()],e.prototype,"sumIndexes",void 0),xe([C("Left")],e.prototype,"step",void 0),xe([C(!1)],e.prototype,"noRisers",void 0),xe([be({},vU)],e.prototype,"accessibility",void 0),xe([be({color:"black",width:2},Fc)],e.prototype,"connector",void 0),xe([be(null,SU)],e.prototype,"cornerRadius",void 0),e}(hF),uF=function(){function o(e,t){this.initDataManager(e,t)}return o.prototype.initDataManager=function(e,t){this.dataManager=e instanceof re?e:new re(e),this.query=t instanceof Pe?t:new Pe},o.prototype.generateQuery=function(){var e=this.query.clone();return e},o.prototype.getData=function(e){var t=this;if(this.dataManager.ready){var i=new kn,r=this.dataManager.ready;return r.then(function(){t.dataManager.executeQuery(e).then(function(n){i.resolve(n)})}).catch(function(n){i.reject(n)}),i.promise}else return this.dataManager.executeQuery(e)},o}(),wW=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),xW=function(o){wW(e,o);function e(t){var i=o.call(this,t)||this;return i.elementId=t.element.id,i.commonXvalues=[],i}return e.prototype.addEventListener=function(){this.chart.isDestroyed||(this.chart.on(B.touchMoveEvent,this.mouseMoveHandler,this),this.chart.on(B.touchEndEvent,this.mouseUpHandler,this))},e.prototype.removeEventListener=function(){this.chart.isDestroyed||(this.chart.off(B.touchMoveEvent,this.mouseMoveHandler),this.chart.off(B.touchEndEvent,this.mouseUpHandler))},e.prototype.mouseUpHandler=function(){var t=this.chart;t.isTouch&&!t.crosshair.enable&&!this.isSelected(t)&&!(this.chart.zoomModule&&ce(this.elementId+"_ZoomArea"))&&this.markerMove(!0)},e.prototype.mouseMoveHandler=function(){var t=this.chart;(t.highlightMode!=="None"||t.tooltip.enable)&&(!t.isTouch||t.startMove)&&!this.isSelected(t)&&!(this.chart.zoomModule&&(ce(this.elementId+"_ZoomArea")||this.chart.zoomModule.startPanning))&&this.markerMove(!1)},e.prototype.markerMove=function(t){var i=this,r=this.chart;this.currentPoints=[];var n,s,a,l;if(!r.tooltip.shared||!r.tooltip.enable)n=this.getData(),l=n.series,s=this.previousPoints[0],a=l&&(l.type==="Bubble"||l.drawType==="Scatter"||l.type==="Scatter"||l.type!=="Candle"&&l.type!=="Hilo"&&l.type!=="HiloOpenClose"&&l.marker.visible&&l.marker.width!==0&&l.marker.height!==0),n.lierIndex=this.lierIndex,n.point&&a&&(!s||s.point!==n.point||s&&s.lierIndex>3&&s.lierIndex!==this.lierIndex)&&this.currentPoints.push(n),n.point&&a&&r.isPointMouseDown&&this.currentPoints.push(n),this.currentPoints.length===0&&n.point&&!a&&!g(s)&&s.point!==n.point&&(this.removeHighlightedMarker(s.series,s.point),this.previousPoints=he([],n,null,!0)),r.tooltip.showNearestTooltip&&this.chart.tooltipModule&&this.chart.tooltipModule.currentPoints&&(a||l.type==="Pareto"&&l.paretoOptions.marker.visible)&&this.currentPoints.length===0&&Oi(r.mouseX,r.mouseY,r.chartAxisLayoutPanel.seriesClipRect)&&(this.currentPoints=this.chart.tooltipModule.currentPoints);else{if(!Oi(r.mouseX,r.mouseY,r.chartAxisLayoutPanel.seriesClipRect))return null;if(r.tooltip.enable){var h=r.chartAreaType==="PolarRadar"?this.getData():null;if(!this.chart.tooltip.showNearestPoint)this.currentPoints=this.chart.tooltipModule.currentPoints;else for(var u=0,c=r.visibleSeries;u<c.length;u++){var d=c[u];!d.enableTooltip||d.category==="Indicator"||(r.chartAreaType==="Cartesian"&&d.visible?n=this.getClosestX(r,d,this.commonXValue(this.chart.visibleSeries)):r.chartAreaType==="PolarRadar"&&d.visible&&h.point!==null&&(n=new of(d.points[h.point.index],d)),n&&(this.currentPoints.push(n),n=null))}}}var p=this.previousPoints.length;if((this.currentPoints.length>0||p>0&&r.tooltip.shared)&&(p===0||r.isPointMouseDown||p>0&&(this.currentPoints.length===0||this.previousPoints[0].point!==this.currentPoints[0].point))){if(p>0)for(var f=0,v=this.previousPoints;f<v.length;f++){var m=v[f];g(m)||this.removeHighlightedMarker(m.series,m.point)}for(var y=function(x){(x&&x.point||l.type!=="Candle"&&l.type!=="Hilo"&&l.type!=="HiloOpenClose")&&(nF(S.markerExplode),S.isRemove=!0,x.point.symbolLocations.map(function(M,D){x.series.marker.allowHighlight&&(!x.series.isRectSeries||x.point.marker.visible)&&i.drawTrackBall(x.series,x.point,M,D)}))},S=this,b=0,w=this.currentPoints;b<w.length;b++){var I=w[b];y(I)}this.previousPoints=he([],this.currentPoints,null,!0)}!r.tooltip.enable&&(this.currentPoints.length===0&&this.isRemove||t&&this.isRemove||!Oi(r.mouseX,r.mouseY,r.chartAxisLayoutPanel.seriesClipRect))&&(this.isRemove=!1,g(this.previousPoints[0])||(this.markerExplode=+setTimeout(function(){i.previousPoints[0]&&i.removeHighlightedMarker(i.previousPoints[0].series,i.previousPoints[0].point)},2e3))),this.currentPoints=[]},e.prototype.animationDuration=function(){var t=200;return this.chart.maxPointCount>100?t=10:this.chart.maxPointCount>50&&(t=100),t},e.prototype.drawTrackBall=function(t,i,r,n){var s=i.marker,a=t.marker,l=s.shape||a.shape||"Circle",h;if(l==="None"||l==="Image")return null;var u=t.symbolElement||t.seriesElement,c;this.chart.highlightModule&&this.chart.highlightMode!=="None"&&(c=this.chart.highlightModule.generateStyle(t)),this.chart.selectionModule&&this.chart.selectionMode!=="None"&&(c=this.chart.selectionModule.generateStyle(t));var d=this.elementId+"_Series_"+t.index+"_Point_"+i.index+"_Trackball"+(n||"");ce(d+"_1")&&ce(d+"_1").getAttribute("e-animate")&&(It.stop(ce(d+"_1")),Ue(ce(d+"_1")));var p=new _t((s.width||a.width)+3,(s.height||a.height)+3),f=s.border||t.border,v=t.type==="BoxAndWhisker"||t.type==="Bubble"||t.type==="Scatter",m=f.color&&f.color!=="transparent"?f.color:s.fill||i.interior||(v?i.color:t.interior),y=hf(Bn(m)),S=s.border?s.border.width:a.border.width,b=t.chart.themeStyle.markerShadow||"rgba("+y.r+","+y.g+","+y.b+",0.2)",w=document.getElementById(this.elementId+"_Series_"+t.index+"_Point_"+i.index+"_Symbol");if(g(w)||w.setAttribute("visibility","visible"),this.chart.enableCanvas){var I=document.getElementById(this.chart.element.id+"_Secondary_Element");h=this.chart.svgRenderer.createSvg({id:this.chart.element.id+"_trackball_svg",width:this.chart.availableSize.width,height:this.chart.availableSize.height}),h.style.cssText="position: absolute; display:block; pointer-events: none",I.appendChild(h)}for(var x=0;x<2;x++){var M=new Ir(d+"_"+x,x?s.fill||i.color||(v?t.interior:"#ffffff"):"transparent",S+(x?0:8),x?m:b,s.opacity||a.opacity,t.marker.border.dashArray,""),D=zs(r,l,p,s.imageUrl,M,"",this.chart.svgRenderer,t.clipRect);D.setAttribute("class",this.elementId+"_EJ2-Trackball_Series_"+t.index+"_Point_"+i.index);var A=u.id.indexOf("Symbol")!==-1?"_Symbol":"",L=document.getElementById(this.elementId+"_Series_"+t.index+"_Point_"+i.index+A);c!==""&&!g(c)&&!g(L)&&L.hasAttribute("class")&&c===L.getAttribute("class")&&D.classList.add(c),D.setAttribute("clip-path",u.getAttribute("clip-path")),D.setAttribute("transform",u.getAttribute("transform")),this.chart.enableCanvas?h.appendChild(D):this.chart.svgObject.appendChild(D)}this.doAnimation(t,i,!1)},e.prototype.doAnimation=function(t,i,r){if(r===void 0&&(r=!1),!(t.type==="Bubble"||t.type==="Scatter"))for(var n=this.animationDuration(),s=0,a=document.getElementsByClassName(this.elementId+"_EJ2-Trackball_Series_"+t.index+"_Point_"+i.index),l=0,h=a.length;l<h;l++)this.trackballAnimate(a[l],s,n,t,i.index,i.symbolLocations[0],!1,r)},e.prototype.trackballAnimate=function(t,i,r,n,s,a,l,h,u){var c=a.x,d=a.y,p=n.type!=="Polar"&&n.type!=="Radar"?n.clipRect.x:0,f=n.type!=="Polar"&&n.type!=="Radar"?n.clipRect.y:0,v=t.getAttribute("transform"),m=n.marker.width/(n.marker.width+3),y=n.marker.height/(n.marker.height+3),S=Math.min(m,y);u||t.setAttribute("transform","translate("+(c+p)+" "+(d+f)+") scale("+S+") translate("+-c+" "+-d+")"),new It({}).animate(t,{duration:r,delay:i,progress:function(b){if(b.element.style.animation="",b.timeStamp>b.delay){if(!n.visible&&u){Ue(t);return}var w=b.timeStamp/b.duration,I=u?Math.max(S,1-(1-S)*w):Math.min(1,S+(1-S)*w);t.setAttribute("transform","translate("+(c+p)+" "+(d+f)+") scale("+I+") translate("+-c+" "+-d+")")}},end:function(){t.style.visibility="",t.setAttribute("transform",v),!l&&s===n.points.length-1&&n.chart.trigger("animationComplete",{series:n.chart.isBlazor?{}:n}),(u||h)&&Ue(t)}})},e.prototype.removeHighlightedMarker=function(t,i,r){if(t===void 0&&(t=null),i===void 0&&(i=null),r===void 0&&(r=!1),!g(t)&&!g(i)){var n=document.getElementById(this.elementId+"_Series_"+t.index+"_Point_"+i.index+"_Symbol"),s=document.getElementsByClassName(this.elementId+"_EJ2-Trackball_Series_"+t.index+"_Point_"+i.index);if(s.length===0){var a=document.querySelectorAll('[class*="'+(this.elementId+"_EJ2-Trackball_Series_"+t.index+"_Point_"+i.index)+'"]');a[1]&&a[1].remove(),a[0]&&a[0].remove()}for(var l=0,h=s.length;l<h;l++)l===1&&s[0]&&t.type!=="Bubble"&&t.type!=="Scatter"?(s[0].setAttribute("opacity",n?n.getAttribute("opacity"):s[0].getAttribute("opacity")),this.trackballAnimate(s[0],0,this.animationDuration(),t,i.index,i.symbolLocations[0],null,null,!0)):Ue(s[0]);g(n)||n.setAttribute("visibility","visible")}else for(var u=0,c=t.points;u<c.length;u++)for(var d=c[u],a=document.getElementsByClassName(this.elementId+"_EJ2-Trackball_Series_"+t.index+"_Point_"+d.index),n=document.getElementById(this.elementId+"_Series_"+t.index+"_Point_"+d.index+"_Symbol"),l=0,h=a.length;l<h;l++)g(n)||n.setAttribute("visibility","visible"),Ue(a[0]);r&&(this.previousPoints=[])},e}(Jw),IW=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),cF=["Circle","Triangle","Diamond","Rectangle","Pentagon","InvertedTriangle","VerticalLine","Cross","Plus","HorizontalLine","Star"],MW=function(o){IW(e,o);function e(t){var i=o.call(this,t)||this;return i.addEventListener(),i}return e.prototype.render=function(t){var i=this,r=t.chart.redraw;this.createElement(t,r);for(var n=function(h){h.visible&&h.symbolLocations&&h.symbolLocations.length&&h.symbolLocations.map(function(u,c){t.marker.shape!=="None"&&i.renderMarker(t,h,u,c,r)})},s=0,a=t.points;s<a.length;s++){var l=a[s];n(l)}},e.prototype.renderMarker=function(t,i,r,n,s){var a=t.index===void 0?t.category:t.index,l=t.marker;t.marker.shape=t.marker.shape?t.marker.shape:cF[a%10];var h={color:l.border.color,width:l.border.width},u=l.border.color,c,d,p,f;r.x=r.x+l.offset.x,r.y=r.y-l.offset.y;var v=t.type==="BoxAndWhisker",m=l.fill||(v||t.marker.isFilled?i.interior||t.interior:"#ffffff"),y,S=v&&!this.chart.enableCanvas?tW(t.seriesElement.childNodes,"Series_"+t.index+"_Point_"+i.index):t.symbolElement;h.color=u||t.setPointColor(i,t.interior);var b=this.elementId+"_Series_"+a+"_Point_"+(t.removedPointIndex!==null&&t.removedPointIndex<=i.index||this.chart.pointsAdded?i.index+1:i.index)+"_Symbol"+(n||""),w={cancel:!1,name:Zl,series:t,point:i,fill:i.isEmpty&&t.emptyPointSettings.fill||m,border:{color:t.type==="BoxAndWhisker"?!g(u)&&u!=="transparent"?u:sW(m,-.6):h.color,width:h.width},height:l.height,width:l.width,shape:l.shape};if(w.border=t.setBorderColor(i,{width:w.border.width,color:w.border.color}),(!t.isRectSeries||t.type==="BoxAndWhisker")&&(this.chart.trigger(Zl,w),i.color=w.fill),w.cancel)r=null,i.marker={visible:!1};else{var I=void 0;t.type==="RangeArea"||t.type==="RangeColumn"||t.drawType==="RangeColumn"||t.type==="SplineRangeArea"||t.type==="RangeStepArea"?I=n?i.low:i.high:v?I=i.outliers[n]:I=i.y;var x=w.point.marker.fill||w.fill,M=void 0;g(w.point.marker.border)?M={color:w.border.color,width:w.border.width}:M={color:w.point.marker.border.color||w.border.color,width:w.point.marker.border.width||w.border.width};var D=w.point.marker.width||w.width,A=w.point.marker.height||w.height,L=w.point.marker.opacity||l.opacity,T=w.point.marker.shape||w.shape,k=w.point.marker.imageUrl||l.imageUrl;f=new Ir(b,x,M.width,M.color,L,t.marker.border.dashArray),(S!=null||this.chart.enableCanvas)&&(s&&ce(f.id)&&(y=ce(f.id),p=T==="Circle"?"c":"",c={x:+y.getAttribute(p+"x"),y:+y.getAttribute(p+"y")},d=y.getAttribute("d")),y=zs(r,T,new _t(D,A),k,f,i.x.toString()+":"+I.toString(),this.chart.renderer,t.clipRect),y&&(y.setAttribute("role","img"),t.category==="TrendLine"&&f.id===this.elementId+"_Series_0_Point_0_Symbol"&&(y.setAttribute("tabindex","0"),y.setAttribute("class","e-chart-focused")),y.setAttribute("aria-label",t.accessibility.accessibilityDescriptionFormat?t.formatAccessibilityDescription(i,t):i.x+": "+i.y+", "+t.name)),vt(this.chart.enableCanvas,S,y,s,!0,p+"x",p+"y",c,d,!1,!1,null,t.chart.duration),t.removedPointIndex!==null&&t.removedPointIndex<=i.index&&(S.lastChild.id=this.elementId+"_Series_"+a+"_Point_"+i.index+"_Symbol"+(n||""))),i.marker={border:M,fill:x,height:A,visible:!0,shape:T,width:D,imageUrl:k}}},e.prototype.createElement=function(t,i){var r,n=t.marker,s=n.border.width+(this.chart.zoomModule&&this.chart.zoomModule.isAxisZoomed(this.chart.axisCollections)?0:13),a=t.chart.svgRenderer,l=t.index===void 0?t.category:t.index,h,u=t.chart.chartAreaType==="Cartesian"?"translate("+t.clipRect.x+","+t.clipRect.y+")":"";if(n.visible){var c=(n.height+s)/2,d=(n.width+s)/2;if(t.chart.chartAreaType==="Cartesian"?(h=new as(this.elementId+"_ChartMarkerClipRect_"+l,"transparent",{width:1,color:"Gray"},1,{x:-d,y:-c,width:t.clipRect.width+d*2,height:t.clipRect.height+c*2},0,0,"",t.marker.border.dashArray),r=Kh(i,h,a)):(h=new $m(this.elementId+"_ChartMarkerClipRect_"+l,"transparent",{width:1,color:"Gray"},1,t.clipRect.width/2+t.clipRect.x,t.clipRect.height/2+t.clipRect.y,t.chart.radius+Math.max(c,d)),r=Kh(i,h,a,"drawCircularClipPath")),h={id:this.elementId+"SymbolGroup"+l,transform:u,"clip-path":"url(#"+this.elementId+"_ChartMarkerClipRect_"+l+")"},t.symbolElement=a.createGroup(h),t.symbolElement.appendChild(r),this.chart.enableCanvas){var p=document.getElementById(this.chart.element.id+"_tooltip_svg");p.appendChild(t.symbolElement)}}},e.prototype.getRangeLowPoint=function(t,i){var r=t.x,n=t.y;return i.chart.requireInvertedAxis?(n+=t.height/2,r+=i.yAxis.isAxisInverse?t.width:0):(n+=i.yAxis.isAxisInverse?0:t.height,r+=t.width/2),{x:r,y:n}},e.prototype.calculateDistance=function(t,i){var r=i.x-t.x,n=i.y-t.y;return Math.sqrt(r*r+n*n)},e.prototype.doMarkerAnimation=function(t){if(!(t.type==="Scatter"||t.type==="Bubble"||t.type==="Candle"||t.type==="Hilo"||t.type==="HiloOpenClose"||t.chart.chartAreaType==="PolarRadar"&&t.drawType==="Scatter")){for(var i=t.symbolElement.childNodes,r=t.animation.delay+(t.animation.duration===0&&Ut==="Enable"?1e3:t.animation.duration),n=t.chart.animated?t.chart.duration:200,s=r,a=t.pathElement?t.pathElement.getTotalLength():0,l=[],h=1;t.type==="Line"&&h<t.points.length;h++)if(t.points[h-1].symbolLocations[0]&&t.points[h].symbolLocations[0]){var u=this.calculateDistance(t.points[h-1].symbolLocations[0],t.points[h].symbolLocations[0]);l.push(u)}for(var c=1,d=t.type==="RangeArea"||t.type==="RangeColumn"||t.type==="SplineRangeArea"||t.type==="RangeStepArea"?2:1,h=0;h<t.points.length;h++)if(t.points[h].symbolLocations){if(!t.points[h].symbolLocations.length||!i[c])continue;if(t.type==="Line"&&(h===0&&(s=0),h>0&&(s+=l[h-1]/a*r,n=0)),zc(i[c],s,n,t,h,t.points[h].symbolLocations[0],!1),d===2){var p=this.getRangeLowPoint(t.points[h].regions[0],t);zc(i[c+1],s,n,t,h,p,!1)}c+=d}}},e}(xW),DW=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),di=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},dF=function(o){DW(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return di([C(!0)],e.prototype,"visible",void 0),di([C(null)],e.prototype,"height",void 0),di([C(null)],e.prototype,"width",void 0),di([be({x:0,y:0},NN)],e.prototype,"location",void 0),di([C("Auto")],e.prototype,"position",void 0),di([C("Series")],e.prototype,"mode",void 0),di([C(8)],e.prototype,"padding",void 0),di([C(null)],e.prototype,"itemPadding",void 0),di([C("Center")],e.prototype,"alignment",void 0),di([be({fontFamily:null,size:null,fontStyle:null,fontWeight:null,color:null},ua)],e.prototype,"textStyle",void 0),di([C(10)],e.prototype,"shapeHeight",void 0),di([C(10)],e.prototype,"shapeWidth",void 0),di([be({},Zn)],e.prototype,"border",void 0),di([be({left:0,right:0,top:0,bottom:0},Hc)],e.prototype,"margin",void 0),di([be({left:0,right:0,top:0,bottom:0},CU)],e.prototype,"containerPadding",void 0),di([C(8)],e.prototype,"shapePadding",void 0),di([C("transparent")],e.prototype,"background",void 0),di([C(1)],e.prototype,"opacity",void 0),di([C(!0)],e.prototype,"toggleVisibility",void 0),di([C(!1)],e.prototype,"enableHighlight",void 0),di([C(null)],e.prototype,"description",void 0),di([C(3)],e.prototype,"tabIndex",void 0),di([C(null)],e.prototype,"title",void 0),di([be({fontFamily:null,size:null,fontStyle:null,fontWeight:null,color:null},ua)],e.prototype,"titleStyle",void 0),di([C("Top")],e.prototype,"titlePosition",void 0),di([C("Normal")],e.prototype,"textWrap",void 0),di([C("Ellipsis")],e.prototype,"textOverflow",void 0),di([C(100)],e.prototype,"maximumTitleWidth",void 0),di([C(null)],e.prototype,"maximumLabelWidth",void 0),di([C(!0)],e.prototype,"enablePages",void 0),di([C(!1)],e.prototype,"isInversed",void 0),di([C(!1)],e.prototype,"reverse",void 0),di([C("Auto")],e.prototype,"layout",void 0),di([C(null)],e.prototype,"maximumColumns",void 0),di([C(!1)],e.prototype,"fixedWidth",void 0),di([be({},So)],e.prototype,"accessibility",void 0),e}(Re),pF=function(){function o(e){this.maxItemHeight=0,this.rowHeights=[],this.pageHeights=[],this.columnHeights=[],this.pageXCollections=[],this.chartRowCount=1,this.legendTitleCollections=[],this.legendRegions=[],this.pagingRegions=[],this.chart=e,this.legend=e.legendSettings,this.legendID=e.element.id+"_chart_legend",this.isChartControl=e.getModuleName()==="chart"||e.getModuleName()==="chart3d",this.isAccChartControl=e.getModuleName()==="accumulationchart"||e.getModuleName()==="circularchart3d",this.isBulletChartControl=e.getModuleName()==="bulletChart",this.isStockChartControl=e.getModuleName()==="stockChart",this.bulletChart=this.chart,this.fivePixel=5,this.rowCount=0,this.pageButtonSize=8,this.maxColumns=0,this.maxWidth=0,this.currentPage=1,this.backwardArrowOpacity=0,this.forwardArrowOpacity=1,this.arrowWidth=2*(this.fivePixel+this.pageButtonSize+this.fivePixel),this.arrowHeight=this.arrowWidth,this.isTop=!1,this.isTitle=!1,this.currentPageNumber=1}return o.prototype.calculateLegendBounds=function(e,t,i,r,n){var s=this.legend,a=this.isBulletChartControl||(this.chart.getModuleName()==="accumulationchart"||this.chart.getModuleName()==="chart")&&(this.legend.layout!=="Auto"||this.legend.maximumColumns>0)?"40%":"20%";this.getPosition(s.position,t),this.legendBounds=new Ae(e.x,e.y,0,0),this.isVertical=this.position==="Left"||this.position==="Right",this.itemPadding=this.legend.itemPadding?this.legend.itemPadding:this.isVertical?8:20,this.isVertical?(this.legendBounds.height=Ni(s.height,t.height-(e.y-this.chart.margin.top))||e.height,this.legendBounds.width=Ni(s.width||a,t.width)):(this.legendBounds.width=Ni(s.width,t.width)||e.width,this.legendBounds.height=Ni(s.height||a,t.height)),this.chart.getModuleName()==="chart3d"?this.library.get3DLegendBounds(t,this.legendBounds,s):this.library.getLegendBounds(t,this.legendBounds,s),this.isBulletChartControl||(this.legendBounds.width+=this.legend.containerPadding.left+this.legend.containerPadding.right,this.legendBounds.height+=this.legend.containerPadding.top+this.legend.containerPadding.bottom),this.getLocation(this.position,s.alignment,this.legendBounds,e,t,i,r,n)},o.prototype.getPosition=function(e,t){var i=this.chart,r=this.chart;this.isChartControl||this.isBulletChartControl||this.isStockChartControl?this.position=e!=="Auto"?e:"Bottom":(e==="Auto"&&((i||r).visibleSeries&&(i||r).visibleSeries[0].type==="Funnel"||(i||r).visibleSeries[0].type==="Pyramid")&&(e="Top"),this.position=e!=="Auto"?e:t.width>t.height?"Right":"Bottom")},o.prototype.setBounds=function(e,t,i,r){var n=i.title&&i.titlePosition==="Top"?this.legendTitleSize.height+this.fivePixel:0;this.isVertical&&this.isPaging&&!i.enablePages&&!this.isBulletChartControl&&(n=i.title&&i.titlePosition==="Top"?this.legendTitleSize.height+this.fivePixel:0,n+=this.pageButtonSize+this.fivePixel),e=Math.min(e,r.width),t=Math.min(t,r.height),i.mode==="Gradient"?(r.width=i.width?r.width:this.isVertical?e:.75*r.width,r.height=i.height?r.height:this.isVertical?.75*r.height:t):(r.width=i.width?r.width:e,r.height=i.height?r.height:t),this.isBulletChartControl||this.isTop&&i.titleStyle.textOverflow!=="None"&&(this.calculateLegendTitle(i,r),r.height+=i.titleStyle.textOverflow==="Wrap"&&this.legendTitleCollections.length>1?this.legendTitleSize.height-this.legendTitleSize.height/this.legendTitleCollections.length:0),this.rowCount=Math.max(1,Math.ceil((r.height-i.padding-n)/(this.maxItemHeight+i.padding)))},o.prototype.getLocation=function(e,t,i,r,n,s,a,l){var h=this.legend.border.width,u=this.isBulletChartControl,c=this.bulletChart,d=c.labelPosition==="Inside",p=c.tickPosition==="Inside",f=c.orientation==="Vertical",v=u&&c.categoryField!==""?s.width+this.chart.border.width+h*3:0,m=this.chart.margin.bottom,y=i.height+h+this.legend.margin.top+this.legend.margin.bottom,S=i.width+h+this.legend.margin.left+this.legend.margin.right;if(e==="Bottom")i.x=this.alignLegend(i.x,n.width,i.width,t),i.y=a&&(i.height===a.height||this.chart.series[0].type!=="Pie")?a.y:r.y+(r.height-y)+h+this.legend.margin.top,i.y+=u&&!c.opposedPosition&&!d&&!p&&!f?c.majorTickLines.height+m+this.legend.border.width+h*2:f&&c.categoryField!==""?s.height+h*2:0,(!l||i.height!==a.height)&&yo(r,new bo(0,0,0,y));else if(e==="Top"){var b=void 0;this.isChartControl&&(b=Ze("100",this.chart.verticalAxes[0].labelStyle,this.chart.themeStyle.legendLabelFont)),i.x=this.alignLegend(i.x,n.width,i.width,t),i.y=a&&(i.height===a.height||this.chart.series[0].type!=="Pie")?a.y:r.y+h+this.legend.margin.top,i.y-=u&&c.opposedPosition&&!d&&!p&&!f?c.majorTickLines.height+this.chart.margin.top:0,y-=u?-h*2:this.isChartControl?-h*2-b.height/2:0,(!l||i.height!==a.height)&&yo(r,new bo(0,0,y,0))}else e==="Right"?(i.x=a&&(i.width===a.width||this.chart.series[0].type!=="Pie")?a.x:r.x+(r.width-i.width)-this.legend.margin.right,i.y=r.y+this.alignLegend(0,n.height-(r.y+m),i.height,t),S+=u&&c.opposedPosition&&!d&&!p&&f?this.chart.margin.left+this.chart.margin.right+c.majorTickLines.height:0,(!l||i.width!==a.width)&&yo(r,new bo(0,S,0,0))):e==="Left"?(i.x=a&&(i.width===a.width||this.chart.series[0].type!=="Pie")?a.x:i.x+this.legend.margin.left,i.y=r.y+this.alignLegend(0,n.height-(r.y+m),i.height,t),S+=u&&!c.opposedPosition&&!d&&!p&&f?i.x-this.chart.margin.left+h+c.majorTickLines.height:c.orientation!=="Vertical"&&c.categoryField!==""?v:0,(!l||i.width!==a.width)&&yo(r,new bo(S,0,0,0))):(i.x=this.legend.location.x,i.y=this.legend.location.y,yo(r,new bo(0,0,0,0)))},o.prototype.alignLegend=function(e,t,i,r){switch(r){case"Far":e=t-i-e;break;case"Center":e=(t-i)/2;break}return e},o.prototype.renderLegend=function(e,t,i,r,n){var s=0,a=0,l=new Ae(0,0,0,0),h=new Ae(0,0,0,0),u,c;n&&(u=ce(this.legendID+"_element").getAttribute("x"),c=ce(this.legendID+"_element").getAttribute("y"));var d=this.findFirstLegendPosition(this.legendCollections),p=t.padding;this.itemPadding=this.isBulletChartControl?t.padding:this.itemPadding;var f=t.enablePages,v=t.titlePosition,m=this.isPaging&&!t.enablePages&&this.isVertical&&(e.getModuleName()!=="accumulationchart"&&e.getModuleName()!=="chart"||this.legend.layout==="Auto")?this.pageButtonSize:0,y=e.renderer.createGroup({id:this.legendID+"_g"}),S=this.createLegendElements(e,i,y,t,this.legendID,r);this.legendRegions=[],this.chartRowCount=1;var b=0;if(s=this.isTitle&&(this.isTop||this.isVertical)?this.legendTitleSize.height:0,this.isChartControl||this.isAccChartControl&&(!this.isVertical||t.layout&&t.layout!=="Auto")){for(var w=1,I=this.rowHeights[0]+(this.isVertical||this.rowHeights.length>1&&this.legend.itemPadding&&this.chart.getModuleName()==="chart"?this.itemPadding:p),x=1;x<this.rowHeights.length;x++)I+this.rowHeights[x]+((this.isVertical||this.rowHeights.length>1&&this.chart.getModuleName()==="chart")&&this.legend.itemPadding?this.itemPadding:p)>this.legendBounds.height-this.pageButtonSize-this.maxItemHeight/2-this.legend.containerPadding.top-this.legend.containerPadding.bottom&&(this.pageHeights[w-1]=I+s,w++,I=0),I+=this.rowHeights[x]+(this.isVertical||this.rowHeights.length>1&&this.legend.itemPadding&&this.chart.getModuleName()==="chart"?this.itemPadding:p);this.pageHeights[w-1]=I+s,this.totalPages=w}for(var x=0;x<this.legendCollections.length;x++)if(this.legendCollections[x].text!==""){b=Math.max(this.legendCollections[x].textSize.height,b);break}else continue;if(!this.isChartControl&&!this.isAccChartControl&&(this.maxItemHeight=Math.max(b,t.shapeHeight)),!f&&this.isPaging&&!this.isVertical?(a=this.isTitle&&v==="Left"?this.legendTitleSize.width:0,a+=this.pageButtonSize+2*this.fivePixel):this.isTitle&&!this.isVertical&&(a=v===(this.isRtlEnable?"Right":"Left")?this.fivePixel+this.legendTitleSize.width:0),e.legendSettings.mode==="Gradient"&&this.legendCollections.length>1)this.getLinearLegend(i,e,t,S),this.totalPages=1;else if(d!==this.legendCollections.length){var M=void 0,D=0,A=this.legendCollections[d],L=this.isBulletChartControl?p:a+p+t.shapeWidth/2+t.containerPadding.left,T=this.isBulletChartControl&&!this.isRtlEnable?i.x+a+p+t.shapeWidth/2:this.isRtlEnable?i.x+(this.chart.getModuleName()==="accumulationchart"&&this.isVertical&&t.layout==="Auto"&&!(t.maximumColumns>0)?this.maxWidth:i.width)-L:i.x+L,k=new Je(T,this.isBulletChartControl?i.y+s+m+p+this.maxItemHeight/2:i.y+s+m+p+this.maxItemHeight/2+t.containerPadding.top),F=e.isRtlEnabled||e.enableRtl?"end":"start",R=new gn("",k.x,k.y,F),N=t.shapePadding+this.itemPadding+t.shapeWidth;this.totalPages=this.totalPages=this.isAccChartControl||this.isChartControl||this.isBulletChartControl||this.isStockChartControl?this.totalPages:0,this.pageXCollections=[],this.legendCollections[d].location=k;var P=void 0;if(!t.enablePages&&this.isPaging){var O=k.x-this.fivePixel,z=k.y-this.fivePixel,H=this.isTitle&&!this.isVertical&&v==="Left"?this.legendTitleSize.width+this.fivePixel:0,Q=this.isVertical?this.pageButtonSize+Math.abs(z-i.y):0,$=this.isTitle&&!this.isVertical&&v==="Right"?this.legendTitleSize.width+this.fivePixel:0;$+=this.isVertical?0:this.fivePixel+this.pageButtonSize+this.fivePixel,l=new Ae(O,z,i.width-$-H,i.height-Q),h=l}else h=i;for(var U=void 0,x=0;x<this.legendCollections.length;x++)U=this.legendCollections[x],P=this.isReverse?this.legendCollections.length-1-D:D,this.chart.getModuleName()==="accumulationchart"&&(U.fill=(this.chart||this.chart||this.chart||this.chart).visibleSeries[0].points[U.pointIndex].color),this.chart.getModuleName()==="stockChart"&&(U.type=this.chart.visibleSeries[D].type),this.accessbilityText=this.isBulletChartControl?"Legend of bullet chart"+U.text:"Click to show or hide the "+U.text+" series",U.render&&U.text&&U.text!==""&&(M=e.renderer.createGroup({id:this.legendID+this.generateId(U,"_g_",P)}),M&&(this.chart.getModuleName()==="chart"||this.chart.getModuleName()==="accumulationchart")?(M.setAttribute("tabindex",x===0&&t.accessibility.focusable?String(t.accessibility.tabIndex):""),M.style.outline="none",M.setAttribute("aria-label",t.accessibility.accessibilityDescription?t.accessibility.accessibilityDescription:U.text+" series is "+(U.visible?"showing, press enter to hide the ":"hidden, press enter to show the ")+U.text+" series"),M.setAttribute("role",t.accessibility.accessibilityRole?t.accessibility.accessibilityRole:"button"),M.setAttribute("aria-pressed",U.visible?"true":"false")):M&&(M.setAttribute("tabindex",x===0?"0":""),M.style.outline="none",M.setAttribute("aria-label",t.description||U.text+" series is "+(U.visible?"showing, press enter to hide the ":"hidden, press enter to show the ")+U.text+" series"),M.setAttribute("role","button"),M.setAttribute("aria-pressed",U.visible?"true":"false")),this.library.getRenderPoint(U,k,N,A,h,D,d),this.renderSymbol(U,M,P),this.renderText(e,U,M,R,D,P),M&&(M.style.cssText="pointer-events: bounding-box; cursor: "+(!t.toggleVisibility&&(e.selectionMode==="None"||e.highlightMode==="None"||e.selectionMode==="None")||this.isBulletChartControl?"auto":"pointer")),S&&S.appendChild(M),A=U),D++;this.totalPages=this.isPaging&&!this.isBulletChartControl&&!this.legend.enablePages&&!this.isVertical&&this.totalPages>this.chartRowCount?this.chartRowCount:this.totalPages,this.currentPage=this.currentPage>1&&this.currentPage>this.totalPages?this.totalPages:this.currentPage,this.isPaging&&this.totalPages>1?this.renderPagingElements(e,i,R,y):this.totalPages=1}if(n){var ie="translate("+(this.rowCount>1?0:Math.round(Number(u))-Math.round(this.legendBounds.x))+` 
              + ',' + `+(Math.round(Number(c))-Math.round(this.legendBounds.y))+")",ne="translate("+(Math.round(Number(u))-Math.round(this.legendBounds.x))+", "+(Math.round(Number(c))-Math.round(this.legendBounds.y))+")";vt(e.enableCanvas,e.svgObject,y,r,!0,"x","y",void 0,void 0,void 0,void 0,void 0,e.duration,void 0,void 0,new Je(0,0),this.position==="Top"||this.position==="Bottom"?ie:ne)}else vt(e.enableCanvas,e.svgObject,y,r)},o.prototype.getLinearLegend=function(e,t,i,r){var n="http://www.w3.org/2000/svg",s=this.legendCollections[0],a=this.legendCollections[1],l=this.chart.renderer.createDefs(),h=0,u=document.createElementNS(n,"linearGradient"),c=1,d=[],p=[];i.title&&(this.isVertical?(e.y+=this.legendTitleSize.height,e.height-=this.legendTitleSize.height):i.titlePosition==="Left"?(e.x+=this.legendTitleSize.width,e.width-=this.legendTitleSize.width):i.titlePosition==="Right"?e.width-=this.legendTitleSize.width:i.titlePosition==="Top"&&(e.y+=this.legendTitleSize.height,e.height-=this.legendTitleSize.height));for(var f=0,v=this.chart.rangeColorSettings;f<v.length;f++){var m=v[f];if(p.indexOf(m.start)<0&&p.push(m.start),m.colors.length>2){var y=m.end-m.start,S=m.colors.length-1;if(y>0){y=y/S;for(var b=1;b<S;b++){var w=m.start+y*b;p.push(w)}}else for(var b=1;b<S;b++)p.push(m.start)}p.indexOf(m.end)<0&&p.push(m.end);for(var I=0,x=m.colors;I<x.length;I++){var M=x[I];d.indexOf(M)<0&&d.push(M)}m.colors.length>0&&m.colors.length<2&&d.push(m.colors[0])}var D=this.isRtlEnable&&!this.isVertical?"100%":"0%",A=this.isVertical||this.isRtlEnable?"0%":"100%",L=this.isVertical?"100%":"0%";u.setAttribute("id",this.generateId(s,"linearGradient",h)),u.setAttribute("x1",D),u.setAttribute("y1","0%"),u.setAttribute("x2",A),u.setAttribute("y2",L);for(var T=p[p.length-1]-p[0],k=0;k<d.length;k++){var F=p[k]-p[0];F=F/T;var R=document.createElementNS(n,"stop");R.setAttribute("offset",F.toString()),R.setAttribute("stop-color",d[k]),R.setAttribute("stop-opacity",c.toString()),u.appendChild(R)}var N=s.text.toString(),P=a.text.toString(),O=Ze(N,i.textStyle,this.chart.themeStyle.legendLabelFont),z=Ze(P,i.textStyle,this.chart.themeStyle.legendLabelFont),H=O.width>z.width?O.width:z.width,Q=O.height>z.height?O.height:z.height,$=2*H+4*i.padding,U=e.width,ie=e.height,ne=e.x+H+2*i.padding,te=e.y+i.padding,oe,ae,ye,De;if(this.isVertical){if($=2*Q+4*i.padding,U=e.width-2*i.padding,ie=e.height-$,ne=e.x+i.padding,te=e.y+Q+2*i.padding,oe=e.y+i.padding+Q,ae=te+ie+Q,ye=e.x+e.width*.5-H*.5,De=ye,U>30){var ve=U-30;U=30,ne=ne+ve/2}}else if(U=e.width-$,ie=e.height-2*i.padding,ye=e.x+(this.isRtlEnable?U+3*i.padding+H:i.padding+(H-O.width)),De=e.x+(this.isRtlEnable?i.padding+(H-z.width):U+3*i.padding+H),oe=e.y+e.height*.5+Q*.25,ae=oe,ie>30){var ue=ie-30;ie=30,te=te+ue/2}var Tt=t.enableRtl?"end":"",_e=new gn("",ye,oe,Tt,N),lt="#D3D3D3";_e.id=this.legendID+this.generateId(s,"_text_",1);var We=s.visible?i.textStyle.color||t.themeStyle.legendLabelFont.color:lt,ct=this.isStockChartControl?!1:this.chart.enableCanvas;hn(t.renderer,_e,i.textStyle,We,r,!1,!1,!1,!1,null,this.currentPageNumber&&ct?new Ae(0,-this.translatePage(ct,null,this.currentPageNumber-1,this.currentPageNumber),0,0):null,null,null,null,null,this.chart.themeStyle.legendLabelFont),_e=new gn("",De,ae,Tt,P),_e.id=this.legendID+this.generateId(s,"_text_",2),hn(t.renderer,_e,i.textStyle,We,r,!1,!1,!1,!1,null,this.currentPageNumber&&ct?new Ae(0,-this.translatePage(ct,null,this.currentPageNumber-1,this.currentPageNumber),0,0):null,null,null,null,null,this.chart.themeStyle.legendLabelFont);var Dt=t.renderer.drawRectangle({width:U,height:ie,x:ne,y:te,fill:"url(#"+this.generateId(s,"linearGradient",h)+")"});l.appendChild(u),r.appendChild(l),r.appendChild(Dt)},o.prototype.findFirstLegendPosition=function(e){for(var t=0,i=0,r=e;i<r.length;i++){var n=r[i];if(n.render&&n.text&&n.text!=="")break;t++}return t},o.prototype.calculateLegendTitle=function(e,t){if(e.title){this.isTop=e.titlePosition==="Top";var i=e.titleStyle.textOverflow==="Trim"?2*e.padding:0;this.isTop||this.isVertical?this.legendTitleCollections=jc(e.title,e.titleStyle,t.width-i,this.chart.enableRtl,this.chart.themeStyle.legendTitleFont):this.legendTitleCollections[0]=js(e.maximumTitleWidth,e.title,e.titleStyle,this.chart.enableRtl,this.chart.themeStyle.legendTitleFont);var r=this.isTop?e.title:this.legendTitleCollections[0];this.legendTitleSize=Ze(r,e.titleStyle,this.chart.themeStyle.legendTitleFont),this.legendTitleSize.height*=this.legendTitleCollections.length}else this.legendTitleSize=new _t(0,0)},o.prototype.renderLegendTitle=function(e,t,i,r){var n=t.padding,s=t.titleStyle.textAlignment;this.isTop=t.titlePosition==="Top";var a=Xh(t.titleStyle.textAlignment,e.enableRtl),l=Qh(i,t.titleStyle);a=this.isTop||this.isVertical?a:e.enableRtl?"end":"",l=s==="Near"?l+n:s==="Far"?l-n:l,l=this.isTop||this.isVertical?l:i.x+(t.titlePosition==="Left"?5:i.width-this.legendTitleSize.width-5);var h=i.height/2+this.legendTitleSize.height/4,u=i.y+(!this.isTop&&!this.isVertical?h:this.legendTitleSize.height/this.legendTitleCollections.length),c=new gn(this.legendID+"_title",l,u,a,this.legendTitleCollections);hn(e.renderer,c,t.titleStyle,t.titleStyle.color||this.chart.themeStyle.legendTitleFont.color,r,null,null,null,null,null,null,null,null,null,null,this.chart.themeStyle.legendTitleFont)},o.prototype.createLegendElements=function(e,t,i,r,n,s){var a=r.padding,l=new as(n+"_element",r.background,r.border,r.opacity,t,0,0,"",this.legend.border.dashArray),h=e.renderer.createGroup({id:n+"_collections"}),u=this.isStockChartControl?!1:e.enableCanvas,c=e.renderer.createClipPath({id:n+"_clipPath"});return l.width=this.isRtlEnable&&this.chart.getModuleName()==="accumulationchart"&&this.isVertical&&r.layout==="Auto"&&!(r.maximumColumns>0)?this.maxWidth:t.width,i?i.appendChild(e.renderer.drawRectangle(l)):e.renderer.drawRectangle(l),r.title&&this.renderLegendTitle(e,r,t,i),u||i.appendChild(h),this.legendTranslateGroup=e.renderer.createGroup({id:n+"_translate_g"}),u||h.appendChild(this.legendTranslateGroup),l.y+=(this.isTop?this.legendTitleSize.height:0)+(this.isBulletChartControl?0:r.containerPadding.top),l.height-=(this.isTop&&(this.isChartControl||!this.isVertical||r.layout!=="Auto")?this.legendTitleSize.height:0)+(this.isBulletChartControl?0:r.containerPadding.top),l.id+="_clipPath_rect",l.width=!this.isChartControl&&e.getModuleName()!=="bulletChart"&&!this.isStockChartControl&&!(e.getModuleName()==="accumulationchart"&&(r.layout!=="Auto"||r.maximumColumns>0))&&this.isVertical?this.maxWidth-a+r.containerPadding.left+r.containerPadding.right:t.width,u?this.pagingClipRect=l:(this.clipRect=e.renderer.drawRectangle(l),c.appendChild(this.clipRect)),vt(u,e.svgObject,c,s),u||(h.style.cssText="clip-path:url(#"+c.id+")"),this.legendTranslateGroup},o.prototype.renderSymbol=function(e,t,i){var r=this.isBulletChartControl?this.chart:null,n=e.visible?e.fill:"#D3D3D3",s=(this.chart.getModuleName()==="chart"||this.chart.getModuleName()==="stockChart")&&(e.shape==="SeriesType"&&e.type.toLowerCase().indexOf("line")>-1&&e.type.toLowerCase().indexOf("area")===-1||e.shape==="HorizontalLine"||e.shape==="VerticalLine"||e.shape==="Cross"),a=(this.chart.getModuleName()==="chart"||this.chart.getModuleName()==="stockChart")&&(e.type==="Scatter"||e.type==="Bubble"),l=this.isStockChartControl?!1:this.chart.enableCanvas,h,u=e.shape==="SeriesType"?e.type:e.shape,c=s?this.legend.mode==="Series"?this.chart.visibleSeries[i].width:this.chart.visibleSeries[0].width:this.isBulletChartControl&&e.shape==="Multiply"?4:1,d;if(u=u==="Scatter"?e.markerShape:u,a&&i<this.chart.visibleSeries.length){var p=this.chart.visibleSeries[i],f=p.border,v=u==="HorizontalLine"||u==="VerticalLine";h=v?n:f.color?f.color:n,c=v?p.width:f.width?f.width:1}var m=new Ir(this.legendID+this.generateId(e,"_shape_",i),n,c,a?h:n,this.legend.opacity,e.dashArray,""),y=Ze(e.text,this.legend.textStyle,this.chart.themeStyle.legendLabelFont),S=this.legend.isInversed&&!this.isRtlEnable?e.location.x+y.width+this.legend.shapePadding:e.location.x,b=e.location.y;l?(d=-this.translatePage(l,null,this.currentPageNumber-1,this.currentPageNumber),zs({x:S,y:b},u,new _t(this.legend.shapeWidth,this.legend.shapeHeight),"",m,this.accessbilityText,this.chart.renderer,this.currentPageNumber?new Ae(0,d,0,0):null,this.isBulletChartControl,r),this.legendRegions.push({rect:new Ae(e.location.x-this.legend.shapeWidth,e.location.y,this.legend.shapeWidth+this.legend.shapePadding,this.legend.shapeHeight+d),index:i})):t.appendChild(zs({x:S,y:b},u,new _t(this.legend.shapeWidth,this.legend.shapeHeight),e.url,m,this.accessbilityText,this.chart.renderer,null,this.isBulletChartControl,r)),(u==="Line"&&e.markerVisibility&&e.markerShape!=="Image"||e.type==="Doughnut"&&u==="Doughnut")&&(m.id=this.legendID+this.generateId(e,"_shape_marker_",i),u=e.type==="Doughnut"?"Circle":e.markerShape,m.fill=e.type==="Doughnut"?"#FFFFFF":m.fill,l?zs({x:S,y:b},u,new _t(this.legend.shapeWidth/2,this.legend.shapeHeight/2),"",m,this.accessbilityText,this.chart.renderer,this.currentPageNumber?new Ae(0,-this.translatePage(l,null,this.currentPageNumber-1,this.currentPageNumber),0,0):null,this.isBulletChartControl,r):t.appendChild(zs({x:S,y:b},u,new _t(this.legend.shapeWidth/2,this.legend.shapeHeight/2),"",m,this.accessbilityText,null,null,this.isBulletChartControl,r)))},o.prototype.renderText=function(e,t,i,r,n,s){var a=e.legendSettings,l="#D3D3D3",h=t.visible?a.textStyle.color||e.themeStyle.legendLabelFont.color:l,u=this.isStockChartControl?!1:this.chart.enableCanvas;if(r.id=this.legendID+this.generateId(t,"_text_",s),r.text=t.textCollection.length>0?t.textCollection:t.text,a.isInversed&&!this.isRtlEnable)r.x=t.location.x-a.shapeWidth/2;else if(this.isRtlEnable){var c=Ze(t.text,a.textStyle,this.chart.themeStyle.legendLabelFont).width;r.x=this.chart.getModuleName()==="bulletChart"?t.location.x-a.shapeWidth:t.location.x-((t.textCollection.length>1?c/t.textCollection.length:c)+a.shapeWidth/2+a.shapePadding)}else r.x=t.location.x+a.shapeWidth/2+a.shapePadding;if(r.y=t.location.y+this.maxItemHeight/4,hn(e.renderer,r,a.textStyle,h,i,!1,!1,!1,!1,null,this.currentPageNumber&&u?new Ae(0,-this.translatePage(u,null,this.currentPageNumber-1,this.currentPageNumber),0,0):null,null,null,null,null,this.chart.themeStyle.legendLabelFont),u){for(var d=Ze(t.text,a.textStyle,this.chart.themeStyle.legendLabelFont),p=void 0,f=0;f<this.legendRegions.length;f++)if(this.legendRegions[f].index===n){p=this.legendRegions[f];break}p.rect.y=r.y<p.rect.y?r.y:p.rect.y,p.rect.width+=d.width,p.rect.height=d.height,p.rect.y-=d.height*.5,p.rect.x-=this.isRtlEnable?p.rect.width:0}},o.prototype.renderPagingElements=function(e,t,i,r){var n=e.renderer.createGroup({id:this.legendID+"_navigation"}),s=this.isStockChartControl?!1:e.enableCanvas,a=this.isBulletChartControl?0:this.legendTitleSize.height,l=this.chart.theme.indexOf("Dark")>-1||this.chart.theme.indexOf("Contrast")>-1?"#FFFFFF":"#545454",h=e.legendSettings,u=8,c=this.legendID+(this.isRtlEnable?"_pagedown":"_pageup"),d=this.legendID+(this.isRtlEnable?"_pageup":"_pagedown"),p=new Ir(c,"transparent",5,l,1,"",""),f=e.availableSize.width<110||e.availableSize.height<190?4:this.pageButtonSize,v=he({},V("properties",h.textStyle),null,!0);v.size=e.availableSize.width<110||e.availableSize.height<190&&!this.isBulletChartControl&&this.chart.getModuleName()==="accumulationchart"?"8px":h.textStyle.size;var m=!h.enablePages&&this.isPaging&&!this.isVertical&&!this.isBulletChartControl?1:this.rowCount-1,y=this.isTitle&&h.titlePosition==="Left"?this.legendTitleSize.width:0;this.pagingRegions=[],this.backwardArrowOpacity=this.currentPage!==1?1:0,this.forwardArrowOpacity=this.currentPage===this.totalPages?0:1,s||r.appendChild(n),!this.isChartControl&&!this.isAccChartControl&&(this.isBulletChartControl||this.isStockChartControl||!this.isVertical?this.totalPages=Math.ceil(this.totalPages/Math.max(1,this.rowCount-1)):this.totalPages=Math.ceil(this.totalPages/this.maxColumns)),n&&(n.style.cursor="pointer"),(this.isChartControl||this.isAccChartControl)&&!(!h.enablePages&&this.isPaging)?this.clipPathHeight=this.pageHeights[0]-(this.isTitle&&this.isTop&&(this.isChartControl||!this.isVertical||h.layout!=="Auto")?this.legendTitleSize.height:0)-h.containerPadding.top-h.containerPadding.bottom:this.clipPathHeight=m*(this.maxItemHeight+h.padding),s?(this.pagingClipRect.height=this.legendBounds.height-this.clipPathHeight-(this.pagingClipRect.y-this.legendBounds.y)-h.border.width,this.pagingClipRect.y=this.pagingClipRect.y+this.clipPathHeight,this.pagingClipRect.x+=h.border.width,this.pagingClipRect.width-=h.border.width+h.border.width/2,this.chart.renderer.clearRect(new Ae(this.pagingClipRect.x,this.pagingClipRect.y,this.pagingClipRect.width,this.pagingClipRect.height))):this.clipRect.setAttribute("height",this.clipPathHeight.toString());var S,b=t.x+f/2,w=t.y+this.clipPathHeight+(a+t.height-this.clipPathHeight)/2;this.isPaging&&!h.enablePages&&!this.isVertical&&!this.isBulletChartControl&&(b=t.x+this.pageButtonSize+y,w=h.title&&this.isTop?t.y+u+a+f/1+.5:t.y+u+f+.5);var I=Ze(this.totalPages+"/"+this.totalPages,v,this.chart.themeStyle.legendLabelFont),x=this.isRtlEnable?h.border.width+f/2:t.width-(2*(f+u)+u+I.width);s?zs({x:b,y:w},"LeftArrow",new _t(f,f),"",p,"LeftArrow",this.chart.renderer,new Ae(x,0,0,0)):this.isVertical&&!h.enablePages&&!this.isBulletChartControl?(b=t.x+t.width/2,w=t.y+f/2+u/2+a,p.opacity=this.backwardArrowOpacity,n.appendChild(zs({x:b,y:w},"UpArrow",new _t(f,f),"",p))):(p.opacity=this.isBulletChartControl?p.opacity:h.enablePages?1:this.isRtlEnable?this.forwardArrowOpacity:this.backwardArrowOpacity,n.appendChild(zs({x:b,y:w},"LeftArrow",new _t(f,f),"",p))),this.pagingRegions.push(new Ae(this.isRtlEnable?b:b+t.width-(2*(f+u)+u+I.width)-f*.5,w-f*.5,f,f)),i.x=b+f/2+u,i.y=w+I.height/4,i.id=this.legendID+"_pagenumber",i.text=this.isRtlEnable?this.totalPages+"/1":"1/"+this.totalPages;var M=this.chart.theme.indexOf("Dark")>-1||this.chart.theme.indexOf("Contrast")>-1?"#FFFFFF":h.textStyle.color||this.chart.theme==="Tailwind3"?"#111827":this.chart.theme==="Tailwind3Dark"?"#FFFFFF":this.chart.themeStyle.legendLabelFont.color;s&&this.totalNoOfPages&&(i.text=this.isRtlEnable?this.totalNoOfPages+"/"+this.currentPageNumber:this.currentPageNumber+"/"+this.totalNoOfPages),(h.enablePages||this.isBulletChartControl)&&(S=hn(e.renderer,i,v,M,n,!1,!1,!1,!1,null,new Ae(x,0,0,0),null,null,null,null,this.chart.themeStyle.legendLabelFont)),b=i.x+u+f/2+I.width,this.isPaging&&!h.enablePages&&!this.isBulletChartControl&&!this.isVertical&&(b=t.x+t.width-(this.isBulletChartControl?this.fivePixel:0)-this.pageButtonSize-(h.title&&h.titlePosition==="Right"?this.legendTitleSize.width+this.fivePixel:0)),p.id=d,p.opacity=h.enablePages?1:this.isRtlEnable?this.backwardArrowOpacity:this.forwardArrowOpacity,s?zs({x:b,y:w},"RightArrow",new _t(f,f),"",p,"RightArrow",this.chart.renderer,new Ae(x,0,0,0)):this.isVertical&&!h.enablePages&&!this.isBulletChartControl?(b=t.x+t.width/2,w=t.y+t.height-f/2,n.appendChild(zs({x:b,y:w},"DownArrow",new _t(f,f),"",p))):n.appendChild(zs({x:b,y:w},"RightArrow",new _t(f,f),"",p)),this.pagingRegions.push(new Ae(this.isRtlEnable?b:b+(t.width-(2*(f+u)+u+I.width)-f*.5),w-f*.5,f,f)),!s&&(h.enablePages||this.isBulletChartControl)?n.setAttribute("transform","translate("+x+", 0)"):(this.currentPageNumber===1&&this.calTotalPage&&(h.enablePages||this.isBulletChartControl)&&(this.totalNoOfPages=this.totalPages,this.calTotalPage=!1),!h.enablePages&&!this.isBulletChartControl&&this.translatePage(s,null,this.currentPage-1,this.currentPage,h)),(h.enablePages||this.isBulletChartControl)&&this.translatePage(s,S,this.currentPage-1,this.currentPage,h)},o.prototype.getPageHeight=function(e,t){for(var i=0,r=0;r<t;r++)i+=e[r]-(this.isTitle&&this.isTop?this.legendTitleSize.height:0);return i},o.prototype.translatePage=function(e,t,i,r,n){var s=this.isChartControl||this.isAccChartControl?i?this.getPageHeight(this.pageHeights,i):0:this.clipPathHeight*i;!e&&(this.isChartControl||this.isAccChartControl)&&(this.clipRect.setAttribute("height",(this.pageHeights[i]-(this.isTitle&&this.isTop&&(this.isChartControl||!this.isVertical||n.layout!=="Auto")?this.legendTitleSize.height:0)-n.containerPadding.top-n.containerPadding.bottom).toString()),this.isAccChartControl&&this.isPaging&&!n.enablePages&&this.isVertical&&(this.chart.getModuleName()!=="accumulationchart"||n.layout==="Auto")&&this.clipRect.setAttribute("height",this.legendBounds.height.toString()));var a="translate(0,-"+s+")";if(!this.isChartControl&&!this.isBulletChartControl&&!this.isStockChartControl&&!(this.chart.getModuleName()==="accumulationchart"&&n.layout!=="Auto")&&this.isVertical){var l=this.pageXCollections[i*this.maxColumns];s=this.isRtlEnable?this.legendBounds.x+this.maxWidth-l:l-this.legendBounds.x,s=s<0?0:s,a=(this.isRtlEnable?"translate(":"translate(-")+s+",0)"}return this.chart.enableCanvas||this.legendTranslateGroup.setAttribute("transform",a),!this.chart.enableCanvas&&(n.enablePages||this.isBulletChartControl)&&(t.textContent=r+"/"+this.totalPages),this.currentPage=r,s},o.prototype.changePage=function(e,t){var i=this.chart.legendSettings,r=document.getElementById(this.legendID+"_pageup"),n=document.getElementById(this.legendID+"_pagedown"),s=this.isStockChartControl?!1:this.chart.enableCanvas,a=i.enablePages||this.isBulletChartControl?document.getElementById(this.legendID+"_pagenumber"):null,l=i.enablePages||this.isBulletChartControl?parseInt(a.textContent.split("/")[0],10):this.currentPage;t&&l>1?this.translatePage(s,a,l-2,l-1,i):!t&&l<this.totalPages&&this.translatePage(s,a,l,l+1,i),this.isPaging&&!i.enablePages&&!this.isBulletChartControl&&(this.currentPage===this.totalPages?this.hideArrow(n):this.showArrow(n),this.currentPage===1?this.hideArrow(r):this.showArrow(r))},o.prototype.hideArrow=function(e){e.setAttribute("opacity","0")},o.prototype.showArrow=function(e){e.setAttribute("opacity","1")},o.prototype.generateId=function(e,t,i){return this.isChartControl||this.isStockChartControl?t+i:t+e.pointIndex},o.prototype.move=function(e){var t=this,i=this.chart.mouseX,r=this.chart.mouseY;if(e.target.textContent.indexOf("...")>-1){var n=e.target.id.split(this.legendID+"_text_");if(n.length===2){var s=parseInt(n[1],10),a=this.chart.element;isNaN(s)||(this.chart.isTouch&&ni(this.chart.element.id+"_EJ2_Legend_Tooltip"),this.isChartControl?Pc(this.chart.series[s].name,i,r,a.offsetWidth,a.id+"_EJ2_Legend_Tooltip",ce(this.chart.element.id+"_Secondary_Element")):Pc(this.chart.getModuleName()==="accumulationchart"?this.legendCollections[s].originalText:this.chart.visibleSeries[0].points[s].x.toString(),i+10,r+10,a.offsetWidth,a.id+"_EJ2_Legend_Tooltip",ce(this.chart.element.id+"_Secondary_Element")))}}else ni(this.chart.element.id+"_EJ2_Legend_Tooltip");this.chart.isTouch&&(clearTimeout(this.clearTooltip),this.clearTooltip=+setTimeout(function(){ni(t.chart.element.id+"_EJ2_Legend_Tooltip")},1e3))},o}(),qh=function(){function o(e,t,i,r,n,s,a,l,h,u,c,d){this.location={x:0,y:0},this.textCollection=[],this.text=e,this.fill=t,this.shape=i,this.url=s,this.visible=r,this.type=n,this.markerVisibility=l,this.markerShape=a,this.pointIndex=h,this.seriesIndex=u,this.dashArray=c,this.originalText=d}return o}(),EW=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Xr=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},AN=function(o){EW(e,o);function e(){var t=o!==null&&o.apply(this,arguments)||this;return t.clipRect=new Ae(0,0,0,0),t}return e.prototype.setDataSource=function(t,i){t&&(this.xData=t.xData,this.yData=t.yData,this.points=t.points);var r=$r(this.type);this.visible&&i[r+"IndicatorModule"].initDataSource(this,i),i.visibleSeriesCount+=this.targetSeries.length},Xr([C("Sma")],e.prototype,"type",void 0),Xr([C(14)],e.prototype,"period",void 0),Xr([C(14)],e.prototype,"kPeriod",void 0),Xr([C(3)],e.prototype,"dPeriod",void 0),Xr([C(80)],e.prototype,"overBought",void 0),Xr([C(20)],e.prototype,"overSold",void 0),Xr([C(2)],e.prototype,"standardDeviation",void 0),Xr([C("Close")],e.prototype,"field",void 0),Xr([C(12)],e.prototype,"slowPeriod",void 0),Xr([C(26)],e.prototype,"fastPeriod",void 0),Xr([C(!0)],e.prototype,"showZones",void 0),Xr([be({color:"#ff9933",width:2},Fc)],e.prototype,"macdLine",void 0),Xr([C("Both")],e.prototype,"macdType",void 0),Xr([C("#2ecd71")],e.prototype,"macdPositiveColor",void 0),Xr([C("#e74c3d")],e.prototype,"macdNegativeColor",void 0),Xr([C("rgba(211,211,211,0.25)")],e.prototype,"bandColor",void 0),Xr([be({color:"#ffb735",width:1},Fc)],e.prototype,"upperLine",void 0),Xr([be({color:"#f2ec2f",width:1},Fc)],e.prototype,"lowerLine",void 0),Xr([be({color:"#f2ec2f",width:1},Fc)],e.prototype,"periodLine",void 0),Xr([be({},So)],e.prototype,"accessibility",void 0),Xr([C("")],e.prototype,"seriesName",void 0),e}(hF),fF=function(){function o(e){this.control=e}return o.prototype.print=function(e){this.printWindow=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no"),this.printWindow.moveTo(0,0),this.printWindow.resizeTo(screen.availWidth,screen.availHeight);var t={cancel:!1,htmlContent:this.getHTMLContent(e),name:SN};this.control.trigger(SN,t),t.cancel||TS(t.htmlContent,this.printWindow)},o.prototype.getHTMLContent=function(e){var t=Xe("div");if(e)if(e instanceof Array)for(var i=0;i<e.length;i++){var r=e[i];t.appendChild(ce(r).cloneNode(!0))}else e instanceof Element?t.appendChild(e.cloneNode(!0)):t.appendChild(ce(e).cloneNode(!0));else t.appendChild(this.control.element.cloneNode(!0));for(var n=0;n<t.children.length;n++){for(var s=this.control.theme.indexOf("Dark")>-1||this.control.theme.indexOf("HighContrast")>-1?"rgba(0, 0, 0, 1)":"rgba(255, 255, 255, 1)",a=t.children[n],l=0;l<a.children.length;l++){var h=void 0,u=!1;a.id.indexOf("_stockChart_svg")>-1?(h=a.children[0].getAttribute("fill"),u=!0):a.children[l].id.indexOf("_svg")>-1&&(h=a.children[l].children[0].getAttribute("fill"),u=!0),u&&(h=h==="transparent"?s:h,a.children[l].children[0].setAttribute("fill",h))}t[n]=a}return t},o}(),Km=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ne=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},AW=function(o){Km(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Ne([C()],e.prototype,"start",void 0),Ne([C()],e.prototype,"end",void 0),Ne([C([])],e.prototype,"colors",void 0),Ne([C("")],e.prototype,"label",void 0),e}(Re),TW=function(o){Km(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Ne([C(!1)],e.prototype,"enable",void 0),Ne([C("")],e.prototype,"dashArray",void 0),Ne([be({color:null,width:1},Zn)],e.prototype,"line",void 0),Ne([C("Both")],e.prototype,"lineType",void 0),Ne([C("")],e.prototype,"verticalLineColor",void 0),Ne([C("")],e.prototype,"horizontalLineColor",void 0),Ne([C(1)],e.prototype,"opacity",void 0),Ne([C(!1)],e.prototype,"snapToData",void 0),Ne([C(!1)],e.prototype,"highlightCategory",void 0),e}(Re),LW=function(o){Km(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Ne([C(!1)],e.prototype,"enableSelectionZooming",void 0),Ne([C(!1)],e.prototype,"enablePinchZooming",void 0),Ne([C(!1)],e.prototype,"showToolbar",void 0),Ne([C(!1)],e.prototype,"enableMouseWheelZooming",void 0),Ne([C(!0)],e.prototype,"enableDeferredZooming",void 0),Ne([C("XY")],e.prototype,"mode",void 0),Ne([C(["Zoom","ZoomIn","ZoomOut","Pan","Reset"])],e.prototype,"toolbarItems",void 0),Ne([C(!1)],e.prototype,"enablePan",void 0),Ne([C(!1)],e.prototype,"enableScrollbar",void 0),Ne([C(!1)],e.prototype,"enableAnimation",void 0),Ne([be({},OU)],e.prototype,"toolbarPosition",void 0),Ne([be({},So)],e.prototype,"accessibility",void 0),e}(Re),Zm=function(o){Km(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.rotatedDataLabelCollections=[],r.animated=!1,r.isPointMouseDown=!1,r.isScrolling=!1,r.checkResize=0,r.visible=0,r.clickCount=0,r.maxPointCount=0,r.singleClickTimer=0,r.chartAreaType="Cartesian",r.isRtlEnabled=!1,r.isCrosshair=!0,r.chartid=57723,r.isLegendClicked=!1,r.isZoomed=!1,r.previousTargetId="",r.currentPointIndex=0,r.currentSeriesIndex=0,r.currentLegendIndex=0,r.previousPageX=null,r.previousPageY=null,r.allowPan=!1,r.pointsRemoved=!1,r.pointsAdded=!1,r.zoomRedraw=!1,Ge("mergePersistData",r.mergePersistChartData,r),r}return e.prototype.mergePersistChartData=function(){var t=window.localStorage.getItem(this.getModuleName()+this.element.id);if(!(g(t)||t==="")){var i=JSON.parse(t),r=Object.keys(i);this.isProtectedOnChange=!0;for(var n=0,s=r;n<s.length;n++){var a=s[n];typeof this[a]=="object"&&!g(this[a])?he(this[a],i[a]):this[a]=i[a]}this.isProtectedOnChange=!1}},e.prototype.isIdHasSpecialCharacter=function(t){var i=/^[A-Za-z ]+$/,r=/^[0-9 ]+$/,n="";if(i.test(t))return t;var s=0;r.test(t[0])&&(n+="\\3"+t[0],s=1);for(var a=s;a<t.length;a++)!i.test(t[a])&&t.indexOf("-")===-1&&t.indexOf("_")===-1&&t.indexOf("\\")===-1&&!r.test(t[a])?n+="\\"+t[a]:n+=t[a];return n},e.prototype.preRender=function(){this.element.id=this.isIdHasSpecialCharacter(this.element.id);var t="Blazor";this.isBlazor=window[t],this.allowServerDataBinding=!1,this.markerIndex=0,this.unWireEvents(),this.initPrivateVariable(),this.setCulture(),this.wireEvents(),this.stockChart&&(this.stockChart.tooltip.header===null&&(this.tooltip.header=this.stockChart.theme.indexOf("Tailwind3")>-1?"${point.x}":"<b>${point.x}</b>"),this.stockChart.tooltip.format===null&&(this.tooltip.format=this.stockChart.theme.indexOf("Tailwind3")>-1?"High : ${point.high}<br/>Low : ${point.low}<br/>Open : ${point.open}<br/>Close : ${point.close}":"High : <b>${point.high}</b><br/>Low : <b>${point.low}</b><br/>Open : <b>${point.open}</b><br/>Close : <b>${point.close}</b>")),this.element.setAttribute("dir",this.enableRtl?"rtl":"ltr")},e.prototype.initPrivateVariable=function(){if(this.animateSeries=!0,this.delayRedraw=!1,this.dragY=null,this.horizontalAxes=[],this.verticalAxes=[],this.refreshAxis(),this.refreshDefinition(this.rows),this.refreshDefinition(this.columns),this.tooltipModule&&(this.tooltipModule.previousPoints=[]),this.element.setAttribute("role",this.accessibility.accessibilityRole?this.accessibility.accessibilityRole:"region"),this.element.setAttribute("tabindex",this.accessibility.focusable?String(this.accessibility.tabIndex):"-1"),this.element.style.outline="none",this.element.setAttribute("aria-label",this.accessibility.accessibilityDescription?this.accessibility.accessibilityDescription:this.title+". Syncfusion interactive chart."),this.element.classList.contains("e-chart-focused")||this.element.setAttribute("class",this.element.getAttribute("class")+" e-chart-focused"),this.element.id===""){for(var t=document.getElementsByClassName("e-chart").length,i="chart_"+this.chartid+"_"+t;document.getElementById(i);)t++,i="chart_"+this.chartid+"_"+t;this.element.id="chart_"+this.chartid+"_"+t}this.svgId=this.stockChart?this.stockChart.element.id+"_stockChart_chart":this.element.id+(this.enableCanvas?"_canvas":"_svg")},e.prototype.render=function(){var t=this;this.svgRenderer=new Ql(this.element.id);var i={chart:this.isBlazor?{}:this,theme:this.theme,name:zm,cancel:!1};this.stockChart?(this.isRtlEnabled=window.getComputedStyle(document.querySelector("body")).direction==="rtl",this.cartesianChartRendering(i)):this.trigger(zm,i,function(){i.cancel||t.cartesianChartRendering(i)}),this.applyZoomkit()},e.prototype.cartesianChartRendering=function(t){this.theme=this.isBlazor?t.theme:this.theme,this.setTheme(),this.createChartSvg(),this.markerRender=new MW(this),this.calculateAreaType(),this.calculateVisibleSeries(),this.initTechnicalIndicators(),this.initTrendLines(),this.calculateVisibleAxis(),this.processData(),this.renderComplete(),this.mouseMoveEvent(),this.allowServerDataBinding=!0},e.prototype.getLocalizedLabel=function(t){return this.localeObject.getConstant(t)},e.prototype.animate=function(t){if(this.redraw=!0,this.animated=!0,this.duration=t||1e3,this.tooltipModule)this.tooltipModule.removeHighlightedMarker(this.tooltipModule.previousPoints,!0);else if(this.markerRender.previousPoints)for(var i=0;i<this.markerRender.previousPoints.length;i++)this.markerRender.removeHighlightedMarker(this.markerRender.previousPoints[i].series,this.markerRender.previousPoints[i].point)},e.prototype.refreshBound=function(){if(this.rotatedDataLabelCollections=[],this.legendModule&&this.legendSettings.visible&&this.legendModule.getLegendOptions(this.visibleSeries,this),this.tooltip.enable&&this.tooltipModule&&(this.tooltipModule.previousPoints=[]),this.calculateStackValues(),this.calculateBounds(),this.stockChart&&!this.stockChart.rangeFound&&(this.stockChart.enablePeriodSelector||this.stockChart.enableSelector))return null;this.renderElements(),ni("chartmeasuretext"),this.removeSelection(),this.markerRender&&this.markerRender.mergeXvalues(this.visibleSeries)},e.prototype.calculateStackValues=function(){for(var t,i=!1,r=0,n=this.visibleSeries.length;r<n;r++)t=this.visibleSeries[r],t.visible&&(t.position=t.rectCount=void 0),(t.type.indexOf("Stacking")!==-1||t.drawType.indexOf("Stacking")!==-1&&this.chartAreaType==="PolarRadar")&&!i&&(t.calculateStackedValue(t.type.indexOf("100")>-1,this),i=!0)},e.prototype.removeSelection=function(){for(var t=0,i=this.visibleSeries;t<i.length;t++){var r=i[t];if(r.visible)for(var n=0,s=r.points;n<s.length;n++){var a=s[n];a.isSelect=!1}}ce(this.element.id+"_ej2_drag_multi_group")?(this.selectionMode.indexOf("Drag")>-1&&(this.selectionModule.filterArray=[]),ni(this.element.id+"_ej2_drag_multi_group"),this.selectionModule.calculateDragSelectedElements(this,new Ae(0,0,0,0),!0)):ce(this.element.id+"_ej2_drag_group")&&(this.selectionMode!=="Lasso"&&(this.selectionModule.filterArray=[]),ni(this.element.id+"_ej2_drag_group"),this.selectionModule.calculateDragSelectedElements(this,new Ae(0,0,0,0),!0))},e.prototype.renderElements=function(){this.renderBorder(),this.renderTitle(),this.renderAreaBorder(),this.renderSeriesElements(this.renderAxes()),this.renderLegend(),this.applyZoomkit(),this.performSelection(),this.setSecondaryElementPosition();for(var t=0,i=this.visibleSeries;t<i.length;t++){var r=i[t];rc(this.element.id+"_DataLabel","Template",r.marker.dataLabel)}this.renderAnnotation(),this.stackLabels.visible&&this.visibleSeries.some(function(n){return n.type&&n.type.indexOf("Stacking")>-1})&&this.dataLabelModule&&this.dataLabelModule.renderStackLabels()},e.prototype.renderAxes=function(){this.yAxisElements=this.renderer.createGroup({id:this.element.id+"yAxisCollection"});var t;return this.rows.length>0&&this.columns.length>0&&(t=this.chartAxisLayoutPanel.renderAxes()),this.stripLineModule&&this.stripLineModule.renderStripLine(this,"Behind",this.axisCollections),t},e.prototype.renderLegend=function(){if(this.legendModule&&this.legendModule.legendCollections.length&&this.legendSettings.visible){this.legendModule.calTotalPage=!0;var t=this.legendSettings.border.width,i=this.legendModule.legendBounds,r=new Ae(i.x,i.y,i.width,i.height);this.enableCanvas&&(this.canvasRender.ctx.beginPath(),r=new Ae(r.x-t/2,r.y-t/2,r.width+t,r.height+t),this.renderer.canvasClip(r)),this.legendModule.renderLegend(this,this.legendSettings,i),this.enableCanvas&&this.renderer.canvasRestore()}this.redraw||(this.stockChart?ce(this.stockChart.chartObject.id)||this.stockChart.mainObject.appendChild(this.svgObject):this.element.appendChild(this.svgObject))},e.prototype.setSecondaryElementPosition=function(){var t=ce(this.element.id+"_Secondary_Element");if(t){var i=this.element.getBoundingClientRect(),r=ce(this.svgId).getBoundingClientRect();t.style.left=Math.max((r.left-i.left)/this.scaleX,0)+"px",t.style.top=Math.max((r.top-i.top)/this.scaleY,0)+"px"}},e.prototype.initializeModuleElements=function(){this.dataLabelCollections=[];var t=this.element.id;this.series.length&&(this.seriesElements=this.svgRenderer.createGroup({id:t+"SeriesCollection"})),this.indicators.length&&(this.indicatorElements=this.renderer.createGroup({id:t+"IndicatorCollection"})),this.hasTrendlines()&&(this.trendLineElements=this.renderer.createGroup({id:t+"TrendLineCollection"})),this.dataLabelElements=this.renderer.createGroup({id:t+"DataLabelCollection"})},e.prototype.hasTrendlines=function(){for(var t,i=0,r=this.series;i<r.length;i++){var n=r[i];if(t=!!n.trendlines.length,t)break}return t},e.prototype.renderSeriesElements=function(t){this.initializeModuleElements();var i=this.element.id;if(this.element.tagName!=="g"){var r=Va(this.redraw,i+"_Secondary_Element")||this.createElement("div");r.id=i+"_Secondary_Element",r.style.cssText="position: relative",vt(!1,this.element,r,this.redraw)}if(this.enableCanvas){var n=document.getElementById(i+"_Secondary_Element");n=n||this.createElement("div",{id:i+"_Secondary_Element",attrs:{style:"position: relative; left:0px; top:0px"}});var s=this.svgRenderer.createSvg({id:i+"_tooltip_svg",width:this.availableSize.width,height:this.availableSize.height});s.style.cssText="position: absolute; pointer-events: none",n.appendChild(s)}this.tooltip.enable&&!this.stockChart&&vt(this.enableCanvas,this.svgObject,this.renderer.createGroup({id:i+"_UserInteraction",style:"pointer-events:none;"}),this.redraw),this.rows.length>0&&this.columns.length>0&&(this.initializeIndicator(),this.initializeTrendLine(),this.renderSeries(),this.trendLineElements&&vt(this.enableCanvas,this.svgObject,this.trendLineElements,this.redraw),this.appendElementsAfterSeries(t))},e.prototype.renderSeries=function(){var t;this.enableCanvas&&this.renderer.canvasClip(this.chartAxisLayoutPanel.seriesClipRect);for(var i=0,r=this.visibleSeries;i<r.length;i++){var n=r[i];n.category==="TrendLine"?t=this.series[n.sourceIndex].trendlines[n.index].visible:t=n.visible,t?(this.visible++,qw(n,this.enableCanvas),this.enableCanvas&&this.renderCanvasSeries(),n.renderSeries(this)):n.isLegendClicked&&(n.type.indexOf("StackingArea")>-1||n.type.indexOf("StackingBar")>-1||n.type.indexOf("StackingColumn")>-1)&&(qw(n,this.enableCanvas),n.renderSeries(this))}this.enableCanvas&&this.renderer.canvasRestore(),this.visible=0;var s={id:this.element.id+"_ChartAreaClipRect_",x:this.chartAxisLayoutPanel.seriesClipRect.x,y:this.chartAxisLayoutPanel.seriesClipRect.y,width:this.chartAxisLayoutPanel.seriesClipRect.width,height:this.chartAxisLayoutPanel.seriesClipRect.height,fill:"transparent","stroke-width":1,stroke:"Gray"};if(!(!this.seriesElements||s.height<0||s.width<0)){var a;this.chartAreaType==="PolarRadar"?a=Kh(this.redraw,s,this.renderer,"drawCircularClipPath"):a=Kh(this.redraw,s,this.renderer),this.enableCanvas||this.seriesElements.appendChild(a);var l=document.getElementById(this.element.id+"_series_svg");l?vt(!1,l,this.seriesElements,this.redraw):vt(this.enableCanvas,this.svgObject,this.seriesElements,this.redraw)}},e.prototype.renderCanvasSeries=function(){var t;if(this.enableCanvas){var i=t;t=i}else t=this.svgObject},e.prototype.initializeIndicator=function(){for(var t=0,i=this.indicators;t<i.length;t++){var r=i[t];this[$r(r.type)+"IndicatorModule"]&&this[$r(r.type)+"IndicatorModule"].createIndicatorElements(this,r,r.index)}this.indicatorElements&&vt(this.enableCanvas,this.svgObject,this.indicatorElements,this.redraw)},e.prototype.initializeTrendLine=function(){for(var t=0,i=this.visibleSeries;t<i.length;t++){var r=i[t];r.trendlines.length&&this.trendLineModule.getTrendLineElements(r,this)}},e.prototype.appendElementsAfterSeries=function(t){this.chartAreaType==="PolarRadar"&&vt(this.enableCanvas,this.svgObject,this.yAxisElements,this.redraw),vt(this.enableCanvas,this.svgObject,t,this.redraw),(this.zoomModule&&this.zoomSettings.enableScrollbar&&this.scrollElement&&this.scrollElement.childElementCount||this.scrollElement&&this.scrollElement.childElementCount)&&vt(!1,ce(this.element.id+"_Secondary_Element"),this.scrollElement,this.redraw),this.stripLineModule&&this.stripLineModule.renderStripLine(this,"Over",this.axisCollections),(!this.tooltip.enable||this.stockChart)&&vt(this.enableCanvas,this.svgObject,this.renderer.createGroup({id:this.element.id+"_UserInteraction",style:"pointer-events:none;"}),this.redraw),this.stockChart&&this.stockChart.calculateStockEvents()},e.prototype.applyZoomkit=function(){this.chartAreaType!=="PolarRadar"&&(!this.redraw||this.zoomRedraw)&&this.zoomModule&&(!this.zoomSettings.enablePan||this.zoomModule.performedUI||this.zoomSettings.showToolbar)&&this.zoomModule.applyZoomToolkit(this,this.axisCollections)},e.prototype.renderAnnotation=function(){this.annotationModule&&this.annotationModule.renderAnnotations(ce((this.stockChart?this.stockChart.element.id:this.element.id)+"_Secondary_Element"))},e.prototype.performSelection=function(){var t=[];this.selectionModule&&(t=he([],this.selectionModule.selectedDataIndexes,null,!0),this.selectionModule.invokeSelection(this)),this.highlightModule&&this.highlightModule.invokeHighlight(this),t.length>0&&(this.selectionModule.selectedDataIndexes=t,this.selectionModule.redrawSelection(this,this.selectionMode))},e.prototype.processData=function(t){t===void 0&&(t=!0),this.visibleSeriesCount=0;for(var i=!0,r=0,n=0,s=this.visibleSeries;n<s.length;n++){var a=s[n];if(!a.visible&&!this.legendSettings.visible){this.visibleSeriesCount++;continue}a.category!=="Indicator"&&a.category!=="TrendLine"&&this.initializeDataModule(a)}for(var l=0,h=this.indicators;l<h.length;l++){var u=h[l];if(u.dataSource){var c=u;this.initializeDataModule(c),i=!1}}if(t&&(!this.visibleSeries.length||this.visibleSeriesCount===this.visibleSeries.length&&i)&&(this.refreshBound(),this.trigger("loaded",{chart:this.isBlazor?{}:this})),!this.stockChart&&this.visibleSeries.length>0)for(var d=0,p=this.visibleSeries;d<p.length;d++){var a=p[d];g(a.points)||(this.maxPointCount=Math.max(r,a.points.length),r=a.points.length)}},e.prototype.initializeDataModule=function(t){t.xData=[],t.yData=[];var i,r="isAngular";this[r]?i=Object.keys(t.dataSource).length?t.dataSource:this.dataSource:i=t.dataSource||this.dataSource,t.dataModule=new uF(i,t.query),t.points=[],t.refreshDataManager(this)},e.prototype.calculateBounds=function(){var t=this.margin,i=0,r=0,n=this.titleStyle.position==="Top"||this.titleStyle.position==="Bottom"&&!this.legendSettings.visible?15:5,s=t.left+this.border.width,a=this.availableSize.width-s-t.right-this.border.width,l=0;this.titleCollection=[],this.subTitleCollection=[],this.title?(this.titleCollection=jc(this.title,this.titleStyle,a,this.enableRtl,this.themeStyle.chartTitleFont),i=Ze(this.title,this.titleStyle,this.themeStyle.chartTitleFont).height*this.titleCollection.length+n,this.subTitle&&(this.subTitleCollection=jc(this.subTitle,this.subTitleStyle,a,this.enableRtl,this.themeStyle.chartSubTitleFont),r=Ze(this.subTitle,this.subTitleStyle,this.themeStyle.chartSubTitleFont).height*this.subTitleCollection.length+n)):this.legendSettings.position!=="Top"&&this.border.width&&(l=10);var h=t.top+l+this.border.width+this.chartArea.border.width*.5,u=this.availableSize.height-h-this.border.width-t.bottom,c=r+i+this.titleStyle.border.width+this.subTitleStyle.border.width;switch(this.titleStyle.position){case"Top":h+=c,u-=c;break;case"Bottom":u-=c;break;case"Left":s+=c,a-=c;break;case"Right":s-=this.titleStyle.border.width+this.subTitleStyle.border.width,a-=c;break}if(this.stockChart&&this.stockChart.legendSettings.visible&&this.stockChart.stockLegendModule&&(this.stockChart.legendSettings.position==="Top"?h+=this.stockChart.stockLegendModule.legendBounds.height:this.stockChart.legendSettings.position==="Left"&&(s+=this.stockChart.stockLegendModule.legendBounds.width)),this.scrollBarModule&&(this.zoomModule&&this.zoomSettings.enableScrollbar&&this.zoomModule.isZoomed||this.scrollSettingEnabled))for(var d=10,p=0,f=this.axisCollections.length;p<f;p++){var v=this.axisCollections[p];v.orientation==="Horizontal"&&v.scrollbarSettings.position==="Bottom"?u-=v.scrollbarSettings.height+d:v.orientation==="Horizontal"&&v.scrollbarSettings.position==="Top"?(u-=v.scrollbarSettings.height+d,h+=v.scrollbarSettings.height+d):v.orientation==="Vertical"&&v.scrollbarSettings.position==="Right"?a-=v.scrollbarSettings.height+d:v.orientation==="Vertical"&&v.scrollbarSettings.position==="Left"&&(a-=v.scrollbarSettings.height+d,s+=v.scrollbarSettings.height+d)}this.initialClipRect=new Ae(s,h,a,u),this.legendModule&&this.legendSettings.visible&&this.legendModule.calculateLegendBounds(this.initialClipRect,this.availableSize,null),this.initialClipRect.y+=this.chartArea.margin.top,this.initialClipRect.height-=this.chartArea.margin.top+this.chartArea.margin.bottom,this.initialClipRect.x+=this.chartArea.margin.left,this.initialClipRect.width-=this.chartArea.margin.left+this.chartArea.margin.right,this.chartAxisLayoutPanel.measureAxis(this.initialClipRect)},e.prototype.print=function(t){var i=new fF(this),r=this.width;this.getModuleName()==="chart"&&parseInt(this.width,10)>=80&&this.width.indexOf("%")>-1&&(this.width="80%",this.dataBind()),i.print(t),this.getModuleName()==="chart"&&parseInt(this.width,10)>=80&&this.width.indexOf("%")>-1&&(this.width=r,this.dataBind())},e.prototype.initTrendLines=function(){this.isProtectedOnChange=!0;for(var t=0,i=this.visibleSeries;t<i.length;t++)for(var r=i[t],n=0,s=0,a=r.trendlines;s<a.length;s++){var l=a[s],h=l;this.trendLineModule&&(h.index=n,h.sourceIndex=r.index,this.trendLineModule.initSeriesCollection(h,this),h.targetSeries&&(h.targetSeries.xAxisName=r.xAxisName,h.targetSeries.yAxisName=r.yAxisName,this.visibleSeries.push(h.targetSeries))),n++}this.isProtectedOnChange=!1},e.prototype.calculateAreaType=function(){var t=this.series[0];this.chartArea.border.width=this.stockChart?0:this.chartArea.border.width,t&&(this.requireInvertedAxis=t.type.indexOf("Bar")!==-1&&!this.isTransposed||t.type.indexOf("Bar")===-1&&this.isTransposed&&this.chartAreaType!=="PolarRadar"),this.chartAxisLayoutPanel=this.chartAreaType==="PolarRadar"?this.polarSeriesModule||this.radarSeriesModule:new gW(this)},e.prototype.calculateVisibleAxis=function(){var t,i=[this.primaryXAxis,this.primaryYAxis];i=this.chartAreaType==="Cartesian"?i.concat(this.axes):i,this.paretoSeriesModule&&this.series[0].type==="Pareto"&&(i=i.concat(this.paretoSeriesModule.paretoAxes)),this.axisCollections=[],this.zoomModule&&(this.zoomModule.isPanning=this.zoomModule.isAxisZoomed(i)&&this.zoomSettings.enablePan,this.svgObject.setAttribute("cursor",this.zoomModule.isPanning?"pointer":"auto"),this.scrollBarModule&&(this.scrollBarModule.axes=i)),this.scrollSettingEnabled&&this.scrollBarModule&&(this.scrollBarModule.axes=i);for(var r=0,n=i.length;r<n;r++){t=i[r],t.series=[],t.labels=[],t.indexLabels={};for(var s=0,a=this.visibleSeries;s<a.length;s++){var l=a[s];this.initAxis(l,t,!0),l.category==="Pareto"&&l.type==="Line"&&l.yAxis&&(l.yAxis.internalVisibility=l.paretoOptions.showAxis)}for(var h=0,u=this.indicators;h<u.length;h++){var c=u[h];this.initAxis(c,t,!1)}this.scrollBarModule&&!t.zoomingScrollBar&&this.scrollBarModule.injectTo(t,this),t.orientation!=null&&this.axisCollections.push(t)}this.rows.length>0&&this.columns.length>0&&this.chartAxisLayoutPanel.measure()},e.prototype.initAxis=function(t,i,r){t.xAxisName===i.name||t.xAxisName==null&&i.name==="primaryXAxis"?(i.orientation=this.requireInvertedAxis?"Vertical":"Horizontal",t.xAxis=i,r&&i.series.push(t)):(t.yAxisName===i.name||t.yAxisName==null&&i.name==="primaryYAxis")&&(i.orientation=this.requireInvertedAxis?"Horizontal":"Vertical",t.yAxis=i,r&&i.series.push(t))},e.prototype.initTechnicalIndicators=function(){for(var t=0,i=0,r=this.indicators;i<r.length;i++){var n=r[i],s=n,a=$r(s.type);if(this[a+"IndicatorModule"]){s.index=t,this[a+"IndicatorModule"].initSeriesCollection(s,this);for(var l=0,h=s.targetSeries;l<h.length;l++){var u=h[l];(n.seriesName||n.dataSource)&&this.visibleSeries.push(u)}}t++}},e.prototype.refreshTechnicalIndicator=function(t){if(this.indicators.length){var i=null;if(t instanceof Hr&&t.category!=="Indicator")for(var r=0,n=this.indicators;r<n.length;r++){var s=n[r];s.seriesName===t.name&&!s.dataSource&&(i=s,i.setDataSource(t,this))}else t instanceof AN&&(i=t,i.setDataSource(t instanceof Hr?t:null,this))}},e.prototype.calculateVisibleSeries=function(){var t;this.visibleSeries=[];for(var i=this.palettes.length?this.palettes:Qw(this.theme),r=i.length,n=this.series.sort(function(l,h){return l.zOrder-h.zOrder}),s=0,a=n.length;s<a;s++){switch(t=n[s],t.category=n[0].type==="Pareto"?"Pareto":"Series",t.index=s,t.interior=t.fill||i[s%r],!t.marker.shape&&(t.marker.visible||t.type==="Scatter"||t.drawType==="Scatter")&&(t.marker.shape=cF[this.markerIndex%10],this.markerIndex++),this.isSecondaryAxis(t.xAxis)&&(t.xAxis.internalVisibility=t.xAxis.series.some(function(l){return l.visible})),this.isSecondaryAxis(t.yAxis)&&(t.yAxis.internalVisibility=t.yAxis.series.some(function(l){return l.visible})),t.type){case"Bar":case"StackingBar":case"StackingBar100":if(n[0].type.indexOf("Bar")===-1)continue;break;case"Polar":case"Radar":if(this.chartAreaType!=="PolarRadar"||this.chartAreaType==="PolarRadar"&&(t.xAxisName!==null&&this.primaryXAxis.name!==t.xAxisName||t.yAxisName!==null&&this.primaryYAxis.name!==t.yAxisName))continue;break;case"Pareto":this.visibleSeries.push(t),this.paretoSeriesModule.initSeries(t,this);continue;default:if(this.chartAreaType==="PolarRadar"||n[0].type.indexOf("Bar")>-1)continue;break}this.visibleSeries.push(t),n[s]=t}},e.prototype.isSecondaryAxis=function(t){return this.axes.indexOf(t)>-1},e.prototype.renderTitle=function(){var t,i=this.margin,r=5;if(this.title){var n=Xh(this.titleStyle.textAlignment,this.enableRtl),s=Ze(this.title,this.titleStyle,this.themeStyle.chartTitleFont);t=new Ae(i.left,0,this.availableSize.width-i.left-i.right,0);var a=this.titleStyle.border.width,l=this.margin.top+s.height*3/4,h=Qh(t,this.titleStyle||this.themeStyle.chartTitleFont)+a,u=void 0,c=this.titleStyle.textAlignment,d=Ze(this.subTitle,this.subTitleStyle,this.themeStyle.chartSubTitleFont);switch(this.titleStyle.position){case"Top":l+=a*.5,h+=n==="start"?a*.5+this.border.width:n==="end"?-a*2-this.border.width:0;break;case"Bottom":h+=n==="start"?a*.5+this.border.width:n==="end"?-a*2-this.border.width:0,l=this.availableSize.height-this.margin.bottom-d.height-s.height/2-a*.5-this.subTitleStyle.border.width*.5;break;case"Left":h=this.margin.left+s.height*3/4+a*.5,l=c==="Near"?i.bottom+a*.5+this.border.width:c==="Far"?this.availableSize.height-i.bottom-a*.5-this.border.width:this.availableSize.height/2,n=c==="Near"?"end":c==="Far"?"start":"middle",n=this.enableRtl?n==="end"?"start":n==="start"?"end":n:n,u="rotate(-90,"+h+","+l+")";break;case"Right":h=this.availableSize.width-this.margin.right-s.height*3/4-a*.5,l=c==="Near"?i.bottom+a*.5+this.border.width:c==="Far"?this.availableSize.height-i.bottom-a*.5-this.border.width:this.availableSize.height/2,n=c==="Near"?"start":c==="Far"?"end":"middle",n=this.enableRtl?n==="end"?"start":n==="start"?"end":n:n,u="rotate(90,"+h+","+l+")";break;case"Custom":h=this.titleStyle.x,l=this.titleStyle.y,n="middle";break}var p={id:this.element.id+"_ChartTitleBorder",x:h-(n==="middle"?s.width/2+r:n==="end"?s.width+r:r),y:l-s.height+s.height/4,rx:this.titleStyle.border.cornerRadius,ry:this.titleStyle.border.cornerRadius,width:s.width+r*2,height:s.height*this.titleCollection.length,fill:this.titleStyle.background,"stroke-width":a,stroke:this.titleStyle.border.color,transform:u||"",d:""},f=Va(this.redraw,this.element.id+"_ChartTitleBorder",p,this.renderer)||this.renderer.drawRectangle(p);vt(this.enableCanvas,this.svgObject,f,this.redraw);var v=new gn(this.element.id+"_ChartTitle",h,l,n,this.titleCollection,u,"auto"),m=Va(this.redraw,this.element.id+"_ChartTitle",v,this.renderer)||hn(this.renderer,v,this.titleStyle,this.titleStyle.color||this.themeStyle.chartTitleFont.color,this.svgObject,null,null,null,null,null,null,null,null,this.enableCanvas,null,this.themeStyle.chartTitleFont);m&&!this.enableCanvas&&(m.setAttribute("tabindex",this.titleStyle.accessibility.focusable?String(this.titleStyle.accessibility.tabIndex):"-1"),m.style.outline="none",m.setAttribute("class","e-chart-focused"),m.setAttribute("role",this.titleStyle.accessibility.accessibilityRole),m.setAttribute("aria-label",this.titleStyle.accessibility.accessibilityDescription)),this.subTitle&&this.renderSubTitle(v)}},e.prototype.renderSubTitle=function(t){for(var i=0,r=0,n=0,s=0,a=10,l=this.titleStyle.textAlignment,h=0,u=this.titleCollection;h<u.length;h++){var c=u[h];n=Ze(c,this.titleStyle,this.themeStyle.chartTitleFont).width,i=n>i?n:i}for(var d=0,p=this.subTitleCollection;d<p.length;d++){var f=p[d];s=Ze(f,this.subTitleStyle,this.themeStyle.chartSubTitleFont).width,r=s>r?s:r}i=Math.max(n,r);var v=Ze(this.subTitleCollection.reduce(function(D,A){return D.length>A.length?D:A}),this.subTitleStyle,this.themeStyle.chartSubTitleFont),m=Xh(this.subTitleStyle.textAlignment,this.enableRtl),y=new Ae(l==="Center"?t.x-i*.5:l==="Far"?t.x-i:t.x,0,i,0);this.titleStyle.position==="Left"&&(y.x=l==="Center"?t.x-i*.5:l==="Far"?this.margin.left+v.height*3/4:t.x-i);var S=Ze(this.title,this.titleStyle,this.themeStyle.chartTitleFont),b=t.y*t.text.length+v.height+a/2+this.titleStyle.border.width+this.subTitleStyle.border.width*.5;this.titleStyle.position==="Bottom"&&(b=t.y*t.text.length+a/2+S.height/2+v.height/2);var w={id:this.element.id+"_ChartSubTitleBorder",x:Qh(y,this.subTitleStyle)-(m==="middle"?v.width/2+a/2:m==="end"?v.width+a/2:a/2),y:b-v.height+v.height/4,rx:this.subTitleStyle.border.cornerRadius,ry:this.subTitleStyle.border.cornerRadius,width:v.width+a,height:v.height*this.subTitleCollection.length,fill:this.subTitleStyle.background,"stroke-width":this.subTitleStyle.border.width,stroke:this.subTitleStyle.border.color,transform:t.transform,d:""},I=Va(this.redraw,this.element.id+"_ChartSubTitleBorder",w,this.renderer)||this.renderer.drawRectangle(w);vt(this.enableCanvas,this.svgObject,I,this.redraw);var x=new gn(this.element.id+"_ChartSubTitle",Qh(y,this.subTitleStyle),b,Xh(this.subTitleStyle.textAlignment,this.enableRtl),this.subTitleCollection,t.transform,"auto"),M=Va(this.redraw,this.element.id+"_ChartSubTitle",x,this.renderer)||hn(this.renderer,x,this.subTitleStyle,this.subTitleStyle.color||this.themeStyle.chartSubTitleFont.color,this.svgObject,null,null,null,null,null,null,null,null,this.enableCanvas,null,this.themeStyle.chartSubTitleFont);M&&!this.enableCanvas&&(M.setAttribute("tabindex",this.subTitleStyle.accessibility.focusable?String(this.subTitleStyle.accessibility.tabIndex):"-1"),this.subTitleStyle.accessibility.focusable&&(M.style.outline="none"),M.setAttribute("class","e-chart-focused"),M.setAttribute("role",this.subTitleStyle.accessibility.accessibilityRole),M.setAttribute("aria-label",this.subTitleStyle.accessibility.accessibilityDescription))},e.prototype.renderBorder=function(){var t=0,i=0,r=this.border.width,n=this.backgroundImage,s=n?"transparent":this.background||this.themeStyle.background;this.stockChart&&this.stockChart.legendSettings.visible&&this.stockChart.stockLegendModule&&(this.stockChart.legendSettings.position==="Top"?i+=this.stockChart.stockLegendModule.legendBounds.height:this.stockChart.legendSettings.position==="Left"&&(t+=this.stockChart.stockLegendModule.legendBounds.width));var a=new as(this.element.id+"_ChartBorder",s,this.border,1,new Ae(r*.5+t,r*.5+i,this.availableSize.width-r,this.availableSize.height-r),0,0,"",this.border.dashArray);if(this.htmlObject=Va(this.redraw,this.element.id+"_ChartBorder",a,this.renderer)||this.renderer.drawRectangle(a),this.htmlObject.setAttribute("aria-hidden","true"),vt(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw),n){var l=new Yw(this.availableSize.height-r,this.availableSize.width-r,n,0,0,this.element.id+"_ChartBackground","visible","none");this.htmlObject=Va(this.redraw,this.element.id+"_ChartBackground",l,this.renderer)||this.renderer.drawImage(l),vt(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw)}},e.prototype.renderAreaBorder=function(){if(this.chartAreaType==="PolarRadar")return null;var t=ce(this.element.id+"_ChartAreaBorder"),i=t?new Ae(+t.getAttribute("x"),+t.getAttribute("y"),+t.getAttribute("width"),+t.getAttribute("height")):null,r=new as(this.element.id+"_ChartAreaBorder",this.chartArea.background,{width:this.chartArea.border.width,color:this.chartArea.border.color||this.themeStyle.areaBorder},this.chartArea.opacity,this.chartAxisLayoutPanel.seriesClipRect,0,0,"",this.chartArea.border.dashArray);if(r.height<0||r.width<0)return null;this.htmlObject=this.renderer.drawRectangle(r),this.htmlObject.setAttribute("aria-hidden","true"),vt(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw,!0,"x","y",null,null,!0,!0,i),this.htmlObject=null;var n=this.chartArea.backgroundImage;if(n){var s=this.chartArea.border.width,a=new Yw(this.initialClipRect.height-s,this.initialClipRect.width-s,n,this.initialClipRect.x,this.initialClipRect.y,this.element.id+"_ChartAreaBackground","visible","none");this.htmlObject=this.renderer.drawImage(a),vt(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw,!0,"x","y",null,null,!0,!0)}},e.prototype.addSeries=function(t){for(var i=window.scrollY||document.documentElement.scrollTop,r=0,n=t;r<n.length;r++){var s=n[r];s=new Hr(this,"series",s),this.series.push(s)}this.refresh(),window.scrollTo(0,i)},e.prototype.removeSeries=function(t){this.redraw=!1;var i=window.scrollY||document.documentElement.scrollTop,r=this.visibleSeries[t];r&&(r.xAxis.series.length<=1&&(r.xAxis.orientation=null),r.yAxis.series.length<=1&&(r.yAxis.orientation=null));for(var n=0;n<this.axes.length;n++)this.axes[n].orientation===null&&this.axes.splice(n,1);this.series.splice(t,1),this.refresh(),window.scrollTo(0,i)},e.prototype.clearSeries=function(){this.series=[];var t=window.scrollY||document.documentElement.scrollTop;this.refresh(),window.scrollTo(0,t)},e.prototype.addAxes=function(t){for(var i=0,r=t;i<r.length;i++){var n=r[i];n=new Fm(this,"axes",n),this.isBlazor&&(n.interval=isNaN(n.interval)?null:n.interval,n.desiredIntervals=isNaN(n.desiredIntervals)?null:n.desiredIntervals),this.axes.push(n)}this.refresh()},e.prototype.removeAxis=function(t){this.redraw=!1,this.axes.splice(t,1),this.refresh()},e.prototype.destroy=function(){this.scrollBarModule&&this.scrollBarModule.destroy(),this.markerRender&&(this.markerRender.removeEventListener(),this.markerRender=null),this.horizontalAxes=[],this.verticalAxes=[],this.visibleSeries=[],this.axisCollections=[],this.rotatedDataLabelCollections=[],this.seriesElements=null,this.chartAxisLayoutPanel=null,this.dataLabelCollections=null,this.dataLabelElements=null,this.yAxisElements=null;var t=document.getElementById(this.element.id+"Keyboard_chart_focus");t&&t.remove();var i=document.getElementById(this.element.id+"_ej2_chart_highlight");i&&i.remove();var r=document.getElementById(this.element.id+"_ej2_chart_selection");r&&r.remove(),ni("chartmeasuretext"),this.element&&(this.unWireEvents(),this.isReact&&this.clearTemplate(),o.prototype.destroy.call(this),this.enableCanvas||(this.removeSvg(),this.svgObject=null))},e.prototype.getModuleName=function(){return"chart"},e.prototype.getPersistData=function(){var t=["loaded","animationComplete","primaryXAxis","primaryYAxis"];return this.addOnPersist(t)},e.prototype.createChartSvg=function(){this.removeSvg(),oF(this)},e.prototype.unWireEvents=function(){var t=B.touchStartEvent,i=B.touchMoveEvent,r=B.touchEndEvent,n=B.isPointer?"pointerleave":"mouseleave";E.remove(this.element,t,this.chartOnMouseDown),E.remove(this.element,i,this.mouseMove),E.remove(this.element,r,this.mouseEnd),E.remove(this.element,"click",this.chartOnMouseClick),E.remove(this.element,"dblclick",this.chartOnDoubleClick),E.remove(this.element,"contextmenu",this.chartRightClick),E.remove(this.element,n,this.mouseLeave),E.remove(this.element,"keydown",this.chartKeyDown),E.remove(document.body,"keydown",this.documentKeyHandler),E.remove(this.element,"keyup",this.chartKeyUp),window.removeEventListener(B.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.resizeBound),this.touchObject&&(this.touchObject.destroy(),this.touchObject=null)},e.prototype.wireEvents=function(){if(this.element){var t=B.isPointer?"pointerleave":"mouseleave";E.add(this.element,B.touchStartEvent,this.chartOnMouseDown,this),E.add(this.element,B.touchMoveEvent,this.mouseMove,this),E.add(this.element,B.touchEndEvent,this.mouseEnd,this),E.add(this.element,"click",this.chartOnMouseClick,this),E.add(this.element,"dblclick",this.chartOnDoubleClick,this),E.add(this.element,"contextmenu",this.chartRightClick,this),E.add(this.element,t,this.mouseLeave,this),E.add(this.element,"keydown",this.chartKeyDown,this),E.add(document.body,"keydown",this.documentKeyHandler,this),E.add(this.element,"keyup",this.chartKeyUp,this),this.resizeBound=this.chartResize.bind(this),window.addEventListener(B.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.resizeBound),this.longPressBound=this.longPress.bind(this),this.touchObject=new Fr(this.element,{tapHold:this.longPressBound,tapHoldThreshold:500}),this.setStyle(this.element)}},e.prototype.chartRightClick=function(t){return this.crosshair.enable&&this.crosshairModule&&(t.buttons===2||t.which===0||t.pointerType==="touch")?(t.preventDefault(),t.stopPropagation(),!1):!0},e.prototype.setStyle=function(t){var i=this.zoomSettings,r=i.enableSelectionZooming||i.enablePinchZooming||this.selectionMode!=="None"||this.highlightMode!=="None";t.style.touchAction=r?"none":"element",t.style.msTouchAction=r?"none":"element",t.style.msContentZooming="none",t.style.msUserSelect="none",t.style.webkitUserSelect="none",t.style.position="relative",t.style.display="block",t.style.overflow="hidden",t.style.height=t.style.height||this.height&&this.height.indexOf("%")===-1?t.style.height:"inherit"},e.prototype.isOrientation=function(){return"orientation"in window&&"onorientationchange"in window},e.prototype.longPress=function(t){return this.mouseX=t&&t.originalEvent.changedTouches?t.originalEvent.changedTouches[0].clientX:0,this.mouseY=t&&t.originalEvent.changedTouches?t.originalEvent.changedTouches[0].clientY:0,this.startMove=!0,this.allowPan=this.stockChart?!1:this.allowPan,this.setMouseXY(this.mouseX,this.mouseY),this.notify("tapHold",t),!1},e.prototype.setMouseXY=function(t,i){if(ce(this.svgId)){var r=ce(this.svgId).getBoundingClientRect(),n=this.element.getBoundingClientRect();this.scaleX=r.width/this.availableSize.width,this.scaleY=r.height/this.availableSize.height,this.mouseY=(i-n.top-Math.max(r.top-n.top,0))/this.scaleY,this.mouseX=(t-n.left-Math.max(r.left-n.left,0))/this.scaleX,this.stockChart&&(this.mouseX+=this.stockChart.legendSettings.position==="Left"?this.stockChart.stockLegendModule.legendBounds.width:0,this.mouseY+=this.stockChart.legendSettings.position==="Top"?this.stockChart.stockLegendModule.legendBounds.height:0)}},e.prototype.export=function(t,i){this.exportModule&&(this.exportModule.export(t,i),this.afterExport&&this.exportModule.getDataUrl(this))},e.prototype.chartResize=function(){var t=this;this.animateSeries=!1;var i={chart:this,name:_m,currentSize:new _t(0,0),previousSize:new _t(this.availableSize.width,this.availableSize.height)},r={name:"beforeResize",cancelResizedEvent:!1};return this.resizeTo&&clearTimeout(this.resizeTo),this.trigger(qN,r),r.cancelResizedEvent||(this.resizeTo=+setTimeout(function(){if(t.isDestroyed||t.stockChart){clearTimeout(t.resizeTo);return}t.createChartSvg(),i.currentSize=t.availableSize,t.trigger(_m,i),t.refreshAxis(),t.refreshBound(),t.trigger("loaded",{chart:t.isBlazor?{}:t})},500)),!1},e.prototype.mouseMove=function(t){var i,r,n;return this.allowPan||(t.type==="touchmove"?(this.isTouch=!0,n=t,i=n.changedTouches[0].clientX,r=n.changedTouches[0].clientY):(this.isTouch=t.pointerType==="touch"||t.pointerType==="2"||this.isTouch,i=t.clientX,r=t.clientY),this.previousPageX=i,this.previousPageY=r,ce(this.svgId)&&(this.setMouseXY(i,r),this.chartOnMouseMove(t))),!1},e.prototype.mouseLeave=function(t){var i,r,n;return this.stockChart&&this.stockChart.onPanning||(t.type==="touchleave"?(this.isTouch=!0,n=t,i=n.changedTouches[0].clientX,r=n.changedTouches[0].clientY):(this.isTouch=t.pointerType==="touch"||t.pointerType==="2",i=t.clientX,r=t.clientY),this.previousPageX=null,this.previousPageY=null,this.setMouseXY(i,r),this.chartOnMouseLeave(t)),!1},e.prototype.chartOnMouseLeave=function(t){var i=t.target,r=B.isPointer?"pointerleave":"mouseleave";return this.trigger(_N,{target:i.id,x:this.mouseX,y:this.mouseY}),ni(this.element.id+"_EJ2_AxisLabel_Tooltip"),this.isChartDrag=this.isPointMouseDown=!1,this.notify(r,t),!1},e.prototype.chartOnDoubleClick=function(t){var i=t.target;return this.trigger(jN,{target:i.id,x:this.mouseX,y:this.mouseY}),!1},e.prototype.chartKeyDown=function(t){var i="";return(this.isZoomed&&t.code==="Tab"||t.code==="Space")&&t.preventDefault(),this.tooltip.enable&&(t.code==="Tab"&&this.previousTargetId.indexOf("Series")>-1||t.code==="Escape")&&(i="ESC"),this.highlightMode!=="None"&&t.code==="Tab"&&this.previousTargetId.indexOf("_chart_legend_")>-1&&this.highlightModule&&this.highlightModule.removeLegendHighlightStyles(),t.ctrlKey&&(t.key==="+"||t.code==="Equal"||t.key==="-"||t.code==="Minus")?(t.preventDefault(),this.isZoomed=this.zoomModule&&(this.zoomSettings.enableDeferredZooming||this.zoomSettings.enableSelectionZooming||this.zoomSettings.enablePinchZooming||this.zoomSettings.enableMouseWheelZooming),i=this.isZoomed?t.code:""):t.keyCode===82&&this.isZoomed?(t.preventDefault(),this.isZoomed=!1,i="R"):t.code.indexOf("Arrow")>-1&&(t.preventDefault(),i=this.isZoomed?t.code:""),t.ctrlKey&&t.key==="p"&&(t.preventDefault(),i="CtrlP"),i!==""&&this.chartKeyboardNavigations(t,t.target.id,i),t.code==="Tab"&&this.removeNavigationStyle(),!1},e.prototype.chartKeyUp=function(t){var i="",r=t.target.id,n,s,a=t.target,l=ce(this.element.id+"_ChartTitle"),h=ce(this.element.id+"SeriesCollection"),u=ce(this.element.id+"_chart_legend_translate_g"),c=ce(this.element.id+"_chart_legend_pageup");if(l&&l.setAttribute("class","e-chart-focused"),h&&h.firstElementChild&&h.firstElementChild.children[1]){var d=h.firstElementChild.children[1],p=d.getAttribute("class");p&&p.indexOf("e-chart-focused")===-1?p=p+" e-chart-focused":p||(p="e-chart-focused"),d.setAttribute("class",p)}if(u){var d=u.firstElementChild,p=d.getAttribute("class");p&&p.indexOf("e-chart-focused")===-1?p=p+" e-chart-focused":p||(p="e-chart-focused"),d.setAttribute("class",p)}if(c&&c.setAttribute("class","e-chart-focused"),t.code==="Tab"){if(this.previousTargetId!=="")if(this.previousTargetId.indexOf("_Series_")>-1&&r.indexOf("_Series_")===-1){n=ce(this.element.id+"SeriesCollection");var f=void 0;(this.previousTargetId.indexOf("_Symbol")>-1?ce(this.element.id+"SymbolGroup"+this.currentSeriesIndex):n.children[this.currentSeriesIndex])&&(f=this.previousTargetId.indexOf("_Symbol")>-1?ce(this.element.id+"SymbolGroup"+this.currentSeriesIndex).children[this.currentPointIndex+1]:this.previousTargetId.indexOf("_Point_")>-1?n.children[this.currentSeriesIndex].children[this.currentPointIndex+1]:n.children[this.currentSeriesIndex]),this.currentPointIndex=0,this.currentSeriesIndex=0}else this.previousTargetId.indexOf("_chart_legend_page")>-1&&r.indexOf("_chart_legend_page")===-1&&r.indexOf("_chart_legend_g_")===-1?this.setTabIndex(t.target,ce(this.element.id+"_chart_legend_pageup")):this.previousTargetId.indexOf("_chart_legend_g_")>-1&&r.indexOf("_chart_legend_g_")===-1&&(n=ce(this.element.id+"_chart_legend_translate_g"),this.setTabIndex(n.children[this.currentLegendIndex],n.firstElementChild));this.previousTargetId=r,r.indexOf("SeriesGroup")>-1?(this.currentSeriesIndex=+r.split("SeriesGroup")[1],a.removeAttribute("tabindex"),a.blur(),a.children[1].id.indexOf("_Point_")===-1&&(s=ce(this.element.id+"SymbolGroup"+r.split("SeriesGroup")[1])),r=this.focusChild(s!=null?s.children[1]:a.children[1])):r.indexOf("_ChartTitle")>-1&&this.setNavigationStyle(r),i=r!==this.element.id?"Tab":""}else if(t.code.indexOf("Arrow")>-1){if(t.preventDefault(),this.previousTargetId=r,r.indexOf("_chart_legend_page")>-1)t.code==="ArrowLeft"?(ce(this.element.id+"_chart_legend_pagedown").removeAttribute("tabindex"),this.focusChild(ce(this.element.id+"_chart_legend_pageup"))):t.code==="ArrowRight"&&(ce(this.element.id+"_chart_legend_pageup").removeAttribute("tabindex"),this.focusChild(ce(this.element.id+"_chart_legend_pagedown")));else if(r.indexOf("_chart_legend_")>-1){var v=a.parentElement.children;v[this.currentLegendIndex].removeAttribute("tabindex"),this.currentLegendIndex+=t.code==="ArrowUp"||t.code==="ArrowRight"?1:-1,this.currentLegendIndex=this.getActualIndex(this.currentLegendIndex,v.length);var m=v[this.currentLegendIndex];this.focusChild(m),this.removeNavigationStyle(),this.setNavigationStyle(m.id),r=m.children[1].id,i=this.highlightMode!=="None"?"ArrowMove":""}else if(r.indexOf("_Series_")>-1){n=a.parentElement.parentElement;var y=t.target;if(a.removeAttribute("tabindex"),a.blur(),t.code==="ArrowRight"||t.code==="ArrowLeft"){for(var S=[],b=0;b<n.children.length;b++)n.children[b].id.indexOf("SeriesGroup")>-1&&S.push(+n.children[b].id.split("SeriesGroup")[1]);this.currentSeriesIndex=S.indexOf(this.currentSeriesIndex)+(t.code==="ArrowRight"?1:-1),this.currentSeriesIndex=S[this.getActualIndex(this.currentSeriesIndex,S.length)]}else this.currentPointIndex+=t.code==="ArrowUp"?1:-1;r.indexOf("_Symbol")>-1?(this.currentPointIndex=this.getActualIndex(this.currentPointIndex,ce(this.element.id+"SymbolGroup"+this.currentSeriesIndex).childElementCount-1),y=ce(this.element.id+"_Series_"+this.currentSeriesIndex+"_Point_"+this.currentPointIndex+"_Symbol")):r.indexOf("_Point_")>-1&&(this.currentPointIndex=this.getActualIndex(this.currentPointIndex,ce(this.element.id+"SeriesGroup"+this.currentSeriesIndex).childElementCount-1),y=ce(this.element.id+"_Series_"+this.currentSeriesIndex+"_Point_"+this.currentPointIndex)),r=this.focusChild(y),i="ArrowMove"}}else(t.code==="Enter"||t.code==="Space")&&(r.indexOf("_chart_legend_")>-1||r.indexOf("_Point_")>-1)&&(r=r.indexOf("_chart_legend_page")>-1?r:r.indexOf("_chart_legend_")>-1?a.children[1].id:r,i="Enter");return i!==""&&this.chartKeyboardNavigations(t,r,i),!1},e.prototype.setTabIndex=function(t,i){t&&t.removeAttribute("tabindex"),i&&i.setAttribute("tabindex","0")},e.prototype.getActualIndex=function(t,i){return t>i-1?0:t<0?i-1:t},e.prototype.focusChild=function(t){t.setAttribute("tabindex","0");var i=t.getAttribute("class");return t.setAttribute("tabindex","0"),i&&i.indexOf("e-chart-focused")===-1?i="e-chart-focused "+i:i||(i="e-chart-focused"),t.setAttribute("class",i),t.focus(),t.id},e.prototype.documentKeyHandler=function(t){t.altKey&&t.keyCode===74&&!g(this.element)&&(this.element.focus(),this.setNavigationStyle(this.element.id))},e.prototype.setNavigationStyle=function(t){var i=document.getElementById(t);i&&(i.style.setProperty("outline",this.focusBorderWidth+"px solid "+(this.focusBorderColor||this.themeStyle.tabColor)),i.style.setProperty("margin",this.focusBorderMargin+"px"))},e.prototype.removeNavigationStyle=function(){var t=document.querySelectorAll("[id*=_Point_], [id*="+this.element.id+"], [id*=_ChartBorder], text[id*=_ChartTitle],g[id*=_chart_legend],  text[id*=_ChartSubTitle], div[id*=_Annotation], g[id*=IndicatorGroup], g[id*=_Zooming_Zoom], g[id*=_Zooming_ZoomIn], g[id*=_Zooming_ZoomOut], g[id*=_Zooming_Pan], g[id*=_Zooming_Reset], path[id*=_TrendLine_]");t&&t.forEach(function(i){(i instanceof HTMLElement||i instanceof SVGElement)&&(i.style.setProperty("outline","none"),i.style.setProperty("margin",""))})},e.prototype.chartKeyboardNavigations=function(t,i,r){switch(this.isLegendClicked=!1,this.removeNavigationStyle(),r!=="Enter"&&r!=="Space"&&this.setNavigationStyle(i),r){case"Tab":case"ArrowMove":if(this.highlightModule&&this.highlightModule.removeLegendHighlightStyles(),i.indexOf("_Point_")>-1){var n=+i.split("_Series_")[1].split("_Point_")[0],s=+i.split("_Series_")[1].replace("_Symbol","").split("_Point_")[1],a=this.visibleSeries[n].points[s].symbolLocations[0];this.mouseX=a.x+this.initialClipRect.x-(this.visibleSeries[n].type.indexOf("StackingBar")>-1?this.visibleSeries[n].marker.height/2:0),this.mouseY=a.y+this.initialClipRect.y+(this.visibleSeries[n].type.indexOf("StackingColumn")>-1?this.visibleSeries[n].marker.height/2:0),this.highlightModule&&(this.highlightModule.highlightChart(document.getElementById(i),"mousemove"),this.highlightModule.completeSelection(document.getElementById(i),"mousemove")),this.tooltipModule&&this.tooltipModule.tooltip()}if(this.highlightModule&&this.highlightMode!=="None"){i=i.indexOf("_chart_legend_g_")>-1?document.getElementById(i).firstChild.id:i;for(var l=this.element.id+"_chart_legend",h=[l+"_text_",l+"_shape_marker_",l+"_shape_"],u=0;u<h.length;u++){var c=h[u];if(i.indexOf(c)>-1){document.getElementById(i).setAttribute("class",""),this.highlightModule.legendSelection(this,parseInt(i.split(c)[1],10),document.getElementById(i),"mousemove");break}}}break;case"Enter":case"Space":i.indexOf("_chart_legend_")>-1?(this.isLegendClicked=!0,this.legendModule.click(t),this.focusChild(document.getElementById(i).parentElement),this.setNavigationStyle(document.getElementById(i).parentElement.id)):(this.selectionModule&&this.selectionModule.calculateSelectedElements(document.getElementById(i),"click"),this.setNavigationStyle(i));break;case"CtrlP":this.print();break;case"ESC":this.tooltipModule.removeTooltip(1);break;case"Equal":case"Minus":this.zoomModule.isZoomed=this.zoomModule.performedUI=!0,this.zoomModule.isPanning=this.isChartDrag=!1,r==="Equal"?this.zoomModule.toolkit.zoomInOutCalculation(1,this,this.axisCollections,this.zoomSettings.mode):this.zoomModule.toolkit.zoomInOutCalculation(-1,this,this.axisCollections,this.zoomSettings.mode),this.zoomModule.performZoomRedraw(this),this.element.focus();break;case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":{var d=r==="ArrowUp"?10:r==="ArrowDown"?-10:0,p=r==="ArrowLeft"?-10:r==="ArrowRight"?10:0;this.zoomModule.isPanning=this.isChartDrag=!0,this.zoomModule.doPan(this,this.axisCollections,p,d),this.zoomModule.performZoomRedraw(this),this.element.focus();break}case"R":this.zoomModule.toolkit.reset(t);break}},e.prototype.chartOnMouseClick=function(t){var i=this,r=t.target,n=this;this.clickCount++;var s=this.FindXYPointValue(n.mouseX,n.mouseY),a=400;this.clickCount===1?this.singleClickTimer=+setTimeout(function(){n.clickCount=0,n.trigger(zN,{target:r.id,x:n.mouseX,y:n.mouseY,axisData:s})},a):this.clickCount===2&&!this.pointDoubleClick&&(clearTimeout(this.singleClickTimer),this.clickCount=0);var l="isAngular";if(this[l]){var h="observers";a=this.pointDoubleClick[h].length>0?400:0}else a=this.pointDoubleClick?400:0;return this.clickCount===1&&this.pointClick?this.singleClickTimer=+setTimeout(function(){i.clickCount=0,i.triggerPointEvent(HN,t)},a):this.clickCount===2&&this.pointDoubleClick&&(clearTimeout(this.singleClickTimer),this.clickCount=0,this.triggerPointEvent(EU,t)),this.axisLabelClick&&this.triggerAxisLabelClickEvent(DU,t),this.removeNavigationStyle(),this.notify("click",t),!1},e.prototype.FindXYPointValue=function(t,i){if(Oi(t,i,this.chartAxisLayoutPanel.seriesClipRect)&&this.series.some(function(u){return u.visible})){for(var r=void 0,n=void 0,s=void 0,a={},l=0,h=this.axisCollections.length;l<h;l++)r=this.axisCollections[l],r.orientation==="Horizontal"?(n=KN(Math.abs(t-r.rect.x),r.rect.width,r),a[this.axisCollections[l].name]=n):(s=ZN(Math.abs(i-r.rect.y),r.rect.height,r),a[this.axisCollections[l].name]=s);return a}return null},e.prototype.triggerPointEvent=function(t,i){var r=i,n=new Jw(this),s=n.getData();s.series&&s.point&&this.trigger(t,{series:this.isBlazor?{}:s.series,point:s.point,seriesIndex:s.series.index,pointIndex:s.point.index,x:this.mouseX,y:this.mouseY,pageX:r.pageX,pageY:r.pageY})},e.prototype.triggerAxisLabelClickEvent=function(t,i){var r=i.target,n=i;if(r.id.indexOf("_AxisLabel_")!==-1){var s=r.id.split("_AxisLabel_"),a=+s[0].slice(-1),l=+s[1],h=this.axisCollections[a];h.visible&&(a===0||a===1)&&this.trigger(t,{chart:this,axis:h,text:h.visibleLabels[l].text,labelID:r.id,index:l,location:new Je(n.pageX,n.pageY),value:h.visibleLabels[l].value})}},e.prototype.chartOnMouseMove=function(t){var i=t.target,r=this.FindXYPointValue(this.mouseX,this.mouseY);return this.trigger(BN,{target:i.id,x:this.mouseX,y:this.mouseY,axisData:r}),this.pointMove&&this.triggerPointEvent(VN,t),this.isTouch||(this.titleTooltip(t,this.mouseX,this.mouseY),this.axisTooltip(t,this.mouseX,this.mouseY)),this.dataEditingModule&&this.dataEditingModule.pointMouseMove(t),this.crosshair.enable&&this.startMove&&t.preventDefault(),this.notify(B.touchMoveEvent,t),this.isTouch=!1,!1},e.prototype.titleTooltip=function(t,i,r,n){var s=t.target.id,a=s===this.element.id+"_ChartTitle"||s===this.element.id+"_ChartSubTitle"||s.indexOf("_AxisTitle")>-1||s.indexOf("_legend_title")>-1,l=0;if(s.indexOf("_AxisTitle")>-1&&(l=parseInt(s.replace(this.element.id,"").replace("AxisLabel_","").split("_")[2],10)),a&&t.target.textContent.indexOf("...")>-1){var h=s===this.element.id+"_ChartTitle"?this.title:s.indexOf("_AxisTitle")>-1?this.axisCollections[l].title:s.indexOf("_ChartSubTitle")>-1?this.subTitle:this.legendSettings.title;Pc(h,i,r,this.element.offsetWidth,this.element.id+"_EJ2_Title_Tooltip",ce(this.element.id+"_Secondary_Element"),n)}else ni(this.element.id+"_EJ2_Title_Tooltip")},e.prototype.axisTooltip=function(t,i,r,n){var s=t.target.id;if((s.indexOf("AxisLabel")>-1||s.indexOf("Axis_MultiLevelLabel")>-1)&&t.target.textContent.indexOf("...")>-1){var a=this.legendSettings.visible||this.primaryXAxis.title==="";Pc(this.findAxisLabel(s),i,r,this.element.offsetWidth,this.element.id+"_EJ2_AxisLabel_Tooltip",ce(this.element.id+"_Secondary_Element"),n,a)}else ni(this.element.id+"_EJ2_AxisLabel_Tooltip")},e.prototype.findAxisLabel=function(t){var i;return t.indexOf("AxisLabel")>-1?(i=t.replace(this.element.id,"").replace("AxisLabel_","").split("_"),this.axisCollections[parseInt(i[0],10)].visibleLabels[parseInt(i[1],10)].originalText):(i=t.replace(this.element.id,"").replace("Axis_MultiLevelLabel_Level_","").replace("Text_","").split("_"),this.axisCollections[parseInt(i[0],10)].multiLevelLabels[parseInt(i[1],10)].categories[parseInt(i[2],10)].text)},e.prototype.chartOnMouseDown=function(t){var i,r,n,s,a=this.FindXYPointValue(this.mouseX,this.mouseY),l=B.isDevice?20:30,h=this.element.getBoundingClientRect(),u=t.target;this.stockChart&&this.stockChart.zoomSettings.enablePan&&(this.allowPan=!0),this.trigger(UN,{target:u.id,x:this.mouseX,y:this.mouseY,axisData:a}),t.type==="touchstart"?(this.isTouch=!0,s=t,i=s.changedTouches[0].clientX,r=s.changedTouches[0].clientY,n=s.target):(this.isTouch=t.pointerType==="touch",i=t.clientX,r=t.clientY,n=t.target);var c=ce(this.svgId).getBoundingClientRect();return this.mouseDownX=this.previousMouseMoveX=i-h.left-Math.max(c.left-h.left,0),this.mouseDownY=this.previousMouseMoveY=r-h.top-Math.max(c.top-h.top,0),this.isTouch&&(this.isDoubleTap=new Date().getTime()<this.threshold&&n.id.indexOf(this.element.id+"_Zooming_")===-1&&(this.mouseDownX-l>=this.mouseX||this.mouseDownX+l>=this.mouseX)&&(this.mouseDownY-l>=this.mouseY||this.mouseDownY+l>=this.mouseY)&&(this.mouseX-l>=this.mouseDownX||this.mouseX+l>=this.mouseDownX)&&(this.mouseY-l>=this.mouseDownY||this.mouseY+l>=this.mouseDownY)),this.dataEditingModule&&this.dataEditingModule.pointMouseDown(),this.notify(B.touchStartEvent,t),!1},e.prototype.mouseEnd=function(t){var i,r,n;return t.type==="touchend"?(n=t,r=n.changedTouches[0].clientX,this.isTouch=!0,i=n.changedTouches[0].clientY):(i=t.clientY,r=t.clientX,this.isTouch=t.pointerType==="touch"||t.pointerType==="2"),this.setMouseXY(r,i),this.chartOnMouseUp(t),!1},e.prototype.chartOnMouseUp=function(t){var i=t.target,r=this.FindXYPointValue(this.mouseX,this.mouseY);return this.trigger(WN,{target:i.id,x:this.mouseX,y:this.mouseY,axisData:r}),this.isChartDrag=!1,this.allowPan=!1,this.isTouch&&(this.titleTooltip(t,this.mouseX,this.mouseY,this.isTouch),this.axisTooltip(t,this.mouseX,this.mouseY,this.isTouch),this.threshold=new Date().getTime()+300),this.dataEditingModule&&this.dataEditingModule.pointMouseUp(),!this.enableCanvas&&this.seriesElements&&this.seriesElements.removeAttribute("clip-path"),this.notify(B.touchEndEvent,t),!1},e.prototype.setCulture=function(){this.intl=new Et,this.setLocaleConstants(),this.localeObject=new Li(this.getModuleName(),this.defaultLocalConstants,this.locale)},e.prototype.setAnnotationValue=function(t,i){var r=ce(this.element.id+"_Annotation_Collections"),n=this.annotations[t],s;i!==null&&(n.content=i,r?(ni(this.element.id+"_Annotation_"+t),s=this.createElement("div"),this.annotationModule.processAnnotation(n,t,s),r.appendChild(s.children[0])):this.annotationModule.renderAnnotations(ce(this.element.id+"_Secondary_Element")))},e.prototype.setLocaleConstants=function(){this.defaultLocalConstants={ZoomIn:"Zoom in",Zoom:"Zoom",ZoomOut:"Zoom out",Pan:"Pan",Reset:"Reset",ResetZoom:"Reset Zoom"}},e.prototype.setTheme=function(){this.themeStyle=lF(this.theme,this.enableCanvas,this)},e.prototype.requiredModules=function(){var t=this,i=[],r=this.series,n=!1,s,a=!1,l=!1,h=!1,u=this.zoomSettings;return this.chartAreaType=r.length>0&&(r[0].type==="Polar"||r[0].type==="Radar")?"PolarRadar":"Cartesian",this.tooltip.enable&&i.push({member:"Tooltip",args:[this]}),r.map(function(c){t.isLegend=t.legendSettings.visible&&(c.name!==""||!!t.isLegend),s=c.type.indexOf("100")!==-1?c.type.replace("100","")+"Series":c.type+"Series",a=c.errorBar.visible||a,h=c.marker.dataLabel.visible||h||c.type==="Pareto"&&c.paretoOptions.marker.dataLabel.visible,l=c.dragSettings.enable||l,i.some(function(d){return d.member===s})||i.push({member:s,args:[t,r]}),t.chartAreaType==="PolarRadar"&&i.push({member:c.drawType+"Series",args:[t,r]}),c.type==="Pareto"&&(i.push({member:"ColumnSeries",args:[t,r]}),i.push({member:"LineSeries",args:[t,r]}))}),this.findIndicatorModules(i),this.findTrendLineModules(i),i=this.findAxisModule(i),n=this.annotations.some(function(c){return c.content!==null}),a&&i.push({member:"ErrorBar",args:[this,r]}),this.isLegend&&i.push({member:"Legend",args:[this]}),(this.enableExport||this.allowExport)&&i.push({member:"Export",args:[this]}),this.chartAreaType!=="PolarRadar"&&this.crosshair.enable&&i.push({member:"Crosshair",args:[this]}),this.chartAreaType!=="PolarRadar"&&!this.scrollSettingEnabled&&(u.enableSelectionZooming||u.enableMouseWheelZooming||u.enablePinchZooming||u.enablePan||u.enableScrollbar||u.showToolbar)&&(i.push({member:"Zoom",args:[this,this.zoomSettings]}),u.enableScrollbar&&i.push({member:"ScrollBar",args:[this]})),this.selectionMode!=="None"&&!(this.chartAreaType==="PolarRadar"&&this.selectionMode.indexOf("Drag")>-1)&&i.push({member:"Selection",args:[this]}),(this.highlightMode!=="None"||this.legendSettings.enableHighlight)&&i.push({member:"Highlight",args:[this]}),h&&i.push({member:"DataLabel",args:[this,r]}),l&&i.push({member:"DataEditing",args:[this]}),n&&i.push({member:"Annotation",args:[this]}),i},e.prototype.findAxisModule=function(t){var i=[];i.push(this.primaryXAxis),i.push(this.primaryYAxis),i=i.concat(this.axes);for(var r=!1,n=!1,s=!1,a=!1,l=!1,h=!1,u=0,c=i;u<c.length;u++){var d=c[u];r=d.valueType==="DateTime"||r,n=d.valueType==="Category"||n,s=d.valueType==="Logarithmic"||s,l=d.valueType==="DateTimeCategory"||l,a=this.findStriplineVisibility(d.stripLines)||a,h=d.multiLevelLabels.length>0||h,this.scrollSettingEnabled=d.scrollbarSettings.enable?!0:this.scrollSettingEnabled}return r&&t.push({member:"DateTime",args:[this]}),n&&t.push({member:"Category",args:[this]}),s&&t.push({member:"Logarithmic",args:[this]}),a&&t.push({member:"StripLine",args:[this]}),h&&t.push({member:"MultiLevelLabel",args:[this]}),l&&t.push({member:"DateTimeCategory",args:[this]}),this.scrollSettingEnabled&&t.push({member:"ScrollBar",args:[this]}),t},e.prototype.findIndicatorModules=function(t){var i,r,n=this.indicators;if(this.indicators.length){t.push({member:"LineSeries",args:[this]}),n.map(function(h){i=i||h.type==="Macd",r=r||h.type==="BollingerBands"}),i&&t.push({member:"ColumnSeries",args:[this]}),r&&t.push({member:"RangeAreaSeries",args:[this]}),r&&t.push({member:"SplineRangeAreaSeries",args:[this]});for(var s=0,a=this.indicators;s<a.length;s++){var l=a[s];t.push({member:l.type+"Indicator",args:[this]})}}},e.prototype.findTrendLineModules=function(t){for(var i,r,n=function(u){var c;u.trendlines.map(function(d){c=c||d.marker.visible,i=!!(i||d.type==="Linear"||d.type==="MovingAverage"),r=!!(r||!i||d.type==="Exponential"||d.type==="Logarithmic"||d.type==="Power"||d.type==="Polynomial")}),c&&t.push({member:"Marker",args:[s,u]})},s=this,a=0,l=this.series;a<l.length;a++){var h=l[a];n(h)}(i||r)&&t.push({member:"TrendLine",args:[this]}),i&&t.push({member:"LineSeries",args:[this]}),r&&t.push({member:"SplineSeries",args:[this]})},e.prototype.findStriplineVisibility=function(t){for(var i=!1,r=0,n=t;r<n.length;r++){var s=n[r];if(s.visible){i=!0;break}}return i},e.prototype.removeSvg=function(){if(this.redraw)return null;if(Xm(this),this.enableCanvas&&this.svgObject&&this.svgObject.tagName==="CANVAS")return this.renderer.clearRect(new Ae(0,0,this.availableSize.width,this.availableSize.height)),this.svgObject.parentNode&&Ue(this.svgObject),null;ni(this.element.id+"_Secondary_Element"),this.isReact&&this.clearTemplate();var t=0;if(this.zoomModule&&this.zoomModule.pinchTarget&&(this.zoomModule.pinchTarget.id="",this.zoomModule.pinchTarget.setAttribute("opacity","0"),this.svgObject.appendChild(this.zoomModule.pinchTarget),t=1),!g(this.resizeTo)){if(this.resizeTo!==this.checkResize&&this.isBlazor&&this.element.childElementCount)for(var i=document.querySelectorAll(".e-chart"),r=0;r<i.length;r++)for(var n=i[r];n.firstChild;)Ue(n.firstChild);this.checkResize=this.resizeTo}if(this.svgObject){for(;this.svgObject.childNodes.length>t;)this.svgObject.removeChild(this.svgObject.firstChild);!this.svgObject.hasChildNodes()&&this.svgObject.parentNode&&!this.stockChart&&Ue(this.svgObject)}},e.prototype.refreshDefinition=function(t){for(var i=0,r=t;i<r.length;i++){var n=r[i];n.axes=[]}},e.prototype.refreshAxis=function(){var t=this.primaryXAxis;t.rect=new Ae(void 0,void 0,0,0),t=this.primaryYAxis,t.isStack100=!1,t.rect=new Ae(void 0,void 0,0,0);for(var i=0,r=this.axes;i<r.length;i++){var n=r[i];t=n,t.rect=new Ae(void 0,void 0,0,0),t.isStack100=!1}if(this.paretoSeriesModule&&this.series[0].type==="Pareto")for(var s=0,a=this.paretoSeriesModule.paretoAxes;s<a.length;s++){var n=a[s];t=n,t.rect=new Ae(void 0,void 0,0,0),t.isStack100=!1}},e.prototype.axisChange=function(t){return!t.name&&!t.valueType?!1:(this.refreshDefinition(this.columns),this.refreshDefinition(this.rows),this.calculateVisibleAxis(),this.processData(),!0)},e.prototype.getVisibleSeries=function(t,i){for(var r=0,n=t;r<n.length;r++){var s=n[r];if(i===s.index)return s}return null},e.prototype.refreshLiveData=function(){this.calculateVisibleSeries(),this.initTechnicalIndicators(),this.initTrendLines(),this.refreshDefinition(this.columns),this.refreshDefinition(this.rows),this.calculateVisibleAxis(),this.processData(!1),this.isBlazor||(this.enableCanvas?this.createChartSvg():this.removeSvg(),this.refreshAxis(),this.refreshBound(),this.trigger("loaded",{chart:this.isBlazor?{}:this}))},e.prototype.removeStyles=function(){ni(this.element.id+"_ej2_chart_selection"),ni(this.element.id+"_ej2_chart_highlight")},e.prototype.mouseMoveEvent=function(){if(this.tooltip.enable&&this.previousPageX!==null&&this.previousPageY!==null){var t=document.createEvent("MouseEvent");t.initMouseEvent("mousemove",!0,!1,window,1,100,100,this.previousPageX,this.previousPageY,!1,!1,!1,!1,0,null),this.element.dispatchEvent(t)}},e.prototype.showTooltip=function(t,i,r){if(r===void 0&&(r=!1),r)for(var n=0,s=this.visibleSeries;n<s.length;n++)for(var a=s[n],l=0,h=a.points;l<h.length;l++){var u=h[l],c=a.xAxis.valueType==="DateTime"?u.xValue:u.x,d=t;if(a.xAxis.valueType==="DateTime"&&(d=new Date(d).getTime()),t===c&&i===u.yValue){this.mouseX=u.regions[0].x+this.chartAxisLayoutPanel.seriesClipRect.x,this.mouseY=u.regions[0].y+this.chartAxisLayoutPanel.seriesClipRect.y,this.tooltipModule.tooltip(),this.markerRender.mouseMoveHandler();break}}else this.isTouch&&(this.startMove=!0),this.mouseX=t,this.mouseY=i,this.tooltipModule.mouseMoveHandler(),this.markerRender.mouseMoveHandler()},e.prototype.hideTooltip=function(){this.tooltipModule.removeTooltip(B.isDevice?2e3:1e3)},e.prototype.showCrosshair=function(t,i){this.mouseX=t,this.mouseY=i,this.isCrosshair=!1,Oi(this.mouseX,this.mouseY,this.chartAxisLayoutPanel.seriesClipRect)?this.crosshairModule.crosshair():this.hideCrosshair(),this.isCrosshair=!0},e.prototype.hideCrosshair=function(){this.crosshairModule.removeCrosshair(B.isDevice?2e3:1e3)},e.prototype.sanitize=function(t){return this.enableHtmlSanitizer?Bt.sanitize(t):t},e.prototype.onPropertyChanged=function(t,i){var r=!1,n=!1;this.animateSeries=!1;var s,a=!1,l=!1;if(!this.delayRedraw&&!this.zoomRedraw){for(var h=0,u=Object.keys(t);h<u.length;h++){var c=u[h];switch(a=a||c!=="primaryXAxis"&&c!=="primaryYAxis"&&c!=="axes",l&&a&&(this.redraw=!1),c){case"primaryXAxis":s=t.primaryXAxis,n=this.axisChange(s),t.primaryXAxis.edgeLabelPlacement&&(r=!0),t.primaryXAxis.crosshairTooltip||(n=!0),t.primaryXAxis.scrollbarSettings&&(n=!0),(!g(s.isInversed)||!g(s.opposedPosition))&&this.primaryXAxis.setIsInversedAndOpposedPosition(),(!this.primaryXAxis.zoomingScrollBar||!this.primaryXAxis.zoomingScrollBar.isScrollUI)&&this.zoomModule&&(!g(s.zoomFactor)||!g(s.zoomPosition))&&(this.redraw=this.zoomSettings.enableAnimation&&!a,l=this.zoomSettings.enableAnimation&&!a);break;case"primaryYAxis":s=t.primaryYAxis,n=this.axisChange(s),t.primaryYAxis.edgeLabelPlacement&&(r=!0),t.primaryYAxis.crosshairTooltip||(n=!0),t.primaryYAxis.scrollbarSettings&&(n=!0),(!g(s.isInversed)||!g(s.opposedPosition))&&this.primaryYAxis.setIsInversedAndOpposedPosition(),(!this.primaryYAxis.zoomingScrollBar||!this.primaryYAxis.zoomingScrollBar.isScrollUI)&&this.zoomModule&&(!g(s.zoomFactor)||!g(s.zoomPosition))&&(this.redraw=this.zoomSettings.enableAnimation&&!a,l=this.zoomSettings.enableAnimation&&!a);break;case"axes":for(var d=0,p=Object.keys(t.axes);d<p.length;d++){var f=p[d];s=t.axes[f],n=n||this.axisChange(s),s.crosshairTooltip||(n=!0),s.scrollbarSettings&&(n=!0),(!g(s.isInversed)||!g(s.opposedPosition))&&this.axes[f].setIsInversedAndOpposedPosition(),(!this.axes[f].zoomingScrollBar||!this.axes[f].zoomingScrollBar.isScrollUI)&&this.zoomModule&&(!g(s.zoomFactor)||!g(s.zoomPosition))&&(this.redraw=this.zoomSettings.enableAnimation&&!a,l=this.zoomSettings.enableAnimation&&!a)}this.scrollElement&&this.zoomSettings.enableScrollbar&&(this.scrollElement=null);break;case"height":case"width":this.createChartSvg(),n=!0;break;case"subTitle":case"title":n=!0;break;case"titleStyle":t.titleStyle&&(t.titleStyle.size||t.titleStyle.textOverflow||t.titleStyle.position)?n=!0:r=!0;break;case"subTitleStyle":t.subTitleStyle&&(t.subTitleStyle.size||t.subTitleStyle.textOverflow)?n=!0:r=!0;break;case"border":r=!0;break;case"dataSource":this.processData(!1),n=!0;break;case"enableCanvas":this.refresh();break;case"series":{for(var v=this.series.length,m=!1,y=void 0,S=void 0,b=0;b<v;b++)y=t.series[b],this.isBlazor&&y&&(y.visible!==i.series[b].visible||y.isClosed||y.marker||y.emptyPointSettings||y.type||y.boxPlotMode||y.showMean)&&(S=!0),!g(y)&&(y.dataSource||y.query||y.errorBar||y.xName||y.yName||y.size||y.high||y.low||y.open||y.close||y.trendlines||y.fill||y.name||y.marker||y.width||y.binInterval||y.type||y.visible!==i.series[b].visible||y.legendShape||y.emptyPointSettings||y.opacity||y.columnWidth||y.columnSpacing||y.opacity||y.dashArray||y.bearFillColor||y.bullFillColor||S)&&(he(this.getVisibleSeries(this.visibleSeries,b),y,null,!0),m=!0);m&&(this.calculateAreaType(),this.calculateVisibleSeries(),this.initTechnicalIndicators(),this.initTrendLines(),this.refreshDefinition(this.columns),this.refreshDefinition(this.rows),this.calculateVisibleAxis(),this.processData(!1),n=!0);break}case"indicators":n=!0;break;case"zoomSettings":(t.zoomSettings.enableScrollbar||i.zoomSettings.enableScrollbar)&&(n=!0),r=!0;break;case"background":r=!0;break;case"chartArea":t.chartArea.border&&t.chartArea.border.width&&(n=!0),r=!0;break;case"legendSettings":(!t.legendSettings.background||!t.legendSettings.opacity)&&(n=!0),r=!0;break;case"palettes":this.calculateVisibleSeries(),r=!0;break;case"selectedDataIndexes":this.selectionModule?(this.selectionModule.currentMode=this.selectionMode,this.selectionModule.selectedDataIndexes=this.selectedDataIndexes,this.selectionModule.styleId=this.element.id+"_ej2_chart_selection",this.selectionModule.redrawSelection(this,i.selectionMode,!0)):this.highlightModule&&(this.highlightModule.currentMode=this.highlightMode,this.highlightModule.highlightDataIndexes=this.selectedDataIndexes,this.highlightModule.styleId=this.element.id+"_ej2_chart_highlight",this.highlightModule.redrawSelection(this,i.selectionMode,!0));break;case"selectionMode":this.selectionModule&&t.selectionMode&&t.selectionMode.indexOf("Drag")===-1&&(this.selectionModule.currentMode=this.selectionMode,i.selectionMode==="None"&&this.selectionModule.invokeSelection(this),this.selectionModule.styleId=this.element.id+"_ej2_chart_selection",this.selectionModule.redrawSelection(this,i.selectionMode,!0));break;case"isMultiSelect":this.selectionModule&&!t.isMultiSelect&&this.selectionModule.selectedDataIndexes.length>1&&(this.selectionModule.currentMode=this.selectionMode,this.selectionModule.styleId=this.element.id+"_ej2_chart_selection",this.selectionModule.redrawSelection(this,i.selectionMode));break;case"highlightMode":case"selectionPattern":case"highlightPattern":this.removeStyles(),r=!0;break;case"theme":this.animateSeries=!0;break;case"enableRtl":case"locale":case"currencyCode":this.isBlazor?(this.setCulture(),r=!0):this.refresh();break;case"tooltip":this.tooltipModule&&(this.tooltipModule.previousPoints=[],this.tooltip.template&&(this.tooltipModule.template=this.tooltip.template));break}}!n&&r&&(this.rotatedDataLabelCollections=[],this.removeSvg(),this.renderElements(),this.trigger("loaded",{chart:this.isBlazor?{}:this})),n&&(this.enableCanvas?this.createChartSvg():this.removeSvg(),this.isReact&&this.clearTemplate(),this.dragY=null,this.refreshAxis(),this.refreshBound(),this.trigger("loaded",{chart:this.isBlazor?{}:this}),this.redraw=!1,this.animated=!1)}this.zoomRedraw=!1},Ne([C(null)],e.prototype,"width",void 0),Ne([C(null)],e.prototype,"height",void 0),Ne([C("")],e.prototype,"title",void 0),Ne([C("")],e.prototype,"dataSource",void 0),Ne([be({fontFamily:null,size:null,fontStyle:null,fontWeight:null,color:null},pN)],e.prototype,"titleStyle",void 0),Ne([C("")],e.prototype,"subTitle",void 0),Ne([be({fontFamily:null,size:null,fontStyle:null,fontWeight:null,color:null,accessibility:{focusable:!1}},pN)],e.prototype,"subTitleStyle",void 0),Ne([be({},Hc)],e.prototype,"margin",void 0),Ne([be({color:"#DDDDDD",width:0},Zn)],e.prototype,"border",void 0),Ne([C(null)],e.prototype,"background",void 0),Ne([be({border:{color:null,width:.5},background:"transparent"},xU)],e.prototype,"chartArea",void 0),Ne([C(!1)],e.prototype,"enableHtmlSanitizer",void 0),Ne([be({name:"primaryXAxis"},Fm)],e.prototype,"primaryXAxis",void 0),Ne([be({name:"primaryYAxis"},Fm)],e.prototype,"primaryYAxis",void 0),Ne([Wt([{}],PU)],e.prototype,"rows",void 0),Ne([Wt([{}],BU)],e.prototype,"columns",void 0),Ne([Wt([{}],Fm)],e.prototype,"axes",void 0),Ne([Wt([{}],Hr)],e.prototype,"series",void 0),Ne([Wt([{accessibility:{focusable:!1}}],AU)],e.prototype,"annotations",void 0),Ne([C([])],e.prototype,"palettes",void 0),Ne([C("Material")],e.prototype,"theme",void 0),Ne([be({},FN)],e.prototype,"tooltip",void 0),Ne([be({},TW)],e.prototype,"crosshair",void 0),Ne([be({},dF)],e.prototype,"legendSettings",void 0),Ne([Wt([{}],AW)],e.prototype,"rangeColorSettings",void 0),Ne([be({},LW)],e.prototype,"zoomSettings",void 0),Ne([C("")],e.prototype,"highlightColor",void 0),Ne([C("None")],e.prototype,"selectionMode",void 0),Ne([C("None")],e.prototype,"highlightMode",void 0),Ne([C("None")],e.prototype,"selectionPattern",void 0),Ne([C("None")],e.prototype,"highlightPattern",void 0),Ne([C(!1)],e.prototype,"isMultiSelect",void 0),Ne([C(!1)],e.prototype,"allowMultiSelection",void 0),Ne([C(!0)],e.prototype,"enableExport",void 0),Ne([C(!1)],e.prototype,"allowExport",void 0),Ne([Wt([],RN)],e.prototype,"selectedDataIndexes",void 0),Ne([C(!1)],e.prototype,"useGroupingSeparator",void 0),Ne([C(!1)],e.prototype,"enableAutoIntervalOnBothAxis",void 0),Ne([C(!1)],e.prototype,"isTransposed",void 0),Ne([C(!1)],e.prototype,"enableCanvas",void 0),Ne([C(null)],e.prototype,"backgroundImage",void 0),Ne([Wt([],AN)],e.prototype,"indicators",void 0),Ne([C(!0)],e.prototype,"enableAnimation",void 0),Ne([C(null)],e.prototype,"description",void 0),Ne([C(1)],e.prototype,"tabIndex",void 0),Ne([C(!0)],e.prototype,"enableSideBySidePlacement",void 0),Ne([be({},So)],e.prototype,"accessibility",void 0),Ne([C(null)],e.prototype,"focusBorderColor",void 0),Ne([C(1.5)],e.prototype,"focusBorderWidth",void 0),Ne([C(0)],e.prototype,"focusBorderMargin",void 0),Ne([be({},RU)],e.prototype,"stackLabels",void 0),Ne([q()],e.prototype,"resized",void 0),Ne([q()],e.prototype,"beforeResize",void 0),Ne([q()],e.prototype,"annotationRender",void 0),Ne([q()],e.prototype,"beforePrint",void 0),Ne([q()],e.prototype,"loaded",void 0),Ne([q()],e.prototype,"beforeExport",void 0),Ne([q()],e.prototype,"afterExport",void 0),Ne([q()],e.prototype,"load",void 0),Ne([q()],e.prototype,"animationComplete",void 0),Ne([q()],e.prototype,"legendRender",void 0),Ne([q()],e.prototype,"textRender",void 0),Ne([q()],e.prototype,"pointRender",void 0),Ne([q()],e.prototype,"seriesRender",void 0),Ne([q()],e.prototype,"axisLabelRender",void 0),Ne([q()],e.prototype,"axisLabelClick",void 0),Ne([q()],e.prototype,"axisRangeCalculated",void 0),Ne([q()],e.prototype,"axisMultiLabelRender",void 0),Ne([q()],e.prototype,"legendClick",void 0),Ne([q()],e.prototype,"multiLevelLabelClick",void 0),Ne([q()],e.prototype,"tooltipRender",void 0),Ne([q()],e.prototype,"sharedTooltipRender",void 0),Ne([q()],e.prototype,"chartMouseMove",void 0),Ne([q()],e.prototype,"chartMouseClick",void 0),Ne([q()],e.prototype,"chartDoubleClick",void 0),Ne([q()],e.prototype,"pointClick",void 0),Ne([q()],e.prototype,"pointDoubleClick",void 0),Ne([q()],e.prototype,"pointMove",void 0),Ne([q()],e.prototype,"chartMouseLeave",void 0),Ne([q()],e.prototype,"chartMouseDown",void 0),Ne([q()],e.prototype,"chartMouseUp",void 0),Ne([q()],e.prototype,"dragComplete",void 0),Ne([q()],e.prototype,"selectionComplete",void 0),Ne([q()],e.prototype,"zoomComplete",void 0),Ne([q()],e.prototype,"onZooming",void 0),Ne([q()],e.prototype,"scrollStart",void 0),Ne([q()],e.prototype,"scrollEnd",void 0),Ne([q()],e.prototype,"scrollChanged",void 0),Ne([q()],e.prototype,"dragStart",void 0),Ne([q()],e.prototype,"drag",void 0),Ne([q()],e.prototype,"dragEnd",void 0),Ne([C("USD")],e.prototype,"currencyCode",void 0),e=Ne([bt],e),e}(Kt),kW=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),NW=function(o){kW(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return e.prototype.calculateDateTimeNiceInterval=function(t,i,r,n,s){s===void 0&&(s=!0);var a=24*60*60*1e3,l=new Date(r),h=new Date(n),u=Math.abs((l.getTime()-h.getTime())/a),c;t.actualIntervalType=t.intervalType;var d=t.intervalType;switch(d){case"Years":c=this.calculateNumericNiceInterval(t,u/365,i);break;case"Quarter":c=this.calculateNumericNiceInterval(t,u/365*4,i);break;case"Months":c=this.calculateNumericNiceInterval(t,u/30,i);break;case"Weeks":c=this.calculateNumericNiceInterval(t,u/7,i);break;case"Days":c=this.calculateNumericNiceInterval(t,u,i);break;case"Hours":c=this.calculateNumericNiceInterval(t,u*24,i);break;case"Minutes":c=this.calculateNumericNiceInterval(t,u*24*60,i);break;case"Seconds":c=this.calculateNumericNiceInterval(t,u*24*60*60,i);break;case"Auto":return c=this.calculateNumericNiceInterval(t,u/365,i),c>=1?(t.actualIntervalType="Years",c):(c=this.calculateNumericNiceInterval(t,u/30,i),c>=1?(t.actualIntervalType="Months",c):(c=this.calculateNumericNiceInterval(t,u/7,i),c>=1&&!s?(t.actualIntervalType="Weeks",c):(c=this.calculateNumericNiceInterval(t,u,i),c>=1?(t.actualIntervalType="Days",c):(c=this.calculateNumericNiceInterval(t,u*24,i),c>=1?(t.actualIntervalType="Hours",c):(c=this.calculateNumericNiceInterval(t,u*24*60,i),c>=1?(t.actualIntervalType="Minutes",c):(c=this.calculateNumericNiceInterval(t,u*24*60*60,i),t.actualIntervalType="Seconds",c))))))}return c},e.prototype.getSkeleton=function(t,i,r,n){var s,a=t.actualIntervalType;return t.skeleton?t.skeleton:(a==="Years"?n?s=(t.isChart&&t.valueType==="DateTime","y"):s=t.isChart?t.valueType==="DateTime"&&t.isIntervalInDecimal?"y":"yMMM":"y":a==="Quarter"?s=n?"y":"yMMM":a==="Months"?n?s=(t.isChart,"m"):s=t.isChart?"MMMd":"MMM":a==="Weeks"?s=n?"m":"MEd":a==="Days"?n?s="d":s=t.isChart?t.valueType==="DateTime"?"MMMd":"yMd":"MMMd":a==="Hours"?n?s="t":s=t.isChart?t.valueType==="DateTime"?"Hm":"EHm":"h":a==="Minutes"?n?s="T":s=t.isChart?"Hms":"hm":n?s="T":s=t.isChart?"Hms":"hms",s)},e.prototype.findCustomFormats=function(t){var i=t.labelFormat?t.labelFormat:"";return t.isChart&&!t.skeleton&&t.actualIntervalType==="Months"&&!i&&(i=t.valueType==="DateTime"?"MMM yyyy":"yMMM"),i},e}(PN);var FW=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),gF=function(o){FW(e,o);function e(t){return o.call(this,t)||this}return e.prototype.calculateRangeAndInterval=function(t,i){this.calculateRange(i),this.getActualRange(i,t),this.applyRangePadding(i,t),this.calculateVisibleLabels(i)},e.prototype.getActualRange=function(t,i){this.initializeDoubleRange(t),t.actualRange={},t.interval?t.actualRange.interval=Math.ceil(t.interval):t.actualRange.interval=Math.max(1,Math.floor(t.doubleRange.delta/eF(i,t))),t.actualRange.min=t.doubleRange.start,t.actualRange.max=t.doubleRange.end,t.actualRange.delta=t.doubleRange.delta},e.prototype.applyRangePadding=function(t,i){var r;t.series.forEach(function(s){r||(r=(s.type.indexOf("Column")>-1||s.type.indexOf("Bar")>-1)&&!(t.zoomFactor<1||t.zoomPosition>0)&&g(t.minimum)&&g(t.maximum))});var n=(t.labelPlacement==="BetweenTicks"||r)&&!this.chart.stockChart&&this.chart.chartAreaType!=="PolarRadar"?.5:0;n>0?(t.actualRange.min-=n,t.actualRange.max+=n):t.actualRange.max+=t.actualRange.max?0:.5,t.doubleRange=new mo(t.actualRange.min,t.actualRange.max),t.actualRange.delta=t.doubleRange.delta,this.calculateVisibleRange(i,t)},e.prototype.calculateVisibleLabels=function(t){t.visibleLabels=[],t.visibleRange.interval=t.visibleRange.interval<1?1:t.visibleRange.interval;var i=Math.ceil(t.visibleRange.min),r;(t.zoomFactor<1||t.zoomPosition>0)&&(i=t.visibleRange.min-t.visibleRange.min%t.visibleRange.interval);var n;for(t.startLabel=t.labels[Math.round(t.visibleRange.min)],t.endLabel=t.labels[Math.floor(t.visibleRange.max)];i<=t.visibleRange.max;i+=t.visibleRange.interval)r=he({},V("properties",t.labelStyle),null,!0),Yh(i,t.visibleRange)&&t.labels.length>0&&(n=Math.round(i),Gw(this.chart,n,t.labels[n]?t.labels[n].toString():"",r,t));t.getMaxLabelWidth&&t.getMaxLabelWidth(this.chart)},e.prototype.getModuleName=function(){return"Category"},e.prototype.destroy=function(){},e}(NW);var Jm=function(){function o(e){this.chart=e}return o.prototype.enableComplexProperty=function(e){var t=[],i=[],r=e.xAxis.visibleRange,n=e.yAxis.visibleRange,s=e.points,a=e.clipRect,l=this.chart&&this.chart.zoomRedraw&&this.chart.redraw?this.previousX:Math.abs(r.delta/a.width),h=this.chart&&this.chart.zoomRedraw&&this.chart.redraw?this.previousY:Math.abs(n.delta/a.height),u=s[0]&&s[0].xValue>l?0:l,c=s[0]&&s[0].y>h?0:h;this.previousX=l,this.previousY=h;for(var d=0,p=0,f=0,v=s;f<v.length;f++){var m=v[f];m.symbolLocations=[],d=g(m.xValue)?r.min:m.xValue,p=g(m.yValue)?n.min:m.yValue,(Math.abs(u-d)>=l||Math.abs(c-p)>=h)&&(t.push(m),u=d,c=p)}for(var y,S=0;S<t.length;S++)y=t[S],!(g(y.x)||e.category==="Indicator"&&(isNaN(y.xValue)||isNaN(y.yValue)))&&i.push(y);return i},o.prototype.getLineDirection=function(e,t,i,r,n,s){var a="";if(e!=null){var l=n(e.xValue,e.yValue,i.xAxis,i.yAxis,r,i),h=n(t.xValue,t.yValue,i.xAxis,i.yAxis,r,i);a=s+" "+l.x+" "+l.y+" L "+h.x+" "+h.y+" "}return a},o.prototype.appendLinePath=function(e,t,i){var r=this.appendPathElement(e,t,i);Qm(r.element,e.d,t.chart.redraw,r.previousDirection,r.chart.duration)},o.prototype.appendPathElement=function(e,t,i){var r=ce(e.id),n=t.chart,s=r?r.getAttribute("d"):null,a=t.chart.renderer.drawPath(e,new Int32Array([t.clipRect.x,t.clipRect.y]));if(a&&a.setAttribute("clip-path",i),t.category==="TrendLine"&&a){var l=n.series[t.sourceIndex].trendlines[t.index];l.marker.visible||a.setAttribute("tabindex",l.accessibility.focusable?String(l.accessibility.tabIndex):"-1"),a.setAttribute("role",l.accessibility.accessibilityRole?l.accessibility.accessibilityRole:""),a.setAttribute("aria-label",l.accessibility.accessibilityDescription?l.accessibility.accessibilityDescription:"")}return t.pathElement=a,t.chart.enableCanvas||t.seriesElement.appendChild(a),t.isRectSeries=!1,{element:r,previousDirection:s,chart:n}},o.prototype.addPath=function(e,t,i){var r=this.appendPathElement(e,t,i);if(r.previousDirection!==""&&e.d!==""){var n=r.previousDirection.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/g),s=e.d.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/g),a=Math.max(n.length,s.length),l=Math.min(n.length,s.length);if(n.length<s.length){for(var h=l;h<a;h++)s.length!==n.length&&n.push(n[n.length-1].replace("M","L"));ha(r.element,e.d,t.chart.redraw,n.join(" "),this.chart.duration)}else if(n.length>s.length){for(var h=l;h<a;h++)s.length!==n.length&&(t.removedPointIndex===t.points.length?s.push(s[s.length-1].replace("M","L")):s.splice(1,0,s[0].replace("M","L")));ha(r.element,s.join(""),t.chart.redraw,r.previousDirection,this.chart.duration,e.d)}else ha(r.element,e.d,t.chart.redraw,r.previousDirection,this.chart.duration)}},o.prototype.addAreaPath=function(e,t,i){var r=this.appendPathElement(e,t,i);if(r.previousDirection!==""&&e.d!==""){var n=r.previousDirection.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/g),s=e.d.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/g),a=Math.max(n.length,s.length),l=Math.min(n.length,s.length);if(l<s.length){for(var h=l;h<a;h++)s.length!==n.length&&s.length!==n.length&&(n.length===1?n.push(n[n.length-(e.id.indexOf("border")!==-1?1:2)].replace("M","L")):n.splice(n.length-1,0,n[n.length-(e.id.indexOf("border")!==-1?1:2)]));ha(r.element,e.d,t.chart.redraw,n.join(" "),this.chart.duration)}else if(n.length>s.length){for(var h=l;h<a;h++)s.length!==n.length&&(t.removedPointIndex===t.points.length?s.length===1?s.push(s[s.length-(e.id.indexOf("border")!==-1?1:2)].replace("M","L")):s.splice(s.length-1,0,s[s.length-(e.id.indexOf("border")!==-1?1:2)]):s.splice(1,0,s[1]?s[1]:s[0]));ha(r.element,s.join(""),t.chart.redraw,r.previousDirection,this.chart.duration,e.d)}else ha(r.element,e.d,t.chart.redraw,r.previousDirection,this.chart.duration)}},o.prototype.renderMarker=function(e){e.marker&&e.marker.visible&&e.chart.markerRender.render(e)},o.prototype.doProgressiveAnimation=function(e,t){var i=new It({}),r=e.pathElement,n=r.getAttribute("stroke-dasharray"),s=e.pathElement.getTotalLength(),a;r.style.visibility="hidden",i.animate(r,{duration:t.duration===0&&Ut==="Enable"?1e3:t.duration,delay:t.delay,progress:function(l){r.style.visibility="visible",a=Math.abs(Math.round(l.timeStamp*s/l.duration)),r.setAttribute("stroke-dasharray",a+","+s)},end:function(){var l=ce(e.chart.element.id+"_Annotation_Collections");l&&(l.style.visibility="visible"),r.setAttribute("stroke-dasharray",n),r.style.visibility="",e.chart.trigger("animationComplete",{series:e.chart.isBlazor?{}:e})}})},o.prototype.storePointLocation=function(e,t,i,r){var n=t.marker&&t.marker.width?t.marker.width:0,s=t.marker&&t.marker.height?t.marker.height:0;e.symbolLocations.push(r(e.xValue,e.yValue,t.xAxis,t.yAxis,i,t)),e.regions.push(new Ae(e.symbolLocations[0].x-n,e.symbolLocations[0].y-s,2*n,2*s))},o.prototype.withinYRange=function(e,t){return e.yValue>=t.visibleRange.min&&e.yValue<=t.visibleRange.max},o.prototype.GetStepLineDirection=function(e,t,i,r,n,s){r===void 0&&(r="L");var a=n.noRisers&&s?" M ":" L ";if(i==="Right")return r=n.noRisers&&s?"M":"L",r+" "+t.x+" "+e.y+" L "+e.x+" "+e.y+" ";if(i==="Center"){var l=t.x+(e.x-t.x)/2;return r+" "+l+" "+t.y+a+l+" "+e.y+" L "+e.x+" "+e.y+" "}else return r+" "+e.x+" "+t.y+a+e.x+" "+e.y+" "},o.prototype.getFirstLastVisiblePoint=function(e){for(var t=null,i=null,r=0,n=e;r<n.length;r++){var s=n[r];t===null&&s.visible&&(t=i=s),i=s.visible?s:i}return{first:t||e[0],last:i||e[e.length-1]}},o.prototype.getBorderDirection=function(e){var t=e.split(" ");return t.length>3&&!this.chart.stackingAreaSeriesModule&&!this.chart.stackingStepAreaSeriesModule?t.splice(t.length-4,3):(this.chart.stackingAreaSeriesModule||this.chart.stackingStepAreaSeriesModule)&&(t.splice(t.length/2+1,t.length/2+1),(t[t.length-1]==="L"||t[t.length-1]==="M")&&t.splice(t.length-1,1)),t.join(" ")},o.prototype.removeEmptyPointsBorder=function(e){var t=0,i=e.split(" "),r;if(i.length===4)return i.join(" ");do r=i.indexOf("M",t),r>-1&&(i.splice(r+1,3),t=r+1,r-6>0&&(i.splice(r-6,6),t-=6));while(r!==-1);return i.join(" ")},o.prototype.doLinearAnimation=function(e,t){var i=e.clipRectElement.childNodes[0].childNodes[0],r=e.chart.animated?e.chart.duration:t.duration,n=Kw("Linear"),s=+i.getAttribute("height"),a=+i.getAttribute("width"),l=+i.getAttribute("x"),h=e.chart.requireInvertedAxis?+i.getAttribute("height")+ +i.getAttribute("y"):+i.getAttribute("y"),u;if(i.style.visibility="hidden",this.animateRect(e,t,i,r,n,s,a,l,h,u),e.marker&&e.marker.visible&&e.symbolElement){var c=e.symbolElement.childNodes[0].childNodes[0];c.style.visibility="hidden",this.animateRect(e,t,c,r,n,s,a,l,h,u)}},o.prototype.animateRect=function(e,t,i,r,n,s,a,l,h,u){new It({}).animate(i,{duration:r===0&&Ut==="Enable"?1e3:r,delay:t.delay,progress:function(c){i.style.visibility="visible",e.chart.requireInvertedAxis?(u=n(c.timeStamp,0,s,c.duration),i.setAttribute("transform","translate("+l+" "+h+") scale(1,"+u/s+") translate("+-l+" "+-h+")")):(u=n(c.timeStamp,0,a,c.duration),i.setAttribute("transform","translate("+l+" "+h+") scale("+u/a+", 1) translate("+-l+" "+-h+")"))},end:function(){var c=ce(e.chart.element.id+"_Annotation_Collections");c&&(c.style.visibility="visible");var d=document.getElementById(e.chart.element.id+"_StackLabelGroup");d&&d.setAttribute("visibility","visible"),i.setAttribute("transform","translate(0,0)"),e.chart.trigger("animationComplete",{series:e.chart.isBlazor?{}:e})}})},o}(),OW=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),vF=function(o){OW(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return e.prototype.render=function(t,i,r,n,s,a){for(var l,h,u="",c=null,d="M",p=t.chart&&t.chart.chartAreaType==="PolarRadar",f=t.emptyPointSettings&&t.emptyPointSettings.mode==="Drop",v=p?Bc:jn,m=t.category==="TrendLine"?t.points:this.enableComplexProperty(t),y=0,S=m;y<S.length;y++){var b=S[y];b.regions=[],b.symbolLocations=[],b.visible&&ul(m[b.index-1],b,m[b.index+1],t)?(u+=this.getLineDirection(c,b,t,n,v,d),d=c?"L":d,c=b,this.storePointLocation(b,t,n,v),u===""&&m.length===1&&(u="M "+b.symbolLocations[0].x+" "+b.symbolLocations[0].y)):(c=f?c:null,d=f?d:"M")}if(p&&t.isClosed){var w=this.getFirstLastVisiblePoint(m);h=v(w.last.xValue,w.last.yValue,i,r,n,t),l=v(w.first.xValue,w.first.yValue,i,r,n,t),u=u.concat(d+" "+h.x+" "+h.y+" L "+l.x+" "+l.y)}var I=t.category==="Indicator"?t.chart.element.id+"_Indicator_"+t.index+"_"+t.name:t.category==="TrendLine"?t.chart.element.id+"_Series_"+t.sourceIndex+"_TrendLine_"+t.index:t.chart.element.id+"_Series_"+(t.index===void 0?t.category:t.index),x=new Ir(I,"none",t.width,t.interior,t.opacity,t.dashArray,u);this[s?"addPath":"appendLinePath"](x,t,""),a||this.renderMarker(t)},e.prototype.updateDirection=function(t,i){this.render(t,t.xAxis,t.yAxis,t.chart.requireInvertedAxis,!1,!0);for(var r=0;r<i.length;r++)t.marker&&t.marker.visible&&t.chart.markerRender.renderMarker(t,t.points[i[r]],t.points[i[r]].symbolLocations[0],null,!0),t.marker.dataLabel.visible&&t.chart.dataLabelModule&&(t.chart.dataLabelModule.commonId=t.chart.element.id+"_Series_"+t.index+"_Point_",t.chart.dataLabelModule.renderDataLabel(t,t.points[i[r]],null,t.marker.dataLabel))},e.prototype.doAnimation=function(t){var i=t.animation;this.doProgressiveAnimation(t,i)},e.prototype.getModuleName=function(){return"LineSeries"},e.prototype.destroy=function(){},e}(Jm),ey=function(){function o(){}return o.prototype.getSideBySideInfo=function(e){if(e.isRectSeries=!0,(e.chart.enableSideBySidePlacement&&!e.position||!g(e.columnWidthInPixel))&&this.getSideBySidePositions(e),e.columnWidthInPixel)return new mo(0,0);var t=e.type==="Histogram"||!e.chart.enableSideBySidePlacement?0:e.position,i=e.type==="Histogram"||!e.chart.enableSideBySidePlacement?1:e.rectCount,r=e.chart.visibleSeries,n=e.chart.enableSideBySidePlacement?e.columnSpacing:0,s=e.columnWidth===null||isNaN(+e.columnWidth)?e.type==="Histogram"?1:.7:Math.min(e.columnWidth,1),a=JN(e.xAxis,r),l=a*s,h,u=t/i-.5,c=new mo(u,u+1/i);if(!(isNaN(c.start)||isNaN(c.end))){if(e.groupName&&e.type.indexOf("Stacking")===-1){var d=.7;e.chart.series.filter(function(m){m.columnWidth>d&&(d=m.columnWidth)});var p=a*d,f=new mo(c.start*p,c.end*p),v=(f.delta-(c.end*l-c.start*l))/2;c=new mo(f.start+v,f.end-v)}else c=new mo(c.start*l,c.end*l);h=n*c.delta,c=new mo(c.start+h/2,c.end-h/2)}return c},o.prototype.getRectangle=function(e,t,i,r,n){var s=jn(e,t,n.xAxis,n.yAxis,n.chart.requireInvertedAxis),a=jn(i,r,n.xAxis,n.yAxis,n.chart.requireInvertedAxis);return new Ae(Math.min(s.x,a.x),Math.min(s.y,a.y),Math.abs(a.x-s.x),Math.abs(a.y-s.y))},o.prototype.drawCylinder=function(e,t,i,r,n){var s=r.width,a=r.height;if(n.chart.enableCanvas){var l=n.chart.canvasRender.ctx,h=l;l.save();var u=Bn(e.fill),c=r.x+n.clipRect.x,d=r.y+n.clipRect.y,p=2*Math.PI+.1,f=void 0,v=void 0,m=void 0,y=void 0,S=void 0,b=void 0,w=void 0,I=void 0,x=void 0,M=void 0,D=void 0,A=void 0,L=void 0,T=void 0,k=void 0,F=void 0,R=void 0,N=void 0,P=void 0,O=0,z=0,H=0,Q=0,$=0;l.fillStyle=Uh(u,.9),l.lineWidth=0,l.strokeStyle=Uh(u,.9),l.globalAlpha=e.opacity,i.isColumn?(O=c,z=s+c,f=s/2,v=f/4,y=m=c+f,M=S=d-v,I=c,w=c+s,b=x=d+a-v,R=Math.PI,N=-f,P=v,i.stacking&&(i.isLastSeries||(M=S=d+v))):(Q=a+d,H=d,v=a/2,f=v/4,I=m=c+f,w=y=c+s+f,x=d+a,M=d,b=S=d+v,$=Math.PI/2,R=Math.PI*1.5,i.stacking&&(i.isLastSeries||(w=y=c+s-f)),v=-v,f=-f,N=f,P=-v);var U=Uh(u,.7),ie=l.createLinearGradient(O,H,z,Q);ie.addColorStop(0,u),ie.addColorStop(.3,U),ie.addColorStop(.7,U),ie.addColorStop(1,u);for(var ne=1;ne<=4;ne++){var te=0;for(ne<4&&l.beginPath(),ne%2===0?(D=y,A=b,L=I,T=M):(D=m,A=S,L=w,T=x),ne===4&&(f=N,v=P,l.fillStyle=ie),ne>2&&(te=$,p=R);te<=p;te+=.1)k=D-f*Math.cos(te),F=A+v*Math.sin(te),te===0?l.moveTo(k,F):l.lineTo(k,F);ne>2&&l.lineTo(L,T),ne!==3&&(l.stroke(),l.fill())}e.id.indexOf("Series")>=0&&(l.clip(),l.restore(),l=h)}else{var oe=n.chart,c=r.x,d=r.y,ae=e.id,u=e.fill,ye=u,De=nW(u);De||(u=Bn(u));var ve=0,ue=0,Tt=0,_e=0,lt=0,We=0,ct=void 0,Dt=void 0,Xt=void 0,Lt=void 0,Bi=void 0,zi=void 0,f=void 0,v=void 0,te=2;for(i.isColumn?(f=s/2,v=f/4,ct=Xt=c,Dt=v<d?d-v:i.stacking?d+v:d-v,Lt=Dt,ve=2*f,_e=v<d||a<2*v?a:i.stacking?a-2*v:a,Bi=ct,zi=v<d?Dt+a:a<Dt?a+Dt:i.stacking?a+(d-v):a+Dt,lt=100,i.stacking&&(i.isLastSeries||(Dt=Lt=d+v,_e=a<f/2?a:a-f/2))):(v=a/2,f=v/4,Dt=Lt=d,ct=Xt=Math.abs(c-f),ue=2*v,Tt=s,Bi=ct+s,zi=Dt,We=100,i.stacking&&(i.isLastSeries||(Bi=ct+s-f*2,Tt=s-f*2))),Ue(this.element);te--;)e.d="M"+ct.toString()+","+Dt.toString()+"a"+f.toString()+","+v.toString()+" 0 1,0 "+ve.toString()+","+ue.toString()+"a"+f.toString()+","+v.toString()+" 0 1,0 "+(-1*ve).toString()+","+(-1*ue).toString(),e.id=ae+"_Region_"+te,e.fill=Uh(u,.9),te%2===0&&n.type!=="StackingBar100"&&n.type!=="StackingBar"&&n.type!=="Bar"&&(e.fill=e.fill+"10"),this.element=oe.renderer.drawPath(this.options,new Int32Array([n.clipRect.x,n.clipRect.y])),vt(n.chart.enableCanvas,n.seriesElement,this.element,oe.redraw),ct=Bi,Dt=zi;e.d="M"+Xt.toString()+","+Lt.toString()+"a"+f.toString()+","+v.toString()+" 0 1,0 "+ve.toString()+","+ue.toString()+"l"+Tt.toString()+" "+_e.toString()+"a"+f.toString()+","+v.toString()+" 0 1,1 "+(-1*ve).toString()+","+(-1*ue).toString()+" z",e.id=ae+"_Region_2",e.fill=Uh(u,.7);var Ct=void 0;if(ye.indexOf("url")===-1){if(!document.getElementById(ae)){Ct={id:ae,x1:"0%",y1:"0%",x2:lt.toString()+"%",y2:We.toString()+"%"};var Ei=[{colorStop:"0%",color:u},{colorStop:"30%",color:Uh(u,.7)},{colorStop:"70%",color:Uh(u,.7)},{colorStop:"100%",color:u}];this.drawGradient(Ct,Ei,n)}e.fill="url(#"+Ct.id+")"}this.element=oe.renderer.drawPath(this.options,new Int32Array([n.clipRect.x,n.clipRect.y])),vt(n.chart.enableCanvas,n.seriesElement,this.element,oe.redraw)}},o.prototype.drawGradient=function(e,t,i){var r=i.chart,n=r.renderer.createDefs(),s="http://www.w3.org/2000/svg",a=document.createElementNS(s,"linearGradient");a.setAttribute("id",e.id),a.setAttribute("x1",e.x1),a.setAttribute("y1",e.y1),a.setAttribute("x2",e.x2),a.setAttribute("y2",e.y2);for(var l=0;l<t.length;l++){var h=document.createElementNS(s,"stop");h.setAttribute("offset",t[l].colorStop),h.setAttribute("stop-color",t[l].color),h.setAttribute("stop-opacity","1"),a.appendChild(h)}i.seriesElement.appendChild(n),n.appendChild(a)},o.prototype.getSideBySidePositions=function(e){for(var t=e.chart,i=0,r=t.columns;i<r.length;i++)for(var n=r[i],s=0,a=t.rows;s<a.length;s++){var l=a[s];this.findRectPosition(e.findSeriesCollection(n,l,!1))}},o.prototype.findRectPosition=function(e){for(var t=[],i={rectCount:0,position:null},r=0;r<e.length;r++){var n=e[r];if(n.type.indexOf("Stacking")!==-1||n.groupName!==""){var s=n.type.indexOf("Stacking")!==-1?n.stackingGroup:n.type+n.groupName;s?t[s]===void 0?(n.position=i.rectCount,t[s]=i.rectCount++):n.position=t[s]:i.position===null?(n.position=i.rectCount,i.position=i.rectCount++):n.position=i.position}else n.position=i.rectCount++}for(var r=0;r<e.length;r++){var n=e[r];n.rectCount=i.rectCount}},o.prototype.updateSymbolLocation=function(e,t,i){i.chart.requireInvertedAxis?this.updateYRegion(e,t,i):this.updateXRegion(e,t,i),i.type==="Histogram"&&(e.minimum=+e.x-i.histogramValues.binWidth/2,e.maximum=+e.x+i.histogramValues.binWidth/2)},o.prototype.updateXRegion=function(e,t,i){e.symbolLocations.push({x:t.x+t.width/2,y:i.seriesType==="BoxPlot"||i.seriesType.indexOf("HighLow")!==-1||e.yValue>=0==!i.yAxis.isAxisInverse?t.y:t.y+t.height}),this.getRegion(e,t,i),i.type==="RangeColumn"&&e.symbolLocations.push({x:t.x+t.width/2,y:t.y+t.height})},o.prototype.updateYRegion=function(e,t,i){e.symbolLocations.push({x:i.seriesType==="BoxPlot"||i.seriesType.indexOf("HighLow")!==-1||e.yValue>=0==!i.yAxis.isAxisInverse?t.x+t.width:t.x,y:t.y+t.height/2}),this.getRegion(e,t,i),i.type==="RangeColumn"&&e.symbolLocations.push({x:t.x,y:t.y+t.height/2})},o.prototype.renderMarker=function(e){e.marker&&e.marker.visible&&e.chart.markerRender.render(e)},o.prototype.getRegion=function(e,t,i){if(e.y===0){var r=i.marker&&i.marker.width?i.marker.width:0,n=i.marker&&i.marker.height?i.marker.height:0;e.regions.push(new Ae(e.symbolLocations[0].x-r,e.symbolLocations[0].y-n,2*r,2*n))}else e.regions.push(t)},o.prototype.triggerEvent=function(e,t,i,r){var n={cancel:!1,name:Zl,series:e,point:t,fill:e.setPointColor(t,i),border:e.setBorderColor(t,r),cornerRadius:e.cornerRadius};return e.chart.trigger(Zl,n),t.color=n.fill,n},o.prototype.drawRectangle=function(e,t,i,r){var n=e.chart,s=n.requireInvertedAxis?i.height:i.width;if(s<=0)return null;var a;if(t.y===0)a=this.calculateRoundedRectPath(i,0,0,0,0);else{var l=void 0,h=void 0,u=void 0,c=void 0,d=t.y<0;n.requireInvertedAxis?(l=d?r.cornerRadius.topRight:r.cornerRadius.topLeft,h=d?r.cornerRadius.topLeft:r.cornerRadius.topRight,u=d?r.cornerRadius.bottomRight:r.cornerRadius.bottomLeft,c=d?r.cornerRadius.bottomLeft:r.cornerRadius.bottomRight):(l=d?r.cornerRadius.bottomLeft:r.cornerRadius.topLeft,h=d?r.cornerRadius.bottomRight:r.cornerRadius.topRight,u=d?r.cornerRadius.topLeft:r.cornerRadius.bottomLeft,c=d?r.cornerRadius.topRight:r.cornerRadius.bottomRight),a=this.calculateRoundedRectPath(i,l,h,u,c,n.requireInvertedAxis)}var p=e.category==="Indicator"?n.element.id+"_Indicator_"+e.index+"_"+e.name+"_Point_"+t.index:n.element.id+"_Series_"+e.index+"_Point_"+(e.removedPointIndex!==null&&e.removedPointIndex<=t.index?t.index+1:t.index),f=Va(n.redraw,p),v=f?f.getAttribute("d"):"";switch(this.options=new Ir(p,r.fill,r.border.width,r.border.color,e.opacity,e.border.dashArray,e.columnFacet==="Cylinder"?"":a),this.element=n.renderer.drawPath(this.options,new Int32Array([e.clipRect.x,e.clipRect.y])),e.removedPointIndex!==null&&e.removedPointIndex<=t.index&&(this.element.id=n.element.id+"_Series_"+e.index+"_Point_"+t.index),e.seriesType){case"XY":this.element.setAttribute("role","img"),this.element.setAttribute("aria-label",e.accessibility.accessibilityDescriptionFormat?e.formatAccessibilityDescription(t,e):t.x+":"+t.yValue+", "+e.name);break;case"HighLow":this.element.setAttribute("role","img"),this.element.setAttribute("aria-label",e.accessibility.accessibilityDescriptionFormat?e.formatAccessibilityDescription(t,e):t.x+":"+t.high+", "+t.low+", "+e.name);break}e.columnFacet==="Cylinder"&&(n.redraw||!n.enableAnimation)&&e.seriesElement.querySelector("#"+this.element.id)||vt(e.chart.enableCanvas,e.seriesElement,this.element,n.redraw),e.chart.enableCanvas||Qm(this.element,e.columnFacet==="Cylinder"?"":a,n.redraw,v,n.duration)},o.prototype.animate=function(e){for(var t=e.seriesElement.childNodes,i=e.category==="Indicator"?0:1,r=Kl(e),n=0,s=r;n<s.length;n++){var a=s[n];if(!(!a.symbolLocations.length&&!(e.type==="BoxAndWhisker"&&a.regions.length)))if((e.type==="Column"||e.type==="Bar"||e.type==="StackingColumn"||e.type==="StackingColumn100"||e.type==="StackingBar"||e.type==="StackingBar100")&&e.columnFacet==="Cylinder")for(var l=0;l<t.length;l++)this.animateRect(t[l],e,a);else this.animateRect(t[i],e,a),i++}},o.prototype.animateRect=function(e,t,i){var r=t.animation,n=t.chart.animated?t.chart.duration:r.duration,s=Kw("Linear"),a=i.yValue<0,l,h,u=+i.regions[0].height,c=+i.regions[0].width,d,p;t.chart.requireInvertedAxis?(h=+i.regions[0].y,t.type.indexOf("Stacking")>-1?(l=zn(0,t.yAxis)*t.yAxis.rect.width,d=l,p=h):(l=+i.regions[0].x,p=a?h:h+u,d=t.seriesType.indexOf("HighLow")!==-1||t.type.indexOf("Waterfall")!==-1?l+c/2:a!==t.yAxis.isAxisInverse?l+c:l)):(l=+i.regions[0].x,t.type.indexOf("Stacking")>-1?(h=(1-zn(0,t.yAxis))*t.yAxis.rect.height,d=l,p=h):(h=+i.regions[0].y,p=t.seriesType.indexOf("HighLow")!==-1||t.type.indexOf("Waterfall")!==-1?h+u/2:a!==t.yAxis.isAxisInverse?h:h+u,d=a?l:l+c));var f;g(e)||(e.style.visibility="hidden",new It({}).animate(e,{duration:n===0&&Ut==="Enable"?1e3:n,delay:r.delay,progress:function(v){v.timeStamp>=v.delay&&(e.style.visibility="visible",t.chart.requireInvertedAxis?(c=c||1,f=s(v.timeStamp-v.delay,0,c,v.duration),e.setAttribute("transform","translate("+d+" "+p+") scale("+f/c+", 1) translate("+-d+" "+-p+")")):(u=u||1,f=s(v.timeStamp-v.delay,0,u,v.duration),e.setAttribute("transform","translate("+d+" "+p+") scale(1,"+f/u+") translate("+-d+" "+-p+")")))},end:function(){var v=document.getElementById(t.chart.element.id+"_Annotation_Collections");v&&(v.style.visibility="visible");var m=document.getElementById(t.chart.element.id+"_StackLabelGroup");m&&m.setAttribute("visibility","visible"),e.setAttribute("transform","translate(0,0)");var y=t.seriesElement;if((e===y.lastElementChild||i.index===t.points.length-1||t.type==="Waterfall"&&e===y.children[y.childElementCount-2])&&(t.chart.trigger("animationComplete",{series:t.chart.isBlazor?{}:t}),t.type==="Waterfall"))for(var S=y.childNodes,b=0;b<S.length;b++)S[b].id.indexOf("Connector")!==-1&&(S[b].style.visibility="visible",S[b].setAttribute("transform","translate(0,0)"))}}))},o.prototype.calculateRoundedRectPath=function(e,t,i,r,n,s){s===void 0&&(s=!1);var a=s?e.width/2:e.height/2;return t=Math.min(t,a),i=Math.min(i,a),r=Math.min(r,a),n=Math.min(n,a),"M "+e.x+" "+(t+e.y)+" Q "+e.x+" "+e.y+" "+(e.x+t)+" "+e.y+" L "+(e.x+e.width-i)+" "+e.y+" Q "+(e.x+e.width)+" "+e.y+" "+(e.x+e.width)+" "+(e.y+i)+" L "+(e.x+e.width)+" "+(e.y+e.height-n)+" Q "+(e.x+e.width)+" "+(e.y+e.height)+" "+(e.x+e.width-n)+" "+(e.y+e.height)+" L "+(e.x+r)+" "+(e.y+e.height)+" Q "+e.x+" "+(e.y+e.height)+" "+e.x+" "+(e.y+e.height-r)+" L "+e.x+" "+(t+e.y)+" Z"},o}(),RW=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),mF=function(o){RW(e,o);function e(){var t=o!==null&&o.apply(this,arguments)||this;return t.sideBySideInfo=[],t}return e.prototype.render=function(t){this.sideBySideInfo[t.index]=this.getSideBySideInfo(t);for(var i=Math.max(t.yAxis.visibleRange.min,0),r=0,n=t.points;r<n.length;r++){var s=n[r];this.renderPoint(t,s,this.sideBySideInfo[t.index],i)}this.renderMarker(t)},e.prototype.renderPoint=function(t,i,r,n){if(i.symbolLocations=[],i.regions=[],i.visible&&ul(t.points[i.index-1],i,t.points[i.index+1],t)){this.rect=this.getRectangle(i.xValue+r.start,i.yValue,i.xValue+r.end,n,t),this.rect.width=t.columnWidthInPixel?t.columnWidthInPixel-(t.chart.enableSideBySidePlacement?t.columnWidthInPixel*t.columnSpacing:0):this.rect.width,this.rect.x=t.columnWidthInPixel?this.rect.x-(t.columnWidthInPixel/2*t.rectCount-t.columnWidthInPixel*t.index):this.rect.x;var s=t.category==="Indicator"?i.color:t.interior,a=this.triggerEvent(t,i,s,{width:t.border.width,color:t.border.color});if(!a.cancel){var l=this.rect.y;if(i.yValue<n&&i.yValue>=0&&t.chart.zoomModule&&t.chart.zoomModule.isAxisZoomed(t.chart.axisCollections)&&(l=jn(i.xValue+r.start,i.yValue,t.xAxis,t.yAxis,t.chart.requireInvertedAxis).y),this.updateSymbolLocation(i,new Ae(this.rect.x,l,this.rect.width,this.rect.height),t),this.drawRectangle(t,i,this.rect,a),t.columnFacet==="Cylinder"){var h={isColumn:!0,stacking:!1,isLastSeries:!0};this.drawCylinder(this.options,this.element,h,this.rect,t)}}}},e.prototype.updateDirection=function(t,i){for(var r=Math.max(t.yAxis.visibleRange.min,0),n=0;n<i.length;n++)this.renderPoint(t,t.points[i[n]],this.sideBySideInfo[t.index],r),t.marker&&t.marker.visible&&t.chart.markerRender.renderMarker(t,t.points[i[n]],t.points[i[n]].symbolLocations[0],null,!0),t.marker.dataLabel.visible&&t.chart.dataLabelModule&&(t.chart.dataLabelModule.commonId=t.chart.element.id+"_Series_"+t.index+"_Point_",t.chart.dataLabelModule.renderDataLabel(t,t.points[i[n]],null,t.marker.dataLabel))},e.prototype.doAnimation=function(t){this.animate(t)},e.prototype.getModuleName=function(){return"ColumnSeries"},e.prototype.destroy=function(){},e}(ey),PW=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),BW=function(o){PW(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return e.prototype.getAreaPathDirection=function(t,i,r,n,s,a,l){var h="",u;return a===null&&(u=s(t,i,r.xAxis,r.yAxis,n,r),h+=l+" "+u.x+" "+u.y+" "),h},e.prototype.getAreaEmptyDirection=function(t,i,r,n,s){var a="";return a+=this.getAreaPathDirection(t.x,t.y,r,n,s,null,"L"),a+=this.getAreaPathDirection(i.x,i.y,r,n,s,null,"L"),a},e.prototype.setPointColor=function(t,i,r,n,s){if(r.pointColorMapping===""){for(var a=void 0,l=void 0,h=0;h<s.length;h++)if(a=s[h],l=n?t.xValue:t.yValue,l<=this.getAxisValue(a.value,n?r.xAxis:r.yAxis,r.chart)||!a.value&&a.value!==0){t.interior=a.color;break}return t.interior==null&&(t.interior=r.interior),!1}else return i?r.setPointColor(t,r.interior)!==r.setPointColor(i,r.interior):!1},e.prototype.sortSegments=function(t,i){var r=this,n=t.segmentAxis==="X"?t.xAxis:t.yAxis,s=[].concat(i);return s.sort(function(a,l){return r.getAxisValue(a.value,n,t.chart)-r.getAxisValue(l.value,n,t.chart)})},e.prototype.applySegmentAxis=function(t,i,r,n){var s=this;if(t.pointColorMapping!=="")return i.map(function(b){s[n?"addMulticolorPath":"appendLinePath"](b,t,"")}),null;var a=t.segmentAxis==="X",l=a?t.xAxis:t.yAxis,h=t.chart,u;this.includeSegment(r,l,t,r.length);for(var c=r.length,d,p,f,v=0,m=function(b){u=r[b],d=y.getAxisValue(u.value,l,t.chart),p=y.createClipRect(b?y.getAxisValue(r[b-1].value,l,t.chart):l.visibleRange.min,d,t,b,a),p&&i.map(function(w){v+=1,f={"clip-path":p,"stroke-dasharray":u.dashArray,opacity:w.opacity,stroke:t.type.indexOf("Line")>-1?u.color||t.interior:w.stroke,"stroke-width":w["stroke-width"],fill:t.type.indexOf("Line")>-1?"none":u.color||t.interior,id:w.id+"_Segment_"+b,d:w.d},v%2===0&&s.chart.multiColoredAreaSeriesModule&&t.border.color!=="transparent"&&f["stroke-width"]!==0&&(f.fill="transparent"),n?s.addMulticolorPath(f,t,"",!0):Qm(ce(f.id),f.d,h.redraw),t.pathElement=h.renderer.drawPath(f),!t.chart.enableCanvas&&!n&&t.seriesElement.appendChild(h.renderer.drawPath(f))})},y=this,S=0;S<c;S++)m(S)},e.prototype.includeSegment=function(t,i,r,n){if(n<=0)return t.push({value:i.visibleRange.max,color:r.interior}),null;this.getAxisValue(t[n-1].value,i,r.chart)<i.visibleRange.max&&t.push({value:i.visibleRange.max,color:r.interior})},e.prototype.addMulticolorPath=function(t,i,r,n){var s=this.appendPathElement(t,i,r);if((s.previousDirection===null||s.previousDirection==="")&&(s.previousDirection="M "+t.d.split(" ").slice(-3)[0]+" "+t.d.split(" ").slice(-5)[0]+" L "+t.d.split(" ").slice(-3)[0]+" "+t.d.split(" ").slice(-5)[0]+" L "+t.d.split(" ").slice(-3)[0]+" "+t.d.split(" ").slice(-5)[0]),(t.d===null||t.d==="")&&(t.d="M "+s.previousDirection.split(" ").slice(-3)[0]+" "+s.previousDirection.split(" ").slice(-5)[0]+" L "+s.previousDirection.split(" ").slice(-3)[0]+" "+s.previousDirection.split(" ").slice(-5)[0]),n){var a=s.previousDirection.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/g),l=t.d.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/g),h=Math.max(a.length,l.length),u=Math.min(a.length,l.length);if(a.length===l.length&&ha(ce(t.id),t.d,i.chart.redraw,s.previousDirection,this.chart.duration),a.length<l.length){for(var c=u;c<h;c++)l.length!==a.length&&a.splice(a.length-(i.type.indexOf("Line")!==-1?1:2),0,a[a.length-(i.type.indexOf("Line")!==-1?1:2)]);ha(ce(t.id),t.d,i.chart.redraw,a.join(" "),this.chart.duration)}if(a.length>l.length){for(var c=u;c<h;c++)l.length!==a.length&&l.splice(1,0,l[1].replace("M","L"));ha(s.element,l.join(""),i.chart.redraw,a.join(""),this.chart.duration,t.d)}}},e.prototype.createClipRect=function(t,i,r,n,s){var a=r.chart.requireInvertedAxis,l=jn(s?t:r.xAxis.visibleRange.min,s?r.yAxis.visibleRange.max:i,r.xAxis,r.yAxis,a),h=jn(s?i:r.xAxis.visibleRange.max,s?r.yAxis.visibleRange.min:t,r.xAxis,r.yAxis,a);h=a?[l,l=h][0]:h;var u;return(r.xAxis.isInversed||r.xAxis.isAxisInverse?l.x-h.x>0:h.x-l.x>0)&&(r.yAxis.isInversed?l.y-h.y>0:h.y-l.y>0)?(u=new as(r.chart.element.id+"_ChartSegment"+r.index+"ClipRect_"+n,"transparent",{width:1,color:"Gray"},1,{x:r.xAxis.isInversed||r.xAxis.isAxisInverse?h.x:l.x,y:r.yAxis.isInversed?h.y:l.y,width:r.xAxis.isInversed||r.xAxis.isAxisInverse?l.x-h.x:h.x-l.x,height:r.yAxis.isInversed?l.y-h.y:h.y-l.y}),r.chart.enableCanvas||r.seriesElement.appendChild(Kh(r.chart.redraw,u,r.chart.renderer)),"url(#"+r.chart.element.id+"_ChartSegment"+r.index+"ClipRect_"+n+")"):null},e.prototype.getAxisValue=function(t,i,r){if(t===null&&(t=i.visibleRange.max),i.valueType==="DateTime"){var n={skeleton:"full",type:"dateTime"};return Date.parse(r.intl.getDateParser(n)(r.intl.getDateFormat(n)(new Date(de.parse.parseJson({val:t}).val))))}else if(i.valueType.indexOf("Category")>-1){var s=i.valueType==="DateTimeCategory"?t.getTime().toString():t;return i.labels.indexOf(s)<0?+t:i.labels.indexOf(s)}else return+t},e}(Jm),zW=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),yF=function(o){zW(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return e.prototype.render=function(t,i,r,n,s,a){var l=null,h="",u=t.chart&&t.chart.chartAreaType==="PolarRadar",c=Math.max(t.yAxis.visibleRange.min,0);if(u){var d=this.getFirstLastVisiblePoint(t.points);c=d.first.yValue}for(var p,f=t.emptyPointSettings&&t.emptyPointSettings.mode==="Drop",v=t.border.width?t.border.width:0,m=t.border.color?t.border.color:t.interior,y=t.chart.chartAreaType==="PolarRadar"?Bc:jn,S=this.enableComplexProperty(t),b,w="",I=0;I<S.length;I++)b=S[I],p=b.xValue,b.symbolLocations=[],b.regions=[],b.visible&&ul(S[I-1],b,S[I+1],t)&&(h+=this.getAreaPathDirection(p,c,t,n,y,l,"M"),l=l||new Je(p,c),h+=this.getAreaPathDirection(p,b.yValue,t,n,y,null,"L"),S[I+1]&&!S[I+1].visible&&(!u||u&&this.withinYRange(S[I+1],r))&&!f&&(h+=this.getAreaEmptyDirection({x:p,y:c},l,t,n,y),l=null),this.storePointLocation(b,t,n,y));if(u&&h!==""){var x="",M=this.chart;x+=this.getAreaPathDirection(0,c,t,n,y,null,"L"),(i.isAxisInverse||r.isAxisInverse)&&(h+=t.type==="Polar"?M.polarSeriesModule.getPolarIsInversedPath(i,x):M.radarSeriesModule.getRadarIsInversedPath(i,x)),h=h.concat(h+" Z")}this[s?"addAreaPath":"appendLinePath"](new Ir(t.chart.element.id+"_Series_"+t.index,t.interior,0,"transparent",t.opacity,t.dashArray,h!==""?h+this.getAreaPathDirection(t.points[t.points.length-1].xValue,t.chart.chartAreaType==="PolarRadar"?t.points[t.points.length-1].yValue:c,t,n,y,null,"L"):""),t,""),t.border.width!==0&&(w=this.removeEmptyPointsBorder(h),this[s?"addAreaPath":"appendLinePath"](new Ir(t.chart.element.id+"_Series_border_"+t.index,"transparent",v,m,1,t.border.dashArray,w),t,"")),a||this.renderMarker(t)},e.prototype.updateDirection=function(t,i){this.render(t,t.xAxis,t.yAxis,t.chart.requireInvertedAxis,!1,!0);for(var r=0;r<i.length;r++)t.marker&&t.marker.visible&&t.chart.markerRender.renderMarker(t,t.points[i[r]],t.points[i[r]].symbolLocations[0],null,!0),t.marker.dataLabel.visible&&t.chart.dataLabelModule&&(t.chart.dataLabelModule.commonId=t.chart.element.id+"_Series_"+t.index+"_Point_",t.chart.dataLabelModule.renderDataLabel(t,t.points[i[r]],null,t.marker.dataLabel))},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"AreaSeries"},e.prototype.doAnimation=function(t){var i=t.animation;this.doLinearAnimation(t,i)},e}(BW),jW=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),bF=function(o){jW(e,o);function e(){var t=o!==null&&o.apply(this,arguments)||this;return t.sideBySideInfo=[],t}return e.prototype.render=function(t){var i=Math.max(t.yAxis.visibleRange.min,0);this.sideBySideInfo[t.index]=this.getSideBySideInfo(t);for(var r=0,n=t.points;r<n.length;r++){var s=n[r];this.renderPoint(t,s,this.sideBySideInfo[t.index],i)}this.renderMarker(t)},e.prototype.renderPoint=function(t,i,r,n){if(i.symbolLocations=[],i.regions=[],i.visible&&ul(t.points[i.index-1],i,t.points[i.index+1],t)){this.rect=this.getRectangle(i.xValue+r.start,i.yValue,i.xValue+r.end,n,t),this.rect.height=t.columnWidthInPixel?t.columnWidthInPixel:this.rect.height,this.rect.y=t.columnWidthInPixel?this.rect.y-(t.columnWidthInPixel/2*t.rectCount-t.columnWidthInPixel*t.index):this.rect.y;var s=this.triggerEvent(t,i,t.interior,{width:t.border.width,color:t.border.color});if(!s.cancel&&(this.updateSymbolLocation(i,this.rect,t),this.drawRectangle(t,i,this.rect,s),t.columnFacet==="Cylinder")){var a={isColumn:!1,stacking:!1,isLastSeries:!0};this.drawCylinder(this.options,this.element,a,this.rect,t)}}},e.prototype.updateDirection=function(t,i){for(var r=Math.max(t.yAxis.visibleRange.min,0),n=0;n<i.length;n++)this.renderPoint(t,t.points[i[n]],this.sideBySideInfo[t.index],r),t.marker&&t.marker.visible&&t.chart.markerRender.renderMarker(t,t.points[i[n]],t.points[i[n]].symbolLocations[0],null,!0),t.marker.dataLabel.visible&&t.chart.dataLabelModule&&(t.chart.dataLabelModule.commonId=t.chart.element.id+"_Series_"+t.index+"_Point_",t.chart.dataLabelModule.renderDataLabel(t,t.points[i[n]],null,t.marker.dataLabel))},e.prototype.doAnimation=function(t){this.animate(t)},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"BarSeries"},e}(ey);var HW=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),SF=function(o){HW(e,o);function e(){var t=o!==null&&o.apply(this,arguments)||this;return t.sideBySideInfo=[],t}return e.prototype.render=function(t){this.sideBySideInfo[t.index]=this.getSideBySideInfo(t);for(var i=t.stackedValues,r=0,n=t.points;r<n.length;r++){var s=n[r];this.renderPoint(t,s,this.sideBySideInfo[t.index],i)}t.visible&&this.renderMarker(t)},e.prototype.renderPoint=function(t,i,r,n){if(i.symbolLocations=[],i.regions=[],i.visible&&ul(t.points[i.index-1],i,t.points[i.index+1],t)){var s=void 0,a=void 0;if(!t.visible&&t.isLegendClicked){for(var l=t.index;l>=0;l--)if(t.chart.visibleSeries[l].visible){s=t.chart.visibleSeries[l].index;break}a=t.index>0&&s!==void 0?t.chart.visibleSeries[s].stackedValues.endValues[i.index]:t.stackedValues.startValues[i.index]}this.rect=this.getRectangle(i.xValue+r.start,!t.visible&&t.isLegendClicked?a:n.endValues[i.index],i.xValue+r.end,!t.visible&&t.isLegendClicked?a:n.startValues[i.index],t),t.chart.isTransposed&&t.columnWidthInPixel?(this.rect.width=t.columnWidthInPixel?t.columnWidthInPixel:this.rect.height,this.rect.x-=t.columnWidthInPixel/2):this.rect.height=t.columnWidthInPixel?t.columnWidthInPixel:this.rect.height,this.rect.y=t.columnWidthInPixel?t.chart.isTransposed?this.rect.y:this.rect.y-t.columnWidthInPixel/2:this.rect.y;var h=this.triggerEvent(t,i,t.interior,{width:t.visible?t.border.width:0,color:t.visible?t.border.color:""});if(!h.cancel&&(this.drawRectangle(t,i,this.rect,h),this.updateSymbolLocation(i,this.rect,t),t.columnFacet==="Cylinder")){var u={isColumn:!1,stacking:t.type==="StackingBar100",isLastSeries:!0};this.drawCylinder(this.options,this.element,u,this.rect,t)}}},e.prototype.updateDirection=function(t,i){for(var r=[],n=0;n<t.yAxis.series.length;n++){var s=t.yAxis.series[n];s.stackingGroup===t.stackingGroup&&r.push(s)}for(var a=0;a<r.length;a++)for(var n=0;n<i.length;n++)this.renderPoint(r[a],r[a].points[i[n]],this.sideBySideInfo[t.index],r[a].stackedValues),t.marker&&t.marker.visible&&r[a].chart.markerRender.renderMarker(r[a],r[a].points[i[n]],r[a].points[i[n]].symbolLocations[0],null,!0),r[a].marker.dataLabel.visible&&r[a].chart.dataLabelModule&&(r[a].chart.dataLabelModule.commonId=r[a].chart.element.id+"_Series_"+r[a].index+"_Point_",r[a].chart.dataLabelModule.renderDataLabel(r[a],r[a].points[i[n]],null,r[a].marker.dataLabel))},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"StackingBarSeries"},e.prototype.doAnimation=function(t){this.animate(t)},e}(ey);var VW=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),CF=function(o){VW(e,o);function e(){var t=o!==null&&o.apply(this,arguments)||this;return t.sideBySideInfo=[],t}return e.prototype.render=function(t){t.isRectSeries=!0,this.sideBySideInfo[t.index]=this.getSideBySideInfo(t);for(var i=t.stackedValues,r=Kl(t),n=0,s=r;n<s.length;n++){var a=s[n];this.renderPoint(t,a,this.sideBySideInfo[t.index],i,r)}t.visible&&this.renderMarker(t)},e.prototype.renderPoint=function(t,i,r,n,s){if(i.symbolLocations=[],i.regions=[],i.visible&&ul(s[i.index-1],i,s[i.index+1],t)){var a=void 0,l=void 0;if(!t.visible&&t.isLegendClicked){for(var h=t.index;h>=0;h--)if(t.chart.visibleSeries[h].visible){a=t.chart.visibleSeries[h].index;break}l=t.index>0&&a!==void 0?t.chart.visibleSeries[a].stackedValues.endValues[i.index]:t.stackedValues.startValues[i.index]}this.rect=this.getRectangle(i.xValue+r.start,!t.visible&&t.isLegendClicked?l:n.endValues[i.index],i.xValue+r.end,!t.visible&&t.isLegendClicked?l:n.startValues[i.index],t),t.chart.isTransposed&&t.columnWidthInPixel?(this.rect.height=t.columnWidthInPixel?t.columnWidthInPixel:this.rect.width,this.rect.y-=t.columnWidthInPixel/2):this.rect.width=t.columnWidthInPixel?t.columnWidthInPixel:this.rect.width,this.rect.x=t.columnWidthInPixel?t.chart.isTransposed?this.rect.x:this.rect.x-(t.columnWidthInPixel/2*t.rectCount-t.columnWidthInPixel*t.position):this.rect.x;var u=this.triggerEvent(t,i,t.interior,{width:t.visible?t.border.width:0,color:t.visible?t.border.color:""});if(!u.cancel&&(this.drawRectangle(t,i,this.rect,u),this.updateSymbolLocation(i,this.rect,t),t.columnFacet==="Cylinder")){var c={isColumn:!0,stacking:t.type==="StackingColumn100",isLastSeries:!0};this.drawCylinder(this.options,this.element,c,this.rect,t)}}},e.prototype.updateDirection=function(t,i){for(var r=[],n=0;n<t.xAxis.series.length;n++){var s=t.xAxis.series[n];s.stackingGroup===t.stackingGroup&&r.push(s)}for(var a=0;a<r.length;a++)for(var l=Kl(r[a]),n=0;n<i.length;n++)this.renderPoint(r[a],r[a].points[i[n]],this.sideBySideInfo[t.index],r[a].stackedValues,l),t.marker&&t.marker.visible&&r[a].chart.markerRender.renderMarker(r[a],r[a].points[i[n]],r[a].points[i[n]].symbolLocations[0],null,!0),r[a].marker.dataLabel.visible&&r[a].chart.dataLabelModule&&(r[a].chart.dataLabelModule.commonId=r[a].chart.element.id+"_Series_"+r[a].index+"_Point_",r[a].chart.dataLabelModule.renderDataLabel(r[a],r[a].points[i[n]],null,r[a].marker.dataLabel))},e.prototype.doAnimation=function(t){this.animate(t)},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"StackingColumnSeries"},e}(ey);var _W=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),wF=function(o){_W(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return e.prototype.render=function(t,i,r,n,s,a){var l=t.chart.chartAreaType==="PolarRadar",h=l?Bc:jn,u="",c=this.enableComplexProperty(t),d=c.length,p=t.stackedValues,f,v,m=l?Math.max(t.yAxis.visibleRange.min,p.endValues[0]):Math.max(t.yAxis.visibleRange.min,p.startValues[0]),y=0,S,b,w="";d>0&&(S=h(c[0].xValue,m,i,r,n,t),u=u.concat("M "+S.x+" "+S.y+" "));for(var I=t.chart&&t.chart.chartAreaType==="PolarRadar",x,M=t.index;M>=0;M--)if(t.chart.visibleSeries[M].visible){x=t.chart.visibleSeries[M].index;break}for(var M=0;M<d;M++)if(f=c[M].index,c[M].symbolLocations=[],c[M].regions=[],c[M].visible&&ul(c[M-1],c[M],c[M+1],t)){var D=t.index>0&&x!==void 0?this.chart.visibleSeries[x].stackedValues.endValues[f]:p.startValues[f];S=h(c[M].xValue,!t.visible&&t.isLegendClicked?D:p.endValues[f],i,r,n,t),u=u.concat("L "+S.x+" "+S.y+" "),c[M].symbolLocations.push(h(c[M].xValue,p.endValues[f],i,r,n,t)),c[M].regions.push(new Ae(c[M].symbolLocations[0].x-t.marker.width,c[M].symbolLocations[0].y-t.marker.height,2*t.marker.width,2*t.marker.height))}else if(!I&&t.emptyPointSettings.mode!=="Drop"){for(var A=M-1;A>=y;A--)f=c[A].index,b=h(c[A].xValue,p.startValues[f],i,r,n,t),u=u.concat("L "+b.x+" "+b.y+" ");c[M+1]&&c[M+1].visible&&(!I||I&&this.withinYRange(c[M+1],r))&&(v=c[M+1].index,S=h(c[M+1].xValue,p.startValues[v],i,r,n,t),u=u.concat("M "+S.x+" "+S.y+" ")),y=M+1}if(t.chart.chartAreaType==="PolarRadar"&&c.length>1){var L=this.getFirstLastVisiblePoint(t.points),T=this.chart;S={x:L.first.xValue,y:p.endValues[L.first.index]},b=h(S.x,S.y,i,r,n,t),u+="L "+b.x+" "+b.y+" ",this.chart.visible===1&&(i.isAxisInverse||r.isAxisInverse)&&(this.chart.enableAnimation=!1,u=t.type==="Polar"?T.polarSeriesModule.getPolarIsInversedPath(i,u):T.radarSeriesModule.getRadarIsInversedPath(i,u))}if(!I||I&&t.index!==this.getFirstSeriesIndex(t.chart.visibleSeries)){for(var A=d-1;A>=y;A--)if(f=c[A].index,!(I&&!c[A].visible)){var k=this.getPreviousSeries(t);(k.emptyPointSettings.mode!=="Drop"||!k.points[A].isEmpty)&&(b=h(c[A].xValue,!t.visible&&t.isLegendClicked&&t.index>0&&x!==void 0?this.chart.visibleSeries[x].stackedValues.endValues[f]:p.startValues[f],i,r,n,t),p.startValues[f]===p.endValues[f]&&(b.y=Math.floor(b.y)),u=u.concat((A===d-1&&l?"M":"L")+" "+b.x+" "+b.y+" "))}}var F=new Ir(t.chart.element.id+"_Series_"+t.index,t.interior,0,"transparent",t.opacity,t.dashArray,u);if(this[s?"addAreaPath":"appendLinePath"](F,t,""),t.border.width!==0&&t.visible){w=this.removeEmptyPointsBorder(this.getBorderDirection(u));var R=new Ir(t.chart.element.id+"_Series_border_"+t.index,"transparent",t.visible?t.border.width:0,t.border.color?t.border.color:t.interior,1,t.border.dashArray,w);this[s?"addAreaPath":"appendLinePath"](R,t,"")}!a&&t.visible&&this.renderMarker(t)},e.prototype.updateDirection=function(t,i){for(var r=0;r<t.xAxis.series.length;r++){var n=t.xAxis.series[r];this.render(n,n.xAxis,n.yAxis,n.chart.requireInvertedAxis,!1,!0);for(var s=0;s<i.length;s++)n.marker&&n.marker.visible&&n.chart.markerRender.renderMarker(n,n.points[i[s]],n.points[i[s]].symbolLocations[0],null,!0),n.marker.dataLabel.visible&&n.chart.dataLabelModule&&(n.chart.dataLabelModule.commonId=n.chart.element.id+"_Series_"+n.index+"_Point_",n.chart.dataLabelModule.renderDataLabel(n,n.points[i[s]],null,n.marker.dataLabel))}},e.prototype.addAreaPath=function(t,i,r){var n=this.appendPathElement(t,i,r);if(n.previousDirection!==""&&t.d!==""){var s=n.previousDirection.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/g),a=t.d.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/g),l=Math.max(s.length,a.length),h=Math.min(s.length,a.length);if(s.length<a.length){for(var u=s.length;u<a.length;u++)a.length!==s.length&&s.splice((s.length+1)/2,0,s.slice((s.length-1)/2)[0],s.slice((s.length-1)/2)[1]);ha(n.element,t.d,i.chart.redraw,s.join(" "),this.chart.duration)}else if(s.length>a.length){for(var u=h;u<l;u++)a.length!==s.length&&(a.splice(1,0,a[1]),a.splice(a.length-1,0,a[a.length-1]));ha(n.element,a.join(""),i.chart.redraw,n.previousDirection,this.chart.duration,t.d)}else ha(n.element,t.d,i.chart.redraw,n.previousDirection,this.chart.duration)}},e.prototype.doAnimation=function(t){var i=t.animation;this.doLinearAnimation(t,i)},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"StackingAreaSeries"},e.prototype.getPreviousSeries=function(t){for(var i=t.chart.visibleSeries,r=0,n=i.length;r<n;r++)if(t.index===i[r].index&&r!==0)return i[r-1];return i[0]},e.prototype.getFirstSeriesIndex=function(t){for(var i=0,r=t;i<r.length;i++){var n=r[i];if(n.visible)return n.index}return 0},e}(Jm);var UW=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),xF=function(o){UW(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return e.prototype.render=function(t,i,r,n,s,a){for(var l=t.chart.chartAreaType==="PolarRadar",h=l?Bc:jn,u="",c=this.enableComplexProperty(t),d=c.length,p=t.stackedValues,f,v,m,y,S=0;S<d;S++)c[S].regions=[],c[S].symbolLocations=[],f=c[S].index,c[S].visible&&ul(c[S-1],c[S],c[S+1],t)?(m=h(c[S].xValue,p.endValues[f],i,r,n,t),u=u.concat((S?"L":"M")+" "+m.x+" "+m.y+" "),c[S].symbolLocations.push(h(c[S].xValue,p.endValues[f],i,r,n,t)),c[S].regions.push(new Ae(c[S].symbolLocations[0].x-t.marker.width,c[S].symbolLocations[0].y-t.marker.height,2*t.marker.width,2*t.marker.height))):t.emptyPointSettings.mode!=="Drop"&&c[S+1]&&c[S+1].visible&&(v=c[S+1].index,m=h(c[S+1].xValue,p.endValues[v],i,r,n,t),u=u.concat("M "+m.x+" "+m.y+" "));t.chart.chartAreaType==="PolarRadar"&&c.length>1&&(m={y:p.endValues[0],x:t.points[0].xValue},y=h(m.x,m.y,i,r,n,t),u+="L "+y.x+" "+y.y+" ");var b=new Ir(t.chart.element.id+"_Series_"+t.index,"none",t.width,t.interior,t.opacity,t.dashArray,u);this[s?"addPath":"appendLinePath"](b,t,""),a||this.renderMarker(t)},e.prototype.updateDirection=function(t,i){this.render(t,t.xAxis,t.yAxis,t.chart.requireInvertedAxis,!1,!0);for(var r=0;r<i.length;r++)t.marker&&t.marker.visible&&t.chart.markerRender.renderMarker(t,t.points[i[r]],t.points[i[r]].symbolLocations[0],null,!0),t.marker.dataLabel.visible&&t.chart.dataLabelModule&&(t.chart.dataLabelModule.commonId=t.chart.element.id+"_Series_"+t.index+"_Point_",t.chart.dataLabelModule.renderDataLabel(t,t.points[i[r]],null,t.marker.dataLabel))},e.prototype.doAnimation=function(t){var i=t.animation;this.doLinearAnimation(t,i)},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"StackingLineSeries"},e}(Jm),IF=function(){function o(){}return o.prototype.render=function(e,t,i,r){e.isRectSeries=!1;for(var n=e.marker,s=this.enableComplexProperty(e),a=e.chart.chartAreaType==="PolarRadar"?Bc:jn,l={width:this.isLineShapeMarker(n.shape)?e.width:e.border.width,color:this.isLineShapeMarker(n.shape)?e.interior:e.border.color},h=0,u=s;h<u.length;h++){var c=u[h];this.renderPoint(e,c,r,a,l,s)}},o.prototype.renderPoint=function(e,t,i,r,n,s){var a=e.chart.redraw,l,h=a&&t.symbolLocations?t.symbolLocations[0]:null;t.symbolLocations=[],t.regions=[],t.visible&&ul(s[t.index-1],t,s[t.index+1],e)&&(l={cancel:!1,name:Zl,series:e,point:t,fill:e.setPointColor(t,e.interior),border:e.setBorderColor(t,{width:n.width,color:n.color}),height:e.marker.height,width:e.marker.width,shape:e.marker.shape},e.chart.trigger(Zl,l),l.cancel?t.marker={visible:!0}:(t.symbolLocations.push(r(t.xValue,t.yValue,e.xAxis,e.yAxis,i,e)),t.color=l.fill,this.refresh(e,t,l,h)))},o.prototype.updateDirection=function(e,t,i){for(var r=e.marker,n=this.enableComplexProperty(e),s=e.chart.chartAreaType==="PolarRadar"?Bc:jn,a={width:this.isLineShapeMarker(r.shape)?e.width:e.border.width,color:this.isLineShapeMarker(r.shape)?e.interior:e.border.color},l=0;l<t.length;l++)this.renderPoint(e,e.points[t[l]],i,s,a,n),e.marker.dataLabel.visible&&e.chart.dataLabelModule&&(e.chart.dataLabelModule.commonId=e.chart.element.id+"_Series_"+e.index+"_Point_",e.chart.dataLabelModule.renderDataLabel(e,e.points[t[l]],null,e.marker.dataLabel))},o.prototype.isLineShapeMarker=function(e){return e==="HorizontalLine"||e==="VerticalLine"||e==="Cross"},o.prototype.enableComplexProperty=function(e){for(var t=[],i=[],r=e.yAxis.visibleRange,n=e.xAxis.visibleRange,s=e.clipRect,a=e.points,l=Math.abs(r.delta/s.height),h=Math.abs(n.delta/s.width),u=a[0]&&a[0].y>l?0:l,c=a[0]&&a[0].x>h?0:h,d=0,p=0,f=0,v=a;f<v.length;f++){var m=v[f];m.symbolLocations||(m.symbolLocations=[]),d=m.yValue?m.yValue:r.min,p=m.xValue?m.xValue:n.min,(Math.abs(u-d)>=l||Math.abs(c-p)>=h)&&(i.push(m),u=d,c=p)}for(var y,S=0;S<i.length;S++)y=i[S],!(g(y.x)||y.x==="")&&t.push(y);return t},o.prototype.refresh=function(e,t,i,r){var n=e.chart,s,a,l=e.marker,h=i.point.marker.imageUrl||l.imageUrl,u=new Ir(n.element.id+"_Series_"+e.index+"_Point_"+t.index,i.fill,i.border.width,e.chart.enableCanvas&&!i.border.color?i.fill:i.border.color,e.opacity,e.border.dashArray);if(n.redraw&&ce(u.id)){s=i.shape==="Circle"?"c":"",a=ce(u.id).getAttribute("d");var c=ce(u.id);r={x:+c.getAttribute(s+"x"),y:+c.getAttribute(s+"y")}}var d=zs(t.symbolLocations[0],i.shape,new _t(i.width,i.height),h,u,t.x.toString()+":"+t.yValue.toString(),e.chart.renderer,e.clipRect);vt(e.chart.enableCanvas,e.seriesElement,d,n.redraw,!0,s+"x",s+"y",r,a,!1,!1,null,n.duration,!0),t.regions.push(new Ae(t.symbolLocations[0].x-l.width,t.symbolLocations[0].y-l.height,2*l.width,2*l.height)),t.marker={border:i.border,fill:i.fill,height:i.height,visible:!0,width:i.width,shape:i.shape,imageUrl:h}},o.prototype.doAnimation=function(e){for(var t=e.animation.duration,i=e.animation.delay,r=e.seriesElement.childNodes,n=1,s=0,a=e.points;s<a.length;s++){var l=a[s];!l.symbolLocations.length||!r[n]||(zc(r[n],i,t,e,l.index,l.symbolLocations[0],!1),n++)}},o.prototype.getModuleName=function(){return"ScatterSeries"},o.prototype.destroy=function(){},o}();var MF=function(){function o(e){this.selectionStyle=[],this.control=e}return o.prototype.seriesStyles=function(){var e,t=document.getElementById(this.styleId),i="{}",r,n,s=this.control.selectionPattern,a=this.control.highlightPattern;if(this.styleId.indexOf("highlight")>0&&this.control.highlightColor!==""||g(t)||s!=="None"||a!=="None"){document.getElementById(this.styleId)&&document.getElementById(this.styleId).remove(),t=this.control.createElement("div"),t.setAttribute("id",this.styleId);for(var l=0,h=this.control.visibleSeries;l<h.length;l++){var u=h[l],c=this.control.visibleSeries[u.index]||this.control.visibleSeries[u.index];if(this.styleId.indexOf("highlight")>0&&this.control.highlightColor!==""||(!g(s)||!g(a))&&(s!=="None"||a!=="None")){var d=this.styleId.indexOf("highlight")>0?a:s;if((c.type==="Pie"||c.type==="Funnel"||c.type==="Pyramid"||this.control.getModuleName()==="circularchart3d")&&this.control.highlightColor!=="transparent")for(var p=0;p<c.points.length;p++)n=c.opacity,r=this.pattern(this.control,this.styleId.indexOf("highlight")>0&&this.control.highlightColor!==""?this.control.highlightColor:c.points[p].color,u.points[p].index,d,n),i="{ fill:"+r+"}",e=u.selectionStyle||this.styleId+"_series_"+u.index+"_point_"+u.points[p].index+",."+this.styleId+"_series_"+u.index+"_point_"+u.points[p].index+"> *",this.control.highlightMode==="None"&&this.control.legendSettings.enableHighlight&&!u.isRectSeries&&(t.innerText+="."+this.styleId+"_series_"+u.index+"> * { stroke-width:3;} ",this.selectionStyle.push([this.styleId+"_series_"+u.index,"stroke-width","3"])),i=i.indexOf("None")>-1?"{fill:"+(this.styleId.indexOf("highlight")>0&&this.control.highlightColor!==""?this.control.highlightColor:c.points[p].color)+"!important}":i,this.selectionStyle.push([this.styleId+"_series_"+u.index+"_point_"+u.points[p].index,"fill",r?r.indexOf("None")>-1?this.styleId.indexOf("highlight")>-1?this.control.highlightColor:"":r:""]);else c.type&&this.control.highlightColor!=="transparent"&&(n=c.opacity,r=this.pattern(this.control,this.styleId.indexOf("highlight")>0&&this.control.highlightColor!==""?this.control.highlightColor:c.pointColorMapping!==""||this.control.rangeColorSettings&&this.control.rangeColorSettings.length>1?c.points[0].color:c.interior,u.index,d,n),i="{ fill:"+r+"}")}e=u.selectionStyle||this.styleId+"_series_"+u.index+",."+this.styleId+"_series_"+u.index+"> *",this.control.highlightMode==="None"&&this.control.legendSettings.enableHighlight&&!u.isRectSeries&&this.selectionStyle.push([this.styleId+"_series_"+u.index,"stroke-width",(parseFloat(u.width?u.width.toString():"0")+1).toString()]),i=i.indexOf("None")>-1?"{}":i,this.selectionStyle.push([this.styleId+"_series_"+u.index,"fill",r?r.indexOf("None")>-1?this.styleId.indexOf("highlight")>-1?this.control.highlightColor:"":r:""])}var f=this.control.highlightColor!=="transparent"?this.control.getModuleName()==="circularchart3d"?.2:.3:n;g(this.control.selectionModule)&&this.control.selectionMode==="None"&&this.control.highlightColor!==""&&(f=1),this.selectionStyle.push([this.unselected,"opacity",f.toString()]),this.control.element.appendChild(t)}},o.prototype.pattern=function(e,t,i,r,n){var s="#ffffff",a=e.svgObject,l=[],h={id:e.element.id+"_"+r+"_Selection_"+i,patternUnits:"userSpaceOnUse"},u="height",c="width",d=10,p=12,f=6,v=17,m=1,y=21,S=9,b=18,w=1,I=20;switch(r){case"Dots":h[u]=h[c]=f,h[c]=f,l[0]={x:0,y:0,width:7,height:7,transform:"translate(0,0)",fill:s,opacity:n,name:"rect"},l[1]={cx:3,cy:3,r:2,"stroke-width":1,fill:t,name:"circle"};break;case"Pacman":h[u]="18.384",h[c]="17.917",l[0]={name:"rect",x:0,y:0,width:17.917,height:18.384,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"path",d:"M9.081,9.194l5.806-3.08c-0.812-1.496-2.403-3.052-4.291-3.052H8.835C6.138,3.063,3,6.151,3,8.723v1.679   c0,2.572,3.138,5.661,5.835,5.661h1.761c2.085,0,3.835-1.76,4.535-3.514L9.081,9.194z","stroke-width":1,stroke:t,fill:t};break;case"Chessboard":h[u]=h[c]=d,l[0]={x:0,y:0,width:d,height:d,fill:s,opacity:n,name:"rect"},l[1]={x:0,y:0,width:5,height:5,fill:t,opacity:n,name:"rect"},l[2]={x:5,y:5,width:5,height:5,fill:t,opacity:n,name:"rect"};break;case"Crosshatch":h[u]=h[c]="8",l[0]={x:0,y:0,width:8,height:8,transform:"translate(0,0)",fill:s,opacity:n,name:"rect"},l[1]={d:"M0 0L8 8ZM8 0L0 8Z","stroke-width":1,stroke:t,name:"path"};break;case"DiagonalForward":h[u]=h[c]=f,l[0]={x:0,y:0,width:f,height:f,transform:"translate(0,0)",fill:s,opacity:n,name:"rect"},l[1]={d:"M 3 -3 L 9 3 M 6 6 L 0 0 M 3 9 L -3 3","stroke-width":2,stroke:t,name:"path"};break;case"DiagonalBackward":h[u]=h[c]=f,l[0]={x:0,y:0,width:f,height:f,transform:"translate(0,0)",fill:s,opacity:n,name:"rect"},l[1]={d:"M 3 -3 L -3 3 M 0 6 L 6 0 M 9 3 L 3 9","stroke-width":2,stroke:t,name:"path"};break;case"Grid":h[u]=h[c]=f,l[0]={name:"rect",x:0,y:0,width:f,height:f,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"path",d:"M1 3.5L11 3.5 M0 3.5L11 3.5 M0 7.5L11 7.5 M0 11.5L11 11.5 M5.5 0L5.5 12 M11.5 0L11.5 12Z","stroke-width":1,stroke:t};break;case"Turquoise":h[u]=h[c]=v,l[0]={name:"rect",x:0,y:0,width:v,height:v,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"path",d:"M0.5739999999999998,2.643a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":m,"stroke-miterlimit":d,stroke:t,fill:t},l[2]={name:"path",d:"M11.805,2.643a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":m,"stroke-miterlimit":d,stroke:t,fill:t},l[3]={name:"path",d:"M6.19,2.643a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":m,"stroke-miterlimit":d,stroke:t,fill:t},l[4]={name:"path",d:"M11.805,8.217a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":m,"stroke-miterlimit":d,stroke:t,fill:t},l[5]={name:"path",d:"M6.19,8.217a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":m,"stroke-miterlimit":d,stroke:t,fill:t},l[6]={name:"path",d:"M11.805,13.899a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":m,"stroke-miterlimit":d,stroke:t,fill:t},l[7]={name:"path",d:"M6.19,13.899a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":m,"stroke-miterlimit":d,stroke:t,fill:t};break;case"Star":h[u]=h[c]=y,l[0]={name:"rect",x:0,y:0,width:y,height:y,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"path",d:"M15.913,18.59L10.762 12.842 5.613 18.75 8.291 11.422 0.325 9.91 8.154 8.33 5.337 0.91 10.488 6.658 15.637 0.75 12.959 8.078 20.925 9.59 13.096 11.17 z","stroke-width":1,stroke:t,fill:t};break;case"Triangle":h[u]=h[c]=d,l[0]={name:"rect",x:0,y:0,width:d,height:d,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"path",d:"M4.987,0L7.48 4.847 9.974 9.694 4.987 9.694 0 9.694 2.493 4.847 z","stroke-width":1,stroke:t,fill:t};break;case"Circle":h[u]=h[c]=S,l[0]={name:"rect",x:0,y:0,width:S,height:S,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"circle",cx:5.125,cy:3.875,r:3.625,"stroke-width":1,fill:t};break;case"Tile":h[u]=h[c]=b,l[0]={name:"rect",x:0,y:0,width:b,height:b,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"path",d:"M0,9L0 0 9 0 z","stroke-width":w,stroke:t,fill:t},l[2]={name:"path",d:"M9,9L9 0 18 0 z","stroke-width":w,stroke:t,fill:t},l[3]={name:"path",d:"M0,18L0 9 9 9 z","stroke-width":w,stroke:t,fill:t},l[4]={name:"path",d:"M9,18L9 9 18 9 z","stroke-width":w,stroke:t,fill:t};break;case"HorizontalDash":h[u]=h[c]=p,l[0]={name:"rect",x:0,y:0,width:p,height:p,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"path",d:"M0,1.5 L10 1.5 M0,5.5 L10 5.5 M0,9.5 L10 9.5 z","stroke-width":1,stroke:t,fill:t};break;case"VerticalDash":h[u]=h[c]=p,l[0]={name:"rect",x:0,y:0,width:p,height:p,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"path",d:"M1.5,0 L1.5 10 M5.5,0 L5.5 10 M9.5,0 L9.5 10 z","stroke-width":1,stroke:t,fill:t};break;case"Rectangle":h[u]=h[c]=p,l[0]={name:"rect",width:p,height:p,fill:s,opacity:n},l[1]={name:"rect",x:1,y:2,width:4,height:9,fill:t,opacity:n},l[2]={name:"rect",x:7,y:2,width:4,height:9,fill:t,opacity:n};break;case"Box":h[u]=h[c]=d,l[0]={name:"rect",width:13,height:13,fill:s,opacity:n},l[1]={name:"rect",x:1.5,y:1.5,width:d,height:9,fill:t,opacity:n};break;case"HorizontalStripe":h[u]=p,h[c]=d,l[0]={name:"rect",x:0,y:0,width:d,height:p,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"path",d:"M0,0.5 L10 0.5 M0,4.5 L10 4.5 M0,8.5 L10 8.5 z","stroke-width":1,stroke:t,fill:t};break;case"VerticalStripe":h[u]=d,h[c]=p,l[0]={name:"rect",x:0,y:0,width:p,height:d,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"path",d:"M0.5,0 L0.5 10 M4.5,0 L4.5 10 M8.5,0 L8.5 10 z","stroke-width":1,stroke:t,fill:t};break;case"Bubble":h[u]=h[c]=I,l[0]={name:"rect",x:0,y:0,width:I,height:I,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"circle",cx:5.217,cy:11.325,r:3.429,"stroke-width":1,fill:"#D0A6D1"},l[2]={name:"circle",cx:13.328,cy:6.24,r:4.884,"stroke-width":1,fill:t},l[3]={name:"circle",cx:13.277,cy:14.66,r:3.018,"stroke-width":1,fill:"#D0A6D1"};break}var x=e.svgRenderer||e.renderer,M=x.createPattern(h,"pattern");return this.loadPattern(e,l,M,x),a.appendChild(M),"url(#"+e.element.id+"_"+r+"_Selection_"+i+")"},o.prototype.loadPattern=function(e,t,i,r){var n;for(n=0;n<t.length;n++){var s=r.createPattern(t[n],t[n].name);i.appendChild(s)}},o.prototype.concatIndexes=function(e,t){return e.concat(t)},o.prototype.checkVisibility=function(e,t){if(t===void 0&&(t=null),!e)return!1;for(var i=!1,r=[],n=0,s=e;n<s.length;n++){var a=s[n];r.indexOf(a.series)===-1&&r.push(a.series)}for(var l=0,h=r;l<h.length;l++){var a=h[l];if(t!=null&&t.rangeColorSettings&&t.rangeColorSettings.length>0&&t.rangeColorSettings[0].colors.length>0){if(this.control.series[0].visible){i=!0;break}}else if(this.control.visibleSeries[a].visible){i=!0;break}}return i},o.prototype.addSvgClass=function(e,t){var i=e.getAttribute("class")||"";i+=i!==""?" ":"";var r=e.id.indexOf("datalabel")>-1||e.id.indexOf("Text")>-1||e.id.indexOf("TextShape")>-1;if(i.indexOf(t)===-1){e.setAttribute("class",i+t);var n=this.selectionStyle;if(t&&t.indexOf("highlight")!==-1&&(this.control.getModuleName()==="chart"&&this.control.highlightModule?n=this.control.highlightModule.selectionStyle:this.control.getModuleName()==="accumulationchart"&&this.control.accumulationHighlightModule?n=this.control.accumulationHighlightModule.selectionStyle:this.control.getModuleName()==="chart3d"&&this.control.highlight3DModule?n=this.control.highlight3DModule.selectionStyle:this.control.getModuleName()==="circularchart3d"&&this.control.circularChartHighlight3DModule&&(n=this.control.circularChartHighlight3DModule.selectionStyle)),e.tagName.toLowerCase()==="g")e.querySelectorAll("*").forEach(function(u){for(var c=0;c<n.length;c++){var d=n[c],p=d[0],f=u.getAttribute("class")?u.getAttribute("class"):"";(p===t||p.indexOf(t)!==-1)&&f.indexOf("selection")===-1&&(d[1]==="fill"&&d[2]&&!r&&(u.style.fill=d[2]),d[1]==="opacity"&&d[2]&&(u.style.opacity=d[2],u.style.fill=""),d[1]==="stroke-width"&&d[2]&&(u.style.strokeWidth=d[2]))}});else for(var s=0;s<n.length;s++){var a=n[s],l=a[0],h=e.getAttribute("class")?e.getAttribute("class"):"";(l===t||l.indexOf(t)!==-1)&&(t.indexOf("highlight")===-1||h.indexOf("selection")===-1)&&(a[1]==="fill"&&a[2]&&!r&&(e.style.fill=a[2]),a[1]==="opacity"&&a[2]&&(e.style.opacity=a[2],e.style.fill=""),a[1]==="stroke-width"&&a[2]&&e.id.indexOf("legend_shape")===-1&&(e.style.strokeWidth=a[2]))}}},o.prototype.removeSvgClass=function(e,t){var i=e.getAttribute("class")||"";if(i.indexOf(t)>-1){e.setAttribute("class",i.replace(t,"").trim());var r=this.selectionStyle;if(t&&t.indexOf("highlight")!==-1&&(this.control.getModuleName()==="chart"&&this.control.highlightModule?r=this.control.highlightModule.selectionStyle:this.control.getModuleName()==="accumulationchart"&&this.control.accumulationHighlightModule?r=this.control.accumulationHighlightModule.selectionStyle:this.control.getModuleName()==="chart3d"&&this.control.highlight3DModule?r=this.control.highlight3DModule.selectionStyle:this.control.getModuleName()==="circularchart3d"&&this.control.circularChartHighlight3DModule&&(r=this.control.circularChartHighlight3DModule.selectionStyle)),e.tagName.toLowerCase()==="g")e.querySelectorAll("*").forEach(function(h){for(var u=0;u<r.length;u++){var c=r[u],d=c[0],p=h.getAttribute("class")?h.getAttribute("class"):"";(d===t||d.indexOf(t)!==-1)&&p.indexOf("selection")===-1&&(c[1]==="fill"&&c[2]&&(h.style.fill=""),c[1]==="opacity"&&c[2]&&(h.style.opacity=""),c[1]==="stroke-width"&&c[2]&&(h.style.strokeWidth=""))}});else for(var n=0;n<r.length;n++){var s=r[n],a=s[0],l=e.getAttribute("class")?e.getAttribute("class"):"";(a===t||a.indexOf(t)!==-1)&&(t.indexOf("highlight")===-1||l.indexOf("selection")===-1)&&(s[1]==="fill"&&s[2]&&(e.style.fill=""),s[1]==="opacity"&&s[2]&&(e.style.opacity=""),s[1]==="stroke-width"&&s[2]&&(e.style.strokeWidth=""))}}},o.prototype.getChildren=function(e){for(var t=[],i=0;i<e.childNodes.length;i++)e.childNodes[i].tagName!=="defs"&&t.push(e.childNodes[i]);return t},o}(),WW=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),qW=function(o){WW(e,o);function e(t){var i=o.call(this,t)||this;i.isdrawRect=!0,i.multiDataIndexes=[],i.pathIndex=0,i.seriesIndex=0,i.count=-1,i.dragRectArray=[],i.filterArray=[],i.totalSelectedPoints=[],i.chart=t,i.renderer=t.renderer;var r=t.selectionMode;return i.isMultiDrag=t.isMultiSelect&&r.indexOf("Drag")>-1,i.addEventListener(),i}return e.prototype.addEventListener=function(){if(!(this.chart.isDestroyed||this.chart.stockChart&&this.chart.stockChart.onPanning)){var t=B.isPointer?"pointerleave":"mouseleave";this.chart.on(B.touchMoveEvent,this.mouseMove,this),this.chart.on(t,this.mouseLeave,this),this.chart.on("click",this.mouseClick,this),this.chart.on(B.touchStartEvent,this.mousedown,this),this.chart.on(B.touchEndEvent,this.mouseLeave,this)}},e.prototype.mousedown=function(t){var i=this.chart;i.isPointMouseDown||i.selectionMode==="None"||i.isChartDrag||(i.isDoubleTap||!i.isTouch||this.rectPoints)&&this.dragStart(i,i.chartAxisLayoutPanel.seriesClipRect,i.mouseDownX,i.mouseDownY,t)},e.prototype.removeEventListener=function(){this.chart.isDestroyed||(this.chart.off(B.touchMoveEvent,this.mouseMove),this.chart.off("pointerleave",this.mouseLeave),this.chart.off("click",this.mouseClick),this.chart.off(B.touchStartEvent,this.mousedown),this.chart.off(B.touchEndEvent,this.mouseLeave))},e.prototype.initPrivateVariables=function(t){this.styleId=t.element.id+"_ej2_chart_selection",this.unselected=t.element.id+"_ej2_deselected",this.closeIconId=t.element.id+"_ej2_drag_close",this.draggedRectGroup=t.element.id+"_ej2_drag_group",this.multiRectGroup=t.element.id+"_ej2_drag_multi_group",this.draggedRect=t.element.id+"_ej2_drag_rect",this.lassoPath=t.element.id+"_ej2_drag_path",this.selectedDataIndexes=[],this.rectPoints=null,this.isSeriesMode=t.selectionMode==="Series"},e.prototype.invokeSelection=function(t){this.initPrivateVariables(t),this.series=he({},t.visibleSeries,null,!0),this.seriesStyles(),this.currentMode=t.selectionMode,t.selectionMode.indexOf("Drag")>-1||this.selectDataIndex(t,this.concatIndexes(t.selectedDataIndexes,this.selectedDataIndexes))},e.prototype.generateStyle=function(t){return t?(this.styleId.indexOf("selection")>1&&this.chart.selectionMode!=="None"&&(this.unselected=t.unSelectedStyle||this.unselected),this.styleId.indexOf("highlight")>0&&(this.chart.highlightMode!=="None"||this.chart.legendSettings.enableHighlight)&&(this.unselected=t.nonHighlightStyle||this.unselected),t.selectionStyle||this.styleId+"_series_"+t.index):"undefined"},e.prototype.selectDataIndex=function(t,i){for(var r=0,n=i;r<n.length;r++){var s=n[r];this.performSelection(s,t,this.getElementByIndex(t,s,"",this.series[s.series].marker.visible)[0])}},e.prototype.getElementByIndex=function(t,i,r,n,s){r===void 0&&(r="");var a=t.element.id+"_Series_"+i.series+"_Point_"+i.point,l=t.series[i.series];return a=l.type!=="Scatter"&&l.type!=="Bubble"&&n?a+"_Symbol"+r:a,!n&&s?[ce(a+"_Text_0"+r),ce(a+"_TextShape_0"+r)]:[ce(a),(l.type==="RangeArea"||l.type==="SplineRangeArea"||l.type==="RangeStepArea")&&l.marker.visible?ce(a+"1"):null]},e.prototype.getClusterElements=function(t,i){for(var r=[],n,s,a=0,l=t.visibleSeries;a<l.length;a++){var h=l[a];if(h.visible){i=new Wh(h.index,i.point),h.isRectSeries&&r.push(this.getElementByIndex(t,i)[0]),r.push(this.getElementByIndex(t,i,"",h.marker.visible)[0]);var u=document.getElementById(t.element.id+"_Series_"+h.index+"_Point_"+i.point+"_Text_0"),c=document.getElementById(t.element.id+"_Series_"+h.index+"_Point_"+i.point+"_TextShape_0");u&&r.push(u),c&&r.push(c),n=this.generateStyle(t.visibleSeries[i.series]),s=document.querySelectorAll("."+n),this.findTrackballElements(s,n);var d=h.marker.visible&&h.isRectSeries?2:1;d+=u&&c?2:u||c?1:0,!t.isMultiSelect&&s.length>0&&s[0].id!==(r[r.length-d]?r[r.length-d].id:"")&&this.removeSelection(t,i.series,s,n,!0)}}return r},e.prototype.findTrackballElements=function(t,i){for(var r,n,s=0;s<t.length;s++)if(!g(t[s])&&(r=g(t[s].parentNode)?[]:[].slice.call(t[0].parentNode.querySelectorAll("."+i)),r.length>0)){n=[];for(var a=0;a<r.length;a++)r[a].id.indexOf("Trackball")>-1&&n.push(r[a]);this.removeStyles(n)}},e.prototype.findElements=function(t,i,r,n,s,a){return n===void 0&&(n=""),this.isSeriesMode?this.getSeriesElements(i):this.currentMode==="Cluster"?this.getClusterElements(t,r):this.getElementByIndex(t,r,n,s,a)},e.prototype.isAlreadySelected=function(t,i){if(i==="click"?(this.currentMode=this.chart.selectionMode,this.styleId=this.chart.element.id+(this.chart.selectionModule&&this.chart.selectionMode!=="None"?"_ej2_chart_selection":"_ej2_chart_highlight")):(i==="mousemove"||i==="pointermove")&&(this.currentMode=this.chart.highlightMode,this.highlightDataIndexes=[],this.styleId=this.chart.element.id+"_ej2_chart_highlight"),this.chart.highlightMode!=="None"&&this.chart.selectionMode==="None"&&i==="click")return!1;if((this.chart.highlightMode!=="None"||this.chart.legendSettings.enableHighlight)&&this.previousSelectedEle&&this.previousSelectedEle[0]){var r=t.parentNode?t.parentNode.id:"",n=void 0;t.parentNode&&(n=r.indexOf("SeriesGroup")>0||r.indexOf("SymbolGroup")>0);for(var s=0;s<this.previousSelectedEle.length;s++)if(this.previousSelectedEle[s]&&this.previousSelectedEle[s].hasAttribute("class"))if(this.previousSelectedEle[s].getAttribute("class").indexOf("highlight")>-1&&(n||i==="click")){if(this.previousSelectedEle[s].removeAttribute("class"),this.previousSelectedEle[s].id.indexOf("Group")>0)for(var a=0;a<this.previousSelectedEle[s].children.length;a++)this.chart.highlightColor!==""&&!g(this.chart.highlightColor)&&this.chart.highlightPattern==="None"&&this.previousSelectedEle[s].children[a].setAttribute("fill",this.previousSelectedEle[s].children[a].id.indexOf("Text")>-1||this.previousSelectedEle[s].children[a].id.indexOf("TextShape")>-1?this.previousSelectedEle[s].children[a].getAttribute("fill"):this.control.visibleSeries[this.indexFinder(this.previousSelectedEle[s].id).series].interior),this.previousSelectedEle[s].children[a].removeAttribute("style");else this.chart.highlightColor!==""&&!g(this.chart.highlightColor)&&this.chart.highlightPattern==="None"&&this.previousSelectedEle[s].setAttribute("fill",this.previousSelectedEle[s].id.indexOf("Text")>-1||this.previousSelectedEle[s].id.indexOf("TextShape")>-1?this.previousSelectedEle[s].getAttribute("fill"):this.control.visibleSeries[this.indexFinder(this.previousSelectedEle[s].id).series].interior),this.previousSelectedEle[s].removeAttribute("style");this.addOrRemoveIndex(this.highlightDataIndexes,this.indexFinder(this.previousSelectedEle[s].id))}else!n&&this.previousSelectedEle[s].getAttribute("class").indexOf("highlight")>-1&&this.performSelection(this.indexFinder(this.previousSelectedEle[s].id),this.chart,this.previousSelectedEle[s])}return!0},e.prototype.mouseClick=function(t){this.calculateSelectedElements(t.target,t.type,!0),this.chart.highlightModule&&this.chart.highlightModule.highlightDataIndexes&&this.chart.highlightModule.highlightDataIndexes.length>0&&t.target.id.indexOf("_chart_legend_")===-1&&t.target.id.indexOf("_Series_")===-1&&this.chart.isTouch&&B.isDevice&&this.removeLegendHighlightStyles()},e.prototype.calculateSelectedElements=function(t,i,r){if(!g(t)&&!(this.chart.selectionMode==="None"&&this.chart.highlightMode==="None"||t.id&&t.id.indexOf(this.chart.element.id+"_")===-1)&&!((i==="mousemove"||i==="pointermove")&&(t.hasAttribute("class")&&(t.getAttribute("class").indexOf("highlight")>-1||t.getAttribute("class").indexOf("selection")>-1)||!g(t.parentNode)&&t.parentNode.hasAttribute("class")&&(t.parentNode.getAttribute("class").indexOf("highlight")>0||t.parentNode.getAttribute("class").indexOf("selection")>0)))&&(this.isAlreadySelected(t,i),t.id&&t.id.indexOf("_Series_")>-1&&t.id.indexOf("_Text_")===-1)){var n=void 0;if(t.id.indexOf("_Trackball_1")>-1)n=ce(t.id.split("_Trackball_")[0]+"_Symbol"),n=g(n)?ce(t.id.split("_Trackball_")[0]):n;else if(t.id.indexOf("_Trackball_0")>-1)return null;this.performSelection(this.indexFinder(t.id),this.chart,n||t,r)}},e.prototype.performSelection=function(t,i,r,n){if(this.isSeriesMode=this.currentMode==="Series",i.visibleSeries[t.series].type==="BoxAndWhisker"&&r&&r.id===i.element.id+"_Series_"+t.series+"_Point_"+t.point+"_BoxPath"&&(r=r.parentNode),i.visibleSeries[t.series].type==="Area"&&(this.currentMode==="Point"||this.currentMode==="Cluster")&&r&&r.id===this.chart.element.id+"_Series_"+t.series){var s=this.generateStyle(i.series[t.series]),a=document.querySelectorAll("."+s);this.findTrackballElements(a,s),this.blurEffect(i.element.id,i.visibleSeries,!1,t.point)}switch(this.currentMode){case"Series":this.selection(i,t,this.getSeriesElements(i.series[t.series])),this.selectionComplete(i,t,this.currentMode),this.blurEffect(i.element.id,i.visibleSeries,!1,t.point);break;case"Point":if(!isNaN(t.point)&&r||!n&&isNaN(t.point)){var l=[];l.push(r);var h=this.chart.visibleSeries[t.series],u=i.element.id+"_Series_"+t.series+"_Point_"+t.point,c=document.getElementById(u+"_Text_0");h.marker.dataLabel.visible&&c!==null&&(l.push(c),l.push(document.getElementById(u+"_TextShape_0"))),l[0]!==null&&i.series[t.series].marker.visible&&(i.series[t.series].type.indexOf("Column")!==-1||i.series[t.series].type.indexOf("Bar")!==-1)&&(r.id.indexOf("_Symbol")===-1&&ce(r.id+"_Symbol")?l.push(ce(r.id+"_Symbol")):r.id.indexOf("_Symbol")!==-1&&ce(r.id.replace("_Symbol",""))&&l.push(ce(r.id.replace("_Symbol","")))),this.selection(i,t,!n&&isNaN(t.point)?this.getSeriesElements(i.series[t.series]):l),this.selectionComplete(i,t,this.currentMode),this.blurEffect(i.element.id,i.visibleSeries,!1,t.point)}break;case"Cluster":(!isNaN(t.point)||!n&&isNaN(t.point))&&(!n&&isNaN(t.point)?this.selection(i,t,this.getSeriesElements(i.series[t.series])):this.clusterSelection(i,t),this.selectionComplete(i,t,this.currentMode),this.blurEffect(i.element.id,i.visibleSeries,!1,t.point));break}},e.prototype.selectionComplete=function(t,i,r){var n,s,a,l=[],h,u;if(r==="Cluster")for(var c=0,d=t.visibleSeries;c<d.length;c++){var p=d[c];if(p.visible)for(var f=0;f<this.selectedDataIndexes.length;f++)s=t.isMultiSelect?this.selectedDataIndexes[f].point:i.point,a=p.index,n=p.points,!isNaN(s)&&s<n.length&&(h=p.type!=="RangeArea"||p.type.indexOf("SplineRangeArea")>-1||p.type.indexOf("RangeStepArea")>-1?n[s].yValue:n[s].regions[0].y,u=n[s].xValue,t.primaryXAxis.valueType==="Category"?u=n[s].x.toLocaleString():t.primaryXAxis.valueType==="DateTime"&&(u=new Date(n[s].xValue)),p.category!=="Indicator"&&l.push({x:u,y:h,seriesIndex:a,pointIndex:s}),(p.type==="RangeArea"||p.type==="SplineRangeArea"||p.type==="RangeStepArea")&&l.push({x:u,y:n[s].regions[0].y,seriesIndex:a,pointIndex:s}))}else if(r==="Series")if(t.isMultiSelect)for(var f=0;f<this.selectedDataIndexes.length;f++)a=this.selectedDataIndexes[f].series,this.selectedDataIndexes.length>0&&l.push({seriesIndex:a});else a=this.selectedDataIndexes.length>0?this.selectedDataIndexes[0].series:this.highlightDataIndexes&&this.highlightDataIndexes.length>0?this.highlightDataIndexes[0].series:0,(this.selectedDataIndexes.length>0||this.highlightDataIndexes&&this.highlightDataIndexes.length>0)&&l.push({seriesIndex:a});else if(r==="Point"){var v=[];this.styleId.indexOf("highlight")>-1?v=this.highlightDataIndexes:v=this.selectedDataIndexes;for(var f=0;f<v.length;f++){s=v[f].point,a=v[f].series;var p=t.series[a];n=p.points,isNaN(s)||(u=n[s].xValue,h=p.type!=="RangeArea"||p.type.indexOf("SplineRangeArea")>-1||p.type.indexOf("RangeStepArea")>-1?n[s].yValue:n[s].regions[0].y,t.primaryXAxis.valueType==="Category"?u=n[s].x.toLocaleString():t.primaryXAxis.valueType==="DateTime"&&(u=new Date(n[s].xValue)),l.push({x:u,y:h,seriesIndex:a,pointIndex:s}))}}var m={name:bN,selectedDataValues:l,cancel:!1,chart:t};t.trigger(bN,m)},e.prototype.selection=function(t,i,r){this.currentMode!=="Lasso"&&!t.isMultiSelect&&this.currentMode.indexOf("Drag")===-1&&this.styleId.indexOf("highlight")===-1&&t.selectionMode!=="None"&&this.removeMultiSelectElements(t,this.selectedDataIndexes,i,t.series);var n=this.rangeColorMappingEnabled()?0:i.series;if(!g(r[0])){t.visibleSeries[n].isRectSeries&&r[0].id&&(document.getElementById(r[0].id+"_Symbol")?r.push(ce(r[0].id+"_Symbol")):r[0].id.indexOf("SeriesGroup")!==-1&&document.getElementById(r[0].id.replace("SeriesGroup","SymbolGroup"))&&r.push(ce(r[0].id.replace("SeriesGroup","SymbolGroup"))));var s=void 0,a=r[0]&&(r[0].getAttribute("class")||"");a=a.replace("e-chart-focused","").trim();var l=r[0].parentNode&&(r[0].parentNode.getAttribute("class")||"");a!==""&&this.currentMode!=="Cluster"&&this.findTrackballElements(r,a),r[0]&&a.indexOf(this.getSelectionClass(r[0].id))>-1?this.removeStyles(r):r[0].parentNode&&l.indexOf(this.getSelectionClass(r[0].id))>-1?this.removeStyles([r[0].parentNode]):(this.previousSelectedEle=t.highlightMode!=="None"||t.legendSettings.enableHighlight?r:[],this.applyStyles(r),s=!0),this.styleId.indexOf("highlight")>0&&(t.highlightMode!=="None"||t.legendSettings.enableHighlight)?this.addOrRemoveIndex(this.highlightDataIndexes,i,s):this.addOrRemoveIndex(this.selectedDataIndexes,i,s)}},e.prototype.clusterSelection=function(t,i){this.selection(t,i,this.getClusterElements(t,new Wh(i.series,i.point)))},e.prototype.removeMultiSelectElements=function(t,i,r,n){for(var s,a=0;a<i.length;a++)s=n[i[a].series],(this.isSeriesMode&&!this.toEquals(i[a],r,this.isSeriesMode)||this.currentMode==="Cluster"&&!this.toEquals(i[a],r,!1)||!this.isSeriesMode&&this.toEquals(i[a],r,!0)&&!this.toEquals(i[a],r,!1))&&(this.removeStyles(this.findElements(t,s,i[a],"",!1)),s.marker.visible&&this.removeStyles(this.findElements(t,s,i[a],"",!0)),s.marker.dataLabel.visible&&this.removeStyles(this.findElements(t,s,i[a],"",!1,!0)),i.splice(a,1),a--)},e.prototype.blurEffect=function(t,i,r,n){r===void 0&&(r=!1),n===void 0&&(n=0);for(var s=this.checkVisibility(this.highlightDataIndexes,this.chart)||this.checkVisibility(this.selectedDataIndexes,this.chart),a=0,l=i;a<l.length;a++){var h=l[a],u=void 0,c=void 0;this.rangeColorMappingEnabled()?r===!1?(u=Object.keys(h.rangeColorPoints).indexOf(h.points[n].interior),c=h.points[n].interior):(u=n,c=document.getElementById(t+"_chart_legend_shape_"+n).getAttribute("fill")):(u=h.index,c=this.chart.visibleSeries[h.index].interior),h.visible&&(this.checkSelectionElements(ce(t+"SeriesGroup"+h.index),this.generateStyle(h),s,r,u,c),h.marker.dataLabel.visible&&!g(h.shapeElement)&&(this.checkSelectionElements(h.shapeElement,this.generateStyle(h),s,r,u,c),this.checkSelectionElements(h.textElement,this.generateStyle(h),s,r,u,c)),g(ce(t+"SymbolGroup"+h.index))||this.checkSelectionElements(ce(t+"SymbolGroup"+h.index),this.generateStyle(h),s,r,u,c))}},e.prototype.checkSelectionElements=function(t,i,r,n,s,a){n===void 0&&(n=!0),s===void 0&&(s=0),a===void 0&&(a="#D3D3D3");var l=this.isSeriesMode?t.childNodes||[t]:t.childNodes||t;this.chart.selectionMode!=="None"&&(this.chart.highlightMode!=="None"||this.chart.legendSettings.enableHighlight)&&(l=t.childNodes||t),this.chart.selectionMode==="Cluster"&&t.tagName.toLowerCase()==="text"&&t.id.indexOf("_Text_")>=0&&(l=[t]);for(var h,u,c,d=t,p=this.chart.visibleSeries[this.rangeColorMappingEnabled()?0:s].marker.dataLabel.visible&&(t.id.indexOf("Text")>-1||t.id.indexOf("TextShape")>-1)&&t.tagName!=="g",f=0;f<l.length&&!p;f++)h=l[f].getAttribute("class")||"",u=l[f].parentNode.getAttribute("class")||"",this.chart.selectionMode!=="None"&&(this.chart.highlightMode!=="None"||this.chart.legendSettings.enableHighlight)&&(i=h.indexOf("selection")>0||h.indexOf("highlight")>0?h:i,i=u.indexOf("selection")>0||u.indexOf("highlight")>0?u:i),h.indexOf(i)===-1&&u.indexOf(i)===-1&&r?this.addSvgClass(l[f],this.unselected):(d=l[f],this.removeSvgClass(l[f],this.unselected),this.removeSvgClass(l[f].parentNode,this.unselected),l[f].id!==""&&h.indexOf(this.unselected)!==-1&&u.indexOf(i)===-1&&this.highlightAnimation(l[f],this.chart.series.length===1?0:this.indexFinder(l[f].id).series,700,.3)),l[f].id.indexOf("Trackball")>0&&d.classList[0]===i&&(this.removeSvgClass(l[f],this.unselected),this.removeSvgClass(l[f].parentNode,this.unselected),this.addSvgClass(l[f],i));if(t.id.indexOf("Symbol")>-1&&t.querySelectorAll("."+i)[0]&&t.querySelectorAll("."+i)[0].getAttribute("class")===i){var v=ce(this.control.element.id+"_Series_"+t.id[t.id.length-1]),m=v&&v.hasAttribute("class")?v.getAttribute("class"):"";m.indexOf(this.unselected)>-1&&this.removeSvgClass(v,this.unselected)}if(this.control.legendModule&&this.control.legendSettings.visible&&this.control.legendSettings.visible&&!(n&&this.rangeColorMappingEnabled&&(t===this.control.visibleSeries[0].textElement||t===this.control.visibleSeries[0].shapeElement))&&(c=ce(this.control.element.id+"_chart_legend_shape_"+s),c)){c.hasAttribute("class")&&(this.removeSvgClass(c,c.getAttribute("class")),!g(this.chart.highlightColor&&this.chart.highlightColor!=="")&&!this.chart.legendSettings.enableHighlight&&(c.setAttribute("stroke",a),this.chart.highlightPattern==="None"&&c.setAttribute("fill",a))),h=d.getAttribute("class")||"",u=d.parentNode.getAttribute("class")||"",h.indexOf(i)===-1&&u.indexOf(i)===-1&&r?(this.addSvgClass(c,this.chart.highlightMode==="None"&&this.chart.legendSettings.enableHighlight&&(!this.chart.selectionModule||this.chart.selectionModule.selectedDataIndexes.length===0)?i:this.unselected),this.removeSvgClass(c,i),this.chart.highlightColor!==""&&!g(this.chart.highlightColor)&&(c.setAttribute("stroke",this.control.visibleSeries[s].interior),this.chart.highlightPattern==="None"&&c.setAttribute("fill",this.control.visibleSeries[s].interior))):(this.removeSvgClass(c,this.unselected),!g(this.chart.highlightColor)&&this.chart.highlightColor!==""&&(c.setAttribute("stroke",this.control.visibleSeries[s].interior),this.chart.highlightPattern==="None"&&c.setAttribute("fill",this.control.visibleSeries[s].interior)),h===""&&u===""||h.trim()==="EJ2-Trackball"?this.removeSvgClass(c,i):(this.addSvgClass(c,i),i.indexOf("highlight")>0&&this.chart.highlightColor!==""&&this.chart.highlightColor!=="transparent"&&!g(this.chart.highlightColor)&&(c.setAttribute("stroke",this.chart.highlightColor),this.styleId.indexOf("highlight")>0&&this.chart.highlightPattern==="None"&&c.setAttribute("fill",this.chart.highlightColor))));var y=void 0;if(this.rangeColorMappingEnabled())for(var f=0;f<this.chart.rangeColorSettings.length;f++)y=document.getElementById(this.chart.element.id+"_chart_legend_shape_"+f),c!==y?(this.addSvgClass(y,this.unselected),this.removeSvgClass(y,i)):n===!0&&this.addSvgClass(y,i),h.indexOf(i)===-1&&n===!1&&this.removeSvgClass(y,this.unselected);n&&u.indexOf(i)>-1&&this.addSvgClass(c,i)}},e.prototype.applyStyles=function(t){for(var i=0,r=t;i<r.length;i++){var n=r[i];if(n){if(this.removeSvgClass(n.parentNode,this.unselected),this.removeSvgClass(n,this.unselected),this.chart.series[0].pointColorMapping==="fill"||this.rangeColorMappingEnabled()){var s=this.getSelectionClass(n.id),a=s.indexOf("highlight")>-1?parseInt(s.split(this.chart.element.id+"_ej2_chart_highlight_series_")[1],10):parseInt(s.split(this.chart.element.id+"_ej2_chart_selection_series_")[1],10),l=this.styleId.indexOf("highlight")>0?this.chart.highlightPattern:this.chart.selectionPattern,h=void 0;if((s.indexOf("highlight")>-1||s.indexOf("selection")>-1)&&(h=document.getElementById(this.chart.element.id+"_"+l+"_Selection_"+a)),n.id.indexOf("legend")===-1&&n.id.indexOf("Text")===-1&&n.id.indexOf("TextShape")===-1&&n.id.indexOf("Group")===-1&&h!=null)for(var u=1;u<h.children.length;u++)h.children[u].setAttribute("fill",n.getAttribute("fill")),h.children[u].setAttribute("stroke",n.getAttribute("fill"))}if(this.addSvgClass(n,this.getSelectionClass(n.id)),n.id.indexOf("Group")>0)for(var c=this.indexFinder(n.id),u=0;u<n.children.length;u++)n.children[u].nodeName!=="defs"&&this.stopElementAnimation(n.children[u],c.series);if(this.styleId.indexOf("highlight")>0&&this.chart.highlightColor!==""&&!g(this.chart.highlightColor)&&this.chart.highlightPattern==="None"&&this.chart.highlightColor!=="transparent")if(n.id.indexOf("Group")>0)for(var u=0;u<n.children.length;u++)n.children[u].setAttribute("fill",n.id.indexOf("Text")>-1||n.id.indexOf("TextShape")>-1?n.children[u].getAttribute("fill"):this.chart.highlightColor);else n.setAttribute("fill",n.id.indexOf("Text")>-1||n.id.indexOf("TextShape")>-1?n.getAttribute("fill"):this.chart.highlightColor)}}},e.prototype.getSelectionClass=function(t){return this.generateStyle(this.control.visibleSeries[this.indexFinder(t).series])},e.prototype.removeStyles=function(t){for(var i=0,r=t;i<r.length;i++){var n=r[i];if(n&&(this.removeSvgClass(n,this.getSelectionClass(n.id)),this.chart.highlightPattern==="None"&&this.chart.highlightColor!==""&&!g(this.chart.highlightColor)&&this.chart.highlightColor!=="transparent"))if(n.id.indexOf("Group")>0)for(var s=0;s<n.children.length;s++)n.children[s].setAttribute("fill",n.id.indexOf("Text")>-1||n.id.indexOf("TextShape")>-1?n.children[s].getAttribute("fill"):this.control.visibleSeries[this.indexFinder(n.id).series].interior);else n.setAttribute("fill",n.id.indexOf("Text")>-1||n.id.indexOf("TextShape")>-1?n.getAttribute("fill"):this.control.visibleSeries[this.indexFinder(n.id).series].interior)}},e.prototype.addOrRemoveIndex=function(t,i,r){for(var n=0;n<t.length;n++)this.toEquals(t[n],i,this.isSeriesMode)&&(t.splice(n,1),n--);r&&t.push(i)},e.prototype.toEquals=function(t,i,r){return(t.series===i.series||this.currentMode==="Cluster"&&!r)&&(r||t.point===i.point)},e.prototype.redrawSelection=function(t,i,r){this.isSeriesMode=i==="Series",g(i)||(i.indexOf("Drag")!==-1||i==="Lasso"||r?t.isRedrawSelection=!1:t.isRedrawSelection=!0);var n=he([],this.selectedDataIndexes,null,!0),s=he([],this.highlightDataIndexes,null,!0);this.styleId.indexOf("highlight")>0&&s.length>0?(this.removeSelectedElements(t,this.highlightDataIndexes,t.series),n=s):this.removeSelectedElements(t,this.selectedDataIndexes,t.series),this.blurEffect(t.element.id,t.visibleSeries,!1),this.selectDataIndex(t,n)},e.prototype.legendSelection=function(t,i,r,n){if(n==="mousemove"){if(r.id.indexOf("text")>1&&(r=ce(r.id.replace("text","shape"))),r.id.indexOf("marker")>1&&(r=ce(r.id.replace("_marker",""))),r.id.indexOf("g")>1&&(r=ce(r.id.replace("_g_","_shape_"))),r.hasAttribute("class")&&(r.getAttribute("class").indexOf("highlight")>-1||r.getAttribute("class").indexOf("selection")>-1))return;this.currentMode=this.chart.highlightMode}var s=this.isAlreadySelected(r,n);if(s){var a=this.generateStyle(t.visibleSeries[i]),l=document.querySelectorAll("."+a);this.isSeriesMode=this.currentMode==="Series";var h=!0;if(l.length>0)this.removeSelection(t,i,l,a,h);else{for(var u=0,c=t.visibleSeries;u<c.length;u++){var d=c[u];d.index!==i&&!t.isMultiSelect&&(a=this.generateStyle(t.visibleSeries[d.index]),l=document.querySelectorAll("."+a),this.removeSelection(t,i,l,a,h))}var p=[];if(this.rangeColorMappingEnabled()){for(var f=0,v=t.visibleSeries[0].seriesElement.children;f<v.length;f++){var m=v[f];if(r.getAttribute("fill")===m.getAttribute("fill")){if(t.visibleSeries[0].marker.dataLabel.visible){var y=this.indexFinder(m.id).point;if(!isNaN(y)&&y>=0){var S=document.getElementById(this.chart.element.id+"_Series_0_Point_"+y+"_Text_0"),b=document.getElementById(this.chart.element.id+"_Series_0_Point_"+y+"_TextShape_0");S&&p.push(S),b&&p.push(b)}}p.push(m)}}for(var w=0,I=p;w<I.length;w++){var d=I[w];if(g(d))return;this.checkSelectionElements(d,a,!1,!0,i)}}else if(t.visibleSeries[i].visible){p=this.getSeriesElements(t.visibleSeries[i]);for(var x=0,M=p;x<M.length;x++){var D=M[x];if(g(D))return;this.checkSelectionElements(D,a,!1,!0,i)}}this.isSeriesMode=!0,this.selection(t,new Wh(i,NaN),p),this.isSeriesMode=t.selectionMode==="Series",this.blurEffect(t.element.id,t.visibleSeries,!0,i)}}},e.prototype.rangeColorMappingEnabled=function(){return!!(this.chart.rangeColorSettings&&this.chart.rangeColorSettings.length>0&&this.chart.visibleSeries.length===1&&this.chart.rangeColorSettings[0].colors.length>0&&(this.chart.series[0].type==="Column"||this.chart.series[0].type==="Bar"||this.chart.series[0].type==="Scatter"||this.chart.series[0].type==="Bubble"))},e.prototype.removeSelection=function(t,i,r,n,s){if(r.length>0){for(var a=[],l=0;l<r.length;l++)a.push(r[l]);this.removeStyles(a),this.isSeriesMode=!0,this.addOrRemoveIndex(this.selectedDataIndexes,new Wh(i,NaN));for(var h=0,u=t.visibleSeries;h<u.length;h++){var c=u[h];if(n=this.generateStyle(c),document.querySelectorAll("."+n).length>0){for(var d=0,p=a;d<p.length;d++){var f=p[d];this.checkSelectionElements(f,n,!0,!0,i)}s=!1;break}}s&&(this.isSeriesMode=t.selectionMode==="Series",this.blurEffect(t.element.id,t.visibleSeries))}},e.prototype.getSeriesElements=function(t){var i=[t.seriesElement];return(t.marker.visible&&t.type!=="Scatter"&&t.type!=="Bubble"&&!t.isRectSeries||t.marker.visible&&t.isRectSeries)&&i.push(t.symbolElement),t.marker.dataLabel.visible&&(i.push(t.textElement),i.push(t.shapeElement)),i},e.prototype.indexFinder=function(t){var i=["NaN","NaN"];return t.indexOf("SeriesGroup")>-1?(i=t.split("SeriesGroup"),i[0]=i[1]):t.indexOf("SymbolGroup")>-1?(i=t.split("SymbolGroup"),i[0]=i[1]):t.indexOf("_Point_")>-1?i=t.split("_Series_")[1].split("_Point_"):t.indexOf("_border_")>-1?i[0]=t.split("_border_")[1]:t.indexOf("_Series_")>-1?i[0]=t.split("_Series_")[1]:t.indexOf("_chart_legend_shape_")>-1?(i=t.split("_chart_legend_shape_"),i[0]=i[1]):t.indexOf("TextGroup")>-1?(i=t.split("TextGroup"),i[0]=i[1]):t.indexOf("ShapeGroup")>-1&&(i=t.split("ShapeGroup"),i[0]=i[1]),new Wh(parseInt(i[0],10),parseInt(i[1],10))},e.prototype.calculateDragSelectedElements=function(t,i,r){this.removeSelectedElements(t,this.selectedDataIndexes,t.series);var n=t.selectionMode==="Lasso",s=new Ae(i.x,i.y,i.width,i.height),a=new Je(t.chartAxisLayoutPanel.seriesClipRect.x,t.chartAxisLayoutPanel.seriesClipRect.y);this.removeOffset(s,a);var l,h,u=[],c=[];this.isSeriesMode=!1;var d=t.allowMultiSelection&&(this.rectGrabbing||this.resizing);if(this.rectPoints=this.dragRectArray[d?this.targetIndex:this.count]=new Ae(i.x,i.y,i.width,i.height),i.width&&i.height&&!r){var p=new Ae(i.x,i.y,i.width,i.height);this.removeOffset(p,a),this.filterArray[d?this.targetIndex:this.count]=p}for(var f=function(x){if(x.visible){l=x.points,u=[];var M,D;(t.isTransposed||x.type.indexOf("Bar")!==-1)&&!(t.isTransposed&&x.type.indexOf("Bar")!==-1)?(M=x.xAxis.rect.y-a.y,D=x.yAxis.rect.x-a.x):(M=x.xAxis.rect.x-a.x,D=x.yAxis.rect.y-a.y);for(var A=0;A<l.length;A++){var L=x.type!=="RangeArea"||x.type.indexOf("SplineRangeArea")>-1||x.type.indexOf("RangeStepArea")>-1?l[A].yValue:l[A].regions[0].y,T=void 0,k=l[A].xValue;t.primaryXAxis.valueType==="Category"?k=l[A].x.toLocaleString():t.primaryXAxis.valueType==="DateTime"&&(k=new Date(l[A].xValue)),x.type==="BoxAndWhisker"?T=l[A].regions.some(function(F){return Oi(F.x+M,F.y+D,s)}):t.selectionMode==="Lasso"?T=l[A].isSelect:T=t.allowMultiSelection?v.isPointSelect(l[A],M,D,v.filterArray):l[A].symbolLocations.some(function(F){return F&&Oi(F.x+M,F.y+D,s)}),T&&x.category!=="Indicator"&&(h=new Wh(x.index,l[A].index),v.selection(t,h,v.findElements(t,x,h,"",x.isRectSeries?!1:x.marker.visible)),u.push({x:k,y:L})),T&&(x.type==="RangeArea"||x.type==="SplineRangeArea"||x.type==="RangeStepArea")&&u.push({x:k,y:l[A].regions[0].y})}c.push(u)}},v=this,m=0,y=t.visibleSeries;m<y.length;m++){var S=y[m];f(S)}this.blurEffect(t.element.id,t.visibleSeries);var b=n?t.mouseDownX:i.x+i.width,w=n?t.mouseDownY:i.y;r||this.createCloseButton(b,w);var I={name:yN,selectedDataValues:c,cancel:!1};t.trigger(yN,I)},e.prototype.removeOffset=function(t,i){t.x-=i.x,t.y-=i.y},e.prototype.isPointSelect=function(t,i,r,n){for(var s=t.symbolLocations[0],a=0,l=n;a<l.length;a++){var h=l[a];if(h&&s&&Oi(s.x+i,s.y+r,h))return!0}return!1},e.prototype.drawDraggingRect=function(t,i){var r=t.chartAxisLayoutPanel.seriesClipRect,n=t.chartArea.border.width,s=t.themeStyle.selectionRectFill,a=t.themeStyle.selectionRectStroke,l=t.selectionMode==="Lasso";switch(this.isdrawRect&&(r.x=r.x-n/2,r.y=r.y-n/2,r.width=r.width+n,r.height=r.height+n,this.isdrawRect=!1),t.selectionMode){case"DragX":i.y=r.y,i.height=r.height;break;case"DragY":i.x=r.x,i.width=r.width;break}if((i.width<5||i.height<5)&&!l)return null;var h=t.selectionMode.indexOf("Drag")>-1||t.selectionMode==="Lasso";if(t.allowMultiSelection&&h){var u=void 0,c=void 0,d=ce(this.multiRectGroup);if(d||(d=t.svgRenderer.createGroup({id:this.multiRectGroup}),t.svgObject.appendChild(d)),this.rectGrabbing||this.resizing){var p=ce(this.draggedRect+this.targetIndex);p.nextSibling&&Ue(p.nextSibling),this.setAttributes(p,i)}else if(!ce(this.draggedRectGroup+this.count)){c=t.svgRenderer.createGroup({id:this.draggedRectGroup+this.count});var f=document.getElementById(t.element.id+"_series_svg");t.enableCanvas?f.appendChild(c):d.appendChild(c)}t.selectionMode!=="Lasso"?(u=t.svgRenderer.drawRectangle(new as(this.draggedRect+this.count,s,{color:a,width:1},1,i,0,0,"",t.theme.indexOf("Fluent2")<1?"3":"")),u.style.cursor="move"):u=t.svgRenderer.drawPath(new Ir(this.lassoPath+this.count,s,3,a,1,"",this.path)),!c&&!this.rectGrabbing&&!this.resizing?ce(this.draggedRectGroup+this.count).appendChild(u):!this.rectGrabbing&&!this.resizing&&c.appendChild(u)}else{var u=ce(l?this.lassoPath:this.draggedRect);if(this.closeIcon&&ni(this.closeIconId),u)l?u.setAttribute("d",this.path):this.setAttributes(u,i);else{var c=t.svgRenderer.createGroup({id:this.draggedRectGroup}),f=document.getElementById(t.element.id+"_series_svg");t.enableCanvas?f.appendChild(c):t.svgObject.appendChild(c),t.selectionMode!=="Lasso"?u=t.svgRenderer.drawRectangle(new as(this.draggedRect,s,{color:a,width:1},1,i,0,0,"",t.theme.indexOf("Fluent2")<1?"3":"")):u=t.svgRenderer.drawPath(new Ir(this.lassoPath,s,3,a,1,"",this.path)),c.appendChild(u)}}},e.prototype.getIndex=function(t){var i;for(i=t.length-1;i>0;i--){var r=Number(t[i]);if(isNaN(r))break}var n=+t.substr(i+1,t.length-1);return n},e.prototype.createCloseButton=function(t,i){var r=this.chart.allowMultiSelection,n=this.chart.themeStyle.selectionCircleStroke,s=this.rectGrabbing||this.resizing,a=this.chart.svgRenderer.createGroup({id:this.closeIconId+(r?s?this.targetIndex:this.count:""),style:"cursor:pointer; visibility: visible;"});a.appendChild(this.chart.svgRenderer.drawCircle(new $m(this.closeIconId+"_circle"+(r?s?this.targetIndex:this.count:""),"#FFFFFF",{color:n,width:1},1,t,i,10)));var l="M "+(t-4)+" "+(i-4)+" L "+(t+4)+" "+(i+4)+" M "+(t-4)+" "+(i+4)+" L "+(t+4)+" "+(i-4);a.appendChild(this.chart.svgRenderer.drawPath({id:this.closeIconId+"_cross"+(r?s?this.targetIndex:this.count:""),d:l,stroke:n,"stroke-width":2,fill:n})),this.closeIcon=a;var h=ce(this.draggedRectGroup+(r?s?this.targetIndex:this.count:""));h&&h.appendChild(a)},e.prototype.removeDraggedElements=function(t,i,r){if(i.id&&i.id.indexOf(this.closeIconId)>-1&&r.indexOf("move")===-1){var n=!0;if(t.allowMultiSelection){var s=this.getIndex(i.id),a=ce(this.multiRectGroup);if(Ue(ce(this.draggedRectGroup+s)),this.dragRectArray[s]=null,this.filterArray[s]=null,this.totalSelectedPoints[s]=null,a&&a.childElementCount===0&&(ni(a),this.dragRectArray=[],this.filterArray=[],this.totalSelectedPoints=[]),this.currentMode==="Lasso"){if(this.multiDataIndexes[s]!=null)for(var l=0;l<this.multiDataIndexes[s].length;l++)this.multiDataIndexes[s][l].isSelect=!1;this.multiDataIndexes[s]=null;for(var h=0;h<this.multiDataIndexes.length;h++)if(this.multiDataIndexes[h]!=null){n=!1;for(var u=0;u<this.multiDataIndexes[h].length;u++)this.multiDataIndexes[h][u].isSelect=!0}this.calculateDragSelectedElements(t,this.dragRect,!0)}else if(this.filterArray.length)for(var l=0;l<this.filterArray.length;l++)this.filterArray[l]&&(n=!1,this.calculateDragSelectedElements(t,this.filterArray[l],!0));else this.calculateDragSelectedElements(t,new Ae(0,0,0,0),!0)}else Ue(ce(this.draggedRectGroup)),this.removeSelectedElements(t,this.selectedDataIndexes,t.series);this.blurEffect(t.element.id,t.visibleSeries),this.changeCursorStyle(!1,t.svgObject,"auto"),(!t.allowMultiSelection||n)&&(this.rectPoints=null)}},e.prototype.resizingSelectionRect=function(t,i,r,n){var s;if(t.allowMultiSelection&&n.id.indexOf("_ej2_drag_rect")>-1||this.dragRectArray[this.targetIndex]){n.id.indexOf("_ej2_drag_rect")>-1&&(this.targetIndex=this.getIndex(n.id));var a=this.dragRectArray[this.targetIndex];s=new Ae(a.x,a.y,a.width,a.height)}if(t.allowMultiSelection||(s=new Ae(this.rectPoints.x,this.rectPoints.y,this.rectPoints.width,this.rectPoints.height)),s){var l=this.findResizeMode(t.svgObject,s,i);this.resizing&&(s=Uw(s.x,s.y,s.x+s.width,s.y+s.height,t.chartAxisLayoutPanel.seriesClipRect),this.drawDraggingRect(t,s),this.dragRect=s),r&&(this.resizing=l)}else return},e.prototype.findResizeMode=function(t,i,r){var n="se-resize",s=!1;if(this.resizing){var h=i.x,u=i.y,c=r.x-h,d=r.y-u;switch(this.resizeMode){case 0:d=Math.abs(i.height+i.y-r.y),i.y=Math.min(i.height+i.y,r.y),i.height=d;break;case 1:c=Math.abs(i.width+i.x-r.x),i.x=Math.min(i.width+i.x,r.x),i.width=c;break;case 2:i.height=Math.abs(d),i.y=Math.min(r.y,u);break;case 3:i.width=Math.abs(c),i.x=Math.min(r.x,h);break;case 4:i.width=Math.abs(c),i.height=Math.abs(d),i.x=Math.min(r.x,h),i.y=Math.min(r.y,u);break}}else for(var a=[new Ae(i.x,i.y,i.width-5,5),new Ae(i.x,i.y,5,i.height),new Ae(i.x,i.y+i.height-5,i.width-5,5),new Ae(i.x+i.width-5,i.y+5,5,i.height-15),new Ae(i.x+i.width-10,i.y+i.height-10,10,10)],l=0;l<a.length;l++)if(Oi(r.x,r.y,a[l])){n=l===4?n:l%2===0?"ns-resize":"ew-resize",s=!0,this.resizeMode=l;break}return this.currentMode!=="Lasso"&&this.changeCursorStyle(s,ce(this.chart.allowMultiSelection?this.draggedRect+this.targetIndex:this.draggedRect),n),this.changeCursorStyle(s,t,n),s},e.prototype.changeCursorStyle=function(t,i,r){r=t?r:this.control.svgObject===i?"auto":"move",i&&(i.style.cursor=r)},e.prototype.removeSelectedElements=function(t,i,r){i=t.isRedrawSelection?i:i.splice(0,i.length);for(var n,s=0,a=r;s<a.length;s++){var l=a[s];if(l.visible){n=this.getSeriesElements(l),this.removeStyles(n);for(var h=0,u=n;h<u.length;h++){var c=u[h];this.removeStyles(this.getChildren(c))}}}},e.prototype.setAttributes=function(t,i){for(var r=Object.keys(i),n=0,s=r;n<s.length;n++){var a=s[n];t.setAttribute(a,i[a])}},e.prototype.draggedRectMoved=function(t,i,r){var n;if((this.resizing||this.rectGrabbing)&&t.allowMultiSelection){var s=this.dragRectArray[this.targetIndex];n=new Ae(s.x,s.y,s.width,s.height)}else n=new Ae(this.rectPoints.x,this.rectPoints.y,this.rectPoints.width,this.rectPoints.height);n.x-=i.x-t.mouseX,n.y-=i.y-t.mouseY,n=Uw(n.x,n.y,n.x+n.width,n.height+n.y,t.chartAxisLayoutPanel.seriesClipRect),r?this.drawDraggingRect(t,n):this.calculateDragSelectedElements(t,n)},e.prototype.mouseLeave=function(t){this.completeSelection(t.target,t.type)},e.prototype.completeSelection=function(t,i){var r=this.chart;r.selectionMode!=="None"&&(this.currentMode=r.selectionMode,(this.dragging||this.resizing)&&this.dragRect.width>5&&this.dragRect.height>5?this.calculateDragSelectedElements(r,this.dragRect):!r.allowMultiSelection&&this.rectGrabbing&&this.rectPoints.width&&this.rectPoints.height?this.draggedRectMoved(r,this.dragRect):this.rectGrabbing&&this.dragRectArray[this.targetIndex].width&&this.dragRectArray[this.targetIndex].height&&this.draggedRectMoved(r,this.dragRect),r.selectionMode==="Lasso"&&this.dragging&&this.path&&this.path.indexOf("L")!==-1&&(r.allowMultiSelection?ce(this.lassoPath+this.count)&&(ce(this.lassoPath+this.count).setAttribute("d",this.path+"Z"),this.pointChecking(ce(this.lassoPath+this.count))):(ce(this.lassoPath).setAttribute("d",this.path+"Z"),this.pointChecking(ce(this.lassoPath))),(this.dragging||this.resizing)&&this.calculateDragSelectedElements(r,this.dragRect)),this.dragging=!1,this.rectGrabbing=!1,this.resizing=!1,this.removeDraggedElements(r,t,i))},e.prototype.getDragRect=function(t,i){return Uw(t.mouseDownX,t.mouseDownY,t.mouseX,t.mouseY,i)},e.prototype.dragStart=function(t,i,r,n,s){var a=t.selectionMode;this.currentMode=t.selectionMode,this.dragging=(a.indexOf("Drag")>-1||a==="Lasso")&&(t.isDoubleTap||!t.isTouch)&&t.chartAreaType!=="PolarRadar";var l=s.target;if(this.path=void 0,this.dragging&&(this.count=ce(this.multiRectGroup)?this.count+1:0,this.dragRect=new Ae(t.mouseDownX,t.mouseDownY,0,0),(t.mouseDownX<i.x||t.mouseDownX>i.x+i.width||t.mouseDownY<i.y||t.mouseDownY>i.y+i.height)&&(this.dragging=!1)),a==="Lasso")for(var h=0,u=t.visibleSeries;h<u.length;h++){var c=u[h];if(c.visible)for(var d=0,p=c.points;d<p.length;d++){var f=p[d];t.allowMultiSelection||(f.isSelect=!1)}}if(a!=="Lasso"&&(this.rectPoints&&!t.allowMultiSelection&&(this.dragRect=new Ae(t.mouseDownX,t.mouseDownY,0,0),this.resizingSelectionRect(t,new Je(r,n),!0),this.rectGrabbing=Oi(r,n,this.rectPoints)),t.allowMultiSelection)){var v=this.getIndex(l.id);this.targetIndex=this.isDragRect(l.id)?v:void 0,this.dragRectArray.length&&this.isDragRect(l.id)&&(this.resizingSelectionRect(t,new Je(r,n),!0,l),this.rectGrabbing=Oi(r,n,this.dragRectArray[v]))}},e.prototype.isDragRect=function(t){return t.indexOf("_ej2_drag_rect")>-1},e.prototype.mouseMove=function(t){var i=this.chart,r=t.target,n=t.type;this.highlightChart(r,n),i.selectionMode!=="None"&&(n==="touchmove"&&(B.isIos||B.isIos7)&&this.dragging&&t.preventDefault&&t.preventDefault(),this.selectionAndDrag(i,r,n))},e.prototype.highlightChart=function(t,i){if(this.chart.highlightMode!=="None"||this.chart.legendSettings.enableHighlight){if(!g(t)){if(t.id.indexOf("_legend_text")>1&&(t=ce(t.id.replace("text","shape"))),t.hasAttribute("class")&&(t.getAttribute("class").indexOf("highlight")>-1||t.getAttribute("class").indexOf("selection")>-1))return;this.calculateSelectedElements(t,i),this.chart.highlightModule.highlightDataIndexes&&this.chart.highlightModule.highlightDataIndexes.length>0&&t.id.indexOf("_chart_legend_g")===-1&&t.id.indexOf("_Series_")===-1?this.removeLegendHighlightStyles():this.chart.highlightModule.highlightDataIndexes&&this.chart.highlightModule.highlightDataIndexes.length>0&&t.id.indexOf("_chart_legend_")===-1&&t.id.indexOf("_Series_")>-1&&this.chart.tooltip&&this.chart.tooltip.enableHighlight&&this.chart.highlightMode==="None"&&this.removeLegendHighlightStyles(!0)}return}},e.prototype.selectionAndDrag=function(t,i,r){var n=Oi(t.mouseX,t.mouseY,t.chartAxisLayoutPanel.seriesClipRect);n&&!this.chart.enableCanvas?(this.rectGrabbing&&!this.resizing?this.draggedRectMoved(t,this.dragRect,!0):this.dragging&&!this.resizing&&(t.selectionMode==="Lasso"?(this.getPath(t.mouseDownX,t.mouseDownY,t.mouseX,t.mouseY),this.drawDraggingRect(t,this.dragRect)):(this.dragRect=this.getDragRect(t,t.chartAxisLayoutPanel.seriesClipRect),this.drawDraggingRect(t,this.dragRect))),this.rectPoints&&!t.allowMultiSelection?this.resizingSelectionRect(t,new Je(t.mouseX,t.mouseY),null,i):(t.allowMultiSelection&&!this.dragging||this.resizing)&&this.resizingSelectionRect(t,new Je(t.mouseX,t.mouseY),null,i)):this.completeSelection(i,r)},e.prototype.removeLegendHighlightStyles=function(t){this.chart.highlightModule.highlightDataIndexes=[];for(var i,r=0;r<this.chart.visibleSeries.length;r++)if(i=document.getElementsByClassName(this.generateStyle(this.chart.visibleSeries[r])),this.selectedDataIndexes.length===0){for(i=document.getElementsByClassName(this.generateStyle(this.chart.visibleSeries[r]));i.length>0;){var n=i[0];if(n&&(this.removeSvgClass(n,n.getAttribute("class")),n.id.indexOf("Group")>0&&!this.chart.visibleSeries[r].isRectSeries))for(var s=this.indexFinder(n.id),a=0;a<n.children.length;a++)n.children[a].nodeName!=="defs"&&this.highlightAnimation(n.children[a],s.series,t?0:700,.3,!t)}for(i=document.getElementsByClassName(this.unselected);i.length>0;){var n=i[0];n&&(this.removeSvgClass(n,n.getAttribute("class")),n.id!==""&&this.highlightAnimation(n,this.chart.series.length===1?0:this.indexFinder(n.id).series,t?0:700,.3))}}else for(i=document.getElementsByClassName(this.generateStyle(this.chart.visibleSeries[r]));i.length>0;){var n=i[0];n&&(this.removeSvgClass(n,n.getAttribute("class")),this.addSvgClass(n,this.unselected))}},e.prototype.getPath=function(t,i,r,n){this.dragging&&(this.path?this.path=this.path+" L"+r+" "+n:this.path="M "+t+" "+i)},e.prototype.highlightAnimation=function(t,i,r,n,s){var a=this,l,h,u=parseFloat(this.chart.visibleSeries[i].width.toString())+1;s?t.id.indexOf("border")!==-1&&this.chart.visibleSeries[i].border.width?h=parseFloat(this.chart.visibleSeries[i].border.width.toString()):t.id.indexOf("Symbol")!==-1&&this.chart.visibleSeries[i].marker.border.width?h=parseFloat(this.chart.visibleSeries[i].marker.border.width.toString()):h=parseFloat(this.chart.visibleSeries[i].width.toString()):(t.id.indexOf("border")!==-1?l=1:t.id.indexOf("Symbol")!==-1?l=parseFloat(this.chart.visibleSeries[i].marker.opacity.toString()):t.id.indexOf("legend_shape")!==-1?l=parseFloat(this.chart.legendSettings.opacity.toString()):l=parseFloat(this.chart.visibleSeries[i].opacity.toString()),g(this.chart.selectionModule)&&this.chart.selectionMode==="None"&&this.chart.highlightColor!==""&&(n=1)),(l||s&&h&&u)&&new It({}).animate(t,{duration:r,progress:function(c){if(t.style.animation="",!(a.chart.tooltip.enableHighlight&&a.chart.tooltipModule.svgTooltip)){var d=c.timeStamp/c.duration;if(s){var p=u+(h-u)*d;t.setAttribute("stroke-width",p.toString())}else{var f=n+(l-n)*d;t.setAttribute("opacity",f.toString())}}},end:function(){a.chart.tooltip.enableHighlight&&a.chart.tooltipModule.svgTooltip||(s?t.setAttribute("stroke-width",h.toString()):t.setAttribute("opacity",l.toString()))}})},e.prototype.stopElementAnimation=function(t,i){var r;t.id.indexOf("border")!==-1?r=1:t.id.indexOf("Symbol")!==-1?r=parseFloat(this.chart.visibleSeries[i].marker.opacity.toString()):r=parseFloat(this.chart.visibleSeries[i].opacity.toString()),t.getAttribute("e-animate")&&It.stop(t),t.setAttribute("opacity",r.toString())},e.prototype.pointChecking=function(t){var i=this,r=this.chart,n,s=ce(r.svgId).getBoundingClientRect(),a=r.chartAxisLayoutPanel.seriesClipRect.x+Math.max(s.left,0),l=r.chartAxisLayoutPanel.seriesClipRect.y+Math.max(s.top,0);this.multiDataIndexes[this.count]=[];for(var h=0,u=r.visibleSeries;h<u.length;h++){var c=u[h];c.points.filter(function(d){d.symbolLocations&&d.symbolLocations.length&&(n=document.elementFromPoint(d.symbolLocations[0].x+a,d.symbolLocations[0].y+l)),n===t?(d.isSelect=!0,i.chart.allowMultiSelection&&i.currentMode==="Lasso"&&(i.multiDataIndexes[i.count][i.seriesIndex]=d,i.seriesIndex++)):r.allowMultiSelection||(d.isSelect=!1)})}this.seriesIndex=0},e.prototype.getModuleName=function(){return"Selection"},e.prototype.destroy=function(){this.removeEventListener()},e}(MF),GW=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),DF=function(o){GW(e,o);function e(t){var i=o.call(this,t)||this;return i.element=i.chart.element,i.textStyle=t.tooltip.textStyle,i.control=t,i.template=t.tooltip.template,i}return e.prototype.getElement=function(t){return document.getElementById(t)},e.prototype.getTooltipElement=function(t){this.inverted=this.chart.requireInvertedAxis,this.header=this.control.tooltip.header===null?this.control.tooltip.shared?"${point.x}":"${series.name}":this.control.tooltip.header,this.formattedText=[];var i=document.getElementById(this.chart.element.id+"_tooltip"),r=this.chart.element.id.indexOf("stockChart")>-1;return!t&&!i||r?this.createElement():null},e.prototype.createElement=function(){var t=document.createElement("div");return t.id=this.element.id+"_tooltip",t.className="ejSVGTooltip",t.style.pointerEvents="none",t.style.position="absolute",t.style.zIndex="1",t},e.prototype.pushData=function(t,i,r,n,s){return t.series.enableTooltip?(s?this.currentPoints.push(t):n?this.currentPoints.push(t):this.currentPoints.push(t),this.stopAnimation(),r&&!document.getElementById(r.id)&&(this.chart.stockChart?document.getElementById(this.chart.stockChart.element.id+"_Secondary_Element").appendChild(r):document.getElementById(this.element.id+"_Secondary_Element").appendChild(r)),!0):!1},e.prototype.removeHighlight=function(){for(var t,i=0,r=this.previousPoints.length;i<r;i++)if(t=this.previousPoints[i],t.series.isRectSeries||this.chart.tooltip.enableHighlight){t.series.visible&&this.highlightPoint(t.series,t.point.index,!1);continue}},e.prototype.animateHighlight=function(t,i,r,n){var s=this,a=parseFloat(i.getAttribute("opacity")),l=null;n!==null&&(l=parseFloat(i.getAttribute("stroke-width"))),new It({}).animate(i,{duration:r,progress:function(h){if(i.style.animation="",!s.svgTooltip){if(n!==null){var u=l+h.timeStamp/h.duration*(n-l);i.setAttribute("stroke-width",Math.max(u,n).toString())}var c=a+h.timeStamp/h.duration*(t-a);i.setAttribute("opacity",Math.min(c,t).toString())}},end:function(){s.svgTooltip||(n!==null&&i.setAttribute("stroke-width",n.toString()),i.setAttribute("opacity",t.toString()))}})},e.prototype.highlightPoint=function(t,i,r){var n=this,s=this.getElement(this.element.id+"_Series_"+t.index+"_Point_"+i),a=this.control.accumulationSelectionModule,l=this.chart.getModuleName()==="accumulationchart",h=!!(a&&a.selectedDataIndexes.length>0);if(s||!t.isRectSeries)if(!h||h&&s.getAttribute("class")&&s.getAttribute("class").indexOf("_ej2_chart_selection_series_")===-1||!t.isRectSeries)if(t.isRectSeries&&this.chart.highlightColor!==""&&!g(this.chart.highlightColor))s.setAttribute("fill",r&&this.chart.highlightColor!=="transparent"?this.chart.highlightColor:t.pointColorMapping!==""?t.points[0].color:t.points[i].color||t.interior);else if(this.control.highlightMode==="None"&&this.chart.tooltip.enableHighlight&&(!this.chart.tooltip.shared||l)){if(r&&(l?this.control.accumulationSelectionModule&&this.control.accumulationSelectionModule.selectedDataIndexes.length>0:this.chart.selectionModule&&this.chart.selectionModule.selectedDataIndexes.length>0))return;for(var u=this.element.id+"_Series_"+t.index+"_Point_"+i,c=function(m){var y=[],S=typeof m.width=="number"?m.width:parseFloat(m.width);if(y=l?[d.getElement(d.chart.element.id+"_Series_"+m.index)]:new qW(d.chart).getSeriesElements(m),l&&d.control.series[0].dataLabel.visible){var b=d.getElement(d.element.id+"_datalabel_Series_0");b&&y.push(b)}y.forEach(function(w){w.childNodes.forEach(function(I){var x=I.id.indexOf("border")>-1?1:I.id.indexOf("Symbol")>-1?m.marker.opacity:m.opacity;r&&n.chart.highlightColor!=="transparent"&&I.id!==""?(l?w.getAttribute("id").indexOf("datalabel")>-1?$h(I.id).point===i:I.id===u:w.getAttribute("id")===n.element.id+"DataLabelCollection"?$h(I.id).series===t.index:m.index===t.index)?(I.setAttribute("opacity",x.toString()),(!t.isRectSeries||I.id.indexOf("border")>-1)&&!l&&I.setAttribute("stroke-width",(S+1).toString())):(I.setAttribute("opacity",l?I.id.indexOf("datalabel")>-1?"0.5":"0.3":I.getAttribute("id").indexOf("Text")>-1?"0.5":"0.3"),(!t.isRectSeries||I.id.indexOf("border")>-1)&&!l&&I.setAttribute("stroke-width",S.toString())):!n.currentPoints[0]&&I.id!==""&&n.animateHighlight(x,I,n.chart.tooltip.duration,(!t.isRectSeries||I.id.indexOf("border")>-1)&&!l?S:null)})})},d=this,p=0,f=this.chart.visibleSeries;p<f.length;p++){var v=f[p];c(v)}}else t.isRectSeries&&s.setAttribute("opacity",(r&&this.chart.highlightColor!=="transparent"?t.opacity/2:t.opacity).toString());else s.setAttribute("opacity",t.opacity.toString())},e.prototype.highlightPoints=function(){for(var t=0,i=this.currentPoints;t<i.length;t++){var r=i[t];(r.series.isRectSeries||this.chart.tooltip.enableHighlight)&&r.series.category==="Series"&&this.highlightPoint(r.series,r.point.index,!0)}},e.prototype.createTooltip=function(t,i,r,n,s,a,l,h,u,c,d,p){u===void 0&&(u=!1),c===void 0&&(c=null),d===void 0&&(d=null);var f=this.currentPoints[0].series,v=t.tooltipModule||t.tooltip3DModule||t.accumulationTooltipModule;if(!v||r===null){ni(this.chart.element.id+"_tooltip");return}i?(this.svgTooltip=new dN({opacity:t.tooltip.opacity?t.tooltip.opacity:this.chart.theme==="Material3"||this.chart.theme==="Material3Dark"||this.chart.theme.indexOf("Bootstrap5")>-1?1:.75,header:this.headerText,content:this.text,fill:t.tooltip.fill,border:t.tooltip.border,enableAnimation:t.tooltip.enableAnimation,location:r,shared:this.control.tooltip.shared,crosshair:u,shapes:a,clipBounds:this.chart.chartAreaType==="PolarRadar"?new Je(0,0):n,areaBounds:h,palette:this.findPalette(),template:p||this.template,data:d,theme:t.theme,offset:l,textStyle:t.tooltip.textStyle,isNegative:f.isRectSeries&&f.type!=="Waterfall"&&s&&s.y<0,inverted:this.chart.requireInvertedAxis&&f.isRectSeries,arrowPadding:this.text.length>1||this.chart.stockChart||this.chart.tooltip.location.x!==null||this.chart.tooltip.location.y!==null?0:7,availableSize:t.availableSize,duration:this.chart.tooltip.duration,isCanvas:this.chart.enableCanvas,isFixed:this.chart.tooltip.location.x!==null||this.chart.tooltip.location.y!==null,isTextWrap:t.tooltip.enableTextWrap&&t.getModuleName()==="chart",blazorTemplate:{name:"Template",parent:this.chart.tooltip},controlInstance:this.chart,enableRTL:t.enableRtl,controlName:"Chart",allowHighlight:t.getModuleName()==="chart"&&!f.marker.allowHighlight,tooltipRender:function(){v.removeHighlight(),v.highlightPoints(),v.updatePreviousPoint(c)},animationComplete:function(m){m.tooltip.fadeOuted&&v.fadeOut(v.previousPoints)},showHeaderLine:this.chart.tooltip.showHeaderLine,showNearestTooltip:this.chart.tooltip.showNearestTooltip}),this.svgTooltip.appendTo(this.getElement(this.element.id+"_tooltip"))):this.svgTooltip&&(this.svgTooltip.location=r,this.svgTooltip.content=this.text,this.svgTooltip.header=this.headerText,this.svgTooltip.offset=l,this.svgTooltip.palette=this.findPalette(),this.svgTooltip.shapes=a,this.svgTooltip.data=d,this.svgTooltip.template=this.template,this.svgTooltip.controlName="Chart",this.svgTooltip.crosshair=u,this.svgTooltip.textStyle=t.tooltip.textStyle,this.svgTooltip.isNegative=f.isRectSeries&&f.type!=="Waterfall"&&s&&s.y<0,this.svgTooltip.clipBounds=this.chart.chartAreaType==="PolarRadar"?new Je(0,0):n,this.svgTooltip.arrowPadding=this.text.length>1||this.chart.stockChart||this.chart.tooltip.location.x!==null||this.chart.tooltip.location.y!==null?0:7,this.svgTooltip.allowHighlight=t.getModuleName()==="chart"&&!f.marker.allowHighlight,this.svgTooltip.dataBind()),this.chart.isReact&&this.chart.renderReactTemplates()},e.prototype.findPalette=function(){for(var t=[],i=0,r=this.currentPoints;i<r.length;i++){var n=r[i];t.push(this.findColor(n,n.series))}return t},e.prototype.findColor=function(t,i){return i.isRectSeries&&(i.type==="Candle"||i.type==="Hilo"||i.type==="HiloOpenClose")?t.point.color:(t.point.color&&t.point.color!=="#ffffff"?t.point.color:t.point.interior)||i.marker.fill||i.interior},e.prototype.updatePreviousPoint=function(t){t&&(this.currentPoints=this.currentPoints.concat(t)),this.previousPoints=he([],this.currentPoints,null,!0)},e.prototype.fadeOut=function(t){var i=this.chart.enableCanvas?this.getElement(this.element.id+"_tooltip_group"):this.getElement(this.element.id+"_tooltip_svg")||this.getElement(this.element.id+"_tooltipparent_template"),r=i&&parseInt(i.getAttribute("opacity"),10)>0;r||(this.valueX=null,this.valueY=null,this.currentPoints=[],this.removeHighlight(),this.removeHighlightedMarker(t,!0),this.svgTooltip=null,this.control.trigger("animationComplete",{}))},e.prototype.removeHighlightedMarker=function(t,i){if(this.chart.markerRender)for(var r=0,n=t;r<n.length;r++){var s=n[r];ni(this.element.id+"_Series_"+s.series.index+"_Point_"+s.point.index+"_Trackball"),this.chart.markerRender.removeHighlightedMarker(s.series,s.point,i)}this.previousPoints=[]},e.prototype.removeText=function(){this.textElements=[];var t=this.getElement(this.element.id+"_tooltip_group");if(t&&t.childNodes.length>0)for(;t.lastChild&&t.childNodes.length!==1;)t.removeChild(t.lastChild)},e.prototype.stopAnimation=function(){nF(this.toolTipInterval)},e.prototype.removeTooltip=function(t){var i=this,r=this.getElement(this.element.id+"_tooltip");this.stopAnimation(),r&&this.previousPoints.length>0&&(this.toolTipInterval=+setTimeout(function(){i.svgTooltip&&i.svgTooltip.fadeOut()},t))},e}(Jw),YW=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),EF=function(o){YW(e,o);function e(t){var i=o.call(this,t)||this;return i.commonXvalues=[],i.addEventListener(),i}return e.prototype.addEventListener=function(){if(!this.chart.isDestroyed){var t=B.isPointer?"pointerleave":"mouseleave";this.chart.on(t,this.mouseLeaveHandler,this),this.chart.on("tapHold",this.longPress,this),this.chart.on(B.touchMoveEvent,this.mouseMoveHandler,this),this.chart.on(B.touchEndEvent,this.mouseUpHandler,this)}},e.prototype.mouseUpHandler=function(){var t=this.control,i=this.getData();i.lierIndex=this.lierIndex,t.isTouch&&!this.isSelected(t)&&(Oi(t.mouseX,t.mouseY,t.chartAxisLayoutPanel.seriesClipRect)&&t.tooltip.shared||!t.tooltip.shared)?t.crosshair.enable?t.startMove&&t.tooltip.fadeOutMode==="Move"&&this.removeTooltip(2e3):(this.tooltip(),t.tooltip.fadeOutMode==="Move"&&this.removeTooltip(t.tooltip.fadeOutDuration)):!this.findData(i,this.previousPoints[0])&&t.tooltip.fadeOutMode==="Click"&&this.removeTooltip(0)},e.prototype.mouseLeaveHandler=function(){this.removeTooltip(this.chart.tooltip.fadeOutDuration)},e.prototype.mouseMoveHandler=function(){var t=this.chart;t.stockChart&&t.stockChart.onPanning&&(t.mouseY<t.chartAxisLayoutPanel.seriesClipRect.y?t.mouseY=t.chartAxisLayoutPanel.seriesClipRect.y:t.mouseY>t.chartAxisLayoutPanel.seriesClipRect.y+t.chartAxisLayoutPanel.seriesClipRect.height&&(t.mouseY=t.chartAxisLayoutPanel.seriesClipRect.y+t.chartAxisLayoutPanel.seriesClipRect.height)),!t.disableTrackTooltip&&!this.isSelected(t)&&(!t.tooltip.shared&&(!t.isTouch||t.startMove)&&this.tooltip(),Oi(t.mouseX,t.mouseY,t.chartAxisLayoutPanel.seriesClipRect)?t.tooltip.shared&&(!t.isTouch||t.startMove)&&this.tooltip():t.tooltip.shared&&t.tooltip.fadeOutMode==="Move"&&this.removeTooltip(this.chart.tooltip.fadeOutDuration))},e.prototype.longPress=function(){var t=this.chart;return t.crosshair.enable&&Oi(t.mouseX,t.mouseY,t.chartAxisLayoutPanel.seriesClipRect)&&(this.tooltip(),t.markerRender.markerMove(!1)),!1},e.prototype.tooltip=function(){var t=this.chart.enableCanvas?this.element.id+"_tooltip_group":this.element.id+"_tooltip_svg",i=this.getElement(t),r=this.chart.stockChart&&i&&i.firstChild.childNodes.length>1,n=i&&parseInt(i.getAttribute("opacity"),10)>0&&!r,s=this.getTooltipElement(n);this.chart.enableCanvas&&s&&(document.getElementById(this.chart.element.id+"_Secondary_Element").appendChild(s),s.appendChild(document.getElementById(this.chart.element.id+"_tooltip_svg"))),this.chart.tooltip.shared?this.renderGroupedTooltip(this.chart,!n,s):this.renderSeriesTooltip(this.chart,!n,s)},e.prototype.findHeader=function(t){return this.header===""?"":(this.header=this.parseTemplate(t.point,t.series,this.header,t.series.xAxis,t.series.yAxis),this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()!==""?this.header:"")},e.prototype.findShapes=function(){if(!this.chart.tooltip.enableMarker)return[];for(var t=[],i=0,r=this.currentPoints;i<r.length;i++){var n=r[i];t.push(n.point.marker.shape||n.series.marker.shape||"Circle")}return t},e.prototype.renderSeriesTooltip=function(t,i,r){var n=this.getData(),s=null,a=1/0;if(n.lierIndex=this.lierIndex,this.currentPoints=[],this.findData(n,this.previousPoints[0])){if(!(t.dataEditingModule&&t.dataEditingModule.isPointDragging)&&this.previousPoints[0]&&n.point.index===this.previousPoints[0].point.index&&n.series.index===this.previousPoints[0].series.index)return null;this.pushData(n,i,r,!0)&&this.triggerTooltipRender(n,i,this.getTooltipText(n),this.findHeader(n))}else{var l=Oi(t.mouseX,t.mouseY,t.chartAxisLayoutPanel.seriesClipRect);if(!n.point&&this.isRemove&&t.tooltip.fadeOutMode==="Move"&&(!t.tooltip.showNearestTooltip||!l))this.removeTooltip(this.chart.tooltip.fadeOutDuration),this.isRemove=!1;else{for(var h=this.mergeXvalues(this.chart.visibleSeries),u=t.visibleSeries.length-1;u>=0;u--){var c=t.visibleSeries[u];if(c.visible&&c.category!=="TrendLine"&&(n=this.getClosestX(t,c,h)||n,t.tooltip.showNearestTooltip&&l&&c.showNearestTooltip&&n&&n.point&&c.enableTooltip&&n.point.symbolLocations[0])){var d=Math.sqrt(Math.pow(t.mouseX-n.series.clipRect.x-n.point.symbolLocations[0].x,2)+Math.pow(t.mouseY-n.series.clipRect.y-n.point.symbolLocations[0].y,2));d<a&&(a=d,s=n)}}t.tooltip.showNearestTooltip&&s&&this.pushData(s,i,r,!0)&&(n=s,this.triggerTooltipRender(n,i,this.getTooltipText(n),this.findHeader(n)))}}n&&n.point&&this.findMouseValues(n,t,this)},e.prototype.triggerTooltipRender=function(t,i,r,n){var s=this,a,l={cancel:!1,name:Vm,text:r,headerText:n,template:a,series:this.chart.isBlazor?{}:t.series,textStyle:this.textStyle,point:t.point,data:{pointX:t.point.x,pointY:t.point.y,seriesIndex:t.series.index,seriesName:t.series.name,pointIndex:t.point.index,pointText:t.point.text}},h=this.chart.border.width,u=3,c=this.chart.tooltip,d=function(p){if(p.cancel)s.removeHighlight(),Ue(s.getElement(s.element.id+"_tooltip"));else{t.series.type==="BoxAndWhisker"&&(s.removeText(),i=!0),s.headerText=p.headerText,s.formattedText=s.formattedText.concat(p.text),s.text=s.formattedText;var f=s.getSymbolLocation(t);f=f||new Je(null,null),f.x=c.location.x!==null?c.location.x:f.x,f.y=c.location.y!==null?c.location.y:f.y,f=f.x===null&&f.y===null?null:f,s.createTooltip(s.chart,i,f,t.series.clipRect,t.point,s.findShapes(),s.findMarkerHeight(s.currentPoints[0]),new Ae(h,h,s.chart.availableSize.width-u-h*2,s.chart.availableSize.height-u-h*2),s.chart.crosshair.enable,null,s.getTemplateText(t),s.template?p.template:"")}s.isRemove=!0};d.bind(this,t),this.chart.trigger(Vm,l,d)},e.prototype.findMarkerHeight=function(t){var i=0,r=t.series;return i=(r.marker.visible||this.chart.tooltip.shared&&(!r.isRectSeries||r.marker.visible)||r.type==="Scatter"||r.drawType==="Scatter")&&!(r.type==="Candle"||r.type==="Hilo"||r.type==="HiloOpenClose")?(r.marker.height+2)/2+2*r.marker.border.width:0,i},e.prototype.findData=function(t,i){return t.point&&(!i||i.point!==t.point||i&&i.lierIndex>3&&i.lierIndex!==this.lierIndex||i.point===t.point)},e.prototype.getSymbolLocation=function(t){var i;if(t.series.type!=="BoxAndWhisker"){if(!t.point.symbolLocations[0])return null;i=new Je(t.point.symbolLocations[0].x,t.point.symbolLocations[0].y)}switch(t.series.type){case"BoxAndWhisker":return this.getBoxLocation(t);case"Waterfall":return this.getWaterfallRegion(t,i);case"RangeArea":case"RangeStepArea":case"SplineRangeArea":case"RangeColumn":return this.getRangeArea(t,i);default:return i}},e.prototype.getRangeArea=function(t,i){return t.point.regions[0]&&(this.inverted?i.x=t.point.regions[0].x+t.point.regions[0].width/2:i.y=t.point.regions[0].y+t.point.regions[0].height/2,t.series.type==="RangeStepArea"&&(i.y=t.point.regions[0].y+t.point.regions[0].height/2+t.point.regions[0].width)),i},e.prototype.getWaterfallRegion=function(t,i){return this.inverted?i.x=t.point.y<0?i.x+(this.chart.enableRtl?-t.point.regions[0].width:t.point.regions[0].width):i.x:i.y=t.point.y<0?i.y-t.point.regions[0].height:i.y,i},e.prototype.getTooltipText=function(t){var i=t.series;return this.parseTemplate(t.point,i,this.getFormat(this.chart,i),i.xAxis,i.yAxis)},e.prototype.getTemplateText=function(t){if(this.template=this.chart.enableHtmlSanitizer?this.chart.sanitize(this.template):this.template,this.template&&this.chart.tooltip.shared){for(var i=[],r=0;r<t.length;r++)i[r]=he({},t[r].point),i[r].x=this.formatPointValue(t[r].point,t[r].series.xAxis,"x",!0,!1),t[r].series.seriesType==="XY"?i[r].y=this.formatPointValue(t[r].point,t[r].series.yAxis,"y",!1,!0):(i[r].low=this.formatPointValue(t[r].point,t[r].series.yAxis,"low",!1,!0),i[r].high=this.formatPointValue(t[r].point,t[r].series.yAxis,"high",!1,!0));return i}else if(this.template){var i=he({},t.point);return i.x=this.formatPointValue(t.point,t.series.xAxis,"x",!0,!1),t.series.seriesType==="XY"?i.y=this.formatPointValue(t.point,t.series.yAxis,"y",!1,!0):(i.low=this.formatPointValue(t.point,t.series.yAxis,"low",!1,!0),i.high=this.formatPointValue(t.point,t.series.yAxis,"high",!1,!0)),i}else return t.point},e.prototype.renderGroupedTooltip=function(t,i,r){var n,s=[],a,l=t.chartAreaType==="PolarRadar"?this.getData():null;this.stopAnimation(),this.removeHighlight(),this.currentPoints=[];var h=[],u=Number.MAX_VALUE,c=Number.MAX_VALUE,d,p,f;i&&(t.stockChart?r&&!Xn(r.id)&&document.getElementById(t.stockChart.element.id+"_Secondary_Element").appendChild(r):r&&document.getElementById(this.element.id+"_Secondary_Element").appendChild(r)),this.removeText();for(var v={text:[],cancel:!1,name:_w,data:[],point:[],series:[],headerText:"",textStyle:this.textStyle,template:[]},m=0,y=0,S=t.visibleSeries;y<S.length;y++){var b=S[y];!b.enableTooltip||!b.visible||(t.chartAreaType==="Cartesian"&&b.visible?n=this.getClosestX(t,b,this.commonXValue(this.chart.visibleSeries)):t.chartAreaType==="PolarRadar"&&b.visible&&l.point!==null&&(n=new of(b.points[l.point.index],b)),t.tooltip.showNearestPoint&&!n&&(n=this.getClosestX(t,b,this.commonXValue([b]))),n&&(v.data.push({pointX:n.point.x,pointY:n.point.y,seriesIndex:n.series.index,seriesName:n.series.name,pointIndex:n.point.index,pointText:n.point.text}),v.series[m]=n.series,v.point[m]=n.point,v.headerText=this.findHeader(n),this.currentPoints.push(n),this.template!=null&&v.template.push(t.enableHtmlSanitizer?t.sanitize(this.template.toString()):this.template.toString()),v.text.push(this.getTooltipText(n)),d=t.requireInvertedAxis?t.mouseY-n.series.clipRect.y:t.mouseX-n.series.clipRect.x,p=t.mouseY-n.series.clipRect.y,n.point.symbolLocations&&n.point.symbolLocations.length&&Math.abs(d-n.point.symbolLocations[0].x)<=u&&Math.abs(n.point.symbolLocations[0].y-p)<Math.abs(c-p)&&(u=Math.abs(d-n.point.symbolLocations[0].x),c=n.point.symbolLocations[0].y,f=n),a=n.series.category==="TrendLine"&&t.tooltip.shared?a:f||n,s.push(n)),m++)}if(!t.tooltip.showNearestPoint){var w=[];this.currentPoints=[],v.point=[],v.series=[],v.data=[],v.text=[];for(var I=0,x=s;I<x.length;I++){var M=x[I];(M.point.symbolLocations[0].x===a.point.symbolLocations[0].x||(M.series.type.indexOf("Column")!==-1||a.series.type.indexOf("Column")!==-1)&&M.point.xValue===a.point.xValue)&&(v.point.push(M.point),v.series.push(M.series),v.text.push(this.getTooltipText(M)),v.headerText=this.findHeader(M),w.push(M),v.data.push({pointX:M.point.x,pointY:M.point.y,seriesIndex:M.series.index,seriesName:M.series.name,pointIndex:M.point.index,pointText:M.point.text}))}s=w,this.currentPoints=w}s.length>0&&this.currentPoints.length>0?this.triggerSharedTooltip(v,a,h,t,i,s):this.getElement(this.element.id+"_tooltip_path")&&this.getElement(this.element.id+"_tooltip_path").setAttribute("d","")},e.prototype.triggerSharedTooltip=function(t,i,r,n,s,a){var l=this,h=t.template,u={cancel:!1,name:_w,text:t.text,headerText:t.headerText,textStyle:t.textStyle,template:h,point:t.point,series:t.series,data:t.data},c=this.chart.border.width,d=3,p,f,v=[];n.stockChart&&(p=n.stockChart.enablePeriodSelector?n.stockChart.toolbarHeight:0,f=Ze(this.chart.stockChart.title,this.chart.stockChart.titleStyle,this.chart.themeStyle.tooltipLabelFont).height+10);var m=function(y){if(y.cancel)ni(l.element.id+"_tooltip"),r.push(i);else{i.series.type==="BoxAndWhisker"&&(l.removeText(),s=!0);for(var S=0;S<y.text.length;S++)y.text[S]&&v.push(l.currentPoints[S]);l.currentPoints=v,l.formattedText=l.formattedText.concat(y.text),l.text=y.text,l.headerText=y.headerText,typeof y.template!="object"?(y.template=y.template.split(","),y.template.length>v.length&&(y.template=y.template.splice(y.template.length-1))):y.template.length>v.length&&y.template.splice(y.template.length-1);var b=l.chart.tooltip;l.findMouseValues(i,l.chart,l);var w=l.findSharedLocation();w=w||new Je(null,null),w.x=b.location.x!==null?b.location.x:w.x,w.y=b.location.y!==null?b.location.y:w.y,w=w.x===null&&w.y===null?null:w,i.series.type.indexOf("Range")===-1||Oi(w.x,w.y,n.chartAxisLayoutPanel.seriesClipRect)?l.createTooltip(n,s,w,l.currentPoints.length===1?l.currentPoints[0].series.clipRect:null,a.length===1?a[0].point:null,l.findShapes(),l.findMarkerHeight(l.currentPoints[0]),new Ae(c,n.stockChart?p+f+c:c,l.chart.availableSize.width-d-c*2,l.chart.availableSize.height-d-c*2),l.chart.crosshair.enable,r,l.template?l.getTemplateText(a):null,l.template?y.template.join(""):""):(ni(l.element.id+"_tooltip"),r.push(i)),i=null}};m.bind(this,i,r),this.chart.trigger(_w,u,m)},e.prototype.findSharedLocation=function(){var t=this.chart.stockChart;if(t){this.text.length===1&&this.text.push("");var i=t.enablePeriodSelector?t.toolbarHeight:0,r=document.getElementById(t.element.id+"_ChartTitle"),n=t.title!==""?r.getBoundingClientRect().height+10:0;return t.tooltip.position==="Nearest"?new Je(this.valueX,this.valueY+i+n):new Je(this.chart.chartAxisLayoutPanel.seriesClipRect.x+5,this.chart.chartAxisLayoutPanel.seriesClipRect.y+i+5+n)}else return this.currentPoints.length>1?new Je(this.valueX,this.valueY):this.getSymbolLocation(this.currentPoints[0])},e.prototype.getBoxLocation=function(t){var i=this.lierIndex>3?t.point.outliers.length>0?t.point.symbolLocations[this.lierIndex-4]:null:{x:t.point.regions[0].x+t.point.regions[0].width/2,y:t.point.regions[0].y+t.point.regions[0].height/2};return i},e.prototype.parseTemplate=function(t,i,r,n,s){for(var a,l,h=RegExp,u=0,c=Object.keys(t);u<c.length;u++){var d=c[u];a=new h("${point."+d+"}","gm"),r=r.replace(a.source,this.formatPointValue(t,a.source==="${point.x}"?n:s,d,a.source==="${point.x}",a.source==="${point.high}"||a.source==="${point.open}"||a.source==="${point.close}"||a.source==="${point.low}"||a.source==="${point.y}"||a.source==="${point.minimum}"||a.source==="${point.maximum}"||a.source==="${point.outliers}"||a.source==="${point.upperQuartile}"||a.source==="${point.lowerQuartile}"||a.source==="${point.median}"))}for(var p=0,f=Object.keys(Object.getPrototypeOf(i));p<f.length;p++){var d=f[p];a=new h("${series."+d+"}","gm"),l=i[d],r=r.replace(a.source,l)}return r},e.prototype.formatPointValue=function(t,i,r,n,s){var a,l,h;if(i.valueType!=="Category"&&n){l=i.labelFormat&&i.labelFormat.match("{value}")!==null;var u=i.valueType==="Double"?+t[r]:t[r];a=l?i.labelFormat.replace("{value}",i.format(u)):i.format(u)}else if(s&&!g(t[r]))l=i.labelFormat&&i.labelFormat.match("{value}")!==null,h=r==="outliers"?i.format(t[r][this.lierIndex-4]):i.format(+t[r]),a=l?i.labelFormat.replace("{value}",h):h;else if(r==="size"){var c=this.chart.intl.getNumberFormat({format:"",useGrouping:this.chart.useGroupingSeparator});a=typeof t[r]=="number"?c(t[r]):t[r],a=a||""}else a=t[r];return a},e.prototype.getFormat=function(t,i){if(i.tooltipFormat)return i.seriesType==="XY"&&i.category==="Indicator"?this.getIndicatorTooltipFormat(i,t,t.tooltip.format):i.tooltipFormat;if(!i.tooltipFormat&&t.tooltip.format)return i.seriesType==="XY"&&i.category==="Indicator"?this.getIndicatorTooltipFormat(i,t,t.tooltip.format):t.tooltip.format;var r=i.type==="Histogram"?"${point.minimum}-${point.maximum}":"${point.x}",n=t.tooltip.shared?"${series.name}":r;switch(i.seriesType){case"XY":return i.category==="Indicator"&&this.getIndicatorTooltipFormat(i,t,t.tooltip.format),n+" : "+(i.type==="Bubble"?t.theme.indexOf("Tailwind3")>-1?"${point.y}  Size : ${point.size}":"<b>${point.y}</b>  Size : <b>${point.size}</b>":t.theme.indexOf("Tailwind3")>-1?"${point.y}":"<b>${point.y}</b>");case"HighLow":return n+"<br/>High : <b>${point.high}</b><br/>Low : <b>${point.low}</b>";case"HighLowOpenClose":return n+"<br/>High : <b>${point.high}</b><br/>Low : <b>${point.low}</b><br/>Open : <b>${point.open}</b><br/>Close : <b>${point.close}</b>";case"BoxPlot":return n+"<br/>"+(this.lierIndex>3?"Outliers : <b>${point.outliers}</b>":"Maximum : <b>${point.maximum}</b><br/>Q3 : <b>${point.upperQuartile}</b><br/>Median : <b>${point.median}</b><br/>Q1 : <b>${point.lowerQuartile}</b><br/>Minimum : <b>${point.minimum}</b>")}},e.prototype.getIndicatorTooltipFormat=function(t,i,r){var n;return t.seriesType==="XY"?n=t.name+" : <b>${point.y}</b>":n=r,n},e.prototype.removeHighlightedMarker=function(t,i){for(var r=0,n=t;r<n.length;r++){var s=n[r];ni(this.element.id+"_Series_"+s.series.index+"_Point_"+s.point.index+"_Trackball"),this.chart.markerRender&&this.chart.markerRender.removeHighlightedMarker(s.series,s.point,i)}this.previousPoints=[]},e.prototype.getModuleName=function(){return"Tooltip"},e.prototype.destroy=function(){},e}(DF);var AF=function(){function o(e){this.errorHeight=0,this.dataLabelRectCollection={},this.chart=e}return o.prototype.initPrivateVariables=function(e,t){var i="",r="",n=e.chart.renderer,s=e.index===void 0?e.category:e.index;e.chart.chartAreaType==="Cartesian"&&(i="translate("+e.clipRect.x+","+e.clipRect.y+")",r="url(#"+this.chart.element.id+"_ChartSeriesClipRect_"+s+")"),t.dataLabel.visible&&!this.chart.enableCanvas&&(e.shapeElement=n.createGroup({id:this.chart.element.id+"ShapeGroup"+s,transform:i,"clip-path":"url(#"+this.chart.element.id+"_ChartSeriesClipRect_"+s+")"}),e.textElement=n.createGroup({id:this.chart.element.id+"TextGroup"+s,transform:i,"clip-path":r}),e.textElement.setAttribute("aria-hidden","true")),this.markerHeight=e.type==="Scatter"||t.visible?t.height/2:0,this.commonId=this.chart.element.id+"_Series_"+s+"_Point_",this.calculateErrorHeight(e,e.marker.dataLabel.position),this.chartBackground=this.chart.chartArea.background==="transparent"?this.chart.background||this.chart.themeStyle.background:this.chart.chartArea.background},o.prototype.calculateErrorHeight=function(e,t){if(e.errorBar.visible)if(e.errorBar.visible&&this.chart.chartAreaType!=="PolarRadar"){var i=e.errorBar.direction,r=this.chart.errorBarModule.positiveHeight,n=this.chart.errorBarModule.negativeHeight;this.isRectSeries(e)?((t==="Top"||t==="Auto")&&(i==="Both"||i==="Minus"?this.errorHeight=n:this.errorHeight=0),(t==="Outer"||t==="Auto")&&(i==="Both"||i==="Plus"?this.errorHeight=r:this.errorHeight=0)):((t==="Top"||t==="Outer"||t==="Auto")&&((i==="Both"||i==="Plus")&&!e.chart.isTransposed?this.errorHeight=r:this.errorHeight=0),(t==="Bottom"||t==="Auto")&&(i==="Both"||i==="Minus"?this.errorHeight=n:this.errorHeight=0))}else this.errorHeight=0;else return null},o.prototype.isRectSeries=function(e){return e.isRectSeries||e.type==="RangeArea"||e.type==="SplineRangeArea"||e.type==="RangeStepArea"},o.prototype.render=function(e,t,i){this.initPrivateVariables(e,e.marker),this.inverted=t.requireInvertedAxis,this.yAxisInversed=e.yAxis.isAxisInverse;var r=t.element.id+"_Series_"+(e.index===void 0?e.category:e.index)+"_DataLabelCollections",n=Xe("div",{id:r}),s=Kl(e);if(e.visible)for(var a=0;a<s.length;a++)this.renderDataLabel(e,s[a],n,i);n.childElementCount&&(t.enableCanvas?ce(t.element.id+"_Secondary_Element").appendChild(n):vt(t.enableCanvas,ce(t.element.id+"_Secondary_Element"),n,t.redraw,!1,"x","y",null,"",!1,!1,null,t.duration))},o.prototype.renderDataLabel=function(e,t,i,r){if(!r.showZero&&(t.y===0||t.y===0&&e.emptyPointSettings.mode==="Zero"))return null;this.margin=r.margin;var n=[],s,a,l,h,u,c,d,p,f={x:0,y:0},v,m=e.clipRect,y,S=!1,b=[],w;r.angle=r.labelIntersectAction==="Rotate90"?90:r.angle,r.enableRotation=r.labelIntersectAction==="Rotate90"?!0:r.enableRotation;var I=c=r.angle,x={width:r.border.width,color:r.border.color},M=he({},V("properties",r.font),null,!0);if(t.symbolLocations.length&&t.symbolLocations[0]||e.type==="BoxAndWhisker"&&t.regions.length){n=t.text!==null?iW(t,e,this.chart):[],s=n.length;for(var D=0;D<s;D++){var A={cancel:!1,name:jm,series:e,point:t,text:n[D],border:x,color:r.fill,template:r.template,font:M,location:f,textSize:Ze(n[D],r.font,this.chart.themeStyle.datalabelFont)};if(this.chart.trigger(jm,A),!A.cancel)if(this.fontBackground=A.color,this.isDataLabelShape(A),this.markerHeight=e.type==="Bubble"?t.regions[0].height/2:this.markerHeight,A.template!==null)this.createDataLabelTemplate(i,e,r,t,A,D,this.chart.redraw);else{r.enableRotation?v=Oc(r.font,A.text,r.angle,this.chart,this.chart.themeStyle.datalabelFont):v=Ze(A.text,r.font,this.chart.themeStyle.datalabelFont);var L=this.calculateTextPosition(t,e,v,r,D),T=new Ae(L.x+m.x,L.y+m.y,L.width,L.height);if(r.enableRotation){var k=this.getRectanglePoints(T);if(d=L.x+L.width/2,p=L.y+L.height/2,S=r.labelIntersectAction==="Rotate90"||I===-90?!1:this.isDataLabelOverlapWithChartBound(k,this.chart,{x:0,y:0,width:0,height:0}),!S){this.chart.rotatedDataLabelCollections.push(k);for(var F=this.chart.rotatedDataLabelCollections.length-1,R=F;R>=0;R--)if(this.chart.rotatedDataLabelCollections[F]&&this.chart.rotatedDataLabelCollections[R-1]&&XN(this.chart.rotatedDataLabelCollections[F],this.chart.rotatedDataLabelCollections[R-1])){S=!0,this.chart.rotatedDataLabelCollections[F]=null;break}}}else S=kc(L,this.chart.dataLabelCollections,m);if(!S||r.labelIntersectAction==="None"){var N=ce(this.commonId+t.index+"_TextShape_"+D);N&&(w={x:+N.getAttribute("x"),y:+N.getAttribute("y")}),this.chart.dataLabelCollections.push(T),this.isShape&&(y=this.chart.renderer.drawRectangle(new as(this.commonId+t.index+"_TextShape_"+D,A.color,A.border,r.opacity,L,r.rx,r.ry,"",r.border.dashArray),new Int32Array([m.x,m.y])),e.shapeElement&&vt(this.chart.enableCanvas,e.shapeElement,y,this.chart.redraw,!0,"x","y",w));var P=this.fontBackground==="transparent"?this.chart.theme.indexOf("Dark")>-1||this.chart.theme.indexOf("HighContrast")>-1?"black":"white":this.fontBackground,O=hf(Bn(P)),z=Math.round((O.r*299+O.g*587+O.b*114)/1e3);a=L.x+this.margin.left+v.width/2+f.x,l=r.enableRotation&&this.chart.chartAreaType!=="PolarRadar"?L.y+this.margin.top+v.height/2+v.width/4+(r.position==="Auto"?t.regions[0].width/10:0)+f.y:L.y+this.margin.top+v.height*3/4+f.y,f={x:0,y:0},I!==0&&r.enableRotation?(h=d,u=p,c=I>360?I-360:I<-360?I+360:I):(c=0,h=L.x,u=L.y,a-=this.chart.chartAreaType==="Cartesian"&&a+v.width/2>m.width?!this.chart.requireInvertedAxis&&a>m.width?0:a+v.width/2-m.width:0,l-=l+v.height>m.y+m.height&&!(e.type.indexOf("Bar")>-1)?l+v.height-(m.y+m.height):0);var H=r.labelIntersectAction==="Rotate90"?r.position==="Top"?"start":r.position==="Middle"?"middle":"end":I===-90&&r.enableRotation?r.position==="Top"?"end":r.position==="Middle"?"middle":"start":"middle",Q=void 0;this.chart.redraw&&document.getElementById(this.commonId+t.index+"_Text_"+D)&&(Q=document.getElementById(this.commonId+t.index+"_Text_"+D).textContent),b.push(hn(this.chart.renderer,new gn(this.commonId+(e.removedPointIndex!==null&&e.removedPointIndex<=t.index?t.index+1:t.index)+"_Text_"+D,a,l,H,A.text,"rotate("+c+","+h+","+u+")","auto",c),A.font,A.font.color||(this.chart.theme==="Bootstrap5"?"#212529":this.chart.theme==="Bootstrap5Dark"?"#DEE2E6":z>=128||e.type==="Hilo"||e.type==="HiloOpenClose"?this.chart.theme.indexOf("Tailwind3")>-1?"#111827":"black":this.chart.theme.indexOf("Tailwind3")>-1?"#FFFFFF":"white"),e.textElement,!1,this.chart.redraw,!0,!1,e.chart.duration,e.clipRect,null,null,this.chart.enableCanvas,null,this.chart.themeStyle.datalabelFont,new Je(h,u))),this.isShape&&r.enableRotation&&y.setAttribute("transform","rotate("+r.angle+", "+h+", "+u+")"),this.chart.stackLabels.visible&&e.type.indexOf("Stacking")>-1&&(this.dataLabelRectCollection=this.dataLabelRectCollection?this.dataLabelRectCollection:{},this.dataLabelRectCollection[this.commonId+(e.removedPointIndex!==null&&e.removedPointIndex<=t.index?t.index+1:t.index)+"_Text_"+D]=T,this.dataLabelRectCollection[this.commonId+t.index+"_TextShape_"+D]=T),e.removedPointIndex!==null&&e.removedPointIndex<=t.index&&(e.textElement.lastChild.id=this.commonId+t.index+"_Text_"+D),this.chart.redraw&&Q!==A.text&&hW(e.textElement.querySelector("#"+this.commonId+t.index+"_Text_"+D),this.chart.duration,parseFloat(Q),parseFloat(A.text),e.marker.dataLabel.format||e.yAxis.labelFormat)}else ce(this.commonId+t.index+"_Text_0")&&e.chart.redraw&&e.currentData&&ce(this.commonId+t.index+"_Text_0").remove()}}}return b},o.prototype.renderStackLabels=function(){var e=this,t=this.chart.renderer.createGroup({id:this.chart.element.id+"_StackLabelGroup"});this.chart.seriesElements.appendChild(t);var i={},r={};if(this.chart.visibleSeries&&this.chart.visibleSeries.length>0)for(var n=this.chart.visibleSeries.length-1;n>=0;n--){var s=this.chart.visibleSeries[n];if(s.animation.enable&&this.chart.animateSeries&&t.setAttribute("visibility","hidden"),s.visible&&s.points&&s.points.length>0)for(var a=0;a<s.points.length;a++){var l=s.points[a],h=String(l.x);!i[h]&&s.stackedValues.endValues[a]>0&&l.visible&&(i[h]=l),!r[h]&&s.stackedValues.endValues[a]<0&&l.visible&&(r[h]=l)}}var u=0;[i,r].forEach(function(c,d){if(c){var p=0,f;Object.keys(c).forEach(function(v){var m=c[v].series.stackedValues.endValues[c[v].index],y=r[v]?r[v].series.stackedValues.endValues[r[v].index]:0;if(d===0?(p=m+y,f=c[v]):i[v]||(p=m,f=c[v]),f&&f.symbolLocations[0]){var S=f.series,b=f.symbolLocations[0],w=e.chart.stackLabels.format,I=p%1===0?p.toFixed(0):p.toFixed(2).slice(-1)==="0"?p.toFixed(1):p.toFixed(2);if(w){var x=w.match("{value}")!==null;I=x?w.replace("{value}",I.toString()):e.chart.intl.getNumberFormat({format:w,useGrouping:e.chart.useGroupingSeparator})(p)}var M=Ze(I,e.chart.stackLabels.font,e.chart.themeStyle.datalabelFont),D=10,A=e.chart.stackLabels.fill==="transparent"&&e.chartBackground==="transparent"?e.chart.theme.indexOf("Dark")>-1||e.chart.theme.indexOf("HighContrast")>-1?"black":"white":e.chart.stackLabels.fill!=="transparent"?e.chart.stackLabels.fill:e.chartBackground,L=hf(Bn(A)),T=Math.round((L.r*299+L.g*587+L.b*114)/1e3),k=M.width+e.chart.stackLabels.border.width+e.chart.stackLabels.margin.left+e.chart.stackLabels.margin.right-D/2,F=e.chart.requireInvertedAxis?D/2:e.chart.primaryYAxis.isInversed?d===0?M.height+D/2:-D:d===0?-D:M.height+D/2,R=e.chart.requireInvertedAxis?e.chart.primaryYAxis.isInversed?d===0?-(D+M.width/2):D+M.width/2:d===0?D+M.width/2:-(D+M.width/2):0;R+=e.chart.stackLabels.font.textAlignment==="Far"?k:e.chart.stackLabels.font.textAlignment==="Near"?-k:0;var N=Math.max(S.clipRect.x+M.width,Math.min(R+S.clipRect.x+b.x,S.clipRect.x+S.clipRect.width-M.width)),P=Math.max(S.clipRect.y+M.height,Math.min(F+S.clipRect.y+b.y-(e.chart.stackLabels.angle>0&&!e.chart.requireInvertedAxis?M.width/2:0),S.clipRect.y+S.clipRect.height-M.height)),O=new Ae(N-M.width/2-e.chart.stackLabels.margin.left,P-M.height-e.chart.stackLabels.margin.top,M.width+(e.chart.stackLabels.margin.left+e.chart.stackLabels.margin.right),M.height+D/2+(e.chart.stackLabels.margin.top+e.chart.stackLabels.margin.bottom)),z=e.chart.renderer.drawRectangle(new as(e.chart.element.id+"StackLabel_TextShape_"+u,e.chart.stackLabels.fill,e.chart.stackLabels.border,null,O,e.chart.stackLabels.rx,e.chart.stackLabels.ry,"",null),new Int32Array([b.x,b.y]));z.setAttribute("transform","rotate("+e.chart.stackLabels.angle+", "+N+", "+P+")"),t.appendChild(z),hn(e.chart.renderer,new gn(e.chart.element.id+"_StackLabel_"+u,N,P,"middle",I,"rotate("+e.chart.stackLabels.angle+", "+N+", "+P+")","auto",e.chart.stackLabels.angle),e.chart.stackLabels.font,e.chart.stackLabels.font.color||(e.chart.theme==="Bootstrap5"?"#212529":e.chart.theme==="Bootstrap5Dark"?"#DEE2E6":T>=128?e.chart.theme.indexOf("Tailwind3")>-1?"#111827":"black":e.chart.theme.indexOf("Tailwind3")>-1?"#FFFFFF":"white"),t,null,e.chart.redraw,!0,null,e.chart.duration,S.clipRect,null,null,e.chart.enableCanvas,null,e.chart.themeStyle.datalabelFont,null),(S.type==="StackingLine"||S.type==="StackingArea")&&document.querySelectorAll('[id^="'+e.chart.element.id+"_Series_"+S.index+"_Point_"+f.index+`_Text_"], 
                                [id^="`+e.chart.element.id+"_Series_"+S.index+"_Point_"+f.index+'_TextShape_"]').forEach(function(ie){ie.id&&(ie.style.visibility="hidden",ie.setAttribute("data-collide","true"))});for(var H in e.dataLabelRectCollection)if(Object.prototype.hasOwnProperty.call(e.dataLabelRectCollection,H)){var Q=e.dataLabelRectCollection[H];if(Q){var $=kc(O,[Q],{x:0,y:0,height:0,width:0});if($){var U=document.getElementById(H);U&&(U.style.visibility="hidden",U.setAttribute("data-collide","true"))}}}}u++})}})},o.prototype.getRectanglePoints=function(e){var t=new Je(e.x,e.y),i=new Je(e.x+e.width,e.y),r=new Je(e.x+e.width,e.y+e.height),n=new Je(e.x,e.y+e.height);return[t,i,r,n]},o.prototype.isDataLabelOverlapWithChartBound=function(e,t,i){for(var r=0;r<e.length;r++)if(!Oi(e[r].x+i.x,e[r].y+i.y,t.initialClipRect))return!0;return!1},o.prototype.createDataLabelTemplate=function(e,t,i,r,n,s,a){this.margin={left:0,right:0,bottom:0,top:0};var l=t.clipRect,h=tF(Xe("div",{id:this.chart.element.id+"_Series_"+(t.index===void 0?t.category:t.index)+"_DataLabel_"+r.index+(s?"_"+s:""),styles:"position: absolute;background-color:"+n.color+";"+iF(i.font,this.chart.themeStyle.datalabelFont)+";border:"+n.border.width+"px solid "+n.border.color+";"}),r.index,this.chart.enableHtmlSanitizer?this.chart.sanitize(n.template):n.template,this.chart,r,t,this.chart.element.id+"_DataLabel",s);this.calculateTemplateLabelSize(e,h,r,t,i,s,l,a)},o.prototype.calculateTemplateLabelSize=function(e,t,i,r,n,s,a,l,h){var u=rF(t,l,h),c=this.calculateTextPosition(i,r,{width:u.width,height:u.height},n,s),d=0,p=0,f=!1;h&&(f=u.width===0||u.height===0),t.style.left=(this.chart.chartAreaType==="PolarRadar"?0:r.clipRect.x)+c.x-d+"px",t.style.top=(this.chart.chartAreaType==="PolarRadar"?0:r.clipRect.y)+c.y+p+"px";var v=r.chart.requireInvertedAxis?r.xAxis:r.yAxis,m=r.chart.requireInvertedAxis?r.yAxis:r.xAxis;t.childElementCount&&!f&&(!kc(c,this.chart.dataLabelCollections,a)||n.labelIntersectAction==="None")&&(r.seriesType!=="XY"||i.yValue===void 0||Yh(i.yValue,r.yAxis.visibleRange)||r.type.indexOf("Stacking")>-1||r.type.indexOf("100")>-1&&Yh(r.stackedValues.endValues[i.index],r.yAxis.visibleRange))&&Yh(i.xValue,r.xAxis.visibleRange)&&parseFloat(t.style.top)>=v.rect.y&&parseFloat(t.style.left)>=m.rect.x&&parseFloat(t.style.top)<=v.rect.y+v.rect.height&&parseFloat(t.style.left)<=m.rect.x+m.rect.width&&(this.chart.dataLabelCollections.push(new Ae(c.x+a.x,c.y+a.y,c.width,c.height)),vt(this.chart.enableCanvas,e,t,l,!0,"left","top"),r.animation.enable&&this.chart.animateSeries&&!this.chart.enableCanvas?this.doDataLabelAnimation(r,t):this.chart.enableCanvas&&e.appendChild(t))},o.prototype.calculateTextPosition=function(e,t,i,r,n){var s=n>1&&t.type==="Candle"?e.regions[1]:e.regions[0];n>1&&t.type==="HiloOpenClose"&&(s=n===2?e.regions[1]:e.regions[2]);var a;a=this.getLabelLocation(e,t,i,n);var l=5,h=t.clipRect;if(!this.chart.requireInvertedAxis||!this.isRectSeries(t)||t.type==="BoxAndWhisker"){this.locationX=a.x;var u=i.height+this.borderWidth*2+this.markerHeight+this.margin.bottom+this.margin.top+l;a.x=r.position==="Auto"?a.x:this.calculateAlignment(u,a.x,r.alignment,this.isRectSeries(t)?e.yValue<0:!1),a.y=!this.isRectSeries(t)||t.type==="BoxAndWhisker"?this.calculatePathPosition(a.y,r.position,t,e,i,n):this.calculateRectPosition(a.y,s,e.yValue<0!==this.yAxisInversed,r.position,t,i,n,e),this.isRectSeries(t)&&this.chart.chartAreaType==="PolarRadar"&&(a=this.calculatePolarRectPosition(a,r.position,t,e,i,n,r.alignment,u))}else{this.locationY=a.y;var u=i.width+this.borderWidth+this.margin.left+this.margin.right-l;a.x=r.position==="Auto"?a.x:this.calculateAlignment(u,a.x,r.alignment,e.yValue<0),a.x=this.calculateRectPosition(a.x,s,e.yValue<0!==this.yAxisInversed,r.position,t,i,n,e)}var c=Rm(a,i,this.margin);(!(r.enableRotation===!0&&r.angle!==0)||r.labelIntersectAction==="Rotate90")&&!(c.y>h.y+h.height||c.x>h.x+h.width||c.x+c.width<0||c.y+c.height<0)&&(c.x=c.x<0?t.type==="StackingColumn"&&!this.inverted?0:l:c.x,c.y=c.y<0&&!this.chart.requireInvertedAxis&&r.labelIntersectAction!=="None"?l:c.y,c.x-=c.x+c.width>h.x+h.width?c.x+c.width-(h.x+h.width)+l:0,c.y-=c.y+c.height>h.y+h.height?c.y+c.height-(h.y+h.height)+l:0,this.fontBackground=this.fontBackground==="transparent"?this.chartBackground:this.fontBackground);var d;return this.inverted&&t.isRectSeries&&c.x+c.width>s.x+s.width&&(d=!0),this.fontBackground=d?this.chartBackground:this.fontBackground,c},o.prototype.calculatePolarRectPosition=function(e,t,i,r,n,s,a,l){var h=5,u,c=this.chart.availableSize.width,d=a==="Center"?0:a==="Far"?1:-1,p=r.regionData.startAngle-.5*Math.PI+(r.regionData.endAngle-r.regionData.startAngle)/2;return s===0?u=r.regionData.radius<r.regionData.innerRadius?r.regionData.innerRadius:r.regionData.radius:u=r.regionData.radius>r.regionData.innerRadius?r.regionData.innerRadius:r.regionData.radius,this.fontBackground=this.fontBackground==="transparent"?this.chartBackground:this.fontBackground,i.drawType.indexOf("Stacking")>-1?t=t==="Outer"?"Top":t:i.drawType.indexOf("Range")>-1&&(t=t==="Outer"||t==="Top"?t:"Auto"),t==="Outer"?u=s===0?u+2*h+this.markerHeight:u-2*h-this.markerHeight:t==="Middle"?(u=u/2+h,i.drawType==="StackingColumn"&&(u=r.regionData.innerRadius+(r.regionData.radius-r.regionData.innerRadius)/2+h-n.height/2)):t==="Top"?u=s===0?u-2*h-this.markerHeight:u+2*h+this.markerHeight:t==="Bottom"?(u=2*h,u+=i.drawType==="StackingColumn"?r.regionData.innerRadius+this.markerHeight:0):s===0?u=u>=i.chart.radius?u-h:i.drawType==="StackingColumn"?u-2*h:u+2*h:u=u>=i.chart.radius?u+h:u-2*h,u+=l*d,e.x=i.clipRect.width/2+i.clipRect.x+u*Math.cos(p),i.drawType==="StackingColumn"?e.x=e.x<c/2?e.x+n.width/2:e.x>c/2?e.x-n.width/2:e.x:i.drawType==="Column"&&(e.x=e.x<c/2?e.x-n.width/2:e.x>c/2?e.x+n.width/2:e.x),e.y=i.clipRect.height/2+i.clipRect.y+u*Math.sin(p),e},o.prototype.getLabelLocation=function(e,t,i,r){var n=new Je(0,0),s=t.type==="Candle"&&r>1?e.regions[1]:e.regions[0];t.type==="HiloOpenClose"&&(s=r===2?e.regions[1]:e.regions[2]);var a=t.xAxis,l=t.yAxis,h=t.chart.requireInvertedAxis;if(t.type==="BoxAndWhisker"){switch(this.markerHeight=0,r){case 0:n=jn(e.xValue,e.median,a,l,h);break;case 1:n=jn(e.xValue,e.maximum,a,l,h);break;case 2:n=jn(e.xValue,e.minimum,a,l,h);break;case 3:n=jn(e.xValue,e.upperQuartile,a,l,h);break;case 4:n=jn(e.xValue,e.lowerQuartile,a,l,h);break;default:{n=jn(e.xValue,e.outliers[r-5],a,l,h),this.markerHeight=t.marker.height/2;break}}h?n.y=e.regions[0].y+e.regions[0].height/2:n.x=e.regions[0].x+e.regions[0].width/2}else h&&t.type.indexOf("Stacking")>-1&&e.yValue===0?n={x:s.x+s.width,y:s.y+s.height/2}:r===0||r===1?n=new Je(e.symbolLocations[0].x,e.symbolLocations[0].y):(r===2||r===3)&&t.type==="Candle"?n=new Je(e.symbolLocations[1].x,e.symbolLocations[1].y):h?n={x:s.x+s.width/2,y:s.y}:n={x:s.x+s.width,y:s.y+s.height/2};if(r>1&&t.type==="HiloOpenClose")if(t.chart.requireInvertedAxis){var u=s.height;n.y=s.y+u/2+2*(r===2?1:-1)}else{var c=s.width;n.x=s.x+c/2+2*(r===2?1:-1)}return n},o.prototype.calculateRectPosition=function(e,t,i,r,n,s,a,l){if(n.chart.chartAreaType==="PolarRadar")return null;var h=5,u=this.margin,c=n.marker.dataLabel.enableRotation||this.inverted?s.width:s.height;switch(r==="Bottom"&&n.type==="StackingColumn"&&!this.inverted&&t.height<s.height?this.extraSpace=this.borderWidth+(Math.abs(t.height-s.height/2)<h?0:h):this.extraSpace=this.borderWidth+c/2+(r!=="Outer"&&n.type.indexOf("Column")>-1&&Math.abs(t.height-s.height)<h?0:h),n.type==="StackingColumn100"||n.type==="StackingBar100"?r=r==="Outer"?"Top":r:n.type.indexOf("Range")>-1?r=r==="Outer"||r==="Top"?r:"Auto":n.type==="Waterfall"&&(r=r==="Auto"?"Middle":r),r){case"Bottom":e=this.inverted?i?e+(n.type==="Waterfall"?+this.extraSpace+u.left+this.markerHeight:+t.width-this.extraSpace-u.left):e-t.width+this.extraSpace+u.right:i?e+(n.type==="Waterfall"?-this.extraSpace-u.top-this.markerHeight:-t.height+this.extraSpace+u.top):e+t.height-this.extraSpace-u.bottom;break;case"Middle":e=e=this.inverted?i?e+t.width/2:e-t.width/2:i?e-t.height/2:e+t.height/2;break;case"Auto":e=this.calculateRectActualPosition(e,t,i,n,s,a,l);break;default:this.extraSpace+=this.errorHeight,e=this.calculateTopAndOuterPosition(e,t,r,n,a,this.extraSpace,i,l);break}var d=this.inverted?e<t.x||e>t.x+t.width:e<t.y||e>t.y+t.height;this.fontBackground=d?this.fontBackground==="transparent"?this.chartBackground:this.fontBackground:this.fontBackground==="transparent"?l.color||n.interior:this.fontBackground;var p=n.chart.series.length;if(r==="Outer"&&n.type.indexOf("Stacking")>-1&&p-1>n.index){for(var f=void 0,v=void 0,m=n.index+1;m<p;m++)if(f=n.chart.series[m],v=f.points[l.index],f.type.indexOf("Stacking")>-1&&f.type.indexOf("100")===-1){this.fontBackground=v&&(v.yValue<0&&l.yValue<0||v.yValue>0&&l.yValue>0)?v?v.color:f.interior:this.fontBackground;break}}return e},o.prototype.calculatePathPosition=function(e,t,i,r,n,s){var a=5;switch(i.type.indexOf("Area")>-1&&i.type!=="RangeArea"&&i.type!=="SplineRangeArea"&&i.type!=="RangeStepArea"&&this.yAxisInversed&&i.marker.dataLabel.position!=="Auto"&&(t=t==="Top"?"Bottom":t==="Bottom"?"Top":t),this.fontBackground=this.fontBackground==="transparent"?this.chartBackground:this.fontBackground,t){case"Top":case"Outer":e=e-this.markerHeight-this.borderWidth-n.height/2-this.margin.bottom-a-this.errorHeight;break;case"Bottom":e=e+this.markerHeight+this.borderWidth+n.height/2+this.margin.top+a+this.errorHeight;break;case"Auto":e=this.calculatePathActualPosition(e,this.markerHeight,i,r,n,s);break}return e},o.prototype.isDataLabelShape=function(e){this.isShape=e.color!=="transparent"||e.border.width>0,this.borderWidth=e.border.width,this.isShape||(this.margin={left:0,right:0,bottom:0,top:0})},o.prototype.calculateRectActualPosition=function(e,t,i,r,n,s,a){for(var l,h,u=!0,c=0,d=this.chart.dataLabelCollections,p=r.type.indexOf("Range")!==-1||r.type==="Hilo"?2:4;u&&c<p;){var f=this.getPosition(c);this.fontBackground=r.marker.dataLabel.fill,r.type.indexOf("Stacking")>-1&&f==="Outer"&&(f="Top",c++),l=this.calculateRectPosition(e,t,i,f,r,n,s,a),this.inverted?(h=Rm(new Je(l,this.locationY),n,this.margin),u=h.x<0||kc(h,d,r.clipRect)||h.x+h.width>r.clipRect.width):(r.marker.dataLabel.enableRotation&&(n.width=n.width-a.regions[0].width/10),h=Rm(new Je(this.locationX,l),n,this.margin),u=h.y<0||kc(h,d,r.clipRect)||h.y>r.clipRect.height,r.marker.dataLabel.template===null&&u!==!0&&(u=h.y/2+n.height+(f==="Outer"?a.regions[0].height+this.extraSpace:a.regions[0].height-2*this.extraSpace)>r.clipRect.height)),c++}return l},o.prototype.calculateAlignment=function(e,t,i,r){switch(i){case"Far":t=this.inverted?r?t-e:t+e:r?t+e:t-e;break;case"Near":t=this.inverted?r?t+e:t-e:r?t-e:t+e;break}return t},o.prototype.calculateTopAndOuterPosition=function(e,t,i,r,n,s,a,l){var h=this.margin,u;switch(r.type){case"RangeColumn":case"RangeArea":case"RangeStepArea":case"SplineRangeArea":case"Hilo":u=n===0&&!this.yAxisInversed||n===1&&this.yAxisInversed,e=this.updateLabelLocation(i,e,s,h,t,u);break;case"Candle":u=(n===0||n===2)&&!this.yAxisInversed||(n===1||n===3)&&this.yAxisInversed,e=this.updateLabelLocation(i,e,s,h,t,u,n>1);break;case"HiloOpenClose":n<=1?(u=n===0&&!this.yAxisInversed||n===1&&this.yAxisInversed,e=this.updateLabelLocation(i,e,s,h,t,u)):this.yAxisInversed?e=this.inverted?e-s-h.right:e+s+h.top:e=this.inverted?e+s+h.left:e-s-h.bottom;break;default:a&&i==="Top"||!a&&i==="Outer"||i==="Top"&&r.visiblePoints[l.index].yValue===0?e=this.inverted?e+(a&&r.type==="Waterfall"?+t.width-s-h.left:+s+h.left+this.markerHeight):e+(a&&r.type==="Waterfall"?-t.height+s+h.bottom:-s-h.bottom-this.markerHeight):e=this.inverted?e+(a&&r.type==="Waterfall"?+t.width+s+h.top:-s-h.right-this.markerHeight):e+(a&&r.type==="Waterfall"?-t.height-s-h.top:+s+h.top+this.markerHeight);break}return e},o.prototype.updateLabelLocation=function(e,t,i,r,n,s,a){return a===void 0&&(a=!1),this.inverted?s?t=e==="Outer"&&!a?t+i+r.left+this.markerHeight:t-i-r.right-this.markerHeight:t=e==="Outer"&&!a?t-n.width-i-r.right-this.markerHeight:t-n.width+i+r.left+this.markerHeight:s?t=e==="Outer"&&!a?t-i-r.bottom-this.markerHeight:t+i+r.top+this.markerHeight:t=e==="Outer"&&!a?t+n.height+i+r.top+this.markerHeight:t+n.height-i-r.bottom-this.markerHeight,t},o.prototype.calculatePathActualPosition=function(e,t,i,r,n,s){var a=i.points,l=r.index,h=a[l].yValue,u,c=a.length-1>l?a[l+1]:null,d=l>0?a[l-1]:null,p,f=!0,v,m,y,S=this.chart.dataLabelCollections;if(i.type==="Bubble")u="Top";else if(i.type.indexOf("Step")>-1)u="Top",l&&(u=!d||!d.visible||h>d.yValue!==this.yAxisInversed||h===d.yValue?"Top":"Bottom");else if(i.type==="BoxAndWhisker")s===1||s===3||s>4?u=i.yAxis.isAxisInverse?"Bottom":"Top":s===2||s===4?u=i.yAxis.isAxisInverse?"Top":"Bottom":(f=!1,u="Middle",p=this.calculatePathPosition(e,u,i,r,n,s));else if(l===0)u=!c||!c.visible||h>c.yValue||h<c.yValue&&this.yAxisInversed?"Top":"Bottom";else if(l===a.length-1)u=!d||!d.visible||h>d.yValue||h<d.yValue&&this.yAxisInversed?"Top":"Bottom";else if(!c.visible&&!(d&&d.visible))u="Top";else if(!c.visible||!d)u=c.yValue>h||d&&d.yValue>h?"Bottom":"Top";else{var b=(c.yValue-d.yValue)/2,w=b*l+(c.yValue-b*(l+1));u=this.yAxisInversed?w<h?"Bottom":"Top":w<h?"Top":"Bottom"}for(m=u==="Bottom",y=["Outer","Top","Bottom","Middle","Auto"].indexOf(u);f&&y<4;)p=this.calculatePathPosition(e,this.getPosition(y),i,r,n,s),v=Rm(new Je(this.locationX,p),n,this.margin),f=v.y<0||kc(v,S,i.clipRect)||v.y+v.height>i.clipRect.height,y=m?y-1:y+1,m=!1;return p},o.prototype.doDataLabelAnimation=function(e,t){for(var i=e.shapeElement.childNodes,r=e.textElement.childNodes,n=e.animation.delay+e.animation.duration,s=e.chart.animated?e.chart.duration:200,a,l=t?1:r.length,h,u=0;u<l;u++)h=r[u],t?(t.style.visibility="hidden",Zw(t,n,s,"ZoomIn")):(a=new Je(+h.getAttribute("x")+ +h.getAttribute("width")/2,+h.getAttribute("y")+ +h.getAttribute("height")/2),zc(h,n,e.animation.duration,e,null,a,!0),i[u]&&(h=i[u],a=new Je(+h.getAttribute("x")+ +h.getAttribute("width")/2,+h.getAttribute("y")+ +h.getAttribute("height")/2),zc(h,n,e.animation.duration,e,null,a,!0)))},o.prototype.getPosition=function(e){return["Outer","Top","Bottom","Middle","Auto"][e]},o.prototype.getModuleName=function(){return"DataLabel"},o.prototype.destroy=function(){},o}();var QW=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),TF=function(o){QW(e,o);function e(t){var i=o.call(this,t)||this;return i.library=i,i.addEventListener(),i}return e.prototype.addEventListener=function(){this.chart.isDestroyed||(this.chart.on(B.touchMoveEvent,this.mouseMove,this),this.chart.on("click",this.click,this),this.chart.on(B.touchEndEvent,this.mouseEnd,this))},e.prototype.removeEventListener=function(){this.chart.isDestroyed||(this.chart.off(B.touchMoveEvent,this.mouseMove),this.chart.off("click",this.click),this.chart.off(B.touchEndEvent,this.mouseEnd))},e.prototype.mouseMove=function(t){if(this.chart.legendSettings.visible&&!this.chart.isTouch&&(this.move(t),this.chart.highlightModule&&(this.chart.highlightMode!=="None"||this.chart.legendSettings.enableHighlight)))for(var i=[this.legendID+"_text_",this.legendID+"_shape_marker_",this.legendID+"_shape_",this.legendID+"_g_"],r=t.target.id,n=void 0,s=0,a=i;s<a.length;s++){var l=a[s];if(r.indexOf(l)>-1){n=parseInt(r.split(l)[1],10),this.chart.highlightModule.legendSelection(this.chart,n,t.target,t.type);break}}},e.prototype.mouseEnd=function(t){this.chart.legendSettings.visible&&this.chart.isTouch&&this.move(t)},e.prototype.getLegendOptions=function(t,i){this.legendCollections=[];var r,n,s,a=[];this.isRtlEnable=i.enableRtl,this.isReverse=!this.isRtlEnable&&i.legendSettings.reverse,t.length>1&&(this.legend.mode="Series");for(var l=0,h=t;l<h.length;l++){var u=h[l];if(this.legend.mode==="Series")u.category!=="Indicator"&&(r=i.chartAreaType==="PolarRadar"?u.drawType:u.type,s=!u.marker.visible&&r.indexOf("Line")>-1&&r.indexOf("Area")===-1?u.dashArray:"",n=u.pointColorMapping&&u.points.length>0&&u.points[0].interior?u.points[0].interior:u.interior,this.legendCollections.push(new qh(u.name,n,u.legendShape,u.category==="TrendLine"?this.chart.series[u.sourceIndex].trendlines[u.index].visible:u.visible,r,u.legendImageUrl?u.legendImageUrl:u.type==="Scatter"&&u.marker.shape==="Image"?u.marker.imageUrl:"",u.marker.shape,u.marker.visible,null,null,s)));else if(this.legend.mode==="Point")for(var c=0,d=u.points;c<d.length;c++){var p=d[c];r=i.chartAreaType==="PolarRadar"?u.drawType:u.type,n=p.interior?p.interior:u.interior,this.legendCollections.push(new qh(p.x.toString(),n,u.legendShape,u.category==="TrendLine"?this.chart.series[u.sourceIndex].trendlines[u.index].visible:p.visible,r,u.type==="Scatter"&&u.marker.shape==="Image"?u.marker.imageUrl:"",u.marker.shape,u.marker.visible))}else if(this.legend.mode==="Range")for(var f=0,v=u.points;f<v.length;f++){var p=v[f];r=i.chartAreaType==="PolarRadar"?u.drawType:u.type,n=p.interior?p.interior:u.interior;var m="Others";if(a.indexOf(n)<0&&(a.push(n),i.rangeColorSettings.length>=1&&i.rangeColorSettings[0].colors.length===1)){for(var y=0,S=i.rangeColorSettings;y<S.length;y++){var b=S[y];b.colors[0]===n&&(m=b.label)}this.legendCollections.push(new qh(m,n,u.legendShape,u.category==="TrendLine"?this.chart.series[u.sourceIndex].trendlines[u.index].visible:p.visible,r,u.type==="Scatter"&&u.marker.shape==="Image"?u.marker.imageUrl:"",u.marker.shape,u.marker.visible))}}else if(this.legendCollections.length===0&&i.rangeColorSettings.length>0){var w=i.rangeColorSettings[0].start.toString(),I=i.rangeColorSettings[i.rangeColorSettings.length-1].end.toString();this.legendCollections.push(new qh(w,u.interior,"Rectangle",!0,r,"",u.marker.shape,u.marker.visible)),this.legendCollections.push(new qh(I,u.interior,"Rectangle",!0,r,"",u.marker.shape,u.marker.visible))}}this.isReverse&&i.legendSettings.mode!=="Gradient"&&this.legendCollections.reverse()},e.prototype.getLegendBounds=function(t,i,r){this.calculateLegendTitle(r,i),this.isTitle=!!r.title,this.chartRowCount=1,this.rowHeights=[],this.columnHeights=[],this.pageHeights=[];var n=r.padding,s=r.titlePosition,a=0,l,h=0,u=this.arrowWidth,c=this.arrowHeight,d=this.isVertical&&!r.enablePages?c:0,p=this.isTitle&&s==="Top"?this.legendTitleSize.height+this.fivePixel:0;p=this.isTitle&&this.isVertical&&s!=="Top"?this.legendTitleSize.height+this.fivePixel:p,this.isVertical?h=r.width?0:t.width/100*5:a=r.height?0:t.height/100*5,i.height+=a,i.width+=h;var f=r.shapeWidth,v=r.shapePadding,m=0,y=0,S=0,b=0,w=0,I=0,x=0,M,D=!1;this.maxItemHeight=Math.max(Ze("MeasureText",r.textStyle,this.chart.themeStyle.legendLabelFont).height,r.shapeHeight);var A=r.layout==="Auto"&&r.maximumColumns>0;if(r.fixedWidth)for(var L=0;L<this.legendCollections.length;L++){var T=f+v+(this.isVertical||L===0?n:this.itemPadding)+(r.maximumLabelWidth?r.maximumLabelWidth:Ze(this.legendCollections[L].text,r.textStyle,this.chart.themeStyle.legendLabelFont).width);this.maxWidth=Math.max(this.maxWidth,T)}for(var L=0;L<this.legendCollections.length;L++)if(l=this.legendCollections[L],Um.test(l.text)&&(l.text=DN(l.text,Um)),CN.test(l.text)&&(l.text=DN(l.text,CN)),M={fill:l.fill,text:l.text,shape:l.shape,markerShape:l.markerShape,name:gN,cancel:!1},this.chart.trigger(gN,M),l.render=!M.cancel,l.text=M.text,l.fill=M.fill,l.shape=M.shape,l.markerShape=M.markerShape,l.textSize=Ze(l.text,r.textStyle,this.chart.themeStyle.legendLabelFont),f=l.text?r.shapeWidth:0,v=l.text?r.shapePadding:0,l.render&&l.text){D=!0,S=r.fixedWidth?this.maxWidth:f+v+(r.maximumLabelWidth?r.maximumLabelWidth:l.textSize.width)+(!this.isVertical||r.layout==="Horizontal"?L===0||w===1&&I>0&&r.layout==="Horizontal"?n:this.itemPadding:n),y=y+S,!r.enablePages&&!this.isVertical&&(x=this.isTitle&&s!=="Top"?this.legendTitleSize.width+this.fivePixel:0,x+=u),this.getLegendHeight(l,r,i,y,this.maxItemHeight,n),(A?w===r.maximumColumns:r.layout==="Vertical"||i.width<n+y+x||this.isVertical&&r.layout==="Auto")&&(m=Math.max(m,y+n+x-(this.isVertical&&this.legend.layout==="Auto"?0:S)),I===0&&S!==y&&(I=1),y=this.isVertical&&this.legend.layout==="Auto"?0:S,I++,w=0,b=d);var k=I>0?I-1:0;this.rowHeights[k]=Math.max(this.rowHeights[k]?this.rowHeights[k]:0,Math.max(l.textSize.height,r.shapeHeight)),this.columnHeights[w]=(this.columnHeights[w]?this.columnHeights[w]:0)+Math.max(l.textSize.height,r.shapeHeight)+(this.isVertical||I>0&&this.legend.itemPadding?L===0?n:this.itemPadding:n),w++}b=Math.max.apply(null,this.columnHeights)+n+p,b=Math.max(b,this.maxItemHeight+n+n+p),r.layout==="Horizontal"&&(b=this.maxItemHeight+n*2+p+this.pageButtonSize+r.border.width),this.isPaging=(i.height<b||r.layout==="Horizontal"&&this.rowHeights.length>1)&&!A,this.isPaging&&!r.enablePages&&(this.isVertical||(b=this.maxItemHeight+n+n+(s==="Top"?p:0))),this.totalPages=I,A&&this.maxWidth&&r.fixedWidth&&(y=this.maxWidth*r.maximumColumns,this.isPaging=!1),(!this.isPaging||this.legend.layout!=="Auto")&&!this.isVertical&&(y+=this.isTitle&&s!=="Top"?this.fivePixel+this.legendTitleSize.width+this.fivePixel:0),D?this.setBounds(Math.max(y+n,m),b,r,i):this.setBounds(0,0,r,i)},e.prototype.getLegendHeight=function(t,i,r,n,s,a){var l=t.textSize.width,h=i.shapePadding+a*2+i.shapeWidth;switch(i.textWrap){case"Wrap":case"AnyWhere":l>i.maximumLabelWidth||l+n>r.width?t.textCollection=ol(t.text,i.maximumLabelWidth?Math.min(i.maximumLabelWidth,r.width-h):r.width-h,i.textStyle,this.chart.enableRtl,null,null,this.chart.themeStyle.legendLabelFont):t.textCollection.push(t.text),t.textSize.height=s*t.textCollection.length;break}},e.prototype.getRenderPoint=function(t,i,r,n,s,a,l){var h=this.legend.padding,u=this.legend.fixedWidth?this.maxWidth:r+(this.legend.maximumLabelWidth?this.legend.maximumLabelWidth:n.textSize.width),c=n.location.x+(this.isRtlEnable?-u:u);(this.legend.layout==="Auto"&&this.legend.maximumColumns>0?a%this.legend.maximumColumns===0:this.legend.layout==="Vertical"||this.isWithinBounds(c,(this.legend.maximumLabelWidth?this.legend.maximumLabelWidth:t.textSize.width)+r-this.itemPadding,s)||this.isVertical&&this.legend.layout==="Auto")?(t.location.x=i.x,a!==l&&this.chartRowCount++,t.location.y=a===l?n.location.y:n.location.y+(this.isVertical&&this.legend.layout!=="Horizontal"&&!(this.legend.maximumColumns>0)?Math.max(n.textSize.height,this.legend.shapeHeight):this.rowHeights[this.chartRowCount-2])+(this.isVertical||this.chartRowCount>1&&this.legend.itemPadding?this.itemPadding:h)):(t.location.x=a===l?n.location.x:c,t.location.y=n.location.y);var d=this.isRtlEnable?t.location.x-r+this.itemPadding+this.legend.shapeWidth/2-this.legendBounds.x:this.legendBounds.x+this.legendBounds.width-(t.location.x+r-this.itemPadding-this.legend.shapeWidth/2);!this.isVertical&&this.isPaging&&!this.legend.enablePages&&(d=this.legendBounds.width-t.location.x-this.fivePixel),d=this.legend.maximumLabelWidth?Math.min(this.legend.maximumLabelWidth,d):d,this.legend.textOverflow==="Ellipsis"&&this.legend.textWrap==="Normal"&&(t.text=js(+d.toFixed(4),t.text,this.legend.textStyle,this.chart.enableRtl,this.chart.themeStyle.legendLabelFont))},e.prototype.isWithinBounds=function(t,i,r){return this.isRtlEnable?t-i<r.x-this.legend.shapeWidth/2:t+i>r.x+r.width+this.legend.shapeWidth/2},e.prototype.LegendClick=function(t,i){var r=this.chart,n=r.legendSettings.mode==="Series"?t:0,s=this.isReverse?this.legendCollections.length-1-t:t,a=r.visibleSeries[n],l=this.legendCollections[s],h="isProtectedOnChange";if(r.legendSettings.mode==="Series"){var u={legendText:l.text,legendShape:l.shape,chart:r.isBlazor?{}:r,series:a,points:a.points,name:Xl,cancel:!1};this.chart.trigger(Xl,u),a.legendShape=u.legendShape,u.cancel||(a.fill!==null&&(r.visibleSeries[t].interior=a.fill),r.legendSettings.toggleVisibility?(a.chart[h]=!0,a.category==="TrendLine"?!r.series[a.sourceIndex].trendlines[a.index].visible&&r.series[a.sourceIndex].visible?r.series[a.sourceIndex].trendlines[a.index].visible=!0:r.series[a.sourceIndex].trendlines[a.index].visible=!1:this.changeSeriesVisiblity(a,a.visible),l.visible=a.category==="TrendLine"?r.series[a.sourceIndex].trendlines[a.index].visible:a.visible,this.refreshLegendToggle(r,a),r.highlightModule&&r.legendSettings.enableHighlight&&r.highlightModule.legendSelection(r,t,i.target,"mousemove")):r.highlightModule?r.highlightModule.legendSelection(r,t,i.target,i.type):r.selectionModule&&r.selectionModule.legendSelection(r,t,i.target,i.type),a.chart[h]=!1)}else if(r.legendSettings.mode==="Point"){var c=a.points[t],u={legendText:l.text,legendShape:l.shape,chart:r.isBlazor?{}:r,series:a,points:[c],name:Xl,cancel:!1};if(this.chart.trigger(Xl,u),r.legendSettings.toggleVisibility&&!u.cancel){c.visible=!c.visible;var d=this.legendCollections[t];d.visible=c.visible,this.refreshLegendToggle(r,a)}}else if(r.legendSettings.mode==="Range"){for(var p=[],d=this.legendCollections[t],f=0,v=a.points;f<v.length;f++){var c=v[f];d.fill===(c.interior||a.interior)&&p.push(c)}var u={legendText:l.text,legendShape:l.shape,chart:r.isBlazor?{}:r,series:a,points:p,name:Xl,cancel:!1};if(this.chart.trigger(Xl,u),r.legendSettings.toggleVisibility&&!u.cancel){d.visible=!d.visible;for(var m=0,y=p;m<y.length;m++){var c=y[m];c.visible=!c.visible}this.refreshLegendToggle(r,a)}}},e.prototype.refreshLegendToggle=function(t,i){var r=[];if(t.selectionModule&&(r=he([],t.selectionModule.selectedDataIndexes,null,!0)),t.svgObject.childNodes.length>0&&!t.enableAnimation&&!t.enableCanvas){for(;t.svgObject.lastChild;)t.svgObject.removeChild(t.svgObject.lastChild);Ue(t.svgObject)}t.animateSeries=!1,t.redraw=t.enableAnimation,i.isLegendClicked=!0,t.rotatedDataLabelCollections=[],ni(Xn(t.element.id+"_Secondary_Element").querySelectorAll(".ejSVGTooltip")[0]),Xm(t),this.redrawSeriesElements(i,t),t.removeSvg(),t.refreshAxis(),i.refreshAxisLabel(),this.refreshSeries(t.visibleSeries);for(var n=0,s=t.visibleSeries;n<s.length;n++){var a=s[n];g(a)||t.markerRender.removeHighlightedMarker(a,null,!0)}t.refreshBound(),t.trigger("loaded",{chart:t}),r.length>0&&(t.selectionModule.selectedDataIndexes=r,t.selectionModule.redrawSelection(t,t.selectionMode)),!t.enableCanvas&&t.highlightModule&&(t.highlightMode!=="None"||t.legendSettings.enableHighlight)&&t.highlightModule.redrawSelection(t,t.highlightMode),t.redraw=!1,i.isLegendClicked=!1},e.prototype.changeSeriesVisiblity=function(t,i){t.visible=!i,this.isSecondaryAxis(t.xAxis)&&(t.xAxis.internalVisibility=t.xAxis.series.some(function(r){return r.visible})),(this.isSecondaryAxis(t.yAxis)||t.category==="Pareto"&&t.type==="Line")&&(t.yAxis.internalVisibility=t.yAxis.series.some(function(r){return r.visible})),t.trendlines.length&&t.visible&&t.trendlines.forEach(function(r){r.visible=!0})},e.prototype.isSecondaryAxis=function(t){return this.chart.axes.indexOf(t)>-1},e.prototype.redrawSeriesElements=function(t,i){if(!i.redraw)return null;ni(i.element.id+"_Series_"+(t.index===void 0?t.category:t.index)+"_DataLabelCollections")},e.prototype.refreshSeries=function(t){for(var i=0,r=t;i<r.length;i++){var n=r[i];if(n.type.indexOf("Spline")>-1){var s=n.type.indexOf("Area")>-1||n.drawType.indexOf("Area")>-1,a=n.type.indexOf("Range")>-1;this.chart["spline"+(s?a?"RangeArea":"Area":"")+"SeriesModule"].findSplinePoint(n)}n.visible&&(n.position=void 0)}},e.prototype.click=function(t){var i=this;if(this.chart.legendSettings.visible){for(var r=this.chart.mouseX,n=this.chart.mouseY,s=[],a=t.target.id.indexOf("_chart_legend_g_")>-1?t.target.firstChild.id:t.target.id,l=[this.legendID+"_text_",this.legendID+"_shape_marker_",this.legendID+"_shape_"],h,u=0,c=l;u<c.length;u++){var d=c[u];if(a.indexOf(d)>-1){h=parseInt(a.split(d)[1],10),this.LegendClick(h,t);break}}a.indexOf(this.legendID+"_pageup")>-1?this.changePage(t,!0):a.indexOf(this.legendID+"_pagedown")>-1&&this.changePage(t,!1),this.chart.enableCanvas&&this.pagingRegions.length&&this.checkWithinBounds(r,n),s=this.legendRegions.filter(function(p){return Oi(r,n+(i.isPaging?(i.currentPageNumber-1)*i.translatePage(i.chart.enableCanvas,null,1,2):0),p.rect)}),s.length&&this.chart.enableCanvas&&this.LegendClick(s[0].index,t)}},e.prototype.checkWithinBounds=function(t,i){var r=this.chart.renderer,n=this.legendBounds,s=this.chart.legendSettings.border.width,a=new Ae(n.x,n.y,n.width,n.height);if(a.x=a.x-s/2,a.y=a.y-s/2,a.width=a.width+s,a.height=a.height+s,Oi(t,i,this.pagingRegions[0]))return this.isRtlEnable?this.canvasPageUp(r,a,n):this.canvasPageDown(r,a,n),null;if(Oi(t,i,this.pagingRegions[1]))return this.isRtlEnable?this.canvasPageDown(r,a,n):this.canvasPageUp(r,a,n),null},e.prototype.canvasPageDown=function(t,i,r){--this.currentPageNumber>0?(this.legendRegions=[],t.clearRect(i),t.canvasClip(new as("legendClipPath","transparent",{width:0,color:""},null,i)),this.renderLegend(this.chart,this.legend,r),t.canvasRestore()):++this.currentPageNumber},e.prototype.canvasPageUp=function(t,i,r){++this.currentPageNumber>0&&this.currentPageNumber<=this.totalNoOfPages?(this.legendRegions=[],t.clearRect(i),t.canvasClip(new as("legendClipPath","transpaent",{width:0,color:""},null,i)),this.renderLegend(this.chart,this.legend,r),t.canvasRestore()):--this.currentPageNumber},e.prototype.getModuleName=function(){return"Legend"},e.prototype.destroy=function(){this.removeEventListener()},e}(pF);var ty=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ot=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},XW=function(o){ty(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ot([C(null)],e.prototype,"content",void 0),ot([C("0")],e.prototype,"x",void 0),ot([C("0")],e.prototype,"y",void 0),ot([C("Pixel")],e.prototype,"coordinateUnits",void 0),ot([C("Chart")],e.prototype,"region",void 0),ot([C("Middle")],e.prototype,"verticalAlignment",void 0),ot([C("Center")],e.prototype,"horizontalAlignment",void 0),ot([C(null)],e.prototype,"description",void 0),e}(Re),$W=function(o){ty(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ot([C(!1)],e.prototype,"visible",void 0),ot([C(!0)],e.prototype,"showZero",void 0),ot([C(null)],e.prototype,"name",void 0),ot([C("transparent")],e.prototype,"fill",void 0),ot([C("Inside")],e.prototype,"position",void 0),ot([C(5)],e.prototype,"rx",void 0),ot([C(5)],e.prototype,"ry",void 0),ot([C(0)],e.prototype,"angle",void 0),ot([C(!1)],e.prototype,"enableRotation",void 0),ot([be({width:null,color:null},Zn)],e.prototype,"border",void 0),ot([be({fontFamily:null,size:null,fontStyle:null,fontWeight:null,color:null},ua)],e.prototype,"font",void 0),ot([be({},Fc)],e.prototype,"connectorStyle",void 0),ot([C(null)],e.prototype,"template",void 0),ot([C("")],e.prototype,"format",void 0),ot([C(null)],e.prototype,"maxWidth",void 0),ot([C("Ellipsis")],e.prototype,"textOverflow",void 0),ot([C("Normal")],e.prototype,"textWrap",void 0),e}(Re),KW=function(o){ty(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ot([C("50%")],e.prototype,"x",void 0),ot([C("50%")],e.prototype,"y",void 0),e}(Re),TN=function(){function o(){this.visible=!0,this.symbolLocation=null,this.region=null,this.labelRegion=null,this.labelVisible=!0,this.regions=null,this.isExplode=!1,this.isClubbed=!1,this.isSliced=!1,this.argsData=null,this.isLabelUpdated=null,this.initialLabelRegion=null}return o}(),ZW=function(o){ty(e,o);function e(){var t=o!==null&&o.apply(this,arguments)||this;return t.points=[],t.clubbedPoints=[],t.sumOfPoints=0,t.isRectSeries=!0,t.clipRect=new Ae(0,0,0,0),t.category="Series",t.rightSidePoints=[],t.leftSidePoints=[],t}return e.prototype.refreshDataManager=function(t,i){var r=this;this.accumulation=t,this.radius=this.radius?this.radius:B.isDevice&&this.dataLabel.position==="Outside"?"40%":"80%";var n=this.dataSource||t.dataSource;if(!(n instanceof re)&&g(this.query)){this.dataManagerSuccess({result:n,count:n.length},t,i);return}var s=this.dataModule.getData(this.dataModule.generateQuery().requiresCount());s.then(function(a){return r.dataManagerSuccess(a,t)})},e.prototype.dataManagerSuccess=function(t,i,r){r===void 0&&(r=!0);var n={name:Hm,series:this,data:t.result};i.allowServerDataBinding=!1,i.trigger(Hm,n),this.resultData=t.result!==""?t.result:[],!i.isBlazor&&!r&&this.getPoints(this.resultData,i),(++i.seriesCounts===i.visibleSeries.length&&r||window.Blazor&&!r&&i.seriesCounts===1)&&(this.getPoints(this.resultData,i),i.refreshChart())},e.prototype.getPoints=function(t,i){var r=Object.keys(t).length;if(this.sumOfPoints=0,r===0)return this.points=[],null;this.findSumOfPoints(t),this.points=[],this.clubbedPoints=[],this.sumOfClub=0;for(var n,s=this.palettes.length?this.palettes:Qw(i.theme),a=Ni(this.groupTo,this.sumOfPoints),l=0;l<r;l++)n=this.setPoints(t,l,s,i),this.isClub(n,a,l)?(n.index=this.clubbedPoints.length,n.isExplode=!0,this.clubbedPoints.push(n),n.isSliced=!0):(g(n.y)&&(n.visible=!1),this.pushPoints(n,s));if(this.lastGroupTo=this.groupTo,this.sumOfClub>0){var h=this.generateClubPoint();this.pushPoints(h,s);var u=this.points.length-1;this.clubbedPoints.map(function(c){c.index+=u,c.color=h.color})}this.clubbedPoints.length&&this.explode&&this.type==="Pie"&&(this.explodeAll||this.points[this.points.length-1].index===this.explodeIndex)&&(this.points.splice(this.points.length-1,1),this.points=this.points.concat(this.clubbedPoints))},e.prototype.generateClubPoint=function(){var t=new TN;return t.isClubbed=!0,t.x="Others",t.y=this.sumOfClub,t.text=t.originalText=t.x+": "+this.sumOfClub,t.sliceRadius="80%",t},e.prototype.pushPoints=function(t,i){t.index=this.points.length,t.isExplode=this.explodeAll||t.index===this.explodeIndex,t.color=t.color||i[t.index%i.length],this.points.push(t)},e.prototype.isClub=function(t,i,r){if(!g(i)){if(this.groupMode==="Value"&&Math.abs(t.y)<=i)return this.sumOfClub+=Math.abs(t.y),!0;if(this.groupMode==="Point"&&r>=i)return this.sumOfClub+=Math.abs(t.y),!0}return!1},e.prototype.findSumOfPoints=function(t){for(var i=Object.keys(t).length,r=0;r<i;r++)!g(t[r])&&!g(t[r][this.yName])&&!isNaN(t[r][this.yName])&&(this.sumOfPoints+=Math.abs(t[r][this.yName]))},e.prototype.setPoints=function(t,i,r,n){var s=new TN;return s.x=V(this.xName,t[i]),s.y=V(this.yName,t[i]),s.legendImageUrl=V(this.legendImageUrl,t[i]),s.color=V(this.pointColorMapping,t[i]),s.text=s.originalText=V(this.dataLabel.name||"",t[i]),s.tooltip=V(this.tooltipMappingName||"",t[i]),s.sliceRadius=V(this.radius,t[i]),s.sliceRadius=g(s.sliceRadius)?"80%":s.sliceRadius,s.separatorY=n.intl.formatNumber(s.y,{useGrouping:n.useGroupingSeparator}),this.setAccEmptyPoint(s,i,t),s},e.prototype.renderSeries=function(t,i){var r=i?ce(t.element.id+"_Series_"+this.index):t.renderer.createGroup({id:t.element.id+"_Series_"+this.index});this.renderPoints(t,r,i);var n;t.accumulationDataLabelModule&&this.dataLabel.visible&&(n=t.renderer.createGroup({id:t.element.id+"_datalabel_Series_"+this.index}),n.style.visibility=(this.animation.enable&&Ut!=="Disable"||Ut==="Enable")&&t.animateSeries&&this.type==="Pie"?"hidden":"visible",this.renderDataLabel(t,n,i)),this.type==="Pie"&&(t.redraw||this.findMaxBounds(this.labelBound,this.accumulationBound),t.pieSeriesModule.animateSeries(t,this.animation,this,r,this.borderRadius,this.points)),!t.redraw&&t.accumulationLegendModule&&(this.labelBound.x-=t.explodeDistance,this.labelBound.y-=t.explodeDistance,this.labelBound.height+=t.explodeDistance-this.labelBound.y,this.labelBound.width+=t.explodeDistance-this.labelBound.x)},e.prototype.renderPoints=function(t,i,r,n,s,a){for(var l=t.element.id+"_Series_"+this.index+"_Point_",h,u,c=[],d=[],p=["Chessboard","Dots","DiagonalForward","Crosshatch","Pacman","DiagonalBackward","Grid","Turquoise","Star","Triangle","Circle","Tile","HorizontalDash","VerticalDash","Rectangle","Box","VerticalStripe","HorizontalStripe","Bubble"],f=0,v=this.points;f<v.length;f++){var m=v[f];m.percentage=+(m.y/this.sumOfPoints*100).toFixed(2);var y={cancel:!1,name:Zl,series:this,point:m,fill:m.color,border:this.isEmpty(m)?{width:this.emptyPointSettings.border.width,color:this.emptyPointSettings.border.color}:{width:this.border.width,color:this.border.color},pattern:this.applyPattern?p[m.index%p.length]:"None"};if(t.trigger(Zl,y),m.color=y.fill,u=m.color,this.applyPattern){var S=new MF(t);u=S.pattern(t,m.color,m.index,y.pattern,this.opacity)}h=new Ir(l+m.index,u,y.border.width||1,y.border.color||m.color,this.opacity,y.series.dashArray,""),this.funnelMode==="Trapezoidal"&&this.type==="Funnel"?(c.push(h),m.visible&&d.push(m)):t[$r(this.type)+"SeriesModule"].renderPoint(m,this,t,h,i,r,n,s,a)}this.funnelMode==="Trapezoidal"&&this.type==="Funnel"?t[$r(this.type)+"SeriesModule"].renderTrapezoidalFunnel(this,d,t,c,i,r):vt(!1,t.getSeriesElement(),i,r)},e.prototype.renderDataLabel=function(t,i,r){t.accumulationDataLabelModule.findAreaRect();var n=Xe("div",{id:t.element.id+"_Series_0_DataLabelCollections"});this.leftSidePoints=[],this.rightSidePoints=[];for(var s=[],a=[],l=0,h=this.points;l<h.length;l++){var u=h[l];u.visible&&(this.dataLabel.showZero||!this.dataLabel.showZero&&(u.y!==0||u.y===0&&this.emptyPointSettings.mode==="Zero"))&&t.accumulationDataLabelModule.renderDataLabel(u,this.dataLabel,i,this.points,this.index,n,r),u.midAngle>=90&&u.midAngle<=270?this.leftSidePoints.push(u):u.midAngle>=0&&u.midAngle<=90?a.push(u):s.push(u)}if(s.sort(function(d,p){return d.midAngle-p.midAngle}),a.sort(function(d,p){return d.midAngle-p.midAngle}),this.leftSidePoints.sort(function(d,p){return d.midAngle-p.midAngle}),this.rightSidePoints=s.concat(a),t.accumulationDataLabelModule.drawDataLabels(this,this.dataLabel,i,n,r),this.dataLabel.template!==null&&n.childElementCount){var c=t.accumulationDataLabelModule.drawDataLabels.bind(t.accumulationDataLabelModule,this,this.dataLabel,i,n,r);t.isReact&&t.renderReactTemplates(c),vt(!1,ce(t.element.id+"_Secondary_Element"),n,r)}vt(!1,t.getSeriesElement(),i,r)},e.prototype.findMaxBounds=function(t,i){t.x=i.x<t.x?i.x:t.x,t.y=i.y<t.y?i.y:t.y,t.height=i.y+i.height>t.height?i.y+i.height:t.height,t.width=i.x+i.width>t.width?i.x+i.width:t.width},e.prototype.findMaxLabelWidth=function(){for(var t,i=0;i<this.points.length;i++)t=this.points[0].textSize.width,t<this.points[i].textSize.width&&(t=this.points[i].textSize.width);return t},e.prototype.setAccEmptyPoint=function(t,i,r){if(!(g(t.y)||isNaN(t.y)))return null;switch(t.color=this.emptyPointSettings.fill||t.color,this.emptyPointSettings.mode){case"Zero":t.y=0,t.visible=!0;break;case"Average":{var n=r[i-1]&&r[i-1][this.yName]||0,s=r[i+1]&&r[i+1][this.yName]||0;t.y=(Math.abs(n)+Math.abs(s))/2,this.sumOfPoints+=t.y,t.visible=!0;break}default:t.visible=!1;break}},e.prototype.setData=function(t,i){if(!t)return null;var r=!1;if(this.dataSource.length===t.length){r=!0;for(var n=0;n<t.length;n++)if(this.dataSource[n][this.xName]===t[n][this.xName]){var s=this.points[n],a=this.dataSource[n];a[this.yName]!==t[n][this.yName]&&(s.y=t[n][this.yName],this.dataSource[n]=t[n])}else{r=!1;break}}if(!r)this.dataSource=t;else{this.sumOfPoints=0;for(var l=[],n=0;n<this.resultData.length;n++)this.points[n]&&this.points[n].visible&&l.push(this.resultData[n]);this.findSumOfPoints(l),this.accumulation.redraw=this.borderRadius?!1:this.accumulation.enableAnimation,this.accumulation.animateSeries=!1;var h=this.accumulation.duration;this.accumulation.duration=g(i)?500:i,this.accumulation[$r(this.type)+"SeriesModule"].initProperties(this.accumulation,this),this.renderPoints(this.accumulation,ce(this.accumulation.element.id+"_Series_"+this.index),this.accumulation.redraw,null,null,!0),this.accumulation.centerLabel.text&&this.accumulation.renderCenterLabel(!0,!0),this.accumulation.annotationModule&&this.accumulation.annotationModule.renderAnnotations(ce(this.accumulation.element.id+"_Secondary_Element")),this.accumulation.accumulationDataLabelModule&&this.dataLabel.visible&&this.renderDataLabel(this.accumulation,ce(this.accumulation.element.id+"_datalabel_Series_"+this.index),this.accumulation.redraw),this.accumulation.redraw=!1,this.accumulation.duration=h}},e.prototype.addPoint=function(t,i){var r;this.accumulation.series[0].dataLabel.visible&&(r=this.findMaxLabelWidth()),this.dataSource.push(t),this.resultData=this.dataSource,this.sumOfPoints=0;for(var n=[],s=0;s<this.resultData.length;s++)this.points[s]&&this.points[s].visible?n.push(this.resultData[s]):s===this.resultData.length-1&&n.push(this.resultData[s]);this.findSumOfPoints(n);var a=this.points.length===0?0:this.points[this.points.length-1].index+1,l=this.palettes.length?this.palettes:Qw(this.accumulation.theme),h=this.setPoints(this.dataSource,a,l,this.accumulation);this.pushPoints(h,l),this.accumulation.redraw=this.borderRadius?!1:this.accumulation.enableAnimation;var u=this.accumulation.duration;this.accumulation.duration=g(i)?500:i,this.updateSeries(ce(this.accumulation.element.id+"_Series_"+this.index),r,"addPoint"),this.accumulation.redraw=!1,this.accumulation.duration=u},e.prototype.removePoint=function(t,i){var r=he([],this.dataSource,null,!0),n=this.accumulation.duration;if(r.length>0&&t>=0&&t<r.length){this.sumOfPoints=0;for(var s=[],a=0;a<this.dataSource.length;a++)a!==t&&this.points[a]&&this.points[a].visible&&s.push(this.dataSource[a]);r.splice(t,1),this.dataSource.splice(t,1),this.findSumOfPoints(s),this.accumulation.redraw=this.borderRadius?!1:this.accumulation.enableAnimation,this.accumulation.duration=g(i)?500:i,this.points.splice(t,1);for(var a=t;a<this.points.length;a++){var l=this.points[a];l.index=a,l.y=this.points[a].y}var h=ce(this.accumulation.element.id+"_Series_0_Point_"+this.points.length);h&&h.parentNode.removeChild(h),this.updateSeries(ce(this.accumulation.element.id+"_Series_"+this.index),void 0,"removePoint",t),this.accumulation.redraw=!1,this.accumulation.duration=n}},e.prototype.updateSeries=function(t,i,r,n){var s=this.accumulation[$r(this.type)+"SeriesModule"].radius,a=this.accumulation[$r(this.type)+"SeriesModule"].center,l;if(this.accumulation.legendSettings.visible){if(r==="addPoint")this.accumulation.accumulationLegendModule.legendCollections.push(new qh(this.points[this.points.length-1].x.toString(),this.points[this.points.length-1].color,this.legendShape,this.points[this.points.length-1].visible,this.type,this.points[this.points.length-1].legendImageUrl,null,null,this.points[this.points.length-1].index,this.index));else{this.accumulation.accumulationLegendModule.legendCollections.splice(n,1);for(var h=n;h<this.accumulation.accumulationLegendModule.legendCollections.length;h++)this.accumulation.accumulationLegendModule.legendCollections[h].pointIndex=h}if(this.accumulation.accumulationLegendModule.legendCollections.length>=1&&(l=this.accumulation.accumulationLegendModule.legendBounds,this.accumulation.accumulationLegendModule.calculateLegendBounds(this.accumulation.initialClipRect,this.accumulation.availableSize,null,l,!0),this.dataLabel&&this.dataLabel.position==="Outside"&&(this.accumulation.legendSettings.position==="Bottom"||this.accumulation.legendSettings.position==="Top")?l.height!==this.accumulation.accumulationLegendModule.legendBounds.height:l.width!==this.accumulation.accumulationLegendModule.legendBounds.width)){var u=this.accumulation.title?Ze(this.accumulation.title,this.accumulation.titleStyle,this.accumulation.themeStyle.chartTitleFont).height*this.accumulation.titleCollection.length:0,c=this.accumulation.subTitle?Ze(this.accumulation.subTitle,this.accumulation.subTitleStyle,this.accumulation.themeStyle.chartSubTitleFont).height*this.accumulation.subTitleCollection.length:0;this.accumulation.initialClipRect=new Ae(this.accumulation.margin.left,this.accumulation.margin.top,this.accumulation.availableSize.width,this.accumulation.availableSize.height),QN(this.accumulation.initialClipRect,new Ae(0,c+u,this.accumulation.margin.right+this.accumulation.margin.left,this.accumulation.margin.bottom+this.accumulation.margin.top)),this.accumulation.accumulationLegendModule.calculateLegendBounds(this.accumulation.initialClipRect,this.accumulation.availableSize,null)}}if(this.accumulation[$r(this.type)+"SeriesModule"].initProperties(this.accumulation,this),this.renderPoints(this.accumulation,t,this.accumulation.redraw,s,a,!0),l&&(this.accumulation.legendSettings.position==="Bottom"||this.accumulation.legendSettings.position==="Top"?l.height!==this.accumulation.accumulationLegendModule.legendBounds.height:l.width!==this.accumulation.accumulationLegendModule.legendBounds.width)&&this.accumulation.centerLabel.text&&this.accumulation.renderCenterLabel(!0,!0),this.accumulation.annotationModule&&this.accumulation.annotationModule.renderAnnotations(ce(this.accumulation.element.id+"_Secondary_Element")),this.accumulation.accumulationDataLabelModule&&this.dataLabel.visible){var d=this.accumulation.renderer.createGroup({id:this.accumulation.element.id+"_datalabel_Series_"+this.index});this.renderDataLabel(this.accumulation,d,this.accumulation.redraw)}this.accumulation.legendSettings.visible&&(this.type==="Pie"&&(this.dataLabel.visible&&this.points[this.points.length-1]&&this.points[this.points.length-1].textSize.width>i&&this.accumulation.legendSettings.position!=="Top"&&this.accumulation.legendSettings.position!=="Bottom"&&(this.accumulation.visibleSeries[0].findMaxBounds(this.accumulation.visibleSeries[0].labelBound,this.points[this.points.length-1].labelRegion),this.findMaxBounds(this.labelBound,this.accumulationBound),this.labelBound.x-=this.accumulation.explodeDistance,this.labelBound.y-=this.accumulation.explodeDistance,this.labelBound.height+=this.accumulation.explodeDistance-this.labelBound.y,this.labelBound.width+=this.accumulation.explodeDistance-this.labelBound.x),this.accumulation.accumulationLegendModule.getSmartLegendLocation(this.accumulation.visibleSeries[0].labelBound,this.accumulation.accumulationLegendModule.legendBounds,this.accumulation.margin)),this.accumulation.accumulationLegendModule.renderLegend(this.accumulation,this.accumulation.legendSettings,this.accumulation.accumulationLegendModule.legendBounds,this.accumulation.redraw,!0))},e.prototype.isEmpty=function(t){return t.color===this.emptyPointSettings.fill},ot([C("")],e.prototype,"dataSource",void 0),ot([C()],e.prototype,"query",void 0),ot([C("")],e.prototype,"xName",void 0),ot([C("")],e.prototype,"name",void 0),ot([C("")],e.prototype,"tooltipMappingName",void 0),ot([C("")],e.prototype,"yName",void 0),ot([C(!0)],e.prototype,"visible",void 0),ot([be({color:null,width:0},Zn)],e.prototype,"border",void 0),ot([be(null,$w)],e.prototype,"animation",void 0),ot([C("SeriesType")],e.prototype,"legendShape",void 0),ot([C("")],e.prototype,"legendImageUrl",void 0),ot([C("")],e.prototype,"pointColorMapping",void 0),ot([C(!1)],e.prototype,"applyPattern",void 0),ot([C(null)],e.prototype,"selectionStyle",void 0),ot([C(null)],e.prototype,"groupTo",void 0),ot([C("Value")],e.prototype,"groupMode",void 0),ot([be({},$W)],e.prototype,"dataLabel",void 0),ot([C([])],e.prototype,"palettes",void 0),ot([C(0)],e.prototype,"startAngle",void 0),ot([C(null)],e.prototype,"endAngle",void 0),ot([C(null)],e.prototype,"radius",void 0),ot([C("0")],e.prototype,"innerRadius",void 0),ot([C("Pie")],e.prototype,"type",void 0),ot([C(!0)],e.prototype,"enableTooltip",void 0),ot([C(!1)],e.prototype,"explode",void 0),ot([C("30%")],e.prototype,"explodeOffset",void 0),ot([C(!1)],e.prototype,"explodeAll",void 0),ot([C(null)],e.prototype,"explodeIndex",void 0),ot([be({mode:"Drop"},ON)],e.prototype,"emptyPointSettings",void 0),ot([C(0)],e.prototype,"gapRatio",void 0),ot([C("80%")],e.prototype,"width",void 0),ot([C("80%")],e.prototype,"height",void 0),ot([C("20%")],e.prototype,"neckWidth",void 0),ot([C("20%")],e.prototype,"neckHeight",void 0),ot([C("Linear")],e.prototype,"pyramidMode",void 0),ot([C("Standard")],e.prototype,"funnelMode",void 0),ot([C(1)],e.prototype,"opacity",void 0),ot([C("0")],e.prototype,"dashArray",void 0),ot([be({},So)],e.prototype,"accessibility",void 0),ot([C(0)],e.prototype,"borderRadius",void 0),e}(Re);function JW(o,e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(o===r.index)return r}return e[0]}function LF(o,e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r.index===o)return r}return null}var tx=function(){function o(e){this.accumulation=e}return Object.defineProperty(o.prototype,"center",{get:function(){return this.pieCenter||(this.accumulation.visibleSeries[0].type==="Pie"?this.accumulation.pieSeriesModule.pieBaseCenter:null)},set:function(e){this.pieCenter=e},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"radius",{get:function(){return this.pieRadius!==void 0?this.pieRadius:this.accumulation.pieSeriesModule.pieBaseRadius},set:function(e){this.pieRadius=e},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"labelRadius",{get:function(){return this.pieLabelRadius!==void 0?this.pieLabelRadius:this.accumulation.pieSeriesModule.pieBaseLabelRadius},set:function(e){this.pieLabelRadius=e},enumerable:!0,configurable:!0}),o.prototype.isCircular=function(){return this.accumulation.type==="Pie"},o.prototype.isVariousRadius=function(){return this.accumulation.pieSeriesModule.isRadiusMapped},o.prototype.processExplode=function(e){if(e.target.id.indexOf("_Series_")>-1||e.target.id.indexOf("_datalabel_")>-1){var t=$h(e.target.id).point;if(isNaN(t)||e.target.id.indexOf("_datalabel_")>-1&&this.accumulation.visibleSeries[0].points[t].labelPosition==="Outside")return null;this.explodePoints(t,this.accumulation),this.deExplodeAll(t,this.accumulation.enableAnimation?300:0)}},o.prototype.invokeExplode=function(){for(var e=this.accumulation.visibleSeries[0],t=this.accumulation.enableAnimation?300:0,i=0,r=e.points;i<r.length;i++){var n=r[i];n.isExplode&&n.y!==0&&this.pointExplode(n.index,n,t)}if(this.accumulation.accumulationSelectionModule&&this.accumulation.selectionMode!=="None"&&this.accumulation.accumulationSelectionModule.selectedDataIndexes.length)for(var s=0,a=this.accumulation.accumulationSelectionModule.selectedDataIndexes;s<a.length;s++){var l=a[s];this.explodePoints(l.point,this.accumulation,!0),this.deExplodeAll(l.point,t)}},o.prototype.deExplodeAll=function(e,t){for(var i=this.accumulation.element.id+"_Series_0_Point_",r=this.accumulation.visibleSeries[0].points,n=0,s=r;n<s.length;n++){var a=s[n];(e!==a.index&&!a.isSliced||a.isClubbed)&&(a.isExplode=!1,this.deExplodeSlice(a.index,i,t))}},o.prototype.explodePoints=function(e,t,i,r){i===void 0&&(i=!1);var n=t.visibleSeries[0],s=n.points,a=LF(e,s),l=!0,h=this.accumulation.enableAnimation?300:0;if(g(a))return null;var u=!i&&(a.isSliced||n.clubbedPoints.length&&s[s.length-1].index===n.clubbedPoints[n.clubbedPoints.length-1].index);n.type==="Pie"&&(u||a.isClubbed)&&(l=this.clubPointExplode(e,a,n,s,t,h,u)),l&&a.y!==0&&this.pointExplode(e,a,h,i,r)},o.prototype.getSum=function(e){var t=0;return e.map(function(i){t+=i.visible?i.y:0}),t},o.prototype.clubPointExplode=function(e,t,i,r,n,s,a){if(a===void 0&&(a=!1),t.isClubbed)return n.animateSeries=!1,r.splice(r.length-1,1),i.clubbedPoints.map(function(h){h.visible=!0,h.isExplode=!0}),n.visibleSeries[0].points=r.concat(i.clubbedPoints),this.deExplodeAll(e,s),i.sumOfPoints=this.getSum(n.visibleSeries[0].points),n.refreshChart(),!1;if(a||t.isSliced){n.animateSeries=!1,r.splice(r.length-i.clubbedPoints.length,i.clubbedPoints.length);var l=i.generateClubPoint();if(l.index=r.length,l.color=i.clubbedPoints[0].color,r.push(l),i.sumOfPoints=this.getSum(r),this.deExplodeAll(e,s),l.isExplode=!1,n.visibleSeries[0].points=r,n.refreshChart(),this.pointExplode(l.index,r[l.index],0,!0),l.isExplode=!1,this.deExplodeSlice(l.index,n.element.id+"_Series_0_Point_",s),t.isSliced)return!1}return!0},o.prototype.pointExplode=function(e,t,i,r,n){var s,a=this.accumulation.element.id+"_Series_0_Point_",l=this.accumulation;this.isCircular()?s=wn(t.midAngle,l.explodeDistance,this.center):s={x:t.labelRegion&&t.labelRegion.x<t.region.x?-l.explodeDistance:l.explodeDistance,y:0},this.isExplode(a+e)||r?(t.isExplode=!0,this.explodeSlice(e,s,a,this.center||{x:0,y:0},i,n)):(t.isExplode=!1,this.deExplodeSlice(e,a,i))},o.prototype.isExplode=function(e){var t=ce(e),i=t?t.getAttribute("transform"):null;return t&&(i==="translate(0, 0)"||i===null||i==="translate(0)")},o.prototype.deExplodeSlice=function(e,t,i){var r=ce(t+e),n=r?r.getAttribute("transform"):null;if(this.accumulation.enableAnimation&&r&&n&&n!=="translate(0, 0)"&&n!=="translate(0)"){var s=n.split("(")[1].split(")")[0].split(",");this.performAnimation(e,t,0,0,+s[0],+s[1]||0,i,!0)}else this.performAnimation(e,t,0,0,0,0,i,!0)},o.prototype.setTranslate=function(e,t,i,r){this.setElementTransform(t+e,i),this.setElementTransform(t+e+"_polygon",i),this.accumulation.visibleSeries[0].dataLabel.visible&&(t=this.accumulation.element.id+"_datalabel_Series_0_",this.setElementTransform(t+"shape_"+e,i),this.setElementTransform(t+"text_"+e,i+r),this.setElementTransform(t+"connector_"+e,i))},o.prototype.setElementTransform=function(e,t){var i=ce(e);i&&i.setAttribute("transform",t)},o.prototype.explodeSlice=function(e,t,i,r,n,s){s&&ce(this.accumulation.element.id+"_Series_0_Point_"+e).getAttribute("transform")?this.setElementTransform(i+e,"translate("+(t.x-r.x)+", "+(t.y-r.y)+")"):this.performAnimation(e,i,0,0,t.x-r.x,t.y-r.y,n)},o.prototype.performAnimation=function(e,t,i,r,n,s,a,l){var h=this,u=this.accumulation,c=t.split("_"),d=parseInt(t.split("_")[c.length-3],10),p=u.visibleSeries[d].points[e];if(a<=0)return this.setTranslate(e,t,"translate("+n+", "+s+")",p.transform),null;var f,v,m=this.accumulation.series[d].type==="Pie"&&this.accumulation.animateSeries&&this.accumulation.series[0].animation.enable?this.accumulation.series[0].animation.duration:0;new It({}).animate(Xe("div"),{duration:a,delay:m,progress:function(y){f=Pr(y.timeStamp,i,n,y.duration),v=Pr(y.timeStamp,r,s,y.duration),h.setTranslate(e,t,"translate("+(l?n-f:f)+", "+(l?s-v:v)+")",p.transform)},end:function(){h.setTranslate(e,t,"translate("+(l?i:n)+", "+(l?i:s)+")",p.transform)}})},o}(),e6=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),t6=function(o){e6(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return e.prototype.initProperties=function(t,i){this.accumulation=t,this.size=Math.min(t.initialClipRect.width,t.initialClipRect.height),this.initAngles(i);var r=parseInt(i.radius,10);if((i.radius.indexOf("%")!==-1||typeof r=="number")&&!isNaN(r))this.isRadiusMapped=!1,this.pieBaseRadius=Ni(i.radius,this.size/2),this.innerRadius=Ni(i.innerRadius,this.pieBaseRadius),this.pieBaseLabelRadius=i.dataLabel.position==="Inside"?(this.pieBaseRadius-this.innerRadius)/2+this.innerRadius:this.pieBaseRadius+Ni(i.dataLabel.connectorStyle.length||"4%",this.size/2);else{var n=[];this.isRadiusMapped=!0;for(var s=0;s<Object.keys(i.points).length;s++)i.points[s].sliceRadius.indexOf("%")!==-1?n[s]=Ni(i.points[s].sliceRadius,this.size/2):n[s]=parseInt(i.points[s].sliceRadius,10);var a=Math.min.apply(null,n),l=Math.max.apply(null,n);this.pieBaseRadius=this.seriesRadius=l,this.innerRadius=Ni(i.innerRadius,this.seriesRadius),this.innerRadius=this.innerRadius>a?this.innerRadius/2:this.innerRadius}this.radius=this.pieBaseRadius,this.labelRadius=this.pieBaseLabelRadius,t.explodeDistance=i.explode?Ni(i.explodeOffset,this.pieBaseRadius):0,this.findCenter(t,i),this.center=this.pieBaseCenter,t.redraw||this.defaultLabelBound(i,i.dataLabel.visible,i.dataLabel.position),this.totalAngle-=.001},e.prototype.getLabelRadius=function(t,i){return t.dataLabel.position==="Inside"?(Ni(i.sliceRadius,this.pieBaseRadius)-this.innerRadius)/2+this.innerRadius:Ni(i.sliceRadius,this.size/2)+Ni(t.dataLabel.connectorStyle.length||"4%",this.size/2)},e.prototype.findCenter=function(t,i){this.accumulation=t,this.pieBaseCenter={x:Ni(t.center.x,t.initialClipRect.width)+t.initialClipRect.x,y:Ni(t.center.y,t.initialClipRect.height)+t.initialClipRect.y};var r=this.getSeriesBound(i),n=new Je(r.x+r.width/2,r.y+r.height/2);this.pieBaseCenter.x+=this.pieBaseCenter.x-n.x,this.pieBaseCenter.y+=this.pieBaseCenter.y-n.y,this.accumulation.origin=this.pieBaseCenter},e.prototype.initAngles=function(t){var i=g(t.endAngle)?t.startAngle:t.endAngle;this.totalAngle=(i-t.startAngle)%360,this.startAngle=t.startAngle-90,this.totalAngle=this.totalAngle<=0?360+this.totalAngle:this.totalAngle,this.startAngle=(this.startAngle<0?this.startAngle+360:this.startAngle)%360},e.prototype.defaultLabelBound=function(t,i,r){var n=this.getSeriesBound(t);t.accumulationBound=n,t.labelBound=new Ae(n.x,n.y,n.width+n.x,n.height+n.y),i&&r==="Outside"&&(t.labelBound=new Ae(1/0,1/0,-1/0,-1/0))},e.prototype.getSeriesBound=function(t){var i=new Ae(1/0,1/0,-1/0,-1/0);this.initAngles(t);var r=this.startAngle,n=this.totalAngle,s=(this.startAngle+n)%360;s=s===0?360:s,t.findMaxBounds(i,this.getRectFromAngle(r)),t.findMaxBounds(i,this.getRectFromAngle(s)),t.findMaxBounds(i,new Ae(this.pieBaseCenter.x,this.pieBaseCenter.y,0,0));var a=(Math.floor(r/90)*90+90)%360,l=Math.floor(s/90)*90%360;l=l===0?360:l,(n>=90||l===a)&&(t.findMaxBounds(i,this.getRectFromAngle(a)),t.findMaxBounds(i,this.getRectFromAngle(l))),(r===0||r+n>=360)&&t.findMaxBounds(i,this.getRectFromAngle(0));for(var h=a===l?0:Math.floor(n/90),u=1;u<h;u++)a=a+90,(a<l||s<r||n===360)&&t.findMaxBounds(i,this.getRectFromAngle(a));return i.width-=i.x,i.height-=i.y,i},e.prototype.getRectFromAngle=function(t){var i=wn(t,this.pieBaseRadius,this.pieBaseCenter);return new Ae(i.x,i.y,0,0)},e.prototype.getPathArc=function(t,i,r,n,s,a,l,h){var u=r-i;u=u<0?u+360:u;var c=u<180?0:1;return!s&&s===0?this.getPiePath(t,wn(i,n,t),wn(r,n,t),n,c,a,h):this.getDoughnutPath(t,wn(i,n,t),wn(r,n,t),n,wn(i,s,t),wn(r,s,t),s,c,a,l,h)},e.prototype.getPiePath=function(t,i,r,n,s,a,l){var h=this.sliceCheck(l);a=h===1?0:a;var u=Math.atan2(i.y-t.y,i.x-t.x),c=Math.atan2(r.y-t.y,r.x-t.x);a=this.adjustCornerRadius(u,c,n,a);var d=i.x-a*Math.cos(u),p=i.y-a*Math.sin(u),f=r.x-a*Math.cos(Math.PI/2+c),v=r.y-a*Math.sin(Math.PI/2+c),m=r.x-a*Math.cos(c),y=r.y-a*Math.sin(c),S=i.x+a*Math.cos(Math.PI/2+u),b=i.y+a*Math.sin(Math.PI/2+u);return"M "+t.x+" "+t.y+" L "+d+" "+p+" A "+a+" "+a+" 0 0 1 "+S+" "+b+" A "+n+" "+n+" 0 "+s+" 1 "+f+" "+v+" A "+a+" "+a+" 0 0 1 "+m+" "+y+" Z"},e.prototype.getDoughnutPath=function(t,i,r,n,s,a,l,h,u,c,d){var p=this.sliceCheck(d);u=p===1?0:u;var f=Math.atan2(i.y-s.y,i.x-s.x),v=Math.atan2(r.y-a.y,r.x-a.x);u=this.adjustCornerRadius(f,v,l,u),u=c&&this.innerRadius===0?u*-1:u;var m=i.x-u*Math.cos(f),y=i.y-u*Math.sin(f),S=r.x-u*Math.cos(Math.PI/2+v),b=r.y-u*Math.sin(Math.PI/2+v),w=a.x+u*Math.cos(v),I=a.y+u*Math.sin(v),x=s.x+u*Math.cos(Math.PI/2+f),M=s.y+u*Math.sin(Math.PI/2+f),D=i.x+u*Math.cos(Math.PI/2+f),A=i.y+u*Math.sin(Math.PI/2+f),L=r.x-u*Math.cos(v),T=r.y-u*Math.sin(v),k=a.x-u*Math.cos(Math.PI/2+v),F=a.y-u*Math.sin(Math.PI/2+v),R=s.x+u*Math.cos(f),N=s.y+u*Math.sin(f);return c?"M "+D+" "+A+" A "+n+" "+n+" 0 "+h+" 1 "+S+" "+b+" L "+k+" "+F+" A "+l+" "+l+" 0 "+h+" 0 "+x+" "+M+" Z":"M "+m+" "+y+" A "+u+" "+u+" 0 0 1 "+D+" "+A+" A "+n+" "+n+" 0 "+h+" 1 "+S+" "+b+" A "+u+" "+u+" 0 0 1 "+L+" "+T+" L "+w+" "+I+" A "+u+" "+u+" 0 0 1 "+k+" "+F+" A "+l+" "+l+" 0 "+h+" 0 "+x+" "+M+" A "+u+" "+u+" 0 0 1 "+R+" "+N+" Z"},e.prototype.adjustCornerRadius=function(t,i,r,n){var s=Math.abs(i-t);s>Math.PI&&(s=2*Math.PI-s);var a=s/(2*Math.PI),l=r*a;return Math.min(n,l)},e.prototype.sliceCheck=function(t){for(var i=0,r=0;r<t.length;r++){var n=t[r];n.visible&&i++}return i},e.prototype.doAnimation=function(t,i,r,n,s){var a=this,l=i.startAngle-90,h=this.accumulation.duration?this.accumulation.duration:i.animation.duration,u;this.pieBaseCenter.x+=1;var c=Math.max(this.accumulation.availableSize.height,this.accumulation.availableSize.width)*.75;c+=c*.414;var d=Kw("Linear");new It({}).animate(t,{duration:h===0&&Ut==="Enable"?1e3:h,delay:i.animation.delay,progress:function(p){u=d(p.timeStamp,l,a.totalAngle,p.duration),t.setAttribute("d",a.getPathArc(a.pieBaseCenter,l,u,c,0,n,!1,s))},end:function(){a.pieBaseCenter.x-=1,t.setAttribute("d",a.getPathArc(a.pieBaseCenter,0,359.99999,c,0,n,!1,s)),a.accumulation.trigger(MU,a.accumulation.isBlazor?{}:{series:i,accumulation:a.accumulation,chart:a.accumulation});var p=ce(a.accumulation.element.id+"_datalabel_Series_"+i.index);p&&zc(p,i.animation.delay,i.animation.duration,i,null,null,!1),r.style.cssText="";var f=ce(a.accumulation.element.id+"_Annotation_Collections");f&&(f.style.visibility="visible")}})},e}(tx),i6=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),qm=function(o){i6(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return e.prototype.renderPoint=function(t,i,r,n,s,a,l,h,u){var c=i.sumOfPoints,d=this.accumulation.visibleSeries[0].points,p=i.borderRadius;t.startAngle=this.startAngle;var f=t.visible?t.y:0,v=c?Math.abs(f)/c*this.totalAngle:null,m=Math.PI/180*(90-(360-this.startAngle)-90);if(this.radius=this.isRadiusMapped?Ni(t.sliceRadius,this.seriesRadius):this.radius,n.d=this.getPathOption(t,v,this.startAngle%360,p,d),t.midAngle=(this.startAngle-v/2)%360,t.endAngle=this.startAngle%360,t.symbolLocation=wn(t.midAngle,(this.radius+this.innerRadius)/2,this.center),a){var y=r.renderer.drawPath(n);!t.isExplode&&u&&y.setAttribute("transform","translate(0, 0)"),y.setAttribute("role",i.accessibility.accessibilityRole?i.accessibility.accessibilityRole:"img"),y.setAttribute("tabindex",t.index===0&&i.accessibility.focusable?String(i.accessibility.tabIndex):"-1"),y.style.outline="none",y.setAttribute("aria-label",i.accessibility.accessibilityDescription?i.accessibility.accessibilityDescription:t.x+": "+t.y+"%. "+i.name),t.degree===void 0&&(t.degree=v,t.start=m),s.appendChild(y),this.refresh(t,v,m,r,n,p,d,l,h,u)}else{var y=r.renderer.drawPath(n);y.setAttribute("role",i.accessibility.accessibilityRole?i.accessibility.accessibilityRole:"img"),y.setAttribute("tabindex",t.index===0&&i.accessibility.focusable?String(i.accessibility.tabIndex):"-1"),y.style.outline="none",y.setAttribute("aria-label",i.accessibility.accessibilityDescription?i.accessibility.accessibilityDescription:t.x+": "+t.y+"%. "+i.name),s.appendChild(y),t.degree=v,t.start=m}},e.prototype.findSeries=function(t,i){var r=3,n=2,s=this.innerRadius===0?this.radius+r:this.innerRadius-r,a=this.innerRadius===0?s+n:s-n;this.toggleInnerPoint(t,s,a,i)},e.prototype.toggleInnerPoint=function(t,i,r,n){var s=t.target,a=$h(s.id,!0),l=t.target.id.substring(0,t.target.id.indexOf("Series")-1),h=document.getElementById(this.accumulation.element.id+"PointHover_Border"),u,c=this.accumulation.visibleSeries[0].points,d=a.series,p=a.point,f=ce(l+"_Series_"+d+"_Point_"+p);if(!isNaN(a.series)&&f){if(!g(d)&&!isNaN(d)&&!g(p)&&!isNaN(p)){var v=this.accumulation.visibleSeries[0].points[p],m=f.getAttribute("class")===l+"_ej2_deselected"?this.accumulation.tooltip.enable?.5:.3:this.accumulation.tooltip.enable?.5:1,y=this.getPathArc(this.accumulation.pieSeriesModule.center,v.startAngle%360,(v.startAngle+v.degree)%360,i,r,n,!0,c);h&&l===this.accumulation.element.id&&(h.getAttribute("d")!==y||v.isExplode)&&(h.parentNode.removeChild(h),h=null);var S=ce(l+"_Series_"+d);if(!h&&(!v.isExplode||v.isExplode&&t.type!=="click")){var b=new Ir(l+"PointHover_Border",v.color,1,v.color,m,"",y);if(u=this.accumulation.renderer.drawPath(b),u.removeAttribute("transform"),this.accumulation.selectionMode!=="None"&&t.target.hasAttribute("class")&&this.accumulation.accumulationSelectionModule.addSvgClass(u,t.target.getAttribute("class")),S.appendChild(u),v.isExplode&&u){var w=f.getAttribute("transform");w&&u.setAttribute("transform",w)}}}}else h&&(this.removeBorder(h,1e3),h=null)},e.prototype.removeBorder=function(t,i){t&&setTimeout(function(){t.parentNode&&t.parentNode.removeChild(t)},i)},e.prototype.refresh=function(t,i,r,n,s,a,l,h,u,c){var d=this,p=ce(s.id),f=n.duration?n.duration:300;new It({}).animate(Xe("div"),{duration:f,delay:0,progress:function(v){var m=Pr(v.timeStamp,t.degree,i-t.degree,v.duration),y=Pr(v.timeStamp,t.start,r-t.start,v.duration);if(y=(y/(Math.PI/180)+360)%360,h&&u){var S=Pr(v.timeStamp,h,d.radius-h,v.duration),b=Pr(v.timeStamp,u.x,d.center.x-u.x,v.duration),w=Pr(v.timeStamp,u.y,d.center.y-u.y,v.duration);p.setAttribute("d",d.getPathOption(t,m,y,a,l,S,b,w))}else p.setAttribute("d",d.getPathOption(t,m,y,a,l));t.isExplode&&n.accBaseModule.explodePoints(t.index,n,!0,c),p.style.visibility="visible"},end:function(){p.style.visibility=t.visible?"visible":"hidden",p.setAttribute("d",s.d),t.degree=i,t.start=r}})},e.prototype.getPathOption=function(t,i,r,n,s,a,l,h){if(!i)return"";var u=this.getPathArc(l?{x:l,y:h}:this.center,r%360,(r+i)%360,this.isRadiusMapped?Ni(t.sliceRadius,this.size/2):a||this.radius,this.innerRadius,n,!1,s);return this.startAngle+=i,u},e.prototype.animateSeries=function(t,i,r,n,s,a){var l=t.element.id+"SeriesGroup"+r.index;if((r.animation.enable&&Ut!=="Disable"||Ut==="Enable")&&t.animateSeries){var h=t.renderer.createClipPath({id:l+"_clipPath"}),u=new Ir(l+"_slice","transparent",1,"transparent",1,"",""),c=t.renderer.drawPath(u);h.appendChild(c),t.svgObject.appendChild(h),n.style.cssText="clip-path:url(#"+h.id+"); -webkit-clip-path:url(#"+h.id+");",this.doAnimation(c,r,n,s,a)}},e.prototype.getModuleName=function(){return"PieSeries"},e.prototype.destroy=function(){},e}(t6),r6=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ft=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},ix=function(o){r6(e,o);function e(t,i){var r=o.call(this,t,i)||this;return r.animateselected=!1,r.explodeDistance=0,r.currentLegendIndex=0,r.currentPointIndex=0,r.previousTargetId="",r.isLegendClicked=!1,r.chartid=57724,r}return e.prototype.animate=function(t){this.duration=t===0&&Ut==="Enable"?700:t,this.animateselected=!0,this.animateSeries=!1;var i=0,r=[],n=[],s=[],a=this.visibleSeries[0],l=[];if(l=a.dataSource,a.sumOfPoints=0,a.points.length<Object.keys(a.dataSource).length)this.refresh();else if(a.points.length>Object.keys(a.dataSource).length){var h=this.visibleSeries[0];h.points=h.points.filter(function(p){return p.visible=!1,n.push(p.index),r.push(p.color),l.some(function(f){var v=f;return p.x===v.x&&(p.visible=!0,s.push(p.index),p.index=i,i++),p.x===v.x})});for(var u=n.filter(function(p){return s.indexOf(p)<0}),c=n.length-u.length,d=n.length-1;d>=c;d--)ni("container_Series_0_Point_"+n[d]);for(var d=0;d<h.points.length;d++)h.points[d].y=h.dataSource[d].y,h.points[d].color=r[d],h.sumOfPoints+=h.dataSource[d].y;this.redraw=this.enableAnimation,this.animateSeries=!1,this.calculateBounds(),this.renderElements()}else{for(var d=0;d<a.points.length;d++)a.points[d].y=a.dataSource[d][a.yName],a.points[d].color=a.dataSource[d][a.pointColorMapping]!=null?a.dataSource[d][a.pointColorMapping]:a.points[d].color,a.sumOfPoints+=a.dataSource[d][a.yName];this.redraw=this.enableAnimation,this.animateSeries=!1,this.removeSvg(),this.refreshPoints(a.points),this.renderElements()}},Object.defineProperty(e.prototype,"type",{get:function(){return this.series&&this.series.length?this.series[0].type:"Pie"},enumerable:!0,configurable:!0}),e.prototype.preRender=function(){var t="Blazor";if(this.isBlazor=window[t],this.allowServerDataBinding=!1,this.unWireEvents(),this.setCulture(),this.animateSeries=!0,this.element.id===""){var i=document.getElementsByClassName("e-accumulationchart").length;this.element.id="acc_chart_"+this.chartid+"_"+i}this.wireEvents(),this.element.setAttribute("dir",this.enableRtl?"rtl":"ltr"),this.element.style.outline="none"},e.prototype.setTheme=function(){this.themeStyle=lF(this.theme,!1,this)},e.prototype.render=function(){var t=this;this.element.className.indexOf("e-accumulationchart")===-1&&this.element.classList.add("e-accumulationchart"),this.element.setAttribute("role",this.accessibility.accessibilityRole?this.accessibility.accessibilityRole:"region"),this.element.setAttribute("tabindex",this.accessibility.focusable?String(this.accessibility.tabIndex):"-1"),this.element.setAttribute("aria-label",this.accessibility.accessibilityDescription?this.accessibility.accessibilityDescription:this.title+". Syncfusion interactive chart."),this.element.setAttribute("class",this.element.getAttribute("class")+" e-accumulationchart-focused");var i={chart:this.isBlazor?{}:this,accumulation:this.isBlazor?{}:this,theme:this.theme,name:zm,cancel:!1};this.trigger(zm,i,function(){t.theme=t.isBlazor?i.theme:t.theme,t.setTheme(),t.accBaseModule=new tx(t),t.pieSeriesModule=new qm(t),t.calculateVisibleSeries(),t.processData(),t.renderComplete(),t.allowServerDataBinding=!0})},e.prototype.unWireEvents=function(){var t=B.isPointer,i=B.touchStartEvent,r=B.touchMoveEvent,n=B.touchEndEvent,s=t?"pointerleave":"mouseleave";E.remove(this.element,r,this.accumulationMouseMove),E.remove(this.element,n,this.accumulationMouseEnd),E.remove(this.element,i,this.accumulationMouseStart),E.remove(this.element,"click",this.accumulationOnMouseClick),E.remove(this.element,"dblclick",this.accumulationOnDoubleClick),E.remove(this.element,"contextmenu",this.accumulationRightClick),E.remove(this.element,s,this.accumulationMouseLeave),E.remove(this.element,"keydown",this.accumulationChartKeyDown),E.remove(document.body,"keydown",this.documentKeyHandler),E.remove(this.element,"keyup",this.accumulationChartKeyUp),window.removeEventListener(B.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.accumulationResizeBound)},e.prototype.wireEvents=function(){if(this.element){var t=B.isPointer,i=B.touchStartEvent,r=B.touchEndEvent,n=B.touchMoveEvent,s=t?"pointerleave":"mouseleave";E.add(this.element,n,this.accumulationMouseMove,this),E.add(this.element,r,this.accumulationMouseEnd,this),E.add(this.element,i,this.accumulationMouseStart,this),E.add(this.element,"click",this.accumulationOnMouseClick,this),E.add(this.element,"dblclick",this.accumulationOnDoubleClick,this),E.add(this.element,"contextmenu",this.accumulationRightClick,this),E.add(this.element,s,this.accumulationMouseLeave,this),E.add(this.element,"keydown",this.accumulationChartKeyDown,this),E.add(document.body,"keydown",this.documentKeyHandler,this),E.add(this.element,"keyup",this.accumulationChartKeyUp,this),this.accumulationResizeBound=this.accumulationResize.bind(this),window.addEventListener(B.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.accumulationResizeBound),new Fr(this.element),this.setStyle(this.element)}},e.prototype.setMouseXY=function(t){var i,r,n=ce(this.element.id+"_svg");if(n&&this.element){var s=n.getBoundingClientRect(),a=this.element.getBoundingClientRect();if(t.type.indexOf("touch")>-1){this.isTouch=!0;var l=t;r=l.changedTouches[0].clientY,i=l.changedTouches[0].clientX}else this.isTouch=t.pointerType==="touch"||t.pointerType==="2",i=t.clientX,r=t.clientY;this.mouseY=r-a.top-Math.max(s.top-a.top,0),this.mouseX=i-a.left-Math.max(s.left-a.left,0)}},e.prototype.accumulationMouseEnd=function(t){return this.setMouseXY(t),this.trigger(WN,{target:t.target.id,x:this.mouseX,y:this.mouseY}),this.isTouch&&(this.titleTooltip(t,this.mouseX,this.mouseY,this.isTouch),this.accumulationDataLabelModule&&this.visibleSeries[0].dataLabel.visible&&this.accumulationDataLabelModule.move(t,this.mouseX,this.mouseY,this.isTouch),this.accumulationLegendModule&&this.legendSettings.visible&&this.accumulationLegendModule.move(t)),this.centerLabel.hoverTextFormat&&this.updateCenterLabel(t),this.notify(B.touchEndEvent,t),!1},e.prototype.accumulationMouseStart=function(t){return this.setMouseXY(t),this.trigger(UN,{target:t.target.id,x:this.mouseX,y:this.mouseY}),!1},e.prototype.accumulationResize=function(){var t=this;this.animateSeries=!1;var i={accumulation:this.isBlazor?{}:this,previousSize:new _t(this.availableSize.width,this.availableSize.height),name:_m,currentSize:new _t(0,0),chart:this.isBlazor?{}:this},r={name:"beforeResize",cancelResizedEvent:!1};return this.resizeTo&&clearTimeout(this.resizeTo),this.trigger(qN,r),r.cancelResizedEvent||(this.resizeTo=+setTimeout(function(){if(t.isDestroyed){clearTimeout(t.resizeTo);return}aF(t),i.currentSize=t.availableSize,t.trigger(_m,i),t.refreshSeries(),t.refreshChart()},500)),!1},e.prototype.print=function(t){var i=document.getElementById(this.element.id+"_Series_0").style.clipPath;document.getElementById(this.element.id+"_Series_0").style.clipPath="";var r=new fF(this);r.print(t),document.getElementById(this.element.id+"_Series_0").style.clipPath=i},e.prototype.export=function(t,i){this.exportModule&&(this.exportModule.export(t,i),this.afterExport&&this.exportModule.getDataUrl(this))},e.prototype.setStyle=function(t){switch(t.style.touchAction="element",t.style.msTouchAction="element",t.style.msContentZooming="none",t.style.msUserSelect="none",t.style.webkitUserSelect="none",t.style.position="relative",t.style.display="block",t.style.height=t.style.height||this.height&&this.height.indexOf("%")===-1?t.style.height:"inherit",this.theme){}},e.prototype.setAnnotationValue=function(t,i){var r=this.annotations[t],n,s=ce(this.element.id+"_Annotation_Collections");i&&(r.content=i,s?(n=this.createElement("div"),ni(this.element.id+"_Annotation_"+t),this.annotationModule.processAnnotation(r,t,n),s.appendChild(n.children[0])):this.annotationModule.renderAnnotations(ce(this.element.id+"_Secondary_Element")))},e.prototype.accumulationMouseMove=function(t){return ce(this.element.id+"_svg")&&(this.setMouseXY(t),this.trigger(BN,{target:t.target.id,x:this.mouseX,y:this.mouseY}),this.pointMove&&this.triggerPointEvent(VN,t.target,t),this.accumulationLegendModule&&this.legendSettings.visible&&this.accumulationLegendModule.move(t),this.accumulationDataLabelModule&&this.visibleSeries[0]&&this.visibleSeries[0].dataLabel.visible&&this.accumulationDataLabelModule.move(t,this.mouseX,this.mouseY),this.centerLabel.hoverTextFormat&&this.updateCenterLabel(t),this.isTouch||this.titleTooltip(t,this.mouseX,this.mouseY),this.enableBorderOnMouseMove&&this.type==="Pie"&&this.pieSeriesModule&&Oi(this.mouseX,this.mouseY,this.initialClipRect)&&this.pieSeriesModule.findSeries(t,this.series[0].borderRadius),this.notify(B.touchMoveEvent,t)),!1},e.prototype.titleTooltip=function(t,i,r,n){var s=t.target.id,a=s===this.element.id+"_title"||s===this.element.id+"_subTitle"||s===this.element.id+"_chart_legend_title";if(t.target.textContent.indexOf("...")>-1&&a){var l=s===this.element.id+"_title"?this.title:s===this.element.id+"_subTitle"?this.subTitle:this.legendSettings.title;Pc(l,i,r,this.element.offsetWidth,this.element.id+"_EJ2_Title_Tooltip",ce(this.element.id+"_Secondary_Element"),n)}else ni(this.element.id+"_EJ2_Title_Tooltip")},e.prototype.accumulationChartKeyDown=function(t){var i="";return this.tooltip.enable&&(t.code==="Tab"&&this.previousTargetId.indexOf("Series")>-1||t.code==="Escape")&&(i="ESC"),t.code.indexOf("Arrow")>-1&&t.preventDefault(),t.ctrlKey&&t.key==="p"&&(t.preventDefault(),i="CtrlP"),i!==""&&this.chartKeyboardNavigations(t,t.target.id,i),t.code==="Tab"&&this.removeNavigationStyle(),!1},e.prototype.accumulationChartKeyUp=function(t){var i="",r=t.target.id,n=ce(this.element.id+"_chart_legend_translate_g"),s=ce(this.element.id+"_chart_legend_pageup");if(n){var a=n.firstElementChild,l=a.getAttribute("class");l&&l.indexOf("e-accumulationchart-focused")===-1?l=l+" e-accumulationchart-focused":l||(l="e-accumulationchart-focused"),a.setAttribute("class",l)}if(s&&s.setAttribute("class","e-accumulationchart-focused"),this.removeNavigationStyle(),t.code==="Tab"){if(this.previousTargetId!=="")if(this.previousTargetId.indexOf("_Point_")>-1&&r.indexOf("_Point_")===-1){var h=document.getElementById(this.previousTargetId).parentElement;this.setTabIndex(h.children[this.currentPointIndex],h.firstElementChild),this.currentPointIndex=0}else this.previousTargetId.indexOf("_chart_legend_page")>-1&&r.indexOf("_chart_legend_page")===-1&&r.indexOf("_chart_legend_g_")===-1?this.setTabIndex(t.target,s):this.previousTargetId.indexOf("_chart_legend_g_")>-1&&r.indexOf("chart_legend_g_")===-1&&n&&this.setTabIndex(n.children[this.currentLegendIndex],n.firstElementChild);this.previousTargetId=r,r.indexOf("_chart_legend_g_")>-1&&this.highlightMode!=="None"?(r=t.target.lastElementChild.id,i="Tab"):r.indexOf("_Point_")>-1&&(this.highlightMode!=="None"||this.tooltip.enable)&&(i="Tab")}else if(t.code.indexOf("Arrow")>-1){if(t.preventDefault(),r.indexOf("_chart_legend_page")>-1)t.target.removeAttribute("tabindex"),this.previousTargetId=r=this.element.id+"_chart_legend_page"+(t.code==="ArrowRight"?"up":"down"),this.focusTarget(ce(r));else if(r.indexOf("_chart_legend_")>-1&&n){t.target.removeAttribute("tabindex"),this.currentLegendIndex+=t.code==="ArrowUp"||t.code==="ArrowRight"?1:-1,this.currentLegendIndex=this.getActualIndex(this.currentLegendIndex,n.children.length);var u=n.children[this.currentLegendIndex];this.focusTarget(u),this.removeNavigationStyle(),this.setNavigationStyle(u.id),this.previousTargetId=r=u.lastElementChild.id,i=this.highlightMode!=="None"?"ArrowMove":""}else if(r.indexOf("_Point_")>-1){t.target.setAttribute("tabindex","-1"),this.currentPointIndex+=t.code==="ArrowUp"||t.code==="ArrowRight"?1:-1;for(var c=0,d=0;d<t.target.parentElement.children.length;d++)c=t.target.parentElement.children[d].id.indexOf("_Point_")>-1?c+1:c;this.currentPointIndex=this.getActualIndex(this.currentPointIndex,c),r=this.element.id+"_Series_0_Point_"+this.currentPointIndex,this.focusTarget(ce(r)),this.removeNavigationStyle(),this.setNavigationStyle(r),i=this.tooltip.enable?"ArrowMove":""}}else(t.code==="Enter"||t.code==="Space")&&(r.indexOf("_chart_legend_")>-1||r.indexOf("_Point_")>-1)&&(r=r.indexOf("_chart_legend_g")>-1?t.target.lastElementChild.id:r,i="Enter");return i!==""&&this.chartKeyboardNavigations(t,r,i),t.code==="Tab"&&this.setNavigationStyle(r),!1},e.prototype.setTabIndex=function(t,i){t&&t.removeAttribute("tabindex"),i&&i.setAttribute("tabindex","0")},e.prototype.getActualIndex=function(t,i){return t>i-1?0:t<0?i-1:t},e.prototype.focusTarget=function(t){var i=t.getAttribute("class");return t.setAttribute("tabindex","0"),i&&i.indexOf("e-accumulationchart-focused")===-1?i=i+" e-accumulationchart-focused":i||(i="e-accumulationchart-focused"),t.setAttribute("tabindex","0"),t.setAttribute("class",i),t.focus(),t.id},e.prototype.documentKeyHandler=function(t){t.altKey&&t.keyCode===74&&!g(this.element)&&this.element.focus()},e.prototype.setNavigationStyle=function(t){var i=document.getElementById(t);i&&(i.style.setProperty("outline",this.focusBorderWidth+"px solid "+(this.focusBorderColor||this.themeStyle.tabColor)),i.style.setProperty("margin",this.focusBorderMargin+"px"))},e.prototype.removeNavigationStyle=function(){var t=document.querySelectorAll("path[id*=_Series_0_Point_], [id*="+this.element.id+"], [id*=_ChartBorder], text[id*=_title],g[id*=_chart_legend]");t&&t.forEach(function(i){(i instanceof HTMLElement||i instanceof SVGElement)&&(i.style.setProperty("outline","none"),i.style.setProperty("margin",""))})},e.prototype.chartKeyboardNavigations=function(t,i,r){switch(this.isLegendClicked=!1,r){case"Tab":case"ArrowMove":if(this.accumulationHighlightModule,i.indexOf("_Point_")>-1){var n=+i.split("_Series_")[1].split("_Point_")[0],s=+i.split("_Series_")[1].replace("_Symbol","").split("_Point_")[1],a=this.visibleSeries[n].points[s].symbolLocation;if(this.mouseX=a.x+this.initialClipRect.x,this.mouseY=a.y+this.initialClipRect.y,this.accumulationHighlightModule){var l=ce(i);if(!g(l)){if(l.id.indexOf("text")>1&&(l=ce(l.id.replace("text","shape"))),l.hasAttribute("class")&&l.getAttribute("class").indexOf("highlight")>-1)return;this.accumulationHighlightModule.calculateSelectedElements(this,l,"mousemove");return}}if(this.accumulationTooltipModule){var h=this.visibleSeries[n],u=void 0;h.enableTooltip&&(u=new lf(h.points[s],h)),this.accumulationTooltipModule.renderSeriesTooltip(this,u)}}if(this.accumulationHighlightModule&&this.highlightMode!=="None"){i=i.indexOf("_chart_legend_g_")>-1?document.getElementById(i).firstChild.id:i;for(var c=this.element.id+"_chart_legend",d=[c+"_text_",c+"_shape_marker_",c+"_shape_"],p=0;p<d.length;p++){var f=d[p];if(i.indexOf(f)>-1){document.getElementById(i).setAttribute("class",""),this.accumulationHighlightModule.legendSelection(this,0,parseInt(i.split(f)[1],10),ce(i),"mousemove");break}}}break;case"Enter":case"Space":i.indexOf("_chart_legend_")>-1&&this.accumulationLegendModule?(this.isLegendClicked=!0,this.accumulationLegendModule.click(t),this.focusChild(document.getElementById(i).parentElement),this.setNavigationStyle(document.getElementById(i).parentElement.id)):this.accumulationSelectionModule&&this.accumulationSelectionModule.calculateSelectedElements(this,document.getElementById(i),"click");break;case"CtrlP":this.print();break;case"ESC":this.accumulationTooltipModule&&this.accumulationTooltipModule.removeTooltip(1);break}},e.prototype.focusChild=function(t){t.setAttribute("tabindex","0");var i=t.getAttribute("class");return t.setAttribute("tabindex","0"),i&&i.indexOf("e-accumulationchart-focused")===-1?i="e-accumulationchart-focused "+i:i||(i="e-accumulationchart-focused"),t.setAttribute("class",i),t.focus(),t.id},e.prototype.accumulationOnDoubleClick=function(t){return this.trigger(jN,{target:t.target.id,x:this.mouseX,y:this.mouseY}),!1},e.prototype.accumulationOnMouseClick=function(t){return this.setMouseXY(t),this.accumulationLegendModule&&this.legendSettings.visible&&this.accumulationLegendModule.click(t),this.selectionMode!=="None"&&this.accumulationSelectionModule&&this.accumulationSelectionModule.calculateSelectedElements(this,t.target,t.type),this.visibleSeries[0].explode&&this.accBaseModule.processExplode(t),this.enableBorderOnMouseMove&&this.pieSeriesModule&&this.type==="Pie"&&this.pieSeriesModule.findSeries(t,this.series[0].borderRadius),this.trigger(zN,{target:t.target.id,x:this.mouseX,y:this.mouseY}),this.pointClick&&this.triggerPointEvent(HN,t.target,t),this.removeNavigationStyle(),!1},e.prototype.triggerPointEvent=function(t,i,r){var n=r,s=$h(i.id,!0);s.series>=0&&s.point>=0&&this.trigger(t,{series:this.isBlazor?{}:this.series[s.series],point:this.series[s.series].points[s.point],seriesIndex:s.series,pointIndex:s.point,x:this.mouseX,y:this.mouseY,pageX:n.pageX,pageY:n.pageY})},e.prototype.accumulationRightClick=function(t){return t.buttons===2&&t.pointerType==="touch"?(t.preventDefault(),t.stopPropagation(),!1):!0},e.prototype.accumulationMouseLeave=function(t){this.setMouseXY(t),this.trigger(_N,{target:t.target.id,x:this.mouseX,y:this.mouseY}),this.notify(B.isPointer?"pointerleave":"mouseleave",t);var i=document.getElementById(this.element.id+"PointHover_Border");return i&&(this.pieSeriesModule.removeBorder(i,1e3),i=null),!1},e.prototype.setCulture=function(){this.intl=new Et},e.prototype.createPieSvg=function(){this.removeSvg(),oF(this)},e.prototype.removeSvg=function(){if(this.redraw)return null;if(Xm(this),ni(this.element.id+"_Secondary_Element"),this.svgObject){for(;this.svgObject.childNodes.length>0;)this.svgObject.removeChild(this.svgObject.firstChild);!this.svgObject.hasChildNodes()&&this.svgObject.parentNode&&Ue(this.svgObject)}ni("EJ2_legend_tooltip"),ni("EJ2_datalabel_tooltip"),ni(this.element.id+"PointHover_Border")},e.prototype.createSecondaryElement=function(){var t=Va(this.redraw,this.element.id+"_Secondary_Element")||this.createElement("div",{id:this.element.id+"_Secondary_Element",styles:"position: relative"});vt(!1,this.element,t,this.redraw)},e.prototype.calculateVisibleSeries=function(){this.visibleSeries=[];for(var t=0,i=this.series.length;t<i;t++)if(this.series[t].index=t,this.series[t].type===this.type&&this.visibleSeries.length===0){this.visibleSeries.push(this.series[t]);break}},e.prototype.processData=function(t){t===void 0&&(t=!0),this.seriesCounts=0;for(var i=0,r=this.visibleSeries;i<r.length;i++){var n=r[i];n.dataModule=new uF(n.dataSource||this.dataSource,n.query),n.refreshDataManager(this,t)}},e.prototype.refreshChart=function(){this.doGrouppingProcess(),this.createPieSvg(),this.calculateBounds(),this.renderElements(),ni("chartmeasuretext")},e.prototype.doGrouppingProcess=function(){var t=this.visibleSeries[0];!g(t.resultData)&&!g(t.lastGroupTo)&&t.lastGroupTo!==t.groupTo&&t.getPoints(t.resultData,this)},e.prototype.calculateBounds=function(){this.initialClipRect=new Ae(this.margin.left,this.margin.top,this.availableSize.width,this.availableSize.height),this.titleCollection=[],this.subTitleCollection=[];var t=0,i=0,r=0;if(this.title&&(this.titleCollection=jc(this.title,this.titleStyle,this.initialClipRect.width,this.enableRtl,this.themeStyle.chartTitleFont)),t=this.title?Ze(this.title,this.titleStyle,this.themeStyle.chartTitleFont).height*this.titleCollection.length:t,this.subTitle){for(var n=0,s=this.titleCollection;n<s.length;n++){var a=s[n];r=Ze(a,this.titleStyle,this.themeStyle.chartSubTitleFont).width}this.subTitleCollection=jc(this.subTitle,this.subTitleStyle,this.initialClipRect.width,this.enableRtl,this.themeStyle.chartSubTitleFont),i=Ze(this.subTitle,this.subTitleStyle,this.themeStyle.chartSubTitleFont).height*this.subTitleCollection.length}var l=this.margin.left+this.border.width,h=this.availableSize.width-l-this.margin.right-this.border.width,u=this.margin.top+this.border.width,c=this.availableSize.height-u-this.border.width-this.margin.bottom,d=i+t;switch(this.titleStyle.position){case"Top":l=0,u=i+t,h=this.margin.right+this.margin.left,c=this.margin.bottom+this.margin.top;break;case"Bottom":c-=d+this.margin.bottom*2;break;case"Left":l+=d,h-=d;break;case"Right":h-=d;break}this.titleStyle.position!=="Top"?this.initialClipRect=new Ae(l,u,h,c):this.initialClipRect=QN(this.initialClipRect,new Ae(l,u,h,c)),this.calculateLegendBounds()},e.prototype.calculateLegendBounds=function(){if(!this.accumulationLegendModule||!this.legendSettings.visible)return null;this.accumulationLegendModule.getLegendOptions(this,this.visibleSeries),this.accumulationLegendModule.calculateLegendBounds(this.initialClipRect,this.availableSize,null)},e.prototype.renderElements=function(){this.renderBorder(),this.createSecondaryElement(),this.renderSeries(),this.renderTitle(),this.renderCenterLabel(!0),this.renderLegend(),vt(!1,this.element,this.svgObject,this.redraw),this.processSelection(),this.processExplode(),this.renderAnnotation(),this.setSecondaryElementPosition(),rc(this.element.id+"_DataLabel","Template",this.series[0].dataLabel),this.trigger("loaded",{accumulation:this.isBlazor?{}:this,chart:this.isBlazor?{}:this}),this.animateSeries=!1},e.prototype.setSecondaryElementPosition=function(){var t=ce(this.element.id+"_Secondary_Element");if(t){var i=this.element.getBoundingClientRect(),r=ce(this.element.id+"_svg").getBoundingClientRect();t.style.left=Math.max(r.left-i.left,0)+"px",t.style.top=Math.max(r.top-i.top,0)+"px"}},e.prototype.renderAnnotation=function(){this.annotationModule&&this.annotationModule.renderAnnotations(ce(this.element.id+"_Secondary_Element"))},e.prototype.processExplode=function(){if(this.redraw||!this.visibleSeries[0].explode)return null;this.accBaseModule.invokeExplode()},e.prototype.renderSeries=function(){this.redraw||this.svgObject.appendChild(this.renderer.createGroup({id:this.element.id+"_SeriesCollection"}));for(var t=0,i=this.visibleSeries;t<i.length;t++){var r=i[t];r.visible&&this[$r(r.type)+"SeriesModule"]&&(this[$r(r.type)+"SeriesModule"].initProperties(this,r),r.renderSeries(this,this.redraw))}},e.prototype.renderBorder=function(){var t=this.border.width,i=new as(this.element.id+"_border",this.background||this.themeStyle.background,this.border,1,new Ae(t/2,t/2,this.availableSize.width-t,this.availableSize.height-t),0,0,"",this.border.dashArray),r=this.renderer.drawRectangle(i);r.setAttribute("aria-hidden","true"),vt(!1,this.svgObject,r,this.redraw);var n=this.backgroundImage;if(n){var s=new Yw(this.availableSize.height-t,this.availableSize.width-t,n,0,0,this.element.id+"_background","visible","none");vt(!1,this.svgObject,this.renderer.drawImage(s),this.redraw)}},e.prototype.renderLegend=function(){if(!this.accumulationLegendModule||!this.legendSettings.visible)return null;this.accumulationLegendModule.legendCollections.length&&(this.visibleSeries[0].type==="Pie"&&this.accumulationLegendModule.getSmartLegendLocation(this.visibleSeries[0].labelBound,this.accumulationLegendModule.legendBounds,this.margin),this.accumulationLegendModule.renderLegend(this,this.legendSettings,this.accumulationLegendModule.legendBounds,this.redraw))},e.prototype.processSelection=function(){var t=[];this.accumulationSelectionModule&&this.selectionMode!=="None"&&(t=he([],this.accumulationSelectionModule.selectedDataIndexes,null,!0),this.accumulationSelectionModule.invokeSelection(this)),this.accumulationHighlightModule&&this.highlightMode!=="None"&&this.accumulationHighlightModule.invokeHighlight(this),t.length>0&&(this.accumulationSelectionModule.selectedDataIndexes=t,this.accumulationSelectionModule.redrawSelection(this))},e.prototype.renderTitle=function(){var t=this.margin;if(!this.title)return null;var i=Xh(this.titleStyle.textAlignment,this.enableRtl),r=Ze(this.title,this.titleStyle,this.themeStyle.chartTitleFont),n=20,s=this.margin.top+r.height*3/4,a=this.accumulationLegendModule===void 0?0:this.legendSettings.position==="Top"?this.accumulationLegendModule.legendBounds.height:0,l=this.explodeDistance===0?0:this.explodeDistance,h=a!==0?0:l/2,u=new Ae(t.left,0,this.availableSize.width-t.left-t.right,0),c=this.margin.top+r.height*3/4,d=Qh(u,this.titleStyle||this.themeStyle.chartTitleFont),p,f=this.titleStyle.textAlignment,v=Ze(this.subTitle,this.subTitleStyle,this.themeStyle.chartSubTitleFont);switch(this.titleStyle.position){case"Top":d=Qh(u,this.titleStyle),c=s;break;case"Bottom":d+=i==="start"?this.border.width:i==="end"?this.border.width:0,c=this.availableSize.height-this.margin.bottom-v.height-r.height/2;break;case"Left":d=this.margin.left+r.height*3/4,c=f==="Near"?t.bottom+this.border.width:f==="Far"?this.availableSize.height-t.bottom-this.border.width:this.availableSize.height/2,i=f==="Near"?"end":f==="Far"?"start":"middle",i=this.enableRtl?i==="end"?"start":i==="start"?"end":i:i,p="rotate(-90,"+d+","+c+")";break;case"Right":d=this.availableSize.width-this.margin.right-r.height*3/4,c=f==="Near"?t.bottom+this.border.width:f==="Far"?this.availableSize.height-t.bottom-this.border.width:this.availableSize.height/2,i=f==="Near"?"start":f==="Far"?"end":"middle",i=this.enableRtl?i==="end"?"start":i==="start"?"end":i:i,p="rotate(90,"+d+","+c+")";break;case"Custom":d=this.titleStyle.x,c=this.titleStyle.y,i="middle";break}var m=new gn(this.element.id+"_title",d,c,i,this.titleCollection,p,"auto"),y=this.series[0].type==="Pie"&&this.visibleSeries[0].dataLabel.position==="Outside"&&this.visibleSeries[0].dataLabel.connectorStyle.length?Ni(this.visibleSeries[0].dataLabel.connectorStyle.length,this.accBaseModule.radius):0;!this.subTitle&&this.series[0].type!=="Funnel"&&this.series[0].type!=="Pyramid"&&(m.y=parseInt(this.series[0].radius,10)>=80?m.y:this.accBaseModule.center.y-this.accBaseModule.radius-n-s-a-h-y,this.series[0].type==="Pie"&&(parseInt(this.series[0].radius,10)<80||isNaN(parseInt(this.series[0].radius,10)))&&(m.y=m.y<this.initialClipRect.y-a?this.initialClipRect.y-a:m.y));var S=hn(this.renderer,m,this.titleStyle,this.titleStyle.color||this.themeStyle.chartTitleFont.color,this.svgObject,!1,this.redraw,null,null,null,null,null,null,null,null,this.themeStyle.chartTitleFont);S&&(S.setAttribute("tabindex","0"),S.style.outline="none",S.parentNode.insertBefore(S,this.svgObject.children&&this.svgObject.children[1])),this.subTitle&&this.renderSubTitle(m)},e.prototype.updateCenterLabel=function(t){var i=this.getPieData(t);this.format=i.point==null?"":this.parseFormat(i.point,this.visibleSeries[0],this.centerLabel.hoverTextFormat),this.renderCenterLabel()},e.prototype.getPieData=function(t){var i=$h(t.target.id,!0);return isNaN(i.series)?new lf(null,null):new lf(this.visibleSeries[0].points[i.point],this.visibleSeries[0])},e.prototype.parseFormat=function(t,i,r){for(var n,s,a=RegExp,l=0,h=Object.keys(t);l<h.length;l++){var u=h[l];n=new a("${point."+u+"}","gm"),r=r.replace(n.source,t[u])}for(var c=0,d=Object.keys(Object.getPrototypeOf(i));c<d.length;c++){var u=d[c];n=new a("${series."+u+"}","gm"),s=i[u],r=r.replace(n.source,s)}return r},e.prototype.renderCenterLabel=function(t,i){var r=this;if(!this.centerLabel.text||this.type!=="Pie")return null;var n=[];if(i){var s=ce(this.element.id+"_centerLabel").querySelectorAll("tspan");s.forEach(function(x){n.push({x:x.getAttribute("x"),y:x.getAttribute("y")})})}for(var a=this.series[0],l,h=Xh(this.centerLabel.textStyle.textAlignment,this.enableRtl),u=10,c=this.pieSeriesModule.innerRadius?2*this.pieSeriesModule.innerRadius*.7071067:2*this.pieSeriesModule.radius*.7071067,d=(this.format||this.centerLabel.text).split("<br>"),p=Ze(d[0],this.centerLabel.textStyle,this.themeStyle.chartTitleFont),f=d.length,v=0;v<f;v++){var m=Ze(d[v],this.centerLabel.textStyle,this.themeStyle.chartTitleFont);m.width>c&&d.splice.apply(d,[v,1].concat(ol(d[v],c,this.centerLabel.textStyle,this.enableRtl,null,null,this.themeStyle.chartTitleFont)))}p.height*d.length>c?l=this.accBaseModule.center.y+(p.height+u)/2-c/2:a.startAngle&&a.endAngle&&Math.abs(a.endAngle-a.startAngle)===180?(l=this.accBaseModule.center.y-p.height*d.length/2+(p.height+u)/2-this.pieSeriesModule.innerRadius/2+(this.pieSeriesModule.innerRadius?u:0),p.height*d.length+this.pieSeriesModule.innerRadius/2+u>c&&(l=this.accBaseModule.center.y+(p.height+u)/2-c/2)):l=d.length>1?this.accBaseModule.center.y-p.height*d.length/2+(p.height+u)/2:this.accBaseModule.center.y+p.height/4;for(var y=new gn(this.element.id+"_centerLabel",(this.series[0].animation.enable&&Ut!=="Disable"||Ut==="Enable")&&t?this.pieSeriesModule.center.x-1:this.pieSeriesModule.center.x,l,h,"","","auto"),S=hn(this.renderer,y,this.centerLabel.textStyle,this.centerLabel.textStyle.color||this.themeStyle.chartTitleFont.color,this.svgObject,!1,this.redraw,null,null,null,null,null,null,null,null,this.themeStyle.chartTitleFont),b=[],v=0;v<d.length;v++){var w={x:y.x,y:y.y+v*p.height,fill:""},I=this.renderer.createTSpan(w,"");I.style.fontFamily="inherit",I.style.fontStyle="inherit",I.style.fontSize="inherit",I.style.fontWeight=d[v].indexOf("<b>")>-1||d[v].indexOf("</b>")>-1?"bold":"inherit",I.textContent=d[v].replace(/<\/?b>/g,""),S.appendChild(I),b.push(I)}i&&b.forEach(function(x,M){r.animateTspan(x,Number(n[M].x),Number(n[M].y),Number(x.getAttribute("x")),Number(x.getAttribute("y")),r.duration)}),t&&(this.series[0].animation.enable&&Ut!=="Disable"||Ut==="Enable")&&this.animateSeries&&this.centerLabelDelay(S)},e.prototype.animateTspan=function(t,i,r,n,s,a){new It({}).animate(t,{duration:a,progress:function(l){t.style.animation="";var h=l.timeStamp/l.duration,u=i+(n-i)*h,c=r+(s-r)*h;t.setAttribute("x",u.toString()),t.setAttribute("y",c.toString())},end:function(){t.setAttribute("x",n.toString()),t.setAttribute("y",s.toString())}})},e.prototype.centerLabelDelay=function(t){t.style.visibility="hidden";var i=new It({});i.animate(t,{delay:this.duration?this.duration:this.series[0].animation.duration,progress:function(r){r.element.style.visibility="visible"}})},e.prototype.renderSubTitle=function(t){for(var i=0,r=0,n=10,s=this.titleStyle.textAlignment,a=Ze(this.subTitle,this.subTitleStyle,this.themeStyle.chartSubTitleFont),l=0,h=this.titleCollection;l<h.length;l++){var u=h[l];r=Ze(u,this.titleStyle,this.themeStyle.chartSubTitleFont).width,i=r>i?r:i}var c=new Ae(s==="Center"?t.x-i/2:s==="Far"?t.x-i:t.x,0,i,0);this.titleStyle.position==="Left"&&(c.x=s==="Center"?t.x-i*.5:s==="Far"?this.margin.left+a.height*3/4:t.x-i);var d=new gn(this.element.id+"_subTitle",Qh(c,this.subTitleStyle),t.y*t.text.length+a.height*3/4+n,Xh(this.subTitleStyle.textAlignment,this.enableRtl),this.subTitleCollection,t.transform,"auto");hn(this.renderer,d,this.subTitleStyle,this.subTitleStyle.color||this.themeStyle.chartSubTitleFont.color,this.svgObject,!1,this.redraw,null,null,null,null,null,null,null,null,this.themeStyle.chartSubTitleFont)},e.prototype.getSeriesElement=function(){return this.svgObject.getElementsByTagName("g")[0]},e.prototype.refreshSeries=function(){for(var t=0,i=this.visibleSeries;t<i.length;t++){var r=i[t];this.refreshPoints(r.points)}},e.prototype.refreshPoints=function(t){for(var i=0,r=t;i<r.length;i++){var n=r[i];n.labelPosition=null,n.labelRegion=null,n.labelVisible=!0}},e.prototype.getModuleName=function(){return"accumulationchart"},e.prototype.destroy=function(){if(this.element){this.unWireEvents(),o.prototype.destroy.call(this),this.element.classList.remove("e-accumulationchart"),this.element.classList.remove("e-accumulationchart-focused");var t=document.getElementById(this.element.id+"Keyboard_accumulationchart_focus");t&&t.remove(),ni("chartmeasuretext"),this.removeSvg();var i=document.getElementById(this.element.id+"_ej2_chart_highlight");i&&i.remove();var r=document.getElementById(this.element.id+"_ej2_chart_selection");r&&r.remove(),this.svgObject=null}},e.prototype.requiredModules=function(){var t=[],i=!1;return t.push({member:this.type+"Series",args:[this]}),this.legendSettings.visible&&t.push({member:"AccumulationLegend",args:[this]}),this.findDatalabelVisibility()&&t.push({member:"AccumulationDataLabel",args:[this]}),this.tooltip.enable&&t.push({member:"AccumulationTooltip",args:[this]}),this.selectionMode!=="None"&&t.push({member:"AccumulationSelection",args:[this]}),this.highlightMode!=="None"&&t.push({member:"AccumulationHighlight",args:[this]}),(this.enableExport||this.allowExport)&&t.push({member:"Export",args:[this]}),i=this.annotations.some(function(r){return r.content!==null}),i&&t.push({member:"Annotation",args:[this]}),t},e.prototype.findDatalabelVisibility=function(){for(var t=0,i=this.series;t<i.length;t++){var r=i[t];if(r.dataLabel.visible)return!0}return!1},e.prototype.changeVisibleSeries=function(t,i){for(var r=0,n=t;r<n.length;r++){var s=n[r];if(i===s.index)return s}return null},e.prototype.getPersistData=function(){return""},e.prototype.sanitize=function(t){return this.enableHtmlSanitizer?Bt.sanitize(t):t},e.prototype.onPropertyChanged=function(t,i){for(var r={refreshElements:!1,refreshBounds:!1},n=0,s=Object.keys(t);n<s.length;n++){var a=s[n];switch(a){case"theme":this.animateSeries=!0;break;case"title":case"subTitle":case"height":case"width":case"margin":r.refreshBounds=!0;break;case"titleStyle":t.titleStyle&&(t.titleStyle.size||t.titleStyle.textOverflow)?r.refreshBounds=!0:r.refreshElements=!0;break;case"subTitleStyle":t.subTitleStyle&&(t.subTitleStyle.size||t.subTitleStyle.textOverflow)?r.refreshBounds=!0:r.refreshElements=!0;break;case"legendSettings":r.refreshBounds=!0,r.refreshElements=!0;break;case"dataSource":this.processData(!1),r.refreshBounds=!0;break;case"series":if(!this.animateselected){for(var l=this.series.length,h=!1,u=void 0,c=void 0,d=0;d<l;d++)u=t.series[d],(u.startAngle||u.endAngle||u.explodeOffset||u.neckHeight||u.neckWidth||u.radius||u.innerRadius||u.groupMode||u.emptyPointSettings)&&this.isBlazor&&(c=!0),t.series[d]&&(t.series[d].dataSource||t.series[d].yName||t.series[d].xName||u.type||t.series[d].dataLabel||u.radius||u.innerRadius||u.startAngle||u.endAngle||u.gapRatio||u.neckWidth||u.explode||u.neckWidth||u.pyramidMode||u.explodeOffset||u.funnelMode||c)&&(he(this.changeVisibleSeries(this.visibleSeries,d),u,null,!0),h=!0),t.series[d]&&!g(t.series[d].explodeIndex)&&t.series[d].explodeIndex>=0&&t.series[d].explodeIndex!==i.series[d].explodeIndex?(this.accBaseModule.explodePoints(t.series[d].explodeIndex,this),this.accBaseModule.deExplodeAll(t.series[d].explodeIndex,this.enableAnimation?300:0)):t.series[d].explodeIndex<0&&this.accBaseModule.deExplodeAll(t.series[d].explodeIndex,this.enableAnimation?300:0),this.pieSeriesModule||(this.pieSeriesModule=new qm(this));h&&(this.calculateVisibleSeries(),this.processData(!1),r.refreshBounds=!0)}this.animateselected=!1,this.redraw=!1;break;case"enableRtl":case"locale":case"currencyCode":o.prototype.refresh.call(this);break;case"background":case"border":case"annotations":case"enableSmartLabels":r.refreshElements=!0;break;case"isMultiSelect":case"selectedDataIndexes":case"selectionMode":this.accumulationSelectionModule&&(g(this.accumulationSelectionModule.selectedDataIndexes)?this.accumulationSelectionModule.invokeSelection(this):(this.accumulationSelectionModule.selectedDataIndexes=this.selectedDataIndexes,this.accumulationSelectionModule.redrawSelection(this)));break;case"tooltip":this.accumulationTooltipModule&&(this.accumulationTooltipModule.previousPoints=[],this.tooltip.template&&(this.accumulationTooltipModule.template=this.tooltip.template));break;case"center":g(t.center.x)||(this.center.x=t.center.x,r.refreshElements=!0),g(t.center.y)||(this.center.y=t.center.y,r.refreshElements=!0);break}}!r.refreshBounds&&r.refreshElements?(this.createPieSvg(),this.renderElements()):r.refreshBounds&&(this.refreshSeries(),this.createPieSvg(),this.calculateBounds(),this.renderElements())},ft([C(null)],e.prototype,"width",void 0),ft([C(null)],e.prototype,"height",void 0),ft([C(null)],e.prototype,"title",void 0),ft([C(null)],e.prototype,"backgroundImage",void 0),ft([be({},KW)],e.prototype,"center",void 0),ft([C("")],e.prototype,"dataSource",void 0),ft([be({fontFamily:null,size:null,fontStyle:null,fontWeight:null,color:null},fN)],e.prototype,"titleStyle",void 0),ft([C(null)],e.prototype,"subTitle",void 0),ft([be({fontFamily:null,size:null,fontStyle:null,fontWeight:null,color:null},fN)],e.prototype,"subTitleStyle",void 0),ft([be({},dF)],e.prototype,"legendSettings",void 0),ft([be({},FN)],e.prototype,"tooltip",void 0),ft([be({},yU)],e.prototype,"centerLabel",void 0),ft([C("None")],e.prototype,"selectionMode",void 0),ft([C("")],e.prototype,"highlightColor",void 0),ft([C("None")],e.prototype,"highlightMode",void 0),ft([C("None")],e.prototype,"selectionPattern",void 0),ft([C("None")],e.prototype,"highlightPattern",void 0),ft([C(!1)],e.prototype,"enableHtmlSanitizer",void 0),ft([C(!0)],e.prototype,"enableBorderOnMouseMove",void 0),ft([C(!1)],e.prototype,"isMultiSelect",void 0),ft([C(!0)],e.prototype,"enableAnimation",void 0),ft([Wt([],RN)],e.prototype,"selectedDataIndexes",void 0),ft([be({},Hc)],e.prototype,"margin",void 0),ft([C(!0)],e.prototype,"enableSmartLabels",void 0),ft([be({color:"#DDDDDD",width:0},Zn)],e.prototype,"border",void 0),ft([C(null)],e.prototype,"background",void 0),ft([Wt([{}],ZW)],e.prototype,"series",void 0),ft([Wt([{}],XW)],e.prototype,"annotations",void 0),ft([C("Material")],e.prototype,"theme",void 0),ft([C(!1)],e.prototype,"useGroupingSeparator",void 0),ft([C(!0)],e.prototype,"enableExport",void 0),ft([C(!1)],e.prototype,"allowExport",void 0),ft([be({},So)],e.prototype,"accessibility",void 0),ft([C(null)],e.prototype,"focusBorderColor",void 0),ft([C(1.5)],e.prototype,"focusBorderWidth",void 0),ft([C(0)],e.prototype,"focusBorderMargin",void 0),ft([q()],e.prototype,"loaded",void 0),ft([q()],e.prototype,"legendClick",void 0),ft([q()],e.prototype,"load",void 0),ft([q()],e.prototype,"seriesRender",void 0),ft([q()],e.prototype,"legendRender",void 0),ft([q()],e.prototype,"textRender",void 0),ft([q()],e.prototype,"tooltipRender",void 0),ft([q()],e.prototype,"pointRender",void 0),ft([q()],e.prototype,"annotationRender",void 0),ft([q()],e.prototype,"beforePrint",void 0),ft([q()],e.prototype,"chartMouseMove",void 0),ft([q()],e.prototype,"chartMouseClick",void 0),ft([q()],e.prototype,"chartDoubleClick",void 0),ft([q()],e.prototype,"pointClick",void 0),ft([q()],e.prototype,"pointMove",void 0),ft([q()],e.prototype,"animationComplete",void 0),ft([q()],e.prototype,"chartMouseDown",void 0),ft([q()],e.prototype,"chartMouseLeave",void 0),ft([q()],e.prototype,"chartMouseUp",void 0),ft([q()],e.prototype,"beforeResize",void 0),ft([q()],e.prototype,"resized",void 0),ft([q()],e.prototype,"beforeExport",void 0),ft([q()],e.prototype,"afterExport",void 0),ft([q()],e.prototype,"selectionComplete",void 0),ft([C("USD")],e.prototype,"currencyCode",void 0),e=ft([bt],e),e}(Kt);var n6=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),kF=function(o){n6(e,o);function e(t){var i=o.call(this,t)||this;return i.library=i,i.titleRect=new Ae(0,t.margin.top,0,0),i.addEventListener(),i}return e.prototype.addEventListener=function(){this.chart.isDestroyed||(this.chart.on(B.touchMoveEvent,this.mouseMove,this),this.chart.on(B.touchEndEvent,this.mouseEnd,this),this.chart.on("click",this.click,this))},e.prototype.removeEventListener=function(){this.chart.isDestroyed||(this.chart.off(B.touchMoveEvent,this.mouseMove),this.chart.off("click",this.click),this.chart.off(B.touchEndEvent,this.mouseEnd))},e.prototype.mouseMove=function(t){if(this.chart.legendSettings.visible&&!this.chart.isTouch&&this.chart.accumulationHighlightModule&&this.chart.highlightMode!=="None"){this.chart.legendSettings.toggleVisibility||this.click(t);for(var i=[this.legendID+"_text_",this.legendID+"_shape_marker_",this.legendID+"_shape_",this.legendID+"_g_"],r=t.target.id,n=void 0,s=0,a=i;s<a.length;s++){var l=a[s];if(r.indexOf(l)>-1){n=parseInt(r.split(l)[1],10),this.chart.accumulationHighlightModule.legendSelection(this.chart,0,n,t.target,t.type);break}}}},e.prototype.mouseEnd=function(t){this.chart.legendSettings.visible&&this.chart.isTouch&&this.move(t)},e.prototype.getLegendOptions=function(t,i){this.legendCollections=[],this.isRtlEnable=t.enableRtl,this.isReverse=!this.isRtlEnable&&t.legendSettings.reverse;for(var r=0;r<1;r++){var n=i[r].type;(n==="Pie"||n==="Doughnut")&&(n=i[r].innerRadius!=="0"&&i[r].innerRadius!=="0%"?"Doughnut":"Pie");for(var s=0,a=i[r].points;s<a.length;s++){var l=a[s];!g(l.x)&&!g(l.y)&&this.legendCollections.push(new qh(t.useGroupingSeparator&&typeof l.x=="number"?t.intl.formatNumber(l.x,{useGrouping:!0}):l.x.toString(),l.color,i[r].legendShape,l.visible,n,l.legendImageUrl,null,null,l.index,i[r].index,null,l.x.toString()))}this.isReverse&&this.legendCollections.reverse()}},e.prototype.getLegendBounds=function(t,i,r){this.calculateLegendTitle(r,i),this.isTitle=!!r.title;var n=0,s=0,a;this.chartRowCount=1,this.rowHeights=[],this.columnHeights=[],this.pageHeights=[];var l=r.padding,h=r.titlePosition,u=0,c=this.arrowWidth,d=r.enablePages?0:this.arrowHeight;this.isVertical?n=r.width?0:t.width/100*5:s=r.height?0:t.height/100*5,i.width+=n,i.height+=s;var p=r.shapePadding,f=r.maximumLabelWidth?r.maximumLabelWidth:0,v=r.shapeWidth,m=0,y=0,S=0,b=[],w=[],I=0,x=0,M=0,D=0,A=0;this.maxItemHeight=Math.max(Ze("MeasureText",r.textStyle,this.chart.themeStyle.legendLabelFont).height,r.shapeHeight);var L,T=!1,k=r.layout==="Auto"&&r.maximumColumns>0;if(r.fixedWidth)for(var F=0;F<this.legendCollections.length;F++){var R=v+p+(this.isVertical||F===0?l:this.itemPadding)+(r.maximumLabelWidth?r.maximumLabelWidth:Ze(this.legendCollections[F].text,r.textStyle,this.chart.themeStyle.legendLabelFont).width);this.maxColumnWidth=this.maxColumnWidth>R?this.maxColumnWidth:R}for(var F=0;F<this.legendCollections.length;F++)if(a=this.legendCollections[F],L={fill:a.fill,text:a.text,shape:a.shape,name:"legendRender",cancel:!1},this.chart.trigger("legendRender",L),a.render=!L.cancel,a.text=a.originalText=L.text.indexOf("&")>-1?this.convertHtmlEntities(L.text):L.text,a.fill=L.fill,a.shape=L.shape,a.textSize=Ze(a.text,r.textStyle,this.chart.themeStyle.legendLabelFont),a.render&&a.text!=="")if(T=!0,D=r.fixedWidth?this.maxColumnWidth:v+p+(r.maximumLabelWidth?r.maximumLabelWidth:a.textSize.width)+(!this.isVertical||r.layout==="Horizontal"?F===0||y===1&&S>0&&r.layout==="Horizontal"?l:this.itemPadding:l),this.getLegendHeight(a,r,i,m,this.maxItemHeight,l),this.isVertical&&r.layout==="Auto"&&!k)M+=Math.max(a.textSize.height,r.shapeHeight)+(F===0?l:this.itemPadding),M+this.itemPadding+d/this.pageButtonSize>i.height&&(m=m+f,I=this.getPageWidth(w),this.totalPages=Math.max(S,this.totalPages||1),m-I+D>i.width?(w.push(m-I),S=this.rowHeights.length,x=S):S=x,b.push(f),f=0,M=Math.max(a.textSize.height,r.shapeHeight)+l,y++),this.columnHeights[y]=(this.columnHeights[y]?this.columnHeights[y]:0)+Math.max(a.textSize.height,r.shapeHeight)+(F===0?l:this.itemPadding),f=Math.max(D,f),this.rowHeights[S]=Math.max(this.rowHeights[S]?this.rowHeights[S]:0,Math.max(a.textSize.height,r.shapeHeight)),S++;else{r.enablePages||(u=this.isTitle&&h!=="Top"?this.legendTitleSize.width+this.fivePixel:0,u+=c),m=m+D,(k?r.maximumColumns===y:i.width<l+m+u||this.legend.layout==="Vertical"&&y===1)&&(f=Math.max(f,m+l+u-D),S===0&&D!==m&&(S=1),m=D,S++,y=0);var N=S&&S-1;this.rowHeights[N]=Math.max(this.rowHeights[N]?this.rowHeights[N]:0,Math.max(a.textSize.height,r.shapeHeight)),this.columnHeights[y]=(this.columnHeights[y]?this.columnHeights[y]:0)+Math.max(a.textSize.height,r.shapeHeight)+l,k&&this.columnHeights[y]>i.height&&(this.columnHeights[y]-=Math.max(a.textSize.height,r.shapeHeight)+l),y++}A=h==="Top"?this.legendTitleSize.height:0,this.isVertical&&r.layout==="Auto"&&!k?(m=m+f,this.isPaging=i.width<m+l,M=Math.max.apply(null,this.columnHeights)+l+d+A,M=Math.max(M,(this.totalPages||1)*(this.maxItemHeight+l)+l+d),this.isPaging=this.isPaging&&this.totalPages>1,b.push(f)):(this.totalPages=this.totalRowCount=S,M=Math.max.apply(null,this.columnHeights)+l+d+A,this.isPaging=(i.height<M||r.layout==="Horizontal"&&this.rowHeights.length>1)&&!k,M=!r.enablePages&&this.isPaging&&r.layout!=="Vertical"?this.maxItemHeight+l+l+A:M,M=Math.max(M,this.maxItemHeight+l+l+A),r.layout==="Horizontal"&&(M=this.maxItemHeight+l*2+A+this.pageButtonSize+r.border.width),this.isPaging||(m+=this.isTitle&&h!=="Top"?this.fivePixel+this.legendTitleSize.width+this.fivePixel:0)),this.maxColumns=0;var P;k&&this.maxColumnWidth&&r.fixedWidth?(P=this.maxColumnWidth*r.maximumColumns+l,this.isPaging=!1):P=this.isVertical&&r.layout==="Auto"&&!k?this.getMaxColumn(b,i.width,l,m+l):Math.max(m+l,f),T?this.setBounds(P,M,r,i):this.setBounds(0,0,r,i)},e.prototype.getPageWidth=function(t){for(var i=0,r=0;r<t.length;r++)i+=t[r];return i},e.prototype.getLegendHeight=function(t,i,r,n,s,a){var l=t.textSize.width,h=i.shapePadding+a*2+i.shapeWidth;switch(i.textWrap){case"Wrap":case"AnyWhere":l>i.maximumLabelWidth||l+n>r.width?t.textCollection=ol(t.text,i.maximumLabelWidth?Math.min(i.maximumLabelWidth,r.width-h):r.width-h,i.textStyle,this.chart.enableRtl,i.textWrap==="AnyWhere",null,this.chart.themeStyle.legendLabelFont):t.textCollection.push(t.text),t.textSize.height=s*t.textCollection.length;break}},e.prototype.convertHtmlEntities=function(t){var i=t.replace("&amp;","&").replace("&lt;","<").replace("&gt;",">").replace("&quot;",'"').replace("&nbsp;"," ").replace("&cent;","\xA2").replace("&pound;","\xA3").replace("&yen;","\xA5").replace("&euro;","\u20AC").replace("&copy;","\xA9").replace("&reg;","\xAE");return i=i.replace("&#38;","&").replace("&#60;","<").replace("&#62;",">").replace("&#34;",'"').replace("&#160;"," ").replace("&#162;","\xA2").replace("&#163;","\xA3").replace("&#165;","\xA5").replace("&#8364;","\u20AC").replace("&#169;","\xA9").replace("&#174;","\xAE"),i},e.prototype.getMaxColumn=function(t,i,r,n){var s=r;this.maxColumnWidth=Math.max.apply(null,t);for(var a=0,l=t;a<l.length;a++){var h=l[a];if(s+=this.maxColumnWidth,this.maxColumns++,s+r>i){s-=this.maxColumnWidth,this.maxColumns--;break}}this.isPaging=s<n&&this.totalPages>1,s===r&&(s=i),this.maxColumns=Math.max(1,this.maxColumns),this.maxWidth=s;var u=this.maxColumnWidth+r,c=0,d=this.columnHeights.length;if(this.isPaging&&this.isVertical){for(var p=1;p<d;p++)u+=this.maxColumnWidth+r,u>i&&(this.pageHeights.push(c!==p-1?Math.max.apply(null,this.columnHeights.slice(c,p-1)):this.columnHeights[c]),u=this.maxColumnWidth+r,c=p);this.pageHeights.push(c!==d-1?Math.max.apply(null,this.columnHeights.slice(c,d-1)):this.columnHeights[c]),this.totalPages=this.pageHeights.length}return s},e.prototype.getAvailWidth=function(t,i){if(this.isVertical&&this.legend.layout==="Auto"&&!(this.legend.maximumColumns>0))i=this.maxWidth;else if(!this.isVertical&&this.legend.layout!=="Vertical"&&!(this.legend.maximumColumns>0)&&this.isPaging&&!this.legend.enablePages)return i-t-this.fivePixel;return i-(this.legend.padding*2+this.legend.shapeWidth+this.legend.shapePadding)},e.prototype.getRenderPoint=function(t,i,r,n,s,a,l){var h=this.legend.padding,u=n.location.y+this.maxItemHeight/4+(n.textCollection.length>0?(n.textCollection.length-1)*this.maxItemHeight:0);if(this.isVertical&&this.legend.layout==="Auto"&&!(this.legend.maximumColumns>0))if(a===l||u+Math.max(t.textSize.height,this.legend.shapeHeight)+h>s.y+s.height){t.location.x=n.location.x+(a===l?0:this.isRtlEnable?-this.maxColumnWidth:this.maxColumnWidth),t.location.y=i.y;var c=this.legend.shapeWidth/2+h;this.pageXCollections.push(t.location.x+(this.isRtlEnable?c:-c))}else t.location.x=n.location.x,t.location.y=n.location.y+Math.max(n.textSize.height,this.legend.shapeHeight)+this.itemPadding;else{var d=this.legend.fixedWidth?this.maxColumnWidth:r+(this.legend.maximumLabelWidth?this.legend.maximumLabelWidth:n.textSize.width),p=n.location.x+(this.isRtlEnable?-d:d);(this.legend.layout==="Auto"&&this.legend.maximumColumns>0?a%this.legend.maximumColumns===0:this.isWithinBounds(p,(this.legend.maximumLabelWidth?this.legend.maximumLabelWidth:t.textSize.width)+r-this.itemPadding,s,this.legend.shapeWidth/2)||this.legend.layout==="Vertical")?(a!==l&&this.chartRowCount++,t.location.y=a===l?n.location.y:n.location.y+this.rowHeights[this.chartRowCount-2]+h,t.location.x=i.x):(t.location.y=n.location.y,t.location.x=a===l?n.location.x:p)}var f=this.getAvailWidth(t.location.x,this.legendBounds.width);f=this.legend.maximumLabelWidth?Math.min(this.legend.maximumLabelWidth,f):f,this.legend.textOverflow==="Ellipsis"&&this.legend.textWrap==="Normal"&&(t.text=js(+f.toFixed(4),t.text,this.legend.textStyle,this.chart.enableRtl,this.chart.themeStyle.legendLabelFont))},e.prototype.isWithinBounds=function(t,i,r,n){return this.isRtlEnable?t-i<r.x-n:t+i>r.x+r.width+n},e.prototype.getSmartLegendLocation=function(t,i,r){var n;switch(this.position){case"Left":n=(t.x-i.width-r.left)/2,i.x=t.x-i.width<r.left?i.x:t.x-i.width-n;break;case"Right":n=(this.chart.availableSize.width-r.right-(t.x+t.width+i.width))/2,i.x=t.x+t.width+i.width>this.chart.availableSize.width-r.right?i.x:t.x+t.width+n;break;case"Top":this.getTitleRect(this.chart),n=(t.y-i.height-(this.titleRect.y+this.titleRect.height))/2,i.y=t.y-i.height<r.top?i.y:t.y-i.height-n;break;case"Bottom":n=(this.chart.availableSize.height-r.bottom-(t.y+t.height+i.height))/2,i.y=t.y+t.height+i.height>this.chart.availableSize.height-r.bottom?i.y:t.y+t.height+n;break}},e.prototype.getTitleRect=function(t){if(!t.title)return null;var i=Ze(t.title,t.titleStyle,this.chart.themeStyle.legendTitleFont);this.titleRect=new Ae(t.availableSize.width/2-i.width/2,t.margin.top,i.width,i.height)},e.prototype.legendByIndex=function(t,i){for(var r=0,n=i;r<n.length;r++){var s=n[r];if(s.pointIndex===t)return s}return null},e.prototype.click=function(t){var i=t.target.id.indexOf("_chart_legend_g_")>-1?t.target.firstChild.id:t.target.id,r=this.chart,n=[this.legendID+"_text_",this.legendID+"_shape_",this.legendID+"_shape_marker_"];this.chart.animateSeries=!1;for(var s=0,a=n;s<a.length;s++){var l=a[s];if(i.indexOf(l)>-1){var h=parseInt(i.split(l)[1],10);if(this.chart.legendSettings.toggleVisibility&&!isNaN(h)){var u=this.chart.visibleSeries[0],c=LF(h,u.points),d=this.legendByIndex(h,this.legendCollections),p={legendText:d.text,legendShape:d.shape,chart:r.isBlazor?{}:r,series:u,point:c,name:Xl,cancel:!1};if(this.chart.trigger(Xl,p),!p.cancel){c.visible=!c.visible,d.visible=c.visible,u.sumOfPoints+=c.visible?c.y:-c.y,r.redraw=r.enableAnimation,this.sliceVisibility(h,c.visible),r.removeSvg(),Xm(r),this.chart.refreshPoints(u.points),this.chart.calculateBounds();var f=document.getElementById(this.chart.element.id+"PointHover_Border");f&&this.chart.pieSeriesModule.removeBorder(f,0),this.chart.accumulationTooltipModule&&this.chart.accumulationTooltipModule.removeTooltip(0),this.chart.renderElements()}}else this.chart.accumulationSelectionModule&&!isNaN(h)?this.chart.accumulationSelectionModule.legendSelection(this.chart,0,h,t.target,t.type):this.chart.accumulationHighlightModule&&!isNaN(h)&&this.chart.accumulationHighlightModule.legendSelection(this.chart,0,h,t.target,t.type)}}i.indexOf(this.legendID+"_pageup")>-1?this.changePage(t,!0):i.indexOf(this.legendID+"_pagedown")>-1&&this.changePage(t,!1),r.redraw=!1},e.prototype.sliceVisibility=function(t,i){var r=this.chart.element.id+"_Series_0_Point_";this.chart.visibleSeries[0].dataLabel.visible&&(r=this.chart.element.id+"_datalabel_Series_0_",this.sliceAnimate(ce(r+"g_"+t),i))},e.prototype.sliceAnimate=function(t,i){if(!t)return null;new It({}).animate(t,{duration:300,delay:0,name:i?"FadeIn":"FadeOut",end:function(r){r.element.style.visibility=i?"visible":"hidden"}})},e.prototype.getModuleName=function(){return"AccumulationLegend"},e.prototype.destroy=function(){this.removeEventListener()},e}(pF),s6=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),NF=function(o){s6(e,o);function e(t){var i=o.call(this,t)||this;return i.rightSideRenderingPoints=[],i.leftSideRenderingPoints=[],i.id=t.element.id+"_datalabel_Series_",i}return e.prototype.getDataLabelPosition=function(t,i,r,n){var s=this.isCircular()?this.isVariousRadius()?this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],t):this.accumulation.pieSeriesModule.labelRadius:this.getLabelDistance(t,i);if(this.accumulation.title){var a=Ze(this.accumulation.title,this.accumulation.titleStyle,this.accumulation.themeStyle.datalabelFont);this.titleRect=new Ae(this.accumulation.availableSize.width/2-a.width/2,this.accumulation.margin.top,a.width,a.height)}this.getLabelRegion(t,i.position,r,s,this.marginValue),t.labelAngle=t.midAngle,t.labelPosition=i.position,this.accumulation.enableSmartLabels&&this.getSmartLabel(t,i,r,n)},e.prototype.getLabelRegion=function(t,i,r,n,s,a){a===void 0&&(a=0);var l=a||t.midAngle,h=20,u=wn(l,n,this.isCircular()?this.center:this.getLabelLocation(t,i));u.y=i==="Inside"?u.y-r.height/2:u.y,u.x=i==="Inside"?u.x-r.width/2:u.x,t.labelRegion=new Ae(u.x,u.y,r.width+s*2,r.height+s*2),i==="Outside"&&(t.labelRegion.y-=t.labelRegion.height/2,l>=90&&l<=270?t.labelRegion.x-=t.labelRegion.width+h:t.labelRegion.x+=h)},e.prototype.calculateLabelCollection=function(t,i){if(t.argsData.template!==null)return null;var r=t.labelPosition||i.position,n=this.isCircular()?this.isVariousRadius()?this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],t):this.accumulation.pieSeriesModule.labelRadius:this.getLabelDistance(t,i),s=this.isVariousRadius()?this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],t):this.accumulation.pieSeriesModule.radius-this.accumulation.pieSeriesModule.innerRadius,a=wn(t.midAngle,n,this.isCircular()?this.center:this.getLabelLocation(t,r)),l=20,h=i.maxWidth;h||(r==="Outside"?h=this.isCircular()?a.x>=this.center.x?this.areaRect.x+this.areaRect.width-a.x:a.x-this.areaRect.x:a.x>=t.region.x?this.areaRect.x+this.areaRect.width-a.x:a.x-this.areaRect.x:h=this.isCircular()?s-l:t.region.width),t.label.indexOf("<br>")!==-1?t.labelCollection=t.label.split("<br>"):i.textWrap==="Normal"&&i.textOverflow==="Ellipsis"?t.labelCollection[0]=js(h,t.label,t.argsData.font,this.accumulation.enableRtl,this.accumulation.themeStyle.datalabelFont):i.textWrap==="Wrap"||i.textWrap==="AnyWhere"?t.labelCollection=ol(t.label,h,t.argsData.font,this.accumulation.enableRtl,i.textWrap==="AnyWhere",i.textOverflow==="Clip",this.accumulation.themeStyle.datalabelFont):t.labelCollection[0]=t.label},e.prototype.getTextSize=function(t,i){for(var r=0,n=i.font,s=i.maxWidth?i.maxWidth:0,a,l=0;l<t.length;l++)a=Ze(t[l],n,this.accumulation.themeStyle.datalabelFont),s=Math.max(a.width,s),r+=a.height;return i.textOverflow==="Clip"&&i.textWrap!=="Normal"&&i.maxWidth&&(s=i.maxWidth),new _t(s,r)},e.prototype.getSmartLabel=function(t,i,r,n){var s=this.isCircular(),a=s?this.radius:this.getLabelDistance(t,i),l=s?i.connectorStyle.length||"4%":"0px";a+=Ni(l,a);var h=this.findPreviousPoint(n,t.index,t.labelPosition);if(i.position==="Inside"?(t.labelRegion.height-=4,t.labelRegion.width-=4,(h&&h.labelRegion&&!i.enableRotation&&($n(t.labelRegion,h.labelRegion)||this.isOverlapping(t,n))||!s&&!rW(t.region,t.labelRegion))&&(t.labelPosition="Outside",s||(a=this.getLabelDistance(t,i)),this.calculateLabelCollection(t,i),r=this.getTextSize(t.labelCollection,i),r.height+=4,r.width+=4,this.getLabelRegion(t,t.labelPosition,r,a,this.marginValue),h=this.findPreviousPoint(n,t.index,t.labelPosition),h&&($n(t.labelRegion,h.labelRegion)||this.isConnectorLineOverlapping(t,h))&&this.setOuterSmartLabel(h,t,i.border.width,a,r,this.marginValue))):h&&h.labelRegion&&($n(t.labelRegion,h.labelRegion)||this.isOverlapping(t,n)||this.isConnectorLineOverlapping(t,h))&&this.setOuterSmartLabel(h,t,i.border.width,a,r,this.marginValue),this.isOverlapping(t,n)&&(this.accumulation.type==="Pyramid"||this.accumulation.type==="Funnel")){var u="OutsideLeft",c=20,d=t.midAngle||0,p=s?this.radius:this.getLabelDistance(t,i),f=wn(d,-p,this.isCircular()?this.center:this.getLabelLocation(t,u));t.labelRegion=new Ae(f.x,f.y,r.width+this.marginValue*2,r.height+this.marginValue*2),t.labelRegion.y-=t.labelRegion.height/2,t.labelRegion.x=t.labelRegion.x-c-t.labelRegion.width,h&&h.labelRegion&&($n(t.labelRegion,h.labelRegion)||this.isOverlapping(t,n)||this.isConnectorLineOverlapping(t,h))&&this.setOuterSmartLabel(h,t,i.border.width,p,r,this.marginValue)}},e.prototype.move=function(t,i,r,n){var s=this;if(t.target.textContent.indexOf("...")>-1){var a=t.target.id.split(this.id);if(a.length===2){var l=parseInt(a[1].split("_text_")[0],10),h=parseInt(a[1].split("_text_")[1],10);if(!isNaN(l)&&!isNaN(h)){n&&ni(this.accumulation.element.id+"_EJ2_Datalabel_Tooltip");var u=JW(l,this.accumulation.visibleSeries).points[h];Pc(u.text||u.y.toString(),i,r,this.areaRect.width,this.accumulation.element.id+"_EJ2_Datalabel_Tooltip",ce(this.accumulation.element.id+"_Secondary_Element"),null,null,this.accumulation.initialClipRect)}}}else ni(this.accumulation.element.id+"_EJ2_Datalabel_Tooltip");n&&(clearTimeout(this.clearTooltip),this.clearTooltip=+setTimeout(function(){ni(s.accumulation.element.id+"_EJ2_Datalabel_Tooltip")},1e3))},e.prototype.findPreviousPoint=function(t,i,r){for(var n=t[0],s=i-1;s>=0;s--)if(n=t[s],n.visible&&n.labelVisible&&n.labelRegion&&n.labelPosition===r)return n;return null},e.prototype.isOverlapping=function(t,i){for(var r=t.index-1;r>=0;r--)if(i[r].visible&&i[r].labelVisible&&i[r].labelRegion&&t.labelRegion&&t.labelVisible&&$n(t.labelRegion,i[r].labelRegion))return!0;return!1},e.prototype.textTrimming=function(t,i,r,n,s){if($n(t.labelRegion,i)){var a=t.labelRegion.width;if(n==="Right"?a=i.x-t.labelRegion.x:n==="Left"?(a=t.labelRegion.x-(i.x+i.width),a<0&&(a+=t.labelRegion.width,t.labelRegion.x=i.x+i.width)):n==="InsideRight"?a=i.x+i.width-t.labelRegion.x:n==="InsideLeft"?(a=t.labelRegion.x+t.labelRegion.width-i.x,a<t.labelRegion.width&&(t.labelRegion.x=i.x)):this.accumulation.enableSmartLabels&&this.setPointVisibileFalse(t),t.labelVisible&&t.labelRegion){t.label.indexOf("<br>")!==-1?t.labelCollection=t.label.split("<br>"):a<t.labelRegion.width&&(s.textWrap==="Normal"&&s.textOverflow==="Ellipsis"?t.labelCollection[0]=js(a-this.marginValue*2,t.label,r,this.accumulation.enableRtl,this.accumulation.themeStyle.datalabelFont):(s.textWrap==="Wrap"||s.textWrap==="AnyWhere")&&(t.labelCollection=ol(t.label,a-this.marginValue*2,r,this.accumulation.enableRtl,s.textWrap==="AnyWhere",s.textOverflow==="Clip",this.accumulation.themeStyle.datalabelFont)),t.labelRegion.width=a);for(var l=0;l<t.labelCollection.length;l++)if(t.labelCollection[l].length===3&&t.labelCollection[l].indexOf("...")>-1){this.setPointVisibileFalse(t);break}}}},e.prototype.setPointVisibileFalse=function(t){t.labelVisible=!1,t.labelRegion=null},e.prototype.setPointVisibleTrue=function(t){t.labelVisible=!0},e.prototype.setOuterSmartLabel=function(t,i,r,n,s,a){if(!this.isCircular())this.setSmartLabelForSegments(i,t);else{var l=this.getOverlappedAngle(t.labelRegion,i.labelRegion,i.midAngle,r*2);for(this.getLabelRegion(i,"Outside",s,n,a,l),l>i.endAngle&&(l=i.midAngle),i.labelAngle=l;i.labelVisible&&($n(t.labelRegion,i.labelRegion)||l<=t.labelAngle||l<=i.midAngle*.9||this.isConnectorLineOverlapping(i,t))&&!(l>i.endAngle);)i.labelAngle=l,this.getLabelRegion(i,"Outside",s,n,a,l),l+=.1}},e.prototype.setSmartLabelForSegments=function(t,i){var r=t.labelRegion,n=this.accumulation.type==="Funnel"?i.labelRegion.y-(r.y+r.height):t.labelRegion.y-(i.labelRegion.y+i.labelRegion.height);n<0&&(t.labelRegion.y+=this.accumulation.type==="Funnel"?n:-n)},e.prototype.isConnectorLineOverlapping=function(t,i){var r;!this.isCircular()&&t.labelRegion.x<t.region.x&&(r="outsideLeft");var n=this.getLabelLocation(t,r),s=new Je(0,0);this.getEdgeOfLabel(t.labelRegion,t.labelAngle,s,0,t);var a=this.getLabelLocation(i),l=new Je(0,0);return this.getEdgeOfLabel(i.labelRegion,i.labelAngle,l,0,t),this.isLineRectangleIntersect(n,s,t.labelRegion)||this.isLineRectangleIntersect(n,s,i.labelRegion)||this.isLineRectangleIntersect(a,l,t.labelRegion)},e.prototype.isLineRectangleIntersect=function(t,i,r){var n=[new Je(Math.round(r.x),Math.round(r.y)),new Je(Math.round(r.x+r.width),Math.round(r.y)),new Je(Math.round(r.x+r.width),Math.round(r.y+r.height)),new Je(Math.round(r.x),Math.round(r.y+r.height))];t.x=Math.round(t.x),t.y=Math.round(t.y),i.x=Math.round(i.x),i.y=Math.round(i.y);for(var s=0;s<n.length;s++)if(this.isLinesIntersect(t,i,n[s],n[(s+1)%n.length]))return!0;return!1},e.prototype.isLinesIntersect=function(t,i,r,n){var s=i.y-t.y,a=t.x-i.x,l=s*t.x+a*t.y,h=n.y-r.y,u=r.x-n.x,c=h*r.x+u*r.y,d=s*u-h*a;if(d!==0){var p=(u*l-a*c)/d,f=(s*c-h*l)/d,v=Math.min(t.x,i.x)<=p&&p<=Math.max(t.x,i.x);return v=v&&Math.min(t.y,i.y)<=f&&f<=Math.max(t.y,i.y),v=v&&Math.min(r.x,n.x)<=p&&p<=Math.max(r.x,n.x),v=v&&Math.min(r.y,n.y)<=f&&f<=Math.max(r.y,n.y),v}return!1},e.prototype.getOverlappedAngle=function(t,i,r,n){var s=t.x;return r>=90&&r<=270?(i.y=t.y-(n+i.height/2),s=t.x+t.width):i.y=t.y+t.height+n,YU(this.center,new Je(s,i.y))},e.prototype.getConnectorPath=function(t,i,r,n){n===void 0&&(n=0);var s=r.connectorStyle,a=this.isCircular()?this.isVariousRadius()?this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],i):this.labelRadius:this.getLabelDistance(i,r),l=this.getConnectorStartPoint(i,s),h=this.accumulation.enableSmartLabels?i.midAngle:n||i.midAngle,u=new Je(0,0),c=this.getEdgeOfLabel(t,h,u,s.width,i);if(s.type==="Curve")if(this.isCircular()){var d=a-(this.isVariousRadius()?Ni(i.sliceRadius,this.accumulation.pieSeriesModule.size/2):this.radius);return i.isLabelUpdated?u=this.getPerpendicularDistance(l,i):(u=wn(h,a-d/2,this.center),i.labelPosition==="Outside"&&r.position==="Inside"&&(u=wn(h,a-d*1.25,this.center))),"M "+l.x+" "+l.y+" Q "+u.x+" "+u.y+" "+c.x+" "+c.y}else return this.getPolyLinePath(l,c);else return"M "+l.x+" "+l.y+" L "+u.x+" "+u.y+" L "+c.x+" "+c.y},e.prototype.getPolyLinePath=function(t,i){var r=[t,i];if(t.y===i.y)return"M "+t.x+" "+t.y+" L "+i.x+" "+i.y;for(var n="M",s=0;s<=16;s++){var a=s/16,l=this.getBezierPoint(a,r,0,2);n+=l.x+","+l.y,s!==16&&(n+=" L")}return n},e.prototype.getBezierPoint=function(t,i,r,n){if(n===1)return i[r];var s=this.getBezierPoint(t,i,r,n-1),a=this.getBezierPoint(t,i,r+1,n-1),l=(s.x,s.x),h=(s.y,s.y),u=(a.x,a.x),c=(a.y,a.y),d=(1-t)*l+t*u,p=(1-t)*h+t*c;return s.x?{x:d,y:p}:{x:d,y:p}},e.prototype.getEdgeOfLabel=function(t,i,r,n,s){n===void 0&&(n=1);var a=new Je(t.x,t.y),l=10;return i>=90&&i<=270?(a.x+=t.width+n/2+l,a.y+=t.height/2,r.x=a.x+10,r.y=a.y):s&&s.region&&s.region.x>s.labelRegion.x?(a.x+=n*2+t.width+l,a.y+=t.height/2,r.x=a.x+10,r.y=a.y):(a.x-=l-n/2,a.y+=t.height/2,r.x=a.x-10,r.y=a.y),a},e.prototype.getLabelDistance=function(t,i){if(t.labelPosition&&i.position!==t.labelPosition||i.connectorStyle.length&&i.position==="Outside"){var r=Ni(i.connectorStyle.length||"70px",this.accumulation.initialClipRect.width);if(r<this.accumulation.initialClipRect.width)return r}var n=t.labelPosition||i.position,s=this.accumulation.visibleSeries[0],a=(this.accumulation.initialClipRect.width-s.triangleSize.width)/2,l;switch(n){case"Inside":return 0;case"Outside":return l=t.symbolLocation.x+t.labelOffset.x,this.accumulation.initialClipRect.width-l-a}},e.prototype.getLabelLocation=function(t,i){if(i===void 0&&(i="Outside"),this.accumulation.type!=="Pie"&&this.accumulation.series[0].funnelMode!=="Trapezoidal"){i=i==="OutsideLeft"?"OutsideLeft":t.labelPosition||i;var r={x:t.symbolLocation.x,y:t.symbolLocation.y-t.labelOffset.y};switch(i){case"Inside":r.y=t.region.y+t.region.height/2;break;case"Outside":r.x+=t.labelOffset.x;break;case"OutsideLeft":r.x-=t.labelOffset.x}return r}else if(this.accumulation.series[0].funnelMode==="Trapezoidal"&&this.accumulation.type==="Funnel"){var n={x:t.symbolLocation.x,y:t.symbolLocation.y};return i==="Outside"&&(n.x=t.labelOffset.x),n}else return wn(t.midAngle,this.isVariousRadius()?Ni(t.sliceRadius,this.accumulation.pieSeriesModule.seriesRadius):this.radius,this.center)},e.prototype.getConnectorStartPoint=function(t,i){var r;return!this.isCircular()&&t.region.x>t.labelRegion.x&&(r="OutsideLeft"),this.isCircular()?wn(t.midAngle,(this.isVariousRadius()?Ni(t.sliceRadius,this.accumulation.pieSeriesModule.seriesRadius):this.radius)-i.width,this.center):this.getLabelLocation(t,r)},e.prototype.findAreaRect=function(){this.areaRect=new Ae(0,0,this.accumulation.availableSize.width,this.accumulation.availableSize.height);var t=this.accumulation.margin;yo(this.areaRect,new bo(t.left,t.right,t.top,t.bottom))},e.prototype.renderDataLabel=function(t,i,r,n,s,a,l){var h=this.accumulation.element.id+"_datalabel_Series_"+s+"_",u=this.accumulation.renderer.createGroup({id:h+"g_"+t.index}),c={width:i.border.width,color:i.border.color},d=he({},V("properties",i.font),null,!0);t.label=this.getDatalabelText(i.format,this.accumulation,t.originalText||t.y.toString());var p={cancel:!1,name:jm,series:this.accumulation.visibleSeries[0],point:t,text:t.label,border:c,color:i.fill,template:this.accumulation.enableHtmlSanitizer?this.accumulation.sanitize(i.template):i.template,font:d};this.accumulation.trigger(jm,p),t.argsData=p;var f=p.template!==null;t.labelVisible=!p.cancel,t.text=t.label=p.text,t.labelCollection=[],this.marginValue=p.border.width?5+p.border.width:1;var v=Xe("div",{id:this.accumulation.element.id+"_Series_0_DataLabel_"+t.index,styles:"position: absolute;background-color:"+p.color+";"+iF(i.font,this.accumulation.themeStyle.datalabelFont)+";border:"+p.border.width+"px solid "+p.border.color+";"});this.calculateLabelSize(f,v,t,n,p,u,h,i,l)},e.prototype.getDatalabelText=function(t,i,r){if(Number(r)){var n=t.match("{value}")!==null,s=i.intl.getNumberFormat({format:n?"":t,useGrouping:i.useGroupingSeparator});r=n?t.replace("{value}",s(parseFloat(r))):s(parseFloat(r))}return r},e.prototype.calculateLabelSize=function(t,i,r,n,s,a,l,h,u,c,d){this.calculateLabelCollection(r,h);var p=t?d?{width:c.width,height:c.height}:this.getTemplateSize(i,r,s,u,t,n,a,l,h):this.getTextSize(r.labelCollection,h);p.height+=4,p.width+=4,r.textSize=p,r.templateElement=i,this.getDataLabelPosition(r,h,p,n),r.labelRegion&&this.correctLabelRegion(r.labelRegion,r.textSize)},e.prototype.drawDataLabels=function(t,i,r,n,s){var a,l,h=t.leftSidePoints.concat(t.rightSidePoints);h.sort(function(T,k){return T.index-k.index}),t.type==="Pie"&&this.accumulation.enableSmartLabels&&this.extendedLabelsCalculation();for(var u=0,c=h;u<c.length;u++){var d=c[u];if(!g(d.argsData)&&!g(d.y)){this.finalizeDatalabels(d,h,i);var p=document.getElementById(this.accumulation.element.id+"_Series_0_Point_"+d.index),f=this.accumulation.element.id+"_datalabel_Series_0_",v=this.accumulation.renderer.createGroup({id:f+"g_"+d.index});v.setAttribute("aria-hidden","true");var m=void 0,y=void 0,S=void 0;if(d.visible&&d.labelVisible){if(a=l=i.angle,d.argsData.template)this.setTemplateStyle(d.templateElement,d,n,i.font.color,d.color,s);else{y=new Je(d.labelRegion.x+this.marginValue,d.labelRegion.y+d.textSize.height*3/(d.labelCollection.length*4)+this.marginValue),S=ce(f+"shape_"+d.index);var b=S?new Je(+S.getAttribute("x"),+S.getAttribute("y")):null,w=d.textSize.width;i.enableRotation?a===0?d.labelPosition==="Outside"?l=0:d.midAngle>=90&&d.midAngle<=260?l=d.midAngle+180:l=d.midAngle:l=a>360?a-360:a<-360?a+360:a:l=0;var I="rotate("+l+","+(y.x+w/2)+","+y.y+")";d.transform=I,m=this.accumulation.renderer.drawRectangle(new as(f+"shape_"+d.index,d.argsData.color,d.argsData.border,1,d.labelRegion,i.rx,i.ry,I,t.dataLabel.border.dashArray)),vt(!1,v,m,s,!0,"x","y",b,null,!1,!1,null,this.accumulation.duration),hn(this.accumulation.renderer,new gn(f+"text_"+d.index,y.x,y.y,this.accumulation.enableRtl?"end":"start",d.labelCollection,I,"auto",l),d.argsData.font,d.argsData.font.color||this.getSaturatedColor(d,d.argsData.color),v,!1,s,!0,!1,this.accumulation.duration,null,null,null,null,!0,this.accumulation.themeStyle.datalabelFont),S=null}if(p&&this.accumulation.highlightMode!=="None"){v.setAttribute("class",p.getAttribute("class")?p.getAttribute("class"):"");for(var x=0;x<v.children.length;x++){var M=document.getElementById(v.children[x].id);M&&(v.children[x].style.opacity=M.style.opacity)}}if(this.accumulation.accumulationLegendModule&&this.accumulation.legendSettings.visible&&!this.accumulation.redraw&&(i.position==="Outside"||this.accumulation.enableSmartLabels)&&this.accumulation.visibleSeries[0].findMaxBounds(this.accumulation.visibleSeries[0].labelBound,d.labelRegion),d.labelPosition==="Outside"){var D=ce(f+"connector_"+d.index),A=D?D.getAttribute("d"):"",L=this.accumulation.renderer.drawPath(new Ir(f+"connector_"+d.index,"transparent",i.connectorStyle.width,i.connectorStyle.color||d.color,1,i.connectorStyle.dashArray,this.getConnectorPath(he({},d.labelRegion,null,!0),d,i,d.labelAngle)));vt(!1,v,L,s,!0,null,null,null,A,!1,!1,null,this.accumulation.duration)}vt(!1,r,v,s)}else ce(v.id)&&ce(v.id).parentNode.removeChild(ce(v.id))}}this.accumulation.type==="Pie"&&i.textWrap==="Normal"&&i.textOverflow==="Clip"&&this.dataLabelClipPath(i,r)},e.prototype.dataLabelClipPath=function(t,i){var r=this.accumulation.element.id+"_datalabel_Series_0_",n=this.accumulation.renderer.createClipPath({id:r+"clipPath"}),s,a=this.accumulation.pieSeriesModule.pieBaseRadius;if(t.position==="Inside")s=this.accumulation.renderer.drawCircle(new $m(r+"clipPath_rect","transparent",{width:0},0,this.center.x,this.center.y,a));else if(t.maxWidth){var l=this.center.x-a-Ni(t.connectorStyle.length||"4%",a)-t.maxWidth,h=this.center.y-a-Ni(t.connectorStyle.length||"4%",a)-t.maxWidth,u=(a+Ni(t.connectorStyle.length||"4%",a)+t.maxWidth)*2,c=u;if(this.accumulation.legendSettings.visible){var d=this.accumulation.accumulationLegendModule;d.position==="Left"?(c=d.legendBounds.x+d.legendBounds.width-l>0?c-(d.legendBounds.width-l):c,l=d.legendBounds.x+d.legendBounds.width<l?l:d.legendBounds.x+d.legendBounds.width):d.position==="Right"&&(c=l+c-d.legendBounds.x>0?c-(l+c-d.legendBounds.x):c)}s=this.accumulation.renderer.drawRectangle(new as(r+"clipPath_rect","transparent",{width:0},0,new Ae(l,h,u,c),0,0))}(t.position==="Inside"||t.maxWidth)&&(n.appendChild(s),vt(!1,this.accumulation.svgObject,n),i.style.cssText="clip-path:url(#"+n.id+")")},e.prototype.finalizeDatalabels=function(t,i,r){if((this.isOverlapping(t,i)||this.titleRect&&t.labelRegion&&$n(t.labelRegion,this.titleRect))&&this.isCircular()&&t.labelPosition==="Outside"&&this.accumulation.enableSmartLabels&&this.setPointVisibileFalse(t),this.accumulation.accumulationLegendModule&&this.accumulation.legendSettings.visible&&t.labelVisible&&t.labelRegion&&(!r.maxWidth&&(r.textOverflow!=="Clip"||r.textWrap!=="Normal"))){var n=this.accumulation.accumulationLegendModule.legendBounds;this.accumulation.visibleSeries[0].type!=="Pie"&&this.accumulation.legendSettings.position==="Left"&&r.position==="Outside"&&(t.labelRegion.x=t.labelRegion.x+n.width);var s=this.accumulation.legendSettings.border.width/2;this.textTrimming(t,new Ae(n.x-s,n.y-s,n.width+2*s,n.height+2*s),r.font,this.accumulation.accumulationLegendModule.position,r)}if(t.labelVisible&&t.labelRegion&&(!r.maxWidth&&(r.textOverflow!=="Clip"||r.textWrap!=="Normal"))){var a=this.isCircular()?t.labelRegion.x>=this.center.x?"InsideRight":"InsideLeft":t.labelRegion.x>=t.region.x?"InsideRight":"InsideLeft";this.textTrimming(t,this.areaRect,r.font,a,r)}t.labelVisible&&t.labelRegion&&!r.maxWidth&&r.textOverflow!=="Clip"&&this.accumulation.enableSmartLabels&&(t.labelRegion.y+t.labelRegion.height/2>this.areaRect.y+this.areaRect.height||t.labelRegion.y<this.areaRect.y||t.labelRegion.x<this.areaRect.x||t.labelRegion.x+t.labelRegion.width>this.areaRect.x+this.areaRect.width)&&this.setPointVisibileFalse(t)},e.prototype.getTemplateSize=function(t,i,r,n,s,a,l,h,u){t=tF(t,i.index,r.template,this.accumulation,i,this.accumulation.visibleSeries[0],this.accumulation.element.id+"_DataLabel",0,r,s,a,l,h,u,n);var c=rF(t,n);return{width:c.width,height:c.height}},e.prototype.setTemplateStyle=function(t,i,r,n,s,a){if(t.style.left=i.labelRegion.x+"px",t.style.top=i.labelRegion.y+"px",t.style.color=n||this.getSaturatedColor(i,i.labelPosition==="Inside"?s:this.getLabelBackground(i)),this.accumulation.isBlazor){var l=this.isCircular()?i.labelRegion.x>=this.center.x?"InsideRight":"InsideLeft":i.labelRegion.x>=i.region.x?"InsideRight":"InsideLeft";l==="InsideRight"?t.style.transform="translate(0%, -50%)":t.style.transform="translate(-100%, -50%)"}t.childElementCount&&(vt(!1,r,t,a,!0,"left","top"),this.doTemplateAnimation(this.accumulation,t))},e.prototype.getSaturatedColor=function(t,i){var r;this.marginValue>=1?r=i==="transparent"?this.getLabelBackground(t):i:r=this.getLabelBackground(t),r=r==="transparent"?this.accumulation.theme.indexOf("Dark")>-1||this.accumulation.theme.indexOf("HighContrast")>-1?"black":"white":r;var n=hf(Bn(r)),s=Math.round((n.r*299+n.g*587+n.b*114)/1e3);return this.accumulation.theme==="Bootstrap5"?"#212529":this.accumulation.theme==="Bootstrap5Dark"?"#DEE2E6":s>=128?this.accumulation.theme.indexOf("Tailwind3")>-1?"#111827":"black":this.accumulation.theme.indexOf("Tailwind3")>-1?"#FFFFFF":"white"},e.prototype.doTemplateAnimation=function(t,i){var r=t.visibleSeries[0],n=r.animation.delay+r.animation.duration;(r.animation.enable&&Ut!=="Disable"||Ut==="Enable")&&t.animateSeries&&(i.style.visibility="hidden",Zw(i,n,200,"ZoomIn"))},e.prototype.getLabelBackground=function(t){return t.labelPosition==="Outside"?this.accumulation.background||this.accumulation.themeStyle.background:t.y?t.color:this.accumulation.theme.indexOf("dark")?"white":"black"},e.prototype.correctLabelRegion=function(t,i,r){r===void 0&&(r=4),t.height-=r,t.width-=r,t.x+=r/2,t.y+=r/2,i.height-=r,i.width-=r},e.prototype.getModuleName=function(){return"AccumulationDataLabel"},e.prototype.destroy=function(){},e.prototype.extendedLabelsCalculation=function(){var t=this,i=this.accumulation.series[0];i.rightSidePoints.forEach(function(r,n,s){r.initialLabelRegion=r.labelRegion,r.isLabelUpdated=0,t.skipPoints(r,s,n)}),i.leftSidePoints.forEach(function(r,n,s){r.initialLabelRegion=r.labelRegion,r.isLabelUpdated=0,t.skipPoints(r,s,n)}),this.arrangeLeftSidePoints(i),this.isIncreaseAngle=!1,this.arrangeRightSidePoints(i)},e.prototype.arrangeRightSidePoints=function(t){var i,r,n=t.rightSidePoints.filter(function(d){return d.labelVisible&&d.labelPosition==="Outside"});this.rightSideRenderingPoints=n;var s,a,l=n[n.length-1],h;l&&l.labelAngle>90&&l.labelAngle<270&&(this.isIncreaseAngle=!0,this.changeLabelAngle(l,89));for(var u=n.length-1;u>=0;u--)if(a=n[u],h=n[u+1],this.isOverlapWithNext(a,n,u)&&a.labelVisible||!(a.labelAngle<=90||a.labelAngle>=270))if(s=l.labelAngle+10,r=!0,i?this.isIncreaseAngle=!1:s>90&&s<270&&h.isLabelUpdated&&(this.isIncreaseAngle=!0),this.isIncreaseAngle)for(var c=u+1;c>0;c--)this.decreaseAngle(n[c],n[c-1],t,!0);else for(var c=u+1;c<n.length;c++)this.increaseAngle(n[c-1],n[c],t,!0);else r&&h&&!h.isLabelUpdated&&(i=!0)},e.prototype.arrangeLeftSidePoints=function(t){var i=this,r=t.leftSidePoints.filter(function(c){return c.labelVisible&&c.labelPosition==="Outside"});this.leftSideRenderingPoints=r;for(var n,s,a,l,h=0;h<r.length;h++)if(s=r[h],n=r[h-1],this.isOverlapWithPrevious(s,r,h)&&s.labelVisible||!(s.labelAngle<270))if(a=!0,l&&(this.isIncreaseAngle=!1),this.isIncreaseAngle)for(var u=h;u<r.length;u++)this.increaseAngle(r[u-1],r[u],t,!1);else for(var u=h;u>0;u--)this.decreaseAngle(r[u],r[u-1],t,!1),r.filter(function(c,d){c.isLabelUpdated&&r[d].labelAngle-10<100&&(i.isIncreaseAngle=!0)});else a&&n&&n.isLabelUpdated&&(l=!0)},e.prototype.decreaseAngle=function(t,i,r,n){if(g(t)||g(i))return null;var s=1;if(n)for(;$n(t.labelRegion,i.labelRegion)||!this.isVariousRadius()&&!(i.labelRegion.height+i.labelRegion.y<t.labelRegion.y);){var a=i.midAngle-s;if(a<0&&(a=360+a),a<=270&&a>=90){a=270,this.isIncreaseAngle=!0;break}this.changeLabelAngle(i,a),s++}else for(t.labelAngle>270&&(this.changeLabelAngle(t,270),i.labelAngle=270);$n(t.labelRegion,i.labelRegion)||!this.isVariousRadius()&&t.labelRegion.y+t.labelRegion.height>i.labelRegion.y;){var a=i.midAngle-s;if(!(a<=270&&a>=90)){a=90,this.isIncreaseAngle=!0;break}if(this.changeLabelAngle(i,a),$n(t.labelRegion,i.labelRegion)&&!r.leftSidePoints.indexOf(i)&&a-1<90&&a-1>270){this.changeLabelAngle(t,t.labelAngle+1),this.arrangeLeftSidePoints(r);break}s++}},e.prototype.increaseAngle=function(t,i,r,n){if(g(t)||g(i))return null;var s=1;if(n)for(;$n(t.labelRegion,i.labelRegion)||!this.isVariousRadius()&&!(t.labelRegion.y+t.labelRegion.height<i.labelRegion.y);){var a=i.midAngle+s;if(a<270&&a>90){a=90,this.isIncreaseAngle=!0;break}if(this.changeLabelAngle(i,a),$n(t.labelRegion,i.labelRegion)&&a+1>90&&a+1<270&&this.rightSideRenderingPoints.indexOf(i)===this.rightSideRenderingPoints.length-1){this.changeLabelAngle(t,t.labelAngle-1),i.labelRegion=i.initialLabelRegion,this.arrangeRightSidePoints(r);break}if(s>360)break;s++}else for(;$n(t.labelRegion,i.labelRegion)||!this.isVariousRadius()&&t.labelRegion.y<i.labelRegion.y+i.labelRegion.height;){var a=i.midAngle+s;if(!(a<270&&a>90)){a=270,this.isIncreaseAngle=!1;break}if(this.changeLabelAngle(i,a),s>360)break;s++}},e.prototype.changeLabelAngle=function(t,i){var r=this.accumulation.series[0].dataLabel,n;this.isVariousRadius()&&(n=this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],t));var s=t.labelPosition==="Outside"&&this.accumulation.enableSmartLabels&&r.position==="Inside"?this.radius+Ni(r.connectorStyle.length||"4%",this.accumulation.pieSeriesModule.size/2):this.isVariousRadius()?n:this.accumulation.pieSeriesModule.labelRadius+10,a=this.isVariousRadius()?n:s;this.getLabelRegion(t,"Outside",t.textSize,a,this.marginValue,i),t.isLabelUpdated=1,t.labelAngle=i},e.prototype.isOverlapWithPrevious=function(t,i,r){for(var n=0;n<r;n++)if(n!==i.indexOf(t)&&i[n].visible&&i[n].labelVisible&&i[n].labelRegion&&t.labelRegion&&t.labelVisible&&$n(t.labelRegion,i[n].labelRegion))return!0;return!1},e.prototype.isOverlapWithNext=function(t,i,r){for(var n=r;n<i.length;n++)if(n!==i.indexOf(t)&&i[n].visible&&i[n].labelVisible&&i[n].labelRegion&&t.labelRegion&&t.labelVisible&&$n(t.labelRegion,i[n].labelRegion))return!0;return!1},e.prototype.skipPoints=function(t,i,r){if(r>0&&(t.midAngle<285&&t.midAngle>255||t.midAngle<105&&t.midAngle>75)){var n=i[r-1],s=t.endAngle%360-t.startAngle%360,a=n.endAngle%360-n.startAngle%360;a<=s&&s<5&&n.labelVisible&&this.setPointVisibleTrue(t)}else if(r>1&&(t.midAngle<300&&t.midAngle>240||t.midAngle<120&&t.midAngle>60)){var l=i[r-1],h=i[r-2],s=t.endAngle%360-t.startAngle%360,a=l.endAngle%360-l.startAngle%360,u=h.endAngle%360-h.startAngle%360;s<3&&a<3&&u<3&&l.labelVisible&&t.labelVisible&&this.setPointVisibleTrue(t)}},e.prototype.getPerpendicularDistance=function(t,i){var r,n=10,s=n+10*Math.sin(i.midAngle*Math.PI/360);return i.midAngle>270&&i.midAngle<360?r=new Je(t.x+s*Math.cos((360-i.midAngle)*Math.PI/180),t.y-s*Math.sin((360-i.midAngle)*Math.PI/180)):i.midAngle>0&&i.midAngle<90?r=new Je(t.x+s*Math.cos(i.midAngle*Math.PI/180),t.y+s*Math.sin(i.midAngle*Math.PI/180)):i.midAngle>0&&i.midAngle<90?r=new Je(t.x-s*Math.cos((i.midAngle-90)*Math.PI/180),t.y+s*Math.sin((i.midAngle-90)*Math.PI/180)):r=new Je(t.x-s*Math.cos((i.midAngle-180)*Math.PI/180),t.y-s*Math.sin((i.midAngle-180)*Math.PI/180)),r},e}(tx),a6=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),FF=function(o){a6(e,o);function e(t){var i=o.call(this,t)||this;return i.accumulation=t,i.addEventListener(),i.template=i.accumulation.tooltip.template,i}return e.prototype.addEventListener=function(){this.accumulation.isDestroyed||(this.accumulation.on(B.isPointer?"pointerleave":"mouseleave",this.mouseLeaveHandler,this),this.accumulation.on(B.touchMoveEvent,this.mouseMoveHandler,this),this.accumulation.on(B.touchEndEvent,this.mouseUpHandler,this))},e.prototype.mouseLeaveHandler=function(){this.removeTooltip(this.accumulation.tooltip.fadeOutDuration)},e.prototype.mouseUpHandler=function(t){var i=this.accumulation;i.tooltip.enable&&i.isTouch&&Oi(i.mouseX,i.mouseY,i.initialClipRect)&&(this.tooltip(t),this.removeTooltip(2e3))},e.prototype.mouseMoveHandler=function(t){var i=this.accumulation;i.tooltip.enable&&Oi(i.mouseX,i.mouseY,i.initialClipRect)&&this.tooltip(t)},e.prototype.tooltip=function(t){this.renderSeriesTooltip(this.accumulation,this.getPieData(t,this.accumulation))},e.prototype.renderSeriesTooltip=function(t,i){var r=this.getElement(this.element.id+"_tooltip_svg"),n=r&&parseInt(r.getAttribute("opacity"),10)>0,s=this.getTooltipElement(n),a=!n;if(this.currentPoints=[],i.point&&(!this.previousPoints[0]||this.previousPoints[0].point!==i.point)){if(this.previousPoints[0]&&i.point.index===this.previousPoints[0].point.index&&i.series.index===this.previousPoints[0].series.index)return null;this.pushData(i,a,s,!1)&&this.triggerTooltipRender(i,a,this.getTooltipText(i,t.tooltip),this.findHeader(i))}else!i.point&&this.isRemove&&(this.removeTooltip(this.accumulation.tooltip.fadeOutDuration),this.isRemove=!1)},e.prototype.triggerTooltipRender=function(t,i,r,n){var s=this,a=this.chart.tooltip,l={cancel:!1,name:Vm,text:r,point:t.point,textStyle:this.textStyle,series:this.accumulation.isBlazor?{}:t.series,headerText:n,data:{pointX:t.point.x,pointY:t.point.y,seriesIndex:t.series.index,pointIndex:t.point.index,pointText:t.point.text,seriesName:t.series.name}},h=function(u){u.cancel?(s.removeHighlight(),Ue(s.getElement(s.element.id+"_tooltip"))):(s.formattedText=s.formattedText.concat(u.text),s.text=s.formattedText,s.headerText=u.headerText,s.createTooltip(s.chart,i,{x:a.location.x!==null?a.location.x:t.point.symbolLocation.x,y:a.location.y!==null?a.location.y:t.point.symbolLocation.y},t.series.clipRect,t.point,a.enableMarker?["Circle"]:[],0,s.chart.initialClipRect,!1,null,t.point,s.template?s.accumulation.enableHtmlSanitizer?s.accumulation.sanitize(s.template):u.template:"")),s.isRemove=!0};h.bind(this,t),this.chart.trigger(Vm,l,h)},e.prototype.getPieData=function(t,i){var r=t.target,n=$h(r.id,!0);if(!isNaN(n.series)){var s=n.series,a=n.point;if(!g(s)&&!isNaN(s)&&!g(a)&&!isNaN(a)){var l=this.getSeriesFromIndex(s,i.visibleSeries);if(l.enableTooltip)return new lf(l.points[a],l)}}return new lf(null,null)},e.prototype.getSeriesFromIndex=function(t,i){return i[0]},e.prototype.getTooltipText=function(t,i){var r=t.series,n=i.format?i.format:this.accumulation.theme.indexOf("Tailwind3")>-1?"${point.x} : ${point.y}":"${point.x} : <b>${point.y}</b>";return n=this.accumulation.useGroupingSeparator?n.replace("${point.y}","${point.separatorY}"):n,this.parseTemplate(t.point,r,n)},e.prototype.findHeader=function(t){return this.header===""?"":(this.header=this.parseTemplate(t.point,t.series,this.header),this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()!==""?this.header:"")},e.prototype.parseTemplate=function(t,i,r){for(var n,s,a=RegExp,l=0,h=Object.keys(t);l<h.length;l++){var u=h[l];n=new a("${point."+u+"}","gm");var c=u==="x"&&this.accumulation.useGroupingSeparator&&typeof t[u]=="number"?this.accumulation.intl.formatNumber(t.x,{useGrouping:!0}):t[u];r=r.replace(n.source,c)}for(var d=0,p=Object.keys(Object.getPrototypeOf(i));d<p.length;d++){var u=p[d];n=new a("${series."+u+"}","gm"),s=i[u],r=r.replace(n.source,s)}return r},e.prototype.getModuleName=function(){return"AccumulationTooltip"},e.prototype.destroy=function(){},e}(DF);var Gm=function(){return Gm=Object.assign||function(o){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r])}return o},Gm.apply(this,arguments)},o6=function(){function o(){this.transform=null}return o}(),ir=new o6,iy=function(){function o(e,t,i){this.x=0,this.y=0,this.z=0,this.epsilon=1e-5,this.x=e,this.y=t||0,this.z=i||0}return o.prototype.isValid=function(e){return!isNaN(e.x)&&!isNaN(e.y)&&!isNaN(e.z)},o.prototype.vector3D=function(e,t,i){return this.x=e,this.y=t,this.z=i,{x:this.x,y:this.y,z:this.z}},o.prototype.vector3DMinus=function(e,t){return this.vector3D(e.x-t.x,e.y-t.y,e.z-t.z)},o.prototype.vector3DPlus=function(e,t){return this.vector3D(e.x+t.x,e.y+t.y,e.z+t.z)},o.prototype.vector3DMultiply=function(e,t){var i=e.y*t.z-t.y*e.z,r=e.z*t.x-t.z*e.x,n=e.x*t.y-t.x*e.y;return this.vector3D(i,r,n)},o.prototype.vector3DAdd=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z},o.prototype.vector3DStarMultiply=function(e,t){var i=e.x*t,r=e.y*t,n=e.z*t;return this.vector3D(i,r,n)},o.prototype.getLength=function(e){var t=this.vector3DAdd(e,e);return Math.sqrt(t)},o.prototype.normalize=function(){var e=this.getLength(this);this.x/=e,this.y/=e,this.z/=e},o.prototype.getNormal=function(e,t,i){var r=this.vector3DMinus(e,t),n=this.vector3DMinus(i,t),s=this.vector3DMultiply(r,n),a=this.getLength(s);return a<this.epsilon?this.vector3D(0,0,0):this.vector3D(s.x/a,s.y/a,s.z/a)},o}(),OF=function(){function o(){this.matrixSize=4}return o.prototype.matrix3D=function(e){for(var t=[],i=0;i<e;i++)t[i]=this.createArray(e);return t},o.prototype.isAffine=function(e){return e[0][3]===0&&e[1][3]===0&&e[2][3]===0&&e[3][3]===1},o.prototype.createArray=function(e){for(var t=[],i=0;i<e;++i)t[i]=0;return t},o.prototype.getIdentity=function(){for(var e=this.matrix3D(this.matrixSize),t=0;t<this.matrixSize;t++)e[t][t]=1;return e},o.prototype.getInterval=function(e){for(var t=this.getIdentity(),i=0;i<this.matrixSize;i++)for(var r=0;r<this.matrixSize;r++)t[i][r]=this.getMinor(e,i,r);return t=this.transposed(t),t=this.getMatrixMultiple(1/this.getDeterminant(e),t),t},o.prototype.getMatrixMultiple=function(e,t){for(var i=0;i<t.length;i++)for(var r=0;r<t[i].length;r++)t[i][r]=t[i][r]*e;return t},o.prototype.getMatrixVectorMultiple=function(e,t){var i=e[0][0]*t.x+e[1][0]*t.y+e[2][0]*t.z+e[3][0],r=e[0][1]*t.x+e[1][1]*t.y+e[2][1]*t.z+e[3][1],n=e[0][2]*t.x+e[1][2]*t.y+e[2][2]*t.z+e[3][2];if(!this.isAffine(e)){var s=1/(e[0][3]*t.x+e[1][3]*t.y+e[2][3]*t.z+e[3][3]);i*=s,r*=s,n*=s}return{x:i,y:r,z:n}},o.prototype.getMatrixVectorAnd=function(e,t){var i=e[0][0]*t.x+e[1][0]*t.y+e[2][0]*t.z,r=e[0][1]*t.x+e[1][1]*t.y+e[2][1]*t.z,n=e[0][2]*t.x+e[1][2]*t.y+e[2][2]*t.z;return new iy(i,r,n)},o.prototype.getMatrixMultiplication=function(e,t){for(var i=this.getIdentity(),r=0;r<this.matrixSize;r++)for(var n=0;n<this.matrixSize;n++){for(var s=0,a=0;a<this.matrixSize;a++)s+=e[a][n]*t[r][a];i[r][n]=s}return i},o.prototype.getMinor=function(e,t,i){return((t+i)%2===0?1:-1)*this.getDeterminant(this.getMatrix(e,t,i))},o.prototype.getMatrix=function(e,t,i){for(var r=e.length-1,n=this.createArray(r),s=0;s<r;s++){var a=s>=t?s+1:s;n[s]=this.createArray(r);for(var l=0;l<r;l++){var h=l>=i?l+1:l;n[s][l]=e[a][h]}}return n},o.prototype.getDeterminant=function(e){var t=e.length,i=0;if(t<2)i=e[0][0];else for(var r=1,n=0;n<t;n++){var s=this.getMatrix(e,n,0);i+=r*e[n][0]*this.getDeterminant(s),r=r>0?-1:1}return i},o.prototype.transform=function(e,t,i){var r=this.getIdentity();return r[3][0]=e,r[3][1]=t,r[3][2]=i,r},o.prototype.turn=function(e){var t=this.getIdentity();return t[0][0]=Math.cos(e),t[2][0]=-Math.sin(e),t[0][2]=Math.sin(e),t[2][2]=Math.cos(e),t},o.prototype.tilt=function(e){var t=this.getIdentity();return t[1][1]=Math.cos(e),t[2][1]=Math.sin(e),t[1][2]=-Math.sin(e),t[2][2]=Math.cos(e),t},o.prototype.transposed=function(e){for(var t=this.getIdentity(),i=0;i<this.matrixSize;i++)for(var r=0;r<this.matrixSize;r++)t[i][r]=e[r][i];return t},o}();var l6=function(){function o(){this.vector=new iy(0,0,0)}return o.prototype.addVisual=function(e,t){return e==null||$l.test()?-1:LN.add(e,t)},o.prototype.prepareView=function(e,t,i,r,n,s){ir.transform==null?ir.transform=s.transform3D.transform3D(n):ir.transform.viewingArea=n,ir.tree||(ir.tree=[]),ir.transform.rotation=i,ir.transform.tilt=r,ir.transform.depth=t,ir.transform.perspectiveAngle=e,s.transform3D.transform(ir.transform),ir.tree[s.chart3D.id]=LN.build()},o.prototype.view=function(e,t,i,r,n,s,a){var l=32767;if(arguments.length===2){if(e==null)return;var h=this.vector.vector3D(0,0,l);this.drawNode3D(ir.tree[t.chart3D.id],h,e,t)}else{if(e==null)return;ir.transform==null?ir.transform=t.transform3D.transform3D(n):ir.transform.viewingArea=n,ir.transform.rotation=i,ir.transform.tilt=r,ir.transform.depth=a,ir.transform.perspectiveAngle=s,t.transform3D.transform(ir.transform);var u=this.vector.vector3D(0,0,l);this.drawNode3D(ir.tree[t.chart3D.id],u,e,t)}},o.prototype.draw3DElement=function(e,t){e.plane.element?e.plane.element.tag==="text"||e.plane.element.tag==="dataLabel"?$l.drawText(e.plane,t):e.plane.element.tag==="template"?$l.drawTemplate(e.plane,t):$l.drawLine(e.plane,t):$l.draw(e.plane,t)},o.prototype.drawNode3D=function(e,t,i,r){if(!(e===null||ir.transform==null))for(var n=!0;n;){var s=vo.vector3DAdd($l.getNormal(r.transform3D.result(ir.transform),e.plane.vectorPoints),t);if(s>e.plane.d){if(e.front!=null&&this.drawNode3D(e.front,t,i,r),this.draw3DElement(e,r),e.back!=null){e=e.back;continue}}else if(e.back!=null&&this.drawNode3D(e.back,t,i,r),this.draw3DElement(e,r),e.front!=null){e=e.front;continue}break}},o}(),h6=function(){function o(e){this.epsilon=5e-4,this.chart=e}return o.prototype.add=function(e,t){return this.chart=t,t.polygons.push(e),t.polygons.length-1},o.prototype.getNext=function(e,t){return e>=t?e-t:e<0?e+t:e},o.prototype.vector3DIndexClassification=function(e,t,i){return{index:t,result:i,vector:e,isCuttingBackPoint:!1,cuttingBackPairIndex:null,alreadyCutBack:!1,isCuttingFrontPoint:!1,cuttingFrontPairIndex:null,alreadyCutFront:!1}},o.prototype.classifyPoint=function(e,t){var i="OnPlane",r=-t.d-vo.vector3DAdd(e,t.normal);return r>this.epsilon?i="OnBack":r<-this.epsilon&&(i="OnFront"),i},o.prototype.classifyPolygon=function(e,t){var i="Unknown",r=t.points;if(r==null)return i;for(var n=0,s=0,a=0,l=e.normal,h=e.d,u=0,c=r.length;u<c;u++){var d=-h-vo.vector3DAdd(r[u],l);if(d>this.epsilon?n++:d<-this.epsilon?s++:a++,n>0&&s>0)break}return a===r.length?i="OnPlane":s+a===r.length?i="ToRight":n+a===r.length?i="ToLeft":i="Unknown",i},o.prototype.splitPolygon=function(e,t){var i=[],r=[];if(e.points!=null){for(var n=[],s=[],a=[],l=void 0,h=void 0,u=e.points.length,c=0;c<u;c++){var d=e.points[c],p=e.points[this.getNext(c+1,u)],f=this.classifyPoint(d,t),v=this.classifyPoint(p,t),m=this.vector3DIndexClassification(d,n.length,f);if(n.push(m),f!==v&&f!=="OnPlane"&&v!=="OnPlane"){var y=vo.vector3DMinus(d,p),S=vo.vector3DMinus(vo.vector3DStarMultiply(t.normal,-t.d),p),b=vo.vector3DAdd(S,t.normal),w=b/vo.vector3DAdd(t.normal,y),I=vo.vector3DPlus(p,vo.vector3DStarMultiply(y,w)),x=this.vector3DIndexClassification(I,n.length,"OnPlane");n.push(x),s.push(x),a.push(x)}else if(f==="OnPlane"){var M=e.points[this.getNext(c-1,u)],D=this.classifyPoint(M,t);if(D===v)continue;if(D!=="OnPlane"&&v!=="OnPlane")s.push(m),a.push(m);else if(D==="OnPlane")switch(v){case"OnBack":s.push(m);break;case"OnFront":a.push(m);break}else if(v==="OnPlane")switch(D){case"OnBack":s.push(m);break;case"OnFront":a.push(m);break}}}if(a.length!==0||s.length!==0){for(var c=0;c<s.length-1;c+=2){var A=s[c],L=s[c+1];A.cuttingBackPoint=!0,L.cuttingBackPoint=!0,A.alterCuttingBackPairIndex=L.index,L.alterCuttingBackPairIndex=A.index}for(var c=0;c<a.length-1;c+=2){var T=a[c],k=a[c+1];T.cuttingFrontPoint=!0,k.cuttingFrontPoint=!0,T.alterCuttingFrontPairIndex=k.index,k.alterCuttingFrontPairIndex=T.index}for(var c=0;c<s.length-1;c++){var A=s[c];if(!A.alreadyCutBack&&(l=this.cutOutBackPolygon(n,A),l.length>2)){var F=$l.polygon3D(l,e);i.push(Gm({},F))}}for(var c=0;c<a.length-1;c++){var L=a[c];if(!L.alreadyCutFront&&(h=this.cutOutFrontPolygon(n,L),h.length>2)){var R=$l.polygon3D(h,e);r.push(Gm({},R))}}}}else i.push(e),r.push(e);return{backPolygon:i,frontPolygon:r}},o.prototype.cutOutFrontPolygon=function(e,t){for(var i=[],r=t,n=!0;n;){r.alreadyCutFront=!0,i.push(r.vector);var s=e[r.alterCuttingFrontPairIndex];if(r.cuttingFrontPoint)if(!s.alreadyCutFront)r=s;else{var a=e[this.getNext(r.index-1,e.length)],l=e[this.getNext(r.index+1,e.length)];if(a.result==="OnFront"&&!a.alreadyCutFront)r=a;else if(l.result==="OnFront"&&!l.alreadyCutFront)r=l;else return i}else{var a=e[this.getNext(r.index-1,e.length)],l=e[this.getNext(r.index+1,e.length)];if(a.result!=="OnBack"&&!a.alreadyCutFront)r=a;else if(l.result!=="OnBack"&&!l.alreadyCutFront)r=l;else return i}}return null},o.prototype.cutOutBackPolygon=function(e,t){for(var i=[],r=t,n=!0;n;){r.alreadyCutBack=!0,i.push(r.vector);var s=e[r.alterCuttingBackPairIndex];if(r.cuttingBackPoint)if(!s.alreadyCutBack)r=s;else{var a=e[this.getNext(r.index-1,e.length)],l=e[this.getNext(r.index+1,e.length)];if(a.result==="OnBack"&&!a.alreadyCutBack)r=a;else if(l.result==="OnBack"&&!l.alreadyCutBack)r=l;else return i}else{var a=e[this.getNext(r.index-1,e.length)],l=e[this.getNext(r.index+1,e.length)];if(a.result!=="OnFront"&&!a.alreadyCutBack)r=a;else if(l.result!=="OnFront"&&!l.alreadyCutBack)r=l;else return i}}return null},o.prototype.build=function(e){if(e){var t=e;if(t.length<1)return null;var i={back:null,front:null,plane:null},r=t[0];i.plane=r;for(var n=[],s=[],a=1,l=t.length;a<l;a++){var h=t[a];if(h!==r){var u=this.classifyPolygon(r,h);switch(u){case"OnPlane":case"ToRight":s.push(h);break;case"ToLeft":n.push(h);break;case"Unknown":if(h.element&&(h.element.tag==="line"||h.element.tag==="text"))n.push(h);else{for(var c=this.splitPolygon(h,r),d=0;d<c.backPolygon.length;d++)c.backPolygon[d].name=c.backPolygon[d].name+"-back",n.push(c.backPolygon[d]);for(var p=0;p<c.frontPolygon.length;p++)c.frontPolygon[p].name=c.frontPolygon[p].name+"-front",s.push(c.frontPolygon[p])}break}}}return n.length>0&&(i.back=this.build(n)),s.length>0&&(i.front=this.build(s)),i}else return this.build(this.chart.polygons)},o}();var u6=function(){function o(){this.epsilon=1e-5,this.normal={x:0,y:0,z:0},this.vector=new iy(0,0,0),this.vectorPoints=[],this.matrixObj=new OF,this.tabIndex=!0}return o.prototype.polygon3D=function(e,t,i,r,n,s,a,l,h,u){if(arguments.length===3)return this.calculateNormal(e,t,i),null;if(arguments.length===2){this.calculateNormal(e[0],e[1],e[2]),this.vectorPoints=e,this.calculateNormal(this.vectorPoints);var c=t;return c.normal=this.normal,c.points=e,c.vectorPoints=this.vectorPoints,c.isSplit=!0,c.d=this.d,c}else{this.calculateNormal(e[0],e[1],e[2]),this.vectorPoints=e,this.calculateNormal(this.vectorPoints);var d={tag:"path",parent:h},c={normal:this.normal,points:e,vectorPoints:this.vectorPoints,index:i,tag:t,name:l||null,strokeThickness:n,opacity:s,fill:a,d:this.d,text:u||"",polygonElement:d};return arguments.length!==1&&(c.polygonElement=d),c}},o.prototype.createLine=function(e,t,i,r,n,s){var a=e.width,l=[];return l[0]=this.vector.vector3D(t,i,s),l[1]=this.vector.vector3D(t+a,n+a,s),l[2]=this.vector.vector3D(r,n,s),this.line3D(e,l)},o.prototype.line3D=function(e,t){var i=this.polygon3D(t);return i.element=e,i},o.prototype.text3D=function(e,t){var i=this.polygon3D(t);return i.element=e,i},o.prototype.createCylinder=function(e,t,i,r,n,s,a,l,h,u,c){var d=0,p,f,v,m,y=24,S=360/y,b=Math.PI/180,w=(e.z+t.z)/2,I=[],x=[],M=[],D=[],A=t.y-e.y<t.z-e.z?(t.y-e.y)/2:(t.z-e.z)/2,L=t.x-e.x<t.z-e.z?(t.x-e.x)/2:(t.z-e.z)/2,T=(e.x+t.x)/2,k=(e.y+t.y)/2;switch(n){case"Bar":case"StackingBar":case"StackingBar100":for(y++;y--;)f=k+A*Math.cos(d*S*b),v=w+A*Math.sin(d*S*b),x[d]={Y:f,Z:v},M.push(this.vector.vector3D(e.x,x[d].Y,x[d].Z)),D.push(this.vector.vector3D(t.x,x[d].Y,x[d].Z)),d>0&&(m=[this.vector.vector3D(e.x,x[d-1].Y,x[d-1].Z),this.vector.vector3D(t.x,x[d-1].Y,x[d-1].Z),this.vector.vector3D(t.x,x[d].Y,x[d].Z),this.vector.vector3D(e.x,x[d].Y,x[d].Z)],I[d+1]=this.polygon3D(m,i,r,a,0,h,a,"-"+(d+1).toString()+"-"+u,c),Kn.addVisual(I[d+1],i)),d++;break;case"Column":case"StackingColumn":case"StackingColumn100":for(y++;y--;)p=T+L*Math.cos(d*S*b),v=w+L*Math.sin(d*S*b),x[d]={Y:p,Z:v},M.push(this.vector.vector3D(x[d].Y,e.y,x[d].Z)),D.push(this.vector.vector3D(x[d].Y,t.y,x[d].Z)),d>0&&(m=[this.vector.vector3D(x[d-1].Y,e.y,x[d-1].Z),this.vector.vector3D(x[d-1].Y,t.y,x[d-1].Z),this.vector.vector3D(x[d].Y,t.y,x[d].Z),this.vector.vector3D(x[d].Y,e.y,x[d].Z)],I[d+1]=this.polygon3D(m,i,r,a,0,h,a,"-"+(d+1).toString()+"-"+u,c),Kn.addVisual(I[d+1],i)),d++;break}return I[0]=this.polygon3D(D,i,r,s,0,h,a,"-0-"+u,c),I[1]=this.polygon3D(M,i,r,s,l,h,a,"-1-"+u,c),Kn.addVisual(I[0],i),Kn.addVisual(I[1],i),I},o.prototype.createBox=function(e,t,i,r,n,s,a,l,h,u,c,d){var p=[],f=[this.vector.vector3D(e.x,e.y,e.z),this.vector.vector3D(t.x,e.y,e.z),this.vector.vector3D(t.x,t.y,e.z),this.vector.vector3D(e.x,t.y,e.z)],v=[this.vector.vector3D(e.x,e.y,t.z),this.vector.vector3D(t.x,e.y,t.z),this.vector.vector3D(t.x,t.y,t.z),this.vector.vector3D(e.x,t.y,t.z)],m=[this.vector.vector3D(e.x,e.y,t.z),this.vector.vector3D(t.x,e.y,t.z),this.vector.vector3D(t.x,e.y,e.z),this.vector.vector3D(e.x,e.y,e.z)],y=[this.vector.vector3D(e.x,t.y,t.z),this.vector.vector3D(t.x,t.y,t.z),this.vector.vector3D(t.x,t.y,e.z),this.vector.vector3D(e.x,t.y,e.z)],S=[this.vector.vector3D(e.x,e.y,e.z),this.vector.vector3D(e.x,e.y,t.z),this.vector.vector3D(e.x,t.y,t.z),this.vector.vector3D(e.x,t.y,e.z)],b=[this.vector.vector3D(t.x,e.y,e.z),this.vector.vector3D(t.x,e.y,t.z),this.vector.vector3D(t.x,t.y,t.z),this.vector.vector3D(t.x,t.y,e.z)];return u?(p[0]=this.polygon3D(f,i,r,n,a,l,s,"-0-"+u,c,d),p[1]=this.polygon3D(v,i,r,n,a,l,s,"-1-"+u,c,d),p[2]=this.polygon3D(m,i,r,n,a,l,s,"-2-"+u,c,d),p[3]=this.polygon3D(y,i,r,n,a,l,s,"-3-"+u,c,d),p[4]=this.polygon3D(S,i,r,n,a,l,s,"-4-"+u,c,d),p[5]=this.polygon3D(b,i,r,n,a,l,s,"-5-"+u,c,d)):(p[0]=this.polygon3D(f,i,r,n,a,l,s,"-0-"+r,c,d),p[1]=this.polygon3D(v,i,r,n,a,l,s,"-1-"+r,c,d),p[2]=this.polygon3D(m,i,r,n,a,l,s,"-2-"+r,c,d),p[3]=this.polygon3D(y,i,r,n,a,l,s,"-3-"+r,c,d),p[4]=this.polygon3D(S,i,r,n,a,l,s,"-4-"+r,c,d),p[5]=this.polygon3D(b,i,r,n,a,l,s,"-5-"+r,c,d)),h?(Kn.addVisual(p[0],i),Kn.addVisual(p[1],i),Kn.addVisual(p[2],i),Kn.addVisual(p[3],i),Kn.addVisual(p[4],i),Kn.addVisual(p[5],i)):(Kn.addVisual(p[5],i),Kn.addVisual(p[4],i),Kn.addVisual(p[0],i),Kn.addVisual(p[1],i),Kn.addVisual(p[2],i),Kn.addVisual(p[3],i)),p},o.prototype.calculateNormal=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e.length>=3){var i=e[0],r=e[1],n=e[2],s=this.vector.vector3DMinus(i,r),a=this.vector.vector3DMinus(n,r),l=this.vector.vector3DMultiply(s,a),h=this.vector.getLength(l);h<this.epsilon&&(h=1),this.normal=this.vector.vector3D(l.x/h,l.y/h,l.z/h),this.d=-(this.normal.x*i.x+this.normal.y*i.y+this.normal.z*i.z),e[3]&&(e[3].normal=this.normal,e[3].d=this.d)}else{var u=e[0];this.calculateNormal(u[0],u[1],u[2],e[1]);for(var c=3;c<u.length&&this.test();c++)this.calculateNormal(u[c],u[0],u[c/2])}},o.prototype.test=function(){return!this.vector.isValid(this.normal)},o.prototype.transform=function(e,t){if(t.points!=null){for(var i=0;i<t.points.length;i++)t.vectorPoints[i]=t.points[i]=Nc.getMatrixVectorMultiple(e,t.points[i]);this.calculateNormal(t.vectorPoints,t)}},o.prototype.getNormal=function(e,t){var i;if(t!=null){i=this.vector.getNormal(this.matrixObj.getMatrixVectorMultiple(e,t[0]),Nc.getMatrixVectorMultiple(e,t[1]),this.matrixObj.getMatrixVectorMultiple(e,t[2]));for(var r=3;r<t.length&&!this.vector.isValid(i)&&t[r/2];r++){var n=Nc.getMatrixVectorMultiple(e,t[r]),s=Nc.getMatrixVectorMultiple(e,t[0]),a=Nc.getMatrixVectorMultiple(e,t[r/2]);i=this.vector.getNormal(n,s,a)}}else i=Nc.getMatrixVectorAnd(e),this.vector.normalize();return i},o.prototype.createTextElement=function(e,t,i,r){var n=[],s=e.x,a=e.y,l=t.width,h=t.height;return n[0]=this.vector.vector3D(s,a,e.z),n[1]=this.vector.vector3D(s+l,a+h+r,e.z),n[2]=this.vector.vector3D(s+l+i,a+h+r,e.z),this.text3D(t,n)},o.prototype.drawLine=function(e,t){var i=ir.transform;if(i!=null){var r=t.transform3D.toScreen(e.vectorPoints[0],i),n=t.transform3D.toScreen(e.vectorPoints[2],i),s={id:e.element.id,x1:r.x,y1:r.y,x2:n.x,y2:n.y,"stroke-dasharray":"","stroke-width":e.element.width,stroke:e.element.stroke,opacity:e.element.opacity};if(t.chart3D.appendChild(t.svgRenderer.drawLine(s)),t.previousID&&t.isTouch){var a=document.getElementById(t.previousID),l=document.getElementById(s.id);a&&l&&l.parentNode.insertBefore(l,a.nextSibling)}t.previousID=s.id}},o.prototype.drawTemplate=function(e,t){var i=e.element,r=ir.transform;if(r!=null){var n=i.label,s=t.transform3D.toScreen(e.vectorPoints[0],r);t.dataLabel3DModule.createDataLabelTemplate(n.series.dataLabelElement,n.series,n.series.dataLabel,n.series.visiblePoints[n.pointIndex],i.argsData,n.pointIndex,!1,s)}},o.prototype.drawText=function(e,t){var i=e.element,r=ir.transform;if(r!=null){var n=t.transform3D.toScreen(e.vectorPoints[0],r),s=n.x,a=n.y;if(i.tag==="text"){var l={id:i.id,x:s,y:a,fill:i.font.color||i.fill,"font-size":i.font.size,"font-family":i.font.fontFamily,"font-style":i.font.fontStyle,"font-weight":i.font.fontWeight,opacity:i.font.opacity,"text-anchor":i.textAnchor,cursor:"default",transform:i.angle?"rotate("+i.angle+","+s+","+a+")":""},h=t.svg3DRenderer.drawText(l,i.label.text,e.element.font,t);i.id.indexOf("-axis-title")>-1&&h.setAttribute("aria-hidden","true"),t.chart3D.append(h)}else{var u=i.series,c=u.yAxis&&u.yAxis.labelFormat?u.yAxis.labelFormat:"",d=i.point.text?i.point.text:i.point.y+c.substring(c.indexOf("}")+1),p=Ze(d,u.dataLabel.font,t.themeStyle.datalabelFont),f=u.dataLabel.margin,v=p.width+f.left+f.right,m=p.height+f.top+f.bottom,y={x:n.x,y:n.y},S=y.x-f.left/2+f.right/2,b=y.y-f.top/2-m/f.top+f.bottom/2,w=u.index;this.dataLabelSymbol(w,u,i.pointIndex,S,b,v,m,t)}}},o.prototype.dataLabelSymbol=function(e,t,i,r,n,s,a,l){var h="M "+(r+-s/2)+" "+(n+-a/2)+" L "+(r+s/2)+" "+(n+-a/2)+" L "+(r+s/2)+" "+(n+a/2)+" L "+(r+-s/2)+" "+(n+a/2)+" L "+(r+-s/2)+" "+(n+-a/2)+" z",u={id:l.element.id+"-svg-data-label-series-"+e+"-point-"+i,fill:t.dataLabel.fill,"stroke-width":t.dataLabel.border.width,"stroke-dasharray":t.dataLabel.border.dashArray,stroke:t.dataLabel.border.color,opacity:t.dataLabel.opacity,visibility:"",d:h},c=l.svgRenderer.drawPath(u);l.chart3D.append(c)},o.prototype.draw=function(e,t){if(!(e.vectorPoints==null||e.vectorPoints.length<=0)){var i=ir.transform,r=t.svg3DRenderer.getStringBuilder(),n=e.fill,s=t.svg3DRenderer.checkColorFormat(n);s||n!=="transparent"&&(n=Bn(n));var a={StartPoint:null};if(i!=null){a.StartPoint=t.transform3D.toScreen(e.vectorPoints[0],i),r.append("M "+a.StartPoint.x+" "+a.StartPoint.y+" ");for(var l=0;l<e.vectorPoints.length;l++){var h=t.transform3D.toScreen(e.vectorPoints[l],i);r.append("L "+h.x+" "+h.y+" ")}}var u=r.toString(),c="Light",d=2*(Math.abs(this.vector.vector3DAdd(e.normal,this.vector.vector3D(0,0,1)))-1),p=2*(Math.abs(this.vector.vector3DAdd(e.normal,this.vector.vector3D(0,1,0)))-1),f=2*(Math.abs(this.vector.vector3DAdd(e.normal,this.vector.vector3D(1,0,0)))-1);e.name&&!(e.name.indexOf("-wall-brush")>-1)&&(d===f?(c="ZLight",n=this.applyZLight(n,t)):p===d||d!==0&&p<d?(c="XLight",n=this.applyXLight(n,t)):d<0?(c="ZLight",n=this.applyZLight(n,t)):c="Light");var v={id:t.element.id+"-svg"+e.name,name:c,fill:n,stroke:"","stroke-width":e.strokeThickness,opacity:e.opacity,d:u},m=t.svgRenderer.drawPath(v);if(e.text&&(m.setAttribute("aria-label",e.text),m.setAttribute("role","img")),e.name&&e.name.indexOf("-wall-brush")>-1&&m.setAttribute("aria-hidden","true"),m.id.indexOf("0-region-series-0-point-0")>-1){if(this.tabIndex)m.setAttribute("tabindex","0");else{var y=e.polygonElement.parent.querySelectorAll('[id*="0-region-series-0-point-0"]');y.length>0&&y[y.length-1].removeAttribute("tabindex"),m.setAttribute("tabindex","0")}this.tabIndex=!1}if(vt(!1,e.polygonElement.parent,m,t.redraw,!0,"x","y",null,u),t.previousID&&t.isTouch){var S=document.getElementById(t.previousID),b=document.getElementById(v.id);S&&b&&b.parentNode.insertBefore(b,S.nextSibling)}t.previousID=v.id}},o.prototype.applyXLight=function(e,t){var i=t.svg3DRenderer.hexToValue(e);return i.red=parseInt((i.red*.7).toString(),10),i.green=parseInt((i.green*.7).toString(),10),i.blue=parseInt((i.blue*.7).toString(),10),t.svg3DRenderer.hexColor(i)},o.prototype.applyZLight=function(e,t){var i=t.svg3DRenderer.hexToValue(e);return i.red=parseInt((i.red*.9).toString(),10),i.green=parseInt((i.green*.9).toString(),10),i.blue=parseInt((i.blue*.9).toString(),10),t.svg3DRenderer.hexColor(i)},o}(),vo=new iy(0,0,0),Nc=new OF,LN=new h6,$l=new u6,Kn=new l6;var Ym=function(){return Ym=Object.assign||function(o){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r])}return o},Ym.apply(this,arguments)},c6=function(){function o(){this.transform=null}return o}(),Pm=new c6,RF=function(){function o(e,t,i){this.x=0,this.y=0,this.z=0,this.epsilon=1e-5,this.x=e,this.y=t||0,this.z=i||0}return o.prototype.isValid=function(e){return!isNaN(e.x)&&!isNaN(e.y)&&!isNaN(e.z)},o.prototype.vector3D=function(e,t,i){return this.x=e,this.y=t,this.z=i,{x:this.x,y:this.y,z:this.z}},o.prototype.vector3DMinus=function(e,t){return this.vector3D(e.x-t.x,e.y-t.y,e.z-t.z)},o.prototype.vector3DPlus=function(e,t){return this.vector3D(e.x+t.x,e.y+t.y,e.z+t.z)},o.prototype.vector3DMultiply=function(e,t){var i=e.y*t.z-t.y*e.z,r=e.z*t.x-t.z*e.x,n=e.x*t.y-t.x*e.y;return this.vector3D(i,r,n)},o.prototype.vector3DAdd=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z},o.prototype.vector3DStarMultiply=function(e,t){var i=e.x*t,r=e.y*t,n=e.z*t;return this.vector3D(i,r,n)},o.prototype.getLength=function(e){var t=this.vector3DAdd(e,e);return Math.sqrt(t)},o.prototype.getNormal=function(e,t,i){var r=this.vector3DMinus(e,t),n=this.vector3DMinus(i,t),s=this.vector3DMultiply(r,n),a=this.getLength(s);return a<this.epsilon?this.vector3D(0,0,0):this.vector3D(s.x/a,s.y/a,s.z/a)},o}(),PF=function(){function o(){this.matrixSize=4}return o.prototype.matrix3D=function(e){for(var t=[],i=0;i<e;i++)t[i]=this.createArray(e);return t},o.prototype.isAffine=function(e){return e[0][3]===0&&e[1][3]===0&&e[2][3]===0&&e[3][3]===1},o.prototype.createArray=function(e){for(var t=[],i=0;i<e;++i)t[i]=0;return t},o.prototype.getIdentity=function(){for(var e=this.matrix3D(this.matrixSize),t=0;t<this.matrixSize;t++)e[t][t]=1;return e},o.prototype.getInterval=function(e){for(var t=this.getIdentity(),i=0;i<this.matrixSize;i++)for(var r=0;r<this.matrixSize;r++)t[i][r]=this.getMinor(e,i,r);return t=this.transposed(t),t=this.getMatrixMultiple(1/this.getDeterminant(e),t),t},o.prototype.getMatrixMultiple=function(e,t){for(var i=0;i<t.length;i++)for(var r=0;r<t[i].length;r++)t[i][r]=t[i][r]*e;return t},o.prototype.getMatrixVectorMultiple=function(e,t){var i=e[0][0]*t.x+e[1][0]*t.y+e[2][0]*t.z+e[3][0],r=e[0][1]*t.x+e[1][1]*t.y+e[2][1]*t.z+e[3][1],n=e[0][2]*t.x+e[1][2]*t.y+e[2][2]*t.z+e[3][2];if(!this.isAffine(e)){var s=1/(e[0][3]*t.x+e[1][3]*t.y+e[2][3]*t.z+e[3][3]);i*=s,r*=s,n*=s}return{x:i,y:r,z:n}},o.prototype.getMatrixMultiplication=function(e,t){for(var i=this.getIdentity(),r=0;r<this.matrixSize;r++)for(var n=0;n<this.matrixSize;n++){for(var s=0,a=0;a<this.matrixSize;a++)s+=e[a][n]*t[r][a];i[r][n]=s}return i},o.prototype.getMinor=function(e,t,i){return((t+i)%2===0?1:-1)*this.getDeterminant(this.getMatrix(e,t,i))},o.prototype.getMatrix=function(e,t,i){for(var r=e.length-1,n=this.createArray(r),s=0;s<r;s++){var a=s>=t?s+1:s;n[s]=this.createArray(r);for(var l=0;l<r;l++){var h=l>=i?l+1:l;n[s][l]=e[a][h]}}return n},o.prototype.getDeterminant=function(e){var t=e.length,i=0;if(t<2)i=e[0][0];else for(var r=1,n=0;n<t;n++){var s=this.getMatrix(e,n,0);i+=r*e[n][0]*this.getDeterminant(s),r=r>0?-1:1}return i},o.prototype.transform=function(e,t,i){var r=this.getIdentity();return r[3][0]=e,r[3][1]=t,r[3][2]=i,r},o.prototype.turn=function(e){var t=this.getIdentity();return t[0][0]=Math.cos(e),t[2][0]=-Math.sin(e),t[0][2]=Math.sin(e),t[2][2]=Math.cos(e),t},o.prototype.tilt=function(e){var t=this.getIdentity();return t[1][1]=Math.cos(e),t[2][1]=Math.sin(e),t[1][2]=-Math.sin(e),t[2][2]=Math.cos(e),t},o.prototype.transposed=function(e){for(var t=this.getIdentity(),i=0;i<this.matrixSize;i++)for(var r=0;r<this.matrixSize;r++)t[i][r]=e[r][i];return t},o}();var d6=function(){function o(e){this.epsilon=5e-4,this.chart=e}return o.prototype.getNext=function(e,t){return e>=t?e-t:e<0?e+t:e},o.prototype.vector3DIndexClassification=function(e,t,i){return{index:t,result:i,vector:e,isCuttingBackPoint:!1,cuttingBackPairIndex:null,alreadyCutBack:!1,isCuttingFrontPoint:!1,cuttingFrontPairIndex:null,alreadyCutFront:!1}},o.prototype.classifyPoint=function(e,t){var i="OnPlane",r=-t.d-al.vector3DAdd(e,t.normal);return r>this.epsilon?i="OnBack":r<-this.epsilon&&(i="OnFront"),i},o.prototype.classifyPolygon=function(e,t){var i="Unknown",r=t.points;if(r==null)return i;for(var n=0,s=0,a=0,l=e.normal,h=e.d,u=0,c=r.length;u<c;u++){var d=-h-al.vector3DAdd(r[u],l);if(d>this.epsilon?n++:d<-this.epsilon?s++:a++,n>0&&s>0)break}return a===r.length?i="OnPlane":s+a===r.length?i="ToRight":n+a===r.length?i="ToLeft":i="Unknown",i},o.prototype.splitPolygon=function(e,t){var i=[],r=[];if(e.points!=null){for(var n=[],s=[],a=[],l=void 0,h=void 0,u=e.points.length,c=0;c<u;c++){var d=e.points[c],p=e.points[this.getNext(c+1,u)],f=this.classifyPoint(d,t),v=this.classifyPoint(p,t),m=this.vector3DIndexClassification(d,n.length,f);if(n.push(m),f!==v&&f!=="OnPlane"&&v!=="OnPlane"){var y=al.vector3DMinus(d,p),S=al.vector3DMinus(al.vector3DStarMultiply(t.normal,-t.d),p),b=al.vector3DAdd(S,t.normal),w=b/al.vector3DAdd(t.normal,y),I=al.vector3DPlus(p,al.vector3DStarMultiply(y,w)),x=this.vector3DIndexClassification(I,n.length,"OnPlane");n.push(x),s.push(x),a.push(x)}}if(a.length!==0||s.length!==0){for(var c=0;c<s.length-1;c+=2){var M=s[c],D=s[c+1];M.cuttingBackPoint=!0,D.cuttingBackPoint=!0,M.alterCuttingBackPairIndex=D.index,D.alterCuttingBackPairIndex=M.index}for(var c=0;c<a.length-1;c+=2){var A=a[c],L=a[c+1];A.cuttingFrontPoint=!0,L.cuttingFrontPoint=!0,A.alterCuttingFrontPairIndex=L.index,L.alterCuttingFrontPairIndex=A.index}for(var c=0;c<s.length-1;c++){var M=s[c];if(!M.alreadyCutBack&&(l=this.cutOutBackPolygon(n,M),l.length>2)){var T=kN.polygon3D(l,e);i.push(Ym({},T))}}for(var c=0;c<a.length-1;c++){var D=a[c];if(!D.alreadyCutFront&&(h=this.cutOutFrontPolygon(n,D),h.length>2)){var k=kN.polygon3D(h,e);r.push(Ym({},k))}}}}else i.push(e),r.push(e);return{backPolygon:i,frontPolygon:r}},o.prototype.cutOutFrontPolygon=function(e,t){for(var i=[],r=t,n=!0;n;){r.alreadyCutFront=!0,i.push(r.vector);var s=e[r.alterCuttingFrontPairIndex];if(r.cuttingFrontPoint)if(!s.alreadyCutFront)r=s;else{var a=e[this.getNext(r.index-1,e.length)],l=e[this.getNext(r.index+1,e.length)];if(a.result==="OnFront"&&!a.alreadyCutFront)r=a;else if(l.result==="OnFront"&&!l.alreadyCutFront)r=l;else return i}else{var a=e[this.getNext(r.index-1,e.length)],l=e[this.getNext(r.index+1,e.length)];if(a.result!=="OnBack"&&!a.alreadyCutFront)r=a;else if(l.result!=="OnBack"&&!l.alreadyCutFront)r=l;else return i}}return null},o.prototype.cutOutBackPolygon=function(e,t){for(var i=[],r=t,n=!0;n;){r.alreadyCutBack=!0,i.push(r.vector);var s=e[r.alterCuttingBackPairIndex];if(r.cuttingBackPoint)if(!s.alreadyCutBack)r=s;else{var a=e[this.getNext(r.index-1,e.length)],l=e[this.getNext(r.index+1,e.length)];if(a.result==="OnBack"&&!a.alreadyCutBack)r=a;else if(l.result==="OnBack"&&!l.alreadyCutBack)r=l;else return i}else{var a=e[this.getNext(r.index-1,e.length)],l=e[this.getNext(r.index+1,e.length)];if(a.result!=="OnFront"&&!a.alreadyCutBack)r=a;else if(l.result!=="OnFront"&&!l.alreadyCutBack)r=l;else return i}}return null},o.prototype.build=function(e,t){if(e){var i=e;if(i.length<1)return null;var r={back:null,front:null,plane:null},n=i[0];r.plane=n;for(var s=[],a=[],l=1,h=i.length;l<h;l++){var u=i[l];if(u!==n){var c=this.classifyPolygon(n,u);switch(c){case"OnPlane":case"ToRight":a.push(u);break;case"ToLeft":s.push(u);break;case"Unknown":if(u.element)s.push(u);else{for(var d=this.splitPolygon(u,n),p=0;p<d.backPolygon.length;p++)d.backPolygon[p].name=d.backPolygon[p].name+"-back",s.push(d.backPolygon[p]);for(var f=0;f<d.frontPolygon.length;f++)d.frontPolygon[f].name=d.frontPolygon[f].name+"-front",a.push(d.frontPolygon[f])}break}}}return s.length>0&&(r.back=this.build(s)),a.length>0&&(r.front=this.build(a)),r}else return this.build(t.circular3DPolygon)},o}();var p6=function(){function o(){this.epsilon=1e-5,this.normal={x:0,y:0,z:0},this.vector=new RF(0,0,0),this.vectorPoints=[],this.matrixObj=new PF}return o.prototype.polygon3D=function(e,t,i,r,n,s,a,l,h,u){if(arguments.length===2){this.calculateNormal(e[0],e[1],e[2]),this.vectorPoints=e,this.calculateNormal(this.vectorPoints);var c=t;return c.normal=this.normal,c.points=e,c.vectorPoints=this.vectorPoints,c.isSplit=!0,c.d=this.d,c}else{this.calculateNormal(e[0],e[1],e[2]),this.vectorPoints=e,this.calculateNormal(this.vectorPoints);var d={tag:"path",parent:h},c={normal:this.normal,points:e,vectorPoints:this.vectorPoints,index:i,tag:t,name:l||null,strokeThickness:n,opacity:s,fill:a,d:this.d,text:u||"",polygonElement:d};return arguments.length!==1&&(c.polygonElement=d),c}},o.prototype.calculateNormal=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e.length>=3){var i=e[0],r=e[1],n=e[2],s=this.vector.vector3DMinus(i,r),a=this.vector.vector3DMinus(n,r),l=this.vector.vector3DMultiply(s,a),h=this.vector.getLength(l);h<this.epsilon&&(h=1),this.normal=this.vector.vector3D(l.x/h,l.y/h,l.z/h),this.d=-(this.normal.x*i.x+this.normal.y*i.y+this.normal.z*i.z),e[3]&&(e[3].normal=this.normal,e[3].d=this.d)}else{var u=e[0];this.calculateNormal(u[0],u[1],u[2],e[1]);for(var c=3;c<u.length&&this.test();c++)this.calculateNormal(u[c],u[0],u[c/2])}},o.prototype.test=function(){return!this.vector.isValid(this.normal)},o.prototype.getNormal=function(e,t){var i;if(t!=null){i=this.vector.getNormal(this.matrixObj.getMatrixVectorMultiple(e,t[0]),Bm.getMatrixVectorMultiple(e,t[1]),this.matrixObj.getMatrixVectorMultiple(e,t[2]));for(var r=3;r<t.length&&!this.vector.isValid(i)&&t[r/2];r++){var n=Bm.getMatrixVectorMultiple(e,t[r]),s=Bm.getMatrixVectorMultiple(e,t[0]),a=Bm.getMatrixVectorMultiple(e,t[r/2]);i=this.vector.getNormal(n,s,a)}}return i},o.prototype.createTextElement=function(e,t,i,r){var n=[],s=e.x,a=e.y,l=t.width,h=t.height;return n[0]=this.vector.vector3D(s,a,e.z),n[1]=this.vector.vector3D(s+l,a+h+r,e.z),n[2]=this.vector.vector3D(s+l+i,a+h+r,e.z),this.text3D(t,n)},o.prototype.createPolyline=function(e,t){if(e.length===2){var i=e[1];e.push({x:i.x,y:i.y,z:i.z})}return this.polyLine3D(t,e)},o.prototype.polyLine3D=function(e,t){var i=this.polygon3D(t);return i.element=e,i},o.prototype.text3D=function(e,t){var i=this.polygon3D(t);return i.element=e,i},o.prototype.drawPolyLine=function(e,t){var i=Pm.transform,r=t.svg3DRenderer.getStringBuilder(),n=t.transform3D.toScreen(e.vectorPoints[0],i);r.append("M "+n.x+" "+n.y+" ");var s=t.transform3D.toScreen(e.vectorPoints[1],i);r.append("L "+s.x+" "+s.y+" "),r.append("M "+s.x+" "+s.y+" ");var a=t.transform3D.toScreen(e.vectorPoints[2],i);r.append("L "+a.x+" "+a.y+" ");var l=r.toString(),h={id:e.element.id,"stroke-dasharray":e.element.dashArray,"stroke-width":e.element.width,stroke:e.element.stroke,d:l},u=t.renderer.drawPath(h);vt(!1,t.groupElement,u,t.redraw,!0,"x","y",null,l)},o.prototype.drawText=function(e,t){var i=e.element,r=Pm.transform;if(r!=null){var n=t.transform3D.toScreen(e.vectorPoints[0],r),s=n.x,a=n.y;if(i.tag==="text"){var l={id:i.id,x:s,y:a,fill:i.font.color||i.fill,"font-size":i.font.size,"font-family":i.font.fontFamily||t.themeStyle.datalabelFont.fontFamily,"font-style":i.font.fontStyle,"font-weight":i.font.fontWeight,opacity:i.font.opacity,"text-anchor":i.textAnchor,cursor:"default",transform:i.angle?"rotate("+i.angle+","+s+","+a+")":""},h=t.svg3DRenderer.drawText(l,i.label.text,e.element.font,t);if(i.id.indexOf("text")>-1&&h.setAttribute("aria-hidden","true"),t.groupElement.append(h),t.previousID&&t.isTouch){var u=document.getElementById(t.previousID),c=document.getElementById(l.id);u&&c&&c.parentNode.insertBefore(c,u.nextSibling)}t.previousID=l.id}else{var d=i.series,p=i.point.argsData.text,f=Ze(p,i.point.argsData.font,t.themeStyle.datalabelFont),v=10,m=f.width+v+v,y=f.height+v+v,S={x:n.x,y:n.y},b=S.x-v/2+v/2,w=S.y-v/2-y/v+v/2,I=d.index;this.dataLabelSymbol(I,d,i,b,w,m,y,t)}}},o.prototype.dataLabelSymbol=function(e,t,i,r,n,s,a,l){var h="M "+(r+-s/2)+" "+(n+-a/2)+" L "+(r+s/2)+" "+(n+-a/2)+" L "+(r+s/2)+" "+(n+a/2)+" L "+(r+-s/2)+" "+(n+a/2)+" L "+(r+-s/2)+" "+(n+-a/2)+" z",u="";if(t.dataLabel.enableRotation){var c=void 0,d=c=t.dataLabel.angle;if(d===0){var p=function(b){return b*(180/Math.PI)},f=p(i.point.symbolLocation.angle);t.dataLabel.position==="Outside"?c=0:f>=90&&f<=260?c=f+180:c=f}else c=d>360?d-360:d<-360?d+360:d;u="rotate("+c+","+r+","+n+")"}var v={id:l.element.id+"-svg-data-label-series-"+e+"-shape-"+i.pointIndex,fill:i.point.argsData.color,"stroke-width":i.point.argsData.border.width,stroke:i.point.argsData.border.color,"stroke-dasharray":i.point.argsData.border.dashArray,opacity:1,visibility:"",transform:u,d:h},m=l.renderer.drawPath(v);if(l.groupElement.append(m),l.previousID&&l.isTouch){var y=document.getElementById(l.previousID),S=document.getElementById(v.id);y&&S&&S.parentNode.insertBefore(S,y.nextSibling)}l.previousID=v.id},o.prototype.draw=function(e,t){if(!(e.vectorPoints==null||e.vectorPoints.length<=0)){var i=Pm.transform,r=t.svg3DRenderer.getStringBuilder(),n=e.fill,s=t.svg3DRenderer.checkColorFormat(n);s||(n=Bn(n));var a={StartPoint:null};if(i!=null){a.StartPoint=t.transform3D.toScreen(e.vectorPoints[0],i),r.append("M "+a.StartPoint.x+" "+a.StartPoint.y+" ");for(var l=0;l<e.vectorPoints.length;l++){var h=t.transform3D.toScreen(e.vectorPoints[l],i);r.append("L "+h.x+" "+h.y+" ")}}var u=r.toString(),c="Light",d=2*(Math.abs(this.vector.vector3DAdd(e.normal,this.vector.vector3D(0,0,1)))-1),p=2*(Math.abs(this.vector.vector3DAdd(e.normal,this.vector.vector3D(0,1,0)))-1),f=2*(Math.abs(this.vector.vector3DAdd(e.normal,this.vector.vector3D(1,0,0)))-1);e.name&&!(e.name.indexOf("-wall-brush")>-1)&&(d===f?(c="ZLight",n=this.applyZLight(n,t)):p===d||d!==0&&p<d?(c="XLight",n=this.applyXLight(n,t)):d<0?(c="ZLight",n=this.applyZLight(n,t)):c="Light");var v={id:t.element.id+"-svg-"+e.name,name:c,fill:n,stroke:"","stroke-width":e.strokeThickness,opacity:e.opacity,d:u},m=t.renderer.drawPath(v);if(e.text&&(m.setAttribute("aria-label",e.text),m.setAttribute("role","img")),vt(!1,e.polygonElement.parent,m,t.redraw,!0,"x","y",null,u),t.previousID&&t.isTouch){var y=document.getElementById(t.previousID),S=document.getElementById(v.id);y&&S&&S.parentNode.insertBefore(S,y.nextSibling)}t.previousID=v.id}},o.prototype.drawTemplate=function(e,t){var i=e.element,r=Pm.transform;if(r!=null){var n=i.label,s=t.transform3D.toScreen(e.vectorPoints[0],r);t.circularChartDataLabel3DModule.createDataLabelTemplate(n.series.dataLabelElement,n.series,n.series.dataLabel,n.series.points[n.pointIndex],n.series.points[n.pointIndex].argsData,n.pointIndex,!1,s,t)}},o.prototype.applyXLight=function(e,t){var i=t.svg3DRenderer.hexToValue(e);return i.red=parseInt((i.red*.7).toString(),10),i.green=parseInt((i.green*.7).toString(),10),i.blue=parseInt((i.blue*.7).toString(),10),t.svg3DRenderer.hexColor(i)},o.prototype.applyZLight=function(e,t){var i=t.svg3DRenderer.hexToValue(e);return i.red=parseInt((i.red*.9).toString(),10),i.green=parseInt((i.green*.9).toString(),10),i.blue=parseInt((i.blue*.9).toString(),10),t.svg3DRenderer.hexColor(i)},o}(),al=new RF(0,0,0),Bm=new PF,iX=new d6,kN=new p6;function J(o,e,t){var i,r=[];if(o){var n=void 0;e&&!g(t)&&(n=ke(e,t)),o=o.lastIndexOf("!")>-1?o.substring(o.lastIndexOf("!")+1):o,o=o.indexOf(":")===-1?o+":"+o:o;var s=new RegExp(/^(?=.*[a-zA-Z])(?=.*\d)/g);if(!s.test(o)){var a=o.split(":");o=g(o.match(/[0-9]/))?a[0]+"1:"+a[1]+(n?n.rowCount-1:"1"):"A"+a[0]+":"+(n?Pi(n.colCount):"A")+a[1]}o.split(":").forEach(function(l){i=Se(l),r.push(i[0]),r.push(i[1])})}return r}function Se(o){return[parseInt(o.match(/\d+/)[0],10)-1,vn(o.match(/[A-Z]+/i)[0].toUpperCase())]}function vn(o){var e=0;o=o.split("").reverse().join("");for(var t=o.length-1;t>=0;t--)e+=(o[t].charCodeAt(0)-64)*Math.pow(26,t);return e-1}function et(o,e){return Pi(e+1)+(o+1)}function Be(o){return et(o[0],o[1])+":"+(g(o[2])?et(o[0],o[1]):et(o[2],o[3]))}function Pi(o){var e="Z";return o/26>1?Pi(o%26===0?o/26-1:Math.floor(o/26))+String.fromCharCode(o%26===0?e.charCodeAt(0):64+o%26):String.fromCharCode(64+o)}function Qi(o,e,t){return J(cu(o),e,t)}function cu(o){var e=o.lastIndexOf("!");return e>-1?o.substring(e+1):o}function f6(o){return o.name+"!"+o.selectedRange}function px(o,e){var t=Gs(o,e);return{sheetIndex:t,indices:Qi(e,o,t)}}function Gs(o,e){var t;return e.indexOf("!")>-1?t=yt(o,Ws(e)):t=o.activeSheetIndex,t}function tt(o){var e=o.slice();return o[0]>o[2]&&BF(e,0,2),o[1]>o[3]&&BF(e,1,3),e}function BF(o,e,t){var i=o[e];o[e]=o[t],o[t]=i}function mf(o){return o[0]===o[2]&&o[1]===o[3]}function rx(o,e,t,i,r,n){return new g6(o,e,t,i,r,n)}var g6=function(){function o(e,t,i,r,n,s){this.preventCallback=!1,this.context=e,this.workerTask=t,this.defaultListener=i,this.workerData=r,this.parent=s,n&&(this.preventCallback=!0),this.initWorker()}return o.prototype.terminate=function(){this.worker.terminate(),URL.revokeObjectURL(this.workerUrl)},o.prototype.initWorker=function(){var e=new Blob([this.getFnCode()],{type:"text/javascript"});if(this.workerUrl=URL.createObjectURL(e),this.worker=new Worker(this.workerUrl),this.worker.onmessage=this.messageFromWorker.bind(this),this.worker.onerror=this.onError.bind(this),!this.parent.isVue)this.worker.postMessage(this.workerData);else{var t=JSON.parse(JSON.stringify(this.workerData));this.worker.postMessage(t)}},o.prototype.messageFromWorker=function(e){this.terminate(),this.defaultListener.apply(this.context,[e.data])},o.prototype.onError=function(e){if(this.terminate(),e.message&&e.message.includes("FormData"))this.defaultListener.apply(this.context,[{isFormDataError:!0}]);else throw e.message||e},o.prototype.getFnCode=function(){var e="",t,i,r="",n=!1;if(typeof this.workerTask=="function")this.workerTask.toString().indexOf("function")<0?r="function "+this.workerTask.toString():(r=this.workerTask.toString(),n=!0),e+="self.workerTask = "+r+`; 
`;else if(typeof this.workerTask=="object")for(i=Object.keys(this.workerTask),t=0;t<i.length;t++)this.workerTask[i[t]].toString().indexOf("function")<0?r="function "+this.workerTask[i[t]].toString():(r=this.workerTask[i[t]].toString(),n=!0),e+=(t===0?"self.workerTask":i[t])+"= "+r+`; 
`;return e+="self.onmessage = "+(n?"":" function ")+(this.preventCallback?this.getMessageFn.toString():this.getCallbackMessageFn.toString())+`; 
`,e},o.prototype.getCallbackMessageFn=function(e){postMessage(this.workerTask.apply(this,e.data))},o.prototype.getMessageFn=function(e){this.workerTask.apply(this,e.data)},o}();function tO(o,e){return e===void 0&&(e=[]),e.push({member:"dataBind",args:[o]}),e.push({member:"workbookProtectSheet",args:[o]}),o.allowSave&&e.push({member:"workbookSave",args:[o]}),o.allowPrint&&e.push({member:"print",args:[o]}),o.allowOpen&&e.push({member:"workbookOpen",args:[o]}),o.allowEditing&&(e.push({member:"workbookEdit",args:[o]}),e.push({member:"workbookFormula",args:[o]})),o.allowNumberFormatting&&e.push({member:"workbookNumberFormat",args:[o]}),o.allowCellFormatting&&e.push({member:"workbookcellformat",args:[o]}),o.allowSorting&&e.push({member:"workbookSort",args:[o]}),o.allowHyperlink&&e.push({member:"workbookHyperlink",args:[o]}),o.allowFiltering&&e.push({member:"workbookFilter",args:[o]}),o.allowFindAndReplace&&e.push({member:"workbookfindAndReplace",args:[o]}),o.allowInsert&&e.push({member:"workbookinsert",args:[o]}),o.allowDelete&&e.push({member:"workbookdelete",args:[o]}),o.allowDataValidation&&e.push({member:"workbookDataValidation",args:[o]}),o.allowMerge&&e.push({member:"workbookmerge",args:[o]}),o.allowCellFormatting&&e.push({member:"workbookConditionalFormatting",args:[o]}),o.allowImage&&e.push({member:"workbookImage",args:[o]}),o.allowChart&&e.push({member:"workbookChart",args:[o]}),o.allowAutoFill&&e.push({member:"workbookautofill",args:[o]}),e}var wd=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),pi=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},iO=function(o){wd(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return pi([C("Calibri")],e.prototype,"fontFamily",void 0),pi([C("bottom")],e.prototype,"verticalAlign",void 0),pi([C("left")],e.prototype,"textAlign",void 0),pi([C("0pt")],e.prototype,"textIndent",void 0),pi([C("#000000")],e.prototype,"color",void 0),pi([C("#ffffff")],e.prototype,"backgroundColor",void 0),pi([C("normal")],e.prototype,"fontWeight",void 0),pi([C("normal")],e.prototype,"fontStyle",void 0),pi([C("11pt")],e.prototype,"fontSize",void 0),pi([C("none")],e.prototype,"textDecoration",void 0),pi([C("")],e.prototype,"border",void 0),pi([C("")],e.prototype,"borderTop",void 0),pi([C("")],e.prototype,"borderBottom",void 0),pi([C("")],e.prototype,"borderLeft",void 0),pi([C("")],e.prototype,"borderRight",void 0),e}(Re);var rO=function(o){wd(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return pi([C("")],e.prototype,"name",void 0),pi([C("")],e.prototype,"scope",void 0),pi([C("")],e.prototype,"comment",void 0),pi([C("")],e.prototype,"refersTo",void 0),e}(Re),v6=function(o){wd(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return pi([C(!1)],e.prototype,"selectCells",void 0),pi([C(!1)],e.prototype,"selectUnLockedCells",void 0),pi([C(!1)],e.prototype,"formatCells",void 0),pi([C(!1)],e.prototype,"formatRows",void 0),pi([C(!1)],e.prototype,"formatColumns",void 0),pi([C(!1)],e.prototype,"insertLink",void 0),e}(Re);var m6=function(o){wd(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return pi([C("General")],e.prototype,"format",void 0),pi([be({},iO)],e.prototype,"style",void 0),pi([C(!0)],e.prototype,"isLocked",void 0),e}(Re),y6=function(o){wd(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return pi([C("GreaterThan")],e.prototype,"type",void 0),pi([be({},m6)],e.prototype,"format",void 0),pi([C("RedFT")],e.prototype,"cFColor",void 0),pi([C("")],e.prototype,"value",void 0),pi([C("")],e.prototype,"range",void 0),pi([C("")],e.prototype,"action",void 0),e}(Re);var b6=function(o){wd(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return pi([C("FillSeries")],e.prototype,"fillType",void 0),pi([C(!0)],e.prototype,"showFillOptions",void 0),e}(Re),S6="workbookDestroyed",ah="updateSheetFromDataSource",ly="dataSourceChanged",ry="dataChanged",yf="triggerDataChange",hy="workbookOpen",bf="beginSave",ai="actionBegin",uy="sortImport",du="findToolDlg",Sf="exportDialog",cy="setFilteredCollection",Cf="saveCompleted",wf="applyNumber",en="getFormattedCell",pu="calculateFormula",fx="refreshCellElem",rr="setCellFormat",gx="findAllValues",nd="textDecorationUpdate",Dr="applyCellFormat";var sd="updateRowColCount",xt="workbookFormulaOperation",fu="workbookEditOperation",Jr="checkDateFormat",dy="checkNumberFormat",vx="parseDecimalNumber",py="getFormattedBarText",Qa="activeCellChanged",fy="openSuccess",mx="openFailure",xf="sheetCreated",ma="sheetsDestroyed",pf="aggregateComputation",yx="getUniqueRange",ad="removeUniquecol",gu="checkUniqueRange",gy="reApplyFormula",vu="clearFormulaDependentCells",vy="formulaInValidation",C6="beforeSort",If="initiateSort",bx="updateSortedDataOnCell",ff="sortComplete";var w6="beforeHyperlinkCreate",x6="afterHyperlinkCreate",I6="beforeHyperlinkClick",M6="afterHyperlinkClick";var od="setLinkModel";var my="initiateFilter";var zF="filterRangeAlert";var Xa="wrapText",Sx="onSave",Cx="insert",wx="delete",ya="insertModel",Mf="deleteModel",yy="isValidation",To="cellValidation",by="addHighlight";var xx="find",nu="gotoHandler";var Df="replace",ld="replaceAll",Sy="showFindAlert",Ix="findKeyUp",Cy="removeHighlight",D6="queryCellInfo",wy="count";var Mx="protectSheet",jF="updateToggleItem",$c="protectsheetHandler",xy="replaceAllDialog",nO="unprotectsheetHandler",E6="editAlert",tu="readonlyAlert",Iy="setLockCells";var Mn="setMerge",Dx="applyMerge",Do="mergedRange",ur="activeCellMergedRange",My="insertMerge",Dn="hideShow",hd="setCFRule",Wi="applyCF",qa="clearCFRule",ud="clear",Ex="clearCF",Dy="setImage",oh="setChart",Ey="initiateChart",Es="refreshRibbonIcons",lh="refreshChart",th="refreshChartSize",Ay="deleteChartColl";var Ty="focusChartBorder",Ax="saveError",su="updateHighlight",Kc="beforeInsert",Ef="beforeDelete",ny="deleteHyperlink",Ly="moveOrDuplicateSheet",cd="setAutoFill",HF="refreshCell",Tx="getFillInfo",ky="getautofillDDB",Af="rowFillHandler",Ny="getTextSpace",Fy="refreshClipboard",au="updateView",pa="selectionComplete",ls="refreshInsertDelete",Oy="getUpdatedFormulaOnInsertDelete",A6="beforeCellUpdate",Lx="duplicateSheetFilterHandler",VF="unMerge",kx="checkFormulaRef",Ry="parseFormulaArgument",Nx="getCellRefValue",Zh="commputeFormulaValue",Py="getChartRowIdxFromClientY",By="getChartColIdxFromClientX",Fx="refreshChartCellOnInit",dd="localizedFormatAction",Ox="moveSheetHandler",pd="addListValidationDropdown",Tf="sheetRenameUpdate",mu="updateSortCollection";function ca(o,e,t,i,r,n,s){var a=o.value;if(a&&typeof a=="string"){if(a.includes(`
`))return{isNumber:!1,value:a};if(Me(a))return{isNumber:!0,value:a};if(r&&a.includes(r)&&(s||o.format.includes(r)||o.format.includes("$"))&&(a=a.replace(r,"").trim()),t&&a.includes(t)&&fd(a,e,t,i)&&(a=a.split(t).join("").trim()),i||(i=Yi(e).decimal),i!=="."&&a.includes(i)&&(a=a.replace(i,".").trim()),Me(a))return{isNumber:!0,value:a};if(n&&a.split("/").length===2)try{var l=a.split(" ");if(l.length===2&&l[0].split("/").length===1){var h=nx(l[0]),u=nx(l[1]);a=h+u}else a=nx(a);return{isNumber:!0,value:a}}catch{return{isNumber:!1,value:a}}}else if(Me(a))return{isNumber:!0,value:a};return{isNumber:!1,value:a}}function fd(o,e,t,i){for(var r=!1,n=123456,s=n.toLocaleString(e),a=s.split(t).reverse(),l=o.split(i)[0].split(t),h=0;h<l.length&&(h===l.length-1?r=l[h].length===a[0].length:r=!Ee(a[1])&&(h===0?l[h].length<=a[1].length:l[h].length===a[1].length),!!r);h++);return r}function ut(o,e){return o&&o[0]==="="&&(o.length>1||e)}function Mr(o){var e=o;if(e=e.split("$").join(""),e.indexOf(":")>-1){var t=e.split(":");if(sy(t[0])&&sy(t[1]))return!0}else if(e.indexOf(":")<0&&sy(e))return!0;return!1}function sO(o){return o.charCodeAt(0)>=65&&o.charCodeAt(0)<=90||o.charCodeAt(0)>=97&&o.charCodeAt(0)<=122}function aO(o,e){return e[1]===0&&e[3]===o.colCount-1}function T6(o,e){return e[0]===0&&e[2]===o.rowCount-1}function Co(o,e,t){return o&&e>=o[0]&&e<=o[2]&&t>=o[1]&&t<=o[3]}function oO(o,e,t){for(var i,r,n=o.split(" "),s=0,a=n.length;s<a&&(i=J(n[s]),r=Co(i,e,t),!r);s++);return r}function Lf(o,e,t){var i=o[0]<=e[0]&&o[2]>=e[2]&&o[1]<=e[1]&&o[3]>=e[3];if(i)return!0;if(t){if(e[0]<o[0]&&e[2]<o[0]||e[0]>o[2]&&e[2]>o[2]||(e[0]<o[0]&&e[2]>o[0]&&(e[0]=o[0],i=!0),e[2]>o[2]&&(e[2]=o[2],i=!0),e[1]<o[1]&&e[3]<o[1]||e[1]>o[3]&&e[3]>o[3]))return!1;e[1]<o[1]&&e[3]>o[1]&&(e[1]=o[1],i=!0),e[3]>o[3]&&(e[3]=o[3],i=!0)}return i}function L6(o,e,t){var i=Pi(t+1);return o?o.split(" ").forEach(function(r){var n=J(r);if(Lf(n,e))o=o.split(r).join(i+(n[0]+1)+":"+i+e[0]+" "+i+(e[2]+2)+":"+i+(n[2]+1));else if(Lf(n,e,!0)){var s=void 0;e[0]>n[0]?s=i+(n[0]+1)+":"+i+e[0]:s=i+(e[2]+2)+":"+i+(n[2]+1),o=o.split(r).join(s)}}):o=i+"1:"+i+e[0]+" "+i+(e[2]+2)+":"+i+"1048576",o}function un(o,e){return o||(o={}),o.isLocked?!0:o.isLocked===!1?!1:e&&e.isLocked?!0:!!(!o.isLocked&&e&&e.isLocked!==!1)}function sy(o){for(var e=o,t=0,i=0,r="",n=e.length,s=0;s<n;s++)sO(e[s])&&i++;r=e.substring(t,i);var a=r.length;if(a!==n&&a<4&&n!==1&&isNaN(parseInt(e,10))){var l=k6(r);if(l>16384)return!1;var h=parseFloat(e.substring(i,n));if(h>0&&h<1048577)return!0}return!1}function k6(o){var e=0,t=0;if(o=o.toUpperCase(),e<o.length&&o[e]==="!"){for(e++;e<o.length&&o[e]!=="!";)e++;e++}for(;e<o.length&&sO(o[e]);){var i=o[e].charCodeAt(0);t=t*26+i-64,e++}return t===0?-1:t}function se(o,e,t,i,r){i===void 0&&(i="rows");var n;if(t)for(var s=e;s<1/0;s++)if(n=o[""+i],n[e]&&n[e].hidden)e++;else if(r)r--,e++;else break;else for(var s=e;s>-1&&(n=o[""+i],n[e]&&n[e].hidden);s--)e--;return e}function gd(o,e){var t=Object.keys(o);return(e?t.indexOf("fontSize")>-1:t.indexOf("fontSize")>-1&&Number(o.fontSize.split("pt")[0])>12)||t.indexOf("fontFamily")>-1||t.indexOf("borderTop")>-1||t.indexOf("borderBottom")>-1}function Hn(o,e,t,i,r,n){var s,a;if(e&&(a=r||G(e[0],e[1],t,!1,!0),s=a.formula||""),s){n&&i.notify(vu,{cellRef:et(e[0],e[1])}),s.indexOf("=")===0&&(s=s.slice(1)),s=s.split("(").join(i.listSeparator).split(")").join(i.listSeparator);for(var l=["+","-","*","/",">=","<=","<>",">","<","=","%","&"],h=void 0,u=s,c=0;c<l.length;c++)h=u.split(l[c]),u=h.join(i.listSeparator);h=u.split(i.listSeparator);for(var d=[],p=void 0,f=void 0,v=void 0,m=void 0,y=void 0,S=0;S<h.length;S++){if(v=h[S].includes("!"),v){var b=h[S].lastIndexOf("!");m=h[S].substring(0,b),y=h[S].substring(b+1).toUpperCase()}else y=h[S].toUpperCase();if(Mr(y.trim())&&!y.includes("$")){var w=N6(y),I=F6(y),x=J(y),M=[o[0]-(e[0]-x[0]),o[1]-(e[1]-x[1]),o[0]-(e[0]-x[2]),o[1]-(e[1]-x[3])];M[1]<0||M[2]<0||M[3]<0||!n&&M[0]<0?p="#REF!":(n&&M[0]<0&&(M[0]=M[2]),p=et(M[0],M[1]),y.includes(":")&&(p+=":"+et(M[2],M[3])),p=Mr(p)?p:"#REF!"),f={},v&&(p=m+"!"+p),f[h[S]]=""+w+p+I,h[S].includes(":")?d.splice(0,0,f):d.push(f)}}var D=void 0,A=void 0;s=a.formula;for(var L=s,S=0;S<d.length;S++){D=Object.keys(d[S])[0],A=d[S][""+D];for(var T=D.length,k=L.indexOf(D),F="",R=0;R<A.length;R++)F+=" ";s=s.slice(0,k)+A+s.slice(k+T),L=L.slice(0,k)+F+L.slice(k+T)}return s}else return null}function N6(o){for(var e="",t=0;t<o.length&&o[t]===" ";t++)e+=" ";return e}function F6(o){for(var e="",t=o.length-1;t>=0&&o[t]===" ";t--)e=" "+e;return e}function sr(o,e,t,i,r){var n={cell:t.cell,rowIndex:t.rowIdx,colIndex:t.colIdx,cancel:!1,sheet:e.name};if(t.preventEvt||o.trigger(A6,n),!t.eventOnly&&!n.cancel)if(t.valChange){var s=G(n.rowIndex,n.colIndex,e),a=!t.preventEvt&&o.getDisplayText(s),l=!!(s&&s.formula);oi(n.rowIndex,n.colIndex,e,n.cell,!t.pvtExtend);var h=G(n.rowIndex,n.colIndex,e,!1,!0);t.mergedCells&&(delete h.value,delete h.formula),h.formattedText&&delete h.formattedText;var u={action:"updateCellValue",address:[n.rowIndex,n.colIndex],sheetIndex:yt(o,e.name),value:l&&!h.formula?h.value||(h.value===0?"0":""):h.formula||h.value||(h.value===0?"0":""),skipFormatCheck:t.skipFormatCheck,isRandomFormula:t.isRandomFormula,isDelete:t.isDelete,deletedRange:t.deletedRange,fillType:t.fillType,cellInformation:i,isRedo:!r,actionName:t.fillType,isPaste:t.requestType==="paste"};if(o.notify(fu,u),t.isFormulaDependent=u.isFormulaDependent,t.requestType&&n.cell===null&&oi(n.rowIndex,n.colIndex,e,n.cell,!t.pvtExtend),t.cellDelete&&(delete h.value,delete h.formula,delete h.hyperlink),t.uiRefresh&&o.serviceLocator.getService("cell").refresh(n.rowIndex,n.colIndex,t.lastCell,t.td,t.checkCF,t.checkWrap,t.skipFormatCheck,t.isRandomFormula,t.fillType),!t.preventEvt){var c=o.getDisplayText(h);if(c!==a){var d=G(n.rowIndex,n.colIndex,e,!1,!0).value;d=d||(d===0?"0":"");var p={value:d,oldValue:a,formula:h.formula||"",address:e.name+"!"+et(n.rowIndex,n.colIndex),displayText:c};t.requestType&&(p.requestType=t.requestType),o.trigger("cellSave",p)}}}else oi(n.rowIndex,n.colIndex,e,n.cell,!t.pvtExtend);return n.cancel}function wb(o,e,t){for(var i=o,r=o,n=e,s=e,a=t.usedRange.rowIndex,l=t.usedRange.colIndex,h=function(d){for(var p=0;p<=l;p++)if(!Ee(G(d,p,t,null,!0).value))return!1;return!0},u=function(d){for(var p=i;p<=r;p++)if(!Ee(G(p,d,t,null,!0).value))return!1;return!0},c=i;c<=a&&!(Ee(G(c,e,t,null,!0).value)&&h(c));c++)r=c;for(var c=i;c>=0&&!(Ee(G(c,e,t,null,!0).value)&&h(c));c--)i=c;for(var c=n;c<=l&&!(Ee(G(o,c,t,null,!0).value)&&u(c));c++)s=c;for(var c=n;c>=0&&!(Ee(G(o,c,t,null,!0).value)&&u(c));c--)n=c;return[i,n,r,s]}function O6(o,e,t){var i=J(o.model.selectedRange),r=0,n=0;if(o.modelType==="Column"){if((t||o.insertType==="before"&&o.isUndoRedo)&&(i=[0,o.start,0,o.end]),o.insertType==="before")e[1]<=i[1]&&e[3]>=i[1]?(r=0,n=i[3]-i[1]+1):i[1]<e[1]&&(r=n=i[3]-i[1]+1);else{if(o.isUndoRedo){var s=o.end-o.start+1;i=[0,o.start-s,0,o.end-s]}e[1]<=i[3]&&e[3]>=i[3]?(r=0,n=i[3]-i[1]+1):i[3]<e[3]&&(r=n=i[3]-i[1]+1)}return[e[0],e[1]+r,e[2],e[3]+n]}else{if((t||o.insertType==="above"&&o.isUndoRedo)&&(i=[o.start,0,o.end,0]),o.insertType==="above")e[0]<=i[0]&&e[2]>=i[0]?(r=0,n=i[2]-i[0]+1):i[0]<e[0]&&(r=n=i[2]-i[0]+1);else{if(o.isUndoRedo){var s=o.end-o.start+1;i=[o.start-s,0,o.end-s,0]}e[0]<=i[2]&&e[2]>=i[2]?(r=0,n=i[2]-i[0]+1):i[2]<e[2]&&(r=n=i[2]-i[0]+1)}return[e[0]+r,e[1],e[2]+n,e[3]]}}function R6(o,e){var t,i=0,r=0;return o.modelType==="Column"?(t=[0,o.start,o.model.usedRange.rowIndex,o.end],t[3]<e[1]?i=r=t[3]-t[1]+1:t[1]>=e[1]&&t[3]<=e[3]?r=t[3]-t[1]+1:t[1]>=e[1]&&t[1]<=e[3]?r=e[3]-t[1]+1:t[1]<e[1]&&t[3]>=e[1]?(i=e[1]-t[1],r=t[3]-t[1]+1):t[1]<e[1]&&t[3]<e[3]&&(i=t[3]-e[1]+(t[3]-t[1])+1,r=t[3]-t[1]+1),[e[0],e[1]-i,e[2],e[3]-r]):(t=[o.start,0,o.end,o.model.usedRange.colIndex],t[2]<e[0]?i=r=t[2]-t[0]+1:t[0]>=e[0]&&t[2]<=e[2]?r=t[2]-t[0]+1:t[0]>=e[0]&&t[0]<=e[2]?r=e[2]-t[0]+1:t[0]<e[0]&&t[2]>=e[0]?(i=e[0]-t[0],r=t[2]-t[0]+1):t[0]<e[0]&&t[2]<e[2]&&(i=t[2]-e[0]+(t[2]-t[0])+1,r=t[2]-t[0]+1),[e[0]-i,e[1],e[2]-r,e[3]])}function kf(o,e,t,i,r,n,s){for(var a,l,h=o.length-1;h>=0;h--){a=o[h].range.trim().split(",");for(var u=0;u<a.length;u++)if(l=J(a[u].includes(":")?a[u]:a[u]+":"+a[u]),t>=l[0]&&i>=l[1]&&t<=l[2]&&i<=l[3]){e.push(o[h]),o.splice(h,1);break}else if(r&&r[0]>=l[0]&&r[1]>=l[1]&&r[0]<=l[2]&&r[1]<=l[3]){var c={action:"autofillWithCF",cFColor:o[h].cFColor,range:Be(n),type:o[h].type,value:o[h].value};o.splice(h,1);for(var d=0,p=s.conditionalFormats;d<p.length&&!(p[d].action==="autofillWithCF"&&p[d].range===c.range);d++)d===p.length-1&&(e.push(c),s.conditionalFormats.push(c));break}}}function zy(o,e){for(var t=e.trim().split(","),i,r,n,s,a,l=function(u){for(var c=0;c<t.length;c++){if(a=J(t[c].includes(":")?t[c]:t[c]+":"+t[c]),u[0]<=a[0]&&u[1]<=a[1]&&u[2]>=a[2]&&u[3]>=a[3])return!0;if(n=u[0]>=a[0]&&u[0]<=a[2],s=u[2]>=a[0]&&u[2]<=a[2],i=u[1]>=a[1]&&u[1]<=a[3],r=u[3]>=a[1]&&u[3]<=a[3],n&&s){if((i||r||u[1]<a[1]&&u[3]>a[3])&&(u[0]-a[0]>0||a[2]-u[2]>0)||i&&u[1]!==a[1]||r&&u[3]!==a[3])return!0}else if(i&&r){if((n||s||u[0]<a[0]&&u[2]>a[2])&&(u[1]-a[1]>0||a[3]-u[3]>0))return!0;if(n){if(u[0]!==a[0])return!0}else if(s&&u[2]!==a[2])return!0}else if(n||s){if(i){if(u[1]!==a[1]||u[0]-a[0]>0)return!0;if(a[2]-u[2]>0)return!0}else if(r){if(u[3]!==a[3]||u[0]-a[0]>0)return!0;if(a[2]-u[2]>0)return!0}else if(u[1]<a[1]&&u[3]>a[3])return!0}else if((i||r)&&u[0]<a[0]&&u[2]>a[2])return!0}return!1},h=0;h<o.length;h++)if(l(o[h]))return!0;return!1}function Zc(o,e,t){var i;t||(t=Yi(e.locale));for(var r=0;r<o.length;r++)Me(o[r])?t.group==="."&&(o[r]=o[r].toString(),o[r].indexOf(".")&&fd(o[r],e.locale,t.group,t.decimal)&&(o[r]=o[r].split(t.group).join(""))):(i={formattedText:o[r],value:o[r],format:"General",cell:{value:o[r],format:"General"},isEdit:!0},e.notify(en,i),Me(i.value)&&(o[r]=i.value.toString()));return o}function lO(o,e){var t=o.getActiveSheet(),i=[[e.topIndex+o.frozenRowCount(t),e.leftIndex+o.frozenColCount(t),e.bottomIndex,e.rightIndex]];if(t.frozenRows||t.frozenColumns){var r=o.frozenRowCount(t),n=o.frozenColCount(t),s=Se(t.topLeftCell);if(r&&n){i.push([s[0],s[1],r-1,n-1]);var a=Se(t.paneTopLeftCell);i.push([a[0],s[1],e.bottomIndex,n-1])}r&&i.push([s[0],e.leftIndex+n,r-1,e.rightIndex]),n&&i.push([e.topIndex+r,s[1],e.bottomIndex,n-1])}return i}function xb(o){if(st(o.sheet,o.rowIdx)){var e=se(o.sheet,o.rowIdx,!0);e<o.rowIdx+o.cell.rowSpan&&(o.rowIdx=e,o.isMergedHiddenCell=!0)}if(Ot(o.sheet,o.colIdx)){var e=se(o.sheet,o.colIdx,!0,"columns");e<o.colIdx+o.cell.colSpan&&(o.colIdx=e,o.isMergedHiddenCell=!0)}}function cs(o){return o.workbookOpenModule&&o.workbookOpenModule.preventFormatCheck}function Nf(o){var e=new Et,t={intl:e,updateValue:!0,value:"",curSymbol:Eh(o.locale,ts)},i={args:t,intl:e},r=Yi(o.locale);return function(n){if(!n.format&&n.value&&!Me(n.value)&&(t.cell=n,t.value=n.value,o.notify(Jr,t),!n.format)){var s=n.value.toString();s.includes(i.args.curSymbol)||s.includes(r.group)||s.includes("%")?(i.fResult=s,o.notify(dy,i)):r.decimal!=="."&&!Me(s)&&s.includes(r.decimal)&&(s=s.replace(r.decimal,"."),Me(s)&&(n.value=s))}}}function Rx(o,e,t){var i=new Pe;e.length&&i.where(St.and(e));var r=o.executeLocal(i);if(t)for(var n=0,s=t.length;n<s&&r.length;n++)i=new Pe,t[n].length&&i.where(St.or(t[n])),r=new re(r).executeLocal(i);return r}function Lo(o,e,t){return o&&o.isReadOnly||t&&t.isReadOnly||e&&e.isReadOnly}function qi(o,e){for(var t=o.getActiveSheet(),i,r=g(e)?tt(J(t.selectedRange)):e,n=r[0];n<=r[2];n++)for(var s=r[1];s<=r[3];s++){var a=G(n,s,t);if(Lo(a,Rt(t,s),Ar(t,n))){i=!0;break}}return i}function Px(o,e){var t=e||o.selectedRange,i=J(t),r=o.colCount,n=o.rowCount;return i[2]===n-1&&i[0]===0?t=t.replace(/[0-9]/g,""):i[3]===r-1&&i[2]===0&&(t=t.replace(/\D/g,"")),t}function _c(o,e,t){if(e.length){var i=o.getActiveSheet(),r,n=o,s=o.frozenColCount(i),a=t&&t[0]||(s?Se(i.topLeftCell)[1]:n.viewport.leftIndex),l=t&&t[1]||n.viewport.rightIndex;e.forEach(function(h){for(var u=a;u<=l;u++){u===s&&(u+=n.viewport.leftIndex);var c=G(h-1,u,i,!1,!0);if((!c.rowSpan||c.rowSpan===1||!c.colSpan||c.colSpan===1)&&(!c.style||!c.style.borderBottom||c.style.borderBottom==="none")&&(r=G(h,u,i,!1,!0).style,r&&r.borderTop)){var d=o.getCell(h-1,u);if(d&&d.style.borderBottom){var p=o.getCell(h,u);p&&(d.style.borderBottom="",p.style.borderTop=r.borderTop)}}}})}}function P6(o){var e=o.toString();if(o===parseInt(e,10))return parseInt(e,10)+"  ";var t=e.indexOf(".")>-1?e.split(".")[1]:0,i=Math.pow(10,t.toString().replace("-","").length),r=Math.abs(XI(t,i));return t/r+"/"+i/r}function XI(o,e){return o=Number(o),e=Number(e),e?XI(e,o%e):o}function _s(o){o=Number(o),o=o>0&&o<1?1+o:o===0?1:o,o>60&&(o-=1);var e=new Date("01/01/1900"),t=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());return new Date(new Date((o-1)*(1e3*3600*24)+t).toUTCString().replace(" GMT",""))}function Ms(o,e,t){var i=new Date("01/01/1900"),r=wo(o)?o:new Date(o),n=Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()),s=Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),a=(s-n)/(1e3*3600*24);return(e?a:parseInt(a.toString(),10))+(t?0:a>60?2:1)}function wo(o){return Object.prototype.toString.call(o)==="[object Date]"&&!isNaN(o.valueOf())}function Me(o){return o-parseFloat(o)>=0}function nx(o){return Function('"use strict";return ('+o+")")()}function sx(o,e,t,i,r,n){var s=nt.getDependables(zr,t,null).dateObject,a=s.dateTimeFormats.availableFormats,l={dateObj:null,isCustom:!1,type:""},h,u=function(){l.type==="time"&&(l.dateObj=new Date((h?h.toDateString():"01/01/1900")+" "+l.dateObj.toLocaleTimeString()))};if(i&&(l.dateObj=e.parseDate(o,{format:i}),l.dateObj&&(l.type=o.toString().indexOf(":")>-1?"time":"datetime",u(),l.isCustom=!0)),g(l.dateObj)){if(o=o.toString(),o&&o.indexOf("/")>-1||o.indexOf("-")>0){var c=r&&r.format||i;if(c){var d=c.toLowerCase().includes("dd-mm-yy");if((d||c.toLowerCase().includes("dd/mm/yy"))&&(c=d?"d-M-y":"d/M/y",l.dateObj=e.parseDate(o,{format:c,skeleton:"yMd"}),l.dateObj))return l.type="date",l}}var p=function(v){if(v.indexOf(":")<0)for(var m=0,y=Object.keys(s.dateFormats);m<y.length;m++){var S=y[m];if(l.dateObj=e.parseDate(v,{format:s.dateFormats[""+S],skeleton:S}),l.dateObj){l.type="date",l.isCustom=!1;break}}if(g(l.dateObj))for(var b=void 0,w=0,I=Object.keys(a);w<I.length;w++){var S=I[w];if(b=a[""+S],l.dateObj=e.parseDate(v,{format:b,skeleton:S}),!l.dateObj&&v.indexOf(":")>-1&&b.indexOf(":")>-1&&(l.dateObj=e.parseDate(v,{format:b.split(" ")[0]})),l.dateObj){l.type=v.toString().indexOf(":")>-1?"time":"datetime",u(),l.isCustom=!0;break}}if(g(l.dateObj))for(var x=0,M=Object.keys(s.timeFormats);x<M.length;x++){var S=M[x];if(l.dateObj=e.parseDate(v,{format:s.timeFormats[""+S],skeleton:S}),l.dateObj){l.type="time",u(),l.isCustom=!1;break}}};if(n){var f=o.split(" ");f.length>=2&&(p(f.shift()),l.dateObj&&(h=l.dateObj,l.dateObj=null,p(f.join(" ")),l.dateObj&&(l.type="datetime")))}else p(o)}return o!=="#DIV/0!"&&!l.dateObj&&new Date(o).toString()!=="Invalid Date"&&(l.dateObj=new Date(o),l.type="date"),l}function Jc(o,e,t){if(o&&o!=="."&&o!=="-"){var i=o.toString(),r=Number.MAX_SAFE_INTEGER.toString().length;if(i.startsWith("-")&&(i=i.slice(1),i=i.includes("-")?o:i),/^\d*\.?\d*$/.test(i))return e&&(i.length>r||t&&(i.startsWith("0")||i.endsWith("0")))?o:parseFloat(o)}return o}var jy="spreadsheetLocale",B6={SortOutOfRangeError:"Select a cell or range inside the used range and try again."};function fa(o,e,t,i,r,n,s,a,l,h,u,c){return l===void 0&&(l=!0),new Promise(function(d){d(function(){var p,f=e.lastIndexOf("!");f>-1?(p=yt(o,e.substring(0,f)),e=e.substring(f+1)):p=o.activeSheetIndex;var v=ke(o,p),m=Qi(h||e),y={sheet:v,indexes:m,formulaCellRef:s,sheetIndex:a,promise:new Promise(function(S){S(function(){}())})};return o.notify(ah,y),y.promise.then(function(){var S,b,w,I=m[0],x=o.frozenRowCount(v),M=o.frozenColCount(v),D=!!c;if(t){w=[];var A,L,T,k,F,R,N,P;i?(R=Yi(o.locale),N=new Et(o.locale)):P=Nf(o),e.split(",").forEach(function(oe,ae){for(m=J(oe),A=0,I=m[0];I<=m[2];){for(L=w[A]||{},b=Ar(v,I),S=m[1];S<=m[3];){if(l&&st(v,I)&&!(n&&Jn(v,I))){I++;continue}k=Pi(S+1);var ye=b?G(I,S,v):null;if(i)ye&&(ye.value||ye.value===0)?(ye.formattedText&&ye.format&&!ye.format.includes("*")?qs(ye.format,!1)?L[k]=_s(ye.value):L[k]=ye.formattedText.toString().trim():L[k]=Hy(o,ye,I,S,!1,N),F=ye.value,typeof F=="string"&&(R.decimal!=="."&&F.includes(R.decimal)?(T=F.replace(R.decimal,"."),Me(T)&&(F=parseFloat(T))):Me(F)&&(F=parseFloat(F)))):(L[k]="",F=null),L[k+"_value"]=F;else if((ye&&(ye.formula||!g(ye.value))||Object.keys(L).length)&&(S===u?(F={value:Hy(o,ye,I,S,!0)},F.value&&typeof F.value=="string"&&(Me(F.value)&&!ye.value.toString().includes(`
`)?(!ye.format||ye.format!=="@")&&(F.value=parseFloat(F.value)):ye.format||(P(ye),Me(ye.value)&&!ye.value.toString().includes(`
`)&&(F.value=parseFloat(ye.value)))),L[k]=he({},ye,F)):L[k]=ye),ye&&(ye.rowSpan&&ye.rowSpan!==1||ye.colSpan&&ye.colSpan!==1)){w=[{throwMergeAlert:!0}];return}S===m[3]&&Object.keys(L).length&&(L.__rowIndex=(I+1).toString(),w[A]=L,D&&ae===0&&!Jn(v,I)&&c.push(L),A++),S++}I++}})}else{w=new Map;for(var O=!!(!i&&r&&r.length);I<=m[2];){if(O&&I>=x&&I<r[0]){I=r[0];continue}if(!i&&st(v,I)){I++;continue}for(b=Ar(v,I),S=m[1];S<=m[3];){var z={cell:G(I,S,v),address:et(I,S),rowIndex:I,colIndex:S};o.trigger(D6,z);var H=G(I,S,v,!1,!0);if(H.formula&&H.formula.toUpperCase().includes("UNIQUE")&&o.notify(pu,{cell:H,rowIdx:I,colIdx:S,sheetIndex:o.activeSheetIndex,address:z.address}),H.colSpan>1&&H.rowSpan>1)for(var Q=void 0,$=I,U=I+H.rowSpan;$<U;$++)for(var ie=S,ne=S+H.colSpan;ie<ne;ie++)$===I&&ie===S||(Q=new Object,$!==I&&(Q.rowSpan=I-$),ie!==S&&(Q.colSpan=S-ie),v.rows[$]&&v.rows[$].cells&&v.rows[$].cells[ie]&&(delete v.rows[$].cells[ie].value,delete v.rows[$].cells[ie].formula),oi($,ie,v,Q,!0));else if(H.colSpan>1)for(var $=S+1,U=S+H.colSpan;$<U;$++)oi(I,$,v,{colSpan:S-$},!0),v.rows[I]&&v.rows[I].cells&&v.rows[I].cells[$]&&(delete v.rows[I].cells[$].value,delete v.rows[I].cells[$].formula);else if(H.rowSpan>1)for(var $=I+1,U=I+H.rowSpan;$<U;$++)oi($,S,v,{rowSpan:I-$},!0),v.rows[$]&&v.rows[$].cells&&v.rows[$].cells[S]&&(delete v.rows[$].cells[S].value,delete v.rows[$].cells[S].formula);if(!i&&Ot(v,S)){S++;continue}if(O&&S>=M&&S<r[1]){S=r[1];continue}if(H.style){var te={};Object.assign(te,H.style),H.style=te}w.set(z.address,H),S++}I++}}return w})}())})}function Hy(o,e,t,i,r,n){if(e){if(g(e.value))return"";if(e.format){var s={value:e.value,formattedText:e.value,cell:e,format:e.format,checkDate:!r,rowIndex:t,colIndex:i,dataUpdate:!0};return o.notify(en,s),s.dateObj&&s.dateObj.toString()!=="Invalid Date"?s.dateObj:r?s.value:s.formattedText.toString().trim()}else{if(r)return e.value;var a=e.value;if(Me(a)&&(a=Number(e.value).toString(),a.includes(".")||a.length>11)){var l={args:{value:a,updateValue:!0},fResult:a,cellVal:a,intl:n};o.notify(vx,l),a=l.fResult}return a}}else return""}function Vy(o,e,t,i){var r,n=0,s,a=o.length;i&&o.length>0&&o.sort(function(c,d){return!g(c)&&!Ee(c.index)&&!g(d)&&!Ee(d.index)?c.index-d.index:0});for(var l=function(c){if(!g(o[c])&&!Ee(o[c].index)&&(s=n=o[c].index-c,delete o[c].index),n>0){for(r=0;n--;)e?(t.createSheet(c+r),r++):o.splice(c,0,null);c+=s,a+=s}if(e){o[c].id<1&&(o[c].id=hO(t.sheets),o[c].properties&&(o[c].properties.id=o[c].id)),o[c].name||t.setSheetPropertyOnMute(o[c],"name","Sheet"+_6(t));var d=0;o[c].rows.forEach(function(p){d=Math.max(d,p&&p.cells&&p.cells.length-1||0)}),t.setSheetPropertyOnMute(o[c],"usedRange",{rowIndex:o[c].rows.length?o[c].rows.length-1:0,colIndex:d})}h=c},h,u=0;u<a;u++)l(u),u=h}var $I=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Di=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},z6=function(o){$I(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return e.prototype.setProperties=function(t,i){var r=this;if(this.parentObj.isComplexArraySetter&&this.controlParent&&this.controlParent.isAngular){if(Object.keys(t).length){this.parentObj.currRangeIdx===void 0?this.parentObj.currRangeIdx=0:this.parentObj.currRangeIdx+=1;var n=this.parentObj.ranges[this.parentObj.currRangeIdx];n&&n.info&&(this.info=n.info),setTimeout(function(){r.parentObj.currRangeIdx!==void 0&&delete r.parentObj.currRangeIdx})}else if(this.controlParent.tagObjects[0].instance&&this.controlParent.tagObjects[0].instance.hasChanges&&!this.controlParent.tagObjects[0].instance.isInitChanges){var s=this.controlParent.sheets.indexOf(this.parentObj);if(this.parentObj.changedRangeIdx===void 0){for(var a,l=this.controlParent.tagObjects[0].instance.list[s].tagObjects,h=0;h<l.length;h++)if(l[h].name==="ranges"){l[h].instance.list.forEach(function(u,c){u.hasChanges&&(a=c)});break}this.parentObj.changedRangeIdx=a}}}o.prototype.setProperties.call(this,t,i)},Di([C(null)],e.prototype,"dataSource",void 0),Di([C("A1")],e.prototype,"startCell",void 0),Di([C(null)],e.prototype,"query",void 0),Di([C(null)],e.prototype,"fieldsOrder",void 0),Di([C(!0)],e.prototype,"showFieldAsHeader",void 0),Di([C("")],e.prototype,"template",void 0),Di([C("A1")],e.prototype,"address",void 0),e}(Re),j6=function(o){$I(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Di([C(0)],e.prototype,"rowIndex",void 0),Di([C(0)],e.prototype,"colIndex",void 0),e}(Re),H6=function(o){$I(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Di([C(null)],e.prototype,"rows",void 0),Di([C(null)],e.prototype,"columns",void 0),Di([be({},v6)],e.prototype,"protectSettings",void 0),Di([Wt([],z6)],e.prototype,"ranges",void 0),Di([Wt([],y6)],e.prototype,"conditionalFormats",void 0),Di([C(0)],e.prototype,"index",void 0),Di([C("")],e.prototype,"name",void 0),Di([C(100)],e.prototype,"rowCount",void 0),Di([C(100)],e.prototype,"colCount",void 0),Di([C("A1:A1")],e.prototype,"selectedRange",void 0),Di([C("A1")],e.prototype,"activeCell",void 0),Di([be({},j6)],e.prototype,"usedRange",void 0),Di([C("A1")],e.prototype,"topLeftCell",void 0),Di([C(!0)],e.prototype,"showHeaders",void 0),Di([C(!0)],e.prototype,"showGridLines",void 0),Di([C(!1)],e.prototype,"isProtected",void 0),Di([C("Visible")],e.prototype,"state",void 0),Di([C(0)],e.prototype,"frozenRows",void 0),Di([C(0)],e.prototype,"frozenColumns",void 0),Di([C("A1")],e.prototype,"paneTopLeftCell",void 0),Di([C("")],e.prototype,"password",void 0),Di([C(null)],e.prototype,"standardHeight",void 0),Di([C(!1)],e.prototype,"isSheetCalculated",void 0),e}(Re);function yt(o,e){var t;e.startsWith("'")&&e.endsWith("'")&&(e=e.replace(/''/g,"'").replace(/^'|'$/g,""));for(var i=0;i<o.sheets.length;i++)if(o.sheets[i].name.toLowerCase()===e.toLowerCase()){t=i;break}return t}function cn(o,e){for(var t,i=0;i<o.sheets.length;i++)if(o.sheets[i].id===e){t=i;break}return t}function Ws(o){var e=o.lastIndexOf("!");return e>-1?o.substring(0,e).replace(/'/gi,""):o.replace(/'/gi,"")}function _F(o,e,t){for(var i=t.length,r=0;r<i;r++)if(t[r].sheet.toUpperCase()===e.toUpperCase())return t[r].index;return-1}function gf(o,e,t,i){t===void 0&&(t={}),o.setSheetPropertyOnMute(t,"selectedRange",i?t.selectedRange+" "+e:e)}function UF(o){return o&&o.selectedRange||"A1"}function V6(o){return o.selectedRange.split(" ")[0]}function ke(o,e){return o.sheets[e]}function _6(o){var e=[];o.sheets.forEach(function(i){e.push(i.name.toLowerCase())});for(var t=0;t<e.length;t++)if(e.indexOf("sheet"+o.sheetNameCount)>-1)o.sheetNameCount++;else return o.sheetNameCount++;return o.sheetNameCount++}function hO(o){var e=0;return o.forEach(function(t){e=Math.max(t.id,e)}),e+1}function cf(o,e,t){var i=e||o.sheets;i.forEach(function(r){if(r.id=r.id||0,r.name=r.name||"",o.setSheetPropertyOnMute(r,"rowCount",r.rowCount||100),o.setSheetPropertyOnMute(r,"colCount",r.colCount||100),o.setSheetPropertyOnMute(r,"topLeftCell",r.topLeftCell||"A1"),o.setSheetPropertyOnMute(r,"activeCell",r.activeCell||"A1"),o.setSheetPropertyOnMute(r,"selectedRange",r.selectedRange||r.activeCell+":"+r.activeCell),o.setSheetPropertyOnMute(r,"usedRange",r.usedRange||{rowIndex:0,colIndex:0}),o.setSheetPropertyOnMute(r,"ranges",r.ranges?r.ranges:[]),o.setSheetPropertyOnMute(r,"rows",r.rows&&he([],r.rows,null,!0)||[]),o.setSheetPropertyOnMute(r,"columns",r.columns||[]),o.setSheetPropertyOnMute(r,"showHeaders",Ee(r.showHeaders)?!0:r.showHeaders),o.setSheetPropertyOnMute(r,"showGridLines",Ee(r.showGridLines)?!0:r.showGridLines),o.setSheetPropertyOnMute(r,"state",r.state||"Visible"),r.maxHgts=r.maxHgts||[],r.isImportProtected=r.isProtected&&t,r.protectSettings=r.protectSettings||{selectCells:!1,formatCells:!1,formatRows:!1,formatColumns:!1,insertLink:!1},r.isProtected=r.isProtected||!1,!r.paneTopLeftCell||r.paneTopLeftCell==="A1"){r.frozenRows=r.frozenRows?r.frozenRows:0,r.frozenColumns=r.frozenColumns?r.frozenColumns:0;var n=Se(r.topLeftCell);o.setSheetPropertyOnMute(r,"paneTopLeftCell",et(r.frozenRows?n[0]+r.frozenRows:n[0],r.frozenColumns?n[1]+r.frozenColumns:n[1]))}Vy(r.columns),U6(r.rows,t)}),Vy(i,!0,o)}function U6(o,e){o.forEach(function(t){t&&t.cells&&Vy(t.cells,null,void 0,e)}),Vy(o,null,void 0,e)}function Vn(o,e){return e===void 0&&(e=o.activeSheetIndex),ke(o,e).name}function _y(o,e,t,i,r){var n=!!t;t=t||[o.activeSheetIndex];var s=Vn(o);e=W6(o.sheets,e,o.activeSheetIndex>e);var a={action:"moveSheet",eventArgs:{position:e,sheetIndexes:t,cancel:!1}};i&&o.trigger("actionBegin",a),a.eventArgs.cancel||(o.notify(Ox,{prevIndex:o.activeSheetIndex,currentIndex:e}),t.forEach(function(l,h){o.sheets.splice(e+h,0,o.sheets.splice(l+(e>l?-1*h:0),1)[0])}),o.setProperties({activeSheetIndex:r?yt(o,s):e>t[0]?e-(t.length-1):e},!0),o.notify(Ly,{refresh:n}),i&&(delete a.eventArgs.cancel,o.trigger("actionComplete",a)))}function KI(o,e,t,i){e=Ee(e)?o.activeSheetIndex:e;var r={action:"duplicateSheet",eventArgs:{sheetIndex:e,cancel:!1}};if(t&&o.trigger("actionBegin",r),!r.eventArgs.cancel){var n=ke(o,e),s=he({},n.properties?n.properties:n,{},!0);s.id=hO(o.sheets);var a=s.name;/^\(\d+\)$/.test("("+a.split(" (")[1])&&(a=a.split(" (")[0]);var l=[];o.sheets.forEach(function(u){l.push(u.name)});for(var h=2;;h++)if(l.indexOf(a+" ("+h+")")===-1){s.name=a+" ("+h+")";break}o.notify(Lx,{sheetIndex:e,newSheetIndex:e+1}),o.notify(mu,{isDuplicate:!0,curSheetIndex:e,newSheetIndex:e+1}),o.createSheet(e+1,[s]),o.notify(xt,{action:"addSheet",sheetName:"Sheet"+s.id,visibleName:s.name,sheetId:s.id}),i||o.setProperties({activeSheetIndex:e+1},!0),o.notify(Ly,{refresh:!0,isDuplicate:!0}),t&&(delete r.eventArgs.cancel,o.trigger("actionComplete",r))}}function W6(o,e,t){for(var i=e;t?i>=0:i<o.length;t?i--:i++)if(!(o[i].state==="Hidden"||o[i].state==="VeryHidden")){e=i;break}return e}var q6=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ax=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n};function G(o,e,t,i,r){var n=Ar(t,o);if(!n||!n.cells)if(i)n?t.rows[o].cells=[]:t.rows[o]={cells:[]};else return r?{}:null;return t.rows[o].cells[e]||(r?{}:null)}function oi(o,e,t,i,r,n){t.rows[o]?t.rows[o].cells||(t.rows[o].cells=[]):t.rows[o]={cells:[]},r&&t.rows[o].cells[e]&&!n?he(t.rows[o].cells[e],i,null,!0):t.rows[o].cells[e]=i}function ZI(o,e){var t={fontFamily:"Calibri",verticalAlign:"bottom",textIndent:"0pt",backgroundColor:"#ffffff",color:"#000000",textAlign:"left",fontSize:"11pt",fontWeight:"normal",fontStyle:"normal",textDecoration:"none",border:"",borderLeft:"",borderTop:"",borderRight:"",borderBottom:""},i={},r;return Object.keys(e?t:o).forEach(function(n){r=o[""+n],r!==t[""+n]&&(i[""+n]=r)}),i}function vd(o,e,t,i,r){e===void 0&&(e=!0);for(var n=t.getAddressInfo(o),s=n.indices,a=ke(t,n.sheetIndex),l=n.sheetIndex===t.activeSheetIndex,h=!i,u=s[0];u<=s[2];u++)for(var c=s[1];c<=s[3];c++)h=sr(t,a,{cell:{wrap:e},rowIdx:u,colIdx:c,preventEvt:i}),!h&&l&&t.notify(Xa,{range:[u,c,u,c],wrap:e,sheet:a,initial:!0,isPublic:r});t.setProperties({sheets:t.sheets},!0)}function pl(o){var e;if(o.indexOf("[")>-1){var t=o.split("[")[1].split("]")[0],i=Bx();i.indexOf(t)>-1&&(e=t)}return e}function Bx(){return["Black","Blue","Cyan","Green","Magenta","Red","White","Yellow"]}function qs(o,e,t,i){var r;if(o.includes('"')){var n=o.split(";"),s,a;n.forEach(function(l,h){for(var u=0;u<l.length;u++)if(l[u]==='"'&&l[u-1]!=="\\"){s=u;do s=l.indexOf('"',s+1),a=l[s-1];while(a==="\\"||a==="_"||a==="*");if(s===-1)break;l=l.substring(0,u)+l.substring(s+1),u--}n[h]=l}),o=n.join(";")}return(o.includes("d")||o.includes("y"))&&!o.includes("#")&&!pl(o)&&(t&&(t.type="date"),i&&o.includes(" ")&&o.split(" ").length===2?o=o.split(" ")[1]:e=!1,r=!0),e&&(o.includes("h")||o.includes("m")||o.includes("s"))&&!o.includes("#")&&!pl(o)&&(t&&(t.type=t.type||"",t.type+="time"),r=!0),r}var G6=function(o){q6(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return ax([C(0)],e.prototype,"chunkSize",void 0),ax([C(3)],e.prototype,"retryCount",void 0),ax([C(500)],e.prototype,"retryAfterDelay",void 0),e}(Re),JI=function(){function o(e){this.parent=e,this.requestedInfo=[],this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(ah,this.updateSheetFromDataSourceHandler,this),this.parent.on(ly,this.dataSourceChangedHandler,this),this.parent.on(ry,this.dataChangedHandler,this),this.parent.on(yf,this.triggerDataChangeHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ah,this.updateSheetFromDataSourceHandler),this.parent.off(ly,this.dataSourceChangedHandler),this.parent.off(ry,this.dataChangedHandler),this.parent.off(yf,this.triggerDataChangeHandler))},o.prototype.updateSheetFromDataSourceHandler=function(e){var t=this,i,r,n,s,a,l,h=[],u=[],c,d,p=new kn,f,v,m;e.promise=p.promise;var y,S=e.autoDetectFormat,b=S&&Nf(this.parent);if(e.sheet&&e.sheet.ranges.length)for(var w,I=function(D){var A=e.sheet.ranges[D];y=J(A.startCell),e.loadFromStartCell&&(e.indexes=y);var L=e.indexes[0],T=e.indexes[2];f=y[0],l=A.dataSource instanceof re?A.dataSource:A.dataSource?new re(A.dataSource):new re,a=a||l.dataSource.url,e.sheet.isLocalData=!l.dataSource.url,f<=L?L=L-f:f<=T?(T=T-f,L=0):L=-1,A.showFieldAsHeader&&L!==0&&(L-=1);var k=!1,F=0;x.initRangeInfo(A);var R=x.getMaxCount(A);if(m=x.getLoadedInfo(L,T,A),L=m.unloadedRange[0],T=m.unloadedRange[1],A.info.insertRowRange&&(A.info.insertRowRange.forEach(function(O){F+=O[1]-O[0]+1}),L-=F,T-=F),L>=R?k=!0:T>R&&(T=R),e.loadComplete||x.requestedInfo.push({deferred:p,indexes:e.indexes,isNotLoaded:m.isNotLoaded}),L>=0&&m.isNotLoaded&&!k){u[D]=L,h[D]=!1;var N;A.fieldsOrder&&(N=[].slice.call(A.fieldsOrder));var P=(A.query?A.query:new Pe).clone();e.loadFullData||(P=P.range(L,T>=R?T:T+1)),l.executeQuery(P.requiresCount()).then(function(O){if(!(!t.parent||t.parent.isDestroyed)){if(s=O.result&&O.result.result?O.result.result:O.result,n=J(A.startCell),f=n[0],v=n[1],s&&s.length){if(A.info.count||(R=O.count,A.info.count=O.count),r=A.info.flds||N||Object.keys(s[0]),A.info.fldLen||(A.info.fldLen=r.length,A.info.flds=r),A.info.insertColumnRange){var z=0;A.info.insertColumnRange.forEach(function(ne){for(var te=ne[0];te<=ne[1];te++)te<=v?r.splice(0,0,"emptyCell"+z):r.splice(te-v,0,"emptyCell"+z),z++})}u[D]===0&&A.showFieldAsHeader&&(c=f+u[D]+F,r.forEach(function(ne,te){i=G(c,v+te,e.sheet,!0),i?ne.includes("emptyCell")||(i.value=ne):e.sheet.rows[f+u[D]].cells[v+te]=ne.includes("emptyCell")?{}:{value:ne}})),s.forEach(function(ne,te){c=f+u[D]+te+(A.showFieldAsHeader?1:0)+F,r.forEach(function(oe,ae){d=v+ae,i=G(c,d,e.sheet,!0),i?(w=i.value,oe.includes("emptyCell")||oi(c,d,e.sheet,t.getCellDataFromProp(ne[oe]),!0)):(w=void 0,i=e.sheet.rows[c].cells[d]=oe.includes("emptyCell")?{}:t.getCellDataFromProp(ne[oe])),S&&b(i),e.updateDependentCellsCallback&&w!==i.value&&e.updateDependentCellsCallback(c,d)})})}else r=[];var H;f+(R||O.count)>0?H=f+(R||O.count)+(A.showFieldAsHeader?1:0)+F-1:H=e.sheet.usedRange.rowIndex;var Q=v+r.length-1<0?e.sheet.usedRange.colIndex:v+r.length-1;e.loadFullData&&(T=H);var $={rowIndex:H,colIndex:Q};if(t.parent.scrollSettings&&t.parent.scrollSettings.isFinite&&($.rowIndex=H<e.sheet.rowCount?H:e.sheet.rowCount-1,$.colIndex=Q<e.sheet.colCount?Q:e.sheet.colCount-1),e.sheet.usedRange.rowIndex<$.rowIndex&&t.parent.setSheetPropertyOnMute(e.sheet,"usedRange",{rowIndex:$.rowIndex,colIndex:e.sheet.usedRange.colIndex}),e.sheet.usedRange.colIndex<$.colIndex&&t.parent.setSheetPropertyOnMute(e.sheet,"usedRange",{rowIndex:e.sheet.usedRange.rowIndex,colIndex:$.colIndex}),F?(m=t.getLoadedInfo(L,T,A),L=m.unloadedRange[0],T=m.unloadedRange[1],L>R&&(m.isNotLoaded=!1),m.isNotLoaded&&(T>R&&(T=R),A.info.loadedRange.push([L,T]))):A.info.loadedRange.push([L,T]),h[D]=!0,h.indexOf(!1)===-1){var U=void 0;if(T+f<f+A.info.count){e.rangeSettingCount||(e.rangeSettingCount=[]),e.rangeSettingCount.push(D),U=!0;var ie={sheet:e.sheet,indexes:[0,0,H,Q],promise:new Promise(function(ne){ne(function(){}())}),rangeSettingCount:e.rangeSettingCount,loadComplete:e.loadComplete,autoDetectFormat:e.autoDetectFormat,resolveAfterFullDataLoaded:e.resolveAfterFullDataLoaded};t.updateSheetFromDataSourceHandler(ie),ie.promise.then(function(){t.parent.getModuleName()!=="workbook"&&(e.rangeSettingCount.pop(),e.rangeSettingCount.length||t.parent.notify("created",null),e.formulaCellRef?t.notfyFormulaCellRefresh(e.formulaCellRef,e.sheetIndex):e.loadComplete&&e.loadComplete())})}else e.formulaCellRef?t.notfyFormulaCellRefresh(e.formulaCellRef,e.sheetIndex):e.loadComplete&&e.loadComplete();U&&e.resolveAfterFullDataLoaded||(t.checkResolve(e.indexes),e.resolveAfterFullDataLoaded&&t.checkResolve([0,0,0,0]))}}})}else D===0&&h.indexOf(!1)===-1&&(e.loadComplete&&e.loadComplete(),x.checkResolve(e.indexes))},x=this,M=e.sheet.ranges.length-1;M>=0;M--)I(M);else p.resolve()},o.prototype.notfyFormulaCellRefresh=function(e,t){this.parent.formulaRefCell=null,this.parent.notify(au,{indexes:J(e),sheetIndex:t,refreshing:!0})},o.prototype.checkResolve=function(e){var t,i,r=0;this.requestedInfo.forEach(function(n,s){i=JSON.stringify(n.indexes)===JSON.stringify(e),(i||t)&&(s===0?(n.deferred.resolve(),r++,t=!0):t&&(n.isLoaded||!n.isNotLoaded)||i&&t?(n.deferred.resolve(),r++):i?n.isLoaded=!0:t=!1)}),this.requestedInfo.splice(0,r)},o.prototype.getCellDataFromProp=function(e){var t={};return Object.prototype.toString.call(e)==="[object Object]"?e.formula?t.formula=e.formula:g(e.value)||(typeof e.value=="string"&&(e.value.indexOf("http://")===0||e.value.indexOf("https://")===0||e.value.indexOf("ftp://")===0||e.value.indexOf("www.")===0)?(t.hyperlink=e.value,t.style={textDecoration:"underline",color:"#00e"}):t.value=e.value):ut(e)?t.formula=e:typeof e=="string"&&(e.indexOf("http://")===0||e.indexOf("https://")===0||e.indexOf("ftp://")===0||e.indexOf("www.")===0)?(t.hyperlink=e,t.style={textDecoration:"underline",color:"#00e"}):t.value=e,t},o.prototype.getLoadedInfo=function(e,t,i){var r=!0;return i.info.loadedRange.forEach(function(n){n[0]<=e&&e<=n[1]?n[0]<=t&&t<=n[1]?r=!1:e=n[1]+1:n[0]<=t&&t<=n[1]&&(t=n[0]-1)}),{isNotLoaded:r,unloadedRange:[e,t]}},o.prototype.getMaxCount=function(e){if(e.query){for(var t=e.query.queries,i=0;i<t.length;i++)if(t[i].fn==="onTake")return Math.min(t[i].e.nos,e.info.count||t[i].e.nos)}return e.info.count},o.prototype.initRangeInfo=function(e){e.info||(e.info={loadedRange:[]})},o.prototype.dataSourceChangedHandler=function(e){var t=this,i,r=this.parent.sheets[e.sheetIdx],n=r.ranges[e.rangeIdx];if(n&&(this.checkRangeHasChanges(r,e.rangeIdx)||!n.info)){var s=n.showFieldAsHeader,a=Se(n.startCell);n.info&&(n.info.loadedRange.forEach(function(h){for(var u=h[0];u<=h[1]&&u<n.info.count+(s?1:0);u++)if(i=r.rows[u+a[0]],i)for(var c=a[1];c<a[1]+n.info.fldLen;c++)i.cells&&i.cells[c]&&delete i.cells[c]}),n.info=null);var l={sheet:r,indexes:[0,0,r.rowCount-1,r.colCount-1],loadFullData:!0,promise:new Promise(function(h){h(function(){}())})};this.updateSheetFromDataSourceHandler(l),l.promise.then(function(){t.parent.trigger("dataSourceChanged",{data:e.changedData,action:"dataSourceChanged",rangeIndex:e.rangeIdx,sheetIndex:e.sheetIdx}),t.parent.notify(au,{sheetIndex:e.sheetIdx,checkWrap:!0,checkCF:!0})})}},o.prototype.checkRangeHasChanges=function(e,t){return this.parent.isAngular?e.changedRangeIdx===t?(delete e.changedRangeIdx,!0):!1:!0},o.prototype.dataChangedHandler=function(e){var t=this,i=[{}],r,n,s,a,l,h,u,c=e.sheetIdx===void 0?this.parent.activeSheetIndex:e.sheetIdx,d=this.parent.sheets[c],p,f;d.ranges.forEach(function(v,m){if(v.dataSource){var y=void 0;if(a=Se(v.startCell),s=a.concat([a[0]+v.info.count+(v.showFieldAsHeader?0:-1),a[1]+v.info.fldLen-1]),e.modelType==="Row"||e.modelType==="Column")if(e.modelType==="Column"){if(e.insertType)l=s[1]<e.index&&s[3]>=e.index,p=[e.index],l?(e.model.forEach(function(){v.info.flds.splice(e.index-a[1],0,"")}),v.info.fldLen+=e.model.length):s[3]+1===e.index&&e.insertType==="after"?(e.model.forEach(function(){v.info.flds.splice(e.index-a[1],0,"")}),v.info.fldLen+=e.model.length):s[1]>=e.index&&(v.startCell=et(a[0],a[1]+e.model.length));else if(l=s[1]<=e.startIndex&&s[3]>=e.startIndex,l)for(var S=e.startIndex;S<=e.endIndex;S++)S<=s[3]&&(v.info.flds.splice(e.startIndex,1),v.info.fldLen-=1);return}else if(e.insertType){if(l=(!v.showFieldAsHeader&&(e.insertType==="above"||e.isMethod)?s[0]<=e.index:s[0]<e.index)&&s[2]>=e.index,p=[e.index],l||s[2]+1===e.index&&e.insertType==="below"?(y=!0,v.info.count+=e.model.length):s[0]>=e.index&&(v.startCell=et(a[0]+e.model.length,a[1])),e.isMethod)return}else l=s[0]<=e.startIndex&&s[2]>=e.startIndex,e.isDataRequest?p=[e.startIndex,s[1],e.startIndex,s[1]]:r="delete";else{var b=e.address||e.range||e.fillRange;p=J(e.requestType&&e.requestType.toLowerCase().includes("paste")?e.pastedRange.substring(e.pastedRange.lastIndexOf("!")+1):e.sheetIdx>-1?e.address:b.substring(b.lastIndexOf("!")+1));var w=[v.showFieldAsHeader?s[0]+1:s[0]].concat(s.slice(1,4));if(v.showFieldAsHeader&&p[0]===a[0])for(var S=p[1];S<=p[3];S++)S>=w[1]&&S<=w[3]&&(v.info.flds[S-a[1]]=G(a[0],S,d,!1,!0).value||"");if(l=Lf(w,p,!0),e.requestType==="paste"&&e.copiedInfo.isCut){if(f=[].slice.call(e.copiedInfo.range),v.showFieldAsHeader&&f[0]===a[0]){for(var S=f[1];S<=f[3];S++)S>=w[1]&&S<=w[3]&&(v.info.flds[S-a[1]]="");l=!1}h=Lf(w,f,!0)}}if(l||y||h){if(e.modelType==="Row"&&!e.insertType&&!e.isDataRequest){if(e.deletedModel.forEach(function(T,k){i[k]={},v.info.flds.forEach(function(F,R){T.cells?(n=T.cells[a[1]+R],i[k][""+F]=t.getFormattedValue(n)):i[k][""+F]=null}),v.info.count-=1}),e.isMethod)return;u={count:e.deletedModel.length,index:e.endIndex}}else{r=y?"add":"edit";var I=0;if(h){I=f[2]-f[0]+1;for(var x=function(T){i[T]={},v.info.flds.forEach(function(k,F){k&&(n=G(f[0]+T,a[1]+F,d),i[T][""+k]=t.getFormattedValue(n))})},S=0;S<I;S++)x(S)}if(l||y)for(var M=!e.isDataRequest&&!h&&!y&&!e.skipFilterCheck,D=function(T,k){if(M&&Jn(d,p[0]+T))return A=k,"continue";i[k+I]={},v.info.flds.forEach(function(F,R){F&&(n=G(p[0]+T,a[1]+R,d),i[k+I][""+F]=t.getFormattedValue(n))}),k++,A=k},A,S=0,L=0;S<(y?e.model.length:p[2]-p[0]+1||1);S++)D(S,L),L=A}e.isDataRequest?e.data=i:t.parent.trigger("dataSourceChanged",{data:i,action:r,rangeIndex:m,sheetIndex:c})}else u&&u.count&&s[0]>u.index&&(v.startCell=et(a[0]-u.count,a[1]))}})},o.prototype.getFormattedValue=function(e){var t=this.parent.getDisplayText(e);return t===""?null:e&&!e.format&&typeof e.value=="number"?e.value:t},o.prototype.triggerDataChangeHandler=function(e){var t=["insert","delete","edit","cellDelete","cellSave","autofill","clipboard","clear"],i=!0;if(((e.action==="delete"||e.action==="insert")&&["Sheet"].indexOf(e.eventArgs.modelType)>-1||e.action==="clear"&&["Clear Formats","Clear Hyperlinks"].indexOf(e.eventArgs.type)>-1||e.action==="clipboard"&&e.eventArgs.requestType==="Formats")&&(i=!1),i&&t.indexOf(e.action)>-1){var r=void 0;e.isUndo&&(e.action==="delete"||e.action==="insert")?(r=he({},e.eventArgs),e.action==="delete"?(r.index=r.startIndex,r.model=r.deletedModel,r.insertType="below"):(r.startIndex=r.index,r.endIndex=e.eventArgs.index+e.eventArgs.model.length-1,r.deletedModel=r.model,delete r.insertType)):r=e.eventArgs,this.parent.notify(ry,r)}},o.prototype.getModuleName=function(){return"dataBind"},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null,this.requestedInfo=[]},o}(),fl="ribbon",Ff="formulaBar",Uy="sheetTabs",rh="refreshSheetTabs",md="isFormulaBarEdit",In="contentLoaded",ml="mouseDown",Un="spreadsheetDestroyed",fi="editOperation",vl="formulaOperation",Ua="formulaBarOperation",yu="click",ds="keyUp",$a="keyDown";var zx="verticalScroll",jx="horizontalScroll",Wy="focusRenameInput",Hx="beforeContentLoaded",Vx="beforeVirtualContentLoaded",Wa="virtualContentLoaded";var Jh="cellNavigate",_x="mouseUpAfterSelection",bu="contextmenuBeforeOpen",Ux="insertSheetTab",qy="removeSheetTab",Wx="renameSheetTab",Of="ribboClick";var da="enableToolbarItems",qx="tabSwitch",Su="selectRange",Gx="rangeSelectionByKeydown",Cu="cut",wu="copy",Ga="paste",yd="clearCopy",Y6="dataBound",Q6="beforeDataBound",Yx="addContextMenuItems",Qx="removeContextMenuItems",Xx="enableContextMenuItems",$x="enableFileMenuItems",Kx="hideFileMenuItems",Zx="addFileMenuItems",Jx="hideRibbonTabs",eI="enableRibbonTabs",tI="addRibbonTabs",iI="addToolbarItems",rI="hideToolbarItems",nI="beforeRibbonCreate",An="rowHeightChanged",_n="colWidthChanged",sI="onContentScroll",xu="deInitProperties",Iu="activeSheetChanged",Gy="initiateCustomSort",Mu="applySort";var aI="autoFitRowsColumns",Yy="refreshFilterCellsOnResize",eu="updateToggleItem",Rf="initiateHyperlink",Pf="editHyperlink",oI="openHyperlink",Qy="addNote",Xy="editNote",Bf="deleteNote",ed="showNote",bd="createNoteIndicator",lI="updateNoteContainer",iu="removeNoteContainer",zf="removeHyperlink",hI="createHyperlinkElement",$y="sheetNameUpdate",Ky="hideSheet",Ka="performUndoRedo",Zy="updateUndoRedoCollection",hh="setActionData",ox="getBeforeActionData",uh="clearUndoRedoCollection",Eo="initiateFilterUI",qc="renderFilterCell",Jy="refreshFilterRange",eb="reapplyFilter",uI="filterByCellValue",jf="clearFilter",tb="getFilteredColumn",mt="actionComplete",ib="filterCellKeyDown",Du="getFilterRange",cI="setAutoFit",dI="refreshFormulaDatasource",pI="initiatedatavalidation";var Hf="invalidData";var ru="protectSheet",df="applyProtect";var fI="protectCellFormat",gI="renderGotoDlgt",vI="renderFindDlg",uf="findHandler",lx="created",mI="spreadsheetCreated",ba="editAlert",nr="readonlyAlert",rb="finiteAlert",yI="setUndoRedo",bI="enableFormulaInput",nb="protectSelection",sb="hiddenMerge",SI="checkPrevMerge",ab="checkMerge",Vf="removeDataValidation",yl="showAggregate",CI="goToSheet",wI="showSheet",xI="renderCFDlg",_f="clearViewer",dl="initiateFormulaReference",ob="initiateCur",II="clearCellRef",lb="editValue",gl="addressHandle",MI="initiateEdit",Gc="forRefSelRender",DI="insertImage",td="refreshOverlayElem",Sd="refreshImgCellObj",Ys="getRowIdxFromClientY",Qs="getColIdxFromClientX",Ya="createImageElement",ga="deleteImage",Eu="deleteChart",ou="refreshChartCellObj",hb="refreshChartCellModel",ub="refreshImagePosition",EI="updateTableWidth",Yc="focusBorder",cb="clearChartBorder",AI="insertChart",Qc="chartRangeSelection",Uf="insertDesignChart",Ao="removeDesignChart",lu="chartDesignTab",WF="addChartEle",TI="undoRedoForChartDesign",db="protectWorkbook",pb="unProtectWorkbook",LI="setProtectWorkbook",kI="removeWorkbookProtection",NI="importProtectWorkbook",Wf="selectionStatus",vf="freeze",FI="overlayEleSize",fb="updateScroll",Za="positionAutoFillElement",gb="hideAutoFillOptions",vb="performAutoFill",OI="selectAutoFillRange";var nh="hideAutoFillElement",RI="unProtectSheetPassword",hu="updateTranslate",PI="getUpdatedScrollPosition",mb="updateScrollValue",qF="beforeCheckboxfilterRenderer",GF="refreshCheckbox",BI="renderInsertDlg",yb="toggleProtect",zI="propertyChange",jI="updateWrapCell",uO=function(){function o(e){this.loopIndex=0,this.processedLoopIndex=0,this.retryCount=0,this.currentDocumentId=null,this.parent=e,this.addEventListener()}return o.prototype.open=function(e){this.load(e)},o.prototype.load=function(e,t){var i=this;if(this.parent.allowOpen){if(e.jsonObject){this.fetchSuccess(e.jsonObject,e,null,!0,!0);return}var r=new FormData;if(e.file)r.append("file",e.file);else if(e.sheetIndex>=0)r.append("sheetPassword",e.sheetPassword),r.append("sheetIndex",e.sheetIndex.toString());else{this.parent.isOpen=!1;return}var n={passWord:""};e.password&&e.password.length&&(n.passWord=e.password),n.passWord&&n.passWord.length&&(e.password=n.passWord),e.password&&r.append("password",e.password),r.append("IsManualCalculationEnabled",(this.parent.calculationMode==="Manual").toString());var s={file:e.file||null,cancel:!1,requestData:{method:"POST",body:r},password:n.passWord},a=e.guid;if(g(e.sheetPassword)&&!a&&g(t)?(this.parent.trigger("beforeOpen",s),this.parent.notify(ai,{eventArgs:s,action:"beforeOpen"})):a&&r.append("guid",a),s.cancel){this.parent.isOpen=!1;return}var l={chunkSize:null,documentId:null};this.parent.openSettings.chunkSize>0&&g(e.sheetPassword)&&(this.setToDefaults(t),!g(this.parent.openSettings.chunkSize)&&this.parent.openSettings.chunkSize!==0&&(l.chunkSize=this.parent.openSettings.chunkSize.toString()),g(this.currentDocumentId)||(l.documentId=this.currentDocumentId),g(l)||r.append("chunkPayload",JSON.stringify(l))),fetch(this.parent.openUrl,s.requestData).then(function(h){return h.ok?h.json():Promise.reject({status:h.status,statusText:h.statusText,url:h.url})}).then(function(h){return i.fetchSuccess(h,s,e.orginalFile,void 0,!0)}).catch(function(h){h.toString().indexOf("Unexpected end of JSON input")===-1&&i.parent.openSettings.chunkSize>0&&i.retryCount<i.parent.openSettings.retryCount?setTimeout(function(){i.retryCount++,i.load(e,!0)},i.parent.openSettings.retryAfterDelay):(i.retryCount>=i.parent.openSettings.retryCount&&(i.retryCount=0),i.fetchFailure(h))})}},o.prototype.fetchFailure=function(e){Ee(e.status)&&Ee(e.statusText)&&(e.statusText="Improper response"),this.parent.notify(mx,e),this.parent.isOpen=!1},o.prototype.fetchSuccess=function(e,t,i,r,n){var s=["UnsupportedFile","InvalidUrl","NeedPassword","InCorrectPassword","InCorrectSheetPassword","CorrectSheetPassword","DataLimitExceeded","FileSizeLimitExceeded","ExternalWorkbook"],a=typeof e=="string"?JSON.parse(e):e,l=a.Workbook;if(g(l)){var h=a.chunkTotalCount;this.currentDocumentId=a.documentId,this.chunkList=new Array(h);var u=0,c=h>this.parent.openSettings.chunkSize?this.parent.openSettings.chunkSize:h,d=0;this.processedLoopIndex=0;var p="",f=this;if(!g(h))for(;u<h;)f.processChunk(u,c,d,p,t,i,r,n),u+=f.parent.openSettings.chunkSize,c=u+f.parent.openSettings.chunkSize<h?f.parent.openSettings.chunkSize:h-u,d++,f.processedLoopIndex++}else{if(s.indexOf(l)>-1){i&&(t.file=i),this.parent.notify(fy,{context:this,data:l,guid:a.Guid,eventArgs:t,isOpenFromJson:r});return}this.updateModel(l,r,n),this.parent.notify(fy,{context:this,data:l,isOpenFromJson:r,eventArgs:t}),this.parent.isOpen=!1,t&&t.password&&t.password.length>0&&(this.parent.showSheetTabs&&(this.parent.element.querySelector(".e-add-sheet-tab").removeAttribute("disabled"),this.parent.element.querySelector(".e-add-sheet-tab").classList.remove("e-disabled")),this.parent.password="")}},o.prototype.processChunk=function(e,t,i,r,n,s,a,l){var h=this,u={currentChunk:e.toString(),chunkSize:t.toString(),loopIndex:i.toString(),documentId:this.currentDocumentId},c=new FormData;c.append("chunkPayload",JSON.stringify(u));var d={file:s||null,cancel:!1,requestData:{method:"POST",body:c},password:n.password};fetch(this.parent.openUrl,d.requestData).then(function(p){return p.ok?p.json():Promise.reject({status:p.status,statusText:p.statusText,url:p.url})}).then(function(p){if(p!==""){for(var f=atob(p.chunk),v=new Uint8Array(f.length),m=0;m<f.length;m++)v[m]=f.charCodeAt(m);if(f=new TextDecoder("utf-8").decode(v),h.chunkList[p.loopIndex]=f,h.loopIndex++,h.loopIndex===h.processedLoopIndex){for(var y=h.chunkList.splice(0,h.loopIndex),S=0;S<y.length;S++)r+=y.slice(S,S+1).join("");p=JSON.parse(r),h.setToDefaults(),h.fetchSuccess(p,n,s,a,l)}}}).catch(function(p){if(g(h.currentFailedChunkIndex)||h.currentFailedChunkIndex===e)if(h.currentFailedChunkIndex=e,h.retryCount<h.parent.openSettings.retryCount)setTimeout(function(){h.processedLoopIndex=i,h.processChunk(e,t,i,r,n,s,a,l),h.retryCount++},h.parent.openSettings.retryAfterDelay);else return h.retryCount=0,h.fetchFailure(p)})},o.prototype.setToDefaults=function(e){this.currentFailedChunkIndex=null,e||(this.retryCount=0),this.loopIndex=0,this.processedLoopIndex=0,this.chunkList=[]},o.prototype.updateModel=function(e,t,i){this.parent.notify(xt,{action:"unRegisterSheet"}),this.setSelectAllRange(e.sheets,t),this.parent.sheetNameCount=1,this.parent.sheets=[],this.parent.notify(ma,{}),this.parent.notify(uh,null),e.activeSheetIndex=e.activeSheetIndex||e.sheets.findIndex(function(r){return r.state!=="Hidden"}),this.parent.setProperties({isProtected:e.isProtected||!1,password:e.password||"",sheets:e.sheets,activeSheetIndex:e.activeSheetIndex,definedNames:e.definedNames||[],filterCollection:e.filterCollection||[],sortCollection:e.sortCollection||[],listSeparator:e.listSeparator||this.parent.listSeparator},!0),g(e.showSheetTabs)||(this.parent.showSheetTabs=e.showSheetTabs),cf(this.parent,void 0,i),this.parent.notify(xf,null),this.parent.notify(xt,{action:"registerSheet",isImport:!0}),this.parent.notify(xt,{action:"initiateDefinedNames"}),this.parent.notify(Mx,null)},o.prototype.setSelectAllRange=function(e,t){var i=this,r,n;e.forEach(function(s){if(s.selectedRange){var a=J(s.selectedRange),l=(Ee(s.rowCount)?100:s.rowCount)-1,h=(Ee(s.colCount)?100:s.colCount)-1;a[2]===65535&&(a[2]=l),a[3]===255&&(a[3]=h),a[0]===65535&&(a[0]=l),a[1]===255&&(a[1]=h),s.selectedRange=Be(a)}if(t&&i.parent.isAngular){for(var u=0;u<i.parent.sheets.length;u++)if(r=ke(i.parent,u),s.name===r.name){s.ranges&&s.ranges.forEach(function(c,d){n=r.ranges[d],n&&n.template&&(c.template=n.template)});break}}})},o.prototype.sheetsDestroyHandler=function(e){g(e.sheetIndex)&&(this.preventFormatCheck=null)},o.prototype.addEventListener=function(){this.parent.on(hy,this.open.bind(this)),this.parent.on(ma,this.sheetsDestroyHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(hy,this.open.bind(this)),this.parent.off(ma,this.sheetsDestroyHandler))},o.prototype.destroy=function(){this.removeEventListener(),this.parent.refreshing||(this.preventFormatCheck=null),this.parent=null},o.prototype.getModuleName=function(){return"workbookOpen"},o}(),X6=function(){function o(e){this.parent=e}return o.prototype.processSheet=function(e,t){var i=JSON.parse(e,function(r,n){if(!((Array.isArray(n)||typeof n=="string")&&!n.length))return n});return[t,i]},o.prototype.processSave=function(e,t,i,r,n){var s=this,a=new FormData,l,h=Object.keys(t);for(a.append("JSONData",JSON.stringify(e)),l=0;l<h.length;l++)a.append(h[l],t[h[l]]);for(h=Object.keys(i),l=0;l<h.length;l++)a.append(h[l],i[h[l]]);a.append("pdfLayoutSettings",JSON.stringify(r)),fetch(t.url,{method:"POST",body:a}).then(function(u){return u.ok?u.blob():Promise.reject({message:u.statusText})}).then(function(u){new Promise(function(c){var d=new FileReader;d.onload=function(){var p=d.result.toString(),f=i.customParams&&typeof i.customParams=="string"&&i.customParams.toLowerCase()==="saveashtml";if(p.indexOf("data:text/plain;base64,")>-1||!f&&p.indexOf("data:text/html;base64,")>-1||p.indexOf("data:application/json;base64,")>-1){var v=void 0;if(p=p.replace("data:text/plain;base64,",""),p=p.replace("data:text/html;base64,",""),p.indexOf("data:application/json;base64,")>-1?(p=p.replace("data:application/json;base64,",""),v=atob(p).split(".")):v=atob(p).split(/(\r\n|\n|\r)/gm),v.length){var m=v[0].length>1&&v[0][0]==='"'?v[0].split('"')[1]+".":v[0];n?n.apply(s,[{dialog:m}]):postMessage({dialog:m})}}else n?n.apply(s,[u]):postMessage(u);c(d.result)},d.readAsDataURL(u)})}).catch(function(u){n?n.apply(s,[{error:u.message}]):postMessage({error:u.message})})},o}(),$6=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),HI=function(){return HI=Object.assign||function(o){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r])}return o},HI.apply(this,arguments)},cO=function(o){$6(e,o);function e(t){var i=o.call(this,t)||this;return i.isProcessCompleted=!1,i.saveJSON={},i.isFullPost=!1,i.needBlobData=!1,i.customParams=null,i.pdfLayoutSettings={fitSheetOnOnePage:!1},i.addEventListener(),i}return e.prototype.getModuleName=function(){return"workbookSave"},e.prototype.destroy=function(){this.removeEventListener(),this.parent=null},e.prototype.addEventListener=function(){this.parent.on(bf,this.initiateSave,this),this.parent.on("getStringifyObject",this.performStringifyAction,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(bf,this.initiateSave),this.parent.off("getStringifyObject",this.performStringifyAction))},e.prototype.initiateSave=function(t){var i=t.saveSettings;this.saveSettings={saveType:i.saveType,url:i.url,fileName:i.fileName||"Sample"},this.isFullPost=t.isFullPost,this.needBlobData=t.needBlobData,this.needBlobData&&(this.isFullPost=!1),this.customParams=t.customParams,this.pdfLayoutSettings=t.pdfLayoutSettings,this.updateBasicSettings(),this.processSheets(i.autoDetectFormat,t.jsonConfig)},e.prototype.updateBasicSettings=function(){var t=this.getStringifyObject(this.parent,["sheets","_isScalar","observers","closed","isStopped","hasError","__isAsync","beforeCellFormat","beforeCellRender","beforeDataBound","beforeOpen","beforeSave","beforeSelect","beforeSort","cellEdit","cellEdited","cellEditing","cellSave","beforeCellSave","contextMenuItemSelect","contextMenuBeforeClose","contextMenuBeforeOpen","created","dataBound","fileMenuItemSelect","fileMenuBeforeClose","fileMenuBeforeOpen","saveComplete","sortComplete","select","actionBegin","actionComplete","afterHyperlinkClick","afterHyperlinkCreate","beforeHyperlinkClick","beforeHyperlinkCreate","openComplete","openFailure","queryCellInfo","dialogBeforeOpen","dataSourceChanged","beforeConditionalFormat","beforeCellUpdate"]),i=JSON.parse(t),r=this.parent.sheets.length;r&&(i.sheets=[]),this.saveJSON=i,this.saveJSON.filterCollection=[]},e.prototype.processSheets=function(t,i){var r=this,n=["dataSource","startCell","query","showFieldAsHeader","result"];if(this.parent.isAngular&&n.push("template"),i)if(i.onlyValues)n.push.apply(n,["style","formula","format","conditionalFormats","validation","hyperlink","wrap","chart","image","notes"]);else{var s={style:i.ignoreStyle,formula:i.ignoreFormula,format:i.ignoreFormat,conditionalFormats:i.ignoreConditionalFormat,validation:i.ignoreValidation,wrap:i.ignoreWrap,chart:i.ignoreChart,image:i.ignoreImage,notes:i.ignoreNote};i.ignoreFreezePane&&n.push.apply(n,["frozenColumns","frozenRows"]);for(var a in s)s[a]&&n.push(a)}for(var l,h,u,c,d=0,p=this.parent.sheets.length;d<p;d++){u=this.parent.sheets[d],l=!1,h=!1;for(var f=0,v=u.ranges.length;f<v;f++)if(c=u.ranges[f],c.dataSource&&(h=!0,!c.info||!c.info.loadedRange||!c.info.loadedRange.length)){l=!0;break}if(l){var m=function(y){rx(r,r.processSheet,r.updateSheet,[r.getStringifyObject(r.parent.sheets[y],n,y,!1,!0),y],null,r.parent)};this.parent.notify(ah,{sheet:u,sheetIndex:d,loadComplete:m.bind(this,d),loadFromStartCell:!0,autoDetectFormat:t})}else rx(this,this.processSheet,this.updateSheet,[this.getStringifyObject(u,n,d,t&&h,!0),d],null,this.parent)}},e.prototype.updateSheet=function(t){this.saveJSON.sheets[t[0]]=t[1],this.isProcessCompleted=this.getSheetLength(this.saveJSON.sheets)===this.parent.sheets.length,this.isProcessCompleted&&this.save(this.saveSettings)},e.prototype.getSheetLength=function(t){var i=0;return t.forEach(function(r){r&&i++}),i},e.prototype.save=function(t){var i={cancel:!1,jsonObject:this.saveJSON};this.parent.notify(Sx,i),i.cancel||(this.isFullPost?(this.initiateFullPostSave(),this.saveJSON={}):rx(this,{workerTask:this.processSave},this.updateSaveResult,[this.saveJSON,t,this.customParams,this.pdfLayoutSettings],!0,this.parent))},e.prototype.updateSaveResult=function(t){if(t.isFormDataError){this.processSave(this.saveJSON,this.saveSettings,this.customParams,this.pdfLayoutSettings,this.updateSaveResult);return}this.saveJSON={};var i={status:"Success",message:"",url:this.saveSettings.url,fileName:this.saveSettings.fileName,saveType:this.saveSettings.saveType,blobData:null};typeof t=="object"&&t.error?(i.status="Failure",i.message=t.error.toString()):typeof t=="object"&&t.dialog?this.parent.notify(Ax,{content:t.dialog}):this.needBlobData?i.blobData=t:this.ClientFileDownload(t),this.parent.trigger("saveComplete",i),this.parent.notify(Cf,i)},e.prototype.ClientFileDownload=function(t){var i=this.parent.createElement("a",{attrs:{download:this.getFileNameWithExtension()}}),r=URL.createObjectURL(t);i.href=r,document.body.appendChild(i),i.click(),URL.revokeObjectURL(r),document.body.removeChild(i)},e.prototype.initiateFullPostSave=function(){var t=Object.keys(this.saveSettings),i,r=this.parent.createElement("form",{attrs:{method:"POST",action:this.saveSettings.url}}),n=this.parent.createElement("input",{attrs:{type:"hidden",name:"JSONData"}});for(n.value=JSON.stringify(this.saveJSON),r.appendChild(n),i=0;i<t.length;i++)n=this.parent.createElement("input",{attrs:{type:"hidden",name:t[i]}}),n.value=this.saveSettings[t[i]],r.appendChild(n);for(t=Object.keys(this.customParams),i=0;i<t.length;i++)n=this.parent.createElement("input",{attrs:{type:"hidden",name:t[i]}}),n.value=this.customParams[t[i]],r.appendChild(n);n=this.parent.createElement("input",{attrs:{type:"hidden",name:"pdfLayoutSettings"}}),n.value=JSON.stringify(this.pdfLayoutSettings),r.appendChild(n),document.body.appendChild(r),r.submit(),ee(r),this.parent.notify(Cf,{})},e.prototype.performStringifyAction=function(t){t.model='{"jsonObject":{"Workbook":{"sheets":[';for(var i=0,r=this.parent.sheets.length-1;i<=r;i++)t.model+=this.getStringifyObject(this.parent.sheets[i],t.skipProps,i)+(i<r?",":"]}}}")},e.prototype.getStringifyObject=function(t,i,r,n,s){var a=this;i===void 0&&(i=[]),r===0&&this.parent.notify(ad,{clearAll:!0}),s&&this.parent.notify(cy,{sheetIdx:r,isSaveAction:!0,saveJson:this.saveJSON});var l=[],h,u=n&&Nf(this.parent),c=JSON.stringify(t,function(p,f){if(!(i.indexOf(p)>-1)){if(p==="cellStyle")return a.parent.commonCellStyle;if(f&&f.cells)for(var v=0,m=f.cells.length;v<m;v++){var y=f.cells[v],S=[Number(p),v];if(y&&(y.value?n&&!y.formula&&u(y):y.formula&&y.formula.indexOf("=UNIQUE(")<0&&(a.parent.calculationMode==="Automatic"&&a.parent.notify(xt,{action:"refreshCalculate",value:y.formula,rowIndex:S[0],colIndex:v,isFormula:ut(y.formula),sheetIndex:r,isRefreshing:!0}),y.value=G(S[0],v,t).value),y.chart)){l.push({index:S,chart:y.chart}),h=[];for(var b=0,w=y.chart.length;b<w;b++){var I=Object.assign({},y.chart[b]);delete I.id,h.push(I)}y.chart=h}}if(p==="validation"&&f&&typeof f.type=="string"&&f.type==="Time"&&["value1","value2"].forEach(function(D){var A=f[D]&&f[D].toString();A&&!Me(Number(A))&&(f[D]=a.getDateAsNumber({range:[],cell:{value:A}},A))}),f&&f.properties&&f.maxHgts&&(f.properties=HI({},f.properties,{maxHgts:f.maxHgts})),f&&typeof f=="object"&&f.hasOwnProperty("properties")){if(f.propName&&f.propName.toString()==="conditionalFormats"){var x=f.properties;if(x.format&&x.format.style){var M=x.format.style;M&&M.backgroundColor==="#ffffff"&&M.color==="#000000"&&M.fontWeight!=="bold"&&M.fontStyle!=="italic"&&M.textDecoration!=="underline"&&delete x.format}}return f.properties}else return f!==null?f:void 0}}),d=ke(this.parent,r);return l.forEach(function(p){oi(p.index[0],p.index[1],d,{chart:p.chart},!0)}),c},e.prototype.getDateAsNumber=function(t,i){var r={value:i,rowIndex:t.range[0],cell:t.cell,colIndex:t.range[1],sheetIndex:t.sheetIdx,updatedVal:""};return this.parent.notify(Jr,r),r.updatedVal||i},e.prototype.getFileNameWithExtension=function(t){t||(t=this.saveSettings.fileName);var i=this.getFileExtension(),r=t.lastIndexOf(".");return r>-1&&(t=t.substr(0,r)),t+i},e.prototype.getFileExtension=function(){return"."+this.saveSettings.saveType.toLowerCase()},e}(X6),W=function(o){return o[o.NA=0]="NA",o[o.Value=1]="Value",o[o.Ref=2]="Ref",o[o.DivZero=3]="DivZero",o[o.Num=4]="Num",o[o.Name=5]="Name",o[o.Null=6]="Null",o[o.Calc=7]="Calc",o}(W||{}),pe=function(o){return o[o.OperatorsCannotStartWithExpression=0]="OperatorsCannotStartWithExpression",o[o.ReservedWordAND=1]="ReservedWordAND",o[o.ReservedWordXOR=2]="ReservedWordXOR",o[o.ReservedWordIf=3]="ReservedWordIf",o[o.NumberContains2DecimalPoints=4]="NumberContains2DecimalPoints",o[o.ReservedWordElse=5]="ReservedWordElse",o[o.ReservedWordNOT=6]="ReservedWordNOT",o[o.InvalidCharInNumber=7]="InvalidCharInNumber",o[o.InvalidCharactersFollowingWithOperator=6]="InvalidCharactersFollowingWithOperator",o[o.MismatchedParentheses=8]="MismatchedParentheses",o[o.UnknownFormulaName=9]="UnknownFormulaName",o[o.RequiresASingleArgument=10]="RequiresASingleArgument",o[o.Requires3Args=11]="Requires3Args",o[o.InvalidMathArgument=12]="InvalidMathArgument",o[o.Requires2Args=13]="Requires2Args",o[o.BadIndex=14]="BadIndex",o[o.TooComplex=15]="TooComplex",o[o.CircularReference=16]="CircularReference",o[o.MissingFormula=17]="MissingFormula",o[o.ImproperFormula=18]="ImproperFormula",o[o.InvalidExpression=19]="InvalidExpression",o[o.CellEmpty=20]="CellEmpty",o[o.BadFormula=21]="BadFormula",o[o.EmptyExpression=22]="EmptyExpression",o[o.VirtualModeRequired=23]="VirtualModeRequired",o[o.MismatchedTics=24]="MismatchedTics",o[o.WrongNumberArguments=25]="WrongNumberArguments",o[o.InvalidArguments=26]="InvalidArguments",o[o.IterationsDoNotConverge=27]="IterationsDoNotConverge",o[o.CalculationOverflow=29]="CalculationOverflow",o[o.AlreadyRegistered=28]="AlreadyRegistered",o[o.MissingSheet=30]="MissingSheet",o[o.CannotParse=31]="CannotParse",o[o.ExpressionCannotEndWithAnOperator=32]="ExpressionCannotEndWithAnOperator",o[o.Spill=33]="Spill",o[o.Div=34]="Div",o}(pe||{}),dO=function(o){return o.xlsx="xlsx",o.xlsm="xlsm",o.xlsb="xlsb",o.xltx="xltx",o.xltm="xltm",o.xls="xls",o.xml="xml",o.xlam="xlam",o.xla="xla",o.xlw="xlw",o.xlr="xlr",o.prn="prn",o.txt="txt",o.csv="csv",o.dif="dif",o.slk="slk",o}(dO||{});function K6(o){switch(o){case"dd-MMM-yyyy":case"dd MMM yyyy":o="medium";break;case"MMM yyyy":o="yMMM";break;case"MM/dd/yyyy":case"dd/MM/yyyy":case"dd/MM/yy":o="short";break;case"dddd MMMM dd yyyy":case"dd MMMM yyyy":o="long";break;case"d MMMM yyyy":o="yMMMd";break;case"yyyy":o="y";break;case"h:mm":o="Hm";break;case"h:mm tt":o="hm";break;case"h":o="H";break;case"h tt":o="h";break;case"dddd":o="E";break;case"h:mm:ss tt":o="hms";break;case"h:mm:ss":o="Hms";break;case"d":o="d";break;case"d dddd":o="Ed";break;case"M":o="M";break;case"Md":o="Md";break;case"MMM":o="MMM";break;case"ddd MMM d":o="MMMEd";break;case"MMM d":o="MMMd";break;case"M/yyyy":o="yM";break;case"ddd":o="E";break;default:o="";break}return o}function Z6(o){var e=!1;for(var t in dO)if(o.indexOf("."+t+"]")>-1){e=!0;break}return e}var J6=function(){function o(e){this.formulas=[{formulaName:"SUM",category:"Math & Trig",description:"Sums individual values, cell references or ranges."},{formulaName:"SUMIFS",category:"Math & Trig",description:"Sums the cells specified by a given set of conditionsor criteria."},{formulaName:"SUMPRODUCT",category:"Math & Trig",description:"Returns sum of the product of given ranges of arrays."},{formulaName:"ABS",category:"Math & Trig",description:"Returns the absolute value of a number."},{formulaName:"RAND",category:"Math & Trig",description:"Return a random number between 0 and 1."},{formulaName:"FLOOR",category:"Math & Trig",description:"Returns the round a number down to the nearest integer."},{formulaName:"CEILING",category:"Math & Trig",description:"Returns a number rounded up to a multiple of another number."},{formulaName:"SUMIF",category:"Math & Trig",description:"It will sum up cells that meet the given criteria."},{formulaName:"PRODUCT",category:"Math & Trig",description:"Multiplies all the numbers given as arguments and returns the product."},{formulaName:"AVERAGE",category:"Statistical",description:"The sum of the numbers divided by how many numbers are being averaged."},{formulaName:"AVERAGEIF",category:"Statistical",description:"Computes the average of the numbers in a range that meet the supplied criteria."},{formulaName:"COUNT",category:"Statistical",description:"Counts the numbers in the list of arguments, exclude text entries."},{formulaName:"COUNTA",category:"Statistical",description:"Counts the non-empty values in the list of arguments."},{formulaName:"COUNTIF",category:"Statistical",description:"Counts the number of cells in a range that meet a specified condition."},{formulaName:"COUNTIFS",category:"Statistical",description:"Counts the number of times each cells in all the ranges that meet the specific conditions."},{formulaName:"AVERAGEA",category:"Statistical",description:"Calculates the average of values in the list of arguments.Arguments can be numbers, names, arrays or references."},{formulaName:"AVERAGEIFS",category:"Statistical",description:"Conditionally returns the average of the contents of cells for the set of ranges."},{formulaName:"MIN",category:"Statistical",description:"Returns the smaller number in set of arguments."},{formulaName:"MAX",category:"Statistical",description:"Returns the largest number in set of arguments."},{formulaName:"DATE",category:"Date",description:"Returns the date, given the year, month and day of the month."},{formulaName:"DAY",category:"Date",description:"Returns the day of a given date."},{formulaName:"TODAY",category:"Date",description:"Returns the current date as date value."},{formulaName:"DAYS",category:"Date",description:"Returns the number of days between two dates."},{formulaName:"WEEKDAY",category:"Date",description:"Returns the day of the week corresponding to a date."},{formulaName:"IF",category:"Logical",description:"Returns one value if a logical expression is TRUE and another if it is FALSE"},{formulaName:"AND",category:"Logical",description:"Returns TRUE if all the arguments are considered TRUE, and FALSE otherwise."},{formulaName:"IFS",category:"Logical",description:"Checks multiple conditions and returns a value corresponding to the first TRUE result."},{formulaName:"IFERROR",category:"Logical",description:"Returns a value you specify if a formula evaluates to an error; otherwise, it returns the result of the formula."},{formulaName:"CHOOSE",category:"Lookup & Reference",description:"Returns a value from a list, given an index number."},{formulaName:"INDEX",category:"Lookup & Reference",description:"Returns a value from a table, given a row and column number."},{formulaName:"FIND",category:"Text",description:"Returns the position of a string of text within another string."},{formulaName:"CONCATENATE",category:"Text",description:" Used to join two or more strings together."},{formulaName:"CONCAT",category:"Text",description:"Concatenates a list or range of text strings."},{formulaName:"SUBTOTAL",category:"Lookup & Reference",description:"Returns a subtotal in a list or database."},{formulaName:"RADIANS",category:"Math & Trig",description:"Converts degrees to radians."},{formulaName:"OR",category:"Logical",description:"Returns TRUE if any arguments considered TRUE, and all the arguments are FALSE it will return FALSE."},{formulaName:"NOT",category:"Logical",description:"Returns the inverse of a given logical expression."},{formulaName:"MATCH",category:"Lookup & Reference",description:"Returns the relative position of an checked item in range that matches a specified value in a specified order"},{formulaName:"RANDBETWEEN",category:"Math & Trig",description:"Returns an integer random number in a specified range."},{formulaName:"SLOPE",category:"Statistical",description:"Returns the slope of the line from linear regression of the data points."},{formulaName:"INTERCEPT",category:"Statistical",description:"Calculates the point of the Y-intercept line via linear regression."},{formulaName:"RSQ",category:"Statistical",description:"Returns the square of the Pearson product moment correlation coefficient based on data points in known_ys and known_xs"},{formulaName:"UNIQUE",category:"Lookup & Reference",description:"Returns a unique values from a range or array."},{formulaName:"ROUNDUP",category:"Math & Trig",description:"Rounds a number away from zero."},{formulaName:"ROUNDDOWN",category:"Math & Trig",description:"Rounds a number down, toward zero."},{formulaName:"INT",category:"Math & Trig",description:"Returns a number to the nearest integer."},{formulaName:"LN",category:"Math & Trig",description:"Returns the natural logarithm of a number."},{formulaName:"ISNUMBER",category:"Information",description:"Returns TRUE, if the argument is number and FALSE otherwise."},{formulaName:"ROUND",category:"Math & Trig",description:"Rounds a number to a specified number of digits."},{formulaName:"LOG",category:"Math & Trig",description:"Returns the logarithm of a number to the base that you specify."},{formulaName:"POWER",category:"Math & Trig",description:"Returns the result of a number raised to power."},{formulaName:"SQRT",category:"Math & Trig",description:"Returns the square root of a positive number."},{formulaName:"TRUNC",category:"Math & Trig",description:"Returns the truncated value of a number to a specified number of decimal places."},{formulaName:"EXP",category:"Math & Trig",description:"Returns e raised to the power of the given number."},{formulaName:"GEOMEAN",category:"Statistical",description:"Returns the geometric mean of an array or range of positive data."},{formulaName:"TEXT",category:"Lookup & Reference",description:"Converts a value to text in specified number format."},{formulaName:"SORT",category:"Lookup & Reference",description:"Sorts a range of an array."},{formulaName:"LOOKUP",category:"Lookup & Reference",description:"Looks for a value in a one-row or one-column range, then returns a value from the same position in a second one-row or one-column range."},{formulaName:"VLOOKUP",category:"Lookup & Reference",description:"Looks for a specific value in the first column of a lookup range and returns a corresponding value from a different column within the same row."},{formulaName:"HLOOKUP",category:"Lookup & Reference",description:"Looks for a value in the top row of the array of values and then returns a value in the same column from a row in the array that you specify."},{formulaName:"T",category:"Text",description:"Checks whether a value is text or not and returns the text."},{formulaName:"EXACT",category:"Text",description:"Checks whether a two text strings are exactly same and returns TRUE or FALSE."},{formulaName:"LEN",category:"Text",description:"Returns a number of characters in a given string."},{formulaName:"MOD",category:"Math & Trig",description:"Returns a remainder after a number is divided by divisor."},{formulaName:"ODD",category:"Math & Trig",description:"Rounds a positive number up and negative number down to the nearest odd integer."},{formulaName:"PI",category:"Math & Trig",description:"Returns the value of pi."},{formulaName:"COUNTBLANK",category:"Statistical",description:"Returns the number of empty cells in a specified range of cells."},{formulaName:"EVEN",category:"Math & Trig",description:"Rounds a positive number up and negative number down to the nearest even integer."},{formulaName:"FACT",category:"Math & Trig",description:"Returns the factorial of a number."},{formulaName:"DECIMAL",category:"Math & Trig",description:"Converts a text representation of a number in a given base into a decimal number."},{formulaName:"DEGREES",category:"Math & Trig",description:"Converts radians to degrees."},{formulaName:"ADDRESS",category:"Lookup & Reference",description:"Returns a cell reference as text, given specified row and column numbers."},{formulaName:"TIME",category:"Date & Time",description:"Converts hours, minutes, seconds to the time formatted text."},{formulaName:"CHAR",category:"Text",description:"Returns the character from the specified number."},{formulaName:"CODE",category:"Text",description:"Returns the numeric code for the first character in a given string."},{formulaName:"DOLLAR",category:"Text",description:"Converts the number to currency formatted text."},{formulaName:"SMALL",category:"Statistical",description:"Returns the k-th smallest value in a given array."},{formulaName:"LARGE",category:"Statistical",description:"Returns the k-th largest value in a given array."},{formulaName:"MEDIAN",category:"Statistical",description:"Returns the median of the given set of numbers."},{formulaName:"EDATE",category:"Date & Time",description:"Returns a date with given number of months before or after the specified date."},{formulaName:"EOMONTH",category:"Date & Time",description:"Returns the last day of the month that is a specified number of months before or after an initially supplied start date."},{formulaName:"DATEVALUE",category:"Date & Time",description:"Converts a date string into date value."},{formulaName:"HOUR",category:"Date & Time",description:"Returns the number of hours in a specified time string."},{formulaName:"MINUTE",category:"Date & Time",description:"Returns the number of minutes in a specified time string."},{formulaName:"SECOND",category:"Date & Time",description:"Returns the number of seconds in a specified time string."},{formulaName:"NOW",category:"Date & Time",description:"Returns the current date and time."},{formulaName:"MONTH",category:"Date & Time",description:"Returns the number of months in a specified date string."},{formulaName:"PROPER",category:"Text",description:"Converts a text to proper case; first letter to uppercase and other letters to lowercase."}],this.isConcat=!1,this.parent=e,this.init()}return o.prototype.init=function(){for(var e,t=0;t<this.formulas.length;t++)e=V("Compute"+this.formulas[t].formulaName,this).bind(this),this.addFormulaCollection(this.formulas[t].formulaName.toUpperCase(),e,this.formulas[t].category,this.formulas[t].description)},o.prototype.addFormulaCollection=function(e,t,i,r){this.parent.libraryFormulas={fName:e,handler:t,category:i,description:r}},o.prototype.ComputeSUM=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=!1;if(e.length&&e[e.length-1]==="isSubtotal"&&(i=!0,e.pop()),g(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];var r=0,n,s,a=0;if(!g(e))for(var l=e,h=function(f){f.toString().indexOf(".")>-1&&(a=Math.max(a,f.split(".")[1].length))},u=0;u<l.length;u++){var c=l[u].toString();if(c.indexOf(":")>-1&&this.parent.isCellReference(c)){for(var d=this.parent.getCellCollection(c.split(this.parent.tic).join("")),p=0;p<d.length;p++)if(n=i?this.parent.getValueFromArg(d[p],null,null,!0):this.parent.getValueFromArg(d[p]),!(i&&n.includes("SUBTOTAL("))){if(this.parent.getErrorStrings().indexOf(n)>-1)return n;g(n[0])||isNaN(this.parent.parseFloat(n))||(h(n),r=r+this.parent.parseFloat(n))}}else{if(l[u].indexOf(this.parent.tic)>-1&&(isNaN(this.parent.parseFloat(l[u].split(this.parent.tic).join("")))||l[u].split(this.parent.tic).join("").trim()===""))return this.parent.getErrorStrings()[W.Value];if(l[u].split(this.parent.tic).join("")===this.parent.trueValue&&(l[u]="1"),l[u].split(this.parent.tic).join("")===this.parent.falseValue&&(l[u]="0"),s=i?this.parent.getValueFromArg(l[u].split(this.parent.tic).join(""),null,null,!0):this.parent.getValueFromArg(l[u].split(this.parent.tic).join("")),i&&s.includes("SUBTOTAL("))continue;if(this.parent.getErrorStrings().indexOf(s)>-1)return s;if(g(s)||isNaN(this.parent.parseFloat(s)))continue;s.length>0&&(h(s),r=r+this.parent.parseFloat(s+""))}}return r.toString().indexOf(".")>-1?r.toFixed(a):r},o.prototype.ComputeINT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r=this.parent.getErrorStrings();return e[0]===""&&e.length===1?this.parent.formulaErrorStrings[pe.InvalidArguments]:e.length>1?this.parent.formulaErrorStrings[pe.WrongNumberArguments]:(i=this.parent.getValueFromArg(e[0]),r.indexOf(i)>-1?i:(i.toUpperCase()===this.parent.trueValue?i="1":i.toUpperCase()===this.parent.falseValue&&(i="0"),!this.parent.isCellReference(e[0])&&(e[0].indexOf(this.parent.tic+this.parent.tic)===-1&&(i=i.split(this.parent.tic).join("")),i.trim()==="")||(i.indexOf("%")>-1&&(i=(Number(i.split("%")[0])*.01).toString()),isNaN(this.parent.parseFloat(i)))?r[W.Value]:(i=this.parent.parseFloat(i),i=Math.floor(i),i)))},o.prototype.ComputeTODAY=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i;if(e.length!==1||e[0]!=="")i=this.parent.formulaErrorStrings[pe.InvalidArguments];else{var r=new Date(Date.now());this.parent.parentObject.getModuleName()==="spreadsheet"?(i=this.parent.parentObject.dateToInt(r),this.parent.parser.storedStringText.toUpperCase().indexOf("TODAY")===0&&this.parent.cell!==""&&this.parent.parentObject.setDateFormat(this.parent.getSheetId(this.parent.grid),this.parent.rowIndex(this.parent.cell)-1,this.parent.colIndex(this.parent.cell)-1)):i=r.getFullYear()+"/"+this.parent.calculateDate((r.getMonth()+1).toString())+"/"+this.parent.calculateDate(r.getDate().toString())}return i},o.prototype.ComputeWEEKDAY=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e[0]===""&&g(e[1])||e.length>2)return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e[0]===""&&e[1]===""||e[1]==="")return this.parent.getErrorStrings()[W.Num].toString();if(e.length===1&&e.push("1"),e[0].indexOf(this.parent.tic)>-1&&e[0].split(this.parent.tic).join("").trim()===""||e[1].split(this.parent.tic).join("").trim()===""||e[1].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(e[1].split(this.parent.tic).join(""))))return this.parent.getErrorStrings()[W.Value];var i,r,n;if(this.parent.isCellReference(e[0])){if(i=this.parent.getValueFromArg(e[0].split(this.parent.tic).join(""))||"0",i.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value]}else e[0].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(e[0].split(this.parent.tic).join("")))?i=this.parent.getValueFromArg(e[0]):i=this.parent.getValueFromArg(e[0].split(this.parent.tic).join(""))||"0";if(this.parent.isCellReference(e[1])?r=this.parent.getValueFromArg(e[1].split(this.parent.tic).join(""))||"0":r=this.parent.getValueFromArg(e[1].split(this.parent.tic).join("")),this.parent.getErrorStrings().indexOf(i)>-1)return i;if(this.parent.getErrorStrings().indexOf(r)>-1)return r;if(i=i===this.parent.trueValue?"1":i===this.parent.falseValue?"0":i,r=r===this.parent.trueValue?"1":r===this.parent.falseValue?"0":r,n=this.parent.parseFloat(i),r=this.parent.parseFloat(r),isNaN(r)||isNaN(n))return this.parent.getErrorStrings()[W.Value];if(n<0||n>2958465)return this.parent.getErrorStrings()[W.Num].toString();switch(r=parseInt(r.toString(),10),n=n<1?0:Math.floor(n)%7,r){case 1:case 17:n=n<=0?n+7:n;break;case 2:case 11:n=n-1,n=n<=0?n+7:n;break;case 3:n=n-2,n=n<0?n+7:n;break;case 12:n=n+5,n=n>7?n-7:n;break;case 13:n=n+4,n=n>7?n-7:n;break;case 14:n=n+3,n=n>7?n-7:n;break;case 15:n=n+2,n=n>7?n-7:n;break;case 16:n=n+1,n=n>7?n-7:n;break;default:n=this.parent.getErrorStrings()[W.Num].toString();break}return n},o.prototype.ComputePROPER=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r,n=this.parent.getErrorStrings();return e.length&&e[e.length-1]==="nestedFormulaTrue"&&(r=!0,e.pop()),g(e)||e[0].trim()===""&&e.length===1?this.parent.formulaErrorStrings[pe.InvalidArguments]:e.length>1?this.parent.formulaErrorStrings[pe.WrongNumberArguments]:(i=this.parent.getValueFromArg(e[0]).trim(),n.indexOf(i)>-1||(e[0].indexOf(this.parent.tic)>-1?e[0]!==i&&e[0].startsWith("n")?i=this.parent.removeTics(i.trim()):(i=this.parent.removeTics(e[0].trim()),i.indexOf(this.parent.tic+this.parent.tic)>-1&&(i=i.replace(/""/g,this.parent.tic))):!e[0].startsWith("n")&&i.split("%").length===2&&this.parent.isNumber(i.split("%")[0])&&(i=(Number(i.split("%")[0])/100).toString()),i=i.toLowerCase().replace(/\b\w/g,function(s){return s.toUpperCase()}).replace(/(\d)([a-z])/g,function(s,a,l){return a+l.toUpperCase()}),r&&(i=this.parent.tic+i+this.parent.tic)),i)},o.prototype.ComputeSUMPRODUCT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r;if(g(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];for(var n=0,s=0,a,l=null,h=e,u=[],c=0;c<h.length;c++)u.push(this.parent.getCellCollection(h[c]).length);for(var d=0;d<u.length;d++)if(u[d]&&u[d+1]&&u[d]!==u[d+1])return this.parent.getErrorStrings()[W.Value];for(var p=0;p<h.length;++p){var f=h[p];if(!f.startsWith(this.parent.tic)&&this.parent.isCellReference(f)){var c=f.indexOf(":"),v=this.parent.rowIndex(f.substr(0,c)),m=this.parent.rowIndex(f.substr(c+1));if(!(v!==-1||m===-1)==(v===-1||m!==-1))return this.parent.getErrorStrings()[W.Name];v>m&&(i=[m,v],v=i[0],m=i[1]);var y=this.parent.colIndex(f.substr(0,c)),S=this.parent.colIndex(f.substr(c+1));if(y>S&&(r=[S,y],y=r[0],S=r[1]),l===null)for(s=(m-v+1)*(S-y+1),l=[],c=0;c<s;++c)l[c]=1;c=0;for(var b=v;b<=m;++b)for(var w=y;w<=S;++w){var I=this.getSheetReference(f)+this.parent.convertAlpha(w)+b,x=this.parent.getValueFromArg(I);if(this.parent.getErrorStrings().indexOf(x)>-1)return x;if(isNaN(this.parent.parseFloat(x)))l[c]=0;else{if(isNaN(l[c]))return this.parent.getErrorStrings()[W.Name];l[c]=l[c]*this.parent.parseFloat(x)}c++}}else{var M=this.parent.getValueFromArg(f);return a=M.indexOf('"'),this.parent.getErrorStrings().indexOf(M)>-1?M:a>-1?0:this.parent.getErrorStrings()[W.Value]}}for(var c=0;c<s;++c)n+=l[c];return n},o.prototype.ComputeROUNDUP=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r,n,s,a,l=e.length;if(!g(e)&&l>2&&(i=this.parent.formulaErrorStrings[pe.InvalidArguments]),l===1&&e[0]!=="")s=e[0].indexOf('"'),r=e[0].indexOf('"')>-1?e[0].replace('"',""):e[0],r=r.indexOf('"')>-1?r.replace('"',""):r,r=r.toUpperCase()==="TRUE"?"1":r==="FALSE"?"0":r,r=this.parent.getValueFromArg(r),a=this.parent.parseFloat(r),a>0?a+=.4999999999:a<0&&(a-=.4999999999),a=this.parent.parseFloat(a.toFixed(0)),i=a.toString();else if(l===2){if(s=e[0].indexOf('"')>-1?e[0].indexOf('"'):e[1].indexOf('"')>-1?e[1].indexOf('"'):-1,this.parent.isCellReference(e[0]))r=this.parent.getValueFromArg(e[0])||"0";else{if(e[0].indexOf(this.parent.tic)>-1&&(e[0].split(this.parent.tic).join("")===this.parent.trueValue||e[0].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];r=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(r)>-1)return r;if(this.parent.isCellReference(e[1]))n=this.parent.getValueFromArg(e[1])||"0";else{if(e[1].indexOf(this.parent.tic)>-1&&(e[1].split(this.parent.tic).join("")===this.parent.trueValue||e[1].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];n=this.parent.getValueFromArg(e[1]).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(n)>-1)return n;r=r.toUpperCase()==="TRUE"?"1":r==="FALSE"?"0":r,n=n.toUpperCase()==="TRUE"?"1":n==="FALSE"?"0":n;var h=isNaN(Number(r))||r.trim()==="",u=isNaN(Number(n))||n.trim()==="";if((e[0].indexOf('"')>-1||this.parent.isCellReference(e[0]))&&h||(e[1].indexOf('"')>-1||this.parent.isCellReference(e[1]))&&u)return this.parent.getErrorStrings()[W.Value];var c=Math.ceil(this.parent.parseFloat(n));if(a=this.parent.parseFloat(r),c>0){var d=r.split("."),p=d.length===2?d[1].length>=c?c:d[1].length:0;a=this.parent.parseFloat(this.preciseRound(a,p,"ROUNDUP")),i=a.toString(),isNaN(a)&&(c.toString().indexOf('"')>-1?i=this.parent.getErrorStrings()[W.Value]:i=this.parent.getErrorStrings()[W.Name])}else a>0?a=a/Math.pow(10,-c)+.49999:a<0&&(a=a/Math.pow(10,-c)-.49999),a>0&&c<-9?a=1*Math.pow(10,-c):a=this.parent.parseFloat(a.toFixed(0))*Math.pow(10,-c),i=a.toString(),isNaN(a)&&(i=c.toString().indexOf('"')>-1?this.parent.getErrorStrings()[W.Value]:i=this.parent.getErrorStrings()[W.Name])}else i=s>-1?this.parent.getErrorStrings()[W.Value]:this.parent.formulaErrorStrings[pe.InvalidArguments];return i},o.prototype.ComputeROUNDDOWN=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r,n,s,a,l=e.length;if(!g(e)&&l>2&&(i=this.parent.formulaErrorStrings[pe.InvalidArguments]),l===1&&e[0]!=="")s=e[0].indexOf('"'),r=e[0].indexOf('"')>-1?e[0].replace('"',""):e[0],r=r.indexOf('"')>-1?r.replace('"',""):r,r=r.toUpperCase()==="TRUE"?"1":r==="FALSE"?"0":r,r=this.parent.getValueFromArg(r),a=this.parent.parseFloat(r),a>0?a-=.4999999999:a<0&&(a+=.4999999999),a=this.parent.parseFloat(a.toFixed(0)),i=a.toString();else if(l===2){if(s=e[0].indexOf('"')>-1?e[0].indexOf('"'):e[1].indexOf('"')>-1?e[1].indexOf('"'):-1,this.parent.isCellReference(e[0]))r=this.parent.getValueFromArg(e[0])||"0";else{if(e[0].indexOf(this.parent.tic)>-1&&(e[0].split(this.parent.tic).join("")===this.parent.trueValue||e[0].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];r=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(r)>-1)return r;if(this.parent.isCellReference(e[1]))n=this.parent.getValueFromArg(e[1])||"0";else{if(e[1].indexOf(this.parent.tic)>-1&&(e[1].split(this.parent.tic).join("")===this.parent.trueValue||e[1].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];n=this.parent.getValueFromArg(e[1]).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(n)>-1)return n;r=r.toUpperCase()==="TRUE"?"1":r==="FALSE"?"0":r,n=n.toUpperCase()==="TRUE"?"1":n==="FALSE"?"0":n;var h=isNaN(Number(r))||r.trim()==="",u=isNaN(Number(n))||n.trim()==="";if((e[0].indexOf('"')>-1||this.parent.isCellReference(e[0]))&&h||(e[1].indexOf('"')>-1||this.parent.isCellReference(e[1]))&&u)return this.parent.getErrorStrings()[W.Value];var c=Math.ceil(this.parent.parseFloat(n));if(a=this.parent.parseFloat(r),c>0){var d=r.indexOf("."),p=0;d!==-1&&(p=r.length-d-1,p=p>=c?c:p),a=this.parent.parseFloat(this.preciseRound(a,p,"ROUNDDOWN")),i=a.toString(),isNaN(a)&&(c.toString().indexOf('"')>-1?i=this.parent.getErrorStrings()[W.Value]:i=this.parent.getErrorStrings()[W.Name])}else a>0?a=a/Math.pow(10,-c)-.49999:a<0&&(a=a/Math.pow(10,-c)+.49999),a>0&&c<-9?a=1*Math.pow(10,-c):a=this.parent.parseFloat(a.toFixed(0))*Math.pow(10,-c),i=a.toString(),isNaN(a)&&(i=c.toString().indexOf('"')>-1?this.parent.getErrorStrings()[W.Value]:i=this.parent.getErrorStrings()[W.Name])}else i=s>-1?this.parent.getErrorStrings()[W.Value]:this.parent.formulaErrorStrings[pe.InvalidArguments];return i},o.prototype.ComputeCOUNT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=!1;if(e.length&&e[e.length-1]==="isSubtotal"&&(i=!0,e.pop()),g(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[pe.WrongNumberArguments];for(var r=e,n,s,a=0,l,h,u=0;u<r.length;u++)if(n=r[u],this.parent.isCellReference(n))if(n.indexOf(":")>-1){s=this.parent.getCellCollection(n.split(this.parent.tic).join(""));for(var c=0;c<s.length;c++)l=i?this.parent.getValueFromArg(s[c],null,null,!0):this.parent.getValueFromArg(s[c]),!(i&&l.includes("SUBTOTAL("))&&(isNaN(this.parent.parseFloat(l))||n.length>0&&l.trim()!==""&&a++)}else{if(l=i?this.parent.getValueFromArg(n,null,null,!0):this.parent.getValueFromArg(n),i&&l.includes("SUBTOTAL("))continue;isNaN(this.parent.parseFloat(l))||n.length>0&&l.trim()!==""&&a++}else h=this.parent.getValueFromArg(n).split(this.parent.tic).join(""),(n.length===0&&h.trim()===""||(!isNaN(this.parent.parseFloat(h))||n===this.parent.trueValue||n===this.parent.falseValue)&&n.length>0&&n.trim()!==""&&h.trim()!=="")&&a++;return a},o.prototype.ComputeDATE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i;if(e.length&&e[e.length-1]==="nestedFormulaTrue"&&(i=!0,e.pop()),g(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(e.length!==3)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];for(var r=[],n=0;n<e.length;++n)r[n]=this.parent.getValueFromArg(e[n]);r[0]=r[0]===this.parent.trueValue?"1":r[0]===this.parent.falseValue?"0":r[0],r[1]=r[1]===this.parent.trueValue?"1":r[1]===this.parent.falseValue?"0":r[1],r[2]=r[2]===this.parent.trueValue?"1":r[2]===this.parent.falseValue?"0":r[2];for(var s=0;s<r.length;s++){var a=r[s];if(this.parent.getErrorStrings().indexOf(a)>-1)return a;if(a==='""'||a==='"0"'&&e[s]!=='"0"'||a==='"TRUE"'||a==='"FALSE"')return this.parent.getErrorStrings()[W.Value].toString()}var l=Math.floor(this.parent.parseFloat(r[0].split(this.parent.tic).join(""))),h=Math.floor(this.parent.parseFloat(r[1].split(this.parent.tic).join(""))),u=Math.floor(this.parent.parseFloat(r[2].split(this.parent.tic).join(""))),c=0;if(!isNaN(l)&&!isNaN(h)&&!isNaN(u)){if(l<0&&h<=12||l>=1e4&&h>0)return this.parent.getErrorStrings()[W.Num].toString();for(;h>12;)h-=12,l++;c=this.parent.getSerialDateFromDate(l,h,u)}else return this.parent.getErrorStrings()[W.Value].toString();if(c===0)return this.parent.getErrorStrings()[W.Num].toString();var d=this.parent.fromOADate(c);if(d.toString()!=="Invalid Date"){if(d.getFullYear()<1900||1e4<=d.getFullYear())return this.parent.getErrorStrings()[W.Num].toString();if(!i)return new Et(this.parent.parentObject.locale||"en-US").formatDate(d,{type:"date",skeleton:"yMd"})}return c.toString()},o.prototype.ComputeFLOOR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(g(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];var i=e,r=i.length,n;if(r!==2)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(i[0]===""&&i[1]===""||i[0]===""&&!i[1].includes('"'))return 0;i[1]===""&&!i[0].includes('"')&&(i[1]="0");for(var s=0;s<i.length;s++){var a=i[s].split(this.parent.tic).join("").trim();if(a===""||i[s].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(a)))return this.parent.getErrorStrings()[W.Value];if(Mr(i[s])){if(n=this.parent.getValueFromArg(i[s])||"0",n=n===this.parent.trueValue?"1":n===this.parent.falseValue?"0":n,n.toUpperCase().match(/[A-Z]/)||n.includes('"')||!this.parent.isNumber(n))return this.parent.getErrorStrings()[W.Value]}else if(n=this.parent.getValueFromArg(i[s].split(this.parent.tic).join("")),n=n===this.parent.trueValue?"1":n===this.parent.falseValue?"0":n,n.toUpperCase().match(/[A-Z]/)||n.includes('"')||!this.parent.isNumber(n))return this.parent.getErrorStrings()[W.Value];i[s]=n}var l=this.parent.parseFloat(i[0]),h=this.parent.parseFloat(i[1]);return l>0&&h<0?this.parent.getErrorStrings()[W.Num]:(l>0||l<0)&&h===0?this.parent.getErrorStrings()[W.DivZero]:isNaN(l)?this.parent.getErrorStrings()[W.Name]:l===0&&h===0?0:Math.floor(l/h)*h},o.prototype.ComputeCEILING=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(g(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];var i=e,r=i.length,n;if(r!==2)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(i[0]===""&&i[1]===""||i[0]===""&&!i[1].includes('"'))return 0;i[1]===""&&!i[0].includes('"')&&(i[1]="0");for(var s=0;s<i.length;s++){var a=i[s].split(this.parent.tic).join("").trim();if(a===""||i[s].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(a)))return this.parent.getErrorStrings()[W.Value];if(Mr(i[s])){if(n=this.parent.getValueFromArg(i[s])||"0",n=n===this.parent.trueValue?"1":n===this.parent.falseValue?"0":n,n.toUpperCase().match(/[A-Z]/)||n.includes('"')||!this.parent.isNumber(n))return this.parent.getErrorStrings()[W.Value]}else if(n=this.parent.getValueFromArg(i[s].split(this.parent.tic).join("")),n=n===this.parent.trueValue?"1":n===this.parent.falseValue?"0":n,n.toUpperCase().match(/[A-Z]/)||n.includes('"')||!this.parent.isNumber(n))return this.parent.getErrorStrings()[W.Value];i[s]=n}var l=this.parent.parseFloat(i[0]),h=this.parent.parseFloat(i[1]);return l>0&&h<0?this.parent.getErrorStrings()[W.Num]:isNaN(l)?this.parent.getErrorStrings()[W.Name]:(l>0||l===0)&&h===0?0:Math.ceil(l/h)*h},o.prototype.ComputeDAY=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r,n=this.parent.getErrorStrings();if(g(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e.length>1)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(e[0].startsWith(this.parent.tic)){if(r=e[0].split(this.parent.tic).join(""),r===""||r===this.parent.trueValue||r===this.parent.falseValue)return n[W.Value]}else if(r=this.parent.getValueFromArg(e[0].split(this.parent.tic).join("")),this.parent.isCellReference(e[0])&&r.indexOf(this.parent.tic)>-1)return n[W.Value];return n.indexOf(r)>-1?r:Number(r)<0?n[W.Num]:Math.floor(Number(r))===0||r===this.parent.falseValue?0:r===this.parent.trueValue?1:(i=this.parent.isNaN(Number(r))?this.parent.parseDate(r):this.parent.intToDate(r),Object.prototype.toString.call(i)==="[object Date]"&&(i=new Date(i).getFullYear()<1900||new Date(i).getFullYear()>9999?this.parent.isNumber(r)?"Num":"NaN":i.getDate()),i.toString()==="NaN"?n[W.Value]:i.toString()==="Num"?n[W.Num]:i)},o.prototype.ComputeIF=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i;if(e.length&&e[e.length-1]==="nestedFormulaTrue"&&(i=!0,e.pop()),g(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(this.parent.getErrorStrings().indexOf(e[0])>0)return e[0];var r=e,n;r.length===4&&r[3]==="nestedFormulaTrue"&&(n=!0,r.pop());var s,a;if(r.length>3||r.length===1)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(r.length<=3){var l=void 0,h=void 0,u="";if(s=this.parent.getValueFromArg(r[0]),this.parent.getErrorStrings().indexOf(s)>-1)return s;var c=s.toUpperCase(),d=this.parent.parseFloat(s);if(c===this.parent.trueValue||d<0||d>0){if(i&&r[1].includes(":")){l=this.parent.getCellCollection(r[1]);for(var p=0;p<l.length;p++)h=this.parent.getValueFromArg(l[p]),isNaN(this.parent.parseFloat(h))||(u+=h+",");return u.slice(0,u.length-1)}a=r[1]===""?"0":this.parent.getValueFromArg(r[1])}else if(c===this.parent.falseValue||d===0){if(g(r[2]))return this.parent.falseValue;if(i&&r[2].includes(":")){l=this.parent.getCellCollection(r[2]);for(var p=0;p<l.length;p++)h=this.parent.getValueFromArg(l[p]),isNaN(this.parent.parseFloat(h))||(u+=h+",");return u.slice(0,u.length-1)}a=r[2]===""?"0":this.parent.getValueFromArg(r[2])}else return this.parent.formulaErrorStrings[pe.Requires3Args]}return!n&&a.indexOf(this.parent.tic)>-1?a.split(this.parent.tic).join(""):a===""?"0":a},o.prototype.ComputeIFERROR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(g(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];var i=e,r;if(i.length!==2)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(this.parent.isCellReference(i[0])){if(r=this.parent.getValueFromArg(i[0])||"0",this.parent.getErrorStrings().indexOf(r)===-1&&r!=="NaN")return r}else if(r=this.parent.getValueFromArg(i[0],null,!0)||"0",this.parent.getErrorStrings().indexOf(r)===-1&&r!=="NaN")return r=r.split(this.parent.tic).join("").trim(),r;return this.parent.isCellReference(i[1])?r=this.parent.getValueFromArg(i[1])||"0":(r=this.parent.getValueFromArg(i[1])||"0",r=r.split(this.parent.tic).join("").trim()),r},o.prototype.ComputePRODUCT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=!1;if(e.length&&e[e.length-1]==="isSubtotal"&&(i=!0,e.pop()),g(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];var r=1,n,s,a=!0,l;if(!g(e))for(var h=e,u=0;u<h.length;u++){var c=h[u];if(c.indexOf(":")>-1&&this.parent.isCellReference(c)){for(var d=this.parent.getCellCollection(c),p=0;p<d.length;p++)if(n=i?this.parent.getValueFromArg(d[p],null,null,!0):this.parent.getValueFromArg(d[p]),!(i&&n.includes("SUBTOTAL("))&&Me(n)){if(this.parent.getErrorStrings().indexOf(n)>-1)return n;l=this.parent.parseFloat(n),isNaN(l)||n.length>0&&(r=r*l,a=!1)}}else if(c.indexOf(":")===-1&&this.parent.isCellReference(c)){if(s=i?this.parent.getValueFromArg(h[u],null,null,!0):this.parent.getValueFromArg(h[u]),i&&s.includes("SUBTOTAL(")||!Me(s))continue;if(this.parent.getErrorStrings().indexOf(s)>-1)return s}else{s=h[u];var f=s.indexOf(this.parent.tic)>-1&&s.split(this.parent.tic).join("").trim()==="";if(f||h[u].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(s.split(this.parent.tic).join(""))))return this.parent.getErrorStrings()[W.Value];if(s=this.parent.getValueFromArg(h[u].split(this.parent.tic).join("")),s=s===this.parent.trueValue?"1":s===this.parent.falseValue?"0":s.split(this.parent.tic).join(""),this.parent.getErrorStrings().indexOf(s)>-1)return s}l=this.parent.parseFloat(s),isNaN(l)||s.length>0&&(r=r*l,a=!1)}return a?"0":r.toString()},o.prototype.ComputeDAYS=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r=this.parent.getErrorStrings();if(g(t)&&t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(t.length!==2)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];var n=function(h){var u=e.parent.getValueFromArg(h).trim();if(u.indexOf(e.parent.tic)>-1&&(u=u.split(e.parent.tic).join("").trim(),u===""||e.parent.isCellReference(h)||u.toUpperCase()===e.parent.trueValue||u.toUpperCase()===e.parent.falseValue))return r[W.Value];if(u=u.split(e.parent.tic).join(""),u.toUpperCase()===e.parent.trueValue)u="1";else if(u===""||u.toUpperCase()===e.parent.falseValue)u="0";else if(Number(u)<0)return r[W.Num];var c={value:u.toString()};return e.parent.parentObject.notify(Jr,c),(c.isDate||c.isTime)&&(u=(e.parent.parseDate(u).getTime()/(1e3*3600*24)).toString()),u},s=n(t[0]);if(r.indexOf(s)>-1)return s;var a=n(t[1]);if(r.indexOf(a)>-1)return a;var l=Math.floor(Number(s))-Math.floor(Number(a));return isNaN(l)?r[W.Value]:l},o.prototype.ComputeUNIQUE=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r,n,s=this.parent.getErrorStrings();if(t[t.length-1]==="isComputeExp"&&(n=!0,t.pop()),g(t)||t[0]===""&&t.length===1)return this.parent.formulaErrorStrings[pe.InvalidArguments];if(t.length>3)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];var a=function(_e){if(g(_e))return e.parent.falseValue;var lt=e.parent.getValueFromArg(_e);return s.indexOf(lt)>-1?lt:Number(lt)===0?e.parent.falseValue:Number(lt)<0||Number(lt)>0?e.parent.trueValue:(e.parent.isCellReference(_e)||(lt=e.parent.removeTics(lt)),lt.toUpperCase()===e.parent.trueValue||lt.toUpperCase()===e.parent.falseValue?lt.toUpperCase():lt.indexOf(e.parent.tic)>-1||_e.indexOf(e.parent.tic)>-1?s[W.Value]:s[W.Name])},l=a(t[1]);if(s.indexOf(l)>-1)return l;var h=a(t[2]);if(s.indexOf(h)>-1)return h;var u=[];if(t[0].indexOf(":")>-1){if(g(t[0].match(/[0-9]/))){var c=t[0].split(":");t[0]=c[0]+"1:"+c[1]+(this.parent.spreadSheetUsedRange[0]+1)}else if(g(t[0].toUpperCase().match(/[A-Z]/))){var c=t[0].split(":");t[0]="A"+c[0]+":"+si(this.parent.spreadSheetUsedRange[1]+1)+c[1]}var d=t[0].split(":");if(this.parent.isCellReference(d[0])&&this.parent.isCellReference(d[1])){for(var p=this.parent.dependencyCollection,f=0;f<p.length&&!n;f++)p[f].split(":")[0]===t[0].split(":")[0]&&this.clearDependency(p[f]);this.parent.dependencyCollection.indexOf(t[0])===-1?n||this.parent.dependencyCollection.push(t[0]):this.clearDependency(t[0]);var v=t[0].indexOf(":"),m=void 0,y=this.parent.rowIndex(this.parent.substring(t[0],0,v)),S=this.parent.colIndex(this.parent.substring(t[0],0,v)),b=this.parent.rowIndex(this.parent.substring(t[0],v+1,v+t[0].length-v-1)),w=this.parent.colIndex(this.parent.substring(t[0],v+1,v+t[0].length-v-1));y>b&&(m=b,b=y,y=m),S>w&&(m=w,w=S,S=m);var I="";t[0].indexOf("!")===0&&(I=t[0].substring(0,t[0].replace("!","").indexOf("!")+2)),t[0]=I+si(S)+y+":"+si(w)+b;var x=w-S,M=this.parent.getCellCollection(t[0]),D=void 0,A=void 0;if(D=A=this.parent.actCell,l===this.parent.falseValue)if(x===0)for(var f=0;f<M.length;f++){var L=this.parent.getValueFromArg(M[f]);L=L===""?"0":L,u.push(L)}else for(var T="",k=x,f=0;f<M.length;f++){if(f===M.length-1){var L=this.parent.getValueFromArg(M[f]);L=L===""?"0":L,T=T+L+"++",u.push(T.substring(0,T.length-2))}if(f<=k){var L=this.parent.getValueFromArg(M[f]);L=L===""?"0":L,T=T+L+"++"}else{u.push(T.substring(0,T.length-2)),k=x+f;var L=this.parent.getValueFromArg(M[f]);L=L===""?"0":L,T=L+"++"}}else for(var T="",k=x+1,F=b-y,f=0;f<k;f++){for(var R=0;R<=F;R++){var L=this.parent.getValueFromArg(M[R*k+f]);L=L===""?"0":L,T=T+L+"++"}u.push(T.substring(0,T.length-2)),T=""}for(var N=[],P=[],O=[],z=[],f=0;f<u.length;f++)N.indexOf(u[f].toLowerCase())===-1?(N.push(u[f].toLowerCase()),O.push(u[f])):(P.indexOf(u[f].toLowerCase())===-1&&P.push(u[f].toLowerCase()),z.push(u[f]));if(h===this.parent.trueValue){for(var H=[],f=0;f<O.length;f++)P.indexOf(O[f].toLowerCase())===-1&&H.push(O[f]);if(O=H,O.length===0)return s[W.Calc]}if(n){var Q;return x!==0?(Q=[],O.forEach(function(_e){Q=Q.concat(_e.split("++"))})):Q=l===this.parent.falseValue?O:O[0].split("++"),Q}D.indexOf("!")>-1&&(D=D.substring(D.lastIndexOf("!")+1));var $=this.parent.rowIndex(D),U=this.parent.colIndex(D);if(this.parent.dependencyLevel===0){var ie=!1;if(l===this.parent.falseValue)for(var f=$,k=O.length+$;f<k;f++)for(var ne=O[0].split("++"),te=U,oe=ne.length+U;te<oe;te++)f===k-1&&te===oe-1&&this.parent.uniqueRange.indexOf(A+":"+si(te)+f)===-1&&this.parent.uniqueRange.push(A+":"+si(te)+f),this.checkSpill(te,f)&&(ie=!0);else for(var f=U,k=O.length+U;f<k;f++)for(var ne=O[0].split("++"),ae=$,oe=ne.length+$;ae<oe;ae++)f===k-1&&ae===oe-1&&this.parent.uniqueRange.indexOf(this.parent.actCell+":"+si(f)+ae)===-1&&this.parent.uniqueRange.push(this.parent.actCell+":"+si(f)+ae),this.checkSpill(f,ae)&&(ie=!0);if(ie)return this.parent.formulaErrorStrings[pe.Spill]}else if(this.parent.dependencyLevel>0&&this.parent.getValueFromArg(si(U)+$,!0).indexOf("#SPILL!")>-1)return this.parent.formulaErrorStrings[pe.Spill];if(l===this.parent.falseValue){var ye=this.parent.getSheetFamilyItem(this.parent.grid),De="",ve=void 0;ye.sheetNameToParentObject!==null&&ye.sheetNameToParentObject.size>0&&(De=ye.parentObjectToToken.get(this.parent.grid),ve=De+D);for(var f=0;f<O.length;f++){var ne=O[f].split("++");f>0&&($++,U=this.parent.colIndex(D));for(var ue=0;ue<ne.length;ue++)this.setValueRefresh(ne[ue],$,U),(f>0||ue>0)&&this.parent.refresh(De+si(U)+$.toString(),ve),ne[ue+1]&&U++}r=O[0].split("++")[0]}else{for(var f=0;f<O.length;f++)for(var ne=O[f].split("++"),Tt=0;Tt<ne.length;Tt++)this.setValueRefresh(ne[Tt],$,U),ne[Tt+1]?$++:(U++,$=this.parent.rowIndex(D));r=O[0].split("++")[0]}}}else if(this.parent.isCellReference(t[0]))this.parent.dependencyCollection.indexOf(t[0])===-1?n||this.parent.dependencyCollection.push(t[0]):this.clearDependency(t[0]),r=this.parent.getValueFromArg(t[0]);else{if(r=this.parent.getValueFromArg(t[0].trim()),s.indexOf(r)>-1)return r;r=this.parent.removeTics(r)}return r},o.prototype.setValueRefresh=function(e,t,i){this.parent.parentObject.setValueRowCol(this.parent.getSheetId(this.parent.grid),e,t,i)},o.prototype.checkSpill=function(e,t){var i=!1,r=this.parent.getValueFromArg(si(e)+t,!0),n="!"+this.parent.getSheetID(this.parent.grid)+"!"+si(e)+t,s;return this.parent.getFormulaInfoTable().get(n)&&(s=this.parent.getFormulaInfoTable().get(n).formulaText),r&&(r.toUpperCase().indexOf("UNIQUE")<0||s&&!s.toUpperCase().includes("UNIQUE"))&&r!==this.parent.formulaErrorStrings[pe.WrongNumberArguments]&&(i=!0),i},o.prototype.clearDependency=function(e){var t=this.parent.actCell,i="";if(t.lastIndexOf("!")>-1){var r=t;t=r.substring(r.lastIndexOf("!")+1),i=r.substring(0,r.lastIndexOf("!"))+"!"}for(var n=this.parent.rowIndex(t),s=this.parent.colIndex(t),a=e.indexOf(":"),l=this.parent.rowIndex(this.parent.substring(e,0,a)),h=this.parent.colIndex(this.parent.substring(e,0,a)),u=this.parent.rowIndex(this.parent.substring(e,a+1,a+e.length-a-1)),c=this.parent.colIndex(this.parent.substring(e,a+1,a+e.length-a-1)),d=u-l+n,p=c-h+s,f=this.parent.getFormulaInfoTable().get("!"+this.parent.getSheetID(this.parent.grid)+"!"+t)?this.parent.getFormulaInfoTable().get("!"+this.parent.getSheetID(this.parent.grid)+"!"+t).getFormulaText():"",v=n;v<=d;v++)for(var m=s;m<=p;m++)if(this.parent.dependencyLevel>0||f.indexOf("UNIQUE")>-1){if(this.parent.getValueFromArg("!"+this.parent.getSheetID(this.parent.grid)+"!"+si(s)+n,!0).indexOf("#SPILL!")>-1)return;this.parent.parentObject.setValueRowCol(this.parent.getSheetID(this.parent.grid)+1,"",v,m),this.parent.refresh("!"+this.parent.getSheetID(this.parent.grid)+"!"+si(m)+v,t),this.parent.actCell=i+t}},o.prototype.ComputeT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r,n=this.parent.getErrorStrings();if(e.length&&e[e.length-1]==="nestedFormulaTrue"&&(r=!0,e.pop()),g(e)||e.length===1&&e[0].trim()==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e.length>1)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(i=this.parent.getValueFromArg(e[0]).trim(),n.indexOf(i)>-1)return i;if(e[0].indexOf(this.parent.tic)>-1)i=this.parent.removeTics(e[0].trim()),i.indexOf(this.parent.tic+this.parent.tic)>-1&&(i=i.replace(/""/g,this.parent.tic));else if(i.split("%").length===2&&this.parent.isNumber(i.split("%")[0])&&(i=(Number(i.split("%")[0])/100).toString()),this.parent.isNumber(i)||i.toUpperCase()===this.parent.trueValue||i.toUpperCase()===this.parent.falseValue)return"";return r&&(i=this.parent.tic+i+this.parent.tic),i},o.prototype.ComputeHOUR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e.length!==1||g(e)||e[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e[0].split(this.parent.tic).join("").trim()==="")return this.parent.getErrorStrings()[W.Value];var i;if(this.parent.isCellReference(e[0])){if(i=this.parent.getValueFromArg(e[0].split(this.parent.tic).join(""))||"0",i.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value]}else{if(e[0].indexOf(this.parent.tic)>-1&&(e[0].split(this.parent.tic).join("")===this.parent.trueValue||e[0].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];i=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(i)>-1)return i;i=i===this.parent.trueValue?"1":i===this.parent.falseValue?"0":i;var r;if(this.parent.isNumber(i)){if(this.parent.parseFloat(i)<0||this.parent.parseFloat(i)>2958465)return this.parent.getErrorStrings()[W.Num];r=this.parent.intToTime(i)}else{var n={value:i.toString()};if(this.parent.parentObject.notify(Jr,n),n.isDate||n.isTime)r=n.dateObj;else return this.parent.getErrorStrings()[W.Value]}if(r.toString()==="Invalid Date"&&(r=new Date(Date.parse(i))),r.toString()==="Invalid Date"){var s=new Date(Date.now()).toLocaleDateString()+" "+i;r=new Date(Date.parse(s))}return r.toString()==="Invalid Date"&&(r=this.parent.fromOADate(this.parent.parseFloat(i))),r.toString()==="Invalid Date"?this.parent.getErrorStrings()[W.Value]:r.getFullYear()<1900||r.getFullYear()>9999?this.parent.getErrorStrings()[W.Value]:r.getHours()},o.prototype.ComputeMINUTE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e.length!==1||g(e)||e[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e[0].split(this.parent.tic).join("").trim()==="")return this.parent.getErrorStrings()[W.Value];var i;if(this.parent.isCellReference(e[0])){if(i=this.parent.getValueFromArg(e[0].split(this.parent.tic).join(""))||"0",i.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value]}else{if(e[0].indexOf(this.parent.tic)>-1&&(e[0].split(this.parent.tic).join("")===this.parent.trueValue||e[0].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];i=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(i)>-1)return i;i=i===this.parent.trueValue?"1":i===this.parent.falseValue?"0":i;var r;if(this.parent.isNumber(i)){if(this.parent.parseFloat(i)<0||this.parent.parseFloat(i)>2958465)return this.parent.getErrorStrings()[W.Num];r=this.parent.intToTime(i)}else{var n={value:i.toString()};if(this.parent.parentObject.notify(Jr,n),n.isDate||n.isTime)r=n.dateObj;else return this.parent.getErrorStrings()[W.Value]}if(r.toString()==="Invalid Date"&&(r=new Date(Date.parse(i))),r.toString()==="Invalid Date"){var s=new Date(Date.now()).toLocaleDateString()+" "+i;r=new Date(Date.parse(s))}return r.toString()==="Invalid Date"&&(r=this.parent.fromOADate(this.parent.parseFloat(i))),r.toString()==="Invalid Date"?this.parent.getErrorStrings()[W.Value]:r.getFullYear()<1900||r.getFullYear()>9999?this.parent.getErrorStrings()[W.Value]:r.getMinutes()},o.prototype.ComputeSECOND=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e.length!==1||g(e)||e[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e[0].split(this.parent.tic).join("").trim()==="")return this.parent.getErrorStrings()[W.Value];var i;if(this.parent.isCellReference(e[0])){if(i=this.parent.getValueFromArg(e[0].split(this.parent.tic).join(""))||"0",i.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value]}else{if(e[0].indexOf(this.parent.tic)>-1&&(e[0].split(this.parent.tic).join("")===this.parent.trueValue||e[0].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];i=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(i)>-1)return i;i=i===this.parent.trueValue?"1":i===this.parent.falseValue?"0":i;var r;if(this.parent.isNumber(i)){if(this.parent.parseFloat(i)<0||this.parent.parseFloat(i)>2958465)return this.parent.getErrorStrings()[W.Num];r=this.parent.intToTime(i)}else{var n={value:i.toString()};if(this.parent.parentObject.notify(Jr,n),n.isDate||n.isTime)r=n.dateObj;else return this.parent.getErrorStrings()[W.Value]}if(r.toString()==="Invalid Date"&&(r=new Date(Date.parse(i))),r.toString()==="Invalid Date"){var s=new Date(Date.now()).toLocaleDateString()+" "+i;r=new Date(Date.parse(s))}return r.toString()==="Invalid Date"&&(r=this.parent.fromOADate(this.parent.parseFloat(i))),r.toString()==="Invalid Date"?this.parent.getErrorStrings()[W.Value]:r.getFullYear()<1900||r.getFullYear()>9999?this.parent.getErrorStrings()[W.Value]:r.getSeconds()},o.prototype.ComputeMONTH=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this.parent.getErrorStrings();if(e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e.length!==1)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];var r=this.parent.getValueFromArg(e[0]).trim();if(i.indexOf(r)>-1)return r;if(this.parent.isCellReference(e[0])){if(r.indexOf(this.parent.tic)>-1)return i[W.Value];if(r==="")return 1}else{if(r.toUpperCase()==='"TRUE"'||r.toUpperCase()==='"FALSE"')return i[W.Value];r=r.split(this.parent.tic).join("")}if(r==="")return i[W.Value];if(r===this.parent.trueValue||r===this.parent.falseValue||Number(r)>-1&&Number(r)<32)return 1;if(Number(r)<0)return i[W.Num];r.indexOf("%")>-1&&(r=(Number(r.split("%")[0])*.01).toString()),this.parent.isNumber(r)&&(r=parseInt(Math.floor(Number(r)).toString(),10));var n=this.parent.parseDate(r);return n.toString()==="Invalid Date"?this.parent.isNumber(r)?i[W.Num]:i[W.Value]:n.getFullYear()<1900||1e4<=n.getFullYear()?i[W.Num]:(n.getMonth()+1).toString()},o.prototype.ComputeNOW=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e.length!==1||e[0]!=="")return this.parent.formulaErrorStrings[pe.InvalidArguments];var i=new Date(Date.now()),r=new Et,n=r.getDateFormat({format:"M/d/yyyy h:mm:ss a"}),s=this.parent.parentObject.dateToInt(n(i),!0);return s.toString()},o.prototype.ComputeEXACT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=!1,r=e.length&&e[e.length-1]==="nestedFormulaTrue",n=this.parent.getErrorStrings();if(r&&e.pop(),!e||!e[0]&&e.length===1)return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e.length!==2)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];var s,a,l;if(e[0]){if(s=this.parent.getValueFromArg(e[0]),n.indexOf(s)>-1)return s;s.indexOf(this.parent.tic)===-1&&s.includes("%")&&(s=(Number(s.split("%")[0])/100).toString()),this.parent.isCellReference(e[0])?l=!0:s=s.split(this.parent.tic).join("")}if(e[1]){if(a=this.parent.getValueFromArg(e[1]),n.indexOf(a)>-1)return a;a.indexOf(this.parent.tic)===-1&&a.includes("%")&&(a=(Number(a.split("%")[0])/100).toString()),this.parent.isCellReference(e[1])?!l&&s.trim().length===0&&a.trim().length===0&&(i=!1):(a=a.split(this.parent.tic).join(""),l&&s.trim().length===0&&a.trim().length===0&&(i=!1))}return s===a&&(i=!0,r&&(i=this.parent.tic+i+this.parent.tic)),i},o.prototype.ComputeLEN=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r=this.parent.getErrorStrings();return g(e)||e[0].trim()===""&&e.length===1?this.parent.formulaErrorStrings[pe.InvalidArguments]:e.length>1?this.parent.formulaErrorStrings[pe.WrongNumberArguments]:(i=this.parent.getValueFromArg(e[0]).trim(),r.indexOf(i)>-1?i:(e[0].indexOf(this.parent.tic)>-1?e[0]!==i&&e[0].startsWith("n")?i=this.parent.removeTics(i.trim()):(i=this.parent.removeTics(e[0].trim()),i.indexOf(this.parent.tic+this.parent.tic)>-1&&(i=i.replace(/""/g,this.parent.tic))):!e[0].startsWith("n")&&i.split("%").length===2&&this.parent.isNumber(i.split("%")[0])&&(i=(Number(i.split("%")[0])/100).toString()),i.length))},o.prototype.ComputeMOD=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i;if(g(e)||e.length!==2)return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e[1]===""&&!e[0].includes('"'))return this.parent.formulaErrorStrings[pe.Div];if(e[0]===""&&!e[1].includes('"'))return 0;for(var r=0;r<e.length;r++){var n=e[r].split(this.parent.tic).join("").trim();if(n===""||e[r].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(n)))return this.parent.getErrorStrings()[W.Value];if(Mr(e[r])){if(i=this.parent.getValueFromArg(e[r])||"0",i=i===this.parent.trueValue?"1":i===this.parent.falseValue?"0":i,i.toUpperCase().match(/[A-Z]/)||i.includes('"')||!this.parent.isNumber(i))return this.parent.getErrorStrings()[W.Value]}else if(i=this.parent.getValueFromArg(e[r].split(this.parent.tic).join("")),i=i===this.parent.trueValue?"1":i===this.parent.falseValue?"0":i,this.parent.getErrorStrings().indexOf(i)>-1)return i;e[r]=i}var s=e[0],a=e[1];if(a==="0"||a==="")return this.parent.formulaErrorStrings[pe.Div];if(s==="0"||s==="")return 0;s=parseFloat(s),a=parseFloat(a);var l=(s%a+a)%a;return isNaN(l)?this.parent.getErrorStrings()[W.Name]:l},o.prototype.ComputeODD=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(g(e)||e.length!==1||e[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];var i=e[0].split(this.parent.tic).join("").trim();if(i===""||e[0].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(i)))return this.parent.getErrorStrings()[W.Value];var r;if(Mr(e[0])){if(r=this.parent.getValueFromArg(e[0]),r===this.parent.trueValue)r="1";else if(r===""||r===this.parent.falseValue)r="0";else if(r.toUpperCase().match(/[A-Z]/)||r.includes('"')||!this.parent.isNumber(r))return this.parent.getErrorStrings()[W.Value]}else{if(r=this.parent.getValueFromArg(e[0].split(this.parent.tic).join("")),r==="#NAME?")return this.parent.getErrorStrings()[W.Name];if(r===this.parent.trueValue)r="1";else if(r===""||r===this.parent.falseValue)r="0";else if(r.toUpperCase().match(/[A-Z]/)||!this.parent.isNumber(r))return this.parent.getErrorStrings()[W.Value]}var n=Math.ceil(parseInt(r,10)),s=n===0;return n=n%2===0?n>0?n+1:n-1:n,Math.ceil(parseInt(r,10))%2!==0&&(parseInt(r,10)>0&&parseFloat(r)>parseInt(r,10)?n=n+2:parseInt(r,10)<0&&parseFloat(r)<parseInt(r,10)&&(n=n-2)),isNaN(n)?this.parent.getErrorStrings()[W.Name]:s?1:n},o.prototype.ComputeEVEN=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(g(e)||e.length!==1||e[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];var i=e[0].split(this.parent.tic).join("").trim();if(i===""||e[0].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(i)))return this.parent.getErrorStrings()[W.Value];var r;if(Mr(e[0])){if(r=this.parent.getValueFromArg(e[0]),r===this.parent.trueValue)r="1";else if(r===""||r===this.parent.falseValue)r="0";else if(r.toUpperCase().match(/[A-Z]/)||r.includes('"')||!this.parent.isNumber(r))return this.parent.getErrorStrings()[W.Value]}else{if(r=this.parent.getValueFromArg(e[0].split(this.parent.tic).join("")),r==="#NAME?")return this.parent.getErrorStrings()[W.Name];if(r===this.parent.trueValue)r="1";else if(r===""||r===this.parent.falseValue)r="0";else if(r.toUpperCase().match(/[A-Z]/)||!this.parent.isNumber(r))return this.parent.getErrorStrings()[W.Value]}var n=Math.ceil(parseInt(r,10));return n=n%2===0?n:n>0?n+1:n-1,Math.ceil(parseInt(r,10))%2===0&&(parseInt(r,10)>0&&parseFloat(r)>parseInt(r,10)?n=n+2:parseInt(r,10)<0&&parseFloat(r)<parseInt(r,10)&&(n=n-2)),isNaN(n)?this.parent.getErrorStrings()[W.Name]:n},o.prototype.ComputePI=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i;return e&&e[0]!==""?i=this.parent.formulaErrorStrings[pe.InvalidArguments]:i=Math.PI,i},o.prototype.ComputeMEDIAN=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r=[];if(g(e)||e[0]===""&&e.length===1)return this.parent.formulaErrorStrings[pe.InvalidArguments];for(var n=0;n<e.length;n++)if(this.parent.isCellReference(e[n]))if(e[n].indexOf(":")>-1)for(var s=this.parent.getCellCollection(e[n]),a=0;a<s.length;a++){var l=this.parent.getValueFromArg(s[a]);if(this.parent.getErrorStrings().indexOf(l)>-1)return l;l.trim()!==""&&r.push(this.parent.parseFloat(l))}else{var h=this.parent.getValueFromArg(e[n]);if(this.parent.getErrorStrings().indexOf(h)>-1)return h;h.trim()!==""&&r.push(this.parent.parseFloat(h))}else if(e[n]===""||e[n]===this.parent.falseValue&&!this.parent.isCellReference(e[n]))r.push(0);else if(e[n]===this.parent.trueValue&&!this.parent.isCellReference(e[n]))r.push(1);else{if(e[n].indexOf(this.parent.tic)>-1&&isNaN(parseFloat(e[n].split(this.parent.tic).join(""))))return this.parent.getErrorStrings()[W.Value];var u=this.parent.getValueFromArg(e[n]).split(this.parent.tic).join("");if(this.parent.getErrorStrings().indexOf(u)>-1)return u;r.push(this.parent.parseFloat(u))}r=r.sort(function(p,f){return p-f});for(var c=r.length,d=0;d<c&&!(isNaN(r[d])&&(r.splice(d,1),c=r.length,d--,r.length===0));d++);if(r.length%2!==0&&!isNaN(r[parseInt((r.length/2).toString(),10)]))i=r[parseInt((r.length/2).toString(),10)];else if(!isNaN(r[r.length/2])&&!isNaN(r[r.length/2-1]))i=(r[r.length/2]+r[r.length/2-1])/2;else return this.parent.getErrorStrings()[W.Num];return i},o.prototype.ComputeEDATE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e.length!==2||g(e))return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e[0]===""||e[1]==="")return this.parent.getErrorStrings()[W.NA];if(e[0].split(this.parent.tic).join("")===""||e[1].split(this.parent.tic).join("")===""||e[1].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(e[1].split(this.parent.tic).join(""))))return this.parent.getErrorStrings()[W.Value];var i,r;if(this.parent.isCellReference(e[0])){if(e[0].indexOf(":")>-1)return this.parent.getErrorStrings()[W.Value];if(i=this.parent.getValueFromArg(e[0].split(this.parent.tic).join(""))||"0",i.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value]}else i=this.parent.getValueFromArg(e[0].split(this.parent.tic).join(""));if(this.parent.isCellReference(e[1])){if(e[1].indexOf(":")>-1)return this.parent.getErrorStrings()[W.Value];r=this.parent.getValueFromArg(e[1].split(this.parent.tic).join(""))||"0"}else r=this.parent.getValueFromArg(e[1].split(this.parent.tic).join(""));if(this.parent.getErrorStrings().indexOf(r)>-1)return r;r=parseInt(r,10);var n;if(this.parent.isNumber(i)){if(i=parseInt(i,10),i<0||i>2958465)return this.parent.getErrorStrings()[W.Num];n=this.parent.fromOADate(i)}else n=this.parent.checkDateFormat(i);if(isNaN(r)||g(this.parent.isDate(n))||n.getFullYear()>9999)return this.parent.getErrorStrings()[W.Value];var s=n.getDate();n.setMonth(n.getMonth()+r),s!==n.getDate()&&n.setDate(0);var a=this.parent.parentObject.dateToInt(n);return i.toString()==="0"&&(a-=1),a<0||a>2958465?this.parent.getErrorStrings()[W.Num]:a.toString()},o.prototype.ComputeEOMONTH=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e.length!==2||g(e))return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e[0]===""||e[1]==="")return this.parent.getErrorStrings()[W.NA];if(e[0].split(this.parent.tic).join("")===""||e[1].split(this.parent.tic).join("")===""||e[1].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(e[1].split(this.parent.tic).join(""))))return this.parent.getErrorStrings()[W.Value];var i,r;if(this.parent.isCellReference(e[0])){if(e[0].indexOf(":")>-1)return this.parent.getErrorStrings()[W.Value];if(i=this.parent.getValueFromArg(e[0].split(this.parent.tic).join(""))||"0",i.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value]}else i=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join("");if(this.parent.getErrorStrings().indexOf(i)>-1)return i;if(this.parent.isCellReference(e[1])){if(e[1].indexOf(":")>-1)return this.parent.getErrorStrings()[W.Value];r=this.parent.getValueFromArg(e[1].split(this.parent.tic).join(""))||"0"}else r=this.parent.getValueFromArg(e[1].split(this.parent.tic).join(""));if(this.parent.getErrorStrings().indexOf(r)>-1)return r;r=parseInt(r,10);var n;if(this.parent.isNumber(i)){if(i=parseInt(i,10),i<0||i>2958465)return this.parent.getErrorStrings()[W.Num];n=this.parent.fromOADate(i)}else n=this.parent.checkDateFormat(i);if(isNaN(r)||g(this.parent.isDate(n))||n.getFullYear()>9999)return this.parent.getErrorStrings()[W.Value];n=new Date(n.getFullYear(),n.getMonth()+(r+1),0);var s=this.parent.parentObject.dateToInt(n);return s<0||s>2958465||n.getFullYear()<1900?this.parent.getErrorStrings()[W.Num]:s.toString()},o.prototype.ComputeDATEVALUE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r=this.parent.getErrorStrings();if(e[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e.length>1)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(i=this.parent.getValueFromArg(e[0])||"0",r.indexOf(i)>-1)return i;if(this.parent.isCellReference(e[0])){if(e[0].indexOf(":")>-1||i.startsWith(this.parent.tic))return r[W.Value]}else i=e[0].split(this.parent.tic).join("")||"0";if(!(!this.parent.isNumber(i)&&!g(this.parent.isDate(i))))return r[W.Value];var n=this.parent.parseDate(i);return r.indexOf(i)>-1?i:g(n)||n.toString()==="Invalid Date"||n.getFullYear()<1900||n.getFullYear()>9999?this.parent.getErrorStrings()[W.Value]:(i=this.parent.toOADate(n).toString(),parseFloat(i).toFixed(0).toString())},o.prototype.ComputeCOUNTBLANK=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=0;if(e.length!==1||g(e)||!this.parent.isCellReference(e[0]))return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e[0]==="")return this.parent.getErrorStrings()[W.Value];for(var r=this.parent.getCellCollection(e[0]),n=0;n<r.length;n++)this.parent.getValueFromArg(r[n])===""&&i++;return i},o.prototype.ComputeFACT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=1,r=this.parent.getErrorStrings();if(e[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e.length!==1)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];var n=e[0];if(this.parent.isCellReference(e[0])||isNaN(Number(n.split(this.parent.tic).join("")))){if(n=this.parent.getValueFromArg(e[0]),r.indexOf(n)>-1)return n;if(n.startsWith(this.parent.tic)||n.match(/^(\d*\.\d+|\d+)\s*[+\-*/]\s*(\d*\.\d+|\d+)$/))return r[W.Value];if(n==="")return 1}if(n=n.split(this.parent.tic).join("").trim(),r.indexOf(n)>-1)return n;if(n.toUpperCase()===this.parent.trueValue||n.toUpperCase()===this.parent.falseValue)return 1;n.indexOf("%")>-1&&(n=(Number(n.split("%")[0])/100).toString());var s=parseInt(n,10);if(s<0||s>170)return r[W.Num];if(n.toUpperCase().match(/[A-Z]/)||n==="")return r[W.Value];if(n.indexOf(":")>-1)return 0;for(var a=1;a<=s;a++)i=i*a;return i},o.prototype.ComputeDECIMAL=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r=/[@#$%^&*()?:{}|<>+-]/g;if(g(e)||e.length!==2)return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e[0].match(r))return this.parent.getErrorStrings()[W.Num];if(e[1].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(e[1].split(this.parent.tic).join(""))))return this.parent.getErrorStrings()[W.Value];var n=void 0,s=void 0;this.parent.isCellReference(e[0].toString())?n=this.parent.getValueFromArg(e[0]):n=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join(""),this.parent.isCellReference(e[1].toString())?s=this.parent.getValueFromArg(e[1]):s=this.parent.getValueFromArg(e[1]).split(this.parent.tic).join("");var a=parseInt(n,10),l=parseInt(s,10);return this.parent.getErrorStrings().indexOf(n)>-1?n:this.parent.getErrorStrings().indexOf(s)>-1?s:n===""&&s!==""?0:n===""||a<0||!isNaN(a)&&!Number.isInteger(parseFloat(n))?this.parent.getErrorStrings()[W.Num]:s===""||l<2||l>36||isNaN(l)?this.parent.getErrorStrings()[W.Num]:isNaN(this.parent.parseFloat(n))&&this.parent.parseFloat(s)<=10?this.parent.getErrorStrings()[W.Num]:(i=parseInt(n,parseInt(s,10)),isNaN(i)?this.parent.getErrorStrings()[W.Num]:i)},o.prototype.ComputeDEGREES=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this.parent.getErrorStrings();if(g(e)||e[0]===""&&e.length===1)return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e.length!==1)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];var r=this.parent.getValueFromArg(e[0]).trim();if(i.indexOf(r)>-1)return r;if(this.parent.isCellReference(e[0])){if(r===""||r.indexOf(":")>-1)return 0;if(r.indexOf(this.parent.tic)>-1||isNaN(Number(r))&&!isNaN(parseInt(r,10)))return i[W.Value]}else if(r.indexOf('"TRUE"')>-1)return i[W.Value];if(r=r.split(this.parent.tic).join(""),r.toUpperCase()===this.parent.trueValue)r="1";else if(r.toUpperCase()===this.parent.falseValue)r="0";else if(r.indexOf("%")>-1)r=(Number(r.split("%")[0])/100).toString();else if(r.toUpperCase().match(/[A-Z]/)||isNaN(parseInt(r,10)))return i[W.Value];return parseFloat(r)*(180/Math.PI)},o.prototype.ComputeADDRESS=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r,n=this.parent.getErrorStrings();if(g(t)||t.length===1&&t[0].trim()==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(t.length<2||t.length>5)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(t[0].split(this.parent.tic).join("").trim()===""||t[1].split(this.parent.tic).join("").trim()==="")return n[W.Value];var s=function(d){var p=e.parent.getValueFromArg(d).trim();return n.indexOf(p)>0?p:(p.toUpperCase()===e.parent.trueValue?p="1":p.toUpperCase()===e.parent.falseValue&&(p="0"),e.parent.isCellReference(d)&&p.indexOf(e.parent.tic)>-1?n[W.Value]:(p=e.parent.removeTics(p),p.split("%").length===2&&e.parent.isNumber(p.split("%")[0])&&(p=(Number(p.split("%")[0])/100).toString()),p))},a=s(t[0]);if(n.indexOf(a)>0)return a;if(a=Number(a),isNaN(a)||a<1)return n[W.Value];a=a.toString();var l=s(t[1]);if(n.indexOf(l)>0)return l;if(l=Number(l),isNaN(l)||l<1)return n[W.Value];l=l.toString();var h,u;if(g(t[2])||t[2].trim()==="")h="1";else{if(h=s(t[2]),n.indexOf(h)>0)return h;if(h=Number(h),isNaN(h)||h<1||h>4)return n[W.Value];h=h.toString()}if(g(t[3])||t[3].trim()==="")u="1";else{if(u=s(t[3]),n.indexOf(u)>0)return u;u.toUpperCase()===this.parent.trueValue||Number(u)>1?u="1":(u===""||u.toUpperCase()===this.parent.falseValue)&&(u="0")}if(u==="1")h==="1"?r="$"+si(parseInt(l,10))+"$"+parseInt(a,10):h==="2"?r=si(parseInt(l,10))+"$"+parseInt(a,10):h==="3"?r="$"+si(parseInt(l,10))+parseInt(a,10):h==="4"&&(r=si(parseInt(l,10))+parseInt(a,10));else if(u==="0")h==="1"?r="R"+parseInt(a,10)+"C"+parseInt(l,10):h==="2"?r="R"+parseInt(a,10)+"C["+parseInt(l,10)+"]":h==="3"?r="R["+parseInt(a,10)+"]C"+parseInt(l,10):h==="4"&&(r="R["+parseInt(a,10)+"]C["+parseInt(l,10)+"]");else return n[W.Name];var c;return!g(t[4])&&t[4]!==""&&(c=this.parent.getValueFromArg(t[4]).split(this.parent.tic).join(""),n.indexOf(c)>0)?c:(g(c)||(r=c+"!"+r),r)},o.prototype.ComputeTIME=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i;if(g(e)||e.length!==3)return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e[0].indexOf(this.parent.tic)>-1&&e[0].split(this.parent.tic).join("").trim()==="")return this.parent.getErrorStrings()[W.Value];if(e[1].indexOf(this.parent.tic)>-1&&e[1].split(this.parent.tic).join("").trim()==="")return this.parent.getErrorStrings()[W.Value];if(e[2].indexOf(this.parent.tic)>-1&&e[2].split(this.parent.tic).join("").trim()==="")return this.parent.getErrorStrings()[W.Value];var r,n,s;if(this.parent.isCellReference(e[0])){if(r=this.parent.getValueFromArg(e[0].split(this.parent.tic).join(""))||"0",r.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value]}else{if(e[0].indexOf(this.parent.tic)>-1&&(e[0].split(this.parent.tic).join("")===this.parent.trueValue||e[0].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];r=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join("")||"0"}if(this.parent.getErrorStrings().indexOf(r)>-1)return r;if(isNaN(this.parent.parseFloat(r))&&!(r===this.parent.trueValue||r===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];if(this.parent.isCellReference(e[1])){if(n=this.parent.getValueFromArg(e[1].split(this.parent.tic).join(""))||"0",n.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value]}else{if(e[1].indexOf(this.parent.tic)>-1&&(e[1].split(this.parent.tic).join("")===this.parent.trueValue||e[1].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];n=this.parent.getValueFromArg(e[1]).split(this.parent.tic).join("")||"0"}if(this.parent.getErrorStrings().indexOf(n)>-1)return n;if(isNaN(this.parent.parseFloat(n))&&!(n===this.parent.trueValue||n===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];if(this.parent.isCellReference(e[2])){if(s=this.parent.getValueFromArg(e[2].split(this.parent.tic).join(""))||"0",s.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value]}else{if(e[2].indexOf(this.parent.tic)>-1&&(e[2].split(this.parent.tic).join("")===this.parent.trueValue||e[2].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];s=this.parent.getValueFromArg(e[2]).split(this.parent.tic).join("")||"0"}if(this.parent.getErrorStrings().indexOf(s)>-1)return s;if(isNaN(this.parent.parseFloat(s))&&!(s===this.parent.trueValue||s===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];if(r=r===this.parent.trueValue?"1":r===this.parent.falseValue?"0":r,n=n===this.parent.trueValue?"1":n===this.parent.falseValue?"0":n,s=s===this.parent.trueValue?"1":s===this.parent.falseValue?"0":s,r=parseInt(this.parent.parseFloat(r).toString(),10),n=parseInt(this.parent.parseFloat(n).toString(),10),s=parseInt(this.parent.parseFloat(s).toString(),10),isNaN(r)||isNaN(n)||isNaN(s))return this.parent.getErrorStrings()[W.Value];if(r>32767||n>32767||s>32767)return this.parent.getErrorStrings()[W.Num];var a=new Date(1900,0,1,r,n,s);if(a.getFullYear()<1900)return this.parent.getErrorStrings()[W.Num];var l=a.getHours(),h=a.getMinutes(),u=a.getSeconds(),c="AM",d=l;d>=12&&(d=l-12,c="PM"),d===0&&(d=12),h=h<10?"0"+h:h,u=u<10?"0"+u:u,d=d<10?"0"+d:d,i=d+":"+h+":"+u+" "+c;var p={value:i.toString()};return this.parent.parentObject.notify(Jr,p),p.isTime&&(i=p.updatedVal),i},o.prototype.ComputeCHAR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r=this.parent.getErrorStrings();if(g(e)||e[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e.length!==1)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];var n=this.parent.getValueFromArg(e[0]).trim();if(r.indexOf(n)>-1)return n;if(n.indexOf('"TRUE"')>-1||this.parent.isCellReference(e[0])&&n.startsWith(this.parent.tic))return r[W.Value];if(n=n.split(this.parent.tic).join(""),this.parent.isNumber(n)?n=Math.floor(Number(n)).toString():n.indexOf("%")>-1?n=Math.floor(Number(n.split("%")[0])/100).toString():n===this.parent.trueValue&&(n="1"),n.toUpperCase().match(/^[0-9]+$/)){var s=parseInt(n,10);if(s>255||s<=0)return r[W.Value];i=String.fromCharCode(s)}else return r[W.Value];return i},o.prototype.ComputeCODE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r=this.parent.getErrorStrings();if(g(e)||e.length===1&&e[0].trim()==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e.length>1)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(i=this.parent.getValueFromArg(e[0]).trim(),r.indexOf(i)>-1)return i;if(e[0].indexOf(this.parent.tic)>-1?e[0]!==i&&e[0].startsWith("n")?i=this.parent.removeTics(i.trim()):i=this.parent.removeTics(e[0].trim()):!e[0].startsWith("n")&&i.split("%").length===2&&this.parent.isNumber(i.split("%")[0])&&(i=(Number(i.split("%")[0])/100).toString()),i!=="")i=i.charCodeAt(0);else return r[W.Value];return i},o.prototype.ComputeDOLLAR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r,n;if(e.length&&e[e.length-1]==="nestedFormulaTrue"&&(n=!0,e.pop()),e.length===1&&(e[0]===""&&(r=!0),e.push("2")),g(e)||e.length!==2||r)return this.parent.formulaErrorStrings[pe.InvalidArguments];for(var s=0;s<e.length;s++)if(e[s].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(e[s])))return this.parent.getErrorStrings()[W.Value];var a=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join(""),l=this.parent.getValueFromArg(e[1]).split(this.parent.tic).join("");if(a=a===""||a===this.parent.falseValue?"0":a===this.parent.trueValue?"1":a,l=l===""||l===this.parent.falseValue?"0":l===this.parent.trueValue?"1":l,a==="#NAME?"||l==="#NAME?")return this.parent.getErrorStrings()[W.Name];if(a.toUpperCase().match(/^[-]?[0-9.]+$/)&&l.toUpperCase().match(/^[-]?[0-9.]+$/)){for(var h=new Et,u=parseInt(l,10),c=Math.pow(10,-1*u),d="",p=1;p<=u;p++)d+="0";var f=Math.round(this.parent.parseFloat(a)/c)*c;isNaN(f)?i=this.parent.getErrorStrings()[W.Value]:i=h.formatNumber(f,{format:"$#,##0."+d+";($#,##0."+d+");$0."+d})}else return this.parent.getErrorStrings()[W.Value];return n&&(i=this.parent.tic+i+this.parent.tic),i},o.prototype.ComputeSMALL=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r=this.parent.getErrorStrings();if(g(e)||e.length===1||e[0]==="")return e[0]===""&&e[1]===""?r[W.Num]:this.parent.formulaErrorStrings[pe.InvalidArguments];if(e.length>2)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];var n=[],s=[],a=[];if(!g(e[0])){var l=void 0;if(this.parent.isCellReference(e[0])){n=this.parent.getCellCollection(e[0]);for(var h=0;h<n.length;h++){if(l=this.parent.getValueFromArg(n[h]),r.indexOf(l)>-1)return l;s.push(l)}}else{if(l=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join(""),r.indexOf(l)>-1)return l;s.push(l)}for(var h=0;h<s.length;h++)s[h]!==""&&!isNaN(this.parent.parseFloat(s[h]))&&a.push(this.parent.parseFloat(s[h]));if(a.length===0&&(g(s[0])||e[0].indexOf(this.parent.tic)>-1))return r[W.Value]}a=a.sort(function(d,p){return d-p});var u;if(!g(e[1])){if(this.parent.isCellReference(e[1])){if(u=this.parent.getValueFromArg(e[1]),u==="")return r[W.Num];if(u.trim()==="")return r[W.Value];u.toUpperCase()===this.parent.trueValue?u="1":u.toUpperCase()===this.parent.falseValue&&(u="0")}else u=this.parent.getValueFromArg(e[1]).split(this.parent.tic).join("");if(r.indexOf(u)>-1)return u;if(u.trim()==="")return e[1].length>0?r[W.Value]:r[W.Num];if(isNaN(this.parent.parseFloat(u)))if(e[1].toUpperCase()===this.parent.trueValue)u="1";else if(e[1].toUpperCase()===this.parent.falseValue)u="0";else return r[W.Value]}var c=Number(u)<1?0:Math.floor(Number(u));return g(a[c-1])&&!isNaN(Number(c))?r[W.Num]:(i=a[c-1],i)},o.prototype.ComputeLARGE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r=this.parent.getErrorStrings();if(g(e)||e.length===1||e[0]==="")return e[0]===""&&e[1]===""?r[W.Num]:this.parent.formulaErrorStrings[pe.InvalidArguments];if(e.length>2)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];var n=[],s=[],a=[];if(!g(e[0])){var l=void 0;if(this.parent.isCellReference(e[0])){n=this.parent.getCellCollection(e[0]);for(var h=0;h<n.length;h++){if(l=this.parent.getValueFromArg(n[h]),r.indexOf(l)>-1)return l;s.push(l)}}else{if(l=this.parent.getValueFromArg(e[0]).split(this.parent.tic).join(""),r.indexOf(l)>-1)return l;s.push(l)}for(var h=0;h<s.length;h++)s[h]!==""&&!isNaN(this.parent.parseFloat(s[h]))&&a.push(this.parent.parseFloat(s[h]));if(a.length===0&&(g(s[0])||e[0].indexOf(this.parent.tic)>-1))return r[W.Value]}a=a.sort(function(d,p){return p-d});var u;if(!g(e[1])){if(this.parent.isCellReference(e[1])){if(u=this.parent.getValueFromArg(e[1]),u==="")return r[W.Num];if(u.trim()==="")return r[W.Value];u.toUpperCase()===this.parent.trueValue?u="1":u.toUpperCase()===this.parent.falseValue&&(u="0")}else u=this.parent.getValueFromArg(e[1]).split(this.parent.tic).join("");if(r.indexOf(u)>-1)return u;if(u.trim()==="")return e[1].length>0?r[W.Value]:r[W.Num];if(isNaN(this.parent.parseFloat(u)))if(e[1].toUpperCase()===this.parent.trueValue)u="1";else if(e[1].toUpperCase()===this.parent.falseValue)u="0";else return r[W.Value]}var c=Number(u)<1?0:Math.ceil(Number(u));return g(a[c-1])&&!isNaN(Number(c))?r[W.Num]:(i=a[c-1],i)},o.prototype.ComputeCHOOSE=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];if(g(t)||t[0]===""&&t.length===1)return this.parent.formulaErrorStrings[pe.InvalidArguments];if(t.length<2)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];var r=this.parent.getErrorStrings(),n=function(a){return a=e.parent.getValueFromArg(a),a.toUpperCase()===e.parent.trueValue?a="1":a.toUpperCase()===e.parent.falseValue&&(a="0"),a},s;if(s=n(t[0]),r.indexOf(s)>-1)return s;if(this.parent.isCellReference(t[0])){if(t[0].indexOf(":")>-1)return r[W.Value]}else s=this.parent.removeTics(s),s.split("%").length===2&&this.parent.isNumber(s.split("%")[0])&&(s=(Number(s.split("%")[0])*.01).toString());return s=Math.floor(this.parent.parseFloat(s)),s<1||isNaN(s)||g(t[s])?r[W.Value]:(s=t[s],s===""&&(s="0"),this.parent.isCellReference(s)?s.indexOf(":")>-1?r[W.Value]:this.parent.getValueFromArg(s):(s.indexOf(this.parent.tic)>-1&&(r.indexOf(s.split(this.parent.tic).join(""))>-1||this.parent.removeTics(s).match(/^(\d*\.\d+|\d+)\s*[-*/]\s*(\d*\.\d+|\d+)$/))&&(s=this.parent.removeTics(s)),s=this.parent.removeTics(this.parent.getValueFromArg(s)),s.indexOf(this.parent.tic+this.parent.tic)>-1?s.replace(/""/g,this.parent.tic):(s.split("%").length===2&&this.parent.isNumber(s.split("%")[0])&&(s=(Number(s.split("%")[0])*.01).toString()),s)))},o.prototype.ComputeSUMIF=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;if(i[0].indexOf(":")<0&&!this.parent.isCellReference(i[0])||i[2]&&i[2].indexOf(":")<0&&!this.parent.isCellReference(i[2]))return this.parent.formulaErrorStrings[pe.ImproperFormula];if(i.length>3||i.length<2)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];var r=this.parent.computeSumIfAndAvgIf(e,!1);return typeof r=="string"&&(this.parent.formulaErrorStrings.indexOf(r)||this.parent.getErrorStrings().indexOf(r))?r:r[0]},o.prototype.ComputeABS=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e,r="",n;if(e.length===0||e.length>1)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(i[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];var s=i[0].split(this.parent.tic).join("").trim();if(s===""||i[0].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(s)))return this.parent.getErrorStrings()[W.Value];if(this.parent.isCellReference(i[0])){if(r=this.parent.getValueFromArg(i[0]),this.parent.getErrorStrings().indexOf(r)>-1)return this.parent.getErrorStrings()[W.Value];if(r===this.parent.trueValue&&(r="1"),(r===""||r===this.parent.falseValue)&&(r="0"),n=this.parent.parseFloat(r),isNaN(n)&&!this.parent.isNumber(r))return this.parent.getErrorStrings()[W.Value]}else{if(r=this.parent.getValueFromArg(i[0]).split(this.parent.tic).join(),r===this.parent.trueValue&&(r="1"),r===this.parent.falseValue&&(r="0"),this.parent.getErrorStrings().indexOf(r)>-1)return r;if(n=this.parent.parseFloat(r),isNaN(n)&&!this.parent.isNumber(r))return this.parent.getErrorStrings()[W.Value]}return Math.abs(n)},o.prototype.ComputeAVERAGE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=!1;if(e.length&&e[e.length-1]==="isSubtotal"&&(i=!0,e.pop()),g(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];for(var r=e,n=0;n<r.length;n++)if(r[n].indexOf(":")>-1&&r[n].indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value];return this.parent.calculateAvg(r,i)},o.prototype.ComputeAVERAGEIF=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;if(i[0].indexOf(":")<0&&!this.parent.isCellReference(i[0]))return this.parent.formulaErrorStrings[pe.ImproperFormula];var r=this.parent.computeSumIfAndAvgIf(e,!0);return r[1]===0||r[0].toString()==="NaN"?this.parent.formulaErrorStrings[pe.Div]:typeof r=="string"&&(this.parent.formulaErrorStrings.indexOf(r)||this.parent.getErrorStrings().indexOf(r))?r:this.parent.parseFloat(r[0])/this.parent.parseFloat(r[1])},o.prototype.ComputeCONCATENATE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this.parent.getErrorStrings();if(g(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];for(var r=e,n="",s="",a=0;a<r.length;a++){var l=r[a];if(this.parent.isCellReference(l)){if(l.indexOf(":")>-1)if(this.isConcat)for(var h=this.parent.getCellCollection(l),u=0;u<h.length;u++){var c=this.parent.getValueFromArg(h[u]);n=n+c}else return i[W.Value];else{if(r.length===1&&r[0].indexOf(this.parent.tic)<0&&!sy(r[0]))return i[W.Name];s=this.parent.getValueFromArg(l)}if(i.indexOf(s)>-1)return s}else if(l.startsWith(this.parent.tic)&&l.endsWith(this.parent.tic)&&l.indexOf('""')>-1?(s=l.substring(1,l.length-1),s=s.replace(/""/g,'"')):(s=l.split(this.parent.tic).join(""),(!(!this.parent.isNumber(s)&&!g(this.parent.isDate(s)))||l.startsWith(" n"))&&(s=this.parent.getValueFromArg(l).split(this.parent.tic).join(""))),i.indexOf(s)>-1)return s;n+=s}return this.isConcat=!1,n},o.prototype.ComputeCONCAT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.isConcat=!0,this.ComputeCONCATENATE.apply(this,e)},o.prototype.ComputeMAX=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.parent.computeMinMax(e,"max")},o.prototype.ComputeMIN=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.parent.computeMinMax(e,"min")},o.prototype.ComputeRAND=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length===1&&e[0]===""&&(e.length=0),e.length>0?this.parent.formulaErrorStrings[pe.WrongNumberArguments]:Math.random().toString()},o.prototype.ComputeAND=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;return g(e)||i.length===1&&i[0]===""?this.parent.formulaErrorStrings[pe.InvalidArguments]:this.parent.computeAndOrNot(i,"and")},o.prototype.ComputeOR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;return g(e)||i.length===1&&i[0]===""?this.parent.formulaErrorStrings[pe.InvalidArguments]:this.parent.computeAndOrNot(i,"or")},o.prototype.ComputeNOT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;return g(e)||e.length>1||e[0]===""?this.parent.formulaErrorStrings[pe.WrongNumberArguments]:this.parent.computeAndOrNot(i,"not")},o.prototype.ComputeFIND=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r=this.parent.getErrorStrings();if(g(t)||t.length===1)return this.parent.formulaErrorStrings[pe.InvalidArguments];if(t.length>3)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];var n=function(h){var u=e.parent.getValueFromArg(h);return r.indexOf(u)>-1||e.parent.isCellReference(h)||(u.split("%").length===2&&e.parent.isNumber(u.split("%")[0])?u=(Number(u.split("%")[0])*.01).toString():h.indexOf(e.parent.tic)>-1&&(e.parent.removeTics(h).match(/^(\d*\.\d+|\d+)\s*[-*/]\s*(\d*\.\d+|\d+)$/)?u=e.parent.getValueFromArg(e.parent.removeTics(h)):u.indexOf(e.parent.tic+e.parent.tic)>-1&&(u=u.replace(/""/g,e.parent.tic)))),u},s;if(!g(t[0])){if(s=n(t[0]),r.indexOf(s)>-1)return s;this.parent.isCellReference(t[0])||(s=this.parent.removeTics(s))}var a;if(!g(t[1])){if(a=n(t[1]),r.indexOf(a)>-1)return a;this.parent.isCellReference(t[1])||(a=this.parent.removeTics(a))}var l=1;if(!g(t[2])){if(l=n(t[2]),r.indexOf(l)>-1)return l;if(l.toUpperCase()===this.parent.trueValue?l="1":l.toUpperCase()===this.parent.falseValue&&(l="0"),this.parent.isCellReference(t[2])||(l=this.parent.removeTics(l)),l=this.parent.parseFloat(l),isNaN(l)||l<=0)return r[W.Value]}return l=a.indexOf(s,l-1),l<0?r[W.Value]:(Number(l)+1).toString()},o.prototype.ComputeINDEX=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r,n,s=this.parent.getErrorStrings();if(t.length&&t[t.length-1]==="nestedFormulaTrue"&&(r=!0,t.pop()),g(t)||t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(t.length<2||t.length>4)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(t[0]==="")return s[W.Value];if(t[0].indexOf(":")===-1)return s[W.Ref];var a,l,h=function(v){if(g(v)||v==="")return 1;var m=e.parent.getValueFromArg(v);return s.indexOf(m)>-1?m:(m.toUpperCase()===e.parent.trueValue?m="1":m.toUpperCase()===e.parent.falseValue&&(m="0"),m.indexOf(e.parent.tic)>-1&&(m=e.parent.removeTics(m),v.indexOf(e.parent.tic)===-1||m.trim()==="")||(m.split("%").length===2&&e.parent.isNumber(m.split("%")[0])&&(m=(Number(m.split("%")[0])/100).toString()),m=parseInt(Number(m).toString(),10),isNaN(m)||m<0)?s[W.Value]:(m===0&&(m=1),m))};if(n=t[0],a=h(t[1]),s.indexOf(a.toString())>-1)return a.toString();if(l=h(t[2]),s.indexOf(l.toString())>-1)return l.toString();var u=n.indexOf(":"),c=this.parent.rowIndex(n.substring(0,u)),d=this.parent.rowIndex(n.substring(u+1)),p=this.parent.colIndex(n.substring(0,u)),f=this.parent.colIndex(n.substring(u+1));return a>d-c+1||l>f-p+1?s[W.Ref]:(a=c+a-1,l=p+l-1,n=this.parent.getValueFromArg(this.getSheetReference(n)+this.parent.convertAlpha(l)+a),n===""?0:r&&s.indexOf(n)===-1&&!this.parent.isNumber(n)&&n!==this.parent.trueValue&&n!==this.parent.falseValue?this.parent.tic+n+this.parent.tic:n)},o.prototype.getSheetReference=function(e){return e.indexOf(this.parent.sheetToken)===0&&e.lastIndexOf(this.parent.sheetToken)>e.indexOf(this.parent.sheetToken)?e.substring(0,e.lastIndexOf(this.parent.sheetToken)+1):""},o.prototype.ComputeIFS=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;if(g(e)||i.length===1&&i[0]===""||i.length%2!==0)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];for(var r="",n="",s=0;s<i.length;s++){if(r=this.parent.getValueFromArg(i[s]),i[s]==="")return this.parent.getErrorStrings()[W.NA];if(this.parent.getErrorStrings().indexOf(r)>-1)return r;if(r!==this.parent.trueValue&&r!==this.parent.falseValue)return this.parent.getErrorStrings()[W.Value];if(r===this.parent.trueValue)return this.parent.isCellReference(i[s+1].split(this.parent.tic).join(""))||i[s+1].includes(this.parent.arithMarker)?(n=this.parent.getValueFromArg(i[s+1]),n=n===""?"0":n):(n=i[s+1]===""?"0":this.parent.getValueFromArg(i[s+1]),n.indexOf(this.parent.tic)>-1&&(n=n.split(this.parent.tic).join(""))),s=s+1,n;r===this.parent.falseValue&&(s=s+1)}return this.parent.getErrorStrings()[W.NA]},o.prototype.ComputeCOUNTA=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=!1;if(e.length&&e[e.length-1]==="isSubtotal"&&(i=!0,e.pop()),g(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[pe.WrongNumberArguments];for(var r=e,n,s=0,a,l,h=0;h<r.length;h++)if(this.parent.isCellReference(r[h]))if(r[h].indexOf(":")>-1){n=this.parent.getCellCollection(r[h].split(this.parent.tic).join(""));for(var u=0;u<n.length;u++)a=i?this.parent.getValueFromArg(n[u],null,null,!0):this.parent.getValueFromArg(n[u]),!(i&&a.includes("SUBTOTAL("))&&a.length>0&&s++}else{if(a=i?this.parent.getValueFromArg(r[h],null,null,!0):this.parent.getValueFromArg(r[h]),i&&a.includes("SUBTOTAL("))continue;a.length>0&&s++}else l=this.parent.getValueFromArg(r[h]).split(this.parent.tic).join(""),(l.length>0||l.length===0&&l.trim()==="")&&s++;return s},o.prototype.ComputeAVERAGEA=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(g(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[pe.WrongNumberArguments];for(var i=e,r,n=0,s,a,l=0,h,u=0;u<i.length;u++)if(this.parent.isCellReference(i[u]))if(i[u].indexOf(":")>-1){r=this.parent.getCellCollection(i[u].split(this.parent.tic).join(""));for(var c=0;c<r.length;c++){if(s=this.parent.getValueFromArg(r[c]),s=this.processLogicalCellValue(s),this.parent.getErrorStrings().indexOf(s)>-1)return s;if(g(s)||s==="")continue;h=this.parent.parseFloat(s),s=isNaN(h)?0:h,n+=s,l=l+1}}else{if(s=this.parent.getValueFromArg(i[u]),s=this.processLogicalCellValue(s),this.parent.getErrorStrings().indexOf(s)>-1)return s;if(g(s)||s==="")continue;h=this.parent.parseFloat(s),s=isNaN(h)?0:h,n+=s,l=l+1}else{if(i[u].indexOf(this.parent.tic)>-1&&(isNaN(this.parent.parseFloat(i[u].split(this.parent.tic).join("")))||i[u].split(this.parent.tic).join("").trim()===""))return this.parent.getErrorStrings()[W.Value];if(i[u]=this.processLogicalCellValue(i[u]),a=this.parent.getValueFromArg(i[u].split(this.parent.tic).join("")),this.parent.getErrorStrings().indexOf(a)>-1)return a;n+=this.parent.parseFloat(a),l=l+1}return l===0?this.parent.getErrorStrings()[W.DivZero]:n/l},o.prototype.processLogicalCellValue=function(e){var t=e;return t.toUpperCase()===this.parent.trueValue?t="1":t.toUpperCase()===this.parent.falseValue&&(t="0"),t},o.prototype.ComputeSORT=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r,n;t.length&&t[t.length-1]==="nestedFormulaTrue"&&(r=!0,t.pop());var s=t,a,l=[];if(g(t)||t[0]===""||s.length>4)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];s[1]=s[1]?s[1]:"1",s[2]=s[2]?s[2]:"1",s[3]=s[3]?s[3]:"FALSE",s[0]=s[0].split("$").join("");var h,u=[];if(s[0].indexOf(":")>-1){var c=s[0].split(":");if(this.parent.isCellReference(c[0])&&this.parent.isCellReference(c[1])){var d=s[0].indexOf(":"),p=void 0,f=this.parent.rowIndex(this.parent.substring(s[0],0,d)),v=this.parent.colIndex(this.parent.substring(s[0],0,d)),m=this.parent.rowIndex(this.parent.substring(s[0],d+1,d+s[0].length-d-1)),y=this.parent.colIndex(this.parent.substring(s[0],d+1,d+s[0].length-d-1));if(f>m&&(p=m,m=f,f=p),v>y&&(p=y,y=v,v=p),this.parent.isCellReference(s[3])){if(s[3]=this.parent.getValueFromArg(s[3]).toUpperCase(),s[3]!==this.parent.trueValue&&s[3]!==this.parent.falseValue)if(Me(s[3]))s[3]=Number(s[3])===0?this.parent.falseValue:this.parent.trueValue;else if(s[3]==="")s[3]=this.parent.falseValue;else return this.parent.getErrorStrings()[W.Value]}else if(n=s[3].startsWith(this.parent.tic)&&s[3].endsWith(this.parent.tic),s[3]=this.parent.getValueFromArg(s[3]),s[3]=Me(s[3])?Number(s[3])===0?this.parent.falseValue:this.parent.trueValue:s[3].split(this.parent.tic).join("").toUpperCase(),s[3]!==this.parent.trueValue&&s[3]!==this.parent.falseValue)return this.parent.getErrorStrings()[n?W.Value:W.Name];if(this.parent.isCellReference(s[2])?(s[2]=this.parent.getValueFromArg(s[2]),s[2]=s[2]===this.parent.trueValue?"1":s[2]):(s[2]=this.parent.getValueFromArg(s[2]),s[2]=s[2]===this.parent.trueValue?"1":s[2].split(this.parent.tic).join("")),s[2]=Me(s[2])?Math.floor(Number(s[2])).toString():s[2],s[2]!=="1"&&s[2]!=="-1")return this.parent.getErrorStrings().indexOf(s[2])>-1?this.parent.getErrorStrings()[W.Name]:this.parent.getErrorStrings()[W.Value];var S=s[2]==="1"?"Ascending":"Descending";if(this.parent.isCellReference(s[1])){if(s[1]=this.parent.getValueFromArg(s[1]),s[1]=Me(s[1])?Math.floor(Number(s[1])).toString():s[1]===this.parent.trueValue?"1":s[1]===this.parent.falseValue?"0":s[1],isNaN(this.parseDouble(s[1]))||this.parseDouble(s[1])<1||(s[3]===this.parent.trueValue?m-f+1<this.parseDouble(s[1]):y-v+1<this.parseDouble(s[1])))return this.parent.getErrorStrings()[W.Value]}else if(n=s[1].startsWith(this.parent.tic)&&s[1].endsWith(this.parent.tic),s[1]=this.parent.getValueFromArg(s[1]),s[1]=Me(s[1])?Math.floor(Number(s[1])).toString():s[1]===this.parent.trueValue?"1":s[1]===this.parent.falseValue?"0":s[1].split(this.parent.tic).join(""),isNaN(this.parseDouble(s[1]))?n:this.parseDouble(s[1])<1||(s[3]===this.parent.trueValue?m-f+1<this.parseDouble(s[1]):y-v+1<this.parseDouble(s[1])))return this.parent.getErrorStrings()[W.Value];var b="";s[0].indexOf("!")===0&&(b=s[0],b=b.replace("!",""),b=b.indexOf("!"),b=s[0].substring(0,b+2)),s[0]=b+si(v)+f+":"+si(y)+m,h=this.parent.getCellCollection(s[0]);for(var w=0;w<h.length;w++)u.push(this.parent.getValueFromArg(h[w]));var I=[],x=[],M=[],D=[],A=[],L=y-v+1,T=function(ye){ye?ye.toUpperCase()==="TRUE"||ye.toUpperCase()==="FALSE"?(D.push(ye),I.push(ye)):isNaN(e.parseDouble(ye))?(M.push(ye),I.push(ye)):(x.push(e.parseDouble(ye)),I.push(e.parseDouble(ye))):ye===""&&(A.push(e.parseDouble(ye).toString()),I.push(e.parseDouble(ye).toString()))};if(s[3]==="TRUE")for(var w=0;w<L;w++)T(u[w+(this.parseDouble(s[1])-1)*L]);if(s[3]==="FALSE")for(var w=0;w<u.length;w++)T(u[w*L+this.parseDouble(s[1])-1]);for(var k=x.length>0?de.sort(x,null,de.fnSort(S)):[],F=M.length>0?de.sort(M,null,de.fnSort(S)):[],R=D.length>0?de.sort(D,null,de.fnSort(S)):[],N=S==="Ascending"?k.concat(F,R,A):R.concat(F,k,A),P=[],O=0;O<N.length;O++)for(var z=0;z<I.length;z++)JSON.stringify(N[O])===JSON.stringify(I[z])&&P.indexOf(z)===-1&&P.push(z);if(s[3]==="TRUE"){for(var H=f,Q=0;H<=m;H++,Q++)for(var O=0,$=0;O<P.length;O++,$++){var U=this.parent.getValueFromArg(b+si(P[O]+v)+H);if(r&&U!==""){l.push(U);continue}U=U===""?"0":U;var ie=this.parent.actCell;ie=ie.indexOf("!")>-1?ie.substring(ie.lastIndexOf("!")+1):ie;var ne=this.parent.rowIndex(ie),te=this.parent.colIndex(ie);this.parent.parentObject.setValueRowCol(this.parent.getSheetID(this.parent.grid)+1,U,ne+Q,te+$)}a=this.parent.getValueFromArg(b+si(P[0]+v)+f)}if(s[3]==="FALSE"){for(var O=0,Q=0;O<P.length;O++,Q++)for(var oe=v,$=0;oe<=y;oe++,$++){var ae=this.parent.getValueFromArg(b+si(oe)+(P[O]+f));if(r&&ae!==""){l.push(ae);continue}ae=ae===""?"0":ae;var ie=this.parent.actCell;ie=ie.indexOf("!")>-1?ie.substring(ie.lastIndexOf("!")+1):ie;var te=this.parent.colIndex(ie),ne=this.parent.rowIndex(ie);this.parent.parentObject.setValueRowCol(this.parent.getSheetID(this.parent.grid)+1,ae,ne+Q,te+$)}a=this.parent.getValueFromArg(b+si(v)+(P[0]+f))}}}return r?l.join(","):a===""?"0":a},o.prototype.ComputeCOUNTIF=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;if(g(e)||e[0]===""||i.length!==2)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(i[0].indexOf(":")<0&&!this.parent.isCellReference(i[0]))return this.parent.getErrorStrings()[W.Name];var r,n=0,s,a=[],l="equal";if(i[1]==="")return 0;var h=i[1].startsWith(this.parent.tic)&&i[1].endsWith(this.parent.tic),u=i[1].split(this.parent.tic).join(""),c=u.includes("*"),d=u==="*"||u==="<>*",p=c&&!d?u.replace(/\*/g,"").trim():u,f=!1;if(!h&&this.parent.isCellReference(p)&&(p=this.parent.getValueFromArg(p),f=!0),c&&!d){var v=u.indexOf("*");u[0]==="*"&&(p="*"+p),u[u.length-1]==="*"&&(p+="*"),v>0&&v<u.length-1&&(p=u.substring(0,v)+"*"+u.substring(v+1))}u=p,u.startsWith("<=")?(l="lessEq",u=u.substring(2)):u.startsWith(">=")?(l="greaterEq",u=u.substring(2)):u.startsWith("<>")?(l="notEq",u=u.substring(2)):u.startsWith("<")?(l="less",u=u.substring(1)):u.startsWith(">")?(l="greater",u=u.substring(1)):u.startsWith("=")&&(l="equal",u=u.substring(1));var m=u.indexOf("*")>-1||u.indexOf("?")>-1;if((!h&&this.parent.isCellReference(u)&&!f||u.includes(this.parent.arithMarker)||u.includes(this.parent.getParseDecimalSeparator())&&!m)&&(u=this.parent.getValueFromArg(u)),i[0].indexOf(":")>-1&&this.parent.isCellReference(i[0])){r=this.parent.getCellCollection(i[0].split(this.parent.tic).join(""));for(var y=0;y<r.length;y++)s=this.parent.getValueFromArg(r[y]),m&&(s=this.parent.findWildCardValue(u.toLowerCase(),s.toLowerCase())),a.push(s),a.push(u),this.parent.processLogical(a,l)===this.parent.trueValue&&n++}return n},o.prototype.ComputeSUMIFS=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this.calculateIFS(e);return i},o.prototype.calculateIFS=function(e,t){var i=this;if(g(e)||e[0]===""||e.length<2||e.length>127)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(e.length===3&&e[2].includes(this.parent.tic+this.parent.tic)){var r="",n,s=this.parent.getParseArgumentSeparator(),a=e[2].split(this.parent.tic+this.parent.tic);return a.forEach(function(l){l=l.trim().split(i.parent.tic).join(""),l&&(n=i.parent.computeIfsFormulas([e[0],e[1],l],i.parent.falseValue,t).toString(),r+=(r?s:"")+n)}),r}return this.parent.computeIfsFormulas(e,this.parent.falseValue,t)},o.prototype.ComputeTEXT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i;e.length&&e[e.length-1]==="nestedFormulaTrue"&&(i=!0,e.pop());var r=e.length,n=e[0],s=e[1];if(r!==2)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];var a=n,l=s;if(s==="")return this.parent.getValueFromArg(a);var h=new Date(1900,0,1,0,0,0),u=a+","+l,c=new Et;if(this.parent.getErrorStrings().indexOf(u)>-1)return u;if(a=this.parent.getValueFromArg(a),Me(a.split(this.parent.tic).join(""))&&(a=a.split(this.parent.tic).join("")),s.startsWith('"')&&s.endsWith('"')?l=l.split(this.parent.tic).join(""):l=this.parent.getValueFromArg(l),l==="")return"";a===""&&(l.length>0&&(l.toUpperCase().indexOf("M")>-1||l.toUpperCase().indexOf("D")>-1||l.toUpperCase().indexOf("Y")>-1||l.toUpperCase().indexOf("S")>-1||l.toUpperCase().indexOf("T")>-1)||l.toUpperCase().indexOf("H")>-1)&&(a=h.toString());var d=this.parseDouble(a);if(isNaN(d)&&this.parent.isDate(new Date(a))!==null&&(d=this.parent.toOADate(new Date(a))),h=Date.parse(a.split(this.parent.tic).join("")),!isNaN(d)||!isNaN(h))if(l.length>0&&l.indexOf("#")===-1&&(l.toUpperCase().indexOf("M")>-1||l.toUpperCase().indexOf("D")>-1||l.toUpperCase().indexOf("Y")>-1||l.toUpperCase().indexOf("S")>-1||l.toUpperCase().indexOf("T")>-1)||l.toUpperCase().indexOf("H")>-1){l=l.split("Y").join("y").split("D").join("d").split("H").join("h"),l=l.split("S").join("s").split("m").join("M").split("AM/PM").join("tt");var p=l.split(""),f=!1,v=!1,m=0,y=0;for(m=0;m<p.length;){var S=p[m];S==="s"&&p[y]==="M"&&(p[y]="m",p[y-1]==="M"&&(p[y-1]="m")),this.parent.isChar(S)&&(y=m),S==="M"&&f&&(p[m]="m",v=!0),S==="h"?f=!0:this.parent.isChar(S)&&S!=="M"&&S!=="h"&&!v&&(f=!1,v=!1),m++}l=String(p),l=l.split(",").join("").split(`
`).join(" ");var b=this.parent.fromOADate(d);d===0&&(b=h);var w=K6(l);if(w===""){var I=Ms(b),x=this.parent.parentObject.getDisplayText({format:l,value:I});return x}var M=c.getDateFormat({skeleton:w,type:"date"}),D=M(new Date(b.toString()));a=D}else a=this.parent.parentObject.getDisplayText({format:l,value:d});return i?this.parent.tic+a+this.parent.tic:a},o.prototype.ComputeCOUNTIFS=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this.parent.computeIfsFormulas(e,this.parent.trueValue);return i},o.prototype.ComputeAVERAGEIFS=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this.calculateIFS(e,this.parent.trueValue);return i},o.prototype.ComputeMATCH=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e.slice(),r=this.parent.getErrorStrings();if(g(i)||i.length===1&&i[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(i.length<2||i.length>3)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];i[0]=this.parent.getValueFromArg(e[0]);var n=i[0].indexOf(this.parent.tic)>-1;if(i[0]=i[0].split(this.parent.tic).join(""),r.indexOf(i[0])>-1)return i[0];if(i[0]==="")return r[W.NA];isNaN(Number(i[0]))&&(n=!0);var s;if(g(e[2]))i[2]="1";else{if(i[2]=this.parent.getValueFromArg(i[2]),i[2].indexOf(this.parent.tic)>-1&&isNaN(Number(i[2].split(this.parent.tic).join(""))))return r[W.Value];i[2].toUpperCase()===this.parent.trueValue?i[2]="1":i[2].toUpperCase()===this.parent.falseValue&&(i[2]="0")}s=parseFloat(i[2]),[-1,0,1].indexOf(s)===-1&&(s=0);var a=[],l,h=!1;if(i[1].indexOf(":")>-1||this.parent.isCellReference(i[1])){l=this.parent.getCellCollection(i[1]);for(var u=0;u<l.length;u++){var c=this.parent.getValueFromArg(l[u]);(c.indexOf(this.parent.tic)>-1||isNaN(Number(c)))&&(h=!0),a[u]=c.split(this.parent.tic).join("")}if(n&&!h||!n&&h)return r[W.NA]}for(var d=0,p="",f=!1,v=isNaN(Number(i[0]))?i[0]:Number(i[0]),m=0;m<a.length;m++){if(a[m]===""){m===a.length-1&&a.pop();continue}else if(s===-1&&(n||h))break;var y=isNaN(Number(a[m]))?a[m]:Number(a[m]);if(s===1)v===y?(d=m+1,f=!0,isNaN(Number(i[0]))&&(n=!1)):v>y&&!n&&!f&&(!p||y>(isNaN(Number(p))?p:Number(p)))&&(d=m+1,p=a[m]);else if(s===0){if((i[0].indexOf("*")>-1||i[0].indexOf("?")>-1)&&(a[m]=this.parent.findWildCardValue(i[0],a[m])),i[0]===a[m])return m+1}else if(s===-1)if(Number(a[m])>Number(a[m+1])||m===a.length-1)v===y?(d=m+1,v=void 0):v<y&&(!p||y<(isNaN(Number(p))?p:Number(p)))&&(d=m+1,p=a[m]);else return r[W.NA]}return n&&h&&s===1?a.length:d||r[W.NA]},o.prototype.ComputeLOOKUP=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;return g(i)||i.length===1&&i[0]===""?this.parent.formulaErrorStrings[pe.WrongNumberArguments]:this.parent.computeLookup(i)},o.prototype.ComputeVLOOKUP=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;return this.parent.computeVHLookup(i,!0)},o.prototype.ComputeHLOOKUP=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;return this.parent.computeVHLookup(i)},o.prototype.ComputeSUBTOTAL=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r=this.parent.getErrorStrings();if(g(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e.length<2)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(i=this.parent.getValueFromArg(e[0]).trim(),r.indexOf(i)>-1)return i;if(i.split(this.parent.tic).join("").trim()===""||(this.parent.isCellReference(e[0])||(i=this.parent.removeTics(i)),i.toUpperCase()===this.parent.trueValue?i="1":i.toUpperCase()===this.parent.falseValue?i="0":i.split("%").length===2&&this.parent.isNumber(i.split("%")[0])&&(i=(Number(i.split("%")[0])/100).toString()),i=this.parent.parseFloat(i),isNaN(i)||(1>i||i>11)&&(101>i||i>111)))return r[W.Value];var n=e.slice(1,e.length);switch(i){case 1:case 101:i=this.ComputeAVERAGE.apply(this,n.concat(["isSubtotal"]));break;case 2:case 102:i=this.ComputeCOUNT.apply(this,n.concat(["isSubtotal"]));break;case 3:case 103:i=this.ComputeCOUNTA.apply(this,n.concat(["isSubtotal"]));break;case 4:case 104:i=this.ComputeMAX.apply(this,n.concat(["isSubtotal"]));break;case 5:case 105:i=this.ComputeMIN.apply(this,n.concat(["isSubtotal"]));break;case 6:case 106:i=this.ComputePRODUCT.apply(this,n.concat(["isSubtotal"]));break;case 7:case 107:i=this.ComputeDAY.apply(this,n);break;case 8:case 108:i=this.ComputeCONCAT.apply(this,n);break;case 9:case 109:i=this.ComputeSUM.apply(this,n.concat(["isSubtotal"]));break;case 10:case 110:i=this.ComputeAVERAGEA.apply(this,n);break;case 11:case 111:i=this.ComputeABS.apply(this,n);break;default:i=r[W.Value];break}return i},o.prototype.ComputeRADIANS=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r=this.parent.getErrorStrings();if(g(e)||e[0]===""&&e.length===1||e[0].split("!").length===2&&e[0].indexOf(this.parent.tic)===-1)return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e.length>1)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(e[0].indexOf(":")>-1||e[0].split(this.parent.tic).join("").trim()===""||e[0].split(this.parent.tic).join("").trim()==="!"||e[0].split("!").length===2)return r[W.Value];if(i=this.parent.getValueFromArg(e[0]).trim(),r.indexOf(i)>-1)return i;if(i.indexOf(this.parent.tic)>-1&&e[0].indexOf(this.parent.tic)===-1||i.split(this.parent.tic).length>3)return r[W.Value];if(i.toUpperCase()===this.parent.trueValue?i="1":i.toUpperCase()===this.parent.falseValue?i="0":i.split("%").length===2&&this.parent.isNumber(i.split("%")[0])&&(i=(Number(i.split("%")[0])/100).toString()),i=this.parent.parseFloat(i.split(this.parent.tic).join("")),!isNaN(i))i=Math.PI*i/180;else return this.parent.isCellReference(e[0])||e[0].indexOf(this.parent.tic)>-1?r[W.Value]:r[W.Name];return i},o.prototype.ComputeRANDBETWEEN=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r,n;if(t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(t.length!==2)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];var s=this.parent.getErrorStrings(),a=function(l){var h;if(h=e.parent.getValueFromArg(l),s.indexOf(h)>-1)return h;if(e.parent.isCellReference(l)){if(h==="")h="0";else if(l.indexOf(":")>-1||h.match(/^(\d*\.\d+|\d+)\s*[+\-*/]\s*(\d*\.\d+|\d+)$/))return s[W.Value]}else{if(h==="")return s[W.NA];if(l.indexOf(e.parent.tic)>-1&&e.parent.removeTics(l).match(/^(\d*\.\d+|\d+)\s*[+*]\s*(\d*\.\d+|\d+)$/))return s[W.Value];if(h.indexOf(e.parent.tic)>-1&&(h=e.parent.removeTics(h),h.indexOf(":")>-1)){var u=h.split(":");if(u.length<=3){if(!e.parent.isNumber(u[0])||!e.parent.isNumber(u[1]))return s[W.Value];var c=Number(u[0])+Number(Number(u[1])/60);if(u.length===3){if(!e.parent.isNumber(u[2]))return s[W.Value];c+=Number(Number(u[2])/3600)}h=(c/24).toString()}else return s[W.Value]}h.split("%").length===2&&e.parent.isNumber(h.split("%")[0])&&(h=(Number(h.split("%")[0])*.01).toString())}return h=parseFloat(h),isNaN(h)?s[W.Value]:h};return n=a(t[1]),s.indexOf(n)>-1?n:(r=a(t[0]),s.indexOf(r)>-1?r:r===0&&n===0?"0":n<r?s[W.Num]:(r=Math.ceil(r),n=Math.floor(n),Math.floor(Math.random()*(n-r+1)+r)))},o.prototype.ComputeSLOPE=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r=this.parent.getErrorStrings();if(g(t)||t.length===1&&t[0].trim()==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(t.length!==2)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(t[0]===""||t[1]==="")return r[W.Value];var n=function(y){return y.indexOf(e.parent.tic)===-1?y=e.parent.getCellCollection(y.split(e.parent.tic).join("")):y=void 0,y},s=n(t[0].trim()),a=n(t[1].trim());if(g(s)||g(a)||s.length<2&&a.length<2)return r[W.DivZero];if(s.length!==a.length)return r[W.NA];var l=function(y){y=e.getDataCollection(y);for(var S=0;S<y.length;S++)if(r.indexOf(y[S])>-1)return y[S].toString();return y};if(s=l(s),r.indexOf(s.toString())>-1)return s.toString();if(a=l(a),r.indexOf(a.toString())>-1)return a.toString();for(var h=0,u=0,c=0,d=0,p=0,f=0,v=a.length;f<v;++f)a[f]!==""&&Number(a[f]).toString()!=="NaN"&&s[f]!==""&&Number(s[f]).toString()!=="NaN"&&(h+=Number(a[f])*Number(s[f]),c+=Number(a[f]),d+=Number(s[f]),u+=Number(a[f])*Number(a[f]),p++);var m=((h-c*d/p)/(u-c*c/p)).toString();return m==="NaN"?r[W.DivZero]:m},o.prototype.ComputeINTERCEPT=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r=this.parent.getErrorStrings();if(g(t)||t.length===1&&t[0].trim()==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(t.length!==2)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(t[0]===""||t[1]==="")return r[W.Value];var n=function(y){return y.indexOf(e.parent.tic)===-1?y=e.parent.getCellCollection(y.split(e.parent.tic).join("")):y=void 0,y},s=n(t[0].trim()),a=n(t[1].trim());if(g(s)||g(a)||s.length<2&&a.length<2)return r[W.DivZero];if(s.length!==a.length)return r[W.NA];var l=function(y){y=e.getDataCollection(y);for(var S=0;S<y.length;S++)if(r.indexOf(y[S])>-1)return y[S];return y};if(s=l(s),r.indexOf(s.toString())>-1)return s.toString();if(a=l(a),r.indexOf(a.toString())>-1)return a.toString();var h=0,u=0,c=0,d=0,p=0,f,v=function(y){for(var S=0,b=a.length;S<b;++S)s[S]!==""&&Number(s[S]).toString()!=="NaN"&&a[S]!==""&&Number(a[S]).toString()!=="NaN"&&(y?(h+=Number(s[S]),u+=Number(a[S]),c++):(f=Number(a[S])-u,d+=f*(Number(s[S])-h),p+=f*f))};v(!0),h=h/c,u=u/c,v(!1);var m=(h-d/p*u).toString();return m==="NaN"?r[W.DivZero]:m},o.prototype.ComputeLN=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r=this.parent.getErrorStrings();return g(e)||e[0]===""&&e.length===1?this.parent.formulaErrorStrings[pe.InvalidArguments]:e.length===0||e.length>1?this.parent.formulaErrorStrings[pe.WrongNumberArguments]:(i=this.parent.getValueFromArg(e[0]),r.indexOf(i)>-1?i:(i.toUpperCase()===this.parent.trueValue?i="1":i.toUpperCase()===this.parent.falseValue&&(i="0"),!this.parent.isCellReference(e[0])&&(i=this.parent.removeTics(i),i.trim()==="")?r[W.Value]:(i.split("%").length===2&&this.parent.isNumber(i.split("%")[0])&&(i=(Number(i.split("%")[0])*.01).toString()),i=this.parent.parseFloat(i),i<=0?r[W.Num]:isNaN(i)?r[W.Value]:Math.log(i))))},o.prototype.ComputeISNUMBER=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e;if(e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e.length!==1)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];var r=this.parent.isCellReference(i[0])?this.parent.getValueFromArg(i[0]):this.parent.getValueFromArg(i[0].split(this.parent.tic).join(""));if(r.toString()===""||e.toString().startsWith(this.parent.tic))return!1;var n=this.parent.parseFloat(r);return!isNaN(n)},o.prototype.ComputeROUND=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!e.length||e.length===1||e.length>2)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];var i=e;if(e.length===1){var r=i[0].split(this.parent.tic).join("")==="TRUE"?"1":i[0].split(this.parent.tic).join("")==="FALSE"?"0":i[0];return isNaN(this.parent.parseFloat(r))?this.parent.formulaErrorStrings[pe.InvalidArguments]:Math.round(this.parent.parseFloat(r)).toString()}var n=this.parent.getValueFromArg(i[0]);if(this.parent.getErrorStrings().indexOf(n)>-1)return n;var s=this.parent.getValueFromArg(i[1]);if(this.parent.getErrorStrings().indexOf(s)>-1)return s;n=n==="TRUE"?"1":n==="FALSE"?"0":n,s=s==="TRUE"?"1":s==="FALSE"?"0":s,n=n.split(this.parent.tic).join(""),s=s.split(this.parent.tic).join("");var a=isNaN(Number(n))||n.trim()==="",l=isNaN(Number(s))||s.trim()==="";if((i[0].indexOf('"')>-1||this.parent.isCellReference(i[0]))&&a||(i[1].indexOf('"')>-1||this.parent.isCellReference(i[1]))&&l)return this.parent.getErrorStrings()[W.Value];if(n===""&&s===""||n==="")return 0;var h=this.parent.parseFloat(n),u=this.parent.parseFloat(s),c;if(!isNaN(u)&&!isNaN(h)&&u>0)c=this.parent.parseFloat(this.preciseRound(h,u,"ROUND"));else{var d=Math.pow(10,-u);c=Math.round(h/d)*d}return c.toString()},o.prototype.preciseRound=function(e,t,i){var r=Math.pow(10,t),n=Math.abs(e)*r,s=e>=0?1:-1,a=i==="ROUND"?Math.round(n):i==="ROUNDDOWN"?Math.floor(n):Math.ceil(n);return(s*(a/r)).toFixed(t)},o.prototype.ComputePOWER=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r,n=this.parent.getErrorStrings();if(g(t)||t.length===1&&t[0].trim()==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(t.length>2)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(t[0].trim()===""&&t[1].trim()==="")return n[W.Num];var s=function(h){var u=e.parent.getValueFromArg(h);if(n.indexOf(u)>-1)return u;if(u.toUpperCase()===e.parent.trueValue?u="1":u.toUpperCase()===e.parent.falseValue&&(u="0"),u.indexOf(e.parent.tic)>-1&&(u=e.parent.removeTics(u),h.indexOf(e.parent.tic)===-1||u.trim()===""))return n[W.Value];if(u.split("%").length===2&&e.parent.isNumber(u.split("%")[0]))u=(Number(u.split("%")[0])/100).toString();else if(u.indexOf("/")>-1&&e.parent.isNumber(u.split("/").join("")))return n[W.Num];return u=e.parent.parseFloat(u),isNaN(u)?n[W.Value]:u},a=s(t[0]);if(n.indexOf(a)>-1)return a;var l=s(t[1]);if(n.indexOf(l)>-1)return l;if(!isNaN(a)&&!isNaN(l)){if(a===0&&l<0)return n[W.DivZero];if(a===0&&l===0||(r=Math.pow(a,l),isNaN(r)||r===1/0))return n[W.Num]}else return n[W.Value];return r.toString()},o.prototype.ComputeSQRT=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r=e[0];if(e.length===0||e.length>1||r==="")return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(r.split(this.parent.tic).join("").trim()==="")return this.parent.getErrorStrings()[W.Value];if(this.parent.isCellReference(r)){if(i=this.parent.getValueFromArg(r)||"0",i.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value]}else{if(r.indexOf(this.parent.tic)>-1&&(r.split(this.parent.tic).join("")===this.parent.trueValue||r.split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];i=this.parent.getValueFromArg(r).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(i)>-1)return i;if(i=i===this.parent.trueValue?"1":i===this.parent.falseValue?"0":i,this.parent.parseFloat(i)<0)return this.parent.getErrorStrings()[W.Num];if(isNaN(this.parent.parseFloat(i))){var n={value:i};if(this.parent.parentObject.notify(Jr,n),n.isDate||n.isTime)i=n.updatedVal;else return this.parent.getErrorStrings()[W.Value]}return Math.sqrt(this.parent.parseFloat(i))},o.prototype.ComputeLOG=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r,n,s=this.parent.getErrorStrings();if(g(t)||t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[pe.InvalidArguments];if(t.length>2)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];var a=function(l){var h=e.parent.getValueFromArg(l);if(h===e.parent.trueValue?h="1":h===e.parent.falseValue&&(h="0"),!e.parent.isCellReference(l)&&h!==""){if(h.indexOf(e.parent.tic)>-1&&s.indexOf(h.split(e.parent.tic).join(""))===-1){if(h=e.parent.removeTics(h),h.trim()==="")return s[W.Value];if(h.indexOf(":")>-1){var u=h.split(":");if(u.length<=3){if(!e.parent.isNumber(u[0])||!e.parent.isNumber(u[1]))return s[W.Value];var c=Number(u[0])+Number(Number(u[1])/60);if(u.length===3){if(!e.parent.isNumber(u[2]))return s[W.Value];c+=Number(Number(u[2])/3600)}h=(c/24).toString()}else return s[W.Value]}}h.split("%").length===2&&e.parent.isNumber(h.split("%")[0])&&(h=(Number(h.split("%")[0])*.01).toString())}return h};if(!g(t[0])){if(r=a(t[0]),s.indexOf(r)>-1)return r;r=this.parent.parseFloat(r)}if(n=10,!g(t[1])){if(n=a(t[1]),s.indexOf(n)>-1)return n;n=this.parent.parseFloat(n)}return r=Number(r),isNaN(r)||isNaN(n)?s[W.Value]:r<=0||n<=0?s[W.Num]:n===1?s[W.DivZero]:(Math.log(r)/Math.LN10/(Math.log(n)/Math.LN10)).toString()},o.prototype.ComputeTRUNC=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r,n=0,s=this.parent.getErrorStrings();if(g(t)||t[0]===""&&t.length===1)return this.parent.formulaErrorStrings[pe.InvalidArguments];if(t.length===0||t.length>2)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];var a=function(l){var h=e.parent.getValueFromArg(l);if(s.indexOf(h)>-1)return h;if(h===e.parent.trueValue)h="1";else if(h===e.parent.falseValue)h="0";else if(!e.parent.isCellReference(l)){if(l.indexOf(e.parent.tic)>-1&&e.parent.removeTics(l).match(/^(\d*\.\d+|\d+)\s*[*]\s*(\d*\.\d+|\d+)$/))h=e.parent.getValueFromArg(e.parent.removeTics(l));else if(h.indexOf(e.parent.tic)>-1){if(h=e.parent.removeTics(h),h.trim()==="")return s[W.Value];if(h.indexOf(":")>-1){var u=h.split(":");if(u.length<=3){if(!e.parent.isNumber(u[0])||!e.parent.isNumber(u[1]))return s[W.Value];var c=Number(u[0])+Number(Number(u[1])/60);if(u.length===3){if(!e.parent.isNumber(u[2]))return s[W.Value];c+=Number(Number(u[2])/3600)}h=(c/24).toString()}else return s[W.Value]}}h.split("%").length===2&&e.parent.isNumber(h.split("%")[0])&&(h=(Number(h.split("%")[0])*.01).toString())}return h};if(!g(t[0])){if(r=a(t[0]),s.indexOf(r)>-1)return r;if(r=this.parent.parseFloat(r),isNaN(r))return s[W.Value]}if(!g(t[1])){if(n=a(t[1]),s.indexOf(n)>-1)return n;if(n=this.parent.parseFloat(n),isNaN(n))return s[W.Value]}return n=Math.pow(10,Math.floor(n)),r=Number(r),((r<0?-1:1)*Math.floor(n*Math.abs(r))/n).toString()},o.prototype.ComputeEXP=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,r=this.parent.getErrorStrings();if(e[0]===""&&e.length===1)return this.parent.formulaErrorStrings[pe.InvalidArguments];if(e.length!==1)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(e[0].split(this.parent.tic).join("").trim()==="")return r[W.Value];if(i=this.parent.getValueFromArg(e[0]),r.indexOf(i)>-1)return i;if(i.indexOf(this.parent.tic)>-1&&(this.parent.isCellReference(e[0])||isNaN(Number(i.split(this.parent.tic).join("")))))return r[W.Value];if(i=i.split(this.parent.tic).join(""),i===this.parent.trueValue)i="1";else if(i===this.parent.falseValue||i==="")i="0";else if(i.indexOf("%")>-1)i=(Number(i.split("%")[0])/100).toString();else if(i.indexOf(":")>-1)return"0";var n=this.parent.parseFloat(i);return isNaN(n)?r[W.Value]:n>709?r[W.Num]:Math.exp(n).toString()},o.prototype.ComputeGEOMEAN=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e,r=1,n=0,s=0,a=0,l,h,u,c;if(e.length===0)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(i.length===1&&i[0]==="")return r.toString();var d;for(h=0;h<i.length;h++)if(i[h].indexOf(":")>-1){if(i[0]===this.parent.tic)return this.parent.getErrorStrings()[W.Value];for(c=this.parent.getCellCollection(i[h].split(this.parent.tic).join("")),u=0;u<c.length;u++){if(s=this.parent.getValueFromArg(c[u]),a=s.split(this.parent.tic).join(""),d=a===this.parent.trueValue||a===this.parent.falseValue,l=this.parent.parseFloat(s),l<=0)return this.parent.getErrorStrings()[W.Num];d||this.parent.getErrorStrings().indexOf(s)>-1||isNaN(l)||(n++,r=r*l)}}else{if(s=this.parent.getValueFromArg(i[h]),this.parent.getErrorStrings().indexOf(s)>-1)return s;var p=s.split(this.parent.tic).join("");if(s.indexOf('"')>-1&&isNaN(this.parent.parseFloat(p)))return this.parent.getErrorStrings()[W.Value];if(i[h]=i[h].startsWith("n")?i[h].slice(1):i[h],s===""&&i[h]==="")return this.parent.getErrorStrings()[W.Num];if((p==="TRUE"||p==="FALSE")&&this.parent.isCellReference(i[h]))continue;if(s.length>0){if(s=s.indexOf('"')>-1?p:s,s=s.split(this.parent.tic).join("")==="TRUE"?"1":s.split(this.parent.tic).join("")==="FALSE"?"0":s,!this.parent.isCellReference(i[h])&&isNaN(this.parent.parseFloat(s)))return this.parent.getErrorStrings()[W.Value];if(l=this.parent.parseFloat(s),l<=0)return this.parent.getErrorStrings()[W.Num];isNaN(l)||(n++,r=r*l)}}return n>0&&(r=Math.pow(r,1/n)),r.toString()},o.prototype.ComputeRSQ=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=0,r=e;if(r.length!==2)return this.parent.formulaErrorStrings[pe.WrongNumberArguments];if(r[0]===""||r[1]==="")return this.parent.getErrorStrings()[W.Value];if(r[0].includes('"')||r[1].includes('"'))return this.parent.getErrorStrings()[W.NA];if(r[0].indexOf(":")===-1&&Mr(r[0])&&r[1].indexOf(":")===-1&&Mr(r[1]))return this.parent.getErrorStrings()[W.DivZero];var n=this.parent.getCellCollection(r[0]),s=this.parent.getCellCollection(r[1]);if(n.length!==s.length)return this.parent.getErrorStrings()[W.NA];for(var a=this.getDataCollection(s),l=0;l<a.length;l++)if(this.parent.getErrorStrings().indexOf(a[l])>-1)return a[l];for(var h=this.getDataCollection(n),u=0;u<h.length;u++)if(this.parent.getErrorStrings().indexOf(h[u])>-1)return h[u];for(var c,d,p=0;p<a.length;p++)c=Number(a[p]),d=Number(h[p]),Me(c)&&Me(d)&&i++;if(i<=1)return this.parent.getErrorStrings()[W.DivZero];if(i===2)return 1;var f=this.getMeanArray(a,h),v=f[0],m=f[1],y=this.getCorrelation(a,h,v,m);return Math.pow(y,2)},o.prototype.getCorrelation=function(e,t,i,r){for(var n=0,s=0,a=0,l,h,u=0;u<e.length;u++)Me(e[u])&&Me(t[u])&&(h=Number(e[u])-i,l=Number(t[u])-r,n+=h*l,s+=Math.pow(h,2),a+=Math.pow(l,2));var c=n/Math.sqrt(s*a);return c},o.prototype.getMeanArray=function(e,t){for(var i=0,r=0,n=0,s=0,a=0,l=0;l<e.length;l++)Me(e[l])&&Me(t[l])&&(r+=Number(e[l]),n+=Number(t[l]),i++);return s=r/i,a=n/i,[s,a]},o.prototype.getDataCollection=function(e){for(var t=[],i=0,r=e.length;i<r;i++)t.push(this.parent.getValueFromArg(e[i]));return t},o.prototype.parseDouble=function(e){var t=this.parent.parseFloat(e.toString());return isNaN(t)?NaN:t},o.prototype.spreadsheetDisplayText=function(e){if(this.parent.parentObject&&this.parent.parentObject.element&&this.parent.parentObject.element.classList.contains("e-spreadsheet")&&this.parent.isCellReference(e)){var t=this.parent.parentObject.getIndexes(e);e=this.parent.parentObject.getDisplayText(this.parent.parentObject.getActiveSheet().rows[t.startIdx].cells[t.endIdx])}return e},o.prototype.spreadsheetFormat=function(e){if(this.parent.parentObject&&this.parent.parentObject.element&&this.parent.parentObject.element.classList.contains("e-spreadsheet")&&this.parent.isCellReference(e)){var t=this.parent.parentObject.getIndexes(e);e=this.parent.parentObject.getActiveSheet().rows[t.startIdx].cells[t.endIdx].format}return e},o}(),eq=function(){function o(e){this.emptyStr="",this.storedStringText=this.emptyStr,this.sheetToken="!",this.tokenAdd="a",this.tokenSubtract="s",this.tokenMultiply="m",this.tokenDivide="d",this.tokenLess="l",this.charEm="r",this.charEp="x",this.tokenGreater="g",this.tokenEqual="e",this.tokenLessEq="k",this.tokenGreaterEq="j",this.tokenNotEqual="o",this.tokenAnd="c",this.tokenEm="v",this.tokenEp="t",this.tokenOr="~",this.charAnd="i",this.charLess="<",this.charGreater=">",this.charEqual="=",this.charLessEq="f",this.charGreaterEq="h",this.charNoEqual="z",this.stringGreaterEq=">=",this.stringLessEq="<=",this.stringNoEqual="<>",this.stringAnd="&",this.stringOr="^",this.charOr="w",this.charAdd="+",this.charSubtract="-",this.charMultiply="*",this.charDivide="/",this.fixedReference="$",this.spaceString=" ",this.ignoreBracet=!1,this.isError=!1,this.isFormulaParsed=!1,this.findNamedRange=!1,this.stringsColl=new Map,this.tokens=[this.tokenAdd,this.tokenSubtract,this.tokenMultiply,this.tokenDivide,this.tokenLess,this.tokenGreater,this.tokenEqual,this.tokenLessEq,this.tokenGreaterEq,this.tokenNotEqual,this.tokenAnd,this.tokenOr],this.charNOTop="\xA7",this.specialSym=["~","@","#","?"],this.isFailureTriggered=!1,this.parent=e}return o.prototype.parse=function(e,t){var i=this;if(this.parent.isTextEmpty(e))return e;if(Z6(e))return this.parent.getErrorStrings()[W.Ref];this.parent.getFormulaCharacter()!=="\0"&&this.parent.getFormulaCharacter()===e[0]&&(e=e.substring(1)),(this.parent.namedRanges.size>0||this.parent.storedData.size>0)&&(e=this.checkForNamedRangeAndKeyValue(e),this.findNamedRange=!1),e=e.replace(/[-+*/&^]+/g,function(p){for(var f="";1<p.length;)switch(p.substring(0,2)){case"++":p="+"+p.substring(2);break;case"--":p="+"+p.substring(2);break;case"+-":p="-"+p.substring(2);break;case"-+":p="-"+p.substring(2);break;case"*+":p="*"+p.substring(2);break;case"/+":p="/"+p.substring(2);break;case"^+":p="^"+p.substring(2);break;case"&+":p="&"+p.substring(2);break;case"*-":case"/-":case"^-":case"&-":f=p.substring(0,1),p=p.substring(1);break;default:throw new os(i.parent.formulaErrorStrings[pe.InvalidExpression],!0)}return f+p}),e=e.split("-(-").join("(");var r=this.storeStrings(e);e=this.storedStringText;var n=0;if(g(r)&&(e=e.split(" ").join("")),e=e.split("=>").join(">="),e=e.split("=<").join("<="),(e[e.length-1]!==this.parent.arithMarker||this.indexOfAny(e,this.tokens)!==e.length-2)&&(e=e.toUpperCase()),e.indexOf(this.sheetToken)>-1){var s=this.parent.getSheetFamilyItem(this.parent.grid);if(s.sheetNameToParentObject!=null&&s.sheetNameToParentObject.size>0){e[0]!==this.sheetToken.toString()&&(e=this.parent.setTokensForSheets(e));var a=this.parent.getSheetToken(e.split(this.parent.tic).join(this.emptyStr)),l=this.checkScopedRange(e.split('"').join(this.emptyStr).split(this.sheetToken).join(""));g(a)&&a!==""&&this.parent.namedRanges.size>0&&l!==""&&(e=l)}}e=this.markLibraryFormulas(e);try{e=this.formulaAutoCorrection(e)}catch(p){var h={message:p.message,exception:p,isForceCalculable:p.formulaCorrection,computeForceCalculate:!1};if(!h.isForceCalculable)throw this.parent.formulaErrorStrings[pe.InvalidExpression];if(this.isFailureTriggered||(this.parent.trigger("onFailure",h),this.isFailureTriggered=!0),h.isForceCalculable&&h.computeForceCalculate)e=this.formulaAutoCorrection(e,h),this.parent.storedData.get(t).formulaText="="+e;else throw this.parent.formulaErrorStrings[pe.InvalidExpression]}if(!this.ignoreBracet)for(n=e.indexOf(")");n>-1;){var u=e.substring(0,n).lastIndexOf("(");if(u===-1)throw new os(this.parent.formulaErrorStrings[pe.MismatchedParentheses]);if(u===n-1)throw new os(this.parent.formulaErrorStrings[pe.EmptyExpression]);var c=this.emptyStr;this.ignoreBracet?c=this.parent.substring(e,u,n-u+1):c=this.parent.substring(e,u+1,n-u-1);try{e=e.substring(0,u)+this.parseSimple(c)+e.substring(n+1)}catch(p){if(p===this.parent.formulaErrorStrings[pe.CircularReference])throw p;var h=this.exceptionArgs(p);this.isFailureTriggered||(this.parent.trigger("onFailure",h),this.isFailureTriggered=!0);var d=typeof h.exception=="string"?h.exception:h.message;return(this.parent.getErrorLine(p)?"":"#"+this.parent.getErrorLine(p)+": ")+d}n=e.indexOf(")")}if(!this.ignoreBracet&&e.indexOf("(")>-1)throw new os(this.parent.formulaErrorStrings[pe.MismatchedParentheses]);return e=this.parseSimple(e),r!==null&&r.size>0&&(e=this.setStrings(e,r)),e},o.prototype.exceptionArgs=function(e){return{message:e.message,exception:e,isForceCalculable:e.formulaCorrection,computeForceCalculate:!1}},o.prototype.formulaAutoCorrection=function(e,t){var i=["*","+","-","/","^","&"],r=[">","=","<"],n=0,s="",a="",l="",h="",u="",c="",d="",p=0;if(this.parent.formulaErrorStrings.indexOf(e)>-1)return e;if(this.indexOfAny(e,this.specialSym)>-1)throw new os(this.parent.formulaErrorStrings[pe.InvalidExpression],!1);for(;n<e.length;)if(e=e.split("-*").join("-").split("/*").join("/").split("*/").join("*").split("-/").join("-").split("*+").join("*").split("+*").join("+"),this.parent.isDigit(e[n])&&e.length>n+1&&this.indexOfAny(e[n+1],i)>-1&&e.length>n+2&&!g(e[n+2])&&this.indexOfAny(e[n+2],i)>-1&&(e[n+2]!=="-"||e[n+1]!=="*"&&e[n+1]!=="/"&&e[n+1]!=="^"&&e[n+1]!=="&"))if(t&&t.computeForceCalculate)this.parent.isDigit(e[n])?(p<1?(c=e[n],l=e[n+1],g(l)&&(l=this.emptyStr),l=l==="&"?"":l,p=p+1,s=s+c+l):p<2&&(d=e[n],h=e[n-1],u=e[n+1],p=0,h==="-"?(u=g(u)?this.emptyStr:u,u=u==="&"?"":u,s=s+h+d+u):(u=g(u)?this.emptyStr:u,s=s+d+u)),n=n+2):(s=e[n]==="-"?s+e[n]:s,n=n+1);else throw this.parent.formulaErrorStrings[pe.ImproperFormula];else if((this.parent.isDigit(e[n])||e[n]===this.parent.rightBracket||this.parent.storedData.has(e[n].toUpperCase()))&&(g(e[n+1])||this.indexOfAny(e[n+1],i)>-1))a=g(e[n+1])?this.emptyStr:e[n+1],a=a==="&"&&e[n+2]!=="-"?"":a,s=e[n-1]==="-"?s+e[n-1]+e[n]+a:s+e[n]+a,n=n+2;else if(this.indexOfAny(e[n],r)>-1&&!g(e[n-1])&&!g(e[n+1]))s=s+e[n],n=n+1;else if(e[n]==="q")for(;e[n]!==this.parent.leftBracket;)s=s+e[n],n=n+1;else e[n]===this.parent.leftBracket||e[n]===this.parent.rightBracket||e[n]==="{"||e[n]==="}"||e[n]==="("||e[n]===")"||this.parent.isUpperChar(e[n])||e[n].indexOf(":")>-1||e[n]===this.parent.getParseArgumentSeparator()||e[n]==="%"&&this.parent.isDigit(e[n-1])||e[n]===this.parent.tic||e[n]===" "||e[n]===this.parent.getParseDecimalSeparator()||e[n]===this.sheetToken||e[n]==="$"||e[n]==="_"?(s=s+e[n],n=n+1):(this.parent.isDigit(e[n])&&(s=e[n-1]==="-"?s+e[n-1]+e[n]:s+e[n]),(e[n]==="-"||e[n]==="+")&&(s=s+e[n],s=s.split("++").join("+").split("+-").join("-").split("-+").join("-")),(e[n]==="/"||e[n]==="*"||e[n]==="^")&&(s=s+e[n]),n=n+1);return s=s===this.emptyStr?e:s,this.indexOfAny(s[s.length-1],i)>-1&&(s=s.substring(0,s.length-1)),s=s.split("--").join("-").split("-+").join("-").split("+-").join("-"),s},o.prototype.checkScopedRange=function(e){var t=this,i=this.emptyStr,r="NaN",n=this.parent.getSheetID(this.parent.grid),s=this.parent.getSheetFamilyItem(this.parent.grid);if(e[0]===this.sheetToken.toString()){var a=e.indexOf(this.sheetToken,1),l=parseInt(e.substr(1,a-1),10);a>1&&!this.parent.isNaN(l)&&(e=e.substring(a+1),n=l)}var h="!"+n.toString();return s===null||s.sheetNameToToken==null||s.sheetNameToToken.forEach(function(u,c){if(s.sheetNameToToken.get(c).toString()===h+"!"){var d=t.emptyStr;t.parent.namedRanges.forEach(function(p,f){g(t.parent.parentObject)?d=s.sheetNameToToken.get(f).toUpperCase():d=t.parent.parentObject.getActiveSheet().name+t.sheetToken+e.toUpperCase(),t.parent.getNamedRanges().has(d)&&(i=t.parent.getNamedRanges().get(d).toUpperCase(),r=i)})}}),r},o.prototype.storeStrings=function(e){var t=0,i=0,r=0,n="",s=null,a,l=e.indexOf(this.parent.tic);if(l>-1)for(t=e.indexOf(this.parent.tic);t>-1&&e.length>0;){if(s===null&&(s=this.stringsColl),i=t+1<e.length?e.indexOf(this.parent.tic,t+1):-1,i===-1)throw new os(this.parent.formulaErrorStrings[pe.MismatchedTics]);a=this.parent.substring(e,t,i-t+1),n=this.parent.tic+this.spaceString+r.toString()+this.parent.tic,s=s.set(n,a),e=e.substring(0,t)+n+e.substring(i+1),t=t+n.length,t<=e.length&&(t=e.indexOf(this.parent.tic,t)),r++}return this.storedStringText=e,s},o.prototype.setStrings=function(e,t){for(var i=0;i<t.size;i++)t.forEach(function(r,n){e=e.split(n).join(r)});return e},o.prototype.parseSimple=function(e){var t=!0,i=e;if(i.length>0&&i[0]==="+"&&(i=i.substring(1)),i==="#DIV/0!")return"#DIV/0!";if(i==="#NAME?")return"#NAME?";if(i===""||this.parent.formulaErrorStrings.indexOf(i)>-1)return i;i=i.split(this.stringLessEq).join(this.charLessEq),i=i.split(this.stringGreaterEq).join(this.charGreaterEq),i=i.split(this.stringNoEqual).join(this.charNoEqual),i=i.split(this.stringAnd).join(this.charAnd),i=i.split(this.stringOr).join(this.charOr),i=i.split(this.fixedReference).join(this.emptyStr),t=!0;var r=[this.tokenEp,this.tokenEm],n=[this.tokenMultiply,this.tokenDivide],s=[this.tokenAdd,this.tokenSubtract],a=[this.charMultiply,this.charDivide],l=[this.charAdd,this.charSubtract],h=[this.tokenLess,this.tokenGreater,this.tokenEqual,this.tokenLessEq,this.tokenGreaterEq,this.tokenNotEqual],u=[this.charLess,this.charGreater,this.charEqual,this.charLessEq,this.charGreaterEq,this.charNoEqual],c=[this.charEp,this.charEm],d=[this.tokenAnd],p=[this.charAnd],f=[this.charOr],v=[this.tokenOr];return i=this.parseSimpleOperators(i,r,c),i=this.parseSimpleOperators(i,v,f),t&&(i=this.parseSimpleOperators(i,n,a)),t&&(i=this.parseSimpleOperators(i,s,l)),t&&(i=this.parseSimpleOperators(i,h,u)),t&&(i=this.parseSimpleOperators(i,d,p)),i},o.prototype.parseSimpleOperators=function(e,t,i){if(this.parent.getErrorStrings().indexOf(e)>-1)return e;for(var r=e,n=0,s="",a=0;a<i.length;a++)s=s+i[a];r=r.split("---").join("-").split("--").join("+").split(this.parent.getParseArgumentSeparator()+"-").join(this.parent.getParseArgumentSeparator()+"u").split(this.parent.leftBracket+"-").join(this.parent.leftBracket+"u").split("=-").join("=u"),r=r.split(",+").join(",").split(this.parent.leftBracket+"+").join(this.parent.leftBracket).split("=+").join("=").split(">+").join(">").split("<+").join("<").split("/+").join("/").split("*+").join("*").split("++").join("+").split("*-").join("*u").split("/-").join("/u").split("w-").join("wu").split("i-").join("iu").toString(),r=r.split(">-").join(">u").split("<-").join("<u").split("h-").join("hu").split("f-").join("fu").split("z-").join("zu"),r.length>0&&r[0]==="-"?(r=r.substring(1).split("-").join(this.tokenOr),r="0-"+r,r=this.parseSimpleOperators(r,[this.tokenSubtract],[this.charSubtract]),r=r.split(this.tokenOr).join("-")):r.length>0&&r[0]==="+"?r=r.substring(1):r.length>0&&r[r.length-1]==="+"&&(r=r.substring(0,r.length-1));try{if(this.indexOfAny(r,i)>-1){if(r.includes(" ")){for(var l="",h=0;h<r.length;h++){var u=r[h];if(i.indexOf(u)>=0)l=l.trim()+u;else{if(u===" "&&i.indexOf(l[l.length-1])>=0)continue;l+=u}}r=l}n=this.indexOfAny(r,i);for(var c=this.parent.getParseDecimalSeparator();n>-1;){var d="",p="",f=0,v=0,m=!1,y=["*","+","-","/","w","=","<",">"],S=r[n]===this.charNOTop,b=0;if(S)f=n;else if(b=n-1,r[b]===this.parent.arithMarker){var w=this.findLeftMarker(r.substring(0,b-1));if(w<0)throw new os(this.parent.formulaErrorStrings[pe.CannotParse]);d=this.parent.substring(r,w+1,b-w-1),f=w+1}else if(r[b]===this.parent.rightBracket){for(var I=0,w=b-1;w>0&&(r[w]!=="q"||I!==0);)r[w]==="q"?I--:r[w]===this.parent.rightBracket&&I++,w--;if(w<0)throw new os(this.parent.formulaErrorStrings[pe.CannotParse]);d=this.parent.substring(r,w,b-w+1),f=w}else if(r[b]===this.parent.tic[0]){var x=r.substring(0,b-1).lastIndexOf(this.parent.tic);if(x<0)throw new os(this.parent.formulaErrorStrings[pe.CannotParse]);d=this.parent.substring(r,x,b-x+1),f=x}else{for(var M=!1;b>-1&&(this.parent.isDigit(r[b])||!M&&(r[b]===c||r[b]==="%"));)!this.parent.isDigit(r[b])&&r[b]!=="%"&&(M=!0),b=b-1;if(b>-1&&M&&r[b]===c)throw new os(this.parent.formulaErrorStrings[pe.NumberContains2DecimalPoints]);if(b=b+1,b===0||b>0&&!this.parent.isUpperChar(r[b-1]))d="n"+this.parent.substring(r,b,n-b),f=b;else if(b>0&&r[b-1]==="E"&&(r.substring(b-4,b)==="TRUE"&&(g(r[b-5])||y.indexOf(r[b-5])>-1)||r.substring(b-5,b)==="FALSE"&&(g(r[b-6])||y.indexOf(r[b-6])>-1))&&(r.substring(b+1,b+5)==="TRUE"||r.substring(b+1,b+6)==="FALSE"))b=r.substring(b-4,b)==="TRUE"?b-4:b-5,d=r.substring(b,n)==="TRUE"?"n1":r.substring(b,n)==="FALSE"?"n0":d,f=b,m=!0;else{for(b=b-1;b>-1&&(this.parent.isUpperChar(r[b])||this.parent.isDigit(r[b])||r[b]==="_");)b=b-1;if(b>-1&&r[b]===this.sheetToken){for(b=b-1;b>-1&&r[b]!==this.sheetToken;)b=b-1;b>-1&&r[b]===this.sheetToken&&(b=b-1)}if(b>-1&&r[b]===":"){for(b=b-1;b>-1&&this.parent.isDigit(r[b]);)b=b-1;for(;b>-1&&this.parent.isUpperChar(r[b]);)b=b-1;if(b>-1&&r[b]===this.sheetToken){for(b--;b>-1&&r[b]!==this.sheetToken;)b--;b>-1&&r[b]===this.sheetToken&&b--}b=b+1,d=this.parent.substring(r,b,n-b),d=this.parent.getCellFrom(d)}else{var D=!1;b>0&&!this.parent.isUpperChar(r[b])&&(D=r[b]==="u"&&r[b-1]===this.parent.getParseArgumentSeparator()),D||(b=b+1),d=this.parent.substring(r,b,n-b)}this.parent.updateDependentCell(d),f=b}(this.parent.namedRanges.size>0&&this.parent.namedRanges.has(d.toUpperCase())||this.parent.storedData.has(d.toUpperCase()))&&(d="n"+this.checkForNamedRangeAndKeyValue(d))}if(n===r.length-1)throw new os(this.parent.formulaErrorStrings[pe.ExpressionCannotEndWithAnOperator]);b=n+1;var D=r[b]==="u";if(D&&(b=b+1),r[b]===this.parent.tic[0]){var w=r.substring(b+1).indexOf(this.parent.tic);if(w<0)throw this.parent.formulaErrorStrings[pe.CannotParse];p=this.parent.substring(r,b,w+2),v=w+b+2}else if(r[b]===this.parent.arithMarker){var w=this.findRightMarker(r.substring(b+1));if(w<0)throw new os(this.parent.formulaErrorStrings[pe.CannotParse]);p=this.parent.substring(r,b+1,w),v=w+b+2}else if(r[b]==="q"){for(var I=0,w=b+1;w<r.length&&(r[w]!==this.parent.rightBracket||I!==0);)r[w]===this.parent.rightBracket?I++:r[w]==="q"&&I--,w++;if(w===r.length)throw this.parent.formulaErrorStrings[pe.CannotParse];p=this.parent.substring(r,b,w-b+1),D&&(p="u"+p),v=w+1}else if(this.parent.isDigit(r[b])||r[b]===c){var M=r[b]===c;for(b=b+1;b<r.length&&(this.parent.isDigit(r[b])||!M&&r[b]===c);)r[b]===c&&(M=!0),b=b+1;if(b<r.length&&r[b]==="%"&&(b+=1),M&&b<r.length&&r[b]===c)throw this.parent.formulaErrorStrings[pe.NumberContains2DecimalPoints];p="n"+this.parent.substring(r,n+1,b-n-1),v=b}else if(this.parent.isUpperChar(r[b])||r[b]===this.sheetToken||r[b]==="u"){if(r[b]===this.sheetToken)for(b=b+1;b<r.length&&r[b]!==this.sheetToken;)b=b+1;b=b+1;for(var A=0,L=!1;b<r.length&&(this.parent.isUpperChar(r[b])||r[b]==="_"||r[b]===c||r[b]==="["||r[b]==="]"||r[b]==="#"||r[b]===" "||r[b]==="%"||r[b]===c&&L);)b!==r.length-1&&r[b]==="["&&r[b+1]==="["&&(L=!0),b!==r.length-1&&r[b]==="]"&&r[b+1]==="]"&&(L=!1),b++,A++;var T=b===r.length||!this.parent.isDigit(r[b]);if(A>1){for(;b<r.length&&(this.parent.isUpperChar(r[b])||this.parent.isDigit(r[b])||r[b]===" "||r[b]==="_");)b++;T=!0}for(;b<r.length&&this.parent.isDigit(r[b]);)b=b+1;if(b<r.length&&r[b]===":"){if(b=b+1,b<r.length&&r[b]===this.sheetToken){for(b++;b<r.length&&r[b]!==this.sheetToken;)b=b+1;b<r.length&&r[b]===this.sheetToken&&b++}for(;b<r.length&&this.parent.isUpperChar(r[b]);)b=b+1;for(;b<r.length&&this.parent.isDigit(r[b]);)b=b+1;b=b-1,p=this.parent.substring(r,n+1,b-n),p=this.parent.getCellFrom(p)}else b=b-1,p=this.parent.substring(r,n+1,b-n),D=r[b]==="u",D&&(p="u"+p);T&&p.startsWith(this.sheetToken)&&(T=!this.parent.isCellReference(p)),T||this.parent.updateDependentCell(p),(this.parent.namedRanges.size>0&&this.parent.namedRanges.has(p.toUpperCase())||this.parent.storedData.has(p.toUpperCase()))&&(p="n"+this.checkForNamedRangeAndKeyValue(p));var k=["*","+","-","/","w"].indexOf(r[b-p.length])>-1;p=p==="TRUE"&&(m||k)?"n1":p==="FALSE"&&(m||k)?"n0":p,v=b+1}var F=s.indexOf(r[n]),R=this.parent.arithMarker+d+p+t[F]+this.parent.arithMarker;f>0&&(R=r.substring(0,f)+R),v<r.length&&(R=R+r.substring(v)),R=R.split(this.parent.arithMarker2).join(this.parent.arithMarker.toString()),r=R,n=this.indexOfAny(r,i)}}else if(r.length>0&&(this.parent.isUpperChar(r[0])||r[0]===this.sheetToken)){for(var N=!0,P=!0,O=!1,z=r.length,w=0;w<z;++w)if(r[w]===this.sheetToken){if(w>0&&!O)throw this.parent.getErrorStrings()[W.Ref];for(O=!0,w++;w<z&&this.parent.isDigit(r[w]);)w++;if(w===z||r[w]!==this.sheetToken){N=!1;break}}else{if(!P&&this.parent.isChar(r[w])){N=!1;break}if(this.parent.isChar(r[w])||this.parent.isDigit(r[w])||r[w]===this.sheetToken)P=this.parent.isUpperChar(r[w]);else{N=!1;break}}N&&this.parent.updateDependentCell(r)}return r}catch(H){if(H===this.parent.formulaErrorStrings[pe.CircularReference])throw H;return H}},o.prototype.indexOfAny=function(e,t){for(var i=0;i<e.length;i++)if(t.indexOf(e[i])>-1)return i;return-1},o.prototype.findLeftMarker=function(e){var t=-1;if(e.indexOf(this.parent.arithMarker)>-1){for(var i=0,r=e.length-1;r>=0;--r)if(e[r]===this.parent.rightBracket)i--;else if(e[r]===this.parent.leftBracket)i++;else if(e[r]===this.parent.arithMarker&&i===0){t=r;break}}return t},o.prototype.findRightMarker=function(e){var t=-1;if(e.indexOf(this.parent.arithMarker)>-1){for(var i=0,r=0;r<e.length;++r)if(e[r]===this.parent.rightBracket)i--;else if(e[r]===this.parent.leftBracket)i++;else if(e[r]===this.parent.arithMarker&&i===0){t=r;break}}return t},o.prototype.parseFormula=function(e,t){if(e.length>0&&e[0]===this.parent.getFormulaCharacter()&&(e=e.substring(1)),e.indexOf("#REF!")>-1)return this.parent.getErrorStrings()[W.Ref];e.length>0&&e[0]==="+"&&(e=e.substring(1));try{this.isFailureTriggered=!1,this.isError=!1,e=this.parse(e.trim(),t),this.isFormulaParsed=!0}catch(n){var i=this.exceptionArgs(n);this.isFailureTriggered||(this.parent.trigger("onFailure",i),this.isFailureTriggered=!0);var r=typeof i.exception=="string"?i.exception:i.message;e=(g(this.parent.getErrorLine(n))?"":"#"+this.parent.getErrorLine(n)+": ")+r,this.isError=!0}return e},o.prototype.markLibraryFormulas=function(e){var t=0,i=e.indexOf(")");if(i===-1)e=this.markNamedRanges(e);else for(;i>-1;){for(var r=0,n=i-1;n>-1&&(e[n]!=="("||r!==0);)e[n]===")"&&r++,n--;if(n===-1)throw new os(this.parent.formulaErrorStrings[pe.MismatchedParentheses]);for(var s=n-1;s>-1&&this.parent.isChar(e[s]);)s--;var a=n-s-1,l=this.parent.substring(e,s+1,a);if(a>0&&!g(this.parent.getFunction(l))){var h=this.parent.substring(e,n,i-n+1),u=this.parent.getParseArgumentSeparator();if(l==="AREAS")this.ignoreBracet=!0;else if(this.ignoreBracet=!1,l.includes("IFS")&&l!=="COUNTIFS"&&h.includes("{")){var c=h.indexOf("{"),d=this.parent.substring(h,c,h.indexOf("}")-c+1);h=h.split(d).join(d.split(u).join(this.parent.tic+this.parent.tic))}try{var p=void 0;h=h.split("(").join("").split(")").join(""),h="("+this.formulaAutoCorrection(h,p)+")"}catch(m){var p={message:m.message,exception:m,isForceCalculable:m.formulaCorrection,computeForceCalculate:!1};if(!p.isForceCalculable)throw this.parent.formulaErrorStrings[pe.ImproperFormula];if(this.isFailureTriggered||(this.parent.trigger("onFailure",p),this.isFailureTriggered=!0,t=t+1),p.computeForceCalculate=t>0?!0:p.computeForceCalculate,p.isForceCalculable)if(p.computeForceCalculate)h=h.split("(").join("").split(")").join(""),h="("+this.formulaAutoCorrection(h,p)+")";else throw this.parent.formulaErrorStrings[pe.ImproperFormula];else throw this.parent.formulaErrorStrings[pe.ImproperFormula]}h=this.markNamedRanges(h),h=this.swapInnerParens(h),h=this.addParensToArgs(h);var f=h.lastIndexOf(u);f===-1&&h.length>2&&h[0]==="("&&h[h.length-1]===")"&&h[1]!=="{"&&h[1]!=="("&&(h=h.substring(0,h.length-1)+"}"+h.substring(h.length-1),h=h[0]+"{"+h.substring(1)),e=e.substring(0,s+1)+"q"+this.parent.substring(e,s+1,a)+h.split("(").join(this.parent.leftBracket).split(")").join(this.parent.rightBracket)+e.substring(i+1)}else{if(a>0)return this.parent.getErrorStrings()[W.Name];var v=this.emptyStr;n>0&&(v=e.substring(0,n)),v=v+"{"+this.parent.substring(e,n+1,i-n-1)+"}",i<e.length&&(v=v+e.substring(i+1)),v=this.markNamedRanges(v),e=v}i=e.indexOf(")")}return e=e.split("{").join("(").split("}").join(")"),e},o.prototype.swapInnerParens=function(e){return e.length>2&&(e=e[0]+e.substr(1,e.length-2).split("(").join("{").split(")").join("}")+e[e.length-1]),e},o.prototype.addParensToArgs=function(e){if(e.length===0)return this.emptyStr;var t=[];t.push(this.parent.getParseArgumentSeparator()),t.push(this.parent.rightBracket);var i=e.lastIndexOf(this.parent.getParseArgumentSeparator()),r=0;if(i===-1){if(e.length>2&&e[0]==="("&&e[e.length-1]===")")if(e[1]!=="{"&&e[1]!=="(")e=e.substring(0,e.length-1)+"}"+e.substring(e.length-1),e=e[0]+"{"+e.substring(1);else{var n=["+","-","*","/"];i=this.lastIndexOfAny(e,n),r===0&&e[e.length-1]===")"&&(r=e.length-1),r>0&&e[i+1]!=="{"&&e[i-1]==="}"&&(e=e.substr(0,r)+"}"+e.substr(r),e=e.substr(0,i+1)+"{"+e.substr(i+1))}}else for(var s=!0;i>-1;){var a=this.indexOfAny(e.substring(i+1,e.length),t);a>=0?a=i+a+1:a===-1&&e[e.length-1]===")"&&(a=e.length-1),a>0&&e[i+1]!=="{"&&e[a-1]!=="}"&&e[a-1]!=="\xA2"&&(e=e.substr(0,a).trim()+"}"+e.substr(a),e=e.substr(0,i+1)+"{"+e.substr(i+1).trim()),i=e.substr(0,i).lastIndexOf(this.parent.getParseArgumentSeparator()),s&&i===-1&&e[0]==="("&&(i=0,s=!1)}return e=e.split("{}").join(this.emptyStr),e},o.prototype.lastIndexOfAny=function(e,t){for(var i=e.length-1;i>-1;i--)if(t.indexOf(e[i])>-1)return i;return-1},o.prototype.markNamedRanges=function(e){var t=[")",this.parent.getParseArgumentSeparator(),"}","+","-","*","/","<",">","=","&",":"],i=e.length>0&&(e[0]==="("||e[0]==="{")?1:0;e.indexOf("#N/A")>-1&&(e=e.split("#N/A").join("#N~A")),e.indexOf("#DIV/0!")>-1&&(e=e.split("#DIV/0!").join("#DIV~0!"));for(var r=this.indexOfAny(e.substring(i),t);r>-1&&r+i<e.length;){var n=this.emptyStr,s=null;if(this.parent.substring(e,i,r).indexOf("[")>-1?s=this.getTableRange(this.parent.substring(e,i,r)):this.parent.storedData.has(this.parent.substring(e,i,r))?s=this.checkForNamedRangeAndKeyValue(this.parent.substring(e,i,r)):this.parent.namedRanges.has(this.parent.substring(e,i,r))&&(s=this.checkForNamedRangeAndKeyValue(this.parent.substring(e,i,r))),g(s)&&(n=this.checkScopedRange(this.parent.substring(e,i,r)),n!=="NaN"?(this.findNamedRange=!0,s=n):this.parent.substring(e,i,r).startsWith(this.sheetToken.toString()),!g(s)&&this.findNamedRange&&s.indexOf(this.fixedReference)>-1&&(s=s.split(this.fixedReference).join(this.emptyStr))),g(s)||(s=s.toUpperCase(),s=this.parent.setTokensForSheets(s),s=this.markLibraryFormulas(s)),!g(s)&&s!==this.emptyStr)e=e.substring(0,i)+s+e.substring(i+r),i+=s.length+1;else for(i+=r+1;i<e.length&&!this.parent.isUpperChar(e[i])&&e[i]!==this.sheetToken;)i++;for(r=i,i<e.length-1&&e[i]==="{"&&(i=i+1),r=this.indexOfAny(e.substring(i),t);r===0&&i<e.length-1;)i++,r=this.indexOfAny(e.substring(i),t);if((r===-1||e.substring(i).indexOf("[")>-1)&&i<e.length){if(e.substring(i).indexOf("[")>-1?s=this.getTableRange(e.substring(i)):this.parent.storedData.has(e.substring(i))?s=this.parent.storedData.size>0?this.checkForNamedRangeAndKeyValue(e.substring(i)):s:s=this.parent.namedRanges.size>0?this.checkForNamedRangeAndKeyValue(e.substring(i)):s,g(s)&&(n=this.checkScopedRange(e.substring(i)),n!=="NaN"&&(s=n)),!g(s)&&s!==this.emptyStr&&(s=s.toUpperCase(),s=this.parent.setTokensForSheets(s),s=this.markLibraryFormulas(s),s!=null)){var a=e.substring(i);a[a.length-1]===")"?e=e.substring(0,i)+s+")":e=e.substring(0,i)+s,i+=s.toString().length+1}r=i<e.length?this.indexOfAny(e.substring(i),t):-1}}return e.indexOf("#N~A")>-1&&(e=e.split("#N~A").join("#N/A")),e.indexOf("#DIV~0!")>-1&&(e=e.split("#DIV~0!").join("#DIV/0!")),e},o.prototype.checkForNamedRangeAndKeyValue=function(e){var t=this.emptyStr;if(e.indexOf("[")>-1){var i=this.getTableRange(e);g(i)||(this.findNamedRange=!0,e=i)}if(t=this.checkScopedRange(e),t!=="NaN")this.findNamedRange=!0,e=t;else{if(e.indexOf(this.sheetToken)>-1){var r=this.parent.getSheetFamilyItem(this.parent.grid),n=e.split('"').join(this.emptyStr);if(n=n.substr(0,n.indexOf(this.sheetToken)),r.sheetNameToToken.has(n.toUpperCase()))var s=parseInt(r.sheetNameToToken.get(n.toUpperCase()).split(this.sheetToken).join(this.emptyStr))}this.parent.storedData.size>0&&this.parent.storedData.has(e)&&(e="A"+this.parent.colIndex(e)),this.parent.namedRanges.size>0&&this.parent.namedRanges.has(e.toUpperCase())&&(g(this.parent.parentObject)?(e=this.parse(this.parent.namedRanges.get(e.toUpperCase())),e=this.parent.setTokensForSheets(e),e.indexOf(this.fixedReference)>-1&&e.split(this.fixedReference).join(this.emptyStr),this.findNamedRange=!0):e=this.parse(this.parent.namedRanges.get(e.toUpperCase()))),this.findNamedRange&&e[0]!=="!"&&e[0]!=="q"&&e[0]!=="bq"&&(e=this.parent.setTokensForSheets(e),e.indexOf(this.fixedReference)>-1&&(e=e.split(this.fixedReference).join(this.emptyStr)))}return e},o.prototype.getTableRange=function(e){e=e.replace(" ",this.emptyStr).toUpperCase();var t=e.replace("]",this.emptyStr).replace("#DATA",this.emptyStr),i=t;t.indexOf(this.parent.getParseArgumentSeparator())>-1&&(i=t.substring(0,t.indexOf(this.parent.getParseArgumentSeparator())).replace("[",this.emptyStr),t=t.replace("[",this.emptyStr).replace(this.parent.getParseArgumentSeparator(),"_"));var r=this.emptyStr;return t.toUpperCase()},o.prototype.findNextEndIndex=function(e,t){for(var i=0,r=t,n=!1;!n&&t<e.length;)e[r]==="["?i++:e[r]==="]"&&(i--,i===0&&(n=!0)),t++;return t=t-r,t},o}(),tq=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),YF=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},iq=function(o){tq(e,o);function e(t){var i=o.call(this,null,null)||this;return i.lFormulas=new Map,i.storedData=new Map,i.keyToRowsMap=new Map,i.rowsToKeyMap=new Map,i.rightBracket="\xA1",i.leftBracket="\xA2",i.sheetToken="!",i.emptyString="",i.leftBrace="{",i.rightBrace="}",i.cell=i.emptyString,i.cellPrefix="!0!A",i.treatEmptyStringAsZero=!1,i.tic='"',i.singleTic="'",i.trueValue="TRUE",i.falseValue="FALSE",i.parseDecimalSeparator=".",i.arithMarker="\xB4",i.arithMarker2=i.arithMarker+i.arithMarker,i.dependentCells=null,i.dependentFormulaCells=null,i.minValue=Number.MIN_SAFE_INTEGER,i.maxValue=Number.MAX_SAFE_INTEGER,i.categoryCollection=["All"],i.dependencyLevel=0,i.randomValues=new Map,i.isRandomVal=!1,i.randCollection=[],i.dependencyCollection=[],i.uniqueRange=[],i.formulaErrorStrings=["binary operators cannot start an expression","cannot parse","bad library","invalid char in front of","number contains 2 decimal points","expression cannot end with an operator","invalid characters following an operator","invalid character in number","mismatched parentheses","unknown formula name","requires a single argument","requires 3 arguments","invalid Math argument","requires 2 arguments","#NAME?","too complex","#CIRCULARREF!","missing formula","improper formula","invalid expression","cell empty","bad formula","empty expression","","mismatched string quotes","wrong number of arguments","invalid arguments","iterations do not converge","Control is already registered","Calculation overflow","Missing sheet","cannot_parse","expression_cannot_end_with_an_operator","#SPILL!","#DIV/0!"],i.errorStrings=null,i.parseArgumentSeparator=",",i.dateTime1900=new Date(1900,0,1,0,0,0),i.isParseDecimalSeparatorChanged=!1,i.isArgumentSeparatorChanged=!1,i.sheetFamilyID=0,i.defaultFamilyItem=null,i.sheetFamiliesList=null,i.modelToSheetID=null,i.tokenCount=0,i.sortedSheetNames=null,i.tempSheetPlaceHolder="\x85",i.namedRanges=new Map,i.formulaInfoTable=null,i.millisecondsOfaDay=24*60*60*1e3,i.parseDateTimeSeparator="/",new J6(i),i.parentObject=g(t)?i:t,i.grid=i.parentObject,i.parser=new eq(i),i}return Object.defineProperty(e.prototype,"libraryFormulas",{get:function(){return this.lFormulas},set:function(t){this.lFormulas.set(t.fName,{handler:t.handler,category:t.category,description:t.description})},enumerable:!0,configurable:!0}),e.prototype.getParseArgumentSeparator=function(){var t=",";return!this.isArgumentSeparatorChanged&&t!==this.parseArgumentSeparator&&(this.parseArgumentSeparator=t),this.parseArgumentSeparator},e.prototype.setParseArgumentSeparator=function(t){this.parseArgumentSeparator=t,this.isArgumentSeparatorChanged=!0},e.prototype.getParseDateTimeSeparator=function(){return this.parseDateTimeSeparator},e.prototype.setTreatEmptyStringAsZero=function(t){this.treatEmptyStringAsZero=t},e.prototype.getTreatEmptyStringAsZero=function(){return this.treatEmptyStringAsZero},e.prototype.setParseDateTimeSeparator=function(t){this.parseDateTimeSeparator=t},e.prototype.onPropertyChanged=function(t,i){},e.prototype.getModuleName=function(){return"calculate"},e.prototype.getFormulaCharacter=function(){return"="},e.prototype.isUpperChar=function(t){var i=t.charCodeAt(0);return i>64&&i<91},e.prototype.resetKeys=function(){this.storedData.clear(),this.keyToRowsMap.clear(),this.rowsToKeyMap.clear()},e.prototype.updateDependentCell=function(t){var i=this,r=this.cell;if(r!==this.emptyString){var n=this.getSheetFamilyItem(this.grid);if(n.sheetNameToParentObject&&(r.includes(this.sheetToken)||(r=n.parentObjectToToken.get(this.grid)+r),t.includes(this.sheetToken)||(t=n.parentObjectToToken.get(this.grid)+t)),r!==t){var s=this.getDependentCells();s.has(t)||s.set(t,[]);var a=s.get(t);if(a.indexOf(r)===-1){var l=this.getDependentFormulaCells(),h={},u=function(c){if(l.has(c)){var d=l.get(c);if(d.has(r))throw i.formulaErrorStrings[pe.CircularReference];h[c]||(h[c]=!0,d.forEach(function(p){u(p)}))}};u(t),a.push(r),l.has(r)?l.get(r).has(t)||l.get(r).set(t,t):(l.set(r,new Map),l.get(r).set(t,t))}}}},e.prototype.getDependentCells=function(){return this.dependentCells==null&&(this.dependentCells=new Map),this.dependentCells},e.prototype.getDependentFormulaCells=function(){if(this.isSheetMember()){var t=this.getSheetFamilyItem(this.grid);return t.sheetDependentFormulaCells==null&&(t.sheetDependentFormulaCells=new Map),t.sheetDependentFormulaCells}else return this.dependentFormulaCells==null&&(this.dependentFormulaCells=new Map),this.dependentFormulaCells},e.prototype.getLibraryFormulas=function(){return this.lFormulas},e.prototype.getFunction=function(t){return this.getLibraryFormulas().has(t.toUpperCase())?this.getLibraryFormulas().get(t.toUpperCase()).handler:null},e.prototype.intToDate=function(t){var i=Number(t);i=i>0&&i<1?1+i:i===0?1:i,i>60&&(i-=1);var r=new Date("01/01/1900"),n=Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds());return new Date(new Date((i-1)*(1e3*3600*24)+n).toUTCString().replace(" GMT",""))},e.prototype.getFormulaInfoTable=function(){if(this.isSheetMember()){var t=this.getSheetFamilyItem(this.grid);return t.sheetFormulaInfotable===null&&(t.sheetFormulaInfotable=new Map),t.sheetFormulaInfotable}else return this.formulaInfoTable===null&&(this.formulaInfoTable=new Map),this.formulaInfoTable},e.prototype.getParseDecimalSeparator=function(){var t=".";return!this.isParseDecimalSeparatorChanged&&t!==this.parseDecimalSeparator&&(this.parseDecimalSeparator=t),this.parseDecimalSeparator},e.prototype.setParseDecimalSeparator=function(t){this.parseDecimalSeparator=t,this.isParseDecimalSeparatorChanged=!0},e.prototype.getSheetToken=function(t){var i=0,r=this.emptyString;if(i<t.length&&t[i]===this.sheetToken){for(i++;i<t.length&&t[i]!==this.sheetToken;)i++;r=t.substring(0,i+1)}if(i<t.length)return r;throw this.formulaErrorStrings[pe.BadIndex]},e.prototype.getSheetID=function(t){var i=this.getSheetFamilyItem(t);if(i.sheetNameToParentObject!=null&&i.sheetNameToParentObject.size>0){var r=i.parentObjectToToken.get(t);if(r){r=r.split(this.sheetToken).join(this.emptyString);var n=this.parseFloat(r);if(!this.isNaN(n))return n}}return-1},e.prototype.parseFloat=function(t){var i=Number(t);return isNaN(i)&&typeof t=="string"&&t.includes(",")&&(i=Number(t.split(",").join(""))),i},e.prototype.rowIndex=function(t){var i=0,r=!1;if(i<t.length&&t[i]===this.sheetToken){for(i++;i<t.length&&t[i]!==this.sheetToken;)i++;i++}for(;i<t.length&&this.isChar(t[i]);)r=!0,i++;var n=parseInt(t.substring(i),10);if(i<t.length&&!this.isNaN(n))return n;if(r)return-1;throw this.formulaErrorStrings[pe.BadIndex]},e.prototype.colIndex=function(t){var i=0,r=0;if(t=t.toUpperCase(),i<t.length&&t[i]===this.sheetToken){for(i++;i<t.length&&t[i]!==this.sheetToken;)i++;i++}for(;i<t.length&&this.isChar(t[i]);){var n=t[i].charCodeAt(0);r=r*26+n-64,i++}return r===0?-1:r},e.prototype.getErrorStrings=function(){return this.errorStrings===null&&(this.errorStrings=["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!","#CALC!"]),this.errorStrings},e.prototype.substring=function(t,i,r){return t.substring(i,r+i)},e.prototype.isChar=function(t){return t.charCodeAt(0)>=65&&t.charCodeAt(0)<=90||t.charCodeAt(0)>=97&&t.charCodeAt(0)<=122},e.prototype.getSheetFamilyItem=function(t,i){return this.sheetFamilyID===0?(this.defaultFamilyItem==null&&(this.defaultFamilyItem=new XF),this.defaultFamilyItem):(this.sheetFamiliesList==null&&(this.sheetFamiliesList=new Map),i===void 0&&(i=this.modelToSheetID.get(t)),this.sheetFamiliesList.has(i)||this.sheetFamiliesList.set(i,new XF),this.sheetFamiliesList.get(i))},e.prototype.setKeyValue=function(t,i){t=t.toUpperCase();var r=i.toString().trim();(!this.storedData.get(t)||r.indexOf(this.leftBrace)===0)&&(this.storedData.set(t,new QF),this.keyToRowsMap.set(t,this.keyToRowsMap.size+1),this.rowsToKeyMap.set(this.rowsToKeyMap.size+1,t));var n=this.storedData.get(t);if(n.getFormulaText()!=null&&n.getFormulaText().length>0&&n.getFormulaText()!==r){var s=this.cellPrefix+this.keyToRowsMap.get(t).toString(),a=this.getDependentFormulaCells().get(s);a!=null&&this.clearFormulaDependentCells(s)}r.length>0&&r[0]===this.getFormulaCharacter()?n.setFormulaText(r):n.getFormulaValue()!==r&&(n.setFormulaText(""),n.setParsedFormula(""),n.setFormulaValue(r))},e.prototype.clearFormulaDependentCells=function(t){var i=this,r=this.getDependentFormulaCells().get(t);r&&(r.forEach(function(n,s){var a=s,l=i.getDependentCells().get(a);i.arrayRemove(l,t),l.length===0&&i.getDependentCells().delete(a)}),this.getDependentFormulaCells().delete(t))},e.prototype.arrayRemove=function(t,i){var r=t.indexOf(i);return r!==-1&&t.splice(r,1),t},e.prototype.getKeyValue=function(t){if(t=t.toUpperCase(),this.storedData.has(t)!==null){var i=this.storedData.get(t),r=i.getFormulaText();if(r.length>0&&r[0]===this.getFormulaCharacter()){this.cell=this.cellPrefix+this.keyToRowsMap.get(t).toString(),r=r.substring(1);try{i.setParsedFormula(this.parser.parseFormula(r,t))}catch(a){var n={message:a.message,exception:a,isForceCalculable:!1,computeForceCalculate:!1};return this.trigger("onFailure",n),i.setFormulaValue(n.message),this.storedData.get(t).getFormulaValue()}try{i.setFormulaValue(this.computeFormula(i.getParsedFormula()))}catch(a){var n={message:a.message,exception:a,isForceCalculable:!1,computeForceCalculate:!1};this.trigger("onFailure",n);var s=typeof n.exception=="string"?n.exception:n.message;return(g(this.getErrorLine(a))?"":"#"+this.getErrorLine(a)+": ")+s}}return this.storedData.get(t).getFormulaValue()}else return this.emptyString},e.prototype.getNamedRanges=function(){return this.namedRanges},e.prototype.addNamedRange=function(t,i){var r=t.split(this.sheetToken);if(r.length>1){var n=this.getSheetId(this.grid).toString(),s=this.getSheetFamilyItem(n);if(!s.parentObjectToToken.get(n))return!1;t=r[0]+this.sheetToken+r[1].toUpperCase()}else t=t.toUpperCase();return this.namedRanges.set(t,i),!0},e.prototype.updateNamedRange=function(t,i){var r=new Map;this.namedRanges.forEach(function(n,s){var a=s;if(s.includes(t)){var l=s.split("!");l[0]=i,a=l.join("!")}r.set(a,n)}),this.namedRanges=r},e.prototype.removeNamedRange=function(t){return t=t.toUpperCase(),this.namedRanges.get(t)!=null?(this.namedRanges.delete(t),!0):!1},e.prototype.convertAlpha=function(t){for(var i=[],r=0,n="A";t>0;){t--;var s=n.charCodeAt(0);i[r]=String.fromCharCode(t%26+s),t=parseInt((t/26).toString(),10),r++}for(var a=[],l=0;l<r;l++)a[r-l-1]=i[l];return a.join("")},e.prototype.getCellCollection=function(t){if(t.indexOf(":")<0)if(this.isCellReference(t))t=t+":"+t;else return t.split(this.getParseArgumentSeparator());var i=this.emptyString,r=t.indexOf(this.sheetToken);if(r>-1)for(var n=r,s=n+1;s<t.length;){if(t[s]===this.sheetToken){i=t.substr(0,s+1);break}s++}var a=t.indexOf(":"),l,h,u,c;if(a>0&&this.isChar(t[a-1]))for(var d=a-2;d>=0&&this.isDigit(t[d]);)d--;l=this.rowIndex(this.substring(t,0,a)),h=this.rowIndex(this.substring(t,a+1,a+t.length-a-1)),u=this.colIndex(this.substring(t,0,a)),c=this.colIndex(this.substring(t,a+1,a+t.length-a-1)),l>h&&(a=h,h=l,l=a),u>c&&(a=c,c=u,u=a);var p=[],f,v=0;for(a=l;a<=h;a++)for(f=u;f<=c;f++)p[v]=i+this.emptyString+this.convertAlpha(f)+a.toString(),v++;return p},e.prototype.computeFormula=function(t,i){return this.calculateFormula(t,!1,i)},e.prototype.calculateFormula=function(t,i,r){var n=this,s,a,l,h=!1,u;if(this.parser.isError)return t;this.parser.isFormulaParsed?s=t:s=this.parser.parseFormula(t),this.parser.isFormulaParsed=!1;try{if(a=this.findLastIndexOfq(s),a>0&&(h=!0),s!==this.emptyString&&a>-1)for(var c=a+1,d=function(){if(s[c]!==p.rightBracket)return c++,"continue";var y=s.substring(a,c+1),S=y.split(p.leftBracket)[0].split("q").join(p.emptyString),b=void 0;if(p.getLibraryFormulas().get(S.toUpperCase()).isCustom){b=y.substring(y.indexOf(p.leftBracket)+1,y.indexOf(p.rightBracket)).split(p.getParseArgumentSeparator());var w=0,I=[],x=void 0;for(w=0;w<b.length;w++)b[w].includes(":")&&p.isCellReference(b[w])?(x=p.getCellCollection(b[w]),x.length>1?(I.push(b[w]),x.forEach(function(N){n.updateDependentCell(N)})):I.push(p.getValueFromArg(b[w]))):I.push(p.getValueFromArg(b[w]));b=I}else{var M=y.substring(y.indexOf(p.leftBracket)+1,y.indexOf(p.rightBracket));b=[];for(var D=p.getParseArgumentSeparator(),A="",L=void 0,T=0,k=M.length-1;T<=k;T++)M[T]==='"'&&(L=!L),M[T]===D&&!L?(b.push(A),A="",T===k&&b.push(A)):(A+=M[T],T===k&&b.push(A));if(b.length||(b=[""]),h&&S){var F=["IF","INDEX","SORT","T","EXACT","PROPER","DOLLAR","DATE","TEXT"];F.some(function(N){return N===S})&&b.push("nestedFormulaTrue"),S==="IF"&&b.push("nestedFormulaTrue")}r&&S==="UNIQUE"&&b.push("isComputeExp")}if(l=g(p.getFunction(S))?p.getErrorStrings()[W.Name]:p.getFunction(S).apply(void 0,b),h){u=p.processNestedFormula(s,y,l);var R=p.findLastIndexOfq(u);return R===0&&(h=!1),R===-1&&(l=p.computeValue(u,i)),a=c=R,s=u,"continue"}return"break"},p=this;c>-1;){var f=d();if(f==="break")break}else this.formulaErrorStrings.indexOf(s)>-1?l=s:s!==this.emptyString&&a===-1&&(l=this.computeValue(s,i))}catch(y){var v={message:y.message,exception:y,isForceCalculable:!1,computeForceCalculate:!1};this.trigger("onFailure",v);var m=typeof v.exception=="string"?v.exception:v.message;l=(g(this.getErrorLine(y))?"":"#"+this.getErrorLine(y)+": ")+m}return l},e.prototype.computeSumIfAndAvgIf=function(t,i){if(g(t)||t[0]===this.emptyString||t.length===0)return this.formulaErrorStrings[pe.WrongNumberArguments];for(var r=t,n=0;n<r.length;n++)if(this.isCellReference(r[n])&&g(r[n].match(/[0-9]/))&&r[n].indexOf("!")<0){var s=r[n].split(":");r[n]=s[0]+"1:"+s[1]+this.spreadSheetUsedRange[0]}var a=r.length;if(a!==2&&a!==3&&a===0)return this.formulaErrorStrings[pe.WrongNumberArguments];if(r[1]==="")return i?this.getErrorStrings()[W.DivZero]:"0";var l=r[0],h=r[1].startsWith(this.tic)&&r[1].endsWith(this.tic),u=r[1].split(this.tic).join(this.emptyString);if(u.length>255)return this.getErrorStrings()[W.Value];var c=u.includes("*"),d=u.includes("?"),p=c?u.replace(/\*/g,"").trim():u,f=!1;if(!h&&this.isCellReference(p)&&(p=this.getValueFromArg(p),f=!0),c){var v=u.indexOf("*");u[0]==="*"&&(p="*"+p),u[u.length-1]==="*"&&(p+="*"),v>0&&v<u.length-1&&(p=u.substring(0,v)+"*"+u.substring(v+1))}u=p;var m=this.parser.tokenEqual;u.startsWith("<=")?(m=this.parser.tokenLessEq,u=u.substring(2)):u.startsWith(">=")?(m=this.parser.tokenGreaterEq,u=u.substring(2)):u.startsWith("<>")?(m=this.parser.tokenNotEqual,u=u.substring(2)):u.startsWith("<")?(m=this.parser.tokenLess,u=u.substring(1)):u.startsWith(">")?(m=this.parser.tokenGreater,u=u.substring(1)):u.startsWith("=")&&(m=this.parser.tokenEqual,u=u.substring(1)),(!h&&this.isCellReference(u)&&!f||u.includes(this.arithMarker)||u.includes(this.getParseDecimalSeparator())&&!c&&!d)&&(u=this.getValueFromArg(u));var y=this.parseFloat(u),S=r[0],b=this.getCellCollection(a>2?r[2]:l),w=this.getCellCollection(S);if(w.length>b.length){var I=this.colIndex(b[b.length-1])+this.colIndex(w[w.length-1])-this.colIndex(w[0]),x=r[2].split(":");x[1]=(this.convertAlpha(I)+this.rowIndex(w[w.length-1])).toString(),b=this.getCellCollection(x.join(":"))}var M=this.getComputeSumIfValue(w,b,u.toLowerCase(),y,m,c,d);return[M[0],M[1]]},e.prototype.computeLookup=function(t){var i,r,n,s,a=[],l=[],h=[],u=[],c,d,p=[],f=t,v=f.length;if(v===1||v>3)return this.formulaErrorStrings[pe.WrongNumberArguments];if(f[1]===""||f[2]==="")return this.getErrorStrings()[W.Value];if(c=this.getValueFromArg(f[0]),f[0].indexOf(this.tic)>-1&&f[0].toUpperCase().split(this.tic).join("")!==this.trueValue&&f[0].toUpperCase().split(this.tic).join("")!==this.falseValue&&this.isNaN(this.parseFloat(f[0].split(this.tic).join("")))&&(c=c.split(this.tic).join("")),this.getErrorStrings().indexOf(c)>-1)return c;var m=f[1].split(":");if(m.length===2&&this.isCellReference(m[0])&&this.isCellReference(m[1])&&v===2){var y=f[1].indexOf(":"),S=this.rowIndex(this.substring(f[1],0,y)),b=this.colIndex(this.substring(f[1],0,y)),w=this.rowIndex(this.substring(f[1],y+1,y+f[1].length-y-1)),I=this.colIndex(this.substring(f[1],y+1,y+f[1].length-y-1));S>w&&(i=[w,S],S=i[0],w=i[1]),b>I&&(r=[I,b],b=r[0],I=r[1]);var x="";f[1].indexOf("!")===0&&(x=f[1],x=x.replace("!",""),x=x.indexOf("!"),x=f[1].substring(0,x+2));var M=I-b+1,D=w-S+1;D>M||D===M?(n=x+si(b)+S+":"+si(b)+w,s=x+si(I)+S+":"+si(I)+w):D<M&&(n=x+si(b)+S+":"+si(I)+S,s=x+si(b)+w+":"+si(I)+w),(S!==w||b!==I)&&(d=!0)}if(d)a=this.getCellCollection(n),l=this.getCellCollection(s);else{a=this.getCellCollection(f[1]);var A=v===2?f[1]:f[2];l=this.getCellCollection(A);var L=J(f[1]),T=J(A),k=L[1]===L[3]?!0:L[0]===L[2],F=T[1]===T[3]?!0:T[0]===T[2];if(!k||!F)return this.getErrorStrings()[W.NA]}for(var R=0;R<a.length;R++)u.push(this.getValueFromArg(a[R]).split(this.tic).join(""));var N=u.map(function(ye){return ye===""?NaN:Number(ye)}).sort(function(ye,De){return ye-De}),P=N[N.length-1],O=N[0],z=this.parseFloat(c);if(this.isNaN(z)){for(var Q=0;Q<a.length;Q++)if(h[Q]=this.getValueFromArg(a[Q]).split(this.tic).join(""),!g(l[Q])&&c!==""&&h[Q]!==""){if(c.toUpperCase()===h[Q].toUpperCase())p.push(this.getValueFromArg(l[Q]).split(this.tic).join("")||"0");else if(c.indexOf("*")>-1||c.indexOf("?")>-1){var $=c;if(c.indexOf("*")>-1){$=$.replace(/\*/g,"").trim(),this.isCellReference($)&&($=this.getValueFromArg($));var U=c.indexOf("*");c[0]==="*"&&($="*"+$),c[c.length-1]==="*"&&($+="*"),U>0&&U<c.length-1&&($=c.substring(0,U)+"*"+c.substring(U+1))}var ie=[],ne=this.findWildCardValue($.toLowerCase(),h[Q].toLowerCase());ie.push(ne),ie.push(c),this.processLogical(ie,"equal")===this.trueValue&&p.push(this.getValueFromArg(l[Q]).split(this.tic).join("")||"0")}}}else for(var H=0;H<N.length;H++)h[H]=N[H].toString().split(this.tic).join(""),!g(l[H])&&h[H]!==""&&z===this.parseFloat(h[H])&&p.push(this.getValueFromArg(l[H]).split(this.tic).join("")||"0");if(p.length>0)return p[p.length-1];if(z>P&&!g(l[a.length-1]))return this.getValueFromArg(l[a.length-1]).split(this.tic).join("")||"0";if(z<O)return this.getErrorStrings()[W.NA];if(u.indexOf(c.split(this.tic).join(""))<0&&c!==this.trueValue&&c!==this.falseValue){if(!this.isNaN(z)&&!this.isNaN(P)&&!this.isNaN(O)){for(var te=[],oe=0;oe<N.length;oe++)z>N[oe]&&te.push(N[oe]);var y=te.length-1;if(!g(l[y])&&y>=0)return this.getValueFromArg(l[y]).split(this.tic).join("")||"0"}else if(this.isNaN(z)&&c!==""&&/^[a-zA-Z!@#$%^&*()_+{}[\]:;<>,.?~\\/-]/.test(c)){var ae=u.sort(),y=this.findClosestMatch(c.split(this.tic).join(""),ae);if(!g(l[y])&&y>=0)return this.getValueFromArg(l[y]).split(this.tic).join("")||"0"}}return this.getErrorStrings()[W.NA]},e.prototype.computeVHLookup=function(t,i){var r=this,n,s,a=t;if(g(a)||a.length<3||a.length>4)return this.formulaErrorStrings[pe.WrongNumberArguments];if(a[1]==="")return this.getErrorStrings()[W.NA];var l=this.getValueFromArg(a[0]);if(l){if(l.includes(this.tic)){var h=l.split(this.tic).join("");if(h&&!this.isNumber(h)){var u=h.toUpperCase();u!==this.trueValue&&u!==this.falseValue&&(l=h)}}}else l="0";var c=this.getErrorStrings();if(c.indexOf(l)>-1)return l;var d=(this.getValueFromArg(a[2])||"0").split(this.tic).join("").toUpperCase(),p=this.parseFloat(d===this.trueValue?"1":d);if(p<1)return c[W.Value];var f;if(a[3]){if(a[3]=this.getValueFromArg(a[3]).split(this.tic).join(""),c.indexOf(a[3])>-1)return a[3];var v=a[3].toUpperCase();if(v===this.falseValue||a[3]==="0")f=!0;else if(!(v===this.trueValue||a[3]==="1"))return c[W.Value]}var m=a[1].split(":"),y,S,b,w,I,x;if(this.isCellReference(m[0])&&this.isCellReference(m[1])){var M=this.rowIndex(m[0]),D=this.colIndex(m[0]),A=this.rowIndex(m[1]),L=this.colIndex(m[1]);if(M>A&&(n=[A,M],M=n[0],A=n[1]),D>L&&(s=[L,D],D=s[0],L=s[1]),!(M>0&&A<=1048576&&D>0&&L<=16384))return this.getErrorStrings()[W.Name];w=this.grid;var T="",k=this.getSheetFamilyItem(w);a[1].startsWith("!")?(T=a[1].substring(0,a[1].replace("!","").indexOf("!")+2),k.tokenToParentObject!==null&&(this.grid=k.tokenToParentObject.get(T))):k.parentObjectToToken!==null&&(T=k.parentObjectToToken.get(w));var F=this.getSheetId(this.grid),R={action:"getSheetInfo",sheetInfo:[]};if(this.parentObject.notify(xt,R),_F(this.parentObject,"Sheet"+F,R.sheetInfo)===-1)return this.grid=w,c[W.Ref];var N=this.getCellValueFn(w,this.cell,F,!0);if(i){var P=D+p-1;if(P>L)return c[W.Ref];y=M,S=A;var O=T+si(D);I=function(We){return N(We,D,O+We)};var z=T+si(P);x=function(){return N(b,P,z+b)||"0"}}else{var H=M+p-1;if(H>A)return c[W.Ref];y=D,S=L;var Q;I=function(We){return Q=T+si(We),N(M,We,Q+M)},x=function(){return N(H,b,Q+H)||"0"}}}else return c[W.Value];var $,U,ie=[];if(f){var ne=void 0;if(this.isNumber(l)){var te=this.parseFloat(l);ne=function(){return te===r.parseFloat(U)}}else if(l.includes("*")||l.includes("?")){var oe=l,ae=l.indexOf("*");ae>-1&&(oe=oe.replace(/\*/g,"").trim(),this.isCellReference(oe)&&(oe=this.getValueFromArg(oe)),ae===0?oe="*"+oe:ae===l.length-1?oe+="*":oe=l.substring(0,ae)+"*"+l.substring(ae+1)),oe=oe.toLowerCase(),ne=function(){return r.processLogical([r.findWildCardValue(oe,U.toLowerCase()),l],"equal")===r.trueValue}}else{var ye=l.toUpperCase();ne=function(){return ye===U.toUpperCase()}}for(b=y;b<=S;b++)U=I(b),U&&ne()&&ie.push(x());$=ie.length?ie[0]:c[W.NA]}else if(l.indexOf("*")>-1||l.indexOf("?")>-1)$=c[W.NA];else{var De,ve=void 0;if(this.isNumber(l)){var ue=this.parseFloat(l),Tt=de.fnSort("");ve=function(){De=Tt(r.isNumber(U)?r.parseFloat(U):U||null,ue)}}else{var _e=new Intl.Collator(this.parentObject.locale||"en-US",{sensitivity:"base"});ve=function(){De=!U||r.isNumber(U)?null:_e.compare(U,l)}}var lt=void 0;for(b=y;b<=S;b++)U=I(b),lt||(ve(),De===0||De<0?ie.push(x()):De>0&&ie.length&&(lt=!0));$=ie.length?ie[ie.length-1]:c[W.NA]}return this.grid=w,$},e.prototype.findClosestMatch=function(t,i){for(var r=0,n=i.length-1;r<=n;){var s=Math.floor((r+n)/2),a=i[s],l=this.compareStrings(t.toLowerCase(),a.toLowerCase());if(l===0)return s;l===1?r=s+1:n=s-1}for(var h=r-1;h>=0;h--)if(this.compareStrings(t.toLowerCase(),i[h].toLowerCase())!==-1)return h;return-1},e.prototype.compareStrings=function(t,i){for(var r=Math.min(t.length,i.length),n=0;n<r;n++){var s=t.charCodeAt(n),a=i.charCodeAt(n);if(s<a)return-1;if(s>a)return 1}return t.length<i.length?-1:t.length>i.length?1:0},e.prototype.findWildCardValue=function(t,i){var r="";if(t.indexOf("?")>-1){var n=RegExp(t.replace(/\?/g,"[\\s\\S]"));i.length===t.length&&this.isNaN(this.parseFloat(i))&&i.match(n)?r=t:r=i}else if(t.indexOf("*")>-1){for(var s=t.indexOf("*"),a="",l="",h=this.falseValue,u=this.falseValue,c=s-1;c>=0;c--)a=a+t[c],u=this.trueValue;for(var c=s+1;c<t.length;c++)l=l+t[c],h=this.trueValue;var d=a===""?-1:i.indexOf(a.split("").reverse().join("")),p=l===""?-1:i.indexOf(l);if(d>-1||p>-1){var f=a.split("").reverse().join("")===i.substr(0,a.length),v=l===i.substring(i.length-l.length,i.length);u===this.trueValue&&h===this.trueValue&&this.isNaN(this.parseFloat(a))&&this.isNaN(this.parseFloat(l))?r=f&&v?t:i:u===this.trueValue&&this.isNaN(this.parseFloat(a))?r=f?t:i:h===this.trueValue&&this.isNaN(this.parseFloat(l))&&(r=v?t:i)}else r=i}return r},e.prototype.getComputeSumIfValue=function(t,i,r,n,s,a,l){var h=0,u=0;switch(s){case this.parser.tokenEqual:for(var c=a?r.replace(/\*/g,""):r,d=0;d<t.length;d++){var p=this.getValueFromRange(i,d),f=this.getValueFromArg(t[d].split(this.tic).join("")).toLowerCase(),v=this.parseFloat(f);if(f===r&&v===n){var m=this.getValueFromArg(i[d].split(this.tic).join("")),y=this.parseFloat(m);this.isNaN(y)||(h=h+y,u=u+1)}else if(f===r)this.isNaN(p)||(h=h+p,u=u+1);else if(a&&c&&f&&this.isNaN(this.parseFloat(f))){var S=r.indexOf("*");r[0]==="*"&&c.length<=f.length&&c===f.slice(f.length-c.length,f.length)?this.isNaN(p)||(h=h+p,u=u+1):r[r.length-1]==="*"&&c.length<=f.length&&c===f.slice(0,c.length)?this.isNaN(p)||(h=h+p,u=u+1):S>-1&&f.startsWith(r.substr(0,S))&&f.endsWith(r.substr(S+1))&&(this.isNaN(p)||(h=h+p,u=u+1))}else if(a&&!c&&f&&this.isNaN(this.parseFloat(f)))this.isNaN(p)||(h=h+p,u=u+1);else if(l&&c&&f&&this.isNaN(this.parseFloat(f))){var b=RegExp(c.replace(/\?/g,"[\\s\\S]"));f.length===r.length&&f.match(b)&&(this.isNaN(p)||(h=h+p,u=u+1))}}break;case this.parser.tokenLess:for(var d=0;d<t.length;d++){var f=this.getValueFromArg(t[d].split(this.tic).join("")),v=this.parseFloat(f);if(v<n){var m=this.getValueFromArg(i[d].split(this.tic).join("")),y=this.parseFloat(m);this.isNaN(y)||(h=h+y,u=u+1)}}break;case this.parser.tokenGreater:for(var d=0;d<t.length;d++){var f=this.getValueFromArg(t[d].split(this.tic).join("")),v=this.parseFloat(f);if(v>n){var m=this.getValueFromArg(i[d].split(this.tic).join("")),y=this.parseFloat(m);this.isNaN(y)||(h=h+y,u=u+1)}}break;case this.parser.tokenLessEq:for(var d=0;d<t.length;d++){var f=this.getValueFromArg(t[d].split(this.tic).join("")),v=this.parseFloat(f);if(v<=n){var m=this.getValueFromArg(i[d].split(this.tic).join("")),y=this.parseFloat(m);this.isNaN(y)||(h=h+y,u=u+1)}}break;case this.parser.tokenGreaterEq:for(var d=0;d<t.length;d++){var f=this.getValueFromArg(t[d].split(this.tic).join("")),v=this.parseFloat(f);if(v>=n){var m=this.getValueFromArg(i[d].split(this.tic).join("")),y=this.parseFloat(m);this.isNaN(y)||(h=h+y,u=u+1)}}break;case this.parser.tokenNotEqual:for(var c=a?r.replace(/\*/g,""):r,d=0;d<t.length;d++){var p=this.getValueFromRange(i,d),f=this.getValueFromArg(t[d].split(this.tic).join("")).toLowerCase(),v=this.parseFloat(f);if(f!==r&&v!==n&&!a&&!l){var m=this.getValueFromArg(i[d].split(this.tic).join("")),y=this.parseFloat(m);this.isNaN(y)||(h=h+y,u=u+1)}else if(a&&c&&f&&this.isNaN(this.parseFloat(f))){var S=r.indexOf("*");r[0]==="*"&&c.length<=f.length&&c!==f.slice(f.length-c.length,f.length)?this.isNaN(p)||(h=h+p,u=u+1):r[r.length-1]==="*"&&c.length<=f.length&&c!==f.slice(0,c.length)?this.isNaN(p)||(h=h+p,u=u+1):(S>-1&&!f.startsWith(r.substr(0,S))||!f.endsWith(r.substr(S+1)))&&(this.isNaN(p)||(h=h+p,u=u+1))}else if(a&&!c&&!this.isNaN(this.parseFloat(f)))this.isNaN(p)||(h=h+p,u=u+1);else if(l&&c&&f&&this.isNaN(this.parseFloat(f))){var b=RegExp(c.replace(/\?/g,"[\\s\\S]"));(f.length!==r.length||!f.match(b))&&(this.isNaN(p)||(h=h+p,u=u+1))}}break}return[h,u]},e.prototype.getValueFromRange=function(t,i){var r=t[i];return r=this.getValueFromArg(r),this.parseFloat(r.toString())},e.prototype.computeAndOrNot=function(t,i){for(var r=this,n=i==="and",s=i==="or",a=i==="not",l=!!(n||a),h,u,c=[],d=t,p=0;p<d.length;p++){if(d[p]===this.tic)return this.getErrorStrings()[W.Value];if(this.isCellReference(d[p]))for(var f=this.getCellCollection(d[p]),v=0;v<f.length;v++){if(this.getErrorStrings().indexOf(f[v])>-1)return f[v];if(f[v][0]===this.tic)return this.getErrorStrings()[W.Name];if(h=this.getValueFromArg(f[v]),this.getErrorStrings().indexOf(h)>-1)return h;u=this.parseFloat(h),h===this.falseValue||h!==""&&u===0||a&&h===""?c.push(this.falseValue):h===this.trueValue||!isNaN(u)&&h!==""?c.push(this.trueValue):(h===""||isNaN(u))&&c.push(this.getErrorStrings()[W.Value])}else{if(h=this.getValueFromArg(d[p]).split(this.tic).join("").toUpperCase(),this.getErrorStrings().indexOf(h)>-1)return h;u=this.parseFloat(h),h===this.falseValue||d[p]===""||h!==""&&u===0?c.push(this.falseValue):h===this.trueValue||!isNaN(u)&&h!==""?c.push(this.trueValue):(h===""||isNaN(u))&&c.push(this.getErrorStrings()[W.Value])}}var m=c.every(function(y){return y===r.getErrorStrings()[W.Value]});if(m)return this.getErrorStrings()[W.Value];for(var v=0;v<c.length;v++){if((n||a)&&c[v]===this.falseValue){l=!1;break}if(s&&c[v]===this.trueValue){l=!0;break}}return l=a?!l:l,l?this.trueValue:this.falseValue},e.prototype.removeTics=function(t){return t.length>1&&t[0]===this.tic[0]&&t[t.length-1]===this.tic[0]&&(t=this.substring(t,1,t.length-2)),t},e.prototype.getCellFrom=function(t){var i="",r=t.indexOf(":")>-1?t.split(":"):[t],n=r.length-1,s=this.rowIndex(r[0]),a;if(s===this.rowIndex(r[n])){var l=this.colIndex(r[0]),h=this.colIndex(r[n]),u=this.colIndex(this.cell);u>=l&&u<=h&&(i=si(u).toString()+s.toString())}else if(this.colIndex(r[0])===this.colIndex(r[n])){a=this.colIndex(r[0]);var c=this.rowIndex(r[n]),d=this.rowIndex(this.cell);d>=s&&d<=c&&(i=si(a).toString()+d.toString())}return i},e.prototype.computeValue=function(t,i,r){try{var n=[],s=0,a="";n.length=0;for(var l=this.getParseDecimalSeparator();s<t.length;){var h=t[s]==="u";if(h&&(s=s+1),t[s]===this.arithMarker){s=s+1;continue}else if(this.isDigit(t[s])){for(var u=this.emptyString;s<t.length&&(this.isDigit(t[s])||t[s]===l);)u+=t[s]===l?".":t[s],s=s+1;if(n.push(u),!t[s])return n.toString()}if(t[s]===this.sheetToken){for(a=t[s],s=s+1;s<t.length&&t[s]!==this.sheetToken;)a=a+t[s],s=s+1;s<t.length&&(a=a+t[s],s=s+1)}else if(this.isUpperChar(t[s])){for(var u=this.emptyString,c="";s<t.length&&this.isUpperChar(t[s]);){var d=t[s];u=u+d,s=s+1}for(;s<t.length&&this.isDigit(t[s]);){var p=t[s];u=u+p,s=s+1}if(s<t.length&&t[s]===":"){if(u=u+t[s],s=s+1,s<t.length&&t[s]===this.sheetToken)for(u=u+t[s],s=s+1;s<t.length&&t[s]!==this.sheetToken;)u=u+t[s],s=s+1;for(;s<t.length&&this.isUpperChar(t[s]);)u=u+t[s],s=s+1;for(;s<t.length&&this.isDigit(t[s]);)u=u+t[s],s=s+1;u=a+this.getCellFrom(u)}else u=a+u;if(c=this.getParentObjectCellValue(u,i).toString(),a="",typeof c=="string"&&this.getErrorStrings().indexOf(c)>-1)return c;h&&(this.isNaN(this.parseFloat(c))?c="-"+c:c=(-this.parseFloat(c)).toString()),n.push(c)}else if(t[s]==="q"){var f=t.substring(s+1).indexOf(this.leftBracket),v=t.substring(s+f+1).indexOf(this.rightBracket);t=this.substring(t,s+f+2,v-1)}else if(t[s]===this.tic[0]){var u=t[s].toString();for(s=s+1;s<t.length&&t[s]!==this.tic[0];)u=u+t[s],s=s+1;var c=u.split(this.tic).join(this.emptyString);c===this.trueValue||c===this.falseValue||!this.isNaN(this.parseFloat(c))&&c!==""?n.push(this.tic+c+this.tic):n.push(c),s=s+1}else if(t[s]==="%"&&n.length>0){var m=n[0],y=this.parseFloat(m);this.isNaN(y)||(n.pop(),n.push((y/100).toString())),s=s+1}else if(t.substring(s).indexOf(this.trueValue)===0)n.push(this.trueValue),s+=this.trueValue.length;else if(t.substring(s).indexOf(this.falseValue)===0)n.push(this.falseValue),s+=this.falseValue.length;else if(t[s]===this.tic[0]||t[s]==="|"){var u=t[s].toString();for(s++;s<t.length&&t[s]!==this.tic[0];)u=u+t[s],s=s+1;n.push(u+this.tic),s+=1}else{if(t[s]===" "&&s<t.length-1){s+=1;continue}switch(t[s]){case"#":{var S=0;this.getErrorStrings().indexOf(t.substring(s))>-1?(t.indexOf("!")===-1||t.substring(s).indexOf("!")===-1?S=t.indexOf("#N/A")>-1?t.indexOf("#N/A")+4+s:t.indexOf("?")+1+s:S=t.indexOf("!")+1+s,n.push(this.substring(t,s,S-s))):(S=s+1,n.push(this.substring(t,s,S-s))),s=S}break;case"n":{s=s+1;var u="";if(t[s]==="n")continue;if(t.substring(s).indexOf("Infinity")===0)u="Infinity",s+=u.length;else{for((t[s]==="u"||h||t[s]==="-")&&(u="-",h?h=!1:s=s+1);s<t.length&&(this.isDigit(t[s])||t[s]===l||t[s]===".");)u+=t[s]===l?".":t[s],s=s+1;if(s<t.length&&t[s]==="%")if(s=s+1,u===""){if(n.length>0){var m=n[0],y=this.parseFloat(m);this.isNaN(y)||(n.pop(),n.push((y/100).toString()))}}else u=(this.parseFloat(u)/100).toString()}u&&n.push(u)}break;case this.parser.tokenAdd:this.getValArithmetic(n,"add",r),s=s+1;break;case this.parser.tokenSubtract:this.getValArithmetic(n,"sub",r),s=s+1;break;case this.parser.tokenMultiply:this.getValArithmetic(n,"mul",r),s=s+1;break;case this.parser.tokenDivide:this.getValArithmetic(n,"div",r),s=s+1;break;case this.parser.tokenLess:this.processLogical(n,"less"),s=s+1;break;case this.parser.tokenGreater:this.processLogical(n,"greater"),s=s+1;break;case this.parser.tokenGreaterEq:this.processLogical(n,"greaterEq"),s=s+1;break;case this.parser.tokenLessEq:this.processLogical(n,"lessEq"),s=s+1;break;case this.parser.tokenNotEqual:this.processLogical(n,"notEq"),s=s+1;break;case this.parser.tokenOr:this.processLogical(n,"or"),s=s+1;break;case this.parser.tokenAnd:this.processLogical(n,"and"),s=s+1;break;case this.parser.tokenEqual:this.processLogical(n,"equal"),s=s+1;break;default:return this.getErrorStrings()[W.Value]}}}if(n.length===0)return this.emptyString;for(var u=this.emptyString,b=n.length;b>0;){var w=n.pop();if(this.getErrorStrings().indexOf(w)>-1)return w;if(u=w+u,u===this.emptyString&&this.isCellReference(t)&&this.getTreatEmptyStringAsZero())return"0";b--}return u}catch(I){throw this.getErrorStrings().indexOf(I)>-1||this.formulaErrorStrings.indexOf(I)>-1?I:new os(this.formulaErrorStrings[pe.InvalidExpression])}},e.prototype.getValArithmetic=function(t,i,r){var n=!1,s=t.pop(),a=s.indexOf(".")!==-1?s.split(".")[1].length:0,l=Math.pow(10,a),h=t.pop(),u=h.indexOf(".")!==-1?h.split(".")[1].length:0,c=Math.pow(10,u),d=l>=c?l:c,p=l*c;s=s===this.trueValue?"1":s===this.falseValue?"0":s,s=s===this.emptyString?"0":this.getErrorStrings().indexOf(s.toString())<0?this.parseFloat(s+"").toString():s;var f=Number(s);isNaN(f)&&!r&&(n=!0,s===this.getErrorStrings()[W.DivZero]?t.push(this.getErrorStrings()[W.DivZero]):t.push(this.getErrorStrings()[W.Value])),h=h===this.trueValue?"1":h===this.falseValue?"0":h,h=h===this.emptyString?"0":this.getErrorStrings().indexOf(h.toString())<0?this.parseFloat(h+"").toString():h,f=Number(h),isNaN(f)&&!r&&(n=!0,h===this.getErrorStrings()[W.DivZero]?t.push(this.getErrorStrings()[W.DivZero]):t.push(this.getErrorStrings()[W.Value])),i==="add"&&!n&&t.push(((Number(h)*d+Number(s)*d)/d).toString()),i==="sub"&&!n&&t.push(((Number(h)*d-Number(s)*d)/d).toString()),i==="mul"&&!n&&t.push((Number(h)*c*(Number(s)*l)/p).toString()),i==="div"&&!n&&(this.isNaN(this.parseFloat(s))||this.isNaN(this.parseFloat(h))?t.push(this.getErrorStrings()[W.Value]):this.parseFloat(s)===0?t.push(this.getErrorStrings()[W.DivZero]):t.push((Number(h)*p/(Number(s)*p)).toString()))},e.prototype.processLogical=function(t,i){var r,n,s,a,l,h,u=!1;return i!=="and"&&i!=="equal"&&(r=t.pop(),n=t.pop(),this.getErrorStrings().indexOf(r)>-1?(h=r,u=!0):this.getErrorStrings().indexOf(n)>-1&&(h=n,u=!0),this.isNaN(this.parseFloat(r))&&this.isNaN(this.parseFloat(n))&&(r=r.toString().toLowerCase(),n=n.toString().toLowerCase()),g(r)||(s=r.indexOf(this.tic)>-1?r:this.parseFloat(r)),g(n)||(a=n.indexOf(this.tic)>-1?n:this.parseFloat(n)),r==="*"&&this.isNaN(this.parseFloat(n))&&n!==""&&(l=!0)),i==="less"&&!u&&(!this.isNaN(s)&&!this.isNaN(a)?h=a<s?this.trueValue:this.falseValue:h=n.toUpperCase().split(this.tic).join("").localeCompare(r.toUpperCase().split(this.tic).join(""))<0?this.trueValue:this.falseValue),i==="greater"&&!u&&(!this.isNaN(s)&&!this.isNaN(a)?h=a>s?this.trueValue:this.falseValue:h=n.toUpperCase().split(this.tic).join("").localeCompare(r.toUpperCase().split(this.tic).join(""))>0?this.trueValue:this.falseValue),i==="lessEq"&&!u&&(!this.isNaN(s)&&!this.isNaN(a)?h=a<=s?this.trueValue:this.falseValue:h=n.toUpperCase().split(this.tic).join("").localeCompare(r.toUpperCase().split(this.tic).join(""))<=0?this.trueValue:this.falseValue),i==="greaterEq"&&!u&&(!this.isNaN(s)&&!this.isNaN(a)?h=a>=s?this.trueValue:this.falseValue:h=n.toUpperCase().split(this.tic).join("").localeCompare(r.toUpperCase().split(this.tic).join(""))>=0?this.trueValue:this.falseValue),i==="notEq"&&!u&&(h=n!==r?this.trueValue:this.falseValue,l&&(h=this.falseValue)),i==="and"&&!u&&(r=t.pop().toString(),n="",t.length>0&&(n=t.pop().toString()),this.getErrorStrings().indexOf(r)>-1?h=r:this.getErrorStrings().indexOf(n)>-1?h=n:(h=this.emptyString+n+r+this.emptyString,h=h.split(this.tic).join(""))),i==="equal"&&!u&&(r=t.pop(),n=t.pop(),this.getErrorStrings().indexOf(r)>-1?h=r:this.getErrorStrings().indexOf(n)>-1?h=n:(this.isNaN(this.parseFloat(r))&&this.isNaN(this.parseFloat(n))&&(r=r.toString().toLowerCase(),n=n.toString().toLowerCase()),r==="*"&&this.isNaN(this.parseFloat(n))&&n!==""&&(l=!0),h=r===n||l?this.trueValue:this.falseValue)),i==="or"&&!u&&(h=Math.pow(this.parseFloat(a),this.parseFloat(s)).toString(),h=this.isNaN(this.parseFloat(h))?this.getErrorStrings()[W.Value]:h),t.push(h),h},e.prototype.computeStoreCells=function(t){for(var i=t.cellValue,r=t.cellRange,n=t.criteria,s=t.argArray,a=t.isCriteria,l=t.storedCells,h=t.isCountIfS===this.trueValue,u=t.countVal||0,c=a===this.trueValue?l:i,d=[],p,f=0;f<c.length;f++){var v=[],m=this.getValueFromArg(i[f]),y=s[h?1+u*2:2+u],S=y.startsWith(this.tic)&&y.endsWith(this.tic);p=y.trim().split(this.tic).join(this.emptyString);var b=p.includes("*"),w=p==="*"||p==="<>*",I=b&&!w?p.replace(/\*/g,"").trim():p,x=!1;if(!S&&this.isCellReference(I)&&(I=this.getValueFromArg(I),x=!0),b&&!w){var M=p.indexOf("*");p[0]==="*"&&(I="*"+I),p[p.length-1]==="*"&&(I+="*"),M>0&&M<p.length-1&&(I=p.substring(0,M)+"*"+p.substring(M+1))}p=I;var D="";if(a=h?this.trueValue:a,a===this.trueValue){var A="",L=0,T=0,k=void 0,F=void 0,R=void 0,N=void 0;l[f]=h&&!u?i[f]:l[f],A=l[f],u&&(k=r[u-1],F=k.indexOf("!")>-1?J(k.substring(k.lastIndexOf("!")+1)):J(k),R=A.indexOf("!")>-1?Se(A.substring(A.lastIndexOf("!")+1)):Se(A),N=r[u].indexOf("!")>-1?J(r[u].substring(r[u].lastIndexOf("!")+1)):J(r[u]));var P=A.indexOf("!")>-1,O=void 0,z="",H="";for(P&&(H=A.substring(0,A.lastIndexOf("!")+1),A=A.substring(A.lastIndexOf("!")+1));!this.isDigit(A[L]);)L=L+1;if(this.isCellReference(r[u])&&r[u].indexOf(":")>-1)for(D=h&&!u?c[f].indexOf("!")>-1?c[f].substring(c[f].lastIndexOf("!")+1):c[f]:et(N[0]+(R[0]-F[0]),N[1]+(R[1]-F[1])),O=r[u].indexOf("!")>-1,O&&(z=r[u].substring(0,r[u].lastIndexOf("!")+1));!this.isDigit(D[T]);)T=T+1;var Q=this.substring(A,L),$=this.substring(D,T),U=this.substring(A,L,A.length-L),ie=this.substring(D,T,D.length-L);P&&(Q=H+Q,$=H+$),U!==ie&&(l[f]=this.substring(l[f],P?H.length+L:L)+ie),D=l[f].split(Q).join($),O?(D.indexOf("!")>-1&&(D=D.substring(D.lastIndexOf("!")+1)),D=z+D):D=D.substring(D.lastIndexOf("!")+1),m=this.getValueFromArg(D),p=h?p:n[u-1].split(this.tic).join(this.emptyString)}var ne="equal";p.startsWith("<=")?(ne="lessEq",p=p.substring(2)):p.startsWith(">=")?(ne="greaterEq",p=p.substring(2)):p.startsWith("<>")?(ne="notEq",p=p.substring(2)):p.startsWith("<")?(ne="less",p=p.substring(1)):p.startsWith(">")?(ne="greater",p=p.substring(1)):p.startsWith("=")&&(ne="equal",p=p.substring(1)),(!S&&this.isCellReference(p)&&(!x||D!==""&&!h)||p.includes(this.arithMarker))&&(p=this.getValueFromArg(p)),(p.indexOf("*")>-1||p.indexOf("?")>-1)&&(m=this.findWildCardValue(p.toLowerCase(),m.toLowerCase())),v.push(m.toLowerCase()),v.push(p.toLowerCase()),this.processLogical(v,ne)===this.trueValue&&(a===this.falseValue?d.push(i[f]):d.push(D))}return l=d,d=[],l},e.prototype.computeIfsFormulas=function(t,i,r){if(i===this.trueValue&&(g(t)||t[0]===""||t.length<2||t.length>127||t.length%2!==0))return this.formulaErrorStrings[pe.WrongNumberArguments];for(var n=t,s=[],a=[],l=[],h=0,u=0,c=0;c<n.length;c++)n[c].indexOf(":")>-1&&this.isCellReference(n[c])?s.push(n[c].trim()):a.push(n[c].trim());for(var d=[],c=0;c<s.length;c++)d.push(this.getCellCollection(s[c]).length);for(var p=0;p<d.length;p++)if(d[p]&&d[p+1]&&d[p]!==d[p+1])return this.getErrorStrings()[W.Value];for(var f=0;f<a.length;f++)if(a[f]==="")return r===this.trueValue?this.getErrorStrings()[W.DivZero]:0;var v,m;if(i===this.falseValue){m=this.falseValue,v=this.getCellCollection(s[1]);var y={cellValue:v,cellRange:s,criteria:a,argArray:n,isCriteria:m,storedCells:l,isCountIfS:i};if(l=this.computeStoreCells(y),h=l.length,h===0)return r===this.trueValue?this.getErrorStrings()[W.DivZero]:0}for(var S=i===this.trueValue?0:2,c=S;c<s.length;c++){m=this.trueValue,m=i===this.trueValue&&c===0?this.falseValue:this.trueValue,v=this.getCellCollection(s[c]);var y={cellValue:v,cellRange:s,criteria:a,argArray:n,isCriteria:m,storedCells:l,isCountIfS:i,countVal:c};if(l=this.computeStoreCells(y),h=l.length,h===0)return r===this.trueValue?this.getErrorStrings()[W.DivZero]:0}for(var b=0,w=s[0].indexOf("!")>-1?J(s[0].substring(s[0].lastIndexOf("!")+1)):J(s[0]),I=s[s.length-1],x=I.indexOf("!")>-1?J(I.substring(I.lastIndexOf("!")+1)):J(I),p=0;p<l.length;p++){var M="",D="",A=0,L=0;M=l[p];var T=M.indexOf("!")>-1,k=void 0,F="",R="";for(T&&(R=M.substring(0,M.lastIndexOf("!")+1),M=M.substring(M.lastIndexOf("!")+1));!this.isDigit(M[A]);)A=A+1;if(this.isCellReference(s[0])&&s[0].indexOf(":")>-1)for(D=et(w[0]+(Se(M)[0]-x[0]),w[1]+(Se(M)[1]-x[1])),k=s[0].indexOf("!")>-1,k&&(F=s[0].substring(0,s[0].lastIndexOf("!")+1));!this.isDigit(D[L]);)L=L+1;var N=this.substring(M,A),P=this.substring(D,L),O=this.substring(M,A,M.length-A),z=this.substring(D,L,D.length-A);if(T&&(N=R+N,P=R+P),O!==z&&(l[p]=this.substring(l[p],T?R.length+A:A)+z),v=l[p].split(N).join(P),k?(v.indexOf("!")>-1&&(v=v.substring(v.lastIndexOf("!")+1)),v=F+v):v=v.substring(v.lastIndexOf("!")+1),i===this.trueValue)u=u+1;else{var H=this.getValueFromArg(v),Q=parseFloat(H===""&&r!==this.trueValue?"0":H);this.isNumber(Q)&&(b++,u=u+Q)}}return r===this.trueValue&&(u=u/b),u},e.prototype.processNestedFormula=function(t,i,r){if(r&&!r.toString().includes('"')){var n=t.indexOf(i)+i.length;if(t[n]==='"'&&this.getErrorStrings().indexOf(r.toString())<0&&!this.isNumber(r)&&r!==this.trueValue&&r!==this.falseValue)return t.split(i).join('"'+r+'"')}return t.split(i).join("n"+r)},e.prototype.isNaN=function(t){return t.toString()==="NaN"||typeof t=="string"},e.prototype.isNumber=function(t){return t-parseFloat(t)>=0},e.prototype.fromOADate=function(t){t=t>0&&t<1?1+t:t===0?1:t,t>60&&(t-=1);var i=new Date("01/01/1900"),r=Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds());return new Date(new Date((t-1)*this.millisecondsOfaDay+r).toUTCString().replace(" GMT",""))},e.prototype.getSerialDateFromDate=function(t,i,r){var n=0;t<1900&&(t+=1900);for(var s=!1;!s;){for(;i>12;)t++,i-=12;for(;i<1;)i+=12,t--;s=!0;for(var a=new Date(t,i,1,-1).getDate();r>a;)a=new Date(t,i,1,-1).getDate(),i++,r-=a,s=!1;r<1&&(i--,i<1&&(i=12,t--),a=new Date(t,i,1,-1).getDate(),r=a+r,s=!1)}var l=Date.parse(t+"/"+i+"/"+r);return this.isNaN(l)||(n=this.toOADate(new Date(l))),n},e.prototype.intToTime=function(t){var i=t.toString().split(".");return g(i[1])||(t=parseFloat(i[0]+1+"."+i[1])||t),this.intToDate(t.toString())},e.prototype.toOADate=function(t,i,r){var n=new Date("01/01/1900"),s=wo(t)?t:new Date(t),a=Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()),l=Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()),h=(l-a)/(1e3*3600*24);return(i?h:parseInt(h.toString(),10))+(r?0:h>60?2:1)},e.prototype.calculateDate=function(t){return this.parseFloat(t)<10?"0"+t:t},e.prototype.isTextEmpty=function(t){return t===null||t===""},e.prototype.isDigit=function(t){var i=t.charCodeAt(0);return i>47&&i<58},e.prototype.findLastIndexOfq=function(t){for(var i=t.lastIndexOf("q"),r=t.lastIndexOf(this.leftBracket);r<i;)i=t.substring(0,i).lastIndexOf("q");return i},e.prototype.getValueFromArg=function(t,i,r,n){if(t=t.trim(),!t||this.getErrorStrings().indexOf(t)>-1)return t;var s=t[0];if(s===this.tic||s===this.singleTic){var a=t.split(this.tic).join("");if(this.isNaN(this.parseFloat(a))){var l=this.isDate(a);if(l&&!this.isNaN(l.getDate()))return this.toOADate(l,!0).toString()}if(t.endsWith(this.tic)){var h=this.getParseDecimalSeparator();h!=="."&&a.includes(h)&&(a=a.replace(h,"."),this.isNumber(a)&&(t=a))}return t}else if(s==="u"&&t.includes(this.arithMarker))t=this.parser.parseSimpleOperators(t.split("u").join("0-"),[this.parser.tokenSubtract],["-"]);else{var u=this.isUpperChar(s);if(!u){var h=this.getParseDecimalSeparator();if(this.isDigit(s)||s===h||s==="-"||s==="n"){if(s==="n"&&(t=t.substring(1),t.indexOf('"n')>-1&&(t=t.replace('"n','"'))),h!=="."&&t.includes(h)){var a=t.replace(h,".");this.isNumber(a)&&(t=a)}return t}}}var c=s===this.sheetToken;if(c||this.isUpperChar(s)&&!["+","-","/","*",")",")","{"].some(function(m){return t.includes(m)})){var d=this.isCellReference(t);if(d&&!c){var p=this.getSheetFamilyItem(this.grid);p.sheetNameToParentObject!==null&&p.parentObjectToToken.has(this.grid)&&(t=p.parentObjectToToken.get(this.grid)+t)}if(t===this.cell){var f=this.getDependentCells().get(t);if(f!=null&&f.indexOf(t)>-1&&this.arrayRemove(f,t),this.getDependentFormulaCells().has(this.cell)||this.clearFormulaDependentCells(this.cell),!i)throw new os(this.formulaErrorStrings[pe.CircularReference])}var v=this.getParentObjectCellValue(t,!1,i,n).toString();return d&&this.updateDependentCell(t),v}else return this.computeValue(t,!1,r)},e.prototype.isDate=function(t){if(typeof t=="object"||Date.parse(t)!==null){var i=void 0;return typeof t=="string"?i=this.checkDateFormat(t):i=new Date(Date.parse(t)),i>=this.dateTime1900?i:null}else return null},e.prototype.isValidCellReference=function(t){var i=0,r=0,n=0,s=[89,71,69],a=this.emptyString;if(this.namedRanges.has(t))return!1;for(var l=0;l<t.length;l++)this.isChar(t[l])&&r++;if(a=t.substring(i,r),a.length<4){for(;n<a.length;)if(!g(a[n])&&a[n].charCodeAt(0)<s[n]){n++;continue}else{if(g(a[n])&&n>0)break;return!1}var h=this.parseFloat(t.substring(r,t.length));if(h<1048576)return!0}return!1},e.prototype.parseDate=function(t){if(!this.isNaN(t)){if(t instanceof Date)return new Date(t);var i=parseInt(t,10);return i<0?this.getErrorStrings()[W.Num]:i<=60?new Date(this.dateTime1900.getTime()+(i-1)*864e5):new Date(this.dateTime1900.getTime()+(i-2)*864e5)}return typeof t=="string"&&(t=this.checkDateFormat(t,!0),!this.isNaN(t))?t:this.getErrorStrings()[W.Value]},e.prototype.checkDateFormat=function(t,i){if(this.parentObject.getModuleName()==="spreadsheet"&&this.parentObject.locale!=="en-US"){var r={value:t,cell:{value:t}};if(this.parentObject.notify("checkDateFormat",r),r.isDate)return r.dateObj}return i?new Date(t):new Date(Date.parse(t))},e.prototype.isCellReference=function(t){if(t=t.trim(),t===this.emptyString)return!1;t=this.setTokensForSheets(t);var i=this.getSheetToken(t),r=!1;i!==""&&(t=t.split(i).join(this.emptyString));var n=!1,s=!1;if(t.indexOf(":")!==t.lastIndexOf(":"))return!1;for(var a=t.split("").join(this.getParseArgumentSeparator()).split(this.getParseArgumentSeparator()),l=0;l<a.length;l++)if(this.isChar(a[l]))n=!0;else if(this.isDigit(a[l]))s=!0;else if(a[l]===":")n&&s&&(r=!0),n=!1,s=!1;else return!1;return t.indexOf(":")>-1&&t.indexOf(this.tic)===-1?r&&n&&s?!0:!!((n&&!s||!n&&s)&&!r):!!(n&&s&&t.indexOf(this.tic)===-1&&this.isValidCell(t))},e.prototype.setTokensForSheets=function(t){var i=this.getSheetFamilyItem(this.grid),r=this.getSortedSheetNames();if(r!=null)for(var n=0;n<r.length;n++){var s=i.sheetNameToToken.get(r[n]);s=s.split(this.sheetToken).join(this.tempSheetPlaceHolder);var a=this.singleTic+"SHEET"+r[n]+this.singleTic+this.sheetToken;t.indexOf(a)===-1&&(a="SHEET"+r[n]+this.sheetToken),t=t.split(a).join(s),a=r[n]+this.sheetToken,t=t.split(a).join(s)}if(t=t.split(this.tempSheetPlaceHolder).join(this.sheetToken),t.indexOf("!!")>-1){t=t.replace("!!","!");var l=t.split("!");l[1]=(parseInt(l[1],10)+1).toString(),t=l.join("!")}return t},e.prototype.getParentObjectCellValue=function(t,i,r,n){if(t===this.trueValue||t===this.falseValue)return t;var s=t.lastIndexOf(this.sheetToken),a=this.grid,l;if(s>-1){var h=this.getSheetFamilyItem(a);if(h.tokenToParentObject!==null)this.grid=h.tokenToParentObject.get(t.substring(0,s+1)),l=t.substring(s+1);else return this.getErrorStrings()[W.Value]}else{for(var u=0;u<t.length&&this.isChar(t[u]);)u++;if(u===t.length)return t===""?this.getErrorStrings()[W.Value]:this.getErrorStrings()[W.Name];l=t;var h=this.getSheetFamilyItem(a);h.isSheetMember&&h.parentObjectToToken!=null&&(t=h.parentObjectToToken.get(this.grid)+t)}if(this.isDigit(l[0])){var c=l.search(/[a-zA-Z]/);c>0&&(l=l.substring(c,l.length)+l.substring(0,c))}var d=this.rowIndex(l),p=this.colIndex(l),f;if(!(d>0&&d<=1048576&&p>0&&p<=16384))f=this.getErrorStrings()[W.Name];else{var v=this.getSheetId(this.grid);if(this.parentObject.notify){var m={action:"getSheetInfo",sheetInfo:[]};if(this.parentObject.notify(xt,m),_F(this.parentObject,"Sheet"+v,m.sheetInfo)===-1)return this.grid=a,this.getErrorStrings()[W.Ref]}f=this.getCellValueFn(a,this.cell,v,!1,i,r,n)(d,p,t)}return this.grid=a,f},e.prototype.getCellValueFn=function(t,i,r,n,s,a,l){var h=this,u=i;u&&(u=t===this.grid?"":u+","+(typeof t=="string"&&Number(t)>-1?t:this.getSheetID(t)));var c=this.parentObject.getValueRowCol.bind(this.parentObject)||this.getValueRowCol.bind(this);return function(d,p,f){if(i===f&&!a)throw h.formulaErrorStrings[pe.CircularReference];h.cell=f;var v=c(r,d,p,u,s,a,l);if(g(v))v=h.emptyString;else{v=v.toString();var m=h.getParseDecimalSeparator();if(m!=="."&&v.includes(m)){var y=v.replace(m,".");h.isNumber(y)&&(v=y)}}return h.cell=i,n&&h.updateDependentCell(f),v}},e.prototype.isValidCell=function(t){var i=t.search(/\d/);if(i===0){var r=t.search(/[a-zA-Z]/);t=t.substring(r,t.length)+t.substring(0,r)}var n=this.rowIndex(t),s=this.colIndex(t);return n>0&&n<=1048576&&s>0&&s<=16384},e.prototype.getSheetId=function(t){return t&&typeof t=="string"&&Number(t)>-1?Number(t):this.getSheetID(t)+1},e.prototype.getValueRowCol=function(t,i,r){var n=this.rowsToKeyMap.get(i).toString(),s=this.getKeyValue(n).toString();if(s!=null&&s[s.length-1]==="%"&&s.length>1){var a=this.parseFloat(s.substring(0,s.length-1));this.isNaN(a)&&(s=(Number(a)/100).toString())}return s},e.prototype.defineFunction=function(t,i,r){typeof i=="string"&&(i=V(i,window)),t=t.toUpperCase(),this.libraryFormulas.set(t,{handler:i,isCustom:!0,description:r})},e.prototype.valueChanged=function(t,i,r,n,s,a,l,h,u,c,d,p){var f=t;this.spreadSheetUsedRange=n,this.grid=t;var v=!0,m=!0,y=this.getSheetFamilyItem(f),S=si(i.getColIndex())+i.getRowIndex().toString();if(this.actCell=a+"!"+S,y.sheetNameToParentObject!==null&&y.sheetNameToParentObject.size>0){var b=y.parentObjectToToken.get(f);S=b+S}var w=i.getFormulaValue().toUpperCase();if(w.indexOf("=RAND()")>-1||w.indexOf("=NOW()")>-1||w.indexOf("NOW()")>-1||w.indexOf("RAND()")>-1||w.indexOf("=RANDBETWEEN(")>-1||w.indexOf("RANDBETWEEN(")>-1||this.randomValues.has(S)){var I=this.randCollection.toString();this.randomValues.has(S)?this.randomValues.has(S)&&(w.indexOf("=RAND()")>-1||w.indexOf("=NOW()")>-1||w.indexOf("NOW()")>-1||w.indexOf("RAND()")>-1||w.indexOf("=RANDBETWEEN(")>-1||w.indexOf("RANDBETWEEN(")>-1?this.randomValues.set(S,i.getFormulaValue()):i.getFormulaValue().toUpperCase()!==this.randomValues.get(S.toUpperCase())&&(this.randomValues.delete(S),I=I.split(S+this.parseArgumentSeparator).join("").split(this.parseArgumentSeparator+S).join("").split(S).join(""),this.randCollection=I.split(this.parseArgumentSeparator)),this.randomValues.size===0&&this.randCollection.length&&(this.isRandomVal=!1,this.randomValues.clear(),this.randCollection=[])):(this.randomValues.set(S,i.getFormulaValue()),this.randCollection.push(S),this.isRandomVal=!0)}if(i.getFormulaValue()&&i.getFormulaValue()[0]===this.getFormulaCharacter()){this.cell=S;var x=void 0;if(g(m)||(m=r),this.getFormulaInfoTable().has(S)){if(x=this.getFormulaInfoTable().get(S),i.getFormulaValue()!==x.getFormulaText()||x.getParsedFormula()==null){x.setFormulaText(i.getFormulaValue()),this.getDependentFormulaCells().has(this.cell)&&this.clearFormulaDependentCells(this.cell);try{x.setParsedFormula(this.parser.parseFormula(i.getFormulaValue()))}catch(D){x.setFormulaValue(D),m=!1}}else this.parser.isError=!1;if(m){this.parser.isFormulaParsed=!0;var M=this.calculateFormula(x.getParsedFormula(),s);v=M!==x.getFormulaValue()&&(!this.parentObject.isEdit||M!==this.formulaErrorStrings[pe.CircularReference]),x.setFormulaValue(M)}}else{x=new QF,x.setFormulaText(i.getFormulaValue()),this.getDependentFormulaCells().has(S)||this.getDependentFormulaCells().set(S,new Map),this.getFormulaInfoTable().set(S,x);try{x.setParsedFormula(this.parser.parseFormula(i.getFormulaValue()))}catch(D){x.setFormulaValue(D),m=!1}if(m){var M=this.calculateFormula(x.getParsedFormula(),s);v=M!==this.formulaErrorStrings[pe.CircularReference],x.setFormulaValue(M)}}m&&(this.parentObject.setValueRowCol===void 0?this.setValueRowCol(this.getSheetID(f)+1,x.getFormulaValue(),i.getRowIndex(),i.getColIndex()):this.parentObject.setValueRowCol(this.getSheetId(f),x.getFormulaValue(),i.getRowIndex(),i.getColIndex(),x.getFormulaText(),l))}else this.getFormulaInfoTable().has(S)&&(this.getFormulaInfoTable().delete(S),this.getDependentFormulaCells().has(S)&&this.clearFormulaDependentCells(S));m&&v&&this.getDependentCells().has(S)&&(this.parentObject.calculationMode==="Automatic"||!this.parentObject.isEdit||d)&&this.getDependentCells().get(S).toString()!==S&&this.refresh(S,void 0,void 0,h,u,c,d,p)},e.prototype.setValueRowCol=function(t,i,r,n){},e.prototype.getSortedSheetNames=function(){var t=this.getSheetFamilyItem(this.grid);if(t!=null&&t.sheetNameToToken!=null){var i=[];t.sheetNameToToken.forEach(function(r,n){i.push(n),i.sort()}),this.sortedSheetNames=i,this.sortedSheetNames.sort(),this.sortedSheetNames.length>9&&this.sortedSheetNames[0].includes("1")&&this.sortedSheetNames[1].includes("10")&&(this.sortedSheetNames.splice(this.sortedSheetNames.indexOf("2"),0,this.sortedSheetNames[0]),this.sortedSheetNames.splice(0,1))}return this.sortedSheetNames},e.prototype.getErrorLine=function(t){var i=t.stack?t.stack.split(`
`)[1].split(":"):null;return i?i[i.length-2]:null},e.prototype.createSheetFamilyID=function(){return this.sheetFamilyID===Number.MAX_SAFE_INTEGER&&(this.sheetFamilyID=Number.MIN_SAFE_INTEGER),this.sheetFamilyID++},e.prototype.computeMinMax=function(t,i){var r,n,s=!1;if(t.length&&t[t.length-1]==="isSubtotal"&&(s=!0,t.pop()),g(t)||t.length===0)return this.formulaErrorStrings[pe.WrongNumberArguments];r=i==="max"?this.minValue:this.maxValue;for(var a=0,l=t.length;a<l;a++)t[a].split(this.tic).join("").trim()===this.emptyString&&(r=0);var h=t;if(h.length>255)return this.getErrorStrings()[W.Value];for(var u=0;u<h.length;u++)if(h[u].indexOf(":")>-1&&this.isCellReference(h[u])){for(var c=this.getCellCollection(h[u]),d=0;d<c.length;d++)if(n=s?this.getValueFromArg(c[d],null,null,!0):this.getValueFromArg(c[d]),!(s&&n.includes("SUBTOTAL("))){var p=this.parseFloat(n);n===""||this.isNaN(this.parseFloat(p))||this.getErrorStrings().indexOf(n)>-1||(r=i==="max"?Math.max(r,p):Math.min(r,p))}}else{var f=s?this.getValueFromArg(h[u],null,null,!0):this.getValueFromArg(h[u]);if(s&&f.includes("SUBTOTAL("))continue;var p=0,v=this.isCellReference(h[u]),m=f===""&&v,y=this.isNaN(this.parseFloat(f))&&v,S=f===(this.trueValue||this.falseValue)&&v;if(h[u]=h[u].startsWith("n")?h[u].slice(1):h[u],this.getErrorStrings().indexOf(f)>-1)return f;if(f===this.trueValue&&h[u]===this.trueValue)f="1";else if(f===this.falseValue&&h[u]===this.falseValue)f="0";else if(m||y||S)continue;if(f.indexOf('"')>-1&&(f=f.split(this.tic).join("")),this.isNaN(this.parseFloat(f)))return this.getErrorStrings()[W.Value];p=this.parseFloat(f),r=i==="max"?Math.max(r,p):Math.min(r,p)}return(r===this.minValue||r===this.maxValue)&&(r=0),r.toString()},e.prototype.calculateAvg=function(t,i){for(var r=t,n=[],s,a,l=0,h=0,u=0;u<r.length;u++)if(this.isCellReference(r[u]))if(r[u].indexOf(":")>-1){n=this.getCellCollection(r[u]);for(var c=0;c<n.length;c++)if(s=i?this.getValueFromArg(n[c],null,null,!0):this.getValueFromArg(n[c]),!(i&&s.includes("SUBTOTAL("))){if(this.getErrorStrings().indexOf(s)>-1)return s;if(g(s)||isNaN(this.parseFloat(s))||s==="")continue;l=l+this.parseFloat(s),h=h+1}}else{if(s=i?this.getValueFromArg(r[u],null,null,!0):this.getValueFromArg(r[u]),i&&s.includes("SUBTOTAL("))continue;if(this.getErrorStrings().indexOf(s)>-1)return s;if(g(s)||isNaN(this.parseFloat(s))||s==="")continue;l=l+this.parseFloat(s),h=h+1}else{if(r[u].indexOf(this.tic)>-1&&(isNaN(this.parseFloat(r[u].split(this.tic).join("")))||r[u].split(this.tic).join("").trim()===""))return this.getErrorStrings()[W.Value];if((r[u].length===0||t[u]===this.falseValue)&&(r[u]="0"),t[u]===this.trueValue&&(r[u]="1"),a=this.getValueFromArg(r[u].split(this.tic).join("")),this.getErrorStrings().indexOf(a)>-1)return a;l=l+this.parseFloat(a),h=h+1}return h===0?this.getErrorStrings()[W.DivZero]:(l/h).toString()},e.prototype.registerGridAsSheet=function(t,i,r){g(this.modelToSheetID)&&(this.modelToSheetID=new Map),g(this.modelToSheetID.get(i))&&this.modelToSheetID.set(i,r);var n=this.getSheetFamilyItem(i);n.isSheetMember=!0;var s=t.toUpperCase();if(n.parentObjectToToken.size===0&&(n.parentObjectToToken=new Map),n.sheetNameToParentObject.size===0&&(n.sheetNameToParentObject=new Map),n.sheetNameToToken.size===0&&(n.sheetNameToToken=new Map),n.tokenToParentObject.size===0&&(n.tokenToParentObject=new Map),Ee(n.sheetNameToParentObject.get(s))){var a=this.sheetToken+this.tokenCount.toString()+this.sheetToken;this.tokenCount++,n.tokenToParentObject.set(a,i),n.parentObjectToToken.set(i,a),n.sheetNameToToken.set(s,a),n.sheetNameToParentObject.set(s,i)}else{var a=n.sheetNameToToken.get(s);n.tokenToParentObject.set(a,i),n.parentObjectToToken.set(i,a)}return t},e.prototype.unregisterGridAsSheet=function(t,i,r){var n=this,s=[i];r&&(s=[],g(this.modelToSheetID)||this.modelToSheetID.forEach(function(a,l){s.push(l)})),s.forEach(function(a){var l=n.getSheetFamilyItem(a),h=(r?a:t).toUpperCase();if(l.sheetNameToParentObject!=null&&l.sheetNameToParentObject.has(h)){l.sheetNameToParentObject.delete(h);var u=l.sheetNameToToken.get(h);l.sheetNameToToken.delete(h),l.tokenToParentObject.delete(u),l.parentObjectToToken.delete(a)}})},e.prototype.computeExpression=function(t,i){var r=this.parser.parseFormula(t),n=this.computeFormula(r,i);return n},e.prototype.isSheetMember=function(){var t=this.getSheetFamilyItem(this.grid);return g(t)?!1:t.isSheetMember},e.prototype.dispose=function(){this.resetKeys(),this.namedRanges.clear(),this.lFormulas.clear()},e.prototype.refreshRandValues=function(t){var i,r,n,s="",a;if(this.randomValues.has(t)){this.randomValues.delete(t);var l=this.randCollection.indexOf(t);l>-1&&this.randCollection.splice(l,1),this.randomValues.size===0&&!this.randCollection.length&&(this.randomValues.clear(),this.randCollection=[])}for(var h=0;h<this.randomValues.size;h++)i=this.rowIndex(this.randCollection[h]),r=this.colIndex(this.randCollection[h]),s=(parseFloat(this.getSheetToken(this.randCollection[h]).split(this.sheetToken).join(""))+1).toString(),a=this.getSheetFamilyItem(s),this.grid=a.sheetNameToParentObject.get(s),n=this.randomValues.get(this.randCollection[h]),n=this.computeFormula(n),this.parentObject.setValueRowCol===void 0?this.setValueRowCol(this.getSheetID(this.grid)+1,n,i,r):this.parentObject.setValueRowCol(this.getSheetId(this.grid),n,i,r)},e.prototype.refresh=function(t,i,r,n,s,a,l,h){var u=this,c;r||(c=!0,r=[]);var d=this.getSheetFamilyItem(this.grid);try{var p=this.getDependentCells().get(t);if(p&&p.length!==0&&(this.parentObject.calculationMode==="Automatic"||l||h==="calculate")){var f=void 0;for(f=0;f<p.length;f++){var v=p[f];if(!(i&&v.indexOf(i)>-1||v===t||r.indexOf(v)>-1)){var m=this.getSheetToken(v),y=this.parentObject.sheets,S=this.parentObject.activeSheetIndex;if(m.length){this.grid=d.tokenToParentObject.get(m);var b=Number(this.grid),w="";if(!this.isNaN(b)&&y)for(var I=0;I<y.length;I++)y[I].id===b&&(w=y[I].name,S=I);this.actCell=w+"!"+v.split(m)[1]}else this.actCell=v.split(m)[1];try{var x=function(H,Q){Q&&(u.cell=H,u.parser.isFormulaParsed=!0,Q.setFormulaValue(u.calculateFormula(Q.getParsedFormula(),!0)))},M=this.rowIndex(v),D=this.colIndex(v),A=this.getFormulaInfoTable().get(v);if(this.parentObject.setValueRowCol===void 0)x(v,A),this.setValueRowCol(this.getSheetID(this.grid)+1,A.getFormulaValue(),M,D);else{var L=y&&y[S].rows&&y[S].rows[M-1]&&y[S].rows[M-1].cells&&y[S].rows[M-1].cells[D-1],T=void 0;if(L&&L.formula&&L.formula.toLowerCase().includes("unique"))if(!this.uniqueCells||this.uniqueCells.indexOf(v)===-1)this.uniqueCells||(this.uniqueCells=[]),this.uniqueCells.push(v),x(v,A),T=A.getFormulaValue(),this.uniqueCells.splice(this.uniqueCells.indexOf(v),1),this.uniqueCells.length||(this.uniqueCells=null);else continue;else r.indexOf(v)===-1&&r.push(v),T=null;this.parentObject.setValueRowCol(this.getSheetId(this.grid),T,M,D,A.getFormulaText())}this.refresh(v,null,r,null,s)}catch{continue}}}}if(c){if(!s&&a&&a.length===4){for(var m=this.getSheetToken(t),k=[],F=a[0],R=a[2];F<=R;F++)for(var N=a[1],P=a[3];N<=P&&!(F===R&&N===P);N++){var L=m+et(F,N);this.refresh(L,null,r,null,s),k.push(L)}var O=new Set(k);r&&(r=r.filter(function(Q){return!O.has(Q)}))}var z=this.parentObject.sheets;z||(r=[]),r.forEach(function(H){for(var Q,$=u.getSheetId(d.tokenToParentObject.get(u.getSheetToken(H))),U=0;U<z.length;U++)if(z[U].id===$){Q=U;break}var ie=u.rowIndex(H)-1,ne=u.colIndex(H)-1,te=z[Q].rows[ie]&&z[Q].rows[ie].cells[ne];te&&u.parentObject.notify("calculateFormula",{cell:te,rowIdx:ie,colIdx:ne,sheetIndex:Q,isDependentRefresh:!0,isRandomFormula:n,action:h})})}}finally{this.getDependentCells().has(t)&&(this.grid=d.tokenToParentObject.get(this.getSheetToken(t)))}},YF([q()],e.prototype,"onFailure",void 0),e=YF([bt],e),e}($s),os=function(){function o(e,t){this.formulaCorrection=!1,this.message=e,this.formulaCorrection=t}return o}(),QF=function(){function o(){this.calcID=Number.MIN_VALUE+1,this.calcID1=Number.MIN_VALUE+1}return o.prototype.getFormulaText=function(){return this.formulaText},o.prototype.setFormulaText=function(e){this.formulaText=e},o.prototype.getFormulaValue=function(){return this.formulaValue},o.prototype.setFormulaValue=function(e){this.formulaValue=e},o.prototype.getParsedFormula=function(){return this.parsedFormula},o.prototype.setParsedFormula=function(e){this.parsedFormula=e},o}(),XF=function(){function o(){this.isSheetMember=!1,this.parentObjectToToken=new Map,this.sheetDependentFormulaCells=new Map,this.sheetNameToParentObject=new Map,this.sheetNameToToken=new Map,this.tokenToParentObject=new Map,this.sheetFormulaInfotable=new Map}return o}();function si(o){for(var e=[],t=0,i="A";o>0&&t<9;){o--;var r=i.charCodeAt(0);e[t]=String.fromCharCode(o%26+r),o=parseInt((o/26).toString(),10),t++}for(var n=[],s=0;s<t;s++)n[t-s-1]=e[s];return n.join("")}var $F=function(){function o(e,t,i){return this.row=e,this.col=t,this.value=i,this.getRowIndex=function(){return e},this.setRowIndex=function(r){e=r},this.getColIndex=function(){return t},this.setColIndex=function(r){t=r},this.getFormulaValue=function(){return i},this}return o}(),pO=function(){function o(e){this.uniqueOBracket="\x81",this.uniqueCBracket="\x82",this.uniqueCSeparator="\x83",this.uniqueCOperator="\x84",this.uniquePOperator="\x85",this.uniqueSOperator="\x86",this.uniqueMOperator="\x87",this.uniqueDOperator="\x88",this.uniqueModOperator="\x89",this.uniqueConcateOperator="\x8A",this.uniqueEqualOperator="\x8B",this.uniqueExpOperator="\x8C",this.uniqueGTOperator="\x8D",this.uniqueLTOperator="\x8E",this.sheetInfo=[],this.parent=e,this.init()}return o.prototype.init=function(){var e=this;this.addEventListener(),this.initCalculate(),this.registerSheet(),this.parent.customFormulaCollection.forEach(function(t,i){e.addCustomFunction(t.handler,i,t.description)})},o.prototype.destroy=function(){var e=this;if(this.removeEventListener(),this.parent.refreshing){this.clearAllUniqueFormulaValue();var t=this.calculateInstance.getLibraryFormulas();t.forEach(function(i,r){i.isCustom&&e.parent.customFormulaCollection.set(r,{handler:i.handler,description:i.description})})}this.calculateInstance.dispose(),this.calculateInstance=null,this.sheetInfo&&(this.sheetInfo=[]),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(xt,this.performFormulaOperation,this),this.parent.on(pf,this.aggregateComputation,this),this.parent.on(yx,this.getUniqueRange,this),this.parent.on(ad,this.removeUniquecol,this),this.parent.on(vu,this.clearFormulaDependentCells,this),this.parent.on(vy,this.formulaInValidation,this),this.parent.on(ls,this.refreshInsertDelete,this),this.parent.on(Oy,this.getUpdatedFormulaOnInsertDelete,this),this.parent.on(kx,this.autoCorrectCellRef,this),this.parent.on(Ry,this.parseFormulaArgument,this),this.parent.on(Nx,this.getCellRefValue,this),this.parent.on(Zh,this.commputeFormulaValue,this),this.parent.on(Tf,this.renameUpdation,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(xt,this.performFormulaOperation),this.parent.off(pf,this.aggregateComputation),this.parent.off(yx,this.getUniqueRange),this.parent.off(ad,this.removeUniquecol),this.parent.off(vu,this.clearFormulaDependentCells),this.parent.off(vy,this.formulaInValidation),this.parent.off(ls,this.refreshInsertDelete),this.parent.off(Oy,this.getUpdatedFormulaOnInsertDelete),this.parent.off(kx,this.autoCorrectCellRef),this.parent.off(Ry,this.parseFormulaArgument),this.parent.off(Nx,this.getCellRefValue),this.parent.off(Zh,this.commputeFormulaValue),this.parent.off(Tf,this.renameUpdation))},o.prototype.getModuleName=function(){return"workbookFormula"},o.prototype.initCalculate=function(){this.calculateInstance=new iq(this.parent),this.calcID=this.calculateInstance.createSheetFamilyID(),this.calculateInstance.setTreatEmptyStringAsZero(!0),this.calculateInstance.grid=this.parent.getActiveSheet().id.toString(),this.calculateInstance.setParseArgumentSeparator(this.parent.listSeparator);var e=Yi(this.parent.locale).decimal;e!=="."&&this.parent.listSeparator!==e&&this.calculateInstance.setParseDecimalSeparator(e)},o.prototype.clearFormulaDependentCells=function(e){if(e.isOpen){this.calculateInstance.getDependentCells().clear(),this.calculateInstance.getFormulaInfoTable().clear(),this.calculateInstance.getDependentFormulaCells().clear();return}var t=e.cellRef.split(":")[0],i=this.parent.getActiveSheet().id.toString(),r=this.calculateInstance.getSheetFamilyItem(i);r.isSheetMember&&!g(r.parentObjectToToken)&&(t=r.parentObjectToToken.get(i)+t),e.clearFormulaInfo&&this.calculateInstance.getFormulaInfoTable().has(t)&&this.calculateInstance.getFormulaInfoTable().delete(t),this.calculateInstance.clearFormulaDependentCells(t)},o.prototype.formulaInValidation=function(e){var t=this.calculateInstance.getLibraryFormulas().get(e.value);e.skip=g(t)},o.prototype.performFormulaOperation=function(e){var t=e.action,i,r;t!=="refreshCalculate"&&(i=this.calculateInstance.getLibraryFormulas(),r=Array.from(i.values()));var n,s=this.calculateInstance.getSheetFamilyItem(e.sheetId);switch(t){case"getLibraryFormulas":e.formulaCollection=Array.from(i.keys());break;case"getFormulaCategory":n=["All"];for(var a=1;a<Array.from(i.values()).length;a++)n.indexOf(r[a].category)<0&&n.push(r[a].category);e.categoryCollection=n;break;case"dropDownSelectFormulas":for(var a=0;a<Array.from(i.values()).length;a++)e.selectCategory===r[a].category&&(e.formulaCollection[a]=Array.from(i.keys())[a]);break;case"getFormulaDescription":for(var a=0;a<Array.from(i.values()).length;a++)e.selectedList===Array.from(i.keys())[a]&&(e.description=r[a].description,e.isCustom=r[a].isCustom);break;case"registerSheet":this.registerSheet(e.sheetIndex,e.sheetCount),e.isImport&&(this.calculateInstance.setParseArgumentSeparator(this.parent.listSeparator),this.updateSheetInfo());break;case"unRegisterSheet":this.unRegisterSheet(e.sheetIndex,e.sheetCount,e.propertyChange);break;case"initSheetInfo":this.updateSheetInfo();break;case"refreshCalculate":this.refreshCalculate(e);break;case"refreshRandomFormula":this.refreshRandomFormula(),this.calculateInstance.cell="";break;case"setArgumentSeparator":this.calculateInstance.setParseArgumentSeparator(this.parent.listSeparator);break;case"addDefinedName":e.isAdded=this.addDefinedName(e.definedName,!1,e.index,e.isEventTrigger);break;case"removeDefinedName":e.isRemoved=this.removeDefinedName(e.definedName,e.scope,e.isEventTrigger);break;case"initiateDefinedNames":this.initiateDefinedNames();break;case"addSheet":this.sheetInfo.push({visibleName:e.visibleName,sheet:e.sheetName,index:e.sheetId});break;case"getSheetInfo":e.sheetInfo=this.sheetInfo;break;case"deleteSheetTab":for(var a=0;a<this.sheetInfo.length;a++)if(this.sheetInfo[a].index===e.sheetId){var l=this.sheetInfo[a].visibleName,h=this.sheetInfo[a].sheet;this.sheetInfo.splice(a,1);var u=e.sheetId.toString();this.sheetDeletion(h,u),this.calculateInstance.unregisterGridAsSheet(u,u),this.definedNamesDeletion(l);break}break;case"getReferenceError":e.refError=this.referenceError();break;case"getAlpha":e.col=si(e.col);break;case"addCustomFunction":this.addCustomFunction(e.functionHandler,e.functionName,e.formulaDescription);break;case"computeExpression":e.calcValue=this.calculateInstance.computeExpression(e.formula,e.isFromComputeExpression);break;case"registerGridInCalc":this.calculateInstance.grid=e.sheetID;break;case"dependentCellsAvailable":case"checkFormulaAdded":s.isSheetMember&&!g(s.parentObjectToToken)&&(e.address=s.parentObjectToToken.get(e.sheetId)+e.address),t==="checkFormulaAdded"?e.added=this.calculateInstance.getFormulaInfoTable().has(e.address):e.isAvailable=this.calculateInstance.getDependentCells().has(e.address);break;case"calculateNow":this.calculateNow(e);break;case"ClearDependentCellCollection":this.calculateInstance.getDependentFormulaCells().clear(),this.calculateInstance.getDependentCells().clear(),this.calculateInstance.getFormulaInfoTable().clear();break}},o.prototype.definedNamesDeletion=function(e){var t=this.parent.definedNames;if(t&&t.length>0)for(var i=t.length-1;i>=0;i--)t[i].refersTo.substring(1,t[i].refersTo.lastIndexOf("!")).split("'").join("")===e&&this.removeDefinedName(t[i].name,t[i].scope)},o.prototype.referenceError=function(){return this.calculateInstance.getErrorStrings()[W.Ref]},o.prototype.getSheetInfo=function(){return this.sheetInfo},o.prototype.addCustomFunction=function(e,t,i){this.calculateInstance.defineFunction(t,e,i)},o.prototype.updateSheetInfo=function(){var e=this;this.sheetInfo=[],this.parent.sheets.forEach(function(t){e.sheetInfo.push({visibleName:t.name,sheet:"Sheet"+t.id,index:t.id})})},o.prototype.getSheetRefUpdateOnDelete=function(){var e=this,t=this.calculateInstance.namedRanges,i,r,n;return t&&t.size&&(n=!0,i=Array.from(t.keys()),r=Array.from(t.values())),function(s,a){var l;n&&!a.includes(s)&&(a=a.replace(/\w+/g,function(c){var d=i.indexOf(c);return d!==-1?(l=!0,r[d]):c}));var h=s.toUpperCase();a=a.toUpperCase();for(var u=a.indexOf(h);u>-1;)a=a.split((a[u-1]==="'"&&a[u+h.length]==="'"?"'"+h+"'":h)+e.calculateInstance.sheetToken).join(e.referenceError()),u=a.indexOf(h);return{value:a,isNamedRange:l}}},o.prototype.sheetDeletion=function(e,t){var i=this,r=this.calculateInstance.getDependentCells(),n,s,a=this.calculateInstance.getSheetFamilyItem(t),l=this.getSheetRefUpdateOnDelete(),h;r.forEach(function(u,c){u.forEach(function(d){n=i.calculateInstance.getFormulaInfoTable().get(d),g(n)||(h=l(e,n.formulaText),h.value!==n.formulaText&&(s=d.slice(0,d.lastIndexOf(i.calculateInstance.sheetToken)+1),h.sheetId=a.tokenToParentObject.has(s)?Number(a.tokenToParentObject.get(s)):parseInt(d.split("!")[1],10)+1,i.updateDataContainer([i.calculateInstance.rowIndex(d)-1,i.calculateInstance.colIndex(d)-1],h),i.calculateInstance.refresh(n.getParsedFormula()))),s=c.slice(0,c.lastIndexOf(i.calculateInstance.sheetToken)+1),t===(a.tokenToParentObject.has(s)?a.tokenToParentObject.get(s):c.split("!")[1])&&(i.calculateInstance.getFormulaInfoTable().delete(c),i.calculateInstance.clearFormulaDependentCells(c))})})},o.prototype.renameUpdation=function(e){var t=this,i=e.value,r=e.pName,n,s,a=e.pName.toUpperCase(),l=new RegExp(`[!@#$%^&()+=';,.{}|\\":<>~_-]`,"g"),h=`(?=['!])(?=[^"]*(?:"[^"]*"[^"]*)*$)`,u=RegExp,c=new u(r.replace(l,"\\$&")+h,"gi"),d=function(p){ut(p.value1)&&p.value1.toUpperCase().includes(a)&&p.value1.match(c)&&(p.value1=p.value1.replace(c,i)),ut(p.value2)&&p.value2.toUpperCase().includes(a)&&p.value2.match(c)&&(p.value2=p.value2.replace(c,i))};this.sheetInfo.forEach(function(p,f){if(n=ke(t.parent,f),n&&n.rows&&n.rows.length){for(var v=0,m=n.rows.length;v<m;v++)if(n.rows[v]&&n.rows[v].cells)for(var y=0,S=n.rows[v].cells.length;y<S;y++)s=G(v,y,n,!1,!0),s.formula&&ut(s.formula)&&s.formula.toUpperCase().includes(a)&&s.formula.match(c)&&(s.formula=s.formula.replace(c,i)),s.validation&&d(s.validation)}if(n&&n.columns&&n.columns.length)for(var b=void 0,v=0,w=n.columns.length;v<w;v++)b=n.columns[v],b&&b.validation&&d(b.validation);for(var I=t.parent.definedNames,v=0;v<I.length;v++)ut(I[v].refersTo)&&I[v].refersTo.includes(r)&&I[v].refersTo.match(c)&&(I[v].refersTo=I[v].refersTo.replace(c,i),I[v].scope.includes(r)&&(I[v].scope=i));t.calculateInstance.updateNamedRange(r,i),p.visibleName===r&&(p.visibleName=i)})},o.prototype.updateDataContainer=function(e,t){for(var i,r,n,s=0,a=this.parent.sheets.length;s<a;s++)if(i=ke(this.parent,s),i.id===t.sheetId){e[0]in i.rows?(r=i.rows[e[0]],e[1]in r.cells?(n=r.cells[e[1]],n.formula=t.isNamedRange?n.formula:t.value,t.visible?s===this.parent.activeSheetIndex&&i.activeCell===et(e[0],e[1])&&this.parent.notify(pa,{}):this.parent.calculationMode==="Automatic"&&(n.value=this.referenceError())):r.cells[e[1]]=n={}):(r=i.rows[e[0]]={},r[e[1]]=n={});break}},o.prototype.parseSheetRef=function(e,t){var i,r=new RegExp(`[!@#$%^&()+=';,.{}|":<>~_-]`,"g"),n=0,s=this.getSheetInfo(),a=s.length,l=[];l.length=0;var h,u,c,d,p,f=`(?=['!])(?=[^"]*(?:"[^"]*"[^"]*)*$)`,v=RegExp;for(n=0;n<a;n++)if(s[n].sheet!==s[n].visibleName&&(i=new v(s[n].visibleName.replace(r,"\\$&")+f,"gi"),c=n,e.match(i))){for(var m=n+1;m<a;m++)s[m].visibleName.includes(s[n].visibleName)&&(h=new v(s[m].visibleName.replace(r,"\\$&")+f,"gi"),u=e.search(h),d=e.search(i),u>-1&&(u<d||u===d&&s[m].visibleName.length>s[n].visibleName.length)&&(p=new RegExp("Sheet","gi"),s[m].visibleName.search(p)!==0&&(i=h,c=m)));e=e.replace(i,c+"/"),l.push(c)}n=0;for(var y;n<l.length;)i=new v(l[n]+"/"+f,"gi"),y=t?"`"+s[l[n]].sheet+"`":s[l[n]].sheet,e=e.replace(i,y),n++;return e},o.prototype.registerSheet=function(e,t){e===void 0&&(e=0),t===void 0&&(t=this.parent.sheets.length);for(var i;e<t;)i=ke(this.parent,e).id+"",this.calculateInstance.registerGridAsSheet(i,i,this.calcID),e++},o.prototype.unRegisterSheet=function(e,t,i){e===void 0&&(e=0),t===void 0&&(t=this.parent.sheets.length);var r;if(this.calculateInstance.tokenCount=0,i)this.calculateInstance.unregisterGridAsSheet(r,r,i);else for(;e<t;)r=ke(this.parent,e).id+"",this.calculateInstance.unregisterGridAsSheet(r,r),e++},o.prototype.getUniqueRange=function(e){e.range=this.calculateInstance.uniqueRange},o.prototype.removeUniquecol=function(e){if(e&&e.clearAll){this.clearAllUniqueFormulaValue();return}for(var t=this.parent.getActiveSheet(),i=0;i<this.calculateInstance.uniqueRange.length;i++){var r=this.calculateInstance.uniqueRange[i].split(":")[0].split("!");if(r[0]===t.name&&r[1]===t.activeCell){var n=J(this.calculateInstance.uniqueRange[i]);this.calculateInstance.uniqueRange.splice(i,1);for(var s=n[0];s<=n[2];s++)for(var a=n[1];a<=n[3];a++){var l=G(s,a,this.parent.getActiveSheet());l.formula="",this.parent.updateCellDetails({value:"",formula:""},Be([s,a]),void 0,void 0,!0)}}}},o.prototype.refreshCalculate=function(e){e.sheet=g(e.sheetIndex)?this.parent.getActiveSheet():ke(this.parent,e.sheetIndex);var t=e.sheet.id+"",i=this.calculateInstance.getSheetFamilyItem(t),r=Pi(e.colIndex+1)+(e.rowIndex+1);i.isSheetMember&&!g(i.parentObjectToToken)&&(r=i.parentObjectToToken.get(t)+r),e.isFormula?this.calculateFormula(e,r):(this.calculateInstance.getFormulaInfoTable().has(r)&&(this.calculateInstance.getFormulaInfoTable().delete(r),this.calculateInstance.clearFormulaDependentCells(r)),this.calculateInstance.refresh(r,null,null,null,e.isDelete,e.deletedRange),this.parent.calculationMode==="Automatic"&&this.calculateInstance.refreshRandValues(r)),this.calculateInstance.cell="",e.isFormulaDependent=this.calculateInstance.getDependentCells().has(r),e.value&&(e.value=e.value.toString().split("^+").join("^").split("&+").join("&"))},o.prototype.calculateFormula=function(e,t){var i=this,r=e.sheet;this.autoCorrectFormula(e,r);var n=e.value;e.isClipboard&&n.toUpperCase().includes("UNIQUE")&&oi(e.rowIndex,e.colIndex,r,{value:""},!0);var s=n;n=this.parseSheetRef(n);var a=new $F(e.rowIndex+1,e.colIndex+1,n),l=[r.usedRange.rowIndex,r.usedRange.colIndex];this.calculateInstance.valueChanged(r.id.toString(),a,!0,l,e.isRefreshing,r.name,e.isRandomFormula,null,e.isDelete,e.deletedRange,e.isDependentRefresh,e.action),this.calculateInstance.isRandomVal===!0&&!e.isRandomFormula&&this.parent.calculationMode==="Automatic"&&this.refreshRandomFormula();var h=G(e.rowIndex,e.colIndex,r);if(h&&s&&!e.isDependentRefresh){s=s.toUpperCase();var u=void 0;if(s.indexOf("=SUM(")===0?u="=SUM(":s.indexOf("=AVERAGE(")===0?u="=AVERAGE(":s.indexOf("=ROUNDDOWN(")===0?u="=ROUNDDOWN(":s.indexOf("=ROUNDUP(")===0?u="=ROUNDUP(":s.indexOf("=MOD(")===0&&(u="=MOD("),u){if(s=s.replace(u,""),s.includes(")")){s=s.slice(0,s.lastIndexOf(")"));for(var c=void 0,d=void 0;s.includes("(")&&s.includes(")");)d=s.indexOf("("),c=s.slice(d+1),s=s.slice(0,d)+(c.includes(")")?c.slice(c.indexOf(")")+1):c)}for(var p=s.split(this.calculateInstance.getParseArgumentSeparator()),f,v=void 0,m=void 0,y=void 0,S=void 0,b=void 0,w=function(N){if(f=p[N].split(":")[0],f.includes("!")?(S=f.substring(0,f.lastIndexOf("!")).split("'").join(""),f=f.substring(f.lastIndexOf("!")+1)):S="",Mr(f)){S?(y=yt(I.parent,S),m=y!==void 0?ke(I.parent,y):r):m=r,b=J(f),v=G(b[0],b[1],m);var P=Er(h.format),O=["Number","Currency","LongDate","Time"];if(v&&v.format&&(!h.format||!e.fillType&&O.every(function(z){return P!==z})&&Er(v.format)!=="Number"))return h.format=v.format,"break"}},I=this,d=0;d<p.length;d++){var x=w(d);if(x==="break")break}}else{var M=this.calculateInstance.getDependentFormulaCells().get(t);if(M&&M.size&&this.calculateInstance.getFormulaInfoTable().has(t)&&this.calculateInstance.getFormulaInfoTable().get(t).getParsedFormula().lastIndexOf("q")===-1&&!h.format){var D,A,L,T,k,F,R=this.calculateInstance.getSheetFamilyItem(null,this.calcID);M.forEach(function(N){D||(L=N.slice(0,N.lastIndexOf("!")+1),N=N.replace(L,""),Mr(N)&&(F=J(N),R.tokenToParentObject.has(L)?(k=cn(i.parent,Number(R.tokenToParentObject.get(L))),T=k!==void 0?ke(i.parent,k):r):T=r,A=G(F[0],F[1],T),A&&A.format&&(D=A.format)))}),D&&(h.format=D)}}}},o.prototype.refreshRandomFormula=function(){var e,t,i="",r=this.calculateInstance.randCollection;if(this.calculateInstance.randomValues.size>1&&this.calculateInstance.randomValues.size===r.length)for(var n=0;n<this.calculateInstance.randomValues.size;n++){e=this.calculateInstance.rowIndex(r[n]),t=this.calculateInstance.colIndex(r[n]),i=this.calculateInstance.randomValues.get(r[n]);var s=(parseFloat(this.calculateInstance.getSheetToken(r[n]).split(this.calculateInstance.sheetToken).join(""))+1).toString(),a=ke(this.parent,cn(this.parent,Number(s)));if(a&&G(e-1,t-1,a).formula){var l=new $F(e,t,i);this.calculateInstance.valueChanged(s,l,!0,void 0,void 0,void 0,!1,!0)}}},o.prototype.autoCorrectFormula=function(e,t){if(!g(e.value)){var i=e.value;i=this.autoCorrectCellRef({formula:e.value}),i=i.toString(),i.split("(").length===2&&i.indexOf(")")<0&&(i+=")");var r=void 0;i.indexOf("=")===0&&(i=i.slice(1),r=!0);var n=i.match(/</g),s=i.match(/>/g),a=i.match(/=/g);if(n){for(var l="",h=0;h<n.length;h++)l=l+n[h];i=i.replace(l,"<")}if(s){for(var u="",c=0;c<s.length;c++)u=u+s[c];i=i.replace(u,">")}if(a){for(var d="",p=0;p<a.length;p++)d=d+a[p];i=i.split(d).join("=")}i=r?"="+i:i,(n||s||a)&&(G(e.rowIndex,e.colIndex,t).formula=i),e.value=i}},o.prototype.correctCellReference=function(e){var t=this,i=e.split(":"),r,n,s,a,l;return i.forEach(function(h,u){if(n=h.split("!"),e=n[1]||h,l=null,e.includes("&"))r=e.split("&"),t.calculateInstance.isCellReference(r[1].split("$").join(""))&&(r[1]=t.getUpdatedCellRef(r[1]),l=r.join("&"));else if(t.calculateInstance.isCellReference(e.split("$").join("")))l=t.getUpdatedCellRef(e),n.length>1&&(l=n[0]+"!"+l);else if(s=h.match(/[/+\-*^><>=<=<>]+/g),s){r=h.split(s[0]);for(var c=0;c<r.length;c++)n=r[c].split("!"),e=n[1]||n[0],t.calculateInstance.isCellReference(e.split("$").join(""))&&(r[c]=t.getUpdatedCellRef(e),n.length>1&&(r[c]=n[0]+"!"+r[c]));l=r.join(s[0])}l&&l!==h&&(a=!0,i[u]=l)}),{isInvalid:a,ref:i.join(":")}},o.prototype.autoCorrectCellRef=function(e){var t=e.formula.lastIndexOf(")"),i;if(t>-1&&e.formula.split(")").length===2){for(var r=t-1;r>-1&&e.formula[r]!=="(";){if(e.formula[r]===")")return e.formula;r--}if(r>-1){for(var n=e.formula.substring(r+1,t),s=this.calculateInstance.getParseArgumentSeparator(),a=n.split(s),l=void 0,h=0;h<a.length;h++)i=this.correctCellReference(a[h]),i.isInvalid&&(l=!0,a[h]=i.ref);l&&(e.formula=e.formula.split(n).join(a.join(s)),e.isInvalid=!0)}}else e.formula.startsWith("=")&&!e.formula.includes(")")&&(i=this.correctCellReference(e.formula.substring(1,e.formula.length)),i.isInvalid&&(e.formula="="+i.ref,e.isInvalid=!0));return e.formula},o.prototype.getUpdatedCellRef=function(e){var t=e;e=e.trim();var i=e.indexOf("$")===0,r=e.search(/[a-zA-Z]/),n=e.search(/\d/);return r=i?r-1:r,(i?n>1:n>0)&&Me(e.substring(n,e.length))?t:e.substring(r,e.length)+e.substring(0,r)},o.prototype.initiateDefinedNames=function(){for(var e=this.parent.definedNames,t=0;t<e.length;){var i=e[t],r=this.parseSheetRef(i.refersTo),n=cu(r),s=!1,a=r.indexOf("http:")>-1?!0:r.indexOf("https:")>-1;if(n=n.split("$").join(""),n=n.split("=").join(""),n.indexOf(":")>-1){var l=n.split(":");(Mr(l[0])&&Mr(l[1])||l[0].match(/[0-9]/)&&l[1].match(/[0-9]/)||l[0].toUpperCase().match(/[A-Z]/)&&l[1].toUpperCase().match(/[A-Z]/))&&(s=!0)}else n.indexOf(":")<0&&Mr(n)&&(s=!0);a&&(s=!1),s?this.addDefinedName(i,!0,void 0,!0):(this.removeDefinedName(i.name,i.scope,!0),t--),t++}},o.prototype.addDefinedName=function(e,t,i,r){(i===void 0||i<-1)&&(i=this.parent.definedNames.length);var n=!0,s,a=e.name;if(e.refersTo.indexOf("!")<0){var l=Vn(this.parent);l=l.indexOf(" ")!==-1?"'"+l+"'":l,e.refersTo=l+"!"+(e.refersTo.indexOf("=")<0?e.refersTo:e.refersTo.split("=")[1])}var h=e.refersTo,u=this.parseSheetRef(e.refersTo);e.scope?(s=yt(this.parent,e.scope),s>-1&&(a=Vn(this.parent,s)+"!"+a)):e.scope="Workbook",e.comment||(e.comment=""),!t&&this.checkIsNameExist(e.name,e.scope)?n=!1:(this.calculateInstance.addNamedRange(a,u[0]==="="?u.substr(1):u),u[0]!=="="&&(e.refersTo="="+h),this.parent.definedNames.indexOf(e)<0&&(this.parent.definedNames.splice(i,0,e),this.parent.notify(Ua,{action:"setNameBoxValue",definedName:e})));var c={name:e.name,scope:e.scope,comment:e.comment,refersTo:e.refersTo,cancel:!1};return r||this.parent.notify("actionComplete",{eventArgs:c,action:"addDefinedName"}),n},o.prototype.removeDefinedName=function(e,t,i){var r=!1,n=t||"Workbook",s=this.getIndexFromNameColl(e,n);if(s>-1){var a=e;if(t){var l=yt(this.parent,t);l>-1&&(a=Vn(this.parent,l)+"!"+e)}this.calculateInstance.removeNamedRange(a);var h=this.parent.definedNames.splice(s,1);if(this.parent.notify(Ua,{action:"setNameBoxValue",definedName:h[0],isRemove:!0}),!i){var u={name:e,scope:n,cancel:!1};this.parent.notify("actionComplete",{eventArgs:u,action:"removeDefinedName"})}r=!0}return r},o.prototype.checkIsNameExist=function(e,t){var i=this.parent.definedNames.some(function(r){return r.name===e&&(t?r.scope===t:r.scope==="")});return i},o.prototype.getIndexFromNameColl=function(e,t){t===void 0&&(t="");var i=-1;return this.parent.definedNames.filter(function(r,n){r.name===e&&r.scope===t&&(i=n)}),i},o.prototype.calculateNow=function(e){var t=this,i=new kn;e.promise=i.promise;var r,n=function(){var h,u,c,d,p={isRefreshing:!0,action:"calculate"},f=t.calculateInstance.getFormulaInfoTable();e.sheets.forEach(function(v){c=v.id.toString(),h=t.calculateInstance.getSheetFamilyItem(c),u=h.isSheetMember?h.parentObjectToToken.get(c):"",t.parent.setSheetPropertyOnMute(v,"isSheetCalculated",!0),p.sheet=v,v.rows.forEach(function(m,y){p.rowIndex=y,m&&m.cells&&m.cells.forEach(function(S,b){S&&ut(S.formula)&&(d=u+Pi(b+1)+(y+1),(S.value===void 0||S.value===null||!f.has(d)||r&&r[d])&&(p.colIndex=b,p.value=S.formula,t.calculateFormula(p,d)))})})}),i.resolve(),t.calculateInstance.cell=""},s=e.sheets.length,a=function(){if(s--,!s){n(),t.parent.calculationMode==="Automatic"&&e.scope==="CalculateWorkbook"&&t.parent.setProperties({calculationMode:"Manual"},!0);var h=t.parent.getActiveSheet();h.conditionalFormats&&h.conditionalFormats.length&&t.parent.notify(Wi,{indexes:[],isAction:!0,refreshAll:!0,isEdit:!0})}},l=function(h){var u=h.id.toString(),c=t.calculateInstance.getSheetFamilyItem(u),d=c.isSheetMember?c.parentObjectToToken.get(u):"";r={};var p=t.calculateInstance.getDependentCells();return function(f,v){var m=d+et(f,v);p.has(m)&&p.get(m).forEach(function(y){r[y]||(r[y]=!0)})}};e.sheets.forEach(function(h){h.ranges.some(function(u){return u.dataSource&&(!u.info||!u.info.loadedRange||!u.info.loadedRange.length)})?t.parent.notify(ah,{sheet:h,autoDetectFormat:!0,loadFromStartCell:!0,updateDependentCellsCallback:l(h),loadComplete:a}):a()})},o.prototype.toFixed=function(e){var t=Number(e);return Math.round(t)!==t&&(e=t.toFixed(2)),e},o.prototype.commputeFormulaValue=function(e){var t=this.parseSheetRef(e.value);e.value=this.calculateInstance.computeExpression(t).toString()},o.prototype.getCellRefValue=function(e){var t,i=this.getSheetInfo(),r=i.length,n=this.calculateInstance.sheetToken,s=e.value,a=s.lastIndexOf(n);if(a!==-1){var l=s.substring(0,a);l.length>0&&l[0]===this.calculateInstance.getFormulaCharacter()&&(l=l.substring(1,e.value.length));for(var h=0;h<r;h++)if(l.toUpperCase()===i[h].visibleName.toUpperCase()){t=h;break}e.value=this.calculateInstance.getValueFromArg(n+t+n+s.substring(a+1).toUpperCase())}else s.length>0&&s[0]===this.calculateInstance.getFormulaCharacter()&&(e.value=this.calculateInstance.getValueFromArg(s.substring(1,e.value.length).toUpperCase()))},o.prototype.aggregateComputation=function(e){var t=this.parent.getActiveSheet(),i=V6(t),r=J(i.split(":")[1]);r[0]+1===t.rowCount&&r[1]+1===t.colCount&&(i="A1:"+et(t.usedRange.rowIndex,t.usedRange.colIndex));var n,s,a=this.calculateInstance.getCellCollection(i);for(s=0;s<a.length;s++)if(n=this.calculateInstance.getValueFromArg(a[s]),Me(n)){e.countOnly=!1;break}if(e.Count=this.calculateInstance.getFunction("COUNTA")(i),!(!e.Count||e.countOnly)){var l=["SUM","AVERAGE","MIN","MAX"],h=[],u=J(t.activeCell),c=G(u[0],u[1],t,!1,!0);for(s=0;s<4;s++){if(n=this.toFixed(this.calculateInstance.getFunction(l[s])(i)),c.format){var d={formattedText:n,value:n,format:c.format,cell:{value:n,format:c.format}};this.parent.notify(en,d),n=d.formattedText}h.push(n)}e.Sum=h[0],e.Avg=h[1],e.Min=h[2],e.Max=h[3]}},o.prototype.refreshInsertDelete=function(e){var t=this;if(e.modelType!=="Sheet"){var i=this.calculateInstance.getDependentFormulaCells(),r,n=cn(this.parent,e.sheet.id);this.parent.sheets.forEach(function(s,a){for(var l=0,h=s.usedRange.rowIndex;l<=h;l++)for(var u=0,c=s.usedRange.colIndex;u<=c;u++)r=G(l,u,s,!1,!0),r.formula&&ut(r.formula)&&(a===n?(e.isInsert||!(e.modelType==="Row"?l>=e.startIndex&&l<=e.endIndex:u>=e.startIndex&&u<=e.endIndex))&&t.updateFormula(e,r,l,u,n):r.formula.includes(e.sheet.name)&&t.updateFormula(e,r,l,u,n,!0,s))}),i.clear(),this.calculateInstance.getDependentCells().clear(),this.calculateInstance.getFormulaInfoTable().clear(),this.refreshNamedRange(e)}},o.prototype.getUpdatedFormulaOnInsertDelete=function(e){if(e.sheetNames){e.updateSheetRef||(e.updateSheetRef=this.getSheetRefUpdateOnDelete());var t=this.parseSheetRef(e.cell.formula,!1),i=t;e.sheetNames.forEach(function(r){i=e.updateSheetRef(r,i).value}),i!==t&&(e.cell.formula=i)}else this.updateFormula(e.insertDeleteArgs,e.cell,e.row,e.col,e.sheetIdx,e.otherSheet,e.formulaSheet)},o.prototype.updateFormula=function(e,t,i,r,n,s,a){var l,h,u,c,d,p=new RegExp(/^(?=.*[a-zA-Z])(?=.*\d)/g),f,v;t.formula&&t.formula.includes("UNIQUE")&&i!==void 0&&this.clearUniqueRange(i,r,a||e.sheet);for(var m=function(){var T=(I?"$":"")+Pi(u[1]+1)+(I?"$":"")+(u[0]+1);return(u[0]!==u[2]||u[1]!==u[3])&&(T+=":"+(I?"$":"")+Pi(u[3]+1)+(I?"$":"")+(u[2]+1)),T},y=this.parseFormulaArgument({formula:this.parseSheetRef(t.formula,!0),rangeRef:!0}),S=this.getSheetInfo(),b,w,I,x=!t.formula.includes(this.parent.listSeparator),M=0;M<y.length;M++)if(l=y[M].trim(),I=l.includes("$"),I&&(l=l.replace(/[$]/g,"")),f=!0,this.calculateInstance.isCellReference(l)){if(d=l.includes(":"),h=M&&y[M-1].trim(),h&&h[h.length-1]==="!"){if(h=h.replace(/['!]/g,""),b=S[n].sheet===S[n].visibleName?e.sheet.name:"`"+S[n].sheet+"`",h!==b)continue}else if(s)continue;!p.test(l)&&l.indexOf(":")>-1&&(f=!1,v=!!g(l.match(/[0-9]/))),u=tt(J(l)),c=this.parent.updateRangeOnInsertDelete(e,u,d,i,r,I,x),c&&(y[M]=u[2]<u[0]||u[3]<u[1]?this.calculateInstance.getErrorStrings()[W.Ref]:f?m():v?Be(u).replace(/\d/g,""):Be(u).replace(/[a-zA-Z]/g,""),w=!0)}var D="="+y.join("");if(w){var A,L=RegExp;S.forEach(function(T){D.includes("`"+T.sheet+"`")&&(A=new L("`"+T.sheet+"`","gi"),D=D.replace(A,T.visibleName))}),t.formula!==D&&(t.formula=D,this.parent.calculationMode==="Manual"&&(e.isInsert||e.isDelete)||(t.value=null))}},o.prototype.clearUniqueRange=function(e,t,i){var r={cellIdx:[e,t,e,t],isUnique:!1,uniqueRange:"",sheetName:i.name};this.parent.notify(gu,r);for(var n=J(r.uniqueRange),s=n[0];s<=n[2];s++)for(var a=n[1];a<=n[3];a++)delete G(s,a,i,!1,!0).value},o.prototype.clearAllUniqueFormulaValue=function(){for(var e=this.calculateInstance.uniqueRange,t,i,r,n=0;n<e.length;n++){var s=e[n].lastIndexOf("!");if(i=ke(this.parent,yt(this.parent,e[n].substring(0,s))),r=J(e[n].substring(s+1)),t=G(r[0],r[1],i),!(t&&t.value==="#SPILL!"))for(var a=r[0];a<=r[2];a++)for(var l=r[1];l<=r[3];l++)t=G(a,l,i),t&&t.value&&delete t.value}},o.prototype.parseFormulaArgument=function(e){var t,i,r=0,n=[],s=this.markSpecialChar(e.formula.replace("=",""),e.rangeRef),a=RegExp,l=new a(e.rangeRef?/\(|\)|=|\^|>|<|\+|-|\*|\/|%|&/g:/\(|\)|=|\^|>|<|:|\+|-|\*|\/|%|&/g),h=new a(this.parent.listSeparator,"g");s=s.split(new a(l.source+"|"+h.source,"g"));for(var u=s.length;r<u;){if(t=s[r],!t){r++;continue}t.length===1?n.push(this.isUniqueChar(t)?this.getUniqueCharVal(t):t):(i=t[0],t.indexOf("!")>0?(this.isUniqueChar(i)&&(n.push(this.getUniqueCharVal(i)),t=t.substr(1)),i=t.indexOf("!")+1,n.push(t.substring(0,i)),t=t.substring(i),i=t.indexOf(":"),i>-1&&t.indexOf("!")>i?(n.push(t.substring(0,i)),n.push(":"),t=t.substring(i+1),i=t.indexOf("!")+1,n.push(t.substring(0,i)),n.push(t.substring(i))):n.push(t)):this.isUniqueChar(i)?(n.push(this.getUniqueCharVal(i)),n.push(t.substr(1))):n.push(t)),r++}return e.formulaArr=n,n},o.prototype.getUniqueCharVal=function(e){switch(e){case this.uniqueOBracket:return"(";case this.uniqueCBracket:return")";case this.uniqueCSeparator:return this.parent.listSeparator;case this.uniqueCOperator:return":";case this.uniquePOperator:return"+";case this.uniqueSOperator:return"-";case this.uniqueMOperator:return"*";case this.uniqueDOperator:return"/";case this.uniqueModOperator:return"%";case this.uniqueConcateOperator:return"&";case this.uniqueEqualOperator:return"=";case this.uniqueExpOperator:return"^";case this.uniqueGTOperator:return">";case this.uniqueLTOperator:return"<"}return""},o.prototype.isUniqueChar=function(e){var t=e.charCodeAt(e);return t>=129&&t<=142},o.prototype.markSpecialChar=function(e,t){e=e.replace(/\(/g,"("+this.uniqueOBracket).replace(/\)/g,")"+this.uniqueCBracket);var i=RegExp;return t?e=e.replace(new i(this.parent.listSeparator,"g"),this.parent.listSeparator+this.uniqueCSeparator):e=e.replace(new i(this.parent.listSeparator,"g"),this.parent.listSeparator+this.uniqueCSeparator).replace(/:/g,":"+this.uniqueCOperator),e=e.replace(/\+/g,"+"+this.uniquePOperator).replace(/-/g,"-"+this.uniqueSOperator),e=e.replace(/\*/g,"*"+this.uniqueMOperator).replace(/\//g,"/"+this.uniqueDOperator),e=e.replace(/&/g,"&"+this.uniqueConcateOperator),e=e.replace(/=/g,"="+this.uniqueEqualOperator),e=e.replace(/\^/g,"^"+this.uniqueExpOperator),e=e.replace(/>/g,">"+this.uniqueGTOperator).replace(/</g,"<"+this.uniqueLTOperator),e.replace(/%/g,"%"+this.uniqueModOperator)},o.prototype.refreshNamedRange=function(e){var t=this;if(e.definedNames&&e.definedNames.length){e.definedNames.forEach(function(y){t.parent.removeDefinedName(y.name,y.scope),t.parent.addDefinedName(y)});return}var i=this.parent.definedNames.length;if(i)for(var r=Object.assign({},this.parent.definedNames),n,s,a,l,h,u,c,d=new RegExp(/^(?=.*[a-zA-Z])(?=.*\d)/g),p,f,v=0;v<i;v++){p=!0,l=r[v];var m=l.refersTo.lastIndexOf("!");a=l.refersTo.substring(m+1),s=l.refersTo.substring(1,m),u=s,u.match(/'/g)&&(u=u.slice(1,-1)),u===e.sheet.name&&(!d.test(a)&&a.indexOf(":")>-1&&(p=!1,f=!!g(a.match(/[0-9]/))),n=J(a),h=this.parent.updateRangeOnInsertDelete(e,n),p?c=Be(n):c=f?Be(n).replace(/\d/g,""):Be(n).replace(/[a-zA-Z]/g,""),e.isInsert?this.updateDefinedNames(l,s,c,h):e.modelType==="Row"?this.updateDefinedNames(l,s,c,h,[n[0],n[2]],e):e.modelType==="Column"&&this.updateDefinedNames(l,s,c,h,[n[1],n[3]],e))}},o.prototype.updateDefinedNames=function(e,t,i,r,n,s){if(r){var a=this.parent.definedNames.indexOf(e),l={action:"removeDefinedName",isRemoved:!1,definedName:e.name,scope:e.scope,isEventTrigger:!0};if(this.parent.notify(xt,l),n){var h={name:e.name,comment:e.comment,refersTo:e.refersTo,scope:e.scope};if(h=new rO(this.parent,"definedNames",h,!0),s.definedNames?s.definedNames.push(h):s.definedNames=[h],n[1]<n[0])return}e.refersTo=t+"!"+i,this.parent.notify(xt,{action:"addDefinedName",definedName:e,isAdded:!1,index:a,isEventTrigger:!0});var u={name:e.name,scope:e.scope,comment:e.comment,refersTo:e.refersTo,cancel:!1};this.parent.notify("actionComplete",{eventArgs:u,action:"refreshNamedRange"})}},o}(),fO=function(){function o(e){this.parent=e,this.localeObj=Yi(this.parent.locale);var t=nt.getDependables(zr,this.parent.locale,null).dateObject;t.dayPeriods&&t.dayPeriods&&t.dayPeriods.format&&t.dayPeriods.format.wide?(this.localeObj.am=t.dayPeriods.format.wide.am||"AM",this.localeObj.pm=t.dayPeriods.format.wide.pm||"PM"):(this.localeObj.am="AM",this.localeObj.pm="PM"),this.updateLocalizedFormats(t),this.addEventListener()}return o.prototype.numberFormatting=function(e){var t=this.parent.activeSheetIndex,i=!0;e.range&&e.range.indexOf("!")>-1&&(t=yt(this.parent,e.range.substring(0,e.range.lastIndexOf("!"))),i=t===this.parent.activeSheetIndex);var r=ke(this.parent,t),n=e.range?e.range.lastIndexOf("!")>-1?e.range.substring(e.range.lastIndexOf("!")+1):e.range:r.selectedRange,s=tt(J(n));e.curSym=Eh(this.parent.locale,ts);for(var a,l,h,u,c,d=s[0];d<=s[2];d++){u=Ar(r,d),c=i&&!st(r,d);for(var p=s[1];p<=s[3];p++)l=G(d,p,r,!1,!0),h=l.format,!Lo(l,r.columns[p],u)&&!sr(this.parent,r,{cell:{format:e.format},rowIdx:d,colIdx:p})&&(l=G(d,p,r),l.rowSpan<0||l.colSpan<0||(a={value:l.value,format:l.format,rowIndex:d,colIndex:p,sheetIndex:t,cell:l,refresh:i,curSymbol:e.curSym},this.getFormattedCell(a),c&&(this.setCell(a),a.td&&(this.parent.notify(fx,a),l.wrap&&(!u||!u.customHeight)&&h!==e.format&&this.parent.notify(Xa,{range:[d,p,d,p],wrap:!0,sheet:r,initial:!0,td:a.td,isOtherAction:!0})),h&&h!==e.format&&h.includes("[")&&Bx().indexOf(pl(e.format))===-1&&this.removeFormatColor(a,{format:h,style:l.style}))),this.parent.setUsedRange(d,p))}r.conditionalFormats&&r.conditionalFormats.length&&this.parent.notify(Wi,{indexes:s,isAction:!0,isEdit:!0}),this.parent.chartColl&&this.parent.chartColl.length&&this.parent.notify(lh,{range:s})},o.prototype.isDigitPlaceHolder=function(e){return e==="#"||e==="0"||e==="?"||e==="."},o.prototype.parseToLocalizedFormat=function(e){if(e.decimalGroupSepsChanged&&(e.format.includes(".")||e.format.includes(","))){for(var t=void 0,i=void 0,r,n=e.format.split(""),s=0;s<n.length;s++)t=n[s],t==='"'?(i=e.format.indexOf('"',s+1),i>-1&&(s=i)):t==="_"||t==="*"||t==="\\"?s++:t==="["?(i=e.format.indexOf("]",s+1),i>-1&&(s=i)):t===","?this.isDigitPlaceHolder(n[s-1])&&(n[s]=this.localeObj.group):t==="."&&(n[s-1]?(r=n[s-1].toLowerCase(),["d","m","y","h"].some(function(a){return r===a})||(n[s]=this.localeObj.decimal)):n[s]=this.localeObj.decimal);e.format=n.join("")}e.curChanged&&e.format.includes('"'+e.curSym+'"')&&(e.format=e.format.split('"'+e.curSym+'"').join(e.curSym))},o.prototype.updateLocalizedFormats=function(e,t){var i=this,r;Ui={currency:["$#,##0.00","$#,##0","$#,##0_);($#,##0)","$#,##0_);[Red]($#,##0)","$#,##0.00_);($#,##0.00)","$#,##0.00_);[Red]($#,##0.00)"],accounting:['_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)','_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)','_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)','_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'],time:e.timeFormats&&e.timeFormats.medium==="HH:mm:ss"?"HH:mm:ss":"h:mm:ss AM/PM"};var n=Eh(this.parent.locale,ts),s={curChanged:n!=="$",curSym:n,decimalGroupSepsChanged:this.localeObj.decimal!=="."&&this.localeObj.group!==","};if(s.curChanged){var a=new Et(this.parent.locale),l=a.getNumberPattern({currency:"$",useGrouping:!0,format:"c0"},!0);if(l&&l.endsWith("$")){var h=l[l.indexOf("$")-1].trim().length?"":" ";Ui.currency.forEach(function(S,b){if(S.includes("$#,##0")){var w="",I=S.split("$#,##0.")[1];if(I)for(var x=0;I[x]==="0";)w+="0",x++;w&&(w="."+w),Ui.currency[b]=S.split("$#,##0"+w).join("#,##0"+w+h+'"'+n+'"')}}),Ui.accounting.forEach(function(S,b){if(S.slice(0,S.indexOf("#")).includes("$")){var w=S.split(";"),I;w.forEach(function(x,M){x.includes("$")&&(x=x.replace("$",""),x.includes("0)")?I=x.indexOf("0)")+2:I=x.lastIndexOf(x.includes("0")?"0":x.includes("?")?"?":x.includes('"-"')?'"':"#")+1,I>0&&(w[M]=x.slice(0,I)+h+('"'+n+'"')+x.slice(I)))}),Ui.accounting[b]=w.join(";")}})}else{var u=function(S,b,w){return w[b]=S.split("$").join('"'+n+'"')};Ui.currency.forEach(u),Ui.accounting.forEach(u)}}var c=["General","0","0.00","#,##0","#,##0.00","#,##0_);(#,##0)","#,##0_);[Red](#,##0)","#,##0.00_);(#,##0.00)","#,##0.00_);[Red](#,##0.00)",Ui.currency[2],Ui.currency[3],Ui.currency[4],Ui.currency[5],"0%","0.00%","0.00E+00","##0.0E+0","# ?/?","# ??/??","m/d/yyyy","d-mmm-yy","d-mmm","mmm-yy","h:mm AM/PM","h:mm:ss AM/PM","h:mm","h:mm:ss","m/d/yyyy h:mm","mm:ss","mm:ss.0","@","[h]:mm:ss"].concat(Ui.accounting);t?(r=this.customFormats).splice.apply(r,[0,c.length].concat(c)):(this.customFormats=c,this.localizedFormats=[]);var d=[0,1,2,3,4,37,38,39,40,5,6,7,8,9,10,11,48,12,13,14,15,16,17,18,19,20,21,22,45,47,49,46,42,41,44,43],p;d.forEach(function(S,b){Qt&&Qt.has(S)&&(i.customFormats[b]=Qt.get(S),p=[5,6,7,8].indexOf(S),p>-1?Ui.currency[p+2]=i.customFormats[b]:(p=[42,41,44,43].indexOf(S),p>-1&&(Ui.accounting[p]=i.customFormats[b]))),s.format=i.customFormats[b],i.parseToLocalizedFormat(s),i.localizedFormats[b]=s.format});for(var f=function(S){var b=v.localizedFormats.findIndex(function(w,I){return w===i.localizedFormats[S]&&I<d.length});b>-1&&(v.localizedFormats.splice(S,1),v.customFormats.splice(S,1),S--),m=S},v=this,m,y=d.length;y<this.localizedFormats.length;y++)f(y),y=m},o.prototype.localizedFormatAction=function(e){e.action==="getLocalizedFormats"?(e.defaultFormats=this.customFormats,e.localizedFormats=this.localizedFormats):e.action==="mapNumberFormatId"?this.updateLocalizedFormats(nt.getDependables(zr,this.parent.locale,null).dateObject,!0):(e.curSym=Eh(this.parent.locale,ts),e.action==="parseToDefaultFormat"?this.parseToDefaultFormat(e):(e.decimalGroupSepsChanged=this.localeObj.decimal!=="."&&this.localeObj.group!==",",e.curChanged=e.curSym!=="$",e.defaultFormat||(e.defaultFormat=e.format,this.parseToLocalizedFormat(e)),this.localizedFormats.indexOf(e.format)===-1&&(this.localizedFormats.push(e.format),this.customFormats.push(e.defaultFormat))))},o.prototype.parseToDefaultFormat=function(e){var t=this,i=this.localeObj.decimal!=="."&&e.format.includes(this.localeObj.decimal),r=this.localeObj.group!==","&&e.format.includes(this.localeObj.group),n=e.curSym!=="$"&&e.format.includes(e.curSym);if(i||r||n){var s,a,l,h=e.format.split(";");h.forEach(function(u,c){for(var d=u.split(""),p=0;p<d.length;p++)l=d[p],l==='"'?p=u.indexOf('"',p+1):l==="_"||l==="*"||l==="\\"?p++:l==="["?(s=u.indexOf("]",p+1),s>-1&&(p=s)):i&&l===t.localeObj.decimal?(a=d[p-1],a?(a=a.toLowerCase(),["d","m","y","h"].some(function(f){return a===f})||(d[p]=".")):d[p]="."):r&&l===t.localeObj.group?t.isDigitPlaceHolder(d[p-1])&&(d[p]=","):n&&(l===e.curSym?d[p]='"'+e.curSym+'"':e.curSym.startsWith(l)&&u.substring(p,p+e.curSym.length)===e.curSym&&d.splice(p,e.curSym.length,'"'+e.curSym+'"'));h[c]=d.join("")}),e.format=h.join(";")}},o.prototype.getFormattedCell=function(e){var t=e.value===void 0||e.value===null?"":e.value;e.sheetIndex=e.sheetIndex===void 0?this.parent.activeSheetIndex:e.sheetIndex;var i=ke(this.parent,e.sheetIndex),r=e.cell||G(e.rowIndex,e.colIndex,i,!1,!0),n=!1,s=new Et;if(e.curSymbol||(e.curSymbol=Eh(this.parent.locale,ts)),(!e.format||e.format==="General")&&!e.skipFormatCheck&&(!r.formula||!r.formula.toLowerCase().startsWith("=text("))){if(e.type=e.format="General",!r.formula||r.formula&&r.formula.indexOf("&-")===-1){var a={value:t,updatedVal:t,cell:r,isEdit:e.isEdit,intl:s};this.checkDateFormat(a),(a.isDate||a.isTime)&&(n=!0,r.value=e.value=a.updatedVal,r.format&&r.format!=="General"?(e.format=r.format,e.type=Er(e.format)):r.format=e.format=hr(a.isDate?"ShortDate":"Time"))}}else e.type=Er(e.format),e.skipFormatCheck&&!e.format&&e.type==="General"&&(e.format="General");if(r.format&&this.isCustomType(r)){e.type="Custom";var l=r.format.indexOf("@")>-1;t!==""&&!l&&this.isPercentageValue(t.toString(),e,r)&&(t=e.value.toString());var h=void 0,u={};Qt&&cs(this.parent)&&(r.format=e.format=this.getMatchingCustomFormat(r.format));var c=r.format;r.format=r.format.split("\\").join("");var d=r.format.split(";");if(qs(d[0],!0,u,!0))t!==""&&(e.result=this.processCustomDateTime(e,r,u.type!=="time",d),h=!e.formatApplied),e.result=e.result||r.value;else if(d.length>1){if(r.format.indexOf("<")>-1||r.format.indexOf(">")>-1)e.result=this.processCustomConditions(r,e);else{var p=ca(r,this.parent.locale,this.localeObj.group,this.localeObj.decimal,e.curSymbol);p.isNumber?(r.value=p.value,this.processCustomAccounting(r,e,d,d[0]),h=!1):(e.result=this.processCustomText(r,e,d),h=!0)}r.format=c}else if(l)h=!0,e.result=this.processCustomText(r,e);else{var p=ca({value:t},this.parent.locale,this.localeObj.group,this.localeObj.decimal);if(p.isNumber)if(r.value=e.value=p.value,r.format.includes("E+0")){e.format!==r.format&&(e.format=r.format),this.checkAndSetColor(e);var f=e.format.split("E")[0],v=f.split(".");this.localeObj.decimal!=="."&&v.length===1&&(v=f.split(this.localeObj.decimal)),e.result=v[0].length>1?this.scientificHashFormat(e,v):this.scientificFormat(e)}else e.result=this.processCustomNumberFormat(r,e),h=!Me(r.value);else r.format&&r.format.includes("[")&&this.removeFormatColor(e,{format:r.format,style:r.style}),h=e.dataUpdate=!0}e.dataUpdate?e.formattedText=e.result||(g(e.value)?"":e.value.toString()):(e.value=e.result,e.formattedText=g(e.value)?"":e.value.toString()),h?e.isRightAlign=!1:e.isRightAlign=!g(e.value)}else{var m=this.processFormats(e,t,n,r,s,i);e.formattedText=m.fResult||(e.value===void 0||e.value===null?"":e.value.toString()),e.isRightAlign=m.rightAlign}return e.rowIndex!==void 0&&(r.format&&e.formattedText&&e.formattedText!==r.value&&r.format!=="General"?r.formattedText=e.formattedText:r.formattedText&&delete r.formattedText),e.formattedText},o.prototype.isCustomType=function(e){var t=Er(e.format);return t==="General"&&e.format!=="General"||t==="Time"&&this.parent.isEdit},o.prototype.processCustomFill=function(e,t,i,r){var n=e[e.indexOf("*")+1],s=e.split("*"+n);if(i.rowIndex===void 0||i.dataUpdate)r=r||this.processCustomNumberFormat({format:s.join(""),value:t.value},i);else{var a=void 0;if(s[1]){var l=parseFloat(t.value);l<0?(a=this.processCustomNumberFormat({format:s[1],value:Math.abs(l).toString()},i),r="-"+s[0].split("'").join("")):(a=this.processCustomNumberFormat({format:s[1],value:t.value},i),r=s[0].split("'").join("")),l===0&&(a=a.split("0").join(""))}else r=r||this.processCustomNumberFormat({format:s[0],value:t.value},i);i.isRowFill=!0,this.setCell(i),this.parent.notify(Af,{cell:t,cellEle:i.td,rowIdx:i.rowIndex,colIdx:i.colIndex,beforeFillText:r,repeatChar:n,afterFillText:a}),r=this.parent.isPrintingProcessing?r+a:r}return r},o.prototype.processCustomDateTime=function(e,t,i,r){var n=this;if(this.localeObj.decimal!=="."&&t.value&&t.value.toString().includes(this.localeObj.decimal)){var s=t.value.replace(this.localeObj.decimal,".");Me(s)&&(t.value=e.value=s)}var a,l=function(){var M=t.value.toString();if(M.includes(n.localeObj.dateSeparator)||M.indexOf("-")>0||M.includes(n.localeObj.timeSeparator))return!0;var D=nt.getDependables(zr,n.parent.locale,null).dateObject,A=D.months["stand-alone"]&&D.months["stand-alone"].abbreviated;return A&&!!Object.keys(A).find(function(L){return M.includes(A[""+L])})};if(Me(t.value)){if(r.length>1&&parseFloat(t.value)<=0&&(e.formatApplied=this.processCustomAccounting(t,e,r),e.formatApplied))return e.result}else if(a=l(),!a)return this.processCustomText(t,e,r);var h,u=r[0],c=new Et,d=function(M){var D,A;if(a){var L=void 0;if(t.format.includes("[h]")){var T=t.value.toString().split(":");T.length>1&&Number(T[0])>=24&&(L=Number(T[0])/24,T[0]="24",t.value=T.join(":"))}if(A=sx(t.value,new Et,n.parent.locale,u,t),D=A.dateObj&&A.dateObj.toString()!=="Invalid Date",D){if(A.dateObj.getFullYear()<1900)return"";var k=Ms(A.dateObj,t.value.toString().includes(":"),A.type==="time");L>=1&&(k+=L,A.dateObj=_s(k)),t.value=k.toString()}}else{if(n.checkAndProcessNegativeValue(e,t.value))return e.formatApplied=!0,e.formattedText;A={dateObj:_s(parseFloat(t.value))},D=A.dateObj&&A.dateObj.toString()!=="Invalid Date"}if(D){M&&i&&(e.dateObj=A.dateObj),e.formatApplied=!0;var F=void 0;if(u.startsWith("MM-dd-yyyy "))u=u.split(" ").splice(1).join(" "),F=c.formatDate(A.dateObj,{type:"date",skeleton:"yMd"})+(u?" "+c.formatDate(A.dateObj,{type:h,format:u}):"");else if(F=c.formatDate(A.dateObj,{type:h,format:u}),u=u.toLowerCase(),u.startsWith("[h]")){var R=Number(t.value.toString().split(".")[0])*24+A.dateObj.getHours();F=R.toString()+F.slice(F.indexOf("]")+1)}else if(u.startsWith("[m")){var N=Number(t.value.toString().split(".")[0])*1440+A.dateObj.getHours()*60+A.dateObj.getMinutes();F=N.toString()+F.slice(F.indexOf("]")+1)}else u.startsWith("[s")&&(F=(Number(t.value.toString().split(".")[0])*86400+(A.dateObj.getHours()*60+A.dateObj.getMinutes())*60+A.dateObj.getSeconds()).toString());return p?F.replace(n.localeObj.am,"A").replace(n.localeObj.pm,"P"):F}return""};u=u.split("_(").join(" ").split("_)").join(" "),t.format.indexOf("h")>-1&&(u=u.split("h").join("H"),h="time"),t.format.indexOf("s")>-1&&(h="time");var p=t.format.indexOf("A/P")>-1;if((t.format.indexOf("AM/PM")>-1||p)&&(u=u.split("H").join("h"),u=u.split("A/P").join("AM/PM").split("AM/PM").join("a"),h="time"),t.format.indexOf("d")>-1){h="date";for(var f=u.split(" "),v=void 0,m=void 0,y=void 0,S=void 0,b=0;b<f.length;b++){S=f[b].includes(this.localeObj.dateSeparator)?this.localeObj.dateSeparator:"-",m=f[b].split(S);for(var w=0;w<m.length;w++)y=m[w],v=y.match(/d/g),v&&v.length>2&&(m[w]=y.split("d").join("E"));f[b]=m.join(S)}u=f.join(" ")}if(t.format.indexOf("m")>-1){if(t.format.indexOf("s")>-1||t.format.indexOf("h")>-1){if(h="time",t.format.includes(" ")){var f=u.split(" ");(f[0].includes("d")||f[0].includes("y"))&&(f[0]=f[0].split("m").join("M"),u=f.join(" "))}}else if(h="date",u=u.split("m").join("M"),u.includes("MMMMM")){var I=u;u="MMMM";var x=d()[0];return u=I.split("MMMMM").join("p"),d(e.checkDate).split("p").join(x)}}return d(e.checkDate)},o.prototype.processCustomConditions=function(e,t){if(Me(e.value)){for(var i=e.format.split(";"),r=Number(e.value),n=void 0,s=void 0,a=void 0,l=0;l<i.length;l++)if(e.format=i[l],a=pl(e.format),a&&(e.format=e.format.split("["+a+"]").join("")),e.format.includes("[")){n=e.format.split("[")[1].split("]")[0];var h=n.split("<="),u=n.split(">="),c=n.split("<"),d=n.split(">");if(h.length===2&&r<=Number(h[1])||u.length===2&&r>=Number(u[1])||c.length===2&&r<Number(c[1])||d.length===2&&r>Number(d[1])){e.format=i[l].split("["+n+"]").join(""),s=!1;break}s=n.split(/<=|>=|<|>/).length===2}else{e.format=i[l],s=!1;break}return s?(this.removeFormatColor(t,{format:i.join(""),style:e.style}),this.processCustomFill("*#",e,t,"#####")):this.processCustomNumberFormat(e,t)}else return e.value},o.prototype.processCustomAccounting=function(e,t,i,r){var n=parseFloat(e.value);return n<0?i[1].includes("@")||(r=i[1]):n===0&&i[2]&&!i[2].includes("@")&&(r=i[2].includes(t.curSymbol+"0")?i[2].split("0").join("#"):i[2]),r?(t.result=this.processCustomNumberFormat({format:e.format,value:n<0?Math.abs(n).toString():e.value,style:e.style},t,r),!0):!1},o.prototype.processCustomText=function(e,t,i){var r=e.value||e.value?e.value.toString():"",n;if(i)if(i[3])n=i[3];else if(i[1]&&i[1].includes("@"))n=i[1];else return r;else n=e.format;var s=this.processCustomNumberFormat({format:n.split("@").join("#"),value:r.split(r).join("1")},t);return s&&(s=s.split("1").join(r),this.localeObj.decimal!=="."&&Me(s)&&s.includes(".")&&(s=s.replace(".",this.localeObj.decimal))),s},o.prototype.thousandSeparator=function(e,t){for(;e;)t=t/1e3,e--;return t},o.prototype.getSeparatorCount=function(e){for(var t=0,i=["#","0"],r=0;r<e.format.length;r++)e.format[r]==='"'&&e.format[r-1]!=="\\"?r=e.format.indexOf('"',r+1):e.format[r]===","&&!(i.indexOf(e.format[r+1])>-1)&&t++;return t},o.prototype.processDigits=function(e,t){t=t.split("?").join("0");var i=e.value.toString();if(i=this.getFormattedNumber(t,parseFloat(i)),i&&i.includes(this.localeObj.decimal)){var r=i.split(this.localeObj.decimal);i=r[0]+this.localeObj.decimal+r[1].split("0").join("  ")}return i||e.value},o.prototype.processFormatWithSpace=function(e,t,i){var r=" ",n={cell:t,char:r,width:0};this.parent.notify(Ny,n);for(var s=n.width,a,l={format:e,formattedText:""},h=0;h<e.length;h++)if(e[h]==="_"){n.char=e[h+1],this.parent.notify(Ny,n);var u=n.width;a=Math.round(u/s),e=e.replace(e[h]+e[h+1],r.repeat(a))}var c=e.length-e.trim().length;if(c>0){if(l.formattedText=this.getFormattedNumber(e.trim(),i),e[0]===" "){for(var d=1,p=1;e[p]===" ";)d++,p++;c-=d,l.formattedText=r.repeat(d)+l.formattedText}l.formattedText+=r.repeat(c)}else l.formattedText=this.getFormattedNumber(e,i);return l.format=e,l},o.prototype.removeFormatColor=function(e,t){Bx().indexOf(pl(t.format))>-1&&(e.color=t.style&&t.style.color?t.style.color:"",this.applyColor(e))},o.prototype.processCustomNumberFormat=function(e,t,i){if(!e.format)return"";var r=e.value,n=ca(e,this.parent.locale,this.localeObj.group,this.localeObj.decimal);if(n.isNumber){var s=void 0,a=void 0;e.value=n.value;var l=parseFloat(e.value.toString()),h=i||e.format;if(e.format.indexOf("[")>-1){var u=pl(h);u?(h=h.split("["+u+"]").join(""),t.color=u.toLowerCase(),this.applyColor(t)):this.removeFormatColor(t,e)}(h.indexOf('"')>-1||h.indexOf("\\")>-1)&&(h=this.processText(h),a=l===0&&!h.includes("#")&&!h.includes("0"),a&&(h+="#"));var c=this.getSeparatorCount(e);if(c){s=!0;var d=this.thousandSeparator(c,l);h.indexOf(".")===-1&&(d=Math.round(d)),r=this.getFormattedNumber(h.split(",").join(""),d),d===0&&(r=r.replace("0",""))}if(h.indexOf("?")>-1&&(s=!0,r=this.processDigits(e,h),h=h.split("?").join("")),h.indexOf("_")>-1){s=!0;var d=this.processFormatWithSpace(h,e,l);h=d.format,r=d.formattedText}if(r&&h.indexOf("?")>-1&&(r=r.replace("?"," ")),h.indexOf("*")>-1&&(s=!0,r=this.processCustomFill(h,e,t)),h==="General"&&(s=!0,r=l.toString()),s||(r=this.getFormattedNumber(h,l)),a&&r&&(r=r.replace("0","")),h[0]==="#"&&l>=0&&l<1){var p=h.split("#").join("").split(".");if(!p[0].includes("0")){l===0&&h.includes(".")&&(!p[1]||!p[1].includes("0"))&&(r=this.getFormattedNumber(h,.1),r=r.replace("1",""));var f=r.split(this.localeObj.decimal);f[0]=f[0].toString().replace(/^0+/,""),r=f.join(this.localeObj.decimal)}}r==="-0"&&(r="0")}return r},o.prototype.processText=function(e){var t=e;return t.indexOf('"')>-1?t=t.split('"').join("'"):t.indexOf("\\")>-1&&(t=t.split("\\").join("")),t},o.prototype.processFormats=function(e,t,i,r,n,s){var a;if(this.parent.isEdit&&e.type==="Scientific"&&!Me(e.value)&&(e.type="General"),t!==""){var l=void 0;switch(e.type!=="General"&&e.type!=="Text"&&this.isPercentageValue(t.toString(),e,r)&&(t=e.value.toString()),e.type){case"General":a={args:e,fResult:t,intl:n,isRightAlign:i,cell:r,rowIdx:Number(e.rowIndex),colIdx:Number(e.colIndex),sheet:s},a.fResult.toString().startsWith(`
`)||a.fResult.toString().endsWith(`
 `)||this.autoDetectGeneralFormat(a),t=a.fResult,i=a.isRightAlign;break;case"Number":l=ca({value:t},this.parent.locale,this.localeObj.group,this.localeObj.decimal,e.curSymbol,!0,!0),l.isNumber&&(r.value=e.value=l.value,t=this.applyNumberFormat(e,n),i=!0);break;case"Currency":l=ca({value:t,format:e.format},this.parent.locale,this.localeObj.group,this.localeObj.decimal,e.curSymbol),l.isNumber&&(r.value=e.value=l.value,t=this.currencyFormat(e,n,r),i=!0);break;case"Percentage":l=ca({value:t},this.parent.locale,this.localeObj.group,this.localeObj.decimal,e.curSymbol,!0,!0),l.isNumber&&(r.value=e.value=l.value,t=this.percentageFormat(e,n),i=!0);break;case"Accounting":t=this.accountingFormat(e,t,n,r),i=e.formatApplied;break;case"ShortDate":t=this.checkAndProcessNegativeValue(e,e.value)?e.formattedText:this.shortDateFormat(e,n,r),i=!!t;break;case"LongDate":t=this.checkAndProcessNegativeValue(e,e.value)?e.formattedText:this.longDateFormat(e,n),i=!!t;break;case"Time":t=this.checkAndProcessNegativeValue(e,e.value)?e.formattedText:this.timeFormat(e,n,r),i=!!t;break;case"Fraction":l=ca({value:t},this.parent.locale,this.localeObj.group,this.localeObj.decimal,null,!0),l.isNumber&&(r.value=e.value=l.value,t=this.fractionFormat(e),i=!0);break;case"Scientific":l=ca({value:t},this.parent.locale,this.localeObj.group,this.localeObj.decimal),l.isNumber&&(r.value=e.value=l.value,t=this.scientificFormat(e),i=!0);break;case"Text":this.localeObj.decimal!=="."&&Me(t)&&t.toString().includes(".")&&(t=t.toString().replace(".",this.localeObj.decimal)),i=!1;break}}return{fResult:t,rightAlign:i}},o.prototype.autoDetectGeneralFormat=function(e){var t=e.fResult,i,r=e.args.cell&&e.args.cell.formula&&e.args.cell.formula.indexOf("ADDRESS(")>0,n=e.args.cell&&e.args.cell.formula&&e.args.cell.formula.indexOf("DOLLAR(")>0,s=e.args.cell&&e.args.cell.formula&&e.args.cell.formula.indexOf("TEXT(")>0;if(!(n&&e.fResult&&e.fResult.toString().includes(e.args.curSymbol)||s)){if(e.fResult&&this.localeObj.decimal!=="."){var a=e.fResult.toString();i=a,a.includes(this.localeObj.decimal)&&(a=a.replace(this.localeObj.decimal,"."),Me(a)&&(a.includes("E")?e.fResult=a:(e.fResult=e.args.value=a=Number(a).toString(),oi(e.rowIdx,e.colIdx,e.sheet,{value:a},!0)),i=a.replace(".",this.localeObj.decimal)))}if(Me(e.fResult)){var a=Number(e.fResult).toString();if(e.fResult.toString().includes("E")?(e.args.format=hr("Scientific"),oi(e.rowIdx,e.colIdx,e.sheet,{value:a,format:e.args.format},!0),e.args.value=a,e.fResult=this.scientificFormat(e.args)):e.args.format&&(e.args.format.indexOf("%")>-1?e.fResult=this.percentageFormat(e.args,e.intl):e.args.format.indexOf(e.args.curSymbol)>-1?e.fResult=this.currencyFormat(e.args,e.intl,e.args.cell):e.fResult=this.applyNumberFormat(e.args,e.intl)),e.args.format==="General"){if(e.args.cell&&e.args.cell.formula&&a.includes(".")&&a.length>11){var l=a.indexOf(".")+1;i=null,e.args.cell.formula.includes("RANDBETWEEN")&&(e.fResult=a=l<7?a:parseFloat(a).toFixed(0))}e.cellVal=a,e.prevVal=i,this.parseDecimalNumber(e),g(e.fResult)&&!g(e.cellVal)&&(e.fResult=e.cellVal)}e.isRightAlign=!0}e.fResult&&this.updateAutoDetectNumberFormat(e),r&&(e.isRightAlign=!1,e.fResult=t)}},o.prototype.parseDecimalNumber=function(e){var t=e.cellVal.split(".");if(t[0].length>11){e.cellVal=Math.abs(Number(t[0])).toString().substring(0,6).replace(/0+$/,"");var i=e.cellVal.length-1;i>-1&&(e.fResult=this.scientificFormat(e.args,i>5?5:i))}else if(t[1])if(e.cellVal.length>11){var r=10-(t[0].length-(Math.sign(Number(e.cellVal))<0?1:0));e.fResult=Number(Number(e.cellVal).toFixed(r>0?r:0)).toString()}else if(e.cellVal.includes("e-")){var n=e.cellVal.split("e-"),i=Number(n[1])+(n[0].includes(".")?n[0].split(".")[1].length:0);n[0]=n[0].replace(".",this.localeObj.decimal),n[1].length===1&&(n[1]="0"+n[1]),e.args.updateValue||oi(e.rowIdx,e.colIdx,e.sheet,{value:Number(e.cellVal).toFixed(i)},!0),e.fResult=n.join("E-")}else e.prevVal?e.fResult=e.prevVal:e.args.updateValue&&this.localeObj.decimal!=="."&&(e.fResult=e.cellVal.replace(".",this.localeObj.decimal))},o.prototype.updateAutoDetectNumberFormat=function(e){var t=e.fResult.toString(),i=e.args.cell||e.cell;if(this.isPercentageValue(t,e.args,i))i.format=t.includes(this.localeObj.decimal)?hr("Percentage"):"0%",e.args.updateValue||(e.args.format=i.format,e.fResult=this.percentageFormat(e.args,e.intl),e.isRightAlign=!0);else{var r=t?t.toString().split("/"):[],n=this.parent.isEdit&&Er(i.format)==="Scientific"&&r.length===2&&Me(r[0])&&Me(r[1]);if(t.includes(" ")||n){var s=n?r:t.split(" ");if(n||s[1].includes("/")&&Me(s[0])&&Number(s[0])%1===0){var a=n?r:s[1].split("/");if(Me(a[0])&&Number(a[0])%1===0&&Me(a[1])&&Number(a[1])%1===0){i.format="# "+(a[0].length>1||a[1].length>1?"??/??":"?/?"),i.value=n?(Number(a[0])/Number(a[1])).toString():(Number(s[0])+Number(a[0])/Number(a[1])).toString(),e.args.updateValue||(e.args.value=i.value,e.args.format=i.format,e.fResult=this.fractionFormat(e.args),e.isRightAlign=!0);return}}}var l="";t.includes(e.args.curSymbol)&&(l=t.includes(this.localeObj.decimal)?Ui.currency[0]:Ui.currency[1],t=t.replace(e.args.curSymbol,""));var h=this.localeObj.decimal==="."||e.args.isEdit&&!i.formula;h&&t.includes(this.localeObj.group)&&fd(t,this.parent.locale,this.localeObj.group,this.localeObj.decimal)&&(t=t.split(this.localeObj.group).join(""),l||(l=t.includes(this.localeObj.decimal)?"#,##0.00":"#,##0")),l?(t=t.replace(this.localeObj.decimal,"."),Me(t)&&(e.args.value=Number(t).toString(),e.args.updateValue?(e.args.cell.value=e.args.value,e.args.cell.format=l):(e.args.format=l,oi(e.rowIdx,e.colIdx,e.sheet,{value:e.args.value,format:l},!0),l.includes('"')&&(l=this.processText(l)),e.fResult=this.getFormattedNumber(l,Number(e.args.value)),e.isRightAlign=!0))):this.localeObj.decimal!=="."&&e.args.format==="General"&&Me(t)&&t.includes(".")&&(e.fResult=Number(t).toString().replace(".",this.localeObj.decimal))}},o.prototype.isPercentageValue=function(e,t,i){if(e.includes("%")){var r=e.split("%");if(r[0]!==""&&r[1].trim()===""){var n=ca({value:r[0]},this.parent.locale,this.localeObj.group,this.localeObj.decimal);if(n.isNumber)return t.value=Number(n.value)/100,i.value=t.value.toString(),!0}}return!1},o.prototype.findSuffix=function(e,t){var i=e.length,r=i-t.length;return e.substr(0,r<0?0:r)+t},o.prototype.applyNumberFormat=function(e,t){e.format=this.isCustomFormat(e.format);var i=e.format.split(";");if(Number(e.value)>0)e.format=i[0];else if(Number(e.value)===0){if(e.format=i[2]?i[2]:i[0],e.format.indexOf('"')>-1&&e.format.indexOf("#")===-1)return e.format=e.format.split("_").join(" ").split("*").join(" ").split("?").join(" ").split('"').join(""),e.format}else if(Number(e.value)<0)e.format=g(i[1])?i[0]:i[1].split("*").join(" "),e.format.indexOf("-")>-1&&(e.value=e.value.toString().split("-").join(""));else if(e.format=i[3]?i[3]:i[0],e.format=e.format.split("_").join(" ").split("*").join(" ").split("?").join(" "),e.format.indexOf("@")>-1)return e.format.split("@").join(e.value.toString());if(e.format=e.format.split("_").join(" ").split("*").join(" ").split('"').join(""),e.format.indexOf("?")>-1&&e.format.indexOf(this.localeObj.decimal)>-1){var r=e.format.split(this.localeObj.decimal)[1].length,n="";if(Number(e.value)%1){var s=e.value.toString().split(".")[1].length;r>s?n=" ":n="0"}e.format=e.format.split("?").join(n)}else e.format=e.format.split("?").join(" ");return Number(e.value)<0&&e.cell&&e.cell.format&&(e.format=e.cell.format),t.formatNumber(Number(e.value),{format:e.format})},o.prototype.isCustomFormat=function(e){return(e==='_-* #,##0.00_-;-* #,##0.00_-;_-* "-"_-;_-@_-'||e==='_-* #,##0_-;-* #,##0_-;_-* "-"_-;_-@_-')&&(e=""),e=e===""?hr("Number"):e,e=e.toString().split("_)").join(" ").split("_(").join(" ").split("[Red]").join(""),e},o.prototype.currencyFormat=function(e,t,i){e.format=e.format||hr("Currency"),e.format=e.format.split("_(").join(" ").split("_)").join(" ");var r=e.format.split(";"),n=pl(e.format),s=Number(e.value);return s>=0||g(r[1])?(n&&(e.color=i.style&&i.style.color?i.style.color:"",this.applyColor(e)),e.format=r[0]):(s=Math.abs(s),e.format=r[1].split("["+n+"]").join("").split("*").join(" "),n&&(e.color=n.toLowerCase(),this.applyColor(e))),e.format=this.getFormatForOtherCurrency(e.format),e.format.includes('"')&&(e.format=this.processText(e.format)),t.formatNumber(s,{format:e.format,currency:ts})},o.prototype.applyColor=function(e){e.refresh&&(this.setCell(e),e.td&&e.td.style.color!==e.color&&this.parent.notify(Dr,{style:{color:e.color},rowIdx:e.rowIndex,colIdx:e.colIndex,td:e.td}))},o.prototype.setCell=function(e){if(!e.td){var t={sheet:ke(this.parent,e.sheetIndex),cell:e.cell,rowIdx:e.rowIndex,colIdx:e.colIndex};(e.cell.rowSpan>1||e.cell.colSpan>1)&&xb(t),e.td=this.parent.getCell(t.rowIdx,t.colIdx)}},o.prototype.percentageFormat=function(e,t){return e.format=e.format===""?hr("Percentage"):e.format,t.formatNumber(Number(e.value),{format:e.format})},o.prototype.accountingFormat=function(e,t,i,r){e.format=e.format||hr("Accounting"),e.format=e.format.split("_(").join(" ").split("_)").join(" ").split("[Red]").join("").split("_").join("");var n=e.format.split(";"),s=ca({value:t},this.parent.locale,this.localeObj.group,this.localeObj.decimal,e.curSymbol,!1,!0);if(s.isNumber){r.value=e.value=s.value;var a=Number(e.value);if(a>=0?e.format=a===0&&n[2]?n[2]:n[0]:(e.format=n[1].split("*").join(" "),a=Math.abs(a)),e.format.includes(e.curSymbol)&&e.format.includes('"')&&(e.format=this.processText(e.format)),e.format=this.getFormatForOtherCurrency(e.format),e.formatApplied=!0,a===0){if(e.format=this.processText(e.format.split("*").join(" ").split("?").join(" ")),!e.format.includes("#")&&!e.format.includes("0")){e.format+="#";var l=i.formatNumber(a,{format:e.format,currency:ts});return l.includes("0")&&(l=l.replace("0","")),e.dataUpdate?l.split(" ").join(""):l}var h=i.formatNumber(a,{format:e.format,currency:ts});return e.dataUpdate?h.split(" ").join(""):h}else{var h=i.formatNumber(a,{format:e.format,currency:ts});return e.dataUpdate?h.split(" ").join(""):h}}else if(n[3])return this.processCustomText(r,e,n);return t},o.prototype.getFormatForOtherCurrency=function(e){if(e.indexOf("[$")>-1){var t=e.split("]")[0].split("[$")[1].split("-")[0];e.indexOf("0")>e.indexOf("[$")?e=t+e.slice(e.indexOf("]")+1,e.length):e=e.slice(0,e.indexOf("[$"))+t}return e},o.prototype.checkAndProcessNegativeValue=function(e,t){if(t&&Me(t)&&Number(t)<0){if(e.rowIndex===void 0||e.dataUpdate)return e.formattedText="#".repeat(e.dataUpdate?7:10),!0;e.isRowFill=!0,this.setCell(e);var i={cell:e.cell,cellEle:e.td,rowIdx:e.rowIndex,colIdx:e.colIndex,repeatChar:"#"};return this.parent.notify(Af,i),e.formattedText=i.formattedText,!0}return!1},o.prototype.shortDateFormat=function(e,t,i){var r;Qt&&cs(this.parent)&&i&&i.format==="m/d/yyyy"&&Qt.has(14)&&(i.format=e.format=Qt.get(14));var n;e.format===""||e.format==="General"||e.format==="mm-dd-yyyy"||e.format==="m/d/yyyy"?(n="MM-dd-yyyy",r={type:"date",skeleton:"yMd"}):(n=e.format,e.format===hr("ShortDate")?r={type:"date",skeleton:"yMd"}:r={type:"date",format:e.format});var s;e.value=e.value.toString();var a=this.checkForDateFormat(e,i);if(e.value&&i&&(!Me(e.value)||a)){var l={value:e.value,updatedVal:e.value,cell:i,isEdit:e.isEdit,intl:t,skipCellFormat:!0,format:n};if(this.checkDateFormat(l),l.isDate||l.isTime)i.value=e.value=l.updatedVal,s=l.dateObj;else if(a)s=_s(e.value);else return""}else s=_s(e.value);return!s||s.toString()==="Invalid Date"?"":s.getFullYear()<1900||s.getFullYear()>9999?Me(e.value)?e.value.toString():"":(e.checkDate&&(e.dateObj=s),t.formatDate(s,r))},o.prototype.longDateFormat=function(e,t){e.value=e.value.toString();var i,r=this.checkForDateFormat(e,e.cell);if((e.value.includes(this.localeObj.dateSeparator)||e.value.indexOf("-")>0)&&(!Me(e.value)||r))if(r){var n={value:e.value,updatedVal:e.value,cell:e.cell,isEdit:e.isEdit,intl:t};this.checkDateFormat(n),n.isDate||n.isTime?(i=n.dateObj,e.cell.value=e.value=Ms(i).toString()):i=_s(e.value)}else if(i=sx(e.value,t,this.parent.locale,"",e.cell).dateObj,i&&i.toString()!=="Invalid Date"&&i.getFullYear()>=1900)e.cell.value=e.value=Ms(i).toString();else return Me(e.value)?e.value:"";else i=_s(e.value);return!i||i.toString()==="Invalid Date"?"":i.getFullYear()<1900||i.getFullYear()>9999?Me(e.value)?e.value.toString():"":(e.checkDate&&(e.dateObj=i),t.formatDate(i,{type:"date",skeleton:"full"}))},o.prototype.checkForDateFormat=function(e,t){var i,r=e.value;if(this.localeObj.decimal==="."||e.isEdit&&!t.formula){if(r.includes(this.localeObj.group)&&fd(r,this.parent.locale,this.localeObj.group,this.localeObj.decimal))return r=r.replace(this.localeObj.group,""),this.localeObj.decimal!=="."&&r.includes(this.localeObj.decimal)&&(r=r.replace(this.localeObj.decimal,".")),Me(r)&&t&&(t.value=e.value=r),!1;i=this.localeObj.dateSeparator==="."&&r.includes("."),this.localeObj.decimal!=="."&&!Me(r)&&r.includes(this.localeObj.decimal)&&(r=r.replace(this.localeObj.decimal,"."),Me(r)&&t&&(t.value=e.value=r))}return i},o.prototype.timeFormat=function(e,t,i){if(g(e.value))return"";var r=hr("Time"),n;(e.format===""||e.format==="General")&&(n=r),e.format==="h:mm:ss AM/PM"?n="h:mm:ss a":n=e.format;var s=e.value.toString();if(!Me(s)&&i){var a={value:s,updatedVal:s,cell:i,isEdit:e.isEdit,intl:t,skipCellFormat:!0};if(this.checkDateFormat(a),a.isDate||a.isTime)i.value=s=a.updatedVal;else return""}var l=s.split(".");return g(l[1])||(s=parseFloat(l[0]+1+"."+l[1])||s),t.formatDate(_s(s),{type:"time",skeleton:"medium",format:n})},o.prototype.scientificHashFormat=function(e,t){var i=this.findDecimalPlaces(e.format),r=t[0].split("0").length-1+(t[0].split("#").length-1),n=Number(e.value).toExponential(i+r),s;if(n.includes("e+"))s="e+";else if(n.includes("e-"))s="e-";else return n;var a=n.split(s),l=a[0].split("."),h=Number(a[1]),u;if(s==="e-"){var c=h+Math.abs(h-r*(h>r?2:1));u=c-h,a[1]=c.toString()}else u=h%r,a[1]=(h-u).toString();u>0&&(l[0]+=l[1].substring(0,u),l[1]=l[1].slice(u),a[0]=l.join("."));var d=+("1"+"0".repeat(i));return this.getFormattedNumber(t.join("."),Number((Math.round(Number(a[0])*d)/d).toFixed(i)))+s.toUpperCase()+this.findSuffix(e.format.split("+")[1],a[1])},o.prototype.scientificFormat=function(e,t){e.format||(e.format=hr("Scientific"));var i=e.format.split("+")[1]||"00";t===void 0&&(t=this.findDecimalPlaces(e.format));var r=Number(e.value).toExponential(t);return r.indexOf("e+")>-1?r=r.split("e+")[0]+"E+"+this.findSuffix(i,r.split("e+")[1]):r.indexOf("e-")>-1&&(r=r.split("e-")[0]+"E-"+this.findSuffix(i,r.split("e-")[1])),r.replace(".",this.localeObj.decimal)},o.prototype.fractionFormat=function(e){var t,i,r;e.format=e.format||hr("Fraction"),this.checkAndSetColor(e);var n=e.value.toString().split("."),s=e.format.split("?").length/2,a=e.format.split(" "),l=a[1]?a[1].split("/"):[];if(/^\?{1,3}\/\?{1,3}$|^\?\/[248]$|^\?\?\/16$/.test(a[1])){if(n.length===2&&!n[1].startsWith("0".repeat(l[1].trim().length||0))){for(var h=[0,1,Number.MAX_VALUE],u=h[0],c=h[1],d=h[2],p=l[1].includes("?")?Number("9".repeat(l[1].split("?").length-1)):Number(l[1]),f=parseFloat("0."+n[1]),v=1;v<=p;v++){var m=Math.round(f*v),y=Math.abs(f-m/v);y<d&&(t=[m,v,y],u=t[0],c=t[1],d=t[2])}var S=XI(u,c);i=[u/S,c/S],u=i[0],c=i[1],u===c?n[0]=""+(parseInt(n[0],10)+1):u!==0&&(r=u+"/"+c)}}else n.length===2&&!n[1].startsWith("0".repeat(s))&&(r=P6(Number(e.value)));var b=this.getFormattedNumber(a[0],Math.abs(Number(n[0])));return r?(b=b==="0"?"":b,(Number(e.value)<0?"-":"")+b+" "+r):(Number(e.value)<0?"-":"")+b+" "+"  ".repeat(s*2)},o.prototype.checkAndSetColor=function(e){var t=pl(e.format);t&&(e.format=e.format.split("["+t+"]").join(""),e.color=t.toLowerCase(),this.applyColor(e))},o.prototype.findDecimalPlaces=function(e){var t=e.toUpperCase().indexOf("E");if(t>-1){var i=e.indexOf(this.localeObj.decimal);return i===-1&&this.localeObj.decimal!=="."&&(i=e.indexOf(".")),i>0?e.substring(i+1,t).length:0}return 2},o.prototype.checkDateFormat=function(e){if(!g(e.value)){var t=e.cell||G(e.rowIndex,e.colIndex,ke(this.parent,g(e.sheetIndex)?this.parent.activeSheetIndex:e.sheetIndex),!1,!0),i=t.format;this.parent.isEdit&&Er(t.format)==="Scientific"&&(t.format="");var r=this.checkCustomDateFormat(e.value.toString(),t,e.isEdit);if(r.val!=="Invalid"){var n=void 0;if(r.format.startsWith("[h]")){var s=r.val.split(":");s.length>1&&Number(s[0])>=24&&(n=Number(s[0])/24,s[0]="24",r.val=s.join(":"))}var a=sx(r.val,e.intl||new Et(this.parent.locale),this.parent.locale,r.format||e.format,e.skipCellFormat&&t,r.isDateTime);if(a.dateObj&&a.dateObj.toString()!=="Invalid Date"){var l=a.dateObj.getFullYear();if(l>=1900&&l<=9999){e.isTime=a.type==="time";var h=Ms(a.dateObj,r.val.includes(":"),e.isTime);if(n>=1&&(h+=n,a.dateObj=_s(h)),r.val=h.toString(),(!t.format||t.format==="General")&&(e.isTime?t.format=hr("Time"):t.format=hr("ShortDate"),e.updateValue)){t.value=r.val;return}e.isDate=a.type==="date"||a.type==="datetime",e.dateObj=a.dateObj}e.updatedVal=r.val}}else i&&(t.format=i)}},o.prototype.checkCustomTimeFormat=function(e,t){var i=this,r=[],n=" "+this.localeObj.am,s=" "+this.localeObj.pm,a=e.includes(n)||e.includes(s);a||(e.includes(n.toLowerCase())||e.includes(s.toLowerCase()))&&(e=e.replace(n.toLowerCase(),n).replace(s.toLowerCase(),s),a=!0);var l=e.split(this.localeObj.timeSeparator),h=l.length===3&&a,u;if(l.length<=3){var c,d,p=a?12:23;l.forEach(function(v,m){v=v.trim(),l[m]=v,v.includes(n)||v.includes(s)?(u=" AM/PM",v=v.replace(n,"").replace(s,"")):u="",c=Number(v),Me(c)&&c>=0?c>=24&&m===0&&l.length>1?r.push("[h]"):c<=p&&m===0?(r.push("h"+u),l.length===1&&(u?(d=e.split(" "),d[0]+=i.localeObj.timeSeparator+"00",l[0]=d.join(" ")):(r=[],e="Invalid"))):c<=60&&(r.length===1||r.length===2)?(r.length===1?(r.push("mm"+u),l.length===2&&r[0]==="[h]"&&r.push("ss")):r.push("ss"),v.length===1&&(l[m]="0"+l[m])):(r=[],e="Invalid"):(r=[],e="Invalid")})}else e="Invalid";if(r.length){e=l.join(this.localeObj.timeSeparator);var f=void 0;if(h?f=this.customFormats[24]:(f=r.join(":"),Qt&&(f=this.getMatchingCustomFormat(f))),!t.format||t.format==="General")return t.format=f,{val:e,format:f}}return{val:e,format:""}},o.prototype.checkCustomDateFormat=function(e,t,i){var r=this,n,s=t.format,a;if(e.includes(this.localeObj.dateSeparator)&&(!e.includes(" "+this.localeObj.am)&&!e.includes(" "+this.localeObj.pm)||e.replace(" "+this.localeObj.am,"").replace(" "+this.localeObj.pm,"").includes(this.localeObj.dateSeparator)))n=this.localeObj.dateSeparator;else if(e.indexOf("-")>0)n="-";else if(e.indexOf(",")>0){var l=new Et(this.parent.locale),h=l.parseDate(e,{skeleton:"full"});return h&&!isNaN(h.getTime())?{val:e,format:"",isDateTime:!1}:{val:"Invalid",format:""}}else return e.includes(this.localeObj.timeSeparator)||e.includes(" "+this.localeObj.am)||e.includes(" "+this.localeObj.pm)?this.checkCustomTimeFormat(e,t):{val:"Invalid",format:""};if(e.includes(this.localeObj.timeSeparator)&&e.includes(" ")){var u=e.split(" ");if(e=u.shift(),a=this.checkCustomTimeFormat(u.join(" "),t),a.val==="Invalid")return{val:"Invalid",format:""}}var c=e.split(n),d="",p=[],f=function(L){d=p.join(n),(!s||s==="General")&&(t.format=L)},v,m=nt.getDependables(zr,this.parent.locale,null).dateObject,y=m.months["stand-alone"]?m.months["stand-alone"].wide:{},S=m.months["stand-alone"]?m.months["stand-alone"].abbreviated:{1:""},b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],w=function(L,T,k,F){if(S[""+T]&&S[""+T].toLowerCase()===k){v=b[Number(T)-1];return}var R=L.substring(0,F);R===k&&(v=b[Number(T)-1])};if(c.length===2){var I=function(L){e=v,p[0]="MMM",Number(L)<=31&&Number(L)>0?(e=L+n+e,r.localeObj.dateSeparator!=="/"&&n!=="-"&&(e+=n+new Date().getFullYear()),p.splice(0,0,"dd"),f(r.customFormats[21])):(L.length===2&&Me(L)&&Number(L)>-1&&(L=(Number(L)<30?new Date().getFullYear().toString().slice(0,2):"19")+L),Number(L)>=1900&&Number(L)<=9999?(e="1"+n+e+n+L,p[1]="yyyy",f(r.customFormats[22])):e="Invalid")};c[0]=c[0].toLowerCase().trim(),c[1]=c[1].toLowerCase().trim(),!Number(c[0])&&c[0].length>=S[1].length?(Object.keys(y).find(function(L){return w(y[""+L].toLowerCase(),L,c[0],c[0].length)}),!g(v)&&!c[0].includes(",")&&I(c[1])):!Number(c[1])&&c[1].length>=S[1].length?(Object.keys(y).find(function(L){return w(y[""+L].toLowerCase(),L,c[1],c[1].length)}),g(v)||I(c[0])):Number(c[0])&&Number(c[0])<=12&&Number(c[1])&&(this.localeObj.dateSeparator==="/"||n==="-"||i&&!t.formula)&&(v=b[Number(c[0])-1],I(c[1])),p.length||(e="Invalid")}else if(c.length>2)for(var x=function(L){Me(c[L])?c[L].length!==4&&c[L].length!==2&&c[L].length!==1&&(e="Invalid"):(c[L]=c[L].trim(),Object.keys(y).find(function(T){return w(y[""+T].toLowerCase(),T,c[L].trim().toLowerCase(),c[L].length)}),g(v)?e="Invalid":L===1&&(p[1]="MMM",c[2]=c[2].trim(),c[2].length===2&&Me(c[2])&&Number(c[2])>-1&&(c[2]=(Number(c[2])<30?new Date().getFullYear().toString().slice(0,2):"19")+c[2]),Number(c[0])<=31&&Number(c[2])>=1900&&Number(c[2])<=9999&&(e=c[0]+n+v,e+=n+c[2],p[0]="d",p[2]="yy",f(M.customFormats[20]),p[2]="yyyy",d=p.join(n))))},M=this,D=0;D<c.length;D++)x(D);var A;return a&&e!=="Invalid"&&((!s||s==="General")&&(t.format=this.customFormats[27]),d&&a.format&&(d+=" "+a.format),e+=" "+a.val,A=!0),{val:e,format:d,isDateTime:A}},o.prototype.formattedBarText=function(e){var t=this;if(!(e.value===""||g(e.value))){var i={},r=e.cell&&e.cell.format||"",n=e.type||(r&&qs(r,!0,i,!0)?i.type:""),s=new Et,a=e.value,l=e.showFormattedText&&(r==="dd-MM-yyyy"||r==="dd/MM/yyyy")?r:hr("ShortDate"),h=hr("Time");h==="h:mm:ss AM/PM"&&(h="h:mm:ss a");var u=r.toLowerCase(),c=function(){t.localeObj.decimal!=="."&&e.value&&(e.value=e.value.toString(),Me(e.value)&&e.value.includes(".")&&(e.value=e.value.replace(".",t.localeObj.decimal)))};if(n==="time"&&u.includes("m")&&!u.includes(":m")&&!u.includes("m:")&&!u.includes("[m")&&!u.includes("am")&&(n="date"),n==="date"){var d=e.value.toString();e.value=this.shortDateFormat({type:n,value:e.value,format:l},s,e.cell),e.value&&d.includes(".")&&(e.value+=" "+this.timeFormat({type:n,value:d,format:h},s))}else n.includes("time")?a&&Number(a)>=1||n==="datetime"?e.value=this.shortDateFormat({type:n,value:e.value,format:l},s)+" "+this.timeFormat({type:n,value:e.value,format:h},s):e.value=this.timeFormat({type:n,value:e.value,format:h},s):e.cell.format&&e.cell.format.includes("%")&&Me(e.cell.value)?(e.value=this.parent.getDisplayText(e.cell),e.value.includes("%")||(e.value=a,c())):c();(!e.value||e.value&&e.value.toString().indexOf("null")>-1)&&(e.value=a)}},o.prototype.getFormattedNumber=function(e,t){return new Et().formatNumber(Number(t),{format:e})||""},o.prototype.getMatchingCustomFormat=function(e){return e==="#,##0_);(#,##0)"&&Qt.has(37)?Qt.get(37):e==="#,##0_);[Red](#,##0)"&&Qt.has(38)?Qt.get(38):e==="#,##0.00_);(#,##0.00)"&&Qt.has(39)?Qt.get(39):e==="#,##0.00_);[Red](#,##0.00)"&&Qt.has(40)?Qt.get(40):e==="d-mmm-yy"&&Qt.has(15)?Qt.get(15):e==="d-mmm"&&Qt.has(16)?Qt.get(16):e==="mmm-yy"&&Qt.has(17)?Qt.get(17):e==="h:mm AM/PM"&&Qt.has(18)?Qt.get(18):e==="h:mm:ss AM/PM"&&Qt.has(19)?Qt.get(19):e==="h:mm"&&Qt.has(20)?Qt.get(20):e==="h:mm:ss"&&Qt.has(21)?Qt.get(21):e==="m/d/yyyy h:mm"&&Qt.has(22)?Qt.get(22):e==="mm:ss"&&Qt.has(45)?Qt.get(45):e},o.prototype.addEventListener=function(){this.parent.on(wf,this.numberFormatting,this),this.parent.on(en,this.getFormattedCell,this),this.parent.on(Jr,this.checkDateFormat,this),this.parent.on(py,this.formattedBarText,this),this.parent.on(dy,this.updateAutoDetectNumberFormat,this),this.parent.on(vx,this.parseDecimalNumber,this),this.parent.on(dd,this.localizedFormatAction,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(wf,this.numberFormatting),this.parent.off(en,this.getFormattedCell),this.parent.off(Jr,this.checkDateFormat),this.parent.off(py,this.formattedBarText),this.parent.off(dy,this.updateAutoDetectNumberFormat),this.parent.off(vx,this.parseDecimalNumber),this.parent.off(dd,this.localizedFormatAction))},o.prototype.destroy=function(){this.removeEventListener(),Qt&&!this.parent.refreshing&&(Qt.clear(),Qt=null),Ui=this.parent=this.localeObj=this.customFormats=this.localizedFormats=null},o.prototype.getModuleName=function(){return"workbookNumberFormat"},o}(),Qt,Ui;function hr(o){var e=o.split(" ").join("");if(!Ui)switch(e){case"Currency":return"$#,##0.00";case"Accounting":return'_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)';case"Time":return"h:mm:ss AM/PM";default:return"General"}var t=function(r,n){return Qt&&Qt.has(n)?Qt.get(n):r},i="General";switch(e){case"Number":i=t("0.00",2);break;case"Currency":i=Ui.currency[0];break;case"Accounting":i=Ui.accounting[2];break;case"ShortDate":i=t("m/d/yyyy",14);break;case"LongDate":i="dddd, mmmm dd, yyyy";break;case"Time":i=Ui.time;break;case"Percentage":i=t("0.00%",10);break;case"Fraction":i=t("# ?/?",12);break;case"Scientific":i=t("0.00E+00",11);break;case"Text":i=t("@",49);break;case"CurrencyWithColorCode":i=Ui.currency[5];break}return i}function Er(o,e){var t="General";switch(o){case"0":case"0.00":case"#,##0":case"#,##0.00":t="Number";break;case"$#,##0.00":case"$#,##0":case"$#,##0_);[Red]($#,##0)":case"$#,##0.00_);($#,##0.00)":case"$#,##0_);($#,##0)":case"$#,##0.00_);[Red]($#,##0.00)":t="Currency";break;case'_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)':case'_ $ * #,##0.00_ ;_ $ * -#,##0.00_ ;_ $ * "-"??_ ;_ @_ ':case'_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)':t="Accounting";break;case"mm-dd-yyyy":case"m/d/yyyy":case"dd/MM/yyyy":t="ShortDate";break;case"dddd, mmmm dd, yyyy":t="LongDate";break;case"h:mm:ss AM/PM":t="Time";break;case"0.00%":case"0%":t="Percentage";break;case"0.00E+00":t="Scientific";break;case"@":t="Text";break;default:if(o){if(!Ui)break;if(o===Ui.time?t="Time":Ui.currency.indexOf(o)>-1?t="Currency":Ui.accounting.indexOf(o)>-1?e&&(t="Accounting"):(o.includes("?/?")||["2","4","8","16"].indexOf(o.split("?/")[1])>-1)&&(t="Fraction"),Qt&&t==="General"&&e){var i=function(r){return r.some(function(n){return Qt.has(n)&&Qt.get(n)===o})};i([1,2,3,4])?t="Number":i([14])?t="ShortDate":i([9,10])?t="Percentage":i([11])?t="Scientific":i([49])&&(t="Text")}e=!1}break}return e&&Ui&&(t==="Currency"&&Ui.currency[0]!=="$#,##0.00"||t==="Accounting"&&Ui.accounting[2]!=='_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)')&&(t="General"),t}function rq(o,e){var t={action:"parseToDefaultFormat",format:e};return o.notify(dd,t),t.format}var gO=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(If,this.initiateSortHandler,this),this.parent.on(bx,this.updateSortedDataOnCell,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(If,this.initiateSortHandler),this.parent.off(bx,this.updateSortedDataOnCell))},o.prototype.initiateSortHandler=function(e){var t=this,i=e.args,r=new kn,n=this.parent.getAddressInfo(i.range),s=ke(this.parent,n.sheetIndex),a=tt(n.indices),l=i.sortOptions||{sortDescriptors:{},containsHeader:!0},h=!1;if(e.promise=r.promise,a[0]>s.usedRange.rowIndex||a[1]>s.usedRange.colIndex){r.reject(this.parent.serviceLocator.getService(jy).getConstant("SortOutOfRangeError"));return}var u=l.containsHeader,c=i.checkForHeader;if((a[0]===a[2]||c)&&(c||(a=wb(a[0],a[1],s)),h=!0,g(l.containsHeader)&&(typeof G(a[0],a[1],s,null,!0).value==typeof G(a[0]+1,a[1],s,null,!0).value?u=this.isSameStyle(G(a[0],a[1],s,null,!0).style,G(a[0]+1,a[1],s,null,!0).style)?this.isHeaderRow(s,a):!0:u=!0)),(g(i.sortOptions)||g(i.sortOptions.containsHeader))&&!h){var d=G(a[0],a[1],s),p=G(a[0]+1,a[1],s);d&&p&&(typeof d.value==typeof p.value?u=!this.isSameStyle(d.style,p.style)||this.isHeaderRow(s,a):u=!0)}a[0]=u?a[0]+1:a[0];var f=Se(s.activeCell),v=Pi(f[1]+1);delete l.containsHeader;var m=l.sortDescriptors,y=new Pe;if(Array.isArray(m)){(!m||m.length===0)&&(m=[{field:v}]);for(var S=m.length,b=S-1;b>-1;b--)if(m[S-1].field||(m[S-1].field=v),!!m[b].field){var w=m[b].sortComparer||this.sortComparer.bind(this,m[b],l.caseSensitive);y.sortBy(m[b].field,w),v=m[b].field}}else{m||(m={field:v}),m.field||(m.field=v);var w=m.sortComparer||this.sortComparer.bind(this,m,l.caseSensitive);y.sortBy(m.field,w),v=m.field}var I=Be(a);fa(this.parent,s.name+"!"+I,!0,null,null,null,null,null,void 0,null,vn(v)).then(function(x){var M=new re(x);if(x.length===1&&x[0].throwMergeAlert){var D=t.parent.sortCollection&&t.parent.sortCollection[t.parent.sortCollection.length-1];if(D){var A=void 0;if(e.previousSort&&e.previousSort.length)for(var L=0;L<e.previousSort.length;L++){var T=e.previousSort[L];D.sheetIndex===T.sheetIndex&&(A=T)}A?(D.columnIndex=A.columnIndex,D.order=A.order,D.sortRange=A.sortRange):t.parent.sortCollection.pop(),t.parent.notify(Jy,null)}r.reject(t.parent.serviceLocator.getService(jy).getConstant("AutoFillMergeAlertMsg"));return}M.executeQuery(y).then(function(k){t.parent.notify("setActionData",{args:{action:"beforeSort",eventArgs:{range:I,cellDetails:x,sortedCellDetails:k.result}}}),t.updateSortedDataOnCell({result:k.result,range:a,sheet:s,jsonData:x});var F={range:s.name+"!"+I,sortOptions:i.sortOptions};e.previousSort&&(F.previousSort=e.previousSort),r.resolve(F)})})},o.prototype.isHeaderRow=function(e,t){return!e.ranges||!e.ranges.length?!1:e.ranges.some(function(i){if(!i.dataSource||!i.showFieldAsHeader)return!1;var r=Se(i.startCell);return r[0]===t[0]&&r[1]>=t[1]&&r[1]<=t[3]})},o.prototype.updateSortedDataOnCell=function(e){for(var t=this,i=[],r,n=function(c,d){for(var p=e.range[1],f=0;p<=e.range[3];p++,f++){if(i[f]||(i[f]=Pi(p+1)),d[i[f]])r=he({},d[i[f]],null,!0);else{if(!G(c,p,e.sheet))continue;r=null}r=t.skipBorderOnSorting(c,p,e.sheet,r),r&&r.validation&&delete r.validation;var v=G(c,p,e.sheet);v&&(v.validation&&(r=Object.assign({},r,{validation:v.validation})),v.wrap&&vd(et(c,p),!1,t.parent)),r&&r.formula&&(r.formula=Hn([c,p],[parseInt(d.__rowIndex,10)-1,p],e.sheet,t.parent,r,!0)),oi(c,p,e.sheet,r)}},s=e.isUndo&&{},a,l,h=e.range[0],u=0;h<=e.range[2];h++,u++){if(st(e.sheet,h)){u--;continue}if(l=e.result[u],e.isUndo){if(l&&(a=parseInt(l.__rowIndex,10)-1,s[a]=!0,n(a,l),h===a))continue;!s[h]&&e.sheet.rows[h]&&n(h,{})}else n(h,l||{})}},o.prototype.skipBorderOnSorting=function(e,t,i,r){var n=G(e,t,i),s=["borderBottom","borderTop","borderRight","borderLeft","border"];if(r&&r.style)for(var a=0,l=s;a<l.length;a++){var h=l[a];delete r.style[""+h]}if(n&&n.style)for(var u=0,c=s;u<c.length;u++){var h=c[u];n.style[""+h]&&(r||(r={}),r.style||(r.style={}),r.style[""+h]=n.style[""+h])}return r},o.prototype.isSameStyle=function(e,t){e||(e={}),t||(t={});for(var i=!0,r=Object.keys(e),n=0;n<r.length;n++)if(e[r[n]]===t[r[n]]||this.parent.cellStyle[r[n]]===e[r[n]])i=!0;else{i=!1;break}return i},o.prototype.sortComparer=function(e,t,i,r){var n=e.order||"",s=de.fnSort(n),a=i&&i.value,l=r&&r.value;if(i&&r&&(typeof a=="string"||typeof l=="string")&&a!==""&&l!==""){var h=void 0,u=void 0;if(Me(i.value)&&(a=Jc(i.value),i.format!=="@"&&(i.value=a),h=!0),Me(r.value)&&(l=Jc(r.value),r.format!=="@"&&(r.value=l),u=!0),!h&&!u){var c={sensitivity:t?"case":"base"},d=new Intl.Collator(this.parent.locale,c);return!n||n.toLowerCase()==="ascending"?d.compare(a,l):d.compare(a,l)*-1}}return g(l)||l===""?-1:g(a)||a===""?1:s(a,l)},o.prototype.getModuleName=function(){return"workbookSort"},o}(),vO=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(my,this.initiateFilterHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(my,this.initiateFilterHandler)},o.prototype.initiateFilterHandler=function(e){var t=this,i=e.args,r=new kn,n=ke(this.parent,Gs(this.parent,i.range)),s=i.filterOptions||{};if(e.promise=r.promise,s.datasource){this.setFilter(s.datasource,s.predicates,i.range,e.refresh,s.equalOrPredicates);var a={range:i.range,filterOptions:s};r.resolve(a)}else{var l=tt(Qi(i.range));if(l[0]>n.usedRange.rowIndex||l[1]>n.usedRange.colIndex){r.reject("Select a cell or range inside the used range and try again.");return}l[0]===l[2]&&l[2]-l[0]===0&&(l[0]=0,l[1]=0,l[3]=n.usedRange.colIndex),l[2]=n.usedRange.rowIndex,l[0]=l[0]+1;var h=Be(l);fa(this.parent,n.name+"!"+h,!0,!0,null,null,null,null,!1).then(function(u){var c=new re(u);t.setFilter(c,s.predicates,i.range,e.refresh);var d={range:h,filterOptions:s};r.resolve(d)})}},o.prototype.setFilter=function(e,t,i,r,n){var s=this;if(e&&t){var a=e.dataSource.json,l=Rx(e,t,n),h="__rowIndex",u,c;if(i.indexOf("!")>-1?(c=yt(this.parent,i.substring(0,i.lastIndexOf("!"))),u=ke(this.parent,c)):(u=this.parent.getActiveSheet(),c=yt(this.parent,u.name)),this.parent.getModuleName()==="spreadsheet"){var d=this.parent,p,f;if(d.scrollSettings.enableVirtualization&&(u.rows||a).length>d.viewport.rowCount+d.getThreshold("row")*2||u.frozenRows||u.frozenColumns||r){a.forEach(function(y){p=l.indexOf(y)<0,hs(u,Number(y[""+h])-1,{hidden:p,isFiltered:p})}),f=c===d.activeSheetIndex;var v=J(u.paneTopLeftCell);this.parent.updateTopLeftCell(se(u,v[0],!0)-this.parent.frozenRowCount(u),null,"col")}else a.forEach(function(y){if(p=l.indexOf(y)<0,f)hs(u,Number(y[""+h])-1,{hidden:p,isFiltered:p});else{var S={startIndex:Number(y[""+h])-1,hide:p,isFiltering:!0,sheetIndex:c};S.endIndex=S.startIndex,s.parent.notify(Dn,S),f=S.refreshUI}});f&&d.renderModule.refreshSheet(!1,!1,document.activeElement.id!==this.parent.element.id+"_SearchBox")}else{var m;a.forEach(function(y){m=l.indexOf(y)<0,hs(u,Number(y[""+h])-1,{hidden:m,isFiltered:m})})}}},o.prototype.getModuleName=function(){return"workbookFilter"},o}(),mO=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.setImage=function(e){var t=e.range?e.range.lastIndexOf("!"):-1,i=e.range?t>-1?e.range.substring(t+1):e.range:this.parent.getActiveSheet().selectedRange,r=e.range&&t>-1?yt(this.parent,e.range.substring(0,t)):this.parent.activeSheetIndex,n=J(i),s=Ee(r)?this.parent.getActiveSheet():ke(this.parent,r),a=G(n[0],n[1],s),l,h=e.options;if(a&&a.image)if(l=a.image,e.isPositionChanged)for(var u=0;u<l.length;u++)for(var c=0;c<h.length;c++)l[u].id===h[c].id&&(l[u]=h[c],document.getElementById(h[c].id)&&(e.isElementRemoved=!0,document.getElementById(h[c].id).remove()));else{l=a.image;for(var u=0;u<h.length;u++)l.push(h[u])}return oi(n[0],n[1],s,{image:a&&a.image?l:h},!0,!0),e.isElementRemoved},o.prototype.addEventListener=function(){this.parent.on(Dy,this.setImage,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(Dy,this.setImage)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.getModuleName=function(){return"workbookImage"},o}(),yO=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(oh,this.setChartHandler,this),this.parent.on(Ay,this.deleteChartColl,this),this.parent.on(th,this.refreshChartSize,this),this.parent.on(Ty,this.focusChartBorder,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(oh,this.setChartHandler),this.parent.off(Ay,this.deleteChartColl),this.parent.off(th,this.refreshChartSize),this.parent.off(Ty,this.focusChartBorder))},o.prototype.setChartHandler=function(e){var t=0,i=[];e.isInitCell=g(e.isInitCell)?!1:e.isInitCell,e.isUndoRedo=g(e.isUndoRedo)?!0:e.isUndoRedo,e.isPaste=g(e.isPaste)?!1:e.isPaste;var r=e.chart,n,s;if(r.length>0)for(;t<r.length;){if(e.isCut===!1&&document.getElementById(e.chart[t].id)&&(r[t]={range:r[t].range,id:kt("e_spreadsheet_chart"),theme:r[t].theme,isSeriesInRows:r[t].isSeriesInRows,type:r[t].type,markerSettings:r[t].markerSettings}),document.getElementById(e.chart[t].id))return;if(n=r[t],n.theme=n.theme||"Material",n.type=n.type||"Line",n.isSeriesInRows=n.isSeriesInRows||!1,g(n.range)){var a=this.parent.getActiveSheet();n.range=a.selectedRange,i=tt(J(n.range)),i[0]===0&&i[2]===a.rowCount-1&&i[2]>a.usedRange.rowIndex&&(i[2]=a.usedRange.rowIndex),i[1]===0&&i[3]===a.colCount-1&&i[3]>a.usedRange.colIndex&&(i[3]=a.usedRange.colIndex)}else i=tt(J(n.range));var l=Be(i);if(n.range.indexOf("!")>0?n.range=n.range.substring(0,n.range.lastIndexOf("!"))+"!"+l:n.range=this.parent.getActiveSheet().name+"!"+l,g(n.id)&&(n.id=kt("e_spreadsheet_chart")),n.markerSettings&&n.markerSettings.visible&&(n.markerSettings.isFilled===void 0&&(n.markerSettings.isFilled=!0),n.markerSettings.shape===void 0&&(n.markerSettings.shape="Circle")),n.height=n.height||290,n.width=n.width||480,this.parent.notify(Ey,{option:n,isInitCell:e.isInitCell,triggerEvent:e.isUndoRedo,dataSheetIdx:e.dataSheetIdx,range:e.range,isPaste:e.isPaste}),this.parent.chartColl.push(n),!e.isInitCell||e.isPaste){var h=e.sheetId===void 0?n.range&&n.range.lastIndexOf("!")>0?yt(this.parent,n.range.substring(0,n.range.lastIndexOf("!"))):this.parent.activeSheetIndex:cn(this.parent,e.sheetId),u={clientY:n.top,isImage:!0},c={clientX:n.left,isImage:!0};this.parent.notify(Py,u),this.parent.notify(By,c);var a=Ee(h)?this.parent.getActiveSheet():this.parent.sheets[h],d=G(u.clientY,c.clientX,a);this.parent.isPrintingProcessing||(d&&d.chart?d.chart.push(n):oi(u.clientY,c.clientX,a,{chart:[n]},!0))}else{var p=J(e.range),u={clientY:n.top,isImage:!0},c={clientX:n.left,isImage:!0};this.parent.notify(Py,u),this.parent.notify(By,c);var f={prevTop:n.top,prevLeft:n.left,prevRowIdx:p[0],prevColIdx:p[1],prevHeight:n.height,prevWidth:n.width,currentTop:n.top,currentLeft:n.left,currentRowIdx:u.clientY,currentColIdx:c.clientX,currentHeight:n.height,currentWidth:n.width,id:n.id,requestType:"chartRefreshOnInit"};(p[0]!==u.clientY||p[1]!==c.clientX)&&(s=r.length,this.parent.notify(Fx,f),t-=s-r.length)}t++}},o.prototype.refreshChartSize=function(e){for(var t,i=1,r=this.parent.sheets.length+1;i<r;){var n=this.parent.chartColl;if(t=n?n.length:0,t)for(;t--;){var s=this.parent.chartColl[t];if(!g(e.overlayEle.querySelector("#"+s.id))){var a=this.parent.element.querySelector("."+s.id),l=at(a,"chart")||at(a,"accumulationchart");l&&(l.height=e.height,l.width=e.width)}}i++}},o.prototype.focusChartBorder=function(e){for(var t=0;t<this.parent.chartColl.length;t++){var i=document.getElementById(e.id),r=document.getElementById(this.parent.chartColl[t].id);i&&r&&j(r,"."+i.classList[1])===i&&this.parent.notify(Ey,{option:this.parent.chartColl[t],isRefresh:!0})}},o.prototype.deleteChartColl=function(e){for(var t=0;t<this.parent.chartColl.length;t++)this.parent.chartColl[t].id+"_overlay"===e.id&&this.parent.chartColl.splice(t,1)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.getModuleName=function(){return"workbookChart"},o}(),bO=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.format=function(e){var t=this,i,r=e.range;if(r&&typeof r=="string"&&r.indexOf("!")>-1){var n=r.lastIndexOf("!");r=r.substring(n+1),i=this.parent.sheets[yt(this.parent,e.range.substring(0,n))]}else i=this.parent.getActiveSheet();r===void 0&&(r=i.selectedRange);var s=typeof r!="object"&&e.onActionUpdate&&!e.isUndoRedo,a={range:r,style:Object.assign({},e.style),requestType:"CellFormat"};e.borderType&&(a.borderType=e.borderType);var l={},h=typeof a.range=="object"?a.range:tt(J(a.range)),u=[],c=qi(this.parent,h);if(c){e.onActionUpdate&&this.parent.notify(tu,null);return}if(Object.assign(l,a.style,null,!0),s&&(this.parent.trigger("beforeCellFormat",a),this.parent.notify("actionBegin",{eventArgs:a,action:"format"}),a.cancel)){e.cancel=!0;return}e.borderType&&(this.setTypedBorder(i,e.style.border,h,e.borderType,e.onActionUpdate,u),delete e.style.border,delete a.style.border);var d,p,f={cell:null,rowIdx:0,colIdx:0,eventOnly:!0,preventEvt:!s},v=function(ae){return f.cell={style:ae},f.rowIdx=d,f.colIdx=p,sr(t.parent,i,f)};if(a.style.borderTop!==void 0){for(p=h[1];p<=h[3];p++)d=h[0],v({borderTop:a.style.borderTop})||(e.isUndoRedo||(this.checkAdjacentBorder(i,"borderBottom",d-1,p),this.checkFullBorder(i,"borderBottom",d-1,p)),this.checkFullBorder(i,"borderTop",d,p),this.setCellBorder(i,f.cell.style,d,p,e.onActionUpdate,p===h[3],null,null,e.isUndoRedo,u));delete a.style.borderTop}if(a.style.borderBottom!==void 0){var m=void 0,y=void 0;for(p=h[1];p<=h[3];p++){d=h[0],m=G(d,p,i,!1,!0),m.rowSpan>0?y=G(h[2],h[1],i,!1,!0):y=G(h[2],h[3],i,!1,!0),m.rowSpan>1&&y.rowSpan<0||(d=h[2]);var S={range:[d,p,d,p]};this.parent.notify(ur,S),d=S.range[0],v({borderBottom:a.style.borderBottom})||(e.isUndoRedo||(this.checkAdjacentBorder(i,"borderTop",h[2]+1,p),this.checkFullBorder(i,"borderTop",h[2]+1,p)),this.checkFullBorder(i,"borderBottom",h[2],p),this.setCellBorder(i,f.cell.style,d,p,e.onActionUpdate,p===h[3],null,null,e.isUndoRedo),this.setBottomBorderPriority(i,h[2],p))}delete a.style.borderBottom}if(a.style.borderLeft!==void 0){for(var b=h[0];b<=h[2];b++)p=h[1],v({borderLeft:a.style.borderLeft})||(e.isUndoRedo||(this.checkAdjacentBorder(i,"borderRight",b,p-1),this.checkFullBorder(i,"borderRight",b,p-1)),this.checkFullBorder(i,"borderLeft",b,p),this.setCellBorder(i,f.cell.style,b,p,e.onActionUpdate,null,null,null,e.isUndoRedo));delete a.style.borderLeft}if(a.style.borderRight!==void 0){for(var w=h[0];w<=h[2];w++){p=h[3];var S={range:[w,p,w,p]};this.parent.notify(ur,S),p=S.range[1],v({borderRight:a.style.borderRight})||(e.isUndoRedo||(this.checkAdjacentBorder(i,"borderLeft",w,p+1),this.checkFullBorder(i,"borderLeft",w,p+1)),this.checkFullBorder(i,"borderRight",w,p),this.setCellBorder(i,f.cell.style,w,p,e.onActionUpdate,null,null,null,e.isUndoRedo))}delete a.style.borderRight}var I,x,M=Object.keys(a.style);if(M.length){var D=void 0,A=void 0,L=void 0,T=this.parent,k=T.viewport&&this.parent.getActiveSheet().id===i.id,F=this.parent.frozenRowCount(i),R=this.parent.frozenColCount(i),N=[F+T.viewport.topIndex,R+T.viewport.leftIndex,T.viewport.bottomIndex,T.viewport.rightIndex],P=void 0,O=void 0,z=void 0,H=void 0,Q=M.indexOf("color")>-1,$=Q||M.indexOf("backgroundColor")>-1;for(d=h[0];d<=h[2];d++)if(O=Ar(i,d)||{},!O.isFiltered){for(P=d>=N[0]&&d<=N[2]||d<F,z=!1,p=h[1];p<=h[3];p++)if(!v(a.style)){if(x===void 0&&(a.style.border!==void 0?(I=a.style.border,delete a.style.border,x=!0):x=!1),D=G(d,p,i,!1,!0),L=i.columns[p],D.rowSpan>1||D.colSpan>1)for(var U=d,ie=D.rowSpan>1?d+(D.rowSpan-1):d;U<=ie;U++)for(var ne=p,te=D.colSpan>1?p+(D.colSpan-1):p;ne<=te;ne++)x&&this.setFullBorder(i,I,h,U,ne,e.onActionUpdate,!0),this.setCellStyle(i,U,ne,a.style);if(x&&this.setFullBorder(i,I,h,d,p,e.onActionUpdate,void 0,u),this.setCellStyle(i,d,p,a.style),!!k)if(P&&(p>=N[1]&&p<=N[3]||p<R)){if(H=null,Q&&D.format&&D.format.includes("[")){var oe=pl(D.format);oe&&(H=oe.toLowerCase())}this.parent.notify(Dr,{style:a.style,rowIdx:d,colIdx:p,lastCell:p===h[3],isHeightCheckNeeded:!0,manualUpdate:!0,onActionUpdate:e.onActionUpdate,formatColor:H}),$&&(A=D.validation||Ds(L,d,p)&&L.validation,A&&A.isHighlighted&&this.parent.notify(su,{rowIdx:d,colIdx:p,cell:D,validation:A,col:D.validation&&L}))}else O.customHeight||(z=z||gd(a.style,e.onActionUpdate),z&&this.parent.notify(Dr,{rowIdx:d,colIdx:p,lastCell:p===h[3],checkHeight:!0,outsideViewport:!P,onActionUpdate:e.onActionUpdate}))}}}x&&(a.style.border=I),_c(this.parent,u,[h[1],h[3]]),this.parent.setUsedRange(h[2],h[3]),e.refreshRibbon&&this.parent.notify(Qa,null),i.conditionalFormats&&i.conditionalFormats.length&&this.parent.notify(Wi,{indexes:h}),s&&(a.style=l,a.range=i.name+"!"+r,this.parent.notify("actionComplete",{eventArgs:a,action:"format"}))},o.prototype.setBottomBorderPriority=function(e,t,i){if(st(e,t+1)){var r=this.skipHiddenRows(e,t+1),n=this.parent.getCellStyleValue(["borderTop"],[r,i]).borderTop;n!==""&&(e.rows[t].cells[i].style.bottomPriority=!0)}},o.prototype.setFullBorder=function(e,t,i,r,n,s,a,l){var h={};r===i[0]&&(this.checkAdjacentBorder(e,"borderBottom",r-1,n),this.checkFullBorder(e,"borderBottom",r-1,n)),n===i[1]&&(this.checkAdjacentBorder(e,"borderRight",r,n-1),this.checkFullBorder(e,"borderRight",r,n-1)),n===i[3]?(this.checkAdjacentBorder(e,"borderLeft",r,n+1),this.checkFullBorder(e,"borderLeft",r,n+1)):this.checkAdjacentBorder(e,"border",r,n+1),h.borderRight=t,h.borderTop=t,h.borderLeft=t,h.borderBottom=t,this.setCellBorder(e,h,r,n,s,n===i[3],null,a,void 0,l),r===i[2]?(this.checkAdjacentBorder(e,"borderTop",r+1,n),this.checkFullBorder(e,"borderTop",r+1,n),this.setBottomBorderPriority(e,r,n)):this.checkAdjacentBorder(e,"border",r+1,n)},o.prototype.checkAdjacentBorder=function(e,t,i,r){var n={};this.parent.getCellStyleValue([t],[i,r])[""+t]!==""&&(n[""+t]=void 0,this.setCellStyle(e,i,r,n))},o.prototype.checkFullBorder=function(e,t,i,r){var n=this.parent.getCellStyleValue(["border"],[i,r]).border;if(n!==""){var s={border:void 0};["borderBottom","borderTop","borderLeft","borderRight"].forEach(function(a){a!==t&&(s[""+a]=n)}),this.setCellStyle(e,i,r,s)}},o.prototype.textDecorationActionUpdate=function(e){var t=this.parent.getActiveSheet(),i={range:t.selectedRange,style:e.style,requestType:"CellFormat"},r=tt(J(t.selectedRange)),n=qi(this.parent,r);if(n){this.parent.notify(tu,null);return}if(this.parent.trigger("beforeCellFormat",i),this.parent.notify("actionBegin",{eventArgs:i,action:"format"}),i.cancel){e.cancel=!0;return}var s=e.style.textDecoration.toLowerCase(),a=s,l=J(t.activeCell),h=this.parent.getCellStyleValue(["textDecoration"],l).textDecoration.toLowerCase(),u=!1;h==="underline"?a=s==="underline"?"none":"underline line-through":h==="line-through"?a=s==="line-through"?"none":"underline line-through":h==="underline line-through"&&(a=s==="underline"?"line-through":"underline",u=!0),a==="none"&&(u=!0);var c={textDecoration:a};this.format({style:c,range:l,refreshRibbon:e.refreshRibbon,onActionUpdate:!0});for(var d=r[0];d<=r[2];d++)for(var p=r[1];p<=r[3];p++)if(!(d===l[0]&&p===l[1])){if(c={},h=this.parent.getCellStyleValue(["textDecoration"],[d,p]).textDecoration.toLowerCase(),h==="none"){if(u)continue;c.textDecoration=s}else if(h==="underline"||h==="line-through")if(u)if(s===h)c.textDecoration="none";else continue;else c.textDecoration=s!==h?"underline line-through":s;else if(h==="underline line-through")if(u)c.textDecoration=s==="underline"?"line-through":"underline";else continue;this.format({style:c,range:[d,p,d,p],refreshRibbon:e.refreshRibbon,onActionUpdate:!0})}i.range=t.name+"!"+i.range,i.style.textDecoration=a,this.parent.notify("actionComplete",{eventArgs:i,action:"format"})},o.prototype.setTypedBorder=function(e,t,i,r,n,s){var a;if(r==="Outer"){for(var l=i[1];l<=i[3];l++)this.checkAdjacentBorder(e,"borderBottom",i[0]-1,l),this.checkFullBorder(e,"borderBottom",i[0]-1,l),this.setCellBorder(e,{borderTop:t},i[0],l,n,l===i[3],void 0,void 0,void 0,s),this.checkAdjacentBorder(e,"borderTop",i[2]+1,l),this.checkFullBorder(e,"borderTop",i[2]+1,l),this.setCellBorder(e,{borderBottom:t},i[2],l,n,l===i[3],r),this.setBottomBorderPriority(e,i[2],l);for(var h=i[0];h<=i[2];h++)this.checkAdjacentBorder(e,"borderRight",h,i[1]-1),this.checkFullBorder(e,"borderRight",h,i[1]-1),this.setCellBorder(e,{borderLeft:t},h,i[1],n),this.checkAdjacentBorder(e,"borderLeft",h,i[3]+1),this.checkFullBorder(e,"borderLeft",h,i[3]+1),this.setCellBorder(e,{borderRight:t},h,i[3],n,null,r)}else if(r==="Inner"){var u={range:[i[0],i[1],i[0],i[1]]};if(this.parent.notify(Do,u),u.range[0]===i[0]&&u.range[1]===i[1]&&u.range[2]===i[2]&&u.range[3]===i[3])return;for(var c=i[0];c<=i[2];c++)for(var d=i[1];d<=i[3];d++){var p={};a=this.parent.getCellStyleValue(["border"],[c,d]).border,a!==""&&(p.border=void 0,(d===i[3]||d===i[1]||c===i[0]||c===i[2])&&(c===i[0]&&(p.borderTop=a),c===i[2]&&(p.borderBottom=a),d===i[3]&&(p.borderRight=a),d===i[1]&&(p.borderLeft=a))),d!==i[3]&&(p.borderRight=t),c!==i[0]&&(p.borderTop=t),c!==i[2]&&(p.borderBottom=t),d!==i[1]&&(p.borderLeft=t),this.setCellBorder(e,p,c,d,n,d===i[3],void 0,void 0,void 0,s)}}else if(r==="Vertical")for(var c=i[0];c<=i[2];c++)for(var d=i[1];d<=i[3];d++){var p={borderRight:t,borderLeft:t};d===i[1]&&(this.checkAdjacentBorder(e,"borderRight",c,d-1),this.checkFullBorder(e,"borderRight",c,d-1)),d===i[3]&&(this.checkAdjacentBorder(e,"borderLeft",c,d+1),this.checkFullBorder(e,"borderLeft",c,d+1)),this.setCellBorder(e,p,c,d,n)}else for(var c=i[0];c<=i[2];c++)for(var d=i[1];d<=i[3];d++){var p={borderTop:t,borderBottom:t};c===i[0]&&(this.checkAdjacentBorder(e,"borderBottom",c-1,d),this.checkFullBorder(e,"borderBottom",c-1,d)),this.setCellBorder(e,p,c,d,n,d===i[3]),c===i[2]&&(this.checkAdjacentBorder(e,"borderTop",c+1,d),this.checkFullBorder(e,"borderTop",c+1,d),this.setBottomBorderPriority(e,c,d))}},o.prototype.setCellBorder=function(e,t,i,r,n,s,a,l,h,u){var c=G(i,r,e),d=Rt(e,r),p=Ar(e,i);if(!(c&&c.isReadOnly||d&&d.isReadOnly||p&&p.isReadOnly)&&(this.setCellStyle(e,i,r,t),!l&&this.parent.getActiveSheet().id===e.id)){if(a==="Outer"&&(t.borderBottom||t.borderRight)){var f={range:[i,r,i,r]};this.parent.notify(ur,f),i=f.range[0],r=f.range[1]}h&&(t.borderTop===""&&this.parent.getCellStyleValue(["borderBottom"],[i-1,r]).borderBottom!==""&&(t.borderTop=this.parent.getCellStyleValue(["borderBottom"],[i-1,r]).borderBottom),t.borderLeft===""&&this.parent.getCellStyleValue(["borderRight"],[i,r-1]).borderRight!==""&&(t.borderLeft=this.parent.getCellStyleValue(["borderRight"],[i,r-1]).borderRight),t.borderRight===""&&this.parent.getCellStyleValue(["borderLeft"],[i,r+1]).borderLeft!==""&&(t.borderRight=this.parent.getCellStyleValue(["borderLeft"],[i,r+1]).borderLeft)),this.parent.notify(Dr,{style:t,rowIdx:i,colIdx:r,onActionUpdate:n,first:"",lastCell:s,isHeightCheckNeeded:!0,manualUpdate:!0,mergeBorderRows:u})}},o.prototype.setCellStyle=function(e,t,i,r){e.rows[t]?e.rows[t].cells||(e.rows[t].cells=[]):e.rows[t]={cells:[]},e.rows[t].cells[i]||(e.rows[t].cells[i]={}),e.rows[t].cells[i].style||(e.rows[t].cells[i].style={}),Object.assign(e.rows[t].cells[i].style,r,null,!0)},o.prototype.skipHiddenRows=function(e,t){return t++,st(e,t)&&(t=this.skipHiddenRows(e,t)),t},o.prototype.addEventListener=function(){this.parent.on(rr,this.format,this),this.parent.on(nd,this.textDecorationActionUpdate,this),this.parent.on(ud,this.clearCellObj,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(rr,this.format),this.parent.off(nd,this.textDecorationActionUpdate),this.parent.off(ud,this.clearCellObj))},o.prototype.clearCellObj=function(e){var t=e.range?e.range.lastIndexOf("!"):0,i=e.range?t>0?e.range.substring(t+1):e.range:this.parent.getActiveSheet().selectedRange,r=e.range&&t>0?yt(this.parent,e.range.substring(0,t)):this.parent.activeSheetIndex,n=ke(this.parent,r),s=tt(Qi(i)),a=s[0],l=s[2],h=n.conditionalFormats&&n.conditionalFormats.length&&[].slice.call(n.conditionalFormats),u=[],c,d,p,f,v;for(a;a<=l;a++)for(p=s[1],f=s[3],p;p<=f;p++){var m=G(a,p,n),y=Lo(m,Rt(n,p),Ar(n,a));if(m&&(e.type==="Clear All"||e.type==="Clear Formats")){if(m.rowSpan>1||m.colSpan>1){var S={range:[a,p,a,p]};this.parent.notify(Do,S);var b=S.range;s[0]<=b[0]&&s[1]<=b[1]&&s[2]>=b[2]&&s[3]>=b[3]&&this.parent.notify(Mn,{merge:!1,range:b,type:"All",sheetIndex:r,preventRefresh:r!==this.parent.activeSheetIndex})}if(m.rowSpan&&m.rowSpan!==1||m.colSpan&&m.colSpan!==1)continue}if(m&&!y)switch(e.type){case"Clear Formats":delete m.format,delete m.rowSpan,delete m.style,delete m.wrap,delete m.colSpan,delete m.formattedText,m.hyperlink&&(m.style={textDecoration:"none",color:"inherit"});break;case"Clear Contents":m.hyperlink&&(this.parent.notify(ny,{sheet:n,rowIdx:a,colIdx:p,preventRefresh:!0}),m.style={textDecoration:"underline",color:"#00e"}),v=!!(m.value||m.formula),delete m.value,delete m.formula,delete m.formattedText,v&&(d={action:"refreshCalculate",rowIndex:a,colIndex:p,sheetIndex:r},this.parent.notify(xt,d),h&&!c&&(c=d.isFormulaDependent,c||kf(h,u,a,p)));break;case"Clear Hyperlinks":delete m.hyperlink;break;case"Clear All":v=!!(m.value||m.formula),oi(a,p,n,{},!1),v&&(d={action:"refreshCalculate",rowIndex:a,colIndex:p,sheetIndex:r},this.parent.notify(xt,d),h&&!c&&(c=d.isFormulaDependent));break}}(u.length||c)&&r===this.parent.activeSheetIndex&&this.parent.notify(Wi,{cfModel:!c&&u,refreshAll:c,isAction:!0})},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.getModuleName=function(){return"workbookcellformat"},o}(),SO=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(fu,this.performEditOperation,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(fu,this.performEditOperation)},o.prototype.getModuleName=function(){return"workbookEdit"},o.prototype.performEditOperation=function(e){var t=e.action;switch(t){case"updateCellValue":e.isFormulaDependent=this.updateCellValue(e.address,e.value,e.sheetIndex,e.isValueOnly,e.skipFormatCheck,e.isRandomFormula,e.skipCellFormat,e.isDelete,e.deletedRange,e.fillType,e.cellInformation,e.isRedo,e.isDependentUpdate,e.actionName,e.isPaste);break}},o.prototype.updateCellValue=function(e,t,i,r,n,s,a,l,h,u,c,d,p,f,v){i===void 0&&(i=this.parent.activeSheetIndex);var m,y;typeof e=="string"?m=J(e):m=e;var S=ke(this.parent,i),b=G(m[0],m[1],S,!0);if(b||(b=S.rows[m[0]].cells[m[1]]={}),r)b.value=t,b.formattedText&&delete b.formattedText;else{var w=ut(t);w=t==="#SPILL!"?!0:w;var I=!1;b.formula&&b.formula.indexOf("UNIQUE")>-1&&t===""&&(I=!0);var x=Er(b.format)!=="Text"&&(!w||!t.toLowerCase().startsWith("=text("));w=Er(b.format)==="Text"?!1:w,!w&&!I&&(b.formula&&(b.formula=""),b.value=x?Jc(t,v):t);var M={action:"refreshCalculate",value:t,rowIndex:m[0],colIndex:m[1],sheetIndex:i,isFormula:w,isRandomFormula:s,isDelete:l,deletedRange:h,fillType:u,isDependentRefresh:p};if(x&&!n){var D={value:t,rowIndex:m[0],colIndex:m[1],sheetIndex:i,updatedVal:"",skipCellFormat:a};if(w)!g(t)&&t.toLowerCase().includes("unique(")&&t.length>0&&(b.value=t);else{var A=Er(b.format),L=t?t.toString().split("/"):[];if((A!=="Number"&&A!=="Percentage"&&A!=="Fraction"&&!(A==="Scientific"&&L.length===2)||A==="Fraction"&&L.length!==2)&&this.parent.notify(Jr,D),!g(D.updatedVal)&&D.updatedVal.length>0)b.value=D.updatedVal;else if(this.parent.isEdit&&t&&!Me(t)){var T=Eh(this.parent.locale,ts);if(b.format)if((t.includes("%")||t.includes(T))&&qs(b.format)){var k={formattedText:t,value:t,format:"General",cell:{value:t,format:"General"},isEdit:!0};this.parent.notify(en,k),k.format!=="General"&&["Currency","Percentage"].indexOf(Er(k.format))>-1&&(b.format=k.format,b.value=k.value)}else{var F={value:b.value,format:b.format,formattedText:b.value,type:"General",cell:b,rowIndex:m[0],colIndex:m[1]};this.parent.notify(en,F)}else if(t.includes(T)||t.includes("%")||t.includes(Yi(this.parent.locale).group)){var R=new Et,N={intl:R,updateValue:!0,value:"",curSymbol:T,cell:b};this.parent.notify(dy,{args:N,intl:R,fResult:t,cell:b})}}}}if(t==="#SPILL!")b.value=t;else{var P={cellIdx:m,isUnique:!1};if(this.parent.notify(gu,P),this.parent.calculationMode==="Manual"&&w&&g(p)&&(f!=="autofill"||b.formula!=="")&&!this.parent.isEdit&&g(this.parent.element.querySelector(".e-text-replaceInp"))&&(I=!0,!d&&b.value===void 0&&(I=!1)),!I&&!l?(this.parent.notify(xt,M),y=M.isFormulaDependent):t=b.value,w){if(b.formula=M.value,this.parent.calculationMode==="Manual"&&I&&d&&!this.parent.isEdit&&c&&c.cellDetails&&c.cellDetails.length>0&&c.cutCellDetails.length===0&&(!g(c.cellDetails[0].autoFillText)||!g(c.cellDetails[0].copyCellValue))){for(var O=0;O<c.cellDetails.length;O++)if(c.cellDetails[O].rowIndex===e[0]&&c.cellDetails[O].colIndex===e[1]){c.cellDetails[O].copyCellValue?t=b.value=c.cellDetails[O].copyCellValue:t=b.value=c.cellDetails[O].autoFillText;break}}else t=b.value,this.parent.calculationMode==="Manual"&&c&&d&&c.displayText&&(t=b.value=c.displayText);var z=b.formula.toLowerCase(),H=Er(b.format)==="Scientific"&&!n&&this.parent.isEdit;z==="=now()"&&(!b.format||b.format==="General"||H)?b.format=hr("ShortDate")+" h:mm":z.includes("=time(")&&(!b.format||H)?b.format="h:mm AM/PM":z.includes("=date(")&&H&&(b.format=hr("ShortDate"))}else b.value&&typeof b.value=="string"&&(b.value.indexOf("www.")===0||b.value.indexOf("https://")===0||b.value.indexOf("http://")===0||b.value.indexOf("ftp://")===0)&&this.parent.notify(od,{hyperlink:b.value,cell:S.name+"!"+et(m[0],m[1])})}}return this.parent.setUsedRange(m[0],m[1],S),this.parent.chartColl.length&&!this.parent.isEdit&&!s&&this.parent.notify(lh,{cell:b,rIdx:m[0],cIdx:m[1],sheetIdx:i,isRefreshChart:!0}),y},o}(),CO=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(od,this.setLinkHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(od,this.setLinkHandler)},o.prototype.setLinkHandler=function(e){var t=e.hyperlink,i=e.cell,r;if(i&&i.indexOf("!")!==-1){var n=i.lastIndexOf("!");if(r=ke(this.parent,yt(this.parent,i.substring(0,n))),i=i.substring(n+1),!r)return}else r=this.parent.getActiveSheet(),i=i||r.selectedRange;var s=!e.triggerEvt&&r.isProtected;if(!(s&&!r.protectSettings.insertLink)){var a=tt(J(i));typeof t=="string"?t.toLowerCase().indexOf("www.")===0&&(t="http://"+t):t.address.toLowerCase().indexOf("www.")===0&&(t.address="http://"+t.address);for(var l,h=J(r.activeCell),u=a[0];u<=a[2];u++)for(var c=a[1];c<=a[3];c++)s&&un(G(u,c,r),Rt(r,c))||(l={hyperlink:t},g(e.displayText)||(e.triggerEvt||e.isUndoRedo?u===h[0]&&c===h[1]&&(l.value=e.displayText,delete l.formattedText):(l.value=e.displayText,delete l.formattedText)),l.style={textDecoration:"underline",color:"#00e"},sr(this.parent,r,{cell:l,rowIdx:u,colIdx:c,preventEvt:!e.triggerEvt}))}},o.prototype.getModuleName=function(){return"workbookHyperlink"},o}(),wO=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.insertModel=function(e){var t=this,i,r,n,s;if(e.model){var a,l=[],h,u,c;if(typeof e.start=="number"){a=e.start,e.end=e.end||a,a>e.end&&(a=e.end,e.end=e.start),e.modelType==="Row"&&a<e.model.maxHgts.length&&(c=[]);for(var d=a;d<=e.end;d++)l.push({}),c&&c.push(null)}else e.start?(a=e.start[0].index||0,l=e.start,u=!0):(a=0,l.push({})),e.modelType==="Row"&&a<e.model.maxHgts.length&&(c=[],l.forEach(function(){c.push(null)}));var p={model:l,index:a,modelType:e.modelType,insertType:e.insertType,cancel:!1,isUndoRedo:e.isUndoRedo},f={eventArgs:p,action:"insert"};if(e.isAction){if(this.parent.notify(ai,f),p.cancel)return;delete p.cancel,p.isAction=e.isAction}var v={startIndex:a,endIndex:a+l.length-1,modelType:e.modelType,sheet:e.model,isInsert:!0};if(e.modelType==="Row"){if(e.checkCount!==void 0&&e.model.rows&&e.checkCount===e.model.rows.length)return;if(this.parent.notify(ls,v),e.model=e.model,e.model.rows||(e.model.rows=[]),u&&e.model.usedRange.rowIndex>-1&&a>e.model.usedRange.rowIndex)for(var d=e.model.usedRange.rowIndex;d<a-1;d++)l.splice(0,0,{});var m=this.parent.frozenRowCount(e.model);if(a<m||a<=m&&e.freezePane){var y=e.model.frozenRows+l.length-(a===m&&m>0?1:0);this.parent.setSheetPropertyOnMute(e.model,"frozenRows",y),p.freezePane=!0}(i=e.model.rows).splice.apply(i,[a,0].concat(l)),c&&(r=e.model.maxHgts).splice.apply(r,[a,0].concat(c)),this.setRowColCount(v.startIndex,v.endIndex,e.model,"row"),a>e.model.usedRange.rowIndex?this.parent.setUsedRange(a+(l.length-1),e.model.usedRange.colIndex,e.model,!0):this.parent.setUsedRange(e.model.usedRange.rowIndex+l.length,e.model.usedRange.colIndex,e.model,!0);for(var S=a+l.length,b,w=void 0,I,x,M=void 0,D=function($){e.model.rows[S]&&e.model.rows[S].cells&&e.model.rows[S].cells[$]&&(w=e.model.rows[S].cells[$],w.rowSpan!==void 0&&w.rowSpan<0&&w.colSpan===void 0&&(M={range:[S,$,S,$],insertCount:l.length,insertModel:"Row"},A.parent.notify(My,M),!p.freezePane&&M.range[0]<m&&M.range[2]>m&&(p.freezePane=!0))),x=G(a-1,$,e.model,!1,!0),b=x.style,w=G(a+1,$,e.model,!1,!0),(b||x.wrap)&&(b&&(I={},Object.keys(b).forEach(function(U){U==="borderLeft"||U==="borderRight"||U==="borderTop"||U==="borderBottom"||(I[U]=b[U])}),w.style&&A.checkBorder(w.style,e.model.rows[a-1].cells[$].style,I)),(!e.isUndoRedo||e.isRedo)&&l.forEach(function(U){U.cells||(U.cells=[]),U.cells[$]||(U.cells[$]={}),b&&(U.cells[$].style||(U.cells[$].style={}),Object.assign(U.cells[$].style,I)),x.wrap&&(U.cells[$].wrap=!0)}))},A=this,d=0;d<=e.model.usedRange.colIndex;d++)D(d);p.sheetCount=e.model.rows.length}else if(e.modelType==="Column"){if(e.checkCount!==void 0&&e.model.columns&&e.checkCount===e.model.columns.length)return;this.parent.notify(ls,v),e.model=e.model,e.model.columns||(e.model.columns=[]),a&&!e.model.columns[a-1]&&(e.model.columns[a-1]={}),(n=e.model.columns).splice.apply(n,[a,0].concat(l));var L=this.parent.frozenColCount(e.model);if(a<L||a<=L&&e.freezePane){var T=e.model.frozenColumns+l.length-(a===L&&L>0?1:0);this.parent.setSheetPropertyOnMute(e.model,"frozenColumns",T),p.freezePane=!0}this.setRowColCount(v.startIndex,v.endIndex,e.model,"col"),a>e.model.usedRange.colIndex?this.parent.setUsedRange(e.model.usedRange.rowIndex,a+(l.length-1),e.model,!0):this.parent.setUsedRange(e.model.usedRange.rowIndex,e.model.usedRange.colIndex+l.length,e.model,!0),e.model.rows||(e.model.rows=[]);var k=[];e.columnCellsModel||(e.columnCellsModel=[]);for(var d=0;d<l.length;d++)k.push(null);h=[];for(var w=void 0,F,R,N=void 0,d=0;d<=e.model.usedRange.rowIndex;d++){e.model.rows[d]?e.model.rows[d].cells||(e.model.rows[d].cells=[]):e.model.rows[d]={cells:[]},a&&!e.model.rows[d].cells[a-1]&&(e.model.rows[d].cells[a-1]={}),(s=e.model.rows[d].cells).splice.apply(s,[a,0].concat(e.columnCellsModel[d]&&e.columnCellsModel[d].cells?e.columnCellsModel[d].cells:k));var S=a+l.length;if(e.model.rows[d].cells[S]&&(w=e.model.rows[d].cells[S],w.colSpan!==void 0&&w.colSpan<0&&w.rowSpan===void 0&&h.push({range:[d,S,d,S],insertCount:k.length,insertModel:"Column"})),N=G(d,a-1,e.model,!1,!0),F=N.style,w=G(d,a+1,e.model,!1,!0),(F||N.wrap)&&(F&&(R={},Object.keys(F).forEach(function(ne){ne==="borderLeft"||ne==="borderRight"||ne==="borderTop"||ne==="borderBottom"||(R[ne]=F[ne])}),w.style&&this.checkBorder(w.style,e.model.rows[d].cells[a-1].style,R)),!e.isUndoRedo||e.isRedo))for(var P=a;P<S;P++)e.model.rows[d].cells[P]||(e.model.rows[d].cells[P]={}),F&&(e.model.rows[d].cells[P].style||(e.model.rows[d].cells[P].style={}),Object.assign(e.model.rows[d].cells[P].style,R)),N.wrap&&(e.model.rows[d].cells[P].wrap=!0)}h.forEach(function(U){t.parent.notify(My,U),!p.freezePane&&U.range[1]<L&&U.range[3]>L&&(p.freezePane=!0)}),p.sheetCount=e.model.columns.length}else{if(e.checkCount!==void 0&&e.checkCount===this.parent.sheets.length)return;for(var O=l,z=Vn(this.parent),H=e.isFromUpdateAction,d=0;d<O.length;d++)if(O[d].name){for(var P=0;P<this.parent.sheets.length;P++)if(O[d].name===this.parent.sheets[P].name){O.splice(d,1),d--;break}}if(!O.length)return;delete l[0].index,this.parent.createSheet(a,l);var Q;e.activeSheetIndex?(p.activeSheetIndex=e.activeSheetIndex,this.parent.setProperties({activeSheetIndex:e.activeSheetIndex},!0)):!e.isAction&&e.start<this.parent.activeSheetIndex&&this.parent.setProperties({activeSheetIndex:this.parent.skipHiddenSheets(this.parent.activeSheetIndex)},!0),H&&this.parent.setProperties({activeSheetIndex:yt(this.parent,z)},!0),l.forEach(function($){u&&t.updateRangeModel($.ranges);var U=t.parent.viewport,ie=[U.topIndex,U.leftIndex,U.bottomIndex,U.rightIndex],ne={sheet:$,resolveAfterFullDataLoaded:!0,indexes:ie,promise:new Promise(function(te){te(function(){}())})};t.parent.notify(ah,ne),Q=$.id,t.parent.notify(xt,{action:"addSheet",visibleName:$.name,sheetName:"Sheet"+Q,sheetId:Q})}),p.activeSheetIndex=e.activeSheetIndex,p.sheetCount=this.parent.sheets.length}e.modelType!=="Sheet"&&(this.insertConditionalFormats(e),this.parent.notify(Fy,{start:a,end:a+l.length-1,modelType:e.modelType,model:e.model,isInsert:!0}),p.activeSheetIndex=yt(this.parent,e.model.name)),this.parent.notify(Cx,f)}},o.prototype.setRowColCount=function(e,t,i,r){var n=r+"Count";this.parent.setSheetPropertyOnMute(i,n,i[""+n]+(t-e+1)),i.id===this.parent.getActiveSheet().id&&this.parent.notify(sd,{index:i[""+n]-1,update:r,isInsert:!0,start:e,end:t})},o.prototype.updateRangeModel=function(e){e.forEach(function(t){t.dataSource&&(t.startCell=t.startCell||"A1",t.showFieldAsHeader=t.showFieldAsHeader===void 0||t.showFieldAsHeader,t.template=t.template||"",t.address=t.address||"A1")})},o.prototype.checkBorder=function(e,t,i){e.borderLeft&&e.borderLeft===t.borderLeft&&(i.borderLeft=e.borderLeft),e.borderRight&&e.borderRight===t.borderRight&&(i.borderRight=e.borderRight),e.borderTop&&e.borderTop===t.borderTop&&(i.borderTop=e.borderTop),e.borderBottom&&e.borderBottom===t.borderBottom&&(i.borderBottom=e.borderBottom)},o.prototype.setInsertInfo=function(e,t,i,r,n){n===void 0&&(n="Row");var s=i=t+(i-1);e.ranges.forEach(function(a){a.info&&t<a.info[""+r]&&(a.info["insert"+n+"Range"]?a.info["insert"+n+"Range"].push([t,s]):a.info["insert"+n+"Range"]=[[t,s]],a.info[""+r]+=s-t+1)})},o.prototype.insertConditionalFormats=function(e){var t=e.model.conditionalFormats;if(e.prevAction==="delete")this.parent.setSheetPropertyOnMute(e.model,"conditionalFormats",e.conditionalFormats);else if(t)for(var i=0,r=t.length;i<r;i++)t[i].range=Be(O6(e,J(t[i].range),!e.isAction&&!e.isUndoRedo))},o.prototype.addEventListener=function(){this.parent.on(ya,this.insertModel,this)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(ya,this.insertModel)},o.prototype.getModuleName=function(){return"workbookinsert"},o}(),nq=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.deleteModel=function(e){var t=this,i=this.parent.sheets.length;if(!(e.modelType==="Sheet"&&i===1)){var r=e.modelType.toLowerCase()+"s";if(e.start=e.start,e.start>e.end){var n=e.start;e.start=e.end,e.end=n}var s={startIndex:e.start,endIndex:e.end,modelType:e.modelType,cancel:!1,isUndoRedo:e.isUndoRedo},a={eventArgs:s,action:"delete"};if(!(e.isAction&&(this.parent.notify(ai,a),s.cancel))){var l,h,u=[],c=e.end-e.start+1,d={startIndex:e.start,endIndex:e.end,modelType:e.modelType,sheet:e.model,isDelete:!0},p=this.parent.scrollSettings.isFinite;if(e.modelType==="Row"){if(e.checkCount!==void 0&&e.checkCount===e.model.usedRange.rowIndex)return;if(this.parent.notify(ls,d),e.model=e.model,p){if(e.start>=e.model.rowCount)return;e.end>=e.model.rowCount&&(e.end=e.model.rowCount-1)}else{if(e.start>e.model.usedRange.rowIndex)return;e.end>e.model.usedRange.rowIndex&&(e.end-=e.end-e.model.usedRange.rowIndex)}this.setRowColCount(e.start,e.end,e.model,"row"),e.start<=e.model.usedRange.rowIndex&&(this.parent.setSheetPropertyOnMute(e.model,"usedRange",{rowIndex:e.model.usedRange.rowIndex-(e.end-e.start+1),colIndex:e.model.usedRange.colIndex}),e.model.usedRange.rowIndex<0&&this.parent.setSheetPropertyOnMute(e.model,"usedRange",{rowIndex:0,colIndex:e.model.usedRange.colIndex}));var f=this.parent.frozenRowCount(e.model);e.start<f&&(f=e.end<f?e.end-e.start+1:f-e.start,f=e.model.frozenRows-f,this.parent.setSheetPropertyOnMute(e.model,"frozenRows",f),s.freezePane=!0);var v=e.end+1,m=void 0,y=void 0;if(e.model.rows[e.start]&&e.model.rows[e.start].cells)for(var S=0;S<=e.model.usedRange.colIndex;S++){if(e.model.rows[e.start].cells[S]&&e.model.rows[e.start].cells[S].rowSpan!==void 0&&e.model.rows[e.start].cells[S].rowSpan<0&&e.model.rows[e.start].cells[S].colSpan===void 0&&(y={range:[e.start,S,e.start,S]},this.parent.notify(ur,y),y.range=y.range,y.range[2]<=e.end&&(h=G(y.range[0],S,e.model),h&&h.rowSpan>1&&(h.rowSpan-(y.range[2]-e.start+1)>1?oi(y.range[0],S,e.model,{colSpan:h.rowSpan-(y.range[2]-e.start+1)},!0):delete e.model.rows[y.range[0]].cells[S].rowSpan),y=null)),e.model.rows[v]&&e.model.rows[v].cells&&e.model.rows[v].cells[S]&&e.model.rows[v].cells[S].rowSpan!==void 0&&e.model.rows[v].cells[S].rowSpan<0&&e.model.rows[v].cells[S].colSpan===void 0&&(y||(y={range:[v,S,v,S]},this.parent.notify(ur,y)),m=new Object,y.range=y.range,Object.assign(m,G(y.range[0],y.range[1],e.model)),m&&m.rowSpan&&(m.rowSpan>1||m.colSpan>1))){var b=[];b[1]=S,b[3]=m.colSpan>1?S+(m.colSpan-1):S,y.range=y.range,y.range[0]<e.start?(b[0]=b[2]=y.range[0],m.rowSpan-c>1&&(b[2]+=m.rowSpan-c-1)):(b[0]=b[2]=e.start,m.rowSpan-(e.end-y.range[0]+1)>1&&(b[2]+=m.rowSpan-(e.end-y.range[0]+1)-1)),u.push({range:b,isAction:!1,preventRefresh:!0,merge:!0,type:"All",skipChecking:!0})}y=null}s.sheetCount=e.model.usedRange.rowIndex}else if(e.modelType==="Column"){if(e.checkCount!==void 0&&e.checkCount===e.model.usedRange.colIndex)return;if(this.parent.notify(ls,d),e.model=e.model,p){if(e.start>=e.model.colCount)return;e.end>=e.model.colCount&&(e.end=e.model.colCount-1)}else{if(e.start>e.model.usedRange.colIndex)return;e.end>e.model.usedRange.colIndex&&(e.end-=e.end-e.model.usedRange.colIndex)}this.setRowColCount(e.start,e.end,e.model,"col"),e.start<=e.model.usedRange.colIndex&&(this.parent.setSheetPropertyOnMute(e.model,"usedRange",{rowIndex:e.model.usedRange.rowIndex,colIndex:e.model.usedRange.colIndex-c}),e.model.usedRange.colIndex<0&&this.parent.setSheetPropertyOnMute(e.model,"usedRange",{rowIndex:e.model.usedRange.rowIndex,colIndex:0}));var w=this.parent.frozenColCount(e.model);e.start<w&&(w=e.end<w?e.end-e.start+1:w-e.start,w=e.model.frozenColumns-w,this.parent.setSheetPropertyOnMute(e.model,"frozenColumns",w),this.parent.updateTopLeftCell(),s.freezePane=!0),l=[];for(var v=e.end+1,m=void 0,y=void 0,S=0;S<=e.model.usedRange.rowIndex;S++)if(l.push({}),e.model.rows[S]&&e.model.rows[S].cells){if(e.model.rows[S].cells[e.start]&&e.model.rows[S].cells[e.start].colSpan!==void 0&&e.model.rows[S].cells[e.start].colSpan<0&&e.model.rows[S].cells[e.start].rowSpan===void 0&&(y={range:[S,e.start,S,e.start]},this.parent.notify(ur,y),y.range=y.range,y.range[3]<=e.end)){var I=G(S,y.range[1],e.model);I&&I.colSpan>1&&(I.colSpan-(y.range[3]-e.start+1)>1?oi(S,y.range[1],e.model,{colSpan:I.colSpan-(y.range[3]-e.start+1)},!0):delete e.model.rows[S].cells[y.range[1]].colSpan),y=null}if(e.model.rows[S].cells[v]&&e.model.rows[S].cells[v].colSpan!==void 0&&e.model.rows[S].cells[v].colSpan<0&&e.model.rows[S].cells[v].rowSpan===void 0&&(y||(y={range:[S,v,S,v]},this.parent.notify(ur,y)),m=new Object,y.range=y.range,Object.assign(m,G(y.range[0],y.range[1],e.model)),m&&m.colSpan&&(m.colSpan>1||m.rowSpan>1))){var b=[];b[0]=S,b[2]=m.rowSpan>1?S+(m.rowSpan-1):S,y.range=y.range,y.range[1]<e.start?(b[1]=b[3]=y.range[1],m.colSpan-c>1&&(b[3]+=m.colSpan-c-1)):(b[1]=b[3]=e.start,m.colSpan-(e.end-y.range[1]+1)>1&&(b[3]+=m.colSpan-(e.end-y.range[1]+1)-1)),u.push({range:b,isAction:!1,preventRefresh:!0,merge:!0,type:"All",skipChecking:!0})}l[S].cells=e.model.rows[S].cells.splice(e.start,c),y=null}s.sheetCount=e.model.usedRange.colIndex,s.deletedCellsModel=l}else{if(e.end-e.start===this.parent.sheets.length-1||e.checkCount!==void 0&&e.checkCount===this.parent.sheets.length)return;this.parent.notify(ls,d),s.sheetCount=this.parent.sheets.length,s.activeSheetIndex=this.parent.activeSheetIndex}for(var x=[],M=e.modelType==="Row"&&e.start<e.model.maxHgts.length,D=e.model[""+r],S=e.start;S<=e.end;S++)e.modelType==="Sheet"&&D[S]&&this.parent.notify(xt,{action:"deleteSheetTab",sheetId:D[S].id}),D[e.start]||e.start<D.length?(x.push(D[e.start]||{}),D.splice(e.start,1)):x.push({}),S===e.start&&(x[0].index=e.start),M&&e.model.maxHgts.splice(e.start,1);u.forEach(function(A){return t.parent.notify(Mn,A)}),this.parent.notify(Ef,e),e.modelType!=="Sheet"&&(this.parent.notify(Fy,e),s.refreshSheet=e.refreshSheet,s.activeSheetIndex=yt(this.parent,e.model.name),s.conditionalFormats=[],this.deleteConditionalFormats(e,s)),s.definedNames=d.definedNames,s.isAction=e.isAction,s.deletedModel=x,delete s.cancel,this.parent.notify(wx,a)}}},o.prototype.setRowColCount=function(e,t,i,r){var n=r+"Count",s=i[""+n];t>=s&&(t=s-1),!(t<e)&&(this.parent.setSheetPropertyOnMute(i,n,s-(t-e+1)),i.id===this.parent.getActiveSheet().id&&this.parent.notify(sd,{index:s-1,update:r,isDelete:!0,start:e,end:t}))},o.prototype.deleteConditionalFormats=function(e,t){var i=e.model.conditionalFormats;if(i)for(var r=0;r<i.length;r++){t.conditionalFormats.push(he({},i[r],null,!0));var n=J(i[r].range),s=J(e.model.selectedRange);e.modelType==="Column"&&s[1]<=n[1]&&s[3]>=n[3]||e.modelType==="Row"&&s[0]<=n[0]&&s[2]>=n[2]?(i.splice(i.indexOf(i[r]),1),r--):i[r].range=Be(R6(e,n))}},o.prototype.addEventListener=function(){this.parent.on(Mf,this.deleteModel,this)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(Mf,this.deleteModel)},o.prototype.getModuleName=function(){return"workbookdelete"},o}(),xO=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.highlightInvalidData=null,this.parent=null},o.prototype.addEventListener=function(){this.parent.on(To,this.updateValidationHandler,this),this.parent.on(by,this.addHighlightHandler,this),this.parent.on(Cy,this.removeHighlightHandler,this),this.parent.on(Kc,this.beforeInsertDeleteHandler,this),this.parent.on(Ef,this.beforeInsertDeleteHandler,this),this.parent.on(ls,this.beforeInsertDeleteHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(To,this.updateValidationHandler),this.parent.off(by,this.addHighlightHandler),this.parent.off(Cy,this.removeHighlightHandler),this.parent.off(Kc,this.beforeInsertDeleteHandler),this.parent.off(Ef,this.beforeInsertDeleteHandler),this.parent.off(ls,this.beforeInsertDeleteHandler))},o.prototype.updateValidationHandler=function(e){var t=this,i,r=e.range.lastIndexOf("!"),n,s;if(r>-1){i=e.range.substring(0,r),e.range=e.range.substring(r+1);var a=yt(this.parent,i);n=ke(this.parent,a),s=a===this.parent.activeSheetIndex}else n=this.parent.getActiveSheet(),s=!0;var l=this.getRangeWhenColumnSelected(e.range,n);i&&(e.range=i+"!"+l.range);var h=tt(J(l.range)),u,c,d,p,f,v,m,y={colIdx:h[1]};if(s){d=this.parent.frozenRowCount(n);var S=this.parent.frozenColCount(n),b=this.parent,w=b.viewport||{};if(f=b.scrollSettings&&b.scrollSettings.enableVirtualization?[d+w.topIndex,S+w.leftIndex,w.bottomIndex,w.rightIndex]:[0,0,n.rowCount-1,n.colCount-1],l.isFullCol){var I=[[f[0],f[2]]];d&&I.push([J(n.topLeftCell)[0],d-1]),m=function(F){F.isHighlighted&&(y.colIdx>=f[1]&&y.colIdx<=f[3]||y.colIdx<S)&&!Ot(n,y.colIdx)&&I.forEach(function(R){for(y.rowIdx=R[0];y.rowIdx<=R[1];y.rowIdx++)st(n,y.rowIdx)||(y.cell=G(y.rowIdx,y.colIdx,n,!1,!0),y.validation=y.cell.validation?y.cell.validation:F,t.parent.notify(su,y))})}}v=function(F){F.isHighlighted&&p&&(y.colIdx>=f[1]&&y.colIdx<=f[3]||y.colIdx<S)&&!Ot(n,y.colIdx)&&t.parent.notify(su,y)}}var x,M,D,A;if(e.isRemoveValidation){if(s){if(D=J(n.activeCell),D[0]>=h[0]&&D[1]>=h[1]&&D[0]<=h[2]&&D[1]<=h[3]){var L=G(D[0],D[1],n,!1,!0).validation||Ds(n.columns[h[1]],D[0],D[1])&&n.columns[D[1]].validation;M=L&&L.type==="List"}y.isRemoveValidation=!0,y.isRemoveHighlightedData=!0}}else{e.isAction&&this.highlightInvalidData&&(x={isHighlighted:this.highlightInvalidData}),e.rules.type==="List"?(D=J(n.activeCell),M=s&&D[0]>=h[0]&&D[1]>=h[1]&&D[0]<=h[2]&&D[1]<=h[3],e.rules.value1&&(e.rules.value1=e.rules.value1.trim(),e.rules.value1[e.rules.value1.length-1]===this.parent.listSeparator&&(e.rules.value1=e.rules.value1.substring(0,e.rules.value1.length-1)))):e.rules.type==="Custom"&&!g(e.rules.value2)&&delete e.rules.value2,s&&(y.removeOnValidData=!0);var T=ut(e.rules.value1),k=ut(e.rules.value2);A=function(F){T&&(y.validation.value1=Hn([F,y.colIdx,F,y.colIdx],h,n,t.parent,{formula:e.rules.value1})),k&&(y.validation.value2=Hn([F,y.colIdx,F,y.colIdx],h,n,t.parent,{formula:e.rules.value2}))}}for(y.colIdx;y.colIdx<=h[3];y.colIdx++){if(l.isFullCol)if(e.isRemoveValidation)u=n.columns[y.colIdx],u&&u.validation&&(s&&m(u.validation),delete u.validation);else{y.validation=Object.assign({},e.rules,x),A(0),n.columns[y.colIdx]||(n.columns[y.colIdx]={}),n.columns[y.colIdx].validation=y.validation,s&&m(y.validation);continue}for(y.rowIdx=h[0];y.rowIdx<=h[2];y.rowIdx++)p=s&&(y.rowIdx>=f[0]&&y.rowIdx<=f[2]||y.rowIdx<d)&&!st(n,y.rowIdx),e.isRemoveValidation?(u=n.columns[y.colIdx],u&&u.validation&&(y.rowIdx===h[2]&&(u.validation.address=L6(u.validation.address,[h[0],y.colIdx,h[2],y.colIdx],y.colIdx)),s&&v(u.validation)),c=G(y.rowIdx,y.colIdx,n),c&&c.validation&&!sr(this.parent,n,{cell:{validation:{}},rowIdx:y.rowIdx,colIdx:y.colIdx})&&(s&&v(c.validation),delete c.validation)):(y.validation=Object.assign({},e.rules,x),A(y.rowIdx),sr(this.parent,n,{cell:{validation:y.validation},rowIdx:y.rowIdx,colIdx:y.colIdx})||s&&(y.cell=G(y.rowIdx,y.colIdx,n),v(y.validation)))}if(M){c=G(D[0],D[1],n,!1,!0);var L=c.validation;L||(L=Ds(n.columns[D[1]],D[0],D[1])?n.columns[D[1]].validation:{}),this.parent.notify(pd,{validation:L,cell:c,rowIdx:D[0],colIdx:D[1],isRefresh:!0})}},o.prototype.addHighlightHandler=function(e){e.isAction&&(this.highlightInvalidData=!0),this.invalidDataHandler(e.range)},o.prototype.removeHighlightHandler=function(e){e.isAction&&(this.highlightInvalidData=null),this.invalidDataHandler(e.range,!0)},o.prototype.invalidDataHandler=function(e,t){var i=this,r,n,s,a,l,h,u,c,d,p,f=this.parent,v=this.parent.getActiveSheet(),m=this.parent.frozenRowCount(v),y=this.parent.frozenColCount(v),S=f.scrollSettings&&f.scrollSettings.enableVirtualization?f.viewport?[m+f.viewport.topIndex,y+f.viewport.leftIndex,f.viewport.bottomIndex,f.viewport.rightIndex]:[]:[0,0,v.rowCount-1,v.colCount-1],b=function(M,D){h&&(a>=S[1]&&a<=S[3]||a<y)&&!Ot(v,a)&&i.parent.notify(su,{isRemoveHighlightedData:t,rowIdx:s,colIdx:a,cell:r,validation:M,removeOnValidData:!0,col:D})},w;t?w=function(M,D){M.isHighlighted&&(D&&delete M.isHighlighted,b(M))}:w=function(M,D,A){D&&(M.isHighlighted=!0),b(M,A)};var I=function(){for(s=l[0];s<=l[2];s++)for(h=u&&(s>=S[0]&&s<=S[2]||s<m)&&!st(v,s),c&&(p=Ar(v,s),d=Math.max(p&&p.cells?p.cells.length-1:null,v.columns.length-1,l[3])),a=l[1];a<=d;a++)r=G(s,a,v,!1,!0),n=v.columns[a],r.validation?w(r.validation,!0,n):Ds(n,s,a)&&w(n.validation,s===l[2])};if(e){if(e.includes("!")){var x=Gs(this.parent,e);v=ke(this.parent,x),e=cu(e),u=x===this.parent.activeSheetIndex}else u=!0;l=tt(J(this.getRangeWhenColumnSelected(Px(v,e),v).range)),d=l[3],I()}else c=!0,this.parent.sheets.forEach(function(M,D){v=M,l=[0,0,Math.max(v.rows.length-1,S[2]),Math.max(v.usedRange.colIndex,S[3])],u=D===i.parent.activeSheetIndex,I()})},o.prototype.beforeInsertDeleteHandler=function(e){var t=this,i;if(e.modelType==="Sheet"){if(e.name!==ls)return;i=!0}else if(e.name===ls)return;var r=e.name===Kc,n,s,a,l;if(r)a=ke(this.parent,e.activeSheetIndex),s=e.index+(e.model.length-1),n={insertDeleteArgs:{startIndex:e.index,endIndex:s,modelType:e.modelType,isInsert:!0,sheet:a},sheetIdx:e.activeSheetIndex},l=e.index-1;else if(i){var h=[],u=void 0,c={action:"getSheetInfo",sheetInfo:[]};this.parent.notify(xt,c);for(var d=e.startIndex;d<=e.endIndex;d++){u=this.parent.sheets[d].id;for(var p=0;p<c.sheetInfo.length;p++)if(c.sheetInfo[p].index===u){h.push(c.sheetInfo[p].sheet);break}}n={sheetNames:h}}else a=e.model,n={insertDeleteArgs:{startIndex:e.start,modelType:e.modelType,endIndex:e.end,sheet:a},sheetIdx:cn(this.parent,a.id)};var f=function(D){ut(D.value1)&&(!n.otherSheet||D.value1.includes(a.name))&&(n.cell={formula:D.value1},t.parent.notify(Oy,n),D.value1=n.cell.formula),ut(D.value2)&&(!n.otherSheet||D.value2.includes(a.name))&&(n.cell={formula:D.value2},t.parent.notify(Oy,n),D.value2=n.cell.formula)},v=e.modelType==="Column",m=function(D,A){if(D){n.insertDeleteArgs.forceUpdate=!0;for(var L=e.index;L<=s;L++)D=he({},D),f(D),A?ch(a,L,{validation:D}):v?oi(I,L,a,{validation:D},!0):oi(L,x,a,{validation:D},!0);delete n.insertDeleteArgs.forceUpdate}},y,S,b,w,I,x,M;this.parent.sheets.forEach(function(D,A){if(i){if(A>=e.startIndex&&A<=e.endIndex)return}else A===n.sheetIdx?(M=r,delete n.otherSheet,delete n.formulaSheet):(n.otherSheet=!0,n.formulaSheet=D,M=!1);for(b=D.usedRange.rowIndex+1,x=0,w=D.usedRange.colIndex+1;x<w;x++)if(!(M&&v&&x>=e.index&&x<=s))for(S=D.columns&&D.columns[x],S&&S.validation&&(f(S.validation),M&&v&&l===x&&m(S.validation,!0)),I=0;I<b;I++)y=G(I,x,D,!1,!0),y.validation&&(!M||v||I<e.index||I>s)&&(f(y.validation),M&&l===(v?x:I)&&m(y.validation))})},o.prototype.getRangeWhenColumnSelected=function(e,t){var i,r=e.split(":");return e.match(/\D/g)&&!e.match(/[0-9]/g)?(r[0]+=1,r[1]+=t.rowCount,e=r[0]+":"+r[1],i=!0):!e.match(/\D/g)&&e.match(/[0-9]/g)&&(r[0]="A"+r[0],r[1]=et(0,t.colCount-1).replace(/[0-9]/g,"")+r[1],e=r[0]+":"+r[1]),{range:e,isFullCol:i}},o.prototype.getModuleName=function(){return"workbookDataValidation"},o}(),VI=function(){return VI=Object.assign||function(o){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r])}return o},VI.apply(this,arguments)},IO=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(xx,this.find,this),this.parent.on(Df,this.replace,this),this.parent.on(ld,this.replaceAll,this),this.parent.on(wy,this.totalCount,this),this.parent.on(gx,this.findAllValues,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(xx,this.find),this.parent.off(Df,this.replace),this.parent.off(ld,this.replaceAll),this.parent.off(wy,this.totalCount),this.parent.off(gx,this.findAllValues))},o.prototype.find=function(e){e.sheetIndex=Ee(e.sheetIndex)?this.parent.activeSheetIndex:e.sheetIndex;var t=this.parent.sheets[e.sheetIndex],i=J(t.activeCell),r={startRow:i[0],startCol:i[1],findVal:e.isCSen?e.value:e.value.toLowerCase(),activeCell:i};(e.searchBy==="By Row"?r.startRow>t.usedRange.rowIndex:r.startCol>t.usedRange.colIndex)?e.findOpt==="next"?r.startRow=r.startCol=0:(r.startRow=t.usedRange.rowIndex,r.startCol=t.usedRange.colIndex):e.searchBy==="By Row"?r.startCol>t.usedRange.colIndex&&(e.findOpt==="next"?(r.startRow++,r.startRow>t.usedRange.rowIndex&&(r.startRow=0),r.startCol=0):(r.startRow--,r.startRow<0&&(r.startRow=t.usedRange.rowIndex),r.startCol=t.usedRange.colIndex)):r.startRow>t.usedRange.rowIndex&&(e.findOpt==="next"?(r.startCol++,r.startCol>t.usedRange.colIndex&&(r.startRow=0),r.startRow=0):(r.startCol--,r.startCol<0&&(r.startCol=t.usedRange.colIndex),r.startRow=t.usedRange.colIndex)),e.mode==="Workbook"?(r.sheets=this.parent.sheets,r.sheetIdx=e.sheetIndex):(r.sheets=[t],r.sheetIdx=0);var n,s=e.showDialog&&this.parent.element&&this.parent.element.querySelector(".e-header-panel");s&&(n=(s.offsetHeight||(t.showHeaders?30:0))+1),e.localeObj=Yi(this.parent.locale),e.findOpt==="next"?this.findNext(e,r):this.findPrevious(e,r),e.showDialog&&this.parent.notify(du,{findValue:e.value,isPublic:!0,headerHgt:n})},o.prototype.findNext=function(e,t){var i=this,r=function(s,a,l){for(var h,u,c=s;c<=a&&(h=t.sheets[c],c===t.sheetIdx?l?u=i.findNextOnSheet(e,t.startRow,t.startCol,t.findVal,h,void 0,t.activeCell):u=i.findNextOnSheet(e,0,0,t.findVal,h,e.searchBy==="By Row"?t.startRow:t.startCol):u=i.findNextOnSheet(e,0,0,t.findVal,h),!u);c++);return u},n=r(t.sheetIdx,t.sheets.length-1,!0);n||(n=r(0,t.sheetIdx)),n?this.parent.notify(nu,{address:n}):this.parent.notify(Sy,null)},o.prototype.findNextOnSheet=function(e,t,i,r,n,s,a){var l,h,u;if(e.searchBy==="By Row"){s===void 0&&(s=n.rows.length-1);var c=void 0;for(h=t;h<=s;h++)if(!st(n,h)){for(u=a&&h===t?i:0,c=n.rows[h]&&n.rows[h].cells&&n.rows[h].cells.length,u;u<c;u++)if(!Ot(n,u)&&(l=this.checkMatch(e,r,h,u,n,a),l))return l}}else{s===void 0&&(s=n.usedRange.colIndex);var d=n.rows&&n.rows.length-1;for(u=i;u<=s;u++)if(!Ot(n,u)){for(h=a&&u===i?t:0,h;h<=d;h++)if(!st(n,h)&&(l=this.checkMatch(e,r,h,u,n,a),l))return l}}return l},o.prototype.findPrevious=function(e,t){var i=this,r=function(s,a,l){for(var h,u,c=s;c>=a&&(h=t.sheets[c],c===t.sheetIdx?l?u=i.findPrevOnSheet(e,t.startRow,t.startCol,0,0,t.findVal,h,t.activeCell):e.searchBy==="By Row"?u=i.findPrevOnSheet(e,h.usedRange.rowIndex,h.usedRange.colIndex,t.startRow,0,t.findVal,h):u=i.findPrevOnSheet(e,h.usedRange.rowIndex,h.usedRange.colIndex,0,t.startCol,t.findVal,h):u=i.findPrevOnSheet(e,h.usedRange.rowIndex,h.usedRange.colIndex,0,0,t.findVal,h),!u);c--);return u},n;n=r(t.sheetIdx,0,!0),n||(n=r(t.sheets.length-1,t.sheetIdx)),n?this.parent.notify(nu,{address:n}):this.parent.notify(Sy,null)},o.prototype.findPrevOnSheet=function(e,t,i,r,n,s,a,l){var h,u,c;if(e.searchBy==="By Row"){for(c=t;c>=r;c--)if(!st(a,c)){for(u=l&&c===t?i:a.rows[c]&&a.rows[c].cells&&a.rows[c].cells.length-1,u;u>=n;u--)if(!Ot(a,u)&&(h=this.checkMatch(e,s,c,u,a,l),h))return h}}else for(u=i;u>=n;u--)if(!Ot(a,u)){for(c=l&&u===i?t:a.rows&&a.rows.length-1,c;c>=r;c--)if(!st(a,c)&&(h=this.checkMatch(e,s,c,u,a,l),h))return h}return h},o.prototype.checkMatch=function(e,t,i,r,n,s){if(s&&i===s[0]&&r===s[1])return null;var a=G(i,r,n,!1,!0);if(n.isProtected&&!n.protectSettings.selectCells&&n.protectSettings.selectUnLockedCells&&un(a,Rt(n,r)))return null;var l=function(c){if(c){if(e.isCSen||(c=c.toLowerCase()),e.isEMatch){if(c===t)return n.name+"!"+et(i,r)}else if(c.includes(t))return n.name+"!"+et(i,r)}return null},h=this.getDisplayText(a,i,r,e.localeObj),u=l(h);return u||(a=G(i,r,n,!1,!0),a.format&&!qs(a.format,!0)&&!h.includes("%")&&(u=l(this.getCellVal(a,e.localeObj)))),u},o.prototype.replace=function(e){var t=this,i=Ee(e.sheetIndex)?this.parent.activeSheetIndex:e.sheetIndex,r=ke(this.parent,e.sheetIndex);if(r.isProtected){this.parent.notify(E6,null);return}var n=e.address,s=J(n||r.activeCell),a=G(s[0],s[1],r,!1,!0),l=this.parent.getDisplayText(a).toString(),h;e.value=e.value.toString(),e.isCSen||(h=e.value.toLowerCase());var u=Yi(this.parent.locale),c=function(f){var v;if(e.isCSen)e.isEMatch?v=l===e.value&&e.replaceValue:v=l.indexOf(e.value)>-1&&l.replace(e.value,e.replaceValue);else if(e.isEMatch)v=l.toLowerCase()===h&&e.replaceValue;else{var m=RegExp;v=l.toLowerCase().includes(h)&&l.replace(new m(e.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"ig"),e.replaceValue)}return!f&&!d&&a.format&&!qs(a.format,!0)&&!l.includes("%")&&(l=t.getCellVal(a,u),l&&(v=c(!0))),v},d=c();if(!(!d&&(e.findOpt="next",this.find(e),s=Se(r.activeCell),a=G(s[0],s[1],r,!1,!0),l=this.parent.getDisplayText(a).toString(),d=c(),!d))){if(Lo(G(s[0],s[1],r),Rt(r,s[1]),Ar(r,s[0]))){this.parent.notify(tu,null);return}var p={address:r.name+"!"+et(s[0],s[1]),cancel:!1,compareValue:e.value,replaceValue:e.replaceValue,sheetIndex:i};if(e.isAction){if(this.parent.notify(ai,{action:"beforeReplace",eventArgs:p}),p.cancel)return;delete p.cancel}sr(this.parent,r,{cell:{value:d},rowIdx:s[0],colIdx:s[1],uiRefresh:!0,checkCF:!0,valChange:!0}),e.isAction&&this.parent.notify("actionComplete",{action:"replace",eventArgs:p})}},o.prototype.replaceAll=function(e){var t=this,i=e.mode==="Sheet"?e.sheetIndex:0,r=this.parent.sheets[i],n=r.usedRange.rowIndex,s=0,a=r.usedRange.colIndex,l=0,h=[],u=e.isAction,c=Se(r.activeCell),d=VI({addressCollection:h,cancel:!1},e),p=0,f=function(I,x,M){requestAnimationFrame?requestAnimationFrame(function(){if(!d.cancel&&d.addressCollection[x]){var D=Se(d.addressCollection[x].substring(d.addressCollection[x].lastIndexOf("!")+1)),A=Gs(t.parent,d.addressCollection[x]);sr(t.parent,t.parent.sheets[A],{cell:{value:I},rowIdx:D[0],uiRefresh:!0,checkCF:!0,colIdx:D[1],valChange:!0,skipFormatCheck:e.skipFormatCheck}),c[0]===D[0]&&c[1]===D[1]&&t.parent.notify("formulaBarOperation",{action:"refreshFormulabar",cell:G(D[0],D[1],t.parent.sheets[A],!1,!0)}),x===d.addressCollection.length-1&&u&&t.parent.notify("actionComplete",{action:"replaceAll",eventArgs:d})}}):t.parent.updateCellDetails({value:I},d.addressCollection[x],void 0,void 0,!0),M.formula||p++},v=function(I,x){var M;if(I)if(e.isCSen)e.isEMatch?I===e.value&&(f(e.replaceValue,h.length,x),h.push(r.name+"!"+et(s,l)),M=!0):I.indexOf(e.value)>-1&&(f(I.replace(e.value,e.replaceValue),h.length,x),h.push(r.name+"!"+et(s,l)),M=!0);else if(e.isEMatch)I.toLowerCase()===e.value&&(f(e.replaceValue,h.length,x),h.push(r.name+"!"+et(s,l)),M=!0);else{var D=I.toLowerCase();if(I===e.value||D.indexOf(e.value.toString().toLowerCase())>-1||D===e.value||I===e.value||D.indexOf(e.value)>-1){var A=RegExp;S=new A(e.value.toString().replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"ig"),f(I.replace(S,e.replaceValue),h.length,x),h.push(r.name+"!"+et(s,l)),M=!0}}return M},m,y,S,b=Yi(this.parent.locale),w;for(s;s<=n+1;s++){if(l>a&&s>n&&e.mode==="Workbook")if(i++,r=this.parent.sheets[i],r)l=0,s=0,a=r.usedRange.colIndex,n=r.usedRange.rowIndex;else break;if(y=r.rows[s],y){for(l===a+1&&(l=0),l;l<=a;l++)if(y&&(w=y.cells&&y.cells[l],w)){if(Lo(w,Rt(r,l),y))continue;m=this.getDisplayText(w,s,l,b).toString(),!v(m,w)&&w.format&&!qs(w.format,!0)&&!m.includes("%")&&v(this.getCellVal(y.cells[l],b),w)}}}h.length&&u?(this.parent.notify("actionBegin",{action:"beforeReplaceAll",eventArgs:d}),d.cancel||this.parent.notify(xy,{count:p,replaceValue:d.replaceValue})):this.parent.notify(xy,{count:p,replaceValue:d.replaceValue})},o.prototype.getDisplayText=function(e,t,i,r){if(!e)return"";if(!e.value&&e.value!==0)return e.hyperlink?typeof e.hyperlink=="string"?e.hyperlink:e.hyperlink.address||"":"";var n=e.value.toString();if(e.format||n.includes(r.dateSeparator)){var s={value:e.value,format:e.format,formattedText:e.value,cell:e,rowIndex:t,colIndex:i};return this.parent.notify(en,s),s.formattedText}else return n},o.prototype.getCellVal=function(e,t){return Me(e.value)?t.decimal!=="."?e.value.toString().split(".").join(t.decimal):e.value.toString():e.value?e.value.toString().toLowerCase():""},o.prototype.totalCount=function(e){var t=this,i=this.parent.sheets[e.sheetIndex],r=Se(i.activeCell),n=0,s=0,a=e.value.toLowerCase(),l=Yi(this.parent.locale),h;i.rows.filter(function(c,d){return c&&c.cells&&!c.isFiltered&&!c.hidden&&c.cells.filter(function(p,f){p&&(p.value||p.value===0)&&!Ot(i,f)&&(!i.isProtected||i.protectSettings.selectCells||!un(p,Rt(i,f)))&&(h=t.getDisplayText(p,d,f,l).toLowerCase(),(h.includes(a)||p.format&&!qs(p.format,!0)&&!h.includes("%")&&t.getCellVal(p,l).includes(a))&&(n++,(d===r[0]&&f>=r[1]||d>r[0])&&s++))})}),s-=1;var u=n;n=u-s,n>u&&(n=u),n!==0&&!this.parent.getDisplayText(G(r[0],r[1],i)).toLowerCase().includes(a)&&(n-=1),e.findCount=n+" of "+u},o.prototype.findAllValues=function(e){var t=e.sheetIndex,i=this.parent.sheets[t],r=i.usedRange.rowIndex,n=0,s=0,a,l=i.usedRange.colIndex,h=0,u=this.parent.sheets.length,c=e.sheetIndex;for(n;n<=r+1;n++){if(c!==1&&e.sheetIndex===u&&(t=1),n>r&&h>l&&e.mode==="Workbook"){if(t++,t>u-1&&(t=0),c===t)return void 0;i=this.parent.sheets[t],i&&(n=0,h=0,l=i.usedRange.colIndex,r=i.usedRange.rowIndex)}if(!g(i)&&i.rows[n]){var d=i.rows[n];for(h===l+2&&(h=0),h;h<=l+1;h++)if(d&&d.cells&&d.cells[h]){var p=i.rows[n].cells[h];if(p&&!g(p.value)&&p.value!==""&&(!i.isProtected||i.protectSettings.selectCells||i.protectSettings.selectUnLockedCells&&!un(p,Rt(i,h)))){var f=p.format,v=void 0;if(f){var m=this.parent.getDisplayText(i.rows[n].cells[h]);v=m.toString()}else v=p.value.toString();if(e.isCSen&&e.isEMatch)v===e.value&&(a=i.name+"!"+et(n,h),e.findCollection.push(a),s++);else if(e.isCSen&&!e.isEMatch){var y=v.indexOf(e.value)>-1;(v===e.value||y)&&(a=i.name+"!"+et(n,h),e.findCollection.push(a),s++)}else if(!e.isCSen&&e.isEMatch){var S=v.toString().toLowerCase();S===e.value.toLowerCase()&&(a=i.name+"!"+et(n,h),e.findCollection.push(a),s++)}else if(!e.isCSen&&!e.isEMatch){var S=v.toString().toLowerCase(),y=S.indexOf(e.value.toLowerCase())>-1;(S===e.value||v===e.value||y||v===e.value)&&(a=i.name+"!"+et(n,h),e.findCollection.push(a),s++)}}}}}},o.prototype.getModuleName=function(){return"workbookfindAndReplace"},o}(),MO=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.protectsheetHandler=function(e){var t=g(e.sheetIndex)?this.parent.activeSheetIndex:e.sheetIndex,i=ke(this.parent,t);this.parent.setSheetPropertyOnMute(i,"isProtected",!0),this.parent.setSheetPropertyOnMute(i,"protectSettings",{selectCells:e.protectSettings.selectCells,formatCells:e.protectSettings.formatCells,formatColumns:e.protectSettings.formatColumns,formatRows:e.protectSettings.formatRows,insertLink:e.protectSettings.insertLink,selectUnLockedCells:e.protectSettings.selectUnLockedCells}),this.parent.notify(Mx,{sheetIndex:t,triggerEvent:e.triggerEvent}),this.parent.notify(jF,{props:"Protect"}),i.password=e.password?e.password:"",i.columns.forEach(function(r){r&&Ee(r.isLocked)&&(r.isLocked=!0)})},o.prototype.unprotectsheetHandler=function(e){var t=this.parent.getActiveSheet();g(e.sheet)||(t=this.parent.sheets[e.sheet]),t.isImportProtected&&(t.isImportProtected=!1),t.protectSettings.formatCells=t.protectSettings.formatColumns=!1,t.protectSettings.formatRows=t.protectSettings.selectCells=!1,this.parent.setSheetPropertyOnMute(t,"isProtected",!1),this.parent.notify(Mx,t.protectSettings),this.parent.notify(jF,{props:"Protect"})},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on($c,this.protectsheetHandler,this),this.parent.on(nO,this.unprotectsheetHandler,this),this.parent.on(Iy,this.lockCells,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off($c,this.protectsheetHandler),this.parent.off(Iy,this.lockCells),this.parent.off($c,this.unprotectsheetHandler))},o.prototype.lockCells=function(e){var t=this.parent.getAddressInfo(e.range),i=tt(t.indices),r=ke(this.parent,t.sheetIndex),n=e.isLocked?e.isLocked:!1;if(i[0]===0&&i[2]===r.rowCount-1)for(var s=i[1];s<=i[3];s++)ch(r,s,{isLocked:e.isLocked});for(var s=i[0];s<=i[2];s++)for(var a=i[1];a<=i[3];a++)oi(s,a,r,{isLocked:n},!0);e.triggerEvent&&this.parent.notify("actionComplete",{action:"lockCells",eventArgs:e})},o.prototype.getModuleName=function(){return"workbookProtectSheet"},o}(),DO=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.merge=function(e){e.sheetIndex=Ee(e.sheetIndex)?this.parent.activeSheetIndex:e.sheetIndex,e.isAction&&(this.parent.notify("actionBegin",{eventArgs:e,action:"merge"}),e.model||(e.model=[])),typeof e.range=="string"&&(e.range=J(e.range));var t=e.range=tt(e.range);if(e.skipChecking||this.mergedRange(e),!e.merge||e.type==="All")this.mergeAll(e),e.refreshRibbon&&this.parent.notify(Qa,null);else if(e.type==="Horizontally")for(var i=e.range[0],r=e.range[2];i<=r;i++)e.range=[i,t[1],i,t[3]],this.mergeAll(e,i-t[0]);else if(e.type==="Vertically")for(var n=e.range[1],r=e.range[3];n<=r;n++)e.range=[t[0],n,t[2],n],this.mergeAll(e,0,n-t[1]);e.range=t,this.parent.setUsedRange(e.range[2],e.range[3]),e.isAction&&this.parent.notify("actionComplete",{eventArgs:e,action:"merge"}),e.sheetIndex===this.parent.activeSheetIndex&&(this.parent.notify("selectRange",{address:ke(this.parent,e.sheetIndex).selectedRange,skipChecking:!0}),this.parent.chartColl&&this.parent.chartColl.length&&this.parent.notify(lh,{range:e.range}))},o.prototype.mergeAll=function(e,t,i){t===void 0&&(t=0),i===void 0&&(i=0);var r=0,n;e.range=e.range;for(var s,a,l,h,u,c=Ee(e.sheetIndex)?this.parent.getActiveSheet():ke(this.parent,e.sheetIndex),d={cell:new Object,rowIdx:e.range[0],colIdx:e.range[1],valChange:!e.merge,preventEvt:!0,uiRefresh:!e.preventRefresh,skipFormatCheck:!0},p=e.range[0],f=t;p<=e.range[2];p++,f++){s=0,e.isAction&&!e.model[f]&&e.model.push({cells:[]});for(var v=e.range[1],m=i;v<=e.range[3];v++,m++){if(n=G(p,v,c),n&&(n.value||n.value===0||n.formula)&&!a&&(a=n.formula||n.value,h=n.format),e.isAction&&e.merge&&(u=e.model[f].cells[m]={},he(u,n,null,!0)),n){delete n.rowSpan,delete n.colSpan,u=!e.merge&&!e.isAction&&e.model&&e.model[f]&&e.model[f].cells[m];var y=this.parent.calculationMode==="Manual"&&this.parent.getActiveSheet().isSheetCalculated&&!g(n.value)&&n.value!=="";u?(y&&(u.value=n.value),oi(p,v,c,u)):e.model&&e.model[f].cells[m]&&y&&(e.model[f].cells[m].value=n.value)}if(p===e.range[0]&&v===e.range[1]){if(e.merge){e.range[3]-e.range[1]>0&&(d.cell.colSpan=e.range[3]-e.range[1]+1),e.range[2]-e.range[0]>0&&(d.cell.rowSpan=e.range[2]-e.range[0]+1),sr(this.parent,c,d),d.valChange=d.mergedCells=!0;continue}}else d.rowIdx=p,d.colIdx=v,d.cell={},e.merge&&(p!==e.range[0]&&(d.cell.rowSpan=-r),v!==e.range[1]&&(s++,d.cell.colSpan=-s));sr(this.parent,c,d),l||(l=d.isFormulaDependent)}r++}if(e.merge)if(a||a===0){delete d.mergedCells,d.cell={};var S=G(e.range[0],e.range[1],c);(!S||!S.value&&!S.formula)&&(ut(a)?d.cell.formula=a:d.cell.value=a,h&&(d.cell.format=h)),d.rowIdx=e.range[0],d.colIdx=e.range[1],sr(this.parent,c,d)}else e.preventRefresh||this.parent.notify(Dx,{rowIdx:e.range[0],colIdx:e.range[1]});e.preventRefresh||this.refreshCF(c,e.range.slice(),l,e.merge)},o.prototype.refreshCF=function(e,t,i,r){e.conditionalFormats&&e.conditionalFormats.length&&(r?this.parent.notify(Wi,{indexes:[t[0],t[1]],refreshAll:i,isAction:!0}):this.parent.notify(Wi,{indexes:t,refreshAll:i,isAction:!0}))},o.prototype.activeCellRange=function(e){e.range=e.range;var t=this.parent.getActiveSheet(),i=G(e.range[0],e.range[1],t);i&&(!g(i.rowSpan)&&i.rowSpan<0&&(e.range[0]+=i.rowSpan,e.insertCount&&(e.range[0]-=e.insertCount)),!g(i.colSpan)&&i.colSpan<0&&(e.range[1]+=i.colSpan,e.insertCount&&(e.range[1]-=e.insertCount)),i=G(e.range[0],e.range[1],t),i&&(i.rowSpan>1&&(e.range[0]+(i.rowSpan-1)>=e.range[2]||e.insertCount)&&(e.range[2]=e.range[0]+(i.rowSpan-1)),i.colSpan>1&&(e.range[1]+(i.colSpan-1)>=e.range[3]||e.insertCount)&&(e.range[3]=e.range[1]+(i.colSpan-1))))},o.prototype.mergedRange=function(e){typeof e.range=="string"&&(e.range=J(e.range)),e.range[0]<=e.range[2]&&e.range[1]<=e.range[3]?this.forward(e):e.range[0]>=e.range[2]&&e.range[1]>=e.range[3]?this.reverse(e):e.range[0]<e.range[2]&&e.range[1]>e.range[3]?this.forwardReverse(e):e.range[0]>e.range[2]&&e.range[1]<e.range[3]&&this.reverseForward(e)},o.prototype.forward=function(e){e.range=e.range;var t=Ee(e.sheetIndex)?this.parent.getActiveSheet():ke(this.parent,e.sheetIndex),i=G(e.range[0],e.range[1],t),r,n,s=r=e.range[0],a=n=e.range[1];if(i&&(!g(i.rowSpan)&&i.rowSpan<0&&(s=r=e.range[0]+i.rowSpan),!g(i.colSpan)&&i.colSpan<0&&(a=n=e.range[1]+i.colSpan),i=G(s,a,t),i&&(i.rowSpan>1&&(r+=i.rowSpan-1,s+(i.rowSpan-1)>=e.range[2]&&(e.range[2]=e.range[0],e.range[2]=s+(i.rowSpan-1))),i.colSpan>1&&(n+=i.colSpan-1,a+(i.colSpan-1)>=e.range[3]&&(e.range[3]=e.range[1],e.range[3]=a+(i.colSpan-1))))),e.range[0]=s,e.range[1]=a,e.range[0]===s&&e.range[1]===a&&e.range[2]===r&&e.range[3]===n&&(e.isActiveCell=!0),!e.skipChecking){for(var l=e.range[1];l<=e.range[3];l++)i=G(e.range[2],l,t),i&&(s=e.range[2],a=l,!g(i.colSpan)&&i.colSpan<0&&(a+=i.colSpan,a<e.range[1]&&(e.range[1]=a)),!g(i.rowSpan)&&i.rowSpan<0&&(s+=i.rowSpan,s<e.range[0]&&(e.range[0]=s)),i=G(s,a,t),i&&(i.colSpan>1&&a+(i.colSpan-1)>e.range[3]&&(e.range[3]=a,e.range[3]=a+(i.colSpan-1)),i.rowSpan>1&&s+(i.rowSpan-1)>e.range[2]&&(e.range[2]=s,e.range[2]=s+(i.rowSpan-1))));for(var h,u,l=e.range[1];l<=e.range[3];l++)i=G(e.range[0],l,t),i&&(u=l,h=e.range[0],!g(i.colSpan)&&i.colSpan<0&&(u+=i.colSpan,u<e.range[1]&&(e.range[1]=u)),!g(i.rowSpan)&&i.rowSpan<0&&(h+=i.rowSpan,h<e.range[0]&&(e.range[0]=h)));for(var l=e.range[0];l<=e.range[2];l++)i=G(l,e.range[3],t),i&&(s=l,a=e.range[3],!g(i.rowSpan)&&i.rowSpan<0&&(s+=i.rowSpan,s<e.range[0]&&(e.range[0]=s)),!g(i.colSpan)&&i.colSpan<0&&(a+=i.colSpan,a<e.range[1]&&(e.range[1]=a)),i=G(s,a,t),i&&(i.rowSpan>1&&s+(i.rowSpan-1)>e.range[2]&&(e.range[2]=s,e.range[2]=s+(i.rowSpan-1)),i.colSpan>1&&a+(i.colSpan-1)>e.range[3]&&(e.range[3]=a,e.range[3]=a+(i.colSpan-1))))}},o.prototype.forwardReverse=function(e){var t=this.parent.getActiveSheet();e.range=e.range;var i=e.range[1],r=G(e.range[0],e.range[1],t),n=e.range[0];if(r&&(!g(r.colSpan)&&r.colSpan<0&&(i+=r.colSpan,e.range[3]>=i&&(e.range[3]=i)),!g(r.rowSpan)&&r.rowSpan<0&&(n+=r.rowSpan,n<e.range[0]&&(e.range[0]=n)),r=G(n,i,t),r&&(r.rowSpan>1&&n+(r.rowSpan-1)>=e.range[2]&&(e.range[2]=n+(r.rowSpan-1)),r.colSpan>1&&i+(r.colSpan-1)>=e.range[1]&&(e.range[1]=i+(r.colSpan-1)))),e.range[0]=n,!e.skipChecking){for(var s,a,l=e.range[3];l<=e.range[1];l++)r=G(e.range[2],l,t),r&&(a=l,s=e.range[2],!g(r.rowSpan)&&r.rowSpan<0&&(s+=r.rowSpan,s<e.range[0]&&(e.range[0]=s)),!g(r.colSpan)&&r.colSpan<0&&(a+=r.colSpan,a<e.range[3]&&(e.range[3]=a)),r=G(s,a,t),r&&(r.rowSpan>1&&s+(r.rowSpan-1)>e.range[2]&&(e.range[2]=s+(r.rowSpan-1)),r.colSpan>1&&a+(r.colSpan-1)>e.range[1]&&(e.range[1]=a+(r.colSpan-1))));for(var h,l=e.range[3];l<=e.range[1];l++)r=G(e.range[0],l,t),r&&(a=l,h=e.range[0],!g(r.rowSpan)&&r.rowSpan<0&&(h+=r.rowSpan,h<e.range[0]&&(e.range[0]=h)),!g(r.colSpan)&&r.colSpan<0&&(a+=r.colSpan),r=G(h,a,t),r&&(r.rowSpan>1&&h+(r.rowSpan-1)>e.range[2]&&(e.range[2]=h+(r.rowSpan-1)),r.colSpan>1&&a+(r.colSpan-1)>e.range[1]&&(e.range[1]=a,e.range[1]=a+(r.colSpan-1))));for(var u,l=e.range[0];l<=e.range[2];l++)r=G(l,e.range[3],t),r&&(h=l,u=e.range[3],!g(r.rowSpan)&&r.rowSpan<0&&(h+=r.rowSpan,h<e.range[0]&&(e.range[0]=h)),!g(r.colSpan)&&r.colSpan<0&&(u+=r.colSpan,u<e.range[3]&&(e.range[3]=u)),r=G(h,u,t),r&&(r.rowSpan>1&&h+(r.rowSpan-1)>e.range[2]&&(e.range[2]=h,e.range[2]=h+(r.rowSpan-1)),r.colSpan>1&&u+(r.colSpan-1)>e.range[1]&&(e.range[1]=u,e.range[1]=u+(r.colSpan-1))))}},o.prototype.reverse=function(e){e.range=e.range;var t=e.range[1],i=Ee(e.sheetIndex)?this.parent.getActiveSheet():ke(this.parent,e.sheetIndex),r=G(e.range[0],e.range[1],i),n=e.range[0];r&&(!g(r.colSpan)&&r.colSpan<0&&(t+=r.colSpan),!g(r.rowSpan)&&r.rowSpan<0&&(n+=r.rowSpan),e.range[2]>=n&&(e.range[2]=n,e.isActiveCell=!0),e.range[3]>=t?(e.range[3]=t,e.range[2]===n&&(e.isActiveCell=!0)):e.isActiveCell&&(e.isActiveCell=!1),r=G(n,t,i),r&&(r.rowSpan>1&&n+(r.rowSpan-1)>=e.range[0]&&(e.range[0]=n,e.range[0]=n+(r.rowSpan-1)),r.colSpan>1&&t+(r.colSpan-1)>=e.range[1]&&(e.range[1]=t,e.range[1]=t+(r.colSpan-1))));var s=e.range[3];if(!e.skipChecking){for(var a=e.range[3];a<=e.range[1];a++)r=G(e.range[2],a,i),r&&(s=a,n=e.range[2],!g(r.rowSpan)&&r.rowSpan<0&&(n+=r.rowSpan,n<e.range[2]&&(e.range[2]=n)),!g(r.colSpan)&&r.colSpan<0&&(s+=r.colSpan,s<e.range[3]&&(e.range[3]=s)),r=G(n,s,i),r&&(r.rowSpan>1&&n+(r.rowSpan-1)>e.range[0]&&(e.range[0]=n,e.range[0]=n+(r.rowSpan-1)),r.colSpan>1&&s+(r.colSpan-1)>e.range[1]&&(e.range[1]=s,e.range[1]=s+(r.colSpan-1))));s=e.range[3];for(var a=e.range[3];a<=e.range[1];a++)r=G(e.range[0],a,i),r&&(s=a,n=e.range[0],!g(r.colSpan)&&r.colSpan<0&&(s+=r.colSpan),!g(r.rowSpan)&&r.rowSpan<0&&(n+=r.rowSpan),r=G(n,s,i),r&&(r.colSpan>1&&s+(r.colSpan-1)>e.range[1]&&(e.range[1]=s,e.range[1]=s+(r.colSpan-1)),r.rowSpan>1&&n+(r.rowSpan-1)>e.range[0]&&(e.range[0]=n,e.range[0]=n+(r.rowSpan-1))));for(var l,h,a=e.range[2];a<=e.range[0];a++)r=G(a,e.range[3],i),r&&(h=a,l=e.range[3],!g(r.rowSpan)&&r.rowSpan<0&&(h+=r.rowSpan,h<e.range[2]&&(e.range[2]=h)),!g(r.colSpan)&&r.colSpan<0&&(l+=r.colSpan,l<e.range[3]&&(e.range[3]=l)),r=G(h,l,i),r&&(r.rowSpan>1&&h+(r.rowSpan-1)>e.range[0]&&(e.range[0]=h,e.range[0]=h+(r.rowSpan-1)),r.colSpan>1&&l+(r.colSpan-1)>e.range[1]&&(e.range[1]=l,e.range[1]=l+(r.colSpan-1))))}},o.prototype.reverseForward=function(e){e.range=e.range;var t=Ee(e.sheetIndex)?this.parent.getActiveSheet():ke(this.parent,e.sheetIndex),i=e.range[0],r=e.range[1],n=G(e.range[0],e.range[1],t);if(n&&(!g(n.rowSpan)&&n.rowSpan<0&&(i+=n.rowSpan,e.range[2]>=i&&(e.range[2]=i)),!g(n.colSpan)&&n.colSpan<0&&(r+=n.colSpan),n=G(i,r,t),n&&(n.rowSpan>1&&i+(n.rowSpan-1)>=e.range[0]&&(e.range[0]=i,e.range[0]=i+(n.rowSpan-1)),n.colSpan>1&&r+(n.colSpan-1)>=e.range[3]&&(e.range[3]=e.range[1],e.range[3]=r+(n.colSpan-1)))),!e.skipChecking){for(var s=e.range[3],a,l=e.range[1];l<=e.range[3];l++)n=G(e.range[2],l,t),n&&(a=e.range[2],s=l,!g(n.rowSpan)&&n.rowSpan<0&&(a+=n.rowSpan,a<e.range[2]&&(e.range[2]=a)),!g(n.colSpan)&&n.colSpan<0&&(s+=n.colSpan,s<e.range[1]&&(e.range[1]=s)),n=G(a,s,t),n&&(n.colSpan>1&&s+(n.colSpan-1)>e.range[3]&&(e.range[3]=s+(n.colSpan-1)),n.rowSpan>1&&n.rowSpan-1+a>e.range[0]&&(e.range[0]=n.rowSpan-1+a)));for(var h,u,l=e.range[1];l<=e.range[3];l++)n=G(e.range[0],l,t),n&&(u=l,h=e.range[0],!g(n.colSpan)&&n.colSpan<0&&(u+=n.colSpan,u<e.range[1]&&(e.range[1]=u)),!g(n.rowSpan)&&n.rowSpan<0&&(h+=n.rowSpan),n=G(h,u,t),n&&n.rowSpan>1&&h+(n.rowSpan-1)>e.range[0]&&(e.range[0]=h+(n.rowSpan-1)));for(var c,l=e.range[2];l<=e.range[0];l++)n=G(l,e.range[3],t),n&&(a=l,c=e.range[3],!g(n.rowSpan)&&n.rowSpan<0&&(a+=n.rowSpan,a<e.range[2]&&(e.range[2]=a)),!g(n.colSpan)&&n.colSpan<0&&(c+=n.colSpan,c<e.range[1]&&(e.range[1]=c)),n=G(a,c,t),n&&(n.rowSpan>1&&n.rowSpan-1+a>e.range[0]&&(e.range[0]=n.rowSpan-1+a),n.colSpan>1&&n.colSpan-1+c>e.range[3]&&(e.range[3]=c,e.range[3]=n.colSpan-1+c)))}},o.prototype.insertHandler=function(e){this.activeCellRange(e),e.range=e.range,e.insertModel==="Row"?e.range[2]+=e.insertCount:e.range[3]+=e.insertCount,e.preventRefresh=!0,e.merge=!0,this.mergeAll(e)},o.prototype.addEventListener=function(){this.parent.on(Mn,this.merge,this),this.parent.on(Do,this.mergedRange,this),this.parent.on(ur,this.activeCellRange,this),this.parent.on(My,this.insertHandler,this)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Mn,this.merge),this.parent.off(Do,this.mergedRange),this.parent.off(ur,this.activeCellRange),this.parent.off(My,this.insertHandler))},o.prototype.getModuleName=function(){return"workbookmerge"},o}(),EO=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(hd,this.setCFRule,this),this.parent.on(qa,this.clearCFRule,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(hd,this.setCFRule),this.parent.off(qa,this.clearCFRule))},o.prototype.setCFRule=function(e){var t=e.cfModel,i=e.sheetIdx===void 0?Gs(this.parent,t.range):e.sheetIdx,r=ke(this.parent,i),n=tt(J(t.range||r.selectedRange));if(t.range=Be(n),e.isAction){var s={range:t.range,type:t.type,cancel:!1,cFColor:t.cFColor,value:t.value,sheetIdx:i};if(this.parent.notify(ai,{eventArgs:s,action:"conditionalFormat"}),s.cancel)return;t.type=s.type,t.cFColor=s.cFColor,t.value=s.value,s.range!==t.range&&(t.range=s.range,n=tt(J(s.range))),delete s.cancel}r.conditionalFormats||this.parent.setSheetPropertyOnMute(r,"conditionalFormats",[]),r.conditionalFormats.push(t),i!==this.parent.activeSheetIndex?e.isUndoRedo&&!e.isFromUpdateAction&&this.parent.notify(nu,{address:r.name+"!"+t.range}):this.parent.notify(Wi,{cfModel:[t],isAction:!0}),this.parent.setUsedRange(n[2],n[3]),e.isAction&&this.parent.notify("actionComplete",{eventArgs:{range:t.range,type:t.type,cFColor:t.cFColor,value:t.value,sheetIdx:i},action:"conditionalFormat"})},o.prototype.clearCFRule=function(e){e.sheetIdx===void 0&&(e.sheetIdx=this.parent.activeSheetIndex);var t=ke(this.parent,e.sheetIdx),i=t.conditionalFormats,r=i&&i[i.length-1]&&i[i.length-1].action!=="autofillWithCF";if(e.isUndo){e.updatedCFModel&&e.updatedCFModel.forEach(function(I){for(var x=0;x<i.length;x++)if(i[x].type===I.type&&i[x].cFColor===I.cFColor&&i[x].range===I.range&&i[x].value===I.value){i.splice(x,1);break}}),i.push.apply(i,e.oldCFModel.map(function(I){return Object.assign({},I)})),this.parent.notify(Wi,{cfModel:e.oldCFModel,isAction:!0}),e.sheetIdx!==this.parent.activeSheetIndex&&this.parent.notify(nu,{address:t.name+"!"+e.range});return}if(!(!i||!i.length)){var n,s,a,l,h,u,c,d,p,f=e.range&&(typeof e.range=="string"?J(e.range):e.range);f=f&&tt(f),e.oldCFModel=[],e.updatedCFModel=[];for(var v=[],m=[],y=[],S=0;S<i.length;S++){n=i[S],s=n.range.split(",");for(var b=0;b<s.length;b++){if(a=J(s[b]),e.range)if(f[0]<=a[0]&&f[1]<=a[1]&&f[2]>=a[2]&&f[3]>=a[3])s.splice(b,1),b--;else if(c=f[0]>=a[0]&&f[0]<=a[2],d=f[2]>=a[0]&&f[2]<=a[2],h=f[1]>=a[1]&&f[1]<=a[3],u=f[3]>=a[1]&&f[3]<=a[3],l=[],c&&d?((h||u||f[1]<a[1]&&f[3]>a[3])&&(f[0]-a[0]>0&&l.push(Be([a[0],a[1],f[0]-1,a[3]])),a[2]-f[2]>0&&l.push(Be([f[2]+1,a[1],a[2],a[3]]))),h&&f[1]!==a[1]&&l.push(Be([f[0],a[1],f[2],f[1]-1])),u&&f[3]!==a[3]&&l.push(Be([f[0],f[3]+1,f[2],a[3]]))):h&&u?((c||d||f[0]<a[0]&&f[2]>a[2])&&(f[1]-a[1]>0&&l.push(Be([a[0],a[1],a[2],f[1]-1])),a[3]-f[3]>0&&l.push(Be([a[0],f[3]+1,a[2],a[3]]))),c?f[0]!==a[0]&&l.push(Be([a[0],f[1],f[0]-1,f[3]])):d&&f[2]!==a[2]&&l.push(Be([f[2]+1,f[1],a[2],f[3]]))):(c||d)&&(h?(f[1]!==a[1]&&l.push(Be([a[0],a[1],a[2],f[1]-1])),f[0]-a[0]>0?l.push(Be([a[0],f[1],f[0]-1,a[3]])):a[2]-f[2]>0&&l.push(Be([f[2]+1,f[1],a[2],a[3]]))):u&&(f[3]!==a[3]&&l.push(Be([a[0],f[3]+1,a[2],a[3]])),f[0]-a[0]>0?l.push(Be([a[0],a[1],f[0]-1,f[3]])):a[2]-f[2]>0&&l.push(Be([f[2]+1,a[1],a[2],f[3]])))),l.length)s[b]=l.join(",");else continue;else f=a,s.splice(b,1),b--;e.sheetIdx===this.parent.activeSheetIndex&&this.parent.notify(Ex,{indexes:f.slice()})}if(p=s.join(","),p!==n.range){if(e.cfModel&&(e.cfModel.cFColor!==n.cFColor||e.cfModel.type!==n.type||e.cfModel.value!==n.value)){y.push(n);continue}m.push(n.range),p?(e.oldCFModel.push({type:n.type,cFColor:n.cFColor,format:n.format,range:n.range,value:n.value}),n.range=p,n.result&&(delete n.result,this.parent.notify(Wi,{cfModel:[n],isAction:!0})),e.updatedCFModel.push(n),v.push(n)):(e.oldCFModel.push(n),v.concat(i.splice(S,1)),S--)}}if(e.sheetIdx!==this.parent.activeSheetIndex?e.isUndoRedo&&!e.isFromUpdateAction&&this.parent.notify(nu,{address:t.name+"!"+e.range}):y.length&&this.parent.notify(Wi,{cfModel:y,isAction:!0}),(e.isAction||e.isClear)&&e.oldCFModel.length){var w={cFormats:v,oldRange:m,previousConditionalFormats:e.oldCFModel,sheetIdx:e.sheetIdx,selectedRange:e.range};e.updatedCFModel.length&&(w.conditionalFormats=e.updatedCFModel),e.isClear?e.cfClearActionArgs=w:r&&this.parent.notify("actionComplete",{eventArgs:w,action:"clearCF"})}}},o.prototype.getModuleName=function(){return"workbookConditionalFormatting"},o}(),AO=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.getFillInfo=function(e){for(var t=this.parent.serviceLocator.getService(jy),i="",r=!0,n="CopyCells",s=[],a=["Down","Up"].indexOf(e.direction)>-1,l=this.getRangeData({range:e.dataRange,sheetIdx:this.parent.activeSheetIndex}),h=l.join().replace(/,/g,"").length,u=this.isRange(e.dataRange)&&h?l.length:1;u--;)if(i=l[u]&&!g(l[u].value)?l[u].value:"",Me(i)||ut(i)||Me(i[i.length-1])){r=!1,n=this.parent.autoFillSettings.fillType;break}return(!h||r)&&(s.push(t.getConstant("FillSeries")),n=e.fillType==="FillSeries"?n:e.fillType),(!a||a&&e.dataRange[1]!==e.dataRange[3])&&s.push("Flash Fill"),{fillType:n,disableItems:s}},o.prototype.isRange=function(e){return e&&(e[0]!==e[2]||e[1]!==e[3])},o.prototype.autoFill=function(e){if(!(!e.dataRange||!e.fillRange||!e.direction||!this.parent.allowEditing||this.parent.getActiveSheet().isProtected&&e.isLockedCell)){var t=tt(J(e.dataRange)),i=tt(J(e.fillRange)),r={dataRange:t,fillRange:i,direction:e.direction,fillType:e.fillType||this.fillInfo.fillType,dataSheetIndex:Gs(this.parent,e.dataRange),fillSheetIndex:Gs(this.parent,e.fillRange),cells:e.cells};switch(this.fillInfo=this.getFillInfo({dataRange:t,fillRange:i,fillType:e.fillType,direction:e.direction}),this.fillInfo.fillType=e.isFillOptClick?e.fillType:this.fillInfo.fillType,e.fillType){case"FillSeries":case"FillWithoutFormatting":this.fillSeries(r);break;case"CopyCells":case"FillFormattingOnly":this.copyCells(r);break}}},o.prototype.fillSeries=function(e){var t,i,r,n,s,a,l,h,u,c,d,p,f,v,m,y,S,b,w,I,x,M={},D=0,A,L,T,k=Ee(e.dataSheetIndex)?this.parent.activeSheetIndex:e.dataSheetIndex,F=ke(this.parent,k),R,N;Ee(e.fillSheetIndex)?(R=this.parent.activeSheetIndex,N=!0):(R=e.fillSheetIndex,N=R===this.parent.activeSheetIndex);for(var P=ke(this.parent,R),O=e.dataRange[0],z=e.dataRange[1],H=e.dataRange[2],Q=e.dataRange[3],$=e.fillRange[0],U=e.fillRange[1],ie=e.fillRange[2],ne=e.fillRange[3],te=["Down","Up"].indexOf(e.direction)>-1,oe=["Up","Left"].indexOf(e.direction)>-1,ae=te?Q-z:H-O,ye=e.fillType==="FillSeries",De,ve,ue,Tt=F.conditionalFormats&&F.conditionalFormats.length&&[].slice.call(F.conditionalFormats),_e=[],lt=N&&this.applyWrapToOuterCells(P),We=e.fillType!=="FillWithoutFormatting"&&N&&te;D<=ae;){s=this.updateFillValues(te,O,z,H,Q,$,U,ie,ne,D),a=s.patternRange,l=s.fillRange,r=this.getPattern(a,{isReverseFill:oe,isVFill:te},k),h=this.getRangeData({range:a,sheetIdx:k}),te||(h=this.getRangeData({range:a,sheetIdx:k},!0));var ct=!1;h[0]&&h[0].formula&&h[0].formula.match(/=[A-Za-z]+\(([^:]+):([^:]+)\)/)&&(ct=!0),p=h.length;for(var Dt=0;Dt<p;Dt++)if(h[Dt]&&h[Dt].isReadOnly){this.parent.notify(tu,null);return}if(!r||!r.length)return;for(i=r.length,w=this.getSelectedRange(P,{rowIndex:l[0],colIndex:l[1]},{rowIndex:l[2],colIndex:l[3]}),I=w.length,oe&&(w=w.reverse(),r=r.reverse(),r=this.ensurePattern(r),h=h.reverse()),f=0;f<I;){switch(x=w[f],n=r[f%i],Me(n)&&(n=r[n]),m=f%p,n.type){case"number":case"date":if(n=n,n.isStartWithMonth&&p===1?(L=_s(n.regVal.a),T=new Date(L),L.setMonth(L.getMonth()+n.regVal.b*n.i),T.getDate()>28&&T.getDate()!==L.getDate()&&(T.setDate(1),T.setMonth(T.getMonth()+n.regVal.b*n.i),T.setDate(new Date(T.getFullYear(),T.getMonth()+1,0).getDate()),L=T),t=Ms(L).toString()):(t=this.round(n.regVal.a+n.regVal.b*n.i,5).toString(),n.val&&(c=typeof n.val[0]=="string"&&n.val[0].match(/^0+/),c&&(u=this.getNextFormattedValue(n.val[0],Number(t))))),n.dataVal){if(n.copy===void 0&&!c&&(n.copy=n.val.length>2,n.copy))for(var Xt=2;Xt<n.val.length&&(n.copy=Math.abs(this.round(n.regVal.a+n.regVal.b*Xt,5))!==n.val[Xt],!n.copy);Xt++);t=n.copy?h[m]&&!g(h[m].value)?h[m].value:"":n.start?Math.abs(Number(t))+n.dataVal:c?n.dataVal+u:n.dataVal+Math.abs(Number(t))}oe?n.i--:n.i++;break;case"string":var Lt=n.i%n.val.length;t=n.val[Lt],n.i++;break;case"formula":for(b=!1,t="=",v=0,y=n.val.length;v<y;)d=n.val[v],typeof d=="object"?(b=!0,S=this.round(d.a+d.b*n.i,5),S<1?(t+="#REF!",ct&&(v=y-1,t+=n.val[v])):t+=te?d.c+(d.b?S:"$"+S):(d.b?Pi(S):d.c.substring(0,d.c.search(/\d/))+"$"+Pi(S))+d.c.trim()):t+=d,v++;b&&oe?n.i--:n.i++;break;case"time":t=(n.regVal.a+n.regVal.b*n.i).toString(),Number(t)<0&&oe&&(t=(n.regVal.a+Math.ceil(Math.abs(n.i/24))+n.regVal.b*n.i).toString()),oe?n.i--:n.i++;break}if(A=G(x.rowIndex,x.colIndex,P,!1,!0),A&&A.isReadOnly){this.parent.notify(tu,null);return}if(ye?Object.assign(M,h[m],null,!0):(e.fillType==="FillWithoutFormatting"&&h[m]&&h[m].hyperlink?(M.hyperlink=h[m].hyperlink,M.style={textDecoration:"none",color:"inherit"}):M.style=A.style,M.format=A.format,M.wrap=A.wrap,M.rowSpan=A.rowSpan,M.colSpan=A.colSpan),h[m]&&h[m].validation){M.validation=Object.assign({},h[m].validation);var Bi=[x.rowIndex,x.colIndex,x.rowIndex,x.colIndex],zi=[e.dataRange[0],e.dataRange[1],e.dataRange[2],e.dataRange[3]],Ct=this.parent.sheets[this.parent.activeSheetIndex],Ei=Hn(Bi,zi,Ct,this.parent,{formula:M.validation.value1});M.validation.value1=Ei,M.validation.value2!==""&&(Ei=Hn(Bi,zi,Ct,this.parent,{formula:M.validation.value2}),M.validation.value2=Ei)}var ji=ut(t);ji&&(M.formula=t),(t!=="0"||t==="0"&&e.fillType!=="FillWithoutFormatting")&&(M.value=ji&&this.parent.calculationMode==="Manual"?h[m]?h[m].value:"0":t),g(M.notes)||delete M.notes,De={cell:M,rowIdx:x.rowIndex,colIdx:x.colIndex,valChange:!0,uiRefresh:N,pvtExtend:!0,skipFormatCheck:!0,fillType:e.fillType},N&&!st(P,x.rowIndex)&&!Ot(P,x.colIndex)&&(De.td=this.parent.getCell(x.rowIndex,x.colIndex),De.td&&(De.uiRefresh=!0)),ue=sr(this.parent,P,De,e.cells),ue||(N&&lt(De),Tt&&!ve&&(ve=De.isFormulaDependent,ve||kf(Tt,_e,x.rowIndex,x.colIndex,e.dataRange,e.fillRange,F)),We&&M.style&&gd(M.style)&&this.parent.notify(Dr,{rowIdx:x.rowIndex,colIdx:x.colIndex,style:M.style,lastCell:!0,isHeightCheckNeeded:!0,onActionUpdate:!0,manualUpdate:!0})),M={},f++}D++}(_e.length||ve)&&this.parent.notify(Wi,{cfModel:!ve&&_e,refreshAll:ve,isAction:!0,isEdit:!0})},o.prototype.copyCells=function(e){var t=0,i,r,n,s,a,l,h,u,c,d={},p,f=e.dataRange[0],v=e.dataRange[1],m=e.dataRange[2],y=e.dataRange[3],S=e.fillRange[0],b=e.fillRange[1],w=e.fillRange[2],I=e.fillRange[3],x=["Down","Up"].indexOf(e.direction)>-1,M=["Up","Left"].indexOf(e.direction)>-1,D=x?y-v:m-f,A=Ee(e.dataSheetIndex)?this.parent.activeSheetIndex:e.dataSheetIndex,L=ke(this.parent,A),T,k;Ee(e.fillSheetIndex)?(k=!0,T=this.parent.activeSheetIndex):(k=e.fillSheetIndex===this.parent.activeSheetIndex,T=e.fillSheetIndex);for(var F=ke(this.parent,T),R=e.fillType==="FillFormattingOnly",N,P,O,z=L.conditionalFormats&&L.conditionalFormats.length&&[].slice.call(L.conditionalFormats),H,Q=k&&this.applyWrapToOuterCells(F),$=[],U=k&&x;t<=D;){a=this.updateFillValues(x,f,v,m,y,S,b,w,I,t),n=a.patternRange,s=a.fillRange,l=this.getRangeData({range:n,sheetIdx:A}),h=l.length;for(var ie=0;ie<h;ie++)if(l[ie]&&l[ie].isReadOnly){this.parent.notify(tu,null);return}for(u=this.getSelectedRange(F,{rowIndex:s[0],colIndex:s[1]},{rowIndex:s[2],colIndex:s[3]}),c=u.length,i=0,M&&(u=u.reverse());i<c;){if(r=i%h,p=u[i],R&&(N=G(p.rowIndex,p.colIndex,F)),Object.assign(d,l[r],null,!0),R&&(d.value=N.value,d.formula=N.formula,g(d.notes)||delete d.notes,d.validation&&delete d.validation),d&&d.isReadOnly){this.parent.notify(tu,null);return}!g(d.notes)&&!g(d.isNoteEditable)&&(delete d.notes,delete d.isNoteEditable),O={cell:d,rowIdx:p.rowIndex,colIdx:p.colIndex,valChange:!0,pvtExtend:!0,fillType:e.fillType},k&&!st(F,p.rowIndex)&&!Ot(F,p.colIndex)&&(O.td=this.parent.getCell(p.rowIndex,p.colIndex),O.uiRefresh=!!O.td),H=sr(this.parent,F,O,e.cells),H||(k&&Q(O),z&&!P&&(P=O.isFormulaDependent,P||kf(z,$,p.rowIndex,p.colIndex,e.dataRange,e.fillRange,L)),U&&d.style&&gd(d.style)&&this.parent.notify(Dr,{rowIdx:p.rowIndex,colIdx:p.colIndex,style:d.style,lastCell:!0,isHeightCheckNeeded:!0,onActionUpdate:!0,manualUpdate:!0})),d={},i++}t++}($.length||P)&&this.parent.notify(Wi,{cfModel:!P&&$,refreshAll:P,isAction:!0,isEdit:!0})},o.prototype.applyWrapToOuterCells=function(e){var t=this,i,r,n=this.parent.frozenRowCount(e),s=this.parent.frozenColCount(e),a=this.parent.viewport;a&&(i=a.topIndex+n,r=a.leftIndex+s);var l;return function(h){!h.td&&G(h.rowIdx,h.colIdx,e,!1,!0).wrap&&(h.rowIdx>=n&&h.rowIdx<i||h.colIdx>=s&&h.colIdx<r)&&(l||(l={range:null,wrap:!0,sheet:e,initial:!0,outsideViewport:!0}),l.range=[h.rowIdx,h.colIdx,h.rowIdx,h.colIdx],t.parent.notify(Xa,l))}},o.prototype.updateFillValues=function(e,t,i,r,n,s,a,l,h,u){var c,d,p,f;e?(c={rowIndex:t,colIndex:i+u},d={rowIndex:r,colIndex:i+u},p={rowIndex:s,colIndex:a+u},f={rowIndex:l,colIndex:a+u}):(c={rowIndex:t+u,colIndex:i},d={rowIndex:t+u,colIndex:n},p={rowIndex:s+u,colIndex:a},f={rowIndex:s+u,colIndex:h});var v=[c.rowIndex,c.colIndex,d.rowIndex,d.colIndex],m=[p.rowIndex,p.colIndex,f.rowIndex,f.colIndex];return{patternRange:v,fillRange:m}},o.prototype.getDataPattern=function(e,t){var i,r,n,s=0,a={val:null,type:null},l=[],h=this.getRangeData({range:e,sheetIdx:Ee(t)?this.parent.activeSheetIndex:t}),u=h.length,c,d;if(u){for(var p=void 0,f=void 0,v=void 0,m=void 0,y=function(w){return!c&&w&&w[w.length-1]==="-"?w.slice(0,w.length-1):w};s<u;){if(d=!1,h[s])if(h[s].formula&&ut(h[s].formula))i=h[s].formula,n="formula";else{i=g(h[s].value)?"":h[s].value;var S={};if(v=h[s].format,m=Me(i),v&&qs(v,!0,S)){if(n=S.type,i&&!m){var b={value:i,updatedVal:i,cell:h[s]};this.parent.notify(Jr,b),b.isDate||b.isTime?h[s].value=i=b.updatedVal:n="string"}d=n==="date"&&v.toLowerCase().startsWith("mmm")}else n=m?"number":"string"}else i="",n="string";if(f="",n==="string"){if(c=!1,Me(i[0])){p=0;do p++;while(Me(i[p]));i[p]===" "&&(c=!0,n="number",f=i.slice(p,i.length),i=Number(i.slice(0,p)))}if(i=i,!c&&Me(i[i.length-1])){p=1;do p++;while(Me(i[i.length-p]));n="number",p-=1,f=i.slice(0,i.length-p),r=i.slice(i.length-p,i.length),i=r.match(/^0+/)?r:Number(r),a.dataVal&&a.dataVal!==f&&a.dataVal===y(f)&&(f=a.dataVal)}}s===0?(a={val:[i],type:n,isStartWithMonth:d},f&&(a.dataVal=f,a.start=c)):n===a.type&&(!a.dataVal||y(a.dataVal)===y(f))?a.val.push(i):(l.push(a),a={val:[i],type:n},f&&(a.dataVal=f,a.start=c)),s++}return l.push(a),l}else return[{val:null,type:null}]},o.prototype.getPredictionValue=function(e,t){for(var i=0,r=0,n=0,s=0,a=0,l=0,h=0,u=e.length;i<u;)r=r+i,n=n+Number(e[i]),s=s+i*Number(e[i]),a=a+i*i,i++;return t?(l=(n*a-r*s)/(u*a-r*r),h=(u*s-r*n)/(u*a-r*r)):(l=this.round((n*a-r*s)/(u*a-r*r),5),h=this.round((u*s-r*n)/(u*a-r*r),5)),{a:l,b:h}},o.prototype.getPattern=function(e,t,i){var r,n,s,a,l,h,u=0,c=[],d=this.getDataPattern(e,i),p=d.length,f;if(d){for(;u<p;){switch(f=d[u],f.type){case"number":case"date":if(n=c.length,h=f.val.length,l=t.isReverseFill?-1:h,h===1){var v=parseFloat(f.val[0])+1;typeof f.val[0]=="string"&&f.val[0].match(/^0+/)?f.val.push(this.getNextFormattedValue(f.val[0],v)):f.val.push(v)}for(a=this.getPredictionValue(f.dataVal?f.val.slice(0,2):f.val),s={regVal:a,type:f.type,i:l,isStartWithMonth:f.isStartWithMonth},f.dataVal&&(s.dataVal=f.dataVal,s.val=f.val,s.start=f.start),c.push(s),r=1;r<h;)c.push(n),r++;break;case"string":for(n=c.length,s={val:f.val,type:f.type,i:0},c.push(s),r=1,h=f.val.length;r<h;)c.push(n),r++;break;case"formula":if(h=f.val.length,f=this.getFormulaPattern(f.val,t),l=t.isReverseFill?-1:h,f.isInPattern)for(n=c.length,s={val:f.val,type:"formula",i:l},c.push(s),r=1;r<h;)c.push(n),r++;else for(r=0,l=t.isReverseFill?-1:1;r<h;)c.push({val:f.val[r],type:"formula",i:l}),r++;break;case"time":if(n=c.length,h=f.val.length,l=t.isReverseFill?-1:h,h===1){var m=_s(f.val[0]),y=Number(f.val[0]),S=y>=0&&y<1,b=Ms(new Date(m.getTime()+60*6e4),!0,S);f.val.push(b)}for(a=this.getPredictionValue(f.val,!0),s={regVal:a,type:f.type,i:l},c.push(s),r=1;r<h;)c.push(n),r++;break}u++}return c}else return[{regVal:null}]},o.prototype.getNextFormattedValue=function(e,t){var i=new Et().formatNumber(Math.abs(t),{minimumIntegerDigits:e.length,useGrouping:!1}),r=ca({value:i},this.parent.locale);return r.isNumber?r.value:i},o.prototype.isCellReference=function(e){return/^[a-z]{1,3}\d{1,7}$/gi.test(e)?"relative":/^\$[a-z]{1,3}\$\d{1,7}$/gi.test(e)?"absolute":/^((\$[a-z]{1,3})\d{1,7}|[a-z]{1,3}(\$\d{1,7}))$/gi.test(e)?"mixed":!1},o.prototype.round=function(e,t){return+(Math.round(parseFloat(e+"e"+t))+"e-"+t)||Number(e)},o.prototype.getRangeData=function(e,t){for(var i=[],r=Ee(e.sheetIdx)?this.parent.getActiveSheet():ke(this.parent,e.sheetIdx),n=e.range[0],s=e.range[1],a=e.range[2],l=e.range[3],h=s,u,c;n<=a;){if(st(r,n)){n++;continue}for(s=h;s<=l;){if(Ot(r,s)){s++;continue}if(u=G(n,s,r),t&&(u=Object.assign({},G(n,s,r)),c=Object.assign({},Rt(r,s)),u&&!u.validation&&c&&c.validation)){u.validation=Object.assign({},Rt(r,s).validation);var d=[n,s,n,s],p=[0,s,0,s],f=Hn(d,p,r,this.parent,{formula:c.validation.value1});u.validation.value1=f,u.validation.value2!==""&&(f=Hn(d,p,r,this.parent,{formula:c.validation.value2}),u.validation.value2=f)}i.push(u),s++}n++}return i},o.prototype.getFormulaPattern=function(e,t){for(var i,r,n,s=[],a=0,l=e.length,h,u={};a<l;)u.formula=e[a],this.parent.notify(Ry,u),s.push(u.formulaArr),a++;var c=this.isInPattern(s,t.isVFill);if(c){for(n=s[0],a=n.length;a--;)r=n[a],h=this.isCellReference(r),h&&h!=="absolute"&&(n[a]=this.getCellRefPrediction(r,t,null,h));return{isInPattern:c,val:n}}else{for(a=0;a<l;){for(n=s[a],i=n.length;i--;)r=n[i],h=this.isCellReference(r.trim()),h&&h!=="absolute"&&(s[a][i]=this.getCellRefPrediction(r,t,l,h));a++}return{isInPattern:c,val:s}}},o.prototype.generateColCount=function(e){for(var t=0,i=0;i<e.length;i++){var r=e.charCodeAt(i)-64;t=t*26+r}return t},o.prototype.getCellRefPrediction=function(e,t,i,r){e=e.toUpperCase();var n="",s=new RegExp("[a-z$]","gi"),a=new RegExp("[0-9$]","g"),l=t.isVFill?e.replace(a,n):e.replace(s,n),h=t.isVFill?Number(e.replace(s,n)):this.generateColCount(e.replace(a,n).trim()),u=null,c=[h],d=e[0]==="$";if(!d&&e.includes("$")&&e.trim()[0]==="$"){for(var p=1;p<e.length;p++)if(e[p]==="$"){u=p,d=!0;break}}return i&&i!==1?c.push(h+i):c.push(h+1),h=this.getPredictionValue(c),r&&r==="mixed"&&(d===t.isVFill?u?l=l.substring(0,u)+"$"+l.substring(u):l="$"+l:h.b=0),h.c=l,h},o.prototype.isInPattern=function(e,t){var i,r,n,s,a,l,h,u,c="",d=0,p=1,f=e.length,v=new RegExp("[0-9$]","g"),m=new RegExp("[a-z$]","gi");if(f===1)return!1;for(;p<f;){if(i=e[d],n=e[p],r=i.length,s=n.length,r!==s)return!1;for(;r--;)if(a=i[r],l=n[r],this.isCellReference(a)===this.isCellReference(l)){if(t?(h=Number(a.replace(m,c)),u=Number(l.replace(m,c))):(h=this.generateColCount(a.replace(v,c)),u=this.generateColCount(l.replace(v,c))),h!==u-1)return!1}else if(a!==l)return!1;d++,p++}return!0},o.prototype.ensurePattern=function(e){for(var t,i=-1,r=e.length;r--;)t=e[r],typeof t=="object"?(i=r,t.type==="string"&&(t.val=t.val.reverse())):e[r]=i;return e},o.prototype.getSelectedRange=function(e,t,i){var r,n,s,a=[],l=tt([t.rowIndex,t.colIndex,i.rowIndex,i.colIndex]);r=l[0];for(var h=l[2];r<=h;){if(Jn(e,r)){r++;continue}for(n=l[1],s=l[3];n<=s;)a.push({rowIndex:r,colIndex:n}),n++;r++}return a},o.prototype.getFillType=function(e){return e.fillType=this.fillInfo.fillType,e.disableItems=this.fillInfo.disableItems,e},o.prototype.addEventListener=function(){this.parent.on(cd,this.autoFill,this),this.parent.on(Tx,this.getFillType,this)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(cd,this.autoFill),this.parent.off(Tx,this.getFillType))},o.prototype.getModuleName=function(){return"workbookautofill"},o}(),TO=function(){function o(){this.services={}}return o.prototype.getService=function(e){if(g(this.services[""+e]))throw"The service "+e+" is not registered";return this.services[""+e]},o.prototype.register=function(e,t){g(this.services[""+e])&&(this.services[""+e]=t)},o}(),sq=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),_I=function(){return _I=Object.assign||function(o){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r])}return o},_I.apply(this,arguments)},Ft=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},aq=function(o){sq(e,o);function e(i){var r=o.call(this,i)||this;return r.isEdit=!1,r.sheetNameCount=1,r.dataValidationRange="",r.isOpen=!1,r.chartColl=[],r.isPrintingProcessing=!1,r.currentPrintSheetIndex=0,r.customFormulaCollection=new Map,t.Inject(JI,cO,uO,fO,bO,SO,pO,gO,CO,vO,wO,IO,xO,MO,DO,EO,mO,yO,AO),r.commonCellStyle={},i&&i.cellStyle&&(r.commonCellStyle=i.cellStyle),r.getModuleName()==="workbook"&&(r.serviceLocator=new TO,r.initWorkbookServices(),r.dataBind(),r.initEmptySheet()),r}t=e,e.prototype.preRender=function(){Object.keys(this.commonCellStyle).length||(this.commonCellStyle=ZI(this.cellStyle,!0)),this.getModuleName()==="spreadsheet"&&!this.refreshing&&this.initEmptySheet()},e.prototype.initWorkbookServices=function(){this.serviceLocator.register(jy,new Li(this.getModuleName(),B6,this.locale))},e.prototype.render=function(){},e.prototype.requiredModules=function(){return tO(this)},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.cellFormat=function(i,r){var n=this.getActiveSheet();n&&(!n.isProtected||n.protectSettings.formatCells)&&(r=r||n.selectedRange,this.notify(rr,{style:i,range:r,refreshRibbon:r.indexOf(n.activeCell)>-1}))},e.prototype.lockCells=function(i,r){var n=this.getActiveSheet();i=i||n.selectedRange,this.notify(Iy,{range:i,isLocked:r,triggerEvent:!0})},e.prototype.getCellStyleValue=function(i,r){var n=this,s=G(r[0],r[1],this.getActiveSheet()),a={};return i.forEach(function(l){a[""+l]=n.cellStyle[""+l],s&&s.style&&s.style[""+l]&&(a[""+l]=s.style[""+l])}),a},e.prototype.numberFormat=function(i,r){this.notify(wf,{format:i,range:r}),this.notify(dd,{action:"addToCustomFormats",format:i})},e.prototype.createSheet=function(i,r){i===void 0&&(i=this.sheets.length),r===void 0&&(r=[{}]);var n;(n=this.sheets).splice.apply(n,[i,0].concat(r)),cf(this,r),this.notify(xf,{sheetIndex:i||0,sheets:r}),this.notify(xt,{action:"registerSheet",sheetIndex:i||0,sheetCount:i+r.length})},e.prototype.removeSheet=function(i){this.sheets.splice(i,1)},e.prototype.destroy=function(){this.notify(S6,null),o.prototype.destroy.call(this)},e.prototype.onPropertyChanged=function(i,r){for(var n=0,s=Object.keys(i);n<s.length;n++){var a=s[n];switch(a){case"cellStyle":ht(this.commonCellStyle,i.cellStyle);break;case"sheets":i.sheets===this.sheets?(this.notify(xt,{action:"unRegisterSheet",propertyChange:!0}),this.sheetNameCount=1,this.notify(ma,{}),cf(this),this.notify(xf,null),this.notify(xt,{action:"registerSheet"})):cf(this);break;case"listSeparator":this.notify(xt,{action:"setArgumentSeparator"});break}}},e.prototype.appendTo=function(i){o.prototype.appendTo.call(this,i)},e.prototype.hideRow=function(i,r,n){r===void 0&&(r=i),n===void 0&&(n=!0);for(var s=this.getActiveSheet(),a=i;a<=r;a++)hs(s,a,{hidden:n})},e.prototype.hideColumn=function(i,r,n){r===void 0&&(r=i),n===void 0&&(n=!0);for(var s=this.getActiveSheet(),a=i;a<=r;a++)ch(s,a,{hidden:n})},e.prototype.setBorder=function(i,r,n,s){this.notify(rr,{style:i,borderType:n,range:r||this.getActiveSheet().selectedRange,isUndoRedo:s})},e.prototype.insertRow=function(i,r,n){this.notify(ya,{model:this.getSheetModel(n),start:i,end:r,modelType:"Row",insertType:"below"})},e.prototype.insertColumn=function(i,r,n){this.notify(ya,{model:this.getSheetModel(n),start:i,end:r,modelType:"Column",insertType:"after"})},e.prototype.insertSheet=function(i,r){this.isProtected||this.notify(ya,{model:this,start:i,end:r,modelType:"Sheet"})},e.prototype.delete=function(i,r,n,s){if(!this.isProtected){i=i||0;var a;if(r=g(r)?i:r,!n||n==="Sheet"){if(a=this,Math.abs(r-i)>=this.sheets.length)return}else if(a=this.getSheetModel(s),!a)return;this.notify(Mf,{model:a,start:i,end:r,modelType:n||"Sheet"})}},e.prototype.moveSheet=function(i,r){this.isProtected||_y(this,i,r)},e.prototype.duplicateSheet=function(i){this.isProtected||KI(this,i)},e.prototype.getSheetModel=function(i){if(g(i))return this.getActiveSheet();var r=typeof i=="string"?yt(this,i):i;return g(r)||r>=this.sheets.length?null:this.sheets[r]},e.prototype.merge=function(i,r){var n,s;i?(n=this.isPrintingProcessing?this.currentPrintSheetIndex:Gs(this,i),s=ke(this,n)):(s=this.getActiveSheet(),i=s.selectedRange,n=this.activeSheetIndex),this.notify(Mn,{merge:!0,range:i,type:r||"All",sheetIndex:n,refreshRibbon:i.indexOf(s.activeCell)>-1,preventRefresh:this.activeSheetIndex!==n})},e.prototype.unMerge=function(i){var r,n;i?(r=Gs(this,i),n=ke(this,r)):(n=this.getActiveSheet(),i=n.selectedRange,r=this.activeSheetIndex),this.notify(Mn,{merge:!1,range:i,sheetIndex:r,type:"All",refreshRibbon:i.indexOf(n.activeCell)>-1,preventRefresh:this.activeSheetIndex!==r})},e.prototype.computeExpression=function(i){var r={action:"computeExpression",formula:i,isFromComputeExpression:!0};return this.notify(xt,r),r.calcValue},e.prototype.initEmptySheet=function(){this.sheets.length?cf(this):this.createSheet()},e.prototype.getActiveSheet=function(){return this.sheets[this.activeSheetIndex]},e.prototype.skipHiddenSheets=function(i,r,n){return n===void 0&&(n=0),this.sheets[i]&&this.sheets[i].state!=="Visible"&&(r===void 0&&(r=i),i&&i+1===this.sheets.length?i=r-1:i=i<r?--i:++i,i=this.skipHiddenSheets(i,r,++n)),n===this.sheets.length?(this.setSheetPropertyOnMute(this.sheets[0],"state","Visible"),0):i},e.prototype.setUsedRange=function(i,r,n,s,a){if(n===void 0&&(n=this.getActiveSheet()),a){this.setSheetPropertyOnMute(n,"usedRange",{rowIndex:i,colIndex:r});return}i>n.usedRange.rowIndex&&(this.setSheetPropertyOnMute(n,"usedRange",{rowIndex:i,colIndex:n.usedRange.colIndex}),n===this.getActiveSheet()&&!s&&this.notify(sd,{index:i,update:"row"})),r>n.usedRange.colIndex&&(this.setSheetPropertyOnMute(n,"usedRange",{rowIndex:n.usedRange.rowIndex,colIndex:r}),n===this.getActiveSheet()&&!s&&this.notify(sd,{index:r,update:"col"}))},e.prototype.getData=function(i){return fa(this,i)},e.prototype.getModuleName=function(){return"workbook"},e.prototype.goTo=function(i){},e.prototype.getValueRowCol=function(i,r,n,s,a,l,h){var u=cn(this,i),c=ke(this,u),d=G(r-1,n-1,c);if(s&&s.includes("!")&&!d&&c.ranges&&c.ranges.length){var p;if(this.formulaRefCell&&this.formulaRefCell===s)return d&&d.value;if(c.ranges.forEach(function(v){if(!v.info||!v.info.loadedRange||!v.info.loadedRange.length){p=!0;return}}),p){if(this.formulaRefCell=s,u=cn(this,Number(s.substring(s.lastIndexOf(",")+1,s.length))),g(u))return d&&d.value;s=s.substring(s.lastIndexOf("!")+1,s.lastIndexOf(",")),fa(this,c.name+"!A1:"+et(r-1,n-1),null,null,null,null,s,u)}}else d&&d.formula&&(a||g(d.value))&&!l&&this.calculationMode==="Automatic"&&this.notify(pu,{cell:d,rowIdx:r-1,colIdx:n-1,sheetIndex:u,formulaRefresh:!0});if(d&&!Me(d.value)&&!this.isEdit){var f={formattedText:d.value,value:d.value,format:d.format,cell:d,skipFormatCheck:!1};this.notify(en,f),d=f.cell}return h&&d&&d.formula&&d.formula.includes("SUBTOTAL(")?d.formula:d&&d.value},e.prototype.setValueRowCol=function(i,r,n,s,a,l){this.notify(fu,{action:"updateCellValue",address:[n-1,s-1],value:r,sheetIndex:cn(this,i),isValueOnly:!0,formula:a,isRandomFormula:l})},e.prototype.open=function(i){this.notify(hy,i)},e.prototype.openFromJson=function(i,r){this.isOpen=!0;var n=typeof i.file=="object"?JSON.stringify(i.file):i.file;if(n!==""&&r){var s=[];if(r.onlyValues)s.push.apply(s,["style","formula","format","conditionalFormats","validation","hyperlink","wrap","chart","image","notes"]);else{var a={style:r.ignoreStyle,formula:r.ignoreFormula,format:r.ignoreFormat,conditionalFormats:r.ignoreConditionalFormat,validation:r.ignoreValidation,wrap:r.ignoreWrap,chart:r.ignoreChart,image:r.ignoreImage,notes:r.ignoreNote};r.ignoreFreezePane&&s.push.apply(s,["frozenColumns","frozenRows"]);for(var l in a)a[l]&&s.push(l)}n=JSON.stringify(JSON.parse(n),function(h,u){if(!(s.indexOf(h)>-1))return u})}this.notify(hy,{jsonObject:n,triggerEvent:i.triggerEvent})},e.prototype.save=function(i,r){if(i===void 0&&(i={}),this.allowSave){var n={url:this.saveUrl,fileName:i.fileName||"Sample",saveType:"Xlsx"},s=_I({},n,i,{customParams:{},isFullPost:!0,needBlobData:!1,cancel:!1,autoDetectFormat:!1,pdfLayoutSettings:{fitSheetOnOnePage:!1,orientation:"Portrait"}});this.trigger("beforeSave",s),this.notify(ai,{eventArgs:s,action:"beforeSave"}),s.cancel||this.notify(bf,{saveSettings:s,isFullPost:s.isFullPost,needBlobData:s.needBlobData,customParams:s.customParams,pdfLayoutSettings:s.pdfLayoutSettings,jsonConfig:r})}},e.prototype.saveAsJson=function(i){var r=this;return new Promise(function(n){r.on(Sx,function(s){s.cancel=!0,r.off(Sx),n({jsonObject:{Workbook:s.jsonObject}}),r.notify(Cf,s)}),r.save({},i)})},e.prototype.addHyperlink=function(i,r){var n={hyperlink:i,cell:r};this.notify(od,n)},e.prototype.findHandler=function(i){this.notify(xx,i)},e.prototype.replaceHandler=function(i){i.replaceBy==="replace"?this.notify(Df,i):this.notify(ld,i)},e.prototype.protectSheet=function(i,r,n){g(i)?i=this.activeSheetIndex:typeof i=="string"&&(i=yt(this,i));var s=this.sheets[i];s&&(this.setSheetPropertyOnMute(s,"isProtected",!0),this.setSheetPropertyOnMute(s,"password",n||""),this.setSheetPropertyOnMute(s,"protectSettings",r||{}),this.notify($c,{protectSettings:s.protectSettings,password:s.password,sheetIndex:i}))},e.prototype.unprotectSheet=function(i){if(g(i)?i=this.activeSheetIndex:typeof i=="string"&&(i=yt(this,i)),!!this.sheets[i]){var r={sheet:i};this.notify(nO,r)}},e.prototype.sort=function(i,r,n){if(!this.allowSorting)return Promise.reject();var s={range:r||this.getActiveSheet().selectedRange,sortOptions:i||{sortDescriptors:{}},cancel:!1},a=new Promise(function(h){h(function(){}())}),l={args:s,promise:a,previousSort:n};return this.notify(If,l),l.promise},e.prototype.addDataValidation=function(i,r){g(i.value1)||(i.type==="List"?i.value1.length>256&&(i.value1=i.value1.substring(0,255)):(i.value1=Zc([i.value1],this)[0],i.value2&&(i.value2=Zc([i.value2],this)[0])),this.notify(To,{rules:i,range:r||Px(this.getActiveSheet())}))},e.prototype.removeDataValidation=function(i){this.notify(To,{range:i||Px(this.getActiveSheet()),isRemoveValidation:!0})},e.prototype.addInvalidHighlight=function(i){this.notify(by,{range:i})},e.prototype.removeInvalidHighlight=function(i){this.notify(Cy,{range:i})},e.prototype.isValidCell=function(i){var r,n,s;if(i){var a=px(this,i);n=a.sheetIndex,s=a.indices,r=ke(this,n)}else r=this.getActiveSheet(),s=Se(r.activeCell),n=this.activeSheetIndex;var l=G(s[0],s[1],r,!1,!0);if(l.validation||Ds(r.columns[s[1]],s[0],s[1])){var h=l.value?l.value:"",u={value:h,range:s,sheetIdx:n,td:null,isValid:!0};return this.notify(yy,u),u.isValid}else return!0},e.prototype.conditionalFormat=function(i){var r=this;if(i.range?this.listSeparator!==","&&i.range.includes(this.listSeparator)&&(i.range=i.range.split(this.listSeparator).join(",")):i.range=this.getActiveSheet().selectedRange,i.value){var n=void 0;if(i.type==="Between")if(this.listSeparator!==","&&i.value.includes(this.listSeparator)){var s=i.value.split('"').filter(function(a){return a.trim()&&a.trim()!==r.listSeparator});n=s.length>1?s:i.value.split(this.listSeparator)}else{var s=i.value.split('"').filter(function(l){return l.trim()&&l.trim()!==","});n=s.length>1?s:i.value.split(",")}else n=[i.value];Zc(n,this),i.value=n.join(",")}this.notify(hd,{cfModel:i})},e.prototype.clearConditionalFormat=function(i){var r={};if(!i||!i.includes("!"))r.range=i||this.getActiveSheet().selectedRange,r.sheetIdx=this.activeSheetIndex;else{var n=i.lastIndexOf("!");r.range=i.substring(n+1),r.sheetIdx=yt(this,i.substring(0,n))}this.notify(qa,r)},e.prototype.updateCell=function(i,r,n){g(n)&&(n=!0),this.updateCellDetails(i,r,void 0,void 0,n)},e.prototype.updateCellDetails=function(i,r,n,s,a,l,h){var u,c;if(r||(r=this.getActiveSheet().activeCell),r.includes("!")){if(u=Qi(r),c=yt(this,r.substring(0,r.lastIndexOf("!"))),c===void 0)return}else u=J(r),c=this.activeSheetIndex;var d=ke(this,c);if(l&&!(d.rowCount>u[0]&&d.rowCount>u[2]&&d.colCount>u[1]&&d.colCount>u[3])){this.notify(rb,null);return}sr(this,d,{cell:i,rowIdx:u[0],colIdx:u[1],preventEvt:!0});var p=h?i.formula||(g(i.value)?null:i.value):g(i.value)?i.formula||null:i.value,f=p!==null,v=G(u[0],u[1],d,!1,!0);if(n&&n.format&&s&&(v.format=n.format),f?(delete v.formattedText,this.notify(fu,{action:"updateCellValue",address:u,value:p,sheetIndex:c,cellInformation:n,isRedo:s,isDependentUpdate:a}),this.isEdit&&v.value==="#CIRCULARREF!"&&(v.value="0")):!g(i.format)&&v.formattedText&&delete v.formattedText,c===this.activeSheetIndex){var m={sheet:d,cell:v,rowIdx:u[0],colIdx:u[1]};(v.rowSpan>1||v.colSpan>1)&&xb(m);var y=!st(d,m.rowIdx)&&!Ot(d,m.colIdx)&&this.getCell(m.rowIdx,m.colIdx);y&&this.serviceLocator.getService("cell").refresh(m.rowIdx,m.colIdx,!0,y,f,f);var S=Se(d.activeCell);u[0]===S[0]&&u[1]===S[1]&&(this.notify(Es,null),this.notify(Ua,{action:"refreshFormulabar",cell:v}),y&&i.validation&&(m.validation=v.validation,m.td=y,m.isRefresh=!0,this.notify(pd,m)))}},e.prototype.getRowData=function(i,r){g(i)&&(i=0),g(r)&&(r=this.activeSheetIndex);var n={sheetIdx:r,startIndex:i,modelType:"Row",isDataRequest:!0};return this.notify(ry,n),n.data},e.prototype.updateRange=function(i,r){r===void 0&&(r=this.activeSheetIndex);var n=ke(this,r);n&&(i.startCell||(i.startCell="A1"),i.showFieldAsHeader===void 0&&(i.showFieldAsHeader=!0),i.template&&!i.address&&(i.address=i.startCell),n.ranges.push(i),this.setSheetPropertyOnMute(n,"ranges",n.ranges),i.dataSource&&this.notify(ly,{sheetIdx:r,rangeIdx:n.ranges.length-1,changedData:i.dataSource}))},e.prototype.wrap=function(i,r){r===void 0&&(r=!0),vd(i,r,this,null,!0)},e.prototype.addDefinedName=function(i){var r={action:"addDefinedName",isAdded:!1,definedName:i};return this.notify(xt,r),r.isAdded},e.prototype.removeDefinedName=function(i,r){r===void 0&&(r="");var n={action:"removeDefinedName",isRemoved:!1,definedName:i,scope:r};return this.notify(xt,n),n.isRemoved},e.prototype.insertImage=function(i,r){this.notify(Dy,{options:i,range:r||this.getActiveSheet().selectedRange})},e.prototype.autoFill=function(i,r,n,s){var a={dataRange:r||this.getActiveSheet().selectedRange,fillRange:i,direction:n||"Down",fillType:s||"FillSeries"};this.notify(cd,a)},e.prototype.insertChart=function(i){this.notify(oh,{chart:i})},e.prototype.deleteChart=function(i){this.notify(Eu,{id:i})},e.prototype.filter=function(i,r){if(!this.allowFiltering)return Promise.reject();var n={range:r||this.getActiveSheet().selectedRange,filterOptions:i,cancel:!1},s=new Promise(function(l){l(function(){}())}),a={args:n,promise:s};return this.notify(my,a),a.promise},e.prototype.addCustomFunction=function(i,r,n){r=r||(typeof i=="string"?i:i.name.replace("bound ",""));var s={action:"addCustomFunction",functionHandler:i,functionName:r,formulaDescription:n};this.notify(xt,s)},e.prototype.clear=function(i){this.notify(ud,i)},e.prototype.getDisplayText=function(i){if(!i)return"";if(i.format&&!g(i.value)){var r={formattedText:i.value,value:i.value,format:i.format,cell:i,skipFormatCheck:!0};return this.notify(en,r),r.formattedText}else return!i.value&&i.hyperlink?typeof i.hyperlink=="string"?i.hyperlink:i.hyperlink.address:i.value||typeof i.value=="number"?i.value.toString():""},e.prototype.freezePanes=function(i,r,n){i===void 0&&(i=1),r===void 0&&(r=1);var s=this.getSheetModel(n);!this.allowFreezePane||s.frozenRows===i&&s.frozenColumns===r||(this.setSheetPropertyOnMute(s,"frozenRows",i),this.setSheetPropertyOnMute(s,"frozenColumns",r),this.updateTopLeftCell(),s.id===this.getActiveSheet().id&&this.getModuleName()==="spreadsheet"&&this.renderModule.refreshSheet())},e.prototype.Unfreeze=function(i){this.freezePanes(0,0,i)},e.prototype.unfreezePanes=function(i){this.freezePanes(0,0,i)},e.prototype.calculateNow=function(i,r){var n;i==="Workbook"&&this.calculationMode==="Manual"&&(i="CalculateWorkbook",this.setProperties({calculationMode:"Automatic"},!0)),i==="Workbook"||i==="CalculateWorkbook"?n=this.sheets:(typeof r=="string"?r=yt(this,r):r=g(r)?this.activeSheetIndex:r,n=[ke(this,r)]);var s={action:"calculateNow",scope:i,sheets:n,promise:new Promise(function(a){a(function(){}())})};return this.notify(xt,s),s.promise},e.prototype.updateTopLeftCell=function(i,r,n,s){s||(s=this.getActiveSheet());var a=Se(s.topLeftCell);s.frozenRows||s.frozenColumns?((g(i)||i<0)&&(i=s.frozenRows?0:a[0]),(g(r)||r<0)&&(r=s.frozenColumns?0:a[1]),i+=this.frozenRowCount(s),r+=this.frozenColCount(s),n&&(n==="row"?i=Se(s.paneTopLeftCell)[0]:r=Se(s.paneTopLeftCell)[1]),this.setSheetPropertyOnMute(s,"paneTopLeftCell",et(i,r)),s.frozenRows&&(i=a[0]),s.frozenColumns&&(r=a[1])):(g(i)&&(i=a[0]),g(r)&&(r=a[1]),this.setSheetPropertyOnMute(s,"paneTopLeftCell",et(i,r))),this.setSheetPropertyOnMute(s,"topLeftCell",et(i,r))},e.prototype.getAddressInfo=function(i){return px(this,i)},e.prototype.setSheetPropertyOnMute=function(i,r,n){this.isProtectedOnChange=!0,i[""+r]=n,this.isProtectedOnChange=!1},e.prototype.frozenRowCount=function(i){return i.frozenRows?i.topLeftCell==="A1"?i.frozenRows:Se(i.topLeftCell)[0]+i.frozenRows:0},e.prototype.frozenColCount=function(i){return i.frozenColumns?i.topLeftCell==="A1"?i.frozenColumns:Se(i.topLeftCell)[1]+i.frozenColumns:0},e.prototype.updateRangeOnInsertDelete=function(i,r,n,s,a,l,h){var u,c=!1;if(i.isInsert)if(u=i.endIndex-i.startIndex+1,i.modelType==="Row")if(i.forceUpdate)r[0]+=1,r[2]+=1,c=!0;else{var d=!l&&h&&r[2]===i.startIndex-1&&s===i.startIndex&&r[1]===r[3];i.startIndex<=r[0]&&(r[0]+=u,c=!0),(i.startIndex<=r[2]||n&&i.startIndex===r[2]+1&&d)&&(r[2]+=u,c=!0)}else if(i.forceUpdate)r[1]+=1,r[3]+=1,c=!0;else{var d=!l&&h&&r[3]===i.startIndex-1&&a===i.startIndex&&r[0]===r[2];i.startIndex<=r[1]&&(r[1]+=u,c=!0),(i.startIndex<=r[3]||n&&i.startIndex===r[3]+1&&d)&&(r[3]+=u,c=!0)}else i.modelType==="Row"?(u=r[0]-i.startIndex,u>0&&(r[0]>i.endIndex?(u=i.endIndex-i.startIndex+1,u>0&&(r[0]-=u,c=!0)):(r[0]-=u,c=!0)),i.startIndex<=r[2]&&(i.endIndex<=r[2]?r[2]-=i.endIndex-i.startIndex+1:r[2]-=r[2]-i.startIndex+1,c=!0)):(u=r[1]-i.startIndex,u>0&&(r[1]>i.endIndex?(u=i.endIndex-i.startIndex+1,u>0&&(r[1]-=u,c=!0)):(r[1]-=u,c=!0)),i.startIndex<=r[3]&&(i.endIndex<=r[3]?r[3]-=i.endIndex-i.startIndex+1:r[3]-=r[3]-i.startIndex+1,c=!0));return c},e.prototype.getCell=function(i,r,n){return null},e.prototype.dateToInt=function(i,r){return Ms(i,r)},e.prototype.setDateFormat=function(i,r,n){var s=ke(this,cn(this,i)),a=G(r,n,s,null,!0).format;(!a||a==="General")&&oi(r,n,s,{format:hr("ShortDate")},!0)};var t;return Ft([Wt([],H6)],e.prototype,"sheets",void 0),Ft([C(0)],e.prototype,"activeSheetIndex",void 0),Ft([C("100%")],e.prototype,"height",void 0),Ft([C(!0)],e.prototype,"allowFindAndReplace",void 0),Ft([C()],e.prototype,"filterCollection",void 0),Ft([C()],e.prototype,"sortCollection",void 0),Ft([C("100%")],e.prototype,"width",void 0),Ft([C(!0)],e.prototype,"showRibbon",void 0),Ft([C(!0)],e.prototype,"showFormulaBar",void 0),Ft([C(!0)],e.prototype,"showSheetTabs",void 0),Ft([C(!0)],e.prototype,"allowEditing",void 0),Ft([C(!0)],e.prototype,"allowOpen",void 0),Ft([C(!0)],e.prototype,"allowSave",void 0),Ft([C(!0)],e.prototype,"allowSorting",void 0),Ft([C(!0)],e.prototype,"allowFiltering",void 0),Ft([C(!0)],e.prototype,"allowNumberFormatting",void 0),Ft([C(!0)],e.prototype,"allowCellFormatting",void 0),Ft([C(!0)],e.prototype,"allowHyperlink",void 0),Ft([C(!0)],e.prototype,"enableNotes",void 0),Ft([C(!0)],e.prototype,"allowInsert",void 0),Ft([C(!0)],e.prototype,"allowDelete",void 0),Ft([C(!0)],e.prototype,"allowMerge",void 0),Ft([C(!0)],e.prototype,"allowDataValidation",void 0),Ft([C(!0)],e.prototype,"allowImage",void 0),Ft([C(!0)],e.prototype,"allowChart",void 0),Ft([C(!0)],e.prototype,"allowAutoFill",void 0),Ft([C(!0)],e.prototype,"allowPrint",void 0),Ft([C("Automatic")],e.prototype,"calculationMode",void 0),Ft([be({},b6)],e.prototype,"autoFillSettings",void 0),Ft([C(!0)],e.prototype,"allowConditionalFormat",void 0),Ft([be({},iO)],e.prototype,"cellStyle",void 0),Ft([C("")],e.prototype,"openUrl",void 0),Ft([be({},G6)],e.prototype,"openSettings",void 0),Ft([C("")],e.prototype,"saveUrl",void 0),Ft([C("")],e.prototype,"password",void 0),Ft([C(!1)],e.prototype,"isProtected",void 0),Ft([Wt([],rO)],e.prototype,"definedNames",void 0),Ft([q()],e.prototype,"beforeOpen",void 0),Ft([q()],e.prototype,"openFailure",void 0),Ft([q()],e.prototype,"beforeSave",void 0),Ft([q()],e.prototype,"saveComplete",void 0),Ft([q()],e.prototype,"beforeCellFormat",void 0),Ft([q()],e.prototype,"queryCellInfo",void 0),Ft([q()],e.prototype,"beforeCellUpdate",void 0),Ft([C(!0)],e.prototype,"allowFreezePane",void 0),Ft([C(",")],e.prototype,"listSeparator",void 0),e=t=Ft([bt],e),e}(Kt);function Ar(o,e){return o.rows[e]}function hs(o,e,t){o.rows[e]||(o.rows[e]={}),Object.keys(t).forEach(function(i){o.rows[e][""+i]=t[""+i]})}function st(o,e){return o.rows[e]&&o.rows[e].hidden}function Jn(o,e){return o.rows[e]&&o.rows[e].isFiltered}function li(o,e,t,i){var r,n;if(o&&o.standardHeight&&(n=o.standardHeight),o&&o.rows&&o.rows[e]){if(!i&&o.rows[e].hidden)return 0;r=o.rows[e].height===void 0?n===void 0?20:n:o.rows[e].height}else r=n===void 0?20:n;if(t&&window.devicePixelRatio%1>0){var s=r*window.devicePixelRatio%1;return r+(s?(s>.5?1-s:-1*s)/window.devicePixelRatio:0)}else return r}function bb(o,e,t){o&&o.rows&&(o.rows[e]||(o.rows[e]={}),o.rows[e].height=t)}function Ri(o,e,t,i,r){t===void 0&&(t=e);var n=0,s;e>t&&(s=e,e=t,t=s);for(var a=e;a<=t;a++)n+=li(o,a,i,r);return n}function Rt(o,e){return o.columns?o.columns[e]||(o.columns[e]={}):(o.columns=[],o.columns[e]={}),o.columns[e]}function ch(o,e,t){var i=Rt(o,e);Object.keys(t).forEach(function(r){i[""+r]=t[""+r]})}function _r(o,e,t,i){var r;if(o&&o.columns&&o.columns[e]){if(!t&&o.columns[e].hidden)return 0;r=o.columns[e].width||o.columns[e].customWidth?o.columns[e].width:64}else r=64;if(i&&window.devicePixelRatio%1>0){var n=r*window.devicePixelRatio%1;return r+(n?(n>.5?1-n:-1*n)/window.devicePixelRatio:0)}else return r}function Ci(o,e,t,i){t===void 0&&(t=e);var r=0;if(e>t){var n=e;e=t,t=n}for(var s=e;s<=t;s++)r+=_r(o,s,null,i);return r}function Ot(o,e){return o.columns[e]&&o.columns[e].hidden}function Ds(o,e,t){return o&&o.validation&&(!o.validation.address||oO(o.validation.address,e,t))}function oq(o){var e=[];return lq(o,e),tO(o,e),e}function lq(o,e){o.showRibbon&&e.push({member:"ribbon",args:[o]}),o.showFormulaBar&&e.push({member:"formulaBar",args:[o]}),o.showSheetTabs&&e.push({member:"sheetTabs",args:[o]}),o.allowEditing&&(e.push({member:"edit",args:[o]}),e.push({member:"formula",args:[o]})),o.allowOpen&&e.push({member:"open",args:[o]}),o.allowSave&&e.push({member:"save",args:[o]}),o.enableContextMenu&&e.push({member:"contextMenu",args:[o]}),o.allowAutoFill&&e.push({member:"autofill",args:[o]}),o.selectionSettings.mode!=="None"&&e.push({member:"selection",args:[o]}),o.enableKeyboardNavigation&&e.push({member:"keyboardNavigation",args:[o]}),o.allowNumberFormatting&&e.push({member:"numberFormat",args:[o]}),o.enableKeyboardShortcut&&e.push({member:"keyboardShortcut",args:[o]}),o.enableClipboard&&e.push({member:"clipboard",args:[o]}),o.allowCellFormatting&&e.push({member:"cellformat",args:[o]}),o.allowSorting&&e.push({member:"sort",args:[o]}),o.allowResizing&&e.push({member:"resize",args:[o]}),e.push({member:"protectSheet",args:[o]}),e.push({member:"workbookFormula",args:[o]}),e.push({member:"workbookEdit",args:[o]}),o.allowHyperlink&&e.push({member:"spreadsheetHyperlink",args:[o]}),o.enableNotes&&e.push({member:"spreadsheetNote",args:[o]}),o.allowUndoRedo&&e.push({member:"undoredo",args:[o]}),o.allowFiltering&&e.push({member:"filter",args:[o]}),o.allowWrap&&e.push({member:"wrapText",args:[o]}),o.allowInsert&&e.push({member:"insert",args:[o]}),o.allowDelete&&e.push({member:"delete",args:[o]}),o.allowDataValidation&&e.push({member:"dataValidation",args:[o]}),o.allowFindAndReplace&&e.push({member:"findAndReplace",args:[o]}),o.allowMerge&&e.push({member:"merge",args:[o]}),o.allowConditionalFormat&&e.push({member:"conditionalFormatting",args:[o]}),o.allowImage&&e.push({member:"spreadsheetImage",args:[o]}),o.allowChart&&e.push({member:"spreadsheetChart",args:[o]})}var KF="e-wraptext",fe="spreadsheetLocale",jt="dialog",hq="actionEvents",eM="shape",uq={Custom:["#ffffff","#000000","#e7e6e6","#44546a","#4472c4","#ed7d31","#a5a5a5","#ffc000","#70ad47","#ff0000","#f2f2f2","#808080","#cfcdcd","#d5dce4","#d9e2f3","#fbe4d5","#ededed","#fff2cc","#e2efd9","#ffcccc","#d9d9d9","#595959","#aeaaaa","#acb9ca","#b4c6e7","#f7caac","#dbdbdb","#ffe599","#c5e0b3","#ff8080","#bfbfbf","#404040","#747070","#8496b0","#8eaadb","#f4b083","#c9c9c9","#ffd966","#a8d08d","#ff3333","#a6a6a6","#262626","#3b3838","#323e4f","#2f5496","#c45911","#7b7b7b","#bf8f00","#538135","#b30000","#7f7f7f","#0d0d0d","#161616","#212934","#1f3763","#823b0b","#525252","#7f5f00","#375623","#660000"]},cq={Custom:["#ffffff","#000000","#ffff00","#00ff00","#00ffff","#0000ff","#ff0000","#000080","#800080","#996633","#f2f2f2","#808080","#ffffcc","#b3ffb3","#ccffff","#ccccff","#ffcccc","#ccccff","#ff80ff","#f2e6d9","#d9d9d9","#595959","#ffff80","#80ff80","#b3ffff","#8080ff","#ff8080","#8080ff","#ff00ff","#dfbf9f","#bfbfbf","#404040","#ffff33","#33ff33","#33ffff","#3333ff","#ff3333","#0000b3","#b300b3","#c68c53","#a6a6a6","#262626","#e6e600","#00b300","#009999","#000099","#b30000","#000066","#660066","#86592d","#7f7f7f","#0d0d0d","#999900","#006600","#006666","#000066","#660000","#00004d","#4d004d","#734d26"]},Vs={UP:38,DOWN:40,LEFT:37,RIGHT:39,FIRSTALPHABET:65,LASTALPHABET:90,SPACE:32,BACKSPACE:8,TAB:9,DELETE:46,ENTER:13,ESC:27},dq={FindValue:"Find value",ReplaceValue:"Replace value",FindReplaceTooltip:"Find & Replace",InsertingEmptyValue:"Reference value is not valid.",ReplaceAllEnd:" matches replaced with ",ByRow:"By Rows",ByColumn:"By Columns",MatchCase:"Match case",MatchExactCellElements:"Match entire cell contents",EnterCellAddress:"Enter cell address",FindAndReplace:"Find and Replace",FindNextBtn:"Find Next",FindPreviousBtn:"Find Previous",ReplaceBtn:"Replace",ReplaceAllBtn:"Replace All",GotoHeader:"Go To",Sheet:"Sheet",Workbook:"Workbook",NoElements:"We couldn't find what you were looking for.",FindWhat:"Find what",ReplaceWith:"Replace with",Cut:"Cut",Copy:"Copy",Paste:"Paste",PasteSpecial:"Paste Special",Link:"Link",Spreadsheet:"Spreadsheet",AddNote:"Add Note",EditNote:"Edit Note",DeleteNote:"Delete Note",Hyperlink:"Hyperlink",EditHyperlink:"Edit Hyperlink",OpenHyperlink:"Open Hyperlink",RemoveHyperlink:"Remove Hyperlink",InvalidHyperlinkAlert:"The address of this site is not valid. Check the address and try again.",InsertLink:"Insert Link",EditLink:"Edit Link",All:"All",Values:"Values",Formats:"Formats",Bold:"Bold",Font:"Font",FontSize:"Font Size",Italic:"Italic",Underline:"Underline",Strikethrough:"Strikethrough",TextColor:"Text Color",FillColor:"Fill Color",HorizontalAlignment:"Horizontal Alignment",AlignLeft:"Align Left",AlignCenter:"Center",AlignRight:"Align Right",VerticalAlignment:"Vertical Alignment",AlignTop:"Align Top",AlignMiddle:"Align Middle",AlignBottom:"Align Bottom",WrapText:"Wrap Text",MergeCells:"Merge Cells",MergeAll:"Merge All",MergeHorizontally:"Merge Horizontally",MergeVertically:"Merge Vertically",Unmerge:"Unmerge",UnmergeCells:"Unmerge Cells",SelectMergeType:"Select Merge Type",MergeCellsAlert:"Merging cells will only preserve the top-leftmost(Uppermost) value. Merge anyway?",Borders:"Borders",TopBorders:"Top Borders",LeftBorders:"Left Borders",RightBorders:"Right Borders",BottomBorders:"Bottom Borders",AllBorders:"All Borders",HorizontalBorders:"Horizontal Borders",VerticalBorders:"Vertical Borders",OutsideBorders:"Outside Borders",InsideBorders:"Inside Borders",NoBorders:"No Borders",BorderColor:"Border Color",BorderStyle:"Border Style",InsertFunction:"Insert Function",CalcOptions:"Calculation Options",CalcOptionsTip:"Choose to calculate formulas either automatically or manually",CalcActiveSheet:"Calculate Sheet",CalcWorkbook:"Calculate Workbook",Automatic:"Automatic",Manual:"Manual",CalcSheetTip:"Calculate the active sheet",CalcWorkbookTip:"Calculate the entire workbook",Insert:"Insert",Delete:"Delete",DuplicateSheet:"Duplicate",MoveRight:"Move Right",MoveLeft:"Move Left",Rename:"Rename",Hide:"Hide",FileName:"File Name",PROPER:"Converts a text to proper case; first letter to uppercase and other letters to lowercase.",NameBox:"Name Box",ShowHeaders:"Show Headers",HideHeaders:"Hide Headers",ShowGridLines:"Show Gridlines",ExtendValidation:"The selection contains some cells without data validation. Do you want to extend validation to these cells?",Yes:"Yes",No:"No",HideGridLines:"Hide Gridlines",FreezePanes:"Freeze Panes",FreezeRows:"Freeze Rows",FreezeColumns:"Freeze Columns",UnfreezePanes:"Unfreeze Panes",UnfreezeRows:"Unfreeze Rows",UnfreezeColumns:"Unfreeze Columns",AddSheet:"Add Sheet",ListAllSheets:"List All Sheets",CollapseToolbar:"Collapse Toolbar",ExpandToolbar:"Expand Toolbar",CollapseFormulaBar:"Collapse Formula Bar",ExpandFormulaBar:"Expand Formula Bar",File:"File",Home:"Home",Formulas:"Formulas",View:"View",New:"New",Open:"Open",SaveAs:"Save As",Print:"Print",Update:"Update",ExcelXlsx:"Microsoft Excel",ExcelXls:"Microsoft Excel 97-2003",CSV:"Comma-separated values",FormulaBar:"Formula Bar",Sort:"Sort",SortAscending:"Ascending",SortDescending:"Descending",CustomSort:"Custom Sort",AddColumn:"Add Column",ContainsHeader:"Data contains header",CaseSensitive:"Case sensitive",SortBy:"Sort by",ThenBy:"Then by",SelectAColumn:"Select a column",SortEmptyFieldError:"All sort criteria must have a column specified. Check the selected sort criteria and try again.",SortDuplicateFieldError:"  is being sorted by values more than once. Delete the duplicate sort criteria and try again.",SortOutOfRangeError:"Select a cell or range inside the used range and try again.",MultiRangeSortError:"This can't be done on a multiple range selection. Select a single range and try again.",SortAndFilter:"Sort & Filter",Filter:"Filter",ClearAllFilter:"Clear",ClearFilterFrom:"Clear Filter From ",ReapplyFilter:"Reapply",FilterCellValue:"Filter by Value of Selected Cell",FilterOutOfRangeError:"Select a cell or range inside the used range and try again.",HideRow:"Hide Row",HideRows:"Hide Rows",UnhideRows:"Unhide Rows",HideColumn:"Hide Column",HideColumns:"Hide Columns",UnhideColumns:"Unhide Columns",InsertRow:"Insert Row",InsertRows:"Insert Rows",Above:"Above",Below:"Below",InsertColumn:"Insert Column",InsertColumns:"Insert Columns",Before:"Before",After:"After",DeleteRow:"Delete Row",DeleteRows:"Delete Rows",DeleteColumn:"Delete Column",DeleteColumns:"Delete Columns",Ok:"OK",Close:"Close",MoreOptions:"More Options",Cancel:"Cancel",Apply:"Apply",MoreColors:"More Colors",StandardColors:"Standard Colors",General:"General",Number:"Number",Currency:"Currency",Accounting:"Accounting",ShortDate:"Short Date",LongDate:"Long Date",Time:"Time",Percentage:"Percentage",Fraction:"Fraction",Scientific:"Scientific",Text:"Text",Custom:"Custom",MobileFormulaBarPlaceHolder:"Enter value or Formula",NumberFormat:"Number Format",PasteAlert:"You can't paste this here, because the copy area and paste area aren't in the same size. Please try pasting in a different range.",DestroyAlert:"Are you sure you want to destroy the current workbook without saving and create a new workbook?",SheetRenameInvalidAlert:"Sheet name contains invalid character.",SheetRenameEmptyAlert:"Sheet name cannot be empty.",SheetRenameAlreadyExistsAlert:"Sheet name already exists. Please enter another name.",DeleteSheetAlert:"You can't undo deleting sheets, and you might be removing some data. If you don't need it, click OK to delete.",DeleteSingleLastSheetAlert:"A Workbook must contain at least one visible worksheet.",PickACategory:"Pick a category",Description:"Description",UnsupportedFile:"Unsupported File",DataLimitExceeded:"File data is too large and it takes more time to process, do you want to continue?",FileSizeLimitExceeded:"File size is too large and it takes more time to process, do you want to continue?",InvalidUrl:"Invalid URL",SUM:"Adds a series of numbers and/or cells.",SUMIF:"Adds the cells based on specified condition.",SUMIFS:"Adds the cells based on specified conditions.",ABS:"Returns the value of a number without its sign.",RAND:"Returns a random number between 0 and 1.",RANDBETWEEN:"Returns a random integer based on specified values.",FLOOR:"Rounds a number down to the nearest multiple of a given factor.",CEILING:"Rounds a number up to the nearest multiple of a given factor.",PRODUCT:"Multiplies a series of numbers and/or cells.",INT:"Returns a number to the nearest integer.",ROUNDUP:"Rounds a number away from zero.",SUMPRODUCT:"Returns sum of the product of given ranges of arrays.",SORT:"Sorts a range of an array",T:"Checks whether a value is text or not and returns the text.",EXACT:"Checks whether a two text strings are exactly same and returns TRUE or FALSE.",LEN:"Returns a number of characters in a given string.",MOD:"Returns a remainder after a number is divided by divisor.",ODD:"Rounds a positive number up and negative number down to the nearest odd integer.",PI:"Returns the value of pi.",COUNTBLANK:"Returns the number of empty cells in a specified range of cells.",EVEN:"Rounds a positive number up and negative number down to the nearest even integer.",DECIMAL:"Converts a text representation of a number in a given base into a decimal number.",DEGREES:"Converts radians to degrees.",ADDRESS:"Returns a cell reference as text, given specified row and column numbers.",TIME:"Converts hours, minutes, seconds to the time formatted text.",CHAR:"Returns the character from the specified number.",CODE:"Returns the numeric code for the first character in a given string.",DOLLAR:"Converts the number to currency formatted text.",SMALL:"Returns the k-th smallest value in a given array.",LARGE:"Returns the k-th largest value in a given array.",FACT:"Returns the factorial of a number.",MEDIAN:"Returns the median of the given set of numbers.",EDATE:"Returns a date with given number of months before or after the specified date.",DATEVALUE:"Converts a date string into date value.",HOUR:"Returns the number of hours in a specified time string.",SECOND:"Returns the number of seconds in a specified time string.",MINUTE:"Returns the number of minutes in a specified time string.",NOW:"Returns the current date and time.",MONTH:"Returns the number of months in a specified date string.",TODAY:"Returns the current date as date value.",WEEKDAY:"Returns the day of the week corresponding to a date.",AVERAGE:"Calculates average for the series of numbers and/or cells excluding text.",AVERAGEIF:"Calculates average for the cells based on specified criterion.",AVERAGEIFS:"Calculates average for the cells based on specified conditions.",AVERAGEA:"Calculates the average for the cells evaluating TRUE as 1, text and FALSE as 0.",COUNT:"Counts the cells that contain numeric values in a range.",COUNTIF:"Counts the cells based on specified condition.",COUNTIFS:"Counts the cells based on specified conditions.",COUNTA:"Counts the cells that contains values in a range.",MIN:"Returns the smallest number of the given arguments.",MAX:"Returns the largest number of the given arguments.",DATE:"Returns the date based on given year, month, and day.",DAY:"Returns the day from the given date.",DAYS:"Returns the number of days between two dates.",IF:"Returns value based on the given expression.",IFS:"Returns value based on the given multiple expressions.",CalculateAND:"Returns TRUE if all the arguments are TRUE, otherwise returns FALSE.",CalculateOR:"Returns TRUE if any of the arguments are TRUE, otherwise returns FALSE.",IFERROR:"Returns value if no error found else it will return specified value.",CHOOSE:"Returns a value from list of values, based on index number.",INDEX:"Returns a value of the cell in a given range based on row and column number.",FIND:"Returns the position of a string within another string, which is case sensitive.",TEXT:"Converts a value to text in specified number format.",CONCATENATE:"Combines two or more strings together.",CONCAT:"Concatenates a list or a range of text strings.",SUBTOTAL:"Returns subtotal for a range using the given function number.",RADIANS:"Converts degrees into radians.",MATCH:"Returns the relative position of a specified value in given range.",LN:"Returns the natural logarithm of a number.",INTERCEPT:"Calculates the point of the Y-intercept line via linear regression.",UNIQUE:"Returns a unique values from a range or array",SLOPE:"Returns the slope of the line from linear regression of the data points.",LOOKUP:"Looks for a value in a one-row or one-column range, then returns a value from the same position in a second one-row or one-column range.",HLOOKUP:"Looks for a value in the top row of the array of values and then returns a value in the same column from a row in the array that you specify.",VLOOKUP:"Looks for a specific value in the first column of a lookup range and returns a corresponding value from a different column within the same row.",NOT:"Returns the inverse of a given logical expression.",EOMONTH:"Returns the last day of the month that is a specified number of months before or after an initially supplied start date.",SQRT:"Returns the square root of a positive number.",ROUNDDOWN:"Rounds a number down, toward zero.",RSQ:"Returns the square of the Pearson product moment correlation coefficient based on data points in known_y's and known_x's.",DefineNameExists:"This name already exists, try different name.",DefineNameInValid:"The name that you entered is not valid.",CircularReference:"When a formula refers to one or more circular references, this may result in an incorrect calculation.",OR:"OR",AND:"AND",CustomFilterDatePlaceHolder:"Choose a date",CustomFilterPlaceHolder:"Enter the value",CustomFilter:"Custom Filter",Between:"Between",DateTimeFilter:"DateTime Filters",Undo:"Undo",Redo:"Redo",DateFilter:"Date Filters",TextFilter:"Text Filters",NumberFilter:"Number Filters",ClearFilter:"Clear Filter",NoResult:"No Matches Found",FilterFalse:"False",FilterTrue:"True",Blanks:"Blanks",SelectAll:"Select All",GreaterThanOrEqual:"Greater Than Or Equal",GreaterThan:"Greater Than",LessThanOrEqual:"Less Than Or Equal",LessThan:"Less Than",NotEqual:"Not Equal",Equal:"Equal",Contains:"Contains",NotContains:"Does Not Contains",EndsWith:"Ends With",NotEndsWith:"Does Not End With",StartsWith:"Starts With",NotStartsWith:"Does Not Start With",IsEmpty:"Empty",IsNotEmpty:"Not Empty",ClearButton:"Clear",FilterButton:"Filter",CancelButton:"Cancel",OKButton:"OK",Search:"Search",ProtectSheet:"Protect Sheet",UnprotectSheet:"Unprotect Sheet",SelectCells:"Select locked cells",SelectUnlockedCells:"Select unlocked cells",FormatCells:"Format cells",FormatRows:"Format rows",FormatColumns:"Format columns",InsertLinks:"Insert links",ProtectContent:"Protect the contents of locked cells",ProtectAllowUser:" Allow all users of this worksheet to:",EditAlert:"The cell you're trying to change is protected. To make change, unprotect the sheet.",ReadonlyAlert:"You are trying to modify a cell that is in read-only mode. To make changes, please disable the read-only status.",FiniteAlert:"Finite mode is active: Cannot access the specified cell range outside the defined limits.",Alert:"Alert",SearchWithin:"Search within",SearchBy:"Search by",Reference:"Reference",DataValidation:"Data Validation",CellRange:"Cell Range",Allow:"Allow",Data:"Data",Minimum:"Minimum",Maximum:"Maximum",IgnoreBlank:"Ignore blank",WholeNumber:"Whole Number",Decimal:"Decimal",Date:"Date",TextLength:"Text Length",List:"List",NotBetween:"Not Between",EqualTo:"Equal To",NotEqualTo:"Not Equal To",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThanOrEqualTo:"Less Than Or Equal To",InCellDropDown:"In-cell-dropdown",Sources:"Sources",Value:"Value",Formula:"Formula",Retry:"Retry",DialogError:"The list source must be a reference to single row or column.",NamedRangeError:"A named range you specified cannot be found.",MinMaxError:"The Maximum must be greater than or equal to the Minimum.",InvalidNumberError:"Please enter a valid number.",InvalidFormula:"Please enter a valid formula.",MoreValidation:`This selection contains more than one validation. 
 Erase current settings and continue?`,FileNameError:`A file name can't contain characters like \\ / : * ? " < > [ ] |`,ListLengthError:"The list values allows only upto 256 characters",ValidationError:"This value doesn't match the data validation restrictions defined for the cell.",EmptyError:"You must enter a value",ClearHighlight:"Clear Highlight",HighlightInvalidData:"Highlight Invalid Data",ClearValidation:"Clear Validation",HighlightCellsRules:"Highlight Cells Rules",CFEqualTo:"Equal To",TextThatContains:"Text that Contains",Save:"Save",EmptyFileName:"File name cannot be empty.",LargeName:"The name is too long.",ADateOccuring:"A Date Occuring",DuplicateValues:"Duplicate Values",TopBottomRules:"Top/Bottom Rules",Directional:"Directional",Shapes:"Shapes",Indicators:"Indicators",Ratings:"Ratings",Top10Items:"Top 10 Items",Top10:"Top 10",Bottom10Items:"Bottom 10 Items",Bottom10:"Bottom 10",AboveAverage:"Above Average",BelowAverage:"Below Average",FormatCellsGreaterThan:"Format cells that are GREATER THAN:",FormatCellsLessThan:"Format cells that are LESS THAN:",FormatCellsBetween:"Format cells that are BETWEEN:",FormatCellsEqualTo:"Format cells that are EQUAL TO:",FormatCellsThatContainTheText:"Format cells that contain the text:",FormatCellsThatContainADateOccurring:"Format cells that contain a date occurring:",FormatCellsDuplicate:"Format cells that contain:",FormatCellsTop:"Format cells that rank in the TOP:",FormatCellsBottom:"Format cells that rank in the BOTTOM:",FormatCellsAbove:"Format cells that are ABOVE AVERAGE:",FormatCellsBelow:"Format cells that are BELOW AVERAGE:",With:"with",DataBars:"Data Bars",ColorScales:"Color Scales",IconSets:"Icon Sets",ClearRules:"Clear Rules",SelectedCells:"Clear Rules from Selected Cells",EntireSheet:"Clear Rules from Entire Sheet",ISNUMBER:"Returns true when the value parses as a numeric value.",ROUND:"Rounds a number to a specified number of digits.",GEOMEAN:"Returns the geometric mean of an array or range of positive data.",POWER:"Returns the result of a number raised to power",LOG:"Returns the logarithm of a number to the base that you specify.",TRUNC:"Returns the truncated value of a number to a specified number of decimal places.",EXP:"Returns e raised to the power of the given number.",Clear:"Clear",ClearContents:"Clear Contents",ClearAll:"Clear All",ClearFormats:"Clear Formats",ClearHyperlinks:"Clear Hyperlinks",LightRedFillWithDarkRedText:"Light Red Fill with Dark Red Text",YellowFillWithDarkYellowText:"Yellow Fill with Dark Yellow Text",GreenFillWithDarkGreenText:"Green Fill with Dark Green Text",RedFill:"Red Fill",RedText:"Red Text",Duplicate:"Duplicate",Unique:"Unique",And:"and",WebPage:"Web Page",ThisDocument:"This Document",DisplayText:"Display Text",Url:"URL",CellReference:"Cell Reference",DefinedNames:"Defined Names",EnterTheTextToDisplay:"Enter the text to display",EnterTheUrl:"Enter the URL",Image:"Image",ConditionalFormatting:"Conditional Formatting",BlueDataBar:"Blue Data Bar",GreenDataBar:"Green Data Bar",RedDataBar:"Red Data Bar",OrangeDataBar:"Orange Data Bar",LightBlueDataBar:"Light blue Data Bar",PurpleDataBar:"Purple Data Bar",GYRColorScale:"Green - Yellow - Red Color Scale",RYGColorScale:"Red - Yellow - Green Color Scale",GWRColorScale:"Green - White - Red Color Scale",RWGColorScale:"Red - White - Green Color Scale",BWRColorScale:"Blue - White - Red Color Scale",RWBColorScale:"Red - White - Blue Color Scale",WRColorScale:"White - Red Color Scale",RWColorScale:"Red - White Color Scale",GWColorScale:"Green - White Color Scale",WGColorScale:"White - Green Color Scale",GYColorScale:"Green - Yellow Color Scale",YGColorScale:"Yellow - Green Color Scale",ThreeArrowsColor:"3 Arrows (Colored)",ThreeArrowsGray:"3 Arrows (Gray)",ThreeTriangles:"3 Triangles",FourArrowsColor:"4 Arrows (Gray)",FourArrowsGray:"4 Arrows (Colored)",FiveArrowsColor:"5 Arrows (Gray)",FiveArrowsGray:"5 Arrows (Colored)",ThreeTrafficLights1:"3 Traffic Lights (Unrimmed)",ThreeTrafficLights2:"3 Traffic Lights (Rimmed)",ThreeSigns:"3 Signs",FourTrafficLights:"4 Traffic Lights",RedToBlack:"Red To Black",ThreeSymbols1:"3 Symbols (Circled)",ThreeSymbols2:"3 Symbols (Uncircled)",ThreeFlags:"3 Flags",ThreeStars:"3 Stars",FourRatings:"4 Ratings",FiveQuarters:"5 Quarters",FiveRatings:"5 Ratings",FiveBoxes:"5 Boxes",Chart:"Chart",Column:"Column",Bar:"Bar",Area:"Area",Pie:"Pie",Doughnut:"Doughnut",PieAndDoughnut:"Pie/Doughnut",Line:"Line",LineMarker:"Line with Markers",Radar:"Radar",Scatter:"Scatter",ChartDesign:"Chart Design",ClusteredColumn:"Clustered Column",StackedColumn:"Stacked Column",StackedColumn100:"100% Stacked Column",ClusteredBar:"Clustered Bar",StackedBar:"Stacked Bar",StackedBar100:"100% Stacked Bar",StackedArea:"Stacked Area",StackedArea100:"100% Stacked Area",StackedLine:"Stacked Line",StackedLineMarker:"Stacked Line with Markers",StackedLine100:"100% Stacked Line",StackedLine100Marker:"100% Stacked Line with Markers",AddChartElement:"Add Chart Element",Axes:"Axes",AxisTitle:"Axis Title",ChartTitle:"Chart Title",DataLabels:"Data Labels",Gridlines:"Gridlines",Legends:"Legends",PrimaryHorizontal:"Primary Horizontal",PrimaryVertical:"Primary Vertical",None:"None",AboveChart:"Above Chart",Center:"Center",InsideEnd:"Inside End",InsideBase:"Inside Base",OutsideEnd:"OutSide End",PrimaryMajorHorizontal:"Primary Major Horizontal",PrimaryMajorVertical:"Primary Major Vertical",PrimaryMinorHorizontal:"Primary Minor Horizontal",PrimaryMinorVertical:"Primary Minor Vertical",Right:"Right",Left:"Left",Bottom:"Bottom",Top:"Top",SwitchRowColumn:"Switch Row/Column",ChartTheme:"Chart Theme",ChartType:"Chart Type",Material:"Material",Fabric:"Fabric",Bootstrap:"Bootstrap",HighContrastLight:"HighContrast Light",MaterialDark:"Material Dark",FabricDark:"Fabric Dark",HighContrast:"HighContrast",BootstrapDark:"Bootstrap Dark",Bootstrap4:"Bootstrap4",Bootstrap5Dark:"Bootstrap5 Dark",Bootstrap5:"Bootstrap5",Tailwind:"Tailwind",TailwindDark:"Tailwind Dark",Tailwind3:"Tailwind 3",Tailwind3Dark:"Tailwind 3 Dark",VerticalAxisTitle:"Vertical Axis Title",HorizontalAxisTitle:"Horizontal Axis Title",EnterTitle:"Enter Title",ProtectWorkbook:"Protect Workbook",Password:"Password (optional):",EnterThePassword:"Enter the password",ConfirmPassword:"Confirm Password",EnterTheConfirmPassword:"Re-enter your password",PasswordAlert:"Confirmation password is not identical",UnprotectWorkbook:"Unprotect Workbook",UnprotectPasswordAlert:"The password you supplied is not correct.",IncorrectPassword:"Unable to open the file or worksheet with the given password",PasswordAlertMsg:"Please enter the password",ConfirmPasswordAlertMsg:"Please enter the confirm password",IsProtected:"is protected",PDF:"PDF Document",AutoFillMergeAlertMsg:"To do this, all the merged cells need to be the same size.",FillSeries:"Fill Series",CopyCells:"Copy Cells",FillFormattingOnly:"Fill Formatting Only",FillWithoutFormatting:"Fill Without Formatting",CustomFormat:"Custom Number Formats",CustomFormatPlaceholder:"Type or Select a custom format",CustomFormatTypeList:"Type",UnprotectWorksheet:"Unprotect Sheet",ReEnterPassword:"Re-enter password to proceed",SheetPassword:"Password to unprotect sheet:",Fluent:"Fluent",FluentDark:"Fluent Dark",Fluent2:"Fluent 2",Fluent2Dark:"Fluent 2 Dark",Fluent2HighContrast:"Fluent 2 HighContrast",Material3:"Material 3",Material3Dark:"Material 3 Dark",CellReferenceTypoError:"We found a typo in your cell reference. Do you want to correct this reference as follows?",InvalidFormulaError:"We found that you typed a formula which is invalid.",InvalidArguments:"We found that you typed a formula with an invalid arguments.",EmptyExpression:"We found that you typed a formula with an empty expression.",MismatchedParenthesis:"We found that you typed a formula with one or more missing opening or closing parenthesis.",ImproperFormula:"We found that you typed a formula which is improper.",WrongNumberOfArguments:"We found that you typed a formula with a wrong number of arguments.",Requires3Arguments:"We found that you typed a formula which requires 3 arguments.",MismatchedStringQuotes:"We found that you typed a formula with a mismatched quotes.",FormulaCircularRef:"We found that you typed a formula with a circular reference.",AddCurrentSelection:"Add current selection to filter",ExternalWorkbook:"An imported excel file contains an external workbook reference. Do you want to import that file?"};function cr(o){requestAnimationFrame(function(){o()})}function _a(o){for(;o.firstChild;)o.removeChild(o.firstChild)}function ZF(o){var e=30;return o.toString().length>3&&(e=o.toString().length*10),e}var hx=null,pq=1.24;function LO(){if(hx!==null)return hx;var o=document.createElement("div"),e=0;return o.style.cssText="width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;",document.body.appendChild(o),e=o.offsetWidth-o.clientWidth|0,document.body.removeChild(o),hx=e}function kO(o,e,t){t===void 0&&(t=1),e=e||["e-ribbon","e-formula-bar-panel","e-sheet-tab-panel","e-header-toolbar"];var i=JF(o,"previous",e,t),r=JF(o,"next",e,t);return i+r}function JF(o,e,t,i){for(var r=o[e+"ElementSibling"],n=0;r;)t.some(function(s){return r.classList.contains(s)})&&(n+=r.getBoundingClientRect().height*i),r=r[e+"ElementSibling"];return n}function UI(o,e,t){if(o.scrollSettings.enableVirtualization){var i=o.getActiveSheet(),r=o.frozenRowCount(i),n=o.frozenColCount(i),s=o.viewport.topIndex+r,a=o.viewport.leftIndex+n,l=o.viewport.bottomIndex,h=o.viewport.rightIndex;if(i.frozenRows||i.frozenColumns){if(o.insideViewport(e[0],e[1])||o.insideViewport(e[2],e[3]))return!0}else if(s<=e[0]&&l>=e[2]&&a<=e[1]&&h>=e[3])return!0;var u=!1;if(t){if(e[0]<s&&e[2]<s||e[0]>l&&e[2]>l||(e[0]<s&&e[2]>s&&e[0]>=r&&(e[0]=s,u=!0),e[2]>l&&(e[2]=l,u=!0),e[1]<a&&e[3]<a||e[1]>h&&e[3]>h))return!1;e[1]<a&&e[3]>a&&e[1]>=n&&(e[1]=a,u=!0),e[3]>h&&(e[3]=h,u=!0)}return u}else return!0}function Ib(o,e,t,i,r,n,s,a){var l,h={left:{idx:0,size:0},top:{idx:0,size:0}},u=h.top.size,c=h.left.size;for(l=h.top.idx;l<e[0];l++)t&&t-1<e[0]&&l<t||(u+=li(o,l,!a));for(l=h.left.idx;l<e[1];l++)i&&i-1<e[1]&&l<i||(c+=_r(o,l,null,!a));return t&&e[0]<t&&(o.showHeaders&&(u+=30),r&&(u-=r)),i&&e[1]<i&&(o.showHeaders&&(c+=s||30),n&&(c-=n)),{top:u,left:c}}function Us(o,e,t,i,r,n,s){i===void 0&&(i="e-selection");var a=o.getActiveSheet();if(a.frozenRows||a.frozenColumns){var l,h=o.frozenRowCount(a),u=o.frozenColCount(a);if(i==="e-active-cell"){if(t[0]<h||t[1]<u){e.style.display="none",l=t[0]<h&&t[1]<u?o.getSelectAllContent():t[0]<h?o.getColumnHeaderContent():o.getRowHeaderContent();var c=l.querySelector("."+i);c||(c=e.cloneNode(!0),l.appendChild(c)),e=c,Hs(o,e,t,a,o.enableRtl,h,u,r,!0,o.viewport.beforeFreezeHeight,o.viewport.beforeFreezeWidth,o.sheetModule.colGroupWidth)}else Hs(o,e,t,a,o.enableRtl,h,u,r);e.style.display&&(e.style.display=""),_i(o.getSelectAllContent(),l,"e-active-cell"),_i(o.getColumnHeaderContent(),l,"e-active-cell"),_i(o.getRowHeaderContent(),l,"e-active-cell")}else if(i==="e-autofill"){var d=void 0,p=o.frozenRowCount(a),f=o.frozenColCount(a);if(t[0]<p||t[1]<f){e.style.display="none",d=t[0]<p&&t[1]<f?o.getSelectAllContent():t[0]<p?o.getColumnHeaderContent():o.getRowHeaderContent();var c=d.querySelector("."+i);c||(c=e.cloneNode(!0),d.appendChild(c)),e=c,Hs(o,e,t,a,o.enableRtl,p,f,r,!0,o.viewport.beforeFreezeHeight,o.viewport.beforeFreezeWidth,o.sheetModule.colGroupWidth,"e-autofill")}else Hs(o,e,t,a,o.enableRtl,p,f,r,!1,0,0,0,"e-autofill");e.style.display&&(e.style.display=""),_i(o.getSelectAllContent(),d,"e-autofill"),_i(o.getColumnHeaderContent(),d,"e-autofill"),_i(o.getRowHeaderContent(),d,"e-autofill")}else if(i==="e-filloption"){var d=void 0,p=o.frozenRowCount(a),f=o.frozenColCount(a);if(t[0]<p||t[1]<f)if(t[3]+1===f&&t[2]+1>p)Hs(o,o.getMainContent().querySelector(".e-filloption"),t,a,o.enableRtl,p,f,r,!1,0,0,0,"e-filloption",!0,{left:-4});else if(t[2]+1===p&&t[3]+1>f)Hs(o,o.getMainContent().querySelector(".e-filloption"),t,a,o.enableRtl,p,f,r,!1,0,0,0,"e-filloption",!0,{top:-4});else if(t[3]+1===f&&t[2]+1<p){d=o.getColumnHeaderContent();var v=d.querySelector("."+i);v||o.notify(ky,{id:o.element.id+"_autofilloptionbtn",appendElem:d}),e=o.autofillModule.autoFillDropDown.element,Hs(o,e,t,a,o.enableRtl,p,f,r,!1,0,0,0,"e-filloption",!0,{left:-4})}else if(t[2]+1===p&&t[3]+1===f)Hs(o,o.getMainContent().querySelector(".e-filloption"),t,a,o.enableRtl,p,f,r,!1,0,0,0,"e-filloption",!0,{top:-4,left:-4});else{d=t[0]<p&&t[1]<f?o.getSelectAllContent():t[0]<p?o.getColumnHeaderContent():o.getRowHeaderContent();var c=d.querySelector("."+i);c||o.notify(ky,{id:o.element.id+"_autofilloptionbtn",appendElem:d}),e=o.autofillModule.autoFillDropDown.element,Hs(o,e,t,a,o.enableRtl,p,f,r,!0,o.viewport.beforeFreezeHeight,o.viewport.beforeFreezeWidth,o.sheetModule.colGroupWidth,"e-filloption",!0)}else Hs(o,o.getMainContent().querySelector(".e-filloption"),t,a,o.enableRtl,p,f,r,!1,0,0,0,"e-filloption",!0);e.style.display&&(e.style.display=""),_i(o.getSelectAllContent(),d,"e-filloption"),_i(o.getColumnHeaderContent(),d,"e-filloption"),_i(o.getRowHeaderContent(),d,"e-filloption")}else{var m=tt(t);if(m[0]<h||m[1]<u){e&&!e.classList.contains("e-multi-range")&&e.classList.add("e-hide");var y=[];m[0]<h&&m[1]<u?m[2]<h&&m[3]<u?(y.push(t),n||(_i(o.getColumnHeaderContent(),l,i,!0),_i(o.getRowHeaderContent(),l,i,!0))):m[2]>h-1?m[3]<u?(n||_i(o.getColumnHeaderContent(),l,i,!0),y.push([m[0],m[1],h-1,m[3]]),y.push([h,m[1],m[2],m[3]])):(y.push([m[0],m[1],h-1,u-1]),y.push([h,m[1],m[2],u-1]),y.push([m[0],u,h-1,m[3]]),y.push([h,u,m[2],m[3]])):m[2]<h?(y.push([m[0],m[1],m[2],u-1]),y.push([m[0],u,m[2],m[3]]),n||_i(o.getRowHeaderContent(),l,i,!0)):(y.push([h,m[1],m[2],u-1]),y.push([m[0],m[1],h-1,u-1]),y.push([h,u,m[2],m[3]]),y.push([m[0],u,h-1,m[3]])):m[0]<h?m[2]<h?(y.push(t),n||_i(o.getRowHeaderContent(),l,i,!0)):(y.push([m[0],m[1],h-1,m[3]]),y.push([h,m[1],m[2],m[3]]),n||(_i(o.getSelectAllContent(),l,i,!0),_i(o.getRowHeaderContent(),l,i,!0))):m[3]<u?(y.push(t),n||_i(o.getSelectAllContent(),l,i,!0)):(y.push([m[0],m[1],m[2],u-1]),y.push([m[0],u,m[2],m[3]]),n||(_i(o.getSelectAllContent(),l,i,!0),_i(o.getColumnHeaderContent(),l,i,!0)));var S;y.forEach(function(w){var I;if(w[2]<h&&w[3]<u)l=o.getSelectAllContent();else{if(h||u){var x=o.getSelectAllContent();x&&(I=x.style.zIndex)}if(w[2]<h)l=o.getColumnHeaderContent();else if(w[3]<u)l=o.getRowHeaderContent();else{if(l=o.getMainContent(),h&&!I){var M=o.getColumnHeaderContent();M&&(I=M.style.zIndex)}if(u&&!I){var D=o.getRowHeaderContent();D&&(I=D.style.zIndex)}}}var A;i==="e-copy-indicator"||i==="e-range-indicator"?(A=e.cloneNode(!0),l.appendChild(A),h&&(w[2]+1===h&&y.forEach(function(L){L!==w&&(S=A.getElementsByClassName("e-bottom")[0],S&&L[0]===h&&ee(S))}),w[0]===h&&l.parentElement.classList.contains("e-main-panel")&&y.forEach(function(L){L!==w&&(S=A.getElementsByClassName("e-top")[0],S&&L[2]+1===h&&ee(S))})),u&&(w[3]+1===u&&y.forEach(function(L){L!==w&&(S=A.getElementsByClassName("e-right")[0],S&&L[1]===u&&ee(S))}),w[1]===u&&(l.classList.contains("e-sheet-content")||l.classList.contains("e-column-header"))&&y.forEach(function(L){L!==w&&(S=A.getElementsByClassName("e-left")[0],S&&L[3]+1===u&&ee(S))}))):(A=l.querySelector("."+i),A||(A=e.cloneNode(!0),n&&!A.classList.contains("e-multi-range")&&A.classList.add("e-multi-range"),l.appendChild(A)),s&&A.classList.remove(i)),(h||u)&&(I?A.style.zIndex=I:A.style.zIndex&&(A.style.zIndex="")),Hs(o,A,w,a,o.enableRtl,h,u,r,!1,o.viewport.beforeFreezeHeight,o.viewport.beforeFreezeWidth,o.sheetModule.colGroupWidth),A.classList.contains("e-hide")&&A.classList.remove("e-hide")})}else n||(_i(o.getSelectAllContent(),null,i,!0),_i(o.getColumnHeaderContent(),null,i,!0),_i(o.getRowHeaderContent(),null,i,!0)),Hs(o,e,t,a,o.enableRtl,h,u,r),(i==="e-range-indicator"||!o.getMainContent().querySelector("."+i))&&o.getMainContent().appendChild(e),e.classList.contains("e-hide")&&e.classList.remove("e-hide"),s&&e.classList.remove(i)}}else{var b=Hs(o,e,t,a,o.enableRtl,0,0,r);return e&&!o.getMainContent().querySelector("."+i)&&o.getMainContent().appendChild(e),b}}function _i(o,e,t,i,r){if(i||o!==e)if(r)for(var n=o.querySelectorAll("."+t),s=0;s<n.length;)n[s].classList.remove(t),s++;else{var a=o.querySelector("."+t);a&&!a.classList.contains("e-multi-range")&&ee(a)}}function Hs(o,e,t,i,r,n,s,a,l,h,u,c,d,p,f){var v=tt(t),m=Ib(i,v,n,s,h,u,c),y=[se(i,0,!0),se(i,0,!0,"columns")],S,b;o.scrollSettings.isFinite?(S=v[0]>=i.rowCount?0:Ri(i,v[0],v[2]<i.rowCount?v[2]:i.rowCount-1,!0),b=v[1]>=i.colCount?0:Ci(i,v[1],v[3]<i.colCount?v[3]:i.colCount-1,!0)):(S=Ri(i,v[0],v[2],!0),b=Ci(i,v[1],v[3],!0));var w=v[1]===0&&v[3]===i.colCount-1,I=v[0]===0&&v[2]===i.rowCount-1,x=0,M=-5,D=-5,A=0,L=6,T=6;if(g(d)){var k={top:(v[0]===y[0]?m.top:m.top-En(1))+"px",height:S&&S+(v[0]===y[0]?0:En(1))+"px",width:b&&b+(v[1]===y[1]?0:En(1))+(l&&s&&v[1]<s&&v[3]>=s?1:0)+"px"};if(k[r?"right":"left"]=(v[1]===y[1]?m.left:m.left-1)+"px",e){var F=ux([{element:e,attrs:k}],a);return F}}else{w&&(M=-5,D=-2,L=6,T=3),I&&(D=-5,M=0,L=1,T=6),I||(x+=S),w||(A+=b),x+=Math.round(m.top)+M,A+=Math.round(m.left)+D;var k={};p?(K([e],"e-hide"),x=f&&f.top?f.top:x,A=f&&f.left?f.left:A,k={top:x+L+"px"},k[r?"right":"left"]=A+T+"px",e&&ux([{element:e,attrs:k}],a)):(k={top:x+"px"},k[r?"right":"left"]=A+"px",e&&ux([{element:e,attrs:k}],a))}}function ux(o,e){var t=new Promise(function(i){var r=function(){o.forEach(function(n){Ye(n.element,n.attrs),i()})};e?r():requestAnimationFrame(function(){return r()})});return t}function Cd(){return B.isPointer?"pointerdown":"mousedown touchstart"}function ih(){return B.isPointer?"pointermove":"mousemove touchmove"}function Xc(){return B.isPointer?"pointerup":"mouseup touchend"}function Vc(o){return o.type==="touchstart"||o.type==="pointerdown"&&o.pointerType==="touch"}function Sb(o){return o.type==="touchmove"||o.type==="pointermove"&&o.pointerType==="touch"}function cx(o){return o.type==="touchend"||o.type==="pointerup"&&o.pointerType==="touch"}function ay(o){return o&&(o.type==="mousedown"||o.type==="pointerdown")}function Uc(o){return o&&(o.type==="mousemove"||o.type==="pointermove")}function dx(o){return o&&(o.type==="mouseup"||o.type==="pointerup")}function uu(o){return o===Vs.UP||o===Vs.DOWN||o===Vs.LEFT||o===Vs.RIGHT}function xo(o){return o.changedTouches?o.changedTouches[0].clientX:o.clientX}function Io(o){return o.changedTouches?o.changedTouches[0].clientY:o.clientY}function fq(o){return o.changedTouches?o.changedTouches[0].pageX:o.pageX}function gq(o){return o.changedTouches?o.changedTouches[0].pageY:o.pageY}function En(o,e){if(window.devicePixelRatio%1>0){var t=o*window.devicePixelRatio%1;return o+(t?(t>.5||e?1-t:-1*t)/window.devicePixelRatio:0)}else return o}var vq={role:"role",selected:"aria-selected",multiselectable:"aria-multiselectable",busy:"aria-busy",colcount:"aria-colcount"};function Wc(o,e){var t=Object.keys(e);t.forEach(function(i){o&&o.setAttribute(vq[""+i],e[""+i])})}function mq(o,e){if(o){var t=at(o,e);t&&t.destroy()}}function WI(o,e,t,i,r){var n,s,a,l,h,u,c,d,p,f=r.getActiveSheet(),v=r.frozenRowCount(f),m=r.frozenColCount(f);if(i){var y=o<m?r.getSelectAllContent():r.getColumnHeaderContent();n=y.getElementsByTagName("th")[e],s=y.getElementsByTagName("col")[e],a=(o<m?r.getRowHeaderContent():r.getMainContent()).getElementsByTagName("col")[e]}else{n=s=v||m?r.getRow(o,null,m-1):r.getRow(o,r.getRowHeaderTable()),s.style.height=parseInt(t,10)>0?En(parseInt(t,10))+"px":"2px",a=r.getRow(o,null,m),a.style.height=parseInt(t,10)>0?En(parseInt(t,10))+"px":"0px";var S=void 0;if(f.showHeaders){var b=r.getRowHeaderContent().getElementsByClassName("e-row"),w=[];w[0]=b[e].getElementsByTagName("td")[0].cloneNode(!0),S=yq(r.getRowHeaderTable(),w,!1,r)+1}for(var I=r.getMainContent().getElementsByClassName("e-row"),x=[],M=0,D=0,A=o,L=0;L<I[e].getElementsByTagName("td").length;L++){var T=I[e].getElementsByTagName("td")[L];x[L]=T.cloneNode(!0);var k=G(A,L,f,!1,!0);if(M=k.value?Cb(r,k.style):M,D=D<M?M:D,T.getElementsByClassName("e-cf-databar")[0]){var F=Number(a.style.height.split("px")[0]);r.notify(Wi,{indexes:[A,L],cell:k,ele:T,isRender:!0,resizedRowHeight:F})}}var R=D+1,N=S>=R?S:R;parseInt(a.style.height,10)<N||n&&n.classList.contains("e-reach-fntsize")&&parseInt(a.style.height,10)===N?(f.showHeaders&&(n.classList.add("e-reach-fntsize"),s.style.lineHeight=parseInt(t,10)>=4?parseInt(t,10)-4+"px":parseInt(t,10)>0?parseInt(t,10)-1+"px":"0px"),a.style.lineHeight=parseInt(t,10)>0?parseInt(t,10)-1+"px":"0px"):(s&&s.style.removeProperty("line-height"),a.style.removeProperty("line-height"),n&&n.classList.contains("e-reach-fntsize")&&n.classList.remove("e-reach-fntsize"))}if(u=a.previousElementSibling,p=a.nextElementSibling,u&&(f.showHeaders&&(l=n.previousElementSibling,h=s.previousElementSibling),u=a.previousElementSibling),p&&(f.showHeaders&&(c=n.nextElementSibling,d=s.nextElementSibling),p=a.nextElementSibling),parseInt(t,10)<=0&&!(a.classList.contains("e-zero")||a.classList.contains("e-zero-start"))){if(u&&p)if(i?(f.showHeaders&&(s.style.width="2px"),a.style.width="0px"):(f.showHeaders&&(s.style.height="2px"),a.style.height="0px"),u.classList.contains("e-zero-start")?(f.showHeaders&&n.classList.add("e-zero-start"),a.classList.add("e-zero-start")):(f.showHeaders&&n.classList.add("e-zero"),a.classList.add("e-zero")),c&&!c.classList.contains("e-zero")&&!c.classList.contains("e-zero-last")&&(f.showHeaders&&n.classList.add("e-zero-last"),a.classList.add("e-zero-last")),u.classList.contains("e-zero-last")&&(f.showHeaders&&l.classList.remove("e-zero-last"),u.classList.remove("e-zero-last")),f.showHeaders&&l.classList.contains("e-zero")?(n.classList.contains("e-zero-end"),xn(h,-2,i)):f.showHeaders&&xn(h,-1,i),f.showHeaders&&l.classList.contains("e-zero-start")&&xn(s,-1,i),f.showHeaders&&c.classList.contains("e-zero"))if(n.classList.contains("e-zero-start"))for(;c;)if(c.classList.contains("e-zero")&&parseInt(d.style.height,10)!==0&&!i||parseInt(d.style.width,10)!==0&&i){i?(s.style.width=parseInt(s.style.width,10)-1+"px",d.style.width=parseInt(d.style.width,10)-1+"px"):(s.style.height=parseInt(s.style.height,10)-1+"px",d.style.height=parseInt(d.style.height,10)-1+"px"),c.classList.remove("e-zero"),c.classList.add("e-zero-start");break}else{var P=void 0;c.classList.remove("e-zero"),c.classList.add("e-zero-start"),i?(P=parseInt(c.getAttribute("aria-colindex"),10)-1,c=r.getColHeaderTable().getElementsByTagName("th")[P+1],d=r.getColHeaderTable().getElementsByTagName("col")[P+1]):(P=parseInt(c.getAttribute("aria-rowindex"),10)-1,c=r.getRowHeaderTable().getElementsByTagName("tr")[P+1],d=r.getRowHeaderTable().getElementsByTagName("tr")[P+1])}else xn(s,-2,i);else f.showHeaders&&(c.classList.contains("e-zero-end")?i?s.style.width="0px":s.style.height="0px":xn(d,-1,i));else if(u)i?(f.showHeaders&&(s.style.width="1px"),a.style.width="0px"):(f.showHeaders&&(s.style.height="1px"),a.style.height="0px"),f.showHeaders&&n.classList.add("e-zero-end"),a.classList.add("e-zero-end"),f.showHeaders&&n.classList.add("e-zero-last"),a.classList.add("e-zero-last"),f.showHeaders&&l.classList.contains("e-zero")?xn(h,-2,i):xn(h,-1,i);else if(c)if(n.classList.add("e-zero-start"),a.classList.add("e-zero-start"),c.classList.contains("e-zero")||(n.classList.add("e-zero-last"),a.classList.add("e-zero-last")),i?(s.style.width="1px",a.style.width="0px"):(s.style.height="1px",a.style.height="0px"),f.showHeaders&&c.classList.contains("e-zero"))for(;c;)if(c.classList.contains("e-zero")&&parseInt(d.style.width,10)!==0&&i||parseInt(d.style.height,10)!==0&&!i){i?(d.style.width=parseInt(d.style.width,10)-1+"px",s.style.width=parseInt(s.style.width,10)-1+"px"):(d.style.height=parseInt(d.style.height,10)-1+"px",s.style.height=parseInt(s.style.height,10)-1+"px"),c.classList.add("e-zero-start"),c.classList.remove("e-zero");break}else{var P=void 0;c.classList.add("e-zero-start"),c.classList.remove("e-zero"),i?(P=parseInt(c.getAttribute("aria-colindex"),10)-1,d=r.getColHeaderTable().getElementsByTagName("col")[P+1],c=r.getColHeaderTable().getElementsByTagName("th")[P+1]):(P=parseInt(c.getAttribute("aria-rowindex"),10)-1,d=r.getRowHeaderTable().getElementsByTagName("tr")[P+1],c=r.getRowHeaderTable().getElementsByTagName("tr")[P+1])}else f.showHeaders&&xn(d,-1,i)}else if(parseInt(t,10)>0){var O=En(parseInt(t,10))+"px";i?(s.style.width=O,a.style.width=O):(s.style.height=O,a.style.height=O),f.showHeaders&&l&&c?(l.classList.contains("e-zero")?n.classList.contains("e-zero")?i?(h.style.width=parseInt(h.style.width,10)+2+"px",s.style.width=parseInt(s.style.width,10)-1+"px"):(h.style.height=parseInt(h.style.height,10)+2+"px",s.style.height=parseInt(s.style.height,10)-1+"px"):xn(s,-1,i):n.classList.contains("e-zero")?xn(h,1,i):n.classList.contains("e-zero-start")&&(i?(h.style.width=parseInt(h.style.width,10)+1+"px",s.style.width=parseInt(s.style.width,10)-1+"px"):(h.style.height=parseInt(h.style.height,10)+1+"px",s.style.height=parseInt(s.style.height,10)-1+"px")),c.classList.contains("e-zero")?xn(s,-1,i):(n.classList.contains("e-zero")||n.classList.contains("e-zero-start"))&&xn(d,1,i),n.classList.contains("e-zero")&&n.classList.remove("e-zero"),n.classList.contains("e-zero-start")&&n.classList.remove("e-zero-start"),a.classList.contains("e-zero")&&a.classList.remove("e-zero"),a.classList.contains("e-zero-start")&&a.classList.remove("e-zero-start"),n.classList.contains("e-zero-last")&&n.classList.remove("e-zero-last"),a.classList.contains("e-zero-last")&&a.classList.remove("e-zero-last"),(l.classList.contains("e-zero")||l.classList.contains("e-zero-start"))&&(l.classList.add("e-zero-last"),u.classList.add("e-zero-last"))):f.showHeaders&&l?(l.classList.contains("e-zero")?n.classList.contains("e-zero")?i?(s.style.width=parseInt(s.style.width,10)-1+"px",h.style.width=parseInt(h.style.width,10)+2+"px"):(s.style.height=parseInt(s.style.height,10)-1+"px",h.style.height=parseInt(h.style.height,10)+2+"px"):xn(s,-1,i):n.classList.contains("e-zero")?xn(h,1,i):xn(s,-1,i),n.classList.contains("e-zero")&&n.classList.remove("e-zero"),n.classList.contains("e-zero-end")&&n.classList.remove("e-zero-end"),a.classList.contains("e-zero")&&a.classList.remove("e-zero"),a.classList.contains("e-zero-end")&&a.classList.remove("e-zero-end")):f.showHeaders&&c&&(c.classList.contains("e-zero")?xn(s,-1,i):n.classList.contains("e-zero-start")&&(xn(d,1,i),n.classList.remove("e-zero-start")),n.classList.contains("e-zero")&&n.classList.remove("e-zero"),a.classList.contains("e-zero")&&a.classList.remove("e-zero"),n.classList.contains("e-zero-start")&&n.classList.remove("e-zero-start"),a.classList.contains("e-zero-start")&&a.classList.remove("e-zero-start"))}}function xn(o,e,t){t?o.style.width=parseInt(o.style.width,10)+e+"px":o.style.height=parseInt(o.style.height,10)+e+"px"}function yq(o,e,t,i,r,n){var s=i.createElement("div",{className:i.element.className,styles:"display: block"}),a=i.createElement("table",{className:o.className+"e-resizetable",styles:"width: auto;height: auto"}),l=i.createElement("tr");t?e.forEach(function(p){var f=l.cloneNode();f.appendChild(p),a.appendChild(f)}):(e.forEach(function(p){l.appendChild(p.cloneNode(!0))}),a.appendChild(l)),s.appendChild(a),document.body.appendChild(s);var h,u,c=a.getBoundingClientRect().width,d=a.getBoundingClientRect().height;return n?(t&&parseInt(r,10)>c?h=c:h=parseInt(r,10),!t&&parseInt(r,10)>d?u=d:u=parseInt(r,10)):(u=d,h=c),document.body.removeChild(s),Math.ceil(t?h:u)}function Zr(o,e,t,i,r,n){var s=o.eventArgs,a,l,h,u,c,d,p,f,v,m,y,S,b,w=o.isFromUpdateAction||Ee(t);if(o.isUndoRedo){w=o.isFromUpdateAction=!0,delete o.isUndoRedo,e.notify(Ka,o);return}if(w&&!n){var I=s.address||s.range||s.pastedRange||s.addressCollection&&s.addressCollection[0]||s.dataRange,x=Ee(s.sheetIndex)?Ee(s.sheetIdx)?Ee(s.activeSheetIndex)?I?Gs(e,I):e.activeSheetIndex:s.activeSheetIndex:s.sheetIdx:s.sheetIndex;if(x!==e.activeSheetIndex){var M={sheet:ke(e,x),resolveAfterFullDataLoaded:!0,indexes:[0,0,0,0],promise:new Promise(function(ae){ae(function(){}())})};e.notify(ah,M),M.promise.then(function(){Zr(o,e,t,i,r,!0)});return}}var D,A,L,T=cn(e,s.index),k;switch(o.action){case"sorting":h={range:o.eventArgs.range,sortOptions:o.eventArgs.sortOptions,cancel:!1},u=new Promise(function(ae){ae(function(){}())}),c={args:h,promise:u},e.notify(If,c),c.promise.then(function(ae){e.serviceLocator.getService("cell").refreshRange(Qi(ae.range))});break;case"cellSave":d=o.eventArgs,D={element:d.element,value:d.value,oldValue:d.oldValue,address:d.address,displayText:d.displayText,formula:d.formula,originalEvent:d.originalEvent,format:d.format},p=D.formula?{formula:D.formula}:{value:D.value},e.updateCellInfo(p,D.address,!1,o.eventArgs,t),t===!0&&e.trigger("cellSave",D);break;case"addNote":case"editNote":case"deleteNote":k=Qi(o.eventArgs.address),t&&(sr(e,e.getActiveSheet(),{rowIdx:k[0],colIdx:k[1],preventEvt:!0,cell:{notes:o.eventArgs.notes}}),e.serviceLocator.getService("cell").refreshRange(Qi(s.address),!1,!1,!0,!0,cs(e)));break;case"cellDelete":A=px(e,o.eventArgs.address),FO(e,A.indices,A.sheetIndex);break;case"format":if(s.requestType==="CellFormat"){if(s.style&&s.style.border&&!g(s.borderType)){var F={};Object.assign(F,s.style,null,!0),s.style.border=void 0,e.notify(rr,{style:s.style,refreshRibbon:!0,range:s.range,onActionUpdate:!0,isUndoRedo:!0}),s.style.border=F.border,e.setBorder(s.style,s.range,s.borderType),s.style=F}else e.notify(rr,{style:s.style,refreshRibbon:!0,range:s.range,onActionUpdate:!0,isUndoRedo:!0});cr(function(){return e.selectRange(e.getActiveSheet().selectedRange)})}else e.numberFormat(s.format,s.range);break;case"clipboard":f=new Promise(function(ae){ae(function(){}())}),b=e.getAddressInfo(s.copiedRange),e.notify(s.copiedInfo.isCut?Cu:wu,{range:b.indices,sId:ke(e,b.sheetIndex).id,promise:u,invokeCopy:!0,isPublic:!0,isFromUpdateAction:!0}),f.then(function(){return e.notify(Ga,{range:Qi(s.pastedRange),sIdx:yt(e,Ws(s.pastedRange)),type:s.type,isAction:!1,isInternal:!0,isFromUpdateAction:!0})});break;case"gridLines":e.setSheetPropertyOnMute(e.sheets[s.sheetIdx],"showGridLines",s.isShow),e.serviceLocator.getService("sheet").toggleGridlines(),e.notify(Es,null);break;case"headers":e.setSheetPropertyOnMute(e.sheets[s.sheetIdx],"showHeaders",s.isShow),e.serviceLocator.getService("sheet").showHideHeaders(),e.notify(Es,null);break;case"resize":case"resizeToFit":w&&(m=e.sheets[s.sheetIndex],y=Rt(m,s.index),S=Ar(m,s.index),(s.isCol&&y&&y.hidden||S&&S.hidden)&&e.notify(Dn,{startIndex:s.index,endIndex:s.index,hide:!1,isCol:s.isCol,sheetIndex:s.sheetIndex})),s.isCol?s.hide===void 0?e.setColWidth(w&&!Ee(t)?s.oldWidth:s.width,s.index,s.sheetIndex):e.hideColumn(s.index,s.index,s.hide):(s.hide===void 0?e.setRowHeight(w&&!Ee(t)?s.oldHeight:s.height,s.index,s.sheetIndex):e.hideRow(s.index,s.index,s.hide),e.notify(Yy,{rowIndex:s.index}));break;case"renameSheet":e.setSheetPropertyOnMute(e.sheets[T],"name",s.value),e.notify($y,{items:e.element.querySelector(".e-sheet-tabs-items"),value:s.value,idx:T});break;case"hideSheet":e.notify(Ky,{sheetIndex:s.sheetIndex});break;case"showSheet":e.notify(wI,s);break;case"removeSheet":e.notify(qy,{index:s.index,isAction:!0,count:s.sheetCount,clicked:!0});break;case"gotoSheet":e.notify(CI,{selectedIndex:s.currentSheetIndex,previousIndex:s.previousSheetIndex});break;case"moveSheet":_y(e,s.position,s.sheetIndexes,null,w);break;case"wrap":vd(o.eventArgs.address,o.eventArgs.wrap,e);break;case"hideShow":s.isCol?e.notify(Dn,{startIndex:s.startIndex,endIndex:s.endIndex,isCol:!0,hide:t===!1?!s.hide:s.hide,sheetIndex:s.sheetIndex,hiddenIndexes:s.hiddenIndexes}):e.notify(Dn,{startIndex:s.startIndex,endIndex:s.endIndex,hide:t===!1?!s.hide:s.hide,sheetIndex:s.sheetIndex});break;case"replace":e.notify(Df,{value:s.compareValue,replaceValue:s.replaceValue,sheetIndex:s.sheetIndex,address:s.address});break;case"replaceAll":e.notify(ld,s);break;case"filter":u=new Promise(function(ae){ae(function(){}())}),t===!1?e.notify(Eo,{predicates:s.previousPredicates,range:s.range,sIdx:s.sheetIndex,promise:u,isInternal:!0}):e.notify(Eo,{predicates:s.predicates,range:s.range,sIdx:s.sheetIndex,promise:u,isInternal:!0,useFilterRange:s.useFilterRange,allowHeaderFilter:s.allowHeaderFilter}),r&&!w&&u.then(function(){e.notify(mt,he({isUndo:!t,isUndoRedo:!w},r))});break;case"insert":if(o.eventArgs.modelType==="Sheet")m=e;else if(m=ke(e,o.eventArgs.activeSheetIndex),!m)break;t===!1?e.notify(Mf,{model:m,start:o.eventArgs.index,isUndoRedo:!0,end:o.eventArgs.index+(o.eventArgs.model.length-1),modelType:o.eventArgs.modelType}):e.notify(ya,{model:m,start:o.eventArgs.index,end:o.eventArgs.index+(o.eventArgs.model.length-1),modelType:o.eventArgs.modelType,checkCount:t===void 0?o.eventArgs.sheetCount:null,activeSheetIndex:o.eventArgs.activeSheetIndex,isUndoRedo:!0,insertType:o.eventArgs.insertType,isFromUpdateAction:w,isRedo:t});break;case"delete":if(o.eventArgs.modelType==="Sheet")m=e;else if(m=ke(e,o.eventArgs.activeSheetIndex),!m)break;t===!1?e.notify(ya,{model:m,start:o.eventArgs.deletedModel,modelType:o.eventArgs.modelType,columnCellsModel:o.eventArgs.deletedCellsModel,definedNames:o.eventArgs.definedNames,activeSheetIndex:o.eventArgs.activeSheetIndex,isUndoRedo:!0,insertType:o.eventArgs.modelType==="Row"?"above":"before",conditionalFormats:o.eventArgs.conditionalFormats,prevAction:o.action,freezePane:s.freezePane}):e.notify(Mf,{model:m,start:o.eventArgs.startIndex,checkCount:o.eventArgs.sheetCount,end:o.eventArgs.endIndex,modelType:o.eventArgs.modelType,isUndoRedo:!0,insertType:o.eventArgs.modelType==="Row"?"above":"before"});break;case"validation":t===!1?e.notify(Vf,{range:s.range}):e.notify(To,{rules:{type:s.type,operator:s.operator,value1:s.value1,value2:s.value2,ignoreBlank:s.ignoreBlank,inCellDropDown:s.inCellDropDown},range:s.range,isAction:!0});break;case"removeHighlight":case"addHighlight":e.notify(Hf,{isRemoveHighlight:o.action==="removeHighlight",isPublic:!0});break;case"merge":o.eventArgs.isAction=!1,v=[];for(var R=0,N=s.model.length;R<N;R++){v.push({cells:[]});for(var P=0,O=s.model[R].cells.length;P<O;P++)v[R].cells[P]={},Object.assign(v[R].cells[P],s.model[R].cells[P])}if(t===!1&&s.mergeCollection)for(var z=void 0,H=0;H<s.mergeCollection.length;H++)z={range:null},Object.assign(z,s),z.range=s.mergeCollection[H],e.notify(Mn,z);else e.notify(Mn,o.eventArgs);if(e.calculationMode==="Manual"&&t&&e.getActiveSheet().isSheetCalculated)for(var H=0;H<s.model.length;H++)for(var Q=s.model[H].cells,$=0;$<Q.length;$++){var U=s.model[H].cells[$].value;v[H].cells[$].value=!g(U)&&U!==""?U:v[H].cells[$].value}s.model=v;break;case"clear":L={options:o.eventArgs,isFromUpdateAction:w},e.notify(_f,L),!w&&L.cfClearActionArgs&&(s.cfClearActionArgs.previousConditionalFormats=L.cfClearActionArgs.previousConditionalFormats,s.cfClearActionArgs.conditionalFormats=L.cfClearActionArgs.conditionalFormats);break;case"conditionalFormat":t===!1?e.notify(qa,{range:s.range,cfModel:{type:s.type,cFColor:s.cFColor,value:s.value},sheetIdx:s.sheetIdx,isUndoRedo:!s.cancel,isFromUpdateAction:w}):e.notify(hd,{cfModel:{type:s.type,cFColor:s.cFColor,value:s.value,range:s.range},sheetIdx:s.sheetIdx,isUndoRedo:!0,isFromUpdateAction:w});break;case"clearCF":if(t===!1)e.notify(qa,{oldCFModel:s.previousConditionalFormats,updatedCFModel:s.conditionalFormats,range:s.selectedRange,isUndo:!0,sheetIdx:s.sheetIdx});else{var ie={range:s.selectedRange,sheetIdx:s.sheetIdx,isUndoRedo:!0,isFromUpdateAction:w};e.notify(qa,ie),w||(s.previousConditionalFormats=ie.oldCFModel,ie.updatedCFModel.length?s.conditionalFormats=ie.updatedCFModel:delete s.conditionalFormats)}break;case"insertImage":t===!1?e.notify(ga,{id:o.eventArgs.id,sheetIdx:o.eventArgs.sheetIndex+1,range:o.eventArgs.range,preventEventTrigger:!0}):e.notify(Ya,{options:{src:o.eventArgs.imageData,height:o.eventArgs.imageHeight,width:o.eventArgs.imageWidth,id:o.eventArgs.id},range:o.eventArgs.range,isPublic:!1,isUndoRedo:!0});break;case"deleteImage":t===!1?e.notify(Ya,{options:{src:o.eventArgs.imageData,height:o.eventArgs.imageHeight,width:o.eventArgs.imageWidth,id:o.eventArgs.id},range:o.eventArgs.address,isPublic:!1,isUndoRedo:!0}):e.notify(ga,{id:o.eventArgs.id,range:o.eventArgs.address,preventEventTrigger:!0});break;case"imageRefresh":l=document.getElementById(o.eventArgs.id),t===!1?e.notify(Sd,{prevTop:o.eventArgs.currentTop,prevLeft:o.eventArgs.currentLeft,currentTop:o.eventArgs.prevTop,currentLeft:o.eventArgs.prevLeft,id:o.eventArgs.id,currentHeight:o.eventArgs.prevHeight,currentWidth:o.eventArgs.prevWidth,requestType:"imageRefresh",prevHeight:o.eventArgs.currentHeight,prevWidth:o.eventArgs.currentWidth,isUndoRedo:!0}):(o.eventArgs.isUndoRedo=!0,e.notify(Sd,o.eventArgs)),l&&(l.style.height=t===!1?o.eventArgs.prevHeight+"px":o.eventArgs.currentHeight+"px",l.style.width=t===!1?o.eventArgs.prevWidth+"px":o.eventArgs.currentWidth+"px",l.style.top=t===!1?o.eventArgs.prevTop+"px":o.eventArgs.currentTop+"px",l.style.left=t===!1?o.eventArgs.prevLeft+"px":o.eventArgs.currentLeft+"px");break;case"insertChart":if(t===!1)e.notify(Eu,{id:s.id,range:s.range,isUndoRedo:!0});else{var ne=[{type:s.type,theme:s.theme,markerSettings:s.markerSettings,isSeriesInRows:s.isSeriesInRows,range:s.range,id:s.id,height:s.height,width:s.width,top:s.top,left:s.left}];e.notify(oh,{chart:ne,isUndoRedo:!1,range:s.posRange})}break;case"deleteChart":if(t===!1){var te=[{type:s.type,theme:s.theme,markerSettings:s.markerSettings,dataLabelSettings:s.dataLabelSettings,title:s.title,legendSettings:s.legendSettings,primaryXAxis:s.primaryXAxis,primaryYAxis:s.primaryYAxis,isSeriesInRows:s.isSeriesInRows,range:s.range,id:s.id,height:s.height,width:s.width,top:s.top,left:s.left}];e.notify(oh,{chart:te,isUndoRedo:!1,range:s.posRange})}else e.notify(Eu,{id:s.id,range:s.range,isUndoRedo:!0});break;case"chartRefresh":a=document.getElementById(o.eventArgs.id),a&&(a.style.height=t===!1?o.eventArgs.prevHeight+"px":o.eventArgs.currentHeight+"px",a.style.width=t===!1?o.eventArgs.prevWidth+"px":o.eventArgs.currentWidth+"px",a.style.top=t===!1?o.eventArgs.prevTop+"px":o.eventArgs.currentTop+"px",a.style.left=t===!1?o.eventArgs.prevLeft+"px":o.eventArgs.currentLeft+"px"),t===!1?(e.notify(ou,he({},o.eventArgs,{currentColIdx:o.eventArgs.prevColIdx,currentHeight:o.eventArgs.prevHeight,currentLeft:o.eventArgs.prevLeft,currentRowIdx:o.eventArgs.prevRowIdx,currentTop:o.eventArgs.prevTop,currentWidth:o.eventArgs.prevWidth,prevColIdx:o.eventArgs.currentColIdx,prevHeight:o.eventArgs.currentHeight,prevLeft:o.eventArgs.currentLeft,prevRowIdx:o.eventArgs.currentRowIdx,prevTop:o.eventArgs.currentTop,prevWidth:o.eventArgs.currentWidth,isUndoRedo:!0})),e.notify(th,{height:o.eventArgs.prevHeight.toString(),width:o.eventArgs.prevWidth.toString(),overlayEle:a})):(o.eventArgs.isUndoRedo=!0,e.notify(ou,o.eventArgs),e.notify(th,{height:o.eventArgs.currentHeight.toString(),width:o.eventArgs.currentWidth.toString(),overlayEle:a}));break;case"chartDesign":e.notify(lu,o.eventArgs);break;case"autofill":w&&s.undoArgs&&(s.undoArgs.isFromUpdateAction=s.undoArgs.isUndo=s.undoArgs.preventEvt=!0,s.undoArgs.isPublic=!0,e.notify(Ka,s.undoArgs)),e.notify(cd,{fillRange:o.eventArgs.fillRange,dataRange:o.eventArgs.dataRange,fillType:o.eventArgs.fillType,direction:o.eventArgs.direction,cells:o.eventArgs.beforeActionData});break;case"removeValidation":t!==!1&&e.notify(Vf,{range:s.range,isCol:s.isColSelected});break;case"addDefinedName":if(t===!1)e.notify(xt,{action:"removeDefinedName",isRemoved:!1,definedName:s.name,scope:s.scope,isEventTrigger:!0});else{var oe={name:s.name,refersTo:s.refersTo,scope:s.scope,comment:s.comment};e.notify(xt,{action:"addDefinedName",isAdded:!1,definedName:oe,isEventTrigger:!0})}break;case"hyperlink":e.notify(od,{hyperlink:s.hyperlink,cell:s.address,displayText:s.displayText,isUndoRedo:!0}),e.serviceLocator.getService("cell").refreshRange(Qi(s.address),!1,!1,!1,!0,cs(e));break;case"removeHyperlink":e.notify(zf,{range:s.address,preventEventTrigger:!0});break;case"freezePanes":e.freezePanes(s.row,s.column,s.sheetIndex);break;case"duplicateSheet":KI(e,s.sheetIndex,null,w);break;case"protectSheet":s.isProtected?e.notify($c,s):(e.setSheetPropertyOnMute(ke(e,s.sheetIndex),"password",""),e.notify(df,{isActive:!0,sheetIndex:s.sheetIndex}));break;case"protectWorkbook":s.isProtected?e.notify(LI,s):e.notify(kI,null);break;case"lockCells":e.notify(Iy,s)}}function NO(o,e,t,i){for(var r=o.sheets[i],n=r.ranges,s,a=0,l=n.length;a<l;a++)if(n[a].template&&(s=J(n[a].address.length?n[a].address:n[a].startCell),s[0]<=e&&s[1]<=t&&s[2]>=e&&s[3]>=t))return!0;return!1}function va(o,e,t,i,r,n,s,a){s===void 0&&(s=!0);var l=li(e,i,!0),h=En(t);if(!a){var u=o.frozenColCount(e);if(r=r||(e.frozenRows?o.getRow(i,null,u):o.getRow(i)),r&&(r.style.height=h+"px"),e.frozenColumns)n=n||o.getRow(i,null,u-1);else{var c=o.frozenRowCount(e);n=n||o.getRow(i,i<c?o.sheetModule.getSelectAllTable():o.getRowHeaderTable())}n&&(n.style.height=h+"px")}bb(e,i,t),o.setProperties({sheets:o.sheets},!0),s&&o.notify(An,{rowIdx:i,threshold:h-l})}function Cb(o,e,t,i){t===void 0&&(t=1);var r=e&&e.fontSize||o.cellStyle.fontSize,n=r.indexOf("pt")>-1?parseInt(r,10)/.75:parseInt(r,10),s=n*(i||tM(e&&e.fontFamily?e:o.cellStyle))*t;return Math.ceil(s%1>.9?s+1:s)}function tM(o){var e=pq;return o&&(o.fontFamily==="Arial Black"||o.fontFamily==="Comic Sans MS"?e=1.44:o.fontFamily==='"Segoe UI", sans-serif'&&(e=1.36)),e}function Vr(o,e,t,i){e||(e=t);var r=document.createElement("canvas"),n=r.getContext("2d");return n.font=(e.fontStyle||t.fontStyle)+" "+(e.fontWeight||t.fontWeight)+" "+(e.fontSize||t.fontSize)+" "+(e.fontFamily||t.fontFamily),i?n.measureText(o).width:En(n.measureText(o).width,!0)}function qf(o,e,t,i){var r,n,s,a,l=0,h=o.toString().split(" "),u=Vr(" ",t,i),c,d,p=0,f=0,v=0,m=function(S,b){l&&p++,r/e>=1&&(S.split("").forEach(function(w){a=Vr(w,t,i,!0),s+=a,s>e&&(p++,s=a)}),r=En(s,!0)),b||y(r),l=r},y=function(S){r+=(S+u)/e>=1?0:u};return h.forEach(function(S){if(s=0,a=0,r=Vr(S,t,i),d=(l+r)/e,d>1)if(n=S.split("-"),n.length>1){var b=n.length-1;n.forEach(function(w,I){s=0,a=0,c||(c=Vr("-",t,i)),r=Vr(w,t,i),I<b&&(r+=c),d=(l+r)/e,d>=1?m(w,n[n.length-1]!==w):(n[n.length-1]===w&&h[h.length-1]!==S&&y(l+r),l+=r)})}else m(S,!1);else y(l+r),l+=r}),l&&(f=(l-u)/e,v=parseFloat(f.toString().split(".")[0]),p+=f+.05>=v+1?Math.ceil(f)+1:Math.ceil(f)),p}function bq(o,e,t){var i=0,r=G(o,e,t,null,!0),n=G(o,e+1,t,null,!0);return r.style&&(r.style.border?i=(e===0?2:1)*parseFloat(r.style.border.split("px")[0]):(e===0&&r.style.borderLeft&&(i=parseFloat(r.style.borderLeft.split("px")[0])),r.style.borderRight&&(i+=parseFloat(r.style.borderRight.split("px")[0])))),!(r.style&&(r.style.border||r.style.borderRight))&&n.style&&n.style.borderLeft&&(i+=parseFloat(n.style.borderLeft.split("px")[0])),i>0&&i<1?1:i}function iM(o,e,t){var i=0,r=G(o,e,t,null,!0);r.style&&(r.style.border?i=(o===0?2:1)*parseFloat(r.style.border.split("px")[0]):(o===0&&r.style.borderTop&&(i=parseFloat(r.style.borderTop.split("px")[0])),r.style.borderBottom&&(i+=parseFloat(r.style.borderBottom.split("px")[0]))));var n=G(o+1,e,t,null,!0);return!(r.style&&(r.style.border||r.style.borderBottom))&&n.style&&n.style.borderTop&&(i+=parseFloat(n.style.borderTop.split("px")[0])),Math.ceil(i)||1}function Au(o,e,t,i){return i===void 0&&(i=t),Ci(o,t,i,!0)-En(4+(bq(e,t,o)||1))}function id(o,e,t,i,r,n,s){return Cb(o,r,n,s)+iM(e,t,i)}function sh(o,e,t,i){o.maxHgts[e]||(o.maxHgts[e]={}),o.maxHgts[e][t]=i}function Mo(o,e){var t=0,i=o.maxHgts[e];return i&&Object.keys(i).forEach(function(r){i[""+r]>t&&(t=i[""+r])}),t}function Fe(o){if(!document.activeElement.classList.contains("e-text-findNext-short"))if(B.isIE){var e=window.scrollX,t=window.scrollY;o.focus(),window.scrollTo(e,t)}else{if(o.classList.contains("e-input")){var i=o,r=i.value.length;i.setSelectionRange(r,r)}o.focus({preventScroll:!0})}}function ko(o,e){for(var t=o.getActiveSheet(),i,r=g(e)?tt(J(t.selectedRange)):e,n=r[0];n<=r[2];n++)for(var s=r[1];s<=r[3];s++){var a=G(n,s,t);if(un(a,Rt(t,s))){i=!0;break}}return i}function qI(o){return o.includes(" ")}function FO(o,e,t){for(var i=ke(o,t),r,n,s,a,l,h=t===o.activeSheetIndex,u,c=i.conditionalFormats&&i.conditionalFormats.length&&[].slice.call(i.conditionalFormats),d=[],p=!1,f=e[0],v=e[2];f<=v;f++)if(!Jn(i,f))for(var m=e[1],y=e[3];m<=y;m++){var S={cellIdx:[f,m],isUnique:!1,uniqueRange:""};if(o.notify(gu,S),r=!1,S.uniqueRange!==""){var b=Qi(S.uniqueRange);r=G(b[0],b[1],i).value==="#SPILL!"}var w=f===v&&m===y;if(!S.isUnique||r){if(n=G(f,m,i),n&&n.value===0||n&&n.value&&(g(n.value)||n.value!=="")){p=!1,s={},n.formula&&(s.formula=""),(n.value||n.value===0)&&(s.value=""),n.hyperlink&&(s.hyperlink="");var I={sheet:i,cell:n,rowIdx:f,colIdx:m};if((n.colSpan>1||n.rowSpan>1)&&xb(I),a=o.getCell(I.rowIdx,I.colIdx),l={cell:s,rowIdx:f,colIdx:m,valChange:!0,uiRefresh:h,td:a,cellDelete:!0,isDelete:!w,deletedRange:e},!Object.keys(s).length||sr(o,i,l))continue;c&&!u&&(u=l.isFormulaDependent,u||kf(c,d,f,m)),a&&(a.querySelector(".e-cf-databar")&&a.removeChild(a.querySelector(".e-cf-databar")),a.querySelector(".e-iconsetspan")&&a.removeChild(a.querySelector(".e-iconsetspan")))}else if(!p&&l&&(p=w,l.isDelete=!w,!Object.keys(s).length||sr(o,i,l)))continue}}(d.length||u)&&h&&o.notify(Wi,{cfModel:!u&&d,refreshAll:u,isAction:!0,isEdit:!0})}function rd(o,e){for(var t=0,i=o.getActiveSheet(),r=(i.frozenRows?o.viewport.height-o.sheetModule.getColHeaderHeight(i,!0):o.viewport.height)-17||20,n=e;;n++)if(t+=li(i,n,!0),t>=r)return{index:n,height:t}}function oy(o,e){for(var t=0,i=o.getActiveSheet(),r=o.getMainContent().parentElement.offsetWidth-o.sheetModule.getRowHeaderWidth(i)-o.sheetModule.getScrollSize(),n=e;;n++)if(t+=_r(i,n,null,!0),t>=r)return n}function dh(o){if(window.devicePixelRatio%1>0){var e=o*window.devicePixelRatio%1;return o+(e?(e>.5?1-e:-1*e)/window.devicePixelRatio:0)}return o}function eh(o){for(var e,t=[],i=o.getActiveSheet().name,r=0,n=o.chartColl.length;r<n;r++)if(e=o.chartColl[r],i===Ws(e.range)){var s={clientY:e.top,isImage:!0},a={clientX:e.left,isImage:!0};o.notify(Ys,s),o.notify(Qs,a),t.push({chart:e,chartRowIdx:s.clientY,chartColIdx:a.clientX})}return t}function OO(o){return/^[A-Za-z]+:[A-Za-z]+$/.test(o)}function Sq(o){return/^[0-9]+:[0-9]+$/.test(o)}function us(o){o.forEach(function(e){e&&e.parentNode&&e.parentNode.removeChild(e)})}var RO=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),GI=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Cq=function(o){RO(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return GI([C(!1)],e.prototype,"isFinite",void 0),GI([C(!0)],e.prototype,"enableVirtualization",void 0),e}(Re),wq=function(o){RO(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return GI([C("Multiple")],e.prototype,"mode",void 0),e}(Re),xq=function(){function o(e){this.colGroupWidth=30,this.parent=e,this.col=e.createElement("col"),this.rowRenderer=e.serviceLocator.getService("row"),this.cellRenderer=e.serviceLocator.getService("cell"),this.addEventListener()}return o.prototype.refreshSelectALLContent=function(){var e,t=this.parent.getActiveSheet();if(t.frozenColumns||t.frozenRows){var i=this.getSelectAllTable().querySelector("thead"),r=this.rowRenderer.render();i.appendChild(r),e=this.parent.createElement("th",{className:"e-select-all-cell"}),r.appendChild(e)}else e=this.headerPanel.firstElementChild,e.classList.add("e-select-all-cell");e.appendChild(this.parent.createElement("button",{className:"e-selectall",id:this.parent.element.id+"_select_all",attrs:{"aria-label":this.parent.serviceLocator.getService(fe).getConstant("SelectAll"),type:"button"}}))},o.prototype.updateLeftColGroup=function(e,t){e&&(this.colGroupWidth=e),t||(t=this.getRowHeaderPanel());var i=t.querySelector("table"),r=this.parent.getActiveSheet(),n=document.createDocumentFragment(),s;if(e)i.querySelector("colgroup").firstElementChild.style.width=this.colGroupWidth+"px";else{s=this.parent.createElement("colgroup");var a=this.col.cloneNode();a.style.width=this.colGroupWidth+"px",n.appendChild(a),s.appendChild(n),i.insertBefore(s,i.querySelector("tbody"))}(r.frozenRows||r.frozenColumns)&&(i=this.getSelectAllTable(),e?i.querySelector("colgroup").firstElementChild.style.width=this.colGroupWidth+"px":i.insertBefore(s.cloneNode(!0),i.querySelector("thead"))),this.setPanelWidth(r,t),this.setPanelHeight(r)},o.prototype.setPanelWidth=function(e,t,i){var r=this.getScrollSize(!0),n=this.getRowHeaderWidth(e),s=this.parent.enableRtl,a=s?"right":"left",l,h=this.getColHeaderPanel(),u=this.getContentPanel();if(i&&(l=s?"left":"right",u.style[""+l]=h.style[""+l]=""),e.frozenColumns){var c=document.getElementById(this.parent.element.id+"_sheet").getElementsByClassName("e-frozen-column")[0];c.style.height="calc(100% - "+r+"px)",i&&(c.style[""+l]=""),c.style[""+a]=n-En(1)+"Px",c.style.display=""}var d="calc(100% - "+n+"px)";this.setHeaderPanelWidth(this.getSelectAllContent(),n),h.style.width=d,h.style[""+a]=n+"px",this.setHeaderPanelWidth(t,n),u.style.width=d,u.style[""+a]=n+"px";var p=this.contentPanel.nextElementSibling?this.contentPanel.nextElementSibling:null;p&&(r?p.style.height=r+1+"px":(p.style.height="1px",p.style.borderTopWidth="0px"),p=p.firstElementChild,i&&(p.style[""+l]=""),p.style[""+a]=n+"px",p.style.width=d,B.userAgent.indexOf("Mac OS")>-1&&B.info.name==="safari"&&(p.style.height="7px",p.style.top="-7px"))},o.prototype.getScrollSize=function(e){var t=parseInt(this.headerPanel.style[this.parent.enableRtl?"margin-left":"margin-right"],10);return t?t+(e?1:0):0},o.prototype.setHeaderPanelWidth=function(e,t){var i=[].slice.call(e.querySelectorAll("col.e-empty"));i.forEach(function(r){t+=parseInt(r.style.width,10)}),e.style.width=t+"px"},o.prototype.setPanelHeight=function(e){var t=this.getScrollSize(!0),i=this.contentPanel,r=this.headerPanel;if(e.frozenRows){var n=this.getColHeaderHeight(e);!e.showHeaders&&!e.frozenColumns?r.style.height=n+"px":r.style.height="",i.style.height="calc(100% - "+(n+t)+"px)";var s=document.getElementById(this.parent.element.id+"_sheet").getElementsByClassName("e-frozen-row")[0];s.style.width=B.isDevice?"100%":"calc(100% - "+t+"px)",s.style.top=n-1-(e.showHeaders?1:0)+"px",s.style.display=""}else i.style.height="calc(100% - "+((e.showHeaders?En(31):0)+t)+"px)"},o.prototype.renderPanel=function(){this.contentPanel=this.parent.createElement("div",{className:"e-main-panel",attrs:{tabindex:"0"}});var e=this.parent.getActiveSheet(),t=this.parent.element.id,i=document.createDocumentFragment(),r=this.parent.createElement("div",{className:"e-row-header",id:t+"_row_header"});i.appendChild(r),this.initHeaderPanel(),this.parent.allowScrolling&&this.parent.scrollModule.setPadding();var n=document.getElementById(this.parent.element.id+"_sheet");e.frozenColumns&&n.classList.add("e-frozen-columns"),e.frozenRows&&n.classList.add("e-frozen-rows"),this.updateHideHeaders(e,n),e.showGridLines||n.classList.add("e-hide-gridlines");var s=this.parent.createElement("div",{className:"e-sheet-content",id:t+"_main_content"});i.appendChild(s),this.parent.allowScrolling||(s.style.overflow="hidden"),e.frozenRows&&n.appendChild(this.parent.createElement("div",{className:"e-frozen-row",styles:"display: none"})),e.frozenColumns&&n.appendChild(this.parent.createElement("div",{className:"e-frozen-column",styles:"display: none"})),B.userAgent.indexOf("Mac OS")>-1&&B.info.name==="safari"&&n.classList.add("e-mac-safari"),this.contentPanel.appendChild(i)},o.prototype.initHeaderPanel=function(){var e=this.parent.element.id,t=document.createDocumentFragment();this.headerPanel=this.parent.createElement("div",{className:"e-header-panel"});var i=this.parent.createElement("div",{className:"e-selectall-container",id:e+"_selectall"});t.appendChild(i);var r=this.parent.createElement("div",{className:"e-column-header",id:e+"_col_header"});t.appendChild(r),this.headerPanel.appendChild(t)},o.prototype.createHeaderTable=function(){var e=this.contentPanel.querySelector(".e-row-header"),t=this.parent.getActiveSheet();(t.frozenRows||t.frozenColumns)&&this.updateTable(t.frozenRows?["thead","tbody"]:["thead"],"selectall",this.headerPanel.querySelector(".e-selectall-container")),this.updateTable(t.frozenRows?["thead","tbody"]:["thead"],"colhdr",this.headerPanel.querySelector(".e-column-header")),this.updateTable(["tbody"],"rowhdr",e),this.updateLeftColGroup(null,e)},o.prototype.updateTable=function(e,t,i){var r=this,n=document.createDocumentFragment(),s=this.parent.createElement("table",{className:"e-table e-"+t+"-table",attrs:{role:"grid"}});e.forEach(function(a){n.appendChild(r.parent.createElement(a))}),s.appendChild(n),i.appendChild(s)},o.prototype.renderTable=function(e){var t=this,i,r,n,s=this.parent.getActiveSheet(),a,l,h=[],u=document.createDocumentFragment();if(u.appendChild(this.headerPanel),u.appendChild(this.contentPanel),this.parent.allowScrolling){var c=this.parent.createElement("div",{className:"e-scrollbar"});c.appendChild(this.parent.createElement("div",{className:"e-scroller"})),u.appendChild(c)}this.createHeaderTable(),this.updateTable(["tbody"],"content",this.contentPanel.lastElementChild);var d=this.parent.createElement("colgroup"),p,f=this.contentPanel.querySelector(".e-sheet-content tbody");this.refreshSelectALLContent();var v=this.getSelectAllContent().querySelector("colgroup"),m=this.getRowHeaderPanel().querySelector("colgroup"),y=this.getSelectAllContent().querySelector("thead .e-header-row"),S=this.contentPanel.querySelector(".e-row-header tbody"),b=this.getSelectAllContent().querySelector("tbody"),w=this.headerPanel.querySelector(".e-column-header thead"),I=this.headerPanel.querySelector(".e-column-header tbody"),x=this.rowRenderer.render();w.appendChild(x),this.getColHeaderTable().insertBefore(d,w);var M=this.parent.frozenRowCount(s),D=this.parent.frozenColCount(s),A=se(s,D-1,!1,"columns");this.parent.notify(Hx,{top:e.top,left:e.left});var L=s.colCount.toString(),T=s.colCount.toString(),k=e.top&&e.left?"RowColumn":e.top?"Row":e.left?"Column":"";this.parent.getColHeaderTable().setAttribute("aria-colcount",L),this.parent.getRowHeaderTable().setAttribute("aria-rowcount",T);var F;Ie(this.parent.getContentTable(),{"aria-rowcount":T,"aria-colcount":L}),e.cells.forEach(function(R,N){i=J(N),(i[1]===e.indexes[1]||!r)&&(i[1]===e.indexes[1]&&(n=t.rowRenderer.render(i[0],!0)),D&&M&&i[1]<D&&i[0]<M?(F=b.querySelector(".e-empty"),F?b.insertBefore(n,F):b.appendChild(n),r=n):D&&i[1]<D?(S.appendChild(n),r=n):(r=t.rowRenderer.render(i[0]),M&&i[0]<M?(F=I.querySelector(".e-empty"),F?I.insertBefore(r,F):I.appendChild(r)):f.appendChild(r),i[1]===e.indexes[1]&&(M&&i[0]<M?b.appendChild(n):S.appendChild(n))),i[1]===e.indexes[1]&&t.cellRenderer.renderRowHeader(i[0],n)),l={colIdx:i[1],rowIdx:i[0],cell:R,mergeBorderRows:h,address:N,lastCell:i[1]===e.indexes[3],isHeightCheckNeeded:!0,row:r,hRow:n,pRow:r.previousSibling,pHRow:n.previousSibling,isRefreshing:e.isRefreshing,first:k?k.includes("Row")?i[0]===e.indexes[0]?"Row":k.includes("Column")&&i[1]===e.indexes[1]?"Column":"":i[1]===e.indexes[1]?"Column":"":""},a=t.cellRenderer.render(l);var P=t.parent.scrollSettings.enableVirtualization&&t.parent.viewport.topIndex!==se(s,0,!0),O=t.parent.scrollSettings.enableVirtualization&&t.parent.viewport.leftIndex!==se(s,0,!0,"columns");if(P&&t.checkRowMerge(i,e.indexes,a,R,s),O&&t.checkColMerge(i,e.indexes,a,R,s),D&&i[1]===A&&(r=null),i[0]===e.indexes[0])if(D&&i[1]<D){p=t.updateCol(s,i[1],v);var z=m.querySelector(".e-empty");z?m.insertBefore(p.cloneNode(!0),z):m.appendChild(p.cloneNode(!0)),t.cellRenderer.renderColHeader(i[1],y)}else t.updateCol(s,i[1],d),t.cellRenderer.renderColHeader(i[1],x)}),this.parent.isReact&&this.parent.renderReactTemplates(),_c(this.parent,h),f.parentElement.insertBefore(d.cloneNode(!0),f),cr(function(){if(t.parent){var R=t.parent.getMainContent(),N=document.getElementById(t.parent.element.id+"_sheet");if(N.childElementCount&&N.querySelector(".e-header-panel")!==t.headerPanel)for(var P=N.children,O=0;O<P.length;O++)!P[O].classList.contains("e-frozen-row")&&!P[O].classList.contains("e-frozen-column")&&!P[O].classList.contains("e-ss-overlay")&&N.removeChild(P[O]);if(N.appendChild(u),N.style.backgroundColor="",s.conditionalFormats&&s.conditionalFormats.length&&t.parent.notify(Wi,{indexes:e.indexes}),t.checkRowHeightChanged(e,s),e.top&&(R.parentElement.scrollTop=e.top),e.left&&(R.scrollLeft=e.left,t.parent.getColumnHeaderContent().scrollLeft=e.left),t.parent.notify(In,e),t.checkTableWidth(s),t.parent.notify(fi,{action:"renderEditor",initLoad:e.initLoad&&!t.parent.isOpen}),!e.initLoad&&!t.parent.isOpen&&t.parent.hideSpinner(),Wc(R,{busy:!1}),t.parent.trigger(Y6,{}),t.parent.isEdit&&t.parent.notify(MI,null),e.openOptions&&e.openOptions.eventArgs&&e.openOptions.eventArgs.triggerEvent&&t.parent.trigger("openComplete",{response:e.openOptions}),e.initLoad){var z=!0;if(t.parent.scrollSettings.enableVirtualization){for(var O=0;O<s.ranges.length;O++)if(s.ranges[O].info.count-1>t.parent.viewport.bottomIndex){z=!1;break}}z?t.parent.isReact?setTimeout(function(){t.parent&&t.triggerCreatedEvent()}):t.triggerCreatedEvent():t.parent.isOpen||t.parent.hideSpinner()}}})},o.prototype.triggerCreatedEvent=function(){this.parent.isOpen||this.parent.hideSpinner(),this.parent.createdHandler&&(this.parent.createdHandler.observers?(this.parent.created.observers=this.parent.createdHandler.observers,this.parent.isAngular&&this.parent.createdHandler.currentObservers&&(this.parent.created.currentObservers=this.parent.createdHandler.currentObservers)):this.parent.setProperties({created:this.parent.createdHandler},!0),this.parent.createdHandler=void 0,this.parent.trigger(lx,null),this.parent&&this.parent.notify(uh,null)),this.parent&&this.parent.notify(mI,null)},o.prototype.checkRowHeightChanged=function(e,t){var i={top:e.top,left:e.left,sheet:t};this.parent.notify(PI,i),e.top!==i.top&&(this.parent.scrollModule&&this.parent.scrollModule.offset.top.idx&&i.top-e.top<li(t,this.parent.scrollModule.offset.top.idx)&&(this.parent.scrollModule.offset.top.size=i.top),e.top=i.top),e.left!==i.left&&(this.parent.scrollModule&&this.parent.scrollModule.offset.left.idx&&i.left-e.left<_r(t,this.parent.scrollModule.offset.left.idx)&&(this.parent.scrollModule.offset.left.size=i.left),e.left=i.left)},o.prototype.checkTableWidth=function(e){if(this.parent.scrollSettings.isFinite&&!this.parent.scrollSettings.enableVirtualization&&e.colCount-1===this.parent.viewport.rightIndex){var t=Ci(e,this.parent.viewport.leftIndex+this.parent.frozenColCount(e),this.parent.viewport.rightIndex),i=this.getRowHeaderWidth(e),r=this.getScrollSize();t<this.contentPanel.getBoundingClientRect().width-i-r?(this.getContentPanel().style.width=t+"px",this.getColHeaderPanel().style.width=t+"px"):this.getContentPanel().style.width.includes("calc")||(this.getContentPanel().style.width="calc(100% - "+i+"px)",this.getColHeaderPanel().style.width="calc(100% - "+i+"px)")}},o.prototype.clearCFResult=function(e){e.conditionalFormats&&e.conditionalFormats.length&&e.conditionalFormats.forEach(function(t){delete t.result})},o.prototype.refreshColumnContent=function(e){var t=this,i,r=0,n=this.parent.getActiveSheet(),s,a=[],l=document.createDocumentFragment(),h=document.createDocumentFragment(),u=this.parent.element.querySelector(".e-sheet-content tbody"),c=this.parent.element.querySelector(".e-column-header tbody"),d=this.parent.element.querySelector(".e-sheet-content colgroup");d=d.cloneNode(),l.appendChild(d),u=l.appendChild(u.cloneNode(!0));var p=d.cloneNode();h.appendChild(p);var f=this.parent.element.querySelector(".e-column-header thead");f=h.appendChild(f.cloneNode(!0));var v=f.querySelector("tr");v.innerText="";var m=this.parent.frozenRowCount(n),y=this.parent.frozenColCount(n);m&&(c=h.appendChild(c.cloneNode(!0)));var S=se(n,m-1,!1),b=this.parent.scrollSettings.enableVirtualization&&this.parent.viewport.topIndex!==se(n,0,!0);this.clearCFResult(n),e.cells.forEach(function(I,x){var M=J(x);if(M[0]===e.indexes[0]){var D=t.updateCol(n,M[1],p);d.appendChild(D.cloneNode()),t.cellRenderer.renderColHeader(M[1],v)}if(M[1]-y===e.indexes[1])if(i=M[0]<m?c.children[r]:u.children[r],i)i.innerText="",r++;else return;if(i){s={colIdx:M[1],rowIdx:M[0],cell:I,address:x,row:i,pRow:i.previousSibling,first:!e.skipUpdateOnFirst&&M[1]===e.indexes[1]?"Column":b&&M[0]===e.indexes[0]?"Row":"",isRefreshing:!0,mergeBorderRows:a};var A=t.cellRenderer.render(s);t.checkColMerge(M,e.indexes,A,I,n),m&&M[0]===S&&(r=0)}});var w=function(){var I=t.getColHeaderTable();_a(I),I.appendChild(h),I=t.getContentTable(),_a(I),I.appendChild(l),t.parent.notify(Wa,{refresh:"Column",prevRowColCnt:e.prevRowColCnt}),_c(t.parent,a),n.conditionalFormats&&n.conditionalFormats.length&&t.parent.notify(Wi,{indexes:e.indexes,isRender:!0}),t.parent.isEdit&&t.parent.notify(Gc,{}),t.parent.allowChart&&t.parent.notify(Qc,null),t.parent.isOpen||t.parent.hideSpinner(),Wc(t.parent.getMainContent(),{busy:!1})};e.insertDelete?w():cr(function(){return w()})},o.prototype.refreshRowContent=function(e){var t=this,i,r,n=this.colGroupWidth,s=this.parent.getActiveSheet(),a,l,h=[],u=document.createDocumentFragment(),c=document.createDocumentFragment(),d=this.parent.createElement("tbody"),p=d.cloneNode();c.appendChild(p),u.appendChild(d);var f=this.parent.frozenColCount(s),v=se(s,f-1,!1,"columns"),m=this.parent.scrollSettings.enableVirtualization&&this.parent.viewport.leftIndex!==se(s,0,!0,"columns");this.clearCFResult(s),e.cells.forEach(function(b,w){var I=J(w);(I[1]===e.indexes[1]||!i)&&(I[1]===e.indexes[1]&&(r=t.rowRenderer.render(I[0],!0)),f&&I[1]<f?(p.appendChild(r),i=r):(I[1]===e.indexes[1]&&p.appendChild(r),i=t.rowRenderer.render(I[0]),d.appendChild(i)),I[1]===e.indexes[1]&&(t.cellRenderer.renderRowHeader(I[0],r),n=ZF(I[0]+1))),f&&(r=p.lastElementChild||r),l={rowIdx:I[0],colIdx:I[1],cell:b,address:w,lastCell:I[1]===e.indexes[3],row:i,hRow:r,pRow:i.previousSibling,pHRow:r.previousSibling,isHeightCheckNeeded:!0,first:!e.skipUpdateOnFirst&&I[0]===e.indexes[0]?"Row":m&&I[1]===e.indexes[1]?"Column":"",isRefreshing:!0,mergeBorderRows:h},a=t.cellRenderer.render(l),t.checkRowMerge(I,e.indexes,a,b,s),f&&I[1]===v&&(i=null)}),this.colGroupWidth!==n&&this.updateLeftColGroup(n);var y=this.contentPanel.querySelector(".e-row-header tbody");y&&(ee(y),this.getRowHeaderTable().appendChild(c));var S=this.contentPanel.querySelector(".e-sheet-content tbody");S&&(ee(S),this.getContentTable().appendChild(u)),this.parent.notify(Wa,{refresh:"Row",prevRowColCnt:e.prevRowColCnt}),_c(this.parent,h),s.conditionalFormats&&s.conditionalFormats.length&&this.parent.notify(Wi,{indexes:e.indexes,isRender:!0}),this.parent.allowChart&&this.parent.notify(Qc,{}),this.parent.isEdit&&this.parent.notify(Gc,null),this.parent.isOpen||this.parent.hideSpinner(),Wc(this.parent.getMainContent(),{busy:!1})},o.prototype.updateCol=function(e,t,i){var r=this.col.cloneNode();if(r.style.width=Le(_r(e,t,null,!0)),i){var n=i.querySelector(".e-empty");return n?i.insertBefore(r,n):i.appendChild(r)}else return r},o.prototype.updateColContent=function(e){var t=this;cr(function(){var i,r,n=0,s,a,l,h,u=t.parent.getActiveSheet(),c=[],d=t.parent.element.querySelector(".e-column-header .e-header-row"),p=t.parent.element.querySelector(".e-sheet-content colgroup"),f=t.parent.element.querySelector(".e-column-header colgroup"),v=d.firstElementChild,m=p.firstElementChild,y=f.firstElementChild,S=t.parent.element.querySelector(".e-sheet-content tbody"),b=t.parent.element.querySelector(".e-column-header tbody"),w=t.parent.frozenRowCount(u),I=t.parent.frozenColCount(u),x=se(u,w-1,!1),M=se(u,e.indexes[0],!0);t.clearCFResult(u),e.cells.forEach(function(D,A){if(!l){var L=J(A);if(e.direction==="first"&&L[1]===e.indexes[1]&&t.checkColMerge([L[0],t.parent.viewport.leftIndex+I],e.indexes,((L[0]<w?b:S).rows[n]||{cells:[]}).cells[e.indexes[3]-e.indexes[1]+1],G(L[0],t.parent.viewport.leftIndex+I,u)||{},u),L[0]===M&&(e.direction==="last"?(a=t.col.cloneNode(),a.style.width=Le(_r(u,L[1],null,!0)),p.insertBefore(a,m),f.insertBefore(a.cloneNode(),y),t.cellRenderer.renderColHeader(L[1],d,v)):(a=t.updateCol(u,L[1],p),f.appendChild(a.cloneNode()),t.cellRenderer.renderColHeader(L[1],d)),t.parent.scrollSettings.enableVirtualization&&e.direction&&(ee(p[e.direction+"ElementChild"]),ee(f[e.direction+"ElementChild"]),ee(d[e.direction+"ElementChild"]))),L[1]===e.indexes[1]){if(L[0]<w)i=b.children[n];else if(i=S.children[n],!i){l=!0;return}n++,r=i.firstElementChild}h={colIdx:L[1],rowIdx:L[0],cell:D,address:A,row:i,pRow:i.previousSibling,lastCell:L[1]===e.indexes[3],isHeightCheckNeeded:e.direction==="first",first:e.direction==="last"&&!e.skipUpdateOnFirst&&L[1]===e.indexes[1]?"Column":"",checkNextBorder:e.direction==="last"&&L[3]===e.indexes[3]?"Column":"",isRefreshing:e.direction==="first",mergeBorderRows:c},e.direction==="last"?(h.refChild=r,s=t.cellRenderer.render(h),t.checkColMerge(L,e.indexes,s,D,u,((L[0]<w?b:S).rows[n-1]||{cells:[]}).cells[1])):s=t.cellRenderer.render(h),t.parent.scrollSettings.enableVirtualization&&e.direction&&ee(i[e.direction+"ElementChild"]),w&&L[0]===x&&(n=0)}}),t.parent.notify(Wa,{refresh:"Column",prevRowColCnt:e.prevRowColCnt}),_c(t.parent,c),u.conditionalFormats&&u.conditionalFormats.length&&t.parent.notify(Wi,{indexes:e.indexes,isRender:!0}),t.parent.allowChart&&t.parent.notify(Qc,null),t.parent.isEdit&&t.parent.notify(Gc,{}),t.parent.isOpen||t.parent.hideSpinner(),Wc(t.parent.getMainContent(),{busy:!1})})},o.prototype.updateRowContent=function(e){var t=this,i=this.parent.getMainContent();if(!(e.direction===""&&!i.children.length)){var r,n,s,a,l,h=[],u=0,c=this.colGroupWidth,d=this.parent.getActiveSheet(),p=i.querySelector("tbody"),f=this.parent.getRowHeaderContent().querySelector("tbody"),v=document.createDocumentFragment(),m=document.createDocumentFragment();this.parent.showSpinner();var y=this.parent.frozenColCount(d),S=this.parent.frozenRowCount(d),b=se(d,e.indexes[1],!0,"columns"),w=se(d,y-1,!1,"columns");this.clearCFResult(d),e.cells.forEach(function(I,x){var M=J(x);e.direction==="first"&&M[0]===e.indexes[0]&&(a===void 0&&(a=(M[1]<y?f:p).rows[e.indexes[2]-e.indexes[0]+1]||null),t.checkRowMerge([t.parent.viewport.topIndex+S,M[1]],e.indexes,(a||{cells:[]}).cells[M[1]<y?u+1:u],G(t.parent.viewport.topIndex+S,M[1],d)||{},d)),(M[1]===b||!r)&&(M[1]===b&&(n=t.rowRenderer.render(M[0],!0)),y&&M[1]<y?(v.appendChild(n),r=n):(r=t.rowRenderer.render(M[0]),m.appendChild(r),M[1]===b&&v.appendChild(n),t.parent.scrollSettings.enableVirtualization&&e.direction&&ee(p[e.direction+"ElementChild"])),M[1]===b&&(t.cellRenderer.renderRowHeader(M[0],n),c=ZF(M[0]+1),t.parent.scrollSettings.enableVirtualization&&e.direction&&ee(f[e.direction+"ElementChild"]))),y&&(n=v.lastElementChild||n),l={colIdx:M[1],rowIdx:M[2],cell:I,address:x,row:r,lastCell:M[1]===e.indexes[3],pHRow:n.previousSibling,checkNextBorder:e.direction==="last"&&M[2]===e.indexes[2]?"Row":"",pRow:r.previousSibling,isHeightCheckNeeded:e.direction==="first"||e.direction==="",hRow:n,first:e.direction==="last"&&!e.skipUpdateOnFirst&&M[0]===e.indexes[0]?"Row":"",isRefreshing:e.direction==="first",mergeBorderRows:h},s=t.cellRenderer.render(l),e.direction==="last"&&p.rows.length&&t.checkRowMerge(M,e.indexes,s,I,d,(M[1]<y?f:p).rows[0].cells[M[1]<y?u+1:u]),u++,y&&M[1]===w&&(r=null,a=void 0,u=0)}),this.colGroupWidth!==c&&this.updateLeftColGroup(c),e.direction==="last"?(f.insertBefore(v,f.firstElementChild),p.insertBefore(m,p.firstElementChild)):(f.appendChild(v),p.appendChild(m)),this.parent.scrollSettings.enableVirtualization&&this.parent.notify(Wa,{refresh:"Row",prevRowColCnt:e.prevRowColCnt}),_c(this.parent,h),d.conditionalFormats&&d.conditionalFormats.length&&this.parent.notify(Wi,{indexes:e.indexes,isRender:!0}),this.parent.isEdit&&this.parent.notify(Gc,null),this.parent.allowChart&&this.parent.notify(Qc,{}),this.parent.isOpen||this.parent.hideSpinner(),Wc(this.parent.getMainContent(),{busy:!1})}},o.prototype.checkRowMerge=function(e,t,i,r,n,s){if(this.parent.scrollSettings.enableVirtualization&&i&&(!g(r.rowSpan)||!g(r.colSpan))){var a=this.parent.frozenRowCount(n),l=this.parent.viewport.topIndex+a;if(e[0]===l){if(r.rowSpan<0){var h={td:i,rowIdx:e[0],colIdx:e[1],isRow:!0,isFreezePane:!0};if(this.parent.notify(ab,h),h.insideFreezePane)return;l>=t[2]&&this.refreshPrevMerge(t[2]+1,e[1])}s&&this.refreshFirstCell(e[0]+(t[2]-t[0])+1,e[1],n,s)}else if(r.rowSpan>1){var u=t[2]+1;e[0]+r.rowSpan-1>=u&&e[0]<u&&this.refreshPrevMerge(u,e[1],l)}}},o.prototype.refreshPrevMerge=function(e,t,i){var r=this.parent.getCell(e,t,this.parent.getRow(i||0,null,t));r&&this.cellRenderer.refresh(e,t,null,r)},o.prototype.refreshFirstCell=function(e,t,i,r){var n=G(e,t,i,!1,!0);(n.rowSpan<0||n.colSpan<0)&&this.cellRenderer.refresh(e,t,null,r)},o.prototype.checkColMerge=function(e,t,i,r,n,s){if(this.parent.scrollSettings.enableVirtualization&&i&&(!g(r.rowSpan)||!g(r.colSpan))){var a=this.parent.frozenColCount(n),l=this.parent.viewport.leftIndex+a;if(e[1]===l){if(r.colSpan<0){var h={td:i,colIdx:e[1],rowIdx:e[0],isFreezePane:!0};if(this.parent.notify(ab,h),h.insideFreezePane)return;if(l>=t[3]){var u=this.parent.getCell(e[0],e[3]+1,this.parent.getRow(e[0],null,e[3]+1));u&&this.cellRenderer.refresh(e[0],t[3]+1,null,u)}}s&&this.refreshFirstCell(e[0],e[1]+(t[3]-t[1])+1,n,s)}else if(r.colSpan>1&&e[1]+r.colSpan-1>=t[3]+1&&e[1]<t[3]+1){var u=this.parent.getCell(e[0],e[3]+1,this.parent.getRow(e[0],null,e[3]+1));u&&this.cellRenderer.refresh(e[0],t[3]+1,null,u)}}},o.prototype.toggleGridlines=function(){var e=document.getElementById(this.parent.element.id+"_sheet");this.parent.getActiveSheet().showGridLines?e.classList.remove("e-hide-gridlines"):e.classList.add("e-hide-gridlines")},o.prototype.showHideHeaders=function(){var e=this,t=this.parent.getActiveSheet();cr(function(){if(t.showHeaders){var i=e.getContentPanel();e.setPanelWidth(t,e.getRowHeaderPanel()),e.setPanelHeight(t),document.getElementById(e.parent.element.id+"_sheet").classList.remove("e-hide-headers"),e.getColHeaderPanel().scrollLeft=i.scrollLeft,e.parent.selectRange(t.selectedRange)}else e.updateHideHeaders(t,document.getElementById(e.parent.element.id+"_sheet")),e.setPanelHeight(t),e.parent.frozenColCount(t)||e.parent.frozenRowCount(t)?(e.setPanelWidth(t,e.getRowHeaderPanel()),e.parent.selectRange(t.selectedRange)):(e.getContentPanel().style.width="",e.getContentPanel().style[e.parent.enableRtl?"right":"left"]=""),e.getScrollElement().style.left=e.getRowHeaderWidth(t)+"px"})},o.prototype.updateHideHeaders=function(e,t){e.showHeaders||t.classList.add("e-hide-headers")},o.prototype.rowHeightChanged=function(e){if(e.threshold||e.isHideShow){var t=this.parent.getActiveSheet();e.rowIdx<this.parent.frozenRowCount(t)&&this.setPanelHeight(t)}},o.prototype.colWidthChanged=function(e){if(e.threshold||e.isHideShow){var t=this.parent.getActiveSheet();e.colIdx<this.parent.frozenColCount(t)&&this.setPanelWidth(t,this.getRowHeaderPanel()),this.checkTableWidth(t)}},o.prototype.getRowHeaderWidth=function(e,t,i){var r=0,n=i?this.parent.viewport.scaleX:1;if(!t&&e.frozenColumns){var s=Se(e.topLeftCell)[1];r=Ci(e,s,s+e.frozenColumns-1,!0)/n}return r+=e.showHeaders?En(this.colGroupWidth)/n:0,r},o.prototype.getColHeaderHeight=function(e,t){var i=Se(e.topLeftCell)[0];return(e.showHeaders&&!t?En(31):0)+Ri(e,i,i+e.frozenRows-1,!0)},o.prototype.getSelectAllContent=function(){return this.headerPanel.getElementsByClassName("e-selectall-container")[0]},o.prototype.getScrollElement=function(){var e;return this.contentPanel&&(e=this.contentPanel.parentElement||this.contentPanel.nextElementSibling),e&&e.querySelector(".e-scroller")},o.prototype.getSelectAllTable=function(){return this.headerPanel.getElementsByClassName("e-selectall-table")[0]},o.prototype.getColHeaderTable=function(){return this.headerPanel.getElementsByClassName("e-colhdr-table")[0]},o.prototype.getRowHeaderTable=function(){return this.contentPanel.getElementsByClassName("e-rowhdr-table")[0]},o.prototype.getContentTable=function(){return this.contentPanel.getElementsByClassName("e-content-table")[0]},o.prototype.getRowHeaderPanel=function(){return this.contentPanel.getElementsByClassName("e-row-header")[0]},o.prototype.getColHeaderPanel=function(){return this.headerPanel.getElementsByClassName("e-column-header")[0]},o.prototype.getContentPanel=function(){return this.contentPanel.getElementsByClassName("e-sheet-content")[0]},o.prototype.addEventListener=function(){this.parent.on(lx,this.triggerCreatedEvent,this),this.parent.on(An,this.rowHeightChanged,this),this.parent.on(_n,this.colWidthChanged,this),this.parent.on(Un,this.removeEventListener,this)},o.prototype.destroy=function(){this.headerPanel&&(_a(this.headerPanel),this.headerPanel.remove()),this.headerPanel=null,this.contentPanel&&(_a(this.contentPanel),this.contentPanel.remove()),this.contentPanel=null,this.col&&(_a(this.col),this.col.remove()),this.col=null,this.rowRenderer=null,this.cellRenderer=null,this.colGroupWidth=null,this.parent=null},o.prototype.removeEventListener=function(){this.parent.off(lx,this.triggerCreatedEvent),this.parent.off(An,this.rowHeightChanged),this.parent.off(_n,this.colWidthChanged),this.parent.off(Un,this.removeEventListener)},o}(),Iq=function(){function o(e){this.parent=e,this.element=this.parent.createElement("tr"),this.cellRenderer=e.serviceLocator.getService("cell"),this.parent.on(xu,this.initProps,this)}return o.prototype.render=function(e,t,i){var r=this.element.cloneNode(),n=this.parent.getActiveSheet();if(e===void 0)return r.classList.add("e-header-row"),r;if(r.classList.add("e-row"),!this.bottomBorderWidth){var s=1;if(window.devicePixelRatio%1>0){var a=1*window.devicePixelRatio%1;s=1+(a?(a>.5?1-a:-1*a)/window.devicePixelRatio:0)}this.bottomBorderWidth=s}var l=li(n,e,!0),h=li(n,e),u={height:l+"px",lineHeight:h<20?l>this.bottomBorderWidth?l-this.bottomBorderWidth+"px":"0px":""};if(Object.assign(r.style,u),Ie(r,{"aria-rowindex":(e+1).toString()}),t&&!i){if(h<20){var s=4+(this.bottomBorderWidth-1);r.style.lineHeight=l>=s?l-s+"px":l>this.bottomBorderWidth?l-this.bottomBorderWidth+"px":"0px",r.classList.contains("e-reach-fntsize")||r.classList.add("e-reach-fntsize")}st(n,e+1)&&!st(n,e-1)&&r.classList.add("e-hide-start"),e!==0&&st(n,e-1)&&!st(n,e+1)&&r.classList.add("e-hide-end")}return r},o.prototype.refresh=function(e,t,i,r,n){var s=this,a=this.parent.getActiveSheet(),l;if(r)l=this.render(e,r,n),this.cellRenderer.renderRowHeader(e,l);else{var h,u,c=function(){for(;h<=u;)Ot(a,h)||s.cellRenderer.render({colIdx:h,rowIdx:e,cell:G(e,h,a),address:et(e,h),lastCell:h===u,row:l,hRow:i,isHeightCheckNeeded:!0,pRow:t,first:e===s.parent.viewport.topIndex&&se(a,e,!0)!==se(a,0,!0)?"Row":"",skipFormatCheck:cs(s.parent),checkCF:!0}),h++},d=this.parent.frozenColCount(a);d&&(l=i,h=Se(a.topLeftCell)[0],u=d-1,c()),l=this.render(e,r,n),h=this.parent.viewport.leftIndex+d,u=this.parent.viewport.rightIndex,c()}return l},o.prototype.initProps=function(){this.bottomBorderWidth=null},o.prototype.destroy=function(){this.parent.off(xu,this.initProps),this.element&&this.element.remove(),this.bottomBorderWidth&&(this.bottomBorderWidth=null),this.parent=null,this.element=null},o}(),Mq=function(){function o(e){this.parent=e,this.element=this.parent.createElement("td"),this.th=this.parent.createElement("th",{className:"e-header-cell"}),this.tableRow=e.createElement("tr",{className:"e-row"}),this.parent.on(au,this.updateView,this),this.parent.on(pu,this.calculateFormula,this)}return o.prototype.renderColHeader=function(e,t,i){var r=this.th.cloneNode(),n=Pi(e+1);r.innerText=n;var s=this.parent.getActiveSheet();Ot(s,e+1)&&r.classList.add("e-hide-start"),e!==0&&Ot(s,e-1)&&r.classList.add("e-hide-end"),i?t.insertBefore(r,i):t.appendChild(r),this.parent.trigger("beforeCellRender",{cell:null,element:r,address:n,colIndex:e}),this.parent.notify(qc,{td:r,rowIndex:0,colIndex:e}),Ie(r,{"aria-colindex":(e+1).toString(),tabindex:"-1"})},o.prototype.renderRowHeader=function(e,t,i){var r=this.element.cloneNode();Y([r],"e-header-cell"),Ie(r,{role:"rowheader",tabindex:"-1"}),r.innerText=(e+1).toString(),i?t.insertBefore(r,i):t.appendChild(r),this.parent.trigger("beforeCellRender",{cell:null,element:r,address:""+(e+1),rowIndex:e})},o.prototype.render=function(e){var t=this.parent.getActiveSheet();if(e.td=this.element.cloneNode(),e.td.className="e-cell",Ie(e.td,{"aria-colindex":(e.colIdx+1).toString(),tabindex:"-1"}),this.checkMerged(e))return this.createImageAndChart(e),e.refChild?e.row.insertBefore(e.td,e.refChild):e.row.appendChild(e.td),e.td;e.isRefresh=!1,e.skipFormatCheck=cs(this.parent);var i=this.update(e);e.checkCF&&e.cell&&t.conditionalFormats&&t.conditionalFormats.length&&this.parent.notify(Wi,{indexes:[e.rowIdx,e.colIdx],cell:e.cell,ele:e.td,isRender:!0}),e.td.classList.contains("e-cell-template")||this.parent.notify(qc,{td:e.td,rowIndex:e.rowIdx,colIndex:e.colIdx}),e.refChild?e.row.insertBefore(e.td,e.refChild):e.row.appendChild(e.td);var r={cell:e.cell,element:e.td,address:e.address,rowIndex:e.rowIdx,colIndex:e.colIdx,needHeightCheck:!1,row:e.row};if(this.parent.trigger("beforeCellRender",r),!t.rows[e.rowIdx]||!t.rows[e.rowIdx].customHeight){if(r.needHeightCheck||i&&r.element&&r.element.children.length){var n=r.element.cloneNode(!0);n.style.width=_r(t,e.colIdx,!0)+"px",this.tableRow.appendChild(n)}if(e.lastCell&&this.tableRow.childElementCount){var s=this.getRowHeightOnInit();s>li(t,e.rowIdx)&&va(this.parent,t,s,e.rowIdx,e.row,e.hRow),this.tableRow.innerText=""}}return this.setWrapByValue(t,e),r.element},o.prototype.setWrapByValue=function(e,t){t.cell&&g(t.cell.wrap)&&t.cell.value&&t.cell.value.toString().includes(`
`)&&(oi(t.rowIdx,t.colIdx,e,{wrap:!0},!0),this.parent.notify(Xa,{range:[t.rowIdx,t.colIdx,t.rowIdx,t.colIdx],wrap:!0,initial:!0,sheet:e,td:t.td,row:t.row,hRow:t.hRow}))},o.prototype.update=function(e){var t=this.parent.getActiveSheet(),i;if(!e.isRefresh||e.cell&&e.cell.template){var r=this.processTemplates(e.cell,e.rowIdx,e.colIdx);r&&(typeof r=="string"?e.td.innerHTML=r:(_a(e.td),dt(r,e.td)),e.td.classList.add("e-cell-template"),i=!0)}if(e.isRefresh){if(e.td.rowSpan&&(this.mergeFreezeRow(t,e.rowIdx,e.colIdx,e.td.rowSpan,e.row,!0),e.td.removeAttribute("rowSpan")),e.td.colSpan&&(this.mergeFreezeCol(t,e.rowIdx,e.colIdx,e.td.colSpan,!0),e.td.removeAttribute("colSpan")),this.checkMerged(e))return!1;if(e.cell&&!e.cell.hyperlink){var n=e.td.querySelector(".e-hyperlink");n&&ee(n)}if(e.cell&&e.td.children.length>0&&e.td.children[e.td.childElementCount-1].className.indexOf("e-addNoteIndicator")>-1){var s=e.td.querySelector(".e-addNoteIndicator");s&&ee(s)}(!e.cell||!this.parent.allowWrap)&&e.td.classList.contains("e-wraptext")&&e.td.classList.remove("e-wraptext")}e.cell&&e.cell.formula&&!e.isRandomFormula&&this.parent.calculationMode==="Automatic"&&(this.calculateFormula(e),e.fillType&&e.fillType==="FillWithoutFormatting"&&delete e.cell.format);var a={value:e.cell&&e.cell.value,type:e.cell&&Er(e.cell.format),format:e.cell&&e.cell.format,formattedText:e.cell&&e.cell.value,isRightAlign:!1,cell:e.cell,rowIndex:e.rowIdx,colIndex:e.colIdx,td:e.td,skipFormatCheck:e.skipFormatCheck,refresh:!0};this.parent.calculationMode==="Manual"&&e.cell&&!e.cell.value&&e.cell.value!==""&&e.cell.formula&&(a.value=0,e.cell.value="0"),e.cell&&this.parent.notify(en,a),this.parent.refreshNode(e.td,a);var l={};if(e.cell){if(e.cell.style&&(e.cell.style.properties?l=ZI(e.cell.style,!0):l=e.cell.style),a.color!==void 0&&(l=Object.assign({},l),l.color=a.color),this.createImageAndChart(e),e.cell.hyperlink&&(e.fillType==="FillFormattingOnly"?(e.td.style.textDecoration="underline",e.td.style.color="#00e"):this.parent.notify(hI,{cell:e.cell,style:l,td:e.td,rowIdx:e.rowIdx,colIdx:e.colIdx,fillType:e.fillType,action:e.action})),e.cell.rowSpan>1){var h=e.rowSpan||e.cell.rowSpan-this.parent.hiddenCount(e.rowIdx,e.rowIdx+(e.cell.rowSpan-1));h>1&&(e.td.rowSpan=h,this.mergeFreezeRow(t,e.rowIdx,e.colIdx,h,e.row))}if(e.cell.colSpan>1){var u=e.colSpan||e.cell.colSpan-this.parent.hiddenCount(e.colIdx,e.colIdx+(e.cell.colSpan-1),"columns");u>1&&(e.td.colSpan=u,this.mergeFreezeCol(t,e.rowIdx,e.colIdx,u))}!g(e.cell.notes)&&!e.fillType?this.parent.notify(bd,{targetElement:e.td,rowIndex:e.rowIdx,columnIndex:e.colIdx}):!g(e.td)&&e.td.children.length>0&&e.td.children[e.td.childElementCount-1].className.indexOf("e-addNoteIndicator")>-1&&this.parent.notify(Bf,{rowIndex:e.rowIdx,columnIndex:e.colIdx}),e.cell.isNoteEditable&&this.parent.notify(ed,{rowIndex:e.rowIdx,columnIndex:e.colIdx,isNoteEditable:!0,isScrollWithNote:!0,cellElement:e.td})}if(e.isRefresh&&g(e.cell)&&!g(e.td)&&e.td.children.length>0&&e.td.children[e.td.childElementCount-1].className.indexOf("e-addNoteIndicator")>-1&&this.parent.notify(Bf,{rowIndex:e.rowIdx,columnIndex:e.colIdx}),e.isRefresh&&this.removeStyle(e.td,e.rowIdx,e.colIdx),e.lastCell&&this.parent.chartColl&&this.parent.chartColl.length&&this.parent.notify(lh,{cell:e.cell,rIdx:e.rowIdx,cIdx:e.colIdx,sheetIdx:this.parent.activeSheetIndex,isSelectAll:e.isSelectAll}),this.applyStyle(e,l),e.checkNextBorder==="Row"){var c=this.parent.getCellStyleValue(["borderTop"],[Number(this.parent.getContentTable().rows[0].getAttribute("aria-rowindex"))-1,e.colIdx]).borderTop;c!==""&&(!e.cell||!e.cell.style||!e.cell.style.bottomPriority)&&(e.style={borderBottom:c},this.parent.notify(Dr,e))}if(e.checkNextBorder==="Column"){var d=this.parent.getCellStyleValue(["borderLeft"],[e.rowIdx,e.colIdx+1]).borderLeft;d!==""&&(!e.cell||!e.cell.style||!e.cell.style.borderRight&&!e.cell.style.border)&&(e.style={borderRight:d},this.parent.notify(Dr,e))}e.cell&&!g(e.cell.wrap)&&this.parent.notify(Xa,{range:[e.rowIdx,e.colIdx,e.rowIdx,e.colIdx],wrap:e.cell.wrap,sheet:t,initial:!0,td:e.td,row:e.row,hRow:e.hRow,isCustomHgt:!e.isRefresh&&li(t,e.rowIdx)>(t&&t.standardHeight?t.standardHeight:20)});var p,f;return e.cell&&e.cell.validation?(p=e.cell.validation,f=t.columns&&t.columns[e.colIdx]):p=Ds(t.columns&&t.columns[e.colIdx],e.rowIdx,e.colIdx)&&t.columns[e.colIdx].validation,p&&(p.isHighlighted&&(e.validation=p,e.col=f,this.parent.notify(su,e)),p.type==="List"&&!e.isRefresh&&e.address===t.activeCell&&(e.validation=p,this.parent.notify(pd,e))),i},o.prototype.applyStyle=function(e,t){(Object.keys(t).length||Object.keys(this.parent.commonCellStyle).length||e.lastCell)&&(e.style=he({},this.parent.commonCellStyle,t),this.parent.notify(Dr,e))},o.prototype.createImageAndChart=function(e){if(e.cell.chart&&e.cell.chart.length>0&&this.parent.notify(oh,{chart:e.cell.chart,isInitCell:!0,range:et(e.rowIdx,e.colIdx),isUndoRedo:!1}),e.cell.image&&e.cell.image.length>0)for(var t=0;t<e.cell.image.length;t++)e.cell.image[t]&&this.parent.notify(Ya,{options:{src:e.cell.image[t].src,id:e.cell.image[t].id,height:e.cell.image[t].height,width:e.cell.image[t].width,top:e.cell.image[t].top,left:e.cell.image[t].left},range:Be([e.rowIdx,e.colIdx,e.rowIdx,e.colIdx]),isPublic:!1})},o.prototype.calculateFormula=function(e){if(e.cell.value!==void 0&&e.cell.value!==null){var t={action:"checkFormulaAdded",added:!0,address:e.address,sheetId:(e.sheetIndex===void 0?this.parent.getActiveSheet():ke(this.parent,e.sheetIndex)).id.toString()};if(this.parent.notify(xt,t),t.added)return}else e.formulaRefresh&&(e.cell.value="");var i=ut(e.cell.formula),r={action:"refreshCalculate",value:e.cell.formula,rowIndex:e.rowIdx,colIndex:e.colIdx,isFormula:i,sheetIndex:e.sheetIndex,isRefreshing:e.isRefreshing,isDependentRefresh:e.isDependentRefresh,isRandomFormula:e.isRandomFormula,fillType:e.fillType};(this.parent.calculationMode==="Automatic"||e.isSortAction||e.action==="calculate"||e.isDependentRefresh)&&this.parent.notify(xt,r),(e.cell.value===void 0&&this.parent.calculationMode==="Manual"&&!this.parent.getActiveSheet().isSheetCalculated||this.parent.isEdit&&e.cell.value==="#CIRCULARREF!")&&(e.cell.value="0"),e.cell.value=G(e.rowIdx,e.colIdx,g(e.sheetIndex)?this.parent.getActiveSheet():ke(this.parent,e.sheetIndex)).value,i&&(e.cell.formula.indexOf("^+")>-1||e.cell.formula.indexOf("&+")>-1)&&(e.cell.formula=r.value)},o.prototype.checkMerged=function(e){if(e.cell&&(e.cell.colSpan<0||e.cell.rowSpan<0)){var t=this.parent.getActiveSheet();if(t.frozenRows||t.frozenColumns){var i={range:[e.rowIdx,e.colIdx,e.rowIdx,e.colIdx]};this.parent.notify(ur,i);var r=this.parent.frozenRowCount(t),n=this.parent.frozenColCount(t),s=void 0;i.range=i.range,t.frozenRows&&t.frozenColumns?i.range[0]<r&&i.range[1]<n?s=e.rowIdx<r&&e.colIdx<n:i.range[0]<r?s=e.rowIdx<r:i.range[1]<n?s=e.colIdx<n:s=!0:s=r?i.range[0]>=r||e.rowIdx<r:i.range[1]>=n||e.colIdx<n,s&&(e.td.style.display="none")}else e.td.style.display="none";e.isMerged=!0;var a=e.cell.rowSpan,l=e.cell.colSpan;return(l<0||a<0)&&(this.parent.notify(SI,e),l<0&&e.cell.style&&e.cell.style.borderTop&&this.applyStyle(e,{borderTop:e.cell.style.borderTop}),a<0&&e.cell.style&&e.cell.style.borderLeft&&this.applyStyle(e,{borderLeft:e.cell.style.borderLeft})),e.isMerged}return!1},o.prototype.mergeFreezeRow=function(e,t,i,r,n,s){var a=this.parent.frozenRowCount(e);if(a&&t<a&&t+(r-1)>=a){var l=void 0,h=0,u=void 0,c=this.parent.frozenColCount(e),d=n||this.parent.getRow(t,null,i),p=[].slice.call(d.parentElement.querySelectorAll(".e-empty"));if(s){var f=t+r-a;if(f<p.length)return;var v=0;if(f===p.length){var m=void 0,y=void 0,S=void 0;for(c&&i<c?(y=Se(e.topLeftCell)[1],S=c):(y=this.parent.viewport.leftIndex+c,S=this.parent.viewport.rightIndex),y;y<S;y++)y!==i&&(m=G(t,y,e,!1,!0),m.rowSpan&&t+m.rowSpan-a>v&&(v=t+m.rowSpan-a));if(v===f)return}else v=f;for(var b=t+(r-1),y=v,S=p.length;y<S;y++)h+=li(e,b),b--,ee(p.pop());this.updateSpanTop(i,c,h,!0),p.length||this.updateColZIndex(i,c,!0);return}this.updateColZIndex(i,c);for(var y=a,S=t+(r-1);y<=S;y++)u=li(e,se(e,y,!0),!0),h+=-u,!(a+p.length>y)&&(l=d.cloneNode(),l.classList.add("e-empty"),l.style.visibility="hidden",l.style.height=u+"px",d.parentElement.appendChild(l));this.updateSpanTop(i,c,h)}},o.prototype.updateSpanTop=function(e,t,i,r){var n=this.parent.serviceLocator.getService("sheet").contentPanel;if(r){if(!parseInt(n.style.top,10))return;i=parseInt(n.style.top,10)+i}if(t&&e<t&&(r||!parseInt(n.style.top,10)||i<parseInt(n.style.top,10))){n.style.top=i+"px";var s=n.nextElementSibling;s&&(s.style.top=i+"px")}},o.prototype.mergeFreezeCol=function(e,t,i,r,n){var s=this.parent.frozenColCount(e);if(s&&i<s&&i+(r-1)>=s){var a=void 0,l=void 0,h=this.parent.frozenRowCount(e),u=(t<h?this.parent.getSelectAllContent():this.parent.getRowHeaderContent()).querySelector("colgroup"),c=[].slice.call(u.querySelectorAll(".e-empty"));if(n){var d=i+r-s;if(d<c.length)return;var p=0;if(d===c.length){var f=void 0,v=void 0,m=void 0;for(h&&t<h?(v=h,m=Se(e.topLeftCell)[0]):(v=this.parent.viewport.bottomIndex,m=this.parent.viewport.topIndex+h),m;m<v;m++)m!==t&&(f=G(m,i,e,!1,!0),f.colSpan&&i+f.colSpan-s>p&&(p=i+f.colSpan-s));if(p===d)return}else p=d;for(var m=p,v=c.length;m<v;m++)ee(c.pop());this.parent.serviceLocator.getService("sheet").setPanelWidth(e,this.parent.getRowHeaderContent()),c.length||this.updateRowZIndex(t,h,!0);return}this.updateRowZIndex(t,h);for(var m=s,v=i+(r-1);m<=v;m++)s+c.length>m||(a=u.childNodes[0].cloneNode(),a.classList.add("e-empty"),a.style.visibility="hidden",l=_r(e,se(e,m,!0,"columns"),null,!0),a.style.width=l+"px",u.appendChild(a),m===v&&this.parent.serviceLocator.getService("sheet").setPanelWidth(e,this.parent.getRowHeaderContent()))}},o.prototype.updateColZIndex=function(e,t,i){e<t?this.updateSelectAllZIndex(i):(this.parent.getColumnHeaderContent().style.zIndex=i?"":"2",this.updatedHeaderZIndex(i))},o.prototype.updateSelectAllZIndex=function(e){var t=this.parent.element.querySelector(".e-frozen-row"),i=this.parent.element.querySelector(".e-frozen-column");if(e)this.parent.getSelectAllContent().style.zIndex="",t&&(t.style.zIndex=""),i&&(i.style.zIndex="");else{var r=this.parent.getRowHeaderContent(),n=this.parent.getColumnHeaderContent();if(r.style.zIndex||n.style.zIndex){this.parent.getSelectAllContent().style.zIndex="3",t&&(t.style.zIndex="4"),i&&(i.style.zIndex="4");var s=r.querySelector(".e-selection");s&&(s.style.zIndex="3");var a=n.querySelector(".e-selection");a&&(a.style.zIndex="3")}else this.parent.getSelectAllContent().style.zIndex="2"}},o.prototype.updatedHeaderZIndex=function(e){if(!e&&this.parent.getSelectAllContent().style.zIndex==="2"){this.parent.getSelectAllContent().style.zIndex="3";var t=this.parent.element.querySelector(".e-frozen-row"),i=this.parent.element.querySelector(".e-frozen-column");i&&(i.style.zIndex="4"),t&&(t.style.zIndex="4");var r=this.parent.getRowHeaderContent().querySelector(".e-selection");r&&(r.style.zIndex="3");var n=this.parent.getColumnHeaderContent().querySelector(".e-selection");n&&(n.style.zIndex="3")}},o.prototype.updateRowZIndex=function(e,t,i){e<t?this.updateSelectAllZIndex(i):(this.parent.getRowHeaderContent().style.zIndex=i?"":"2",this.updatedHeaderZIndex(i))},o.prototype.processTemplates=function(e,t,i){for(var r=this.parent.getActiveSheet(),n=r.ranges,s,a=0,l=n.length;a<l;a++)if(n[a].template&&(s=J(n[a].address.length?n[a].address:n[a].startCell),s[0]<=t&&s[1]<=i&&s[2]>=t&&s[3]>=i)){if(e)return this.compileCellTemplate(n[a].template,Object.assign({rowIndex:t,colIndex:i},e));if(!G(t,i,r,!0))return this.compileCellTemplate(n[a].template,Object.assign({rowIndex:t,colIndex:i},G(t,i,r,null,!0)))}return""},o.prototype.compileCellTemplate=function(e,t){var i;if(typeof e=="string"){var r=void 0;return e.trim().indexOf("#")===0?r=document.querySelector(e).innerHTML.trim():r=e,i=wt(r),!this.parent.isVue||this.isSelector(e)?i(t,this.parent,"ranges","",!0)[0].outerHTML:i(t,this.parent,"ranges","")}else{i=wt(e);var n=i(t,this.parent,"ranges","");return n[0]?n:[n]}},o.prototype.isSelector=function(e){try{return!!document.querySelector(e)}catch{return!1}},o.prototype.getRowHeightOnInit=function(){var e=this.parent.createElement("table",{className:"e-table e-test-table"}),t=e.appendChild(this.parent.createElement("tbody"));t.appendChild(this.tableRow),this.parent.element.appendChild(e);var i=this.tableRow.getBoundingClientRect().height;return this.parent.element.removeChild(e),i<20?20:i},o.prototype.removeStyle=function(e,t,i){var r;if(e.style.length){r=this.parent.getCellStyleValue(["borderLeft","border"],[t,i+1]);var n=r.borderLeft||r.border;r=this.parent.getCellStyleValue(["borderTop","border"],[t+1,i]);var s=r.borderTop||r.border;n||s?[].slice.call(e.style).forEach(function(u){n&&s?!u.includes("border-right")&&!u.includes("border-bottom")&&e.style.removeProperty(u):(n&&!(u.indexOf("border-right")>-1)&&(!s||s==="none")||s&&!(u.indexOf("border-bottom")>-1)&&(!n||n==="none"))&&e.style.removeProperty(u)}):e.removeAttribute("style")}var a=this.parent.getCell(t-1,i);if(a&&a.style.borderBottom){var l=Number(a.parentElement.getAttribute("aria-rowindex"))-1;r=this.parent.getCellStyleValue(["borderBottom","border"],[l,i]),r.borderBottom||r.border||(a.style.borderBottom="")}var h=e.previousElementSibling;h&&h.style.borderRight&&(i=Number(h.getAttribute("aria-colindex"))-1,r=this.parent.getCellStyleValue(["borderRight","border"],[t,i]),r.borderRight||r.border||(h.style.borderRight=""))},o.prototype.refreshRange=function(e,t,i,r,n,s,a,l,h,u,c,d){h===void 0&&(h=!0);var p=this.parent.getActiveSheet(),f=e.slice(),v,m;if(UI(this.parent,f,!0)){for(var y=0,S=f[0];S<=f[2];S++)if(!st(p,S))for(var b=f[1];b<=f[3];b++)Ot(p,b)||(m=this.parent.getCell(S,b),m&&(v={rowIdx:S,colIdx:b,td:m,cell:G(S,b,p),isRefreshing:t,lastCell:b===f[3],isRefresh:!0,isHeightCheckNeeded:h,manualUpdate:!0,first:"",onActionUpdate:r,skipFormatCheck:s,isFromAutoFillOption:l,isSelectAll:c,rowHeight:d&&d[y]&&d[y].rowHeight},y++,a&&(v.address=et(S,b)),this.update(v),n&&p.conditionalFormats&&p.conditionalFormats.length&&this.parent.notify(Wi,{indexes:[S,b],isAction:!0}),this.parent.notify(qc,{td:m,rowIndex:S,colIndex:b}),i&&this.setWrapByValue(p,v)),this.parent.calculationMode==="Manual"&&u&&(m?v.isSortAction=u:v={rowIdx:S,colIdx:b,td:m,cell:G(S,b,p),isRefreshing:t,lastCell:b===f[3],isRefresh:!0,isHeightCheckNeeded:h,manualUpdate:!0,first:"",onActionUpdate:r,skipFormatCheck:s,isFromAutoFillOption:l,isSortAction:u},v.cell&&v.cell.formula&&p.isSheetCalculated&&this.calculateFormula(v)))}},o.prototype.refresh=function(e,t,i,r,n,s,a,l,h){var u=this.parent.getActiveSheet();if(!(!r&&(st(u,e)||Ot(u,t)))&&(r||!this.parent.scrollSettings.enableVirtualization||this.parent.insideViewport(e,t))){var c=r||this.parent.getCell(e,t);if(!c)return;var d={rowIdx:e,colIdx:t,td:c,cell:G(e,t,u),isRefresh:!0,lastCell:i,isHeightCheckNeeded:!0,manualUpdate:!0,first:"",skipFormatCheck:a,isRandomFormula:l,fillType:h};this.update(d),n&&u.conditionalFormats&&u.conditionalFormats.length&&this.parent.notify(Wi,{indexes:[e,t],isAction:!0}),this.parent.notify(qc,{td:c,rowIndex:e,colIndex:t}),s&&this.setWrapByValue(u,d)}},o.prototype.updateView=function(e){if(g(e.sheetIndex)||e.sheetIndex===this.parent.activeSheetIndex){if(!e.indexes){var t=this.parent.getActiveSheet(),i=this.parent.frozenRowCount(t),r=this.parent.frozenColCount(t),n=J(t.topLeftCell);i&&r&&this.refreshRange([n[0],n[1],i-1,r-1],e.refreshing,e.checkWrap,!1,e.checkCF),i&&this.refreshRange([n[0],this.parent.viewport.leftIndex+r,i-1,this.parent.viewport.rightIndex],e.refreshing,e.checkWrap,!1,e.checkCF),r&&this.refreshRange([this.parent.viewport.topIndex+i,n[1],this.parent.viewport.bottomIndex,r-1],e.refreshing,e.checkWrap,!1,e.checkCF),e.indexes=[this.parent.viewport.topIndex+i,this.parent.viewport.leftIndex+r,this.parent.viewport.bottomIndex,this.parent.viewport.rightIndex]}this.refreshRange(e.indexes,e.refreshing,e.checkWrap,!1,e.checkCF)}else e.refreshing&&this.calculateFormula({cell:G(e.indexes[0],e.indexes[1],ke(this.parent,e.sheetIndex),!0,!0),rowIdx:e.indexes[0],colIdx:e.indexes[1],sheetIndex:e.sheetIndex})},o.prototype.destroy=function(){this.parent.off(au,this.updateView),this.parent.off(pu,this.calculateFormula),this.element&&this.element.remove(),this.element=null,this.th&&this.th.remove(),this.th=null,this.tableRow&&this.tableRow.remove(),this.tableRow=null,this.parent=null},o}(),Dq=function(){function o(e){this.parent=e,this.addEventListener(),this.instantiateRenderer()}return o.prototype.render=function(){this.parent.setProperties({activeSheetIndex:this.parent.skipHiddenSheets(this.parent.activeSheetIndex)},!0),this.parent.isMobileView()||(this.parent.notify(fl,null),this.parent.notify(Ff,null));var e=this.parent.createElement("div",{id:this.parent.element.id+"_sheet_panel",className:"e-sheet-panel"});this.parent.enableRtl&&e.classList.add("e-rtl"),this.parent.element.appendChild(e),this.parent.showSheetTabs?this.parent.notify(Uy,null):(this.parent.notify(xt,{action:"initSheetInfo"}),this.parent.notify(xt,{action:"initiateDefinedNames"})),this.parent.isMobileView()&&(this.parent.notify(Ff,null),this.parent.notify(fl,null)),this.parent.password&&(this.parent.password.length>0||this.parent.isProtected)&&(this.parent.isProtected=!0,this.parent.showSheetTabs&&(this.parent.element.querySelector(".e-add-sheet-tab").setAttribute("disabled","true"),this.parent.element.querySelector(".e-add-sheet-tab").classList.add("e-disabled"))),this.parent.selectionSettings.mode==="None"&&(this.parent.allowAutoFill=!1),this.setSheetPanelSize(),this.renderSheet(e),this.checkTopLeftCell(!this.parent.refreshing)},o.prototype.checkTopLeftCell=function(e,t,i,r,n,s){var a=this.parent.getActiveSheet();this.parent.showSpinner();var l=a.topLeftCell==="A1",h=Se(a.topLeftCell),u;if(a.topLeftCell!==a.paneTopLeftCell&&(a.frozenRows||a.frozenColumns)){var c=Se(a.paneTopLeftCell);u=this.parent.scrollSettings.enableVirtualization,l=a.frozenRows&&a.frozenColumns?h[0]+a.frozenRows===c[0]&&h[1]+a.frozenColumns===c[1]:a.frozenRows?h[0]+a.frozenRows===c[0]&&h[1]===0:h[1]+a.frozenColumns===c[1]&&h[0]===0,h[0]&&c[0]>h[0]?this.parent.viewport.beforeFreezeHeight=Ri(a,0,h[0]-1,!0):this.parent.viewport.beforeFreezeHeight=0,h[1]&&c[1]>h[1]?this.parent.viewport.beforeFreezeWidth=Ci(a,0,h[1]-1,!0):this.parent.viewport.beforeFreezeWidth=0}else this.parent.viewport.beforeFreezeHeight=this.parent.viewport.beforeFreezeWidth=0;var d=this.parent.frozenRowCount(a),p=this.parent.frozenColCount(a);if(!this.parent.scrollSettings.enableVirtualization||l)this.refreshUI({rowIndex:h[0],colIndex:h[1],refresh:"All"},null,e,t,n,s),u&&(this.parent.viewport.topIndex=se(a,d,!0)-d,this.parent.viewport.leftIndex=se(a,p,!0,"columns")-p);else{var f=a.paneTopLeftCell===a.topLeftCell?h:Se(a.paneTopLeftCell),v={preventScroll:!0};v.scrollTop=i||(f[0]>d?Ri(a,d,f[0]-1,!0):0),v.scrollLeft=r||(f[1]>p?Ci(a,p,f[1]-1,!0):0),this.parent.notify(sI,v);var m=this.parent.getThreshold("row"),y=a.frozenRows?h[0]:h[0]>m?se(a,h[0]-m,!0):0,S=[];a.frozenRows&&S.push(f[0]-m>d?f[0]-m:d),m=this.parent.getThreshold("col");var b=a.frozenColumns?h[1]:h[1]>m?se(a,h[1]-m,!0,"columns"):0;a.frozenColumns?(S.length||S.push(d),S.push(f[1]-m>p?f[1]-m:p)):S.length&&S.push(p),this.refreshUI({rowIndex:y,colIndex:b,refresh:"All",top:v.scrollTop,left:v.scrollLeft,frozenIndexes:S},null,e,t,n,s),u&&(d&&S[0]>=d&&(this.parent.viewport.topIndex=se(a,S[0],!0)-d),p&&S[1]>=p&&(this.parent.viewport.leftIndex=se(a,S[1],!0,"columns")-p))}},o.prototype.renderSheet=function(e){e===void 0&&(e=document.getElementById(this.parent.element.id+"_sheet_panel")),e.appendChild(this.parent.createElement("div",{className:"e-sheet",id:this.parent.element.id+"_sheet",styles:"background-color: #fff"})),this.parent.serviceLocator.getService("sheet").renderPanel()},o.prototype.refreshUI=function(e,t,i,r,n,s){var a=this;e.refresh!=="All"&&this.parent.showSpinner();var l=this.parent.serviceLocator.getService("sheet"),h=this.parent.getActiveSheet(),u=Vn(this.parent),c={rowCount:h.rowCount,colCount:h.colCount};if(e.frozenIndexes=e.frozenIndexes?e.frozenIndexes:[],!t)if(this.parent.scrollSettings.enableVirtualization){var d=e.rowIndex+this.parent.viewport.rowCount+this.parent.getThreshold("row")*2,p=e.colIndex+this.parent.viewport.colCount+this.parent.getThreshold("col")*2,f=this.parent.frozenRowCount(h),v=this.parent.frozenColCount(h);e.frozenIndexes.length&&(d+=e.frozenIndexes[0]-f,p+=e.frozenIndexes[1]-v),e.refresh==="Row"?d+=f:d+=h.frozenRows,e.refresh==="Column"?p+=v:p+=h.frozenColumns;var m=e.frozenIndexes[0]>f?e.frozenIndexes[0]:e.rowIndex+(e.refresh==="Row"?f:h.frozenRows),y=this.parent.skipHidden(m,d,"rows",!1);if(d=y[1],m!==y[0]){var S=Se(h.paneTopLeftCell);S[0]===m&&this.parent.updateTopLeftCell(y[0]-f,S[1],"col")}y[0]-=f;var b=h.rowCount-1,w=0,I=e.rowIndex;if(this.parent.scrollSettings.isFinite&&d>b&&(w=d-b,d=se(h,b,!1),y[0]+f>se(h,f,!0))){var x=e.rowIndex-w;x=x<0?0:x,x=this.decreaseHidden(x,e.rowIndex-1,f),e.top&&x<e.rowIndex&&this.parent.notify(hu,{height:Ri(h,x+f,e.rowIndex-1+f,!0),isRender:!0}),this.parent.viewport.topIndex=y[0]=x,I=e.refresh==="Row"?x:I}e.refresh==="Row"?e.rowIndex=se(h,I+f,!0)-f:I=e.rowIndex=f?se(h,I,!0):y[0];var M=e.frozenIndexes[1]>v?e.frozenIndexes[1]:e.colIndex+(e.refresh==="Column"?v:h.frozenColumns);if(y=this.parent.skipHidden(M,p,"columns",!1),p=y[1],M!==y[0]){var S=Se(h.paneTopLeftCell);S[1]===M&&this.parent.updateTopLeftCell(S[0],y[0]-v,"row")}y[0]-=v,b=h.colCount-1,w=0;var D=e.colIndex;if(this.parent.scrollSettings.isFinite&&p>b&&(w=p-b,p=se(h,b,!1,"columns"),y[0]+v>se(h,v,!0,"columns"))){var x=e.colIndex-w;x=x>-1?x:0,x=this.decreaseHidden(x,e.colIndex-1,v,"columns"),e.left&&x<e.colIndex&&this.parent.notify(hu,{width:Ci(h,x+v,e.colIndex-1+v,!0),isRender:!0}),this.parent.viewport.leftIndex=y[0]=x,D=e.refresh==="Column"?x:D}e.refresh==="Column"?e.colIndex=se(h,D+v,!0,"columns")-v:D=e.colIndex=v?se(h,D,!0,"columns"):y[0],e.refresh==="Row"&&(I+=f,f&&(d+=Se(h.topLeftCell)[0]),p=this.parent.viewport.rightIndex),e.refresh==="Column"&&(D+=v,v&&(p+=Se(h.topLeftCell)[1]),d=this.parent.viewport.bottomIndex),this.parent.viewport.topIndex=e.rowIndex,this.parent.viewport.bottomIndex=d,this.parent.viewport.leftIndex=e.colIndex,this.parent.viewport.rightIndex=p,t=et(I,D)+":"+et(d,p)}else e.refresh==="All"&&this.updateTopLeftScrollPosition(he(e,{sheet:h})),this.parent.viewport.bottomIndex=h.rowCount-1,this.parent.viewport.rightIndex=h.colCount-1,t=et(e.rowIndex,e.colIndex)+":"+et(this.parent.viewport.bottomIndex,this.parent.viewport.rightIndex);e.refresh==="All"&&this.parent.trigger(Q6,{});var A=this.parent.isOpen||this.parent.refreshing;Wc(this.parent.getMainContent(),{busy:!0});var L=this.parent.sheets.length;fa(this.parent,u+"!"+t,null,null,e.frozenIndexes).then(function(T){if(!(!a.parent||L<a.parent.sheets.length)){var k=cn(a.parent,h.id);if(!n&&(k===void 0||k!==a.parent.activeSheetIndex)){k>-1&&a.checkTopLeftCell();return}var F=[e.rowIndex,e.colIndex].concat(Se(t.split(":")[1])),R,N;switch(e.refresh){case"All":l.renderTable({cells:T,indexes:F,top:e.top,left:e.left,initLoad:i,isRefreshing:r,isOpen:A,openOptions:s});break;case"Row":l.refreshRowContent({cells:T,indexes:F,skipUpdateOnFirst:e.skipUpdateOnFirst,prevRowColCnt:c}),R=!1,N={isEdit:R},a.parent.notify(md,N),N.isEdit&&a.parent.notify(fi,{action:"startEdit",refreshCurPos:!1});break;case"Column":l.refreshColumnContent({cells:T,indexes:F,skipUpdateOnFirst:e.skipUpdateOnFirst,prevRowColCnt:c,insertDelete:e.insertDelete});break;case"RowPart":l.updateRowContent({cells:T,indexes:F,direction:e.direction,skipUpdateOnFirst:e.skipUpdateOnFirst,prevRowColCnt:c});break;case"ColumnPart":l.updateColContent({cells:T,indexes:F,direction:e.direction,skipUpdateOnFirst:e.skipUpdateOnFirst,prevRowColCnt:c});break}a.parent&&a.parent.isReact&&a.parent.renderReactTemplates()}}),this.parent.notify(Vx,{refresh:e.refresh,skipTranslate:e.skipTranslate})},o.prototype.updateTopLeftScrollPosition=function(e){var t=Se(e.sheet.topLeftCell),i=Se(e.sheet.paneTopLeftCell);if(e.sheet.frozenRows){var r=this.parent.frozenRowCount(e.sheet);i[0]>r&&(e.top=Ri(e.sheet,r,i[0]-1,!0))}else e.rowIndex&&(e.rowIndex=0),t[0]!==0&&(e.top=Ri(e.sheet,0,t[0]-1,!0));if(e.sheet.frozenColumns){var n=this.parent.frozenColCount(e.sheet);i[1]>n&&(e.left=Ci(e.sheet,n,i[1]-1,!0))}else e.colIndex&&(e.colIndex=0),t[1]!==0&&(e.left=Ci(e.sheet,0,t[1]-1,!0))},o.prototype.removeSheet=function(){document.getElementById(this.parent.element.id+"_sheet")&&Ue(document.getElementById(this.parent.element.id+"_sheet"))},o.prototype.refreshSheet=function(e,t,i,r,n){var s=0,a=0;if(t){var l=this.parent.element.getElementsByClassName("e-main-panel")[0];l&&(s=l.scrollTop);var h=this.parent.getMainContent();h&&(a=h.scrollLeft)}this.removeSheet(),this.renderSheet(),this.parent.notify(xu,{}),this.checkTopLeftCell(!1,e,s,a,r,n),i&&Fe(this.parent.element)},o.prototype.setSheetPanelSize=function(e){var t=document.getElementById(this.parent.element.id+"_sheet_panel"),i=this.parent.element.getBoundingClientRect(),r;if(this.parent.viewport.scaleY=this.parent.viewport.scaleX=1,this.parent.enableScaling){var n=this.parent.element.offsetHeight,s=n/i.height;s!==1&&Math.abs(n-i.height)>=n*.1&&(this.parent.viewport.scaleY=s);var a=this.parent.element.offsetWidth,l=a/i.width;l!==1&&Math.abs(a-i.width)>=a*.1&&(this.parent.viewport.scaleX=l)}this.parent.height==="auto"?(t.style.height="260px",r=230):(r=i.height*this.parent.viewport.scaleY-kO(t,null,this.parent.viewport.scaleY),t.style.height=r+"px",r-=32/this.parent.viewport.scaleY),e!==void 0&&(this.colMinWidth=e),this.parent.viewport.height=r;var h=i.width*this.parent.viewport.scaleX;this.parent.viewport.width=h-32/this.parent.viewport.scaleX,this.parent.viewport.rowCount=this.roundValue(r,20),this.parent.viewport.colCount=this.roundValue(h,this.colMinWidth||64)},o.prototype.roundValue=function(e,t){var i=e/t,r=Math.round(i);return Math.abs(i-r)<.5?r:r-1},o.prototype.moveOrDuplicateSheetHandler=function(e){this.parent.notify(rh,null),e.refresh&&this.refreshSheet(e.isDuplicate)},o.prototype.decreaseHidden=function(e,t,i,r){r===void 0&&(r="rows"),e+=i,t+=i;for(var n=this.parent.getActiveSheet(),s=t;s>=e;s--)if(n[""+r][s]&&n[""+r][s].hidden&&(e--,e<i)){e=se(n,i,!0,r);break}return e-i},o.prototype.instantiateRenderer=function(){this.parent.serviceLocator.register("cell",new Mq(this.parent)),this.parent.serviceLocator.register("row",new Iq(this.parent)),this.parent.serviceLocator.register("sheet",new xq(this.parent))},o.prototype.destroy=function(){this.removeEventListener(),this.parent.serviceLocator.getService("row").destroy(),this.parent.serviceLocator.getService("cell").destroy(),this.colMinWidth&&(this.colMinWidth=null),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(Un,this.destroy,this),this.parent.on(Ly,this.moveOrDuplicateSheetHandler,this),this.parent.on(PI,this.updateTopLeftScrollPosition,this)},o.prototype.removeEventListener=function(){this.parent.off(Un,this.destroy),this.parent.off(Ly,this.moveOrDuplicateSheetHandler),this.parent.off(PI,this.updateTopLeftScrollPosition)},o}(),Eq=function(o,e,t,i){return new(t||(t=Promise))(function(r,n){function s(h){try{l(i.next(h))}catch(u){n(u)}}function a(h){try{l(i.throw(h))}catch(u){n(u)}}function l(h){h.done?r(h.value):new t(function(u){u(h.value)}).then(s,a)}l((i=i.apply(o,e||[])).next())})},Aq=function(o,e){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,r,n,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(h){return function(u){return l([h,u])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,r&&(n=h[0]&2?r.return:h[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,h[1])).done)return n;switch(r=0,n&&(h=[h[0]&2,n.value]),h[0]){case 0:case 1:n=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,r=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!n||h[1]>n[0]&&h[1]<n[3])){t.label=h[1];break}if(h[0]===6&&t.label<n[1]){t.label=n[1],n=h;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(h);break}n[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(o,t)}catch(u){h=[6,u],r=0}finally{i=n=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},PO=function(){function o(e){this.parent=e,this.init(),this.addEventListener()}return o.prototype.init=function(){this.parent.element.appendChild(this.parent.createElement("input",{className:"e-clipboard",attrs:{contenteditable:"true",tabindex:"-1","aria-hidden":"true"}}))},o.prototype.addEventListener=function(){var e=this.getClipboardEle();this.parent.on(Cu,this.cut,this),this.parent.on(wu,this.copy,this),this.parent.on(Ga,this.paste,this),this.parent.on(yd,this.clearCopiedInfo,this),this.parent.on(qx,this.tabSwitchHandler,this),this.parent.on(bu,this.cMenuBeforeOpenHandler,this),this.parent.on(Of,this.ribbonClickHandler,this),this.parent.on(In,this.initCopyIndicator,this),this.parent.on(An,this.rowHeightChanged,this),this.parent.on(_n,this.colWidthChanged,this),this.parent.on(Fy,this.refreshOnInsertDelete,this),E.add(e,"cut",this.cut,this),E.add(e,"copy",this.copy,this),E.add(e,"paste",this.paste,this)},o.prototype.removeEventListener=function(){var e=this.getClipboardEle();this.parent.isDestroyed||(this.parent.off(Cu,this.cut),this.parent.off(wu,this.copy),this.parent.off(Ga,this.paste),this.parent.off(yd,this.clearCopiedInfo),this.parent.off(qx,this.tabSwitchHandler),this.parent.off(bu,this.cMenuBeforeOpenHandler),this.parent.off(Of,this.ribbonClickHandler),this.parent.off(In,this.initCopyIndicator),this.parent.off(An,this.rowHeightChanged),this.parent.off(_n,this.colWidthChanged),this.parent.off(Fy,this.refreshOnInsertDelete)),E.remove(e,"cut",this.cut),E.remove(e,"copy",this.copy),E.remove(e,"paste",this.paste)},o.prototype.ribbonClickHandler=function(e){var t=this.parent.element.id;switch(e.item.id){case t+"_cut":this.cut({invokeCopy:!0});break;case t+"_copy":this.copy({invokeCopy:!0});break}},o.prototype.tabSwitchHandler=function(e){e.activeTab===0&&!this.copiedInfo&&!this.copiedShapeInfo&&this.hidePaste()},o.prototype.cMenuBeforeOpenHandler=function(e){var t=this.parent.getActiveSheet(),i=this.parent.serviceLocator.getService(fe),r=[],n=[],s=[],a=[],l=t.activeCell,h=Se(l),u=G(h[0],h[1],t),c=t.isProtected&&un(u,Rt(t,h[1])),d=Lo(u,Rt(t,h[1]),Ar(t,h[0]));(e.target==="Content"||e.target==="RowHeader"||e.target==="ColumnHeader"||e.target==="SelectAll")&&(this.parent.enableContextMenuItems([i.getConstant("Paste"),i.getConstant("PasteSpecial")],!!(this.copiedInfo||this.copiedShapeInfo&&!c)),this.parent.enableContextMenuItems([i.getConstant("Cut")],!c)),e.target==="Content"&&(t.isProtected&&this.parent.enableContextMenuItems([i.getConstant("Filter"),i.getConstant("Sort"),i.getConstant("AddNote")],!1),c?this.parent.enableContextMenuItems([i.getConstant("Cut"),i.getConstant("Hyperlink"),i.getConstant("EditNote"),i.getConstant("DeleteNote")],!1):d?this.parent.enableContextMenuItems([i.getConstant("Cut"),i.getConstant("Paste"),i.getConstant("PasteSpecial"),i.getConstant("Filter"),i.getConstant("Sort"),i.getConstant("Hyperlink"),i.getConstant("EditHyperlink"),i.getConstant("OpenHyperlink"),i.getConstant("RemoveHyperlink"),i.getConstant("AddNote")],!1):t.isProtected&&!t.protectSettings.insertLink&&this.parent.enableContextMenuItems([i.getConstant("Hyperlink")],!1)),t.isProtected&&(e.target==="ColumnHeader"&&(s=[i.getConstant("DeleteColumn"),i.getConstant("DeleteColumns"),i.getConstant("InsertColumn"),i.getConstant("InsertColumns")],a=[i.getConstant("HideColumn"),i.getConstant("HideColumns"),i.getConstant("UnhideColumns")],this.parent.enableContextMenuItems(s,!1),this.parent.enableContextMenuItems(a,t.protectSettings.formatColumns)),e.target==="RowHeader"&&(r=[i.getConstant("DeleteRow"),i.getConstant("DeleteRows"),i.getConstant("InsertRow"),i.getConstant("InsertRows")],n=[i.getConstant("HideRow"),i.getConstant("HideRows"),i.getConstant("UnhideRows")],this.parent.enableContextMenuItems(r,!1),this.parent.enableContextMenuItems(n,t.protectSettings.formatRows)))},o.prototype.rowHeightChanged=function(e){if(this.copiedInfo){var t=this.getCopyIndicator();t&&(this.copiedInfo.range[0]>e.rowIdx?t.style.top=parseFloat(t.style.top)+e.threshold+"px":Co(this.copiedInfo.range,e.rowIdx,this.copiedInfo.range[1])&&(t.style.height=parseFloat(t.style.height)+e.threshold+"px"))}},o.prototype.colWidthChanged=function(e){if(this.copiedInfo){var t=this.getCopyIndicator();t&&(this.copiedInfo.range[1]>e.colIdx?t.style.left=parseFloat(t.style.left)+e.threshold+"px":Co(this.copiedInfo.range,this.copiedInfo.range[0],e.colIdx)&&(t.style.width=parseFloat(t.style.width)+e.threshold+"px"))}},o.prototype.cut=function(e){this.setCopiedInfo(e,!0)},o.prototype.copy=function(e){this.setCopiedInfo(e,!1)},o.prototype.paste=function(e){var t=this;if(this.parent.isEdit||this.parent.element.getElementsByClassName("e-dlg-overlay").length>0){var i=this.parent.element.getElementsByClassName("e-spreadsheet-edit")[0];i.style.height="auto";return}var r,n=e&&e.clipboardData||window.clipboardData;if(!(n&&e.clipboardData&&e.clipboardData.getData("isInternalCut").length&&!this.copiedInfo))if(n||this.copiedShapeInfo||e.isInternal&&this.copiedInfo){e.isInternal=!n;var s=void 0,a=this.getCopiedIdx();e.isAction=!!n||e.isAction;var l=e&&e.sIdx>-1?e.sIdx:this.parent.activeSheetIndex,h=ke(this.parent,l),u=tt(e&&e.range||J(h.selectedRange)),c=void 0,d=void 0;if(n){if(c=this.getExternalCells(e),d=c.model,!e.isInternal&&c.internal&&(n=!1,!this.copiedInfo))return;if(!d||!d.length)if(c.file){this.parent.notify(DI,{file:c.file});return}else if(this.copiedInfo)n=!1;else return}c=c;var p=Object.assign({isExternal:n},this.copiedInfo),f,v,m=void 0,y=void 0,S=void 0,b=void 0,w,I=void 0,x=void 0;n?(v=l,w=ke(this.parent,v),m={},b=c.selection,S=b!=="Sheet"&&(u[2]-u[0]+1)%c.rowCount===0&&(u[3]-u[1]+1)%c.colCount===0,f=[0,0,c.usedRowIndex,c.usedColIndex]):(f=tt(this.copiedShapeInfo?J(h.selectedRange):this.copiedInfo.range),v=a,m=Rt(h,f[1]),y=mf(f)&&this.isRangeMerged(u,h),w=ke(this.parent,v),S=!y&&(u[2]-u[0]+1)%(f[2]-f[0]+1)===0&&(u[3]-u[1]+1)%(f[3]-f[1]+1)===0,w&&(I=f[1]===0&&f[3]===w.colCount-1,x=f[0]===0&&f[2]===w.rowCount-1,I?x?(b="Sheet",f[2]=w.usedRange.rowIndex,f[3]=w.usedRange.colIndex):(b="Row",f[3]=w.usedRange.colIndex):x&&(b="Column",f[2]=w.usedRange.rowIndex))),r=S?u:[u[0],u[1]].concat([u[0]+f[2]-f[0],u[1]+f[3]-f[1]||u[1]]),b&&((b==="Sheet"||b==="Column")&&r[2]<h.usedRange.rowIndex&&(r[2]=h.usedRange.rowIndex),(b==="Sheet"||b==="Row")&&r[3]<h.usedRange.colIndex&&(r[3]=h.usedRange.colIndex));var M=e&&e.type||"All";if(qi(this.parent,r)){this.parent.notify(nr,null);return}else if(h.isProtected&&ko(this.parent,r)){this.parent.notify(ba,null);return}if(e.isAction&&!this.copiedShapeInfo){var D={requestType:"paste",copiedInfo:this.copiedInfo,copiedRange:Be(f),pastedRange:Be(r),type:M,cancel:!1};if(this.parent.notify(ai,{eventArgs:D,action:"clipboard"}),D.cancel)return;u=J(D.pastedRange),n?S=c.selection!=="Sheet"&&(u[2]-u[0]+1)%c.rowCount===0&&(u[3]-u[1]+1)%c.colCount===0:S=!y&&!I&&(u[2]-u[0]+1)%(f[2]-f[0]+1)===0&&!x&&(u[3]-u[1]+1)%(f[3]-f[1]+1)===0,r=S?u:[u[0],u[1]].concat([u[0]+f[2]-f[0],u[1]+f[3]-f[1]||u[1]]),M=D.type}var A=void 0;b?(A=[].concat(r),(b==="Sheet"||b==="Column")&&(r[2]<h.usedRange.rowIndex&&(r[2]=h.usedRange.rowIndex),f[2]<h.usedRange.rowIndex&&(f[2]+=h.usedRange.rowIndex-f[2]),A[2]<h.rowCount&&(A[2]=h.rowCount-1)),(b==="Sheet"||b==="Row")&&(r[3]<h.usedRange.colIndex&&(f[3]+=h.usedRange.colIndex-r[3],r[3]=h.usedRange.colIndex),f[3]<h.usedRange.colIndex&&(f[3]+=h.usedRange.colIndex-f[3]),A[3]<h.colCount&&(A[3]=h.colCount-1))):A=r;var L=void 0,T=void 0,k=void 0,F=u[0],R=[];if(h.isProtected&&ko(this.parent,r)){this.parent.notify(ba,null);return}if(this.copiedShapeInfo&&!this.copiedInfo){var N=this.copiedShapeInfo.pictureElem;N.classList.contains("e-datavisualization-chart")?(this.copiedShapeInfo.chartInfo.top=null,this.copiedShapeInfo.chartInfo.left=null,this.parent.notify(oh,{chart:[this.copiedShapeInfo.chartInfo],isInitCell:!0,isUndoRedo:!0,isPaste:!0,dataSheetIdx:this.copiedShapeInfo.sheetIdx,isCut:this.copiedShapeInfo.isCut,range:e.range||h.selectedRange,sheetId:h.id})):this.parent.notify(Ya,{options:{src:N.style.backgroundImage.replace(/url\((['"])?(.*?)\1\)/gi,"$2"),height:this.copiedShapeInfo.height,width:this.copiedShapeInfo.width,id:this.copiedShapeInfo.isCut?N.id:""},range:Be([F,u[1],F,u[1]]),isPublic:!1,isUndoRedo:!0});var P=G(F,u[1],h);if(P&&!g(P.image)&&P.image.length>0){var O={requestType:"imagePaste",copiedShapeInfo:this.copiedShapeInfo,pasteSheetIndex:this.parent.activeSheetIndex,pastedRange:Vn(this.parent)+"!"+Be([F,u[1],F,u[1]]),pastedPictureElement:document.getElementById(P.image[P.image.length-1].id)};this.parent.notify(mt,{eventArgs:O,action:"clipboard"})}}else{var z=[],H=this.isInRange(f,u,a),Q=!1,$=!1,U=0,ie=[],ne=void 0,te=void 0;!S&&M!=="Values"&&(ne=this.setCF(f,r,w,h,ie,ne));for(var oe=!1,ae=[],ye={sheet:h,isExternal:!!n},De=this.setCell(ye),ve=!n&&this.copiedInfo.isCut&&this.setCell({sheet:w}),ue=[],Tt=[],_e=f[0],lt=0;_e<=f[2];_e++,lt++){if(!n&&!p.isCut&&Jn(w,_e)){lt--,U++;continue}H&&(z[u[0]+lt]={cells:[]});for(var We=f[1],ct=0;We<=f[3];We++,ct++){if(H&&(z[u[0]+lt].cells[u[1]+ct]=G(u[0]+lt,u[1]+ct,w,!1,!0)),L=n?d[_e]&&d[_e].cells[We]||{}:he({},H&&z[_e]&&z[_e].cells[We]?z[_e].cells[We]:G(_e,We,w),null,!0),m=Rt(w,We),!L.validation&&Ds(m,_e,We)){var Dt=Object.assign({},m.validation),Xt=[0,f[1],0,f[3]],Lt=Dt.value1,Bi=Dt.value2;ut(Lt)&&(Dt.value1=Hn([_e,We],Xt,w,this.parent,{formula:Lt})),ut(Bi)&&(Dt.value2=Hn([_e,We],Xt,w,this.parent,{formula:Bi})),L.validation=Dt}if(L&&L.isReadOnly&&delete L.isReadOnly,I||x){if(L&&L.rowSpan){if(L.rowSpan>0)L.rowSpan+_e-1<=f[2]?Q=!0:L={};else if(!Q)L={};else if(L.rowSpan<0){var zi=L.rowSpan,Ct=L.colSpan?L.colSpan:0,Ei=G(F+zi,u[1]+ct+Ct,h);Ei&&!Ei.rowSpan&&(L={})}}L&&L.colSpan&&(L.colSpan>0?L.colSpan+We-1<=f[3]?$=!0:L={}:$||(L={}))}if(L&&M){var ji=void 0;switch(M){case"Formats":ji={format:L.format,style:L.style},this.copiedInfo&&!this.copiedInfo.isCut&&(L.rowSpan&&(ji.rowSpan=L.rowSpan),L.colSpan&&(ji.colSpan=L.colSpan)),L=ji;break;case"Values":if(L={value:L.value},L.value&&L.value.toString().indexOf(`
`)>-1){var Ur=this.parent.getCell(u[0],u[1]);Ur.classList.add("e-alt-unwrap")}break}T=["Formats","Values"].indexOf(M)>-1}if(!this.parent.scrollSettings.isFinite&&(f[2]-f[0]>1048575-u[0]||f[3]-f[1]>16383-u[1])||this.parent.scrollSettings.isFinite&&(f[2]-f[0]>h.rowCount-1-u[0]||f[3]-f[1]>h.colCount-1-u[1])){this.showDialog();return}if(S){for(var Fi=u[0];Fi<=u[2];Fi+=f[2]-f[0]+1)if(!(!p.isCut&&!U&&Jn(h,Fi+lt)))for(var Tr=u[1];Tr<=u[3];Tr+=f[3]-f[1]+1){if(_e===f[0]&&We===f[1]&&(ne===void 0||ne.length)&&M!=="Values"&&(ne=this.setCF(f,[Fi,Tr,Fi+(f[2]-f[0]),Tr+(f[3]-f[1])],w,h,ie,ne)),k=G(Fi+lt,Tr+ct,h,!1,!0),!n&&(!g(k.colSpan)||!g(k.rowSpan))){if(I||x)continue;var _={range:[Fi+lt,Tr+ct,Fi+lt,Tr+ct],merge:!1,isAction:!1,type:"All",sheetIndex:l,preventRefresh:l!==this.parent.activeSheetIndex};R.push(_),this.parent.notify(Mn,_)}var Z=Tr+ct;if(L=he({},L||{},null,!0),!T&&this.copiedInfo&&!this.copiedInfo.isCut&&L.formula){var we=Hn([Fi+lt,Z],[_e,We],w,this.parent,H?L:null);g(we)||(L.formula=we)}if(this.copiedInfo&&!this.copiedInfo.isCut&&L.validation){var Te=u,Xt=f,je=Hn(Te,Xt,w,this.parent,{formula:L.validation.value1});L.validation.value1=je,L.validation.value2!==""&&(je=Hn(Te,Xt,w,this.parent,{formula:L.validation.value2}),L.validation.value2=je)}h.isProtected&&L&&L.isLocked!==!1&&(L.isLocked=k.isLocked),k&&k.formula&&k.formula.indexOf("=UNIQUE(")>-1&&this.parent.notify(ad,null);var He={cellIdx:[_e,We],isUnique:!1,uniqueRange:"",sheetName:w.name};this.parent.notify(gu,He),He.isUnique&&(L.value=null),oe=!1,L&&L.formula&&L.formula.indexOf("=UNIQUE(")>-1&&(oe=!0,ae.push([Fi,Z]),L.value=null),te=De(Fi+lt,Z,L,Z===u[3],T,oe,e.beforeActionData,e.isUndo),!te&&L.formula&&this.copiedInfo&&this.copiedInfo.isCut&&this.parent.notify(vu,{cellRef:Be([_e,We,_e,We])})}}else(n||!NO(this.parent,_e,We,a))&&(y?De(F,u[1]+ct,{value:L.value},We===f[3],!0):De(F,u[1]+ct,L,We===f[3],T));if(!n&&this.copiedInfo.isCut&&!(Co(u,_e,We)&&a===this.parent.activeSheetIndex)){var gt=G(_e,We,w);if(gt){if(gt.isReadOnly)continue;if(gt.isLocked||g(gt.isLocked))if((I||x)&&(gt.rowSpan!==void 0||gt.colSpan!==void 0))if(gt.rowSpan>1||gt.colSpan>1)ue.push({range:[_e,We,_e,We],rowSpan:gt.rowSpan,colSpan:gt.colSpan}),gt=null;else continue;else!gt.validation&&w.columns[We]&&w.columns[We].validation&&Tt.indexOf(We)===-1&&Tt.push(We),gt=null;else gt.isLocked===!1&&(w.isProtected?gt={isLocked:!1}:gt=null)}ve(_e,We,gt,We===f[3])}}F++}if(ue.length&&ue.forEach(function(yn){oi(yn.range[0],yn.range[1],w,{rowSpan:yn.rowSpan,colSpan:yn.colSpan});var ps={range:yn.range};t.parent.notify(Do,ps),t.parent.notify(Mn,{merge:!1,range:ps.range,type:"All",sheetIndex:v,preventRefresh:v!==t.parent.activeSheetIndex}),ps.range=ps.range;for(var Id=ps.range[0];Id<=ps.range[2];Id++)for(var Fo=ps.range[1];Fo<=ps.range[3];Fo++)ve(Id,Fo,null)}),Tt.length&&Tt.forEach(function(yn){t.parent.notify(To,{range:w.name+"!"+Be([f[0],yn,f[2],yn]),isRemoveValidation:!0})}),ae.length)for(var _e=0;_e<ae.length;_e++)this.parent.serviceLocator.getService("cell").refresh(ae[_e][0],ae[_e][1]);ye.isRandFormula&&this.parent.calculationMode==="Automatic"&&this.parent.notify(xt,{action:"refreshRandomFormula"}),this.parent.notify(Es,null);var Lr=r[2]-U,Ai=A[2]-U;r[2]=Lr,A[2]=Ai,this.parent.setUsedRange(r[2],r[3]);var dn=Be(A);l===this.parent.activeSheetIndex&&!e.isFromUpdateAction&&this.parent.notify(Su,{address:dn}),!n&&this.copiedInfo.isCut&&(s=this.copiedInfo.isCut,a===this.parent.activeSheetIndex&&this.parent.serviceLocator.getService("cell").refreshRange(f),this.clearCopiedInfo()),(n||H)&&this.copiedInfo&&this.clearCopiedInfo();var tn=void 0;if(s){ne&&ne.length&&M!=="Values"&&(tn={range:f,sheetIdx:v,isClear:!0},this.parent.notify(qa,tn)),sh(w,f[0],f[1],(this.parent.getRow(f[0],null,this.parent.frozenColCount(w))||{offsetHeight:20}).offsetHeight);var mn=Mo(w,f[0]);va(this.parent,w,mn,f[0])}ie.length&&l===this.parent.activeSheetIndex&&this.parent.notify(Wi,{cfModel:ie,isAction:!0});var Sa=ke(this.parent,a);if(!n&&f[0]===f[2]&&b==="Row"){for(var mn=Sa.rows[f[0]].height,_e=u[0];_e<=u[2];_e++)va(this.parent,this.parent.getActiveSheet(),mn,_e);if(s){var xd=Sa&&Sa.standardHeight?Sa.standardHeight:20;va(this.parent,Sa,xd,f[0])}}if(e.isAction){var O={requestType:"paste",copiedInfo:p,mergeCollection:R,pasteSheetIndex:this.parent.activeSheetIndex,copiedRange:w.name+"!"+(p.range?Be(p.range):w.selectedRange),pastedRange:h.name+"!"+Be(r),type:M||"All",selectedRange:dn};U&&(O.skipFilterCheck=!0),tn&&tn.cfClearActionArgs&&(O.cfClearActionArgs=tn.cfClearActionArgs),ie.length&&(O.cfActionArgs={cfModel:ie,sheetIdx:l}),this.parent.notify(mt,{eventArgs:O,action:"clipboard"})}e.focus&&Fe(this.parent.element)}}else this.getClipboardEle().select()},o.prototype.setCF=function(e,t,i,r,n,s){var a=this,l,h,u=function(p){l=[t[0]+(h[0]<=e[0]?0:h[0]-e[0]),t[1]+(h[1]<=e[1]?0:h[1]-e[1]),t[2]-(h[2]>=e[2]?0:e[2]-h[2]),t[3]-(h[3]>=e[3]?0:e[3]-h[3])],r.conditionalFormats||a.parent.setSheetPropertyOnMute(r,"conditionalFormats",[]);var f={range:Be(l),type:p.type,cFColor:p.cFColor,value:p.value,format:p.format};r.conditionalFormats.push(f),n.push(f)};if(s)for(var c=0,d=s.length;c<d;c++)h=J(s[c].range),u(s[c]);else if(s=[],i.conditionalFormats)for(var c=0,d=i.conditionalFormats.length;c<d;c++)h=J(i.conditionalFormats[c].range),zy([e],i.conditionalFormats[c].range)&&(s.push(i.conditionalFormats[c]),u(i.conditionalFormats[c]));return s},o.prototype.isRangeMerged=function(e,t){var i=G(e[0],e[1],t);if(i&&(i.colSpan>1||i.rowSpan>1)){var r={range:e.slice(2,4).concat(e.slice(2,4))};return this.parent.notify(ur,r),r.range[0]===e[0]&&r.range[1]===e[1]&&r.range[2]===e[2]&&r.range[3]===e[3]}return!1},o.prototype.updateFilter=function(e,t){var i,r;this.parent.notify(cy,null);for(var n=0;n<this.parent.sheets.length;n++)if(this.parent.filterCollection&&this.parent.filterCollection[n]&&this.parent.filterCollection[n].sheetIndex===cn(this.parent,e.sId)){var s=e.range,a=J(this.parent.filterCollection[n].filterRange);s=tt(s),a[0]===s[0]&&a[2]===s[2]&&a[1]===s[1]&&a[3]===s[3]&&(i=!0,r=[Math.abs(s[0]-a[0]),Math.abs(s[1]-a[1]),Math.abs(s[2]-a[2]),Math.abs(s[3]-a[3])])}var l=this.parent.getCell(e.range[0],e.range[1]);l=l&&(l.querySelector(".e-filter-icon")?l:this.parent.getCell(e.range[2],e.range[3]));var h=l&&l.querySelector(".e-sortasc-filter"),u=l&&l.querySelector(".e-sortdesc-filter");if(i)for(var c=0;c<this.parent.filterCollection.length;c++){var d=this.parent.filterCollection[c],p=e&&e.sId?cn(this.parent,e.sId):this.parent.activeSheetIndex;if(d.sheetIndex===p&&this.parent.notify(Eo,{predicates:null,range:d.filterRange,sIdx:p,isCut:!0}),d.sheetIndex===p&&p===this.parent.activeSheetIndex&&(r=[t[0]+r[0],t[1]+r[1],Math.abs(t[2]-r[2]),Math.abs(t[3]-r[3])],this.parent.notify(Eo,{predicates:null,range:Be(r),sIdx:null,isCut:!0}),e.range[3]===e.range[1])){var f=this.parent.getCell(t[0],t[1]);h&&f&&f.querySelector(".e-filter-icon").classList.add("e-sortasc-filter"),u&&f&&f.querySelector(".e-filter-icon").classList.add("e-sortdesc-filter")}}},o.prototype.isInRange=function(e,t,i){var r=this.parent.activeSheetIndex;return Co(e,t[0],t[1])&&i===r||Co(e,t[2],t[3])&&i===r},o.prototype.setCell=function(e){var t=this,i=e.sheet,r=i.name===this.parent.getActiveSheet().name;return function(n,s,a,l,h,u,c,d){a&&a.formula&&(a.formula.indexOf("RANDBETWEEN(")>-1||a.formula.indexOf("RAND(")>-1||a.formula.indexOf("NOW(")>-1)&&(e.isRandFormula=!0);var p=sr(t.parent,i,{cell:a,rowIdx:n,colIdx:s,pvtExtend:!h,valChange:!u,lastCell:l,uiRefresh:r,requestType:"paste",skipFormatCheck:!e.isExternal,isRandomFormula:e.isRandFormula},c,d);if(!p&&a&&a.style&&e.isExternal){var f=id(t.parent,n,s,i,a.style||t.parent.cellStyle,a.wrap?qf(t.parent.getDisplayText(a),Au(i,n,s,a.colSpan>1?s+a.colSpan-1:s),a.style,t.parent.cellStyle):1);f=Math.round(f),f<20&&(f=20),sh(i,n,s,f);var v=Ri(i,n),m=Mo(i,n),y=m>v;y&&va(t.parent,i,m,n)}return p}},o.prototype.getCopiedIdx=function(){if(this.copiedInfo){for(var e=0;e<this.parent.sheets.length;e++)if(this.parent.sheets[e].id===this.copiedInfo.sId)return e;this.clearCopiedInfo()}return-1},o.prototype.setCopiedInfo=function(e,t){var i=this;if(!this.parent.isEdit){var r=new kn;e.promise=r.promise;var n=this.parent.getActiveSheet(),s;if(e&&e.range){var a=e.range[1]===0&&e.range[3]===n.colCount-1,l=e.range[0]===0&&e.range[2]===n.rowCount-1,h={range:e.range};a||l||this.parent.notify(Do,h),s=h.range}else s=J(n.selectedRange);if(t&&qi(this.parent,s)){this.parent.notify(nr,null);return}if(e&&!e.isPublic&&!e.clipboardData){var u={copiedRange:n.name+"!"+Be(s),cancel:!1,action:t?"cut":"copy"};if(this.parent.notify(ai,u),u.cancel)return}var c={sheet:n,indexes:[0,0,n.rowCount-1,n.colCount-1],isFinite:this.parent.scrollSettings.isFinite,promise:new Promise(function(f){f(function(){}())})},d=document.getElementsByClassName("e-ss-overlay-active"),p=d.length;n.isLocalData&&!(e&&e.clipboardData)&&s[0]===0&&s[2]===n.rowCount-1&&!p&&(this.parent.showSpinner(),this.parent.notify("updateSheetFromDataSource",c)),this.checkForUncalculatedFormula(s,e&&e.sId?e.sId:n.id),c.promise.then(function(){if(p>0){var f={clientY:d[0].offsetTop,isImage:!0};i.parent.notify(Ys,f);var v={clientX:d[0].offsetLeft,isImage:!0};if(i.parent.notify(Qs,v),i.copiedShapeInfo={sId:e&&e.sId?e.sId:n.id,sheetIdx:n.index,isCut:t,pictureElem:d[0],copiedRange:Be([f.clientY,v.clientX,f.clientY,v.clientX]),height:d[0].offsetHeight,width:d[0].offsetWidth,chartInfo:i.getChartElemInfo(d[0])},!d[0].classList.contains("e-datavisualization-chart")){var m=window.getComputedStyle(d[0]).backgroundImage.slice(5,-2);i.addImgToClipboard(m,i.copiedShapeInfo.height,i.copiedShapeInfo.width)}i.hidePaste(!0),t&&(d[0].classList.contains("e-datavisualization-chart")?i.parent.deleteChart(i.copiedShapeInfo.chartInfo.id):i.parent.notify(ga,{id:i.copiedShapeInfo.pictureElem.id,sheetIdx:i.copiedShapeInfo.sId,range:i.copiedShapeInfo.copiedRange}))}else e&&e.clipboardData||(i.copiedInfo&&i.clearCopiedInfo(),i.copiedInfo={range:s,sId:e&&e.sId?e.sId:n.id,isCut:t},i.hidePaste(!0),e.isFromUpdateAction||i.initCopyIndicator(),B.isIE||i.getClipboardEle().select(),e&&e.invokeCopy&&document.execCommand(t?"cut":"copy"),i.parent.hideSpinner());B.isIE&&i.setExternalCells(e,t),r.resolve()}),e&&e.clipboardData&&(this.setExternalCells(e,t),this.getClipboardEle().setAttribute("aria-label",n.selectedRange+" "+this.parent.serviceLocator.getService(fe).getConstant(t?"Cut":"Copy")))}},o.prototype.imageToCanvas=function(e,t,i){return new Promise(function(r){var n=document.createElement("canvas"),s=n.getContext("2d"),a=new Image;a.src=e,a.crossOrigin="anonymous",a.onload=function(){n.width=i,n.height=t,s.drawImage(a,0,0,i,t),n.toBlob(function(l){r(l)},"image/png")}})},o.prototype.addImgToClipboard=function(e,t,i){return Eq(this,void 0,void 0,function(){var r,n,s;return Aq(this,function(a){switch(a.label){case 0:return n=window.navigator,[4,this.imageToCanvas(e,t,i)];case 1:return s=a.sent(),[4,n.clipboard.write([new ClipboardItem((r={},r[s.type]=s,r))])];case 2:return a.sent(),[2]}})})},o.prototype.checkForUncalculatedFormula=function(e,t){for(var i,r=cn(this.parent,t),n=ke(this.parent,r),s=e[0];s<=e[2];s++)for(var a=e[1];a<=e[3];a++)i=G(s,a,n,null,!0),i.formula&&Ee(i.value)&&this.parent.notify(xt,{action:"refreshCalculate",value:i.formula,rowIndex:s,colIndex:a,isFormula:ut(i.formula),sheetIndex:r})},o.prototype.getChartElemInfo=function(e){var t=this.parent.chartColl;if(e.classList.contains("e-datavisualization-chart")){for(var i=e.getElementsByClassName("e-control")[0].id,r=0;r<t.length;r++)if(t[r].id===i){var n=t[r];return n}}return null},o.prototype.clearCopiedInfo=function(){this.copiedInfo&&(this.parent.getActiveSheet().id===this.copiedInfo.sId&&(this.removeIndicator(this.parent.getSelectAllContent()),this.removeIndicator(this.parent.getColumnHeaderContent()),this.removeIndicator(this.parent.getRowHeaderContent()),this.removeIndicator(this.parent.getMainContent())),this.copiedInfo=null,this.hidePaste()),this.copiedShapeInfo&&(this.copiedShapeInfo=null,this.hidePaste())},o.prototype.removeIndicator=function(e){if(e){var t=e.getElementsByClassName("e-copy-indicator")[0];t&&ee(t)}},o.prototype.initCopyIndicator=function(){if(this.copiedInfo&&this.parent.getActiveSheet().id===this.copiedInfo.sId){var e=this.parent.createElement("div",{className:"e-copy-indicator"});e.appendChild(this.parent.createElement("div",{className:"e-top"})),e.appendChild(this.parent.createElement("div",{className:"e-bottom"})),e.appendChild(this.parent.createElement("div",{className:"e-left"})),e.appendChild(this.parent.createElement("div",{className:"e-right"})),Us(this.parent,e,this.copiedInfo.range,"e-copy-indicator")}},o.prototype.showDialog=function(){var e=this;this.parent.serviceLocator.getService(jt).show({header:"Spreadsheet",height:205,width:340,isModal:!0,showCloseIcon:!0,content:this.parent.serviceLocator.getService(fe).getConstant("PasteAlert"),beforeOpen:function(t){var i={dialogName:"PasteDialog",element:t.element,target:t.target,cancel:t.cancel};e.parent.trigger("dialogBeforeOpen",i),i.cancel&&(t.cancel=!0)}})},o.prototype.hidePaste=function(e){this.parent.getActiveSheet().isProtected&&(e=!1),this.parent.notify(da,[{items:[this.parent.element.id+"_paste"],enable:e||!1}])},o.prototype.setExternalCells=function(e,t){var i,r,n="",s,a=this.parent.getActiveSheet(),l=tt(this.copiedInfo.range),h=l[1]===0&&l[3]===a.colCount-1,u=l[0]===0&&l[2]===a.rowCount-1,c='<html><body><table class="e-spreadsheet" xmlns="http://www.w3.org/1999/xhtml" style="border-collapse:collapse;"';(h||u)&&(c+=' aria-rowcount="'+a.usedRange.rowIndex+'" aria-colcount="'+a.usedRange.colIndex+'"',c+=' aria-label="'+(h&&u?"Sheet":h?"Row":"Column")+'"'),c+="><tbody>";for(var d=l[0];d<=l[2];d++)if(!(!t&&Jn(a,d))){c+="<tr>";for(var p=l[1];p<=l[3];p++)if(i=G(d,p,a,!1,!0),!(i.colSpan<0||i.rowSpan<0)){if(c+="<td",i.colSpan&&(c+=' colspan="'+i.colSpan+'"'),i.rowSpan&&(c+=' rowspan="'+i.rowSpan+'"'),i.style?(s="",i.style.whiteSpace||(s+="white-space:"+(i.wrap?"normal":"nowrap")+";"),i.style.verticalAlign||(s+="vertical-align:bottom;"),Object.keys(i.style).forEach(function(v){var m=i.style[""+v];v.includes("border")&&m.includes("dashed")&&m.includes("1px")&&(m=m.replace("1px","thin"));var y=v.match(/[A-Z]/);s+=(v==="backgroundColor"?"background":y?v.replace(y[0],"-"+y[0].toLowerCase()):v)+":"+(v==="backgroundColor"||v==="color"?i.style[""+v].slice(0,7):m)+";"}),c+=s.includes('"')?" style='"+s+"'":' style="'+s+'"'):c+=' style="white-space:'+(i.wrap?"normal":"nowrap")+';vertical-align:bottom;"',g(i.value))c+="></td>";else{if(r=i.value,i.format&&i.format!=="General"){c+=i.value.toString().includes('"')?" cell-value='"+r+"'":' cell-value="'+i.value+'"',c+=i.format.includes('"')?" num-format='"+i.format+"'":' num-format="'+i.format+'"';var f={formattedText:r,value:r,format:i.format,cell:i,rowIndex:d,colIndex:p,dataUpdate:!0};this.parent.notify(en,f),r=f.formattedText}c+=">",typeof r=="string"&&r.includes(`
`)?c+=r.split(`
`).join("<br>"):c+=r,n+=r,c+="</td>"}n+=p===l[3]?"":"	"}c+="</tr>",n+=d===l[2]?"":`
`}c+="</tbody></table></body></html>",B.isIE?(window.clipboardData.setData("text",n),t&&window.clipboardData.setData("isInternalCut",n)):(e.clipboardData.setData("text/html",c),e.clipboardData.setData("text/plain",n),t&&e.clipboardData.setData("isInternalCut",n),e.preventDefault())},o.prototype.getExternalCells=function(e){var t=this,i,r,n=[],s={model:n},a=this.parent.createElement("span"),l=function(){return setTimeout(function(){t.getClipboardEle().innerHTML=""},0)};if(B.isIE)r=window.clipboardData.getData("text");else{if(i=e.clipboardData.getData("text/html"),r=e.clipboardData.getData("text/plain"),this.copiedInfo&&i.includes('<table class="e-spreadsheet"')){var h=!1;if(!this.copiedInfo.isCut){var u={sheetIdx:cn(this.parent,this.copiedInfo.sId)};if(this.parent.notify(Du,u),u.isFiltered){var c=u.filterRange,d=this.copiedInfo.range;h=c[0]===d[0]&&c[1]===d[1]&&c[2]===d[2]&&c[3]===d[3]}}if(!h)return l(),{internal:!0}}a.innerHTML=i}if(a.querySelector("table"))this.generateCells(a,s);else if(a.querySelector("img")){var p=a.querySelector("img");this.parent.notify(Ya,{options:{src:p.src,height:p.height,width:p.width},isPublic:!0})}else if(r){var f=[],v,m,y;i&&(m=[].slice.call(a.children));var S=this.cellStyle(a);s.colCount=1,r.split(`
`).forEach(function(b){v=null,i&&(y=m.filter(function(w){return w.textContent&&w.textContent.replace(/(\r\n|\n|\r|\s)/gm," ").trim()===b.trim()})[0],y&&(v=S(y),m.splice(m.indexOf(y),1))),b.split("	").forEach(function(w,I){(w||v)&&(f[I]={},v&&(v.whiteSpace&&v.whiteSpace!=="nowrap"?(f[I].wrap=!0,delete v.whiteSpace,Object.keys(v).length&&(f[I].style=v)):f[I].style=v),w&&(ut(w)?f[I].formula=w:f[I].value=Jc(w.trim(),!0,!0)))}),n.push({cells:f}),s.colCount=Math.max(s.colCount,f.length),f=[]}),s.rowCount=n.length,s.usedRowIndex=n.length-1,s.usedColIndex=s.colCount-1}else if(e.clipboardData.files&&e.clipboardData.files[0]&&e.clipboardData.files[0].type.includes("image"))return l(),{file:e.clipboardData.files[0]};return l(),s},o.prototype.generateCells=function(e,t){var i=t.model,r=e.querySelector("table"),n=r.classList.contains("e-spreadsheet"),s={},a={};t.usedRowIndex=r.rows.length-1,t.rowCount=r.rows.length,n&&(t.selection=r.getAttribute("aria-label"),t.selection&&(t.selection==="Sheet"?(t.usedRowIndex=Number(r.getAttribute("aria-rowcount")),t.usedColIndex=Number(r.getAttribute("aria-colcount"))):t.selection==="Row"?t.usedColIndex=Number(r.getAttribute("aria-colcount")):t.usedRowIndex=Number(r.getAttribute("aria-rowcount"))));var l=[];g(r)||g(r.getAttribute("style"))||(l.push(r.getAttribute("style")),this.generateStyles(l,s));var h=this.cellStyle(e,n),u,c,d,p,f=1,v,m,y;t.colCount=1;for(var S=[],b=0,w=t.usedRowIndex;b<=w;b++){u=r.rows[b],g(u.getAttribute("style"))||(S.push(u.getAttribute("style")),this.generateStyles(S,a)),i[b]||(i[b]={cells:[]}),c=i[b].cells,t.colCount=Math.max(t.colCount,u.cells.length),v=t.usedColIndex<u.cells.length?t.usedColIndex:u.cells.length-1;for(var I=0;I<=v;I++){if(p=u.cells[I],y=I,c[I]&&(I=this.getNewIndex(c,I)),c[I]={},d=h(p,a,s),p.textContent=p.textContent.replace(/(\r\n|\n|\r)/gm,""),p.textContent=p.textContent.replace(/\s+/g," "),d.whiteSpace&&d.whiteSpace!=="nowrap"&&(c[I].wrap=!0,delete d.whiteSpace),Object.keys(d).length&&(d.border&&(["borderBottom","borderTop","borderLeft","borderRight"].forEach(function(T){d[""+T]=d.border}),delete d.border),c[I].style=d),p.textContent&&(c[I].value=Jc(p.textContent.trim(),!0,!0)),m=n?"num-format":"number-format",p.getAttribute(m)&&(c[I].format=p.getAttribute(m),c[I].value&&p.getAttribute("cell-value")&&(c[I].value=Jc(p.getAttribute("cell-value").trim(),!0,!0))),p.getAttribute("colspan")&&parseInt(p.getAttribute("colspan"),10)>1&&(c[I].colSpan=parseInt(p.getAttribute("colspan"),10)),p.getAttribute("rowspan")&&parseInt(p.getAttribute("rowspan"),10)>1&&(c[I].rowSpan=parseInt(p.getAttribute("rowspan"),10)),c[I].colSpan>1&&c[I].rowSpan>1)for(var x=void 0,M=b,D=b+c[I].rowSpan;M<D;M++)for(var A=I,L=I+c[I].colSpan;A<L;A++)M===b&&A===I||(x=c[I].style?{style:he({},c[I].style)}:{},M!==b&&(x.rowSpan=b-M),A!==I&&(x.colSpan=I-A),i[M]||(i[M]={cells:[]}),i[M].cells[A]=x);else if(c[I].colSpan>1)for(var M=I+1,D=I+c[I].colSpan;M<D;M++)c[M]={colSpan:I-M,style:he({},d)};else if(c[I].rowSpan>1)for(var M=b+1,D=b+c[I].rowSpan;M<D;M++)i[M]||(i[M]={cells:[]}),i[M].cells[I]={rowSpan:b-M,style:he({},d)};I=y}f=Math.max(f,c.length)}t.usedColIndex=f-1},o.prototype.getNewIndex=function(e,t){return e[t]&&(t++,t=this.getNewIndex(e,t)),t},o.prototype.cellStyle=function(e,t){var i=this,r,n;if(!t){r=e.querySelector("style")&&e.querySelector("style").innerHTML;var s=Object.keys(this.parent.commonCellStyle);if(s&&s.length&&r){var a=r.includes("td")?r.split("td")[1]:r;a=a.includes("{")?a.split("{")[1].split("}")[0]:a.split("}")[0],n={};for(var l=0;l<s.length;l++){var h=s[l],u=h.match(/[A-Z]/);u&&(h=h.replace(u[0],"-"+u[0].toLowerCase())),a.indexOf(h)>-1&&(n[s[l]]=a.split(h+":")[1].split(";")[0].trim())}}}return function(c,d,p){var f={},v;if(t)if(c.getAttribute("style"))v=c.getAttribute("style").split(";");else return f;else{if(v=[],r&&c.className&&r.includes(c.classList[0])){var m=r.split(c.classList[0]);v.push(m[m.length-1].split("{")[1].split("}")[0])}var y=[].slice.call(c.querySelectorAll("*"));y.unshift(c),y.forEach(function(S){S.getAttribute("style")&&v.push(S.getAttribute("style")),S.tagName==="B"&&v.push("font-weight:bold"),S.tagName==="I"&&v.push("font-style:italic"),S.tagName==="U"&&v.push("text-decoration:underline")}),Object.assign(f,p,d,n)}return v.length&&i.generateStyles(v,f),c.querySelector("S")&&(f.textDecoration=f.textDecoration?"underline line-through":"line-through"),f.textDecoration&&["underline","line-through","underline line-through","none"].indexOf(f.textDecoration)===-1&&(f.textDecoration="none"),f.textAlign&&["left","center","right"].indexOf(f.textAlign)===-1&&(f.textAlign="left"),f.verticalAlign&&["bottom","middle","top"].indexOf(f.verticalAlign)===-1&&(f.verticalAlign="bottom"),f.fontSize&&(f.fontSize=Math.round(parseFloat(f.fontSize.indexOf("px")>-1?(parseFloat(f.fontSize)*.75).toString():f.fontSize.indexOf("em")>-1?(parseFloat(f.fontSize)*16/1.3333).toString():f.fontSize))+"pt"),f.fontWeight&&["bold","normal"].indexOf(f.fontWeight)===-1&&(f.fontWeight=f.fontWeight>"599"?"bold":"normal"),f}},o.prototype.generateStyles=function(e,t){var i,r,n,s,a,l=["font-family","vertical-align","text-align","text-indent","color","white-space","font-weight","font-style","font-size","text-decoration","background","background-color"],h=["fontFamily","verticalAlign","textAlign","textIndent","color","whiteSpace","fontWeight","fontStyle","fontSize","textDecoration","backgroundColor","backgroundColor"],u=["border-bottom","border-top","border-right","border-left","border"],c=["borderBottom","borderTop","borderRight","borderLeft","border"];e&&e.length&&e.forEach(function(d){d.split(";").forEach(function(p){if(r=p.split(":")[0].trim(),i=l.indexOf(r),i>-1)r=p.split(":")[1].trim(),t[h[i]]=r;else if(i=u.indexOf(r),i>-1){if(r=p.split(":")[1].trim(),r==="none")r=void 0;else if(r.includes("pt")){n=r.split("pt"),s=n[0].split(" ");for(var f=0;f<s.length;f++)if(a=parseFloat(s[f]),a){s.splice(f,1),s.unshift((a/.75).toFixed(2)+"px"),n[0]=s.join(" ");break}r=n.join("")}t[c[i]]=r}})})},o.prototype.refreshOnInsertDelete=function(e){if(this.copiedInfo){if(e.model.id!==this.copiedInfo.sId)return;var t=this.copiedInfo.range;if(e.isInsert){if(e.modelType==="Column"){if(e.start<=t[3]){if(e.start<=t[1]){var i=e.end-e.start+1;t[1]+=i,t[3]+=i}else t[3]=t[1]+(e.start-t[1]-1);this.performAction()}}else if(e.start<=t[2]){if(e.start<=t[0]){var i=e.end-e.start+1;t[0]+=i,t[2]+=i}else t[2]=t[1]+(e.start-t[1]-1);this.performAction()}}else this.clearCopiedInfo()}},o.prototype.performAction=function(){var e=this.getCopyIndicator();e&&Us(this.parent,e,this.copiedInfo.range,"e-copy-indicator")},o.prototype.getClipboardEle=function(){return this.parent.element.getElementsByClassName("e-clipboard")[0]},o.prototype.getCopyIndicator=function(){return this.parent.element.getElementsByClassName("e-copy-indicator")[0]},o.prototype.getModuleName=function(){return"clipboard"},o.prototype.destroy=function(){this.removeEventListener();var e=this.getClipboardEle();ee(e),this.parent=null},o}(),BO=function(){function o(e){this.editorElem=null,this.editCellData={},this.isEdit=!1,this.isCellEdit=!0,this.isNewValueEdit=!0,this.isAltEnter=!1,this.curEndPos=null,this.curStartPos=null,this.uniqueColl="",this.uniqueActCell="",this.isSpill=!1,this.keyCodes={BACKSPACE:8,SPACE:32,TAB:9,DELETE:46,ESC:27,ENTER:13,FIRSTALPHABET:65,LASTALPHABET:90,FIRSTNUMBER:48,LASTNUMBER:59,FIRSTNUMPAD:96,LASTNUMPAD:111,SYMBOLSETONESTART:186,SYMBOLSETONEEND:192,SYMBOLSETTWOSTART:219,SYMBOLSETTWOEND:222,FIREFOXEQUALPLUS:61,FIREFOXMINUS:173,F2:113},this.formulaErrorStrings=["mismatched parentheses","requires 3 arguments","improper formula","empty expression","mismatched string quotes","wrong number of arguments","invalid arguments"],this.parent=e,this.addEventListener()}return o.prototype.destroy=function(){this.isEdit&&this.cancelEdit(!0,!1),this.removeEventListener(),this.editorElem=null,this.formulaErrorStrings&&(this.formulaErrorStrings=[]),this.editCellData&&(this.editCellData={}),this.keyCodes&&(this.keyCodes={}),this.parent=null},o.prototype.addEventListener=function(){B.isDevice&&B.info.name==="safari"&&(B.isIos||B.isIos7)?E.add(this.parent.element,"touchend",this.tapHandler,this):E.add(this.parent.element,"dblclick",this.dblClickHandler,this),this.parent.on(ml,this.mouseDownHandler,this),this.parent.on(ds,this.keyUpHandler,this),this.parent.on($a,this.keyDownHandler,this),this.parent.on(fi,this.performEditOperation,this),this.parent.on(ob,this.initiateCurPosition,this),this.parent.on(lb,this.updateFormulaBarValue,this),this.parent.on(gl,this.addressHandler,this),this.parent.on(MI,this.initiateRefSelection,this),this.parent.on(Gc,this.refSelectionRender,this),this.parent.on(gu,this.checkUniqueRange,this),this.parent.on(gy,this.reApplyFormula,this),this.parent.on(Iu,this.sheetChangeHandler,this),this.parent.on(nr,this.readOnlyAlertHandler,this),this.parent.on(rb,this.finiteAlertHandler,this)},o.prototype.removeEventListener=function(){B.isDevice&&B.info.name==="safari"&&(B.isIos||B.isIos7)?E.remove(this.parent.element,"touchend",this.tapHandler):E.remove(this.parent.element,"dblclick",this.dblClickHandler),this.parent.isDestroyed||(this.parent.off(ml,this.mouseDownHandler),this.parent.off(ds,this.keyUpHandler),this.parent.off($a,this.keyDownHandler),this.parent.off(fi,this.performEditOperation),this.parent.off(ob,this.initiateCurPosition),this.parent.off(lb,this.updateFormulaBarValue),this.parent.off(gl,this.addressHandler),this.parent.off(MI,this.initiateRefSelection),this.parent.off(Gc,this.refSelectionRender),this.parent.off(gu,this.checkUniqueRange),this.parent.off(gy,this.reApplyFormula),this.parent.off(Iu,this.sheetChangeHandler),this.parent.off(nr,this.readOnlyAlertHandler),this.parent.off(rb,this.finiteAlertHandler))},o.prototype.getModuleName=function(){return"edit"},o.prototype.performEditOperation=function(e){var t=e.action;switch(t){case"renderEditor":if(this.renderEditor(),e.initLoad&&B.isDevice&&B.info.name==="safari"&&(B.isIos||B.isIos7)){var i=this.parent.createElement("div",{className:"e-ss-focus-edit",attrs:{contentEditable:"true",inputmode:"none",tabindex:"-1"}}),r=this.parent.element.querySelector(".e-sheet-panel");r&&(r.style.position="relative",r.appendChild(i)),this.parent.element.onfocus=function(){Fe(i)}}break;case"refreshEditor":this.refreshEditor(e.value,e.refreshFormulaBar,e.refreshEditorElem,e.isAppend,e.trigEvent),e.refreshCurPos&&this.setCursorPosition();break;case"startEdit":if(!this.isEdit)this.isNewValueEdit=e.isNewValueEdit,this.startEdit(e.address,e.value,e.refreshCurPos);else{var n=!1,s={isEdit:n};this.parent.notify(md,s),s.isEdit&&(this.isNewValueEdit=e.isNewValueEdit,this.startEdit(e.address,e.value,e.refreshCurPos))}break;case"endEdit":this.isEdit&&this.endEdit(e.refreshFormulaBar,null,e.isPublic);break;case"cancelEdit":this.isEdit&&this.cancelEdit(e.refreshFormulaBar);break;case"getCurrentEditValue":e.editedValue=this.editCellData.value,e.endFormulaRef!==void 0&&(e.endFormulaRef=this.endFormulaRef);break;case"refreshDependentCellValue":this.refreshDependentCellValue(e.rowIdx,e.colIdx,e.sheetIdx);break;case"getElement":e.element=this.getEditElement(this.parent.getActiveSheet());break;case"focusEditorElem":this.editorElem.focus();break;case"getCurrentEditSheetIdx":e.sheetIndex=this.editCellData.sheetIndex;break}},o.prototype.keyUpHandler=function(e){if(this.isEdit){var t=this.getEditElement(this.parent.getActiveSheet());e.altKey&&e.keyCode===13?(t.focus(),this.altEnter(),this.isAltEnter=!0):this.isCellEdit&&this.editCellData.value!==t.textContent&&e.keyCode!==16&&(!e.shiftKey||e.shiftKey&&!uu(e.keyCode))&&this.refreshEditor(t.textContent,this.isCellEdit);var i=ut(this.editCellData.value,!0);if(i&&(!e||e.keyCode!==16&&e.keyCode!==17&&(!e.shiftKey||!uu(e.keyCode)))&&(this.updateFormulaReference(t),this.endFormulaRef)){var r=this.getCurPosition(),n=["+","-","*","/",this.parent.listSeparator,"(","=","&",":"];r.end&&n.indexOf(this.editCellData.value[r.end-1])>-1&&(this.endFormulaRef=!1)}}},o.prototype.updateFormulaReference=function(e){var t=this.parent.element.querySelector(".e-formularef-indicator");t&&t.parentElement.removeChild(t),this.editCellData.value!==e.textContent&&this.refreshEditor(e.textContent,!0);var i=this.editCellData.sheetIndex,r=this.editCellData.value;this.parent.notify(dl,{range:r,formulaSheetIdx:i})},o.prototype.keyDownHandler=function(e){var t=e.target,i=e.keyCode,r=this.parent.getActiveSheet(),n=Se(r.activeCell),s=G(n[0],n[1],r,!1,!0),a=this.parent.enableKeyboardShortcut;if(!a&&i===this.keyCodes.SPACE&&!e.ctrlKey&&!e.altKey&&!e.metaKey){e.preventDefault();return}if(!j(t,".e-spreadsheet .e-dialog")){if(!r.isProtected||t.classList.contains("e-sheet-rename")||!un(s,Rt(r,n[1]))||(t.classList.contains("e-formula-bar")||t.classList.contains("e-combobox"))&&!t.disabled){if(this.isEdit){var l=this.getEditElement(r),h=ut(this.editCellData.value,!0);if((this.isCellEdit||h&&this.editCellData.value!==l.textContent&&e.keyCode!==16&&e.keyCode!==17)&&(n[1]<this.parent.frozenColCount(r)&&(!r.frozenRows||n[0]>=this.parent.frozenRowCount(r))&&l&&l.style.height!=="auto"&&Vr(l.textContent,s.style,this.parent.cellStyle)>parseInt(l.style.maxWidth,10)&&(l.style.height="auto"),Vr(l.textContent,s.style,this.parent.cellStyle)>parseInt(l.style.maxWidth,10)-5&&(l.style.height="auto"),n[0]<this.parent.frozenRowCount(r)&&l&&!l.style.overflow&&Vr(l.textContent,s.style,this.parent.cellStyle)>parseInt(l.style.maxWidth,10)&&(l.style.overflow="auto"),(!e.shiftKey||e.shiftKey&&!uu(e.keyCode))&&this.refreshEditor(l.textContent,this.isCellEdit,!1,!1,!1)),!e.altKey)switch(i){case this.keyCodes.ENTER:if(B.isWindows&&e.preventDefault(),!h)this.endEdit(!1,e);else{var u=this.parent.element.querySelector(".e-formularef-indicator");u&&u.parentElement.removeChild(u),ke(this.parent,this.editCellData.sheetIndex).id===r.id?this.endEdit(!1,e):(this.parent.goTo(this.editCellData.fullAddr),this.endEdit(!1,e))}break;case this.keyCodes.TAB:this.hasFormulaSuggSelected()||this.endEdit(!1,e);break;case this.keyCodes.ESC:a&&this.cancelEdit(!0,!0,e);break}}else if(t.classList.contains("e-spreadsheet")||j(t,".e-sheet-panel")){i===13&&t.contentEditable==="true"&&e.preventDefault();var c=String.fromCharCode(i),d=i>=this.keyCodes.FIRSTALPHABET&&i<=this.keyCodes.LASTALPHABET||c.toLowerCase()!==c.toUpperCase()&&!(i>=112&&i<=123),p=i>=this.keyCodes.FIRSTNUMBER&&i<=this.keyCodes.LASTNUMBER,f=i>=this.keyCodes.FIRSTNUMPAD&&i<=this.keyCodes.LASTNUMPAD,v=i>=this.keyCodes.SYMBOLSETONESTART&&i<=this.keyCodes.SYMBOLSETONEEND;v||(v=i>=this.keyCodes.SYMBOLSETTWOSTART&&i<=this.keyCodes.SYMBOLSETTWOEND);var m=i===this.keyCodes.FIREFOXEQUALPLUS||i===this.keyCodes.FIREFOXMINUS,y=!e.shiftKey&&!e.ctrlKey&&!e.metaKey&&i===this.keyCodes.F2&&a,S=i===this.keyCodes.BACKSPACE&&a,b=/(Macintosh|MacIntel|MacPPC|Mac68K|Mac|Mac OS|iPod|iPad)/i.test(navigator.userAgent)&&S,w=this.parent.element.querySelector(".e-readonly-alert-dlg"),I=this.parent.element.getElementsByClassName("e-ss-overlay-active");if((!e.ctrlKey&&!e.metaKey&&!e.altKey&&(!e.shiftKey&&i===this.keyCodes.SPACE||d||p||f||v||B.info.name==="mozilla"&&m)||y||S)&&(y&&(this.isNewValueEdit=!1),w||(qi(this.parent)&&I.length===0?this.parent.notify(nr,null):I.length?S&&!b&&this.editingHandler("delete"):(this.startEdit(null,null,!0,!0),Fe(this.getEditElement(r))))),(i===this.keyCodes.DELETE||b)&&a){var x=r.isProtected&&ko(this.parent);w||(x?this.parent.notify(ba,null):qi(this.parent)&&I.length===0?this.parent.notify(nr,null):(this.editingHandler("delete"),this.parent.notify(Qa,null)))}}}else if((i>=this.keyCodes.FIRSTALPHABET&&i<=this.keyCodes.LASTALPHABET||i>=this.keyCodes.FIRSTNUMBER&&i<=this.keyCodes.LASTNUMBER||i===this.keyCodes.DELETE||i===this.keyCodes.BACKSPACE||i===this.keyCodes.SPACE||i>=this.keyCodes.FIRSTNUMPAD&&i<=this.keyCodes.LASTNUMPAD||i>=this.keyCodes.SYMBOLSETONESTART&&i<=this.keyCodes.SYMBOLSETONEEND||i>=219&&i<=222||!e.shiftKey&&!e.ctrlKey&&!e.metaKey&&i===this.keyCodes.F2)&&i!==67&&i!==89&&i!==90){if(r.protectSettings.insertLink&&i===75||e.altKey&&(i===65||i===70||i===72||i===77||i===78||i===87))return;!e.ctrlKey&&e.keyCode!==70&&!this.parent.element.querySelector(".e-editAlert-dlg")&&!t.parentElement.classList.contains("e-unprotectpwd-content")&&!t.parentElement.classList.contains("e-password-content")&&!t.parentElement.classList.contains("e-sheet-password-content")&&!t.parentElement.classList.contains("e-unprotectsheetpwd-content")&&!t.parentElement.classList.contains("e-reenterpwd-content")&&this.parent.notify(ba,null)}}},o.prototype.renderEditor=function(){if(!this.editorElem||!X("#"+this.parent.element.id+"_edit",this.parent.element)){var e=this.parent.createElement("div",{id:this.parent.element.id+"_edit",className:"e-spreadsheet-edit",attrs:{contentEditable:"true",role:"textbox",spellcheck:"false","aria-multiline":"true"}});this.parent.element.getElementsByClassName("e-spreadsheet-edit")[0]&&this.parent.element.getElementsByClassName("e-spreadsheet-edit")[0].remove();var t=this.parent.element.querySelector(".e-sheet-content");if(!t)return;t.appendChild(e),this.editorElem=e}this.parent.notify(vl,{action:"renderAutoComplete"})},o.prototype.refreshEditor=function(e,t,i,r,n,s){n===void 0&&(n=!0),r?e=this.editCellData.value=this.editCellData.value+e:this.editCellData.value=s||e;var a=this.getEditElement(this.parent.getActiveSheet());i&&a&&(a.textContent=e),t&&this.parent.notify(Ua,{action:"refreshFormulabar",value:e}),this.parent.isEdit&&a&&n&&this.editCellData.value===a.textContent&&this.triggerEvent("cellEditing").cancel&&this.cancelEdit(!1,!1,null,!0)},o.prototype.startEdit=function(e,t,i,r){i===void 0&&(i=!0),this.parent.showSheetTabs&&this.parent.element.querySelector(".e-add-sheet-tab").setAttribute("disabled","true");var n=this.parent.getActiveSheet(),s=Se(n.activeCell),a=G(s[0],s[1],n,!1,!0);if(this.parent.calculationMode==="Manual"&&ut(a.formula)&&(this.editCellData.prevFormulaValue=a.value),NO(this.parent,s[0],s[1],this.parent.activeSheetIndex)){var l=this.parent.getCell(s[0],s[1]),h=!1,u=l.innerHTML;if(l&&u.indexOf("<")>-1&&u.indexOf(">")>-1&&u.indexOf("input")>-1&&(h=!0),h)return}var c=this.updateEditCellDetail(e,t);this.initiateEditor(i,c),this.positionEditor(),this.parent.isEdit=this.isEdit=!0,this.parent.notify(yd,null),this.parent.notify(da,[{enable:!1}]),a.formula&&!r&&this.parent.notify(dl,{range:a.formula,formulaSheetIdx:this.editCellData.sheetIndex})},o.prototype.setCursorPosition=function(){var e=this.getEditElement(this.parent.getActiveSheet()),t=e.textContent.length;if(t){var i=document.getSelection(),r=document.createRange();r.setStart(e.firstChild,t),r.collapse(!0),i.removeAllRanges(),i.addRange(r)}e.focus()},o.prototype.hasFormulaSuggSelected=function(){var e=document.getElementById(this.parent.element.id+"_ac_popup");return e&&e.style.visibility==="visible"&&e.querySelectorAll(".e-item-focus").length>0},o.prototype.editingHandler=function(e){var t=document.getElementsByClassName("e-ss-overlay-active"),i=t.length,r;switch(e){case"delete":if(i>0)t[0].classList.contains("e-datavisualization-chart")?this.parent.notify(Eu,{id:t[0].id,sheetIdx:this.parent.activeSheetIndex+1}):this.parent.notify(ga,{id:t[0].id,sheetIdx:this.parent.activeSheetIndex+1});else{var n=this.parent.getActiveSheet(),s=n.selectedRange,a=Qi(s);a=a[0]>a[2]||a[1]>a[3]?tt(a):a,s=Be(a);var l={address:n.name+"!"+s,cancel:!1};if(this.parent.notify(ai,{action:"cellDelete",eventArgs:l}),l.cancel)return;s=cu(l.address),a=J(s),FO(this.parent,a,this.parent.activeSheetIndex),this.parent.notify(pa,{}),a[0]===0&&a[1]===0&&a[2]>=n.usedRange.rowIndex&&a[3]>=n.usedRange.colIndex&&this.parent.setUsedRange(0,0,n,!1,!0);var h={cellIdx:a,isUnique:!1};if(this.checkUniqueRange(h),h.isUnique){var u=J(this.uniqueColl),c=G(u[0],u[1],this.parent.getActiveSheet());c&&c.value&&(r=c.value.toString().indexOf("#SPILL!")>-1)}if(h.isUnique&&this.uniqueColl.split(":")[0]===s.split(":")[0]){for(var d=J(this.uniqueColl),p=d[0];p<=d[2];p++)for(var f=d[1];f<=d[3];f++)this.parent.updateCellInfo({value:"",formula:""},Be([p,f]),!0);this.parent.notify(ad,null),this.uniqueColl=""}else if(h.isUnique){var v=J(this.uniqueColl);if(G(v[0],v[1],n).value==="#SPILL!"){for(var m=!1,f=v[0];f<=v[2];f++)for(var y=v[1];y<=v[3];y++){var c=G(f,y,n);f===v[0]&&y===v[1]?m=!1:c&&!g(c.value)&&c.value!==""&&(m=!0)}m||this.reApplyFormula()}}h.isUnique?this.parent.notify(mt,{action:"cellDelete",eventArgs:{address:n.name+"!"+s,isSpill:r}}):this.parent.notify(mt,{action:"cellDelete",eventArgs:{address:n.name+"!"+s}})}break}},o.prototype.getCurPosition=function(){var e={},t=window.getSelection();if(t&&t.focusNode&&t.focusNode.classList&&t.focusNode.classList.contains("e-formula-bar-panel")){var i=t.focusNode.getElementsByClassName("e-formula-bar e-css")[0];i.value===this.editCellData.value&&(e.start=i.selectionStart,e.end=i.selectionEnd)}else if(this.getEditElement(this.parent.getActiveSheet()).textContent===this.editCellData.value&&(e.start=t.anchorOffset,e.end=t.focusOffset,e.start>e.end)){var r=e.start;e.start=e.end,e.end=r}return e},o.prototype.mouseDownHandler=function(e){if(!j(e.target,".e-findtool-dlg")&&!j(e.target,".e-validation-error-dlg")&&this.isEdit){var t=this.getCurPosition(),i=void 0,r=void 0;t.start&&(this.curStartPos=i=t.start),t.end&&(this.curEndPos=r=t.end);var n=e.target,s=this.parent.getActiveSheet(),a=this.parent.element.querySelector(".e-formularef-indicator");this.isCellEdit=n.classList.contains("e-spreadsheet-edit");var l=ut(this.editCellData.value,!0),h=this.getEditElement(s),u=["+","-","*","/",this.parent.listSeparator,"(","=","&",":"];if(n.classList.contains("e-cell")||n.classList.contains("e-header-cell")||n.classList.contains("e-selectall")||j(n,".e-toolbar-item.e-active")||j(n,".e-table"))if(!l||this.endFormulaRef)this.endFormulaRef=!1,this.endEdit(!1,e);else{var c=Se(s.activeCell),d=G(c[0],c[1],s),p=document.activeElement.classList.contains("e-formula-bar")?document.activeElement.value:h.textContent;if(this.editCellData.value===p)if(i===r){if(this.editCellData.sheetIndex!==yt(this.parent,s.name)){if(u.indexOf(p.substring(i-1,i))===-1){a&&a.parentElement.removeChild(a),this.parent.goTo(this.editCellData.fullAddr),this.endEdit(!1,e);return}}else if(u.indexOf(h.textContent.substring(i-1,i))===-1){a&&a.parentElement.removeChild(a),this.endEdit(!1,e);return}}else u.indexOf(p.substring(i-1,i))!==-1&&Mr(p.substring(i,r))&&p.indexOf(":")!==r&&(this.editCellData.value=p.substring(0,i)+p.substring(r,p.length));if(!d)return;if(l=d.formula&&(ut(d.formula)||this.editCellData.value&&this.editCellData.value.toString().indexOf("=")===0),l&&this.parent.isEdit){var f=r;this.editCellData.value.length===f?(this.editCellData.value.substring(this.editCellData.value.length-1)===")"||Me(this.editCellData.value.substring(this.editCellData.value.length-1)))&&(a&&a.parentElement.removeChild(a),this.endEdit(!1,e)):this.editCellData.value===p&&u.indexOf(p.substring(f-1,f))===-1&&(a&&a.parentElement.removeChild(a),this.endEdit(!1,e))}}else if(l&&this.editCellData.value===h.textContent&&h.textContent.indexOf("(")!==h.textContent.length-1&&!this.isCellEdit&&!n.classList.contains("e-formula-bar")&&u.indexOf(this.editCellData.value.substring(i-1,i))===-1&&ke(this.parent,this.editCellData.sheetIndex).id===s.id){var f=window.getSelection().focusOffset;if(u.indexOf(h.textContent.substring(f-1,f))===-1){a&&a.parentElement.removeChild(a),this.parent.goTo(this.editCellData.fullAddr),this.isEdit&&this.endEdit(!1,e);return}}}},o.prototype.tapHandler=function(e){var t=this;if(!this.tapedTwice){this.tapedTwice=!0,setTimeout(function(){if(t.tapedTwice=!1,!t.parent.isEdit&&e.target.classList.contains("e-cell")){var i=t.parent.element.querySelector(".e-ss-focus-edit");i&&Fe(i)}},300);return}e.preventDefault(),this.dblClickHandler(e)},o.prototype.dblClickHandler=function(e){var t=e.target;if(!j(t,".e-datavisualization-chart")&&!t.classList.contains("e-ss-overlay")&&(t.classList.contains("e-active-cell")||t.classList.contains("e-cell")||t.classList.contains("e-wrap-content")||j(t,".e-sheet-content")||t.classList.contains("e-table"))){var i=this.parent.getActiveSheet(),r=Se(i.activeCell),n=G(r[0],r[1],i,!1,!0);if(Lo(n,Rt(i,r[1]),Ar(i,r[0])))this.parent.notify(nr,null);else if(!i.isProtected||!un(n,Rt(i,r[1])))if(this.isEdit){if(!t.classList.contains("e-spreadsheet-edit"))if(ut(this.editCellData.value)){var s=this.editCellData.fullAddr.substring(0,this.editCellData.fullAddr.lastIndexOf("!"));this.parent.getActiveSheet().name===s&&this.endEdit()}else this.endEdit()}else this.isNewValueEdit=!1,this.startEdit(),Fe(this.getEditElement(i));else this.parent.notify(ba,null)}},o.prototype.updateEditCellDetail=function(e,t){var i,r,n;if(g(this.editCellData.sheetIndex)?e&&e.lastIndexOf("!")>-1?i=yt(this.parent,Ws(e)):i=this.parent.activeSheetIndex:i=this.editCellData.sheetIndex,this.editCellData.addr?ut(this.editCellData.value,!0)&&(r=ke(this.parent,i),this.isNewValueEdit=!1):(r=ke(this.parent,i),e?e=cu(e):e=r.activeCell),e){var s=J(e),a=s[0],l=s[1],h=G(a,l,r,!1,!0);if(h.colSpan>1||h.rowSpan>1){var u={sheet:r,cell:h,rowIdx:a,colIdx:l};xb(u),a=u.rowIdx,l=u.colIdx,n=u.isMergedHiddenCell}var c=this.parent.getCell(a,l),d=Ib(r,s,this.parent.frozenRowCount(r),this.parent.frozenColCount(r),this.parent.viewport.beforeFreezeHeight,this.parent.viewport.beforeFreezeWidth,this.parent.sheetModule.colGroupWidth);this.editCellData={addr:e,fullAddr:Vn(this.parent,i)+"!"+e,rowIndex:a,colIndex:l,sheetIndex:i,element:c,value:t||"",position:d,prevFormulaValue:this.editCellData.prevFormulaValue}}return n},o.prototype.initiateEditor=function(e,t){var i=this;fa(this.parent,this.editCellData.fullAddr,!1,t).then(function(r){i.parent&&r.forEach(function(n){var s,a=function(){var u={cell:n,value:n?n.value:"",showFormattedText:i.editCellData.showFormattedText};i.parent.notify(py,u),s=n?n.formula||u.value:"",i.editCellData.oldValue=s};a();var l=i.triggerEvent("cellEdit",null,s);if(l.cancel){i.cancelEdit(!0,!1,null,!0);return}l.showFormattedText&&(i.editCellData.showFormattedText=!0,a()),i.editCellData.value?s=i.editCellData.value:i.editCellData.value=s;var h;i.isNewValueEdit?(h=s,s=""):i.isNewValueEdit=!0,Ee(s)&&(s=""),i.refreshEditor(s,!1,!0,!1,!1,h),e&&i.setCursorPosition()})})},o.prototype.positionEditor=function(e){var t=this.editCellData.element,i=!1,r,n={isEdit:i};if(this.parent.notify(md,n),n.isEdit&&g(t)&&(r=this.parent.getCell(this.editCellData.rowIndex,this.editCellData.colIndex),t=r,this.editCellData.element=r),t){t.classList.add("e-ss-edited");var s=this.parent.getActiveSheet(),a=G(this.editCellData.rowIndex,this.editCellData.colIndex,s,!1,!0),l=this.editCellData.position.left+1,h=this.editCellData.position.top+1,u={range:[this.editCellData.rowIndex,this.editCellData.colIndex,this.editCellData.rowIndex,this.editCellData.colIndex]};this.parent.notify(ur,u);var c=Ri(s,u.range[0],u.range[2])-3,d=Ci(s,u.range[1],u.range[3])-3,p=this.parent.getMainContent(),f=p.parentElement,v=void 0,m=this.parent.frozenColCount(s),y=void 0,S=void 0,b=this.parent.frozenRowCount(s),w=void 0;if(this.editCellData.colIndex<m)v=Math.abs(this.parent.getRowHeaderContent().getBoundingClientRect()[this.parent.enableRtl?"left":"right"]-t.getBoundingClientRect()[this.parent.enableRtl?"right":"left"])-1,this.editCellData.rowIndex<b?this.parent.getRowHeaderContent().style.zIndex==="2"&&(y="3"):Vr(a.value,a.style,this.parent.cellStyle)>v&&(w=!0);else{v=f.offsetWidth-(l-p.scrollLeft)-28-this.parent.sheetModule.getRowHeaderWidth(s);var I=t.getBoundingClientRect(),x=f.getBoundingClientRect(),M=this.parent.enableRtl?I.left:I.right,D=this.parent.enableRtl?x.left:x.right,A=this.parent.getScrollElement(),L=this.parent.sheetModule.getScrollSize();this.parent.enableRtl?D+L>M&&(A.scrollLeft-=I.width):D-L<M&&(A.scrollLeft+=I.width)}this.editCellData.rowIndex<b&&(S=!0);var T=!S&&(a&&a.wrap||t&&e||w)?"auto;":c+"px;",k="display:block;top:"+h+"px;"+(this.parent.enableRtl?"right:":"left:")+l+"px;min-width:"+d+"px;max-width:"+(a&&a.wrap?d:v)+"px;height:"+T+(a&&a.wrap?"width:"+d+"px;":"")+"min-height:"+c+"px;"+(y?"z-index: "+y+";":"")+(S&&(a&&!a.wrap||t&&e)&&(Vr(a.value,a.style,this.parent.cellStyle)>v||t&&e)?"overflow: auto;":""),F=t.style.cssText.split(";");F.forEach(function(P){P.includes("border")||(k+=P+";")});var R=this.getEditElement(s,!0);R.style.cssText=k,Vr(R.textContent,a.style,this.parent.cellStyle)>v&&(R.style.height="auto");var N=this.parent.element.querySelector(".e-active-cell");N&&(N.style.height=c+4+"px"),t.classList.contains("e-right-align")?R.classList.add("e-right-align"):t.classList.contains("e-center-align")&&R.classList.add("e-center-align")}},o.prototype.updateEditedValue=function(e,t,i,r){var n=this,s=this.editCellData.oldValue;t&&(this.editCellData.value=t);var a=this.editCellData.value;this.parent.notify(hh,{args:{action:"beforeCellSave",eventArgs:{address:this.editCellData.addr}}});var l=!0;if(this.parent.allowDataValidation){var h=this.parent.getActiveSheet(),u=J(h.activeCell),c=G(u[0],u[1],h,!1,!0),d=Rt(h,u[1]);if(c.validation||Ds(d,u[0],u[1])){var p=this.editCellData.value||this.getEditElement(h).innerText,f=this.parent.activeSheetIndex,v=typeof this.editCellData.addr=="string"?J(this.editCellData.addr):this.editCellData.addr,m={value:p,range:v,sheetIdx:f,isEdit:!0,td:null,isValid:!0},y=Object.assign({},c,{value:p});oi(u[0],u[1],h,y),this.parent.notify(yy,m),oi(u[0],u[1],h,c),l=m.isValid,l?ut(p)||!c.format?this.editCellData.value||(this.editCellData.value=p):(p!==m.value||!this.editCellData.value&&m.value)&&(this.editCellData.value=m.value):this.isCellEdit=!0}}if(!r&&ut(this.editCellData.value)){var S={formula:this.editCellData.value};if(this.parent.notify(kx,S),S.isInvalid){var b;this.isCellEdit=!0,l=!1;var w=this.parent.serviceLocator.getService(fe),I=this.parent.serviceLocator.getService(jt);I.show({width:400,isModal:!0,showCloseIcon:!0,target:this.parent.element,cssClass:"e-validation-error-dlg",content:w.getConstant("CellReferenceTypoError")+"<br>"+S.formula,beforeOpen:function(){return n.editCellData.element.focus()},buttons:[{buttonModel:{content:w.getConstant("Yes"),isPrimary:!0},click:function(){b=!0,I.hide()}},{buttonModel:{content:w.getConstant("No")},click:function(){return I.hide()}}],close:function(){if(b)t=n.editCellData.value=S.formula,n.updateCell(s,e,t,a,i),n.parent.notify(Ua,{action:"refreshFormulabar",value:S.formula});else{var x=n.getEditElement(n.parent.getActiveSheet());x.innerText&&window.getSelection().selectAllChildren(x)}}},!1)}}l?this.updateCell(s,e,t,a,i):i&&i.preventDefault()},o.prototype.updateCell=function(e,t,i,r,n){var s=e?e.toString().toUpperCase():"",a=this.parent.getActiveSheet();(e||e===0)&&(e=e.toString());var l=this.editCellData.value;l&&(l=l.toString());var h=e!==l||ut(s);if(h){this.isAltEnter&&l&&l.includes(`
`)&&(vd(a.activeCell,!0,this.parent,!0),this.refreshEditor(l,this.isCellEdit,!1,!1,!1));var u=J(a.activeCell);e&&e.indexOf("=UNIQUE(")>-1&&this.editCellData.value===""&&this.parent.notify(ad,null);var c={cellIdx:u,isUnique:!1};this.checkUniqueRange(c);var d=c.isUnique;if(d&&e!==""&&this.editCellData.value===""){var p=J(this.uniqueColl);if(G(p[0],p[1],a).value.toString().indexOf("#SPILL!")===-1)return}e&&e.indexOf("UNIQUE")>-1&&this.editCellData.value&&this.editCellData.value.toString().indexOf("UNIQUE")>-1&&d&&this.updateUniqueRange("");var f={action:"updateCellValue",address:this.editCellData.addr,value:this.editCellData.value,skipCellFormat:this.editCellData.showFormattedText};this.parent.notify(fu,f);var v=G(u[0],u[1],a,!0),m=void 0;g(v)||(m=v.value.toString());var y=m==="#CIRCULARREF!",S=this.formulaErrorStrings.indexOf(m)>-1;if(S||y){var b=void 0;if(n){var w=n.target,I=["e-toolbar-item","e-tab-wrap","e-text-wrap","e-tab-text","e-caret"],x=["e-scroller","e-main-panel","e-autofill"];(!I.some(function(R){return w.classList.contains(R)})||!j(w,".e-ribbon"))&&!x.some(function(R){return w.classList.contains(R)})&&(b=this.showFormulaAlertDlg(m,y)),b||n.preventDefault()}if(b)v.value="0";else{delete v.value,delete v.formula,this.parent.notify(vu,{cellRef:a.activeCell,clearFormulaInfo:!0}),ut(s)?this.parent.updateCellInfo({formula:s},a.activeCell):e&&this.parent.updateCellInfo({value:e},a.activeCell);return}}var M=void 0;f.isFormulaDependent&&(M=lO(this.parent,this.parent.viewport));var D=G(u[0],u[1],a,!0),A=this.getRefreshNodeArgs(D,this.editCellData.element,this.editCellData.rowIndex,this.editCellData.colIndex);if(this.editCellData.value=A.value,this.parent.notify(lh,{cell:null,rIdx:this.editCellData.rowIndex,cIdx:this.editCellData.colIndex,viewportIndexes:M}),D&&D.formula&&(this.editCellData.formula=D.formula),t&&this.parent.refreshNode(this.editCellData.element,A),D&&D.hyperlink&&this.parent.serviceLocator.getService("cell").refreshRange(u),a.conditionalFormats&&a.conditionalFormats.length&&this.parent.notify(Wi,{indexes:[this.editCellData.rowIndex,this.editCellData.colIndex],isAction:!0,refreshAll:f.isFormulaDependent,isEdit:!0}),D&&D.wrap&&this.parent.notify(Xa,{range:u,wrap:!0,sheet:a}),d){var p=J(this.uniqueColl);if(G(p[0],p[1],a).value.toString().indexOf("#SPILL!")>-1&&(this.isSpill=!0),e!==""&&this.editCellData.value===""||this.editCellData.formula&&this.editCellData.formula.length>1&&e!==this.editCellData.formula){for(var L=!1,T=p[0];T<=p[2];T++)for(var k=p[1];k<=p[3];k++){var F=G(T,k,a);T===p[0]&&k===p[1]?L=!1:F&&!g(F.value)&&F.value!==""&&(L=!0)}L||this.reApplyFormula()}else this.updateUniqueRange(r)}}this.triggerEvent("cellSave",n,i),this.resetEditState(),this.focusElement(n)},o.prototype.checkUniqueRange=function(e){var t={range:[]};this.parent.notify(yx,t);var i=t.range;e.sheetName||(e.sheetName=this.parent.getActiveSheet().name);for(var r=0;r<i.length;r++)if(i[r].substring(0,i[r].lastIndexOf("!"))===e.sheetName){for(var n=J(i[r]),s=n[0];s<=n[2];s++)for(var a=n[1];a<=n[3];a++)if(e.cellIdx[0]===s&&e.cellIdx[1]===a){e.isUnique=!0,this.uniqueCell=!0;var l=this.uniqueColl!==""?J(this.uniqueColl):[0,0,0,0],h=J(i[r]);if(l[0]===h[0]&&l[1]===h[1]){var u=[l[0],h[1],l[0],h[1]];u[2]=l[2]>h[2]?l[2]:h[2],u[3]=l[3]>h[3]?l[3]:h[3],this.uniqueColl=Be(u),e.uniqueRange=Be(u)}else this.uniqueColl=i[r],e.uniqueRange=i[r]}}},o.prototype.updateUniqueRange=function(e){var t=J(this.uniqueColl),i=!1;G(t[0],t[1],this.parent.getActiveSheet()).value!=="#SPILL!"&&(i=!0);for(var r=t[0];r<=t[2];r++)for(var n=t[1];n<=t[3];n++)i&&(r===t[0]&&n===t[1]?this.parent.updateCellInfo({value:"#SPILL!"},Be([r,n]),!0):Be([r,n]).split(":")[0]===this.editCellData.addr?this.parent.updateCellInfo({value:e},Be([r,n]),!0):this.parent.updateCellInfo({value:""},Be([r,n]),!0))},o.prototype.reApplyFormula=function(){var e=J(this.uniqueColl),t=G(e[0],e[1],this.parent.getActiveSheet());this.parent.updateCellInfo({value:""},Be([e[0],e[1]]),!0);for(var i=this.parent.sheets,r=t.formula,n=0;n<i.length;n++)r.indexOf(i[n].name)>-1&&(r=r.replace(i[n].name,"!"+n));this.parent.notify(xt,{action:"computeExpression",formula:r}),this.uniqueCell=!1,this.uniqueActCell!==""&&(this.editCellData.value=this.uniqueActCell,this.uniqueActCell="")},o.prototype.refreshDependentCellValue=function(e,t,i){if(e&&t&&(e--,t--,(this.editCellData.rowIndex!==e||this.editCellData.colIndex!==t)&&this.parent.activeSheetIndex===i||this.uniqueCell&&this.parent.activeSheetIndex===i)){var r=ke(this.parent,i),n=void 0;if(!st(r,e)&&!Ot(r,t)&&(n=this.parent.getCell(e,t)),n){if(n.parentElement){var s=n.parentElement.getAttribute("aria-rowindex");if(s&&Number(s)-1!==e)return}var a=G(e,t,r),l=J(r.activeCell);l[0]===e&&l[1]===t&&(this.uniqueActCell=a.value);var h=this.getRefreshNodeArgs(a,n,e,t);this.parent.refreshNode(n,h)}}},o.prototype.getRefreshNodeArgs=function(e,t,i,r){e=e||{};var n={value:e.value,format:e.format,formattedText:e.formattedText&&e.formattedText!==""?e.formattedText:e.value,isRightAlign:!1,type:"General",cell:e,rowIndex:i,td:t,colIndex:r,refresh:!0,isEdit:!0};return this.parent.notify(en,n),n},o.prototype.endEdit=function(e,t,i){e===void 0&&(e=!1),e&&this.refreshEditor(this.editCellData.oldValue,!1,!0,!1,!1);var r=this.triggerEvent("beforeCellSave");if(r.cancel){this.parent.isEdit&&t&&t.preventDefault();return}if(!this.isAltEnter&&r.value&&r.value.toString().indexOf(`
`)>-1){var n=G(this.editCellData.rowIndex,this.editCellData.colIndex,this.parent.getActiveSheet());vd(this.parent.getActiveSheet().activeCell,n?n.wrap!==!1:!0,this.parent),this.refreshEditor(r.value,this.isCellEdit,!1,!1,!1)}this.updateEditedValue(!0,r.value,t,i)},o.prototype.cancelEdit=function(e,t,i,r){e===void 0&&(e=!0),t===void 0&&(t=!0),this.refreshEditor(this.editCellData.oldValue,e,!1,!1,!1),r||(t?this.triggerEvent("cellSave",i,void 0,!0):this.triggerEvent("cellEdited")),this.resetEditState(),this.focusElement()},o.prototype.focusElement=function(e){if(e&&e.keyCode===9&&document.activeElement.classList.contains("e-formula-bar")){var t=this.parent.element.querySelector(".e-formula-bar-panel "+(e.shiftKey?".e-insert-function":".e-combobox"));t&&Fe(t)}else Fe(this.parent.element);this.parent.notify(da,[{enable:!0}])},o.prototype.triggerEvent=function(e,t,i,r){var n=this.parent.getActiveSheet(),s=G(this.editCellData.rowIndex,this.editCellData.colIndex,n),a={element:this.editCellData.element,value:i||this.editCellData.value,oldValue:this.editCellData.oldValue,address:this.editCellData.fullAddr,displayText:this.parent.getDisplayText(s),previousFormulaValue:this.editCellData.prevFormulaValue};if(a.address){var l=J(a.address),h={cellIdx:l,isUnique:!1};this.checkUniqueRange(h),h.isUnique&&(a.isSpill=this.isSpill)}var u=(a.value?a.value.toString():a.value)!==(a.oldValue||a.oldValue===0?a.oldValue.toString():a.oldValue);if(u||!r&&ut(a.value)&&(!s||!s.format||Er(s.format)!=="Text")){if(e!=="cellSave"&&(a.cancel=!1),e==="beforeCellSave"){this.parent.notify(ai,{eventArgs:a,action:"cellSave",preventAction:!0}),s=ut(a.value)?{formula:a.value}:{value:a.value};var c=sr(this.parent,n,{cell:s,rowIdx:this.editCellData.rowIndex,colIdx:this.editCellData.colIndex,eventOnly:!0});if(c)return this.cancelEdit(!1,!1,null,!0),a.cancel=!0,a}this.parent.trigger(e,a),e==="cellSave"&&(this.parent.trigger("cellEdited",a),this.editCellData.formula?a.formula=this.editCellData.formula:u||(a.formula=a.value),s.format&&(a.format=s.format),a.originalEvent=t,this.parent.notify(mt,{eventArgs:a,action:"cellSave"}))}else e!=="beforeCellSave"&&(e==="cellSave"?this.parent.trigger("cellEdited",a):this.parent.trigger(e,a));return a},o.prototype.altEnter=function(){this.positionEditor(!0);var e=window.getSelection(),t=e.anchorNode,i,r=document.createRange();i=t.nodeType===3?e.anchorOffset:t.textContent.length,i===0&&t.textContent.length>0&&(i=t.textContent.length);var n=t.textContent,s=n.slice(0,i),a=n.slice(i)||" ";t.textContent=s+`
`+a,r=document.createRange(),t.nodeType===3?(r.setStart(t,i+1),r.setEnd(t,i+1)):t.nodeType===1&&(r.setStart(t.firstChild,i+1),r.setEnd(t.firstChild,i+1)),e.removeAllRanges(),e.addRange(r)},o.prototype.resetEditState=function(e){if(e===void 0&&(e=!0),e){var t=this.getEditElement(this.parent.getActiveSheet());(ut(t.textContent)||t.textContent==="")&&this.parent.notify(II,null),this.editCellData.element&&(this.editCellData.element.classList.remove("e-ss-edited"),this.editorElem.textContent="",t===this.editorElem?(this.editorElem.removeAttribute("style"),this.editorElem.classList.remove("e-right-align")):ee(t))}if(this.editCellData={},this.parent.isEdit=this.isEdit=!1,this.isCellEdit=!0,this.isAltEnter=!1,this.parent.notify(vl,{action:"endEdit"}),this.parent.showSheetTabs&&!this.parent.isProtected){var i=this.parent.element.querySelector(".e-add-sheet-tab");i&&i.removeAttribute("disabled")}},o.prototype.refSelectionRender=function(){var e=this.getEditElement(this.parent.getActiveSheet());e&&ut(e.textContent)&&this.parent.notify(dl,{range:e.textContent,formulaSheetIdx:this.editCellData.sheetIndex})},o.prototype.initiateRefSelection=function(){var e=this.editCellData.fullAddr.substring(0,this.editCellData.fullAddr.lastIndexOf("!")),t=this.editCellData.value;this.parent.getActiveSheet().name===e&&ut(this.editCellData.value,!0)?(this.startEdit(this.editCellData.addr,t,!1),this.parent.notify(dl,{range:this.editCellData.value,formulaSheetIdx:this.editCellData.sheetIndex}),this.getEditElement(this.parent.getActiveSheet()).textContent=t,this.initiateCurPosition()):this.initiateCurPosition()},o.prototype.addressHandler=function(e){var t=this.parent.serviceLocator.getService(jt).dialogInstance;if(t&&t.element&&t.element.classList.contains("e-validation-error-dlg")){e.isAlertDlgOpen=!0;return}if(!this.curStartPos){var i=this.getCurPosition();i.start&&(this.curStartPos=i.start),i.end&&(this.curEndPos=i.end)}var r=e.range,n=this.editCellData.sheetIndex,s=this.getEditElement(this.parent.getActiveSheet());this.parent.activeSheetIndex!==n&&(r="'"+this.parent.getActiveSheet().name+"'!"+r,e.isNameBoxSelect&&(n=this.parent.activeSheetIndex));var a=this.editCellData.value;if(e.isSelect)this.parent.notify(dl,{range:a+r,formulaSheetIdx:n});else if(this.parent.activeSheetIndex===n){var l=document.activeElement.classList.contains("e-formula-bar")?document.activeElement.value:s.textContent;e.isNameBoxSelect&&(this.parent.notify(dl,{range:a+r,formulaSheetIdx:n}),this.curStartPos=a.length);var h=void 0,u=void 0;e.isMouseDown&&l!==a?(h=l.substring(0,this.curEndPos)+this.parent.listSeparator,u=l.substring(this.curEndPos),this.refreshEditor(h+u,!1,!0),this.parent.notify(dl,{range:s.textContent,formulaSheetIdx:n}),this.curEndPos+=this.parent.listSeparator.length,this.curStartPos=this.curEndPos,h+=r):(h=a.substring(0,this.curStartPos)+r,u=a.substring(this.curStartPos),e.isNameBoxSelect&&this.refreshEditor(h+u,!0,!0)),s.textContent=h+u,this.curEndPos=h.length}},o.prototype.updateFormulaBarValue=function(e){var t=this.editCellData.value,i=this.parent.getActiveSheet().selectedRange.split(" "),r=i[i.length-1];r=mf(Qi(r))?r.split(":")[0]:r;var n=this.parent.element.querySelector(".e-formula-bar");if(t&&ut(t,!0)){var s=this.editCellData.fullAddr.substring(0,this.editCellData.fullAddr.lastIndexOf("!")),a=this.parent.getActiveSheet().name!==s;a&&(r="'"+this.parent.getActiveSheet().name+"'!"+r);var l=void 0,h=void 0;a&&e.isMouseDown&&i.length>1&&e.formulaBarVal&&e.formulaBarVal!==t?(l=e.formulaBarVal.substring(0,this.curEndPos)+this.parent.listSeparator,h=e.formulaBarVal.substring(this.curEndPos),this.refreshEditor(l+h,!0),this.curEndPos+=this.parent.listSeparator.length,this.curStartPos=this.curEndPos,l+=r):(l=t.substring(0,this.curStartPos)+r,h=t.substring(this.curStartPos)),n.value=l+h,this.curEndPos=l.length}},o.prototype.setFormulaBarCurPosition=function(e,t,i){e.setSelectionRange&&(e.focus(),e.selectionStart=t,e.selectionEnd=t,e.setSelectionRange(t,i))},o.prototype.initiateCurPosition=function(e){e===void 0&&(e={isCellEdit:!1});var t=this.getEditElement(this.parent.getActiveSheet(),!0);if(e.isCellEdit){var i=this.getCurPosition();if(!this.endFormulaRef&&i.start===i.end){this.updateFormulaReference(t);var r=["+","-","*","/",this.parent.listSeparator,"(","=","&",":"];i.end&&r.indexOf(this.editCellData.value[i.end-1])===-1&&(this.endFormulaRef=!0)}return}var n=t.innerText,s=window.getSelection();if(s&&s.focusNode&&s.focusNode.classList&&s.focusNode.classList.contains("e-formula-bar-panel")){var a=this.parent.element.querySelector(".e-formula-bar");this.setFormulaBarCurPosition(a,this.curEndPos,this.curEndPos);return}if(n){var l=document.createRange();n.indexOf(")")===n.length-1?(l.setStart(t.childNodes[0],this.curEndPos),l.setEnd(t.childNodes[0],this.curEndPos)):(l.setStart(t.childNodes[0],this.curEndPos),l.setEnd(t.childNodes[0],this.curEndPos)),s.removeAllRanges(),s.addRange(l)}var h=this.editCellData.sheetIndex;if(h!==this.parent.activeSheetIndex){var u=this.parent.element.querySelector(".e-formula-bar");u.value&&(u.value.indexOf(")")===this.curEndPos-1?this.setFormulaBarCurPosition(u,this.curEndPos-1,this.curEndPos-1):this.setFormulaBarCurPosition(u,this.curEndPos,this.curEndPos))}},o.prototype.getEditElement=function(e,t){if((this.isEdit||t)&&(e.frozenRows||e.frozenColumns)){var i=this.parent.frozenRowCount(e),r=this.parent.frozenColCount(e),n=Se(e.activeCell),s=void 0;if(n[0]<i&&n[1]<r)s=this.parent.getSelectAllContent();else if(n[0]<i)s=this.parent.getColumnHeaderContent();else if(n[1]<r)s=this.parent.getRowHeaderContent();else return this.editorElem;var a=s.getElementsByClassName("e-spreadsheet-edit")[0];return!a&&t&&(a=s.appendChild(this.editorElem.cloneNode())),a}return this.editorElem},o.prototype.sheetChangeHandler=function(){this.isEdit||(this.editCellData.value=null)},o.prototype.showFormulaAlertDlg=function(e,t){var i=this,r=this.parent.serviceLocator.getService(fe),n=this.parent.serviceLocator.getService("dialog"),s,a=this.getFormulaErrorKey(e),l,h=r.getConstant(a),u=n.dialogInstance;return u&&u.visible&&u.element.classList.contains("e-circularref-dlg")||n.show({width:400,isModal:!0,showCloseIcon:!0,target:this.parent.element,cssClass:"e-validation-error-dlg e-circularref-dlg",content:h,beforeOpen:function(c){if(t){var d=i.parent.getActiveSheet(),p={dialogName:"CircularReferenceDialog",element:c.element,target:c.target,cancel:c.cancel,cellAddress:d.name+"!"+d.activeCell,content:h};if(i.parent.trigger("dialogBeforeOpen",p),p.cancel){c.cancel=l=!0;return}else p.content!==h&&(n.dialogInstance.content=p.content,n.dialogInstance.dataBind())}if(window.getSelection().rangeCount>0){var f=window.getSelection().getRangeAt(0);s=f.endOffset}},buttons:[{buttonModel:{content:r.getConstant("Ok"),isPrimary:!0},click:function(){return n.hide()}}],close:function(){if(!l){var c=i.getEditElement(i.parent.getActiveSheet());if(c.childElementCount){var d=c.textContent;s=d.length,c.textContent=d}var p=document.getSelection(),f=document.createRange();f.setStart(c.firstChild,s),f.collapse(!0),p.removeAllRanges(),p.addRange(f),c.focus()}}},!1),l},o.prototype.getFormulaErrorKey=function(e){var t;switch(e){case"invalid arguments":t="InvalidArguments";break;case"improper formula":t="ImproperFormula";break;case"empty expression":t="EmptyExpression";break;case"mismatched parentheses":t="MismatchedParenthesis";break;case"mismatched string quotes":t="MismatchedStringQuotes";break;case"wrong number of arguments":t="WrongNumberOfArguments";break;case"requires 3 arguments":t="Requires3Arguments";break;case"#CIRCULARREF!":t="FormulaCircularRef";break;default:t="InvalidFormulaError"}return t},o.prototype.readOnlyAlertHandler=function(){var e=this,t=this.parent.serviceLocator.getService(fe),i=this.parent.serviceLocator.getService("dialog"),r=this.parent.element.querySelector(".e-find-dlg"),n;g(r)||(n=at(r,"dialog")),i.show({content:t.getConstant("ReadonlyAlert"),isModal:!0,closeOnEscape:!0,showCloseIcon:!0,width:"400px",cssClass:"e-readonly-alert-dlg",beforeOpen:function(s){var a={dialogName:"ReadOnlyAlertDialog",content:t.getConstant("ReadonlyAlert"),element:s.element,target:s.target,cancel:s.cancel};e.parent.trigger("dialogBeforeOpen",a),a.cancel?s.cancel=!0:(i.dialogInstance.content=a.content,Fe(e.parent.element))},close:function(){g(r)||(i.dialogInstance=n),Fe(e.parent.element)}})},o.prototype.finiteAlertHandler=function(){var e=this.parent.serviceLocator.getService(fe),t=this.parent.serviceLocator.getService("dialog");t.show({header:e.getConstant("Alert"),content:e.getConstant("FiniteAlert"),isModal:!0,closeOnEscape:!0,showCloseIcon:!0,width:"400px",cssClass:"e-finite-alert-dlg"})},o}(),zO=function(){function o(e){this.invalidOperators=["%"],this.formulaRange=[],this.isNoteActiveElement=!1,this.isNoteTouch=!1,this.parent=e,this.addEventListener(),this.mouseMoveEvt=this.mouseMoveHandler.bind(this)}return o.prototype.addEventListener=function(){this.parent.on(In,this.init,this),this.parent.on(ml,this.mouseDownHandler,this),this.parent.on(Wa,this.virtualContentLoadedHandler,this),this.parent.on(Jh,this.cellNavigateHandler,this),this.parent.on(Su,this.selectRange,this),this.parent.on(An,this.rowHeightChanged,this),this.parent.on(_n,this.colWidthChanged,this),this.parent.on(nb,this.protectHandler,this),this.parent.on(dl,this.initiateFormulaSelection,this),this.parent.on(II,this.clearBorder,this),this.parent.on(Ys,this.getRowIdxFromClientY,this),this.parent.on(Qs,this.getColIdxFromClientX,this),this.parent.on(Py,this.getRowIdxFromClientY,this),this.parent.on(By,this.getColIdxFromClientX,this),this.parent.on(Yc,this.chartBorderHandler,this),this.parent.on(Wf,this.isTouchSelectionStarted,this),this.parent.on(Gx,this.selectionByKeydown,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(In,this.init),this.parent.off(ml,this.mouseDownHandler),this.parent.off(Wa,this.virtualContentLoadedHandler),this.parent.off(Jh,this.cellNavigateHandler),this.parent.off(Su,this.selectRange),this.parent.off(An,this.rowHeightChanged),this.parent.off(_n,this.colWidthChanged),this.parent.off(nb,this.protectHandler),this.parent.off(dl,this.initiateFormulaSelection),this.parent.off(II,this.clearBorder),this.parent.off(Ys,this.getRowIdxFromClientY),this.parent.off(Qs,this.getColIdxFromClientX),this.parent.off(Py,this.getRowIdxFromClientY),this.parent.off(By,this.getColIdxFromClientX),this.parent.off(Yc,this.chartBorderHandler),this.parent.off(Wf,this.isTouchSelectionStarted),this.parent.off(Gx,this.selectionByKeydown))},o.prototype.isTouchSelectionStarted=function(e){e.touchSelectionStarted=this.touchSelectionStarted},o.prototype.selectionByKeydown=function(e){this.selectRangeByIdx(e.range,e.e,!1,!1,!1,!1,void 0,!1)},o.prototype.rowHeightChanged=function(e){var t=this;e.threshold&&cr(function(){if(t.parent){var i=t.parent.getActiveSheet(),r=t.getActiveCell();if(r&&(i.frozenRows||i.frozenColumns||i.selectedRange.includes(" "))){t.selectRange({address:i.selectedRange});return}var n=tt(J(i.selectedRange)),s={range:n,isActiveCell:!1,skipChecking:!0},a;if(r){var l=Se(i.activeCell)[0];if(t.parent.notify(Do,s),s.isActiveCell){var h=G(n[0],n[1],i,!1,!0);a=h.rowSpan>1&&n[0]<=e.rowIdx&&n[2]>=e.rowIdx}l===e.rowIdx||a?r.style.height=parseFloat(r.style.height)+e.threshold+"px":l>e.rowIdx&&(r.style.top=parseFloat(r.style.top)+e.threshold+"px")}if(r=t.getSelectionElement(),r){if(a||n[0]===n[2]&&n[1]===n[3])return;var u=n[0],c=n[2];u<=e.rowIdx&&c>=e.rowIdx&&r?r.style.height=parseFloat(r.style.height)+e.threshold+"px":u>e.rowIdx&&r&&(r.style.top=parseFloat(r.style.top)+e.threshold+"px")}}})},o.prototype.colWidthChanged=function(e){var t=this;e.threshold&&cr(function(){if(t.parent){var i=t.parent.getActiveSheet(),r=t.getActiveCell(),n=t.parent.enableRtl;if(r&&(i.frozenRows||i.frozenColumns||i.selectedRange.includes(" "))){t.selectRange({address:i.selectedRange});return}var s=tt(J(i.selectedRange)),a={range:s,isActiveCell:!1,skipChecking:!0},l;if(r){t.parent.notify(Do,a);var h=Se(i.activeCell)[1];if(a.isActiveCell){var u=G(s[0],s[1],i,!1,!0);l=u.rowSpan>1||u.colSpan>1}h===e.colIdx||l?r.style.width=parseFloat(r.style.width)+e.threshold+"px":h>e.colIdx&&(n?r.style.right=parseFloat(r.style.right)+e.threshold+"px":r.style.left=parseFloat(r.style.left)+e.threshold+"px")}if(r=t.getSelectionElement(),!(!r||l||s[0]===s[2]&&s[1]===s[3])){var c=s[1],d=s[3];c<=e.colIdx&&d>=e.colIdx&&r?r.style.width=parseFloat(r.style.width)+e.threshold+"px":c>e.colIdx&&r&&(n?r.style.right=parseFloat(r.style.right)+e.threshold+"px":r.style.left=parseFloat(r.style.left)+e.threshold+"px")}}})},o.prototype.selectRange=function(e){e.address=this.parent.selectionSettings.mode==="Single"?Be(Se(e.address)):e.address,this.selectMultiRange(e.address,null,null,e.skipChecking)},o.prototype.init=function(){this.createSelectionElement();var e=this.parent.getActiveSheet(),t=tt(J(e.selectedRange)),i=Se(e.activeCell),r=t[0]<=i[0]&&t[2]>=i[0]&&t[1]<=i[1]&&t[3]>=i[1];this.selectMultiRange(e.selectedRange,!0,r)},o.prototype.selectMultiRange=function(e,t,i,r){var n=this,s=this.parent.activeSheetIndex;e.indexOf("!")>-1&&(s=yt(this.parent,Ws(e)),e=e.substring(e.lastIndexOf("!")+1)),this.parent.activeSheetIndex===s?e.split(" ").forEach(function(a,l){n.selectRangeByIdx(J(a),{type:"mousedown",ctrlKey:l!==0},null,i,t,r)}):gf(this.parent,e,this.parent.sheets[s])},o.prototype.createSelectionElement=function(){var e=this.parent.getMainContent(),t=this.parent.createElement("div",{className:"e-selection"});e.appendChild(t),t=this.parent.createElement("div",{className:"e-active-cell"}),e.appendChild(t)},o.prototype.isMergeActiveCell=function(e,t,i,r){var n=G(i,r,e,!1,!0);if(n.rowSpan&&n.rowSpan!==1||n.colSpan&&n.colSpan!==1){var s={range:[i,r,i,r]};this.parent.notify(ur,s);var a=s.range;return a[0]===t[0]&&a[1]===t[1]}return!1},o.prototype.mouseDownHandler=function(e){var t=this;if(this.isNoteActiveElement=!g(document)&&!g(document.activeElement)&&typeof document.activeElement.className=="string"&&document.activeElement.className.indexOf("e-addNoteContainer")>-1,!(j(e.target,".e-scrollbar")||e.target.classList.contains("e-main-panel")||e.target.classList.contains("e-sheet"))){var i={action:"getCurrentEditValue",editedValue:""},r=this.parent.getActiveSheet();this.parent.notify(fi,i);var n=ut(i.editedValue,!0),s=this.parent.enableNotes&&!g(this.parent.spreadsheetNoteModule.noteCellIndexes),a=s?this.parent.spreadsheetNoteModule.noteCellIndexes:Se(this.parent.getActiveSheet().activeCell),l=this.parent.getCell(a[0],a[1]);if(!g(l)&&l.children!==null&&l.children.length>0&&this.isNoteActiveElement&&l.children[l.children.length-1].classList.contains("e-addNoteIndicator")){var h=G(a[0],a[1],r),u=!g(h)&&h.notes?"editNote":"addNote",c=document.getElementsByClassName("e-addNoteContainer")[0],d=Vn(this.parent,this.parent.activeSheetIndex)+"!"+Be(a);if(!g(c)&&!g(c.value)&&e.target.className!=="e-addNoteContainer"&&(g(h)||g(h.notes)||h.notes!==c.value)){this.parent.notify(hh,{args:{action:"beforeCellSave",eventArgs:{address:d}}}),sr(this.parent,this.parent.getActiveSheet(),{rowIdx:a[0],colIdx:a[1],preventEvt:!0,cell:{notes:c.value,isNoteEditable:!1}});var p={notes:c.value,address:d};this.parent.notify(mt,{eventArgs:p,action:u})}else e.target.className!=="e-addNoteContainer"&&sr(this.parent,this.parent.getActiveSheet(),{rowIdx:a[0],colIdx:a[1],preventEvt:!0,cell:{isNoteEditable:!1}});this.parent.spreadsheetNoteModule.isShowNote=null}if(!this.isNoteTouch&&e.target.className!=="e-addNoteContainer"&&document.getElementsByClassName("e-addNoteContainer")&&document.getElementsByClassName("e-addNoteContainer").length>0&&this.parent.notify(iu,""),this.isNoteTouch&&e.type.indexOf("mouse")>-1&&(this.isNoteTouch=!1),!this.parent.isEdit||n){var f=document.getElementById(this.parent.element.id+"_overlay");if(typeof e.target.className=="string"){if(e.target.className.indexOf("e-ss-overlay")>-1)return}else f&&f.classList.remove("e-ss-overlay-active");if(j(e.target,".e-datavisualization-chart")||r.isProtected&&!r.protectSettings.selectCells&&!r.protectSettings.selectUnLockedCells)return;if(!(j(e.target,".e-findtool-dlg")||j(e.target,".e-dragfill-ddb"))&&this.getSheetElement().contains(e.target)&&!e.target.classList.contains("e-colresize")&&!e.target.classList.contains("e-rowresize")){var v=this.parent.getActiveSheet(),m=this.parent.selectionSettings.mode,y=xo(e),S=Io(e),b=this.getRowIdxFromClientY({clientY:S,target:e.target}),w=this.getColIdxFromClientX({clientX:y,target:e.target}),I=Se(v.activeCell),x=void 0,M=void 0;if(v.showHeaders){var D=e.target;if(v.frozenColumns||v.frozenRows){var A=this.parent.getSelectAllContent().querySelector("thead");A?M=(this.parent.getColumnHeaderContent().contains(D)||A.contains(D))&&D.classList.contains("e-header-cell")||D.classList.contains("e-selectall-table")&&b<0&&w>=this.parent.frozenColCount(v):M=this.parent.getColumnHeaderContent().contains(D)&&D.classList.contains("e-header-cell"),A=this.parent.getSelectAllContent().querySelector("tbody"),A?x=(this.parent.getRowHeaderContent().contains(D)||A.contains(D))&&D.classList.contains("e-header-cell")||D.classList.contains("e-selectall-table")&&w<0&&b>=this.parent.frozenRowCount(v):x=this.parent.getRowHeaderContent().contains(D)&&D.classList.contains("e-header-cell"),b===-1&&(b=0),w===-1&&(w=0)}else x=this.parent.getRowHeaderContent().contains(e.target),M=this.parent.getColumnHeaderContent().contains(e.target)}if((v.frozenRows||v.frozenColumns)&&!M&&!x){var L=e.target,T=["e-rowhdr-table","e-selectall-table","e-colhdr-table"].findIndex(function(ve){return L.classList.contains(ve)});if(T>-1){var k=[".e-row-header",".e-selectall-container",".e-column-header"][T],F=j(L,k);if(F&&F.style.zIndex){var h=G(b,w,v);if(h&&h.validation&&h.validation.type==="List"||Ds(v.columns[w],b,w)&&v.columns[w].validation.type==="List"){var R=this.parent.getCell(b,w);if(R){var N=R.querySelector(".e-validation-list");if(N){var P=N.getBoundingClientRect(),O=y>=P.left&&y<=P.right&&S>=P.top&&S<=P.bottom;if(O){var z=N.querySelector(".e-dropdownlist");if(z){var H=at(z,"dropdownlist");H&&H.showPopup()}}}}}}}}if(e.which===3&&this.isSelected(b,w))return;if(e.target.classList.contains("e-autofill")){this.isautoFillClicked=!0;var Q=e.target.parentElement.querySelector(".e-dragfill-ddb");(!Q||Q.classList.contains("e-hide"))&&(this.dAutoFillCell=v.selectedRange)}var $=J(v.topLeftCell),U=void 0;if(x?(this.isRowSelected=!0,!e.shiftKey||m==="Single"?this.startCell=[b,0]:this.startCell||(this.startCell=[$[0],0]),U=[this.startCell[0],v.frozenColumns?$[1]:0,b,v.colCount-1]):M?(this.isColSelected=!0,!e.shiftKey||m==="Single"?this.startCell=[0,w]:this.startCell||(this.startCell=[0,$[1]]),U=[v.frozenRows?$[0]:0,this.startCell[1],v.rowCount-1,w]):j(e.target,".e-select-all-cell")?(this.startCell=[v.frozenRows?$[0]:0,v.frozenColumns?$[1]:0],U=[].concat(this.startCell,[v.rowCount-1,v.colCount-1])):e.target.classList.contains("e-sheet-content")||((!e.shiftKey||m==="Single")&&(this.startCell=[b,w]),!this.isautoFillClicked&&!j(e.target,".e-filloption")&&(U=[].concat(this.startCell?this.startCell:Se(v.activeCell),[b,w]))),Vc(e)&&!(x||M)&&U){var ie=this.isRowColSelected(U);this.isRowSelected=ie.isRowSelected,this.isColSelected=ie.isColSelected}var ne=e.ctrlKey&&U&&v.selectedRange.includes(Be(U));if(!ne&&m==="Multiple"&&(!cx(e)&&(!Vc(e)||Vc(e)&&(I[0]===b&&I[1]===w||this.isMergeActiveCell(v,I,b,w)))||M||x)?(document.addEventListener(ih().split(" ")[0],this.mouseMoveEvt),B.isPointer||(B.isIos&&Vc(e)&&e.target&&e.target.classList.contains("e-cell")&&e.preventDefault(),document.addEventListener(ih().split(" ")[1],this.mouseMoveEvt,{passive:!1})),this.touchSelectionStarted=!0):this.touchSelectionStarted=!1,!cx(e))if(ne){if(this.parent.isEdit){var te=function(ve){E.remove(document,Xc(),te),t.updateFormulaCursorPosition(ve)};E.add(document,Xc(),te,this)}}else E.add(document,Xc(),this.mouseUpHandler,this);var oe=e.target.className==="e-addNoteIndicator"||e.target.children.length>0&&e.target.children[e.target.childElementCount-1].className.indexOf("e-addNoteIndicator")>-1;if(Vc(e)&&oe){var ae=Se(Be(U).split(":")[0]);this.parent.notify(ed,{rowIndex:ae[0],columnIndex:ae[1],isNoteEditable:!1}),this.isNoteTouch=!0,this.parent.spreadsheetNoteModule.isNoteVisibleOnTouch=!0}if(Vc(e)&&!(M||x)){this.touchEvt=e;return}if(U&&this.selectRangeByIdx(U,e),!this.isNoteTouch&&e.type.indexOf("mouse")>-1&&oe){var ye=Se(Be(U).split(":")[0]);this.parent.notify(ed,{rowIndex:ye[0],columnIndex:ye[1],isNoteEditable:!1}),this.parent.spreadsheetNoteModule.isNoteVisible=!0}this.parent.isMobileView()&&(this.parent.element.classList.add("e-mobile-focused"),this.parent.renderModule.setSheetPanelSize())}}if(n&&(e.target.classList.contains("e-cell")||e.target.classList.contains("e-wrap-content")||e.target.classList.contains("e-header-cell"))&&this.parent.isEdit){var U=this.parent.getActiveSheet().selectedRange,De=U.split(" ");U=mf(Qi(De[De.length-1]))?De[De.length-1].split(":")[0]:De[De.length-1],this.parent.notify(gl,{range:U,isSelect:!1,isMouseDown:e.ctrlKey})}}},o.prototype.mouseMoveHandler=function(e){var t=this,i=this.parent.getActiveSheet();Sb(e)&&e.preventDefault();var r={action:"getCurrentEditValue",editedValue:""};this.parent.notify(fi,r);var n=ut(r.editedValue,!0),s=this.parent.getMainContent().parentElement,a=this.parent.element.getElementsByClassName("e-scroller")[0],l=s.getBoundingClientRect(),h=this.parent.frozenColCount(i),u=l.left+this.parent.sheetModule.getRowHeaderWidth(i,!1,!0),c=l.right-LO(),d=l.top,p=l.bottom,f=xo(e),v=Io(e),m=this.isRowSelected?i.colCount-1:this.getColIdxFromClientX({clientX:f,target:e.target}),y=this.isColSelected?i.rowCount-1:this.getRowIdxFromClientY({clientY:v,target:e.target}),S,b;if(e.ctrlKey){var w=i.selectedRange.split(" ");S=J(w[w.length-1])}else S=J(i.selectedRange);if(B.isDevice){var I=screen.availWidth;c>=I-40&&(c-=40-(I-c)),!i.showHeaders&&u<40&&(u+=40-u)}var x={range:[y,m,y,m]};if(this.parent.notify(ur,x),!(x.range[2]===S[2]&&x.range[3]===S[3]&&v<=p&&v>=d&&f<=c&&f>=u)){var M=this.parent.frozenRowCount(i);!n&&!this.isColSelected&&!this.isRowSelected&&(S=Se(i.activeCell));var D=v>p&&!this.isColSelected&&y<i.rowCount,A=v<d&&y>=0&&!this.isColSelected&&!!s.scrollTop&&(!M||S[0]>=M),L=f>c&&!this.isRowSelected&&m<i.colCount,T=f<u&&m>=0&&!this.isRowSelected&&!!a.scrollLeft&&(!h||S[1]>=h);this.clearInterval();var k,F;if(D||A||L||T){(A||T)&&(k=y,F=m);var R=function(){if(D||A){if(y=t.getRowIdxFromClientY({clientY:D?p:d}),y>=i.rowCount){t.clearInterval();return}s.scrollTop+=(D?1:-1)*li(i,y)}if(L||T){if(m=t.getColIdxFromClientX({clientX:L?c:u,isFScroll:!0}),m>=i.colCount){t.clearInterval();return}a.scrollLeft+=(L?1:-1)*_r(i,m)}if(A&&i.frozenRows&&!s.scrollTop||T&&i.frozenColumns&&!a.scrollLeft){t.selectRangeByIdx([].concat(S[0],S[1],[k,F]),e),t.clearInterval();return}t.selectRangeByIdx([].concat(S[0],S[1],[y,m]),e)};R(),this.scrollInterval=setInterval(function(){R(),t.clearInterval(),t.scrollInterval=setInterval(R,100)})}else{var N=[].concat(S[0],S[1],[y,m]);if(M&&N[0]<M&&N[2]>=M&&s.scrollTop&&(s.scrollTop=0,N[2]=M),h&&N[1]<h&&N[3]>=h&&a.scrollLeft&&(a.scrollLeft=0,N[3]=h),this.isautoFillClicked){e.target.classList.contains("e-autofill")&&(this.dAutoFillCell=i.selectedRange);var P={e,indexes:null};this.parent.notify(OI,P),N=P.indexes,b=N}this.selectRangeByIdx(N,e)}if(n&&this.parent.isEdit&&!j(e.target,"#"+this.parent.element.id+"_edit")){var O=void 0;this.isautoFillClicked?O=Be(b):O=this.parent.getActiveSheet().selectedRange;var z=O.split(" ");this.parent.notify(gl,{range:z[z.length-1],isSelect:!1})}}},o.prototype.mouseUpHandler=function(e){var t=this.getRowIdxFromClientY({clientY:Io(e),target:e.target}),i=this.getColIdxFromClientX({clientX:xo(e),target:e.target});this.clearInterval(),cx(e)&&!(this.isColSelected||this.isRowSelected)&&this.getRowIdxFromClientY({clientY:Io(this.touchEvt),target:e.target})===t&&this.getColIdxFromClientX({clientX:xo(this.touchEvt),target:e.target})===i&&this.mouseDownHandler(e),document.removeEventListener(ih().split(" ")[0],this.mouseMoveEvt),B.isPointer||document.removeEventListener(ih().split(" ")[1],this.mouseMoveEvt),E.remove(document,Xc(),this.mouseUpHandler);var r=this.parent.getActiveSheet();if((r.frozenRows||r.frozenColumns)&&_i(this.parent.element,null,"e-cur-selection",!0,!0),this.parent.notify(_x,e),this.isautoFillClicked){var n=this.parent.getActiveSheet(),s=J(n.selectedRange);if(!(this.isColSelected&&s[1]===i)&&!(this.isRowSelected&&s[0]===t)){var a=e.target.parentElement.querySelector(".e-dragfill-ddb");(!a||a.classList.contains("e-hide"))&&(this.dAutoFillCell=n.selectedRange),this.parent.notify(vb,{event:e,dAutoFillCell:this.dAutoFillCell})}this.isautoFillClicked=!1}else!e.ctrlKey&&!qI(UF(this.parent.getActiveSheet()))?this.parent.notify(Za,null):this.parent.notify(nh,null);this.updateFormulaCursorPosition(e)},o.prototype.updateFormulaCursorPosition=function(e){if(this.parent.isEdit){var t={action:"getCurrentEditValue",editedValue:""};this.parent.notify(fi,t);var i=ut(t.editedValue,!0);i&&this.parent.notify(ob,{isCellEdit:e.target.classList.contains("e-spreadsheet-edit")})}},o.prototype.isSelected=function(e,t){for(var i=!1,r,n=this.parent.getActiveSheet().selectedRange.split(" "),s=0;s<n.length;s++)if(r=tt(J(n[s])),r[0]<=e&&e<=r[2]&&r[1]<=t&&t<=r[3]){i=!0;break}return i},o.prototype.virtualContentLoadedHandler=function(e){var t=this,i=this.parent.getActiveSheet(),r,n,s;i.selectedRange.split(" ").forEach(function(a,l){if(r=J(a),s=r[1]===0&&r[3]===e.prevRowColCnt.colCount-1,n=r[0]===0&&r[2]===e.prevRowColCnt.rowCount-1,s||n)n&&s?r=[0,0,i.rowCount-1,i.colCount-1]:n?r=[0,r[1],i.rowCount-1,r[3]]:r=[r[0],0,r[2],i.colCount-1],i.frozenRows||i.frozenColumns?t.selectRangeByIdx(r,{type:"mousedown",ctrlKey:l!==0},!1,!1,!1,!1,void 0,!0):t.selectRangeByIdx(r,null,!0,null,null,null,l);else{r=J(a);var h=t.parent.viewport.topIndex+t.parent.frozenRowCount(i),u=t.parent.viewport.leftIndex+t.parent.frozenColCount(i);t.highlightHdr(r,l!==0,r[0]>=h||r[2]>=h,r[1]>=u||r[3]>=u)}})},o.prototype.clearInterval=function(){this.scrollInterval&&(clearInterval(this.scrollInterval),this.scrollInterval=null)},o.prototype.getScrollLeft=function(){return this.parent.scrollModule?this.parent.scrollModule.prevScroll.scrollLeft:0},o.prototype.cellNavigateHandler=function(e){var t=this.parent.getActiveSheet();t.isProtected&&!t.protectSettings.selectCells&&!t.protectSettings.selectUnLockedCells||(e.type="mousedown",this.selectRangeByIdx(e.range,e,!1,!1,!1,!1,void 0,e.preventAnimation))},o.prototype.getColIdxFromClientX=function(e){var t=this,i=0,r=this.parent.getActiveSheet(),n=0;if(e.isImage)n=e.clientX;else{var s=document.getElementById(this.parent.element.id+"_sheet").getBoundingClientRect();this.parent.enableRtl?n=s.right-this.parent.sheetModule.getRowHeaderWidth(r,!0,!0)-1-e.clientX:n=e.clientX-(s.left+this.parent.sheetModule.getRowHeaderWidth(r,!0,!0)+1),n+=this.parent.viewport.beforeFreezeWidth;var a=function(){var u=t.parent.element.querySelector(".e-frozen-column");return parseInt(u.style[t.parent.enableRtl?"right":"left"],10)/t.parent.viewport.scaleX};if((!e.target||!j(e.target,".e-row-header")&&!j(e.target,".e-selectall-container")||this.isScrollableArea(e.clientX,e.target,!0))&&(!this.parent.frozenColCount(r)||n>a()||e.isFScroll)&&(n+=this.getScrollLeft()/this.parent.viewport.scaleX),r.frozenRows&&n<0&&r.showHeaders)return-1}for(var l,h=0;;h++)if(l=i+=_r(r,h,null,!e.isImage)/this.parent.viewport.scaleX,n<(e.isImage?Number(dh(l).toFixed(2)):l)||this.parent.scrollSettings.isFinite&&h===r.colCount-1)return e.isImage||(e.size=n),e.clientX=h,h},o.prototype.isScrollableArea=function(e,t,i){return t.classList.contains("e-table")?i?e>this.parent.getMainContent().getBoundingClientRect().left:e>this.parent.getMainContent().parentElement.getBoundingClientRect().top:!1},o.prototype.getRowIdxFromClientY=function(e){var t=0,i=this.parent.getActiveSheet(),r=0;if(e.isImage)r=e.clientY;else{var n=document.getElementById(this.parent.element.id+"_sheet");if(r=e.clientY+this.parent.viewport.beforeFreezeHeight-(n.getBoundingClientRect().top+(i.showHeaders?31/this.parent.viewport.scaleY:0)),(!e.target||!j(e.target,".e-header-panel")||this.isScrollableArea(e.clientY,e.target))&&(r+=this.parent.getMainContent().parentElement.scrollTop/this.parent.viewport.scaleY),i.frozenColumns&&r<0&&i.showHeaders)return-1}for(var s,a=0;;a++)if(s=t+=li(i,a,!e.isImage)/this.parent.viewport.scaleY,r<(e.isImage?Number(dh(s).toFixed(2)):s)||this.parent.scrollSettings.isFinite&&a===i.rowCount-1)return e.isImage||(e.size=r),e.clientY=a,a},o.prototype.initFormulaReferenceIndicator=function(e){if(this.parent.isEdit){var t=this.parent.createElement("div",{className:"e-formularef-indicator"});t.appendChild(this.parent.createElement("div",{className:"e-top"})),t.appendChild(this.parent.createElement("div",{className:"e-bottom"})),t.appendChild(this.parent.createElement("div",{className:"e-left"})),t.appendChild(this.parent.createElement("div",{className:"e-right"})),this.parent.getMainContent().appendChild(t),Us(this.parent,t,e,"e-formularef-indicator")}},o.prototype.isMouseEvent=function(e){return ay(e)||dx(e)||Uc(e)},o.prototype.selectRangeByIdx=function(e,t,i,r,n,s,a,l){var h=this,u=t&&this.isMouseEvent(t);if(!(t&&t.target&&u&&j(t.target,"#"+this.parent.element.id+"_edit"))){var c={action:"getCurrentEditValue",editedValue:"",endFormulaRef:!1};this.parent.notify(fi,c);var d=(this.parent.isEdit?ut(c.editedValue,!0):!1)&&!c.endFormulaRef,p=t&&t.ctrlKey&&ay(t),f;p||(f=this.getSelectionElement(t,a));var v=this.parent.getActiveSheet(),m=J(v.topLeftCell),y=this.parent.element.querySelector(".e-formularef-indicator"),S={range:[].slice.call(e),isActiveCell:!1,skipChecking:s},b,w=this.isRowColSelected(e);!w.isColSelected&&!w.isRowSelected&&this.parent.notify(Do,S),e!==S.range&&(b=!0),e=S.range;var I=new Promise(function(O){O(function(){}())}),x={range:Be(e),cancel:!1};if(v.isProtected){var M=G(e[2],e[3],v);if(v.protectSettings.selectUnLockedCells&&!v.protectSettings.selectCells)if(g(M)){if(!v.protectSettings.selectCells)return}else{if(M.isLocked===!0||g(M.isLocked))return;var D=this.parent.element.getElementsByClassName("e-sheet-panel")[0];D&&D.classList.contains("e-protected")&&D.classList.remove("e-protected")}}if(this.parent.trigger("beforeSelect",x),!x.cancel){if(d&&y&&y.parentElement.removeChild(y),this.parent.notify(gb,null),(mf(e)||S.isActiveCell)&&!p){if(f&&(f.classList.contains("e-multi-range")||f.classList.add("e-hide"),v.frozenRows||v.frozenColumns)){var A=Uc(t)?"e-cur-selection":"e-selection";_i(this.parent.getSelectAllContent(),null,A,!0),_i(this.parent.getColumnHeaderContent(),null,A,!0),_i(this.parent.getRowHeaderContent(),null,A,!0)}if(!v.frozenColumns&&!v.frozenRows&&f&&Us(this.parent,f,e),d&&t&&t.target&&(!u||!t.target.classList.contains("e-spreadsheet-edit"))&&this.parent.isEdit){var L={range:Be(e).split(":")[0],isSelect:!0};if(this.parent.notify(gl,L),L.isAlertDlgOpen)return;this.initFormulaReferenceIndicator(e)}}else{if(p)if(a===void 0){var T=Be(e);if(v.selectedRange.includes(T)&&!d){var k=v.selectedRange.split(" ");k.length>1?(k.splice(k.indexOf(T),1),T=k.join(" ")):T=v.activeCell+":"+v.activeCell,this.selectRange({address:T});return}else f=this.getSelectionElement(t,a)}else f=this.getSelectionElement(t,a);if(d&&this.parent.isEdit){if(t&&t.target&&(!u||!t.target.classList.contains("e-spreadsheet-edit"))&&this.parent.isEdit){var L={range:Be(e),isSelect:!0};if(this.parent.notify(gl,L),L.isAlertDlgOpen)return;this.initFormulaReferenceIndicator(e)}}else{var A=void 0;f&&(f.classList.remove("e-hide"),(v.frozenRows||v.frozenColumns)&&((t&&t.target||p)&&(A="e-cur-selection",Uc(t)&&f.classList.contains("e-cur-selection")?f.classList.add("e-hide"):f.classList.add(A)),!p&&(this.isColSelected||this.isRowSelected)&&ay(t)&&(_i(this.parent.getSelectAllContent(),null,"e-selection"),_i(this.parent.getColumnHeaderContent(),null,"e-selection"),_i(this.parent.getRowHeaderContent(),null,"e-selection"))));var F=this.isColSelected&&this.isRowSelected?void 0:this.getOffset(e[2],e[3]);b&&F&&(F.left={idx:0,size:0}),I=Us(this.parent,f,e,A,l,p,p&&!t.target)||I}}var R={action:"getCurrentEditSheetIdx",sheetIndex:null};this.parent.notify(fi,R),v.frozenColumns&&e[1]>0&&e[1]===m[1]&&e[3]===v.colCount-1&&(e[1]=0),v.frozenRows&&e[0]>0&&e[0]===m[0]&&e[2]===v.rowCount-1&&(e[0]=0);var N=Be(e);if(t&&t.ctrlKey&&(Uc(t)||dx(t))&&!d)N=v.selectedRange.slice(0,v.selectedRange.lastIndexOf(" "))+" "+N;else if(a>-1){var k=v.selectedRange.split(" ");k[a]=N,N=k.join(" ")}if(!d&&!this.isautoFillClicked){var P=!1;v.selectedRange!==N&&(P=!0),gf(this.parent,N,v,p),P&&I.then(function(){h.parent&&h.parent.trigger("select",{range:h.parent.getActiveSheet().selectedRange})})}else!n&&!this.isautoFillClicked&&gf(this.parent,N,v,p);w=this.isRowColSelected(e),this.isRowSelected=w.isRowSelected,this.isColSelected=w.isColSelected,this.highlightHdr(e,t&&t.ctrlKey),!i&&!(t&&(t.type==="mousemove"||Sb(t)))&&(d?R.sheetIndex===this.parent.getActiveSheet().id-1&&n?(r=!0,this.updateActiveCell(r?J(v.activeCell):e,n,l)):this.parent.isEdit||this.updateActiveCell(r?J(v.activeCell):e,n,l):this.updateActiveCell(r?J(v.activeCell):e,n,l)),g(t)&&(t={type:"mousedown"}),d?n||this.parent.notify(pa,t):this.parent.notify(pa,t),!p&&!qI(UF(this.parent.getActiveSheet()))?this.parent.notify(Za,{preventAnimation:l}):this.parent.notify(nh,null),this.parent.showAggregate&&this.parent.notify(yl,{}),this.parent.notify(td,null)}}},o.prototype.isRowColSelected=function(e){var t=this.parent.getActiveSheet();return{isRowSelected:e[1]===0&&e[3]===t.colCount-1,isColSelected:e[0]===0&&e[2]===t.rowCount-1}},o.prototype.updateActiveCell=function(e,t,i){var r=this.parent.getActiveSheet(),n=J(r.topLeftCell),s,a,l;this.isColSelected?(s=n[0],a=e[1],this.isRowSelected&&(a=n[1])):(s=e[0],a=e[1],this.isRowSelected&&(a=n[1]));var h={range:[s,a].concat([s,a])};if(this.parent.notify(ur,h),e!==h.range&&(l=!0),e=h.range,r.activeCell!==et(e[0],e[1])||t){if(this.previousActiveCell=r.activeCell.indexOf(":")>-1?this.previousActiveCell:r.activeCell,this.parent.setSheetPropertyOnMute(r,"activeCell",et(e[0],e[1])),r.isProtected){var u=this.parent.element.querySelector(".e-formula-bar"),c=G(e[0],e[1],r),d=un(c,Rt(r,e[1]));d&&u&&!u.disabled?u.disabled=!0:!d&&u&&u.disabled&&(u.disabled=!1)}if(this.getActiveCell()){var p=this.getOffset(e[2],e[3]);l&&(p.left={idx:0,size:0}),Us(this.parent,this.getActiveCell(),e,"e-active-cell",i)}this.parent.notify(Qa,null)}else Us(this.parent,this.getActiveCell(),e,"e-active-cell",i)},o.prototype.getOffset=function(e,t){var i={left:{idx:0,size:0},top:{idx:0,size:0}};return this.parent.scrollModule&&(t>=this.parent.scrollModule.offset.left.idx&&(i.left=this.parent.scrollModule.offset.left),e>=this.parent.scrollModule.offset.top.idx&&(i.top=this.parent.scrollModule.offset.top)),i},o.prototype.getSelectionElement=function(e,t){var i=this.parent.getActiveSheet();if(e&&e.ctrlKey&&!this.parent.isEdit)if(dx(e)||Uc(e))if(i.frozenColumns||i.frozenRows){var r=this.parent.getMainContent().querySelector(".e-cur-selection");return r||(r=this.parent.element.querySelector(".e-multi-range"),r&&r.cloneNode())}else return this.parent.getMainContent().querySelector(".e-selection:last-child");else{var n=this.parent.getMainContent().getElementsByClassName("e-selection")[0],r=n.cloneNode();return r.classList.add("e-multi-range"),i.frozenColumns||i.frozenRows?(i.selectedRange.includes(" ")||(n.classList.remove("e-hide"),Us(this.parent,n,tt(J(i.selectedRange)),void 0,!1,!0)),!this.parent.getMainContent().querySelector(".e-multi-range")&&n.classList.contains("e-hide")?n:r):(n.classList.remove("e-hide"),this.parent.getMainContent().appendChild(r))}else{if(t>-1)return i.frozenRows||i.frozenColumns?this.parent.element.querySelector(".e-sheet").getElementsByClassName("e-selection")[t]:this.parent.getMainContent().getElementsByClassName("e-selection")[t];var s=[].slice.call(this.parent.element.getElementsByClassName("e-multi-range"));return s.forEach(function(a){Ue(a)}),this.parent.getMainContent().getElementsByClassName("e-selection")[0]}},o.prototype.getActiveCell=function(){return this.parent.getMainContent().getElementsByClassName("e-active-cell")[0]},o.prototype.getSheetElement=function(){return document.getElementById(this.parent.element.id+"_sheet")},o.prototype.highlightHdr=function(e,t,i,r){var n=this;i===void 0&&(i=!0),r===void 0&&(r=!0);var s=this.parent.getActiveSheet();if(s.showHeaders){t||(K(this.getSheetElement().querySelectorAll(".e-highlight"),"e-highlight"),K(this.getSheetElement().querySelectorAll(".e-prev-highlight"),"e-prev-highlight"));var a=this.parent.element.getElementsByClassName("e-select-all-cell")[0];a&&K([a],["e-prev-highlight-right","e-prev-highlight-bottom"]);var l=[],h=[],u=tt(e);this.isRowSelected&&(u[1]=se(s,u[1],!0,"columns")),this.isColSelected&&(u[0]=se(s,u[0],!0));var c=[0,0,0,0],d=[0,0,0,0],p=Se(s.topLeftCell),f,v,m=function(w,I,x){var M,D;if(w&&u[f]<w){p[f]=se(s,p[f],!0,I);var A=se(s,u[f],!0,I);A===p[f]&&(u[f]=A),D=n.parent.hiddenCount(p[f],u[f]-1,I,s),c[f]=u[f]-D-p[f],M=u[v]<w?u[v]:w-1,c[v]=M-n.parent.hiddenCount(u[f],M,I,s)-D-p[f]+1,M=n.parent.viewport[""+x]+w,u[v]>=M&&(d[f]=0,d[f]-=n.parent.hiddenCount(M,M,I,s),d[v]=u[v]-n.parent.hiddenCount(M,u[v],I,s)-M+1)}else{M=se(s,n.parent.viewport[""+x]+w,!0,I);var A=se(s,u[f],!0,I);M===A&&(u[f]=M),D=n.parent.hiddenCount(M,u[f]-1,I,s),d[f]=u[f]-D-M,d[v]=u[v]-n.parent.hiddenCount(u[f],u[v],I,s)-D-M+1}},y=function(w,I,x){for(var M=[].slice.call(I.getElementsByClassName("e-header-cell")),D=w[f];D<w[v];D++)M[D]&&x.push(M[D])};if(i){if(f=0,v=2,m(this.parent.frozenRowCount(s),"rows","topIndex"),s.frozenRows){var S=this.parent.getSelectAllContent().querySelector("tbody");S&&y(c,S,l)}y(d,this.parent.getRowHeaderContent(),l)}if(r){if(f=1,v=3,m(this.parent.frozenColCount(s),"columns","leftIndex"),s.frozenColumns){var b=this.parent.getSelectAllContent().querySelector("thead");b&&y(c,b,h)}y(d,this.parent.getColumnHeaderContent(),h)}s.isProtected&&!s.protectSettings.selectCells?K([].concat(l,h),"e-highlight"):Y([].concat(l,h),"e-highlight"),l.length&&l[0].parentElement.previousElementSibling&&l[0].parentElement.previousElementSibling.classList.add("e-prev-highlight"),h.length&&h[0].previousElementSibling&&h[0].previousElementSibling.classList.add("e-prev-highlight"),this.isRowSelected&&this.isColSelected&&(s.isProtected&&!s.protectSettings.selectCells?document.getElementById(this.parent.element.id+"_select_all").classList.remove("e-highlight"):document.getElementById(this.parent.element.id+"_select_all").classList.add("e-highlight")),a&&(se(s,u[0],!0)===se(s,0,!0)&&a.classList.add("e-prev-highlight-bottom"),se(s,u[1],!0,"columns")===se(s,0,!0,"columns")&&a.classList.add("e-prev-highlight-right"))}},o.prototype.protectHandler=function(){var e=J(this.parent.getActiveSheet().selectedRange),t=tt(e),i=Se(this.parent.getActiveSheet().activeCell),r=t[0]<=i[0]&&t[2]>=i[0]&&t[1]<=i[1]&&t[3]>=i[1];this.selectRangeByIdx(e,null,null,r)},o.prototype.initiateFormulaSelection=function(e){this.processFormulaEditRange(e.range,e.formulaSheetIdx)},o.prototype.processFormulaEditRange=function(e,t){var i,r=t,n=0,s={formula:e};this.parent.notify(Ry,s);var a=s.formulaArr,l=a.length,h=0,u=[["e-vborderright","e-vborderbottom"],["e-pborderright","e-pborderbottom"],["e-cborderright","e-cborderbottom"],["e-gborderright","e-gborderbottom"],["e-oborderright","e-oborderbottom"],["e-bborderright","e-bborderbottom"]];this.clearBorder();for(var c=this.parent.getActiveSheet().id-1;n<l&&(i=a[n],!(this.invalidOperators.indexOf(i)>-1));){if(Mr(i.toUpperCase())){if(i=i.replace(/\$/g,""),n>0&&a[n-1].lastIndexOf("!")===a[n-1].length-1){var d=a[n-1].substring(1,a[n-1].lastIndexOf("!")-1);r=d?yt(this.parent,d):r}a[n+1]===":"&&(n++,a[n+1]&&Mr(a[n+1].toUpperCase())&&(i=i+":"+a[n+1],n++)),c===r&&this.updateFormulaEditRange(i,h,u),r=t,h++}n++}},o.prototype.updateFormulaEditRange=function(e,t,i){var r=J(e);this.formulaRange[t]=e,this.dStartCell={rowIndex:r[0],colIndex:r[1]},this.dEndCell={rowIndex:r[2],colIndex:r[3]},this.focusBorder(this.dStartCell,this.dEndCell,i[t%6])},o.prototype.chartBorderHandler=function(e){this.focusBorder(e.startcell,e.endcell,e.classes,!0)},o.prototype.focusBorder=function(e,t,i,r){r=g(r)?!1:r;var n=this.parent.getActiveSheet(),s=tt([e.rowIndex,e.colIndex,t.rowIndex,t.colIndex]),a=J(n.topLeftCell),l=this.parent.hiddenCount(a[1],s[3]-1,"columns",n);if(r&&l>0&&(s[1]-=l,s[3]-=l),n.frozenRows||n.frozenColumns){var h=this.parent.createElement("div",{className:r?"e-range-indicator e-chart-range":"e-range-indicator e-formuala-range"});h.appendChild(this.parent.createElement("div",{className:"e-top"})),h.appendChild(this.parent.createElement("div",{className:"e-bottom"})),h.appendChild(this.parent.createElement("div",{className:"e-left"})),h.appendChild(this.parent.createElement("div",{className:"e-right"})),Us(this.parent,h,s,"e-range-indicator");return}var u=s[0],c=s[1],d=s[2],p=s[3];u&&this.getEleFromRange([u-1,c,u-1,p]).forEach(function(f){f&&(f.classList.add(i[1]),r||f.classList.add("e-formularef-selection"))}),this.getEleFromRange([u,p,d,p]).forEach(function(f){f&&(f.classList.add(i[0]),r||f.classList.add("e-formularef-selection"))}),this.getEleFromRange([d,c,d,p]).forEach(function(f){f&&(f.classList.add(i[1]),r||f.classList.add("e-formularef-selection"))}),c&&this.getEleFromRange([u,c-1,d,c-1]).forEach(function(f){f&&(f.classList.add(i[0]),r||f.classList.add("e-formularef-selection"))})},o.prototype.getEleFromRange=function(e){var t=e[0],i=e[1],r=e[2],n=e[3],s,a,l,h=[],u,c=[];if(t>r&&(l=t,t=r,r=l),i>n&&(l=i,i=n,n=l),this.parent.scrollSettings.enableVirtualization){for(s=t;s<=r;s++)if(a=s,a>-1){var d=this.parent.getRow(a,null);d&&(u=d.getElementsByClassName("e-cell"),h=n===i?[u[n]]:this.getRowCells(u,i,n+1),this.merge(c,h))}}return c},o.prototype.getRowCells=function(e,t,i){var r=[];for(t;t<i;t++)e[t]&&r.push(e[t]);return r},o.prototype.merge=function(e,t){!e||!t||Array.prototype.push.apply(e,t)},o.prototype.clearBorder=function(){var e=this.parent.getActiveSheet();if(e.frozenColumns||e.frozenRows){var t=[].slice.call(this.parent.element.getElementsByClassName("e-formuala-range"));t.forEach(function(l){ee(l)});return}for(var i=this.parent.element.getElementsByClassName("e-formularef-selection"),r=i.length-1;r>=0;r--)for(var n=i[r],s=["e-vborderright","e-vborderbottom","e-pborderright","e-pborderbottom","e-cborderright","e-cborderbottom","e-gborderright","e-gborderbottom","e-oborderright","e-oborderbottom","e-bborderright","e-bborderbottom","e-formularef-selection"],a=0;a<s.length;a++)n.classList.remove(s[a])},o.prototype.getModuleName=function(){return"selection"},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o}(),Tq=function(){function o(e){this.clientX=0,this.isKeyScroll=!0,this.parent=e,this.addEventListener(),this.initProps()}return o.prototype.onContentScroll=function(e){if(this.parent){var t=this.parent.getMainContent().parentElement,i=e.scrollLeft,r=e.scrollTop||t.scrollTop,n=i&&this.parent.enableRtl?this.initScrollValue-i:i,s,a;if(this.parent.allowAutoFill){var l=document.querySelector("#"+this.parent.element.id+"_autofilloptionbtn-popup"),h=document.querySelector("#"+this.parent.element.id+"_autofilloptionbtn");if(l){var u=at(h,"dropdown-btn");u.toggle()}}if(!g(i)&&this.prevScroll.scrollLeft!==n){var c=n>this.prevScroll.scrollLeft;a=this.offset.left.size,this.offset.left=this.getColOffset(n,c,e.skipHidden),e.preventScroll||(this.parent.getColumnHeaderContent().scrollLeft=i,this.parent.getMainContent().scrollLeft=i,e.scrollLeft=i),s={cur:this.offset.left,prev:{idx:this.leftIndex,size:a},increase:c,preventScroll:e.preventScroll},this.updateTopLeftCell(c,!0),this.parent.notify(Wy,null),this.parent.notify(jx,s),this.updateNoteContainer(),!this.parent.scrollSettings.enableVirtualization&&c&&!this.parent.scrollSettings.isFinite&&this.updateNonVirtualCols(),this.leftIndex=s.prev.idx,this.prevScroll.scrollLeft=n}if(Math.round(this.prevScroll.scrollTop)!==Math.round(r)){e.skipRowVirualScroll&&(this.prevScroll.scrollTop=0,this.offset.top={idx:0,size:0});var d=r>this.prevScroll.scrollTop;a=this.offset.top.size,this.offset.top=this.getRowOffset(r,d),s={cur:this.offset.top,prev:{idx:this.topIndex,size:a},increase:d,preventScroll:e.preventScroll},this.updateTopLeftCell(d),e.preventScroll&&this.offset.top.idx<=this.parent.getThreshold("row")?this.offset.top={idx:0,size:0}:e.skipRowVirualScroll?s.prev.idx=s.cur.idx:(this.parent.notify(Wy,null),this.parent.notify(zx,s),this.updateNoteContainer()),!this.parent.scrollSettings.enableVirtualization&&d&&!this.parent.scrollSettings.isFinite&&this.updateNonVirtualRows(),this.topIndex=s.prev.idx,this.prevScroll.scrollTop=r}var p=!1,f={isEdit:p};if(this.parent.notify(md,f),f.isEdit){var v=this.parent.element.querySelector(".e-formula-bar");v.focus()}this.isKeyScroll=!0}},o.prototype.updateNoteContainer=function(){document.getElementsByClassName("e-addNoteContainer")&&document.getElementsByClassName("e-addNoteContainer").length>0&&this.parent.notify(lI,null)},o.prototype.updateScrollValue=function(e){e.scrollLeft!==void 0&&(this.prevScroll.scrollLeft=e.scrollLeft+(this.prevScroll.scrollLeft-this.offset.left.size),this.offset.left.size=e.scrollLeft),e.scrollTop!==void 0&&(this.prevScroll.scrollTop=e.scrollTop+(this.prevScroll.scrollTop-this.offset.top.size),this.offset.top.size=e.scrollTop)},o.prototype.updateNonVirtualRows=function(){var e=this.parent.getActiveSheet(),t=this.parent.getThreshold("row");this.offset.top.idx>e.rowCount-(this.parent.viewport.rowCount+t)&&(this.parent.renderModule.refreshUI({rowIndex:e.rowCount,colIndex:0,direction:"first",refresh:"RowPart"},et(e.rowCount,0)+":"+et(e.rowCount+t-1,e.colCount-1)),this.parent.setSheetPropertyOnMute(e,"rowCount",e.rowCount+t),this.parent.viewport.bottomIndex=e.rowCount-1)},o.prototype.updateNonVirtualCols=function(){var e=this.parent.getActiveSheet(),t=this.parent.getThreshold("col");this.offset.left.idx>e.colCount-(this.parent.viewport.colCount+t)&&(this.parent.renderModule.refreshUI({rowIndex:0,colIndex:e.colCount,direction:"first",refresh:"ColumnPart"},et(0,e.colCount)+":"+et(e.rowCount-1,e.colCount+t-1)),this.parent.setSheetPropertyOnMute(e,"colCount",e.colCount+t),this.parent.viewport.rightIndex=e.colCount-1)},o.prototype.updateTopLeftCell=function(e,t){var i=this.parent.getActiveSheet(),r=this.offset.top.idx,n=this.offset.left.idx;if(!e){var s=this.parent.frozenRowCount(i);r=se(i,r+s,!0)-s;var a=this.parent.frozenColCount(i);n=se(i,n+a,!0,"columns")-a}t?this.parent.updateTopLeftCell(null,n,"row"):this.parent.updateTopLeftCell(r,null,"col")},o.prototype.getRowOffset=function(e,t){var i=this.offset.top.size,r=this.parent.getActiveSheet(),n=t?this.offset.top.idx+1:this.offset.top.idx?this.offset.top.idx-1:0,s=this.parent.frozenRowCount(r),a=this.parent.scrollSettings.isFinite?r.rowCount:1/0;for(e=Math.round(e);n<a;)if(t){var l=li(r,n-1+s,!0);if(i+=l,Math.abs(Math.round(i)-e)<=1)return{idx:se(r,n+s,!0)-s,size:i};if(Math.round(i)>e)return{idx:n-1,size:i-l};n++}else{var l=li(r,n+s,!0);if(i-=l,i<=0)return{idx:0,size:0};if(Math.abs(Math.round(i)-e)<=1)return{idx:n,size:i};if(Math.round(i)<e)return i+=l,Math.round(i)>e?{idx:n,size:i-l<0?0:i-l}:{idx:se(r,n+1+s,!0)-s,size:i};n--}return{idx:this.offset.top.idx,size:this.offset.top.size}},o.prototype.getColOffset=function(e,t,i){for(var r=this.offset.left.size,n=this.parent.getActiveSheet(),s=t?this.offset.left.idx+1:this.offset.left.idx?this.offset.left.idx-1:0,a=this.parent.frozenColCount(n),l=this.parent.scrollSettings.isFinite?n.colCount:1/0;s<l;)if(t){var h=_r(n,s-1+a,i,!0);if(r+=h,Math.abs(Math.round(r)-e)<=1)return{idx:se(n,s+a,!0,"columns")-a,size:r};if(Math.round(r)>e)return{idx:s-1,size:r-h};s++}else{var h=_r(n,s+a,i,!0);if(r-=h,r<=0)return{idx:0,size:0};if(Math.abs(Math.round(r)-e)<=1)return{idx:s,size:r};if(Math.round(r)<e)return r+=h,Math.round(r)>e?(r=r-h,{idx:s,size:r<0?0:r}):{idx:se(n,s+1+a,!0,"columns")-a,size:r};s--}return{idx:this.offset.left.idx,size:this.offset.left.size}},o.prototype.contentLoaded=function(e){if(!this.parent.scrollSettings.enableVirtualization){var t=this.parent.createElement("div",{className:"e-virtualtrack"});this.updateNonVirualScrollWidth({scrollTrack:t}),this.parent.getScrollElement().appendChild(t)}e.left&&(this.parent.getScrollElement().scrollLeft=e.left),this.setScrollEvent(),this.parent.enableRtl&&(this.initScrollValue=this.parent.getScrollElement().scrollLeft)},o.prototype.updateNonVirualScrollWidth=function(e){e.scrollTrack||(e.scrollTrack=this.parent.getScrollElement().getElementsByClassName("e-virtualtrack")[0]),e.scrollTrack.style.width=Math.abs(this.parent.getContentTable().getBoundingClientRect().width+(this.parent.scrollSettings.isFinite?this.parent.sheetModule.getScrollSize():0))+"px"},o.prototype.onHeaderWheel=function(e){e.preventDefault(),this.parent.getMainContent().parentElement.scrollTop+=e.deltaY,this.parent.getScrollElement().scrollLeft+=e.deltaX},o.prototype.onContentWheel=function(e){e.deltaX!==0&&(e.preventDefault(),this.parent.getScrollElement().scrollLeft+=e.deltaX)},o.prototype.scrollHandler=function(e){this.onContentScroll({scrollLeft:e.target.scrollLeft})},o.prototype.updateScroll=function(e){g(e.left)?this.parent.sheetModule.contentPanel.scrollTop=e.top:this.parent.getScrollElement().scrollLeft=e.left},o.prototype.setScrollEvent=function(){E.add(this.parent.sheetModule.contentPanel,"scroll",this.onContentScroll,this),E.add(this.parent.getColumnHeaderContent(),"wheel",this.onHeaderWheel,this),E.add(this.parent.getSelectAllContent(),"wheel",this.onHeaderWheel,this),E.add(this.parent.getMainContent(),"wheel",this.onContentWheel,this),E.add(this.parent.getRowHeaderContent(),"wheel",this.onContentWheel,this),E.add(this.parent.getScrollElement(),"scroll",this.scrollHandler,this)},o.prototype.initProps=function(){this.topIndex=0,this.leftIndex=0,this.prevScroll={scrollLeft:0,scrollTop:0},this.offset={left:{idx:0,size:0},top:{idx:0,size:0}}},o.prototype.setPadding=function(e){this.parent.sheetModule.contentPanel.style.overflowY="scroll";var t=LO();if(t>0){var i=this.parent.getColumnHeaderContent(),r=this.parent.enableRtl?{margin:"marginLeft",border:"borderLeftWidth"}:{margin:"marginRight",border:"borderRightWidth"};i.parentElement.style[r.margin]=t+"px",i.style[r.border]="1px"}e&&(this.initScrollValue=0)},o.prototype.setClientX=function(e){if(!(e.type==="mousedown"||e.pointerType==="mouse")){var t={touchSelectionStarted:!1};if(this.parent.notify(Wf,t),!(t.touchSelectionStarted||t.isOverlayClicked)){this.clientX=this.getPointX(e);var i=document.getElementById(this.parent.element.id+"_sheet");E.add(i,B.isPointer?"pointermove":"touchmove",this.onTouchScroll,this),E.add(i,B.isPointer?"pointerup":"touchend",this.pointerUpHandler,this)}}},o.prototype.getPointX=function(e){var t=0;return e.touches&&e.touches.length?t=e.touches[0].clientX:t=e.clientX,t},o.prototype.onTouchScroll=function(e){if(e.pointerType!=="mouse"){var t=this.getPointX(e),i=this.clientX-t,r=this.parent.element.getElementsByClassName("e-scroller")[0];(i>10||i<-10)&&r.scrollLeft+i>=0&&(e.preventDefault(),this.clientX=t,cr(function(){r.scrollLeft+=i}))}},o.prototype.pointerUpHandler=function(){var e=document.getElementById(this.parent.element.id+"_sheet");E.remove(e,B.isPointer?"pointermove":"touchmove",this.onTouchScroll),E.remove(e,B.isPointer?"pointerup":"touchend",this.pointerUpHandler)},o.prototype.addEventListener=function(){this.parent.on(In,this.contentLoaded,this),this.parent.on(sI,this.onContentScroll,this),this.parent.on(fb,this.updateScroll,this),this.parent.on(xu,this.initProps,this),this.parent.on(Un,this.destroy,this),this.parent.on(ml,this.setClientX,this),this.parent.on(mb,this.updateScrollValue,this),this.parent.scrollSettings.enableVirtualization||(this.parent.on(Wa,this.updateNonVirualScrollWidth,this),this.parent.on(_n,this.updateNonVirualScrollWidth,this))},o.prototype.destroy=function(){this.removeEventListener();var e=document.querySelector("#"+this.parent.element.id+"_autofilloptionbtn");if(e){var t=at(e,"dropdown-btn");t&&t.destroy()}this.parent=null},o.prototype.removeEventListener=function(){this.parent.off(In,this.contentLoaded),this.parent.off(sI,this.onContentScroll),this.parent.off(fb,this.updateScroll),this.parent.off(xu,this.initProps),this.parent.off(Un,this.destroy),this.parent.off(ml,this.setClientX),this.parent.off(mb,this.updateScrollValue),this.parent.scrollSettings.enableVirtualization||(this.parent.off(Wa,this.updateNonVirualScrollWidth),this.parent.off(_n,this.updateNonVirualScrollWidth))},o}(),Lq=function(){function o(e){this.scroll=[],this.parent=e,this.addEventListener()}return o.prototype.createVirtualElement=function(e){var t=this.parent.getActiveSheet(),i=this.parent.getMainContent();this.content=this.parent.createElement("div",{className:"e-virtualable"}),this.content.appendChild(i.querySelector(".e-table")),i.appendChild(this.content);var r=i.appendChild(this.parent.createElement("div",{className:"e-virtualtrack"})),n=0,s;this.parent.sheets.length>this.scroll.length&&this.initScroll();var a=this.parent.viewport.bottomIndex;t.rowCount>a+1||t.usedRange.rowIndex>a?(!this.parent.scrollSettings.isFinite&&t.rowCount<=t.usedRange.rowIndex&&this.parent.setSheetPropertyOnMute(t,"rowCount",t.usedRange.rowIndex+1),this.setScrollCount(t.rowCount,"row")):(this.parent.scrollSettings.isFinite||this.parent.setSheetPropertyOnMute(t,"rowCount",a+1),this.scroll[this.parent.activeSheetIndex].rowCount=t.rowCount);var l=this.parent.frozenRowCount(t),h=Se(t.topLeftCell);e.top&&(n=e.top,t.frozenRows&&(n+=Ri(t,h[0],l-1,!0)),l=Se(t.paneTopLeftCell)[0]),n+=Ri(t,l,this.scroll[this.parent.activeSheetIndex].rowCount-1,!0),a=this.parent.viewport.rightIndex;var u=0,c=this.parent.frozenColCount(t);e.left?(u=e.left,c&&(u+=Ci(t,h[1],c-1,!0)),l=Se(t.paneTopLeftCell)[1]):l=c,t.colCount>a+1||t.usedRange.colIndex>a?(!this.parent.scrollSettings.isFinite&&t.colCount<=t.usedRange.colIndex&&this.parent.setSheetPropertyOnMute(t,"colCount",t.usedRange.colIndex+1),u+=Ci(t,l,a,!0),this.setScrollCount(t.colCount,"col"),s=u+Ci(t,a+1,this.scroll[this.parent.activeSheetIndex].colCount-1,!0)):(this.parent.scrollSettings.isFinite||this.parent.setSheetPropertyOnMute(t,"colCount",a+1),u+=Ci(t,l,t.colCount-1,!0),this.scroll[this.parent.activeSheetIndex].colCount=t.colCount,s=u),g(this.parent.viewport.leftIndex)&&(this.parent.viewport.leftIndex=0),g(this.parent.viewport.topIndex)&&(this.parent.viewport.topIndex=0),e.left&&(u=Ci(t,this.parent.viewport.leftIndex+c,a,!0)),g(this.translateX)&&(this.translateX=0),g(this.translateY)&&(this.translateY=0),i=this.parent.getRowHeaderContent(),this.rowHeader=this.content.cloneNode(),this.rowHeader.appendChild(i.querySelector(".e-table")),i.appendChild(this.rowHeader);var d=i.appendChild(r.cloneNode());this.rowHeader.style.transform="translate(0px, "+this.translateY+"px)",i=this.parent.getColumnHeaderContent(),this.colHeader=this.content.cloneNode(),this.colHeader.appendChild(i.querySelector(".e-table")),i.appendChild(this.colHeader);var p=i.appendChild(r.cloneNode());if(this.colHeader.style.width=u+"px",d.style.height=n+"px",p.style.width=s+"px",this.colHeader.style.transform="translate("+this.translateX+"px, 0px)",this.content.style.transform="translate("+this.translateX+"px, "+this.translateY+"px)",this.content.style.width=u+"px",r.style.height=n+"px",r.style.width=s+"px",this.parent.allowScrolling){var f=p.cloneNode(!0);f.style.width=s+(this.parent.scrollSettings.isFinite?this.parent.sheetModule.getScrollSize():0)+"px",this.parent.getScrollElement().appendChild(f)}},o.prototype.initScroll=function(){for(var e=0;e<this.parent.sheets.length;)this.scroll[e]||this.scroll.push({rowCount:0,colCount:0}),e++},o.prototype.setScrollCount=function(e,t){var i=this.parent.activeSheetIndex;(!this.scroll[i][t+"Count"]||this.scroll[i][t+"Count"]!==e)&&(this.scroll[i][t+"Count"]=e)},o.prototype.getRowAddress=function(e){var t=this.parent.getActiveSheet();return Be([e[0],t.frozenColumns?Se(t.topLeftCell)[1]:this.parent.viewport.leftIndex,e[1],this.parent.viewport.rightIndex])},o.prototype.getColAddress=function(e){var t=this.parent.getActiveSheet();return Be([t.frozenRows?Se(t.topLeftCell)[0]:this.parent.viewport.topIndex,e[0],this.parent.viewport.bottomIndex,e[1]])},o.prototype.updateScrollCount=function(e,t,i){i===void 0&&(i=e);var r=this.parent.getActiveSheet(),n=e+this.parent.viewport[t+"Count"]+1+i,s=this.scroll[this.parent.activeSheetIndex][t+"Count"];if(n<s){if(r[t+"Count"]===s)return;n=s}this.parent.scrollSettings.isFinite||this.parent.setSheetPropertyOnMute(r,t+"Count",n)},o.prototype.onVerticalScroll=function(e){var t=e.cur.idx,i=e.cur.size,r=e.prev.idx,n=Math.abs(t-r),s=this.parent.getThreshold("row");if(n>Math.round(s/2)){var a=void 0,l=void 0,h=void 0,u=this.parent.getActiveSheet();if(t<=s&&!e.increase){if(this.translateY&&r>s){this.translateY=0;var c=this.parent.frozenColCount(u),d=this.parent.frozenRowCount(u);if(e.preventScroll)this.parent.viewport.topIndex=r-(s-d);else{var p=c?Se(u.topLeftCell)[1]:this.parent.viewport.leftIndex,f=c?[d,this.parent.viewport.leftIndex+c]:[];if(n<this.parent.viewport.rowCount+s){a=se(u,d,!0),l=se(u,this.parent.viewport.topIndex+d-1,!1),this.parent.viewport.topIndex=a-d;var v=this.skipHiddenLastIdx(this.parent.viewport.bottomIndex-(l-a+1-this.hiddenCount(a,l)),this.parent.viewport.bottomIndex);this.parent.viewport.bottomIndex=se(u,v,!1),this.parent.renderModule.refreshUI({colIndex:p,rowIndex:a,direction:"last",refresh:"RowPart",skipUpdateOnFirst:!0,frozenIndexes:f},this.getRowAddress([a,se(u,l,!1)]))}else{var m=this.parent.viewport.leftIndex;this.parent.renderModule.refreshUI({rowIndex:0,colIndex:p,refresh:"Row",skipUpdateOnFirst:!0,frozenIndexes:f,skipTranslate:!0}),c&&(this.parent.viewport.leftIndex=m),this.translate({refresh:"Row"})}Fe(this.parent.element),t=0}}this.updateScrollCount(s,"row")}if(r<s&&(n=Math.abs(t-s)),!e.increase&&this.parent.scrollSettings.isFinite&&this.parent.viewport.bottomIndex===se(u,u.rowCount-1,!1)){var d=this.parent.frozenRowCount(u),y=this.parent.viewport.topIndex+d+J(u.paneTopLeftCell)[0]-1;if(t+d>y){e.prev.idx=t;return}n=y-(t+d)}if(t>s){if(h=this.parent.viewport.topIndex,this.parent.viewport.topIndex=t-s,e.increase&&h>this.parent.viewport.topIndex){this.parent.viewport.topIndex=h;return}var d=this.parent.frozenRowCount(u);if(e.preventScroll)this.setThresholdHeight(i,s,d),this.translate({refresh:"Row"});else{var c=this.parent.frozenColCount(u),p=void 0,S=[];if(c?(p=Se(u.topLeftCell)[1],S.push(d),S.push(this.parent.viewport.leftIndex+c)):p=this.parent.viewport.leftIndex,n<this.parent.viewport.rowCount+s)if(e.increase){if(a=this.parent.viewport.bottomIndex+1,l=this.parent.viewport.bottomIndex+(this.parent.viewport.topIndex-h),l-=this.hiddenCount(h+d,this.parent.viewport.topIndex-1+d),l<=this.parent.viewport.bottomIndex||this.parent.scrollSettings.isFinite&&a>se(u,u.rowCount-1,!1,"rows")){this.parent.viewport.topIndex=h;return}var b=this.parent.skipHidden(a,l,"rows",!1),w=this.checkLastIdx(b[1],"row");a=b[0],l=w.index;var I=this.parent.viewport.topIndex+d;if(w.diff){var x=l-a+1-this.hiddenCount(a,l);I=se(u,h,!0,"rows",x)+d}this.parent.viewport.topIndex=se(u,I,!w.diff)-d,this.setThresholdHeight(i,t-this.parent.viewport.topIndex,d,!!w.diff,h===se(u,d,!0)),this.parent.viewport.bottomIndex=l,this.parent.renderModule.refreshUI({colIndex:p,rowIndex:a,direction:"first",refresh:"RowPart",frozenIndexes:S},this.getRowAddress([a,l]))}else{if(a=se(u,this.parent.viewport.topIndex+d,!1),a<d&&(a=d,a=se(u,a,!0)),this.parent.viewport.topIndex=a-d,l=se(u,h+d-1,!1),l<d||l<a){this.parent.viewport.topIndex=h;return}var v=this.skipHiddenLastIdx(this.parent.viewport.bottomIndex-(l-a+1-this.hiddenCount(a,l)),this.parent.viewport.bottomIndex);this.parent.viewport.bottomIndex=se(u,v,!1),this.setThresholdHeight(i,t-this.parent.viewport.topIndex,d),this.parent.renderModule.refreshUI({colIndex:p,rowIndex:a,direction:"last",refresh:"RowPart",frozenIndexes:S},this.getRowAddress([a,l]))}else h=this.parent.viewport.leftIndex,this.parent.viewport.topIndex=se(u,this.parent.viewport.topIndex+d,!1)-d,this.parent.viewport.topIndex<0&&(this.parent.viewport.topIndex=se(u,d,!0)-d),this.parent.renderModule.refreshUI({rowIndex:this.parent.viewport.topIndex,colIndex:p,refresh:"Row",frozenIndexes:S,skipTranslate:!0}),c&&(this.parent.viewport.leftIndex=h),this.setThresholdHeight(i,t-this.parent.viewport.topIndex,d,this.parent.scrollSettings.isFinite&&this.parent.viewport.bottomIndex===se(u,u.rowCount-1,!1)),this.translate({refresh:"Row"});this.updateScrollCount(t,"row",s),this.focusSheet()}}e.prev.idx=t}},o.prototype.skipHiddenLastIdx=function(e,t,i){i===void 0&&(i="rows");for(var r=this.parent.getActiveSheet(),n=0,s=e;s<=t;s++)r[""+i][s]&&r[""+i][s].hidden&&n++;return n&&(e=this.skipHiddenLastIdx(e-n,e-1,i)),e},o.prototype.hiddenCount=function(e,t,i){i===void 0&&(i="rows");for(var r=0,n=this.parent.getActiveSheet(),s=e;s<=t;s++)n[""+i][s]&&n[""+i][s].hidden&&r++;return r},o.prototype.checkLastIdx=function(e,t){var i=0;if(this.parent.scrollSettings.isFinite){var r=this.parent.getActiveSheet(),n=se(r,r[t+"Count"]-1,!1,t==="col"?"columns":"rows");e>n&&(i=e-n,e=n)}return{index:e,diff:i}},o.prototype.onHorizontalScroll=function(e){var t=e.cur.idx,i=e.cur.size,r=e.prev.idx,n=Math.abs(t-r),s=this.parent.getThreshold("col");if(n>Math.round(s/2)){var a=void 0,l=void 0,h=void 0,u=this.parent.getActiveSheet();if(t<=s&&!e.increase){if(this.translateX&&r>s){this.translateX=0;var c=this.parent.frozenColCount(u),d=this.parent.frozenRowCount(u);if(e.preventScroll)this.parent.viewport.leftIndex=r-(s-c);else{var p=d?Se(u.topLeftCell)[0]:this.parent.viewport.topIndex,f=d?[this.parent.viewport.topIndex+d,c]:[];if(n<this.parent.viewport.colCount+s){a=se(u,c,!0,"columns"),l=se(u,this.parent.viewport.leftIndex+c-1,!1,"columns"),this.parent.viewport.leftIndex=a-c;var v=this.skipHiddenLastIdx(this.parent.viewport.rightIndex-(l-a+1-this.hiddenCount(a,l,"columns")),this.parent.viewport.rightIndex,"columns");this.parent.viewport.rightIndex=se(u,v,!1,"columns"),this.parent.renderModule.refreshUI({rowIndex:p,colIndex:a,direction:"last",refresh:"ColumnPart",skipUpdateOnFirst:!0,frozenIndexes:f},this.getColAddress([a,se(u,l,!1,"columns")]))}else{var m=this.parent.viewport.topIndex;this.parent.renderModule.refreshUI({rowIndex:p,colIndex:0,refresh:"Column",skipUpdateOnFirst:!0,frozenIndexes:f,skipTranslate:!0}),d&&(this.parent.viewport.topIndex=m),this.translate({refresh:"Column"})}Fe(this.parent.element),t=0}}this.updateScrollCount(s,"col")}if(r<s&&(n=Math.abs(t-s)),!e.increase&&this.parent.scrollSettings.isFinite&&this.parent.viewport.rightIndex===se(u,u.colCount-1,!1,"columns")){var c=this.parent.frozenColCount(u),y=this.parent.viewport.leftIndex+c+J(u.paneTopLeftCell)[1]-1;if(y+=this.hiddenCount(this.parent.viewport.leftIndex+c,y),t+c>y){e.prev.idx=t;return}n=y-(t+c)}if(t>s){if(h=this.parent.viewport.leftIndex,this.parent.viewport.leftIndex=t-s,e.increase&&h>this.parent.viewport.leftIndex){this.parent.viewport.leftIndex=h;return}var c=this.parent.frozenColCount(u);if(e.preventScroll)this.setThresholdWidth(i,s,c),this.translate({refresh:"Column"});else{var d=this.parent.frozenRowCount(u),p=d?Se(u.topLeftCell)[0]:this.parent.viewport.topIndex,S=[];if(d&&(S=[d+this.parent.viewport.topIndex,c]),n<this.parent.viewport.colCount+s)if(e.increase){if(a=this.parent.viewport.rightIndex+1,l=this.parent.viewport.rightIndex+(this.parent.viewport.leftIndex-h),l-=this.hiddenCount(h+c,this.parent.viewport.leftIndex-1+c,"columns"),l<=this.parent.viewport.rightIndex||this.parent.scrollSettings.isFinite&&a>se(u,u.colCount-1,!1,"columns")){this.parent.viewport.leftIndex=h;return}var b=this.parent.skipHidden(a,l,"columns",!1),w=this.checkLastIdx(b[1],"col");a=b[0],l=w.index,this.parent.viewport.leftIndex=se(u,this.parent.viewport.leftIndex-w.diff+c,!w.diff,"columns")-c,this.setThresholdWidth(i,t-this.parent.viewport.leftIndex,c,!!w.diff,h===se(u,c,!0,"columns")),this.parent.viewport.rightIndex=l,this.parent.renderModule.refreshUI({rowIndex:p,colIndex:a,direction:"first",refresh:"ColumnPart",frozenIndexes:S},this.getColAddress([a,l]))}else{if(a=se(u,this.parent.viewport.leftIndex+c,!1,"columns"),a<c&&(a=c,a=se(u,a,!0,"columns")),this.parent.viewport.leftIndex=a-c,l=se(u,h+c-1,!1,"columns"),l<c||l<a){this.parent.viewport.leftIndex=h;return}var v=this.skipHiddenLastIdx(this.parent.viewport.rightIndex-(l-a+1-this.hiddenCount(a,l,"columns")),this.parent.viewport.rightIndex,"columns");this.parent.viewport.rightIndex=se(u,v,!1,"columns"),this.setThresholdWidth(i,t-this.parent.viewport.leftIndex,c),this.parent.renderModule.refreshUI({rowIndex:p,colIndex:a,direction:"last",refresh:"ColumnPart",frozenIndexes:S},this.getColAddress([a,l]))}else h=this.parent.viewport.topIndex,this.parent.viewport.leftIndex=se(u,this.parent.viewport.leftIndex+c,!1,"columns")-c,this.parent.viewport.leftIndex<0&&(this.parent.viewport.leftIndex=se(u,c,!0,"columns")-c),this.parent.renderModule.refreshUI({rowIndex:p,colIndex:this.parent.viewport.leftIndex,refresh:"Column",frozenIndexes:S,skipTranslate:!0}),d&&(this.parent.viewport.topIndex=h),this.setThresholdWidth(i,t-this.parent.viewport.leftIndex,c,this.parent.scrollSettings.isFinite&&this.parent.viewport.rightIndex===se(u,u.colCount-1,!1,"columns")),this.translate({refresh:"Column"});this.updateScrollCount(t,"col",s),this.focusSheet()}}e.prev.idx=t}},o.prototype.focusSheet=function(){(!document.activeElement.classList.contains("e-text-findNext-short")||!j(document.activeElement,"#"+this.parent.element.id))&&Fe(this.parent.element)},o.prototype.setThresholdHeight=function(e,t,i,r,n){var s=this.parent.getActiveSheet(),a=this.parent.viewport.topIndex+i,l=a+t-1;r||n||l<a?this.translateY=a<=i?0:Ri(s,i,a-1,!0):this.translateY=e-Ri(s,a,l,!0)},o.prototype.setThresholdWidth=function(e,t,i,r,n){var s=this.parent.getActiveSheet(),a=this.parent.viewport.leftIndex+i,l=a+t-1;r||n||l<a?this.translateX=a<=i?0:Ci(s,i,a-1,!0):this.translateX=e-Ci(s,a,l,!0)},o.prototype.translate=function(e){if(!(e.skipTranslate||!this.content)){var t=this.translateX||0;t=this.parent.enableRtl?-t:t,(e.refresh==="Row"||e.refresh==="RowPart")&&(this.content.style.transform="translate("+t+"px, "+this.translateY+"px)",this.rowHeader.style.transform="translate(0px, "+this.translateY+"px)"),(e.refresh==="Column"||e.refresh==="ColumnPart")&&(this.content.style.transform="translate("+t+"px, "+this.translateY+"px)",this.colHeader.style.transform="translate("+t+"px, 0px)")}},o.prototype.updateColumnWidth=function(e){if(e.refresh==="Column"){this.content.style.width="";var t=this.parent.getActiveSheet(),i=Ci(t,this.parent.viewport.leftIndex+this.parent.frozenColCount(t),this.parent.viewport.rightIndex,!0);if(this.colHeader.style.width=i+"px",this.content.style.width=i+"px",!this.parent.scrollSettings.isFinite||e.isUpdate){var r=this.parent.element.querySelector(".e-scroller .e-virtualtrack");if(!r)return;var n=parseInt(r.style.width,10),s=i+this.translateX+this.parent.viewport.beforeFreezeWidth;if(s>n){var a=s-n;r.style.width=n+a+"px"}else{var a=n-s,l=this.parent.getMainContent().getElementsByClassName("e-virtualtrack")[0];n-a<parseInt(l.style.width,10)&&(r.style.width=l.style.width)}}}else if(!this.parent.scrollSettings.isFinite){var l=this.parent.getMainContent().getElementsByClassName("e-virtualtrack")[0],h=parseInt(l.style.height,10),u=this.content.getBoundingClientRect().height,c=u+this.translateY+this.parent.viewport.beforeFreezeHeight;if(c>h){var a=c-h;l.style.height=h+a+"px"}else{var a=h-c,d=this.parent.getRowHeaderContent().getElementsByClassName("e-virtualtrack")[0];h-a<parseInt(d.style.height,10)&&(l.style.height=d.style.height)}}},o.prototype.updateRowColCount=function(e){if(this.scroll.length){var t=this.parent.getActiveSheet();if(e.update==="row"){if(e.index!==this.scroll[this.parent.activeSheetIndex].rowCount-1){var i=this.getVTrackHeight("height"),r=i;if(e.index>=this.scroll[this.parent.activeSheetIndex].rowCount?e.start===void 0?r+=Ri(t,this.scroll[this.parent.activeSheetIndex].rowCount,e.index,!0):r+=Ri(t,e.start,e.end,!0):e.start===void 0?r-=Ri(t,e.index+1,this.scroll[this.parent.activeSheetIndex].rowCount-1,!0):r-=Ri(t,e.start,e.end,!0),!e.isDelete&&r<i)return;this.scroll[this.parent.activeSheetIndex].rowCount=e.index+1,this.updateVTrack(this.rowHeader,r,"height"),this.scroll[this.parent.activeSheetIndex].rowCount>t.rowCount&&this.parent.setSheetPropertyOnMute(t,"rowCount",this.scroll[this.parent.activeSheetIndex].rowCount)}}else if(e.index!==this.scroll[this.parent.activeSheetIndex].colCount-1){var n=this.getVTrackHeight("width"),s=n;if(e.index>=this.scroll[this.parent.activeSheetIndex].colCount?e.start===void 0?s+=Ci(t,this.scroll[this.parent.activeSheetIndex].colCount,e.index,!0):s+=Ci(t,e.start,e.end,!0):e.start===void 0?s-=Ci(t,e.index+1,this.scroll[this.parent.activeSheetIndex].colCount-1,!0):s-=Ci(t,e.start,e.end,!0),!e.isDelete&&s<n)return;this.scroll[this.parent.activeSheetIndex].colCount=e.index+1,this.updateVTrack(this.colHeader,s,"width"),this.scroll[this.parent.activeSheetIndex].colCount>t.colCount&&this.parent.setSheetPropertyOnMute(t,"colCount",this.scroll[this.parent.activeSheetIndex].colCount)}}},o.prototype.getVTrackHeight=function(e){var t=this.content.nextElementSibling.style[""+e];if(t.includes("e+")){t=t.split("px")[0];var i=t.split("e+");return Number(i[0])*Math.pow(10,Number(i[1]))}else return parseFloat(t)},o.prototype.updateVTrackHeight=function(e){var t=this.parent.frozenRowCount(this.parent.getActiveSheet());if(e.rowIdx<this.scroll[this.parent.activeSheetIndex].rowCount&&this.updateVTrack(this.rowHeader,this.getVTrackHeight("height")+e.threshold,"height"),e.rowIdx>=t&&e.rowIdx<this.parent.scrollModule.offset.top.idx+t){var i=this.parent.element.getElementsByClassName("e-main-panel")[0];i&&(this.parent.scrollModule.prevScroll.scrollTop=i.scrollTop+e.threshold,i.scrollTop+=e.threshold),this.parent.scrollModule.offset.top.size+=e.threshold,e.rowIdx<this.parent.viewport.topIndex+t&&(this.translateY+=e.threshold,this.translate({refresh:"Row"}))}},o.prototype.updateVTrackWidth=function(e){if(!Ot(this.parent.getActiveSheet(),e.colIdx)){var t=this.parent.frozenColCount(this.parent.getActiveSheet());if(e.colIdx>=this.parent.viewport.leftIndex+t&&e.colIdx<=this.parent.viewport.rightIndex){var i=this.parent.getColumnHeaderContent().getElementsByClassName("e-virtualtrack")[0];i.style.width=parseFloat(i.style.width)+e.threshold+"px";var r=this.parent.getMainContent().getElementsByClassName("e-virtualtrack")[0];r.style.width=parseFloat(r.style.width)+e.threshold+"px";var n=this.parent.getScrollElement().getElementsByClassName("e-virtualtrack")[0];n.style.width=parseFloat(n.style.width)+e.threshold+"px";var s=this.parent.getColumnHeaderContent().getElementsByClassName("e-virtualable")[0];s.style.width=parseFloat(s.style.width)+e.threshold+"px";var a=this.parent.getMainContent().getElementsByClassName("e-virtualable")[0];a.style.width=parseFloat(a.style.width)+e.threshold+"px"}else e.colIdx>=t&&e.colIdx<this.parent.viewport.leftIndex+t&&(this.parent.scrollModule.offset.left.size+=e.threshold,this.translateX+=e.threshold,this.translate({refresh:"Column"}))}},o.prototype.updateVTrack=function(e,t,i){e.nextElementSibling.style[""+i]=t+"px",this.content.nextElementSibling.style[""+i]=t+"px",i==="width"&&this.parent.allowScrolling&&(this.parent.getScrollElement().firstElementChild.style.width=t+"px")},o.prototype.deInitProps=function(){this.parent.viewport.leftIndex=null,this.parent.viewport.topIndex=null,this.parent.viewport.bottomIndex=null,this.translateX=null,this.translateY=null},o.prototype.updateScrollProps=function(e){var t=this;e===void 0&&(e={sheetIndex:0,sheets:this.parent.sheets}),this.scroll.length===0?this.initScroll():e.sheets.forEach(function(){t.scroll.splice(e.sheetIndex,0,{rowCount:0,colCount:0})})},o.prototype.sliceScrollProps=function(e){g(e.sheetIndex)?this.scroll.length=0:this.scroll.splice(e.sheetIndex,1)},o.prototype.updateTranslate=function(e){if(e.height){if(e.isRender)this.translateY-=e.height;else{var t=parseInt(this.parent.getMainContent().getElementsByClassName("e-virtualtrack")[0].style.height,10);e.isHide?(this.updateVTrack(this.rowHeader,t-e.height,"height"),this.setThresholdHeight(this.translateY,e.prevSize-1-this.parent.viewport.topIndex+1,this.parent.frozenRowCount(this.parent.getActiveSheet()))):(this.updateVTrack(this.rowHeader,t+e.height,"height"),this.translateY=this.translateY+e.size)}this.translate({refresh:"Row"})}e.width&&(this.translateX-=e.width,this.translate({refresh:"Column"}))},o.prototype.addEventListener=function(){this.parent.on(Hx,this.createVirtualElement,this),this.parent.on(Vx,this.translate,this),this.parent.on(Wa,this.updateColumnWidth,this),this.parent.on(EI,this.updateColumnWidth,this),this.parent.on(zx,this.onVerticalScroll,this),this.parent.on(jx,this.onHorizontalScroll,this),this.parent.on(sd,this.updateRowColCount,this),this.parent.on(An,this.updateVTrackHeight,this),this.parent.on(_n,this.updateVTrackWidth,this),this.parent.on(xu,this.deInitProps,this),this.parent.on(ma,this.sliceScrollProps,this),this.parent.on(xf,this.updateScrollProps,this),this.parent.on(hu,this.updateTranslate,this),this.parent.on(Un,this.destroy,this)},o.prototype.destroy=function(){this.removeEventListener();var e=document.querySelectorAll(".e-addNoteIndicator");e&&e.forEach(function(t){t.remove()}),this.rowHeader&&(_a(this.rowHeader),this.rowHeader.remove()),this.colHeader&&(_a(this.colHeader),this.colHeader.remove()),this.content&&(_a(this.content),this.content.remove()),this.rowHeader=null,this.colHeader=null,this.content=null,this.parent=null,this.scroll.length=0,this.translateX=null,this.translateY=null},o.prototype.removeEventListener=function(){this.parent.off(Hx,this.createVirtualElement),this.parent.off(Vx,this.translate),this.parent.off(Wa,this.updateColumnWidth),this.parent.off(EI,this.updateColumnWidth),this.parent.off(zx,this.onVerticalScroll),this.parent.off(jx,this.onHorizontalScroll),this.parent.off(sd,this.updateRowColCount),this.parent.off(An,this.updateVTrackHeight),this.parent.off(_n,this.updateVTrackWidth),this.parent.off(ma,this.sliceScrollProps),this.parent.off(xf,this.updateScrollProps),this.parent.off(hu,this.updateTranslate),this.parent.off(Un,this.destroy)},o}(),jO=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on($a,this.keyDownHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off($a,this.keyDownHandler)},o.prototype.keyDownHandler=function(e){var t=this,i=e.target,r=this.parent.enableRtl,n=this.parent.enableKeyboardShortcut;if(e.altKey&&(e.keyCode===38||e.keyCode===40)&&!n){e.preventDefault();return}if(e.altKey&&e.keyCode===38&&this.parent.element.lastElementChild.classList.contains("e-filter-popup")){this.parent.notify(ib,{closePopup:!0});return}if(this.parent.allowPrint&&e.ctrlKey&&e.keyCode===80&&n){e.preventDefault(),this.parent.print();return}var s=e.target;if(!g(s)&&s.classList.contains("e-addNoteContainer")){if(e.key==="Escape"||e.keyCode===27){var a=!g(this.parent.spreadsheetNoteModule.noteCellIndexes),l=a?this.parent.spreadsheetNoteModule.noteCellIndexes:Se(this.parent.getActiveSheet().activeCell),h=G(l[0],l[1],this.parent.getActiveSheet()),u=this.parent.getCell(l[0],l[1]),c=Vn(this.parent,this.parent.activeSheetIndex)+"!"+Be(l);if(!g(s)&&!g(s.value)&&(g(h)||g(h.notes)||h.notes!==s.value)&&document.activeElement.className.indexOf("e-addNoteContainer")>-1){var d=!g(h)&&h.notes?"editNote":"addNote";this.parent.notify(hh,{args:{action:"beforeCellSave",eventArgs:{address:c}}}),sr(this.parent,this.parent.getActiveSheet(),{rowIdx:l[0],colIdx:l[1],preventEvt:!0,cell:{notes:s.value,isNoteEditable:!1}});var p={notes:s.value,address:c};this.parent.notify(mt,{eventArgs:p,action:d})}this.parent.spreadsheetNoteModule.isShowNote=null,this.parent.notify(iu,""),Fe(u)}return}var f=this.parent.serviceLocator.getService(jt).dialogInstance,v=i.id===this.parent.element.id+"_name_box";if(this.parent.selectionSettings.mode==="None"||f||this.parent.isEdit||i.classList.contains("e-ss-ddb")&&e.keyCode!==117&&e.keyCode!==9||v&&e.keyCode!==117||i.classList.contains("e-sheet-rename")||i.id===this.parent.element.id+"_SearchBox"||i.classList.contains("e-chk-hidden")||i.classList.contains("e-ddl")&&i.classList.contains("e-input-focus")){if(f){if(e.keyCode===13)f.element.classList.contains("e-spreadsheet-function-dlg")&&(i.classList.contains("e-formula-list")||i.classList.contains("e-list-item"))&&Fe(f.element.querySelector(".e-footer-content .e-primary"));else if(e.keyCode===9){if(f.element.classList.contains("e-find-dlg")){var m=f.element.querySelectorAll(".e-footer-content .e-btn:not(:disabled)"),y=m.length?m[m.length-1].className:"e-findnreplace-checkmatch";if(e.shiftKey){if(document.activeElement.classList.contains("e-dlg-closeicon-btn"))if(e.preventDefault(),m.length)Fe(m[m.length-1]);else{var S=f.element.querySelector(".e-findnreplace-exactmatchcheckbox");S&&(Fe(S.querySelector(".e-findnreplace-checkmatch")),S.classList.add("e-focus"))}}else document.activeElement.className.includes(y)&&Fe(f.element)}else if(f.element.classList.contains("e-protect-dlg")){if(e.shiftKey?document.activeElement.classList.contains("e-primary"):document.activeElement.id===this.parent.element.id+"_protect_check"){var b=f.element.querySelector(".e-protect-option-list");if(b&&!b.querySelector(".e-list-item.e-focused")){var w=b.querySelector(".e-list-item");w&&w.classList.add("e-focused")}}}else if(f.element.classList.contains("e-custom-format-dlg"))if(e.shiftKey){if(document.activeElement.className.includes("e-list-item e-active")){var b=j(document.activeElement,".e-custom-listview");b&&Fe(b)}}else if(document.activeElement.classList.contains("e-btn")&&document.activeElement.parentElement.classList.contains("e-custom-dialog")){var b=f.element.querySelector(".e-custom-listview"),I=at(b,"listview");if(b){var w=b.querySelector(".e-list-item.e-active");if(!w)if(w=b.querySelector(".e-list-item"),w)I.selectItem(w);else return;e.preventDefault(),w.focus()}}else document.activeElement.classList.contains("e-list-item")&&Fe(f.element);else if(f.element.classList.contains("e-spreadsheet-function-dlg")){if(e.shiftKey&&document.activeElement.className.includes("e-list-item e-active")){var b=j(document.activeElement,".e-formula-list");b&&Fe(b)}}else if(f.element.classList.contains("e-goto-dlg")&&!f.element.classList.contains("e-dlg-modal"))if(e.shiftKey){if(document.activeElement.className.includes("e-dlg-closeicon-btn")){var x=f.element.querySelector(".e-footer-content .e-btn");x&&(e.preventDefault(),Fe(x))}}else document.activeElement.className.includes("e-btn-goto-ok")&&Fe(f.element)}}else v&&e.keyCode===9&&e.shiftKey&&this.focusEle(e,".e-formula-bar",!1,!0);var p={action:"getCurrentEditValue",editedValue:""};this.parent.notify(fi,p);var M=ut(p.editedValue,!0);this.parent.isEdit&&M&&e.shiftKey&&!e.ctrlKey&&uu(e.keyCode)&&this.shiftSelection(e);return}var D=this.parent.getActiveSheet(),A=Se(D.activeCell);if(e.altKey){if(e.keyCode===40){if(i.classList.contains("e-dropdown-btn")||i.classList.contains("e-split-btn"))return;var L={e,isFilterCell:!1};if(this.parent.notify(ib,L),L.isFilterCell)return}if(e.keyCode===40&&!document.getElementById(this.parent.element.id+"listValid_popup")){var h=this.parent.getCell(A[0],A[1]);if(h){var T=h.querySelector(".e-validation-list .e-ddl");if(T){Fe(T);var k=T.querySelector(".e-dropdownlist")||T,I=at(k,"dropdownlist");I&&I.showPopup();return}}}}i.id===this.parent.element.id+"_File"&&Fe(this.parent.element);var F=i.classList.contains("e-add-sheet-tab")||i.classList.contains("e-sheets-list")||i.classList.contains("e-tab-wrap")&&!!j(i,".e-sheet-tabs-items")||i.classList.contains("e-aggregate-list")||i.classList.contains("e-scroll-nav");[9,37,38,39,40,33,34,35,36].indexOf(e.keyCode)>-1&&!F&&e.preventDefault();var R,N=J(D.selectedRange);if(e.keyCode===36){var P=this.parent.frozenColCount(D),O=void 0;if(e.ctrlKey||e.metaKey){var z=se(D,this.parent.frozenRowCount(D),!0);e.shiftKey?O=[A[0],A[1],z,se(D,P,!0,"columns")]:(O=[z,se(D,P,!0,"columns"),z],O[3]=O[1]);var H=this.parent.element.querySelector(".e-main-panel");H.scrollTop&&(H.scrollTop=0);var Q=this.parent.getScrollElement();Q.scrollLeft&&(Q.scrollLeft=0)}else if(e.shiftKey){var $=se(D,P,!0,"columns");D.frozenColumns&&se(D,A[1],!0,"columns")===$?O=[N[0],A[1],N[2],se(D,0,!0,"columns")]:O=[N[0],A[1],N[2],$],this.scrollNavigation([O[2],O[3]],!0)}else{var $=se(D,P,!0,"columns");D.frozenColumns&&($===A[1]||P===A[1])&&($=se(D,0,!0,"columns")),O=[A[0],$,A[0],$],this.scrollNavigation([O[0],O[1]],!0)}this.updateSelection(D,O,e)}else if(e.ctrlKey||e.metaKey){if(e.keyCode===35){e.preventDefault();var U=se(D,D.usedRange.rowIndex,!1);U=U>-1?U:D.usedRange.rowIndex;var ie=se(D,D.usedRange.colIndex,!1,"columns");ie=ie>-1?ie:D.usedRange.colIndex,e.shiftKey||(A[0]=U,A[1]=ie),A[2]=U,A[3]=ie,this.updateSelection(D,A.concat(A),e),this.scrollNavigation([U,ie],!0)}else e.keyCode===32&&!e.shiftKey&&n&&(N[0]=0,N[2]=D.rowCount-1,this.updateSelection(D,N,{shiftKey:!0}));if(e.keyCode===40||e.keyCode===39||e.keyCode===38||e.keyCode===37)e.shiftKey?(e.keyCode===40?N[2]=this.getNextNonEmptyCell(N[2],A[1],"down"):e.keyCode===39&&!r||e.keyCode===37&&r?N[3]=this.getNextNonEmptyCell(A[0],N[3],"right"):e.keyCode===38?N[2]=this.getNextNonEmptyCell(N[2],A[1],"top"):N[3]=this.getNextNonEmptyCell(A[0],N[3],"left"),this.updateSelection(D,N,e),this.scrollNavigation([N[2],N[3]],!0)):(e.keyCode===37&&!r||e.keyCode===39&&r?A[1]=this.getNextNonEmptyCell(A[0],A[1],"left"):e.keyCode===38?A[0]=this.getNextNonEmptyCell(A[0],A[1],"top"):e.keyCode===39&&!r||e.keyCode===37&&r?A[1]=this.getNextNonEmptyCell(A[0],A[1],"right"):A[0]=this.getNextNonEmptyCell(A[0],A[1],"down"),this.parent.selectRange(Be(A)),this.scrollNavigation([A[0],A[1]],!0));else if(e.keyCode===117){var ne=document.activeElement;ne.classList.contains("e-spreadsheet")||j(ne,".e-sheet")?this.setFocus("Sheet",e,!0):F?this.setFocus("SheetTabs",e):j(ne,".e-ribbon")?this.setFocus("Ribbon",e):(v||ne.classList.contains("e-insert-function"))&&this.setFocus("FormulaBar",e)}}else{if(e.shiftKey){if(e.keyCode===32&&n&&(e.preventDefault(),N[1]=0,N[3]=D.colCount-1,this.updateSelection(D,N,e)),this.shiftSelection(e),(e.keyCode===34||e.keyCode===33)&&this.parent.scrollModule&&this.parent.scrollModule.isKeyScroll){var te=0,H=this.parent.element.querySelector(".e-main-panel"),oe=se(D,Se(D.paneTopLeftCell)[0],!0),ae=rd(this.parent,oe).height;if(e.keyCode===34){if(te=ae+this.parent.scrollModule.offset.top.size,!this.parent.scrollSettings.isFinite){var ye=this.parent.getMainContent().querySelector(".e-virtualtrack");ye&&parseFloat(ye.style.height)<te+ae&&(ye.style.height=te+ae+"px")}}else if(te=this.parent.scrollModule.offset.top.size-ae,Math.round(te)<0)if(H.scrollTop)te=0;else{this.parent.selectRange(Be([N[0],N[1],oe,N[3]]));return}var De=se(D,J(D.selectedRange)[2],!0),ve=oe>De?0:De-oe;this.parent.scrollModule&&H.scrollTop&&(this.parent.scrollModule.isKeyScroll=!1),H.scrollTop=te,cr(function(){e.keyCode===34?(N[2]=se(D,Se(D.paneTopLeftCell)[0]+ve,!0),t.parent.scrollSettings.isFinite&&N[2]>D.rowCount-1&&(N[2]=se(D,D.rowCount-1,!1),N[2]=N[2]<0?0:N[2])):(N[2]=se(D,Se(D.paneTopLeftCell)[0]+ve,!1),N[2]=N[2]<0?0:N[2]),t.updateSelection(D,N,e)})}}else if(e.keyCode===9||(this.parent.enableRtl?e.keyCode===37:e.keyCode===39)){var h=G(A[0],A[1],D);if(h&&h.colSpan>1&&(A[1]+=h.colSpan-1),A[1]<D.colCount-1&&(!D.isProtected||D.protectSettings.selectCells))A[1]+=1,R=!0;else if(D.protectSettings.selectUnLockedCells){var ue=this.getNextUnlockedCell("right",A);R=A[1]!==ue[1]||A[0]!==ue[0],A[1]=ue[1],A[0]=ue[0]}}else if(e.keyCode===13||e.keyCode===40){var h=G(A[0],A[1],D);if(h&&h.rowSpan>1&&(A[0]+=h.rowSpan-1),A[0]<D.rowCount-1&&(!D.isProtected||D.protectSettings.selectCells))R=!0,A[0]+=1;else if(D.protectSettings.selectUnLockedCells){var ue=this.getNextUnlockedCell("down",A);R=A[0]!==ue[0]||A[1]!==ue[1],A[1]=ue[1],A[0]=ue[0]}}else if((e.keyCode===34||e.keyCode===33)&&this.parent.scrollModule&&this.parent.scrollModule.isKeyScroll){var H=this.parent.element.querySelector(".e-main-panel"),te=0,Tt=se(D,Se(D.paneTopLeftCell)[0],!0),_e=se(D,Se(D.activeCell)[0],!0),ae=rd(this.parent,Tt).height;if(e.keyCode===34){if(te=this.parent.scrollModule.offset.top.size+ae,!this.parent.scrollSettings.isFinite){var ye=this.parent.getMainContent().querySelector(".e-virtualtrack");ye&&parseFloat(ye.style.height)<te+ae&&(ye.style.height=te+ae+"px")}}else{if(te=this.parent.scrollModule.offset.top.size-ae,D.frozenRows&&A[0]<this.parent.frozenRowCount(D)){this.parent.selectRange(Be([Tt,N[1],Tt,N[1]]));return}if(Math.round(te)<0)if(H.scrollTop)te=0;else return}var lt=Tt>_e?0:_e-Tt;this.parent.scrollModule&&H.scrollTop&&(this.parent.scrollModule.isKeyScroll=!1),H.scrollTop=te,cr(function(){var Te;e.keyCode===34?(Te=se(D,Se(D.paneTopLeftCell)[0]+lt,!0),t.parent.scrollSettings.isFinite&&Te>D.rowCount-1&&(Te=se(D,D.rowCount-1,!1),Te=Te<0?0:Te)):(Te=Se(D.paneTopLeftCell)[0]+lt,Te-=t.parent.hiddenCount(Tt,_e),Te=se(D,Te,!1),Te=Te<0?0:Te),t.parent.notify(Jh,{range:[Te,A[1],Te,A[1]],preventAnimation:!0})})}if(e.shiftKey?e.keyCode===9:this.parent.enableRtl?e.keyCode===39:e.keyCode===37){if(A[1]>0&&(!D.isProtected||D.protectSettings.selectCells))A[1]-=1,R=!0;else if(D.protectSettings.selectUnLockedCells){var ue=this.getNextUnlockedCell("left",A);R=A[1]!==ue[1]||A[0]!==ue[0],A[1]=ue[1],A[0]=ue[0]}if(A[1]<=0){var We=this.parent.getMainContent();A[1]===0&&We.scrollLeft&&!this.parent.enableRtl&&(We.scrollLeft=0)}}else if((e.shiftKey?e.keyCode===13:e.keyCode===38)&&!this.parent.element.querySelector(".e-find-toolbar")){if(A[0]>0&&(!D.isProtected||D.protectSettings.selectCells))A[0]-=1,R=!0;else if(D.protectSettings.selectUnLockedCells){var ct=this.getNextUnlockedCell("up",A);R=A[0]!==ct[0]||A[1]!==ct[1],A[1]=ct[1],A[0]=ct[0]}if(A[0]<=0){var Dt=this.parent.getMainContent().parentElement;A[0]===0&&Dt.scrollTop&&(Dt.scrollTop=0)}}}if(R&&(!this.parent.scrollModule||this.parent.scrollModule.isKeyScroll)&&!F&&!j(document.activeElement,".e-ribbon")&&!i.classList.contains("e-insert-function")&&(!i.classList.contains("e-formula-bar")||i.classList.contains("e-formula-bar")&&i.nodeName==="TEXTAREA"&&e.keyCode===13)){if(e.keyCode===40||e.keyCode===38||e.keyCode===13){for(;st(D,A[0]);)if((e.keyCode===40||!e.shiftKey&&e.keyCode===13)&&(A[0]=A[0]+1),(e.keyCode===38||e.shiftKey&&e.keyCode===13)&&(A[0]=A[0]-1,A[0]<0))return}if(e.keyCode===37||e.keyCode===39||e.keyCode===9){for(;Ot(D,A[1]);)if((e.keyCode===39||!e.shiftKey&&e.keyCode===9)&&(A[1]=A[1]+1),(e.keyCode===37||e.shiftKey&&e.keyCode===9)&&(A[1]=A[1]-1,A[1]<0))return}var Xt=J(D.topLeftCell);D.frozenRows&&A[0]<Xt[0]&&(A[0]=se(D,Xt[0],!0)),D.frozenColumns&&A[1]<Xt[1]&&(A[1]=se(D,Xt[1],!0,"columns")),this.scrollNavigation(A);var Lt=Be(A),Bi=function(_){if(Lt!==D.selectedRange){t.parent.selectionModule.previousActiveCell=D.activeCell,document.getElementsByClassName("e-addNoteContainer")&&document.getElementsByClassName("e-addNoteContainer").length>0&&t.parent.notify(iu,""),t.parent.setSheetPropertyOnMute(D,"activeCell",Lt),t.parent.notify(Jh,{range:A.concat(A),preventAnimation:_});var Z;B.isDevice&&B.info.name==="safari"&&(B.isIos||B.isIos7)&&(Z=t.parent.element.querySelector(".e-ss-focus-edit")),Z=Z||t.parent.getCell(A[0],A[1]),Z&&Fe(Z)}};if(this.parent.scrollModule&&this.parent.scrollModule.isKeyScroll){if(Lt===D.selectedRange)return;cr(Bi.bind(this,!0))}else Bi()}else if(e.keyCode===9){var zi=this.parent.showRibbon&&j(document.activeElement,".e-ribbon");if(zi)j(document.activeElement,".e-tab-header")?e.shiftKey||zi.classList.contains("e-collapsed")?this.focusEle(e,".e-ribbon .e-drop-icon"):this.focusEle(e,".e-ribbon .e-content .e-toolbar-item:not(.e-separator):not(.e-overlay):not(.e-hide) .e-btn"):j(document.activeElement,".e-content")?e.shiftKey?this.focusEle(e,".e-ribbon .e-toolbar-items .e-toolbar-item.e-active .e-tab-wrap",!0):this.focusEle(e,".e-ribbon .e-drop-icon"):document.activeElement.classList.contains("e-drop-icon")&&(e.shiftKey&&!zi.classList.contains("e-collapsed")?this.focusEle(e,".e-ribbon .e-content .e-toolbar-item:not(.e-separator):not(.e-overlay):not(.e-hide) .e-btn"):this.focusEle(e,".e-ribbon .e-toolbar-items .e-toolbar-item.e-active .e-tab-wrap",!0));else if(i.classList.contains("e-insert-function"))e.shiftKey?this.focusEle(e,".e-formula-bar-panel .e-combobox"):this.focusEle(e,".e-formula-bar",!1,!0);else if(F)if(e.shiftKey){var Ct=i.classList.contains("e-aggregate-list")||i.classList.contains("e-scroll-left-nav");if(i.classList.contains("e-add-sheet-tab")||Ct||i.classList.contains("e-sheets-list")&&i.previousElementSibling&&i.previousElementSibling.disabled){var Ei=!Ct&&this.parent.element.querySelector(".e-aggregate-list");if(Ei)this.focusEle(e,null,!1,!1,Ei);else if(!i.classList.contains("e-scroll-left-nav")&&this.parent.element.querySelector(".e-sheet-tab-panel .e-scroll-nav"))this.focusEle(e,".e-sheet-tab-panel .e-scroll-right-nav",!0);else{var ji=[].slice.call(this.parent.element.querySelectorAll(".e-sheet-tab-panel .e-toolbar-item"));ji[ji.length-1]&&this.focusEle(e,null,!0,!1,ji[ji.length-1].querySelector(".e-tab-wrap"))}}else if(i.classList.contains("e-scroll-right-nav"))this.focusEle(e,".e-sheet-tab-panel .e-scroll-left-nav",!0);else if(i.classList.contains("e-tab-wrap")){var ji=[].slice.call(this.parent.element.querySelectorAll(".e-sheet-tab-panel .e-toolbar-item")),ue=ji.indexOf(i.parentElement);ue===0?this.focusEle(e,".e-sheet-tab-panel .e-sheets-list"):this.focusEle(e,null,!0,!1,ji[ue-1].querySelector(".e-tab-wrap"))}}else{var Ur=!!this.parent.element.querySelector(".e-aggregate-list");if(i.classList.contains("e-aggregate-list")||!Ur&&i.classList.contains("e-scroll-right-nav"))this.focusEle(e,".e-sheet-tab-panel .e-icon-btn:not(:disabled)");else if(i.classList.contains("e-sheets-list"))this.focusEle(e,".e-sheet-tab-panel .e-toolbar-item .e-tab-wrap",!0);else if(i.classList.contains("e-scroll-left-nav"))this.focusEle(e,".e-sheet-tab-panel .e-scroll-right-nav",!0);else if(i.classList.contains("e-tab-wrap")){var ji=[].slice.call(this.parent.element.querySelectorAll(".e-sheet-tab-panel .e-toolbar-item")),Fi=ji.indexOf(i.parentElement);if(Fi===ji.length-1){var Tr=!!this.parent.element.querySelector(".e-sheet-tab-panel .e-scroll-nav");(Tr||!Ur)&&this.focusEle(e,".e-sheet-tab-panel ."+(Tr?"e-scroll-nav":"e-icon-btn:not(:disabled)"),Tr)}else this.focusEle(e,null,!0,!1,ji[Fi+1].querySelector(".e-tab-wrap"))}}}e.keyCode===121&&e.shiftKey&&!this.parent.enableKeyboardShortcut&&e.preventDefault()},o.prototype.setFocus=function(e,t,i){e==="Sheet"?t.shiftKey?this.parent.showFormulaBar?this.focusEle(t,".e-formula-bar-panel .e-combobox"):this.setFocus("FormulaBar",t,i):this.parent.showSheetTabs?this.focusEle(t,".e-sheet-tab-panel .e-icon-btn:not(:disabled)"):this.setFocus("SheetTabs",t,i):e==="SheetTabs"?t.shiftKey?i||this.focusEle(t,".e-selectall"):this.parent.showRibbon?this.focusEle(t,".e-ribbon .e-toolbar-items .e-toolbar-item.e-active .e-tab-wrap",!0):this.setFocus("Ribbon",t,i):e==="Ribbon"?t.shiftKey?this.parent.showSheetTabs?this.focusEle(t,".e-sheet-tab-panel .e-icon-btn:not(:disabled)"):i||this.focusEle(t,".e-selectall"):this.parent.showFormulaBar?this.focusEle(t,".e-formula-bar-panel .e-combobox"):this.setFocus("FormulaBar",t,i):e==="FormulaBar"&&(t.shiftKey?this.parent.showRibbon?this.focusEle(t,".e-ribbon .e-toolbar-items .e-toolbar-item.e-active .e-tab-wrap",!0):this.setFocus("Ribbon",t,i):i||this.focusEle(t,".e-selectall"))},o.prototype.focusEle=function(e,t,i,r,n){if(n=n||this.parent.element.querySelector(t),i&&!n){var s=this.parent.element.querySelector(".e-ribbon .e-tab"),a=s&&at(s,"tab").selectedItem||0;n=this.parent.element.querySelector(".e-tab-header").getElementsByClassName("e-toolbar-item")[a],n=n&&n.querySelector(".e-tab-wrap")}if(n)if(e.preventDefault(),r)n.click(),Fe(n),n.setSelectionRange(n.value.length,n.value.length);else if(i){if(n.setAttribute("tabindex","0"),n.parentElement.classList.contains("e-active")&&n.parentElement.classList.contains("e-toolbar-item")){var s=this.parent.element.querySelector(".e-sheet-tab-panel .e-sheet-tab");!s&&s.classList.contains("e-focused")&&s.classList.add("e-focused")}n.focus()}else Fe(n)},o.prototype.updateSelection=function(e,t,i){e.isProtected&&!e.protectSettings.selectCells&&e.protectSettings.selectUnLockedCells?ko(this.parent,tt(t))||this.parent.notify(Jh,{range:t,shiftKey:i.shiftKey}):this.parent.notify(Jh,{range:t,shiftKey:i.shiftKey})},o.prototype.getNextNonEmptyCell=function(e,t,i){var r=this.parent.getActiveSheet(),n=function(S,b){var w=G(S,b,r,null,!0).value;return!g(w)&&w!==""},s,a;if(i==="down"){var l=se(r,e+1,!0);s=n(l,t);for(var h=se(r,r.rowCount-1,!1),u=l;u<r.rowCount;u++){if(u===h)return u;if(s){if(!n(se(r,u,!0),t))return se(r,u-1,!1)}else if(a=se(r,u+1,!0),n(a,t))return a}return e}else if(i==="top"){var l=se(r,e-1,!1);s=n(l,t);for(var c=this.parent.frozenRowCount(r)?J(r.topLeftCell)[0]:0,d=se(r,c,!0),p=l;p>=0;p--){if(p===d)return p;if(s){if(!n(se(r,p,!1),t))return se(r,p+1,!0)}else if(a=se(r,p-1,!1),n(a,t))return a}return e}else if(i==="right"){var f=se(r,t+1,!0,"columns");s=n(e,f);for(var v=se(r,r.colCount-1,!1,"columns"),m=f;m<r.colCount;m++){if(m===v)return m;if(s){if(!n(e,se(r,m,!0,"columns")))return se(r,m-1,!1,"columns")}else if(a=se(r,m+1,!0,"columns"),n(e,a))return a}return t}else{var f=se(r,t-1,!1,"columns");s=n(e,f);for(var c=this.parent.frozenColCount(r)?J(r.topLeftCell)[1]:0,d=se(r,c,!0,"columns"),y=f;y>=0;y--){if(y===d)return y;if(s){if(!n(e,se(r,y,!1,"columns")))return se(r,y+1,!0,"columns")}else if(a=se(r,y-1,!1,"columns"),n(e,a))return a}return t}},o.prototype.getNextUnlockedCell=function(e,t){var i=this.parent.getActiveSheet(),r,n;if(e==="right")for(var s=t[0],a=void 0,l=void 0,h=i.usedRange.rowIndex,u=i.usedRange.colIndex;s<=h;){for(a=a===void 0?t[1]+1:0,l&&s===t[0]&&(u=t[1]-1),a;a<=u;a++)if(r=G(s,a,i),n=Rt(i,a)||{},!un(r,n)&&!n.hidden&&!st(i,s))return[s,a];s===i.usedRange.rowIndex&&!l?(s=0,h=t[0],l=!0):s++}else if(e==="left")for(var s=t[0],a=void 0,l=void 0,h=0,u=0;s>=h;){for(a=a===void 0?t[1]-1:i.usedRange.colIndex,l&&s===t[0]&&(u=t[1]+1),a;a>=u;a--)if(r=G(s,a,i),n=Rt(i,a)||{},!un(r,n)&&!n.hidden&&!st(i,s))return[s,a];s===0&&!l?(s=i.usedRange.rowIndex,h=t[0],l=!0):s--}else if(e==="down")for(var a=t[1],s=void 0,l=void 0,u=i.usedRange.colIndex,h=i.usedRange.rowIndex;a<=u;){for(s=s===void 0?t[0]+1:0,l&&a===t[1]&&(h=t[0]-1),s;s<=h;s++)if(r=G(s,a,i),n=Rt(i,a)||{},!un(r,n)&&!n.hidden&&!st(i,s))return[s,a];a===i.usedRange.colIndex&&!l?(a=0,u=t[1],l=!0):a++}else for(var a=t[1],s=void 0,l=void 0,u=0,h=0;a>=u;){for(s=s===void 0?t[0]-1:i.usedRange.rowIndex,l&&a===t[1]&&(h=t[0]+1),s;s>=h;s--)if(r=G(s,a,i),n=Rt(i,a)||{},!un(r,n)&&!n.hidden&&!st(i,s))return[s,a];a===0&&!l?(a=i.usedRange.colIndex,u=t[1],l=!0):a--}return t},o.prototype.shiftSelection=function(e){var t=this.parent.getActiveSheet(),i=J(t.selectedRange),r=tt(i),n=!0,s=this.parent.enableRtl;if(e.keyCode===38){for(var a=r[1];a<=r[3];a++){var l=G(i[2],a,t);if(!g(l)&&l.rowSpan&&l.rowSpan<0){i[2]=se(t,i[2]-(Math.abs(l.rowSpan)+1),!1),n=!1;break}}n&&(i[2]=se(t,i[2]-1,!1));var h=this.parent.frozenRowCount(t)?J(t.topLeftCell)[0]:0;if(i[2]<h)return}if(e.keyCode===40){for(var a=r[1];a<=r[3];a++){var l=G(i[2],a,t);if(!g(l)&&l.rowSpan&&l.rowSpan>0){i[2]=se(t,i[2]+Math.abs(l.rowSpan),!0),n=!1;break}}if(n&&(i[2]=se(t,i[2]+1,!0)),i[2]>=t.rowCount&&(i[2]=se(t,t.rowCount-1,!1),i[2]<0))return}if(e.keyCode===39&&!s||e.keyCode===37&&s){for(var a=r[0];a<=r[2];a++){var l=G(a,i[3],t);if(!g(l)&&l.colSpan&&l.colSpan>0){i[3]=se(t,i[3]+Math.abs(l.colSpan),!0,"columns"),n=!1;break}}if(n&&(i[3]=se(t,i[3]+1,!0,"columns")),i[3]>=t.colCount&&(i[3]=se(t,t.colCount-1,!1,"columns"),i[3]<0))return}if(e.keyCode===37&&!s||e.keyCode===39&&s){for(var a=r[0];a<=r[2];a++){var l=G(a,i[3],t);if(!g(l)&&l.colSpan&&l.colSpan<0){i[3]=se(t,i[3]-(Math.abs(l.colSpan)+1),!1,"columns"),n=!1;break}}n&&(i[3]=se(t,i[3]-1,!1,"columns"));var h=this.parent.frozenColCount(t)?J(t.topLeftCell)[1]:0;if(i[3]<h)return}if(!this.parent.scrollSettings.enableVirtualization&&e.shiftKey&&e.ctrlKey){var u=[t.usedRange.rowIndex,t.usedRange.colIndex];if(e.keyCode===37&&(i[3]<=u[1]?i[3]=se(t,0,!0,"columns"):i[3]=se(t,u[1],!0,"columns")),e.keyCode===38&&(i[2]<=u[0]?i[2]=se(t,0,!0):i[2]=se(t,u[0],!0)),e.keyCode===39&&(i[3]<=u[1]?i[3]=se(t,u[1],!1,"columns"):i[3]=se(t,t.colCount,!1,"columns"),i[3]<0)||e.keyCode===40&&(i[2]<=u[0]?i[2]=se(t,u[0],!1):i[2]=se(t,t.rowCount,!1),i[2]<0))return}if(e.keyCode===37||e.keyCode===39||e.keyCode===38||e.keyCode===40){var c=Se(t.activeCell);this.parent.isEdit&&e.shiftKey?(e.preventDefault(),this.parent.notify(Gx,{range:i,e}),this.parent.notify(gl,{range:Be(tt(i)),isSelect:!1}),this.parent.notify(ob,{})):this.parent.notify(Jh,{range:i,shiftKey:e.shiftKey}),this.scrollNavigation([T6(t,i)?c[0]:i[2],aO(t,i)?c[1]:i[3]])}},o.prototype.scrollNavigation=function(e,t){if(this.parent.allowScrolling){var i=this.parent.enableRtl?-1:1,r=this.parent.getMainContent().parentElement,n=this.parent.getScrollElement(),s=this.parent.getActiveSheet(),a=tt(J(s.selectedRange)),l=Se(s.topLeftCell),h=this.parent.frozenRowCount(s),u=this.parent.frozenColCount(s),c=Se(s.paneTopLeftCell),d=se(s,e[0]<h?l[0]:c[0],!0),p=this.parent.scrollModule.offset.top.size;if(r.scrollTop){if(h&&e[0]!==a[2]){if(e[0]===h){r.scrollTop=0;return}e[0]===h-1&&(r.scrollTop=0)}else if(e[0]===se(s,0,!0)){r.scrollTop=0;return}}if(n&&n.scrollLeft){if(u&&e[1]!==a[3]){if(e[1]===u){n.scrollLeft=0;return}e[1]===u-1&&(n.scrollLeft=0)}else if(e[1]===se(s,0,!0,"columns")){n.scrollLeft=0;return}}var f=rd(this.parent,d).index;if(f<=e[0]){if(e[0]>=h)if(t){var v=r.getBoundingClientRect().height,m=Ri(s,c[0],e[0],!0);m>v*2?r.scrollTop=p+m-v:r.scrollTop=p+m-li(s,e[0],!0),Fe(this.parent.element)}else r.scrollTop=p+Ri(s,f,e[0],!0)}else d>e[0]&&(r.scrollTop&&(this.parent.scrollModule.isKeyScroll=!1),r.scrollTop=p-Math.ceil(Ri(s,e[0],d-1,!0)),t&&Fe(this.parent.element));var y=oy(this.parent,c[1]);if(y<=e[1]&&n){if(e[1]>=u)if(t){var S=n.getBoundingClientRect().width,b=Ci(s,c[1],e[1],!0);b>S*2?n.scrollLeft=(this.parent.scrollModule.offset.left.size+b-S)*i:n.scrollLeft=(this.parent.scrollModule.offset.left.size+(b-_r(s,e[0],null,!0)))*i,Fe(this.parent.element)}else n.scrollLeft=(this.parent.scrollModule.offset.left.size+Ci(s,y,e[1],!0))*i}else c[1]>e[1]&&n&&(n.scrollLeft&&(this.parent.scrollModule.isKeyScroll=!1),n.scrollLeft=(this.parent.scrollModule.offset.left.size-Ci(s,e[1],c[1]-1,!0))*i,t&&Fe(this.parent.element))}},o.prototype.getModuleName=function(){return"keyboardNavigation"},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o}(),HO=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on($a,this.keyDownHandler,this),this.parent.on(ds,this.keyUpHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off($a,this.keyDownHandler),this.parent.off(ds,this.keyUpHandler))},o.prototype.isTrgtNotInput=function(e){var t=e.target;return!j(t,".e-filter-popup")&&!j(t,".e-find-dlg")&&!j(t,".e-hyperlink-dlg")&&!j(t,".e-sheet-tab")&&!j(t,".e-name-box")&&!j(t,".e-link-dialog")},o.prototype.ribbonShortCuts=function(e){if(this.parent.showRibbon&&e.altKey&&!e.ctrlKey&&!e.shiftKey){var t=at(this.parent.element.querySelector(".e-ribbon .e-tab"),"tab"),i=void 0;if(e.keyCode===72)i=1;else if(e.keyCode===78)i=2;else if(e.keyCode===65)i=4;else if(e.keyCode===87)i=5;else if(e.keyCode===77)i=3;else if(e.keyCode===70)e.preventDefault(),X("#"+this.parent.element.id+"_File",this.parent.element).click();else if(e.keyCode===18){e.preventDefault();var r=Se(this.parent.getActiveSheet().activeCell),n={sheetIdx:this.parent.activeSheetIndex};if(this.parent.notify(Du,n),!(n.hasFilter&&n.filterRange&&n.filterRange[0]===r[0]&&n.filterRange[1]<=r[1]&&n.filterRange[3]>=r[1])){var s=document.activeElement;if(!s.classList.contains("e-spreadsheet-edit")&&!s.classList.contains("e-sheet-rename")&&s.id!==this.parent.element.id+"_name_box"&&!j(s,".e-dropdown-btn")&&!j(s,".e-split-btn")&&!j(s,".e-popup-open")){var a=this.parent.getCell(r[0],r[1]);if(a&&a.querySelector(".e-validation-list"))return;if(j(s,".e-ribbon")){Fe(this.parent.element);return}for(var l=0;l<=this.parent.ribbonModule.ribbon.items.length;l++)if(l===this.parent.ribbonModule.ribbon.selectedTab){var h=this.parent.element.querySelector(".e-toolbar-items").children[l+2].children[0];h.setAttribute("tabindex","0"),Fe(h);return}}}}i&&(!t.items[i].disabled&&!t.items[i].cssClass.includes("e-hide")?(e.preventDefault(),t.select(i,Object.assign(e,{isShortcut:!0}))):Fe(this.parent.element))}},o.prototype.keyUpHandler=function(e){if(e.keyCode===37||e.keyCode===39){var t=document.activeElement;if(t.classList.contains("e-colorpicker-wrapper")||t.classList.contains("e-split-btn-wrapper")){var i=t.querySelector(".e-split-btn");i&&Fe(i)}}else if(e.keyCode===13){var r=e.target;if(r.classList.contains("e-scroll-nav")){var n=function(){r.getAttribute("tabindex")||(r.setAttribute("tabindex","0"),Fe(r)),E.remove(r,"blur",n)};E.add(r,"blur",n,this)}}},o.prototype.keyDownHandler=function(e){var t=this.parent.selectionSettings.mode==="None";this.ribbonShortCuts(e);var i=this.parent.getActiveSheet(),r=e.target,n=e.target;if(!(!g(n)&&n.classList.contains("e-addNoteContainer"))){if((e.ctrlKey||e.metaKey)&&this.isTrgtNotInput(e)){!j(r,".e-find-dlg")&&!t&&([79,83].indexOf(e.keyCode)>-1||e.keyCode===65&&!this.parent.isEdit)&&e.preventDefault();var s=Se(i.activeCell);if(e.keyCode===79)this.parent.allowOpen&&this.parent.openUrl&&X("#"+this.parent.element.id+"_fileUpload",this.parent.element).click();else if(e.keyCode===83)this.parent.saveUrl&&this.parent.allowSave&&this.parent.notify(Sf,null);else if(e.keyCode===67&&!t)this.parent.notify(wu,{promise:Promise});else if(e.keyCode===75&&!t){var a=i.rows[s[0]],l=void 0;e.preventDefault(),g(a)||(l=a.cells[s[1]]),g(l)&&oi(s[0],s[1],i,l,!1),l&&l.hyperlink?this.parent.notify(Pf,null):this.parent.notify(Rf,null)}else if(e.keyCode===90&&!t)this.parent.isEdit||(e.preventDefault(),this.parent.notify(Ka,{isUndo:!0}));else if(e.keyCode===89&&!t)this.parent.isEdit||(e.preventDefault(),this.parent.notify(Ka,{isUndo:!1}));else if((e.keyCode===82||e.keyCode===68)&&!t){e.preventDefault();var h=tt(J(i.selectedRange)),u={colIndex:h[1],rowIndex:h[0]},c=void 0,d=void 0;if(e.keyCode===68?(h[0]===h[2]?u.rowIndex=h[0]-1:h[0]+=1,d=Be([u.rowIndex,u.colIndex,u.rowIndex,h[3]]),c="Down"):(h[1]===h[3]?u.colIndex=h[1]-1:h[1]+=1,c="Right",d=Be([u.rowIndex,u.colIndex,h[2],u.colIndex])),u.rowIndex<0||u.colIndex<0)return;this.parent.notify(vb,{fillType:G(u.rowIndex,u.colIndex,i,!1,!0).formula?"FillSeries":"CopyCells",dAutoFillCell:d,rangeInfo:{direction:c,startCell:u,endCell:{rowIndex:h[2],colIndex:h[3]},fillRange:h}}),this.parent.notify(pa,{type:"mousedown"}),this.parent.notify(Es,null)}var p=i.isProtected&&un(G(s[0],s[1],i),Rt(i,s[1]));if(e.keyCode===70&&!t&&this.parent.allowFindAndReplace&&(e.preventDefault(),this.parent.notify(du,{})),(!p||!i.isProtected||e.keyCode===86)&&e.keyCode!==70&&!t&&(e.keyCode===71?(e.preventDefault(),this.parent.notify(gI,null)):e.keyCode===72?(e.preventDefault(),this.parent.notify(vI,null)):e.keyCode===88?this.parent.notify(Cu,{promise:Promise}):e.keyCode===86&&this.parent.notify(Ga,{isAction:!0}),e.shiftKey&&e.keyCode===76&&!this.parent.isEdit&&!i.isProtected&&(e.preventDefault(),this.parent.notify(Eo,{}))),!t&&(!i.isProtected||i.protectSettings.formatCells))if(e.keyCode===66){e.preventDefault();var f=this.parent.getCellStyleValue(["fontWeight"],s).fontWeight;f=f==="bold"?"normal":"bold",this.parent.notify(rr,{style:{fontWeight:f},onActionUpdate:!0,refreshRibbon:!0})}else if(e.keyCode===73){e.preventDefault();var f=this.parent.getCellStyleValue(["fontStyle"],s).fontStyle;f=f==="italic"?"normal":"italic",this.parent.notify(rr,{style:{fontStyle:f},onActionUpdate:!0,refreshRibbon:!0})}else e.ctrlKey&&e.keyCode===85&&!e.shiftKey?(e.preventDefault(),this.parent.notify(nd,{style:{textDecoration:"underline"},refreshRibbon:!0})):e.ctrlKey&&e.keyCode===53&&!e.shiftKey&&(e.preventDefault(),this.parent.notify(nd,{style:{textDecoration:"line-through"},refreshRibbon:!0}))}if(e.keyCode===27&&this.parent.notify(yd,null),((e.ctrlKey||e.metaKey)&&e.keyCode===119||e.keyCode===13&&r.classList.contains("e-drop-icon"))&&this.parent.showRibbon){e.preventDefault();var v=this.parent.element.querySelector(".e-drop-icon");v&&v.click()}if((e.ctrlKey||e.metaKey)&&!t){if(e.keyCode===57){if(!i.isProtected||i.protectSettings.formatRows){e.preventDefault();var s=J(i.selectedRange);this.parent.notify(Dn,{startIndex:s[0],endIndex:s[2],hide:!e.shiftKey,isCol:!1,actionUpdate:!0})}}else if(e.keyCode===48&&(!i.isProtected||i.protectSettings.formatColumns)){var s=J(i.selectedRange);this.parent.notify(Dn,{startIndex:s[1],endIndex:s[3],hide:!e.shiftKey,isCol:!0,actionUpdate:!0})}}if(e.shiftKey&&!t){if(e.keyCode===113&&!i.isProtected)e.preventDefault(),e.target.children.length>0&&typeof e.target.children[e.target.children.length-1].className=="string"&&e.target.children[e.target.children.length-1].className.indexOf("e-addNoteIndicator")>-1?this.parent.notify(Xy,null):this.parent.notify(Qy,null);else if(e.keyCode===114)e.preventDefault(),this.parent.notify(BI,null);else if(e.keyCode===116&&this.parent.allowFindAndReplace)e.preventDefault(),this.parent.notify(du,{});else if(e.keyCode===121){var m=document.activeElement.className;["e-spreadsheet","e-cell","e-header-cell","e-clipboard","e-rowhdr-table","e-selectall-table","e-main-panel"].some(function(D){return m.includes(D)})&&this.focusTarget(i)}}if(e.altKey&&!t&&((e.ctrlKey||e.metaKey)&&e.keyCode===78?(e.preventDefault(),this.parent.refresh(!0)):e.keyCode===113&&this.parent.saveUrl&&(e.preventDefault(),this.parent.notify(Sf,null))),(e.ctrlKey||e.metaKey)&&e.shiftKey&&!t){if(!i.isProtected||i.protectSettings.formatCells){var y=i.selectedRange,S=void 0;if(e.keyCode===192)S="General";else if(e.keyCode===52)S=hr("CurrencyWithColorCode");else if(e.keyCode===53)S="0%";else if(e.keyCode===54)S=hr("Scientific");else if(e.keyCode===51)S="dd-mmm-yy";else if(e.keyCode===50)S="h:mm AM/PM";else if(e.keyCode===49)S=hr("Number");else if(e.keyCode===55){e.preventDefault();var b="1px solid #000000";this.parent.notify(rr,{style:{border:b},onActionUpdate:!0,borderType:"Outer"})}if(S){var w=qi(this.parent,tt(J(y)));if(!w){var I={format:S,range:y,cancel:!1,requestType:"NumberFormat"},x={range:i.name+"!"+I.range,format:I.format,requestType:"NumberFormat"};this.parent.trigger("beforeCellFormat",I),this.parent.notify(ai,{eventArgs:I,action:"format"}),I.cancel||(this.parent.notify(wf,I),this.parent.notify(pa,{type:"mousedown"}),this.parent.notify(mt,{eventArgs:x,action:"format"}),this.parent.notify(Es,null))}}}if(e.keyCode===85){e.preventDefault();var M=this.parent.element.querySelector(".e-formula-bar-panel .e-drop-icon");M&&M.click()}}e.keyCode===122&&e.shiftKey&&!e.ctrlKey&&!this.parent.isProtected&&this.parent.notify(ya,{model:this.parent,start:this.parent.activeSheetIndex+1,end:this.parent.activeSheetIndex+1,modelType:"Sheet",isAction:!0,activeSheetIndex:this.parent.activeSheetIndex+1}),e.shiftKey&&e.altKey&&e.keyCode===75&&this.parent.showSheetTabs&&this.parent.element.querySelector(".e-sheets-list").click()}},o.prototype.focusTarget=function(e){var t=tt(J(e.selectedRange)),i=t[1]===0&&t[3]===e.colCount-1,r=t[0]===0&&t[2]===e.rowCount-1,n;if(i&&r)n=this.parent.element.querySelector(".e-selectall");else if(i){var s=this.parent.frozenRowCount(e);if(t[0]<s){var a=this.parent.getRow(t[0],this.parent.sheetModule.getSelectAllTable());n=a&&a.cells[0]}else{t[0]=se(e,t[0],!0);var l=se(e,J(e.paneTopLeftCell)[0],!0),h=rd(this.parent,l).index,u=void 0;t[0]>l&&t[0]<h?u=this.parent.getRow(t[0],this.parent.getRowHeaderTable()):t[0]>=h?u=this.parent.getRow(h-1,this.parent.getRowHeaderTable()):u=this.parent.getRow(l+1,this.parent.getRowHeaderTable()),n=u&&u.cells[0]}}else if(r){var c=this.parent.frozenColCount(e);if(t[1]<c){var a=this.parent.element.querySelector(".e-selectall-container .e-header-row");n=a&&this.parent.getCell(0,t[1],a)}else{t[1]=se(e,t[1],!0,"columns");var d=se(e,J(e.paneTopLeftCell)[1],!0,"columns"),p=oy(this.parent,d),u=this.parent.element.querySelector(".e-column-header .e-header-row");t[1]>d&&t[1]<p?n=u&&this.parent.getCell(0,t[1],u):t[1]>=p?n=u&&this.parent.getCell(0,p-1,u):n=u&&this.parent.getCell(0,d+1,u)}}else{var f=J(e.paneTopLeftCell);n=this.parent.getCell(t[0],t[1]);var s=this.parent.frozenRowCount(e),c=this.parent.frozenColCount(e);if(t[0]<s&&t[1]<c)n=this.parent.getCell(t[0],t[1]);else if(t[0]<s){var d=J(e.paneTopLeftCell)[1],p=oy(this.parent,d);t[1]>d&&t[1]<p?n=this.parent.getCell(t[0],t[1]):t[1]>=p?n=this.parent.getCell(t[0],p-1):n=this.parent.getCell(t[0],d+1)}else if(t[1]<c){var l=J(e.paneTopLeftCell)[0],h=rd(this.parent,l).index;t[0]>l&&t[0]<h?n=this.parent.getCell(t[0],t[1]):t[0]>=h?n=this.parent.getCell(h-1,t[1]):n=this.parent.getCell(l+1,t[1])}else{var l=J(e.paneTopLeftCell)[0],h=rd(this.parent,l).index,d=J(e.paneTopLeftCell)[1],p=oy(this.parent,d);t[0]>l&&t[0]<h?t[1]>d&&t[1]<p?n=this.parent.getCell(t[0],t[1]):t[1]>=p?n=this.parent.getCell(t[0],p-1):n=this.parent.getCell(t[0],d+1):t[0]>=h?t[1]>d&&t[1]<p?n=this.parent.getCell(h-1,t[1]):t[1]>=p?n=this.parent.getCell(h-1,p-1):n=this.parent.getCell(h-1,d+1):t[1]>d&&t[1]<p?n=this.parent.getCell(l+1,t[1]):t[1]>=p?n=this.parent.getCell(l+1,p-1):n=this.parent.getCell(l+1,d+1)}n||(n=this.parent.getCell(f[0]+1,f[1]+1))}n&&Fe(n)},o.prototype.getModuleName=function(){return"keyboardShortcut"},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o}(),VO=function(){function o(e){this.checkHeight=!1,this.parent=e,this.addEventListener()}return o.prototype.applyCellFormat=function(e){if(e.checkHeight){this.checkHeight||(this.checkHeight=!0),this.updateRowHeight(e.rowIdx,e.colIdx,e.lastCell,e.onActionUpdate,e.outsideViewport,e.rowHeight);return}var t=Object.keys(e.style),i=this.parent.getActiveSheet();if(!(e.lastCell&&!t.length&&Mo(i,e.rowIdx)<=(i.standardHeight||20))){var r=e.td||this.parent.getCell(e.rowIdx,e.colIdx);if(r){this.updateMergeBorder(e,i);var n=void 0;if(e.formatColor&&r.style.color===e.formatColor&&(n=e.style.color,delete e.style.color),e.style.border!==void 0||e.style.borderTop!==void 0||e.style.borderLeft!==void 0){var s={};Object.keys(e.style).forEach(function(v){s[""+v]=e.style[""+v]}),s.border!==void 0&&(Object.assign(r.style,{borderRight:e.style.border,borderBottom:e.style.border}),this.setLeftBorder(e.style.border,r,e.rowIdx,e.colIdx,e.colIdx===this.parent.frozenColCount(i)?e.hRow:e.row,e.onActionUpdate,e.first,i),this.setTopBorder(e.style.border,r,e.rowIdx,e.colIdx,e.pRow,e.pHRow,e.onActionUpdate,e.first,e.lastCell,e.manualUpdate,i,e),delete s.border),s.borderTop!==void 0&&(this.setTopBorder(e.style.borderTop,r,e.rowIdx,e.colIdx,e.pRow,e.pHRow,e.onActionUpdate,e.first,e.lastCell,e.manualUpdate,i,e),delete s.borderTop),s.borderLeft!==void 0&&(this.setLeftBorder(e.style.borderLeft,r,e.rowIdx,e.colIdx,e.colIdx===this.parent.frozenColCount(i)?e.hRow:e.row,e.onActionUpdate,e.first,i),delete s.borderLeft),Object.keys(s).length&&(s.borderBottom!==void 0&&this.setThickBorderHeight(s.borderBottom,e.rowIdx,e.colIdx,r,e.row,e.hRow,e.onActionUpdate,e.lastCell,e.manualUpdate),Object.assign(r.style,s))}else{if(e.style.borderBottom!==void 0&&this.setThickBorderHeight(e.style.borderBottom,e.rowIdx,e.colIdx,r,e.row,e.hRow,e.onActionUpdate,e.lastCell,e.manualUpdate),Object.assign(r.style,e.style),r){var a=r.querySelector(".e-cf-databar");if(a){var l=a.querySelector(".e-databar-value");l&&(l.style.textDecoration=e.style.textDecoration,e.style.verticalAlign&&(l.style.alignItems=e.style.verticalAlign==="top"?"start":e.style.verticalAlign==="middle"?"center":"end"))}}var h=G(e.rowIdx,e.colIdx,i);if(h&&(h.rowSpan||h.colSpan)&&r.offsetHeight>0){var u=Cb(this.parent,h.style||this.parent.cellStyle);u>r.offsetHeight&&va(this.parent,i,r.offsetHeight,e.rowIdx)}if(e.style.fontSize&&r){var c=r.querySelector(".e-validation-list");c&&this.parent.notify(pd,{ddlCont:c,rowIdx:e.rowIdx,colIdx:e.colIdx,updatePosition:!0})}}var d=G(e.rowIdx,e.colIdx,i,null,!0);if(!i.rows[e.rowIdx]||!i.rows[e.rowIdx].customHeight){if(e.isHeightCheckNeeded){if(e.manualUpdate)this.checkHeight||(this.checkHeight=gd(e.style,e.onActionUpdate)),r&&r.children[0]&&r.children[0].className==="e-cf-databar"&&e.style.fontSize&&(r.children[0].querySelector(".e-databar-value").style.fontSize=e.style.fontSize),e.isFromAutoFillOption||this.updateRowHeight(e.rowIdx,e.colIdx,e.lastCell,e.onActionUpdate,null,e.rowHeight),d.wrap&&(e.style.fontSize||e.style.fontFamily)&&(r.style.lineHeight=parseFloat(d.style&&d.style.fontSize||this.parent.cellStyle.fontSize)*tM(d.style&&d.style.fontFamily?d.style:this.parent.cellStyle)+"pt");else if(!d.wrap&&gd(e.style)&&sh(i,e.rowIdx,e.colIdx,id(this.parent,e.rowIdx,e.colIdx,i,e.style)),e.lastCell){var u=Mo(i,e.rowIdx),p=i.standardHeight||20;u>p&&u>li(i,e.rowIdx)&&va(this.parent,i,u,e.rowIdx,e.row,e.hRow)}}}else if(!d.wrap&&(e.style.fontSize||e.style.fontFamily)){var f=li(i,e.rowIdx,!0)-iM(e.rowIdx,e.colIdx,i);f<Cb(this.parent,d.style)?r.style.lineHeight=f+"px":r.style.lineHeight&&(r.style.lineHeight="")}n!==void 0&&(e.style.color=n)}else this.updateRowHeight(e.rowIdx,e.colIdx,!0,e.onActionUpdate,null,e.rowHeight)}},o.prototype.updateRowHeight=function(e,t,i,r,n,s){if(this.checkHeight){var a=this.parent.getActiveSheet(),l=G(e,t,a,null,!0);if(!l.rowSpan){var h=0;h=id(this.parent,e,t,a,l.style||this.parent.cellStyle,l.wrap&&!l.colSpan?qf(this.parent.getDisplayText(l),Au(a,e,t),l.style,this.parent.cellStyle):1);var u=l.value&&l.value.toString();if(u&&u.indexOf(`
`)>-1){var c=void 0,d=u.split(`
`),p=0,f=d.length;for(c=0;c<f;c++){var v=qf(d[c],Au(a,e,t),l.style,this.parent.cellStyle);v===0&&(v=1),p=p+v}h=id(this.parent,e,t,a,l.style||this.parent.cellStyle,p)}var m=a&&a.standardHeight?a.standardHeight:20;if(h<m&&(h=m),sh(a,e,t,h),!n){var y=this.parent.getCell(e,t);y&&y.children[0]&&y.children[0].className==="e-cf-databar"&&(y.children[0].style.height="100%",y.children[0].firstElementChild.nextElementSibling.style.height="100%")}if(i){this.checkHeight=!1;var S=s||Mo(a,e),b=li(a,e);(r?S!==b:S>b)&&va(this.parent,a,S,e,null,null,!0,n)}}}},o.prototype.updateMergeBorder=function(e,t){var i=G(e.rowIdx,e.colIdx,t,null,!0),r={range:[e.rowIdx,e.colIdx,e.rowIdx,e.colIdx]};if(this.parent.notify(ur,r),i.rowSpan>1&&!e.style.borderBottom){var n=G(r.range[2],r.range[1],t,null,!0);n.style&&n.style.borderBottom&&(e.style.borderBottom=n.style.borderBottom)}if(i.colSpan>1&&!e.style.borderRight){var s=G(r.range[0],r.range[3],t,null,!0);s.style&&s.style.borderRight&&(e.style.borderRight=s.style.borderRight)}},o.prototype.setLeftBorder=function(e,t,i,r,n,s,a,l){if(!(a&&a.includes("Column"))){var h=this.parent.enableRtl,u=h?this.parent.getCell(i,r+1,n):this.parent.getCell(i,r-1,n);if(u){var c=G(i,r-1,l,!1,!0);if(c.rowSpan&&c.rowSpan!==1||c.colSpan&&c.colSpan!==1){var d={range:[i,r-1,i,r-1]};if(this.parent.notify(ur,d),c=G(d.range[0],d.range[1],l,!1,!0),c.style&&c.style.borderRight&&c.style.borderRight!=="none")return;if(c=G(d.range[0],d.range[3],l,null,!0),c.style&&c.style.borderRight&&c.style.borderRight!=="none")return;t.style.borderLeft=e}else s&&e!==""&&r===this.parent.viewport.leftIndex&&(this.parent.getMainContent().scrollLeft-=this.getBorderSize(e)),u.style.borderRight=e==="none"?u.style.borderRight:e}else t.style.borderLeft=e}},o.prototype.setTopBorder=function(e,t,i,r,n,s,a,l,h,u,c,d){if(!(l&&l.includes("Row"))){var p=r,f=G(i,r,c,!1,!0);f.colSpan>1&&Ot(c,r)&&(p=se(c,r,!0,"columns"),p>r+f.colSpan-1&&(p=r));var v=this.parent.getCell(i-1,p,n);if(v)if(f=G(i-1,r,c,!1,!0),f.rowSpan&&f.rowSpan!==1||f.colSpan&&f.colSpan!==1){var m={range:[i-1,r,i-1,r]};if(this.parent.notify(ur,m),f=G(m.range[0],m.range[1],c,!1,!0),f.style&&f.style.borderBottom&&f.style.borderBottom!=="none")return;if(f=G(m.range[2],m.range[1],c,null,!0),f.style&&f.style.borderBottom&&f.style.borderBottom!=="none")return;t.style.borderTop=e,d.mergeBorderRows!==void 0&&d.mergeBorderRows.indexOf(i)===-1&&d.mergeBorderRows.push(i)}else{if(st(c,i-1)){var y=[Number(v.parentElement.getAttribute("aria-rowindex"))-1,r];if(this.parent.getCellStyleValue(["bottomPriority"],y).bottomPriority)return}a&&e!==""&&c.topLeftCell.includes(""+(i+1))&&(this.parent.getMainContent().parentElement.scrollTop-=this.getBorderSize(e)),this.setThickBorderHeight(e,i-1,r,v,n,s,a,h,u),v.style.borderBottom=e==="none"?v.style.borderBottom:e}else t.style.borderTop=e}},o.prototype.setThickBorderHeight=function(e,t,i,r,n,s,a,l,h){var u=e?this.getBorderSize(e):1,c=this.parent.getActiveSheet();if(u>2&&(!c.rows[t]||!c.rows[t].customHeight))if(h)this.checkHeight||(this.checkHeight=!0),this.updateRowHeight(t,i,l,a);else{var d=li(c,t),p=Math.ceil(this.parent.calculateHeight(this.parent.getCellStyleValue(["fontFamily","fontSize"],[t,i]),1,3));p>d&&va(this.parent,c,p,t,n,s)}a&&(l||!this.checkHeight)&&u<3&&(!c.rows[t]||!c.rows[t].customHeight)&&(this.checkHeight||(this.checkHeight=!0),this.updateRowHeight(t,i,l,a))},o.prototype.getBorderSize=function(e){var t=e.split(" ")[0];return t==="thin"?1:t==="medium"?2:t==="thick"?3:parseInt(t,10)||1},o.prototype.clearObj=function(e){var t=this,i=e.options,r=i.range?i.range.indexOf("!")>0?i.range.substring(i.range.lastIndexOf("!")+1):i.range:this.parent.getActiveSheet().selectedRange,n=i.range&&i.range.indexOf("!")>0?yt(this.parent,i.range.substring(0,i.range.lastIndexOf("!"))):this.parent.activeSheetIndex,s=tt(J(r)),a=qi(this.parent,s);if(a){e.isAction&&this.parent.notify(nr,null);return}var l=this.parent.sheets[n],h=s[0],u=s[2],c,d,p=this.parent.element.getElementsByClassName("e-ss-overlay-active"),f=p.length>0,v,m=this.parent.element.getElementsByClassName("e-prev-highlight-bottom").length>0,y={range:r,type:i.type,requestType:"clear",sheetIndex:n},S=function(){e.isAction&&t.parent.notify(ai,{action:"beforeClear",eventArgs:y})},b=function(){e.isAction&&(y={range:l.name+"!"+r,type:i.type,sheetIndex:n},v&&(y.cfClearActionArgs=v.cfClearActionArgs),t.parent.notify(mt,{eventArgs:y,action:"clear",isSelectAll:m}))},w=i.type==="Clear All";if(f)(i.type==="Clear Contents"||w)&&(S(),p[0].classList.contains("e-datavisualization-chart")?this.parent.notify(Eu,{id:p[0].id,sheetIdx:this.parent.activeSheetIndex+1,clearAction:!0}):this.parent.notify(ga,{id:p[0].id,sheetIdx:this.parent.activeSheetIndex+1,clearAction:!0}),b());else{if(S(),i.type==="Clear Formats"||w)for(v={range:r,sheetIdx:n,isClear:!0},this.parent.notify(qa,v),e.cfClearActionArgs=v.cfClearActionArgs,w&&(this.parent.notify(To,{range:r,isRemoveValidation:!0}),h===0&&s[1]===0&&u>=l.usedRange.rowIndex&&s[3]>=l.usedRange.colIndex&&this.parent.setUsedRange(h,s[1],l,!1,!0)),h;h<=u;h++)for(c=s[1],d=s[3],c;c<=d;c++){var I=G(h,c,l),x=this.parent.getCell(h,c);I&&(w&&I.formula&&this.parent.notify(vu,{cellRef:Be([h,c,h,c])}),I.wrap&&this.parent.notify(Xa,{range:[h,c,h,c],wrap:!1,sheet:l}),I.hyperlink&&(x&&K(x.querySelectorAll(".e-hyperlink"),"e-hyperlink-style"),w&&this.parent.removeHyperlink(l.name+"!"+Be([h,c,h,c]))))}i.type==="Clear Hyperlinks"&&this.parent.removeHyperlink(l.name+"!"+r),this.parent.notify(ud,{range:l.name+"!"+r,type:i.type}),this.parent.serviceLocator.getService("cell").refreshRange(tt(J(r)),!1,!1,!1,i.type==="Clear Hyperlinks",cs(this.parent),!w,null,null,null,m),e.isFromUpdateAction||this.parent.notify(Su,{address:r}),this.parent.notify(Qa,null),b()}},o.prototype.addEventListener=function(){this.parent.on(Dr,this.applyCellFormat,this),this.parent.on(_f,this.clearObj,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Dr,this.applyCellFormat),this.parent.off(_f,this.clearObj))},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null,this.checkHeight=null},o.prototype.getModuleName=function(){return"cellformat"},o}(),kq=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(In,this.wireEvents,this),this.parent.on(aI,this.autoFit,this),this.parent.on(cI,this.setAutoFitHandler,this),this.parent.on(zI,this.propertyChange,this)},o.prototype.autoFit=function(e){for(var t=e.isRow?this.parent.getRowHeaderTable():this.parent.getColHeaderTable().rows[0],i=e.startIndex;i<=e.endIndex;i++)this.trgtEle=e.isRow?this.parent.getRow(i,t):this.parent.getCell(null,i,t),this.setAutofit(i,!e.isRow)},o.prototype.wireEvents=function(){var e=this.parent.getRowHeaderContent(),t=this.parent.element.getElementsByClassName("e-header-panel")[0];t&&(E.add(t,"dblclick",this.dblClickHandler,this),E.add(e,"dblclick",this.dblClickHandler,this),E.add(t,"mousedown",this.mouseDownHandler,this),E.add(e,"mousedown",this.mouseDownHandler,this),this.wireResizeCursorEvent(e,t))},o.prototype.wireResizeCursorEvent=function(e,t){E.add(e,"mousemove",this.setTarget,this),E.add(t,"mousemove",this.setTarget,this)},o.prototype.unWireResizeCursorEvent=function(){E.remove(this.parent.getRowHeaderContent(),"mousemove",this.setTarget);var e=this.parent.element.getElementsByClassName("e-header-panel")[0];e&&E.remove(e,"mousemove",this.setTarget)},o.prototype.unwireEvents=function(){var e=this.parent.getRowHeaderContent(),t=this.parent.element.getElementsByClassName("e-header-panel")[0];t&&(E.remove(t,"dblclick",this.dblClickHandler),E.remove(e,"dblclick",this.dblClickHandler),E.remove(t,"mousedown",this.mouseDownHandler),E.remove(e,"mousedown",this.mouseDownHandler),this.unWireResizeCursorEvent())},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(In,this.wireEvents),this.parent.off(aI,this.autoFit),this.parent.off(cI,this.setAutoFitHandler),this.parent.off(zI,this.propertyChange))},o.prototype.mouseMoveHandler=function(e){var t=this.parent.element.getElementsByClassName("e-colresize-handler")[0],i=this.parent.element.getElementsByClassName("e-rowresize-handler")[0];if(this.resizeTooltip(null,!0,e),t||i){this.isMouseMoved=!0;var r=this.parent.enableRtl;t?(r?e.x<this.trgtEle.parentElement.firstChild.getBoundingClientRect().right:e.x>this.trgtEle.parentElement.firstChild.getBoundingClientRect().left)&&(t.style.left=e.clientX-document.getElementById(this.parent.element.id+"_sheet").getBoundingClientRect().left+"px"):i&&e.y>=this.trgtEle.parentElement.parentElement.firstChild.getBoundingClientRect().top&&(i.style.top=e.clientY-document.getElementById(this.parent.element.id+"_sheet").getBoundingClientRect().top+"px")}},o.prototype.mouseDownHandler=function(e){if(!(!j(e.target,".e-header-cell")||e.target.className.includes("e-filter-icon"))){if(this.event=e,this.trgtEle=e.target,this.trgtEle.parentElement.classList.contains("e-hide-end")||this.trgtEle.classList.contains("e-hide-end")){var t=this.trgtEle.offsetHeight,i=e.offsetY;(t>=10&&i<5||t-2<8&&i<Math.ceil((i-2)/2))&&this.trgtEle.classList.add("e-skip-resize")}this.updateTarget(e,this.trgtEle);var r=this.trgtEle,n=r.classList.contains("e-colresize")?"e-colresize-handler":r.classList.contains("e-rowresize")?"e-rowresize-handler":"";this.createResizeHandler(r,n),this.unWireResizeCursorEvent(),E.add(this.parent.element,"mousemove",this.mouseMoveHandler,this),E.add(document,"mouseup",this.mouseUpHandler,this)}},o.prototype.mouseUpHandler=function(e){var t=this.parent.element.getElementsByClassName("e-resize-handle")[0];this.resizeOn(e),this.isMouseMoved=null;var i=document.querySelector(".e-header-tooltip");t&&(ee(t),this.updateCursor()),i&&i.remove(),E.remove(document,"mouseup",this.mouseUpHandler),E.remove(this.parent.element,"mousemove",this.mouseMoveHandler);var r=this.parent.element.getElementsByClassName("e-header-panel")[0];r&&this.wireResizeCursorEvent(this.parent.getRowHeaderContent(),r),this.parent.notify(Za,null),this.parent.notify(gb,null)},o.prototype.dblClickHandler=function(e){if(!(!j(e.target,".e-header-cell")||e.target.className.includes("e-filter-icon"))){this.trgtEle=e.target;var t=this.updateTarget(e,this.trgtEle);if(t){this.parent.notify(nr,null);return}if(this.trgtEle.classList.contains("e-colresize")){var i=parseInt(this.trgtEle.getAttribute("aria-colindex"),10)-1,r=_r(this.parent.getActiveSheet(),i)+"px";this.trgtEle.classList.contains("e-unhide-column")?this.showHiddenColumns(i-1):this.setAutofit(i,!0,r,this.trgtEle)}else if(this.trgtEle.classList.contains("e-rowresize")){var n=parseInt(this.trgtEle.parentElement.getAttribute("aria-rowindex"),10)-1,s=li(this.parent.getActiveSheet(),n)+"px";this.setAutofit(n,!1,s)}this.parent.notify(Za,null)}},o.prototype.setTarget=function(e){if(!(this.parent.isEdit||!j(e.target,".e-header-cell")||e.target.className.includes("e-filter-icon"))){var t=e.target,i=this.parent.getActiveSheet();if(!(i.isProtected&&(!i.protectSettings.formatColumns||!i.protectSettings.formatRows)&&(!i.protectSettings.formatRows&&!i.protectSettings.formatColumns||i.protectSettings.formatRows&&j(t,".e-colhdr-table")||i.protectSettings.formatColumns&&j(t,".e-rowhdr-table")))){var r,n,s,a;if(j(t,".e-header-row")){n=t.offsetWidth,a="e-colresize",s=this.parent.enableRtl?n-e.offsetX:e.offsetX;var l=this.getColPrevSibling(t);l&&!l.classList.contains("e-select-all-cell")?r=l:Number(t.getAttribute("aria-colindex"))>1&&(r=t)}else if(j(t,".e-row")){s=e.offsetY,n=t.offsetHeight,a="e-rowresize";var l=this.getRowPrevSibling(t);l?r=l.firstElementChild:Number(t.parentElement.getAttribute("aria-rowindex"))>1&&(r=t)}if(n-2<8&&s!==Math.ceil((n-2)/2))s<Math.ceil((n-2)/2)?(t.classList.add(a),r&&r.classList.add(a)):s>Math.ceil((n-2)/2)&&t.classList.add(a);else if(n-5<s&&s<=n&&n>=10)t.classList.add(a);else if(s<5&&r&&n>=10)t.classList.add(a),r.classList.add(a);else for(var h=this.parent.element.getElementsByClassName(a),u=0;u<h.length;u++)h[u].classList.remove(a)}}},o.prototype.getColPrevSibling=function(e){var t=this.parent.frozenColCount(this.parent.getActiveSheet());return e.previousElementSibling||(t&&j(e,".e-column-header")?this.parent.getSelectAllContent().querySelector(".e-header-row").lastElementChild:null)},o.prototype.getRowPrevSibling=function(e){var t=this.parent.frozenRowCount(this.parent.getActiveSheet());return e.parentElement.previousElementSibling||(t&&j(e,".e-row-header")?this.parent.getSelectAllContent().querySelector("tbody").lastElementChild:null)},o.prototype.updateTarget=function(e,t){if(j(t,".e-header-row")){var i=this.parent.enableRtl?t.offsetWidth-e.offsetX:e.offsetX;if(t.offsetWidth<10&&i<Math.ceil((t.offsetWidth-2)/2)||i<5&&t.offsetWidth>=10&&t.classList.contains("e-colresize")){var r=this.parent.getActiveSheet(),n=Number(this.trgtEle.getAttribute("aria-colindex"))-2,s=this.getColPrevSibling(t);if(s&&!Ot(r,n))this.trgtEle=s;else if(n>-1){var a=Rt(r,n);if(a.isReadOnly||qi(this.parent,[0,n,r.rowCount-1,n]))return!0;this.trgtEle.classList.add("e-unhide-column")}}}else if(t.offsetHeight<10&&e.offsetY<Math.ceil((t.offsetHeight-2)/2)||e.offsetY<5&&t.offsetHeight>=10&&t.classList.contains("e-rowresize")){var r=this.parent.getActiveSheet(),n=Number(t.parentElement.getAttribute("aria-rowindex"))-2,s=this.getRowPrevSibling(t);if(s||st(r,n))if(e.type==="dblclick"&&st(r,n)){var l=Ar(r,n);if(l.isReadOnly||qi(this.parent,[n,0,n,r.colCount-1]))return!0;var h=tt(J(r.selectedRange)),u=void 0;n<=h[2]&&n>h[0]&&aO(r,h)?u={startIndex:h[0],endIndex:h[2],hide:!1,autoFit:!0}:u={startIndex:n,endIndex:n,hide:!1,autoFit:!0},this.parent.notify(Dn,u)}else st(r,n)||(this.trgtEle=s.getElementsByClassName("e-header-cell")[0])}return!1},o.prototype.setAutoFitHandler=function(e){e.isCol&&Ot(this.parent.getActiveSheet(),e.idx)?this.showHiddenColumns(e.idx):this.setAutofit(e.idx,e.isCol,null,null,e.sheetIdx)},o.prototype.getWrapText=function(e,t,i){var r=this,n=e.toString().split(" "),s=Vr(" ",i,this.parent.cellStyle),a,l=0,h=0,u=e,c="",d=function(){var p=parseInt(h.toString(),10);(p>l||p===l&&Vr(c.trim(),i,r.parent.cellStyle)>Vr(u,i,r.parent.cellStyle))&&(u=c.trim(),l=p)};return n.forEach(function(p,f){a=Vr(p,i,r.parent.cellStyle),(h+a)/t>1?(d(),c="",h=a):(a+=(h+a+s)/t>=1?0:s,h+=a),c+=p+" ",f===n.length-1&&d()}),u},o.prototype.setAutofit=function(e,t,i,r,n){var s=this,a=g(n)?this.parent.getActiveSheet():ke(this.parent,n),l,h=g(n)?!0:n===this.parent.activeSheetIndex;if(r){var u={cancel:!1,index:e,isCol:t,sheetIndex:this.parent.activeSheetIndex};if(t?(u.oldWidth=i,u.autoFitWithHeader=!1):u.oldHeight=i,this.parent.notify(ai,{eventArgs:u,action:"resizeToFit"}),u.cancel)return;l=u.autoFitWithHeader}var c,d={},p,f,v,m=this.parent.createElement("table",{className:this.parent.getContentTable().className+" e-resizetable",styles:"height: auto"}),y=this.parent.createElement("tbody"),S=this.parent.createElement("tr",{className:"e-row"}),b=this.parent.createElement("td",{className:"e-cell"}),w=0,I=0;if(t){var x;m.style.width="auto";var M=function(H){p=b.cloneNode(),p.textContent=H,p.style.fontFamily=d.style&&d.style.fontFamily||s.parent.cellStyle.fontFamily,p.style.fontSize=d.style&&d.style.fontSize||s.parent.cellStyle.fontSize,p.style.fontWeight=d.style&&d.style.fontWeight||s.parent.cellStyle.fontWeight,x=S.cloneNode(),x.appendChild(p),y.appendChild(x)};l&&M(r.textContent);for(var D=0,A=a.rows.length;D<A;D++)d=G(D,e,a),d&&d.value&&(d.wrap?(v=!0,M(this.getWrapText(this.parent.getDisplayText(d),Au(a,e,e,d.colSpan>1?e+d.colSpan-1:e),d.style))):M(this.parent.getDisplayText(d)));c=_r(a,e)}else{var L=a.rows[e]&&a.rows[e].cells?a.rows[e].cells.length:0;f=this.parent.createElement("colgroup");for(var T=0;T<L;T++)d=G(e,T,a),d&&(p=b.cloneNode(),d.wrap&&p.classList.add("e-wraptext"),p.textContent=this.parent.getDisplayText(d),p.style.fontFamily=d.style&&d.style.fontFamily||this.parent.cellStyle.fontFamily,p.style.fontSize=d.style&&d.style.fontSize||this.parent.cellStyle.fontSize,S.appendChild(p),I=d.colSpan&&d.colSpan>=1?this.getMergedColumnsWidth(d.colSpan,T,a):d.colSpan&&d.colSpan<1?0:_r(a,T,!1,!0),w+=I,f.appendChild(this.parent.createElement("col",{styles:"width:"+I+"px"})));m.appendChild(f),y.appendChild(S),c=li(a,e)}m.appendChild(y),w&&(m.style.width=w+"px");var k=this.parent.createElement("div",{className:this.parent.element.className,styles:"display: block"});k.appendChild(m),document.body.appendChild(k);var F=m.getBoundingClientRect();document.body.removeChild(k);var R=Math.ceil(t?F.width:F.height),N=(t?this.getFloatingElementWidth(R+(v?1:0),e):R)||c,P;if(t){N>0?P=-(c-N):P=-c;var O=this.parent.frozenColCount(a);O&&e>=J(a.topLeftCell)[1]&&e<O||e>=this.parent.viewport.leftIndex+O&&e<=this.parent.viewport.rightIndex?(Rt(a,e).width=N>0?N:0,h&&(this.resizeStart(e,this.parent.getViewportIndex(e,!0),N+"px",t,!0,i),this.parent.notify(_n,{threshold:P,colIdx:e}))):(h&&this.parent.notify(_n,{threshold:P,colIdx:e}),Rt(a,e).width=N>0?N:0)}else{var z=this.parent.frozenRowCount(a);N=N>20?N:20,P=-(c-N),z&&e>=J(a.topLeftCell)[0]&&e<z||e>=this.parent.viewport.topIndex+z&&e<=this.parent.viewport.bottomIndex?(bb(a,e,N),hs(a,e,{customHeight:!1}),h&&(this.resizeStart(e,this.parent.getViewportIndex(e),N+"px",t,!0,i),this.parent.notify(An,{threshold:P,rowIdx:e}))):(h&&this.parent.notify(An,{threshold:P,rowIdx:e}),bb(a,e,N))}h&&this.parent.selectRange(a.selectedRange)},o.prototype.getMergedColumnsWidth=function(e,t,i){for(var r=0,n=0;n<e;n++)r+=_r(i,t,!1,!0),t++;return r},o.prototype.createResizeHandler=function(e,t){var i=this.parent.createElement("div",{className:t});i.classList.add("e-resize-handle");var r=document.getElementById(this.parent.element.id+"_sheet");e.classList.contains("e-colresize")?(i.style.height=this.parent.getMainContent().parentElement.clientHeight+this.parent.getColumnHeaderContent().offsetHeight+"px",i.style.left=this.event.clientX-r.getBoundingClientRect().left+"px",i.style.top="0px"):e.classList.contains("e-rowresize")&&(i.style.width=this.parent.getMainContent().parentElement.clientWidth+"px",i.style.left="0px",i.style.top=this.event.clientY-r.getBoundingClientRect().top+"px"),r.appendChild(i),this.resizeTooltip(e,!1),this.updateCursor()},o.prototype.resizeTooltip=function(e,t,i){if(t){var r=this.parent.enableRtl,n=document.querySelector(".e-header-tooltip"),s=this.parent.element.getElementsByClassName("e-colresize-handler")[0],a=this.parent.element.getElementsByClassName("e-rowresize-handler")[0];if(s){var l=r?Math.round(this.trgtEle.getBoundingClientRect().right)-i.clientX:i.clientX-Math.round(this.trgtEle.getBoundingClientRect().left);n&&(n.firstChild.textContent=l>0?"Width:("+l.toString()+" pixels)":"Width: 0.00")}else if(a){var h=i.clientY-Math.round(this.trgtEle.getBoundingClientRect().top);n&&(n.firstChild.textContent=h>0?"Height:("+h.toString()+" pixels)":"Height: 0.00")}}else{var u=e.classList.contains("e-colresize"),c=e.classList.contains("e-rowresize");if(u||c){var d=u?"e-colresize-handler":"e-rowresize-handler",p=new Ol({cssClass:"e-header-tooltip",showTipPointer:!1});u?p.content=Ks(function(){return"Width:("+Math.round(e.getBoundingClientRect().width).toString()+" pixels)"}):c&&(p.content=Ks(function(){return"Height:("+Math.round(e.getBoundingClientRect().height).toString()+" pixels)"}),p.offsetX=-(this.parent.getMainContent().parentElement.clientWidth/2-Math.round(e.getBoundingClientRect().width))),p.appendTo("."+d),p.open(),p.refresh()}}},o.prototype.setColWidth=function(e,t,i,r){var n=this.parent.getActiveSheet(),s=En(i)-r;if(s<0&&r<-s&&(s=-r),i>0){if(this.isMouseMoved&&this.trgtEle.classList.contains("e-unhide-column")){this.showHiddenColumns(e,i),this.parent.notify(mt,{eventArgs:{index:e,width:"0px",isCol:!0,sheetIndex:this.parent.activeSheetIndex,oldWidth:r+"px",hide:!1},action:"resize"});return}this.resizeStart(e,t,i+"px",!0,!1,r+"px"),ch(n,e,{width:i,customWidth:!0}),this.parent.notify(_n,{threshold:s,colIdx:e,checkWrapCell:!0})}else this.isMouseMoved&&(this.parent.hideColumn(e),this.showHideCopyIndicator(),this.parent.notify(mt,{eventArgs:{index:e,width:"0px",isCol:!0,sheetIndex:this.parent.activeSheetIndex,oldWidth:r+"px",hide:!0},action:"resize"}))},o.prototype.showHideCopyIndicator=function(){var e=this.parent.element.getElementsByClassName("e-copy-indicator")[0],t=!1;e&&(ee(e),this.parent.notify(nh,null),t=!0),t&&this.parent.notify(In,{})},o.prototype.showHiddenColumns=function(e,t){var i=this,r=this.parent.getActiveSheet(),n=J(r.selectedRange),s,a,l;if(e>=n[1]&&e<=n[3]&&n[2]===r.rowCount-1&&Se(r.activeCell)[0]===Se(r.topLeftCell)[0]?(s=n[1],a=n[3],l=this.parent.getMainContent().querySelector("colgroup")):s=a=e,t!==void 0)for(var h=s;h<=a;h++)ch(r,h,{width:t,customWidth:!0}),h>=this.parent.viewport.leftIndex&&h<=this.parent.viewport.rightIndex&&!Ot(r,h)&&(l.children[this.parent.getViewportIndex(h,!0)].style.width=t+"px");this.trgtEle&&this.trgtEle.classList.remove("e-unhide-column");var u={startIndex:s,endIndex:a,hide:!1,isCol:!0,autoFit:!0};if(this.parent.notify(Dn,u),this.showHideCopyIndicator(),t===void 0)if(u.autoFit)this.autoFit({isRow:!1,startIndex:s,endIndex:a});else{var c=function(){i.parent.off(In,c),i.autoFit({isRow:!1,startIndex:s,endIndex:a})};this.parent.on(In,c,this)}},o.prototype.setRowHeight=function(e,t,i,r){var n=this.parent.getActiveSheet(),s=this.parent.frozenColCount(n),a=parseInt(this.parent.getRow(e,null,s).style.height,10),l=i,h=En(parseInt(l,10))-a;h<0&&a<-h&&(h=-a);var u;n.rows[e]&&n.rows[e].customHeight&&(u=!0),this.resizeStart(e,t,l,!1,!1,r,u),hs(n,e,{height:parseInt(l,10)>0?parseInt(l,10):0,customHeight:!0}),this.parent.notify(An,{threshold:h,rowIdx:e,isCustomHgt:!0})},o.prototype.resizeOn=function(e){var t=this,i,r,n=this.parent.getActiveSheet(),s=J(n.activeCell),a=G(s[0],s[1],n);if(this.trgtEle.classList.contains("e-rowresize")){var l=Number(this.trgtEle.parentElement.getAttribute("aria-rowindex"))-2;if(this.isMouseMoved&&st(n,l)&&this.trgtEle.classList.contains("e-skip-resize")&&e.clientY>this.trgtEle.getBoundingClientRect().top){this.trgtEle.classList.remove("e-skip-resize");var h={startIndex:l,endIndex:l,hide:!1,skipAppend:!0};this.parent.notify(Dn,h);var u=this.parent.getRowHeaderTable().tBodies[0],c=this.parent.getContentTable().tBodies[0];h.hdrRow.style.display="none",h.row.style.display="none",u.insertBefore(h.hdrRow,u.children[h.insertIdx]),c.insertBefore(h.row,c.children[h.insertIdx]),this.trgtEle=h.hdrRow.firstElementChild,h.hdrRow.nextElementSibling.classList.remove("e-hide-end"),h.mergeCollection.forEach(function(w){t.parent.notify(Mn,w)})}else if(this.trgtEle.classList.contains("e-skip-resize")){if(this.trgtEle.classList.remove("e-skip-resize"),!this.isMouseMoved&&st(n,l)||!this.trgtEle.parentElement.previousElementSibling)return;this.trgtEle=this.trgtEle.parentElement.previousElementSibling.getElementsByClassName("e-header-cell")[0]}r=i=parseInt(this.trgtEle.parentElement.getAttribute("aria-rowindex"),10)-1,i=this.parent.getViewportIndex(r);var d=this.parent.frozenColCount(n),p=this.parent.getRow(r,null,d).style.height,f=e.clientY-this.event.clientY+parseInt(p,10);if(f<=0){this.parent.hideRow(r),this.showHideCopyIndicator(),hs(n,r,{height:0,customHeight:!0}),this.parent.notify(mt,{eventArgs:{index:r,height:"0px",isCol:!1,sheetIndex:this.parent.activeSheetIndex,oldHeight:p},action:"resize"});return}if(this.setRowHeight(r,i,f+"px",p),this.parent.notify(Yy,{rowIndex:r}),this.trgtEle.parentElement.style.display==="none"){var v=this.parent.getActiveSheet(),m=tt(J(v.selectedRange));if(r<=m[2]&&r>m[0]){f=li(v,r);for(var y=void 0,S=m[0];S<=m[2];S++)S!==r&&(p=li(v,S)+"px",hs(v,S,{customHeight:!0,height:f}),st(v,S)?y||(y=S):(this.parent.getRow(S).style.height=f+"px",v.showHeaders&&(this.parent.getRow(S,this.parent.getRowHeaderTable()).style.height=f+"px")),this.parent.notify(mt,{eventArgs:{index:S,height:f+"px",isCol:!1,sheetIndex:this.parent.activeSheetIndex,oldHeight:p},action:"resize"}));this.parent.hideRow(m[0],r-1,!1),this.showHideCopyIndicator(),i+=Math.abs(r-y)}else i!==0&&!st(v,r-1)?this.trgtEle.parentElement.previousElementSibling.classList.remove("e-hide-start"):i!==0&&this.trgtEle.parentElement.classList.add("e-hide-end"),this.parent.selectRange(v.selectedRange);this.trgtEle.parentElement.style.display="",this.parent.getContentTable().rows[i].style.display=""}}else if(this.trgtEle.classList.contains("e-colresize")){this.isMouseMoved&&this.trgtEle.classList.contains("e-unhide-column")&&e.clientX<this.trgtEle.getBoundingClientRect().left&&(this.trgtEle.classList.remove("e-unhide-column"),this.trgtEle.previousElementSibling&&(this.trgtEle=this.trgtEle.previousElementSibling)),i=parseInt(this.trgtEle.getAttribute("aria-colindex"),10)-1;var b=void 0;this.trgtEle.classList.contains("e-unhide-column")?(i-=1,b=0):b=_r(this.parent.getActiveSheet(),i),this.setColWidth(i,this.parent.getViewportIndex(i,!0),(this.parent.enableRtl?this.event.clientX-e.clientX:e.clientX-this.event.clientX)+b,b)}a&&a.format&&a.format.includes("*")&&this.parent.notify(en,{value:a.value,format:a.format,cell:a,formattedText:a.value,rowIndex:s[0],colIndex:s[1]})},o.prototype.resizeStart=function(e,t,i,r,n,s,a){WI(e,t,i,r,this.parent);var l=n?"resizeToFit":"resize",h,u;r?(h={index:e,width:i,isCol:r,sheetIndex:this.parent.activeSheetIndex,oldWidth:s},u=s!==i):(h={index:e,height:i,isCol:r,sheetIndex:this.parent.activeSheetIndex,oldHeight:s,isPrevCustomHeight:a},u=s!==i),u&&this.parent.notify(mt,{eventArgs:h,action:l})},o.prototype.updateCursor=function(){this.parent.element.getElementsByClassName("e-colresize-handler")[0]?this.parent.element.classList.add("e-col-resizing"):this.parent.element.classList.contains("e-col-resizing")&&this.parent.element.classList.remove("e-col-resizing"),this.parent.element.getElementsByClassName("e-rowresize-handler")[0]?this.parent.element.classList.add("e-row-resizing"):this.parent.element.classList.contains("e-row-resizing")&&this.parent.element.classList.remove("e-row-resizing")},o.prototype.getFloatingElementWidth=function(e,t){var i=e,r={filterRange:[],hasFilter:!1};return this.parent.notify(Du,r),r.hasFilter&&r.filterRange&&r.filterRange[1]<=t&&r.filterRange[3]>=t&&(i=e+22),i},o.prototype.destroy=function(){this.unwireEvents(),this.removeEventListener(),this.trgtEle&&this.trgtEle.remove(),this.trgtEle=null,this.event=null,this.parent=null},o.prototype.getModuleName=function(){return"resize"},o.prototype.propertyChange=function(e){e.propertyName==="allowResizing"&&this.wireEvents()},o}(),Nq=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.hideShow=function(e){var t=this,i=Ee(e.sheetIndex)?this.parent.activeSheetIndex:e.sheetIndex,r=ke(this.parent,i);if(e.startIndex>e.endIndex){var n=e.startIndex;e.startIndex=e.endIndex,e.endIndex=n}if(e.actionUpdate!==void 0){var s=e.isCol?[0,e.startIndex,r.rowCount-1,e.endIndex]:[e.startIndex,0,e.endIndex,r.colCount-1];if(qi(this.parent,s)){e.actionUpdate&&this.parent.notify(nr,null);return}}var a;if(e.actionUpdate){if(e.sheetIndex=i,a={eventArgs:e,action:"hideShow"},this.parent.notify(ai,a),e.cancel)return;delete e.cancel}e.hide&&(e.hiddenIndexes=[]);var l=function(d){e.isCol?(t.hideCol(e),d&&t.parent.sheetModule.colWidthChanged({colIdx:e.startIndex,isHideShow:!0})):(t.hideRow(e),d&&t.parent.sheetModule.rowHeightChanged({rowIdx:e.startIndex,isHideShow:!0}))},h=e.isCol?this.parent.frozenColCount(r):this.parent.frozenRowCount(r);if(h&&e.startIndex<h){var u=void 0;if(e.freezePane=!0,e.endIndex>=h&&(u=e.endIndex,e.endIndex=h-1),l(!0),delete e.freezePane,u!==void 0){var c=e.startIndex;e.endIndex=u,e.startIndex=h,l(!this.parent.scrollSettings.enableVirtualization),e.startIndex=c}}else l(!this.parent.scrollSettings.enableVirtualization);e.actionUpdate&&(this.updateIndexOnlyForHiddenColumnsAndRows(e,r),this.parent.notify(mt,a),Fe(this.parent.element))},o.prototype.updateIndexOnlyForHiddenColumnsAndRows=function(e,t){for(var i=e.startIndex,r=e.endIndex,n,s=e.startIndex;s<=r;s++)if(n=e.isCol?Rt(t,s):Ar(t,s)||{},n.hidden===!1){e.startIndex=s;break}for(var a=e.endIndex;a>=i;a--)if(n=e.isCol?Rt(t,a):Ar(t,a)||{},n.hidden===!1){e.endIndex=a;break}},o.prototype.hideRow=function(e){var t=this,i=Ee(e.sheetIndex)?this.parent.activeSheetIndex:e.sheetIndex,r=ke(this.parent,i),n,s=0,a,l,h,u,c=Object.assign({},e),d=this.parent.scrollSettings.isFinite&&!c.freezePane,p;if(d){if(c.startIndex>=r.rowCount)return;c.endIndex>=r.rowCount&&(c.endIndex=r.rowCount-1),p=0}var f=this.parent.frozenRowCount(r);if(c.hide){for(var v=void 0,m,y=void 0,S=[],b=[],w=d&&c.endIndex===se(r,r.rowCount-1,!1),I=c.startIndex;I<=c.endIndex;I++){if(st(r,I)){c.isFiltering&&!Jn(r,I)&&hs(r,I,{isFiltered:!0});continue}if(a===void 0&&(c.freezePane?(m=this.parent.sheetModule.getSelectAllTable(),v=this.parent.getColHeaderTable()):(m=this.parent.getRowHeaderTable(),v=this.parent.getContentTable()),a=this.parent.getViewportIndex(I),s=0),u={hidden:!0},c.isFiltering&&(u.isFiltered=!0),c.isFiltering||(S=eh(this.parent)),hs(r,I,u),c.isFiltering||(b=eh(this.parent)),i===this.parent.activeSheetIndex)if(d&&(p+=li(r,I,!0,!0)),this.refreshChart(I,"rows"),c.isFiltering||this.refreshChartCellModel(S,b),y=v&&v.rows[a],y){if(!h){for(var x=0;x<=r.usedRange.colIndex;x++)if(n=G(I,x,r)||{},(n.colSpan||n.rowSpan)&&(c.startIndex>=this.parent.viewport.topIndex||this.parent.scrollSettings.enableVirtualization)){h=!0;break}}if(h)continue;if(m.rows[a]&&ee(m.rows[a]),ee(y),s++,y=v.rows[a],y&&I===c.endIndex){var M=void 0;l=se(r,I+1,!0);for(var D=l!==se(r,0,!0)&&l===(this.parent.viewport.topIndex>=c.startIndex?c.endIndex+1:this.parent.viewport.topIndex)?"Row":"",x=this.parent.viewport.leftIndex;x<=this.parent.viewport.rightIndex;x++){var A=this.parent.getCellStyleValue(["borderTop"],[l,x]).borderTop;A!==""&&(M=y.cells[x],this.parent.notify(Dr,{onActionUpdate:!1,rowIdx:l,colIdx:x,style:{borderTop:A},row:y,pRow:y.previousElementSibling,first:D,td:M}))}}}else I<=this.parent.viewport.bottomIndex?s++:s--}if(c.refreshUI)return;if(h&&(c.startIndex>=this.parent.viewport.topIndex||!this.parent.scrollSettings.enableVirtualization)){c.isFiltering?e.refreshUI=!0:(this.parent.selectRange(r.selectedRange),r.frozenRows||r.frozenColumns?(this.parent.renderModule.refreshSheet(!1,!1,!0),e.refreshUI=!0):this.parent.renderModule.refreshUI({rowIndex:this.parent.viewport.topIndex,colIndex:this.parent.viewport.leftIndex,refresh:"Row"}));return}if(!s)return;this.parent.selectRange(r.selectedRange);var L=function(){if(r.showHeaders){var Lt=c.freezePane?1:0;a===Lt?m.rows[Lt]&&m.rows[Lt].classList.add("e-hide-end"):(m&&m.rows[a-1]&&m.rows[a-1].classList.add("e-hide-start"),m&&m.rows[a]&&m.rows[a].classList.add("e-hide-end"))}};if(!c.freezePane&&this.parent.scrollSettings.enableVirtualization){var T=c.startIndex,k=c.startIndex;if(c.startIndex<Se(r.paneTopLeftCell)[0]||s>this.parent.viewport.rowCount){if(c.isFiltering){e.refreshUI=!0;return}this.parent.updateTopLeftCell(se(r,c.startIndex-1<f?f:c.startIndex-1,!0)-f,null,"col"),this.parent.renderModule.refreshSheet(!1,!1,!0)}else{T=this.parent.viewport.bottomIndex+1,k=T+s-1;var F=this.parent.skipHidden(T,k,"rows",!1);if(T=F[0],k=F[1],d)if(T>=r.rowCount){this.parent.viewport.topIndex+f===se(r,f,!0)?(L(),this.parent.notify(hu,{isHide:!0,height:p}),w&&(this.parent.viewport.bottomIndex=se(r,r.rowCount-1,!1))):this.parent.renderModule.refreshSheet(!1,!1,!0);return}else if(k>=r.rowCount){this.parent.renderModule.refreshSheet(!1,!1,!0);return}else this.parent.notify(hu,{isHide:!0,height:p});this.parent.viewport.bottomIndex=k;var R=void 0,N=this.parent.frozenColCount(r),P=[];N?(P.push(f),P.push(this.parent.viewport.leftIndex+N),R=Se(r.topLeftCell)[1]):R=this.parent.viewport.leftIndex,this.parent.renderModule.refreshUI({colIndex:R,rowIndex:T,direction:"",refresh:"RowPart",frozenIndexes:P},et(T,R)+":"+et(k,this.parent.viewport.rightIndex))}}L()}else{var O=void 0,z=void 0,H=void 0,y=void 0,Q=void 0,$=void 0,v=void 0,U=void 0,ie=void 0,ne=c.startIndex-1,te=[],oe=c.freezePane,ae="lastElementChild",ye=0,De=this.parent.viewport.topIndex+f;if(d){var ve=se(r,r.rowCount-1,!1);if(this.parent.viewport.bottomIndex===ve)if(De===se(r,f,!0))oe=!0;else{var ue=J(r.paneTopLeftCell)[0],Tt=r.rowCount-1-ue+1-this.parent.hiddenCount(ue,r.rowCount-1);Tt<this.parent.viewport.rowCount+Math.round(this.parent.getThreshold("row")/2)&&(ae="firstElementChild")}}for(var S=eh(this.parent),I=c.startIndex,_e=c.endIndex;I<=_e;I++){if(!(c.isFiltering?st(r,I):st(r,I)&&!Jn(r,I))){if(c.startIndex===c.endIndex)return;a===void 0?ne++:Q=I;continue}if(Q!==void 0){_e=I;continue}if(u={hidden:!1},c.isFiltering&&(u.isFiltered=!1),!oe&&I>this.parent.viewport.bottomIndex){if(hs(r,I,u),ie===void 0)return;continue}if(ie===void 0&&(ie=I),hs(r,I,u),i===this.parent.activeSheetIndex){d&&(p+=li(r,I,!0,!0)),this.refreshChart(I,"rows"),a===void 0&&(O=document.createDocumentFragment(),z=document.createDocumentFragment(),$=this.parent.serviceLocator.getService("row"),c.freezePane?(U=this.parent.sheetModule.getSelectAllTable(),v=this.parent.getColHeaderTable()):(U=this.parent.getRowHeaderTable(),v=this.parent.getContentTable(),I<this.parent.viewport.topIndex+f&&(this.parent.viewport.topIndex=I-f)),a=this.parent.getViewportIndex(I)),ne++,H=$.refresh(I,null,null,!0,!0),O.appendChild(H),U&&U.rows.length&&!oe&&ee(U.tBodies[0][""+ae]),y=z.appendChild($.refresh(I,y,H)),v&&v.rows.length&&!oe&&(ee(v.tBodies[0][""+ae]),ae==="firstElementChild"&&(a!==void 0&&a-1>-1&&(a-=1),ye+=li(r,this.parent.viewport.topIndex,!0),this.parent.viewport.topIndex=se(r,this.parent.viewport.topIndex+1,!0)));for(var x=this.parent.viewport.leftIndex;x<=this.parent.viewport.rightIndex;x++)if(n=G(I,x,r)||{},n.rowSpan!==void 0||n.colSpan!==void 0){var lt={range:[I,x,I,x],isAction:!1,merge:!0,type:"All",skipChecking:!0};this.parent.notify(ur,lt),(!te.length||lt.range[1]!==te[te.length-1].range[1]||lt.range[0]!==te[te.length-1].range[0])&&te.push(lt)}}}var b=eh(this.parent);if(this.refreshChartCellModel(S,b),a===void 0)return;var We=void 0;if(!c.freezePane){if(c.isFiltering&&c.startIndex<Se(r.paneTopLeftCell)[0]&&(e.refreshUI=!0,Q===void 0||Q===c.endIndex))return;var ct=this.parent.viewport.bottomIndex;this.parent.viewport.bottomIndex=this.parent.viewport.topIndex+f+this.parent.viewport.rowCount+this.parent.getThreshold("row")*2;var Dt=this.parent.hiddenCount(c.endIndex+1,this.parent.viewport.bottomIndex);s=this.parent.hiddenCount(this.parent.viewport.topIndex+f,c.startIndex)+Dt,this.parent.viewport.bottomIndex+=s,d&&this.parent.viewport.bottomIndex>=r.rowCount&&(this.parent.viewport.bottomIndex=se(r,r.rowCount-1,!1)),!c.isFiltering&&ie>=De&&ie<=ct&&ie>this.parent.viewport.bottomIndex-Dt-Math.abs(ne-ie)&&(We=!0)}if(c.insertIdx=e.insertIdx=a,c.row=e.row=z.querySelector(".e-row"),c.mergeCollection=e.mergeCollection=te,r.showHeaders&&(e.hdrRow=c.hdrRow=O.querySelector(".e-row"),a!==0&&!st(r,ne-1)&&U.rows[a-1]&&U.rows[a-1].classList.remove("e-hide-start"),c.startIndex!==0&&st(r,c.startIndex-1)&&c.hdrRow.classList.add("e-hide-end"),st(r,ne+1)?O.lastElementChild.classList.add("e-hide-start"):U.rows[a]&&U.rows[a].classList.remove("e-hide-end")),y&&v&&v.rows[a]){l=se(r,ne+1,!0);for(var I=this.parent.viewport.leftIndex;I<=this.parent.viewport.rightIndex;I++){var A=this.parent.getCellStyleValue(["borderTop"],[l,I]).borderTop;if(A!==""){this.parent.notify(Dr,{onActionUpdate:!1,rowIdx:l,colIdx:I,style:{borderTop:A},pRow:y,td:v.rows[a].cells[I],first:""});var Xt=se(r,ie-1,!1);Xt>-1?v.rows[a-1]&&!this.parent.getCellStyleValue(["borderBottom"],[Xt,I]).borderBottom&&!this.parent.getCellStyleValue(["borderTop"],[ie,I]).borderTop&&(v.rows[a-1].cells[I].style.borderBottom=""):v.rows[a].cells[I].style.borderTop=""}}}if(c.skipAppend)return;d&&this.parent.notify(hu,{height:p,size:ye}),We||Math.abs(ne-ie)>this.parent.viewport.rowCount+this.parent.getThreshold("row")*2?this.parent.renderModule.refreshSheet(!1,!1,!0):(U&&(U.tBodies[0].rows.length?U.tBodies[0].insertBefore(O,U.rows[a]):U.tBodies[0].appendChild(O)),v&&v.tBodies[0]&&(v.tBodies[0].rows.length?v.tBodies[0].insertBefore(z,v.rows[a]):v.tBodies[0].appendChild(z)),this.parent.selectRange(r.selectedRange),c.autoFit&&r.showHeaders&&this.parent.notify(aI,{startIndex:c.startIndex,endIndex:c.endIndex,isRow:!0}),te.forEach(function(Ei){t.parent.notify(Mn,Ei)}),Q!==void 0&&Q!==c.endIndex&&(c.startIndex=Q,this.hideRow(c)))}},o.prototype.hideCol=function(e){for(var t=this,i=Ee(e.sheetIndex)?this.parent.activeSheetIndex:e.sheetIndex,r=ke(this.parent,i),n=[],s=[],a=Se(r.paneTopLeftCell),l=this.parent.frozenColCount(r),h=this.parent.frozenRowCount(r),u=this.parent.viewport.leftIndex+l,c,d=se(r,r.colCount-1,!1,"columns"),p=e.startIndex;p<=e.endIndex;p++){if(e.hide){if(Ot(r,p))continue}else if(!Ot(r,p)||e.hiddenIndexes&&e.hiddenIndexes.indexOf(p)===-1)continue;var f=eh(this.parent);ch(r,p,{hidden:e.hide});var v=eh(this.parent);if(this.refreshChart(p,"columns"),this.refreshChartCellModel(f,v),this.parent.scrollSettings.enableVirtualization&&!e.freezePane&&(p<u||p>this.parent.viewport.rightIndex&&(!this.parent.scrollSettings.isFinite||!(d===this.parent.viewport.rightIndex&&p>=d&&p<r.colCount)))){p<u&&s.push(p);continue}n.push(p),e.hide&&(e.hiddenIndexes.push(p),p<=a[1]&&(c=!0))}if(!(!s.length&&!n.length)&&i===this.parent.activeSheetIndex){var m=Se(r.topLeftCell),y,S,b=function(){var F;return t.parent.scrollSettings.enableVirtualization?F=[h?m[0]:t.parent.viewport.topIndex,t.parent.viewport.bottomIndex]:F=[0,r.rowCount-1],e.freezePane?(y=t.parent.getRowHeaderTable(),S=t.parent.sheetModule.getSelectAllTable()):(y=t.parent.getContentTable(),S=t.parent.getColHeaderTable()),F};if(e.hide){if(!n.length)return;if((n.length<=this.parent.getThreshold("col")||!this.parent.scrollSettings.enableVirtualization||e.freezePane)&&this.removeCell(r,n,b(),y,S),!e.freezePane&&this.parent.scrollSettings.enableVirtualization){if(c){this.parent.updateTopLeftCell(null,se(r,n[0]-1<l?l:n[0]-1,!0,"columns")-l,"row"),this.parent.renderModule.refreshSheet(!1,!1,!0);return}var w=[],I=this.parent.viewport.topIndex,x=h?m[0]:I;if(h&&(w=[h+I,l]),this.parent.scrollSettings.isFinite){var M=se(r,r.colCount-1,!1,"columns"),D=this.parent.viewport.leftIndex+l,A=this.parent.viewport.rightIndex;if(A+n.length>=M){var L=se(r,D-(A+n.length-M),!1,"columns");L>=l&&(this.parent.viewport.leftIndex=L,this.parent.viewport.leftIndex-=this.parent.hiddenCount(A,M)),this.parent.viewport.rightIndex=M,D!==this.parent.viewport.leftIndex+l||A!==this.parent.viewport.rightIndex?(this.parent.renderModule.refreshUI({colIndex:this.parent.viewport.leftIndex,refresh:"Column",frozenIndexes:w,rowIndex:x,skipUpdateOnFirst:this.parent.viewport.leftIndex+l===se(r,l,!0,"columns")}),h&&(this.parent.viewport.topIndex=I)):this.parent.notify(EI,{refresh:"Column",isUpdate:!0}),this.parent.selectRange(r.selectedRange);return}}if(n.length<=this.parent.getThreshold("col")){var T=this.parent.skipHidden(this.parent.viewport.rightIndex+1,this.parent.viewport.rightIndex+n.length,"columns");this.parent.viewport.rightIndex=T[1],this.parent.renderModule.refreshUI({rowIndex:x,colIndex:T[0],direction:"",refresh:"ColumnPart",frozenIndexes:w},""+Be([x,T[0],this.parent.viewport.bottomIndex,T[1]]))}else this.parent.renderModule.refreshUI({skipUpdateOnFirst:this.parent.viewport.leftIndex+l===se(r,l,!0,"columns"),rowIndex:x,colIndex:this.parent.viewport.leftIndex,refresh:"Column",frozenIndexes:w}),h&&(this.parent.viewport.topIndex=I)}this.parent.selectRange(r.selectedRange)}else{if(s.length&&this.parent.scrollSettings.enableVirtualization){s.sort(function(F,R){return F-R});var k=s[0]-1<l?l:s[0]-1;this.parent.updateTopLeftCell(null,se(r,k,!0,"columns")-l,"row"),this.parent.renderModule.refreshSheet(!1,!1,!0),e.autoFit&&(e.autoFit=!1);return}(!this.parent.scrollSettings.isFinite||this.parent.viewport.rightIndex<d)&&(n.length<=this.parent.getThreshold("col")||!this.parent.scrollSettings.enableVirtualization||e.freezePane)?(this.appendCell(r,n,b(),y,S,e.freezePane),this.parent.scrollSettings.enableVirtualization&&!e.freezePane&&this.parent.notify(Wa,{refresh:"Column",prevRowColCnt:{rowCount:r.rowCount,colCount:r.colCount}}),this.parent.selectRange(r.selectedRange)):this.parent.renderModule.refreshSheet(!1,!1,!0)}}},o.prototype.removeCell=function(e,t,i,r,n){var s=this,a=i[0],l=i[1],h=0,u=t.length-1,c=this.parent.frozenRowCount(e),d=r.getElementsByTagName("colgroup")[0],p=this.parent.getViewportIndex(t[0],!0)+1,f=se(e,c-1,!1),v,m,y,S,b;for(e.showHeaders&&(y=n.getElementsByTagName("colgroup")[0],v=n.rows[0]);a<=l;){if(st(e,a)){a++;continue}m=c&&a<c?n.rows[h+1]:r.rows[h],t.forEach(function(w,I){if(h===0&&a>=c&&(e.showHeaders&&(ee(y.children[p]),ee(v.cells[p])),ee(d.children[p])),ee(m.cells[p]),I===0&&(S=G(a,w,e,!1,!0),(S.colSpan!==void 0&&(S.rowSpan===void 0||S.colSpan>1)||S.rowSpan<0&&a-1>-1&&st(e,a-1)&&Math.abs(S.rowSpan)===s.parent.hiddenCount(a+S.rowSpan,a,"rows",e))&&s.parent.notify(sb,{rowIdx:a,colIdx:w,model:"col",start:t[0],end:t[u]})),I===u){b=se(e,w+1,!0,"columns");var x=s.parent.getCellStyleValue(["borderLeft"],[h,b]).borderLeft;x!==""&&s.parent.notify(Dr,{onActionUpdate:!1,rowIdx:h,colIdx:b,style:{borderLeft:x},row:m,first:""}),S=G(a,w,e)||{},(S.colSpan!==void 0&&(S.rowSpan===void 0||S.colSpan>1)||S.rowSpan<0&&a-1>-1&&st(e,a-1)&&Math.abs(S.rowSpan)===s.parent.hiddenCount(a+S.rowSpan,a,"rows",e))&&s.parent.notify(sb,{rowIdx:a,colIdx:w,model:"col",start:t[0],end:t[u],isEnd:!0})}}),c&&a===f?(h=0,a=this.parent.viewport.topIndex+c):(h++,a++)}p-1>-1&&e.showHeaders&&v.cells[p-1]&&v.cells[p-1].classList.add("e-hide-start"),e.showHeaders&&v.cells[p]&&v.cells[p].classList.add("e-hide-end")},o.prototype.appendCell=function(e,t,i,r,n,s){var a=this,l=i[0],h=i[1],u=0,c=t.length-1,d,p,f,v,m=this.parent.frozenRowCount(e),y=r.getElementsByTagName("colgroup")[0];e.showHeaders&&(f=n.getElementsByTagName("colgroup")[0],d=n.rows[0]);var S=this.parent.serviceLocator.getService("cell");t.sort(function(L,T){return L-T});for(var b=[],w=[],I,x,M,D=se(e,m-1,!1),A;l<=h;){if(st(e,l)){l++;continue}p=m&&l<m?n.rows[u+1]:r.rows[u],t.forEach(function(L,T){if(u===0&&(w[T]=a.parent.getViewportIndex(L,!0),e.showHeaders&&(x=d.cells[w[T]],x&&(T===0&&t[T]&&!Ot(e,t[T]-1)&&x.previousSibling&&x.previousElementSibling.classList.remove("e-hide-start"),T===c&&x.classList.remove("e-hide-end"))),l>=m&&(y.children[w[T]]?(y.insertBefore(a.parent.sheetModule.updateCol(e,L),y.children[w[T]]),e.showHeaders&&S.renderColHeader(L,d,x)):(y.appendChild(a.parent.sheetModule.updateCol(e,L)),e.showHeaders&&S.renderColHeader(L,d)),s||(ee(y.lastChild),e.showHeaders&&ee(d.lastChild)),e.showHeaders&&T===c&&(ee(f),n.insertBefore(y.cloneNode(!0),n.tHead)))),s||ee(p.lastChild),x=p.cells[w[T]],A={rowIdx:l,colIdx:L,cell:G(l,L,e),row:p,address:et(l,L),lastCell:L===c,isHeightCheckNeeded:!0,first:L!==se(e,0,!0,"columns")&&L===a.parent.viewport.leftIndex?"Column":"",checkNextBorder:T===c?"Column":"",checkCF:!0},x&&(A.refChild=x),I=S.render(A),T===0&&I.previousSibling){var k=a.parent.getCellStyleValue(["borderLeft"],[u,se(e,t[t.length-1]+1,!0,"columns")]).borderLeft;k!==""&&(v=se(e,t[0]-1,!1,"columns"),v>-1&&!a.parent.getCellStyleValue(["borderRight"],[u,v]).borderRight&&!a.parent.getCellStyleValue(["borderLeft"],[u,t[0]]).borderLeft&&(I.previousSibling.style.borderRight=""))}if(M=G(l,L,e)||{},M.colSpan!==void 0&&(M.rowSpan===void 0||M.colSpan>1)||M.rowSpan<0&&l-1>-1&&st(e,l-1)&&Math.abs(M.rowSpan)===a.parent.hiddenCount(l+M.rowSpan,l,"rows",e)){var F={range:[l,L,l,L],isAction:!1,merge:!0,type:"All",skipChecking:!0};a.parent.notify(ur,F),(!b.length||F.range[1]!==b[b.length-1].range[1]||F.range[0]!==b[b.length-1].range[0])&&b.push(F)}}),m&&l===D?(l=this.parent.viewport.topIndex+m,u=0):(l++,u++)}b.forEach(function(L){a.parent.notify(Mn,L)}),this.parent.viewport.rightIndex=se(e,this.parent.viewport.rightIndex-t.length,!1,"columns")},o.prototype.refreshChart=function(e,t){this.parent.notify(lh,{rIdx:e,showHide:t})},o.prototype.refreshChartCellModel=function(e,t){this.parent.notify(hb,{prevChartIndexes:e,currentChartIndexes:t})},o.prototype.addEventListener=function(){this.parent.on(Dn,this.hideShow,this),this.parent.on(Un,this.destroy,this)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.off(Dn,this.hideShow),this.parent.off(Un,this.destroy)},o}(),Fq=function(){function o(e){this.divElements=[],this.inputElements=[],this.parent=e,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(Rf,this.initiateHyperlinkHandler,this),this.parent.on(Pf,this.editHyperlinkHandler,this),this.parent.on(oI,this.openHyperlinkHandler,this),this.parent.on(yu,this.hyperlinkClickHandler,this),this.parent.on(hI,this.createHyperlinkEle,this),this.parent.on(ds,this.keyUpHandler,this),this.parent.on(ny,this.removeHyperlink,this),this.parent.on(zf,this.removeHyperlinkHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Rf,this.initiateHyperlinkHandler),this.parent.off(Pf,this.editHyperlinkHandler),this.parent.off(oI,this.openHyperlinkHandler),this.parent.off(yu,this.hyperlinkClickHandler),this.parent.off(hI,this.createHyperlinkEle),this.parent.off(ds,this.keyUpHandler),this.parent.off(ny,this.removeHyperlink),this.parent.off(zf,this.removeHyperlinkHandler))},o.prototype.getModuleName=function(){return"spreadsheetHyperlink"},o.prototype.keyUpHandler=function(e){var t=e.target;if(j(t,".e-document")){var i=document.querySelector(".e-hyp-text"),r=this.parent.element.querySelector(".e-hyperlink-alert-span"),n=j(t,".e-hyperlink-dlg")||j(t,".e-edithyperlink-dlg"),s=n.getElementsByClassName("e-footer-content")[0],a=s.firstChild;i&&!g(i.value)&&(Mr(i.value.toUpperCase())?r&&(r.remove(),a.removeAttribute("disabled")):(this.showDialog(),a.setAttribute("disabled","true")))}if(t.classList.contains("e-text")&&j(t,".e-cont")&&j(t,".e-webpage")&&j(t,".e-webpage").getElementsByClassName("e-cont")[1]===t.parentElement){var l=j(t,".e-hyperlink-dlg")||j(t,".e-edithyperlink-dlg"),h=l.getElementsByClassName("e-footer-content")[0],a=h.firstChild;if(t.value!=="")a.removeAttribute("disabled");else{var u=j(t,".e-link-dialog"),c=u.querySelector(".e-webpage"),d=!!c.querySelectorAll(".e-cont")[1].querySelector(".e-text").value;d||a.setAttribute("disabled","true")}}},o.prototype.initiateHyperlinkHandler=function(){var e=this,t=this.parent.getActiveSheet();if(t.isProtected&&(!t.protectSettings.insertLink||ko(this.parent))){this.parent.notify(ba,null);return}if(qi(this.parent)){this.parent.notify(nr,null);return}var i=this.parent.serviceLocator.getService(fe);if(!this.parent.element.querySelector(".e-hyperlink-dlg")){var r=this.parent.serviceLocator.getService(jt),n;r.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-hyperlink-dlg",header:i.getConstant("InsertLink"),beforeOpen:function(s){var a={dialogName:"InsertLinkDialog",element:s.element,target:s.target,cancel:s.cancel};if(e.parent.trigger("dialogBeforeOpen",a),a.cancel){s.cancel=!0;return}r.dialogInstance.content=e.hyperlinkContent(),n=r.dialogInstance.content.querySelector(".e-text").value,r.dialogInstance.dataBind(),Fe(e.parent.element)},open:function(){setTimeout(function(){Fe(r.dialogInstance.element.querySelectorAll(".e-webpage input")[1])})},beforeClose:this.dialogBeforeClose.bind(this),buttons:[{buttonModel:{content:i.getConstant("Insert"),isPrimary:!0,disabled:!0},click:function(){e.dlgClickHandler(n),r.hide()}}]})}},o.prototype.dialogBeforeClose=function(){var e=this.headerTabs;e&&e.element&&(e.destroy(),e.element.remove()),this.headerTabs=null,us(this.inputElements),this.inputElements=[],us(this.divElements),this.divElements=[]},o.prototype.dlgClickHandler=function(e){var t,i,r=this.parent.getActiveSheet(),n=r.name+"!"+r.selectedRange,s=this.parent.element.querySelector(".e-link-dialog").getElementsByClassName("e-content")[0].querySelector(".e-item.e-active");if(s)if(t=s.getElementsByClassName("e-cont")[0].querySelector(".e-text").value,t===e&&(t=null),s.querySelector(".e-webpage")){i=s.getElementsByClassName("e-cont")[1].querySelector(".e-text").value;var a={address:i};this.parent.insertHyperlink(a,n,t,!1)}else{i=s.getElementsByClassName("e-cont")[1].querySelector(".e-text").value;var l=s.getElementsByClassName("e-cont")[2];if(l.getElementsByClassName("e-list-item")[0].querySelector(".e-active")){var h=s.getElementsByClassName("e-cont")[2].querySelector(".e-active").textContent;i=h+"!"+i.toUpperCase();var a={address:i};this.parent.insertHyperlink(a,n,t,!1)}else if(l.querySelector(".e-active")){for(var u=s.getElementsByClassName("e-cont")[2].querySelector(".e-active").textContent,c=0;c<this.parent.definedNames.length;c++)if(this.parent.definedNames[c].name===u){var a={address:this.parent.definedNames[c].name};this.parent.insertHyperlink(a,n,t,!1)}}}},o.prototype.showDialog=function(){this.parent.element.querySelector(".e-hyperlink-alert-span")&&this.parent.element.querySelector(".e-hyperlink-alert-span").remove();var e=this.parent.serviceLocator.getService(fe),t=this.parent.createElement("span",{className:"e-hyperlink-alert-span"});t.innerText=e.getConstant("HyperlinkAlert");var i=this.parent.element.querySelector(".e-hyperlink-dlg")||this.parent.element.querySelector(".e-edithyperlink-dlg");i.querySelector(".e-dlg-content").appendChild(t)},o.prototype.editHyperlinkHandler=function(){var e=this,t=this.parent.serviceLocator.getService(fe),i=this.parent.serviceLocator.getService(jt),r;i.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-edithyperlink-dlg",header:t.getConstant("EditLink"),beforeOpen:function(n){var s={dialogName:"EditLinkDialog",element:n.element,target:n.target,cancel:n.cancel};if(e.parent.trigger("dialogBeforeOpen",s),s.cancel){n.cancel=!0;return}i.dialogInstance.content=e.hyperEditContent(),r=i.dialogInstance.content.querySelector(".e-text").value,i.dialogInstance.dataBind(),Fe(e.parent.element)},open:function(){setTimeout(function(){i.dialogInstance.element.querySelector(".e-webpage")?Fe(i.dialogInstance.element.querySelectorAll(".e-webpage input")[1]):Fe(i.dialogInstance.element.querySelectorAll(".e-document input")[1])})},buttons:[{buttonModel:{content:t.getConstant("Update"),isPrimary:!0},click:function(){e.dlgClickHandler(r),i.hide()}}]})},o.prototype.openHyperlinkHandler=function(){var e=Se(this.parent.getActiveSheet().activeCell),t=this.parent.getCell(e[0],e[1]);t.getElementsByClassName("e-hyperlink")[0]&&(t=t.querySelector(".e-hyperlink")),this.hlOpenHandler(t)},o.prototype.hlOpenHandler=function(e,t,i){var r=this;if(e.classList.contains("e-hyperlink")){var n=j(e,".e-cell");if(!n)return;var s=["",""],a=void 0,l=!0,h=this.parent.getActiveSheet(),u=parseInt(n.getAttribute("aria-colindex"),10)-1,c=parseInt(n.parentElement.getAttribute("aria-rowindex"),10)-1,d=G(c,u,h,!1,!0);d.style&&d.style.color==="#00e"&&(sr(this.parent,h,{rowIdx:c,colIdx:u,preventEvt:!0,cell:{style:{color:"#551a8b"}}}),n.style.color="#551a8b");var p=d.hyperlink,f=void 0,v={hyperlink:p,address:h.activeCell,target:"_blank",cancel:!1};if(this.parent.trigger(I6,v),v.cancel){i&&i.preventDefault();return}p=v.hyperlink;var m={hyperlink:p,address:h.activeCell};typeof p=="string"&&(f=p),typeof p=="object"&&(f=p.address);var y=f;if(f.indexOf("http://")===-1&&f.indexOf("https://")===-1&&f.indexOf("ftp://")===-1){if(!g(f)){if(this.parent.definedNames){for(var S=0;S<this.parent.definedNames.length;S++)if(this.parent.definedNames[S].name===f){f=this.parent.definedNames[S].refersTo,f=f.slice(1);break}}f.lastIndexOf("!")!==-1?(s[0]=f.substring(0,f.lastIndexOf("!")),s[0].startsWith("'")&&s[0].endsWith("'")&&(s[0]=s[0].slice(1,s[0].length-1)),s[1]=f.substring(f.lastIndexOf("!")+1)):(s[0]=this.parent.getActiveSheet().name,s[1]=f);for(var b,S=0;S<this.parent.sheets.length;S++)this.parent.sheets[S].name===s[0]&&(b=S);if(h=this.parent.sheets[b],s[1].indexOf(":")!==-1){var w=s[1].indexOf(":"),I=s[1].substr(0,w),x=s[1].substr(w+1,s[1].length);I=I.replace("$",""),x=x.replace("$",""),x.match(/\D/g)&&!x.match(/[0-9]/g)&&I.match(/\D/g)&&!I.match(/[0-9]/g)?(I=I+"1",x=x+h.rowCount,s[1]=I+":"+x):!x.match(/\D/g)&&x.match(/[0-9]/g)&&!I.match(/\D/g)&&I.match(/[0-9]/g)&&(a=[parseInt(I,10)-1,0,parseInt(x,10)-1,h.colCount-1],l=!1)}var M=void 0,D=this.parent.definedNames;if(!g(D)){for(var S=0;S<D.length;S++)if(D[S].name===y){M=!0;break}}if(Mr(s[1])||M){if(a=l?J(s[1]):a,!g(h)){var A=Be(a);if(h===this.parent.getActiveSheet())cr(function(){r.parent.goTo(A)});else{if(A.indexOf(":")>=0){var L=A.split(":");A=L[0]===L[1]?L[0]:A}cr(function(){r.parent.goTo(r.parent.sheets[b].name+"!"+A)})}}}else this.showInvalidHyperlinkDialog()}}else t||(this.isValidUrl(f)?window.open(f,v.target):this.showInvalidHyperlinkDialog());this.parent.trigger(M6,m)}},o.prototype.isValidUrl=function(e){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)},o.prototype.showInvalidHyperlinkDialog=function(){var e=this.parent.serviceLocator.getService(jt),t=this.parent.serviceLocator.getService(fe);e.show({width:323,isModal:!0,showCloseIcon:!0,header:t.getConstant("Hyperlink"),content:t.getConstant("InvalidHyperlinkAlert"),buttons:[{buttonModel:{content:t.getConstant("Ok"),isPrimary:!0},click:function(){e.hide()}}]},!1)},o.prototype.hyperlinkClickHandler=function(e){var t=e.target;if(j(t,".e-link-dialog")&&j(t,".e-toolbar-item")){var i=j(t,".e-hyperlink-dlg")||j(t,".e-edithyperlink-dlg"),r=i.getElementsByClassName("e-footer-content")[0],n=r.firstChild,s=i.querySelector(".e-document"),a=i.querySelector(".e-webpage"),l=a?a.querySelectorAll(".e-cont")[0].querySelector(".e-text").value:s.querySelectorAll(".e-cont")[0].querySelector(".e-text").value,h=s?s.querySelectorAll(".e-cont")[0].querySelector(".e-text").value:l,u=j(t,".e-toolbar-items");if(u.getElementsByClassName("e-toolbar-item")[1].classList.contains("e-active")){var c=s.querySelectorAll(".e-cont")[2].querySelector(".e-active");s.querySelectorAll(".e-cont")[0].querySelector(".e-text").value=l,j(c,".e-list-item").classList.contains("e-level-2")&&n.hasAttribute("disabled")?n.removeAttribute("disabled"):j(c,".e-list-item").classList.contains("e-level-1")&&!n.hasAttribute("disabled")&&n.setAttribute("disabled","true")}else{var d=!a.querySelectorAll(".e-cont")[1].querySelector(".e-text").value;a.querySelectorAll(".e-cont")[0].querySelector(".e-text").value=h,d&&!n.hasAttribute("disabled")?n.setAttribute("disabled","true"):!d&&n.hasAttribute("disabled")&&n.removeAttribute("disabled")}}if(j(t,".e-list-item")&&t.classList.contains("e-fullrow")){var p=this.parent.element.getElementsByClassName("e-link-dialog")[0];if(p)p=p.getElementsByClassName("e-content")[0].getElementsByClassName("e-active")[0];else return;var f=p.getElementsByClassName("e-cont")[1].getElementsByClassName("e-text")[0],i=j(t,".e-hyperlink-dlg")||j(t,".e-edithyperlink-dlg"),r=i.getElementsByClassName("e-footer-content")[0],n=r.firstChild;j(t,".e-list-item").classList.contains("e-level-2")?j(t,".e-list-item").getAttribute("data-uid")==="defName"?(!f.classList.contains("e-disabled")&&!f.hasAttribute("readonly")&&(f.setAttribute("readonly","true"),f.classList.add("e-disabled"),f.setAttribute("disabled","true")),n.hasAttribute("disabled")&&n.removeAttribute("disabled")):j(t,".e-list-item").getAttribute("data-uid")==="sheet"&&(f.classList.contains("e-disabled")&&f.hasAttribute("readonly")&&(f.removeAttribute("readonly"),f.classList.remove("e-disabled"),f.removeAttribute("disabled")),Mr(f.value.toUpperCase())&&n.hasAttribute("disabled")&&n.removeAttribute("disabled")):j(t,".e-list-item").classList.contains("e-level-1")&&n.setAttribute("disabled","true")}else this.hlOpenHandler(t,!0,e)},o.prototype.createHyperlinkEle=function(e){var t=e.cell;if(!g(t.hyperlink)){var i=e.td,r=this.parent.createElement("a",{className:"e-hyperlink e-hyperlink-style"}),n=void 0;if(typeof t.hyperlink=="string"?(t.hyperlink.toLowerCase().indexOf("www.")===0&&(t.hyperlink="http://"+t.hyperlink),n=t.hyperlink):(n=t.hyperlink.address,n.toLowerCase().indexOf("www.")===0&&(t.hyperlink.address=n="http://"+n)),n.indexOf("http://")===0||n.indexOf("https://")===0||n.indexOf("ftp://")===0?(r.setAttribute("href",n),r.setAttribute("target","_blank")):(n.includes("=")||n.includes("!"))&&r.setAttribute("ref",n),Er(t.format)==="Accounting"?r.innerHTML=i.innerHTML:r.innerText=i.innerText!==""?i.innerText:n,i.textContent="",i.innerText="",(this.parent.autoFillSettings.fillType==="FillWithoutFormatting"||e.fillType==="FillWithoutFormatting"||e.action==="Clear Formats")&&(r.style.textDecoration="none"),i.appendChild(r),!e.style.color||!e.style.textDecoration){var s={};e.style.color||(e.style.color=s.color="#00e"),e.style.textDecoration||(e.style.textDecoration=s.textDecoration="underline"),sr(this.parent,this.parent.getActiveSheet(),{rowIdx:e.rowIdx,colIdx:e.colIdx,preventEvt:!0,cell:{style:s}})}}},o.prototype.hyperEditContent=function(){var e=!0,t=this.hyperlinkContent(),i=J(this.parent.getActiveSheet().activeCell),r=this.parent.sheets[this.parent.getActiveSheet().id-1].rows[i[0]].cells[i[1]];this.parent.scrollSettings.enableVirtualization&&(i[0]=i[0]-this.parent.viewport.topIndex,i[1]=i[1]-this.parent.viewport.leftIndex);var n=this.parent.getDisplayText(r),s,a=r.hyperlink;typeof a=="string"?(s=a,n=n||s,s.indexOf("http://")===-1&&s.indexOf("https://")===-1&&s.indexOf("ftp://")===-1&&(e=!1)):typeof a=="object"&&(s=a.address,n=n||s,s.indexOf("http://")===-1&&s.indexOf("https://")===-1&&s.indexOf("ftp://")===-1&&(e=!1));for(var l=0,h=0,u=this.parent.definedNames,c=this.parent.sheets,d=0,p=u.length;d<p;d++)u[d].name===s&&l++;for(var d=0,p=c.length;d<p;d++)s.includes(c[d].name)&&h++;l===0&&h===0&&(e=!0);var f=t.querySelector(".e-content");if(e){var v=f.querySelector(".e-webpage");if(v.getElementsByClassName("e-cont")[0].getElementsByClassName("e-text")[0].setAttribute("value",n),typeof a=="string")v.getElementsByClassName("e-cont")[1].querySelector(".e-text").setAttribute("value",a);else{var m=v.getElementsByClassName("e-cont")[1].querySelector(".e-text");m.setAttribute("value",a.address)}}else{var y=void 0,S=f.querySelector(".e-document");S.getElementsByClassName("e-cont")[0].getElementsByClassName("e-text")[0].setAttribute("value",n);var b=void 0,w=void 0;if(this.parent.definedNames){for(var d=0;d<this.parent.definedNames.length;d++)if(this.parent.definedNames[d].name===s){y=!0;break}}if(y){var I=S.getElementsByClassName("e-cont")[1].getElementsByClassName("e-text")[0];I.setAttribute("readonly","true"),I.classList.add("e-disabled"),I.setAttribute("disabled","true");for(var x=S.getElementsByClassName("e-cont")[2],M=x.querySelectorAll(".e-list-item.e-level-1")[1],d=0;d<M.getElementsByTagName("li").length;d++)M.getElementsByTagName("li")[d].innerText===s&&M.getElementsByTagName("li")[d].classList.add("e-active")}else{if(s&&s.lastIndexOf("!")!==-1){var D=s.lastIndexOf("!");b=s.substring(0,D),w=s.substring(D+1)}S.getElementsByClassName("e-cont")[1].querySelector(".e-text").setAttribute("value",w);for(var x=S.getElementsByClassName("e-cont")[2],M=x.querySelectorAll(".e-list-item.e-level-1")[0],d=0;d<M.getElementsByTagName("li").length;d++)if(M.getElementsByTagName("li")[d].innerText===b){if(M.getElementsByTagName("li")[d].classList.contains("e-active"))break;M.getElementsByTagName("li")[d].classList.add("e-active")}else M.getElementsByTagName("li")[d].classList.contains("e-active")&&M.getElementsByTagName("li")[d].classList.remove("e-active")}}return t},o.prototype.hyperlinkContent=function(){var e=this.parent.serviceLocator.getService(fe),t=0,i=0,r=!0,n,s=!0,a,l=J(this.parent.getActiveSheet().activeCell),h=this.parent.getActiveSheet(),u=G(l[0],l[1],h),c=!0;if(u){u.value&&typeof u.value=="string"&&u.value.match("[A-Za-z]+")!==null||u.value===""||g(u.value)?c=!0:c=!1;var d=u.hyperlink;if(typeof d=="string"){var p=d;p.indexOf("http://")===-1&&p.indexOf("https://")===-1&&p.indexOf("ftp://")===-1&&(a=d,r=!1)}else if(typeof d=="object"){var p=d.address;p.indexOf("http://")===-1&&p.indexOf("https://")===-1&&p.indexOf("ftp://")===-1&&(a=d.address,r=!1)}if(a){for(var f=0,v=0,m=this.parent.definedNames,y=this.parent.sheets,S=0,b=y.length;S<b;S++)a.includes(y[S].name)&&v++;for(var w=0,b=m.length;w<b;w++)m[w].name===a&&f++;f===0&&v===0&&(r=!0)}if(r?i=0:i=1,this.parent.definedNames){for(var I=0;I<this.parent.definedNames.length;I++)if(this.parent.definedNames[I].name===a){n=!0,s=!1;break}}}var x=this.parent.createElement("div",{className:"e-link-dialog"}),M=this.parent.createElement("div",{className:"e-webpage"}),D=this.parent.createElement("div",{className:"e-document"});this.headerTabs=new Zv({selectedItem:i,items:[{header:{text:e.getConstant("WebPage")},content:M},{header:{text:e.getConstant("ThisDocument")},content:D}]}),this.headerTabs.appendTo(x);var A=x.querySelector(".e-toolbar-items").querySelector(".e-indicator");r?A.style.cssText="left: 0; right: 136px":A.style.cssText="left: 136px; right: 0";var L=this.parent.createElement("div",{className:"e-cont"}),T=this.parent.createElement("div",{className:"e-cont"}),k=this.parent.createElement("div",{className:"e-header"});k.innerText=e.getConstant("DisplayText");var F=this.parent.createElement("div",{className:"e-header"});F.innerText=e.getConstant("Url");var R=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"Text"}});this.inputElements.push(R),c||(R.classList.add("e-disabled"),R.setAttribute("readonly","true"),R.setAttribute("disabled","true")),u&&g(u.hyperlink)&&R.setAttribute("value",this.parent.getDisplayText(u));var N=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"Text"}});this.inputElements.push(N),R.setAttribute("placeholder",e.getConstant("EnterTheTextToDisplay")),N.setAttribute("placeholder",e.getConstant("EnterTheUrl")),L.appendChild(R),L.insertBefore(k,R),T.appendChild(N),T.insertBefore(F,N),M.appendChild(T),M.insertBefore(L,T);var P=[],O=[],z=this.parent.sheets;for(t;t<this.parent.sheets.length;t++){var H=this.parent.sheets[t].name;this.parent.sheets[t].state==="Visible"&&(z[t]===this.parent.getActiveSheet()?P.push({nodeId:"sheet",nodeText:H.indexOf(" ")!==-1?"'"+H+"'":H,selected:!0}):P.push({nodeId:"sheet",nodeText:H.indexOf(" ")!==-1?"'"+H+"'":H}))}for(t=0;t<this.parent.definedNames.length;t++)O.push({nodeId:"defName",nodeText:this.parent.definedNames[t].name});var Q=[{nodeId:"01",nodeText:e.getConstant("CellReference"),expanded:s,nodeChild:P},{nodeId:"02",nodeText:e.getConstant("DefinedNames"),expanded:n,nodeChild:O}],$=new em({fields:{dataSource:Q,id:"nodeId",text:"nodeText",child:"nodeChild"}}),U=this.parent.createElement("div",{className:"e-cont"}),ie=this.parent.createElement("div",{className:"e-header"});ie.innerText=e.getConstant("CellReference");var ne=this.parent.createElement("input",{className:"e-input e-text e-hyp-text",attrs:{type:"Text"}});ne.setAttribute("value","A1"),this.inputElements.push(ne),U.appendChild(ne),U.insertBefore(ie,ne);var te=this.parent.createElement("div",{className:"e-cont"}),oe=this.parent.createElement("div",{className:"e-header"});oe.innerText=e.getConstant("DisplayText");var ae=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"Text"}});this.inputElements.push(ae),c||(ae.classList.add("e-disabled"),ae.setAttribute("readonly","true"),ae.setAttribute("disabled","true")),u&&g(u.hyperlink)&&ae.setAttribute("value",this.parent.getDisplayText(u)),ae.setAttribute("placeholder",e.getConstant("EnterTheTextToDisplay")),te.appendChild(ae),te.insertBefore(oe,ae);var ye=this.parent.createElement("div",{className:"e-cont"}),De=this.parent.createElement("div",{className:"e-header"});De.innerText=e.getConstant("Sheet");var ve=this.parent.createElement("div",{className:"e-refcont"});return this.divElements.push(L),this.divElements.push(T),this.divElements.push(k),this.divElements.push(F),this.divElements.push(U),this.divElements.push(ie),this.divElements.push(te),this.divElements.push(oe),this.divElements.push(ye),this.divElements.push(De),this.divElements.push(ve),this.divElements.push(D),this.divElements.push(M),this.divElements.push(x),ye.appendChild(ve),ye.insertBefore(De,ve),D.appendChild(U),D.insertBefore(te,U),$.appendTo(ve),D.appendChild(ye),x},o.prototype.removeHyperlink=function(e){var t=G(e.rowIdx,e.colIdx,e.sheet);t&&t.hyperlink&&(typeof t.hyperlink=="string"?t.value=t.value||t.value===0?t.value:t.hyperlink:t.value=t.value||t.value===0?t.value:t.hyperlink.address,delete t.hyperlink,t.style&&(delete t.style.textDecoration,delete t.style.color),t.validation&&t.validation.isHighlighted&&t.style.backgroundColor&&(t.style.color="#ff0000"),e.sheet===this.parent.getActiveSheet()&&(t.style&&this.parent.notify(Es,null),e.preventRefresh||this.parent.serviceLocator.getService("cell").refresh(e.rowIdx,e.colIdx,!1,null,!0,!1,cs(this.parent))))},o.prototype.removeHyperlinkHandler=function(e){var t=e.range,i,r=this.parent.getActiveSheet(),n;if(!e.preventEventTrigger){var s={address:t.indexOf("!")===-1?r.name+"!"+t:t,cancel:!1};if(this.parent.notify(ai,{action:"removeHyperlink",eventArgs:s}),s.cancel)return}if(t&&t.indexOf("!")!==-1){var a=t.lastIndexOf("!");i=t.substring(0,a);for(var l=this.parent.sheets,h=0;h<l.length;h++)l[h].name===i&&(n=h);r=this.parent.sheets[n],t=t.substring(a+1)}for(var u=J(t||r.activeCell),c,d,p=u[0];p<=u[2];p++)for(var f=u[1];f<=u[3];f++)if(r&&r.rows[p]&&r.rows[p].cells[f]){if(d=[],c=this.parent.getCell(p,f),c)for(var v=0;v<c.classList.length;v++)d.push(c.classList[v]);this.parent.notify(ny,{sheet:r,rowIdx:p,colIdx:f});for(var v=0;v<d.length;v++)c.classList.contains(d[v])||c.classList.add(d[v])}e.preventEventTrigger||this.parent.notify(mt,{action:"removeHyperlink",eventArgs:{address:t.indexOf("!")===-1?r.name+"!"+t:t}})},o}(),YI=function(){return YI=Object.assign||function(o){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r])}return o},YI.apply(this,arguments)},Oq=function(){function o(e){this.undoCollection=[],this.redoCollection=[],this.isUndo=!1,this.undoRedoStep=100,this.parent=e,this.addEventListener()}return o.prototype.setActionData=function(e){var t=this.parent.getActiveSheet(),i,r=[],n=[],s=e.args,a=s.eventArgs,l={};switch(s.action){case"format":i=J(s.eventArgs.range);break;case"clipboard":l=a.copiedInfo,i=J(cu(a.pastedRange)),l&&l.isCut&&(n=this.getCellDetails(l.range,ke(this.parent,cn(this.parent,l.sId)),"clipboard"));break;case"beforeSort":i=J(s.eventArgs.range),i[0]===i[2]&&i[2]-i[0]===0&&(i[0]=0,i[1]=0,i[2]=t.usedRange.rowIndex,i[3]=t.usedRange.colIndex);break;case"beforeCellSave":case"cellDelete":case"cellSave":case"addNote":case"editNote":case"deleteNote":i=J(a.address);break;case"beforeWrap":case"beforeReplace":case"chartDesign":i=this.parent.getAddressInfo(a.address).indices;break;case"beforeClear":i=J(a.range);break;case"beforeInsertImage":i=J(a.range);break;case"deleteImage":i=J(a.address);break;case"beforeInsertChart":i=J(a.range);break;case"filter":i=J(a.range);break;case"autofill":i=J(a.fillRange);break;case"validation":OO(a.range.substring(a.range.lastIndexOf("!")+1))?(i=J(a.range),i[2]=t.usedRange.rowIndex):i=J(a.range);break;case"removeValidation":if(a.isColSelected){this.beforeActionData={cellDetails:[]};for(var h=a.range.substring(a.range.lastIndexOf("!")+1).split(":"),u=vn(h[0]),c=vn(h[1]);u<=c;u++)t.columns[u]&&t.columns[u].validation&&this.beforeActionData.cellDetails.push({colIndex:u,validation:t.columns[u].validation})}else i=J(a.range);break;case"hyperlink":case"removeHyperlink":i=J(a.address);break}s.action==="beforeSort"?(this.beforeActionData={cellDetails:a.cellDetails},this.beforeActionData.sortedCellDetails=a.sortedCellDetails):i&&(s.isClearAction&&this.beforeActionData.cellDetails.length>0?r=this.beforeActionData.cellDetails:r=this.getCellDetails(i,t,s.action),this.beforeActionData={cellDetails:r,cutCellDetails:n})},o.prototype.getBeforeActionData=function(e){e.beforeDetails=this.beforeActionData},o.prototype.performUndoRedo=function(e){var t;e.isFromUpdateAction?t=e:(t=e.isUndo?this.undoCollection.pop():this.redoCollection.pop(),e.setCollection&&(e.undoArgs=t)),this.isUndo=e.isUndo;var i;if(t){var r=void 0,n=t.action,s={},a=[],l;if(t.action==="autofill"||t.action==="autofillWithCF"?a=t.eventArgs.fillRange.split("!"):t.action==="cellSave"||t.action==="cellDelete"?a=t.eventArgs.address.split("!"):t.action==="clipboard"&&(a=t.eventArgs.pastedRange.split("!")),a.length>0?l=ke(this.parent,yt(this.parent,a[0])):t.action==="clear"&&(l=ke(this.parent,t.eventArgs.sheetIndex)),t.action==="autofillWithCF"){t.action="autofill";var h=l.conditionalFormats;h[h.length-1].action==="autofillWithCF"&&e.isUndo&&(h[h.length-1].value?h.pop():this.parent.notify(qa,{range:h[h.length-1].range,isAction:!0}))}if(!e.isPublic){var u=t.eventArgs.beforeActionData;if(delete t.eventArgs.beforeActionData,r={action:t.action,eventArgs:{}},he(r.eventArgs,t.eventArgs,null,!0),this.parent.calculationMode==="Manual"&&(t.action==="clipboard"||t.action==="cellDelete"||t.action==="autofill"||t.action==="clear")){if(!e.isUndo)l.isSheetCalculated&&(u.cutCellDetails.length?u.cutCellDetails:u.cellDetails).forEach(function(w){var I=G(w.rowIndex,w.colIndex,l,!1,!0).value;(I||I===0)&&w.value!==I&&(w.value=I)});else if(t.eventArgs.requestType==="paste"&&t.action==="clipboard"||t.eventArgs.fillType){var c=void 0;if(u.cutCellDetails.length?l.isSheetCalculated&&(c="Cut"):c=t.eventArgs.fillType?"autofill":"Copy",c)for(var d=0,p=u.cellDetails,f=u.cutCellDetails;d<p.length;d++){var v=G(p[d].rowIndex,p[d].colIndex,l,!1,!0);v=v?v.value:"",c==="Copy"?p[d].copyCellValue=v:c==="autofill"?p[d].value!==v&&p[d].autoFillText!==v&&(p[d].autoFillText=v):c==="Cut"&&f[d].value!==v&&(f[d].value=v)}}}if(t.eventArgs.beforeActionData=u,r.eventArgs.cancel=!1,t.preventAction=r.preventAction=!0,e.isUndo){if(r.isUndo=!0,t.action==="cellSave"&&this.parent.calculationMode==="Manual"&&l.isSheetCalculated&&u.cellDetails.length===1){var m=G(u.cellDetails[0].rowIndex,u.cellDetails[0].colIndex,l);m&&t.eventArgs.displayText!==m.value&&(t.eventArgs.displayText=m.value)}}else r.isRedo=!0;if(e.isFromUpdateAction||this.parent.notify(ai,r),r.eventArgs.cancel){this.updateUndoRedoIcons();return}delete r.eventArgs.cancel}switch(t.action){case"cellSave":case"format":case"wrap":case"cellDelete":case"autofill":case"removeValidation":case"hyperlink":case"addNote":case"editNote":case"deleteNote":case"removeHyperlink":t=this.performOperation(t,e.preventEvt,e.preventReSelect,e.isFromAutoFillOption),t.action=n;break;case"sorting":this.undoForSorting(t,e.isUndo);break;case"clipboard":t=this.undoForClipboard(t,e.isUndo,r),i=!0;break;case"resize":case"resizeToFit":if(t=this.undoForResize(t),e.isUndo){var y=t.eventArgs;if(!y.isPrevCustomHeight){var S=this.parent.sheets[y.sheetIndex],b=S&&Ar(S,y.index);b&&b.customHeight&&delete b.customHeight}}break;case"hideShow":Zr(t,this.parent,!e.isUndo);break;case"replace":t=this.performOperation(t);break;case"replaceAll":t.eventArgs.isAction=!1,e.isUndo&&(s.value=t.eventArgs.replaceValue,s.replaceValue=t.eventArgs.value,s.skipFormatCheck=cs(this.parent)),this.parent.notify(ld,YI({},t.eventArgs,s));break;case"insert":case"filter":Zr(t,this.parent,!e.isUndo,null,r),i=t.action==="filter";break;case"delete":Zr(t,this.parent,!e.isUndo);break;case"validation":Zr(t,this.parent,!e.isUndo),t=this.performOperation(t);break;case"addHighlight":case"removeHighlight":Zr(t,this.parent,!e.isUndo);break;case"merge":t.eventArgs.merge=t.isFromUpdateAction?t.eventArgs.merge:!t.eventArgs.merge,Zr(t,this.parent,!e.isUndo);break;case"clear":t=this.performOperation(t),e.isUndo&&t.eventArgs.cfClearActionArgs&&Zr({action:"clearCF",eventArgs:t.eventArgs.cfClearActionArgs},this.parent,!e.isUndo);for(var d=this.undoCollection.length;d>0&&this.undoCollection[d-1].isClearAction;d--)this.performUndoRedo(e);break;case"conditionalFormat":Zr(t,this.parent,!e.isUndo,this.undoCollection);break;case"clearCF":Zr(t,this.parent,!e.isUndo);break;case"insertImage":case"deleteImage":Zr(t,this.parent,!e.isUndo);break;case"imageRefresh":Zr(t,this.parent,!e.isUndo);break;case"insertChart":case"deleteChart":Zr(t,this.parent,!e.isUndo);break;case"chartRefresh":Zr(t,this.parent,!e.isUndo);break;case"chartDesign":t.eventArgs.isUndo=e.isUndo,this.parent.notify(TI,t.eventArgs);break;case"addDefinedName":Zr(t,this.parent,!e.isUndo);break}e.isFromUpdateAction||(e.isUndo?this.redoCollection.push(t):this.undoCollection.push(t),this.undoCollection.length>this.undoRedoStep&&this.undoCollection.splice(0,1),this.redoCollection.length>this.undoRedoStep&&this.redoCollection.splice(0,1),this.updateUndoRedoIcons(),!e.isPublic&&!i&&this.parent.notify(mt,he({isUndoRedo:!0,isUndo:e.isUndo},t))),this.parent.notify(Es,null)}},o.prototype.undoForSorting=function(e,t){var i=this,r=Gs(this.parent,e.eventArgs.range),n=J(e.eventArgs.range),s=function(c,d){if(r===i.parent.activeSheetIndex){var p=i.parent.getCell(n[0]-1,i.parent.sortCollection[c].columnIndex);if(p&&(p=X(".e-filter-icon",p),p)){var f="e-sort"+(i.parent.sortCollection[c].order==="Ascending"?"asc":"desc")+"-filter";d?p.classList.add(f):p.classList.remove(f)}}};if(t){if(this.parent.notify(bx,{result:e.eventArgs.beforeActionData.cellDetails,range:n,sheet:ke(this.parent,r),jsonData:e.eventArgs.beforeActionData.sortedCellDetails,isUndo:!0}),this.parent.notify(ff,{range:e.eventArgs.range}),this.parent.sortCollection&&e.eventArgs.previousSort){for(var a=this.parent.sortCollection.length-1;a>=0;a--)if(this.parent.sortCollection[a].sheetIndex===r){s(a,!1),this.parent.sortCollection.splice(a,1);var l=e.eventArgs.previousSort;if(Array.isArray(l))for(var h=0;h<l.length;h++)this.parent.sortCollection.splice(h,0,l[h]),s(h,!0);this.parent.sortCollection.length||(this.parent.sortCollection=void 0);break}}}else if(Zr(e,this.parent,!0),e.eventArgs.previousSort){var u=0;if(this.parent.sortCollection)for(var a=this.parent.sortCollection.length-1;a>=0;a--)this.parent.sortCollection[a].sheetIndex===r&&(s(a,!1),u=a,this.parent.sortCollection.splice(a,1));else this.parent.sortCollection=[];this.parent.sortCollection.splice(u,0,{sortRange:e.eventArgs.range.substring(e.eventArgs.range.lastIndexOf("!")+1),sheetIndex:r,columnIndex:vn(e.eventArgs.sortOptions.sortDescriptors.field),order:e.eventArgs.sortOptions.sortDescriptors.order}),s(u,!0)}},o.prototype.updateUndoRedoCollection=function(e){var t=["clipboard","format","sorting","cellSave","resize","resizeToFit","wrap","hideShow","replace","validation","merge","clear","conditionalFormat","clearCF","insertImage","imageRefresh","insertChart","deleteChart","chartRefresh","filter","cellDelete","autofill","autofillWithCF","addDefinedName","removeValidation","removeHighlight","addHighlight","hyperlink","removeHyperlink","deleteImage","chartDesign","replaceAll","addNote","editNote","deleteNote"];(e.args.action==="insert"||e.args.action==="delete")&&e.args.eventArgs.modelType!=="Sheet"&&t.push(e.args.action);var i=e.args.action;if(!(t.indexOf(i)===-1&&!e.isPublic)){var r=e.args.eventArgs;if(i==="clipboard"||i==="sorting"||i==="format"||i==="cellSave"||i==="wrap"||i==="replace"||i==="validation"||i==="clear"||i==="conditionalFormat"||i==="clearCF"||i==="insertImage"||i==="imageRefresh"||i==="insertChart"||i==="chartRefresh"||i==="filter"||i==="cellDelete"||i==="autofill"||i==="autofillWithCF"||i==="removeValidation"||i==="addDefinedName"||i==="hyperlink"||i==="removeHyperlink"||i==="deleteImage"||i==="chartDesign"||i==="addNote"||i==="editNote"||i==="deleteNote"){var n={beforeDetails:{cellDetails:[]}};this.parent.notify(ox,n),r.beforeActionData=n.beforeDetails}if(i==="clipboard"&&r.copiedInfo&&r.copiedInfo.isExternal){var s=this.parent.getAddressInfo(r.pastedRange);r.copiedInfo.cellDetails=this.getCellDetails(s.indices,ke(this.parent,s.sheetIndex),i)}this.redoCollection.length>0&&this.redoCollection[this.redoCollection.length-1].action==="autofillWithCF"&&e.args.action==="autofill"&&(e.args.action="autofillWithCF"),this.undoCollection.push(e.args),this.redoCollection=[],this.undoCollection.length>this.undoRedoStep&&this.undoCollection.splice(0,1),this.updateUndoRedoIcons()}},o.prototype.clearUndoRedoCollection=function(){this.undoCollection=[],this.redoCollection=[],this.updateUndoRedoIcons()},o.prototype.updateUndoRedoIcons=function(){var e=this.parent.serviceLocator.getService(fe);this.parent.notify(da,[{tab:e.getConstant("Home"),items:[this.parent.element.id+"_undo"],enable:this.undoCollection.length>0}]),this.parent.notify(da,[{tab:e.getConstant("Home"),items:[this.parent.element.id+"_redo"],enable:this.redoCollection.length>0}])},o.prototype.updateUndoRedoSheetReferences=function(e){var t=function(i){i.forEach(function(r){var n=r.eventArgs;n&&["address","dataRange","fillRange"].forEach(function(s){n[s]&&n[s].includes(e.pName)&&(n[s]=n[s].replace(e.pName,e.value))})})};t(this.undoCollection),t(this.redoCollection)},o.prototype.undoForClipboard=function(e,t,i){var r=this,n=e.eventArgs,s=[];s[0]=n.pastedRange.substring(0,n.pastedRange.lastIndexOf("!")),s[1]=n.pastedRange.substring(n.pastedRange.lastIndexOf("!")+1);var a=J(s[1]),l=yt(this.parent,s[0]),h=ke(this.parent,l),u=n.copiedInfo,c=n.beforeActionData,d=e.isFromUpdateAction,p=l===this.parent.activeSheetIndex,f;if(i&&(i.isUndoRedo=!0,i.eventArgs.beforeActionData=c),e.eventArgs.requestType==="imagePaste"){var v=n.copiedShapeInfo;t?(f=v.pictureElem,v.isCut?(this.parent.notify(ga,{id:f.id,sheetIdx:n.pasteSheetIndex+1,isUndoRedo:!0}),this.parent.notify(Ya,{options:{src:f.style.backgroundImage.replace(/url\((['"])?(.*?)\1\)/gi,"$2"),height:v.height,width:v.width,id:f.id},range:v.copiedRange,isPublic:!1,isUndoRedo:!0})):this.parent.notify(ga,{id:n.pastedPictureElement.id,sheetIdx:n.pasteSheetIndex+1,isUndoRedo:!0})):v.isCut?(f=v.pictureElem,this.parent.notify(ga,{id:f.id,sheetIdx:v.sId,isUndoRedo:!0}),this.parent.notify(Ya,{options:{src:f.style.backgroundImage.replace(/url\((['"])?(.*?)\1\)/gi,"$2"),height:v.height,width:v.width,id:f.id},range:v.pastedRange,isPublic:!1,isUndoRedo:!0})):(f=n.pastedPictureElement,this.parent.notify(Ya,{options:{src:f.style.backgroundImage.replace(/url\((['"])?(.*?)\1\)/gi,"$2"),height:f.offsetHeight,width:f.offsetWidth,id:f.id},range:v.pastedRange,isPublic:!1,isUndoRedo:!0}))}else{if(t){if(u.isCut){var m=c.cutCellDetails;this.updateCellDetails(m,ke(this.parent,cn(this.parent,u.sId)),tt(u.range),p,e),n.cfClearActionArgs&&Zr({action:"clearCF",eventArgs:n.cfClearActionArgs},this.parent,!1)}c&&this.updateCellDetails(c.cellDetails,h,a,p,e,null,null,i?i.isUndoRedo:null),n.cfActionArgs&&n.cfActionArgs.cfModel.forEach(function(w){Zr({eventArgs:{range:w.range,type:w.type,cFColor:w.cFColor,value:w.value,sheetIdx:n.cfActionArgs.sheetIdx,cancel:!0},action:"conditionalFormat"},r.parent,!1)}),sh(h,a[0],a[1],li(h,a[0]));var y=Mo(h,a[0]);va(this.parent,h,y,a[0]),n.mergeCollection.forEach(function(w){w.merge=!w.merge,r.parent.notify(Mn,w),w.merge=!w.merge}),i&&!d&&this.parent.notify(mt,i)}else if(u.isExternal){var S=this.parent.getAddressInfo(n.pastedRange);this.updateCellDetails(u.cellDetails,ke(this.parent,S.sheetIndex),S.indices,!0,e,null,null,i?i.isUndoRedo:null),i&&!d&&this.parent.notify(mt,i)}else{var b=new Promise(function(I){I(function(){}())}),S=this.parent.getAddressInfo(n.copiedRange);this.parent.notify(n.copiedInfo.isCut?Cu:wu,{range:S.indices,sId:ke(this.parent,S.sheetIndex).id,promise:b,invokeCopy:!0,isPublic:!0,isFromUpdateAction:d}),b.then(function(){r.parent.notify(Ga,{range:s&&Qi(n.pastedRange),sIdx:s&&yt(r.parent,Ws(n.pastedRange)),type:n.type,isAction:!1,isInternal:!0,isFromUpdateAction:d,beforeActionData:n.beforeActionData,isUndo:t}),i&&!d&&r.parent.notify(mt,i)})}p&&!d?(this.parent.notify(Su,{address:n.selectedRange}),this.parent.notify(Za,{})):this.checkRefreshNeeded(l,d)}return e},o.prototype.undoForResize=function(e){var t=e.eventArgs;if(t.hide===void 0)if(t.isCol){var i=t.oldWidth;t.oldWidth=t.width,t.width=i}else{var i=t.oldHeight;t.oldHeight=t.height,t.height=i}else t.hide=!t.hide;Zr(e,this.parent,!1);var r=this.parent.getActiveSheet(),n=J(r.activeCell),s=G(n[0],n[1],r);if(s&&s.rowSpan){var a=this.parent.getCell(n[0],n[1]);this.parent.element.querySelector(".e-active-cell").style.height=a.offsetHeight+"px"}else if(s&&s.colSpan){var a=this.parent.getCell(n[0],n[1]);this.parent.element.querySelector(".e-active-cell").style.width=a.offsetWidth+"px"}return e},o.prototype.performOperation=function(e,t,i,r){var n=e.eventArgs,s=[],a=e.action==="cellSave"||e.action==="wrap"||e.action==="replace"||e.action==="cellDelete"||e.action==="hyperlink"||e.action==="addNote"||e.action==="editNote"||e.action==="deleteNote"||e.action==="removeHyperlink"?n.address:n.range;e.action==="autofill"?(s[0]=n.fillRange.substring(0,n.fillRange.lastIndexOf("!")),s[1]=n.fillRange.substring(n.fillRange.lastIndexOf("!")+1)):(s[0]=a.substring(0,a.lastIndexOf("!")),s[1]=a.substring(a.lastIndexOf("!")+1));var l=yt(this.parent,s[0]),h=ke(this.parent,l),u;if(n.isColSelected){var c=s[1].split(":");u=[0,vn(c[0]),h.rowCount-1,vn(c[1])]}else u=tt(J(s[1]));var d=u,p=n.beforeActionData,f=e.isFromUpdateAction,v=this.checkRefreshNeeded(l,f),m={cellIdx:[u[0],u[1]],isUnique:!1,uniqueRange:""};if(n.isColSelected||this.parent.notify(gu,m),this.isUndo){if(m.isUnique&&n.formula&&n.formula.indexOf("UNIQUE")>-1){var y=J(m.uniqueRange);if(G(y[0],y[1],this.parent.getActiveSheet()).value!=="#SPILL!")for(var S=y[0];S<=y[2];S++)for(var b=y[1];b<=y[3];b++)S===y[0]&&b===y[1]&&(b=b+1),this.parent.updateCellInfo({value:""},Be([S,b]),!0)}if(this.updateCellDetails(p.cellDetails,h,u,v,e,t,n.isColSelected,!0,r),m.isUnique&&e.action==="cellDelete"&&n.isSpill){for(var y=J(m.uniqueRange),w=G(y[0],y[1],this.parent.getActiveSheet()),I=y[0];I<=y[2];I++)for(var S=y[1];S<=y[3];S++)for(var b=u[0];b<=u[2];b++)for(var x=u[1];x<=u[3];x++)(I!==b||S!==x)&&this.parent.updateCellInfo({value:""},et(I,S),!0);w.value="#SPILL!",this.parent.updateCellInfo(w,et(y[0],y[1]),!0)}if(!n.isSpill&&m.uniqueRange!==""){for(var M=J(m.uniqueRange),S=M[0];S<=M[2];S++)for(var b=M[1];b<=M[3];b++)S===M[0]&&b===M[1]&&(b=b+1),this.parent.updateCellInfo({value:""},Be([S,b]),!0);this.parent.notify(gy,null)}}else{var D=e.eventArgs,A=J(h.activeCell),L=s[1]?s[1].split(":"):[];d[0]!==A[0]&&d[1]!==A[1]&&e.action==="hyperlink"&&L.length>0&&(h.activeCell=L[0],A=J(h.activeCell));var T=this.parent.getCellStyleValue(["textDecoration"],A).textDecoration;if(D&&D.style&&D.style.textDecoration){var k=D.style.textDecoration,F=k,R=void 0,N=!1;T==="underline"?F=k==="underline"?"none":"underline line-through":T==="line-through"?F=k==="line-through"?"none":"underline line-through":T==="underline line-through"&&(F=k==="underline"?"line-through":"underline",N=!0),F==="none"&&(N=!0),D.style.textDecoration=F,e.eventArgs=D;for(var I=d[0];I<=d[2];I++)for(var S=d[1];S<=d[3];S++){if(R={},T=this.parent.getCellStyleValue(["textDecoration"],[I,S]).textDecoration,T==="none"){if(N)continue;R.textDecoration=k}else if(T==="underline"||T==="line-through")if(N)if(k===T)R.textDecoration="none";else continue;else R.textDecoration=k!==T?"underline line-through":k;else if(T==="underline line-through")if(N)R.textDecoration=k==="underline"?"line-through":"underline";else continue;this.parent.notify(rr,{style:{textDecoration:R.textDecoration},range:[I,S,I,S],refreshRibbon:!0,onActionUpdate:!0})}D.style.textDecoration=k,e.eventArgs=D}else{if(!g(n.oldValue)&&n.oldValue!==n.value&&m.isUnique){var P=J(m.uniqueRange);if(G(P[0],P[1],this.parent.getActiveSheet()).value!=="#SPILL!")for(var S=P[0];S<=P[2];S++)for(var b=P[1];b<=P[3];b++)S===P[0]&&b===P[1]&&(this.parent.updateCellInfo({value:"#SPILL!"},Be([P[0],P[1]]),!0),b=b+1),this.parent.updateCellInfo({value:""},Be([S,b]),!0)}if(Zr(e,this.parent,!0),m.isUnique&&e.action==="cellDelete"&&n.isSpill){for(var O=J(m.uniqueRange),z=!1,I=O[0];I<=O[1];I++)for(var S=O[1];S<=O[3];S++)I===O[0]&&S===O[1]&&S++,G(I,S,h)&&!g(G(I,S,h).value)&&G(I,S,h).value!==""&&(z=!0);if(!z){var w=G(O[0],O[1],this.parent.getActiveSheet());w.value="",this.parent.updateCellInfo(w,et(O[0],O[1]),!0),this.parent.notify(gy,null)}}}}return e.action==="autofill"&&(s[1]=this.isUndo?e.eventArgs.dataRange:e.eventArgs.selectedRange),v&&!i&&!f&&(n.isColSelected&&(s[1]=h.selectedRange),this.parent.notify(Su,{address:s[1]})),this.parent.showAggregate&&this.parent.notify(yl,{}),e},o.prototype.getCellDetails=function(e,t,i){var r=this,n=[],s,a=i==="cellDelete",l={};e=tt(e);var h=function(v,m){var y={rowIndex:v,colIndex:m,value:s?s.value:"",formula:s?s.formula:""},S=li(t,v);if(s){s.format&&(y.format=s.format),g(s.isLocked)||(y.isLocked=s.isLocked),s.style&&(y.style=Object.assign({},s.style)),s.wrap&&(y.wrap=s.wrap),s.rowSpan&&(y.rowSpan=s.rowSpan),s.colSpan&&(y.colSpan=s.colSpan),s.image&&(y.image=s.image),s.chart&&(y.chart=JSON.parse(JSON.stringify(s.chart))),s.validation&&(y.validation=Object.assign({},s.validation)),s.notes&&(y.notes=s.notes),s.isReadOnly&&(y.isReadOnly=s.isReadOnly),s.formattedText&&(y.formattedText=s.formattedText),s.hyperlink&&(y.hyperlink=ms(s.hyperlink)?he({},s.hyperlink):s.hyperlink),(t.standardHeight?S!==t.standardHeight:S!==20)&&(s.rowHeight=y.rowHeight=S);var b=r.parent.editModule;y.value=s&&b&&s.formula===b.editCellData.value&&!g(b.editCellData.prevFormulaValue)?b.editCellData.prevFormulaValue:y.value}n.push(y)};if(i==="validation"||i==="removeValidation")for(var u=e[1];u<=e[3];u++)for(var c=Rt(t,u),d=e[0];d<=e[2];d++)!l[u]&&Ds(c,d,u)&&(n.push({colIndex:u,validation:Object.assign({},c.validation)}),l[u]=!0),s=G(d,u,t),!(s&&!s.validation)&&h(d,u);else for(var p=e[0];p<=e[2];p++)if(!(a&&Jn(t,p)))for(var f=e[1];f<=e[3];f++)s=G(p,f,t),h(p,f);return n},o.prototype.updateCellDetails=function(e,t,i,r,n,s,a,l,h){var u=this,c=e.length,d=n&&!s&&(n.action==="cellSave"||n.action==="cellDelete"||n.action==="autofill"||n.action==="clipboard"),p,f,v,m=n&&!n.eventArgs.cfClearActionArgs&&t.conditionalFormats&&t.conditionalFormats.length&&[].slice.call(t.conditionalFormats),y=[],S,b,w,I;n.action==="cellDelete"&&(w=!1,I=i);for(var x=function(T){if(a||Ee(e[T].rowIndex))return ch(t,e[T].colIndex,{validation:e[T].validation}),"continue";f=G(e[T].rowIndex,e[T].colIndex,t,!1,!0),f.style&&n&&(n.action==="format"||n.action==="clipboard")&&(f.style.borderTop&&(!e[T].style||!e[T].style.borderTop)&&M.parent.setBorder({borderTop:""},t.name+"!"+et(e[T].rowIndex,e[T].colIndex),null,l),f.style.borderLeft&&(!e[T].style||!e[T].style.borderLeft)&&M.parent.setBorder({borderLeft:""},t.name+"!"+et(e[T].rowIndex,e[T].colIndex),null,l),f.style.borderRight&&(!e[T].style||!e[T].style.borderRight)&&M.parent.setBorder({borderRight:""},t.name+"!"+et(e[T].rowIndex,e[T].colIndex),null,l),f.style.fontSize&&(!e[T].style||!e[T].style.fontSize)&&(f.style.fontSize="11pt",v=!0,M.parent.notify(Dr,{style:{fontSize:"11pt"},rowIdx:e[T].rowIndex,colIdx:e[T].colIndex,lastCell:!0,isHeightCheckNeeded:!0,manualUpdate:!0,onActionUpdate:!0})),f.style.fontFamily&&(!e[T].style||!e[T].style.fontFamily)&&(v=!0,f.style.fontFamily="Calibri",M.parent.notify(Dr,{style:{fontFamily:"Calibri"},rowIdx:e[T].rowIndex,colIdx:e[T].colIndex,lastCell:!0,isHeightCheckNeeded:!0,manualUpdate:!0,onActionUpdate:!0}))),f.image&&n&&n.action==="clipboard"&&f.image.forEach(function(R){u.parent.notify(ga,{id:R.id,sheet:t,preventEventTrigger:!0,rowIdx:e[T].rowIndex,colIdx:e[T].colIndex})});var k={value:e[T].formula&&e[T].formula.toUpperCase().includes("UNIQUE")?null:e[T].value,formula:e[T].formula};if(e[T].format&&(k.format=e[T].format),g(e[T].isLocked)||(k.isLocked=f.isLocked?f.isLocked:e[T].isLocked),e[T].style&&(k.style=Object.assign({},e[T].style)),e[T].wrap&&(k.wrap=e[T].wrap),e[T].rowSpan&&(k.rowSpan=e[T].rowSpan),e[T].colSpan&&(k.colSpan=e[T].colSpan),e[T].hyperlink&&(k.hyperlink=e[T].hyperlink),e[T].image&&(k.image=e[T].image),e[T].notes&&(k.notes=e[T].notes),e[T].isReadOnly&&(k.isReadOnly=e[T].isReadOnly),e[T].formattedText&&(k.formattedText=e[T].formattedText),oi(e[T].rowIndex,e[T].colIndex,t,k),b={action:"updateCellValue",address:[e[T].rowIndex,e[T].colIndex,e[T].rowIndex,e[T].colIndex],notes:e[T].notes,value:e[T].formula?e[T].formula:e[T].value,sheetIndex:yt(M.parent,t.name),skipFormatCheck:cs(M.parent),isDelete:w,deletedRange:I,actionName:n.action},M.parent.notify(fu,b),m&&!S&&(S=b.isFormulaDependent),n&&n.action==="format"&&n.eventArgs.requestType==="NumberFormat"&&k.wrap&&k.format!==f.format&&!Ar(t,e[T].rowIndex).customHeight?M.parent.notify(Xa,{range:[e[T].rowIndex,e[T].colIndex,e[T].rowIndex,e[T].colIndex],wrap:!0,sheet:t,initial:!0,isOtherAction:!0}):(n&&n.action==="wrap"&&n.eventArgs.wrap||f.wrap&&!e[T].wrap)&&M.parent.notify(Xa,{range:[e[T].rowIndex,e[T].colIndex,e[T].rowIndex,e[T].colIndex],wrap:!1,sheet:t,initial:!0}),n&&e[T].hyperlink&&n.action==="clear"){var F=t.name+"!"+Be([e[T].rowIndex,e[T].colIndex,e[T].rowIndex,e[T].colIndex]);p=M.parent.getCell(e[T].rowIndex,e[T].colIndex),n.eventArgs.type==="Clear All"||n.eventArgs.type==="Clear Hyperlinks"?M.parent.addHyperlink(e[T].hyperlink,F,e[T].value):n.eventArgs.type==="Clear Formats"&&p&&Y(p.querySelectorAll(".e-hyperlink"),"e-hyperlink-style")}e[T].validation&&M.parent.notify(To,{rules:e[T].validation,range:t.name+"!"+et(e[T].rowIndex,e[T].colIndex)}),d&&e[T].value!==f.value&&M.parent.trigger("cellSave",{element:null,value:e[T].value,oldValue:f.value,formula:e[T].formula,cancel:!1,address:t.name+"!"+et(e[T].rowIndex,e[T].colIndex),displayText:M.parent.getDisplayText(e[T])}),m&&!S&&kf(m,y,e[T].rowIndex,e[T].colIndex)},M=this,D=0;D<c;D++)x(D);if(r){if(i[0]===i[2]&&i[1]===i[3]){var A=G(i[0],i[1],t);A.rowSpan>1&&(i[2]=i[0]+A.rowSpan-1),A.colSpan>1&&(i[3]=i[1]+A.colSpan-1)}var L=!1;n.action==="autofill"||n.action==="clipboard"||n.action==="wrap"?L=!0:n.action==="format"&&n.eventArgs.requestType==="CellFormat"&&(L=gd(n.eventArgs.style,!0)),this.parent.serviceLocator.getService("cell").refreshRange(i,!1,!1,!0,!1,cs(this.parent),null,h,L,null,null,e),(y.length||S)&&this.parent.notify(Wi,{cfModel:!S&&y,refreshAll:S,isAction:!0}),v&&cr(function(){return u.parent.selectRange(t.selectedRange)})}},o.prototype.checkRefreshNeeded=function(e,t){var i=!0;return e!==this.parent.activeSheetIndex&&(t||(this.parent.activeSheetIndex=e,this.parent.dataBind()),i=!1),i},o.prototype.addEventListener=function(){this.parent.on(Ka,this.performUndoRedo,this),this.parent.on(Zy,this.updateUndoRedoCollection,this),this.parent.on(hh,this.setActionData,this),this.parent.on(ox,this.getBeforeActionData,this),this.parent.on(uh,this.clearUndoRedoCollection,this),this.parent.on(yI,this.updateUndoRedoIcons,this),this.parent.on(Tf,this.updateUndoRedoSheetReferences,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Ka,this.performUndoRedo),this.parent.off(Zy,this.updateUndoRedoCollection),this.parent.off(hh,this.setActionData),this.parent.off(ox,this.getBeforeActionData),this.parent.off(uh,this.clearUndoRedoCollection),this.parent.off(yI,this.updateUndoRedoIcons),this.parent.off(Tf,this.updateUndoRedoSheetReferences))},o.prototype.destroy=function(){this.removeEventListener(),this.undoCollection.length>0&&(this.undoCollection=[]),this.redoCollection.length>0&&(this.redoCollection=[]),this.beforeActionData&&this.beforeActionData.cellDetails&&(this.beforeActionData.cellDetails=[]),this.parent=null},o.prototype.getModuleName=function(){return"undoredo"},o}(),Rq=function(){function o(e){this.parent=e,this.wrapCell=this.parent.createElement("span",{className:"e-wrap-content"}),this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(Of,this.ribbonClickHandler,this),this.parent.on(Xa,this.wrapTextHandler,this),this.parent.on(An,this.rowHeightChangedHandler,this),this.parent.on(_n,this.colWidthChanged,this),this.parent.on(jI,this.updateWrapCell,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Of,this.ribbonClickHandler),this.parent.off(Xa,this.wrapTextHandler),this.parent.off(An,this.rowHeightChangedHandler),this.parent.off(_n,this.colWidthChanged),this.parent.off(jI,this.updateWrapCell))},o.prototype.wrapTextHandler=function(e){if(e.initial||UI(this.parent,e.range,!0)){if(e.isPublic&&qi(this.parent,e.range))return;e.initial&&!e.td&&!e.outsideViewport&&UI(this.parent,e.range,!0)&&(e.initial=!1);var t=void 0,i=void 0,r=void 0,n=void 0,s=void 0,a=void 0,l=void 0,h=void 0,u=void 0,c=void 0,d=this.parent.frozenRowCount(e.sheet),p=void 0,f=void 0,v=void 0;!g(e.sheet.standardHeight)&&e.sheet.standardHeight<20?p=!0:f=this.parent.allowFiltering&&this.parent.filterModule.filterRange.has(this.parent.activeSheetIndex)&&this.parent.filterModule.filterRange.get(this.parent.activeSheetIndex).range;for(var m=e.range[0];m<=e.range[2];m++){n=0,u=Ar(e.sheet,m),l=u.customHeight,a=l||e.isCustomHgt,c=!st(e.sheet,m);for(var y=e.range[1];y<=e.range[3];y++)if(i=G(m,y,e.sheet,null,!0),!(i.rowSpan<0||i.colSpan<0)){var S=i.rowSpan>1||i.colSpan>1;if(t=e.initial?e.td:c&&!Ot(e.sheet,y)&&this.parent.getCell(m,y),t?(e.wrap?(h=tM(i.style&&i.style.fontFamily?i.style:this.parent.cellStyle),t.classList.add(KF)):(t.classList.remove(KF),h=null),(a||S||u.height<20||p||f&&m===f[0]&&y>=f[1]&&y<=f[3])&&this.updateWrapCell({rowIdx:m,colIdx:y,sheet:e.sheet,ele:t}),B.isIE&&t.classList.add("e-ie-wrap")):h=null,!(a||S)){r=Au(e.sheet,m,y,i.colSpan>1?y+i.colSpan-1:y);var b=this.parent.getDisplayText(i).toString();if(this.parent.isEdit&&t&&b.indexOf(`
`)<0){var w=this.parent.element.querySelector(".e-spreadsheet-edit");w&&w.textContent.indexOf(`
`)>-1&&(b=w.textContent)}if(b)if(e.wrap){t&&t.classList.contains("e-alt-unwrap")&&(t.classList.remove("e-alt-unwrap"),b.includes(`
`)&&(v=t.querySelector(".e-hyperlink"),v&&!v.innerText.includes(`
`)&&(v.innerText=b)));var I=void 0,x=0,M=void 0;if(b.indexOf(`
`)>-1){var D=b.split(`
`),A=D.length;for(M=0;M<A;M++)I=qf(D[M],r,i.style,this.parent.cellStyle),I===0&&(I=1),x=x+I;I=x}else I=qf(b,r,i.style,this.parent.cellStyle);if(s=id(this.parent,m,y,e.sheet,i.style||this.parent.cellStyle,I,h),n=Math.max(n,s),i.rowSpan>1){var L=Ri(e.sheet,m,m+(i.rowSpan-1));if(L>=n)return;s=n=li(e.sheet,m)+(n-L)}sh(e.sheet,m,y,s)}else{if(t&&(b.indexOf(`
`)>-1&&t.classList.add("e-alt-unwrap"),v=t.querySelector(".e-hyperlink"),v)){var T=v.innerText;T.includes(`
`)&&(v.innerText=T.split(`
`).join(" "))}s=id(this.parent,m,y,e.sheet,i.style||this.parent.cellStyle,1,h),sh(e.sheet,m,y,s),n=Math.max(Mo(e.sheet,m),20)}else(!e.wrap||!b)&&(sh(e.sheet,m,y,20),n=Math.max(Mo(e.sheet,m),20));if(y===e.range[3]){var k=li(e.sheet,m);(e.wrap&&(e.isOtherAction?n>=20:n>20)&&Mo(e.sheet,m)<=n||(!e.wrap||!b)&&Mo(e.sheet,m)<k&&k>20)&&k!==n&&(t?(va(this.parent,e.sheet,n,m,e.row,e.hRow,c),t&&e.sheet.conditionalFormats&&e.sheet.conditionalFormats.length&&this.parent.notify(Wi,{indexes:[m,y],isAction:!0})):va(this.parent,e.sheet,n,m,null,null,c,!c||m>this.parent.viewport.bottomIndex||m>=d&&m<this.parent.viewport.topIndex+d))}}if(t){if(a&&!S){var b=this.parent.getDisplayText(i);e.wrap?t.classList.contains("e-alt-unwrap")&&t.classList.remove("e-alt-unwrap"):b.indexOf(`
`)>-1&&t.classList.add("e-alt-unwrap")}e.wrap?l?t.style.lineHeight&&(t.style.lineHeight=""):t.style.lineHeight=parseFloat(i.style&&i.style.fontSize||this.parent.cellStyle.fontSize)*h+"pt":t.style.lineHeight=""}}}e.initial||this.parent.notify(Za,null)}},o.prototype.ribbonClickHandler=function(e){var t=j(e.originalEvent.target,".e-btn");if(t&&t.id===this.parent.element.id+"_wrap"){var i=t.classList.contains("e-active"),r=f6(this.parent.getActiveSheet()),n={address:r,wrap:i,cancel:!1};if(qi(this.parent)){this.parent.notify(nr,null);return}this.parent.notify(ai,{action:"beforeWrap",eventArgs:n}),n.cancel||(vd(this.parent.getActiveSheet().selectedRange,i,this.parent),this.parent.notify(mt,{action:"wrap",eventArgs:{address:r,wrap:i}}))}},o.prototype.rowHeightChangedHandler=function(e){if(e.isCustomHgt){e.sheet=this.parent.getActiveSheet();for(var t=this.parent.viewport.leftIndex,i=this.parent.viewport.rightIndex;t<=i;t++)G(e.rowIdx,t,e.sheet,!1,!0).wrap&&(e.colIdx=t,e.ele=this.parent.getCell(e.rowIdx,t),this.updateWrapCell(e),e.ele.style.lineHeight&&(e.ele.style.lineHeight=""))}},o.prototype.colWidthChanged=function(e){if(e.checkWrapCell){e.sheet=this.parent.getActiveSheet();for(var t=this.parent.viewport.topIndex,i=this.parent.viewport.bottomIndex;t<=i;t++)G(t,e.colIdx,e.sheet,!1,!0).wrap&&(e.rowIdx=t,e.ele=this.parent.getCell(t,e.colIdx),this.updateWrapCell(e))}},o.prototype.updateWrapCell=function(e){if(e.ele&&!e.ele.querySelector(".e-wrap-content")){for(var t=this.wrapCell.cloneNode(),i=e.ele.querySelector(".e-filter-btn");e.ele.childElementCount&&!g(e.ele.firstElementChild)&&e.ele.firstElementChild.className.indexOf("e-addNoteIndicator")===-1;)t.appendChild(e.ele.firstElementChild);var r=void 0;if(!g(e.ele.firstElementChild)&&e.ele.firstElementChild.className.indexOf("e-addNoteIndicator")>-1&&(r=e.ele.firstElementChild),i&&(e.ele.firstChild?e.ele.insertBefore(i,e.ele.firstChild):e.ele.appendChild(i)),!G(e.rowIdx,e.colIdx,e.sheet,!1,!0).hyperlink){var n=e.ele.lastChild;n&&n.nodeType===3?(t.appendChild(document.createTextNode(n.textContent)),n.textContent=""):(t.appendChild(document.createTextNode(e.ele.textContent)),e.ele.textContent="")}e.ele.appendChild(t),g(r)||e.ele.appendChild(r)}},o.prototype.getModuleName=function(){return"wrapText"},o.prototype.destroy=function(){this.removeEventListener(),this.wrapCell&&(this.wrapCell.remove(),this.wrapCell=null),this.parent=null},o}(),Pq=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.insert=function(e){var t=e.eventArgs;this.parent.notify(Kc,t);var i=ke(this.parent,t.activeSheetIndex);switch(t.modelType){case"Sheet":this.parent.notify(Ux,{startIdx:t.index,endIdx:t.index+(t.model.length-1),preventUpdate:!t.isAction}),this.parent.renderModule.refreshSheet();break;case"Row":if(t.activeSheetIndex===this.parent.activeSheetIndex){var r=this.parent.frozenRowCount(i);if(!this.parent.scrollSettings.enableVirtualization||t.index<=this.parent.viewport.bottomIndex)if(t.freezePane)this.parent.renderModule.refreshSheet(!1,!1,!0);else if(this.parent.scrollSettings.enableVirtualization){var n=this.parent.frozenColCount(i);if(t.index>=this.parent.viewport.topIndex+r){var s=[],a=void 0;n?(a=Se(i.topLeftCell)[1],s.push(r),s.push(this.parent.viewport.leftIndex+n)):a=this.parent.viewport.leftIndex;var l=this.parent.viewport.leftIndex;this.parent.renderModule.refreshUI({rowIndex:this.parent.viewport.topIndex,colIndex:a,refresh:"Row",frozenIndexes:s,skipUpdateOnFirst:this.parent.viewport.topIndex+r===se(i,r,!0)}),n&&(this.parent.viewport.leftIndex=l)}var h=Se(i.paneTopLeftCell)[0];t.index<h&&(this.parent.notify(mb,{scrollTop:Ri(i,r,h-1,!0)}),this.parent.goTo(et(t.index,se(i,n,!0,"columns")))),this.parent.selectRange(i.selectedRange)}else this.parent.renderModule.refreshSheet(!1,!1,!0);else this.parent.scrollSettings.isFinite&&(this.parent.viewport.topIndex+r===se(i,0,!0)||this.parent.viewport.bottomIndex===se(i,i.rowCount-t.model.length-1,!1))&&this.parent.renderModule.refreshSheet(!1,!1,!0)}break;case"Column":if(t.activeSheetIndex===this.parent.activeSheetIndex){var n=this.parent.frozenColCount(i);if(!this.parent.scrollSettings.enableVirtualization||t.index<=this.parent.viewport.rightIndex)if(t.freezePane)this.parent.renderModule.refreshSheet(!1,!1,!0);else if(this.parent.scrollSettings.enableVirtualization){var r=this.parent.frozenRowCount(i);if(t.index>=this.parent.viewport.leftIndex+n){var s=[];r&&(s=[r+this.parent.viewport.topIndex,n]);var u=r?Se(i.topLeftCell)[0]:this.parent.viewport.topIndex,c=this.parent.viewport.topIndex;this.parent.renderModule.refreshUI({skipUpdateOnFirst:this.parent.viewport.leftIndex+n===se(i,n,!0,"columns"),rowIndex:u,colIndex:this.parent.viewport.leftIndex,refresh:"Column",frozenIndexes:s}),r&&(this.parent.viewport.topIndex=c)}var d=Se(i.paneTopLeftCell)[1];t.index<d&&(this.parent.notify(mb,{scrollLeft:Ci(i,0,d-1,!0)}),this.parent.goTo(et(se(i,r,!0),t.index))),this.parent.selectRange(i.selectedRange)}else this.parent.renderModule.refreshSheet(!1,!1,!0);else this.parent.scrollSettings.isFinite&&(this.parent.viewport.leftIndex+n===se(i,0,!0,"columns")||this.parent.viewport.rightIndex===se(i,i.colCount-t.model.length-1,!1,"columns"))&&this.parent.renderModule.refreshSheet(!1,!1,!0)}break}this.refreshImgElement(t.model.length,this.parent.activeSheetIndex,t.modelType,t.index),t.isAction?(delete t.isAction,this.parent.notify(mt,e),Fe(this.parent.element)):t.isUndoRedo||(t.isMethod=!0,this.parent.notify(yf,e))},o.prototype.refreshImgElement=function(e,t,i,r){for(var n=this.parent.sheets[t],s,a=[0,0,n.usedRange.rowIndex,n.usedRange.colIndex],l=0;l<=a[2];l++)for(var h=a[1];h<=a[3];h++)s=G(l,h,n),s&&s.image&&s.image.length>0&&(i==="Row"&&l>=r||i==="Column"&&h>=r)&&this.parent.notify(ub,{rowIdx:l,colIdx:h,sheetIdx:t,type:i,count:e,status:"insert"})},o.prototype.addEventListener=function(){this.parent.on(Cx,this.insert,this)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(Cx,this.insert)},o.prototype.getModuleName=function(){return"insert"},o}(),Bq=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.delete=function(e){var t=e.eventArgs;if(t.modelType==="Sheet"){var i=t.activeSheetIndex>=t.startIndex&&t.activeSheetIndex<=t.endIndex;i&&this.parent.setProperties({activeSheetIndex:this.parent.skipHiddenSheets(t.startIndex<this.parent.sheets.length?t.startIndex:t.startIndex?t.startIndex-1:0)},!0),t.endIndex<t.activeSheetIndex&&this.parent.setProperties({activeSheetIndex:t.activeSheetIndex-(t.endIndex+1-t.startIndex)},!0),this.parent.notify(rh,null),i&&this.parent.renderModule.refreshSheet(!1,!1,!0)}else if(t.activeSheetIndex===this.parent.activeSheetIndex){var r=this.parent.getActiveSheet(),n=this.parent.frozenRowCount(r),s=this.parent.frozenColCount(r);if(t.modelType==="Row"){if(!this.parent.scrollSettings.enableVirtualization||t.startIndex<=this.parent.viewport.bottomIndex)if(this.parent.scrollSettings.enableVirtualization)if(t.startIndex<Se(r.paneTopLeftCell)[0])this.parent.updateTopLeftCell(se(r,t.startIndex-1<n?n:t.startIndex-1,!0)-n,null,"col"),this.parent.renderModule.refreshSheet(!1,!1,!0);else if(t.freezePane||this.parent.scrollSettings.isFinite&&this.parent.viewport.bottomIndex>=se(r,r.rowCount-1,!1))this.parent.renderModule.refreshSheet(!1,!1,!0);else{var a=[],l=this.parent.frozenColCount(r),h=void 0,u=this.parent.viewport.leftIndex;l?(a.push(n),a.push(u+l),h=Se(r.topLeftCell)[1]):h=u,this.parent.renderModule.refreshUI({rowIndex:this.parent.viewport.topIndex,refresh:"Row",colIndex:h,skipUpdateOnFirst:this.parent.viewport.topIndex+n===se(r,n,!0),frozenIndexes:a}),l&&(this.parent.viewport.leftIndex=u),this.parent.selectRange(r.selectedRange)}else this.parent.renderModule.refreshSheet(!1,!1,!0)}else{if(t.refreshSheet!==!1&&(!this.parent.scrollSettings.enableVirtualization||t.startIndex<=this.parent.viewport.rightIndex))if(this.parent.scrollSettings.enableVirtualization)if(t.startIndex<Se(r.paneTopLeftCell)[1])this.parent.updateTopLeftCell(null,se(r,t.startIndex-1<s?s:t.startIndex-1,!0,"columns")-s,"row"),this.parent.renderModule.refreshSheet(!1,!1,!0);else if(t.freezePane||t.refreshSheet===!0)this.parent.renderModule.refreshSheet(!1,!1,!0);else{var c=this.parent.frozenRowCount(r),a=[],d=this.parent.viewport.topIndex,p=c?Se(r.topLeftCell)[0]:d;c&&(a=[c+d,s]),this.parent.renderModule.refreshUI({rowIndex:p,refresh:"Column",colIndex:this.parent.viewport.leftIndex,insertDelete:!0,skipUpdateOnFirst:this.parent.viewport.leftIndex+s===se(r,s,!0,"columns"),frozenIndexes:a}),c&&(this.parent.viewport.topIndex=d),this.parent.selectRange(r.selectedRange)}else this.parent.renderModule.refreshSheet(!1,!1,!0);delete t.refreshSheet}}this.refreshImgElement(t.deletedModel.length,this.parent.activeSheetIndex,t.modelType,t.startIndex),t.isAction?(delete t.isAction,this.parent.notify(mt,e),Fe(this.parent.element)):t.isUndoRedo||(t.isMethod=!0,this.parent.notify(yf,e))},o.prototype.addEventListener=function(){this.parent.on(wx,this.delete,this)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(wx,this.delete)},o.prototype.getModuleName=function(){return"delete"},o.prototype.refreshImgElement=function(e,t,i,r){for(var n=this.parent.sheets[t],s,a=[0,0,n.usedRange.rowIndex,n.usedRange.colIndex],l=0;l<=a[2];l++)for(var h=a[1];h<=a[3];h++)s=G(l,h,n),s&&s.image&&s.image.length>0&&(i==="Row"&&l>=r||i==="Column"&&h>=r)&&this.parent.notify(ub,{rowIdx:l,colIdx:h,sheetIdx:t,type:i,count:e,status:"delete"})},o}(),zq=function(){function o(e){this.divElements=[],this.spanElements=[],this.inputElements=[],this.checkBoxElements=[],this.numericTextBoxElements=[],this.dropDownListElements=[],this.parent=e,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener();var e={};if(!this.parent.isDestroyed&&!this.parent.refreshing){var t=Se(this.parent.getActiveSheet().activeCell),i=this.parent.getCell(t[0],t[1]);i&&(e={rowIdx:t[0],colIdx:t[1],td:i,isRefresh:!0})}this.removeListDropdownHandler(this.parent.element.querySelector(".e-validation-list"),e);var r=X("#"+this.parent.element.id+"_datavalidation-popup");r&&r.remove(),this.typeData=[],this.operatorData=[],this.dataList&&(this.dataList=null),this.formObj&&(this.formObj.destroy(),this.formObj=null),this.parent=null},o.prototype.addEventListener=function(){B.isDevice&&B.info.name==="safari"&&(B.isIos||B.isIos7)?E.add(this.parent.element,"touchend",this.listOpen,this):E.add(this.parent.element,"dblclick",this.listOpen,this),this.parent.on(pI,this.initiateDataValidationHandler,this),this.parent.on(Hf,this.invalidDataHandler,this),this.parent.on(yy,this.isValidCellHandler,this),this.parent.on(Qa,this.listHandler,this),this.parent.on(ds,this.keyUpHandler,this),this.parent.on(Vf,this.removeValidationHandler,this),this.parent.on(su,this.updateHighlightHandler,this),this.parent.on(An,this.listValidationHeightHandler,this),this.parent.on(pd,this.addListValidationDropdownHandler,this)},o.prototype.removeEventListener=function(){B.isDevice&&B.info.name==="safari"&&(B.isIos||B.isIos7)?E.remove(this.parent.element,"touchend",this.listOpen):E.remove(this.parent.element,"dblclick",this.listOpen),this.parent.isDestroyed||(this.parent.off(pI,this.initiateDataValidationHandler),this.parent.off(Hf,this.invalidDataHandler),this.parent.off(yy,this.isValidCellHandler),this.parent.off(Qa,this.listHandler),this.parent.off(ds,this.keyUpHandler),this.parent.off(Vf,this.removeValidationHandler),this.parent.off(su,this.updateHighlightHandler),this.parent.off(An,this.listValidationHeightHandler),this.parent.off(pd,this.addListValidationDropdownHandler))},o.prototype.removeValidationHandler=function(e){var t,i,r={cancel:!1,isColSelected:e.isCol};if(e.range&&e.range.includes("!")){if(i=e.range,t=ke(this.parent,yt(this.parent,i.substring(0,i.lastIndexOf("!")))),!t)return}else if(t=this.parent.getActiveSheet(),i=t.name+"!",e.range)i+=e.range;else{var n=this.getRange(t.selectedRange);i+=n.range,r.isColSelected=n.isColSelected}r.range=i,e.isAction&&this.parent.notify(ai,{eventArgs:r,action:"removeValidation"}),r.cancel||(this.parent.notify(To,{range:i,isRemoveValidation:!0}),e.isAction&&(delete r.cancel,this.parent.notify(mt,{eventArgs:r,action:"removeValidation"})))},o.prototype.updateNoteIndicator=function(e,t,i){var r=e.querySelector(".e-addNoteIndicator");r&&(Ue(r),this.parent.notify(bd,{targetElement:e,rowIndex:t,columnIndex:i,skipEvent:!0}))},o.prototype.keyUpHandler=function(e){var t=e.target,i=this.parent.element.querySelector(".e-datavalidation-dlg");if(j(t,".e-values")&&i&&e.keyCode!==13){var r=i.querySelector(".e-values"),n=r.querySelector(".e-dlg-error"),s=i.querySelector(".e-footer-content"),a=s.querySelector(".e-primary");a.hasAttribute("disabled")&&a.removeAttribute("disabled"),n&&r.removeChild(n)}},o.prototype.listOpen=function(e){var t=e.target;this.listObj&&t.classList.contains("e-cell")&&t.querySelector(".e-validation-list")&&this.parent.isEdit&&this.listObj.showPopup()},o.prototype.invalidDataHandler=function(e){var t={range:"",cancel:!1},i,r=e.isRemoveHighlight?Cy:by;!e.isPublic&&(i={eventArgs:t,action:r},this.parent.notify(ai,i),t.cancel)||(this.parent.notify(r,{range:t.range,isAction:!0}),e.isPublic||(i.preventAction=!0,this.parent.notify(mt,i)))},o.prototype.listHandler=function(){var e=this.parent.getActiveSheet(),t=Se(e.activeCell),i=G(t[0],t[1],e),r=this.parent.getCell(t[0],t[1]);if(r){this.removeListDropdownHandler(this.parent.element.getElementsByClassName("e-validation-list")[0]);var n=i&&i.validation||e.columns&&e.columns[t[1]]&&e.columns[t[1]].validation;if(n&&n.type==="List"){if(n.address&&!oO(n.address,t[0],t[1]))return;this.addListValidationDropdownHandler({cell:i,validation:n,td:r,rowIdx:t[0],colIdx:t[1]})}i&&i.validation&&(i.validation=n)}},o.prototype.removeListDropdownHandler=function(e,t){if(e){if(this.listObj&&this.listObj.destroy(),Ue(e),t)t.isRefresh&&this.updateNoteIndicator(t.td,t.rowIdx,t.colIdx);else if(!g(this.parent.selectionModule.previousActiveCell)){var i=Se(this.parent.selectionModule.previousActiveCell),r=this.parent.getCell(i[0],i[1]);r&&this.updateNoteIndicator(r,i[0],i[1])}}},o.prototype.addListValidationDropdownHandler=function(e){var t=this;if(e.updatePosition){this.updateTopPosition({ddlCont:e.ddlCont,rowIdx:e.rowIdx,colIdx:e.colIdx});return}var i=e.validation.inCellDropDown;if(e.isRefresh){if(!e.td&&(e.td=this.parent.getCell(e.rowIdx,e.colIdx),!e.td)||(this.removeListDropdownHandler(e.td.querySelector(".e-validation-list"),e),e.validation.type!=="List"))return;g(i)&&(i=!0)}else g(e.validation.ignoreBlank)&&(e.validation.ignoreBlank=!0),g(i)&&(i=e.validation.inCellDropDown=!0);if(i){var r=this.parent.createElement("div",{className:"e-validation-list"}),n=this.parent.createElement("input",{id:this.parent.element.id+"listValid"});r.appendChild(n);var s,a=e.td,l=a.getElementsByClassName("e-wrap-content")[0]||a;this.updateTopPosition({ddlCont:r,rowIdx:e.rowIdx,colIdx:e.colIdx}),this.listValidationHeightHandler({ddlCont:r}),l.insertBefore(r,l.firstChild);var h=e.validation.value1;(!e.cell||!e.cell.validation)&&h.startsWith("=")&&(h=Hn([e.rowIdx,e.colIdx,e.rowIdx,e.colIdx],[0,e.colIdx,0,e.colIdx],this.parent.getActiveSheet(),this.parent,{formula:h}));var u=this.getListDataSource(h);this.listObj=new Ps({index:this.setDropDownListIndex(u,e.cell),dataSource:u,fields:{text:"text",value:"id"},width:"0px",popupHeight:"200px",change:function(){return t.listValueChange(t.listObj.text)},beforeOpen:function(){s=window.browserDetails.isDevice,s&&(window.browserDetails.isDevice=!1)},open:function(c){c.popup.offsetX=t.listObj.enableRtl?3:-a.offsetWidth+(t.parent.enableRtl?4:24),c.popup.offsetY=-(a.querySelector(".e-control-wrapper.e-ddl").offsetHeight-18),c.popup.element.style.width=a.offsetWidth-1+"px",s&&(window.browserDetails.isDevice=!0)},close:function(c){c.event&&(c.event.keyCode===13||c.event.altKey&&c.event.keyCode===38)&&(c.event.preventDefault(),c.event.stopPropagation()),Fe(t.parent.element)}}),this.listObj.appendTo(n),this.updateNoteIndicator(a,e.rowIdx,e.colIdx)}},o.prototype.updateTopPosition=function(e){var t=this.parent.getActiveSheet(),i=G(e.rowIdx,e.colIdx,t);i&&i.style&&i.style.fontSize&&parseFloat(i.style.fontSize)>11?e.ddlCont.style.top=parseFloat(i.style.fontSize)-11+"pt":e.ddlCont.style.top&&(e.ddlCont.style.top="")},o.prototype.listValidationHeightHandler=function(e){var t=this.parent.getActiveSheet(),i=Se(t.activeCell),r=G(i[0],i[1],t),n=r&&r.validation||t.columns&&t.columns[i[1]]&&t.columns[i[1]].validation;if(n&&n.type==="List"&&n.inCellDropDown){var s=li(t,i[0],!0)-iM(i[0],i[1],t);if(s<=18){var a=e.ddlCont||this.parent.element.querySelector(".e-validation-list");a&&(a.style.height=s+"px")}else if(!e.ddlCont){var a=this.parent.element.querySelector(".e-validation-list");a&&a.style.removeProperty("height")}}},o.prototype.setDropDownListIndex=function(e,t){if(t&&!g(t.value)){for(var i=t.value.toString(),r=Me(i),n=r&&Yi(this.parent.locale),s=0,a=e.length;s<a;s++)if(e[s].text===i||r&&this.parseValidationValue(e[s].text,n).toString()===i)return s}return null},o.prototype.getListDataSource=function(e){var t=this,i=[],r=0,n=this.parent.definedNames,s=e,a=s.startsWith("=");if(n.length>0&&a){for(var l=s.split("=")[1],h=0,u=n.length;h<u;h++)if(n[h].name===l){for(var c=n[h].refersTo;c.includes("'");)c=c.replace("'","");s=c}}if(a){var d=void 0,p=void 0,f=void 0,v=s.lastIndexOf("!");v>-1?(f=s.substring(1,v),p=s.substring(v+1),f.startsWith("'")&&f.endsWith("'")&&(f=f.substring(1,f.length-1)),d=ke(this.parent,yt(this.parent,f))):(d=this.parent.getActiveSheet(),p=s.substring(1));var m=this.parent.getActiveSheet();if(d){if(d.name!==m.name){var y,S=J(m.selectedRange);d.ranges.forEach(function(T){if(!T.info||!T.info.loadedRange||!T.info.loadedRange.length){y=!0;return}}),y&&(this.parent.showSpinner(),fa(this.parent,d.name+"!"+p).then(function(){if(t.parent.hideSpinner(),m.name===t.parent.getActiveSheet().name){var T=J(t.parent.getActiveSheet().selectedRange);if(T[0]===S[0]&&T[1]===S[1]){var k=t.getListDataSource(e);t.listObj.dataSource=k;var F=G(T[0],T[1],m);t.listObj.index=t.setDropDownListIndex(k,F),t.listObj.dataBind()}}}))}var b=void 0,w=p.split(":");if(w[0]&&w[1]&&(w[0].match(/[a-z]+$/ig)&&w[1].match(/[a-z]+$/ig)||w[0].match(/^[0-9]/g)&&w[1].match(/^[0-9]/g))){var I=this.parent.getIndexes(p);I.isCol?b=[0,I.startIdx,d.usedRange.rowIndex,I.startIdx]:b=[I.startIdx,0,I.startIdx,d.usedRange.colIndex]}else b=J(p);for(var x=void 0,M=b[0];M<=b[2];M++){d.rows[M]||hs(d,M,{});for(var D=b[1];D<=b[3];D++){d.rows[M].cells||oi(M,D,d,{}),r+=1,x=d.rows[M].cells[D];var A=this.parent.getDisplayText(x)||"";i.push({text:A,id:"list-"+r})}}}}else for(var L=this.getListOfValues(s),h=0;h<L.length;h++)r+=1,i.push({text:L[h],id:"list-"+r});return i},o.prototype.listValueChange=function(e){var t=this.parent.getActiveSheet(),i=Qi(t.activeCell),r=Object.assign({},G(i[0],i[1],t));if(t.isProtected&&un(r,Rt(t,i[1])))this.parent.notify(ba,null);else if(Lo(r,Rt(t,i[1]),Ar(t,i[0])))this.parent.notify(nr,null);else{this.parent.isEdit&&this.parent.closeEdit();var n={value:e,oldValue:r.value,address:t.name+"!"+t.activeCell,cancel:!1};if(this.parent.notify(ai,{action:"cellSave",eventArgs:n}),n.cancel)return;var s={value:e,formula:""};if(r.format&&qs(r.format)&&!Me(e)){var a={formattedText:e,value:e,format:"General",cell:{value:e,format:"General"},isEdit:!0};this.parent.notify(en,a),a.format!=="General"&&["Currency","Percentage"].indexOf(Er(a.format))>-1&&(s.format=a.format,s.value=a.value)}var l=sr(this.parent,t,{cell:s,rowIdx:i[0],colIdx:i[1],valChange:!0,lastCell:!0,checkCF:!0,uiRefresh:!0});if(!l){var h=G(i[0],i[1],t,!1,!0);delete h.formula,this.parent.notify(Ua,{action:"refreshFormulabar",cell:h}),this.parent.notify(Es,null),this.parent.notify(mt,{action:"cellSave",eventArgs:{value:e,oldValue:r.value,address:t.name+"!"+t.activeCell}})}}},o.prototype.getRange=function(e){var t=J(e),i=this.parent.getActiveSheet(),r=i.rowCount,n;return t[2]===r-1&&t[0]===0&&(e=e.replace(/[0-9]/g,""),n=!0),{range:e,isColSelected:n}},o.prototype.initiateDataValidationHandler=function(){var e=this,t=this.parent.getActiveSheet(),i=J(t.selectedRange),r=i[0],n=i[1],s,a;i[2]>=i[0]?(s=function(){return r<=i[2]},a=function(){r++}):(s=function(){return r>=i[2]},a=function(){r--});var l,h;i[3]>=i[1]?(l=function(){return n<=i[3]},h=function(){n++}):(l=function(){return n>=i[3]},h=function(){n--});var u,c,d,p,f,v,m,y=function(L,T){if(v){var k=Hn(L,T,t,e.parent,{formula:p.value1});k.includes("#REF!")||(p.value1=k)}if(m){var k=Hn(L,T,t,e.parent,{formula:p.value2});k.includes("#REF!")||(p.value2=k)}};for(r;s();a()){for(n;l();h())if(u=G(r,n,t,!1,!0),f=u.validation||Ds(t.columns[n],r,n)&&t.columns[n].validation,f)if(p){if(f.type!==p.type||f.operator!==p.operator||(!v||!ut(f.value1))&&f.value1!==p.value1||(!m||!ut(f.value2))&&f.value2!==p.value2){c=!0;break}}else{p=Object.assign({},f),v=ut(p.value1),m=ut(p.value2),u.validation||y([r,n,r,n],[0,n,0,n]);var S=J(t.activeCell);(r!==S[0]||n!==S[1])&&y(S,[r,n,r,n])}else d=!0;n=i[1]}var b=this.parent.serviceLocator.getService(fe),w=this.parent.serviceLocator.getService(jt),I=function(L){if(!e.parent.element.querySelector(".e-datavalidation-dlg")){var T=e.getRange(t.selectedRange).range;w.show({width:375,showCloseIcon:!0,isModal:!0,cssClass:"e-datavalidation-dlg",header:b.getConstant("DataValidation"),beforeOpen:function(k){var F={dialogName:"ValidationDialog",element:k.element,target:k.target,cancel:k.cancel};e.parent.trigger("dialogBeforeOpen",F),F.cancel?k.cancel=!0:(w.dialogInstance.content=e.dataValidationContent(b,T,L),w.dialogInstance.dataBind(),Fe(e.parent.element))},beforeClose:e.dialogBeforeClose.bind(e),buttons:[{buttonModel:{content:b.getConstant("ClearAll"),cssClass:"e-btn e-clearall-btn e-flat"},click:function(){w.dialogInstance.content=e.dataValidationContent(b,T),w.dialogInstance.dataBind()}},{buttonModel:{content:b.getConstant("Apply"),isPrimary:!0},click:function(){e.dlgClickHandler(w)}}]})}};if(c||p&&d){var x,M=[{buttonModel:{isPrimary:!0,cssClass:"e-btn-goto-ok"},click:function(){w.hide(!0),I()}}];c?(x="MoreValidation",M[0].buttonModel.content=b.getConstant("Ok")):(x="ExtendValidation",M[0].buttonModel.content=b.getConstant("No"),M.splice(0,0,{buttonModel:{content:b.getConstant("Yes"),isPrimary:!0,cssClass:"e-btn-goto-ok"},click:function(){w.hide(!0),I(p)}}));var D=b.getConstant(x),A={width:350,isModal:!0,showCloseIcon:!0,cssClass:"e-goto-dlg",header:b.getConstant("Spreadsheet"),content:D,beforeOpen:function(L){var T={dialogName:x,element:L.element,target:L.target,cancel:L.cancel,content:D};e.parent.trigger("dialogBeforeOpen",T),T.cancel?L.cancel=!0:(T.content!==D&&(w.dialogInstance.content=T.content,w.dialogInstance.dataBind()),Fe(e.parent.element))},buttons:M};w.show(A)}else I(p)},o.prototype.dataValidationContent=function(e,t,i){var r=this,n,s,a,l=!i,h,u;if(l)n=s="0",u=!0;else{var c=i.value1,d=i.value2;if(a=i.type,h=i.operator,u=i.ignoreBlank!==!1,a==="Date"||a==="Time"){var p=function(ye){if(Me(ye)){var De={cell:{value:ye},type:a.toLowerCase(),value:ye};return r.parent.notify(py,De),De.value}return ye};n=p(c),s=p(d)}else{var f=function(ye){if(Me(ye)){ye=ye.toString();var De=Yi(r.parent.locale);De.decimal!=="."&&ye.includes(".")&&(ye=ye.replace(".",De.decimal))}return ye};n=f(c),s=f(d)}}var v=this.parent.createElement("div",{className:"e-validation-dlg"}),m=this.parent.createElement("div",{className:"e-cellrange"}),y=this.parent.createElement("div",{className:"e-allowdata"}),S=this.parent.createElement("div",{className:"e-values"}),b=this.parent.createElement("div",{className:"e-ignoreblank"});this.divElements.push(v),this.divElements.push(m),this.divElements.push(y),this.divElements.push(S),this.divElements.push(b),v.appendChild(m),v.appendChild(y),v.appendChild(S),v.appendChild(b);var w=this.parent.createElement("span",{className:"e-header"});w.innerText=e.getConstant("CellRange");var I=this.parent.createElement("input",{className:"e-input",attrs:{value:t,"aria-label":e.getConstant("CellRange")}});m.appendChild(w),m.appendChild(I);var x=this.parent.createElement("div",{className:"e-allow"}),M=this.parent.createElement("div",{className:"e-data"});y.appendChild(x),y.appendChild(M);var D=this.parent.createElement("span",{className:"e-header"});D.innerText=e.getConstant("Allow"),this.typeData=[{text:e.getConstant("WholeNumber"),id:"type-1"},{text:e.getConstant("Decimal"),id:"type-2"},{text:e.getConstant("Date"),id:"type-3"},{text:e.getConstant("Time"),id:"type-4"},{text:e.getConstant("TextLength"),id:"type-5"},{text:e.getConstant("List"),id:"type-6"},{text:e.getConstant("Custom"),id:"type-7"}],this.operatorData=[{text:e.getConstant("Between"),id:"operator-1"},{text:e.getConstant("NotBetween"),id:"operator-2"},{text:e.getConstant("EqualTo"),id:"operator-3"},{text:e.getConstant("NotEqualTo"),id:"operator-4"},{text:e.getConstant("GreaterThan"),id:"operator-5"},{text:e.getConstant("LessThan"),id:"operator-6"},{text:e.getConstant("GreaterThanOrEqualTo"),id:"operator-7"},{text:e.getConstant("LessThanOrEqualTo"),id:"operator-8"}];var A=this.parent.createElement("input",{className:"e-select"});this.spanElements.push(w),this.inputElements.push(I),this.divElements.push(x),this.divElements.push(M),this.spanElements.push(D),this.inputElements.push(A);var L=0;if(!l){a&&(a=this.formattedType(a));for(var T=0;T<this.typeData.length;T++)if(a===this.formattedType(this.typeData[T].text)){L=T;break}}if(l||a!=="List"&&a!=="Custom"){var k=0,F=this.parent.createElement("span",{className:"e-header"});F.innerText=e.getConstant("Data");var R=this.parent.createElement("input",{className:"e-select"});if(!l){for(var T=0;T<this.operatorData.length;T++)if(h===this.formattedValue(this.operatorData[T].text)){k=T;break}}M.appendChild(F),M.appendChild(R),this.spanElements.push(F),this.inputElements.push(R),this.dataList=new Ps({dataSource:this.operatorData,index:k,popupHeight:"200px",change:this.userInput.bind(this)}),this.dropDownListElements.push(this.dataList),this.dataList.appendTo(R)}else if(a!=="Custom"){var N=this.parent.createElement("input",{className:"e-checkbox"});M.appendChild(N);var P=new ea({label:e.getConstant("InCellDropDown"),checked:i.inCellDropDown!==!1});this.checkBoxElements.push(P),P.appendTo(N),this.inputElements.push(N)}x.appendChild(D),x.appendChild(A),this.typeList=new Ps({dataSource:this.typeData,index:L,popupHeight:"200px",change:this.userInput.bind(this)}),this.dropDownListElements.push(this.typeList),this.typeList.appendTo(A);var O=function(ye,De){var ve=r.parent.createElement("span",{className:"e-header"});ve.innerText=ye;var ue=r.parent.createElement("input",{className:"e-input",attrs:{value:De}});S.appendChild(ve),S.appendChild(ue),r.spanElements.push(ve),r.inputElements.push(ue)};if(l||this.typeList.value!==e.getConstant("List")&&this.typeList.value!==e.getConstant("Custom")&&(this.dataList.value===e.getConstant("Between")||this.dataList.value===e.getConstant("NotBetween"))){var z=this.parent.createElement("div",{className:"e-minimum"}),H=this.parent.createElement("div",{className:"e-maximum"});S.appendChild(z),S.appendChild(H);var Q=this.parent.createElement("span",{className:"e-header"});Q.innerText=e.getConstant("Minimum");var $=this.parent.createElement("span",{className:"e-header"});$.innerText=e.getConstant("Maximum");var U=this.parent.createElement("input",{id:"minvalue",className:"e-input",attrs:{value:n,"aria-label":e.getConstant("Minimum")}}),ie=this.parent.createElement("input",{id:"maxvalue",className:"e-input",attrs:{value:s,"aria-label":e.getConstant("Maximum")}});z.appendChild(Q),z.appendChild(U),H.appendChild($),H.appendChild(ie),this.divElements.push(z),this.divElements.push(H),this.spanElements.push(Q),this.spanElements.push($),this.inputElements.push(U),this.inputElements.push(ie);var ne=new ia({value:0});this.numericTextBoxElements.push(ne),ne.appendTo("#minvalue");var te=new ia({value:0});this.numericTextBoxElements.push(te),te.appendTo("#maxvalue")}else O(!l&&a==="List"?e.getConstant("Sources"):!l&&a==="Custom"?e.getConstant("Formula"):e.getConstant("Value"),n);var oe=this.parent.createElement("input",{className:"e-checkbox"});b.appendChild(oe);var ae=new ea({label:e.getConstant("IgnoreBlank"),checked:u});return this.checkBoxElements.push(ae),ae.appendTo(oe),this.inputElements.push(oe),v},o.prototype.dialogBeforeClose=function(){this.checkBoxElements.forEach(function(e){e&&e.element&&(e.destroy(),e.element.remove())}),this.checkBoxElements=[],this.numericTextBoxElements.forEach(function(e){e&&e.element&&(e.destroy(),e.element.remove())}),this.numericTextBoxElements=[],this.dropDownListElements.forEach(function(e){e&&e.element&&(e.destroy(),e.element.remove())}),this.dropDownListElements=[],us(this.spanElements),this.spanElements=[],us(this.inputElements),this.inputElements=[],us(this.divElements),this.divElements=[]},o.prototype.userInput=function(){var e=this.typeList,t=this.dataList,i=this.parent.element.querySelector(".e-datavalidation-dlg"),r=i.querySelector(".e-validation-dlg"),n=r.querySelector(".e-allowdata"),s=r.querySelector(".e-values"),a=this.parent.serviceLocator.getService(fe),l=n.querySelector(".e-data"),h=function(D){for(;D.lastChild;)D.removeChild(D.lastChild)};if(h(s),e.value===a.getConstant("List")){h(l);var u=this.parent.createElement("input",{className:"e-checkbox"});this.inputElements.push(u),l.appendChild(u);var c=new ea({label:a.getConstant("InCellDropDown"),checked:!0});this.checkBoxElements.push(c),c.appendTo(u)}else if(e.value===a.getConstant("Custom"))h(l);else if(!l.childElementCount||l.getElementsByClassName("e-checkbox-wrapper")[0]){h(l);var d=this.parent.createElement("span",{className:"e-header"});d.innerText=a.getConstant("Data");var p=this.parent.createElement("input",{className:"e-select"});this.spanElements.push(d),this.inputElements.push(p),l.appendChild(d),l.appendChild(p),t.appendTo(p)}if(e.value!==a.getConstant("List")&&e.value!==a.getConstant("Custom")&&(t.value===a.getConstant("Between")||t.value===a.getConstant("NotBetween"))){var f=this.parent.createElement("div",{className:"e-minimum"}),v=this.parent.createElement("div",{className:"e-maximum"});this.divElements.push(f),this.divElements.push(v),s.appendChild(f),s.appendChild(v);var m=this.parent.createElement("span",{className:"e-header"});m.innerText=a.getConstant("Minimum");var y=this.parent.createElement("span",{className:"e-header"});y.innerText=a.getConstant("Maximum");var S=this.parent.createElement("input",{id:"min",className:"e-input",attrs:{value:"0"}}),b=this.parent.createElement("input",{id:"max",className:"e-input",attrs:{value:"0"}});this.spanElements.push(m),this.spanElements.push(y),this.inputElements.push(S),this.inputElements.push(b);var w=new ia({value:0});this.numericTextBoxElements.push(w),w.appendTo("min");var I=new ia({value:0});this.numericTextBoxElements.push(I),I.appendTo("max"),f.appendChild(m),f.appendChild(S),v.appendChild(y),v.appendChild(b)}else{var x=this.parent.createElement("span",{className:"e-header"});x.innerText=e.value===a.getConstant("List")?a.getConstant("Sources"):e.value===a.getConstant("Custom")?a.getConstant("Formula"):a.getConstant("Value");var M=e.value===a.getConstant("List")?this.parent.createElement("input",{className:"e-input",attrs:{placeholder:"Enter value"}}):this.parent.createElement("input",{className:"e-input",attrs:{value:"0"}});this.spanElements.push(x),this.inputElements.push(M),s.appendChild(x),s.appendChild(M)}},o.prototype.dlgClickHandler=function(e){var t=this,i=this.parent.serviceLocator.getService(fe),r,n=this.parent.element.querySelector(".e-datavalidation-dlg"),s=n.querySelector(".e-footer-content"),a=n.getElementsByClassName("e-dlg-content")[0].getElementsByClassName("e-validation-dlg")[0],l=a.getElementsByClassName("e-allowdata")[0],h=l.getElementsByClassName("e-allow")[0].getElementsByTagName("input")[0],u=l.getElementsByClassName("e-data")[0].getElementsByTagName("input")[0],c=a.getElementsByClassName("e-values")[0],d=[];d[0]=c.getElementsByTagName("input")[0].value,d[1]=c.getElementsByTagName("input")[1]?c.getElementsByTagName("input")[1].value:"";var p=this.formattedType(h.value),f=!0,v=a.querySelector(".e-ignoreblank .e-checkbox").checked,m=l.querySelector(".e-data").querySelector(".e-checkbox-wrapper")?!!l.querySelector(".e-data").querySelector(".e-checkbox-wrapper").querySelector(".e-check"):null,y=a.querySelector(".e-cellrange").getElementsByTagName("input")[0].value,S;u&&(S=this.formattedValue(u.value));var b=[];if(p==="List")if(d[0]!==""&&b.push(d[0]),d[0].startsWith("=")){var w=d[0].substring(1),I=this.parent.definedNames.find(function(Q){return Q.name===w});I&&(w=I.refersTo.substring(1));var x=void 0,M=void 0;if(w.includes("!")){M=w.lastIndexOf("!");var D=w.substring(0,M);w=w.substring(M+1),D.startsWith("'")&&D.endsWith("'")&&(D=D.substring(1,D.length-1)),x=yt(this.parent,D)>-1,I||(b[0]="="+D+"!"+w)}else x=!0;!w.includes(":")&&Mr(w)&&(w=w+":"+w);var A=void 0;if(x){var L=w.split(":");L.length===2&&(A=w.match(/[a-z]/gi)&&L[0].replace(/[0-9]/g,"")===L[1].replace(/[0-9]/g,"")||w.match(/\d/g)&&L[0].replace(/\D/g,"")===L[1].replace(/\D/g,""))}f=A,f||(r=!I&&M===void 0&&!w.includes(":")?i.getConstant("NamedRangeError"):i.getConstant("DialogError"))}else d[0].length>256&&(f=!1,r=i.getConstant("ListLengthError"));else{var T=Yi(this.parent.locale);if(p==="Decimal"&&T.decimal!=="."){var k=function(Q){return Me(Q)&&Q.includes(".")&&(T.group!=="."||!fd(Q,t.parent.locale,T.group,T.decimal))};(k(d[0])||k(d[1]))&&(f=!1,r=i.getConstant("InvalidNumberError"))}Zc(d,this.parent,T),d[0]!==""&&b.push(d[0]),d[1]!==""&&b.push(d[1])}if(f){var F=this.parent.getActiveSheet(),R=this.isDialogValidator(b,p,S);if(S==="Between"&&R.isValid&&!isNaN(parseFloat(b[0]))&&!isNaN(parseFloat(b[1]))&&parseFloat(b[0])>parseFloat(b[1])&&(R.isValid=!1,R.errorMsg=i.getConstant("MinMaxError")),p==="Custom"&&ut(b[0])){var N=["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!","#CALC!"],P={value:b[0]};this.parent.notify(Zh,P);var O=P.value;N.indexOf(O)>-1&&(R.isValid=!1,R.errorMsg=i.getConstant("InvalidFormula"))}if(r=R.errorMsg,f=R.isValid,f){if(qi(this.parent,tt(J(y)))){e.hide(!0),this.parent.notify(nr,null);return}var z={range:F.name+"!"+y,value1:b[0],value2:b[1]||"",ignoreBlank:v,type:p,operator:S,inCellDropDown:m,cancel:!1};this.parent.notify(ai,{eventArgs:z,action:"validation"}),z.cancel||(this.parent.notify(To,{rules:{type:z.type,operator:z.operator,value1:z.value1,value2:z.value2,ignoreBlank:z.ignoreBlank,inCellDropDown:z.inCellDropDown},range:z.range,isAction:!0}),delete z.cancel,this.parent.element.getElementsByClassName("e-validation-error-dlg")[0]||(e.dialogInstance?e.dialogInstance.hide():e.hide()),this.parent.notify(mt,{eventArgs:z,action:"validation"}))}}if(!f){var H=this.parent.createElement("div",{className:"e-dlg-error",id:"e-invalid"});H.innerText=r,c.appendChild(H),s.querySelector(".e-primary").setAttribute("disabled","true")}},o.prototype.formattedValue=function(e){var t=this.parent.serviceLocator.getService(fe);switch(e){case t.getConstant("Between"):e="Between";break;case t.getConstant("NotBetween"):e="NotBetween";break;case t.getConstant("EqualTo"):e="EqualTo";break;case t.getConstant("NotEqualTo"):e="NotEqualTo";break;case t.getConstant("GreaterThan"):e="GreaterThan";break;case t.getConstant("LessThan"):e="LessThan";break;case t.getConstant("GreaterThanOrEqualTo"):e="GreaterThanOrEqualTo";break;case t.getConstant("LessThanOrEqualTo"):e="LessThanOrEqualTo";break;default:e="Between";break}return e},o.prototype.formattedType=function(e){var t=this.parent.serviceLocator.getService(fe);switch(e){case t.getConstant("WholeNumber"):e="WholeNumber";break;case t.getConstant("Decimal"):e="Decimal";break;case t.getConstant("Date"):e="Date";break;case t.getConstant("TextLength"):e="TextLength";break;case t.getConstant("List"):e="List";break;case t.getConstant("Time"):e="Time";break;case t.getConstant("Custom"):e="Custom";break}return e},o.prototype.isDialogValidator=function(e,t,i){var r=this.parent.serviceLocator.getService(fe),n=0,s=!1,a;if(t==="List"?s=!(e.length>0):i==="Between"||i==="NotBetween"?s=e.length!==2:s=!(e.length>0),s)return{isValid:!1,errorMsg:r.getConstant("EmptyError")};for(var l=void 0,h=0;h<e.length;h++){if(ut(e[h])){var u={value:e[h]};this.parent.notify(Zh,u),l=u.value}else t==="Date"||t==="Time"?l=e[h]=this.getDateAsNumber({range:[],cell:{value:e[h]}},e[h]):l=e[h];if(a=this.formatValidation(l,t,!0),a.isValid)n=n+1;else break}return a.isValid=n===e.length,a},o.prototype.getDateAsNumber=function(e,t){var i={value:t,rowIndex:e.range[0],cell:e.cell,colIndex:e.range[1],sheetIndex:e.sheetIdx,updatedVal:""};return this.parent.notify(Jr,i),i.updatedVal||t},o.prototype.getListOfValues=function(e){var t;return this.parent.listSeparator!==","&&e.includes(this.parent.listSeparator)?t=e.split(this.parent.listSeparator):t=e.split(","),t},o.prototype.checkValidationHandler=function(e,t){var i=e.value.toString(),r=this.parent.sheets[e.sheetIdx],n=G(e.range[0],e.range[1],r,null,!0),s=t.value1,a=t.value2;if(!n.validation){var l=e.range,h=[0,e.range[1],0,e.range[3]];ut(s)&&(s=Hn(l,h,r,this.parent,{formula:s})),ut(a)&&(a=Hn(l,h,r,this.parent,{formula:a}))}if(t.type!=="List"){if(ut(s)){var u={value:s};this.parent.notify(Zh,u),s=u.value}if(ut(a)){var c={value:a};this.parent.notify(Zh,c),a=c.value}if(ut(e.value)){var d={value:e.value};this.parent.notify(Zh,d),e.value=d.value}}var p=e.value,f=t.operator||"Between",v=t.type||"WholeNumber",m=g(t.ignoreBlank)?!0:t.ignoreBlank;if(m&&i==="")return!0;var y=v==="Date"||v==="Time";if(e.value)if(y||t.type==="TextLength")Me(e.value)||(p=e.value=this.getDateAsNumber(e,e.value));else{var S=e.isEdit&&Yi(this.parent.locale),b=this.parseValidationValue(e.value,S);b!==e.value&&Me(b)&&(p=e.value=b.toString())}var w=this.formatValidation(e.value,v).isValid;if(w)if(w=!1,y?(s&&!Me(s)&&(s=this.getDateAsNumber(e,s)),a&&!Me(a)&&(a=this.getDateAsNumber(e,a))):t.type==="TextLength"&&(p=e.value.toString().length.toString()),v==="List"){var I=e.value.toString(),x=Me(I),S=x&&Yi(this.parent.locale);if(s.startsWith("=")){for(var M=void 0,D=this.getListDataSource(s),A=0;A<D.length;A++)if(M=D[A].text.toString(),i===M||I===M||x&&I===this.parseValidationValue(M,S).toString()){w=!0;break}}else for(var L=this.getListOfValues(s),A=0;A<L.length;A++)if(i===L[A]||I===L[A]||x&&I===this.parseValidationValue(L[A],S).toString()){w=!0;break}!w&&m&&I===""&&(w=!0)}else if(v==="Custom"){var b=parseFloat(s.toString());if(Me(b))if(b===0){var T={value:t.value1};this.parent.notify(Nx,T),w=T.value===""}else w=!0;else s.toUpperCase()==="TRUE"?w=!0:w=!1;!w&&m&&s===""&&(w=!0)}else switch(v==="Decimal"||v==="Time"?(p=parseFloat(p.toString()),s=parseFloat(s.toString()),a=a?parseFloat(a.toString()):null):(p=parseInt(p.toString(),10),s=parseInt(s.toString(),10),a=a?parseInt(a.toString(),10):null),f){case"EqualTo":w=p===s;break;case"NotEqualTo":w=p!==s;break;case"Between":w=p>=s&&p<=a;break;case"NotBetween":w=!(p>=s&&p<=a);break;case"GreaterThan":w=p>s;break;case"LessThan":w=p<s;break;case"GreaterThanOrEqualTo":w=p>=s;break;case"LessThanOrEqualTo":w=p<=s;break}return w},o.prototype.parseValidationValue=function(e,t){if(Me(e))return t&&t.group==="."&&(e=e.toString(),e.indexOf(".")&&fd(e,this.parent.locale,t.group,t.decimal)&&(e=e.split(t.group).join(""))),e;var i={formattedText:e,value:e,format:"General",cell:{value:e,format:"General"},isEdit:!!t};return this.parent.notify(en,i),i.value},o.prototype.isValidCellHandler=function(e){var t=this.parent.sheets[e.sheetIdx],i=G(e.range[0],e.range[1],t),r={skip:!1,value:""},n=i&&i.validation;if(n){if(ut(n.value1)&&!Mr(n.value1.substring(1,n.value1.length))&&n.value1.indexOf("(")>-1){var s=n.value1;s=s.substring(s.indexOf("=")+1,s.indexOf("(")),r.value=s.toUpperCase(),this.parent.notify(vy,r)}if(!r.skip&&ut(n.value2)&&!Mr(n.value2.substring(1,n.value2.length))&&n.value1.indexOf("(")>-1){var a=n.value2;a=a.substring(a.indexOf("=")+1,a.indexOf("(")),r.value=a.toUpperCase(),this.parent.notify(vy,r)}}if(!r.skip&&(e.value=g(e.value)?"":e.value,n?(e.isValid=this.checkValidationHandler(e,n),e.isValid&&Ds(t.columns[e.range[1]],e.range[0],e.range[1])&&(n=t.columns[e.range[1]].validation,e.isValid=this.checkValidationHandler(e,n))):Ds(t.columns[e.range[1]],e.range[0],e.range[1])&&(n=t.columns[e.range[1]].validation,e.isValid=this.checkValidationHandler(e,n)),n)){var l=void 0;e.isEdit&&!e.isValid&&(e.isValid=l=this.validationErrorHandler(this.parent.serviceLocator.getService(fe).getConstant("ValidationError"))),e.isValid&&n.isHighlighted&&!st(t,e.range[0])&&!Ot(t,e.range[1])&&this.updateHighlightHandler({rowIdx:e.range[0],colIdx:e.range[1],isRemoveHighlightedData:!l,isRemoveValidation:!0})}},o.prototype.formatValidation=function(e,t,i){var r=this.parent.element.getElementsByClassName("e-sheet-panel")[0],n,s=this.parent.createElement("form",{id:"formId",className:"form-horizontal"}),a=this.parent.createElement("input",{id:"e-validation"});if(a.setAttribute("name","validation"),a.setAttribute("type","text"),t==="Date"&&Me(e)){var l=e.toString().split(".");l.length===2&&(e=l[0])}a.setAttribute("value",e),s.appendChild(a),r.appendChild(s);var h;switch(t){case"Date":h={rules:{validation:{date:!0}},customPlacement:function(c,d){n=d.innerText}};break;case"Decimal":h={rules:{validation:{number:!0}},customPlacement:function(c,d){n=d.innerText}};break;case"WholeNumber":h={rules:{validation:{regex:/^-?\d*\.?[0]*$/}},customPlacement:function(c,d){n=d.innerText}};break;case"TextLength":i&&(h={rules:{validation:{regex:/^\d*\.?[0]*$/}},customPlacement:function(c,d){n=d.innerText}});break}this.formObj=new _C("#formId",h);var u=this.formObj.validate();return r.removeChild(r.getElementsByClassName("form-horizontal")[0]),{isValid:u,errorMsg:n}},o.prototype.updateHighlightHandler=function(e){var t;if(!e.isRemoveValidation){var i=e.cell.value||e.cell.value===0?e.cell.value:e.cell.hyperlink?typeof e.cell.hyperlink=="string"?e.cell.hyperlink:e.cell.hyperlink.address||"":"",r={value:i,range:[e.rowIdx,e.colIdx],sheetIdx:this.parent.activeSheetIndex};t=this.checkValidationHandler(r,e.validation),t&&e.col&&Ds(e.col,e.rowIdx,e.colIdx)&&(r.value=i,t=this.checkValidationHandler(r,e.col.validation))}if(t){if(e.removeOnValidData){var n=this.parent.getCell(e.rowIdx,e.colIdx);n&&n.style.backgroundColor&&(e.td=n,e.style=this.parent.getCellStyleValue(["backgroundColor","color"],[e.rowIdx,e.colIdx]),this.parent.notify(Dr,e),e.td=null)}}else e.isRemoveHighlightedData?(e.style=this.parent.getCellStyleValue(["backgroundColor","color"],[e.rowIdx,e.colIdx]),this.parent.notify(Dr,e)):(e.style={backgroundColor:"#ffff00",color:"#ff0000"},this.parent.notify(Dr,e))},o.prototype.validationErrorHandler=function(e){var t=this,i=this.parent.element.getElementsByClassName("e-spreadsheet-edit")[0],r=this.parent.serviceLocator.getService(fe),n=!1;if(!this.parent.element.querySelector(".e-validation-error-dlg")){var s=this.parent.serviceLocator.getService(jt),a=!1,l={width:400,height:200,isModal:!0,showCloseIcon:!0,cssClass:"e-validation-error-dlg",target:document.getElementById(this.parent.element.id)||this.parent.element,beforeOpen:function(h){var u={dialogName:"ValidationErrorDialog",element:h.element,target:h.target,cancel:h.cancel,content:e};t.parent.trigger("dialogBeforeOpen",u),u.cancel&&(h.cancel=!0,n=!0),i.focus(),s.dialogInstance.content=u.content,s.dialogInstance.dataBind()},buttons:[{buttonModel:{content:r.getConstant("Retry"),isPrimary:!0},click:function(){t.errorDlgHandler(s,"Retry")}},{buttonModel:{content:r.getConstant("Cancel")},click:function(){t.errorDlgHandler(s,"Cancel")}}]};s.show(l,a)}return n},o.prototype.errorDlgHandler=function(e,t){if(t==="Retry"){var i=this.parent.element.getElementsByClassName("e-spreadsheet-edit")[0];e.hide(),i.innerText&&(window.getSelection().selectAllChildren(i),this.listObj&&!this.listObj.isDestroyed&&this.listObj.showPopup())}else{var r=Se(this.parent.getActiveSheet().activeCell),n=G(r[0],r[1],this.parent.getActiveSheet()),s=n?this.parent.getDisplayText(n):"";this.parent.notify(fi,{action:"cancelEdit",value:s,refreshFormulaBar:!0,refreshEditorElem:!0,isAppend:!1,trigEvent:!0}),e.hide()}},o.prototype.getModuleName=function(){return"dataValidation"},o}(),jq=function(){function o(e){this.parent=e,this.init()}return o.prototype.init=function(){this.addEventListener()},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(df,this.protect,this),this.parent.on(ru,this.protectSheetHandler,this),this.parent.on(ba,this.editProtectedAlert,this),this.parent.on(db,this.protectWorkbook,this),this.parent.on(ds,this.KeyUpHandler,this),this.parent.on(pb,this.unProtectWorkbook,this),this.parent.on(RI,this.unProtectSheetPassword,this),this.parent.on(NI,this.importProtectWorkbook,this),this.parent.on(LI,this.protectWorkbookHandler,this),this.parent.on(kI,this.removeWorkbookProtection,this),this.parent.on(yb,this.toggleProtect,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(df,this.protect),this.parent.off(ru,this.protectSheetHandler),this.parent.off(ba,this.editProtectedAlert),this.parent.off(db,this.protectWorkbook),this.parent.off(ds,this.KeyUpHandler),this.parent.off(pb,this.unProtectWorkbook),this.parent.off(RI,this.unProtectSheetPassword),this.parent.off(NI,this.importProtectWorkbook),this.parent.off(LI,this.protectWorkbookHandler),this.parent.off(kI,this.removeWorkbookProtection),this.parent.off(yb,this.toggleProtect))},o.prototype.protect=function(e){if(e.isActive){var t=this.parent.getActiveSheet();t.isImportProtected&&(t.isImportProtected=!1)}this.parent.notify(yd,null),e.isActive?(this.parent.setSheetPropertyOnMute(ke(this.parent,e.sheetIndex),"isProtected",!1),this.parent.notify(eu,{props:"Protect"}),this.parent.notify(ru,e),this.parent.notify(nb,null)):this.createDialogue()},o.prototype.createDialogue=function(){var e=this,t=this.parent.serviceLocator.getService(fe),i=[{text:t.getConstant("SelectCells"),id:"1"},{text:t.getConstant("SelectUnlockedCells"),id:"6"},{text:t.getConstant("FormatCells"),id:"2"},{text:t.getConstant("FormatRows"),id:"3"},{text:t.getConstant("FormatColumns"),id:"4"},{text:t.getConstant("InsertLinks"),id:"5"}];this.optionList=new yp({dataSource:i,showCheckBox:!0,select:this.dialogOpen.bind(this)});var r=this.parent.createElement("div",{className:"e-sheet-password-dialog"}),n=this.parent.createElement("div",{className:"e-sheet-password-content"}),s=this.parent.createElement("div",{className:"e-header"});s.innerText=t.getConstant("SheetPassword");var a=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});a.setAttribute("placeholder",t.getConstant("EnterThePassword")),n.appendChild(a),n.insertBefore(s,a),r.appendChild(n);var l=this.parent.createElement("div",{className:"e-protect-content"});l.innerText=t.getConstant("ProtectAllowUser"),this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(),"isProtected",!1);var h=new ea({checked:!0,label:t.getConstant("ProtectContent"),cssClass:"e-protect-checkbox"}),u=this.parent.createElement("div",{className:"e-protect-option-list",id:this.parent.element.id+"_option_list"}),c=this.parent.createElement("div",{className:"e-header-content"});c.innerText=t.getConstant("ProtectSheet");var d=this.parent.createElement("input",{id:this.parent.element.id+"_protect_check",attrs:{type:"checkbox"}}),p=this.parent.serviceLocator.getService("dialog"),f=function(){var m=fr(document.getElementById(e.parent.element.id+"_protect_check"),ea);p.dialogInstance.element.querySelector(".e-footer-content .e-btn.e-primary").disabled=!m.checked},v;p.show({header:c.outerHTML,content:r.outerHTML+d.outerHTML+l.outerHTML+u.outerHTML,showCloseIcon:!0,isModal:!0,cssClass:"e-protect-dlg",beforeOpen:function(m){var y={dialogName:"ProtectSheetDialog",element:m.element,target:m.target,cancel:m.cancel};e.parent.trigger("dialogBeforeOpen",y),y.cancel?v=m.cancel=!0:Fe(e.parent.element)},beforeClose:function(){v||E.remove(h.element,"click",f)},buttons:[{click:this.selectOption.bind(this,p),buttonModel:{content:t.getConstant("Ok"),isPrimary:!0}},{click:function(){return p.hide()},buttonModel:{content:t.getConstant("Cancel")}}]},!1),v||(h.appendTo("#"+this.parent.element.id+"_protect_check"),this.optionList.appendTo("#"+this.parent.element.id+"_option_list"),this.optionList.selectMultipleItems([{id:"1"},{id:"6"}]),E.add(h.element,"click",f,this))},o.prototype.dialogOpen=function(e){var t=this.parent.serviceLocator.getService(fe);e.text===t.getConstant("SelectCells")&&e.isChecked&&e.isInteracted&&this.optionList.checkItem({id:"6"}),e.text===t.getConstant("SelectUnlockedCells")&&!e.isChecked&&e.isInteracted&&this.optionList.uncheckItem({id:"1"})},o.prototype.selectOption=function(e){var t=e.dialogInstance.element.querySelector(".e-sheet-password-content .e-input"),i=t.value;if(i)this.reEnterSheetPassword(i);else{var r=this.parent.getActiveSheet();this.parent.setSheetPropertyOnMute(r,"isProtected",!0),this.parent.setSheetPropertyOnMute(r,"password",i),this.updateProtectSheet(i),e.hide(),!r.protectSettings.selectCells&&!r.protectSettings.selectUnLockedCells?this.parent.notify(nh,null):r.protectSettings.selectUnLockedCells&&ko(this.parent,J(r.selectedRange))&&this.parent.notify(nh,null)}},o.prototype.applySheetPwd=function(e){var t=this.parent.getActiveSheet();this.parent.setSheetPropertyOnMute(t,"isProtected",!0),this.parent.setSheetPropertyOnMute(t,"password",e),this.updateProtectSheet(e),!t.protectSettings.selectCells&&!t.protectSettings.selectUnLockedCells&&this.parent.notify(nh,null)},o.prototype.updateProtectSheet=function(e){var t=this.parent.serviceLocator.getService(fe),i=this.optionList.getSelectedItems(),r={selectCells:i.text.indexOf(t.getConstant("SelectCells"))>-1,formatCells:i.text.indexOf(t.getConstant("FormatCells"))>-1,formatRows:i.text.indexOf(t.getConstant("FormatRows"))>-1,formatColumns:i.text.indexOf(t.getConstant("FormatColumns"))>-1,insertLink:i.text.indexOf(t.getConstant("InsertLinks"))>-1,selectUnLockedCells:i.text.indexOf(t.getConstant("SelectUnlockedCells"))>-1};this.parent.notify($c,{protectSettings:r,password:e,triggerEvent:!0}),this.parent.notify(nb,null),this.parent.notify(uh,null)},o.prototype.protectSheetHandler=function(e){var t=g(e&&e.sheetIndex)?this.parent.activeSheetIndex:e.sheetIndex,i=ke(this.parent,t),r=this.parent.element.id,n=[r+"_undo",r+"_redo",r+"_cut",r+"_copy",r+"_paste",r+"_number_format",r+"_font_name",r+"_font_size",r+"_bold",r+"_italic",r+"_line-through",r+"_underline",r+"_font_color_picker",r+"_fill_color_picker",r+"_borders",r+"_merge_cells",r+"_text_align",r+"_vertical_align",r+"_wrap",r+"_sorting",r+"_clear",r+"_conditionalformatting"],s=[r+"_cut",r+"_copy",r+"_number_format",r+"_font_name",r+"_font_size",r+"_bold",r+"_italic",r+"_line-through",r+"_underline",r+"_font_color_picker",r+"_fill_color_picker",r+"_borders",r+"_text_align",r+"_vertical_align",r+"_wrap",r+"_sorting",r+"_clear",r+"_conditionalformatting"],a=[r+"_insert_function"],l=[r+"_hyperlink",r+"_",r+"_chart"],h=[r+"_image"],u=[r+"_find"],c=[r+"_datavalidation"],d=[r+"_chart"],p=document.getElementById(this.parent.element.id+"_sheet_panel");p&&(i.isProtected&&(i.protectSettings.selectCells||i.protectSettings.selectUnLockedCells&&!ko(this.parent,J(i.selectedRange)))?p.classList.remove("e-protected"):p.classList.add("e-protected"),i.isProtected||p.classList.remove("e-protected")),this.parent.dataBind(),this.parent.notify(fI,{disableHomeBtnId:n,enableHomeBtnId:s,enableFrmlaBtnId:a,enableInsertBtnId:l,findBtnId:u,dataValidationBtnId:c,imageBtnId:h,chartBtnId:d}),this.parent.notify(bI,null),i.isProtected&&this.parent.notify(eu,{props:"Protect"}),e&&e.triggerEvent&&this.parent.notify(mt,{action:"protectSheet",eventArgs:{sheetIndex:t,isProtected:i.isProtected,password:i.password,protectSettings:i.protectSettings.properties||i.protectSettings}})},o.prototype.editProtectedAlert=function(){var e=this,t=this.parent.serviceLocator.getService(fe),i=this.parent.serviceLocator.getService("dialog");i.show({content:t.getConstant("EditAlert"),isModal:!0,closeOnEscape:!0,showCloseIcon:!0,width:"400px",cssClass:"e-editAlert-dlg",beforeOpen:function(r){var n={dialogName:"EditAlertDialog",content:t.getConstant("EditAlert"),element:r.element,target:r.target,cancel:r.cancel};e.parent.trigger("dialogBeforeOpen",n),n.cancel?r.cancel=!0:(i.dialogInstance.content=n.content,Fe(e.parent.element))},close:function(){return Fe(e.parent.element)}})},o.prototype.protectWorkbook=function(){var e=this,t=this.parent.serviceLocator.getService(fe),i=this.parent.serviceLocator.getService(jt);i.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-protectworkbook-dlg",header:t.getConstant("ProtectWorkbook"),beforeOpen:function(r){var n={dialogName:"ProtectWorkbook",element:r.element,target:r.target,cancel:r.cancel};e.parent.trigger("dialogBeforeOpen",n),n.cancel?r.cancel=!0:(i.dialogInstance.content=e.passwordProtectContent(),i.dialogInstance.dataBind(),Fe(e.parent.element))},buttons:[{buttonModel:{content:t.getConstant("Ok"),isPrimary:!0},click:function(){e.alertMessage(),e.dlgClickHandler(i)}}]})},o.prototype.passwordProtectContent=function(){var e=this.parent.serviceLocator.getService(fe),t=this.parent.createElement("div",{className:"e-password-dialog"}),i=this.parent.createElement("div",{className:"e-password-content"}),r=this.parent.createElement("div",{className:"e-password-content"}),n=this.parent.createElement("div",{className:"e-header"});n.innerText=e.getConstant("Password");var s=this.parent.createElement("div",{className:"e-header"});s.innerText=e.getConstant("ConfirmPassword");var a=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}}),l=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});return a.setAttribute("placeholder",e.getConstant("EnterThePassword")),l.setAttribute("placeholder",e.getConstant("EnterTheConfirmPassword")),i.appendChild(a),i.insertBefore(n,a),r.appendChild(l),r.insertBefore(s,l),t.appendChild(r),t.insertBefore(i,r),t},o.prototype.KeyUpHandler=function(e){var t=e.target;if(t.classList.contains("e-text")&&j(t,".e-password-content")&&j(t,".e-password-dialog")&&j(t,".e-password-dialog").getElementsByClassName("e-password-content")[1]===t.parentElement){var i=j(t,".e-protectworkbook-dlg"),r=i.getElementsByClassName("e-footer-content")[0],n=r.firstChild;t.value!==""?n.removeAttribute("disabled"):n.setAttribute("disabled","true")}if(t.classList.contains("e-text")&&j(t,".e-unprotectpwd-content")&&j(t,".e-unprotectpwd-dialog")&&j(t,".e-unprotectpwd-dialog").getElementsByClassName("e-unprotectpwd-content")[0]===t.parentElement){var s=j(t,".e-unprotectworkbook-dlg"),a=s.getElementsByClassName("e-footer-content")[0],l=a.firstChild;t.value!==""?l.removeAttribute("disabled"):l.setAttribute("disabled","true")}if(t.classList.contains("e-text")&&j(t,".e-reenterpwd-content")&&j(t,".e-reenterpwd-dialog")&&j(t,".e-reenterpwd-dialog").getElementsByClassName("e-reenterpwd-content")[0]===t.parentElement){var h=j(t,".e-reenterpwd-dlg"),u=h.getElementsByClassName("e-footer-content")[0],c=u.firstChild;t.value!==""?c.removeAttribute("disabled"):c.setAttribute("disabled","true")}if(t.classList.contains("e-text")&&j(t,".e-unprotectsheetpwd-content")&&j(t,".e-unprotectsheetpwd-dialog")&&j(t,".e-unprotectsheetpwd-dialog").getElementsByClassName("e-unprotectsheetpwd-content")[0]===t.parentElement){var d=j(t,".e-unprotectworksheet-dlg"),p=d.getElementsByClassName("e-footer-content")[0],f=p.firstChild;t.value!==""?f.removeAttribute("disabled"):f.setAttribute("disabled","true")}if(t.classList.contains("e-text")&&j(t,".e-importprotectpwd-content")&&j(t,".e-importprotectpwd-dialog")&&j(t,".e-importprotectpwd-dialog").getElementsByClassName("e-importprotectpwd-content")[0]===t.parentElement){var v=j(t,".e-importprotectworkbook-dlg"),m=v.getElementsByClassName("e-footer-content")[0],f=m.firstChild;t.value!==""?f.removeAttribute("disabled"):f.setAttribute("disabled","true")}},o.prototype.alertMessage=function(){var e=this.parent.element.querySelector(".e-pwd-alert-span"),t=this.parent.element.querySelector(".e-unprotectpwd-alert-span"),i=this.parent.element.querySelector(".e-importprotectpwd-alert-span"),r=this.parent.element.querySelector(".e-reenterpwd-alert-span"),n=this.parent.element.querySelector(".e-unprotectsheetpwd-alert-span");e&&e.remove(),t&&t.remove(),i&&i.remove(),r&&r.remove(),n&&n.remove()},o.prototype.dlgClickHandler=function(e){var t=this.parent.serviceLocator.getService(fe),i=this.parent.element.querySelector(".e-password-dialog").getElementsByClassName("e-password-content")[0].querySelector(".e-input"),r=this.parent.element.querySelector(".e-password-dialog").getElementsByClassName("e-password-content")[1].querySelector(".e-input"),n=this.parent.createElement("span",{className:"e-pwd-alert-span"});i.value===r.value?(e.hide(),this.parent.notify(eu,{props:"Protectworkbook"}),this.protectWorkbookHandler({password:i.value}),this.parent.notify(mt,{action:"protectWorkbook",eventArgs:{isProtected:!0,password:i.value}})):i.value===""?n.textContent=t.getConstant("PasswordAlertMsg"):r.value===""?n.textContent=t.getConstant("ConfirmPasswordAlertMsg"):i.value!==r.value&&(n.textContent=t.getConstant("PasswordAlert")),e.dialogInstance&&this.parent.element.querySelector(".e-protectworkbook-dlg").querySelector(".e-dlg-content").appendChild(n)},o.prototype.protectWorkbookHandler=function(e){this.parent.password=e.password,this.parent.isProtected=!0,this.parent.showSheetTabs&&(this.parent.element.querySelector(".e-add-sheet-tab").setAttribute("disabled","true"),this.parent.element.querySelector(".e-add-sheet-tab").classList.add("e-disabled")),this.parent.notify(eu,{props:"Protectworkbook"})},o.prototype.unProtectWorkbook=function(){var e=this,t=this.parent.serviceLocator.getService(fe),i=this.parent.serviceLocator.getService(jt);i.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-unprotectworkbook-dlg",header:t.getConstant("UnprotectWorkbook"),beforeOpen:function(r){var n={dialogName:"UnprotectWorkbook",element:r.element,target:r.target,cancel:r.cancel};e.parent.trigger("dialogBeforeOpen",n),n.cancel?r.cancel=!0:(i.dialogInstance.content=e.unProtectPasswordContent(),i.dialogInstance.dataBind(),Fe(e.parent.element))},buttons:[{buttonModel:{content:t.getConstant("Ok"),isPrimary:!0,disabled:!0},click:function(){e.alertMessage(),e.unprotectdlgOkClick(i)}}]})},o.prototype.unProtectsheet=function(e){var t=this,i=this.parent.serviceLocator.getService(fe),r=this.parent.serviceLocator.getService(jt);r.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-unprotectworksheet-dlg",header:i.getConstant("UnprotectWorksheet"),beforeOpen:function(n){var s={dialogName:"UnProtectSheet",element:n.element,target:n.target,cancel:n.cancel};t.parent.trigger("dialogBeforeOpen",s),s.cancel?n.cancel=!0:(r.dialogInstance.content=t.unProtectSheetPasswordContent(),r.dialogInstance.dataBind(),Fe(t.parent.element))},buttons:[{buttonModel:{content:i.getConstant("Ok"),isPrimary:!0,disabled:!(this.parent.allowOpen&&this.parent.openModule.isImportedFile&&this.parent.openModule.unProtectSheetIdx.indexOf(this.parent.activeSheetIndex)===-1)},click:function(){t.alertMessage(),t.unprotectSheetdlgOkClick(r,e)}}]})},o.prototype.reEnterSheetPassword=function(e){var t=this,i=this.parent.serviceLocator.getService(fe),r=this.parent.serviceLocator.getService(jt),n=r.dialogInstance,s,a;r.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-reenterpwd-dlg",header:i.getConstant("ConfirmPassword"),beforeOpen:function(l){var h={dialogName:"Re-enterPassword",element:l.element,target:l.target,cancel:l.cancel};if(t.parent.trigger("dialogBeforeOpen",h),h.cancel)s=l.cancel=!0;else{var u=t.parent.serviceLocator.getService(fe),c=t.parent.createElement("div",{className:"e-reenterpwd-dialog"}),d=t.parent.createElement("div",{className:"e-reenterpwd-content"}),p=t.parent.createElement("div",{className:"e-header"});p.innerText=u.getConstant("ReEnterPassword");var f=t.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});d.appendChild(f),d.insertBefore(p,f),c.appendChild(d),r.dialogInstance.content=c,r.dialogInstance.dataBind(),Fe(t.parent.element.querySelector(".e-protect-dlg.e-dialog .e-footer-content .e-btn"))}},close:function(){r.dialogInstance=n,s?(t.applySheetPwd(e),r.hide(!0)):a&&r.hide(!0)},buttons:[{buttonModel:{content:i.getConstant("Ok"),isPrimary:!0,disabled:!0},click:function(){t.alertMessage();var l=t.parent.serviceLocator.getService(fe),h=t.parent.element.querySelector(".e-reenterpwd-dialog .e-reenterpwd-content .e-input"),u=h.value;if(e===u)t.applySheetPwd(e),a=!0,r.hide();else{var c=t.parent.createElement("span",{className:"e-reenterpwd-alert-span"});u?c.textContent=l.getConstant("PasswordAlert"):c.textContent=l.getConstant("ConfirmPasswordAlertMsg"),t.parent.element.querySelector(".e-reenterpwd-dlg").querySelector(".e-reenterpwd-dialog").appendChild(c)}}}]})},o.prototype.unProtectPasswordContent=function(){var e=this.parent.serviceLocator.getService(fe),t=this.parent.createElement("div",{className:"e-unprotectpwd-dialog"}),i=this.parent.createElement("div",{className:"e-unprotectpwd-content"}),r=this.parent.createElement("div",{className:"e-header"});r.innerText=e.getConstant("EnterThePassword");var n=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});return i.appendChild(n),i.insertBefore(r,n),t.appendChild(i),t},o.prototype.unProtectSheetPasswordContent=function(){var e=this.parent.serviceLocator.getService(fe),t=this.parent.createElement("div",{className:"e-unprotectsheetpwd-dialog"}),i=this.parent.createElement("div",{className:"e-unprotectsheetpwd-content"}),r=this.parent.createElement("div",{className:"e-header"});r.innerText=e.getConstant("EnterThePassword");var n=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});return i.appendChild(n),i.insertBefore(r,n),t.appendChild(i),t},o.prototype.unprotectdlgOkClick=function(e){var t=this.parent.serviceLocator.getService(fe),i=this.parent.element.querySelector(".e-unprotectpwd-dialog").getElementsByClassName("e-unprotectpwd-content")[0].querySelector(".e-input");if(this.parent.password===i.value)e.hide(),this.removeWorkbookProtection(),this.parent.notify(mt,{action:"protectWorkbook",eventArgs:{isProtected:!1}});else{var r=this.parent.createElement("span",{className:"e-unprotectpwd-alert-span"});r.innerText=t.getConstant("UnprotectPasswordAlert"),this.parent.element.querySelector(".e-unprotectworkbook-dlg").querySelector(".e-dlg-content").appendChild(r)}},o.prototype.removeWorkbookProtection=function(){this.parent.password="",this.parent.isProtected=!1,this.parent.showSheetTabs&&(this.parent.element.querySelector(".e-add-sheet-tab").removeAttribute("disabled"),this.parent.element.querySelector(".e-add-sheet-tab").classList.remove("e-disabled"));var e=document.getElementById(this.parent.element.id+"_protectworkbook");e&&e.classList.remove("e-active"),this.parent.notify(eu,{props:"Protectworkbook"})},o.prototype.unprotectSheetdlgOkClick=function(e,t){var i=this.parent.serviceLocator.getService(fe),r=this.parent.getActiveSheet(),n=this.parent.element.querySelector(".e-unprotectsheetpwd-dialog").getElementsByClassName("e-unprotectsheetpwd-content")[0].querySelector(".e-input");if(t&&r.password.length===0){var s={sheetPassword:n.value,sheetIndex:this.parent.activeSheetIndex};this.parent.open(s)}else if(r.password===n.value)e.hide(),this.unProtectSheetPassword();else{var a=this.parent.createElement("span",{className:"e-unprotectsheetpwd-alert-span"});a.innerText=i.getConstant("UnprotectPasswordAlert"),this.parent.element.querySelector(".e-unprotectworksheet-dlg").querySelector(".e-dlg-content").appendChild(a)}},o.prototype.unProtectSheetPassword=function(){var e=this.parent.getActiveSheet(),t=this.parent.activeSheetIndex;this.parent.setSheetPropertyOnMute(e,"isProtected",!e.isProtected),this.parent.setSheetPropertyOnMute(e,"password","");var i=!e.isProtected;this.parent.notify(df,{isActive:i,id:this.parent.element.id+"_protect",sheetIndex:t,triggerEvent:!0}),this.parent.allowOpen&&this.parent.openModule.isImportedFile&&this.parent.openModule.unProtectSheetIdx.indexOf(t)===-1&&this.parent.openModule.unProtectSheetIdx.push(t)},o.prototype.importProtectWorkbook=function(e){var t=this,i=this.parent.serviceLocator.getService(fe),r=this.parent.serviceLocator.getService(jt);r.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-importprotectworkbook-dlg",header:i.getConstant("UnprotectWorkbook"),beforeOpen:function(n){var s={dialogName:"ImportProtectWorkbook",element:n.element,target:n.target,cancel:n.cancel};t.parent.trigger("dialogBeforeOpen",s),s.cancel?n.cancel=!0:(r.dialogInstance.content=t.importProtectPasswordContent(e),r.dialogInstance.dataBind(),Fe(t.parent.element))},buttons:[{buttonModel:{content:i.getConstant("Ok"),isPrimary:!0,disabled:!0},click:function(){t.alertMessage(),t.importOkClick(e)}}]})},o.prototype.importProtectPasswordContent=function(e){var t=this.parent.serviceLocator.getService(fe),i=this.parent.createElement("div",{className:"e-importprotectpwd-dialog"}),r=this.parent.createElement("div",{className:"e-importprotectpwd-content"}),n=this.parent.createElement("span",{className:"e-header"});n.innerText='"'+e.file.name+'" '+t.getConstant("IsProtected");var s=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});return s.setAttribute("placeholder",t.getConstant("EnterThePassword")),r.appendChild(n),r.appendChild(s),i.appendChild(r),i},o.prototype.importOkClick=function(e){var t=this.parent.element.querySelector(".e-importprotectpwd-dialog").getElementsByClassName("e-importprotectpwd-content")[0].querySelector(".e-input");this.parent.password=t.value;var i={file:e.file,password:t.value};this.parent.open(i)},o.prototype.toggleProtect=function(){var e,t=this.parent.element.id,i=this.parent.getActiveSheet();i.isProtected&&this.parent.allowOpen&&i.isImportProtected&&this.parent.openModule.isImportedFile&&this.parent.openModule.unProtectSheetIdx.indexOf(this.parent.activeSheetIndex)===-1?this.unProtectsheet(!0):i.password&&i.password.length>0?this.unProtectsheet():(this.parent.setSheetPropertyOnMute(i,"isProtected",!i.isProtected),e=!i.isProtected,this.parent.notify(df,{isActive:e,id:t+"_protect",sheetIndex:this.parent.activeSheetIndex,triggerEvent:!0}))},o.prototype.getModuleName=function(){return"protectSheet"},o}(),Hq=function(){function o(e){this.shortValue="",this.divElements=[],this.paraElements=[],this.inputElements=[],this.textBoxElements=[],this.dropDownListElements=[],this.parent=e,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(vI,this.renderFindDlg,this),this.parent.on(gI,this.renderGotoDlg,this),this.parent.on(nu,this.gotoHandler,this),this.parent.on(uf,this.findHandler,this),this.parent.on(Sy,this.showFindAlert,this),this.parent.on(xy,this.replaceAllDialog,this),this.parent.on(Ix,this.findKeyUp,this),this.parent.on(du,this.findToolDlg,this),this.parent.on(Iu,this.refreshFindDlg,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(vI,this.renderFindDlg),this.parent.off(gI,this.renderGotoDlg),this.parent.off(nu,this.gotoHandler),this.parent.off(uf,this.findHandler),this.parent.off(Sy,this.showFindAlert),this.parent.off(xy,this.replaceAllDialog),this.parent.off(Ix,this.findKeyUp),this.parent.off(du,this.findToolDlg),this.parent.off(Iu,this.refreshFindDlg))},o.prototype.findToolDlg=function(e){var t=this,i=function(I){var x=t.parent.showRibbon&&t.parent.element.querySelector(".e-ribbon");if(x){var M=e.event&&e.event.target?j(e.event.target,"#"+t.parent.element.id+"_findbtn"):X("#"+t.parent.element.id+"_findbtn",x);M&&(I?M.classList.add("e-disabled"):M.classList.remove("e-disabled"),M.disabled=I)}},r=e.dialogEle||this.parent.element.getElementsByClassName("e-findtool-dlg")[0];e.isPublic&&(this.findValue=e.findValue);var n=this.parent.getActiveSheet(),s,a,l,h=function(I){if(!(!a||n.isProtected&&!n.protectSettings.selectCells&&!n.protectSettings.selectUnLockedCells)){var x=a.value;if(I&&I.keyCode===13)a.value&&l.textContent!=="0 of 0"&&(t.parent.notify(uf,{findOption:I.shiftKey?"prev":"next"}),t.updateCount(l,I.shiftKey));else{var M=void 0;if(x==="")l.textContent="0 of 0",M=!1;else{var D={value:x,mode:"Sheet",isCSen:!1,sheetIndex:t.parent.activeSheetIndex,isEMatch:!1,searchBy:"By Row"};t.parent.notify(wy,D),l.textContent=D.findCount,M=D.findCount!=="0 of 0"}s.enableItems(1,M),s.enableItems(2,M)}}};if(r)if(e.isPublic||e.refreshPosition){if(e.isPublic&&(a=r.querySelector(".e-text-findNext-short"),a.value=this.findValue,l=r.querySelector(".e-input-group-icon"),s=at(r.querySelector(".e-find-toolbar"),"toolbar"),h()),e.refreshPosition){var u=void 0;if(this.parent.getActiveSheet().showHeaders){var c=this.parent.getColumnHeaderContent().parentElement;u=(c&&c.offsetHeight||30)+1}else u=1;r.style.top=u+"px"}}else i(!0),this.findDialog.hide();else{var d=this.parent.createElement("div",{className:"e-input-group"});a=this.parent.createElement("input",{className:"e-input e-text-findNext-short",attrs:{type:"Text"}}),this.findValue&&(a.value=this.findValue);var p=this.parent.serviceLocator.getService(fe);a.setAttribute("placeholder",p.getConstant("FindValue")),l=this.parent.createElement("span",{className:"e-input-group-icon"});var f,v=n.usedRange.rowIndex*n.usedRange.colIndex>100;a.onkeyup=function(I){v?(f&&clearTimeout(f),f=setTimeout(h.bind(t,I),500)):h(I)},d.appendChild(a),d.appendChild(l);var m=[{type:"Input",template:d},{prefixIcon:"e-icons e-prev-icon",tooltipText:p.getConstant("FindPreviousBtn"),type:"Button",cssClass:"e-findRib-prev",disabled:!0},{prefixIcon:"e-icons e-next-icon",tooltipText:p.getConstant("FindNextBtn"),type:"Button",cssClass:"e-findRib-next",disabled:!0},{type:"Separator"},{prefixIcon:"e-icons e-option-icon",tooltipText:p.getConstant("MoreOptions"),type:"Button",cssClass:"e-findRib-more"},{prefixIcon:"e-icons e-close",tooltipText:p.getConstant("Close"),type:"Button",cssClass:"e-findRib-close"}];s=new Hl({clicked:function(I){I.item.cssClass==="e-findRib-next"?(t.parent.notify(uf,{findOption:"next"}),t.updateCount(l)):I.item.cssClass==="e-findRib-prev"?(t.parent.notify(uf,{findOption:"prev"}),t.updateCount(l,!0)):I.item.cssClass==="e-findRib-more"&&(t.findDialog.animationSettings.effect="None",t.findDialog.setProperties({animationSettings:t.findDialog.animationSettings},!0),t.renderFindDlg(),t.findDialog.hide())},width:"auto",height:"auto",items:m,cssClass:"e-find-toolObj",created:function(){var I=s.element.querySelectorAll(".e-toolbar-item .e-tbar-btn");I.forEach(function(x){return x.removeAttribute("tabindex")})}});var y=this.parent.createElement("div",{className:"e-find-toolbar",attrs:{tabindex:"-1"}});s.createElement=this.parent.createElement,s.appendTo(y),r=this.parent.createElement("div",{className:"e-dlg-div",attrs:{"aria-label":p.getConstant("FindValue")}});var S=this.parent.element.getElementsByClassName("e-sheet-panel")[0],b={cssClass:"e-findtool-dlg",visible:!1,enableRtl:this.parent.enableRtl,target:S,open:function(){if(E.add(document,"click",t.closeDialog,t),t.findValue&&(!n.isProtected||n.protectSettings.selectCells||n.protectSettings.selectUnLockedCells)){var I={value:t.findValue,mode:"Sheet",isCSen:!1,sheetIndex:t.parent.activeSheetIndex,isEMatch:!1,searchBy:"By Row"};t.parent.notify(wy,I),l.textContent=I.findCount;var x=I.findCount!=="0 of 0";s.enableItems(1,x),s.enableItems(2,x)}else l.textContent="0 of 0";i(!1);var M=s.element.querySelector(".e-input-group");M&&M.addEventListener("focus",function(){var D=s.element.querySelector(".e-text-findNext-short");Fe(D),D.classList.add("e-input-focus"),D.setSelectionRange(0,D.value.length)}),w&&t.findDialog.setProperties({animationSettings:w},!0)},beforeOpen:function(){return Fe(t.parent.element)},beforeClose:function(){t.findValue=a.value||null,s.destroy(),E.remove(document,"click",t.closeDialog)},close:function(){t.findDialog.destroy(),t.findDialog=null,ee(r),S.style.position="",Fe(t.parent.element),i(!1)},created:function(){S.style.position="relative",r.style.width=t.parent.getMainContent().offsetWidth+"px",r.style.visibility="hidden",r.style.display="block",t.findDialog.width=parseInt(getComputedStyle(r).borderLeftWidth,10)*2+r.querySelector(".e-toolbar-items").getBoundingClientRect().width+"px",r.style.display="",r.style.width="",r.style.visibility="",r.style.top=(e&&e.headerHgt||t.parent.getColumnHeaderContent().parentElement.offsetHeight+1)+"px",r.style.left="",r.style[t.parent.enableRtl?"left":"right"]=t.parent.sheetModule.getScrollSize()+"px",t.findDialog.show()}};B.isDevice?(b.header=y,b.allowDragging=!0):b.content=y,this.findDialog=new Ah(b),this.findDialog.createElement=this.parent.createElement;var w;e&&e.isPublic&&(w={effect:this.findDialog.animationSettings.effect},this.findDialog.setProperties({animationSettings:{effect:"None"}},!0)),this.findDialog.appendTo(r)}},o.prototype.refreshFindDlg=function(){var e=this.findDialog&&this.parent.element.getElementsByClassName("e-findtool-dlg")[0];if(e){var t=e.querySelector(".e-text-findNext-short");this.findToolDlg({findValue:t.value,isPublic:!0,refreshPosition:!0,dialogEle:e})}},o.prototype.updateCount=function(e,t){var i=e.textContent.split(" "),r;t?(r=Number(i[0])-1,r<1&&(r=Number(i[2]))):(r=Number(i[0])+1,r>Number(i[2])&&(r=1)),i[0]=r.toString(),e.textContent=i.join(" ")},o.prototype.closeDialog=function(e){(j(e.target,".e-findRib-close")||!j(e.target,".e-spreadsheet"))&&this.findDialog&&this.findToolDlg({})},o.prototype.renderFindDlg=function(){var e=this,t=this.parent.serviceLocator.getService(jt);if(this.parent.element.querySelector(".e-find-dlg"))t.hide();else{var i=this.parent.serviceLocator.getService(fe),r={isModal:!1,showCloseIcon:!0,cssClass:"e-find-dlg",header:i.getConstant("FindAndReplace"),beforeOpen:function(n){var s={dialogName:"FindAndReplaceDialog",element:n.element,target:n.target,cancel:n.cancel};e.parent.trigger("dialogBeforeOpen",s),s.cancel?n.cancel=!0:(t.dialogInstance.content=e.findandreplaceContent(),t.dialogInstance.dataBind(),Fe(e.parent.element))},buttons:[{buttonModel:{content:i.getConstant("FindPreviousBtn"),isPrimary:!0,cssClass:"e-btn-findPrevious",disabled:!0},click:function(n){e.dialogMessage(),e.findHandler({findOption:n&&n.keyCode===13?"next":"prev"})}},{buttonModel:{content:i.getConstant("FindNextBtn"),isPrimary:!0,cssClass:"e-btn-findNext",disabled:!0},click:function(){e.dialogMessage(),e.findHandler({findOption:"next"})}},{buttonModel:{content:i.getConstant("ReplaceBtn"),isPrimary:!0,cssClass:"e-btn-replace",disabled:!0},click:function(){e.dialogMessage(),e.replaceHandler(Df)}},{buttonModel:{content:i.getConstant("ReplaceAllBtn"),isPrimary:!0,cssClass:"e-btn-replaceAll",disabled:!0},click:function(){e.dialogMessage(),e.replaceHandler(ld)}}],open:function(){var n=e.parent.element.querySelector(".e-text-findNext");if(n.value){var s=e.parent.element.querySelector(".e-btn-findPrevious"),a=at(s,"btn");a.disabled=!1,at(e.parent.element.querySelector(".e-btn-findNext"),"btn").disabled=!1}cr(function(){Fe(n)})},beforeClose:this.dialogBeforeClose.bind(this)};t.show(r)}},o.prototype.dialogBeforeClose=function(){var e=this.checkBoxElements;e&&e.element&&(e.destroy(),e.element.remove()),this.checkBoxElements=null,this.textBoxElements.forEach(function(t){t&&t.element&&(t.destroy(),t.element.remove())}),this.textBoxElements=[],this.dropDownListElements.forEach(function(t){t&&t.element&&(t.destroy(),t.element.remove())}),this.dropDownListElements=[],us(this.paraElements),this.paraElements=[],us(this.inputElements),this.inputElements=[],us(this.divElements),this.divElements=[]},o.prototype.dialogMessage=function(){this.parent.element.querySelector(".e-replace-alert-span")?this.parent.element.querySelector(".e-replace-alert-span").remove():this.parent.element.querySelector(".e-find-alert-span")&&this.parent.element.querySelector(".e-find-alert-span").remove()},o.prototype.renderGotoDlg=function(){var e=this,t=this.parent.serviceLocator.getService(fe),i=this.parent.serviceLocator.getService(jt),r=!1;if(g(this.parent.element.querySelector(".e-goto-dlg"))){var n={width:300,isModal:!1,showCloseIcon:!0,cssClass:"e-goto-dlg",header:t.getConstant("GotoHeader"),beforeOpen:function(s){var a={dialogName:"GoToDialog",element:s.element,target:s.target,cancel:s.cancel};e.parent.trigger("dialogBeforeOpen",a),a.cancel?s.cancel=!0:(i.dialogInstance.content=e.GotoContent(),i.dialogInstance.dataBind(),Fe(e.parent.element))},buttons:[{buttonModel:{content:t.getConstant("Ok"),isPrimary:!0,cssClass:"e-btn-goto-ok"},click:function(){e.gotoHandler()&&i.hide()}}],open:function(){e.textFocus()}};i.show(n,r)}else i.hide()},o.prototype.textFocus=function(){var e=this,t=this.parent.element.querySelector(".e-text-goto");t.addEventListener("focus",function(){e.parent.element.querySelector(".e-goto-alert-span")&&e.parent.element.querySelector(".e-goto-alert-span").remove()})},o.prototype.findHandler=function(e){var t=this.parent.element.querySelector(".e-text-findNext");t||(t=this.parent.element.querySelector(".e-text-findNext-short"),t||this.gotoAlert());var i=t.value;if(t.value!==""){var r=this.parent.getActiveSheet();if(r.isProtected&&!r.protectSettings.selectCells&&!r.protectSettings.selectUnLockedCells)return;var n=this.parent.activeSheetIndex,s=this.parent.element.querySelector(".e-findnreplace-checkcase"),a=void 0;if(!s)a=!1;else{var l=at(s,"checkbox");a=l.checked}var h=this.parent.element.querySelector(".e-findnreplace-checkmatch"),u=void 0;if(!h)u=!1;else{var c=at(h,"checkbox");u=c.checked}var d=this.parent.element.querySelector(".e-findnreplace-searchby"),p=void 0;if(!d)p="By Row";else{var f=at(d,"dropdownlist");p=f.value.toString()}var v=this.parent.element.querySelector(".e-findnreplace-searchwithin"),m=void 0;if(!v)m="Sheet";else{var y=at(v,"dropdownlist");m=y.value.toString()}var S={value:i,sheetIndex:n,findOpt:e.findOption,mode:m,isCSen:a,isEMatch:u,searchBy:p,isAction:!0};this.parent.find(S)}},o.prototype.replaceHandler=function(e){var t=this.parent.element.querySelector(".e-find-dlg"),i=t.querySelector(".e-text-findNext").value,r=this.parent.element.querySelector(".e-text-replaceInp").value,n=this.parent.element.querySelector(".e-findnreplace-checkcase").checked,s=this.parent.element.querySelector(".e-findnreplace-checkmatch").checked,a=this.parent.element.querySelector(".e-search-within .e-ddl-hidden").value,l=this.parent.element.querySelector(".e-searchby .e-ddl-hidden").value;this.parent.notify(e,{value:i,mode:a,isCSen:n,isEMatch:s,searchBy:l,findOpt:"next",replaceValue:r,replaceBy:e,sheetIndex:this.parent.activeSheetIndex,isAction:!0})},o.prototype.gotoHandler=function(e){var t=!0;if(e)this.parent.goTo(e.address);else{for(var i=this.parent.element.querySelector(".e-text-goto").value,r=0;r<this.parent.definedNames.length;r++)if(this.parent.definedNames[r].name===i){i=this.parent.definedNames[r].refersTo.slice(1);break}var n=i;i.includes("!")&&(n=i.substring(i.lastIndexOf("!")+1)),n=n.split("$").join(""),n.includes(":")&&(n=n.split(":")[0]);var s=n.match(/\d+/),a=n.match(/[A-Z]+/i);if(!s||!a||a.index!==0)this.gotoAlert(),t=!1;else{var l=tt(J(n)),h=this.parent.getActiveSheet();l[2]>=1048576||l[3]>=16384?(this.gotoAlert(),t=!1):this.parent.scrollSettings.isFinite&&(h.rowCount<l[2]+1||h.colCount<l[3]+1)?(this.parent.notify(rb,null),t=!1):this.parent.goTo(i)}}return t},o.prototype.gotoAlert=function(){var e=this.parent.serviceLocator.getService(fe),t=this.parent.createElement("span",{className:"e-goto-alert-span"});t.innerText=e.getConstant("InsertingEmptyValue"),this.parent.element.querySelector(".e-goto-alert-span")&&this.parent.element.querySelector(".e-goto-alert-span").remove(),this.parent.element.querySelector(".e-goto-dlg").querySelector(".e-dlg-content").appendChild(t)},o.prototype.showFindAlert=function(){this.parent.element.querySelector(".e-replace-alert-span")&&this.parent.element.querySelector(".e-replace-alert-span").remove();var e=this.parent.element.querySelector(".e-find-dlg .e-dlg-content");if(e){var t=this.parent.createElement("span",{className:"e-find-alert-span"});t.innerText=this.parent.serviceLocator.getService(fe).getConstant("NoElements"),e.appendChild(t)}},o.prototype.replaceAllDialog=function(e){this.parent.element.querySelector(".e-find-alert-span")&&this.parent.element.querySelector(".e-find-alert-span").remove();var t=this.parent.element.querySelector(".e-replace-alert-span");t&&t.remove();var i=this.parent.serviceLocator.getService(fe),r=this.parent.createElement("span",{className:"e-replace-alert-span"});r.innerText=e.count+i.getConstant("ReplaceAllEnd")+e.replaceValue,this.parent.element.querySelector(".e-find-dlg")&&this.parent.element.querySelector(".e-find-dlg").querySelector(".e-dlg-content").appendChild(r)},o.prototype.findKeyUp=function(e){if(e.target.classList.contains("e-text-findNext")){var t=this.parent.element.querySelector(".e-text-findNext").value;if(!g(t)&&t!==""){var i=this.parent.element.querySelector(".e-btn-findPrevious"),r=at(i,"btn");r.disabled=!1,at(this.parent.element.querySelector(".e-btn-findNext"),"btn").disabled=!1}else at(this.parent.element.querySelector(".e-btn-findPrevious"),"btn").disabled=!0,at(this.parent.element.querySelector(".e-btn-findNext"),"btn").disabled=!0,this.dialogMessage()}var n=this.parent.element.querySelector(".e-text-findNext").value,s=this.parent.element.querySelector(".e-text-replaceInp").value;!g(n)&&!g(s)&&n!==""&&s!==""?this.parent.getActiveSheet().isProtected||(at(this.parent.element.querySelector(".e-btn-replace"),"btn").disabled=!1,at(this.parent.element.querySelector(".e-btn-replaceAll"),"btn").disabled=!1):(at(this.parent.element.querySelector(".e-btn-replace"),"btn").disabled=!0,at(this.parent.element.querySelector(".e-btn-replaceAll"),"btn").disabled=!0)},o.prototype.findandreplaceContent=function(){this.parent.element.querySelector(".e-text-findNext-short")&&(this.shortValue=this.parent.element.querySelector(".e-text-findNext-short").value);var e=this.parent.createElement("div",{className:"e-link-dialog"}),t=this.parent.createElement("div",{className:"e-find"}),i=this.parent.createElement("div",{className:"e-findCheck"});this.divElements.push(e),this.divElements.push(t),this.divElements.push(i);var r=this.parent.serviceLocator.getService(fe);e.appendChild(t);var n=this.parent.createElement("div",{className:"e-cont"}),s=this.parent.createElement("p",{className:"e-header"});s.innerText=r.getConstant("FindWhat");var a=this.parent.createElement("input",{className:"e-input e-text-findNext",attrs:{type:"Text",placeholder:r.getConstant("FindValue"),value:this.shortValue}});this.divElements.push(n),this.paraElements.push(s),this.inputElements.push(a),n.appendChild(a),n.insertBefore(s,a),t.appendChild(n);var l=new Lh({width:"70%"});this.textBoxElements.push(l),l.createElement=this.parent.createElement,l.appendTo(a);var h=this.parent.createElement("div",{className:"e-cont"}),u=this.parent.createElement("p",{className:"e-header"});u.innerText=r.getConstant("ReplaceWith");var c=this.parent.createElement("input",{className:"e-input e-text-replaceInp",attrs:{type:"Text",placeholder:r.getConstant("ReplaceValue")}});this.divElements.push(h),this.paraElements.push(u),this.inputElements.push(c),h.appendChild(c),h.insertBefore(u,c),t.appendChild(h);var d=new Lh({width:"70%"});this.textBoxElements.push(d),d.createElement=this.parent.createElement,d.appendTo(c);var p=[{Id:"Sheet",Within:r.getConstant("Sheet")},{Id:"Workbook",Within:r.getConstant("Workbook")}],f=new Ps({dataSource:p,cssClass:"e-search-within",fields:{value:"Id",text:"Within"},width:"50%",index:0});this.dropDownListElements.push(f);var v=r.getConstant("SearchWithin"),m=this.parent.createElement("input",{className:"e-findnreplace-searchwithin",attrs:{type:"select",label:v}}),y=this.parent.createElement("p",{className:"e-header"});y.innerText=v,this.inputElements.push(m),this.paraElements.push(y),t.appendChild(y),t.appendChild(m),f.createElement=this.parent.createElement,f.appendTo(m);var S=[{Id:"By Row",Search:r.getConstant("ByRow")},{Id:"By Column",Search:r.getConstant("ByColumn")}],b=new Ps({dataSource:S,cssClass:"e-searchby",fields:{value:"Id",text:"Search"},width:"50%",index:0});this.dropDownListElements.push(b),v=r.getConstant("SearchBy");var w=this.parent.createElement("input",{className:"e-findnreplace-searchby",attrs:{type:"select",label:v}}),I=this.parent.createElement("p",{className:"e-header"});I.innerText=v,this.inputElements.push(w),this.paraElements.push(I),t.appendChild(I),t.appendChild(w),b.createElement=this.parent.createElement,b.appendTo(w);var x=new ea({label:r.getConstant("MatchCase"),checked:!1,cssClass:"e-findnreplace-casecheckbox"}),M=this.parent.createElement("input",{className:"e-findnreplace-checkcase",attrs:{type:"checkbox"}});this.inputElements.push(M),i.appendChild(M),x.createElement=this.parent.createElement,x.appendTo(M);var D=new ea({label:r.getConstant("MatchExactCellElements"),checked:!1,cssClass:"e-findnreplace-exactmatchcheckbox"});this.checkBoxElements=D;var A=this.parent.createElement("input",{className:"e-findnreplace-checkmatch",attrs:{type:"checkbox"}});return this.inputElements.push(A),i.appendChild(A),D.createElement=this.parent.createElement,D.appendTo(A),t.appendChild(i),e},o.prototype.GotoContent=function(){var e=this.parent.serviceLocator.getService(fe),t=this.parent.createElement("div",{className:"e-link-dialog"}),i=this.parent.createElement("div",{className:"e-goto"});t.appendChild(i);var r=this.parent.createElement("div",{className:"e-cont"}),n=this.parent.createElement("p",{className:"e-header"});n.innerText=e.getConstant("Reference");var s=new Lh({placeholder:e.getConstant("EnterCellAddress")}),a=this.parent.createElement("input",{className:"e-text-goto",attrs:{type:"Text"}});return r.appendChild(a),r.insertBefore(n,a),i.appendChild(r),s.createElement=this.parent.createElement,s.appendTo(a),t},o.prototype.destroy=function(){this.removeEventListener(),this.findDialog&&this.findDialog.hide(),this.parent=null},o.prototype.getModuleName=function(){return"findAndReplace"},o}(),Vq=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.merge=function(e){this.parent.serviceLocator.getService("cell").refresh(e.rowIdx,e.colIdx,e.lastCell,e.element,!1,!1,cs(this.parent))},o.prototype.hideHandler=function(e){var t=this.parent.getActiveSheet(),i={range:[e.rowIdx,e.colIdx,e.rowIdx,e.colIdx]};this.parent.notify(ur,i),i.range=i.range;var r=G(i.range[0],i.range[1],t)||{},n=e.model==="row"?i.range[0]:i.range[1],s=n+((r[e.model+"Span"]||1)-1);if(!(!e.isEnd&&(e.start===n||Ot(t,n))||e.isEnd&&e.start>n&&!Ot(t,n))&&r[e.model+"Span"]>1&&s>=e.start)if(e.model==="row"?st(t,n):Ot(t,n)){if(e.colIdx<=s){var a=se(t,i.range[1],!0,"columns");if(a<=s){var l=i.range[0];r.rowSpan>1&&(l=se(t,i.range[0],!0),l=l<=i.range[2]?l:i.range[0]);var h=this.parent.getCell(l,a);h&&(h.style.display="",this.parent.serviceLocator.getService("cell").refresh(i.range[0],i.range[1],!0,h,!0,!0))}}}else{var l=r.rowSpan>1?se(t,i.range[0],!0):i.range[0];this.merge({rowIdx:i.range[0],colIdx:i.range[1],element:this.parent.getCell(l,i.range[1])})}},o.prototype.checkPrevMerge=function(e){var t=this,i,r,n,s,a,l=this.parent.getActiveSheet(),h=function(){var d=t.parent.getContentTable(),p=d&&d.rows[0];if(p){var f=parseInt(p.getAttribute("aria-rowindex"),10)-1;if(r.range=r.range,f>t.parent.viewport.topIndex+t.parent.frozenRowCount(l)&&f>r.range[0]&&f<=r.range[2]){var v=void 0,m=t.parent.getRowHeaderTable(),y=m&&m.rows[0],S=t.parent.frozenColCount(l);if(S&&!y)return;for(var b=e.colIdx;b<=r.range[3];b++)v=t.parent.getCell(f,b,b<S?y:p),v&&(v.colSpan>1||v.rowSpan>1)&&(v.style.display="none",v.removeAttribute("colSpan"),v.removeAttribute("rowSpan"))}}},u=function(d){if(r.range=r.range,st(l,r.range[0])&&e.rowIdx>=r.range[0]&&e.rowIdx<=r.range[2]){s=!1;for(var p=r.range[0];p<e.rowIdx;p++)if(!st(l,p)){s=!0;break}if(i.rowSpan>1&&!s){var f=i.rowSpan-t.parent.hiddenCount(r.range[0],r.range[2]);f>0&&(h(),e.td.style.display="",e.colSpan=n,e.rowSpan=f,e.cell=i,e.isMerged=!1)}}else if(d){for(var p=r.range[0];a&&p<e.rowIdx;p++)if(!st(l,p)){s=!0;break}s||(h(),e.td.style.display="",e.colSpan=n,e.cell=i,e.isMerged=!1)}};if(e.cell.colSpan<0){if(e.colIdx-1>-1&&Ot(l,e.colIdx-1)&&(i=G(e.rowIdx,e.colIdx-1,l,!1,!0),a=e.rowIdx-1>-1&&st(l,e.rowIdx-1),(i.colSpan!==void 0||i.rowSpan!==void 0)&&(i.rowSpan===void 0||i.rowSpan>1||a)&&(r={range:[e.rowIdx,e.colIdx-1,e.rowIdx,e.colIdx-1]},this.parent.notify(ur,r),r.range=r.range,i=G(r.range[0],r.range[1],l,!1,!0),Ot(l,r.range[1])&&e.colIdx>=r.range[1]&&e.colIdx<=r.range[3]))){for(var c=r.range[1];c<e.colIdx;c++)if(!Ot(l,c)){s=!0;break}i.colSpan>1&&!s&&(n=i.colSpan-this.parent.hiddenCount(r.range[1],r.range[3],"columns"),n>0&&u(!0))}}else e.rowIdx-1>-1&&st(l,e.rowIdx-1)&&(i=G(e.rowIdx-1,e.colIdx,l,!1,!0),i.rowSpan!==void 0&&(r={range:[e.rowIdx-1,e.colIdx,e.rowIdx-1,e.colIdx]},this.parent.notify(ur,r),r.range=r.range,i=G(r.range[0],r.range[1],l,!1,!0),u()))},o.prototype.checkMerge=function(e){var t=this.parent.getActiveSheet(),i,r=G(e.rowIdx,e.colIdx,t)||{};if(e.isRow){if(r.colSpan===void 0||Ot(t,e.colIdx-1)){if(i={range:[e.rowIdx,e.colIdx,e.rowIdx,e.colIdx]},i.range=i.range,this.parent.notify(ur,i),Ot(t,e.colIdx-1)&&!Ot(t,i.range[1])||e.isFreezePane&&i.range[0]<this.parent.frozenRowCount(t)){e.insideFreezePane=i.range[0]<this.parent.frozenRowCount(t);return}if(e.colIdx!==this.parent.viewport.leftIndex+this.parent.frozenColCount(t)&&Ot(t,e.colIdx-1)){for(var n=i.range[1];r.colSpan!==void 0&&n<e.colIdx;n++)if(!Ot(t,n))return}r=G(i.range[0],i.range[1],t);var s=i.range[2]-e.rowIdx+1-this.parent.hiddenCount(e.rowIdx,i.range[2]);s>=1&&(this.merge({rowIdx:i.range[0],colIdx:i.range[1],element:e.td}),s===1?e.td.removeAttribute("rowspan"):e.td.rowSpan=s,e.td.style.display="")}}else if(r.rowSpan===void 0||st(t,e.rowIdx-1)){if(i={range:[e.rowIdx,e.colIdx,e.rowIdx,e.colIdx]},i.range=i.range,this.parent.notify(ur,i),st(t,e.rowIdx-1)&&!st(t,i.range[0])||e.isFreezePane&&i.range[1]<this.parent.frozenColCount(t)){e.insideFreezePane=i.range[1]<this.parent.frozenColCount(t);return}if(e.rowIdx!==this.parent.viewport.topIndex+this.parent.frozenRowCount(t)&&st(t,e.rowIdx-1)){for(var a=i.range[0];r.rowSpan!==void 0&&a<e.rowIdx;a++)if(!st(t,a))return}r=G(i.range[0],i.range[1],t);var s=i.range[3]-e.colIdx+1-this.parent.hiddenCount(e.colIdx,i.range[3],"columns");s>=1&&(this.merge({rowIdx:i.range[0],colIdx:i.range[1],element:e.td}),s===1?e.td.removeAttribute("colspan"):e.td.colSpan=s,e.td.style.display="")}},o.prototype.addEventListener=function(){this.parent.on(Dx,this.merge,this),this.parent.on(sb,this.hideHandler,this),this.parent.on(SI,this.checkPrevMerge,this),this.parent.on(ab,this.checkMerge,this)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Dx,this.merge),this.parent.off(sb,this.hideHandler),this.parent.off(SI,this.checkPrevMerge),this.parent.off(ab,this.checkMerge))},o.prototype.getModuleName=function(){return"merge"},o}(),_q=function(){function o(e){this.divElements=[],this.spanElements=[],this.inputElements=[],this.dropDownListElements=[],this.parent=e,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.dupData&&(this.dupData=[]),this.colorData&&(this.colorData=[]),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(Wi,this.applyCF,this),this.parent.on(xI,this.renderCFDlg,this),this.parent.on(Ex,this.clearCF,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Wi,this.applyCF),this.parent.off(xI,this.renderCFDlg),this.parent.off(Ex,this.clearCF))},o.prototype.clearCF=function(e){var t=this,i=this.parent.getActiveSheet(),r=function(n,s,a,l){K([l],["e-redft","e-yellowft","e-greenft","e-redf","e-redt","e-iconset"]);var h,u;["backgroundColor","color"].forEach(function(d){l.style[""+d]&&(l.style[""+d]="",h=a&&a.style&&a.style[""+d]||t.parent.commonCellStyle[""+d],h&&(u={},u[""+d]=h,t.parent.notify(Dr,{style:u,rowIdx:n,colIdx:s,td:l})))});var c;[".e-cf-databar",".e-iconsetspan"].forEach(function(d){c=l.querySelector(d);var p=l.querySelector(".e-wrap-content");c&&(p?p.removeChild(c):l.removeChild(c),l.textContent=t.parent.getDisplayText(a))})};this.updateRange(i,e.indexes,this.parent.frozenRowCount(i),this.parent.frozenColCount(i),Se(i.topLeftCell),r)},o.prototype.renderCFDlg=function(e){var t=this,i=this.parent.serviceLocator.getService(fe),r,n=this.parent.serviceLocator.getService(jt);n.show({width:375,showCloseIcon:!0,isModal:!0,cssClass:"e-conditionalformatting-dlg",header:e.action.replace("...",""),beforeOpen:function(s){var a={dialogName:"ConditionalFormatDialog",element:s.element,target:s.target,cancel:s.cancel};t.parent.trigger("dialogBeforeOpen",a),a.cancel?s.cancel=!0:(n.dialogInstance.content=t.cfDlgContent(e.action),n.dialogInstance.dataBind(),Fe(t.parent.element))},beforeClose:this.dialogBeforeClose.bind(this),close:function(){r&&(t.parent.notify(nr,null),r=!1)},buttons:[{buttonModel:{content:i.getConstant("Ok"),isPrimary:!0},click:function(){var s=t.parent.getActiveSheet();qi(t.parent,tt(J(s.selectedRange)))?r=!0:t.dlgClickHandler(e.action),n.hide()}}]})},o.prototype.dialogBeforeClose=function(){var e=this.numericTBElements;e&&e.element&&(e.destroy(),e.element.remove()),this.numericTBElements=null,this.dropDownListElements.forEach(function(t){t&&t.element&&(t.destroy(),t.element.remove())}),this.dropDownListElements=[],this.value1Inp&&(this.value1Inp.removeEventListener("input",this.validateCFInput.bind(this)),this.value1Inp.parentNode&&this.value1Inp.parentNode.removeChild(this.value1Inp),this.value1Inp=null),this.value2Inp&&(this.value2Inp.removeEventListener("input",this.validateCFInput.bind(this)),this.value2Inp.parentNode&&this.value2Inp.parentNode.removeChild(this.value2Inp),this.value2Inp=null),us(this.spanElements),this.spanElements=[],us(this.inputElements),this.inputElements=[],us(this.divElements),this.divElements=[]},o.prototype.dlgClickHandler=function(e){var t=this.parent.serviceLocator.getService(fe),i=this.parent.element.querySelector(".e-conditionalformatting-dlg .e-dlg-content .e-cf-dlg"),r={cFColor:this.getCFColor(i.querySelector(".e-cfsub .e-input").value),range:this.parent.getActiveSheet().selectedRange},n=i.querySelectorAll(".e-cfmain .e-input");if(e===t.getConstant("DuplicateValues")+"...")r.type=n[0].value===t.getConstant("Duplicate")?"Duplicate":"Unique";else{r.type=this.getType(e);var s=[];n[0]&&s.push(n[0].value),n[1]&&s.push(n[1].value),Zc(s,this.parent),r.value=s.join(",")}this.parent.notify(hd,{cfModel:r,isAction:!0})},o.prototype.getType=function(e){var t=this.parent.serviceLocator.getService(fe),i;switch(e){case t.getConstant("GreaterThan")+"...":i="GreaterThan";break;case t.getConstant("LessThan")+"...":i="LessThan";break;case t.getConstant("Between")+"...":i="Between";break;case t.getConstant("CFEqualTo")+"...":i="EqualTo";break;case t.getConstant("TextThatContains")+"...":i="ContainsText";break;case t.getConstant("ADateOccuring")+"...":i="DateOccur";break;case t.getConstant("Top10Items")+"...":i="Top10Items";break;case t.getConstant("Bottom10Items")+"...":i="Bottom10Items";break;case t.getConstant("Top10")+" %...":i="Top10Percentage";break;case t.getConstant("Bottom10")+" %...":i="Bottom10Percentage";break;case t.getConstant("AboveAverage")+"...":i="AboveAverage";break;case t.getConstant("BelowAverage")+"...":i="BelowAverage";break}return i},o.prototype.getCFColor=function(e){var t=this.parent.serviceLocator.getService(fe),i="RedFT";switch(e){case t.getConstant("LightRedFillWithDarkRedText"):i="RedFT";break;case t.getConstant("YellowFillWithDarkYellowText"):i="YellowFT";break;case t.getConstant("GreenFillWithDarkGreenText"):i="GreenFT";break;case t.getConstant("RedFill"):i="RedF";break;case t.getConstant("RedText"):i="RedT";break}return i},o.prototype.cfDlgContent=function(e){var t=this.getDlgText(e),i=this.parent.serviceLocator.getService(fe),r=this.parent.createElement("div",{className:"e-cf-dlg"}),n=this.parent.createElement("div",{className:"e-cfmain"}),s=this.parent.createElement("div",{className:"e-cfsub"});this.divElements.push(r),this.divElements.push(n),this.divElements.push(s);var a=this.parent.createElement("span",{className:"e-header e-top-header"});a.innerText=t,this.value1Inp=this.parent.createElement("input",{className:"e-input",id:"valueInput",attrs:{type:"text","aria-label":t}});var l=this.parent.createElement("input",{className:"e-select"}),h=this.parent.createElement("span",{className:"e-header"});h.innerText=i.getConstant("With");var u=this.parent.createElement("input",{className:"e-select"});this.spanElements.push(a),this.inputElements.push(l),this.spanElements.push(h),this.inputElements.push(u),r.appendChild(n),r.appendChild(s),n.appendChild(a);var c;if(e!==i.getConstant("DuplicateValues")+"..."){if(e!==i.getConstant("AboveAverage")+"..."&&e!==i.getConstant("BelowAverage")+"..."){n.appendChild(this.value1Inp),c=!0;var d=e===i.getConstant("Top10")+" %..."||e===i.getConstant("Bottom10")+" %...";if(e===i.getConstant("Top10Items")+"..."||e===i.getConstant("Bottom10Items")+"..."||d){this.value1Inp.maxLength=d?3:4;var p=new ia({value:10,min:1,max:d?100:1e3,format:"###"});this.numericTBElements=p,p.appendTo(this.value1Inp)}}}else{n.appendChild(l),this.dupData=[{text:i.getConstant("Duplicate"),id:"duplicate"},{text:i.getConstant("Unique"),id:"unique"}];var f=new Ps({dataSource:this.dupData,index:0,popupHeight:"200px"});this.dropDownListElements.push(f),f.appendTo(l)}if(e===i.getConstant("Between")+"..."){var v=this.parent.createElement("span",{className:"e-header e-header-2"});v.innerText=i.getConstant("And"),this.value2Inp=this.parent.createElement("input",{className:"e-input e-between"}),this.spanElements.push(v),n.appendChild(v),n.appendChild(this.value2Inp),this.value2Inp.addEventListener("input",this.validateCFInput.bind(this))}c&&(this.validateCFInput({target:this.value1Inp}),this.value1Inp.addEventListener("input",this.validateCFInput.bind(this))),s.appendChild(h),s.appendChild(u),this.colorData=[{text:i.getConstant("LightRedFillWithDarkRedText"),value:"redft",id:"redft"},{text:i.getConstant("YellowFillWithDarkYellowText"),id:"yellowft"},{text:i.getConstant("GreenFillWithDarkGreenText"),id:"greenft"},{text:i.getConstant("RedFill"),id:"redf"},{text:i.getConstant("RedText"),id:"redt"}];var m=new Ps({dataSource:this.colorData,index:0,popupHeight:"200px"});return this.dropDownListElements.push(m),m.appendTo(u),r},o.prototype.validateCFInput=function(e){var t=this.parent.serviceLocator.getService(jt),i=e.target.value,r=t.dialogInstance.element.getElementsByClassName("e-primary")[0];i&&(e.target.classList.contains("e-between")||e.target.parentElement.querySelector(".e-between"))&&(i=e.target.parentElement.querySelector(e.target.classList.contains("e-between")?".e-input":".e-between").value),r.disabled=!i.trim()},o.prototype.checkCellHandler=function(e,t,i){var r=i.range.trim().split(",");return r.some(function(n){var s=J(n.includes(":")?n:n+":"+n);return e>=s[0]&&e<=s[2]&&t>=s[1]&&t<=s[3]})},o.prototype.getDlgText=function(e){var t=this.parent.serviceLocator.getService(fe),i="";switch(e){case t.getConstant("GreaterThan")+"...":i=t.getConstant("FormatCellsGreaterThan");break;case t.getConstant("LessThan")+"...":i=t.getConstant("FormatCellsLessThan");break;case t.getConstant("Between")+"...":i=t.getConstant("FormatCellsBetween");break;case t.getConstant("CFEqualTo")+"...":i=t.getConstant("FormatCellsEqualTo");break;case t.getConstant("TextThatContains")+"...":i=t.getConstant("FormatCellsThatContainTheText");break;case t.getConstant("ADateOccuring")+"...":i=t.getConstant("FormatCellsThatContainADateOccurring");break;case t.getConstant("DuplicateValues")+"...":i=t.getConstant("FormatCellsDuplicate");break;case t.getConstant("Top10Items")+"...":i=t.getConstant("FormatCellsTop");break;case t.getConstant("Top10")+" %...":i=t.getConstant("FormatCellsTop");break;case t.getConstant("Bottom10Items")+"...":i=t.getConstant("FormatCellsBottom");break;case t.getConstant("Bottom10")+" %...":i=t.getConstant("FormatCellsBottom");break;case t.getConstant("AboveAverage")+"...":i=t.getConstant("FormatCellsAbove");break;case t.getConstant("BelowAverage")+"...":i=t.getConstant("FormatCellsBelow");break}return i},o.prototype.updateResult=function(e,t,i,r,n,s,a,l){var h={},u={},c=e.range.split(","),d=[],p,f,v,m,y;i?y=function(){if(Me(f)&&m!=="Text"){var x=parseFloat(f);x>=0?(d[0]===void 0||x>d[0])&&(d[0]=x):(d[1]===void 0||x<d[1])&&(d[1]=x)}}:r?y=function(){if(Me(f)&&m!=="Text"){var x=parseFloat(f);d.push(Number(x))}}:n?(d=[0,0],y=function(){Me(f)&&m!=="Text"&&(d[0]+=parseFloat(f),d[1]++)}):s?y=function(){Me(f)&&m!=="Text"&&d.push(parseFloat(f))}:a?y=function(){if(Me(f)&&m!=="Text"){var x=parseFloat(f);(d[0]===void 0||x<d[0])&&(d[0]=x),(d[1]===void 0||x>d[1])&&(d[1]=x)}}:y=function(){h[""+f]?f!==""&&(u[""+f]||(u[""+f]=!0,d.push(f))):h[""+f]=!0};for(var S=0;S<c.length;S++){p=J(c[S]);for(var b=p[0];b<=p[2];b++)for(var w=p[1];w<=p[3];w++)v=G(b,w,t,!1,!0),m="",g(v.value)?v.formula&&(this.parent.notify(pu,{cell:v,rowIdx:b,colIdx:w,sheetIndex:this.parent.activeSheetIndex}),f=v.value.toString().toLowerCase(),m=Er(v.format),y()):(f=v.value.toString().toLowerCase(),m=Er(v.format),y())}if(r||s){if(d=d.sort(function(x,M){return x-M}),e.type.includes("Bottom")||(d=d.reverse()),s){var I=parseFloat(l);e.type.includes("Percentage")&&(I=I/(100/d.length),I=I<1?1:I),d=d.slice(0,I)}}else n&&(d=[d[0]/d[1]],d[0]||(d=[]));e.result=d},o.prototype.applyCF=function(e){var t=!e.cfModel,i=this.parent.getActiveSheet(),r=e.cfModel||i.conditionalFormats,n=[e.indexes];e.refreshAll&&(n=lO(this.parent,this.parent.viewport));for(var s={},a=r.length-1;a>=0;a--)t&&(n[0].length===2?!this.checkCellHandler(e.indexes[0],e.indexes[1],r[a]):!zy(n,r[a].range))||this.updateCF(e,i,r[a],s)},o.prototype.updateCF=function(e,t,i,r){var n=this,s,a="",l=!1;if(i.value){var h=[],u=[];if(i.type==="Between"?(h=i.value.split('"').filter(function(L){return L.trim()&&L.trim()!==","}),h.length>1?(u=h,l=!0):u=i.value.split(",").filter(function(L){return!!L.trim()})):u=[i.value],u.length>1)if(u[0].split("(").length>1){for(var c="",d=0;d<u.length;d++)c+=u[d]+",",c.split("(").length===c.split(")").length&&s===void 0&&(s=c.substring(0,c.length-1),c="");a=c.substring(0,c.length-1)}else{s=u[0];for(var d=1;d<u.length;d++)a+=d+1===u.length?u[d]:u[d]+","}else s=u[0]||i.value}i.type||(i.type="GreaterThan");var p,f;i.format&&i.format.style?(p=ZI(i.format.style,!0),Object.keys(p).length||(f=i.cFColor,f||(f=i.cFColor="RedFT"))):(p={},f=i.cFColor,f||(f=i.cFColor="RedFT"));var v=i.type.includes("Average"),m=i.type.includes("10")&&Me(s),y=i.type.includes("Three")||i.type.includes("Four")||i.type.includes("Five"),S=i.type.includes("DataBar"),b=i.type.includes("ColorScale");(!e.isRender||!i.result)&&(i.type==="Duplicate"||i.type==="Unique"||S||b||v||m||y)&&this.updateResult(i,t,S,b,v,m,y,s);var w=function(L,T,k,F,R,N){var P=k&&!g(k.value)?k.value.toString():"",O,z,H=!0,Q=k?Er(k.format):"";switch(i.type){case"GreaterThan":case"LessThan":O=n.isGreaterThanLessThan(i,P,s,Q);break;case"Between":O=Me(P)&&Q!=="Text"&&n.isBetWeen(i,P,s,a,N);break;case"EqualTo":O=n.isEqualTo(i,P,s);break;case"ContainsText":O=P&&s&&n.isContainsText(P,s);break;case"DateOccur":z={value:s,cell:{},updatedVal:s},Me(s)||n.parent.notify(Jr,z),O=P===z.updatedVal;break;case"Unique":O=P!==""&&i.result.indexOf(P.toLowerCase())===-1;break;case"Duplicate":O=i.result.indexOf(P.toLowerCase())>-1;break;case"Top10Items":case"Bottom10Items":case"Top10Percentage":case"Bottom10Percentage":if(i.result){var $=parseFloat(P);wo(P)&&($=Ms(P)),O=i.result.indexOf($)>-1}break;case"AboveAverage":O=i.result.length&&Me(P)&&Q!=="Text"&&parseFloat(P)>i.result[0];break;case"BelowAverage":O=i.result.length&&Me(P)&&Q!=="Text"&&parseFloat(P)<i.result[0];break;default:if(H=!1,S)r[L+"_"+T+"_bars"]||(r[L+"_"+T+"_bars"]=!0,n.applyDataBars(P,i,F,L,Q,R));else if(b){if(!r[L+"_"+T]){var $=Me(P)?parseFloat(P):NaN;if(isNaN($)){if(F.style.backgroundColor&&!F.classList.contains("e-yellowft")&&!F.classList.contains("e-greenft")&&!F.classList.value.includes("e-redf")){F.style.backgroundColor="";var U=he({},n.parent.commonCellStyle,k&&k.style);U.backgroundColor&&n.parent.notify(Dr,{style:{backgroundColor:U.backgroundColor},td:F,rowIdx:L,colIdx:T})}}else{var ie=i.result,ne=ie.indexOf($);if(ne===-1){if(F.style.backgroundColor){F.style.backgroundColor="";var te=he({},n.parent.commonCellStyle,k&&k.style);te.backgroundColor&&n.parent.notify(Dr,{style:{backgroundColor:te.backgroundColor},td:F,rowIdx:L,colIdx:T})}}else{var oe=n.getColor(i.type);F.style.backgroundColor=ne===0?oe[0]:ne===ie.length-1?oe[oe.length-1]:ie.length===3&&ne===1?oe[1]:n.getGradient(ne,oe[0],oe[1],oe[2],ie.length),r[L+"_"+T]=!0}}}}else if(!r[L+"_"+T+"_icons"]){r[L+"_"+T+"_icons"]=!0;var ae=n.parent.createElement("span",{className:"e-icon e-iconsetspan"}),ye=n.applyIconSet(P,i,F,ae,Q);ye&&k&&k.format&&k.format.includes("*")&&Er(k.format)!=="Accounting"&&n.parent.notify(Af,{cell:k,cellEle:F,rowIdx:L,colIdx:T,updateFillSize:!0,iconSetSpan:ae})}break}if(e.isAction&&H&&(n.parent.trigger("beforeConditionalFormat",{conditionalFormat:i,cell:k,element:F,apply:O,address:et(L,T)}),!O&&e.isEdit&&!r[L+"_"+T])){var De;f?F.className.includes("e-"+f.toLowerCase())&&(F.classList.remove("e-"+f.toLowerCase()),F.style.backgroundColor="",F.style.color="",De=he({},n.parent.commonCellStyle,k&&k.style),(De.backgroundColor||De.color)&&n.parent.notify(Dr,{rowIdx:L,colIdx:T,td:F,style:{backgroundColor:De.backgroundColor,color:De.color}})):(F.removeAttribute("style"),De=he({},n.parent.commonCellStyle,k&&k.style),Object.keys(De).length&&n.parent.notify(Dr,{style:De,rowIdx:L,colIdx:T,td:F}))}O&&!r[L+"_"+T]&&(r[L+"_"+T]=!0,K([F],["e-redft","e-yellowft","e-greenft","e-redf","e-redt"]),f&&(F.classList.add("e-"+f.toLowerCase()),n.setCFStyle(p,i)),Object.assign(F.style,p))};if(e.ele)w(e.indexes[0],e.indexes[1],e.cell,e.ele,e.resizedRowHeight,l);else for(var I=i.range.split(","),x=this.parent.frozenRowCount(t),M=this.parent.frozenColCount(t),D=Se(t.topLeftCell),A=0;A<I.length;A++)this.updateRange(t,J(I[A]),x,M,D,w,l)},o.prototype.updateRange=function(e,t,i,r,n,s,a){t[0]=t[0]<i?t[0]<n[0]?n[0]:t[0]:t[0]<this.parent.viewport.topIndex+i?this.parent.viewport.topIndex+i:t[0],t[1]=t[1]<r?t[1]<n[1]?n[1]:t[1]:t[1]<this.parent.viewport.leftIndex+r?this.parent.viewport.leftIndex+r:t[1],t[2]=t[2]<i?t[2]<n[0]?n[0]-1:t[2]:t[2]>this.parent.viewport.bottomIndex?this.parent.viewport.bottomIndex:t[2],t[3]=t[3]<r?t[3]<n[1]?n[1]-1:t[3]:t[3]>this.parent.viewport.rightIndex?this.parent.viewport.rightIndex:t[3];for(var l,h=t[0];h<=t[2];h++)if(i&&h===i&&(h=this.parent.viewport.topIndex+i),!st(e,h))for(var u=t[1];u<=t[3];u++)r&&u===r&&(u=this.parent.viewport.leftIndex+r),!Ot(e,u)&&(l=this.parent.getCell(h,u),l&&s(h,u,G(h,u,e),l,void 0,a))},o.prototype.applyIconSet=function(e,t,i,r,n){var s=i.classList.contains("e-iconset"),a=i.querySelector(".e-wrap-content");if(s){i.classList.remove("e-iconset");var l=i.querySelector(".e-iconsetspan");l&&(a?a.removeChild(l):i.removeChild(l))}var h=Me(e)?parseFloat(e):NaN,u=t.result;if(isNaN(h)||u[0]===void 0&&u[1]===void 0||Me(e)&&n==="Text")return s;var c=u[0],d=u[1],p=this.getIconList(t.type).split(","),f;if(p.length===3){var v=c+.67*(d-c),m=c+.33*(d-c);f="e-"+(h>=v?p[0].trim():h>=m?p[1].trim():p[2].trim())}else if(p.length===4){var y=c+.25*(d-c),S=c+.5*(d-c),b=c+.75*(d-c);f="e-"+(h>=b?p[0].trim():h>=S?p[1].trim():h>=y?p[2].trim():p[3].trim())}else if(p.length===5){var y=c+.2*(d-c),S=c+.4*(d-c),b=c+.6*(d-c),w=c+.8*(d-c);f="e-"+(h>=w?p[0].trim():h>=b?p[1].trim():h>=S?p[2].trim():h>=y?p[3].trim():p[4].trim())}r.classList.add(f);var I=i.querySelector(".e-cf-databar");return I&&(r.style.height=I.style.height,r.classList.add(i.style.verticalAlign==="top"?"e-cf-icon-top":i.style.verticalAlign==="middle"?"e-cf-icon-middle":"e-cf-icon-end")),a?a.insertBefore(r,a.firstChild):i.insertBefore(r,i.childNodes[0]),i.classList.add("e-iconset"),!0},o.prototype.getIconList=function(e){var t="3arrows-1,3arrows-2,3arrows-3";switch(e){case"ThreeArrows":return"3arrows-1,3arrows-2,3arrows-3";case"ThreeArrowsGray":return"3arrowsgray-1,3arrowsgray-2,3arrowsgray-3";case"FourArrowsGray":return"4arrowsgray-1,4arrowsgray-2,4arrowsgray-3,4arrowsgray-4";case"FourArrows":return"4arrows-1,4arrows-2,4arrows-3,4arrows-4";case"FiveArrowsGray":return"5arrowsgray-1,5arrowsgray-2,5arrowsgray-3,5arrowsgray-4,5arrowsgray-5";case"FiveArrows":return"5arrows-1,5arrows-2,5arrows-3,5arrows-4,5arrows-5";case"ThreeTrafficLights1":return"3trafficlights-1,3trafficlights-2,3trafficlights-3";case"ThreeTrafficLights2":return"3rafficlights2-1,3rafficlights2-2,3rafficlights2-3";case"ThreeSigns":return"3signs-1,3signs-2,3signs-3";case"FourTrafficLights":return"4trafficlights-1,4trafficlights-2,4trafficlights-3,4trafficlights-4";case"FourRedToBlack":return"4redtoblack-1,4redtoblack-2,4redtoblack-3,4redtoblack-4";case"ThreeSymbols":return"3symbols-1,3symbols-2,3symbols-3";case"ThreeSymbols2":return"3symbols2-1,3symbols2-2,3symbols2-3";case"ThreeFlags":return"3flags-1,3flags-2,3flags-3";case"FourRating":return"4rating-4,4rating-3,4rating-2,4rating-1";case"FiveQuarters":return"5quarters-1,5quarters-2,5quarters-3,5quarters-4,5quarters-5";case"FiveRating":return"5rating-5,5rating-4,5rating-3,5rating-2,5rating-1";case"ThreeTriangles":return"3triangles-1,3triangles-2,3triangles-3";case"ThreeStars":return"3stars-1,3stars-2,3stars-3";case"FiveBoxes":return"5boxes-1,5boxes-2,5boxes-3,5boxes-4,5boxes-5"}return t},o.prototype.applyDataBars=function(e,t,i,r,n,s){var a=this.parent.getActiveSheet(),l=t.result,h=0,u,c;if(Me(e)&&(c=parseFloat(e)),l[0]===void 0&&l[1]===void 0||isNaN(c)||Me(e)&&n==="Text"){var d=i.getElementsByClassName("e-cf-databar")[0];if(d){var p=d.getElementsByClassName("e-databar-value")[0].textContent,f=i.querySelector(".e-hyperlink"),v=i.querySelector(".e-addNoteIndicator"),m=i.querySelector(".e-wrap-content");m?(m.textContent="",f?m.appendChild(f):m.innerText=p):(i.removeChild(d),f?i.appendChild(f):i.innerText=p),v&&i.appendChild(v)}return}l[0]!==void 0&&l[1]!==void 0?(u=l[0]+Math.abs(l[1]),h=Math.abs(l[1]/u*100)):l[0]!==void 0?u=l[0]:u=l[1];var y=this.parent.createElement("div",{id:"spreadsheet-databar",className:"e-cf-databar"}),S=this.parent.createElement("span",{id:"spreadsheet-leftspan",className:"e-databar"}),b=this.parent.createElement("span",{id:"spreadsheet-rightspan",className:"e-databar"}),w=this.parent.createElement("span",{id:"spreadsheet-dataspan",className:"e-databar-value"}),I=i.querySelector(".e-iconsetspan"),x=i.querySelector(".e-addNoteIndicator"),M=i.querySelector(".e-wrap-content"),D=s||li(a,r,!0),A=i.querySelector("#"+this.parent.element.id+"_currency");y.style.height=D-1+"px",I&&(I.style.height=D-1+"px",I.classList.add(i.style.verticalAlign==="top"?"e-cf-icon-top":i.style.verticalAlign==="middle"?"e-cf-icon-middle":"e-cf-icon-end")),A&&(A.style.alignItems=i.style.verticalAlign==="top"?"start":i.style.verticalAlign==="middle"?"center":"end",A.classList.add("e-cf-currency"));var L=t.type[0];L==="L"&&(L+="B"),l[1]===void 0?(b.style.width=""+Math.ceil(Math.abs(c/u*100))+"%",b.style.height=D-3+"px",b.style.backgroundColor=this.getColor(L)[0],b.style.left="0px"):l[0]===void 0?(b.style.width=""+Math.ceil(Math.abs(c/u*100))+"%",b.style.height=D-3+"px",b.style.backgroundColor=this.getColor("R")[0],b.style.left="0px"):c>=0?(S.style.width=h+"%",S.style.height=D-3+"px",S.style.backgroundColor="transparent",S.style.left="0px",b.style.width=""+Math.ceil(Math.abs(c/u*100))+"%",b.style.height=D-3+"px",b.style.backgroundColor=this.getColor(L)[0],b.style.left=h+"%"):(S.style.width=""+Math.ceil(Math.abs(c/u*100))+"%",S.style.height=D-3+"px",S.style.backgroundColor=this.getColor("R")[0],S.style.width===h+"%"?S.style.left="0px":S.style.right=100-h+"%"),w.style.fontSize=i.style.fontSize||"11pt",w.style.alignItems=i.style.verticalAlign==="top"?"start":i.style.verticalAlign==="middle"?"center":"end",w.style.textDecoration=i.style.textDecoration;var T=i.querySelector("#"+this.parent.element.id+"_currency");T&&y.appendChild(T);var k=i.querySelector(".e-hyperlink");if(k)w.appendChild(k);else{var F=i.querySelector(".e-validation-list")?i.innerText:i.textContent;w.innerText=F,F===""&&w.appendChild(document.createTextNode(F))}y.appendChild(S),y.appendChild(b),y.appendChild(w),i.textContent="",M?(M.textContent="",I&&M.appendChild(I),M.appendChild(y),i.appendChild(M)):(I&&i.insertBefore(I,i.firstElementChild),i.appendChild(y)),x&&i.appendChild(x)},o.prototype.getColor=function(e){if(e==="LB")return["#008aef"];for(var t=e.split(""),i=[],r=0;r<t.length;r++)switch(t[r]){case"G":i.push("#63be7b");break;case"Y":i.push("#ffeb84");break;case"R":i.push("#f8696b");break;case"W":i.push("#ffffff");break;case"B":i.push("#5a8ac6");break;case"O":i.push("#ffb628");break;case"LB":i.push("#008aef");break;case"P":i.push("#d6007b");break}return i},o.prototype.getGradient=function(e,t,i,r,n){if(g(r))return this.getLinear(t,i,e/n);var s=n/2;return e>=s?this.getLinear(i,r,Math.abs((e-s)/s)):this.getLinear(t,i,e/s)},o.prototype.getLinear=function(e,t,i){var r=this.byteLinear(e[1]+e[2],t[1]+t[2],i),n=this.byteLinear(e[3]+e[4],t[3]+t[4],i),s=this.byteLinear(e[5]+e[6],t[5]+t[6],i);return"#"+r+n+s},o.prototype.byteLinear=function(e,t,i){var r=parseInt(e,16)*(1-i)+parseInt(t,16)*i|0;return Math.abs(r).toString(16)},o.prototype.isGreaterThanLessThan=function(e,t,i,r){if(Me(t)&&r!=="Text")if(Me(i)){var n=new RegExp(/[^.-a-zA-Z 0-9]+/g);return e.type==="GreaterThan"?parseFloat(t)>parseFloat(i.replace(n,"")):parseFloat(t)<parseFloat(i.replace(n,""))}else{var s={value:i,rowIndex:0,colIndex:0,sheetIndex:0,isDate:!1,updatedVal:"",isTime:!1};if(this.parent.notify(Jr,s),s.isDate||s.isTime)return e.value=s.updatedVal.toString(),e.type==="GreaterThan"?Number(t)>Number(s.updatedVal):Number(t)<Number(s.updatedVal);if(i)return e.type==="GreaterThan"?t.toLowerCase()>i.toLowerCase():t.toLowerCase()<i.toLowerCase()}else if(t===""&&Number(i)>0&&e.type==="LessThan")return!0;return!1},o.prototype.isBetWeen=function(e,t,i,r,n){var s,a;if(!n){var l=new RegExp(/[^.-a-zA-Z 0-9]+/g);i=i.replace(l,""),r=r.replace(l,"")}if(Me(i)){var h=parseFloat(i),u=parseFloat(r);return h>u&&(s=[u,h],h=s[0],u=s[1]),parseFloat(t)>=h&&parseFloat(t)<=u}else if(i&&r){var c={value:i,cell:{},updatedVal:""},d={value:r,cell:{},updatedVal:""};return this.parent.notify(Jr,c),this.parent.notify(Jr,d),(c.isDate||c.isTime)&&(d.isDate||d.isTime)?(e.value=c.updatedVal+","+d.updatedVal,c.updatedVal>d.updatedVal&&(a=[d.updatedVal,c.updatedVal],c.updatedVal=a[0],d.updatedVal=a[1]),t>=c.updatedVal&&t<=d.updatedVal):t.toLowerCase()>=i.toLowerCase()&&t.toLowerCase()<=r.toLowerCase()}return!1},o.prototype.isEqualTo=function(e,t,i){if(Me(i)){if(t==="")return parseFloat(i)===0;var r=new RegExp(/[^.-a-zA-Z 0-9]+/g);return parseFloat(t)===parseFloat(i.replace(r,""))}else{if(!t||!i)return!1;var n={value:i,cell:{},updatedVal:""};return this.parent.notify(Jr,n),n.isTime||n.isDate?(e.value=n.updatedVal,t===n.updatedVal):t.toLowerCase()===i.toLowerCase()}},o.prototype.isContainsText=function(e,t){var i=new RegExp(/[^.-a-zA-Z 0-9]+/g);return Me(t.replace(i,""))?(t=t.replace(i,""),wo(e)&&(e=Ms(e).toString()),e.indexOf(t)>-1):wo(t)?(wo(e)&&(e=Ms(e).toString()),e.indexOf(Ms(t).toString())>-1):e.toLowerCase().indexOf(t.toLowerCase())>-1},o.prototype.setCFStyle=function(e,t){switch(t.cFColor){case"RedFT":e.backgroundColor="#ffc7ce",e.color="#9c0055";break;case"YellowFT":e.backgroundColor="#ffeb9c",e.color="#9c6500";break;case"GreenFT":e.backgroundColor="#c6efce",e.color="#006100";break;case"RedF":e.backgroundColor="#ffc7ce";break;case"RedT":e.color="#9c0055";break}return e},o.prototype.getModuleName=function(){return"conditionalFormatting"},o}(),Uq=function(){function o(e){this.fillOptionIndex=0,this.parent=e,this.addEventListener()}return o.prototype.getfillItems=function(){var e=this.parent.serviceLocator.getService(fe);return[{text:e.getConstant("CopyCells")},{text:e.getConstant("FillSeries")},{text:e.getConstant("FillFormattingOnly")},{text:e.getConstant("FillWithoutFormatting")}]},o.prototype.createAutoFillElement=function(){if(this.parent.allowAutoFill){var e=this.parent.getMainContent(),t=this.parent.createElement("div",{className:"e-autofill"});e.lastElementChild&&e.lastElementChild.classList.contains("e-ss-overlay")?e.insertBefore(t,e.getElementsByClassName("e-ss-overlay")[0]):e.appendChild(t),this.autoFillElement=t,this.autoFillDropDown&&(this.autoFillDropDown.destroy(),this.autoFillDropDown=null),this.getautofillDDB({id:this.parent.element.id+"_autofilloptionbtn",appendElem:e})}},o.prototype.getautofillDDB=function(e){var t=this;return this.splitBtnElem=this.parent.createElement("button",{id:e.id,className:"e-filloption",attrs:{type:"button"}}),this.splitBtnElem.appendChild(this.parent.createElement("span",{className:"e-tbar-btn-text"})),this.autoFillDropDown=new Or({cssClass:"e-dragfill-ddb",iconCss:"e-icons e-dragfill-icon",items:this.getfillItems(),createPopupOnClick:!0,enableRtl:this.parent.enableRtl,select:function(i){t.autoFillOptionClick({type:t.getFillType(i.item.text)})},beforeOpen:function(){return t.autoFillClick()}}),this.autoFillDropDown.createElement=this.parent.createElement,this.autoFillDropDown.appendTo(this.splitBtnElem),e.appendElem.appendChild(this.splitBtnElem),this.autoFillDropDown},o.prototype.getFillType=function(e){var t=this.parent.serviceLocator.getService(fe),i;return e===t.getConstant("CopyCells")?i="CopyCells":e===t.getConstant("FillSeries")?i="FillSeries":e===t.getConstant("FillFormattingOnly")?i="FillFormattingOnly":i="FillWithoutFormatting",i},o.prototype.autoFillClick=function(){var e=this.parent.serviceLocator.getService(fe),t={fillType:"FillSeries",disableItems:[""]};this.parent.notify(Tx,t),this.autoFillDropDown.setProperties({items:this.getfillItems()},!0),this.autoFillDropDown.removeItems(t.disableItems),this.refreshAutoFillOption(e.getConstant(t.fillType))},o.prototype.getFillRange=function(e,t,i,r){switch(r){case"Up":return[i.rowIndex,e.colIndex,e.rowIndex-1,t.colIndex];case"Right":return[e.rowIndex,t.colIndex+1,t.rowIndex,i.colIndex];case"Down":return[t.rowIndex+1,e.colIndex,i.rowIndex,t.colIndex];case"Left":return[e.rowIndex,i.colIndex,t.rowIndex,e.colIndex-1]}},o.prototype.autoFillOptionClick=function(e){var t=this.parent.serviceLocator.getService(fe),i=this.parent.getActiveSheet(),r=tt(J(this.parent.selectionModule.dAutoFillCell)),n=J(i.selectedRange),s=r[0],a=r[1],l=r[2],h=r[3],u=this.getDirection({rowIndex:l,colIndex:h},{rowIndex:n[2],colIndex:n[3]}),c=[s,a,l,h],d=this.getFillRange({rowIndex:s,colIndex:a},{rowIndex:l,colIndex:h},{rowIndex:n[2],colIndex:n[3]},u);this.refreshAutoFillOption(t.getConstant(e.type));var p={isUndo:!0,isPublic:!0,preventReSelect:!0,preventEvt:e.type==="FillWithoutFormatting",setCollection:e.type==="FillFormattingOnly"||e.type==="FillWithoutFormatting",isFromAutoFillOption:!0};this.parent.notify(Ka,p);var f={dataRange:i.name+"!"+Be(c),fillRange:i.name+"!"+Be(d),direction:u,fillType:e.type,isFillOptClick:!0};this.isVerticalFill=f.direction==="Down"||f.direction==="Up",this.parent.notify(cd,f),this.positionAutoFillElement({isautofill:!0});var v={dataRange:f.dataRange,fillRange:f.fillRange,fillType:f.fillType,direction:f.direction,selectedRange:i.name+"!"+Be(n),undoArgs:p.undoArgs};this.parent.notify(mt,{eventArgs:v,action:"autofill"}),this.parent.showAggregate&&this.parent.notify(yl,{}),this.autoFillClick()},o.prototype.refreshAutoFillOption=function(e){for(var t=0;t<this.autoFillDropDown.items.length;t++)this.autoFillDropDown.items[t].iconCss="";for(var t=0;t<this.autoFillDropDown.items.length;t++)this.autoFillDropDown.items[t].text===e&&(this.autoFillDropDown.items[t].iconCss="e-icons e-selected-icon");["Copy Cells","Fill Series","Fill Formatting Only","Fill Without Formatting"].indexOf(e)<0&&(this.autoFillDropDown.items[this.fillOptionIndex].iconCss=""),this.autoFillDropDown.dataBind()},o.prototype.positionAutoFillElement=function(e){var t=0,i=0,r=this.parent.getActiveSheet(),n=tt(J(r.selectedRange)),s=-5,a=-5,l=6,h=6,u=n[1]===0&&n[3]===r.colCount-1,c=n[0]===0&&n[2]===r.rowCount-1,d=n[2],p=n[3],f,v,m,y=this.parent.enableRtl,S=this.parent.getCell(d,p);if(Ot(r,n[3])||st(r,n[2])||S&&S.classList.contains("e-formularef-selection")||r.isProtected&&r.protectSettings.selectUnLockedCells&&ko(this.parent,n)){this.hideAutoFillElement();return}if(r.isProtected&&(r.protectSettings.selectCells||r.protectSettings.selectUnLockedCells)||!r.isProtected){if(u?(s=-5,a=-1,l=6,h=2,d=n[2],p=n[1]):c&&(a=-5,s=0,l=1,h=6,d=n[0],p=n[3]),r.frozenColumns||r.frozenRows){if(c||u?(Us(this.parent,this.autoFillElement,n,"e-autofill",e&&e.preventAnimation),this.parent.autoFillSettings.showFillOptions&&e&&e.isautofill&&Us(this.parent,this.autoFillDropDown.element,n,"e-filloption")):(Us(this.parent,this.autoFillElement,[d,p,d,p],"e-autofill",e&&e.preventAnimation),this.parent.autoFillSettings.showFillOptions&&e&&e.isautofill&&Us(this.parent,this.autoFillDropDown.element,[d,p,d,p],"e-filloption")),this.autoFillElement){this.autoFillCell={rowIndex:d,colIndex:p};var b=this.parent.element.querySelectorAll(".e-autofill");if(b.length){var w=b[0].getBoundingClientRect();this.autoFillElementPosition={left:w.left,top:w.top},[].slice.call(b).forEach(function(T){K([T],"e-hide")})}}}else if(m=Ib(r,[d,p,d,p],this.parent.frozenRowCount(r),this.parent.frozenColCount(r),this.parent.viewport.beforeFreezeHeight,this.parent.viewport.beforeFreezeWidth,this.parent.sheetModule.colGroupWidth),f=Ri(r,d,d,!0),v=Ci(r,p,p,!0),c||(t+=f),u||(i+=v),t+=Math.round(m.top)+s,i+=Math.round(m.left)+a,this.autoFillElement){K([this.autoFillElement],"e-hide"),this.autoFillElement.style.top=t+"px",y?this.autoFillElement.style.right=i+"px":this.autoFillElement.style.left=i+"px",this.autoFillCell={rowIndex:d,colIndex:p};var w=this.autoFillElement.getBoundingClientRect();if(this.autoFillElementPosition={left:w.left,top:w.top},this.parent.autoFillSettings.showFillOptions&&e&&e.isautofill){K([this.autoFillDropDown.element],"e-hide");var I=this.parent.element.querySelector(".e-main-panel"),x=this.parent.element.querySelector(".e-main-panel .e-sheet-content .e-virtualable"),M=this.parent.element.querySelector(".e-sheet-panel .e-scrollbar .e-scroller"),D=x&&x.clientHeight<I.clientHeight?I.clientHeight-x.clientHeight:0,A=x&&x.clientWidth<I.clientWidth?I.clientWidth-x.clientWidth:0,L=this.autoFillDropDown.element.getBoundingClientRect();I.scrollTop+I.clientHeight-D<t+L.height&&(t-=L.height),M.scrollLeft+M.clientWidth-A<i+L.width&&(i-=L.width),this.autoFillDropDown.element.style.top=t+l+"px",y?this.autoFillDropDown.element.style.right=i+h+"px":this.autoFillDropDown.element.style.left=i+h+"px"}}}},o.prototype.hideAutoFillElement=function(){var e=this.parent.element;[].slice.call(e.querySelectorAll(".e-autofill")).forEach(function(t){e&&Y([t],"e-hide")})},o.prototype.hideAutoFillOptions=function(){var e=this.parent.element;[].slice.call(e.querySelectorAll(".e-filloption")).forEach(function(t){e&&Y([t],"e-hide")})},o.prototype.selectAutoFillRange=function(e){var t={clientY:Io(e.e),target:e.e.target},i={clientX:xo(e.e),target:e.e.target},r=this.parent.getActiveSheet();this.parent.notify(Ys,t),this.parent.notify(Qs,i);var n,s=this.getAutoFillRange({rowIndex:t.clientY,colIndex:i.clientX});return s&&s.fillRange?n=[s.startCell.rowIndex,s.startCell.colIndex,s.endCell.rowIndex,s.endCell.colIndex]:n=J(r.selectedRange),e.indexes=n,n},o.prototype.getAutoFillRange=function(e){var t=this.parent.getActiveSheet(),i=this.autoFillCell,r=tt(J(t.selectedRange)),n=r[0],s=r[1],a=r[2],l=r[3],h=Lf(r,[e.rowIndex,e.colIndex,e.rowIndex,e.colIndex],!0),u={rowIndex:n,colIndex:s},c={rowIndex:r[0],colIndex:r[1]},d={rowIndex:r[2],colIndex:r[3]},p={rowIndex:a,colIndex:l},f=this.modifyRangeForMerge(e.rowIndex,e.colIndex,i.rowIndex,i.colIndex,r);return e.rowIndex<i.rowIndex?n-e.rowIndex>e.colIndex-l&&n-e.rowIndex>s-e.colIndex?h?{startCell:u,endCell:{rowIndex:e.rowIndex,colIndex:l}}:{startCell:p,endCell:{rowIndex:f.rowIndex,colIndex:s},fillRange:[f.rowIndex,s,n-1,l],direction:"Up"}:e.colIndex>i.colIndex?{startCell:u,endCell:{rowIndex:a,colIndex:e.colIndex},fillRange:[n,l+1,a,e.colIndex],direction:"Right"}:e.colIndex<i.colIndex?h?{startCell:u,endCell:p}:{startCell:p,endCell:{rowIndex:n,colIndex:e.colIndex},fillRange:[n,e.colIndex,a,s-1],direction:"Left"}:{startCell:c,endCell:d}:e.colIndex>i.colIndex?e.rowIndex-a>e.colIndex-l?{startCell:u,endCell:{rowIndex:e.rowIndex,colIndex:l},fillRange:[a+1,s,e.rowIndex,l],direction:"Down"}:{startCell:u,endCell:{rowIndex:a,colIndex:f.colIndex},fillRange:[n,l+1,a,f.colIndex],direction:"Right"}:e.colIndex<i.colIndex?e.rowIndex-a>l-e.colIndex||e.rowIndex-n>l-e.colIndex&&e.rowIndex!==a?{startCell:u,endCell:{rowIndex:e.rowIndex,colIndex:l},fillRange:[a+1,s,e.rowIndex,l],direction:"Down"}:h?{startCell:u,endCell:p}:{startCell:p,endCell:{rowIndex:n,colIndex:f.colIndex},fillRange:[n,f.colIndex,a,s-1],direction:"Left"}:e.rowIndex>i.rowIndex?{startCell:u,endCell:{rowIndex:f.rowIndex,colIndex:l},fillRange:[a+1,s,f.rowIndex,l],direction:"Down"}:e.rowIndex===i.rowIndex&&e.colIndex===i.colIndex?{startCell:c,endCell:d}:{startCell:c,endCell:d}},o.prototype.modifyRangeForMerge=function(e,t,i,r,n){var s={rowIndex:e,colIndex:t};if(this.isMergedRange(n)){var a=n[2]-n[0]+1,l=n[3]-n[1]+1,h=void 0;e<i?(h=(n[2]-e+1)%a,h&&e-(a-h)>=0&&(s.rowIndex=e-(a-h))):t>r?(h=(t-n[1]+1)%l,h&&(s.colIndex=t+(l-h))):t<r?(h=(n[3]-t+1)%l,h&&t-(l-h)>=0&&(s.colIndex=t-(l-h))):e>i&&(h=(e-n[0]+1)%a,h&&(s.rowIndex=e+(a-h)))}return s},o.prototype.performAutoFill=function(e){if(e.rangeInfo||!(e.event.clientX>this.autoFillElementPosition.left&&e.event.clientX<this.autoFillElementPosition.left+10)||!(e.event.clientY>this.autoFillElementPosition.top&&e.event.clientY<this.autoFillElementPosition.top+10)){var t=void 0;if(e.rangeInfo)t=e.rangeInfo;else{var i={clientY:Io(e.event),target:e.event.target},r={clientX:xo(e.event),target:e.event.target};this.parent.notify(Ys,i),this.parent.notify(Qs,r),t=this.getAutoFillRange({rowIndex:i.clientY,colIndex:r.clientX})}var n=this.parent.getActiveSheet();if(t&&t.fillRange){var s={dataRange:n.name+"!"+e.dAutoFillCell,fillRange:n.name+"!"+Be(t.fillRange),direction:t.direction,fillType:e.fillType||this.parent.autoFillSettings.fillType,cancel:!1},a=qi(this.parent,J(e.dAutoFillCell))||qi(this.parent,t.fillRange);if(a){this.parent.notify(nr,null);return}if(this.parent.notify(ai,{eventArgs:s,action:"autofill"}),s.cancel)return;var l=ko(this.parent,t.fillRange);if(n.isProtected&&l){this.parent.notify(ba,null);return}e.rangeInfo?this.performAutoFillAction(s,null,l):(this.performAutoFillAction(s,t,l),this.positionAutoFillElement({isautofill:!0}))}}else this.positionAutoFillElement({isautofill:!1})},o.prototype.refreshCell=function(e){this.parent.serviceLocator.getService("cell").refreshRange([e.rowIndex,e.colIndex,e.rowIndex,e.colIndex])},o.prototype.getDirection=function(e,t,i){if(i=g(i)?this.isVerticalFill:i,i){if(t.rowIndex<e.rowIndex)return"Up";if(t.rowIndex>e.rowIndex)return"Down";if(t.colIndex>e.colIndex)return"Right";if(t.colIndex<e.colIndex)return"Left"}else{if(t.colIndex>e.colIndex)return"Right";if(t.colIndex<e.colIndex)return"Left";if(t.rowIndex<e.rowIndex)return"Up";if(t.rowIndex>e.rowIndex)return"Down"}return null},o.prototype.performAutoFillAction=function(e,t,i){var r=this,n=this.parent.getActiveSheet(),s=this.parent.serviceLocator.getService(fe);if(this.isMergedRange(J(e.fillRange))){var a=this.parent.serviceLocator.getService(jt);a.show({isModal:!0,showCloseIcon:!0,height:180,width:400,content:s.getConstant("AutoFillMergeAlertMsg"),buttons:[{buttonModel:{content:this.parent.serviceLocator.getService(fe).getConstant("Ok"),isPrimary:!0},click:function(){a.hide(),r.parent.selectRange(e.dataRange)}}],close:function(){a.hide(),r.parent.selectRange(e.dataRange)}},!1);return}this.isVerticalFill=e.direction==="Down"||e.direction==="Up",this.parent.notify(cd,{dataRange:e.dataRange,fillRange:e.fillRange,direction:e.direction,fillType:e.fillType,isLockedCell:i});var l=t?Be([t.startCell.rowIndex,t.startCell.colIndex,t.endCell.rowIndex,t.endCell.colIndex]):n.selectedRange;gf(this.parent,l,n);var h={dataRange:e.dataRange,fillRange:e.fillRange,fillType:e.fillType,direction:e.direction,selectedRange:l};this.parent.notify(mt,{eventArgs:h,action:n.conditionalFormats&&n.conditionalFormats.length>0&&n.conditionalFormats[n.conditionalFormats.length-1].action==="autofillWithCF"?"autofillWithCF":"autofill"}),this.parent.trigger("select",{range:this.parent.getActiveSheet().selectedRange}),this.parent.showAggregate&&this.parent.notify(yl,{}),this.parent.notify(Es,null)},o.prototype.getRangeData=function(e){for(var t=[],i=this.parent.getActiveSheet(),r=e.range[0],n=e.range[1],s=e.range[2],a=e.range[3],l=n,h;r<=s;){if(st(i,r)){r++;continue}for(n=l;n<=a;){if(Ot(i,n)){n++;continue}h=G(r,n,i),t.push(h),n++}r++}return t},o.prototype.isMergedRange=function(e){var t=0,i=this.getRangeData({range:e,sheetIdx:this.parent.activeSheetIndex});for(t=0;t<i.length;t++)if(i[t]&&(i[t].rowSpan||i[t].colSpan))return!0;return!1},o.prototype.addEventListener=function(){this.parent.on(In,this.createAutoFillElement,this),this.parent.on(Za,this.positionAutoFillElement,this),this.parent.on(gb,this.hideAutoFillOptions,this),this.parent.on(nh,this.hideAutoFillElement,this),this.parent.on(vb,this.performAutoFill,this),this.parent.on(OI,this.selectAutoFillRange,this),this.parent.on(HF,this.refreshCell,this),this.parent.on(ky,this.getautofillDDB,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(In,this.createAutoFillElement),this.parent.off(Za,this.positionAutoFillElement),this.parent.off(gb,this.hideAutoFillOptions),this.parent.off(nh,this.hideAutoFillElement),this.parent.off(vb,this.performAutoFill),this.parent.off(OI,this.selectAutoFillRange),this.parent.off(HF,this.refreshCell),this.parent.off(ky,this.getautofillDDB))},o.prototype.destroy=function(){this.removeEventListener(),this.autoFillElement&&this.autoFillElement.remove(),this.autoFillElement=null,this.autoFillElementPosition=null,this.autoFillCell=null,this.autoFillDropDown&&this.autoFillDropDown.destroy(),this.autoFillDropDown=null,this.isVerticalFill=null,this.fillOptionIndex=null,this.splitBtnElem&&(_a(this.splitBtnElem),this.splitBtnElem.remove()),this.splitBtnElem=null,this.parent=null},o.prototype.getModuleName=function(){return"autofill"},o}(),Wq=function(){function o(e){this.isNoteVisible=!1,this.isNoteVisibleOnTouch=!1,this.parent=e,this.addEventListener()}return o.prototype.destroy=function(){if(this.removeEventListener(),!this.parent.isDestroyed&&!this.parent.refreshing)for(var e=this.parent.element.getElementsByClassName("e-addNoteIndicator");e.length;){var t=j(e[0],".e-cell");t&&(E.remove(t,"mouseover",this.mouseOver),E.remove(t,"mouseout",this.mouseOut)),ee(e[0])}this.parent=null,this.isNoteVisible=null},o.prototype.addEventListener=function(){this.parent.on(Qy,this.addNote,this),this.parent.on(Xy,this.editNote,this),this.parent.on(Bf,this.deleteNote,this),this.parent.on(bd,this.createNoteIndicator,this),this.parent.on(ed,this.showNote,this),this.parent.on(iu,this.removeNoteContainer,this),this.parent.on(lI,this.updateNoteContainer,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Qy,this.addNote),this.parent.off(Xy,this.editNote),this.parent.off(ed,this.showNote),this.parent.off(Bf,this.deleteNote),this.parent.off(bd,this.createNoteIndicator),this.parent.off(iu,this.removeNoteContainer),this.parent.off(lI,this.updateNoteContainer))},o.prototype.getModuleName=function(){return"spreadsheetNote"},o.prototype.addNote=function(){var e=g(this.noteCellIndexes)?Se(this.parent.getActiveSheet().activeCell):this.noteCellIndexes,t=this.parent.getCell(e[0],e[1]);!g(t)&&(t.children.length===0||t.children.length>0&&t.children[t.childElementCount-1].className.indexOf("e-addNoteIndicator")===-1)&&(this.createNoteIndicator({targetElement:t,rowIndex:e[0],columnIndex:e[1]}),this.createNoteContainer(t,e[0],e[1],!1,!0))},o.prototype.deleteNote=function(e){var t=Se(this.parent.getActiveSheet().activeCell),i=!g(e)&&!g(e.rowIndex)?e.rowIndex:t[0],r=!g(e)&&!g(e.columnIndex)?e.columnIndex:t[1],n=this.parent.getCell(i,r);if(n.children.length>0&&n.children[n.children.length-1].className.indexOf("e-addNoteIndicator")>-1){n.removeChild(n.children[n.children.length-1]),E.remove(n,"mouseover",this.mouseOver),E.remove(n,"mouseout",this.mouseOut);var s=Vn(this.parent,this.parent.activeSheetIndex)+"!"+this.parent.getActiveSheet().activeCell,a=G(i,r,this.parent.getActiveSheet());if(!g(e)&&e.isDeleteFromMenu&&this.parent.notify(hh,{args:{action:"beforeCellSave",eventArgs:{address:s}}}),!g(a)&&a.notes&&delete a.notes,!g(e)&&e.isDeleteFromMenu){var l={notes:a.notes,address:s};this.parent.notify(mt,{eventArgs:l,action:"deleteNote"}),this.isShowNote=null}}},o.prototype.editNote=function(){var e=g(this.noteCellIndexes)?Se(this.parent.getActiveSheet().activeCell):this.noteCellIndexes;this.showNote({rowIndex:e[0],columnIndex:e[1],isNoteEditable:!0});var t=document.getElementsByClassName("e-addNoteContainer")[0];sr(this.parent,this.parent.getActiveSheet(),{rowIdx:e[0],colIdx:e[1],preventEvt:!0,cell:{isNoteEditable:!0}}),t&&this.getNoteFocus(t)},o.prototype.createNoteIndicator=function(e){var t=this.parent.createElement("div",{className:"e-addNoteIndicator",styles:"position: absolute;top: 0;right: 0;width: 0;height: 0;border-left: 8px solid transparent;border-top: 8px solid red;cursor: pointer;"});if(e.targetElement.children.length>0)for(var i=li(this.parent.getActiveSheet(),e.rowIndex),r=20,n=0;n<e.targetElement.childElementCount;n++)e.targetElement.children[n].className.indexOf("e-filter-btn")>-1&&(t.style.right=(i<r+10?e.targetElement.children[n].getBoundingClientRect().width<=0?r:e.targetElement.children[n].getBoundingClientRect().width:2)+"px"),e.targetElement.children[n].className.indexOf("e-validation-list")>-1&&(t.style.right=(e.targetElement.children[n].getBoundingClientRect().width||20)+2+"px");(!g(e.targetElement)&&e.targetElement.children.length===0||e.targetElement.children.length>0&&e.targetElement.children[e.targetElement.childElementCount-1].className.indexOf("e-addNoteIndicator")===-1)&&(e.skipEvent||(E.add(e.targetElement,"mouseover",this.mouseOver,[this,e.rowIndex,e.columnIndex]),E.add(e.targetElement,"mouseout",this.mouseOut,this)),e.targetElement.appendChild(t))},o.prototype.mouseOver=function(){var e=this,t=e[0];(t.isNoteVisibleOnTouch&&!g(document.getElementsByClassName("e-addNoteContainer")[0])||g(document.getElementsByClassName("e-addNoteContainer")[0]))&&(g(document.getElementsByClassName("e-addNoteContainer")[0])||t.removeNoteContainer(),t.showNote({rowIndex:e[1],columnIndex:e[2],isNoteEditable:!1}),t.isNoteVisible=!0)},o.prototype.mouseOut=function(e){this.isNoteVisible&&!this.isNoteVisibleOnTouch&&!g(document.getElementsByClassName("e-addNoteContainer")[0])&&document.activeElement.className.indexOf("e-addNoteContainer")===-1&&!g(e.relatedTarget)&&e.relatedTarget.className.indexOf("e-connectorLine")===-1&&e.relatedTarget.className.indexOf("e-addNoteContainer")===-1&&(this.removeNoteContainer(),this.isNoteVisible=!1)},o.prototype.createNoteContainer=function(e,t,i,r,n){var s=this.parent.getActiveSheet(),a=G(t,i,s),l=e.getBoundingClientRect(),h=this.parent.createElement("textarea",{className:"e-addNoteContainer"});this.createContainer(h,a,l,r),this.createConnectorLine(h,l),n&&this.getNoteFocus(h),E.add(h,"mouseout",this.mouseOut,this),E.add(document.getElementsByClassName("e-connectorLine")[0],"mouseout",this.mouseOut,this)},o.prototype.getNoteFocus=function(e){e.selectionStart=e.value.length,e.focus()},o.prototype.createContainer=function(e,t,i,r){var n=5;!g(document.getElementsByClassName("e-select-all-cell")[0])&&!g(document.getElementsByClassName("e-scroller")[0])&&i.top>=document.getElementsByClassName("e-select-all-cell")[0].getBoundingClientRect().bottom&&i.right>=document.getElementsByClassName("e-select-all-cell")[0].getBoundingClientRect().right&&i.bottom<=document.getElementsByClassName("e-scroller")[0].getBoundingClientRect().top&&i.right<=document.getElementsByClassName("e-scroller")[0].getBoundingClientRect().width?(e.style.display="block",n=i.top===document.getElementsByClassName("e-select-all-cell")[0].getBoundingClientRect().bottom?0:n):e.style.display="none";var s=this.parent.element.getBoundingClientRect(),a=this.parent.element.style.getPropertyValue("position");e.style.position="absolute",e.style.top=i.top-(s.top-(a==="absolute"?0:this.parent.element.offsetTop))-n+"px",e.style.left=i.left+i.width-(s.left-(a==="absolute"?0:this.parent.element.offsetLeft))+10+"px",e.style.width="120px",e.style.height="120px",e.style.zIndex="5",e.style.color="black",e.style.backgroundColor="lightyellow",r&&!g(t)&&!g(t.notes)?e.innerHTML=t.notes:e.innerHTML="",this.parent.element.appendChild(e)},o.prototype.createConnectorLine=function(e,t){var i=this.parent.createElement("canvas",{className:"e-connectorLine",styles:"width: 100px; position: absolute;  z-index: 1;"}),r=i.getContext("2d"),n=this.parent.element.getBoundingClientRect(),s=this.parent.element.style.getPropertyValue("position");i.style.left=t.left+t.width-(n.left-(s==="absolute"?0:this.parent.element.offsetLeft))+"px",i.style.top=e.getBoundingClientRect().top-(n.top-(s==="absolute"?0:this.parent.element.offsetTop))-5+"px",r.clearRect(0,0,i.width,i.height),r.beginPath(),e.getBoundingClientRect().top===t.top?(r.moveTo(0,16),r.lineTo(30,15)):(r.moveTo(0,30),r.lineTo(30,15)),r.strokeStyle="black",r.lineWidth=5,r.stroke(),this.parent.element.appendChild(i),e.getBoundingClientRect().top>0?(i.style.display="block",i.style.zIndex="4"):i.style.display="none"},o.prototype.showNote=function(e){var t=g(this.parent.getCell(e.rowIndex,e.columnIndex))?e.cellElement:this.parent.getCell(e.rowIndex,e.columnIndex),i=document.getElementById(this.parent.element.id+"_contextmenu"),r=g(i)?"none":i.style.getPropertyValue("display"),n=e.isNoteEditable?!0:r!=="block";!g(t)&&g(document.getElementsByClassName("e-addNoteContainer")[0])&&n&&(e.isScrollWithNote||t.children!==null&&t.children.length>0&&t.children[t.children.length-1].classList.contains("e-addNoteIndicator"))&&(this.createNoteContainer(t,e.rowIndex,e.columnIndex,!0,e.isNoteEditable),this.noteCellIndexes=[e.rowIndex,e.columnIndex])},o.prototype.removeNoteContainer=function(){E.remove(document.getElementsByClassName("e-addNoteContainer")[0],"mouseout",this.mouseOut),E.remove(document.getElementsByClassName("e-connectorLine")[0],"mouseout",this.mouseOut),this.parent.element.removeChild(document.getElementsByClassName("e-addNoteContainer")[0]),this.parent.element.removeChild(document.getElementsByClassName("e-connectorLine")[0]),this.noteCellIndexes=null,this.isNoteVisible=!1,this.isNoteVisibleOnTouch=!1},o.prototype.updateNoteContainer=function(){this.parent.selectionModule.isNoteActiveElement=document.activeElement.className.indexOf("e-addNoteContainer")>-1?!0:this.parent.selectionModule.isNoteActiveElement;var e=g(this.noteCellIndexes)?Se(this.parent.getActiveSheet().activeCell):this.noteCellIndexes,t=G(e[0],e[1],this.parent.getActiveSheet()),i=document.getElementsByClassName("e-addNoteContainer")[0];if((g(t)||g(t.notes)||t.notes!==i.value)&&this.parent.selectionModule.isNoteActiveElement){var r=Vn(this.parent,this.parent.activeSheetIndex)+"!"+Be(e);this.parent.notify(hh,{args:{action:"beforeCellSave",eventArgs:{address:r}}});var n=!g(t)&&t.notes?"editNote":"addNote";sr(this.parent,this.parent.getActiveSheet(),{rowIdx:e[0],colIdx:e[1],preventEvt:!0,cell:{notes:i.value,isNoteEditable:!0}});var s={notes:i.value,address:r};this.parent.notify(mt,{eventArgs:s,action:n}),this.isShowNote=null}if(this.isShowNote=g(this.isShowNote)?this.parent.selectionModule.isNoteActiveElement:this.isShowNote,this.isShowNote){var a=!g(t)&&!g(t.isNoteEditable)?t.isNoteEditable:!1;this.parent.notify(iu,""),this.parent.notify(ed,{rowIndex:e[0],columnIndex:e[1],isNoteEditable:!0,isScrollWithNote:a})}else this.parent.notify(iu,""),this.isShowNote=null},o}(),qq=function(){function o(e){this.parent=e}return o.prototype.show=function(e,t){var i=this,r;t=!!g(t);var n=e.beforeOpen||null,s=e.close||null,a={header:"Spreadsheet",cssClass:this.parent.cssClass,target:this.parent.element,buttons:[],allowDragging:!0};e.beforeOpen=function(h){n&&(n(h),h.cancel&&(i.hide(!0),h.preventFocus||Fe(i.parent.element)))},e.close=function(){i.destroyDialog(),s&&s()},he(a,e),t&&(r=this.parent.serviceLocator.getService(fe).getConstant(a.buttons.length?"Cancel":"Ok"),a.buttons.push({buttonModel:{content:r,isPrimary:a.buttons.length===0},click:this.hide.bind(this)}));var l=this.parent.createElement("div");document.body.appendChild(l),this.dialogInstance=new Ah(a),this.dialogInstance.createElement=this.parent.createElement,this.dialogInstance.appendTo(l),this.dialogInstance&&this.dialogInstance.refreshPosition()},o.prototype.destroyDialog=function(){this.dialogInstance.destroy(),Ue(this.dialogInstance.element),this.dialogInstance=null},o.prototype.hide=function(e){this.dialogInstance&&(e&&(this.dialogInstance.animationSettings.effect="None",this.dialogInstance.dataBind()),this.dialogInstance.hide())},o.prototype.destroy=function(){this.parent=null},o}(),Gq=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.initializeActionBegin=function(){var e=this,t=this.parent.beforeCellFormat;this.parent.beforeCellFormat=function(s){e.actionEventHandler({evtArgs:s,evtFunc:t,actionType:"begin",eventType:"format"})};var i=this.parent.beforeOpen;this.parent.beforeOpen=function(s){e.actionEventHandler({evtArgs:s,evtFunc:i,actionType:"begin",eventType:"beforeOpen"})};var r=this.parent.beforeSave;this.parent.beforeSave=function(s){e.actionEventHandler({evtArgs:s,evtFunc:r,actionType:"begin",eventType:"beforeSave"})};var n=this.parent.beforeSort;this.parent.beforeSort=function(s){e.actionEventHandler({evtArgs:s,evtFunc:n,actionType:"begin",eventType:"beforeSort"})}},o.prototype.initializeActionComplete=function(){var e=this,t=this.parent.sortComplete;this.parent.sortComplete=function(r){e.actionEventHandler({evtArgs:r,evtFunc:t,actionType:"complete",eventType:"sorting"})};var i=this.parent.cellSave;this.parent.cellSave=function(r){e.actionEventHandler({evtArgs:r,evtFunc:i,actionType:"complete",eventType:"cellSave"})}},o.prototype.actionEventHandler=function(e){e.evtFunc&&e.evtFunc.apply(this,[e]),e.actionType==="begin"?this.actionBeginHandler({eventArgs:e.evtArgs,action:e.eventType}):this.actionCompleteHandler({eventArgs:e.evtArgs,action:e.eventType})},o.prototype.actionBeginHandler=function(e){var t=e.preventAction;delete e.preventAction;var i={action:e.action};e.isUndo&&(i.isUndo=!0,delete e.isUndo),e.isRedo&&(i.isUndo=!1,delete e.isRedo),i.args=e,this.parent.trigger("actionBegin",i),!t&&!this.parent.isPrintingProcessing&&(e.action==="clipboard"||e.action==="format"||e.action==="cellSave"||e.action==="addNote"||e.action==="editNote"||e.action==="deleteNote"||e.action==="beforeWrap"||e.action==="beforeReplace"||e.action==="filter"||e.action==="beforeClear"||e.action==="beforeInsertImage"||e.action==="beforeInsertChart"||e.action==="chartDesign"||e.action==="cellDelete"||e.action==="autofill"||e.action==="validation"||e.action==="removeValidation"||e.action==="hyperlink"||e.action==="removeHyperlink"||e.action==="deleteImage")&&this.parent.notify(hh,{args:e}),t&&(e.preventAction=!0),i.isUndo&&(e.isUndo=!0),i.isUndo===!1&&(e.isRedo=!0)},o.prototype.actionCompleteHandler=function(e){var t=e.preventAction;delete e.preventAction,this.parent.notify(yf,e),e.preventEventTrigger||this.parent.trigger("actionComplete",e),!t&&e.action!=="undoRedo"&&e.action!=="gotoSheet"&&this.parent.notify(Zy,{args:e}),this.parent.notify(Za,null)},o.prototype.addEventListener=function(){this.parent.on(mt,this.actionCompleteHandler,this),this.parent.on(ai,this.actionBeginHandler,this),this.parent.on(Un,this.removeEventListener,this)},o.prototype.removeEventListener=function(){this.parent.off(mt,this.actionCompleteHandler),this.parent.off(ai,this.actionBeginHandler),this.parent.off(Un,this.removeEventListener)},o}(),Yq=function(){function o(e){this.minHeight="300px",this.minWidth="400px",this.isOverlayClicked=!1,this.isResizerClicked=!1,this.currentWidth=400,this.currenHeight=300,this.parent=e,this.parent.on(Wf,this.isOverlaySelected,this),this.parent.on(td,this.refreshOverlayElem,this),this.parent.on(Un,this.destroy,this)}return o.prototype.insertOverlayElement=function(e,t,i){var r=this.parent.createElement("div",{id:e,attrs:{class:"e-ss-overlay"},styles:"width: "+this.minWidth+";  height: "+this.minHeight});if(this.parent.allowEditing){var n=this.parent.element.getElementsByClassName("e-ss-overlay-active")[0];n&&(K([n],"e-ss-overlay-active"),this.parent.notify(Ao,{})),r.classList.add("e-ss-overlay-active")}var s=J(t),a=this.parent.sheets[i],l=this.parent.frozenRowCount(a),h=this.parent.frozenColCount(a),u=Ib(a,s,l,h,this.parent.viewport.beforeFreezeHeight,this.parent.viewport.beforeFreezeWidth,this.parent.sheetModule.colGroupWidth,!0);if(s[0]>=l&&s[1]<h){var c=this.parent.sheetModule.contentPanel;c.scrollTop&&(u.top-=c.scrollTop,u.top+=this.parent.getColumnHeaderContent().parentElement.getBoundingClientRect().height)}if(s[1]>=h&&s[0]<l){var d=this.parent.getScrollElement();d.scrollLeft&&(u.left-=d.scrollLeft,u.left+=this.parent.sheetModule.getRowHeaderWidth(a))}var p;return s[0]<l||s[1]<h?(p=this.parent.element.querySelector("#"+this.parent.element.id+"_sheet"),l&&(s[0]>=l?u.top+=(a.showHeaders?31:0)+Ri(a,Se(a.topLeftCell)[0],l-1):h||(u.left+=this.parent.sheetModule.getRowHeaderWidth(a,!0))),h&&(s[1]>=h?u.left+=this.parent.sheetModule.getRowHeaderWidth(a):l||(u.left+=a.showHeaders?31:0))):p=this.parent.getMainContent(),r.style.top=Number(dh(u.top).toFixed(2))+"px",r.style.left=Number(dh(u.left).toFixed(2))+"px",i===this.parent.activeSheetIndex?(p.appendChild(r),this.renderResizeHandler(r),this.addEventListener(r)):this.parent.isPrintingProcessing&&(r.style.visibility="hidden",document.body.append(r)),this.originalWidth=parseFloat(getComputedStyle(r,null).getPropertyValue("width").replace("px","")),this.originalHeight=parseFloat(getComputedStyle(r,null).getPropertyValue("height").replace("px","")),{element:r,top:u.top,left:u.left}},o.prototype.adjustFreezePaneSize=function(e,t,i){var r=J(i),n=this.parent.getActiveSheet(),s=this.parent.frozenRowCount(n),a=this.parent.frozenColCount(n);if(r[0]<s||r[1]<a?(g(e.top)||(t.style.top=e.top+(n.showHeaders?31:0)-this.parent.viewport.beforeFreezeHeight+"px"),g(e.left)||(t.style.left=e.left+this.parent.sheetModule.getRowHeaderWidth(n,!0)-this.parent.viewport.beforeFreezeWidth+"px")):(g(e.top)||(t.style.top=e.top-this.parent.viewport.beforeFreezeHeight-(s?Ri(n,Se(n.topLeftCell)[0],s-1):0)+"px"),g(e.left)||(t.style.left=e.left-this.parent.viewport.beforeFreezeWidth-(a?Ci(n,Se(n.topLeftCell)[1],a-1):0)+"px")),g(e.top)){var l=Se(n.topLeftCell)[0];e.top=this.parent.viewport.beforeFreezeHeight+(s&&l===r[0]?0:Ri(n,s?l:0,r[0]-1))}if(g(e.left)){var h=Se(n.topLeftCell)[1];e.left=this.parent.viewport.beforeFreezeWidth+(a&&h===r[1]?0:Ci(n,a?h:0,r[1]-1))}},o.prototype.addEventListener=function(e){var t=e;E.add(t,Cd(),this.overlayClickHandler,this),E.add(t,ih(),this.overlayMouseMoveHandler,this),E.add(this.parent.element.querySelector("#"+this.parent.element.id+"_sheet"),ih(),this.overlayMouseMoveHandler,this),E.add(document,Xc(),this.overlayMouseUpHandler,this),this.parent.on(FI,this.setOriginalSize,this)},o.prototype.setOriginalSize=function(e){this.originalHeight=e.height,this.originalWidth=e.width},o.prototype.overlayMouseMoveHandler=function(e){var t=e.target,i=document.getElementsByClassName("e-ss-overlay-active")[0],r=this.parent.getActiveSheet(),n=r.frozenRows||r.frozenColumns?[29,this.parent.sheetModule.getRowHeaderWidth(r,!0)]:[-1,-1],s,a,l,h,u,c;if(this.isOverlayClicked&&this.isResizerClicked)switch(Sb(e)&&e.preventDefault(),this.resizer){case"e-ss-overlay-t":s=Math.max(this.originalMouseY-Io(e)+this.originalHeight,20),a=Io(e)-(this.originalMouseY-this.originalResizeTop),s>20&&a>n[0]&&(i.style.height=s+"px",i.style.top=a+"px",this.resizedReorderTop=a,this.currenHeight=s,this.parent.notify(th,{height:i.style.height,width:i.style.width,overlayEle:i}));break;case"e-ss-overlay-r":l=this.originalWidth+(fq(e)-this.originalMouseX),l>20&&(i.style.width=l+"px",this.currentWidth=l,this.parent.notify(th,{height:i.style.height,width:i.style.width,overlayEle:i}));break;case"e-ss-overlay-b":h=this.originalHeight+(gq(e)-this.originalMouseY),h>20&&(i.style.height=h+"px",this.currenHeight=h,this.parent.notify(th,{height:i.style.height,width:i.style.width,overlayEle:i}));break;case"e-ss-overlay-l":u=Math.max(this.originalMouseX-xo(e)+this.originalWidth,20),c=xo(e)-(this.originalMouseX-this.originalResizeLeft),u>20&&c>n[1]&&(i.style.width=u+"px",i.style.left=c+"px",this.resizedReorderLeft=c,this.currentWidth=u,this.parent.notify(th,{height:i.style.height,width:i.style.width,overlayEle:i}));break}else if(this.isOverlayClicked)if(Sb(e)&&e.preventDefault(),j(t,".e-sheet")&&!t.classList.contains("e-sheet-content")||t.classList.contains("e-cell")){if(!i)return;var d=xo(e)-this.diffX,p=Io(e)-this.diffY;d>n[1]&&(i.style.left=d+"px"),p>n[0]&&(i.style.top=p+"px"),this.resizedReorderLeft=d<0?0:d,this.resizedReorderTop=p<0?0:p}else this.overlayMouseUpHandler(e,!0)},o.prototype.overlayMouseUpHandler=function(e,t){if(!(!this.parent||this.parent.getActiveSheet().isProtected||!this.parent.allowEditing)){this.isResizerClicked=!1;var i=e.target,r=document.getElementsByClassName("e-datavisualization-chart e-ss-overlay-active");i.classList.contains("e-ss-overlay")||(i=j(e.target,".e-datavisualization-chart")?j(e.target,".e-datavisualization-chart"):i);var n=this.parent.getActiveSheet(),s={prevTop:n.frozenRows||n.frozenColumns?this.prevY:this.originalReorderTop,prevLeft:n.frozenRows||n.frozenColumns?this.prevX:this.originalReorderLeft,currentTop:this.resizedReorderTop>=0?parseInt(this.resizedReorderTop.toString(),10):this.originalReorderTop,currentLeft:this.resizedReorderLeft>=0?parseInt(this.resizedReorderLeft.toString(),10):this.originalReorderLeft,id:i.id,currentHeight:this.currenHeight,currentWidth:this.currentWidth,requestType:"imageRefresh",prevHeight:this.originalHeight,prevWidth:this.originalWidth};if(this.isOverlayClicked||t){var a=void 0,l=void 0,h={clientY:s.prevTop,isImage:!0},u={clientX:s.prevLeft,isImage:!0},c=this.parent.element.getElementsByClassName("e-ss-overlay-active")[0];if(n.frozenRows||n.frozenColumns){if(!c)return;h.isImage=!1,u.isImage=!1,h.target=c,u.target=c,s.prevTop<this.parent.getColumnHeaderContent().getBoundingClientRect().bottom&&(h.target=this.parent.getColumnHeaderContent()),s.prevLeft<this.parent.getRowHeaderContent().getBoundingClientRect().right&&(u.target=this.parent.getRowHeaderTable());var d=c.getBoundingClientRect();a={clientY:d.top},l={clientX:d.left},d.top<this.parent.getColumnHeaderContent().getBoundingClientRect().bottom&&(a.target=this.parent.getColumnHeaderContent()),d.left<this.parent.getRowHeaderContent().getBoundingClientRect().right&&(l.target=this.parent.getRowHeaderTable())}else a={clientY:s.currentTop,isImage:!0},l={clientX:s.currentLeft,isImage:!0};if(this.parent.notify(Ys,h),this.parent.notify(Ys,a),this.parent.notify(Qs,u),this.parent.notify(Qs,l),a.size&&(s.currentTop=a.size),l.size&&(s.currentLeft=l.size),s.prevRowIdx=h.clientY,s.prevColIdx=u.clientX,s.currentRowIdx=a.clientY,s.currentColIdx=l.clientX,(n.frozenColumns||n.frozenRows)&&!j(c,".e-sheet-content")){var p=this.parent.frozenColCount(n),f=this.parent.frozenRowCount(n);if(s.currentRowIdx>=f&&s.currentColIdx>=p){var v=parseInt(c.style.top,10),m=parseInt(c.style.left,10),y=this.parent.sheetModule.contentPanel;v+=y.scrollTop,v-=this.parent.getColumnHeaderContent().parentElement.getBoundingClientRect().height;var S=this.parent.getScrollElement();m+=S.scrollLeft,m-=this.parent.sheetModule.getRowHeaderWidth(n),c.style.top=v+"px",c.style.left=m+"px",this.parent.getMainContent().appendChild(c)}}r&&r[0]&&r[0].querySelector(".e-control")&&(s.id=r[0].id),this.originalReorderTop!==this.resizedReorderTop||this.originalReorderLeft!==this.resizedReorderLeft?(s.id=c.id,r&&r[0]?(s.requestType="chartRefresh",this.parent.notify(ou,s)):this.parent.notify(Sd,s),this.resizedReorderTop=this.originalReorderTop,this.resizedReorderLeft=this.originalReorderLeft):(this.currenHeight!==this.originalHeight||this.originalWidth!==this.currentWidth)&&(s.id=i.id.indexOf("overlay")>0?i.id:i.parentElement&&i.parentElement.classList.contains("e-ss-overlay")?i.parentElement.id:c.id,r&&r[0]?(s.requestType="chartRefresh",this.parent.notify(ou,s)):this.parent.notify(Sd,s),this.originalHeight=this.currenHeight,this.originalWidth=this.currentWidth)}this.isOverlayClicked=!1}},o.prototype.isOverlaySelected=function(e){e.isOverlayClicked=this.isOverlayClicked},o.prototype.refreshOverlayElem=function(e){if(e){var t=".e-ss-overlay-active"+(e&&e.selector||""),i=this.parent.element.querySelector(t);i&&(K([i],"e-ss-overlay-active"),this.parent.notify(Ao,{}))}else for(var t="e-ss-overlay-active",r=Array.from(this.parent.element.getElementsByClassName(t)),n=0;n<r.length;n++){var s=r[n];s&&(K([s],"e-ss-overlay-active"),this.parent.notify(Ao,{}))}this.parent.notify(cb,null)},o.prototype.overlayClickHandler=function(e){if(!(this.parent.getActiveSheet().isProtected||!this.parent.allowEditing)){this.isOverlayClicked=!0;var t=e.target,i=e.target;t.classList.contains("e-ss-overlay")||(i=t.parentElement,j(e.target,".e-datavisualization-chart")&&(i=j(e.target,".e-datavisualization-chart")));var r=this.parent.getActiveSheet();if((r.frozenColumns||r.frozenRows)&&j(i,".e-sheet-content")){var n=parseInt(i.style.top,10),s=parseInt(i.style.left,10),a=this.parent.sheetModule.contentPanel;n-=a.scrollTop,n+=this.parent.getColumnHeaderContent().parentElement.getBoundingClientRect().height;var l=this.parent.getScrollElement();s-=l.scrollLeft,s+=this.parent.sheetModule.getRowHeaderWidth(r),i.style.top=n+"px",i.style.left=s+"px",this.parent.element.querySelector("#"+this.parent.element.id+"_sheet").appendChild(i)}this.originalWidth=this.currentWidth=parseFloat(i.style.width),this.originalHeight=this.currenHeight=parseFloat(i.style.height),this.originalReorderLeft=parseFloat(i.style.left),this.originalReorderTop=parseFloat(i.style.top),this.resizedReorderLeft=parseFloat(i.style.left),this.resizedReorderTop=parseFloat(i.style.top),this.originalResizeTop=this.originalReorderTop,this.originalResizeLeft=this.originalReorderLeft,this.originalMouseX=xo(e),this.originalMouseY=Io(e),this.diffX=this.originalMouseX-this.originalReorderLeft,this.diffY=this.originalMouseY-this.originalReorderTop;var h=document.getElementsByClassName("e-ss-overlay-active")[0];h&&K([h],"e-ss-overlay-active"),this.parent.element.querySelector("#"+i.id).classList.add("e-ss-overlay-active"),t.classList.contains("e-ss-resizer")&&(this.resizer=t.classList[0],this.isResizerClicked=!0),i.classList.contains("e-datavisualization-chart")&&(this.parent.notify(Ty,{id:i.id}),h||this.parent.notify(Uf,{id:i.id}));var u=i.getBoundingClientRect();this.prevX=u.left,this.prevY=u.top}},o.prototype.renderResizeHandler=function(e){for(var t=["e-ss-overlay-t","e-ss-overlay-r","e-ss-overlay-b","e-ss-overlay-l"],i=0,r;i<t.length;)r=this.parent.createElement("div",{className:t[i]+" e-ss-resizer"+(B.isDevice?" e-ss-resizer-touch":""),styles:"width: 8px; height: 8px; border-radius: 4px;"}),e.appendChild(r),i++},o.prototype.removeEventListener=function(){var e=this.parent.element.querySelectorAll(".e-ss-overlay");if(e.length)for(var t=0;t<e.length;t++)E.remove(e[t],Cd(),this.overlayClickHandler),E.remove(e[t],ih(),this.overlayMouseMoveHandler);var i=this.parent.element.querySelector("#"+this.parent.element.id+"_sheet");i&&E.remove(i,ih(),this.overlayMouseMoveHandler),document&&E.remove(document,Xc(),this.overlayMouseUpHandler),this.parent.isDestroyed||(this.parent.off(FI,this.setOriginalSize),this.parent.off(Wf,this.isOverlaySelected),this.parent.off(td,this.refreshOverlayElem),this.parent.off(Un,this.destroy))},o.prototype.destroy=function(){this.removeEventListener(),this.currentWidth&&(this.currentWidth=null),this.currenHeight&&(this.currenHeight=null),this.minHeight&&(this.minHeight=null),this.minWidth&&(this.minWidth=null),this.isOverlayClicked&&(this.isOverlayClicked=null),this.isResizerClicked&&(this.isResizerClicked=null),this.parent=null},o}(),rM=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),QI=function(){return QI=Object.assign||function(o){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r])}return o},QI.apply(this,arguments)},Br=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},Qq=function(o){rM(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Br([C("")],e.prototype,"text",void 0),Br([C("")],e.prototype,"iconCss",void 0),Br([C("left")],e.prototype,"iconPosition",void 0),e}(Re),eO=function(o){rM(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}return Br([be({},Qq)],e.prototype,"header",void 0),Br([Wt([],$v)],e.prototype,"content",void 0),Br([C("")],e.prototype,"cssClass",void 0),Br([C(!1)],e.prototype,"disabled",void 0),e}(Re),Xq=function(o){rM(e,o);function e(t,i){return o.call(this,t)||this}return e.prototype.preRender=function(){},e.prototype.render=function(){this.element.id||(this.element.id=kt("ribbon")),this.renderRibbon()},e.prototype.destroy=function(){var t=this.element.querySelector(".e-drop-icon");if(t&&t.removeEventListener("click",this.ribbonExpandCollapse.bind(this)),this.menuItems.length){var i=document.getElementById(this.element.id+"_menu");i&&at(i,"menu").destroy()}this.toolbarObj&&this.toolbarObj.destroy(),this.tabObj&&this.tabObj.destroy(),this.element.innerHTML="",this.toolbarObj=null,this.tabObj=null,o.prototype.destroy.call(this)},e.prototype.getTabItems=function(){var t=this,i=[];return this.menuItems.length&&i.push({header:{text:this.initMenu(this.menuItems)},content:this.toolbarObj.element,cssClass:"e-menu-tab"}),this.items.forEach(function(r){i.push({header:r.header,content:t.toolbarObj.element})}),i},e.prototype.initMenu=function(t){var i=this,r=this.createElement("ul",{id:this.element.id+"_menu"});this.element.appendChild(r);var n=new Ph({cssClass:"e-file-menu",items:t,showItemOnClick:!0,beforeOpen:function(s){s.parentItem.text===t[0].text&&(n.showItemOnClick=!1),i.trigger("beforeOpen",s)},select:function(s){i.trigger("fileMenuItemSelect",s)},beforeClose:function(s){if(s.event.type==="mouseover"&&!j(s.event.target,".e-menu-popup")){s.cancel=!0;return}i.trigger("beforeClose",s),(!s.parentItem||s.parentItem.text===t[0].text)&&n.setProperties({showItemOnClick:!0},!0)},beforeItemRender:function(s){i.trigger("beforeFileMenuItemRender",s)},created:function(){n.element.removeAttribute("tabindex");var s=n.element.querySelector(".e-menu-item");s&&s.removeAttribute("tabindex")}});return n.createElement=this.createElement,n.appendTo(r),r.parentElement},e.prototype.renderRibbon=function(){var t=this,i=this.createElement("div"),r=this.createElement("div"),n;this.toolbarObj=new Hl({items:this.items[this.selectedTab].content,clicked:function(a){return t.trigger("clicked",a)}}),this.toolbarObj.createElement=this.createElement,this.toolbarObj.appendTo(r),this.tabObj=new Zv({selectedItem:this.getIndex(this.selectedTab),animation:{next:{duration:0},previous:{duration:0}},items:this.getTabItems(),selecting:function(a){if(a.isSwiped){a.cancel=!0;return}if(n=a.event&&a.event.isShortcut,t.menuItems.length&&a.selectingIndex===0){if(a.cancel=!0,(!a.event||n||a.event.type==="keydown")&&a.selectingItem){var l=a.selectingItem.querySelector(".e-file-menu .e-menu-item");l&&l.click()}}else{if(a.selectingIndex===t.getIndex(t.selectedTab))return;t.updateToolbar(t.getIndex(a.selectingIndex,!0)),t.toolbarObj.dataBind(),t.refreshTemplateItems(t.toolbarObj),t.element.classList.contains("e-collapsed")&&E.remove(a.selectedItem,"click",t.ribbonExpandCollapse);var h=void 0;t.menuItems.length?(h=QI({},a),h.selectingIndex-=1,h.selectedIndex-=1):h=a,t.trigger("selecting",h)}},selected:function(a){!a.isInteracted&&!n&&(a.preventFocus=!0),a.selectedIndex!==t.getIndex(t.selectedTab)&&(t.setProperties({selectedTab:t.getIndex(a.selectedIndex,!0)},!0),t.element.classList.contains("e-collapsed")&&(t.element.classList.remove("e-collapsed"),t.trigger("expandCollapse",{element:t.toolbarObj.element,expanded:!0})))},created:function(){t.toolbarObj.refreshOverflow()}}),this.element.appendChild(i),this.tabObj.createElement=this.createElement,this.tabObj.appendTo(i);var s=this.createElement("span",{className:"e-drop-icon e-icons"});s.addEventListener("click",this.ribbonExpandCollapse.bind(this)),this.element.appendChild(s)},e.prototype.ribbonExpandCollapse=function(t){var i={element:this.toolbarObj.element,expanded:!0},r;this.element.classList.contains("e-collapsed")?(r=this.tabObj.element.querySelector(".e-tab-header").getElementsByClassName("e-toolbar-item")[this.tabObj.selectedItem],this.element.classList.remove("e-collapsed"),r.classList.add("e-active"),E.remove(r,"click",this.ribbonExpandCollapse),this.trigger("expandCollapse",i)):(r=this.tabObj.element.querySelector(".e-tab-header .e-toolbar-item.e-active"),this.element.classList.add("e-collapsed"),i.expanded=!1,r.classList.remove("e-active"),E.add(r,"click",this.ribbonExpandCollapse,this),this.trigger("expandCollapse",i))},e.prototype.getIndex=function(t,i){return this.menuItems.length?i?t-1:t+1:t},e.prototype.updateToolbar=function(t){this.toolbarObj.items=this.items[t].content,this.toolbarObj.dataBind()},e.prototype.refreshTemplateItems=function(t){this.spreadInstance&&this.spreadInstance.isReact&&this.spreadInstance.portals&&t&&t.portals&&(this.spreadInstance.portals=this.spreadInstance.portals.concat(t.portals),this.spreadInstance.renderReactTemplates())},e.prototype.enableMenuItems=function(t,i,r){i===void 0&&(i=!0),this.menuItems.length&&at(document.getElementById(this.element.id+"_menu"),"menu").enableItems(t,i,r)},e.prototype.hideMenuItems=function(t,i,r){if(i===void 0&&(i=!0),!!this.menuItems.length){var n=at(document.getElementById(this.element.id+"_menu"),"menu");i?n.hideItems(t,r):n.showItems(t,r)}},e.prototype.addMenuItems=function(t,i,r,n){if(r===void 0&&(r=!0),!!this.menuItems.length){var s=at(document.getElementById(this.element.id+"_menu"),"menu");r?s.insertAfter(t.reverse(),i,n):s.insertBefore(t,i,n)}},e.prototype.hideTabs=function(t,i){var r=this;i===void 0&&(i=!0);var n,s,a,l;if(i||(l=this.isAllHidden()),t.forEach(function(u){n=r.getTabIndex(u,-1),n>-1&&(i?r.items[n].cssClass.includes(" e-hide")||(r.items[n].cssClass=r.items[n].cssClass+" e-hide",r.tabObj.items[r.getIndex(n)].cssClass=r.items[n].cssClass,s===void 0&&n===r.selectedTab&&(s=!0),a=!0):r.items[n].cssClass.includes(" e-hide")&&(r.items[n].cssClass=r.items[n].cssClass.replace(" e-hide",""),r.tabObj.items[r.getIndex(n)].cssClass=r.items[n].cssClass,s===void 0&&n===r.selectedTab&&(s=!0),a=!0))}),this.setProperties({items:this.items},!0),this.tabObj.items=this.tabObj.items,this.tabObj.dataBind(),i&&(l=this.isAllHidden(),l&&(s=!1)),!i&&l&&(s=!s),a&&l&&(this.element.classList.contains("e-collapsed")?(this.element.classList.remove("e-collapsed"),this.element.querySelector(".e-drop-icon").classList.remove("e-hide")):(this.element.classList.add("e-collapsed"),this.element.querySelector(".e-drop-icon").classList.add("e-hide"))),s){for(var h=0;h<this.items.length;h++)if(!this.items[h].cssClass.includes(" e-hide")){this.tabObj.selectedItem=this.getIndex(h),this.tabObj.dataBind();break}}},e.prototype.isAllHidden=function(){for(var t=!0,i=0;i<this.items.length;i++)if(!this.items[i].cssClass.includes(" e-hide")){t=!1;break}return t},e.prototype.enableTabs=function(t,i){var r=this;i===void 0&&(i=!0),t.forEach(function(n){var s=r.getTabIndex(n,-1);s>-1&&(r.items[s].disabled=!i,s=r.getIndex(s),r.tabObj.enableTab(s,i))}),this.setProperties({items:this.items},!0)},e.prototype.addTabs=function(t,i){var r=this,n=this.getTabIndex(i);t.forEach(function(s){s=new eO(r.items[0],"items",s,!0),r.items.splice(n,0,s),r.tabObj.addTab([{header:s.header,content:r.toolbarObj.element}],r.getIndex(n)),n++}),this.setProperties({items:this.items},!0),this.setProperties({selectedTab:this.getIndex(this.tabObj.selectedItem,!0)},!0)},e.prototype.getTabIndex=function(t,i){if(i===void 0&&(i=this.items.length),t){for(var r=0;r<this.items.length;r++)if(this.items[r].header.text===t){i=r;break}}return i},e.prototype.addToolbarItems=function(t,i,r){var n=this,s=this.getTabIndex(t);g(r)&&(r=this.items[s].content.length),i.forEach(function(a){a=new $v(n.items[s].content[0],"content",a,!0),n.items[s].content.splice(r,0,a),r++}),this.setProperties({items:this.items},!0),s===this.selectedTab&&i.length&&this.updateToolbar(s)},e.prototype.enableItems=function(t,i,r){if(r===void 0&&(r=!0),i){var n=this.getTabIndex(t,-1);if(n<0)return;for(var s=0;s<i.length;s++){if(typeof i[s]=="string"){for(var a=0;a<this.items[n].content.length;a++)if(this.items[n].content[a].id===i[s]){i[s]=a;break}}if(typeof i[s]=="string"){if(i.length-1>s)continue;return}this.items[n].content[i[s]].disabled=!r,this.setProperties({items:this.items},!0),n===this.selectedTab&&this.toolbarObj.enableItems(i[s],r)}}else this.toolbarObj.disable(!r)},e.prototype.hideToolbarItems=function(t,i,r){var n=this;r===void 0&&(r=!0);for(var s,a,l=0;l<this.items.length;l++)if(this.items[l].header.text===t){s=l,i.forEach(function(h){a=n.items[s].content[h],a&&(r?a.cssClass.includes(" e-hide")||(a.cssClass=a.cssClass+" e-hide"):a.cssClass.includes(" e-hide")&&(a.cssClass=a.cssClass.replace(" e-hide","")))});break}this.setProperties({items:this.items},!0),s!==void 0&&s===this.selectedTab&&this.updateToolbar(s)},e.prototype.getModuleName=function(){return"ribbon"},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.onPropertyChanged=function(t,i){for(var r=0,n=Object.keys(t);r<n.length;r++){var s=n[r];switch(s){case"selectedTab":this.tabObj.selectedItem=this.getIndex(t.selectedTab),this.tabObj.dataBind();break}}},Br([C("")],e.prototype,"cssClass",void 0),Br([C(!0)],e.prototype,"menuType",void 0),Br([Wt([],Mc)],e.prototype,"menuItems",void 0),Br([C(0)],e.prototype,"selectedTab",void 0),Br([Wt([],eO)],e.prototype,"items",void 0),Br([C(null)],e.prototype,"spreadInstance",void 0),Br([q()],e.prototype,"selecting",void 0),Br([q()],e.prototype,"fileMenuItemSelect",void 0),Br([q()],e.prototype,"beforeFileMenuItemRender",void 0),Br([q()],e.prototype,"beforeOpen",void 0),Br([q()],e.prototype,"beforeClose",void 0),Br([q()],e.prototype,"selectFormat",void 0),Br([q()],e.prototype,"clicked",void 0),Br([q()],e.prototype,"created",void 0),Br([q()],e.prototype,"expandCollapse",void 0),e=Br([bt],e),e}(Kt),$q=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.render=function(){var e=this,t=this.parent.element.id,i=this.parent.createElement("input",{attrs:{type:"color"}}),r=function(n){n.element.tabIndex=-1};this.fontColorPicker=new Cv({value:"#000000ff",mode:"Palette",showButtons:!1,presetColors:uq,enableOpacity:!1,cssClass:"e-spreadsheet-color-popup",beforeTileRender:r,beforeClose:function(){return e.beforeCloseHandler(e.fontColorPicker)},open:this.openHandler.bind(this),beforeModeSwitch:function(n){return e.beforeModeSwitch(e.fontColorPicker,n)},change:function(n){var s=e.fontColorPicker.getValue(n.currentValue.rgba),a={style:{color:s},onActionUpdate:!0};e.parent.notify(rr,a),a.cancel?e.fontColorPicker.setProperties({value:e.fontColorPicker.getValue(n.previousValue.rgba,"HEXA")},!0):e.updateSelectedColor(a.style.color,e.fontColorPicker.element,"TextColor")},created:function(){return e.updateSelectedColor("#000000",e.fontColorPicker.element,"TextColor",!0)}}),this.fontColorPicker.createElement=this.parent.createElement,this.parent.element.appendChild(i),this.fontColorPicker.appendTo(i),i.parentElement.id=t+"_font_color_picker",Y([i.nextElementSibling.getElementsByClassName("e-selected-color")[0]],["e-icons","e-font-color"]),i=this.parent.createElement("input",{attrs:{type:"color"}}),this.filColorPicker=new Cv({value:"#ffff00ff",mode:"Palette",presetColors:cq,showButtons:!1,enableOpacity:!1,cssClass:"e-spreadsheet-color-popup",open:this.openHandler.bind(this),beforeTileRender:r,beforeClose:function(){return e.beforeCloseHandler(e.filColorPicker)},beforeModeSwitch:function(n){return e.beforeModeSwitch(e.filColorPicker,n)},change:function(n){var s=e.filColorPicker.getValue(n.currentValue.rgba),a={style:{backgroundColor:s},onActionUpdate:!0};e.parent.notify(rr,a),a.cancel?e.filColorPicker.setProperties({value:e.filColorPicker.getValue(n.previousValue.rgba,"HEXA")},!0):e.updateSelectedColor(a.style.backgroundColor,e.filColorPicker.element,"FillColor")},created:function(){return e.updateSelectedColor("#ffff00",e.filColorPicker.element,"FillColor",!0)}}),this.filColorPicker.createElement=this.parent.createElement,this.parent.element.appendChild(i),this.filColorPicker.appendTo(i),i.parentElement.id=t+"_fill_color_picker",Y([i.nextElementSibling.getElementsByClassName("e-selected-color")[0]],["e-icons","e-fill-color"])},o.prototype.updateSelectedColor=function(e,t,i,r){var n=this.parent.serviceLocator.getService(fe).getConstant(i);r&&t.parentElement.querySelector(".e-dropdown-btn").setAttribute("aria-label",n);var s=t.parentElement.querySelector(".e-split-colorpicker");s.setAttribute("aria-label",n+" "+e),s.firstElementChild.style.borderBottomColor=e},o.prototype.openHandler=function(e){e.element.querySelector(".e-mode-switch-btn").title=this.parent.serviceLocator.getService(fe).getConstant("MoreColors")},o.prototype.beforeCloseHandler=function(e){e.modeSwitcher||e.setProperties({modeSwitcher:!0},!0),e.showButtons&&e.setProperties({showButtons:!1},!0),Fe(e.element.parentElement.querySelector(".e-split-colorpicker"))},o.prototype.beforeModeSwitch=function(e,t){var i=this.parent.serviceLocator.getService(fe);t.mode==="Picker"?(e.showButtons=!0,e.dataBind(),t.element.querySelector(".e-apply").title=i.getConstant("Apply"),t.element.querySelector(".e-cancel").title=i.getConstant("Cancel"),t.element.querySelector(".e-mode-switch-btn").title=i.getConstant("StandardColors")):(e.showButtons=!1,e.dataBind(),t.element.querySelector(".e-mode-switch-btn").title=i.getConstant("MoreColors"))},o.prototype.destroy=function(){this.parent&&(this.removeEventListener(),this.fontColorPicker&&this.fontColorPicker.destroy(),this.fontColorPicker=null,this.filColorPicker&&this.filColorPicker.destroy(),this.filColorPicker=null,this.parent=null)},o.prototype.addEventListener=function(){this.parent.on(nI,this.render,this),this.parent.on("destroyRibbonComponents",this.destroy,this),this.parent.on(Un,this.destroy,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(nI,this.render),this.parent.off("destroyRibbonComponents",this.destroy),this.parent.off(Un,this.destroy))},o}(),_O=function(){function o(e){this.border="1px solid #000000",this.fontNameIndex=5,this.numPopupWidth=0,this.preTabIdx=1,this.spanElements=[],this.iconSetGroupElement=[],this.iconSetElements=[],this.iconWrapElements=[],this.parent=e,this.addEventListener(),new $q(e)}return o.prototype.getModuleName=function(){return"ribbon"},o.prototype.ribbonOperation=function(e){e&&e.onPropertyChange?this.onPropertyChanged(e.prop):this.initialize()},o.prototype.initialize=function(e){if(this.parent.notify(nI,{}),this.parent.isMobileView())this.createMobileView();else{var t=e&&(this.parent.element.querySelector(".e-formula-bar-panel")||document.getElementById(this.parent.element.id+"_sheet_panel"));this.createRibbon(t)}},o.prototype.getRibbonMenuItems=function(){var e=this.parent.serviceLocator.getService(fe),t=this.parent.element.id,i=[{text:this.parent.isMobileView()?"":e.getConstant("File"),iconCss:this.parent.isMobileView()?"e-icons e-file-menu-icon":null,id:t+"_File",items:[{text:e.getConstant("New"),id:t+"_New",iconCss:"e-new e-icons"},{text:e.getConstant("Open"),id:t+"_Open",iconCss:"e-open e-icons"},{text:e.getConstant("SaveAs"),iconCss:"e-save e-icons",id:t+"_Save_As",items:[{text:e.getConstant("ExcelXlsx"),id:t+"_Xlsx",iconCss:"e-xlsx e-icons"},{text:e.getConstant("ExcelXls"),id:t+"_Xls",iconCss:"e-xls e-icons"},{text:e.getConstant("CSV"),id:t+"_Csv",iconCss:"e-csv e-icons"},{text:e.getConstant("PDF"),id:t+"_Pdf",iconCss:"e-pdf e-icons"}]},{text:e.getConstant("Print"),id:t+"_Print",iconCss:"e-print e-icons"}]}];return i},o.prototype.getRibbonItems=function(){var e=this,t=this.parent.element.id,i=this.parent.serviceLocator.getService(fe),r=[{header:{text:i.getConstant("Home")},content:[{prefixIcon:"e-undo-icon",tooltipText:i.getConstant("Undo")+" (Ctrl+Z)",htmlAttributes:{"aria-label":i.getConstant("Undo")},id:t+"_undo",disabled:!0},{prefixIcon:"e-redo-icon",tooltipText:i.getConstant("Redo")+" (Ctrl+Y)",htmlAttributes:{"aria-label":i.getConstant("Redo")},id:t+"_redo",disabled:!0},{type:"Separator",id:t+"_separator_1"},{prefixIcon:"e-cut-icon",tooltipText:i.getConstant("Cut")+" (Ctrl+X)",htmlAttributes:{"aria-label":i.getConstant("Cut")},id:t+"_cut"},{prefixIcon:"e-copy-icon",tooltipText:i.getConstant("Copy")+" (Ctrl+C)",htmlAttributes:{"aria-label":i.getConstant("Copy")},id:t+"_copy"},{tooltipText:i.getConstant("Paste")+" (Ctrl+V)",template:this.getPasteBtn(t,i),id:t+"_paste",disabled:!0},{type:"Separator",id:t+"_separator_2"},{template:this.getNumFormatDDB(t,i),tooltipText:i.getConstant("NumberFormat"),id:t+"_number_format"},{type:"Separator",id:t+"_separator_3"},{template:this.getFontNameDDB(t),tooltipText:i.getConstant("Font"),id:t+"_font_name"},{type:"Separator",id:t+"_separator_4"},{template:this.getFontSizeDDB(t),tooltipText:i.getConstant("FontSize"),id:t+"_font_size"},{type:"Separator",id:t+"_separator_5"},{template:this.getBtn(t,"bold",i.getConstant("Bold")),tooltipText:i.getConstant("Bold")+" (Ctrl+B)",id:t+"_bold"},{template:this.getBtn(t,"italic",i.getConstant("Italic")),tooltipText:i.getConstant("Italic")+" (Ctrl+I)",id:t+"_italic"},{template:this.getBtn(t,"line-through",i.getConstant("Strikethrough")),tooltipText:i.getConstant("Strikethrough")+" (Ctrl+5)",id:t+"_line-through"},{template:this.getBtn(t,"underline",i.getConstant("Underline")),tooltipText:i.getConstant("Underline")+" (Ctrl+U)",id:t+"_underline"},{template:document.getElementById(t+"_font_color_picker"),tooltipText:i.getConstant("TextColor"),id:t+"_font_color_picker"},{type:"Separator",id:t+"_separator_6"},{template:document.getElementById(t+"_fill_color_picker"),tooltipText:i.getConstant("FillColor"),id:t+"_fill_color_picker"},{template:this.getBordersDBB(t),tooltipText:i.getConstant("Borders"),id:t+"_borders"},{template:this.getMergeSplitBtn(t),tooltipText:i.getConstant("MergeCells"),id:t+"_merge_cells",disabled:!0},{type:"Separator",id:t+"_separator_7"},{template:this.getTextAlignDDB(t),tooltipText:i.getConstant("HorizontalAlignment"),id:t+"_text_align"},{template:this.getVerticalAlignDDB(t),tooltipText:i.getConstant("VerticalAlignment"),id:t+"_vertical_align"},{template:this.getBtn(t,"wrap",i.getConstant("WrapText"),!1),tooltipText:""+i.getConstant("WrapText"),id:t+"_wrap"}]},{header:{text:i.getConstant("Insert")},content:[{prefixIcon:"e-hyperlink-icon",text:i.getConstant("Link"),id:t+"_hyperlink",tooltipText:i.getConstant("Link"),click:function(){e.getHyperlinkDlg()}},{prefixIcon:"e-image-icon",text:i.getConstant("Image"),id:t+"_image",tooltipText:i.getConstant("Image"),click:function(){X("#"+t+"_imageUpload",e.parent.element).click()}}]},{header:{text:i.getConstant("Formulas")},content:[{prefixIcon:"e-insert-function",tooltipText:i.getConstant("InsertFunction"),text:i.getConstant("InsertFunction"),id:t+"_insert_function"},{type:"Separator",id:t+"_separator_14"},{template:this.createCalcOptions(t,i),tooltipText:i.getConstant("CalcOptionsTip"),id:t+"_calc_types"},{type:"Separator",id:t+"_separator_15"},{prefixIcon:"e-calculate-sheet",tooltipText:i.getConstant("CalcSheetTip"),text:i.getConstant("CalcActiveSheet"),id:t+"_calc_current_sheet",click:function(){e.parent.notify(xt,{action:"ClearDependentCellCollection"}),e.parent.calculateNow("Sheet")},disabled:this.parent.calculationMode==="Automatic"},{prefixIcon:"e-calculation",tooltipText:i.getConstant("CalcWorkbookTip"),text:i.getConstant("CalcWorkbook"),id:t+"_calc_entire_sheets",click:function(){e.parent.notify(xt,{action:"ClearDependentCellCollection"}),e.parent.calculateNow("Workbook")},disabled:this.parent.calculationMode==="Automatic"}]},{header:{text:i.getConstant("Data")},content:[{prefixIcon:"e-protect-icon",text:i.getConstant("ProtectSheet"),id:t+"_protect",tooltipText:i.getConstant("ProtectSheet")},{prefixIcon:"e-password-protect-icon",text:i.getConstant("ProtectWorkbook"),id:t+"_protectworkbook",tooltipText:i.getConstant("ProtectWorkbook")},{type:"Separator",id:t+"_separator_8"},{template:this.datavalidationDDB(t),tooltipText:i.getConstant("DataValidation"),id:t+"_datavalidation"}]},{header:{text:i.getConstant("View")},content:[{prefixIcon:"e-hide-headers",text:this.getLocaleText("Headers"),id:t+"_headers",tooltipText:this.getLocaleText("Headers")},{type:"Separator",id:t+"_separator_9"},{prefixIcon:"e-hide-gridlines",text:this.getLocaleText("GridLines"),id:t+"_gridlines",tooltipText:this.getLocaleText("GridLines")},{type:"Separator",id:t+"_separator_13"},{prefixIcon:"e-freeze-pane",text:i.getConstant("FreezePanes"),id:t+"_freezepanes",tooltipText:i.getConstant("FreezePanes"),disabled:!this.parent.allowFreezePane},{prefixIcon:"e-freeze-row",text:i.getConstant("FreezeRows"),id:t+"_freezerows",tooltipText:i.getConstant("FreezeRows"),disabled:!this.parent.allowFreezePane},{prefixIcon:"e-freeze-column",text:i.getConstant("FreezeColumns"),id:t+"_freezecolumns",tooltipText:i.getConstant("FreezeColumns"),disabled:!this.parent.allowFreezePane}]}];return this.parent.allowConditionalFormat&&r.find(function(n){return n.header&&n.header.text===i.getConstant("Home")}).content.push({type:"Separator",id:t+"_separator_10"},{template:this.getCFDBB(t),tooltipText:i.getConstant("ConditionalFormatting"),id:t+"_conditionalformatting"}),this.parent.allowChart&&r.find(function(n){return n.header&&n.header.text===i.getConstant("Insert")}).content.push({type:"Separator",id:t+"_separator_11"},{template:this.getChartDDB(t,!0),text:i.getConstant("Chart"),tooltipText:i.getConstant("Chart"),id:t+"_chart"}),this.parent.allowCellFormatting&&r.find(function(n){return n.header&&n.header.text===i.getConstant("Home")}).content.push({type:"Separator",id:t+"_separator_12"},{template:this.getClearDDB(t),tooltipText:i.getConstant("Clear"),id:t+"_clear"}),(this.parent.allowSorting||this.parent.allowFiltering)&&r.find(function(n){return n.header&&n.header.text===i.getConstant("Home")}).content.push({template:this.getSortFilterDDB(t),tooltipText:i.getConstant("SortAndFilter"),id:t+"_sorting"}),this.parent.allowFindAndReplace&&r.find(function(n){return n.header&&n.header.text===i.getConstant("Home")}).content.push({template:this.getFindBtn(t),prefixIcon:"e-tbar-search-icon tb-icons",tooltipText:i.getConstant("FindReplaceTooltip"),id:t+"_find"}),r},o.prototype.createCalcOptions=function(e,t){var i=Xe("button",{id:e+"_calc_types",attrs:{type:"button"},className:"e-calc-types"}),r=Xe("span",{className:"e-calc-types-text"});return r.innerText=t.getConstant("CalcOptions"),i.appendChild(r),this.calcTypeOptions=new Or({items:[{id:e+"_Automatic",text:t.getConstant("Automatic"),iconCss:this.parent.calculationMode==="Automatic"?"e-icons e-selected-icon":""},{id:e+"_Manual",text:t.getConstant("Manual"),iconCss:this.parent.calculationMode==="Manual"?"e-icons e-selected-icon":""}],createPopupOnClick:!0,iconCss:"e-calculation e-icons",cssClass:"e-flat e-calc-types"}),this.calcTypeOptions.select=this.selectCalcOptions.bind(this),this.calcTypeOptions.appendTo(i),i},o.prototype.selectCalcOptions=function(e){e.item.id===this.parent.element.id+"_Automatic"?(this.calcTypeOptions.items[0].iconCss="e-icons e-selected-icon",this.calcTypeOptions.items[1].iconCss="",this.parent.calculationMode==="Manual"&&this.parent.notify(xt,{action:"ClearDependentCellCollection"}),this.parent.setProperties({calculationMode:"Automatic"},!0),this.updateFormulaButtons(),this.parent.calculateNow("Workbook")):(this.calcTypeOptions.items[0].iconCss="",this.calcTypeOptions.items[1].iconCss="e-icons e-selected-icon",this.parent.setProperties({calculationMode:"Manual"},!0),this.updateFormulaButtons())},o.prototype.updateFormulaButtons=function(){var e=this.parent.serviceLocator.getService(fe);this.parent.notify(da,[{tab:e.getConstant("Formulas"),items:[this.parent.element.id+"_calc_current_sheet"],enable:this.parent.calculationMode==="Manual"}]),this.parent.notify(da,[{tab:e.getConstant("Formulas"),items:[this.parent.element.id+"_calc_entire_sheets"],enable:this.parent.calculationMode==="Manual"}])},o.prototype.getPasteBtn=function(e,t){var i=this,r=this.parent.element.appendChild(this.parent.createElement("button",{id:e+"_paste",attrs:{type:"button"}}));return this.pasteSplitBtn=new Sp({iconCss:"e-icons e-paste-icon",items:[{text:t.getConstant("All"),id:"All"},{text:t.getConstant("Values"),id:"Values"},{text:t.getConstant("Formats"),id:"Formats"}],createPopupOnClick:!0,select:function(n){i.pasteSplitBtn.element.setAttribute("aria-label",t.getConstant("Paste")+" "+n.item.text),i.parent.notify(Ga,{type:n.item.id,isAction:!0,isInternal:!0})},click:function(){r.setAttribute("aria-label",t.getConstant("Paste")),i.parent.notify(Ga,{isAction:!0,isInternal:!0})},beforeOpen:function(n){n.element.setAttribute("aria-label",t.getConstant("Paste"))}}),this.pasteSplitBtn.createElement=this.parent.createElement,this.pasteSplitBtn.appendTo(r),r.parentElement},o.prototype.getHyperlinkDlg=function(){var e=this.parent.getActiveSheet(),t=J(e.activeCell),i=G(t[0],t[1],e);i&&i.hyperlink?this.parent.notify(Pf,null):this.parent.notify(Rf,null)},o.prototype.passwordProtectDlg=function(){this.parent.password.length>0?this.parent.notify(pb,null):document.getElementById(this.parent.element.id+"_protectworkbook").classList.contains("e-active")?(document.getElementById(this.parent.element.id+"_protectworkbook").classList.remove("e-active"),this.parent.showSheetTabs&&this.parent.element.querySelector(".e-add-sheet-tab").removeAttribute("disabled")):this.parent.notify(db,null)},o.prototype.getLocaleText=function(e){var t,i=this.parent.serviceLocator.getService(fe),r=this.parent.getActiveSheet();return r["show"+e]?t=i.getConstant("Hide"+e):t=i.getConstant("Show"+e),t},o.prototype.getLocaleProtectText=function(e,t){var i,r=this.parent.serviceLocator.getService(fe),n=this.parent.getActiveSheet();return n.isProtected?(t&&this.parent.getMainContent().classList.remove("e-hide-"+e.toLowerCase()),i=r.getConstant("Unprotect"+e)):(t&&this.parent.getMainContent().classList.add("e-hide-"+e.toLowerCase()),i=r.getConstant("Protect"+e)),i},o.prototype.getLocaleProtectWorkbook=function(e,t){var i,r=this.parent.serviceLocator.getService(fe);return this.parent.isProtected?(t&&this.parent.getMainContent().classList.remove("e-hide-"+e.toLowerCase()),i=r.getConstant(e)):(t&&this.parent.getMainContent().classList.add("e-hide-"+e.toLowerCase()),i=r.getConstant(e)),i},o.prototype.insertDesignChart=function(){var e=this,t=this.parent.serviceLocator.getService(fe),i=this.ribbon.items.length-1,r=t.getConstant("ChartDesign");if(this.parent.allowChart&&this.ribbon.items[i]&&this.ribbon.items[i].header.text!==r){this.preTabIdx=this.ribbon.selectedTab;var n=this.parent.element.id,s=[{header:{text:r},content:[{template:this.getAddChartEleDBB(n),tooltipText:t.getConstant("AddChartElement"),id:n+"add_chart_ element_chart"},{type:"Separator"},{prefixIcon:"e-switch-row-column-icon",text:t.getConstant("SwitchRowColumn"),tooltipText:t.getConstant("SwitchRowColumn"),id:n+"switch_row_column_chart",click:function(){e.parent.notify(lu,{switchRowColumn:!0,triggerEvent:!0})}},{type:"Separator"},{template:this.getChartThemeDDB(n),tooltipText:t.getConstant("ChartTheme"),id:n+"_chart_theme"},{type:"Separator"},{template:this.getChartDDB(n,!1),tooltipText:t.getConstant("ChartType"),id:n+"_chart_type"}]}];this.addRibbonTabs({items:s}),this.ribbon.tabObj.select(this.ribbon.items.length)}},o.prototype.removeDesignChart=function(){var e=this.parent.serviceLocator.getService(fe),t=this.ribbon.items.length-1;this.ribbon.items[t]&&this.ribbon.items[t].header.text===e.getConstant("ChartDesign")&&(this.ribbon.tabObj.select(this.preTabIdx+1),this.parent.hideRibbonTabs([e.getConstant("ChartDesign")],!0),document.getElementsByClassName("e-addchart-ddb").length>0&&document.getElementsByClassName("e-addchart-ddb")[0].remove(),document.getElementsByClassName("e-chart-type-ddb").length>0&&document.getElementsByClassName("e-chart-type-ddb")[0].remove(),document.getElementsByClassName("e-charttheme-ddb").length>0&&document.getElementsByClassName("e-charttheme-ddb")[0].remove(),delete this.ribbon.items[t].content[0],this.ribbon.items.length=this.ribbon.items.length-1)},o.prototype.createRibbon=function(e){var t=this.parent.createElement("div",{id:this.parent.element.id+"_ribbon"});this.ribbon=new Xq({selectedTab:0,menuItems:this.getRibbonMenuItems(),items:this.getRibbonItems(),fileMenuItemSelect:this.fileMenuItemSelect.bind(this),beforeOpen:this.fileMenuBeforeOpen.bind(this),beforeClose:this.fileMenuBeforeClose.bind(this),clicked:this.toolbarClicked.bind(this),created:this.ribbonCreated.bind(this),selecting:this.tabSelecting.bind(this),expandCollapse:this.expandCollapseHandler.bind(this),beforeFileMenuItemRender:this.beforeRenderHandler.bind(this),spreadInstance:this.parent&&this.parent.isReact?this.parent:null}),this.ribbon.createElement=this.parent.createElement,e?this.parent.element.insertBefore(t,e):this.parent.element.appendChild(t),this.ribbon.appendTo(t)},o.prototype.tabSelecting=function(e){if(e.selectingIndex!==this.ribbon.selectedTab){var t=this.parent.serviceLocator.getService(fe);if(this.ribbon.items[e.selectingIndex]&&this.ribbon.items[e.selectingIndex].header.text===t.getConstant("Insert")){for(var i=this.ribbon.items[e.selectingIndex].content,r=i.length-1;r>=0;r--)if(i[r].id===this.parent.element.id+"_chart"){var n=i[r].template;n&&!n.classList.contains("e-dropdown-btn")&&this.createChartDdb(document.getElementById(this.parent.element.id+"_chart-btn"),!0);break}}if(this.ribbon.items[e.selectedIndex]&&this.ribbon.items[e.selectedIndex].header.text===t.getConstant("Insert")){for(var i=this.ribbon.items[e.selectedIndex].content,r=i.length-1;r>=0;r--)if(i[r].id===this.parent.element.id+"_chart"){var n=i[r].template;n&&n.classList.contains("e-dropdown-btn")&&this.destroyComponent(n,"dropdown-btn");break}}this.refreshRibbonContent(e.selectingIndex),this.parent.notify(qx,{activeTab:e.selectingIndex})}},o.prototype.beforeRenderHandler=function(e){var t=this.parent.serviceLocator.getService(fe);e.item.text===t.getConstant("Open")&&(!this.parent.openUrl||!this.parent.allowOpen)&&e.element.classList.add("e-disabled"),e.item.text===t.getConstant("SaveAs")&&(!this.parent.saveUrl||!this.parent.allowSave)&&e.element.classList.add("e-disabled"),e.item.text===t.getConstant("Print")&&!this.parent.allowPrint&&e.element.classList.add("e-disabled")},o.prototype.getChartThemeDDB=function(e){var t=this,i=this.parent.serviceLocator.getService(fe),r=this.parent.createElement("button",{id:e+"_chart_theme",attrs:{type:"button"},className:"e-ss-ddb"});r.appendChild(this.parent.createElement("span",{className:"e-tbar-btn-text"}));var n="Material",s=this.parent.element.querySelector(".e-ss-overlay-active");if(s){var a=s.querySelector(".e-chart");a?n=at(a,"chart").theme:(a=s.querySelector(".e-accumulationchart"),a&&(n=at(a,"accumulationchart").theme))}var l=new Or({items:this.getChartThemeDdbItems(n),content:i.getConstant(n),createPopupOnClick:!0,select:function(h){t.parent.notify(pa,{type:"mousedown"}),(!h.element||!h.element.querySelector(".e-selected-icon"))&&(l.content=h.item.text,l.dataBind(),t.parent.notify(lu,{chartTheme:h.item.id,triggerEvent:!0}),l.setProperties({items:t.getChartThemeDdbItems(h.item.id)},!0))},cssClass:"e-flat e-charttheme-ddb",beforeOpen:function(h){t.tBarDdbBeforeOpen(h.element,h.items,t.parent.serviceLocator.getService(fe).getConstant("Chart"))}});return l.createElement=this.parent.createElement,l.appendTo(r),r},o.prototype.getNumFormatDDB=function(e,t){var i=this,r=this.parent.createElement("button",{id:e+"_number_format",attrs:{type:"button"},className:"e-ss-ddb"}),n=this.parent.createElement("span",{className:"e-tbar-btn-text"});n.innerText=t.getConstant("General"),r.appendChild(n);var s={action:"getLocalizedFormats"};this.parent.notify(dd,s);var a=s.defaultFormats,l=s.localizedFormats;return this.numFormatDDB=new Or({items:this.getNumFormatDdbItems(e),createPopupOnClick:!0,select:function(h){var u=i.parent.serviceLocator.getService(fe);if(h.item.text===u.getConstant("Custom"))i.renderCustomFormatDialog(a,l);else{var c=h.item.id.split(i.parent.element.id+"_")[1],d=hr(c);i.applyNumFormat(d);var p=i.parent.getActiveSheet();i.refreshNumFormatSelection(Er(d,!0),p,u,d);var f=Se(p.activeCell);i.refreshTextAlign(p,G(f[0],f[1],p,!1,!0),c,f),i.numFormatDDB.element.setAttribute("aria-label",c),i.parent.showAggregate&&i.parent.notify(yl,{})}},open:function(h){return i.numDDBOpen(h)},beforeItemRender:function(h){return i.previewNumFormat(h)},cssClass:"e-flat e-numformat-ddb",beforeOpen:function(h){i.tBarDdbBeforeOpen(h.element,h.items,i.parent.serviceLocator.getService(fe).getConstant("NumberFormat"))}}),this.numFormatDDB.createElement=this.parent.createElement,this.numFormatDDB.appendTo(r),r},o.prototype.getFontSizeDDB=function(e){var t=this;return this.fontSizeDdb=new Or({cssClass:"e-font-size-ddb",content:"11",createPopupOnClick:!0,items:[{text:"8"},{text:"9"},{text:"10"},{text:"11"},{text:"12"},{text:"14"},{text:"16"},{text:"18"},{text:"20"},{text:"22"},{text:"24"},{text:"26"},{text:"28"},{text:"36"},{text:"48"},{text:"72"}],beforeOpen:function(i){t.tBarDdbBeforeOpen(i.element,i.items,t.parent.serviceLocator.getService(fe).getConstant("FontSize")),t.refreshSelected(t.fontSizeDdb,i.element,"content","text")},select:function(i){var r={style:{fontSize:i.item.text+"pt"},onActionUpdate:!0};t.parent.notify(rr,r),r.cancel||(t.fontSizeDdb.content=r.style.fontSize.split("pt")[0],t.fontSizeDdb.dataBind()),t.fontSizeDdb.element.setAttribute("aria-label",i.item.text)}}),this.fontSizeDdb.createElement=this.parent.createElement,this.fontSizeDdb.appendTo(this.parent.createElement("button",{id:e+"_font_size",attrs:{type:"button"},className:"e-ss-ddb"})),this.fontSizeDdb.element},o.prototype.getChartDDB=function(e,t){var i=this.parent.serviceLocator.getService(fe),r;if(t){r=this.parent.createElement("button",{id:e+"_chart-btn",attrs:{type:"button"}});var n=this.parent.createElement("span",{id:e+"_chart"});n.innerText=i.getConstant("Chart"),r.appendChild(n)}else{r=this.parent.createElement("button",{id:e+"_chart-type-btn",attrs:{type:"button"}});var n=this.parent.createElement("span",{id:e+"_chart_type"});n.innerText=i.getConstant("ChartType"),r.appendChild(n),this.createChartDdb(r,!1)}return r},o.prototype.closeDropdownPopup=function(e){if(e.altKey&&e.keyCode===38||e.keyCode===27){var t=this[1];t&&(t.toggle(),Fe(t.element))}},o.prototype.createChartDdb=function(e,t){var i=this,r=this.parent.serviceLocator.getService(fe),n=t?"e-chart-menu":"e-chart-type-menu",s=this.parent.createElement("ul",{id:""+this.parent.element.id+(t?"_chart_menu":"_chart_type_menu")}),a,l=new Or({iconCss:"e-icons "+(t?"e-chart-icon":"e-chart-type-icon"),cssClass:t?"e-chart-ddb":"e-chart-type-ddb",target:s,createPopupOnClick:!0,beforeOpen:function(h){a=i.createChartMenu(s,n,r,l),i.tBarDdbBeforeOpen(h.element,a.items,i.parent.serviceLocator.getService(fe).getConstant("Chart")),E.add(s,"keydown",i.closeDropdownPopup,[i,l])},open:function(){return Fe(s)},beforeClose:function(h){h.event&&j(h.event.target,"."+n)?h.cancel=!0:(E.remove(s,"keydown",i.closeDropdownPopup),a.destroy())}});l.createElement=this.parent.createElement,l.appendTo(e)},o.prototype.createChartMenu=function(e,t,i,r){var n=this,s=new Ph({cssClass:t,items:[{iconCss:"e-icons e-column",text:i.getConstant("Column"),items:[{id:"column_chart"}]},{iconCss:"e-icons e-bar",text:i.getConstant("Bar"),items:[{id:"bar_chart"}]},{iconCss:"e-icons e-area",text:i.getConstant("Area"),items:[{id:"area_chart"}]},{iconCss:"e-icons e-pie-doughnut",text:i.getConstant("PieAndDoughnut"),items:[{id:"pie_doughnut_chart"}]},{iconCss:"e-icons e-line",text:i.getConstant("Line"),items:[{id:"line_chart"}]},{iconCss:"e-icons e-scatter",text:i.getConstant("Scatter"),items:[{id:"scatter_chart"}]}],orientation:"Vertical",beforeOpen:function(Ct){var Ei;Ct.parentItem.text===i.getConstant("Column")?(Ct.element.firstChild.appendChild(a),Ei="e-column-chart"):Ct.parentItem.text===i.getConstant("Bar")?(Ct.element.firstChild.appendChild(S),Ei="e-bar-chart"):Ct.parentItem.text===i.getConstant("Area")?(Ct.element.firstChild.appendChild(k),Ei="e-area-chart"):Ct.parentItem.text===i.getConstant("Line")?(Ct.element.firstChild.appendChild(z),Ei="e-line-chart"):Ct.parentItem.text===i.getConstant("PieAndDoughnut")?(Ct.element.firstChild.appendChild(ye),Ei="e-pie-doughnut-chart"):Ct.parentItem.text===i.getConstant("Radar")?(Ct.element.firstChild.appendChild(_e),Ei="e-radar-chart"):Ct.parentItem.text===i.getConstant("Scatter")&&(Ct.element.firstChild.appendChild(Xt),Ei="e-scatter-chart"),Ei&&(Ct.element.parentElement.classList.add(Ei),E.add(Ct.element,"keydown",n.menuIconKeyDown.bind(n,Ei+" .e-menu-icon",0)))},select:function(Ct){return n.chartSelected(Ct,r)},beforeItemRender:function(Ct){Ct.item.text||Ct.element.removeAttribute("tabindex")},beforeClose:function(Ct){Ct.event&&Ct.event.keyCode===37?Ct.cancel=!0:E.remove(Ct.element,"keydown",n.menuIconKeyDown)}}),a=this.parent.createElement("div",{id:"column_main",className:"e-column-main"}),l=this.parent.createElement("div",{id:"column1_text",className:"e-column1-text"});l.innerText=i.getConstant("Column");var h=this.parent.createElement("div",{id:"column1_cont",className:"e-column1-cont"}),u=this.parent.createElement("div",{id:"column2_cont",className:"e-column2-cont"});a.appendChild(l),a.appendChild(h);var c=i.getConstant("ClusteredColumn"),d=this.parent.createElement("span",{id:"clusteredColumn",className:"e-clusteredcolumn e-column-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("StackedColumn");var p=this.parent.createElement("span",{id:"stackedColumn",className:"e-stackedcolumn e-column-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("StackedColumn100");var f=this.parent.createElement("span",{id:"stackedColumn100",className:"e-stackedcolumn100 e-column-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}}),v=this.parent.createElement("span",{id:"clusteredColumn3D",className:"e-clusteredColumn3D e-column-icon"}),m=this.parent.createElement("span",{id:"stackedColumn3D",className:"e-stackedColumn3D e-column-icon"}),y=this.parent.createElement("span",{id:"stackedColumn1003D",className:"e-stackedColumn1003D e-column-icon"});h.appendChild(d),h.appendChild(p),h.appendChild(f),u.appendChild(v),u.appendChild(m),u.appendChild(y);var S=this.parent.createElement("div",{id:"bar_main",className:"e-bar-main"}),b=this.parent.createElement("div",{id:"bar1_text",className:"e-bar1-text"});b.innerText=i.getConstant("Bar");var w=this.parent.createElement("div",{id:"bar1_cont",className:"e-bar1-cont"}),I=this.parent.createElement("div",{id:"bar2_cont",className:"e-bar2-cont"});S.appendChild(b),S.appendChild(w),c=i.getConstant("ClusteredBar");var x=this.parent.createElement("span",{id:"clusteredBar",className:"e-clusteredbar e-bar-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("StackedBar");var M=this.parent.createElement("span",{id:"stackedBar",className:"e-stackedbar e-bar-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("StackedBar100");var D=this.parent.createElement("span",{id:"stackedBar100",className:"e-stackedbar100 e-bar-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}}),A=this.parent.createElement("span",{id:"clusteredBar3D",className:"e-clusteredBar3D e-bar-icon"}),L=this.parent.createElement("span",{id:"stackedBar3D",className:"e-stackedBar3D e-bar-icon"}),T=this.parent.createElement("span",{id:"stackedBar1003D",className:"e-stackedBar1003D e-bar-icon"});w.appendChild(x),w.appendChild(M),w.appendChild(D),I.appendChild(A),I.appendChild(L),I.appendChild(T);var k=this.parent.createElement("div",{id:"area_main",className:"e-area-main"}),F=this.parent.createElement("div",{id:"area_text",className:"e-area-text"});F.innerText=i.getConstant("Area");var R=this.parent.createElement("div",{id:"area_cont",className:"e-area-cont"});k.appendChild(F),k.appendChild(R),c=i.getConstant("Area");var N=this.parent.createElement("span",{id:"area",className:"e-area e-area-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("StackedArea");var P=this.parent.createElement("span",{id:"stackedArea",className:"e-stackedarea e-area-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("StackedArea100");var O=this.parent.createElement("span",{id:"stackedArea100",className:"e-stackedarea100 e-area-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});R.appendChild(N),R.appendChild(P),R.appendChild(O);var z=this.parent.createElement("div",{id:"line_main",className:"e-line-main"}),H=this.parent.createElement("div",{id:"line_text",className:"e-line-text"});H.innerText=i.getConstant("Line");var Q=this.parent.createElement("div",{id:"line_cont",className:"e-line-cont"}),$=this.parent.createElement("div",{id:"line_cont_marker",className:"e-line-cont"});z.appendChild(H),z.appendChild(Q),z.appendChild($),c=i.getConstant("Line");var U=this.parent.createElement("span",{id:"line",className:"e-line e-line-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("StackedLine");var ie=this.parent.createElement("span",{id:"stackedLine",className:"e-stackedline e-line-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("StackedLine100");var ne=this.parent.createElement("span",{id:"stackedLine100",className:"e-stackedline100 e-line-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("LineMarker");var te=this.parent.createElement("span",{id:"lineMarker",className:"e-line-marker e-line-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("StackedLineMarker");var oe=this.parent.createElement("span",{id:"stackedLineMarker",className:"e-stackedline-marker e-line-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("StackedLine100Marker");var ae=this.parent.createElement("span",{id:"stackedLine100Marker",className:"e-stackedline100-marker e-line-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});Q.appendChild(U),Q.appendChild(ie),Q.appendChild(ne),$.appendChild(te),$.appendChild(oe),$.appendChild(ae);var ye=this.parent.createElement("div",{id:"pie_main",className:"e-pie-main"}),De=this.parent.createElement("div",{id:"pie_text",className:"e-pie-text"});De.innerText=i.getConstant("Pie");var ve=this.parent.createElement("div",{id:"pie_cont",className:"e-pie-cont"});ye.appendChild(De),ye.appendChild(ve),c=i.getConstant("Pie");var ue=this.parent.createElement("span",{id:"pie",className:"e-pie e-pie-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});c=i.getConstant("Doughnut");var Tt=this.parent.createElement("span",{id:"doughnut",className:"e-doughnut e-pie-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});ve.appendChild(ue),ve.appendChild(Tt);var _e=this.parent.createElement("div",{id:"radar_main",className:"e-radar-main"}),lt=this.parent.createElement("div",{id:"radar_text",className:"e-radar-text"});lt.innerText=i.getConstant("Radar");var We=this.parent.createElement("div",{id:"radar_cont",className:"e-radar-cont"});_e.appendChild(lt),_e.appendChild(We);var ct=this.parent.createElement("span",{id:"radar",className:"e-radar e-radar-icon e-menu-icon e-icons",attrs:{tabindex:"-1"}}),Dt=this.parent.createElement("span",{id:"radar_markers",className:"e-radar-markers e-radar-icon e-menu-icon e-icons",attrs:{tabindex:"-1"}});ct.title=i.getConstant("BlueDataBar"),Dt.title=i.getConstant("GreenDataBar"),We.appendChild(ct),We.appendChild(Dt);var Xt=this.parent.createElement("div",{id:"scatter_main",className:"e-scatter-main"}),Lt=this.parent.createElement("div",{id:"scatter_text",className:"e-scatter-text"});c=i.getConstant("Scatter"),Lt.innerText=c;var Bi=this.parent.createElement("div",{id:"scatter_cont",className:"e-scatter-cont"});Xt.appendChild(Lt),Xt.appendChild(Bi);var zi=this.parent.createElement("span",{id:"scatter",className:"e-scatter e-scatter-icon e-menu-icon e-icons",attrs:{title:c,"aria-label":c,tabindex:"-1"}});return Bi.appendChild(zi),s.createElement=this.parent.createElement,s.appendTo(e),e.classList.add("e-ul"),s},o.prototype.getAddChartEleDBB=function(e){var t=this,i=this.parent.serviceLocator.getService(fe),r=this.parent.createElement("ul",{id:e+"_add_chart_menu"}),n;this.addChartDdb=new Or({iconCss:"e-icons e-addchart-icon",cssClass:"e-addchart-ddb",target:r,createPopupOnClick:!0,close:function(){return Fe(t.parent.element)},beforeOpen:function(l){n=t.createAddChartMenu(r,i),t.tBarDdbBeforeOpen(l.element,n.items),E.add(r,"keydown",t.closeDropdownPopup,[t,t.addChartDdb])},open:function(){return Fe(r)},beforeClose:function(l){l.event&&j(l.event.target,".e-addchart-menu")?l.cancel=!0:(E.remove(r,"keydown",t.closeDropdownPopup),n.destroy())}}),this.addChartDdb.createElement=this.parent.createElement;var s=this.parent.createElement("button",{id:e+"_addchart",attrs:{type:"button"}}),a=this.parent.createElement("span",{id:e+"_chart"});return a.innerText=i.getConstant("AddChartElement"),s.appendChild(a),this.addChartDdb.appendTo(s),this.addChartDdb.element},o.prototype.createAddChartMenu=function(e,t){var i=this,r=new Ph({cssClass:"e-addchart-menu",title:t.getConstant("AddChartElement"),items:[{iconCss:"e-icons e-axes",text:t.getConstant("Axes"),items:[{iconCss:"e-icons e-ph-axes",id:"PHAxes",text:t.getConstant("PrimaryHorizontal")},{iconCss:"e-icons e-pv-axes",id:"PVAxes",text:t.getConstant("PrimaryVertical")}]},{iconCss:"e-icons e-axis-title",text:t.getConstant("AxisTitle"),items:[{iconCss:"e-icons e-ph-axistitle",id:"PHAxisTitle",text:t.getConstant("PrimaryHorizontal")},{iconCss:"e-icons e-pv-axistitle",id:"PVAxisTitle",text:t.getConstant("PrimaryVertical")}]},{iconCss:"e-icons e-chart-title",text:t.getConstant("ChartTitle"),items:[{iconCss:"e-icons e-ct-none",id:"ChartTitleNone",text:t.getConstant("None")},{iconCss:"e-icons e-ct-abovechart",id:"ChartTitleAbove",text:t.getConstant("AboveChart")}]},{iconCss:"e-icons e-data-labels",id:this.parent.element.id+"data-labels",text:t.getConstant("DataLabels"),items:[{iconCss:"e-icons e-dl-none",id:"DLNone",text:t.getConstant("None")},{iconCss:"e-icons e-dl-center",id:"DLCenter",text:t.getConstant("Center")},{iconCss:"e-icons e-dl-insideend",id:"DLInsideend",text:t.getConstant("InsideEnd")},{iconCss:"e-icons e-dl-insidebase",id:"DLInsidebase",text:t.getConstant("InsideBase")},{iconCss:"e-icons e-dl-outsideend",id:"DLOutsideend",text:t.getConstant("OutsideEnd")}]},{iconCss:"e-icons e-gridlines",text:t.getConstant("Gridlines"),items:[{iconCss:"e-icons e-gl-major-horizontal",id:"GLMajorHorizontal",text:t.getConstant("PrimaryMajorHorizontal")},{iconCss:"e-icons e-gl-major-vertical",id:"GLMajorVertical",text:t.getConstant("PrimaryMajorVertical")},{iconCss:"e-icons e-gl-minor-horizontal",id:"GLMinorHorizontal",text:t.getConstant("PrimaryMinorHorizontal")},{iconCss:"e-icons e-gl-minor-vertical",id:"GLMinorVertical",text:t.getConstant("PrimaryMinorVertical")}]},{iconCss:"e-icons e-legends",text:t.getConstant("Legends"),items:[{iconCss:"e-icons e-legends-none",id:"LegendNone",text:t.getConstant("None")},{iconCss:"e-icons e-legends-right",id:"LegendsRight",text:t.getConstant("Right")},{iconCss:"e-icons e-legends-left",id:"LegendsLeft",text:t.getConstant("Left")},{iconCss:"e-icons e-legends-bottom",id:"LegendsBottom",text:t.getConstant("Bottom")},{iconCss:"e-icons e-legends-top",id:"LegendsTop",text:t.getConstant("Top")}]}],orientation:"Vertical",select:this.addChartEleSelected.bind(this),beforeOpen:function(n){if(n.parentItem.id===i.parent.element.id+"data-labels"){var s=i.parent.element.querySelector(".e-ss-overlay-active");if(s){var a=s.querySelector(".e-chart");if(a){var l=at(a,"chart");if(l.series[0]&&l.series[0].type.includes("Line")){var h=function(c,d){if(c){var p=c.parentElement;p.innerHTML="",p.appendChild(c),p.appendChild(document.createTextNode(t.getConstant(d)))}};h(n.element.querySelector(".e-dl-insideend"),"Above"),h(n.element.querySelector(".e-dl-insidebase"),"Below");var u=n.element.querySelector(".e-dl-outsideend");u&&(u.parentElement.style.display="none")}}}}}});return r.createElement=this.parent.createElement,r.appendTo(e),e.classList.add("e-ul"),r},o.prototype.getCFDBB=function(e){var t=this,i=this.parent.createElement("ul",{id:e+"_cf_menu"}),r;return this.cfDdb=new Or({iconCss:"e-icons e-conditionalformatting-icon",cssClass:"e-cf-ddb",target:i,createPopupOnClick:!0,close:function(){return Fe(t.parent.element)},beforeOpen:function(n){r=t.createCFMenu(i),t.tBarDdbBeforeOpen(n.element,r.items,t.parent.serviceLocator.getService(fe).getConstant("ConditionalFormatting")),E.add(i,"keydown",t.closeDropdownPopup,[t,t.cfDdb])},open:function(){return Fe(i)},beforeClose:function(n){n.event&&j(n.event.target,".e-cf-menu")?n.cancel=!0:(E.remove(i,"keydown",t.closeDropdownPopup),r&&r.element&&(us(t.spanElements),t.spanElements=[],us(t.iconWrapElements),t.iconWrapElements=[],us(t.iconSetElements),t.iconSetElements=[],us(t.iconSetGroupElement),t.iconSetGroupElement=[],r.destroy(),r.element.remove()))}}),this.cfDdb.createElement=this.parent.createElement,this.cfDdb.appendTo(this.parent.createElement("button",{id:e+"_conditionalformatting",attrs:{type:"button"}})),this.cfDdb.element},o.prototype.createCFMenu=function(e){var t=this,i=this.parent.serviceLocator.getService(fe),r=function(s,a,l){var h;s.forEach(function(u){h=i.getConstant(u+a);var c=t.parent.createElement("span",{id:u+a,className:"e-"+u.toLowerCase()+" e-cf-icon",attrs:{title:h,"aria-label":h,tabindex:"-1"}});t.spanElements.push(c),l.appendChild(c)})},n=new Ph({cssClass:"e-cf-menu",items:[{iconCss:"e-icons e-hlcellrules",text:i.getConstant("HighlightCellsRules"),items:[{iconCss:"e-icons e-greaterthan",id:"cf_greaterthan_dlg",text:i.getConstant("GreaterThan")+"..."},{iconCss:"e-icons e-lessthan",id:"cf_lessthan_dlg",text:i.getConstant("LessThan")+"..."},{iconCss:"e-icons e-between",id:"cf_between_dlg",text:i.getConstant("Between")+"..."},{iconCss:"e-icons e-equalto",id:"cf_eqaulto_dlg",text:i.getConstant("CFEqualTo")+"..."},{iconCss:"e-icons e-textcontains",id:"cf_textcontains_dlg",text:i.getConstant("TextThatContains")+"..."},{iconCss:"e-icons e-adateoccuring",id:"cf_adateoccuring_dlg",text:i.getConstant("ADateOccuring")+"..."},{iconCss:"e-icons e-duplicate",id:"cf_duplicatevalues_dlg",text:i.getConstant("DuplicateValues")+"..."}]},{iconCss:"e-icons e-topbottomrules",text:i.getConstant("TopBottomRules"),items:[{iconCss:"e-icons e-top10items",id:"cf_top10items_dlg",text:i.getConstant("Top10Items")+"..."},{iconCss:"e-icons e-top10",id:"cf_top10_dlg",text:i.getConstant("Top10")+" %..."},{iconCss:"e-icons e-bottom10items",id:"cf_bottom10items_dlg",text:i.getConstant("Bottom10Items")+"..."},{iconCss:"e-icons e-bottom10",id:"cf_bottom10_dlg",text:i.getConstant("Bottom10")+" %..."},{iconCss:"e-icons e-aboveaverage",id:"cf_aboveaverage_dlg",text:i.getConstant("AboveAverage")+"..."},{iconCss:"e-icons e-belowaverage",id:"cf_belowaverage_dlg",text:i.getConstant("BelowAverage")+"..."}]},{iconCss:"e-icons e-databars",text:i.getConstant("DataBars"),items:[{id:"db_icons1"},{id:"db_icons2"}]},{iconCss:"e-icons e-colorscales",text:i.getConstant("ColorScales"),items:[{id:"cs_icons1"},{id:"cs_icons2"},{id:"cs_icons3"}]},{iconCss:"e-icons e-iconsets",text:i.getConstant("IconSets"),items:[{id:"is_icons"}]},{iconCss:"e-icons e-clearrules",text:i.getConstant("ClearRules"),items:[{id:"cf_cr_cells",text:i.getConstant("SelectedCells")},{id:"cf_cr_sheet",text:i.getConstant("EntireSheet")}]}],orientation:"Vertical",beforeOpen:function(s){if(s.parentItem.iconCss==="e-icons e-databars")s.element.parentElement.classList.add("e-databars"),r(["Blue","Green","Red"],"DataBar",s.element.firstChild),r(["Orange","LightBlue","Purple"],"DataBar",s.element.lastChild),E.add(s.element,"keydown",t.menuIconKeyDown.bind(t,"e-cf-icon",3));else if(s.parentItem.iconCss==="e-icons e-colorscales")s.element.parentElement.classList.add("e-colorscales"),r(["GYR","RYG","GWR","RWG"],"ColorScale",s.element.firstChild),r(["BWR","RWB","WR","RW"],"ColorScale",s.element.querySelector("#cs_icons2")),r(["GW","WG","GY","YG"],"ColorScale",s.element.lastChild),E.add(s.element,"keydown",t.menuIconKeyDown.bind(t,"e-cf-icon",4));else if(s.parentItem.iconCss==="e-icons e-iconsets"){s.element.parentElement.classList.add("e-iconsets");var a=t.parent.createElement("div",{id:"is",className:"e-is"});t.iconSetGroupElement.push(a);var l=[{hdr:"Directional"},{cont:[{cls:"3arrows",key:"ThreeArrowsColor",id:"ThreeArrows",count:3},{cls:"3arrowsgray",key:"ThreeArrowsGray",count:3},{cls:"3triangles",key:"ThreeTriangles",count:3},{cls:"4arrowsgray",key:"FourArrowsGray",count:4},{cls:"4arrows",key:"FourArrowsColor",id:"FourArrows",count:4},{cls:"5arrowsgray",key:"FiveArrowsGray",count:5},{cls:"5arrows",key:"FiveArrowsColor",id:"FiveArrows",count:5}]},{hdr:"Shapes"},{cont:[{cls:"3trafficlights",key:"ThreeTrafficLights1",count:3},{cls:"3rafficlights2",key:"ThreeTrafficLights2",count:3},{cls:"3signs",key:"ThreeSigns",count:3},{cls:"4trafficlights",key:"FourTrafficLights",count:4},{cls:"4redtoblack",key:"RedToBlack",id:"FourRedToBlack",count:4}]},{hdr:"Indicators"},{cont:[{cls:"3symbols",key:"ThreeSymbols1",id:"ThreeSymbols",count:3},{cls:"3symbols2",key:"ThreeSymbols2",count:3},{cls:"3flags",key:"ThreeFlags",count:3}]},{hdr:"Ratings"},{cont:[{cls:"3stars",key:"ThreeStars",count:3},{cls:"4rating",key:"FourRatings",id:"FourRating",count:4},{cls:"5quarters",key:"FiveQuarters",count:5},{cls:"5rating",key:"FiveRatings",id:"FiveRating",count:5},{cls:"5boxes",key:"FiveBoxes",count:5}]}],h,u,c,d;l.forEach(function(p,f){h=t.parent.createElement("div",{id:"is"+(f+1),className:"e-is"+(f+1)}),t.iconSetElements.push(h),p.hdr?h.innerText=i.getConstant(p.hdr):p.cont.forEach(function(v){for(c=i.getConstant(v.key),u=t.parent.createElement("div",{id:v.id||v.key,className:"e-"+v.cls+" e-is-wrapper",attrs:{title:c,"aria-label":c,tabindex:"-1"}}),t.iconWrapElements.push(u),d=0;d<v.count;d++){var m=t.createElement("span","e-"+v.cls+"-"+(d+1)+" e-iconsetspan");t.spanElements.push(m),u.appendChild(m)}h.appendChild(u)}),a.appendChild(h)}),s.element.firstChild.appendChild(a),E.add(s.element,"keydown",t.menuIconKeyDown.bind(t,"e-is-wrapper",0))}},select:this.cfSelected.bind(this),beforeItemRender:function(s){(s.item.id.includes("db_icons")||s.item.id.includes("cs_icons")||s.item.id==="is_icons")&&s.element.removeAttribute("tabindex")},beforeClose:function(s){var a=["e-icons e-databars","e-icons e-colorscales","e-icons e-iconsets"].indexOf(s.parentItem.iconCss)>-1;s.cancel=s.event&&s.event.keyCode===37&&a,a&&!s.cancel&&E.remove(s.element,"keydown",t.menuIconKeyDown)}});return n.createElement=this.parent.createElement,n.appendTo(e),e.classList.add("e-ul"),n},o.prototype.menuIconKeyDown=function(e,t,i){var r,n=[];if(!i)r=0,n=[].slice.call(document.querySelectorAll("."+e));else if(i.keyCode===40||i.keyCode===39||i.keyCode===38||i.keyCode===37){if(i.preventDefault(),n=[].slice.call(document.querySelectorAll("."+e)),r=n.indexOf(i.target),r===-1)r=0;else if(i.keyCode===39)r++,r===n.length&&(r=0);else if(i.keyCode===37)r--,r===-1&&(r=n.length-1);else if(!e.includes("e-menu-icon")){var s=n.length,a=void 0,l=void 0;t||(t=2,i.keyCode===40?(a=[6,11,14,19],l=[5,10,13]):(a=[7,12,15],l=[8,13,16]),s--),i.keyCode===40?r===s-1?r=0:(r+=a&&a.indexOf(r)>-1?1:l&&l.indexOf(r)>-1?3:t,a&&s++,r>=s&&(r=r-s+1)):r===0?r=s-1:(r-=a&&a.indexOf(r)>-1?1:l&&l.indexOf(r)>-1?3:t,r<0&&(r=a?s:s+r-1))}}n[r]&&Fe(n[r])},o.prototype.createElement=function(e,t){return this.parent.createElement(e,{className:t})},o.prototype.getBordersDBB=function(e){var t=this,i=this.parent.createElement("ul",{id:e+"_borders_menu"});this.cPickerEle=this.parent.createElement("input",{id:e+"_cell_border_color",attrs:{type:"color"}}),this.parent.element.appendChild(this.cPickerEle),this.colorPicker=new Cv({cssClass:"e-border-colorpicker",mode:"Palette",inline:!0,beforeTileRender:function(n){n.element.tabIndex=-1},change:function(n){var s=t.border.split(" ");s[2]=n.currentValue.hex,t.border=s.join(" ")}}),this.colorPicker.createElement=this.parent.createElement,this.colorPicker.appendTo(this.cPickerEle);var r;return this.bordersDdb=new Or({iconCss:"e-icons e-bottom-borders",cssClass:"e-borders-ddb",target:i,createPopupOnClick:!0,beforeOpen:function(n){r=t.createBorderMenu(i),t.tBarDdbBeforeOpen(n.element,r.items,t.parent.serviceLocator.getService(fe).getConstant("Borders"),1),E.add(i,"keydown",t.closeDropdownPopup,[t,t.bordersDdb])},open:function(){return Fe(i)},beforeClose:function(n){n.event&&j(n.event.target,".e-borders-menu")?n.cancel=!0:(E.remove(i,"keydown",t.closeDropdownPopup),r.destroy())},close:function(){return Fe(t.bordersDdb.element)}}),this.bordersDdb.createElement=this.parent.createElement,this.bordersDdb.appendTo(this.parent.createElement("button",{id:e+"_borders",attrs:{type:"button"}})),this.bordersDdb.element},o.prototype.createBorderMenu=function(e){var t=this,i=this.parent.serviceLocator.getService(fe),r=this.parent.element.id,n=new Ph({cssClass:"e-borders-menu",items:[{iconCss:"e-icons e-top-borders",text:i.getConstant("TopBorders"),id:r+"_border_topborders"},{iconCss:"e-icons e-left-borders",text:i.getConstant("LeftBorders"),id:r+"_border_leftborders"},{iconCss:"e-icons e-right-borders",text:i.getConstant("RightBorders"),id:r+"_border_rightborders"},{iconCss:"e-icons e-bottom-borders",text:i.getConstant("BottomBorders"),id:r+"_border_bottomborders"},{iconCss:"e-icons e-all-borders",text:i.getConstant("AllBorders"),id:r+"_border_allborders"},{iconCss:"e-icons e-horizontal-borders",text:i.getConstant("HorizontalBorders"),id:r+"_border_horizontalborders"},{iconCss:"e-icons e-vertical-borders",text:i.getConstant("VerticalBorders"),id:r+"_border_verticalborders"},{iconCss:"e-icons e-outside-borders",text:i.getConstant("OutsideBorders"),id:r+"_border_outsideborders"},{iconCss:"e-icons e-inside-borders",text:i.getConstant("InsideBorders"),id:r+"_border_insideborders"},{iconCss:"e-icons e-no-borders",text:i.getConstant("NoBorders"),id:r+"_border_noborders"},{separator:!0},{text:i.getConstant("BorderColor"),items:[{id:r+"_border_colors"}],id:r+"_border_bordercolor"},{text:i.getConstant("BorderStyle"),items:[{iconCss:"e-icons e-selected-icon",id:r+"_1px"},{id:r+"_2px"},{id:r+"_3px"},{id:r+"_dashed"},{id:r+"_dotted"},{id:r+"_double"}]}],orientation:"Vertical",beforeOpen:function(s){if(s.parentItem.id===r+"_border_bordercolor"){t.colorPicker.refresh();var a=t.colorPicker.element.parentElement;s.element.firstElementChild.appendChild(a),a.style.display="inline-block",s.element.parentElement.classList.add("e-border-color"),s.element.firstElementChild.removeAttribute("tabindex")}else s.element.classList.add("e-border-style")},beforeClose:function(s){if(s.event&&s.parentItem.id===r+"_border_bordercolor")if(!j(s.event.target,".e-border-colorpicker")||j(s.event.target,".e-apply")||j(s.event.target,".e-cancel")){t.colorPicker=at(t.cPickerEle,"colorpicker"),t.colorPicker.mode==="Picker"&&(t.colorPicker.mode="Palette",t.colorPicker.dataBind());var a=t.colorPicker.element.parentElement;a.style.display="",t.parent.element.appendChild(a)}else s.cancel=!0},onOpen:function(s){if(s.parentItem.id===r+"_border_bordercolor"){s.element.parentElement.style.overflow="visible";var a=s.element.querySelector(".e-color-palette .e-palette");a&&Fe(a)}},onClose:function(){return Fe(n.element)},select:function(s){t.borderSelected(s,n)}});return n.createElement=this.parent.createElement,n.appendTo(e),e.classList.add("e-ul"),n},o.prototype.chartSelected=function(e,t){var i=!g(j(e.element,".e-chart-menu")),r=e.element.id;if("column_chartbar_chartarea_chartpie_doughnut_chartline_chartradar_chartscatter_chart".includes(r)){e.item&&(!e.item.items||!e.item.items.length)&&t.toggle();var n=e.event.target.id;this.parent.notify(AI,{action:r,id:n,isChart:i})}},o.prototype.addChartEleSelected=function(e){var t=e.element.id;this.parent.notify(lu,{addChartEle:t,triggerEvent:!0}),e.item&&(!e.item.items||!e.item.items.length)&&this.addChartDdb.toggle()},o.prototype.cfSelected=function(e){var t=this.parent.getActiveSheet();if(e.item.id.includes("_dlg"))this.parent.notify(xI,{action:e.item.text});else{var i=e.item.id.includes("icons");if(i||e.item.id==="cf_cr_cells"||e.item.id==="cf_cr_sheet")if(qi(this.parent,tt(J(t.selectedRange))))this.parent.notify(nr,null);else if(i){var r=e.event.target;this.parent.notify(hd,{cfModel:{type:r.id||r.parentElement.id,range:t.selectedRange},isAction:!0})}else e.item.id==="cf_cr_cells"?this.parent.notify(qa,{range:t.selectedRange,isAction:!0}):e.item.id==="cf_cr_sheet"&&(this.parent.conditionalFormat=null,this.parent.notify(qa,{isAction:!0}))}e.item&&(!e.item.items||!e.item.items.length)&&this.cfDdb.toggle()},o.prototype.borderSelected=function(e,t){this.bordersDdb.element.setAttribute("aria-label",e.item.text);var i=this.parent.element.id;if(!(e.item.items.length||e.item.id===i+"_border_colors")){if(!e.item.text){var r=this.border.split(" "),n=r[1]==="solid"?i+"_"+r[0]:i+"_"+r[1];if(n===e.item.id)return;e.item.id===i+"_1px"||e.item.id===i+"_2px"||e.item.id===i+"_3px"?(r[0]=e.item.id.split(i+"_")[1],r[1]="solid"):(r[1]=e.item.id.split(i+"_")[1],r[0]=r[1]==="double"?"3px":"1px"),this.border=r.join(" "),t.items[12].items.forEach(function(s){s.id===n&&(s.iconCss=null),s.id===e.item.id&&(s.iconCss="e-icons e-selected-icon")}),t.setProperties({items:t.items},!0);return}switch(this.bordersDdb.toggle(),this.parent.showSpinner(),e.item.id){case i+"_border_topborders":this.parent.notify(rr,{style:{borderTop:this.border},onActionUpdate:!0});break;case i+"_border_leftborders":this.parent.notify(rr,{style:{borderLeft:this.border},onActionUpdate:!0});break;case i+"_border_rightborders":this.parent.notify(rr,{style:{borderRight:this.border},onActionUpdate:!0});break;case i+"_border_bottomborders":this.parent.notify(rr,{style:{borderBottom:this.border},onActionUpdate:!0});break;case i+"_border_allborders":this.parent.notify(rr,{style:{border:this.border},onActionUpdate:!0});break;case i+"_border_horizontalborders":this.parent.notify(rr,{style:{border:this.border},onActionUpdate:!0,borderType:"Horizontal"});break;case i+"_border_verticalborders":this.parent.notify(rr,{style:{border:this.border},onActionUpdate:!0,borderType:"Vertical"});break;case i+"_border_outsideborders":this.parent.notify(rr,{style:{border:this.border},onActionUpdate:!0,borderType:"Outer"});break;case i+"_border_insideborders":this.parent.notify(rr,{style:{border:this.border},onActionUpdate:!0,borderType:"Inner"});break;case i+"_border_noborders":this.parent.notify(rr,{style:{border:""},onActionUpdate:!0});break}this.parent.hideSpinner()}},o.prototype.getFontNameDDB=function(e){var t=this,i=this.parent.createElement("button",{id:e+"_font_name",attrs:{type:"button"},className:"e-ss-ddb"}),r=this.parent.createElement("span",{className:"e-tbar-btn-text"});return r.innerText="Calibri",i.appendChild(r),this.fontNameDdb=new Or({cssClass:"e-font-family",items:this.getFontFamilyItems(),createPopupOnClick:!0,select:function(n){var s={style:{fontFamily:n.item.text},onActionUpdate:!0};t.parent.notify(rr,s),i.setAttribute("aria-label",n.item.text),s.cancel||t.refreshFontNameSelection(s.style.fontFamily)},beforeOpen:function(n){t.tBarDdbBeforeOpen(n.element,n.items,t.parent.serviceLocator.getService(fe).getConstant("Font"))}}),this.fontNameDdb.createElement=this.parent.createElement,this.fontNameDdb.appendTo(i),i},o.prototype.getBtn=function(e,t,i,r){r===void 0&&(r=!0);var n=new bn({iconCss:"e-icons e-"+t+"-icon",cssClass:"e-flat",isToggle:!0});return n.createElement=this.parent.createElement,n.appendTo(this.parent.createElement("button",{id:e+"_"+t,attrs:{"aria-label":i,type:"button"}})),r&&n.element.addEventListener("click",this.toggleBtnClicked.bind(this)),n.element},o.prototype.datavalidationDDB=function(e){var t=this,i=this.parent.serviceLocator.getService(fe),r;return this.datavalidationDdb=new Or({cssClass:"e-datavalidation-ddb",iconCss:"e-datavalidation-icon e-icons",content:i.getConstant("DataValidation"),items:[{text:i.getConstant("DataValidation")},{text:i.getConstant("HighlightInvalidData")},{text:i.getConstant("ClearHighlight")},{text:i.getConstant("ClearValidation")}],createPopupOnClick:!0,beforeOpen:function(n){t.refreshSelected(t.datavalidationDdb,n.element,"iconCss"),n.element.setAttribute("aria-label",i.getConstant("DataValidation"))},select:function(n){switch(n.item.text){case i.getConstant("DataValidation"):t.parent.notify(pI,null);break;case i.getConstant("HighlightInvalidData"):t.parent.notify(Hf,{});break;case i.getConstant("ClearHighlight"):t.parent.notify(Hf,{isRemoveHighlight:!0});break;case i.getConstant("ClearValidation"):t.parent.notify(Vf,{isAction:!0});break;default:r=n.item.text===i.getConstant("SortAscending")?"Ascending":"Descending",t.parent.notify(Mu,{sortOptions:{sortDescriptors:{order:r}}});break}t.datavalidationDdb.element.setAttribute("aria-label",n.item.text)}}),this.datavalidationDdb.createElement=this.parent.createElement,this.datavalidationDdb.appendTo(this.parent.createElement("button",{id:e+"_datavalidation",attrs:{type:"button"},className:"e-ss-ddb"})),this.datavalidationDdb.element},o.prototype.getTextAlignDDB=function(e){var t=this,i=this.parent.serviceLocator.getService(fe);return this.textAlignDdb=new Or({cssClass:"e-align-ddb",iconCss:"e-icons e-left-icon",items:[{iconCss:"e-icons e-left-icon"},{iconCss:"e-icons e-center-icon"},{iconCss:"e-icons e-right-icon"}],beforeItemRender:this.alignItemRender.bind(this),createPopupOnClick:!0,beforeOpen:function(r){t.refreshSelected(t.textAlignDdb,r.element,"iconCss"),r.element.setAttribute("aria-label",i.getConstant("HorizontalAlignment"))},select:function(r){var n={style:{textAlign:r.item.iconCss.split(" e-")[1].split("-icon")[0]},onActionUpdate:!0};t.parent.notify(rr,n),n.cancel||(t.textAlignDdb.iconCss="e-icons e-"+n.style.textAlign+"-icon",t.textAlignDdb.dataBind()),t.textAlignDdb.element.setAttribute("aria-label",i.getConstant("HorizontalAlignment")+" "+i.getConstant("Align"+t.getAlignText(r)))}}),this.textAlignDdb.createElement=this.parent.createElement,this.textAlignDdb.appendTo(this.parent.createElement("button",{id:e+"_text_align",attrs:{type:"button"},className:"e-ss-ddb"})),this.textAlignDdb.element},o.prototype.getVerticalAlignDDB=function(e){var t=this,i=this.parent.serviceLocator.getService(fe);return this.verticalAlignDdb=new Or({cssClass:"e-align-ddb",iconCss:"e-icons e-bottom-icon",items:[{iconCss:"e-icons e-top-icon"},{iconCss:"e-icons e-middle-icon"},{iconCss:"e-icons e-bottom-icon"}],beforeItemRender:this.alignItemRender.bind(this),createPopupOnClick:!0,beforeOpen:function(r){t.refreshSelected(t.verticalAlignDdb,r.element,"iconCss"),r.element.setAttribute("aria-label",i.getConstant("VerticalAlignment"))},select:function(r){var n={style:{verticalAlign:r.item.iconCss.split(" e-")[1].split("-icon")[0]},onActionUpdate:!0};t.parent.notify(rr,n),n.cancel||(t.verticalAlignDdb.iconCss="e-icons e-"+n.style.verticalAlign+"-icon",t.verticalAlignDdb.dataBind()),t.verticalAlignDdb.element.setAttribute("aria-label",i.getConstant("VerticalAlignment")+" "+i.getConstant("Align"+t.getAlignText(r)))}}),this.verticalAlignDdb.createElement=this.parent.createElement,this.verticalAlignDdb.appendTo(this.parent.createElement("button",{id:e+"_vertical_align",attrs:{type:"button"},className:"e-ss-ddb"})),this.verticalAlignDdb.element},o.prototype.getMergeSplitBtn=function(e){var t=this;this.parent.element.appendChild(this.parent.createElement("button",{id:e+"_merge",attrs:{type:"button"}}));var i=this.parent.serviceLocator.getService(fe);return this.mergeSplitBtn=new Sp({cssClass:"e-merge-ddb",iconCss:"e-icons e-merge-icon",createPopupOnClick:!0,items:[{text:i.getConstant("MergeAll"),id:e+"_merge_all"},{text:i.getConstant("MergeHorizontally"),id:e+"_merge_horizontally"},{text:i.getConstant("MergeVertically"),id:e+"_merge_vertically"},{separator:!0,id:e+"_merge_separator"},{text:i.getConstant("Unmerge"),id:e+"_unmerge"}],select:this.mergeSelectHandler.bind(this),click:function(r){r.element.setAttribute("aria-label",i.getConstant("MergeCells")),r.element.classList.contains("e-active")?t.unMerge():t.merge(t.parent.element.id+"_merge_all")},created:function(){var r=i.getConstant("MergeCells");t.mergeSplitBtn.element.title=r,t.mergeSplitBtn.element.setAttribute("aria-label",r),t.mergeSplitBtn.element.nextElementSibling.title=i.getConstant("SelectMergeType")},beforeOpen:function(r){return r.element.setAttribute("aria-label",i.getConstant("MergeCells"))}}),this.mergeSplitBtn.createElement=this.parent.createElement,this.mergeSplitBtn.appendTo("#"+e+"_merge"),this.mergeSplitBtn.element.parentElement},o.prototype.mergeSelectHandler=function(e){e.item.id===this.parent.element.id+"_unmerge"?this.unMerge():this.merge(e.item.id),this.mergeSplitBtn.element.setAttribute("aria-label",e.item.text)},o.prototype.unMerge=function(e){var t=this.parent.getActiveSheet(),i=tt(J(t.selectedRange));if(qi(this.parent,i)){this.parent.notify(nr,null);return}this.parent.showSpinner();for(var r=t.selectedRange,n=[],s=i[0];s<=i[2];s++)for(var a=i[1];a<=i[3];a++){var l=G(s,a,t);if(l&&(l.rowSpan>1||l.colSpan>1)){var h={range:[s,a,s,a]};this.parent.notify(Do,h),n.push(h.range)}}var u={merge:!1,range:e&&e.range||r,isAction:!0,refreshRibbon:!0,type:"All"};n.length>0&&(u.mergeCollection=n),this.parent.notify(Mn,u),this.toggleActiveState(!1),this.parent.hideSpinner()},o.prototype.merge=function(e){var t=this,i=this.parent.getActiveSheet(),r=J(i.selectedRange),n;if(qi(this.parent,tt(r))){this.parent.notify(nr,null);return}for(var s,a=e.includes("merge_all"),l=r[0];l<=r[2];l++)for(var h=r[1];h<=r[3];h++)l===r[0]&&h===r[1]&&a||l===r[0]&&e.includes("merge_vertically")||h===r[1]&&e.includes("_merge_horizontally")||(n=G(l,h,i)||{},(n.value||n.formula)&&(s=!0));if(!s){this.performMerge(e),a&&this.toggleActiveState(!0);return}var u=this.parent.serviceLocator.getService(jt);u.show({height:200,width:400,isModal:!0,showCloseIcon:!0,cssClass:"e-merge-alert-dlg",content:this.parent.serviceLocator.getService(fe).getConstant("MergeCellsAlert"),beforeOpen:function(c){var d={dialogName:"MergeAlertDialog",element:c.element,target:c.target,cancel:c.cancel};t.parent.trigger("dialogBeforeOpen",d),d.cancel?c.cancel=!0:Fe(t.parent.element)},buttons:[{buttonModel:{content:this.parent.serviceLocator.getService(fe).getConstant("Ok"),isPrimary:!0},click:function(){u.hide(),t.performMerge(e),a&&t.toggleActiveState(!0)}}]})},o.prototype.performMerge=function(e){var t=this.parent.element.id;switch(this.parent.showSpinner(),e){case t+"_merge_all":this.parent.notify(Mn,{merge:!0,range:this.parent.getActiveSheet().selectedRange,type:"All",isAction:!0,refreshRibbon:!0});break;case t+"_merge_horizontally":this.parent.notify(Mn,{merge:!0,range:this.parent.getActiveSheet().selectedRange,type:"Horizontally",isAction:!0});break;case t+"_merge_vertically":this.parent.notify(Mn,{merge:!0,range:this.parent.getActiveSheet().selectedRange,type:"Vertically",isAction:!0});break}this.parent.hideSpinner()},o.prototype.getSortFilterDDB=function(e){var t=this,i=this.parent.serviceLocator.getService(fe),r;return this.sortingDdb=new Or({cssClass:"e-sort-filter-ddb",iconCss:"e-icons e-sort-filter-icon",items:[{text:i.getConstant("SortAscending"),iconCss:"e-icons e-sort-asc"},{text:i.getConstant("SortDescending"),iconCss:"e-icons e-sort-desc"},{text:i.getConstant("CustomSort")+"...",iconCss:"e-icons e-sort-custom"},{separator:!0},{text:i.getConstant("Filter"),iconCss:"e-icons e-filter-apply",id:e+"_applyfilter"},{text:i.getConstant("ClearAllFilter"),iconCss:"e-icons e-filter-clear",id:e+"_clearfilter"},{text:i.getConstant("ReapplyFilter"),iconCss:"e-icons e-filter-reapply",id:e+"_reapplyfilter"}],createPopupOnClick:!0,beforeItemRender:function(n){var s={isFiltered:!1,isClearAll:!0};t.parent.notify(tb,s),!t.parent.allowSorting&&(n.item.text===i.getConstant("SortAscending")||n.item.text===i.getConstant("SortDescending")||n.item.text===i.getConstant("CustomSort")+"...")&&n.element.classList.add("e-disabled"),!t.parent.allowFiltering&&n.item.text===i.getConstant("Filter")&&n.element.classList.add("e-disabled"),(n.item.id===e+"_clearfilter"||n.item.id===e+"_reapplyfilter")&&(s.isFiltered?n.element.classList.remove("e-disabled"):n.element.classList.add("e-disabled"))},beforeOpen:function(n){t.refreshSelected(t.sortingDdb,n.element,"iconCss"),n.element.setAttribute("aria-label",t.parent.serviceLocator.getService(fe).getConstant("SortAndFilter"))},select:function(n){var s=[];if(n.item.text===i.getConstant("SortAscending")||n.item.text===i.getConstant("SortDescending")||n.item.text===i.getConstant("CustomSort")+"..."){var a=J(t.parent.getActiveSheet().selectedRange),l=wb(a[0],a[1],t.parent.getActiveSheet());if(qi(t.parent,l)){t.parent.notify(nr,null);return}}switch(n.item.text){case i.getConstant("Filter"):t.parent.notify(Eo,{});break;case i.getConstant("ClearAllFilter"):t.parent.notify(jf,{isAction:!0});break;case i.getConstant("ReapplyFilter"):t.parent.notify(eb,null);break;case i.getConstant("CustomSort")+"...":t.parent.notify(Gy,null);break;default:if(r=n.item.text===i.getConstant("SortAscending")?"Ascending":"Descending",t.parent.sortCollection)for(var h=t.parent.sortCollection.length-1;h>=0;h--)t.parent.sortCollection[h]&&t.parent.sortCollection[h].sheetIndex===t.parent.activeSheetIndex&&(s.push(t.parent.sortCollection[h]),t.parent.sortCollection.splice(h,1));t.parent.notify(mu,{sortOptions:{sortDescriptors:{order:r}}}),t.parent.notify(Mu,{sortOptions:{sortDescriptors:{order:r}},previousSort:s});break}t.sortingDdb.element.setAttribute("aria-label",n.item.text)}}),this.sortingDdb.createElement=this.parent.createElement,this.sortingDdb.appendTo(this.parent.createElement("button",{id:e+"_sorting",attrs:{type:"button"},className:"e-ss-ddb"})),this.sortingDdb.element},o.prototype.getFindBtn=function(e){var t=this,i=this.parent.createElement("button",{id:e+"_findbtn",attrs:{type:"button","aria-label":this.parent.serviceLocator.getService(fe).getConstant("FindReplaceTooltip")}});return this.findDdb=new bn({cssClass:"e-spreadsheet-find-ddb e-flat",iconCss:"e-icons e-search-icon"}),this.findDdb.createElement=this.parent.createElement,this.findDdb.appendTo(i),i.onclick=function(r){t.parent.notify(du,{event:r})},this.findDdb.element},o.prototype.getClearDDB=function(e){var t=this,i=this.parent.serviceLocator.getService(fe);return this.clearDdb=new Or({cssClass:"e-clear-ddb",iconCss:"e-icons e-clear-icon",items:[{text:i.getConstant("ClearAll"),id:e+"_Clear All"},{text:i.getConstant("ClearFormats"),id:e+"_Clear Formats"},{text:i.getConstant("ClearContents"),id:e+"_Clear Contents"},{text:i.getConstant("ClearHyperlinks"),id:e+"_Clear Hyperlinks"}],createPopupOnClick:!0,beforeOpen:function(r){r.element.setAttribute("aria-label",t.parent.serviceLocator.getService(fe).getConstant("Clear"))},beforeItemRender:function(r){var n=t.parent.getActiveSheet(),s=tt(J(n.selectedRange));n.isProtected&&n.protectSettings.formatCells&&r.item.id!==e+"_Clear Formats"&&(r.item.id===e+"_Clear Hyperlinks"||ko(t.parent,s))&&(r.element.classList.add("e-disabled"),r.element.setAttribute("aria-disabled","true"))},select:function(r){t.parent.notify(_f,{options:{type:r.item.id.replace(e+"_","")},isAction:!0}),t.clearDdb.element.setAttribute("aria-label",r.item.text)}}),this.clearDdb.createElement=this.parent.createElement,this.clearDdb.appendTo(this.parent.createElement("button",{id:e+"_clear",attrs:{type:"button"},className:"e-ss-ddb"})),this.clearDdb.element},o.prototype.ribbonCreated=function(){var e=this.parent.serviceLocator.getService(fe).getConstant("CollapseToolbar");Ie(this.ribbon.element.querySelector(".e-drop-icon"),{role:"button",tabindex:"-1",title:e,"aria-label":e}),this.ribbon.toolbarObj&&(this.ribbon.toolbarObj.allowKeyboard=this.parent.enableKeyboardNavigation,this.ribbon.toolbarObj.dataBind())},o.prototype.alignItemRender=function(e){e.element.title=this.parent.serviceLocator.getService(fe).getConstant("Align"+this.getAlignText(e))},o.prototype.getAlignText=function(e){var t=e.item.iconCss.split(" e-")[1].split("-icon")[0];return t[0].toUpperCase()+t.slice(1,t.length)},o.prototype.toggleBtnClicked=function(e){var t=j(e.target,".e-btn"),i=this.parent.element.id,r=t.id,n=rr,s,a,l,h,u;switch(r){case i+"_bold":a={fontWeight:"normal"},l={fontWeight:"bold"},u="fontWeight";break;case i+"_italic":a={fontStyle:"normal"},l={fontStyle:"italic"},u="fontStyle";break;case i+"_line-through":n=nd,a={textDecoration:"line-through"},l=a,u="textDecoration";break;case i+"_underline":n=nd,a={textDecoration:"underline"},l=a,u="textDecoration";break}t.classList.contains("e-active")?(s=l[""+u],h={style:l,onActionUpdate:!0},this.parent.notify(n,h),h.cancel&&t.classList.remove("e-active")):(s=a[""+u],h={style:a,onActionUpdate:!0},this.parent.notify(n,h),h.cancel&&t.classList.add("e-active")),!h.cancel&&s!==h.style[""+u]&&this.refreshToggleBtn(Se(this.parent.getActiveSheet().activeCell))},o.prototype.getCellStyleValue=function(e,t){var i=G(t[0],t[1],this.parent.getActiveSheet()),r=this.parent.cellStyle[""+e];return i&&i.style&&i.style[""+e]&&(r=i.style[""+e]),r},o.prototype.refreshSelected=function(e,t,i,r){r===void 0&&(r=i);for(var n=0;n<e.items.length;n++)if(e.items[n][""+r]===e[""+i]){t.children[n].classList.add("e-selected");break}},o.prototype.expandCollapseHandler=function(e){var t=this.ribbon.element.querySelector(".e-drop-icon"),i=this.parent.serviceLocator.getService(fe);e.expanded?(t.title=i.getConstant("CollapseToolbar"),t.setAttribute("aria-label",i.getConstant("ExpandToolbar"))):(t.title=i.getConstant("ExpandToolbar"),t.setAttribute("aria-label",i.getConstant("CollapseToolbar"))),this.parent.setPanelSize()},o.prototype.getChartThemeDdbItems=function(e){var t=this.parent.serviceLocator.getService(fe),i=[],r=["Material","Fabric","Bootstrap","HighContrastLight","MaterialDark","FabricDark","HighContrast","BootstrapDark","Bootstrap4","Bootstrap5Dark","Bootstrap5","TailwindDark","Tailwind","Tailwind3","Tailwind3Dark","FluentDark","Fluent","Fluent2","Fluent2Dark","Material3","Material3Dark"];return r.forEach(function(n){i.push({id:n,text:t.getConstant(n),iconCss:n===e?"e-icons e-selected-icon":""})}),i},o.prototype.getNumFormatDdbItems=function(e){var t=this.parent.serviceLocator.getService(fe);return[{id:e+"_General",text:t.getConstant("General")},{id:e+"_Number",text:t.getConstant("Number")},{id:e+"_Currency",text:t.getConstant("Currency")},{id:e+"_Accounting",text:t.getConstant("Accounting")},{id:e+"_ShortDate",text:t.getConstant("ShortDate")},{id:e+"_LongDate",text:t.getConstant("LongDate")},{id:e+"_Time",text:t.getConstant("Time")},{id:e+"_Percentage",text:t.getConstant("Percentage")},{id:e+"_Fraction",text:t.getConstant("Fraction")},{id:e+"_Scientific",text:t.getConstant("Scientific")},{id:e+"_Text",text:t.getConstant("Text")},{id:e+"_Custom",text:t.getConstant("Custom")}]},o.prototype.getFontFamilyItems=function(){return[{text:"Arial"},{text:"Arial Black"},{text:"Axettac Demo"},{text:"Batang"},{text:"Book Antiqua"},{text:"Calibri",iconCss:"e-icons e-selected-icon"},{text:"Comic Sans MS"},{text:"Courier"},{text:"Courier New"},{text:"Din Condensed"},{text:"Georgia"},{text:"Helvetica"},{text:"Helvetica New"},{text:"Roboto"},{text:"Tahoma"},{text:"Times New Roman"},{text:"Verdana"}]},o.prototype.applyNumFormat=function(e){var t=this.parent.getActiveSheet(),i={format:e,range:t.selectedRange,cancel:!1,requestType:"NumberFormat"},r={range:t.name+"!"+i.range,format:i.format,requestType:"NumberFormat"},n=qi(this.parent,tt(J(i.range)));return!n&&(this.parent.trigger("beforeCellFormat",i),this.parent.notify(ai,{eventArgs:i,action:"format"}),i.cancel)||(this.parent.notify(wf,i),this.parent.notify(pa,{type:"mousedown"}),n||this.parent.notify(mt,{eventArgs:r,action:"format"})),i.format},o.prototype.renderCustomFormatDialog=function(e,t){var i=this,r=this.parent.serviceLocator.getService(fe),n=this.parent.createElement("div"),s=this.parent.createElement("div",{className:"e-custom-dialog"}),a=this.parent.createElement("button",{className:"e-btn",attrs:{type:"button"}});a.innerText=r.getConstant("Apply");var l=this.parent.createElement("div",{className:"e-custom-sample"});l.innerText=r.getConstant("CustomFormatTypeList")+":";var h=this.parent.createElement("div",{className:"e-input-button"}),u=this.parent.createElement("input",{className:"e-input e-dialog-input",attrs:{type:"text",name:"input",spellcheck:"false",placeholder:r.getConstant("CustomFormatPlaceholder")}}),c=this.parent.createElement("div",{className:"e-custom-listview"}),d=this.parent.serviceLocator.getService(jt),p=new yp({dataSource:t,select:function(b){u.value=b.item.textContent,b.event&&b.event.type==="keydown"&&b.item&&b.item.focus()}});if(h.appendChild(u),h.appendChild(a),s.appendChild(h),s.appendChild(l),s.appendChild(c),p.appendTo(c),t[4]!==e[4])for(var f=p.element.getElementsByClassName("e-list-text"),v=0,m=f.length;v<m;v++)f[v].textContent!==t[v]&&(f[v].textContent=t[v]);var y=function(){var b=u.value,w=t.indexOf(b),I;w>-1?I=e[w]:I=rq(i.parent,b),I=i.applyNumFormat(I),I&&(i.refreshNumFormatSelection(Er(I,!0),i.parent.getActiveSheet(),r,I),i.parent.notify(dd,{action:"addToCustomFormats",format:b,defaultFormat:I})),d.hide(),i.parent.showAggregate&&i.parent.notify(yl,{})};a.addEventListener("click",y);var S=function(){var b=p.getSelectedItems();b&&p.unselectItem()};u.addEventListener("input",S),d.show({header:r.getConstant("CustomFormat"),cssClass:"e-custom-format-dlg",height:this.parent.cssClass.indexOf("e-bigger")>-1?502:480,width:440,isModal:!0,showCloseIcon:!0,content:s,footerTemplate:n,beforeOpen:function(b){var w={dialogName:"CustomNumberFormatDlg",element:b.element,target:b.target,cancel:b.cancel};if(i.parent.trigger("dialogBeforeOpen",w),w.cancel)b.cancel=!0;else{var I=i.parent.getActiveSheet(),x=Se(I.activeCell),M=G(x[0],x[1],I);if(M&&M.format){var D=e.indexOf(M.format);p.selectItem(p.element.getElementsByClassName("e-list-item")[D])}Fe(i.parent.element)}}})},o.prototype.tBarDdbBeforeOpen=function(e,t,i,r){r===void 0&&(r=0);var n=this.parent.viewport.height,s=parseInt(getComputedStyle(e.firstElementChild).height,10)*(t.length-r)+parseInt(getComputedStyle(e).paddingTop,10)*2;if(r){var a=getComputedStyle(e.querySelector(".e-separator"));s+=r*(parseInt(a.borderBottomWidth,10)+parseInt(a.marginTop,10)*2)}s>n?(e.style.height=n+"px",e.style.overflowY="auto"):e.style.height&&(e.style.height="",e.style.overflowY=""),e.setAttribute("aria-label",i)},o.prototype.numDDBOpen=function(e){this.numPopupWidth=0;for(var t=e.element.querySelectorAll("span.e-numformat-preview-text"),i=0,r=t.length;i<r;i++)this.numPopupWidth<t[i].offsetWidth&&(this.numPopupWidth=t[i].offsetWidth);var n=this.numPopupWidth+160;document.querySelector(".e-numformat-ddb.e-dropdown-popup").style.width=n+"px"},o.prototype.previewNumFormat=function(e){if(!e.item.id.includes("_Custom")){var t=this.parent.createElement("div",{className:"e-numformat-text",styles:"width:100%",innerHTML:e.element.innerHTML});e.element.innerHTML="";var i=this.parent.getActiveSheet(),r=Se(i.activeCell),n=G(r[0],r[1],i,!1,!0);if(!g(n.value)||n.value!==""){var s=hr(e.item.id.split(this.parent.element.id+"_")[1]),a={type:e.item.text,formattedText:"",value:n.value,format:s,cell:{value:n.value,format:s},skipFormatCheck:cs(this.parent)};this.parent.notify(en,a);var l=this.parent.createElement("span",{className:"e-numformat-preview-text",styles:"float:right;"});l.innerText=a.formattedText,t.appendChild(l)}e.element.appendChild(t)}},o.prototype.refreshRibbonContent=function(e){if(this.ribbon){g(e)&&(e=this.ribbon.selectedTab);var t=this.parent.serviceLocator.getService(fe),i=this.parent.getActiveSheet(),r=Se(i.activeCell);switch(this.ribbon.items[e].header.text){case t.getConstant("Home"):this.refreshHomeTabContent(r);break;case t.getConstant("Insert"):{i.isProtected&&(i.protectSettings.insertLink&&!un(G(r[0],r[1],i),Rt(i,r[1]))?this.enableToolbarItems([{tab:t.getConstant("Insert"),items:[this.parent.element.id+"_hyperlink"],enable:!0}]):this.enableToolbarItems([{tab:t.getConstant("Insert"),items:[this.parent.element.id+"_hyperlink"],enable:!1}]));break}case t.getConstant("Formulas"):i.isProtected&&(un(G(r[0],r[1],i),Rt(i,r[1]))?this.enableToolbarItems([{tab:t.getConstant("Formulas"),items:[this.parent.element.id+"_insert_function"],enable:!1}]):this.enableToolbarItems([{tab:t.getConstant("Formulas"),items:[this.parent.element.id+"_insert_function"],enable:!0}]));break;case t.getConstant("Data"):this.refreshDataTabContent(e);break;case t.getConstant("View"):this.refreshViewTabContent(e);break}}},o.prototype.refreshHomeTabContent=function(e){g(document.getElementById(this.parent.element.id+"_number_format"))||(this.numFormatDDB=at(document.getElementById(this.parent.element.id+"_number_format"),Or));var t=this.parent.getActiveSheet(),i=Se(t.activeCell),r=this.parent.serviceLocator.getService(fe),n=G(i[0],i[1],t,!1,!0),s=Er(n.format||"General",!0);if(this.refreshNumFormatSelection(s,t,r,n.format),t.isProtected&&this.parent.enableClipboard&&this.parent.clipboardModule.copiedInfo&&this.parent.notify(da,[{items:[this.parent.element.id+"_paste"],enable:!un(n,Rt(t,i[1]))}]),this.fontNameDdb&&(t.isProtected&&!t.protectSettings.formatCells?this.refreshFontNameSelection("Calibri"):this.refreshFontNameSelection(this.getCellStyleValue("fontFamily",e))),this.fontSizeDdb){var a=this.getCellStyleValue("fontSize",e);t.isProtected&&!t.protectSettings.formatCells?this.fontSizeDdb.content="11":(a=a.includes("pt")?a.split("pt")[0]:"11",a!==this.fontSizeDdb.content&&(this.fontSizeDdb.content=a,this.fontSizeDdb.dataBind()))}if(this.refreshTextAlign(t,n,s,e),this.verticalAlignDdb){var a="e-icons e-"+this.getCellStyleValue("verticalAlign",e).toLowerCase()+"-icon";t.isProtected&&!t.protectSettings.formatCells?this.verticalAlignDdb.iconCss="e-icons e-bottom-icon":a!==this.verticalAlignDdb.iconCss&&(this.verticalAlignDdb.iconCss=a,this.verticalAlignDdb.dataBind())}if(this.refreshToggleBtn(e),!t.isProtected&&(n.rowSpan>1||n.colSpan>1))this.enableToolbarItems([{tab:r.getConstant("Home"),items:[this.parent.element.id+"_merge_cells"],enable:!0}]),this.toggleActiveState(!0);else{var l=J(t.selectedRange);this.enableToolbarItems([{tab:r.getConstant("Home"),items:[this.parent.element.id+"_merge_cells"],enable:l[0]!==l[2]||l[1]!==l[3]}]),this.toggleActiveState(!1)}},o.prototype.refreshTextAlign=function(e,t,i,r){if(this.textAlignDdb){var n=this.getCellStyleValue("textAlign",r);if(e.isProtected&&!e.protectSettings.formatCells)this.textAlignDdb.iconCss="e-icons e-left-icon";else{t.value!==void 0&&n==="left"&&(i==="Accounting"||Me(t.value)&&i!=="Text")&&(n="right");var s="e-icons e-"+n.toLowerCase()+"-icon";s!==this.textAlignDdb.iconCss&&(this.textAlignDdb.iconCss=s,this.textAlignDdb.dataBind())}}},o.prototype.toggleActiveState=function(e){var t=this.parent.serviceLocator.getService(fe);this.parent.getActiveSheet().isProtected||(e?this.mergeSplitBtn.element.classList.contains("e-active")||(this.mergeSplitBtn.element.classList.add("e-active"),this.mergeSplitBtn.element.title=t.getConstant("UnmergeCells")):this.mergeSplitBtn.element.classList.contains("e-active")&&(this.mergeSplitBtn.element.classList.remove("e-active"),this.mergeSplitBtn.element.title=t.getConstant("MergeCells")))},o.prototype.refreshToggleBtn=function(e){var t=this,i=this.parent.getActiveSheet(),r,n=this.parent.element.id,s,a,l=G(e[0],e[1],i),h=["fontWeight","fontStyle","textDecoration","textDecoration"];["bold","italic","line-through","underline","wrap"].forEach(function(u,c){r=document.getElementById(n+"_"+u),r&&(a=!1,(!i.isProtected||i.protectSettings.formatCells)&&(u==="wrap"?a=t.parent.allowWrap&&l&&l.wrap:t.parent.allowCellFormatting&&(s=t.getCellStyleValue(h[c],e).toLowerCase(),a=s.indexOf(u)>-1)),a?r.classList.add("e-active"):r.classList.contains("e-active")&&r.classList.remove("e-active"))})},o.prototype.refreshFontNameSelection=function(e){e=e.split('"').join(""),this.fontNameDdb.element.firstElementChild.textContent=e;for(var t=0;t<this.fontNameDdb.items.length;t++)if(this.fontNameDdb.items[t].text===e){this.fontNameDdb.items[t].iconCss="e-icons e-selected-icon",t!==this.fontNameIndex&&(this.fontNameDdb.items[this.fontNameIndex].iconCss=""),this.fontNameDdb.setProperties({items:this.fontNameDdb.items},!0),this.fontNameIndex=t;break}["Arial","Arial Black","Axettac Demo","Batang","Book Antiqua","Calibri","Comic Sans MS","Courier","Courier New","Din Condensed","Georgia","Helvetica","Helvetica New","Roboto","Tahoma","Times New Roman","Verdana"].indexOf(e)<0&&(this.fontNameDdb.items[this.fontNameIndex].iconCss=""),this.fontNameDdb.element.setAttribute("aria-label",e)},o.prototype.refreshNumFormatSelection=function(e,t,i,r){if(this.numFormatDDB){t.isProtected&&!t.protectSettings.formatCells?e="General":(r&&e==="General"&&r!=="General"&&(e="Custom"),e=i.getConstant(e));for(var n=0;n<this.numFormatDDB.items.length;n++)this.numFormatDDB.items[n].iconCss!==""&&(this.numFormatDDB.items[n].iconCss=""),this.numFormatDDB.items[n].text===e&&(this.numFormatDDB.items[n].iconCss="e-icons e-selected-icon");this.numFormatDDB.element.firstElementChild.textContent=e,this.numFormatDDB.setProperties({items:this.numFormatDDB.items},!0),this.numFormatDDB.element.setAttribute("aria-label",e)}},o.prototype.fileMenuItemSelect=function(e){var t=this,i=he({cancel:!1},e);this.parent.trigger("fileMenuItemSelect",i);var r=this.parent.element.id,n;if(!i.cancel)switch(e.item.id){case r+"_Print":this.parent.print();break;case r+"_Open":X("#"+r+"_fileUpload",this.parent.element).click(),Fe(this.parent.element);break;case r+"_Xlsx":case r+"_Xls":case r+"_Csv":case r+"_Pdf":this.parent.notify(Sf,e);break;case r+"_New":n=this.parent.serviceLocator.getService(jt),n.show({height:200,width:400,isModal:!0,showCloseIcon:!0,content:this.parent.serviceLocator.getService(fe).getConstant("DestroyAlert"),beforeOpen:function(s){var a={dialogName:"DestroySheetDialog",element:s.element,target:s.target,cancel:s.cancel};t.parent.trigger("dialogBeforeOpen",a),a.cancel?s.cancel=!0:Fe(t.parent.element)},buttons:[{buttonModel:{content:this.parent.serviceLocator.getService(fe).getConstant("Ok"),isPrimary:!0},click:function(){n.hide(),t.parent.refresh(!0)}}]});break}},o.prototype.toolbarClicked=function(e){if(e.item&&e.item.id!=="spreadsheet_find"){var t=this.parent.element.id,i=this.parent.getActiveSheet(),r=void 0,n=void 0,s=void 0,a=void 0;switch(e.item.id){case t+"_headers":if(r={isShow:!i.showHeaders,sheetIdx:this.parent.activeSheetIndex,cancel:!1},this.parent.notify(mt,{eventArgs:r,action:"headers"}),r.cancel)return;this.parent.setSheetPropertyOnMute(i,"showHeaders",!i.showHeaders),this.parent.serviceLocator.getService("sheet").showHideHeaders(),this.toggleRibbonItems({props:"Headers",activeTab:this.ribbon.selectedTab});break;case t+"_gridlines":if(n={isShow:!i.showGridLines,sheetIdx:this.parent.activeSheetIndex,cancel:!1},this.parent.notify(mt,{eventArgs:n,action:"gridLines"}),n.cancel)return;this.parent.setSheetPropertyOnMute(i,"showGridLines",!i.showGridLines),this.toggleRibbonItems({props:"GridLines",activeTab:this.ribbon.selectedTab});break;case t+"_protect":this.parent.notify(yb,{});break;case t+"_undo":this.parent.notify(Ka,{isUndo:!0});break;case t+"_redo":this.parent.notify(Ka,{isUndo:!1});break;case t+"_freezepanes":s=Se(i.topLeftCell),a=i.frozenRows||i.frozenColumns?s:Se(i.activeCell),this.parent.notify(vf,{row:a[0]-s[0],column:a[1]-s[1],triggerEvent:!0});break;case t+"_freezerows":this.parent.notify(vf,{row:i.frozenRows?0:Se(i.activeCell)[0]-Se(i.topLeftCell)[0],column:i.frozenColumns,triggerEvent:!0});break;case t+"_freezecolumns":this.parent.notify(vf,{row:i.frozenRows,column:i.frozenColumns?0:Se(i.activeCell)[1]-Se(i.topLeftCell)[1],triggerEvent:!0});break;case t+"_protectworkbook":this.parent.password.length>0?this.parent.notify(pb,null):this.parent.isProtected?(this.parent.isProtected=!1,this.parent.showSheetTabs&&(this.parent.element.querySelector(".e-add-sheet-tab").removeAttribute("disabled"),this.parent.element.querySelector(".e-add-sheet-tab").classList.remove("e-disabled")),this.toggleRibbonItems({props:"Protectworkbook",activeTab:this.ribbon.selectedTab}),this.parent.notify(mt,{action:"protectWorkbook",eventArgs:{isProtected:!1}})):this.parent.element.querySelector(".e-add-sheet-tab").classList.contains("e-disabled")?this.toggleRibbonItems({props:"Protectworkbook",activeTab:this.ribbon.selectedTab}):this.parent.notify(db,null);break}this.parent.notify(Of,e)}},o.prototype.toggleRibbonItems=function(e){var t="",i=this.parent.serviceLocator.getService(fe).getConstant("View"),r=this.parent.serviceLocator.getService(fe).getConstant("Data");if(this.ribbon.items[this.ribbon.selectedTab].header.text===i){if(g(e.activeTab)){for(var n=0,s=this.ribbon.items.length;n<s;n++)if(this.ribbon.items[n].header.text===i){e.activeTab=n;break}}var a=this.getLocaleText(e.props);e.props==="GridLines"&&this.parent.serviceLocator.getService("sheet").toggleGridlines();for(var l=this.parent.element.id+"_"+e.props.toLowerCase(),h=this.ribbon.items[e.activeTab].content.length,n=void 0;n<h;n++)this.ribbon.items[e.activeTab].content[n].type!=="Separator"&&this.ribbon.items[e.activeTab].content[n].id===l&&(this.ribbon.items[e.activeTab].content[n].text=a,this.ribbon.setProperties({items:this.ribbon.items},!0));this.ribbon.items[this.ribbon.selectedTab].header.text===i&&e.props!=="Protect"&&this.updateToggleText(e.props.toLowerCase(),a)}if(this.ribbon.items[this.ribbon.selectedTab].header.text===r){if(g(e.activeTab)){for(var n=0,u=this.ribbon.items.length;n<u;n++)if(this.ribbon.items[n].header.text===r){e.activeTab=n;break}}var l=this.parent.element.id+"_"+e.props.toLowerCase();if(l===this.parent.element.id+"_protect"){var c=this.ribbon.items[this.ribbon.selectedTab].content.length,d=void 0;for(d=0;d<c&&this.ribbon.items[this.ribbon.selectedTab].content[d].id!==this.parent.element.id+"_protect";d++);t=this.getLocaleProtectText("Sheet",!0)}else if(l===this.parent.element.id+"_protectworkbook"){var p=this.ribbon.items[this.ribbon.selectedTab].content.length,d=void 0;for(d=0;d<p&&this.ribbon.items[this.ribbon.selectedTab].content[d].id!==this.parent.element.id+"_protectworkbook";d++);this.parent.isProtected||this.parent.password.length>0?t=this.getLocaleProtectWorkbook("UnprotectWorkbook"):this.parent.isProtected||(t=this.getLocaleProtectWorkbook("ProtectWorkbook"))}for(var h=this.ribbon.items[e.activeTab].content.length,n=void 0;n<h;n++)this.ribbon.items[e.activeTab].content[n].type!=="Separator"&&this.ribbon.items[e.activeTab].content[n].id===l&&(this.ribbon.items[e.activeTab].content[n].text=t,this.ribbon.setProperties({items:this.ribbon.items},!0));this.ribbon.items[this.ribbon.selectedTab].header.text===r&&this.updateToggleText(e.props.toLowerCase(),t)}},o.prototype.enableFileMenuItems=function(e){this.ribbon.enableMenuItems(e.items,e.enable,e.isUniqueId)},o.prototype.hideRibbonTabs=function(e){this.ribbon.hideTabs(e.tabs,e.hide)},o.prototype.addRibbonTabs=function(e){this.ribbon.addTabs(e.items,e.insertBefore);var t=X(".e-ribbon .e-tab-header .e-toolbar-item:not(.e-menu-tab).e-hide",this.parent.element);t&&this.parent.updateActiveBorder(Oe(".e-ribbon .e-tab-header .e-toolbar-item:not(.e-menu-tab)",this.parent.element)[this.ribbon.selectedTab])},o.prototype.updateToggleText=function(e,t){var i=X("#"+this.parent.element.id+"_"+e+" .e-tbar-btn-text",this.ribbon.element);if(e==="protect"||e==="protectworkbook"?i.parentElement.setAttribute("aria-label",t):i.parentElement.setAttribute("aria-label",i.textContent),cr(function(){i&&(i.textContent=t)}),e==="headers"){var r=this.parent.element.getElementsByClassName("e-findtool-dlg")[0];r&&r.classList.contains("e-popup-open")&&this.parent.notify(du,{refreshPosition:!0,dialogEle:r})}},o.prototype.refreshViewTabContent=function(e){for(var t=this.parent.element.id,i=this.parent.getActiveSheet(),r=this.parent.serviceLocator.getService(fe),n,s=0;s<this.ribbon.items[e].content.length;s++)n=this.ribbon.items[e].content[s],n.type!=="Separator"&&(n.id===t+"_headers"&&this.updateViewTabContent(e,"Headers",s),n.id===t+"_gridlines"&&this.updateViewTabContent(e,"GridLines",s),n.id===t+"_freezepanes"&&(i.frozenRows||i.frozenColumns?n.text===r.getConstant("FreezePanes")&&this.updateToggleText("freezepanes",this.updateRibbonItemText("Unfreeze","Panes",s,e)):n.text===r.getConstant("UnfreezePanes")&&this.updateToggleText("freezepanes",this.updateRibbonItemText("Freeze","Panes",s,e))),n.id===t+"_freezerows"&&(i.frozenRows?n.text===r.getConstant("FreezeRows")&&this.updateToggleText("freezerows",this.updateRibbonItemText("Unfreeze","Rows",s,e)):n.text===r.getConstant("UnfreezeRows")&&this.updateToggleText("freezerows",this.updateRibbonItemText("Freeze","Rows",s,e))),n.id===t+"_freezecolumns"&&(i.frozenColumns?n.text===r.getConstant("FreezeColumns")&&this.updateToggleText("freezecolumns",this.updateRibbonItemText("Unfreeze","Columns",s,e)):n.text===r.getConstant("UnfreezeColumns")&&this.updateToggleText("freezecolumns",this.updateRibbonItemText("Freeze","Columns",s,e))))},o.prototype.updateViewTabContent=function(e,t,i){var r=this.parent.getActiveSheet(),n=this.parent.serviceLocator.getService(fe);r["show"+t]?this.ribbon.items[e].content[i].text===n.getConstant("Show"+t)&&this.updateToggleText(t.toLowerCase(),this.updateRibbonItemText("Hide",t,i,e)):this.ribbon.items[e].content[i].text===n.getConstant("Hide"+t)&&this.updateToggleText(t.toLowerCase(),this.updateRibbonItemText("Show",t,i,e))},o.prototype.updateRibbonItemText=function(e,t,i,r){var n=this.parent.serviceLocator.getService(fe),s=n.getConstant(e+t);return this.ribbon.items[r].content[i].text=s,this.ribbon.setProperties({items:this.ribbon.items},!0),s},o.prototype.refreshDataTabContent=function(e){for(var t=this.parent.element.id,i,r=0;r<this.ribbon.items[e].content.length;r++)if(this.ribbon.items[e].content[r].type!=="Separator"){if(this.ribbon.items[e].content[r].id===t+"_protect"){if(this.updateDataTabContent(e,"Sheet",r),i)break;i=!0}this.ribbon.items[e].content[r].id===t+"_protectworkbook"&&this.updateDataTabContent(e,"Workbook",r)}},o.prototype.updateDataTabContent=function(e,t,i){var r=this.parent.getActiveSheet(),n=this.parent.serviceLocator.getService(fe);if(t==="Sheet")r.isProtected?this.ribbon.items[e].content[i].text===n.getConstant("Protect"+t)&&(this.ribbon.items[e].content[i].cssClass="e-active",this.updateProtectBtn("Unprotect",t,i,e)):this.updateProtectBtn("Protect",t,i,e);else if(t==="Workbook"){var s=this.parent.serviceLocator.getService(fe);this.parent.isProtected?this.ribbon.items[e].content[i].text===s.getConstant("Protect"+t)&&this.updateToggleText("protectworkbook",this.updateRibbonItemText("Unprotect",t,i,e)):this.ribbon.items[e].content[i].text===s.getConstant("Unprotect"+t)&&this.updateToggleText("protectworkbook",this.updateRibbonItemText("Protect",t,i,e))}},o.prototype.updateProtectBtn=function(e,t,i,r){var n=this.parent.serviceLocator.getService(fe),s=n.getConstant(e+t);this.ribbon.items[r].content[i].text=s,this.ribbon.setProperties({items:this.ribbon.items},!0),this.updateToggleText("protect",s)},o.prototype.updateProtectWorkbookBtn=function(e,t,i,r){var n=this.parent.serviceLocator.getService(fe),s=n.getConstant(e);this.ribbon.items[r].content[i].text=s,this.ribbon.setProperties({items:this.ribbon.items},!0),this.updateToggleText("protectworkbook",s)},o.prototype.addToolbarItems=function(e){var t=this.parent.serviceLocator.getService(fe);this.ribbon.addToolbarItems(t.getConstant(e.tab),e.items,e.index),this.parent&&this.parent.isReact&&this.parent.portals&&this.ribbon.toolbarObj&&this.ribbon.toolbarObj.portals&&(this.parent.portals=this.parent.portals.concat(this.ribbon.toolbarObj.portals),this.parent.renderReactTemplates())},o.prototype.enableToolbarItems=function(e){var t=this;e.forEach(function(i){t.ribbon.enableItems(i.tab||t.ribbon.items[t.ribbon.selectedTab].header.text,i.items,i.enable)})},o.prototype.createMobileView=function(){var e=this,t=this.parent.element.id,i=this.parent.createElement("div",{className:"e-header-toolbar"}),r=this.parent.createElement("ul");i.appendChild(r);var n=new Hl({items:[{prefixIcon:"e-tick-icon",align:"Left",id:t+"focused_tick",cssClass:"e-focused-tick"},{template:r,align:"Right",id:t+"file_menu"}],clicked:function(s){switch(s.item.id){case t+"focused_tick":e.parent.element.classList.remove("e-mobile-focused"),e.parent.renderModule.setSheetPanelSize();break}},created:function(){var s=new Ph({cssClass:"e-mobile e-file-menu",enableRtl:!0,showItemOnClick:!0,items:e.getRibbonMenuItems(),select:e.fileMenuItemSelect.bind(e),beforeOpen:function(a){a.element.parentElement.classList.remove("e-rtl"),e.fileMenuBeforeOpen(a)},beforeClose:e.fileMenuBeforeClose.bind(e)});s.createElement=e.parent.createElement,s.appendTo(r)}});n.createElement=this.parent.createElement,n.appendTo(i),this.parent.element.insertBefore(i,this.parent.element.firstElementChild),this.renderMobileToolbar()},o.prototype.renderMobileToolbar=function(){var e=this,t=this.parent.createElement("div",{className:"e-toolbar-panel e-ribbon"}),i=this.parent.createElement("div"),r=this.parent.createElement("button",{attrs:{type:"button"}});t.appendChild(i),t.appendChild(r),t.style.display="block",this.parent.element.appendChild(t);var n=new Or({cssClass:"e-caret-hide",content:this.ribbon.items[0].header.text,items:[{text:this.ribbon.items[0].header.text},{text:this.ribbon.items[1].header.text},{text:this.ribbon.items[2].header.text},{text:this.ribbon.items[3].header.text}],createPopupOnClick:!0,select:function(a){a.item.text!==n.content&&(s.element.style.display="none",n.content=a.item.text,n.dataBind(),s.items=e.ribbon.items[n.items.indexOf(a.item)+1].content,s.width="calc(100% - "+r.getBoundingClientRect().width+"px)",s.element.style.display="",s.dataBind(),s.items[0].text=a.item.text,s.dataBind())},open:function(a){var l=a.element.parentElement,h=l.getBoundingClientRect(),u=br(n.element,"right","bottom");l.style.left=u.left-h.width+"px",l.style.top=u.top-h.height+"px";for(var c=0;c<n.items.length;c++)if(n.content===n.items[c].text){a.element.children[c].classList.add("e-selected");break}},close:function(){return Fe(e.parent.element)}});n.createElement=this.parent.createElement,n.appendTo(r);var s=new Hl({width:"calc(100% - "+r.getBoundingClientRect().width+"px)",items:this.ribbon.items[0].content,clicked:this.toolbarClicked.bind(this)});s.createElement=this.parent.createElement,s.appendTo(i),t.style.display=""},o.prototype.fileMenuBeforeOpen=function(e){var t=this,i=this.parent.serviceLocator.getService(fe),r,n=[".xlsx",".xls",".csv",".pdf"];e.parentItem.text===i.getConstant("SaveAs")&&[].slice.call(e.element.children).forEach(function(s,a){r=t.parent.createElement("div",{innerHTML:s.innerHTML}),s.innerHTML="";var l=t.parent.createElement("span",{className:"e-extension"});l.innerText=n[a],r.appendChild(l),s.appendChild(r)}),this.parent.trigger("fileMenuBeforeOpen",e),e.element.setAttribute("aria-label",i.getConstant("File"))},o.prototype.enableRibbonTabs=function(e){this.ribbon.enableTabs(e.tabs,e.enable)},o.prototype.fileMenuBeforeClose=function(e){var t=this;this.parent.trigger("fileMenuBeforeClose",e),e.parentItem&&e.event&&e.event.keyCode===37&&e.parentItem.id===this.parent.element.id+"_File"&&cr(function(){var i=t.ribbon.element.querySelector(".e-tab-header .e-toolbar-item .e-tab-wrap");if(i){Fe(i);var r=i.querySelector(".e-menu-item.e-focused");r&&r.classList.remove("e-focused")}})},o.prototype.hideFileMenuItems=function(e){this.ribbon.hideMenuItems(e.items,e.hide,e.isUniqueId)},o.prototype.addFileMenuItems=function(e){this.ribbon.addMenuItems(e.items,e.text,e.insertAfter,e.isUniqueId)},o.prototype.hideToolbarItems=function(e){this.ribbon.hideToolbarItems(e.tab,e.indexes,e.hide)},o.prototype.protectSheetHandler=function(e){var t=this.parent.getActiveSheet(),i=this.parent.serviceLocator.getService(fe);t.isProtected&&t.protectSettings.formatCells||!t.isProtected?(this.parent.allowCellFormatting?(this.enableToolbarItems([{tab:i.getConstant("Home"),items:e.enableHomeBtnId,enable:!0}]),t.isProtected&&t.protectSettings.formatCells&&this.enableToolbarItems([{tab:i.getConstant("Home"),items:e.enableHomeBtnId.slice(15,16),enable:!1}])):this.enableToolbarItems([{tab:i.getConstant("Home"),items:e.enableHomeBtnId.slice(3,14),enable:!1}]),this.parent.allowWrap||this.enableToolbarItems([{tab:i.getConstant("Home"),items:e.enableHomeBtnId.slice(14,15),enable:!1}]),this.parent.allowNumberFormatting||this.enableToolbarItems([{tab:i.getConstant("Home"),items:e.enableHomeBtnId.slice(2,3),enable:!1}]),this.parent.notify(yI,null)):this.enableToolbarItems([{tab:i.getConstant("Home"),items:e.disableHomeBtnId,enable:!1}]),t.isProtected&&t.protectSettings.insertLink||!t.isProtected?!this.parent.allowHyperlink||t.isProtected&&t.protectSettings.insertLink?this.enableToolbarItems([{tab:i.getConstant("Insert"),items:e.enableInsertBtnId.slice(0,1),enable:!1}]):this.enableToolbarItems([{tab:i.getConstant("Insert"),items:e.enableInsertBtnId,enable:!0}]):this.enableToolbarItems([{tab:i.getConstant("Insert"),items:e.enableInsertBtnId,enable:!1}]),this.enableToolbarItems([{tab:i.getConstant("Home"),items:e.findBtnId,enable:!t.isProtected||t.protectSettings.selectCells||t.protectSettings.selectUnLockedCells}]);var r=this.ribbon.items[this.ribbon.selectedTab].content.length,n;for(n=0;n<r&&this.ribbon.items[this.ribbon.selectedTab].content[n].id!==this.parent.element.id+"_protectworkbook";n++);t.isProtected?(this.parent.isProtected&&this.parent.element.querySelector("#"+this.parent.element.id+"_protectworkbook")&&this.parent.element.querySelector("#"+this.parent.element.id+"_protectworkbook").querySelector(".e-tbar-btn-text").textContent===i.getConstant("UnprotectWorkbook")?this.ribbon.items[this.ribbon.selectedTab].header.text===i.getConstant("Data")&&(this.ribbon.items[this.ribbon.selectedTab].content[n].text=i.getConstant("UnprotectWorkbook")):this.ribbon.items[this.ribbon.selectedTab].header.text===i.getConstant("Data")&&(this.ribbon.items[this.ribbon.selectedTab].content[n].text=i.getConstant("ProtectWorkbook")),this.enableToolbarItems([{tab:i.getConstant("Insert"),items:e.imageBtnId,enable:!1}]),this.enableToolbarItems([{tab:i.getConstant("Data"),items:e.dataValidationBtnId,enable:!1}]),this.enableToolbarItems([{tab:i.getConstant("Formulas"),items:e.enableFrmlaBtnId,enable:!1}]),this.enableToolbarItems([{tab:i.getConstant("Insert"),items:e.chartBtnId,enable:!1}])):(this.parent.isProtected&&this.parent.element.querySelector("#"+this.parent.element.id+"_protectworkbook")&&this.parent.element.querySelector("#"+this.parent.element.id+"_protectworkbook").querySelector(".e-tbar-btn-text").textContent===i.getConstant("UnprotectWorkbook")?this.ribbon.items[this.ribbon.selectedTab].header.text===i.getConstant("Data")&&(this.ribbon.items[this.ribbon.selectedTab].content[n].text=i.getConstant("UnprotectWorkbook")):this.ribbon.items[this.ribbon.selectedTab].header.text===i.getConstant("Data")&&(this.ribbon.items[this.ribbon.selectedTab].content[n].text=i.getConstant("ProtectWorkbook")),this.enableToolbarItems([{tab:i.getConstant("Insert"),items:e.imageBtnId,enable:this.parent.allowImage}]),this.enableToolbarItems([{tab:i.getConstant("Data"),items:e.dataValidationBtnId,enable:this.parent.allowDataValidation}]),this.enableToolbarItems([{tab:i.getConstant("Formulas"),items:e.enableFrmlaBtnId,enable:!0}]),this.enableToolbarItems([{tab:i.getConstant("Insert"),items:e.chartBtnId,enable:this.parent.allowChart}]))},o.prototype.updateMergeItem=function(e){if(this.parent.allowMerge&&(Uc(e)||e.type==="touchmove"||e.shiftKey&&(e.type==="mousedown"||e.type==="touchend"))){var t=this.parent.getActiveSheet();if(!t.isProtected){var i=J(t.selectedRange);if(i[1]===i[3]&&i[0]===i[2])this.enableToolbarItems([{tab:this.parent.serviceLocator.getService(fe).getConstant("Home"),items:[this.parent.element.id+"_merge_cells"],enable:!1}]),this.toggleActiveState(!1);else{this.enableToolbarItems([{tab:this.parent.serviceLocator.getService(fe).getConstant("Home"),items:[this.parent.element.id+"_merge_cells"],enable:!0}]),i=tt(i);var r=G(i[0],i[1],t,!1,!0);r.rowSpan>1||r.colSpan>1?this.toggleActiveState((!(r.rowSpan>1)||i[0]+r.rowSpan-1===i[2])&&(!(r.colSpan>1)||i[1]+r.colSpan-1===i[3])):this.toggleActiveState(!1)}}}},o.prototype.onPropertyChanged=function(e){var t=this.parent.serviceLocator.getService(fe),i=this.parent.element.id,r=this.parent.getActiveSheet();switch(e){case"allowFreezePane":this.ribbon.enableItems(t.getConstant("View"),[i+"_freezepanes",i+"_freezerows",i+"_freezecolumns"],this.parent.allowFreezePane);break;case"showRibbon":this.parent.showRibbon?this.initialize(!0):this.ribbon&&this.destroy();break;case"allowImage":this.ribbon.enableItems(t.getConstant("Insert"),[i+"_image"],this.parent.allowImage);break;case"allowChart":this.ribbon.enableItems(t.getConstant("Insert"),[i+"_chart"],this.parent.allowChart),this.parent.allowChart||this.removeDesignChart();break;case"allowWrap":case"allowCellFormatting":if(this.refreshToggleBtn(Se(r.activeCell)),!r.isProtected||r.protectSettings.formatCells)if(e==="allowWrap")this.ribbon.enableItems(t.getConstant("Home"),[i+"_wrap"],this.parent.allowWrap);else{var n=[i+"_font_name",i+"_font_size",i+"_bold",i+"_italic",i+"_line-through",i+"_underline",i+"_font_color_picker",i+"_fill_color_picker",i+"_borders",i+"_merge_cells",i+"_text_align",i+"_vertical_align"];this.enableToolbarItems([{tab:t.getConstant("Home"),items:n,enable:this.parent.allowCellFormatting}])}break;case"allowNumberFormatting":(!r.isProtected||r.protectSettings.formatCells)&&this.ribbon.enableItems(t.getConstant("Home"),[i+"_number_format"],this.parent.allowNumberFormatting);break;case"calculationMode":this.parent.notify(da,[{tab:t.getConstant("Formulas"),items:[this.parent.element.id+"_calc_current_sheet",this.parent.element.id+"_calc_entire_sheets"],enable:this.parent.calculationMode==="Manual"}]),this.calcTypeOptions&&(this.calcTypeOptions.items[0].iconCss=this.parent.calculationMode==="Automatic"?"e-icons e-selected-icon":"",this.calcTypeOptions.items[1].iconCss=this.parent.calculationMode==="Manual"?"e-icons e-selected-icon":""),this.parent.calculationMode==="Automatic"&&this.parent.calculateNow("Workbook");break}},o.prototype.addEventListener=function(){this.parent.on(fl,this.ribbonOperation,this),this.parent.on(da,this.enableToolbarItems,this),this.parent.on(Qa,this.refreshRibbonContent,this),this.parent.on(eu,this.toggleRibbonItems,this),this.parent.on($x,this.enableFileMenuItems,this),this.parent.on(Jx,this.hideRibbonTabs,this),this.parent.on(tI,this.addRibbonTabs,this),this.parent.on(iI,this.addToolbarItems,this),this.parent.on(Kx,this.hideFileMenuItems,this),this.parent.on(Zx,this.addFileMenuItems,this),this.parent.on(rI,this.hideToolbarItems,this),this.parent.on(eI,this.enableRibbonTabs,this),this.parent.on(fI,this.protectSheetHandler,this),this.parent.on(pa,this.updateMergeItem,this),this.parent.on(Es,this.refreshRibbonContent,this),this.parent.on(Uf,this.insertDesignChart,this),this.parent.on(Ao,this.removeDesignChart,this),this.parent.on(VF,this.unMerge,this)},o.prototype.destroy=function(){var e=this.parent.element,t=this.ribbon?this.ribbon.element:null,i=this.cPickerEle,r=e.id,n=this.parent.serviceLocator.getService(fe),s=at(e.querySelector(".e-tab"),"tab"),a;s&&(a=s.selectedItem),this.switchRibbonTab(n.getConstant("Home")),["bold","italic","line-through","underline","cut","copy","undo","redo","wrap"].forEach(function(h){mq(X("#"+(r+"_"+h),e),bn)}),this.pasteSplitBtn&&this.pasteSplitBtn.destroy(),this.pasteSplitBtn=null,this.mergeSplitBtn&&this.mergeSplitBtn.destroy(),this.mergeSplitBtn=null,this.numFormatDDB&&this.numFormatDDB.destroy(),this.numFormatDDB=null,this.fontSizeDdb&&this.fontSizeDdb.destroy(),this.fontSizeDdb=null,this.fontNameDdb&&this.fontNameDdb.destroy(),this.fontNameDdb=null,this.textAlignDdb&&this.textAlignDdb.destroy(),this.textAlignDdb=null,this.verticalAlignDdb&&this.verticalAlignDdb.destroy(),this.verticalAlignDdb=null,this.sortingDdb&&this.sortingDdb.destroy(),this.sortingDdb=null,this.clearDdb&&this.clearDdb.destroy(),this.clearDdb=null,this.colorPicker&&this.colorPicker.destroy(),this.colorPicker=null,this.destroyComponent(r+"_borders_menu","menu"),this.bordersDdb&&this.bordersDdb.destroy(),this.bordersDdb=null,this.findDdb&&this.findDdb.destroy(),this.findDdb=null,this.destroyComponent(r+"_chart_menu","menu"),this.destroyComponent(r+"_chart_type_menu","menu"),this.destroyComponent(r+"_chart-btn","dropdown-btn"),this.destroyComponent(r+"_chart-type-btn","dropdown-btn"),this.destroyComponent(r+"_cf_menu","menu"),this.cfDdb&&(this.cfDdb.destroy(),this.cfDdb.element&&this.cfDdb.element.remove()),this.cfDdb=null,this.detachPopupElement(r),this.parent.notify("destroyRibbonComponents",null),a&&(s.selectedItem=a,s.dataBind()),this.addChartDdb&&(this.addChartDdb.destroy(),this.addChartDdb=null),this.destroyComponent(r+"_chart_theme","menu"),this.destroyComponent(r+"_chart_theme","dropdown-btn"),this.destroyComponent(r+"_chart-type-btn","menu"),this.destroyComponent(r+"_chart-type-btn","dropdown-btn"),this.datavalidationDdb&&this.datavalidationDdb.destroy(),this.datavalidationDdb=null,i&&ee(i);var l=this.parent.serviceLocator.getService(jt);l.dialogInstance&&l.dialogInstance.element.classList.contains("e-custom-format-dlg")&&l.hide(!0),this.cPickerEle=null,this.border&&(this.border=""),this.fontNameIndex&&(this.fontNameIndex=null),this.preTabIdx&&(this.preTabIdx=null),this.numPopupWidth&&(this.numPopupWidth=null),this.ribbon&&this.ribbon.destroy(),t&&ee(t),this.ribbon=null,this.removeEventListener(),this.parent=null},o.prototype.destroyComponent=function(e,t){var i=typeof e=="string"?document.getElementById(e):e;if(i){if(t!=="menu"||i.childElementCount){var r=at(i,t);if(r&&(r.destroy(),t==="dropdown-btn")){var n=document.getElementById(i.id+"-popup");n&&ee(n)}}t==="menu"&&ee(i)}},o.prototype.detachPopupElement=function(e){["_conditionalformatting","_chart-type-btn","_chart-btn","_borders"].forEach(function(t){var i=document.getElementById(""+e+t+"-popup");i&&ee(i)})},o.prototype.switchRibbonTab=function(e){for(var t,i=this.parent.element.querySelectorAll(".e-tab-text"),r=0;r<i.length;r++){var n=i[r];if(n.textContent.toLowerCase()===e.toLowerCase()){var s=n.closest(".e-toolbar-item");if(s){t=s.getAttribute("data-id");break}}}var a=at(this.parent.element.querySelector(".e-tab"),"tab");a&&!g(t)&&(a.selectedItem=a.getItemIndex(t),a.dataBind())},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(fl,this.ribbonOperation),this.parent.off(da,this.enableToolbarItems),this.parent.off(Qa,this.refreshRibbonContent),this.parent.off(eu,this.toggleRibbonItems),this.parent.off($x,this.enableFileMenuItems),this.parent.off(Jx,this.hideRibbonTabs),this.parent.off(tI,this.addRibbonTabs),this.parent.off(iI,this.addToolbarItems),this.parent.off(Kx,this.hideFileMenuItems),this.parent.off(Zx,this.addFileMenuItems),this.parent.off(rI,this.hideToolbarItems),this.parent.off(eI,this.enableRibbonTabs),this.parent.off(fI,this.protectSheetHandler),this.parent.off(pa,this.updateMergeItem),this.parent.off(Es,this.refreshRibbonContent),this.parent.off(Uf,this.insertDesignChart),this.parent.off(Ao,this.removeDesignChart),this.parent.off(VF,this.unMerge))},o}(),UO=function(){function o(e){this.categoryCollection=[],this.formulaCollection=[],this.isGoto=!1,this.parent=e,this.addEventListener()}return o.prototype.getModuleName=function(){return"formulaBar"},o.prototype.createFormulaBar=function(e){var t=this;if(!this.parent.showFormulaBar&&this.insertFnRipple){this.destroy();return}var i=this.parent.serviceLocator.getService(fe),r=this.parent.element.id,n=this.parent.createElement("div",{className:"e-formula-bar-panel"});if(!this.parent.isMobileView()){var s=this.parent.createElement("input",{id:r+"_name_box",attrs:{type:"text"}});n.appendChild(s),this.comboBoxInstance=new um({value:"A1",cssClass:"e-name-box",width:"",noRecordsTemplate:Ks(function(){return""}),fields:{text:"name",value:"refersTo"},beforeOpen:this.nameBoxBeforeOpen.bind(this),blur:this.nameBoxBlur.bind(this),select:this.nameBoxSelect.bind(this),open:function(){t.isDevice&&(window.browserDetails.isDevice=!0)},change:function(){}}),this.comboBoxInstance.createElement=this.parent.createElement,this.comboBoxInstance.appendTo(s),this.comboBoxInstance.element.parentElement.title=i.getConstant("NameBox")}var a=n.appendChild(this.parent.createElement("button",{className:"e-btn e-css e-flat e-icon-btn e-insert-function",attrs:{title:i.getConstant("InsertFunction"),type:"button"}}));a.appendChild(this.parent.createElement("span",{className:"e-btn-icon e-icons"})),this.insertFnRipple=Vi(n,{selector:".e-insert-function"}),n.appendChild(this.parent.createElement("div",{className:"e-separator"}));var l=i.getConstant("FormulaBar"),h=n.appendChild(this.parent.createElement("textarea",{className:"e-formula-bar e-css",id:r+"_formula_input",attrs:{title:l,"aria-label":l,spellcheck:"false"}}));if(h.rows=1,this.parent.isMobileView())h.placeholder=i.getConstant("MobileFormulaBarPlaceHolder"),E.add(h,"focus",this.textAreaFocusIn,this),E.add(h,"blur",this.textAreaFocusOut,this);else{var u=i.getConstant("ExpandFormulaBar");n.appendChild(this.parent.createElement("span",{className:"e-drop-icon e-icons",attrs:{title:u,role:"button",tabindex:"-1","aria-label":u}}))}e&&e.uiUpdate?this.parent.element.insertBefore(n,document.getElementById(r+"_sheet_panel")):this.parent.element.appendChild(n)},o.prototype.textAreaFocusIn=function(){var e=this.parent.element.querySelector(".e-formula-bar-panel"),t=this.parent.createElement("button",{className:"e-btn e-css e-flat e-icon-btn e-formula-submit",attrs:{type:"button"}});t.appendChild(this.parent.createElement("span",{className:"e-btn-icon e-icons e-tick-icon"})),e.classList.add("e-focused"),e.appendChild(t)},o.prototype.textAreaFocusOut=function(){var e=this.parent.element.querySelector(".e-formula-bar-panel");e.classList.remove("e-focused"),ee(e.querySelector(".e-formula-submit"))},o.prototype.keyDownHandler=function(e){var t=e.target;if(this.parent.isEdit&&(!this.parent.getActiveSheet().isProtected||t.classList.contains("e-formula-bar")&&!t.disabled)){if((ut(t.value)||t.validity&&t.value.toString().indexOf("=")===0)&&(e.keyCode===16||e.keyCode===17))return;t.classList.contains("e-formula-bar")&&(!e.shiftKey||e.shiftKey&&!uu(e.keyCode))&&this.parent.notify(fi,{action:"refreshEditor",value:t.value,refreshEditorElem:!0})}},o.prototype.keyUpHandler=function(e){if(this.parent.isEdit){var t=e.target;if(t.classList.contains("e-formula-bar")){var i={action:"getCurrentEditValue",editedValue:""};this.parent.notify(fi,i),i.editedValue!==t.value&&e.keyCode!==16&&e.keyCode!==17&&(!e.shiftKey||e.shiftKey&&!uu(e.keyCode))&&this.parent.notify(fi,{action:"refreshEditor",value:t.value,refreshEditorElem:!0})}}},o.prototype.nameBoxBeforeOpen=function(e){this.comboBoxInstance.element.classList.contains("e-name-editing")?e.cancel=!0:(this.comboBoxInstance.element.select(),this.isDevice=window.browserDetails.isDevice,this.isDevice&&(window.browserDetails.isDevice=!1))},o.prototype.nameBoxBlur=function(){this.comboBoxInstance.element.classList.contains("e-name-editing")&&(this.comboBoxInstance.element.classList.remove("e-name-editing"),this.updateValueAfterMouseUp())},o.prototype.nameBoxSelect=function(e){if(e.isInteracted&&(!e.e||e.e.type!=="keydown"||e.e.keyCode!==40&&e.e.keyCode!==38)){var t=e.itemData.refersTo.substr(1),i=yt(this.parent,Ws(t));if(i===void 0)return;var r=cu(t),n=ke(this.parent,i),s=void 0,a=void 0;if(r.indexOf(":")===-1)s=a=r.replace("$","");else{var l=r.indexOf(":");s=r.substr(0,l).replace("$",""),a=r.substr(l+1,r.length).replace("$","")}a.match(/\D/g)&&!a.match(/[0-9]/g)&&s.match(/\D/g)&&!s.match(/[0-9]/g)?(s=s+"1",a=a+n.rowCount,r=s+":"+a):!a.match(/\D/g)&&a.match(/[0-9]/g)&&!s.match(/\D/g)&&s.match(/[0-9]/g)&&(s=et(parseInt(s,10)-1,0),a=et(parseInt(a,10)-1,n.colCount-1),r=s+":"+a),i===this.parent.activeSheetIndex?(this.parent.isEdit||this.parent.selectRange(r),this.parent.notify(gl,{range:r,isSelect:!1,isMouseDown:!1,isNameBoxSelect:!0}),Fe(this.parent.element)):(gf(this.parent,r,n),this.parent.activeSheetIndex=i,this.parent.notify(gl,{range:r,isSelect:!1,isMouseDown:!1,isNameBoxSelect:!0}),Fe(this.parent.element))}},o.prototype.formulaBarUpdateHandler=function(e){var t=this,i=this.parent.getActiveSheet(),r=i.selectedRange.split(":"),n,s={action:"getElement",element:null};this.parent.notify(fi,s);var a=this.parent.element.querySelector(".e-formula-bar");if(e.type==="mousemove"||e.type==="pointermove"){var l=J(r[0]),h=J(r[1]);n=Math.abs(l[0]-h[0])+1+"R x "+(Math.abs(l[1]-h[1])+1)+"C",this.parent.isEdit&&(e.target&&!e.target.classList.contains("e-spreadsheet-edit")?this.parent.notify(lb,{}):s.element&&(a.value=s.element.textContent))}else{n=r[0];var u=Vn(this.parent)+"!"+n;fa(this.parent,u,!1,!0).then(function(c){t.parent&&c.forEach(function(d){var p=t.getFormulaBarValue(d),f={action:"getCurrentEditValue",editedValue:""};t.parent.notify(fi,f);var v=document.getElementById(t.parent.element.id+"_formula_input"),m=v.value;v.value=p,(!f.editedValue||!ut(f.editedValue.toString(),!0))&&t.parent.notify(fi,{action:"refreshEditor",value:p,refreshEditorElem:!0}),t.parent.isEdit&&(e.target&&!e.target.classList.contains("e-spreadsheet-edit")?t.parent.notify(lb,{isMouseDown:ay(e),formulaBarVal:m}):s.element&&(a.value=s.element.textContent))})})}this.updateComboBoxValue(n)},o.prototype.getFormulaBarValue=function(e){var t="";if(e)if(e.formula)t=e.formula;else if(!g(e.value)&&e.value!==""){var i={},r=e.format&&qs(e.format,!0,i,!0)&&i.type;if(r==="date"||r==="time"||r==="datetime"){var n=_s(Number(e.value));if(n&&n.toString()!=="Invalid Date"&&n.getFullYear()>=1900){var s=new Et,a=hr("Time");a==="h:mm:ss AM/PM"&&(a="h:mm:ss a");var l=e.format.toLowerCase();r==="time"&&l.includes("m")&&!l.includes(":m")&&!l.includes("m:")&&!l.includes("[m")&&!l.includes("am")&&(r="date");var h=e.value.toString().split("."),u=h.length===2,c=u?_s(parseFloat(h[0]+1+"."+h[1])||Number(e.value)):n;if(r==="date"){var d={type:"date"};d.skeleton="yMd",t=s.formatDate(n,d),u&&(t+=" "+s.formatDate(c,{type:"time",skeleton:"medium",format:a}))}else(Number(e.value)>=1||r==="datetime")&&(t=s.formatDate(n,{type:"date",skeleton:"yMd"})+" "),t+=s.formatDate(c,{type:"time",skeleton:"medium",format:a})}}else e.format&&e.format.includes("%")&&Me(e.value)&&(t=this.parent.getDisplayText(e),t.includes("%")||(t=""));if(!t){if(t=e.value.toString(),t.toLowerCase()==="true"||t.toLowerCase()==="false")t=t.toUpperCase();else if(this.parent.locale!=="en-US"){var p=Yi(this.parent.locale).decimal;p!=="."&&Me(t)&&t.includes(".")&&(t=t.replace(".",p))}}}else e.hyperlink&&(t=typeof e.hyperlink=="string"?e.hyperlink:e.hyperlink.address||"");return t},o.prototype.updateValueAfterMouseUp=function(){this.updateComboBoxValue(this.parent.getActiveSheet().selectedRange.split(":")[0])},o.prototype.updateComboBoxValue=function(e){var t=this.parent.getActiveSheet(),i=Vn(this.parent)+"!"+t.selectedRange,r={action:"getNameFromRange",range:i,definedName:null};if(this.parent.notify(vl,r),r.definedName&&(e=r.definedName.name),!this.parent.isMobileView()){if(this.comboBoxInstance.text===e)return;this.comboBoxInstance.text=e,this.comboBoxInstance.dataBind()}},o.prototype.disabletextarea=function(){var e=this.getFormulaBar();this.parent.getActiveSheet().isProtected&&!this.parent.isEdit?e.disabled=!0:e.disabled=!1},o.prototype.updateNameBoxValue=function(e,t){var i=this.parent.element.id,r=at(this.parent.element.querySelector("#"+i+"_name_box"),"combobox"),n=this.parent.getActiveSheet();if(t)r.text===e.name&&(r.value=n.activeCell,r.dataBind());else{var s=e.refersTo.split("!");if(s.length===2&&e.refersTo.startsWith("=")){var a=s[0].split("=")[1].replace(/'/g,""),l=e.refersTo.split("!")[1];a===n.name&&l===n.selectedRange&&(r.value=e.name,r.dataBind())}}},o.prototype.formulaBarScrollEdit=function(){var e=J(this.parent.getActiveSheet().selectedRange),t=Se(this.parent.getActiveSheet().topLeftCell);e[0]<t[0]&&(this.parent.goTo(this.parent.getActiveSheet().selectedRange),this.isGoto=!0),this.parent.notify(fi,{action:"startEdit",refreshCurPos:!1})},o.prototype.formulaBarClickHandler=function(e){var t=e.target,i=this.parent.getActiveSheet(),r=i.isProtected,n=Se(i.activeCell),s=G(n[0],n[1],i),a=un(s,Rt(i,n[1]));if(t.classList.contains("e-drop-icon")&&t.parentElement.classList.contains("e-formula-bar-panel"))this.toggleFormulaBar(t);else if(t.classList.contains("e-formula-bar")){if(Lo(s,Rt(i,n[1]),Ar(i,n[0]))){this.parent.notify(nr,null);return}!this.parent.isEdit&&(!r||r&&!a)||this.parent.isEdit&&r&&!t.disabled?this.formulaBarScrollEdit():r&&a&&this.parent.notify(ba,null)}else if(t.parentElement&&t.parentElement.classList.contains("e-name-box"))if(t.classList.contains("e-ddl-icon")){var l={action:"getNames",names:[]};if(this.parent.notify(vl,l),this.comboBoxInstance.dataSource.length!==l.names.length||this.comboBoxInstance.value===this.comboBoxInstance.text){var h=this.comboBoxInstance.text;this.comboBoxInstance.dataSource=l.names;var u=l.names.find(function(c){return c.name===h});this.comboBoxInstance.value=u?u.refersTo:this.comboBoxInstance.value,this.comboBoxInstance.dataBind()}}else this.comboBoxInstance.element.classList.add("e-name-editing"),this.comboBoxInstance.element.select();!g(t.offsetParent)&&(t.offsetParent.classList.contains("e-insert-function")||t.classList.contains("e-insert-function")||this.parent.element.id+"_insert_function"===t.offsetParent.id||this.parent.element.id+"_insert_function"===t.id||t.parentElement.classList.contains("e-insert-function")||this.parent.element.id+"_insert_function"===t.parentElement.id)&&this.renderInsertDlg()},o.prototype.renderInsertDlg=function(){var e=this,t=this.parent.getActiveSheet(),i=Se(t.activeCell);if(t.isProtected&&un(G(i[0],i[1],t),Rt(t,i[1]))&&!this.parent.isEdit){this.parent.notify(ba,null);return}var r=G(i[0],i[1],t);if(Lo(r,Rt(t,i[1]),Ar(t,i[0]))){this.parent.notify(nr,null);return}var n=this.parent.serviceLocator.getService(fe),s=!this.parent.isEdit,a={action:"getCurrentEditValue",editedValue:""};if(!s){var l={action:"isFormulaEditing",isFormulaEdit:!1};this.parent.notify(vl,l),s=l.isFormulaEdit,this.parent.notify(fi,a)}if((s||a.editedValue==="")&&!this.parent.element.querySelector(".e-spreadsheet-function-dlg")){a.editedValue===""&&this.parent.notify(fi,{action:"refreshEditor",value:"="});var h=this.parent.createElement("div",{className:"e-formula-description",id:this.parent.element.id+"_description_content"}),u=this.parent.createElement("div",{className:"e-category-content",id:this.parent.element.id+"_category_content"});u.innerText=n.getConstant("PickACategory");var c=this.parent.createElement("input",{className:"e-formula-category",id:this.parent.element.id+"_formula_category"}),d=this.parent.createElement("div",{className:"e-formula-list",id:this.parent.element.id+"_formula_list"}),p=this.parent.createElement("div",{className:"e-description-content"});p.innerText=n.getConstant("Description");var f=this.parent.createElement("div",{className:"e-header-content"});f.innerText=n.getConstant("InsertFunction");var v={action:"getFormulaCategory",categoryCollection:[]};this.parent.notify(xt,v),this.categoryCollection=v.categoryCollection;var m;this.categoryList=new Ps({dataSource:this.categoryCollection,cssClass:"e-ss-formula-category",index:0,width:"285px",popupHeight:"210px",select:this.dropDownSelect.bind(this),open:function(){return m=!0},close:function(){return m=!1}});var y={action:"getLibraryFormulas",formulaCollection:[]};this.parent.notify(xt,y),this.formulaCollection=y.formulaCollection,this.formulaList=new yp({dataSource:this.formulaCollection.sort(),actionComplete:this.updateFormulaList.bind(this),select:this.listSelected.bind(this),width:"285px",height:"200px"});var S;this.dialog=this.parent.serviceLocator.getService(jt),this.dialog.show({header:f.outerHTML,content:u.outerHTML+c.outerHTML+d.outerHTML+p.outerHTML+h.outerHTML,width:"320px",height:"485px",cssClass:"e-spreadsheet-function-dlg",showCloseIcon:!0,isModal:!0,beforeOpen:function(b){var w={dialogName:"InsertFunctionDialog",element:b.element,target:b.target,cancel:b.cancel};e.parent.trigger("dialogBeforeOpen",w),w.cancel?(e.dialog.dialogInstance.setProperties({beforeClose:void 0},!0),S=b.cancel=!0):Fe(e.parent.element)},open:this.dialogOpen.bind(this),beforeClose:this.dialogBeforeClose.bind(this),close:this.dialogClose.bind(this),buttons:[{click:function(b){b&&b.keyCode===13&&!m||e.selectFormula()},buttonModel:{content:n.getConstant("Ok"),isPrimary:!0}}]}),S?this.categoryList=this.formulaList=null:(this.categoryList.appendTo("#"+this.parent.element.id+"_formula_category"),this.formulaList.appendTo("#"+this.parent.element.id+"_formula_list"),E.add(this.formulaList.element,"dblclick",this.formulaClickHandler,this))}},o.prototype.toggleFormulaBar=function(e){var t=e.parentElement,i=this.parent.serviceLocator.getService(fe);t.classList.contains("e-expanded")?(t.classList.remove("e-expanded"),document.getElementById(this.parent.element.id+"_formula_input").rows=1,e.title=i.getConstant("ExpandFormulaBar"),e.setAttribute("aria-label",i.getConstant("CollapseFormulaBar"))):(t.classList.add("e-expanded"),document.getElementById(this.parent.element.id+"_formula_input").rows=3,e.title=i.getConstant("CollapseFormulaBar"),e.setAttribute("aria-label",i.getConstant("ExpandFormulaBar"))),this.parent.setPanelSize()},o.prototype.dialogOpen=function(){var e=this;cr(function(){var t=e.dialog.dialogInstance.element.querySelector(".e-footer-content .e-primary"),i=e.parent.serviceLocator.getService(fe);t.setAttribute("aria-label",i.getConstant("InsertFunction")+" "+i.getConstant("Ok")),e.categoryList&&Fe(e.categoryList.element)})},o.prototype.dialogClose=function(){var e={action:"getCurrentEditValue",editedValue:""};this.parent.notify(fi,e),e.editedValue.toString().trim()==="="&&this.parent.notify(fi,{action:"refreshEditor",value:""})},o.prototype.dialogBeforeClose=function(){E.remove(this.formulaList.element,"dblclick",this.formulaClickHandler);var e=document.getElementsByClassName("e-spreadsheet-function-dlg")[0].querySelector(".e-dlg-content");e.parentNode.removeChild(e),this.categoryList.destroy(),this.categoryList=null,this.formulaList.destroy(),this.formulaList=null},o.prototype.selectFormula=function(){var e=this.formulaList.getSelectedItems().text,t=ke(this.parent,this.parent.activeSheetIndex);this.parent.isEdit?this.parent.notify(fi,{action:"refreshEditor",value:e+"(",refreshFormulaBar:!0,refreshEditorElem:!0,isAppend:!0}):(this.parent.notify(fi,{action:"startEdit",value:"="+e+"(",address:t.activeCell}),this.parent.notify(Ua,{action:"refreshFormulabar",value:"="+e+"("})),this.dialog.dialogInstance.storeActiveElement=document.getElementById(this.parent.element.id+"_edit"),this.dialog.hide()},o.prototype.listSelected=function(e){this.updateFormulaDescription(),e.isInteracted&&e.item&&e.item.focus()},o.prototype.updateFormulaList=function(){this.activeListFormula(),this.updateFormulaDescription()},o.prototype.dropDownSelect=function(e){this.formulaCollection=[];var t={action:"getLibraryFormulas",formulaCollection:[]};if(e.item.textContent==="All")this.parent.notify(xt,t),this.formulaCollection=t.formulaCollection;else{var i=e.item.textContent,r={action:"dropDownSelectFormulas",formulaCollection:[],selectCategory:i};this.parent.notify(xt,r),this.formulaCollection=r.formulaCollection}this.formulaList.dataSource=this.formulaCollection.sort()},o.prototype.activeListFormula=function(){var e=document.getElementById(this.parent.element.id+"_formula_list"),t=e.children[0].children[0].firstElementChild;this.formulaList.selectItem(t)},o.prototype.updateFormulaDescription=function(){var e=this.formulaList.getSelectedItems().text,t={action:"getFormulaDescription",description:"",selectedList:e,isCustom:!1};this.parent.notify(xt,t);var i=this.dialog.dialogInstance.element.querySelector(".e-footer-content .e-primary");i.hasAttribute("aria-label")&&i.removeAttribute("aria-label");var r=document.getElementById(this.parent.element.id+"_description_content");e=e==="AND"?"CalculateAND":e==="OR"?"CalculateOR":e,r.textContent=t.isCustom?t.description:this.parent.serviceLocator.getService(fe).getConstant(e)},o.prototype.formulaClickHandler=function(e){var t=e.target,i=ke(this.parent,this.parent.activeSheetIndex);(t.offsetParent.classList.contains("e-text-content")||t.classList.contains("e-list-item"))&&(this.parent.isEdit?this.parent.notify(fi,{action:"refreshEditor",value:t.innerText+"(",refreshFormulaBar:!0,refreshEditorElem:!0,isAppend:!0}):(this.parent.notify(fi,{action:"startEdit",value:"="+t.innerText+"(",address:i.activeCell}),this.parent.notify(Ua,{action:"refreshFormulabar",value:"="+t.innerText+"("})),this.dialog.hide())},o.prototype.addEventListener=function(){this.parent.on(Ff,this.createFormulaBar,this),this.parent.on(yu,this.formulaBarClickHandler,this),this.parent.on($a,this.keyDownHandler,this),this.parent.on(BI,this.renderInsertDlg,this),this.parent.on(ds,this.keyUpHandler,this),this.parent.on(pa,this.formulaBarUpdateHandler,this),this.parent.on(_x,this.updateValueAfterMouseUp,this),this.parent.on(Ua,this.editOperationHandler,this),this.parent.on(bI,this.disabletextarea,this),this.parent.on(md,this.isFormulaBarEdit,this)},o.prototype.destroy=function(){this.removeEventListener(),this.comboBoxInstance&&this.comboBoxInstance.destroy(),this.comboBoxInstance=null,this.categoryCollection=null,this.formulaCollection=null,this.dialog=null,this.isGoto=null,this.insertFnRipple&&this.insertFnRipple(),this.insertFnRipple=null;var e=this.parent.element.querySelector(".e-formula-bar-panel");e&&(_a(e),ee(e)),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Ff,this.createFormulaBar),this.parent.off(yu,this.formulaBarClickHandler),this.parent.off(BI,this.renderInsertDlg),this.parent.off($a,this.keyDownHandler),this.parent.off(ds,this.keyUpHandler),this.parent.off(pa,this.formulaBarUpdateHandler),this.parent.off(_x,this.updateValueAfterMouseUp),this.parent.off(Ua,this.editOperationHandler),this.parent.off(bI,this.disabletextarea),this.parent.off(md,this.isFormulaBarEdit))},o.prototype.editOperationHandler=function(e){switch(e.action){case"refreshFormulabar":e.cell?this.getFormulaBar().value=this.getFormulaBarValue(e.cell):this.getFormulaBar().value=Ee(e.value)?"":e.value;break;case"setNameBoxValue":this.updateNameBoxValue(e.definedName,e.isRemove);break;case"getElement":e.element=this.getFormulaBar();break}},o.prototype.isFormulaBarEdit=function(e){var t=this.parent.isEdit;t&&this.isGoto?e.isEdit=!0:e.isEdit=!1},o.prototype.getFormulaBar=function(){return X("#"+this.parent.element.id+"_formula_input",this.parent.element)},o}(),WO=function(){function o(e){this.isFormulaBar=!1,this.isFormula=!1,this.isPopupOpened=!1,this.isPreventClose=!1,this.isSubFormula=!1,this.parent=e,this.addEventListener()}return o.prototype.getModuleName=function(){return"formula"},o.prototype.destroy=function(){this.removeEventListener(),this.autocompleteInstance&&(this.autocompleteInstance.destroy(),this.autocompleteInstance.element&&(this.autocompleteInstance.element.remove(),this.autocompleteInstance.element=null)),this.autocompleteInstance=null,this.acInputElement&&(this.acInputElement.remove(),this.acInputElement=null),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(vl,this.performFormulaOperation,this),this.parent.on(ds,this.keyUpHandler,this),this.parent.on($a,this.keyDownHandler,this),this.parent.on(yu,this.formulaClick,this),this.parent.on(dI,this.refreshFormulaDatasource,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(vl,this.performFormulaOperation),this.parent.off(ds,this.keyUpHandler),this.parent.off($a,this.keyDownHandler),this.parent.off(yu,this.formulaClick),this.parent.off(dI,this.refreshFormulaDatasource))},o.prototype.performFormulaOperation=function(e){var t=this,i=e.action,r=this.parent.serviceLocator.getService(fe);switch(i){case"renderAutoComplete":this.renderAutoComplete();break;case"endEdit":this.endEdit();break;case"addDefinedName":e.isAdded=this.addDefinedName(e.definedName);break;case"getNames":e.sheetName||(e.sheetName=Vn(this.parent)),e.names=this.getNames(e.sheetName);break;case"getNameFromRange":e.definedName=this.getNameFromRange(e.range);break;case"isFormulaEditing":e.isFormulaEdit=this.isFormula;break;case"isCircularReference":{var n=this.parent.serviceLocator.getService(jt),s=r.getConstant("CircularReference"),a=function(u){t.parent.trigger("dialogBeforeOpen",u),u.content!==s&&(n.dialogInstance.content=u.content,n.dialogInstance.dataBind())},l=n.dialogInstance;if(l&&l.visible&&l.element.classList.contains("e-circularref-dlg"))a({dialogName:"CircularReferenceDialog",element:l.element,target:this.parent.element,cancel:!1,cellAddress:e.address,content:s});else{var h=e.address;n.show({height:180,width:400,isModal:!0,showCloseIcon:!0,cssClass:"e-circularref-dlg",content:s,beforeOpen:function(u){var c={dialogName:"CircularReferenceDialog",element:u.element,target:u.target,cancel:u.cancel,cellAddress:h,content:s};a(c),u.cancel=c.cancel}})}e.argValue="0";break}}},o.prototype.renderAutoComplete=function(){if(!X("#"+this.parent.element.id+"_ac",this.parent.element)){var e=this.parent.createElement("input",{id:this.parent.element.id+"_ac",className:"e-ss-ac"});this.parent.element.appendChild(e);var t={action:"getLibraryFormulas",formulaCollection:[]};this.parent.notify(xt,t);var i={dataSource:t.formulaCollection,cssClass:"e-ss-atc",popupWidth:"130px",allowFiltering:!0,filterType:"StartsWith",sortOrder:"Ascending",open:this.onSuggestionOpen.bind(this),close:this.onSuggestionClose.bind(this),select:this.onSelect.bind(this),actionComplete:this.onSuggestionComplete.bind(this)};this.autocompleteInstance=new cm(i,e),this.autocompleteInstance.createElement=this.parent.createElement,this.acInputElement=e}},o.prototype.onSuggestionOpen=function(e){var t=this;this.isPopupOpened=!0,e.popup.relateTo=this.getRelateToElem(),e.popup.element.firstChild.style.maxHeight="180px",new Promise(function(i){setTimeout(function(){i()},100)}).then(function(){t.triggerKeyDownEvent(Vs.DOWN)})},o.prototype.onSuggestionClose=function(e){this.isPreventClose?e.cancel=!0:this.isPopupOpened=!1},o.prototype.onSelect=function(e){var t="="+e.itemData.value+"(";if(this.isSubFormula){var i=this.getEditingValue(),r=i.lastIndexOf(this.parent.listSeparator);r>-1?t=i.slice(0,r+1):(r=i.lastIndexOf("("),r>-1&&(t=i.slice(0,r+1))),t+=e.itemData.value+"("}if(this.parent.notify(fi,{action:"refreshEditor",value:t,refreshFormulaBar:!0,refreshEditorElem:!0,refreshCurPos:!this.isFormulaBar}),this.isPopupOpened){this.hidePopUp();var n=X("#"+this.parent.element.id+"_ac_popup");n&&ee(n),this.isPopupOpened=!1}},o.prototype.onSuggestionComplete=function(e){this.isPreventClose=e.result.length>0,this.isPreventClose||(e.cancel=!0,this.hidePopUp())},o.prototype.refreshFormulaDatasource=function(){var e={action:"getLibraryFormulas",formulaCollection:[]};this.parent.notify(xt,e),this.autocompleteInstance&&(this.autocompleteInstance.dataSource=e.formulaCollection)},o.prototype.keyUpHandler=function(e){if(this.parent.isEdit){var t=this.getEditingValue();this.isFormula=ut(t),(this.isFormula||this.isPopupOpened)&&(e.keyCode!==Vs.TAB&&this.isFormula&&(t=this.getSuggestionKeyFromFormula(t)),this.refreshFormulaSuggestion(e,t))}else this.isPopupOpened&&this.hidePopUp()},o.prototype.keyDownHandler=function(e){var t=e.keyCode;if(this.isFormula){if(this.isPopupOpened)switch(t){case Vs.UP:case Vs.DOWN:e.preventDefault(),this.triggerKeyDownEvent(t);break;case Vs.TAB:e.preventDefault(),this.triggerKeyDownEvent(Vs.ENTER);break}}else{var i=e.target;if(i.id===this.parent.element.id+"_name_box")switch(t){case Vs.ENTER:document.querySelector(".e-name-box.e-popup-open")||(this.addDefinedName({name:i.value}),Fe(this.parent.element));break;case Vs.ESC:Fe(this.parent.element);break}}},o.prototype.formulaClick=function(e){if(this.parent.isEdit){var t=e.target;this.isFormulaBar=t.classList.contains("e-formula-bar")}},o.prototype.refreshFormulaSuggestion=function(e,t){if(t.length>0){var i=this.autocompleteInstance.element,r=e.keyCode,n=this.isPopupOpened;uu(r)||(i.value=t,i.dispatchEvent(new Event("input")),i.dispatchEvent(new Event("keyup")),n&&this.triggerKeyDownEvent(Vs.DOWN))}else this.isPopupOpened&&(this.isPreventClose=!1,this.hidePopUp())},o.prototype.endEdit=function(){if(this.isSubFormula=!1,this.isPreventClose=!1,this.isFormula=!1,this.isFormulaBar=!1,this.isPopupOpened){this.hidePopUp();var e=X("#"+this.parent.element.id+"_ac_popup");e&&ee(e),this.isPopupOpened=!1}},o.prototype.hidePopUp=function(){this.autocompleteInstance.hidePopup()},o.prototype.getSuggestionKeyFromFormula=function(e){var t="";if(e=e.substr(1),e){var i=e.lastIndexOf("(");e=e.substr(i+1);var r=e.split(this.parent.listSeparator);r.length===1?(t=r[0],this.isSubFormula=i>-1):(t=r[r.length-1],this.isSubFormula=!0);var n=t.match(/\w/);(!n||n&&n.index!==0)&&(t="")}return t},o.prototype.getRelateToElem=function(){var e={action:"getElement"};return this.isFormulaBar?this.parent.notify(Ua,e):this.parent.notify(fi,e),e.element},o.prototype.getEditingValue=function(){var e={action:"getCurrentEditValue",editedValue:""};return this.parent.notify(fi,e),e.editedValue},o.prototype.triggerKeyDownEvent=function(e){var t=this.autocompleteInstance.element;t.dispatchEvent(new Event("input"));var i=new Event("keydown");i.keyCode=e,i.which=e,i.altKey=!1,i.shiftKey=!1,i.ctrlKey=!1,t.dispatchEvent(i)},o.prototype.getNames=function(e){var t=this.parent.definedNames.filter(function(i){return i.scope==="Workbook"||i.scope===""||i.scope===e});return t},o.prototype.getNameFromRange=function(e){var t=e.slice(0,e.indexOf(":")),i=e.substring(e.lastIndexOf("!")+1).split(":"),r=i.length>1&&i[0]===i[1],n,s,a=this.parent.definedNames.filter(function(l){n=l.refersTo.substring(0,l.refersTo.lastIndexOf("!")),s=l.refersTo.substring(l.refersTo.lastIndexOf("!")+1),n.includes("'")&&n.match(/^='.*'$/)&&(n="="+n.slice(2,-1));var h=n+"!"+s.split("$").join("");return r&&h==="="+t?!0:h==="="+e});return a&&a[0]},o.prototype.addDefinedName=function(e){var t=this,i=e.name,r=!1;if(i&&Mr(i.toUpperCase()))return this.parent.goTo(i),r;if(!e.refersTo){var n=ke(this.parent,this.parent.activeSheetIndex),s=Vn(this.parent);s=s.indexOf(" ")!==-1?"'"+s+"'":s;var a=n.selectedRange;if(!g(a)){var l=a.indexOf(":"),h=a.substr(0,l),u=a.substr(l+1,a.length);parseInt(u.replace(/\D/g,""),10)===n.rowCount&&parseInt(h.replace(/\D/g,""),10)===1?(u=u.replace(/[0-9]/g,""),h=h.replace(/[0-9]/g,""),a="$"+h+":$"+u):Se(u)[1]===n.colCount-1&&Se(h)[1]===0?(u=u.replace(/\D/g,""),h=h.replace(/\D/g,""),a="$"+h+":$"+u):a=h===u?h:a}e.refersTo=s+"!"+a,e.scope="Workbook"}if(i.length>0&&/^([a-zA-Z_0-9.]){0,255}$/.test(i)){var c={action:"addDefinedName",definedName:e,isAdded:!1};this.parent.notify(xt,c),r=c.isAdded,c.isAdded||this.parent.serviceLocator.getService(jt).show({content:this.parent.serviceLocator.getService(fe).getConstant("DefineNameExists"),width:"300",beforeOpen:function(d){var p={dialogName:"DefineNameExistsDialog",element:d.element,target:d.target,cancel:d.cancel};t.parent.trigger("dialogBeforeOpen",p),p.cancel&&(d.cancel=!0)}})}else this.parent.serviceLocator.getService(jt).show({content:this.parent.serviceLocator.getService(fe).getConstant("DefineNameInValid"),width:"300",beforeOpen:function(d){var p={dialogName:"DefineNameInValidDialog",element:d.element,target:d.target,cancel:d.cancel};t.parent.trigger("dialogBeforeOpen",p),p.cancel&&(d.cancel=!0)}});return r},o}(),qO=function(){function o(e){this.aggregateContent="",this.selaggregateCnt="Sum",this.parent=e,this.addEventListener()}return o.prototype.getModuleName=function(){return"sheetTabs"},o.prototype.createSheetTabs=function(){var e=this;if(!this.parent.showSheetTabs&&this.tabInstance){this.destroy();return}var t=this.parent.serviceLocator.getService(fe),i=this.parent.createElement("div",{className:"e-sheet-tab-panel",id:this.parent.element.id+"_sheet_tab_panel"}),r=this.parent.createElement("button",{className:"e-add-sheet-tab e-btn e-css e-flat e-icon-btn"+(this.parent.allowInsert?"":" e-disabled"),attrs:{title:t.getConstant("AddSheet"),type:"button"}});r.appendChild(this.parent.createElement("span",{className:"e-btn-icon e-icons e-add-icon"})),r.addEventListener("click",this.addSheetTab.bind(this)),r.disabled=!this.parent.allowInsert,i.appendChild(r),this.addBtnRipple=Vi(i,{selector:".e-add-sheet-tab"});var n=this.parent.createElement("button",{attrs:{title:t.getConstant("ListAllSheets"),type:"button"}});i.appendChild(n),this.parent.element.appendChild(i);var s=this.getSheetTabItems();this.dropDownInstance=new Or({iconCss:"e-icons",items:s.ddbItems,createPopupOnClick:!0,beforeItemRender:function(p){var f=e.parent.sheets[e.dropDownInstance.items.indexOf(p.item)];f.state==="Hidden"?p.element.classList.add("e-hide"):f.state==="VeryHidden"&&(p.element.style.display="none")},select:function(p){return e.updateSheetTab({idx:e.dropDownInstance.items.indexOf(p.item)})},beforeOpen:function(p){return e.beforeOpenHandler(e.dropDownInstance,p.element,t.getConstant("ListAllSheets"))},open:function(p){return e.openHandler(e.dropDownInstance,p.element,"left")},cssClass:"e-sheets-list e-flat e-caret-hide",close:function(){return e.focusTab(e.tabInstance.element)}}),this.dropDownInstance.createElement=this.parent.createElement,this.dropDownInstance.appendTo(n);var a=this.parent.createElement("div",{className:"e-sheet-tab"}),l;this.tabInstance=new Zv({selectedItem:this.parent.activeSheetIndex,overflowMode:"Scrollable",items:s.tabItems,scrollStep:250,selecting:function(p){if(p.selectingIndex!==p.selectedIndex)if(l)l=!1;else{var f={currentSheetIndex:p.selectingIndex,previousSheetIndex:p.selectedIndex,cancel:!1};e.parent.notify(ai,{eventArgs:f,action:"gotoSheet"}),l=f.cancel}},selected:function(p){p.isInteracted||(p.preventFocus=!0),e.goToSheet(p,l,!0)},created:function(){var p=e.tabInstance.element.querySelector(".e-toolbar-items");p.classList.add("e-sheet-tabs-items"),E.add(p,"dblclick",e.renameSheetTab,e)}}),i.appendChild(a),this.tabInstance.createElement=this.parent.createElement,this.tabInstance.appendTo(a),E.remove(this.tabInstance.element,"keydown",this.tabInstance.spaceKeyDown);for(var h=s.tabItems.length,u,c=0;c<h;c++){u=ke(this.parent,c);var d={action:"addSheet",sheetName:"Sheet"+u.id,sheetId:u.id,visibleName:u.name};this.parent.notify(xt,d)}this.parent.notify(xt,{action:"initiateDefinedNames"}),this.parent.notify(ru,null)},o.prototype.goToSheet=function(e,t,i){var r=this;if(e.selectedIndex!==e.previousIndex){if(t){this.tabInstance.selectedItem=e.previousIndex,this.tabInstance.dataBind(),Fe(this.parent.element);return}if(this.parent.notify(Ao,{}),this.parent.isEdit){var n=window.getSelection(),s={action:"getCurrentEditValue",editedValue:""};this.parent.notify(fi,s);var a=s.editedValue?ut(s.editedValue,!0):!1;!a&&n&&n.focusNode&&n.focusNode.classList&&n.focusNode.classList.contains("e-formula-bar-panel")&&(a=ut(this.parent.element.querySelector(".e-formula-bar").value,!0)),a||this.parent.endEdit()}this.parent.activeSheetIndex=e.selectedIndex,this.parent.dataBind(),this.updateDropDownItems(e.selectedIndex,e.previousIndex);var l={action:"registerGridInCalc",sheetID:(e.selectedIndex+1).toString()};this.parent.notify(xt,l),i&&(this.parent.notify(mt,{eventArgs:{previousSheetIndex:e.previousIndex,currentSheetIndex:e.selectedIndex},action:"gotoSheet"}),cr(function(){return Fe(r.parent.element)}))}},o.prototype.updateDropDownItems=function(e,t){t>-1&&(this.dropDownInstance.items[t].iconCss=""),this.dropDownInstance.items[e].iconCss="e-selected-icon e-icons",this.dropDownInstance.setProperties({items:this.dropDownInstance.items},!0)},o.prototype.beforeOpenHandler=function(e,t,i){var r=this.parent.viewport.height,n=parseInt(getComputedStyle(t.firstElementChild).height,10)*e.items.length+parseInt(getComputedStyle(t).paddingTop,10)*2;n>r&&(t.style.height=r+"px",t.style.overflowY="auto"),t.parentElement.style.visibility="hidden",i&&t.setAttribute("aria-label",i)},o.prototype.openHandler=function(e,t,i){var r=t.parentElement,n,s=is(r);if(s.indexOf("bottom")===-1){n=t.style.overflowY==="auto"?this.parent.viewport.height:r.getBoundingClientRect().height;var a=br(e.element,i,"top");i==="right"&&(a.left-=r.getBoundingClientRect().width),r.style.left=a.left+"px",r.style.top=a.top-n+"px"}r.style.visibility="",Fe(t)},o.prototype.getSheetTabItems=function(){var e=this,t=[],i=[],r;return this.parent.sheets.forEach(function(n,s){r=Vn(e.parent,s).replace(/</g,"&lt;").replace(/>/g,"&gt;"),t.push({header:{text:r},visible:n.state==="Visible"}),i.push({text:r,iconCss:s===e.parent.activeSheetIndex?"e-selected-icon e-icons":""})}),{tabItems:t,ddbItems:i}},o.prototype.refreshSheetTab=function(){var e=this.getSheetTabItems();this.dropDownInstance.items=e.ddbItems,this.dropDownInstance.setProperties({items:this.dropDownInstance.items},!0),this.tabInstance.items=e.tabItems,this.tabInstance.selectedItem=this.parent.activeSheetIndex,this.tabInstance.dataBind()},o.prototype.addSheetTab=function(){this.parent.notify(ya,{model:this.parent,start:this.parent.activeSheetIndex+1,end:this.parent.activeSheetIndex+1,modelType:"Sheet",isAction:!0,activeSheetIndex:this.parent.activeSheetIndex+1})},o.prototype.insertSheetTab=function(e){this.parent.notify(Ao,{}),(!e.preventUpdate||e.startIdx===this.tabInstance.selectedItem)&&(this.dropDownInstance.items[this.tabInstance.selectedItem].iconCss="");for(var t=e.startIdx;t<=e.endIdx;t++){var i=this.parent.sheets[t].name.replace(/</g,"&lt;").replace(/>/g,"&gt;");this.dropDownInstance.items.splice(t,0,{text:i}),this.tabInstance.addTab([{header:{text:i},content:""}],t)}(!e.preventUpdate||e.startIdx===this.tabInstance.selectedItem)&&(this.dropDownInstance.items[e.startIdx].iconCss="e-selected-icon e-icons"),this.dropDownInstance.setProperties({items:this.dropDownInstance.items},!0),e.preventUpdate?e.startIdx!==this.tabInstance.selectedItem?this.refreshSheetTab():this.parent.notify(ru,null):this.updateSheetTab({idx:e.startIdx,preventDataBind:!0})},o.prototype.updateSheetTab=function(e){if(e.name==="activeSheetChanged")e.idx=this.parent.skipHiddenSheets(e.idx);else if(this.parent.sheets[e.idx].state==="Hidden"){if(this.parent.isProtected)return;this.showSheet({sheetIndex:e.idx,triggerEvent:!0})}this.tabInstance.selectedItem=e.idx,e.preventDataBind||this.tabInstance.dataBind(),this.parent.notify(ru,null)},o.prototype.showSheet=function(e){this.parent.setSheetPropertyOnMute(this.parent.sheets[e.sheetIndex],"state","Visible"),this.tabInstance.hideTab(e.sheetIndex,!1),e.triggerEvent&&this.parent.notify(mt,{action:"showSheet",eventArgs:{sheetIndex:e.sheetIndex}})},o.prototype.switchSheetTab=function(e){var t=j(e.event.target,".e-toolbar-item");if(t){for(var i=t.querySelector(".e-tab-text").textContent,r=[],n=this.parent.element.id+"_cmenu",s=0,a=this.parent.sheets.length;s<a;s++)if(this.parent.sheets[s].name===i){this.parent.activeSheetIndex!==s&&this.updateSheetTab({idx:s});break}e.element.classList.contains("e-contextmenu")&&e.items[0]&&e.items[0].id===this.parent.element.id+"_cmenu_insert_sheet"&&(this.skipHiddenSheets()===1&&r.push(n+"_hide_sheet",n+"_delete_sheet"),(!this.parent.allowInsert||this.parent.isProtected)&&r.push(n+"_insert_sheet"),!this.parent.allowDelete&&r.indexOf(n+"_delete_sheet")>-1&&r.push(n+"_delete_sheet")),(this.parent.password.length>0||this.parent.isProtected)&&(r.indexOf(n+"_insert_sheet")>-1&&r.push(n+"_insert_sheet"),r.indexOf(n+"_delete_sheet")>-1&&r.push(n+"_delete_sheet"),r.push(n+"_duplicate",n+"_rename",n+"_hide_sheet",n+"_delete_sheet",n+"_insert_sheet",n+"_move_left",n+"_move_right")),this.parent.enableContextMenuItems(r,!1,!0)}},o.prototype.skipHiddenSheets=function(){var e=this.parent.sheets.length;return this.parent.sheets.forEach(function(t){t.state!=="Visible"&&--e}),e},o.prototype.renameSheetTab=function(){var e=this.tabInstance.element.querySelector(".e-toolbar-item.e-active");if(e){e=e.querySelector(".e-text-wrap");var t=e.querySelector(".e-tab-text").textContent,i={eventArgs:{name:t,index:this.parent.getActiveSheet().id},action:"renameSheet",cancel:!1};if(this.parent.trigger("actionBegin",i),i.cancel||this.parent.isProtected)return;var r=this.parent.createElement("input",{id:this.parent.element.id+"_rename_input",className:"e-input e-sheet-rename",styles:"width: "+e.getBoundingClientRect().width+"px",attrs:{type:"text",name:"Rename",required:"",value:t,spellcheck:"false",maxlength:"31"}});e.firstElementChild.style.display="none",e.appendChild(r),E.add(document,"mousedown touchstart",this.renameInputFocusOut,this),E.add(r,"keydown",this.renameKeyDown,this),E.add(r,"input",this.updateWidth,this),r.focus(),r.setSelectionRange(0,t.length),E.remove(j(e,".e-toolbar-items"),"dblclick",this.renameSheetTab)}},o.prototype.updateWidth=function(e){var t=e.target,i=t.value.length,r=t.value.split(" ");if(r.length){var n=r.length-1;i-=n,i+=n*.5}t.style.width=i+"ch"},o.prototype.renameKeyDown=function(e){e.keyCode===32?e.stopPropagation():e.keyCode===27?(this.removeRenameInput(e.target),this.focusTab(this.tabInstance.element)):e.keyCode===13&&this.renameInputFocusOut(e)},o.prototype.renameInputFocusOut=function(e){var t=e.target;if(!((e.type==="mousedown"||e.type==="touchstart")&&(t.classList.contains("e-sheet-rename")||j(t,".e-dlg-container")))){t=document.getElementById(this.parent.element.id+"_rename_input");var i=t.value,r=this.parent.serviceLocator.getService(fe);if(i){var n=this.tabInstance.selectedItem;if(i.match(new RegExp(".*[\\[\\]\\*\\\\/\\?].*")))this.showRenameDialog(t,r.getConstant("SheetRenameInvalidAlert"));else{if(this.parent.sheets[n].name!==i){for(var s=0,a=this.parent.sheets.length;s<a;s++)if(s!==this.parent.activeSheetIndex&&this.parent.sheets[s].name.toLowerCase()===i.toLowerCase()){this.showRenameDialog(t,r.getConstant("SheetRenameAlreadyExistsAlert"));return}}var l=this.removeRenameInput(t);this.parent.sheets[n].name!==i&&(this.parent.setSheetPropertyOnMute(this.parent.sheets[n],"name",i),this.updateSheetName({value:i,idx:n,items:l})),e.type==="keydown"?this.focusTab(l):j(e.target,".e-spreadsheet")&&Fe(this.parent.element)}}else this.showRenameDialog(t,r.getConstant("SheetRenameEmptyAlert"));this.parent.notify(mt,{eventArgs:{index:this.parent.getActiveSheet().id,value:i},action:"renameSheet"})}},o.prototype.focusTab=function(e){Fe(X(".e-toolbar-item.e-active .e-tab-wrap",e))},o.prototype.updateSheetName=function(e){var t=this.tabInstance.items[e.idx].header.text.replace(/&lt;/g,"<").replace(/&gt;/g,">"),i=e.value.replace(/</g,"&lt;").replace(/>/g,"&gt;");this.tabInstance.items[e.idx].header.text=i,this.dropDownInstance.items[e.idx].text=i,this.dropDownInstance.setProperties({items:this.dropDownInstance.items},!0);var r=e.items.querySelectorAll(".e-toolbar-item")[e.idx].querySelector(".e-tab-text");if(r.textContent="",r.appendChild(document.createTextNode(e.value)),e.value.indexOf("  ")>-1?this.tabInstance.setProperties({items:this.tabInstance.items},!0):this.tabInstance.dataBind(),this.parent.notify(Tf,{value:e.value,pName:t}),this.parent.allowChart){var n=[],s;this.parent.chartColl.forEach(function(a){a.range.includes("!")&&(s=a.range.lastIndexOf("!"),n[0]=a.range.substring(0,s),n[1]=a.range.substring(s+1),n[0].toLowerCase()===t.toLowerCase()&&(n[0]=e.value,a.range=n.join("!")))})}},o.prototype.hideSheet=function(e){var t={action:"hideSheet",eventArgs:{sheetIndex:e.sheetIndex,cancel:!1}};e.triggerEvent&&(this.parent.notify(ai,t),t.eventArgs.cancel)||(this.parent.setSheetPropertyOnMute(ke(this.parent,e.sheetIndex),"state","Hidden"),this.tabInstance.hideTab(e.sheetIndex),e.triggerEvent&&(delete t.eventArgs.cancel,this.parent.notify(mt,t)))},o.prototype.removeRenameInput=function(e){var t=e.parentElement.querySelector(".e-tab-text"),i=j(e,".e-toolbar-items");return E.add(i,"dblclick",this.renameSheetTab,this),E.remove(document,"mousedown touchstart",this.renameInputFocusOut),E.remove(e,"keydown",this.renameKeyDown),E.remove(e,"input",this.updateWidth),Ue(e),t.style.display="",i},o.prototype.showRenameDialog=function(e,t){var i=this,r=this.parent.serviceLocator.getService(jt),n;r.show({height:180,width:400,isModal:!0,showCloseIcon:!0,content:t,beforeOpen:function(s){var a={dialogName:"SheetRenameDialog",element:s.element,target:s.target,cancel:s.cancel};i.parent.trigger("dialogBeforeOpen",a),a.cancel?n=s.preventFocus=s.cancel=!0:(s.element.querySelector(".e-footer-content .e-primary").setAttribute("aria-label",t+" "+i.parent.serviceLocator.getService(fe).getConstant("Ok")),Fe(e))},close:function(){n?cr(function(){var s=[e.selectionStart,e.selectionEnd];Fe(e),e.setSelectionRange(s[0],s[1])}):e.setSelectionRange(0,e.value.length)}})},o.prototype.focusRenameInput=function(){var e=document.getElementById(this.parent.element.id+"_rename_input");e&&e.focus()},o.prototype.removeSheetTab=function(e){var t=this;if(!(e.count&&e.count===this.parent.sheets.length)){var i=this.parent.serviceLocator.getService(fe);if(this.skipHiddenSheets()>1){var r=e.sheetName?ke(this.parent,yt(this.parent,e.sheetName)):this.parent.getActiveSheet(),n=g(e.index)?yt(this.parent,r.name):e.index,s={index:n,sheetCount:this.parent.sheets.length,sheetName:r.name},a=r.rows&&r.rows.length?r.rows.length===1?!!(r.rows[0].cells&&r.rows[0].cells.length):!0:!1;if(a){var l=this.parent.serviceLocator.getService(jt);e.clicked?this.forceDelete(n):l.show({height:200,width:400,isModal:!0,showCloseIcon:!0,cssClass:"e-delete-sheet-dlg",content:i.getConstant("DeleteSheetAlert"),beforeOpen:function(h){var u={dialogName:"DeleteSheetDialog",element:h.element,target:h.target,cancel:h.cancel};t.parent.trigger("dialogBeforeOpen",u),u.cancel?h.cancel=!0:(h.element.querySelector(".e-footer-content .e-primary").setAttribute("aria-label",i.getConstant("DeleteSheetAlert")+" "+i.getConstant("Ok")),Fe(t.parent.element))},buttons:[{buttonModel:{content:i.getConstant("Ok"),isPrimary:!0},click:function(){l.hide(),t.forceDelete(n),t.parent.notify(uh,null),e&&!e.isAction&&(s.sheetCount=t.parent.sheets.length,t.parent.notify(mt,{eventArgs:s,action:"removeSheet"}))}}]})}else this.parent.notify(ls,{startIndex:n,endIndex:n,modelType:"Sheet",isDelete:!0}),this.parent.notify(xt,{action:"deleteSheetTab",sheetId:ke(this.parent,n).id}),this.destroySheet(n),this.parent.notify(uh,null),e&&!e.isAction&&(s.sheetCount=this.parent.sheets.length,this.parent.notify(mt,{eventArgs:s,action:"removeSheet"}))}else this.parent.serviceLocator.getService(jt).show({height:180,width:400,isModal:!0,showCloseIcon:!0,content:i.getConstant("DeleteSingleLastSheetAlert"),beforeOpen:function(h){var u={dialogName:"DeleteSingleSheetDialog",element:h.element,target:h.target,cancel:h.cancel};t.parent.trigger("dialogBeforeOpen",u),u.cancel&&(h.cancel=!0)}})}},o.prototype.forceDelete=function(e){this.parent.notify(Ao,{}),this.parent.notify(ls,{startIndex:e,endIndex:e,modelType:"Sheet",isDelete:!0}),this.parent.notify(xt,{action:"deleteSheetTab",sheetId:ke(this.parent,e).id}),this.destroySheet(e)},o.prototype.destroySheet=function(e){var t=g(e)?this.parent.activeSheetIndex:e;this.parent.removeSheet(t),this.parent.notify(ma,{sheetIndex:t}),this.dropDownInstance.items.splice(t,1),this.dropDownInstance.setProperties({items:this.dropDownInstance.items},!0),this.tabInstance.removeTab(t);var i=this.parent.skipHiddenSheets(this.tabInstance.selectedItem);this.parent.activeSheetIndex=i,this.parent.setProperties({activeSheetIndex:i},!0),this.parent.renderModule.refreshSheet(),this.tabInstance.selectedItem=i,this.tabInstance.dataBind(),this.updateDropDownItems(i),this.parent.notify(ru,null)},o.prototype.showAggregate=function(e){var t=this;if(mf(J(this.parent.getActiveSheet().selectedRange))||e&&e.remove){this.removeAggregate();return}var i={Count:0,Sum:"0",Avg:"0",Min:"0",Max:"0",countOnly:!0};if(this.parent.notify(pf,i),i.Count>1){this.aggregateContent=i.countOnly?"Count":this.selaggregateCnt,i.countOnly&&(this.aggregateContent="Count",delete i.Sum,delete i.Avg,delete i.Min,delete i.Max);var r=i.countOnly?"e-aggregate-list e-flat e-aggregate-list-countonly e-caret-hide":"e-aggregate-list e-flat";delete i.countOnly;var n=this.aggregateContent,s=n+": "+i[n.toString()];if(this.aggregateDropDown)this.updateAggregateContent(s,i);else{var a=this.parent.createElement("button",{id:this.parent.element.id+"_aggregate",attrs:{type:"button"}});document.getElementById(this.parent.element.id+"_sheet_tab_panel").appendChild(a),this.aggregateDropDown=new Or({content:s,items:this.getAggregateItems(i),createPopupOnClick:!0,select:function(l){t.parent.notify(pf,i),t.updateAggregateContent(l.item.text,{Count:i.Count,Sum:i.Sum,Avg:i.Avg,Min:i.Min,Max:i.Max},!0)},beforeOpen:function(l){return t.beforeOpenHandler(t.aggregateDropDown,l.element)},open:function(l){return t.openHandler(t.aggregateDropDown,l.element,"right")},close:function(){return Fe(t.parent.element)},cssClass:r}),this.aggregateDropDown.createElement=this.parent.createElement,this.aggregateDropDown.appendTo(a)}}else this.removeAggregate()},o.prototype.getAggregateItems=function(e){var t=this,i=[],r,n,s;return Object.keys(e).forEach(function(a){s=e[""+a],s!==pf&&(r=a+": "+s,n=a===t.aggregateContent?"e-selected-icon e-icons":"",i.push({text:r,iconCss:n}))}),i},o.prototype.updateAggregateContent=function(e,t,i){this.aggregateContent=e.split(": ")[0],i&&(this.selaggregateCnt=e.split(": ")[0]),this.aggregateDropDown.content=e,this.aggregateDropDown.dataBind(),this.aggregateDropDown.setProperties({items:this.getAggregateItems(t)},!0)},o.prototype.removeAggregate=function(){g(this.aggregateDropDown)||(this.aggregateDropDown.destroy(),Ue(this.aggregateDropDown.element),this.aggregateDropDown=null)},o.prototype.addEventListener=function(){this.parent.on(Uy,this.createSheetTabs,this),this.parent.on(rh,this.refreshSheetTab,this),this.parent.on(Ux,this.insertSheetTab,this),this.parent.on(qy,this.removeSheetTab,this),this.parent.on(Wx,this.renameSheetTab,this),this.parent.on(bu,this.switchSheetTab,this),this.parent.on(Iu,this.updateSheetTab,this),this.parent.on(Qa,this.removeAggregate,this),this.parent.on(Wy,this.focusRenameInput,this),this.parent.on($y,this.updateSheetName,this),this.parent.on(Ky,this.hideSheet,this),this.parent.on(yl,this.showAggregate,this),this.parent.on(CI,this.goToSheet,this),this.parent.on(wI,this.showSheet,this)},o.prototype.destroy=function(){this.removeEventListener(),this.dropDownInstance&&this.dropDownInstance.destroy(),this.dropDownInstance=null,this.tabInstance&&this.tabInstance.destroy(),this.tabInstance=null,this.removeAggregate(),this.aggregateContent=null,this.addBtnRipple&&this.addBtnRipple(),this.addBtnRipple=null,E.remove(document,"mousedown touchstart",this.renameInputFocusOut);var e=document.getElementById(this.parent.element.id+"_sheet_tab_panel");e&&Ue(e),this.selaggregateCnt&&(this.selaggregateCnt=null),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Uy,this.createSheetTabs),this.parent.off(rh,this.refreshSheetTab),this.parent.off(Ux,this.insertSheetTab),this.parent.off(qy,this.removeSheetTab),this.parent.off(Wx,this.renameSheetTab),this.parent.off(bu,this.switchSheetTab),this.parent.off(Iu,this.updateSheetTab),this.parent.off(Qa,this.removeAggregate),this.parent.off(Wy,this.focusRenameInput),this.parent.off($y,this.updateSheetName),this.parent.off(Ky,this.hideSheet),this.parent.off(yl,this.showAggregate),this.parent.off(CI,this.goToSheet),this.parent.off(wI,this.showSheet))},o}(),GO=function(){function o(e){this.isImportedFile=!1,this.unProtectSheetIdx=[],this.parent=e,this.addEventListener(),this.renderFileUpload()}return o.prototype.addEventListener=function(){this.parent.on(fy,this.openSuccess,this),this.parent.on(mx,this.openFailed,this),this.parent.on(ma,this.sheetsDestroyHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(fy,this.openSuccess),this.parent.off(mx,this.openFailed),this.parent.off(ma,this.sheetsDestroyHandler))},o.prototype.renderFileUpload=function(){var e=this.parent.element.appendChild(this.parent.createElement("input",{id:this.parent.element.id+"_fileUpload",attrs:{type:"file",accept:".xls, .xlsx, .csv, .xlsm, .xlsb",name:"fileUpload"}}));e.onchange=this.fileSelect.bind(this),e.onerror=this.openFailed.bind(this),e.style.display="none"},o.prototype.fileSelect=function(e){var t=e.target.files[0];if(!(t&&t.length<1)){var i={file:t};this.parent.open(i),X("#"+this.parent.element.id+"_fileUpload",this.parent.element).value=""}},o.prototype.openSuccess=function(e){var t=this,i=["UnsupportedFile","InvalidUrl","NeedPassword","InCorrectPassword","InCorrectSheetPassword","CorrectSheetPassword","DataLimitExceeded","FileSizeLimitExceeded","ExternalWorkbook"],r=function(u){t.parent.serviceLocator.getService(jt).hide(!0);var c=new File([],e.guid,{type:u.toLowerCase()});t.parent.open({file:c,guid:e.guid,password:e.eventArgs.password,orginalFile:e.eventArgs.file})};if(i.indexOf(e.data)>-1){var n=this.parent.serviceLocator.getService(fe);if(i[2]===e.data)this.parent.element.querySelector(".e-importprotectworkbook-dlg")||this.parent.notify(NI,e.eventArgs);else if(i[3]===e.data){var s=this.parent.createElement("span",{className:"e-importprotectpwd-alert-span"});s.innerText=n.getConstant("IncorrectPassword"),this.parent.element.querySelector(".e-importprotectworkbook-dlg").querySelector(".e-dlg-content").appendChild(s)}else if(i[4]===e.data){var s=this.parent.createElement("span",{className:"e-unprotectsheetpwd-alert-span"});s.innerText=n.getConstant("IncorrectPassword"),this.parent.element.querySelector(".e-unprotectworksheet-dlg").querySelector(".e-dlg-content").appendChild(s)}else if(i[5]===e.data){this.parent.isOpen=!1,this.parent.notify(RI,null);var a=this.parent.serviceLocator.getService(jt);a.hide(),this.parent.hideSpinner()}else if(i[8]===e.data){var a=this.parent.serviceLocator.getService(jt);a.hide(!0);var l=e.data.includes("ExternalWorkbook");this.parent.serviceLocator.getService(jt).show({content:this.parent.serviceLocator.getService("spreadsheetLocale").getConstant("ExternalWorkbook"),width:"350",buttons:l?[{click:r.bind(this,e.data+"Yes"),buttonModel:{content:n.getConstant("Yes"),isPrimary:!0}},{click:r.bind(this,e.data+"No"),buttonModel:{content:n.getConstant("No")}}]:[],beforeOpen:function(c){var d={dialogName:"OpenDialog",element:c.element,target:c.target,cancel:c.cancel};t.parent.trigger("dialogBeforeOpen",d),d.cancel&&(c.cancel=!0)}},l?!0:null),this.parent.hideSpinner();return}else{var a=this.parent.serviceLocator.getService(jt);a.hide(!0);var h=e.data.includes("LimitExceeded");this.parent.serviceLocator.getService(jt).show({content:this.parent.serviceLocator.getService("spreadsheetLocale").getConstant(e.data),width:"300",buttons:h?[{click:r.bind(this,e.data+"Open"),buttonModel:{content:n.getConstant("Ok"),isPrimary:!0}},{click:r.bind(this,e.data+"Cancel"),buttonModel:{content:n.getConstant("Cancel")}}]:[],beforeOpen:function(c){var d={dialogName:"OpenDialog",element:c.element,target:c.target,cancel:c.cancel};t.parent.trigger("dialogBeforeOpen",d),d.cancel&&(c.cancel=!0)}},h?!0:null),this.parent.hideSpinner();return}}else{var a=this.parent.serviceLocator.getService(jt);a.hide(),this.parent.showSpinner()}this.parent.element&&i[5]!==e.data&&(this.parent.notify(vu,{cellRef:null,isOpen:!0}),e.isOpenFromJson||(this.parent.trigger("openComplete",{response:e}),this.parent.notify(mt,{response:e,action:"import"})),this.parent.isProtected&&this.parent.showSheetTabs&&e.isOpenFromJson&&(this.parent.element.querySelector(".e-add-sheet-tab").setAttribute("disabled","true"),this.parent.element.querySelector(".e-add-sheet-tab").classList.add("e-disabled")),this.parent.renderModule.refreshSheet(e.isOpenFromJson,!1,!1,!1,e),this.parent.notify(rh,null),this.isImportedFile=!0,e.context.preventFormatCheck=e.eventArgs&&e.eventArgs.file&&e.eventArgs.file.name&&!e.eventArgs.file.name.includes(".csv"),this.unProtectSheetIdx=[],this.parent.hideSpinner())},o.prototype.openFailed=function(e){this.parent.trigger("openFailure",e),this.parent.hideSpinner()},o.prototype.sheetsDestroyHandler=function(e){g(e.sheetIndex)&&(this.isImportedFile=!1,this.unProtectSheetIdx=[])},o.prototype.destroy=function(){this.removeEventListener();var e=X("#"+this.parent.element.id+"_fileUpload",this.parent.element);e&&ee(e),this.isImportedFile=null,this.unProtectSheetIdx=null,this.parent=null},o.prototype.getModuleName=function(){return"open"},o}(),YO=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(bf,this.initiateSave,this),this.parent.on(Cf,this.saveCompleted,this),this.parent.on(Ax,this.showErrorDialog,this),this.parent.on(Sf,this.exportDialog,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(bf,this.initiateSave),this.parent.off(Cf,this.saveCompleted),this.parent.off(Ax,this.showErrorDialog),this.parent.off(Sf,this.exportDialog))},o.prototype.getModuleName=function(){return"save"},o.prototype.initiateSave=function(){this.parent.showSpinner()},o.prototype.saveCompleted=function(){this.parent.hideSpinner()},o.prototype.showErrorDialog=function(e){var t=this,i=this.parent.serviceLocator.getService(jt);i.show({isModal:!0,showCloseIcon:!0,height:180,width:400,content:e.content,beforeOpen:function(){return Fe(t.parent.element)}})},o.prototype.exportDialog=function(e){var t=this,i=this.parent.serviceLocator.getService(fe),r=this.parent.serviceLocator.getService(jt),n=e?e.item.id.split(this.parent.element.id+"_")[1]:"xlsx";if(g(this.parent.element.querySelector(".e-open-dlg"))){var s={isModal:!0,showCloseIcon:!0,cssClass:"e-open-dlg",header:i.getConstant("SaveAs"),beforeOpen:function(a){var l={dialogName:i.getConstant("SaveAs"),element:a.element,target:a.target,cancel:a.cancel};t.parent.trigger("dialogBeforeOpen",l),l.cancel?a.cancel=!0:(r.dialogInstance.content=t.OpenContent(n),r.dialogInstance.dataBind(),t.parent.element.querySelector(".e-text-open").setSelectionRange(0,t.parent.element.querySelector(".e-text-open").value.length),Fe(t.parent.element))},buttons:[{buttonModel:{content:i.getConstant("Save"),isPrimary:!0,cssClass:"e-btn-open-ok"},click:function(){var a=t.parent.element.querySelector(".e-text-open").value;if(t.checkValidName(a)){r.hide();var l=e?e.item.id.split(t.parent.element.id+"_")[1]:"Xlsx";t.parent.save({saveType:l,fileName:a})}else{var h=t.parent.element.querySelector(".e-btn-open-ok"),u=at(h,"btn");u.disabled=!0;var c=t.parent.serviceLocator.getService(fe),d=a.length===0?c.getConstant("EmptyFileName"):a.length>218?c.getConstant("LargeName"):c.getConstant("FileNameError"),p=t.parent.createElement("span",{className:"e-file-alert-span"});p.innerText=d,t.parent.element.querySelector(".e-file-alert-span")&&t.parent.element.querySelector(".e-file-alert-span").remove(),t.parent.element.querySelector(".e-open-dlg").querySelector(".e-dlg-content").appendChild(p)}}}]};r.show(s)}else r.hide()},o.prototype.checkValidName=function(e){var t=!0;return(e.match(new RegExp('.*[\\[\\]\\*\\\\/\\?\\:\\<\\>\\|\\"].*'))||e.length<1||e.length>218)&&(t=!1),t},o.prototype.OpenContent=function(e){var t=this,i=this.parent.serviceLocator.getService(fe),r=this.parent.createElement("div",{className:"e-open-dialog"}),n=this.parent.createElement("div",{className:"e-open-head"}),s=this.parent.createElement("div",{className:"e-input-group"});r.appendChild(n),r.appendChild(s);var a=i.getConstant("FileName"),l=this.parent.element.id+"_filename",h=this.parent.createElement("p",{className:"e-header",id:l,attrs:{"aria-label":i.getConstant("SaveAs")+" "+a}});h.innerText=a;var u=this.parent.createElement("input",{className:"e-input e-text-open",attrs:{type:"Text","aria-labelledby":l}}),c=this.parent.createElement("span",{className:"e-input-group-icon"});return u.onkeyup=function(d){if(t.parent.element.querySelector(".e-file-alert-span")&&d.keyCode!==13){var p=t.parent.element.querySelector(".e-btn-open-ok"),f=at(p,"btn");f.disabled=!1,t.parent.element.querySelector(".e-file-alert-span").remove()}},n.appendChild(h),c.textContent="."+e.toLowerCase(),s.appendChild(u),u.setAttribute("value","Sample"),s.appendChild(c),r},o}(),QO=function(){function o(e){this.parent=e,this.init()}return o.prototype.init=function(){this.initContextMenu(),this.addEventListener()},o.prototype.initContextMenu=function(){var e=document.createElement("ul");e.id=this.parent.element.id+"_contextmenu",this.parent.element.appendChild(e),this.contextMenuInstance=new Kv({cssClass:"e-spreadsheet-contextmenu",target:"#"+this.parent.element.id,select:this.selectHandler.bind(this),beforeOpen:this.beforeOpenHandler.bind(this),beforeClose:this.beforeCloseHandler.bind(this),beforeItemRender:function(t){t.element.setAttribute("aria-label",t.item.text)}},e),e.setAttribute("role","menu")},o.prototype.beforeCloseHandler=function(e){var t=this;this.parent.trigger("contextMenuBeforeClose",e),this.parent.enableKeyboardShortcut&&e.event&&e.event.keyCode===27&&cr(function(){return Fe(t.parent.element)})},o.prototype.selectHandler=function(e){var t=he({cancel:!1},e);this.parent.trigger("contextMenuItemSelect",t);var i=this.parent.element.id+"_cmenu",r=J(this.parent.getActiveSheet().selectedRange),n=[];if((e.item.id===i+"_ascending"||e.item.id===i+"_descending")&&this.parent.sortCollection)for(var s=this.parent.sortCollection.length-1;s>=0;s--)this.parent.sortCollection[s]&&this.parent.sortCollection[s].sheetIndex===this.parent.activeSheetIndex&&(n.push(this.parent.sortCollection[s]),this.parent.sortCollection.splice(s,1));if(e.item.id===i+"_delete_row"||e.item.id===i+"_delete_column"||e.item.id===i+"_insert_column_before"||e.item.id===i+"_insert_column_after"||e.item.id===i+"_insert_row_above"||e.item.id===i+"_insert_row_below"){var a=Ar(this.parent.getActiveSheet(),r[0]),l=Rt(this.parent.getActiveSheet(),r[1]);if(a&&!a.isReadOnly&&l&&!l.isReadOnly&&qi(this.parent,r)){this.parent.notify(nr,null);return}}if(e.item.id===i+"_ascending"||e.item.id===i+"_descending"||e.item.id===i+"_customsort"){var h=wb(r[0],r[1],this.parent.getActiveSheet());if(qi(this.parent,h)){this.parent.notify(nr,null);return}}var u;if(!t.cancel){var c=void 0;switch(e.item.id){case i+"_cut":this.parent.notify(Cu,{invokeCopy:!0,promise:Promise});break;case i+"_copy":this.parent.notify(wu,{invokeCopy:!0,promise:Promise});break;case i+"_paste":this.parent.notify(Ga,{isAction:!0,isInternal:!0,focus:!0});break;case i+"_pastevalues":this.parent.notify(Ga,{type:"Values",isAction:!0,isInternal:!0,focus:!0});break;case i+"_pasteformats":this.parent.notify(Ga,{type:"Formats",isAction:!0,isInternal:!0,focus:!0});break;case i+"_rename":this.parent.notify(Wx,{});break;case i+"_delete_sheet":this.parent.notify(qy,{}),Fe(this.parent.element);break;case i+"_insert_sheet":this.parent.notify(ya,{model:this.parent,start:this.parent.activeSheetIndex,end:this.parent.activeSheetIndex,modelType:"Sheet",isAction:!0,activeSheetIndex:this.parent.activeSheetIndex});break;case i+"_hide_sheet":this.parent.notify(Ky,{sheetIndex:this.parent.activeSheetIndex,triggerEvent:!0});break;case i+"_duplicate":KI(this.parent,void 0,!0),Fe(this.parent.element);break;case i+"_move_right":_y(this.parent,this.parent.activeSheetIndex+1,null,!0),Fe(this.parent.element);break;case i+"_move_left":_y(this.parent,this.parent.activeSheetIndex-1,null,!0),Fe(this.parent.element);break;case i+"_ascending":this.parent.notify(mu,{sortOptions:{sortDescriptors:{order:"Ascending"}}}),this.parent.notify(Mu,{sortOptions:{sortDescriptors:{order:"Ascending"}},previousSort:n});break;case i+"_descending":this.parent.notify(mu,{sortOptions:{sortDescriptors:{order:"Descending"}}}),this.parent.notify(Mu,{sortOptions:{sortDescriptors:{order:"Descending"}},previousSort:n});break;case i+"_customsort":this.parent.notify(Gy,null);break;case i+"_filtercellvalue":this.parent.notify(uI,null);break;case i+"_clearfilter":u=Pi(Se(this.parent.getActiveSheet().activeCell)[1]+1),this.parent.notify(jf,{field:u});break;case i+"_reapplyfilter":this.parent.notify(eb,null);break;case i+"_hide_row":c=J(this.parent.getActiveSheet().selectedRange),this.parent.notify(Dn,{startIndex:c[0],endIndex:c[2],hide:!0,isCol:!1,actionUpdate:!0});break;case i+"_unhide_row":c=J(this.parent.getActiveSheet().selectedRange),this.parent.notify(Dn,{startIndex:c[0],endIndex:c[2],hide:!1,isCol:!1,actionUpdate:!0});break;case i+"_hide_column":c=J(this.parent.getActiveSheet().selectedRange),this.parent.notify(Dn,{startIndex:c[1],endIndex:c[3],hide:!0,isCol:!0,actionUpdate:!0});break;case i+"_unhide_column":c=J(this.parent.getActiveSheet().selectedRange),this.parent.notify(Dn,{startIndex:c[1],endIndex:c[3],hide:!1,isCol:!0,actionUpdate:!0});break;case i+"_insert_row_above":case i+"_delete_row":c=J(this.parent.getActiveSheet().selectedRange),this.parent.notify(e.item.id.substr(i.length+1,6)+"Model",{model:this.parent.getActiveSheet(),start:c[0],end:c[2],modelType:"Row",isAction:!0,insertType:"above"});break;case i+"_insert_row_below":c=tt(J(this.parent.getActiveSheet().selectedRange)),this.parent.notify(ya,{model:this.parent.getActiveSheet(),start:c[2]+1,end:c[2]+1+(c[2]-c[0]),modelType:"Row",isAction:!0,insertType:"below"});break;case i+"_insert_column_before":case i+"_delete_column":c=J(this.parent.getActiveSheet().selectedRange),this.parent.notify(e.item.id.substr(i.length+1,6)+"Model",{model:this.parent.getActiveSheet(),start:c[1],end:c[3],modelType:"Column",isAction:!0,insertType:"before"});break;case i+"_insert_column_after":c=tt(J(this.parent.getActiveSheet().selectedRange)),this.parent.notify(ya,{model:this.parent.getActiveSheet(),start:c[3]+1,end:c[3]+1+(c[3]-c[1]),modelType:"Column",isAction:!0,insertType:"after"});break;case i+"_addNote":this.parent.notify(Qy,null);break;case i+"_editNote":this.parent.notify(Xy,null);break;case i+"_deleteNote":this.parent.notify(Bf,{rowIndex:null,columnIndex:null,isDeleteFromMenu:!0});break;case i+"_hyperlink":this.parent.notify(Rf,null);break;case i+"_editHyperlink":this.parent.notify(Pf,null);break;case i+"_openHyperlink":this.parent.notify(oI,null);break;case i+"_removeHyperlink":this.parent.notify(zf,{range:this.parent.getActiveSheet().selectedRange});break;case i+"_protect":this.parent.notify(yb,{});break}}},o.prototype.getInsertModel=function(e,t){for(var i=[],r=e;r<=t;r++)r===e?i.push({index:r}):i.push({});return i},o.prototype.beforeOpenHandler=function(e){for(var t=e.event.target,i,r=["e-numericcontainer","e-active-cell","e-selection","e-row","e-header-row","e-select-all-cell","e-sheet-tabs-items","e-spreadsheet-contextmenu"],n,s,a=0,l=r.length;a<l;a++)if(j(t,"."+r[a])){i=!0;break}if(i)n=this.getTarget(t);else{var h=["e-header-cell","e-rowhdr-table","e-selectall-table","e-main-panel"];if(i=h.some(function(w){return t.classList.contains(w)}),i&&(parseInt(t.parentElement.style.zIndex,10)>1||parseInt(t.parentElement.parentElement.style.zIndex,10)>1)){var u=e.event,c={clientY:u.clientY,isImage:!1,target:t},d={clientX:u.clientX,isImage:!1,target:t};this.parent.notify(Ys,c),this.parent.notify(Qs,d),n=c.size<=0?"ColumnHeader":d.size<=0?"RowHeader":"Content"}else i=!1}if(!i){e.cancel=!0;return}if(e.element.classList.contains("e-contextmenu")){var p=this.parent.getActiveSheet();if(e.event.target&&(t.classList.contains("e-rowresize")||t.classList.contains("e-colresize"))){var f=J(p.selectedRange);if(!(t.classList.contains("e-rowresize")?f[1]===0&&f[3]===p.colCount-1:f[0]===0&&f[2]===p.rowCount-1)){e.cancel=!0;return}(t.classList.contains("e-rowresize")?this.parent.hiddenCount(f[0],f[2])!==Math.abs(f[2]-f[0])+1:this.parent.hiddenCount(f[1],f[3],"columns")!==Math.abs(f[3]-f[1])+1)?s=this.getDataSource(n):s=this.getDataSource(n,t)}else{if(n==="Content"){var f=J(p.selectedRange),v=f[1]===0&&f[3]===p.colCount-1,m=f[0]===0&&f[2]===p.rowCount-1;n=v&&m?"SelectAll":v?"RowHeader":m?"ColumnHeader":"Content"}s=this.getDataSource(n,n==="Footer"?t:void 0)}this.contextMenuInstance.items=s,this.contextMenuInstance.dataBind()}else s=e.items;if(this.parent.selectionSettings.mode==="None"&&n==="Content"&&this.parent.enableContextMenuItems(["Filter"],!1,!1),n==="ColumnHeader"||n==="RowHeader"){if(e.element&&e.element.childElementCount>0){var y=n==="ColumnHeader"?e.element.querySelector("#"+this.parent.element.id+"_cmenu_insert_column"):e.element.querySelector("#"+this.parent.element.id+"_cmenu_insert_row"),S=n==="ColumnHeader"?e.element.querySelector("#"+this.parent.element.id+"_cmenu_delete_column"):e.element.querySelector("#"+this.parent.element.id+"_cmenu_delete_row");this.parent.allowInsert&&y.classList.contains("e-disabled")?y.classList.remove("e-disabled"):(!this.parent.allowInsert||this.parent.element.querySelector(".e-selectall.e-highlight"))&&!y.classList.contains("e-disabled")&&y.classList.add("e-disabled"),this.parent.allowDelete&&S.classList.contains("e-disabled")?S.classList.remove("e-disabled"):!this.parent.allowDelete&&!S.classList.contains("e-disabled")&&S.classList.add("e-disabled"),this.parent.selectionSettings.mode==="None"&&(n==="ColumnHeader"&&this.parent.enableContextMenuItems(["Insert Column","Delete Column","Hide Column"],!1,!1),n==="RowHeader"&&this.parent.enableContextMenuItems(["Insert Row","Delete Row","Hide Row"],!1,!1))}}else if(n==="Footer"){var b=yt(this.parent,t.textContent);b===0&&e.element.querySelector("#"+this.parent.element.id+"_cmenu_move_left").classList.add("e-disabled"),b===this.parent.sheets.length-1&&e.element.querySelector("#"+this.parent.element.id+"_cmenu_move_right").classList.add("e-disabled"),this.parent.selectionSettings.mode==="None"&&this.parent.enableContextMenuItems(["Insert"],!1,!1)}this.parent.trigger("contextMenuBeforeOpen",e),this.parent.notify(bu,he(e,{target:n,items:s}))},o.prototype.getTarget=function(e){return j(e,".e-sheet-content")?"Content":j(e,".e-column-header")?e.classList.contains("e-header-cell")?"ColumnHeader":"Content":j(e,".e-row-header")?e.classList.contains("e-header-cell")?"RowHeader":"Content":j(e,".e-sheet-tabs-items")?"Footer":j(e,".e-selectall-container")?e.classList.contains("e-header-cell")?j(e,".e-header-row")?"ColumnHeader":"RowHeader":j(e,".e-select-all-cell")?"SelectAll":"Content":""},o.prototype.getDataSource=function(e,t){var i=this.parent.serviceLocator.getService(fe),r=[],n=this.parent.element.id+"_cmenu";if(e==="Content")this.setClipboardData(r,i,n),r.push({separator:!0}),this.setFilterItems(r,n),this.setSortItems(r,n),r.push({separator:!0}),this.parent.enableNotes&&(this.setNotesMenu(r,n),r.push({separator:!0})),this.setHyperLink(r,n);else if(e==="RowHeader"){this.setClipboardData(r,i,n);var s=this.parent.getActiveSheet(),a=J(s.selectedRange);this.setInsertDeleteItems(r,i,"Row",n,[a[0],a[2]],["Above","Below"]),(!t||t.classList.contains("e-rowresize")||!t.parentElement||!t.parentElement.classList.value.includes("e-hide"))&&this.setHideShowItems(r,i,"Row",n,[a[0],a[2]])}else if(e==="ColumnHeader"){this.setClipboardData(r,i,n);var s=this.parent.getActiveSheet(),a=J(s.selectedRange);this.setInsertDeleteItems(r,i,"Column",n,[a[1],a[3]],["Before","After"]),(!t||!t.classList.value.includes("e-hide"))&&this.setHideShowItems(r,i,"Column",n,[a[1],a[3]])}else e==="SelectAll"?(this.setClipboardData(r,i,n),this.setFilterItems(r,n),this.setSortItems(r,n)):e==="Footer"&&(r.push({text:i.getConstant("Insert"),id:n+"_insert_sheet"}),r.push({text:i.getConstant("Delete"),iconCss:"e-icons e-delete",id:n+"_delete_sheet"}),r.push({text:i.getConstant("DuplicateSheet"),id:n+"_duplicate"}),r.push({text:i.getConstant("Rename"),id:n+"_rename"}),r.push({text:i.getConstant("Hide"),id:n+"_hide_sheet"}),this.setProtectSheetItems(r,n,t),r.push({text:i.getConstant("MoveRight"),id:n+"_move_right"}),r.push({text:i.getConstant("MoveLeft"),id:n+"_move_left"}));return r},o.prototype.setProtectSheetItems=function(e,t,i){var r=this.parent.serviceLocator.getService(fe);ke(this.parent,yt(this.parent,i.textContent)).isProtected?e.push({text:r.getConstant("UnprotectSheet"),id:t+"_protect",iconCss:"e-icons e-protect-icon"}):e.push({text:r.getConstant("ProtectSheet"),id:t+"_protect",iconCss:"e-icons e-protect-icon"})},o.prototype.setFilterItems=function(e,t){if(this.parent.allowFiltering){var i=this.parent.serviceLocator.getService(fe),r={clearFilterText:null,isFiltered:!1};this.parent.notify(tb,r),e.push({text:i.getConstant("Filter"),id:t+"_filter",iconCss:"",items:[{text:r.clearFilterText,iconCss:"e-icons e-filter-clear",id:t+"_clearfilter"},{text:i.getConstant("ReapplyFilter"),iconCss:"e-icons e-filter-reapply",id:t+"_reapplyfilter"},{separator:!0},{text:i.getConstant("FilterCellValue"),iconCss:"",id:t+"_filtercellvalue"}]})}},o.prototype.setSortItems=function(e,t){var i=this.parent.serviceLocator.getService(fe);this.parent.allowSorting&&e.push({text:i.getConstant("Sort"),id:t+"_sort",iconCss:"e-icons e-sort-icon",items:[{text:i.getConstant("SortAscending"),iconCss:"e-icons e-sort-asc",id:t+"_ascending"},{text:i.getConstant("SortDescending"),iconCss:"e-icons e-sort-desc",id:t+"_descending"},{text:i.getConstant("CustomSort")+"...",iconCss:"e-icons e-sort-custom",id:t+"_customsort"}]})},o.prototype.setHyperLink=function(e,t){if(this.parent.allowHyperlink){var i=this.parent.serviceLocator.getService(fe),r=this.parent.getActiveSheet(),n=Se(r.activeCell),s=this.parent.getCell(n[0],n[1]);g(s)?e.push({text:i.getConstant("Hyperlink"),iconCss:"e-icons e-hyperlink-icon",id:t+"_hyperlink"}):!s.getElementsByClassName("e-hyperlink")[0]&&!s.classList.contains("e-hyperlink")?e.push({text:i.getConstant("Hyperlink"),iconCss:"e-icons e-hyperlink-icon",id:t+"_hyperlink"}):e.push({text:i.getConstant("EditHyperlink"),iconCss:"e-icons e-edithyperlink-icon",id:t+"_editHyperlink"},{text:i.getConstant("OpenHyperlink"),iconCss:"e-icons e-openhyperlink-icon",id:t+"_openHyperlink"},{text:i.getConstant("RemoveHyperlink"),iconCss:"e-icons e-removehyperlink-icon",id:t+"_removeHyperlink"})}},o.prototype.setNotesMenu=function(e,t){if(this.parent.enableNotes){var i=this.parent.serviceLocator.getService(fe),r=Se(this.parent.getActiveSheet().activeCell),n=this.parent.getCell(r[0],r[1]);!g(n)&&n.children.length>0&&n.children[n.children.length-1].className.indexOf("addNoteIndicator")>-1?e.push({text:i.getConstant("EditNote"),iconCss:"e-icons e-edit-notes",id:t+"_editNote"},{text:i.getConstant("DeleteNote"),iconCss:"e-icons e-delete-notes",id:t+"_deleteNote"}):e.push({text:i.getConstant("AddNote"),iconCss:"e-icons e-add-notes",id:t+"_addNote"})}},o.prototype.setClipboardData=function(e,t,i){this.parent.enableClipboard&&(e.push({text:t.getConstant("Cut"),iconCss:"e-icons e-cut-icon",id:i+"_cut"}),e.push({text:t.getConstant("Copy"),iconCss:"e-icons e-copy-icon",id:i+"_copy"}),e.push({text:t.getConstant("Paste"),iconCss:"e-icons e-paste-icon",id:i+"_paste"}),e.push({text:t.getConstant("PasteSpecial"),id:i+"_pastespecial",items:[{text:t.getConstant("Values"),id:i+"_pastevalues"},{text:t.getConstant("Formats"),id:i+"_pasteformats"}]}))},o.prototype.setInsertDeleteItems=function(e,t,i,r,n,s){e.push({separator:!0}),["Insert","Delete"].forEach(function(a){n[0]===n[1]?e.push({text:t.getConstant(""+a+i),id:r+("_"+a.toLowerCase()+"_"+i.toLowerCase())}):e.push({text:t.getConstant(""+a+i+"s"),id:r+("_"+a.toLowerCase()+"_"+i.toLowerCase())}),a==="Insert"&&(e[e.length-1].items=[],s.forEach(function(l){e[e.length-1].items.push({text:t.getConstant(l),id:e[e.length-1].id+"_"+l.toLowerCase()})}))})},o.prototype.setHideShowItems=function(e,t,i,r,n){if(n[0]===n[1])e.push({text:t.getConstant("Hide"+i),id:r+("_hide_"+i.toLowerCase())});else{var s=n[0];n[0]=n[0]>n[1]?n[1]:n[0],n[1]=n[1]>s?n[1]:s,e.push({text:t.getConstant("Hide"+i+"s"),id:r+("_hide_"+i.toLowerCase())})}this.parent.hiddenCount(n[0],n[1],i.toLowerCase()+"s")&&e.push({text:t.getConstant("Unhide"+i+"s"),id:r+("_unhide_"+i.toLowerCase())})},o.prototype.addEventListener=function(){this.parent.on(Yx,this.addItemsHandler,this),this.parent.on(Qx,this.removeItemsHandler,this),this.parent.on(Xx,this.enableItemsHandler,this)},o.prototype.addItemsHandler=function(e){e.insertAfter?this.contextMenuInstance.insertAfter(e.items,e.text,e.isUniqueId):this.contextMenuInstance.insertBefore(e.items,e.text,e.isUniqueId)},o.prototype.removeItemsHandler=function(e){this.contextMenuInstance.removeItems(e.items,e.isUniqueId)},o.prototype.enableItemsHandler=function(e){this.contextMenuInstance.enableItems(e.items,e.enable,e.isUniqueId)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Yx,this.addItemsHandler),this.parent.off(Qx,this.removeItemsHandler),this.parent.off(Xx,this.enableItemsHandler))},o.prototype.getModuleName=function(){return"contextMenu"},o.prototype.destroy=function(){this.removeEventListener(),this.contextMenuInstance.destroy();var e=document.getElementById(this.parent.element.id+"_contextmenu");e&&ee(e),this.contextMenuInstance=null,this.parent=null},o}(),XO=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.refreshCellElement=function(e){this.parent.refreshNode(e.td,e)},o.prototype.getTextSpace=function(e){e.width=Vr(e.char,e.cell.style,this.parent.cellStyle)},o.prototype.rowFillHandler=function(e){var t=e.cellEle;if(t){var i=void 0,r=e.colIdx;if(e.cell.colSpan>1){var n={range:[e.rowIdx,e.colIdx,e.rowIdx,e.colIdx]};this.parent.notify(ur,n),r=n.range[3]}var s=Au(this.parent.getActiveSheet(),e.rowIdx,e.colIdx,r),a=e.iconSetSpan||t.querySelector(".e-iconsetspan");if(a&&(s-=a.getBoundingClientRect().width),e.updateFillSize){if(i=t.querySelector(".e-fill"),!i||!i.textContent)return;e.repeatChar=i.textContent[0];var l=t.querySelector(".e-fill-before");l&&(s-=Vr(l.textContent,e.cell.style,this.parent.cellStyle));var h=t.querySelector(".e-fill-sec");h&&(s-=Vr(h.textContent,e.cell.style,this.parent.cellStyle))}else{var u=t.querySelector(".e-addNoteIndicator");if(t.innerText="",e.beforeFillText){var l=this.parent.createElement("span",{className:"e-fill-before",styles:"float: "+(this.parent.enableRtl?"right":"left")});l.innerText=e.beforeFillText,t.appendChild(l),s-=Vr(e.beforeFillText,e.cell.style,this.parent.cellStyle)}if(i=this.parent.createElement("span",{className:"e-fill"}),t.appendChild(i),e.afterFillText){var h=this.parent.createElement("span",{className:"e-fill-sec"});h.innerText=e.afterFillText,t.appendChild(h),s-=Vr(e.afterFillText,e.cell.style,this.parent.cellStyle)}a&&t.insertBefore(a,t.childNodes[0]),u&&t.appendChild(u)}var c=Vr(e.repeatChar,e.cell.style,this.parent.cellStyle),d=parseInt((s/c).toString(),10);e.formattedText=d>0?e.repeatChar.repeat(d):"",i.textContent=e.formattedText}},o.prototype.addEventListener=function(){this.parent.on(fx,this.refreshCellElement,this),this.parent.on(Af,this.rowFillHandler,this),this.parent.on(Ny,this.getTextSpace,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(fx,this.refreshCellElement),this.parent.off(Af,this.rowFillHandler),this.parent.off(Ny,this.getTextSpace))},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.getModuleName=function(){return"numberFormat"},o}(),Kq=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(Mu,this.applySortHandler,this),this.parent.on(ff,this.sortCompleteHandler,this),this.parent.on(Gy,this.initiateCustomSortHandler,this),this.parent.on(uy,this.sortImport,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Mu,this.applySortHandler),this.parent.off(ff,this.sortCompleteHandler),this.parent.off(Gy,this.initiateCustomSortHandler),this.parent.off(uy,this.sortImport))},o.prototype.getModuleName=function(){return"sort"},o.prototype.isValidSortRange=function(){var e=this.parent.getActiveSheet(),t=tt(Qi(e.selectedRange));return!(t[0]>e.usedRange.rowIndex||t[1]>e.usedRange.colIndex)},o.prototype.sortImport=function(e){for(var t=this.parent.sortCollection,i,r=this.parent.getActiveSheet().usedRange.rowIndex-1,n=e?e.sheetIdx:this.parent.activeSheetIndex,s=0;s<t.length;s++)if(t[s].sheetIndex===n){for(var a=0;a<r;a++)if(i=this.parent.getCell(a,t[s].columnIndex),i&&i.querySelector(".e-filter-icon")){t[s].order==="Ascending"||t[s].order==="OnTop"?i.querySelector(".e-filter-icon").classList.contains("e-sortasc-filter")||i.querySelector(".e-filter-icon").classList.add("e-sortasc-filter"):i.querySelector(".e-filter-icon").classList.contains("e-sortdesc-filter")||i.querySelector(".e-filter-icon").classList.add("e-sortdesc-filter");return}}},o.prototype.sortRangeAlertHandler=function(e){var t=this,i=this.parent.serviceLocator.getService(jt),r=this.parent.serviceLocator.getService(fe);i.show({height:180,width:400,isModal:!0,showCloseIcon:!0,content:e.error,beforeOpen:function(n){var s={dialogName:e.error===r.getConstant("MultiRangeSortError")?"MultiRangeSortDialog":"SortRangeDialog",content:e.error,element:n.element,target:n.target,cancel:n.cancel};t.parent.trigger("dialogBeforeOpen",s),s.cancel?n.cancel=!0:(i.dialogInstance.content=s.content,Fe(t.parent.element))}}),this.parent.hideSpinner()},o.prototype.initiateCustomSortHandler=function(){var e=this,t=this.parent.serviceLocator.getService(fe),i=this.parent.getActiveSheet();if(!this.isValidSortRange()||i.rows.length===0){this.sortRangeAlertHandler({error:t.getConstant("SortOutOfRangeError")});return}if(qI(i.selectedRange)){this.sortRangeAlertHandler({error:t.getConstant("MultiRangeSortError")});return}var r=this.parent.serviceLocator.getService(jt),n;r.show({height:400,width:560,isModal:!0,showCloseIcon:!0,cssClass:"e-customsort-dlg",header:t.getConstant("CustomSort"),beforeOpen:function(s){var a={dialogName:"CustomSortDialog",element:s.element,target:s.target,cancel:s.cancel};e.parent.trigger("dialogBeforeOpen",a),a.cancel?s.cancel=!0:(r.dialogInstance.content=e.customSortContent(),r.dialogInstance.dataBind(),Fe(e.parent.element))},buttons:[{buttonModel:{content:t.getConstant("Ok"),isPrimary:!0},click:function(){var s=r.dialogInstance.content,a=at(s.getElementsByClassName("e-list-sort e-listview e-lib")[0],"listview"),l=a.dataSource;e.clearError();var h=s.getElementsByClassName("e-sort-error")[0];h.style.display="block",e.validateError(l,s,h)||(n={sortDescriptors:l,containsHeader:s.getElementsByClassName("e-sort-checkheader")[0].checked,caseSensitive:s.getElementsByClassName("e-sort-checkcase")[0].checked},r.hide())}}],close:function(){n&&cr(function(){return e.applySortHandler({sortOptions:n})})}})},o.prototype.validateError=function(e,t,i){var r=this.parent.serviceLocator.getService(fe),n=e.some(function(d){return d.field.toString()===""});if(n)return Array.prototype.some.call(t.getElementsByClassName("e-sort-field"),function(d){var p=!at(d,"dropdownlist").value;return p&&d.parentElement.classList.add("e-error"),p}),i.innerText=r.getConstant("SortEmptyFieldError"),!0;var s=new Set,a="",l=e.some(function(d){return a=d.field.toString(),s.size===s.add(d.field).size}),h="";if(l){var u=0;Array.prototype.some.call(t.getElementsByClassName("e-sort-field"),function(d){var p=at(d,"dropdownlist");return p.value===a&&(d.parentElement.classList.add("e-error"),h=p.text,u++),u===2}),i.innerText="";var c=this.parent.createElement("strong");return c.innerText=h,i.appendChild(c),i.appendChild(document.createTextNode(r.getConstant("SortDuplicateFieldError"))),!0}return!1},o.prototype.customSortContent=function(){var e=this.parent.createElement("div",{className:"e-sort-dialog"}),t=this.getFields(),i=kt("customSort"),r=this.getCustomListview(i);this.setHeaderTab(e,r,t);var n=this.parent.createElement("div",{className:"e-sort-listsection",styles:""});e.appendChild(n);var s=this.parent.createElement("div",{className:"e-list-sort",styles:""});n.appendChild(s),r.createElement=this.parent.createElement,r.appendTo(s),s.removeAttribute("tabindex"),this.renderListItem(i,r,!0,t);var a=this.parent.createElement("div",{className:"e-sort-error"});return e.appendChild(a),e},o.prototype.getFields=function(){var e=this.parent.getActiveSheet(),t=tt(Qi(e.selectedRange));if(t[0]===t[2]&&t[2]-t[0]===0){t[0]=0,t[1]=0,t[3]=e.usedRange.colIndex;var i={filterRange:[],hasFilter:!1};this.parent.notify(Du,i),i.hasFilter&&i.filterRange&&(t[0]=i.filterRange[0])}var r=[],n,s;for(t[1];t[1]<=t[3];t[1]++){var a=G(t[0],t[1],e);if(s="Column "+Pi(t[1]+1),a&&a.value){if(n=a.value,a.format){var l={formattedText:n,value:n,format:a.format,rowIndex:t[0],colIndex:t[1]};this.parent.notify(en,l),n=l.formattedText}}else n=s;r.push({text:n,value:s})}return r},o.prototype.setHeaderTab=function(e,t,i){var r=this,n=this.parent.serviceLocator.getService(fe),s=this.parent.createElement("div",{className:"e-sort-header"});e.appendChild(s);var a=this.parent.createElement("button",{className:"e-btn e-sort-addbtn e-flat",attrs:{type:"button"}});a.innerText=n.getConstant("AddColumn");var l=this.parent.element.querySelector(".e-customsort-dlg .e-footer-content");l.insertBefore(a,l.firstElementChild),a.addEventListener("click",function(){if(t){var p=kt("customSort");t.addItem([{id:p,text:n.getConstant("ThenBy"),field:"",order:"ascending"}]),r.renderListItem(p,t,h.checked,i,!0)}});var h=new ea({label:n.getConstant("ContainsHeader"),checked:!0,change:function(p){var f=p.checked?{text:"text",value:"value"}:{text:"value"};Array.prototype.forEach.call(e.getElementsByClassName("e-sort-field e-dropdownlist e-lib"),function(v){var m=at(v,"dropdownlist");m.dataSource=null,m.dataSource=i,m.fields=f,m.dataBind()})},cssClass:"e-sort-headercheckbox"}),u=this.parent.createElement("input",{className:"e-sort-checkheader",attrs:{type:"checkbox"}});s.appendChild(u),h.createElement=this.parent.createElement,h.appendTo(u);var c=new ea({label:n.getConstant("CaseSensitive"),checked:!1,cssClass:"e-sort-casecheckbox"}),d=this.parent.createElement("input",{className:"e-sort-checkcase",attrs:{type:"checkbox"}});s.appendChild(d),c.createElement=this.parent.createElement,c.appendTo(d)},o.prototype.getCustomListview=function(e){var t=this.parent.serviceLocator.getService(fe),i=[{id:e,text:t.getConstant("SortBy"),field:"",order:"ascending"}];mA(!1);var r=new yp({dataSource:i,fields:{id:"id"},height:"100%",template:Ks(function(n){return'<div class="e-sort-listwrapper">'+('<span class="text">'+n.text+"</span>")+'<div class="e-sort-row"><div class="e-sort-field"></div><div class="e-sort-order">'+('<span class="e-sort-ordertxt" style="display:none;">'+n.order+"</span></div>")+'<span class="e-icons e-sort-delete" tabindex="0"></span></div>'}),cssClass:"e-sort-template"});return r},o.prototype.deleteHandler=function(e,t){var i=e.getElementsByClassName("e-sort-delete")[0];i.addEventListener("click",function(){e&&t.removeItem(e)})},o.prototype.renderListItem=function(e,t,i,r,n){var s=this,a=this.parent.serviceLocator.getService(fe),l=t.element.querySelector("li[data-uid="+e+"]"),h=i?{text:"text",value:"value"}:{text:"value"},u=l.getElementsByClassName("e-sort-field")[0],c=new Ps({dataSource:r,width:"auto",cssClass:"e-sort-field-ddl",fields:h,placeholder:a.getConstant("SelectAColumn"),change:function(b){b.value&&(Array.prototype.some.call(t.dataSource,function(w){return w.id===e&&(w.field=b.value.toString().replace("Column ","")),w.id===e}),s.clearError())}});c.createElement=this.parent.createElement,c.appendTo(u),n||(c.index=0);var d=l.getElementsByClassName("e-sort-order")[0],p=d.getElementsByClassName("e-sort-ordertxt")[0],f=p.innerText.toLocaleLowerCase()==="ascending",v=new sc({label:a.getConstant("SortAscending"),name:"sortAZ_"+e,value:"ascending",checked:f,cssClass:"e-sort-radiobutton",change:function(b){s.setRadioBtnValue(t,e,b.value)}}),m=this.parent.createElement("input",{id:"orderAsc_"+e,className:"e-sort-radioasc",styles:"",attrs:{type:"radio"}});d.appendChild(m),v.createElement=this.parent.createElement,v.appendTo(m);var y=new sc({label:a.getConstant("SortDescending"),name:"sortAZ_"+e,value:"descending",checked:!f,cssClass:"e-sort-radiobutton",change:function(b){s.setRadioBtnValue(t,e,b.value)}}),S=this.parent.createElement("input",{id:"orderDesc_"+e,className:"e-sort-radiodesc",styles:"",attrs:{type:"radio"}});d.appendChild(S),y.createElement=this.parent.createElement,y.appendTo(S),this.deleteHandler(l,t)},o.prototype.setRadioBtnValue=function(e,t,i){i&&Array.prototype.some.call(e.dataSource,function(r){return r.id===t&&(r.order=i),r.id===t})},o.prototype.clearError=function(){var e=document.getElementsByClassName("e-sort-dialog")[0],t=e.getElementsByClassName("e-sort-error")[0];t.style.display!=="none"&&t.innerHTML!==""&&(t.style.display="none",Array.prototype.forEach.call(e.getElementsByClassName("e-error"),function(i){i.classList.remove("e-error")}))},o.prototype.applySortHandler=function(e){var t=this,i=this.parent.getActiveSheet(),r=e&&e.range||i.selectedRange,n=tt(Qi(r)),s=e&&e.sortOptions||{sortDescriptors:{}},a=n[0]===n[2],l={filterRange:[],hasFilter:!1,sheetIdx:this.parent.activeSheetIndex};this.parent.notify(Du,l),l.hasFilter&&(a?Co(l.filterRange,n[0],n[1]):l.filterRange[0]===n[0]&&(this.parent.element.querySelector(".e-selectall.e-highlight")||n[1]>=l.filterRange[1]&&n[1]<=l.filterRange[3]||n[3]>=l.filterRange[1]&&n[3]<=l.filterRange[3]))&&(n[0]=l.filterRange[0],n[1]=l.filterRange[1],n[2]=i.usedRange.rowIndex,n[3]=i.usedRange.colIndex,s.containsHeader=!l.allowHeaderFilter,a=!1),r=Be(n);var h={range:r,sortOptions:s,cancel:!1};if(this.parent.trigger(C6,h),!h.cancel){this.parent.notify(ai,{eventArgs:h,action:"beforeSort"}),this.parent.showSpinner();var u=new Promise(function(d){d(function(){}())}),c={args:{range:h.range,sortOptions:h.sortOptions,checkForHeader:a&&r!==h.range},promise:u,previousSort:e&&e.previousSort};this.parent.notify(If,c),c.promise.then(function(d){return t.sortCompleteHandler(d),t.parent.trigger(ff,d),t.parent.notify(mt,{eventArgs:d,action:"sorting"}),document.activeElement.tagName==="BODY"&&Fe(t.parent.element),Promise.resolve(d)}).catch(function(d){return t.sortRangeAlertHandler({error:d}),Promise.reject(d)})}},o.prototype.sortCompleteHandler=function(e){var t,i,r=this.parent.activeSheetIndex;if(e.range.includes("!")){var n=e.range.lastIndexOf("!");r=yt(this.parent,e.range.substring(0,n)),t=ke(this.parent,r),i=J(e.range.substring(n+1))}else t=this.parent.getActiveSheet(),i=J(e.range);for(var s=i[0];s<=i[2];s++)for(var a=i[1];a<=i[3];a++)this.parent.notify(xt,{action:"refreshCalculate",rowIndex:s,colIndex:a});this.parent.serviceLocator.getService("cell").refreshRange(i,!0,!0,!1,!1,cs(this.parent),void 0,void 0,void 0,!0),r===this.parent.activeSheetIndex&&t.conditionalFormats&&t.conditionalFormats.length&&this.parent.notify(Wi,{indexes:i}),this.parent.hideSpinner(),this.parent.notify(Jy,null)},o}(),Zq=function(){function o(e){this.parent=e,this.filterCollection=new Map,this.filterRange=new Map,this.filterBtn=e.createElement("div",{className:"e-filter-btn e-control e-btn e-lib e-filter-iconbtn e-icon-btn"}),this.filterBtn.appendChild(e.createElement("span",{className:"e-btn-icon e-icons e-filter-icon"})),this.addEventListener()}return o.prototype.destroy=function(){var e=this;this.removeEventListener(),this.parent.refreshing&&this.filterRange.size&&(this.parent.filterCollection=[],this.filterRange.forEach(function(i,r){e.setFilteredCollection({sheetIdx:r,saveJson:{filterCollection:e.parent.filterCollection}})})),this.filterRange=null,this.filterCollection=null,this.filterBtn&&this.filterBtn.remove(),this.filterBtn=null,this.treeViewObj&&this.treeViewObj.destroy(),this.treeViewObj=null,this.treeViewEle&&this.treeViewEle.remove(),this.treeViewEle=null,this.cBox&&(this.cBox.remove(),this.cBox=null);var t=document.querySelectorAll(".e-filter-popup");t&&t.forEach(function(i){i.remove()}),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(zF,this.filterRangeAlertHandler,this),this.parent.on(Eo,this.initiateFilterUIHandler,this),this.parent.on(ml,this.filterMouseDownHandler,this),this.parent.on(qc,this.renderFilterCellHandler,this),this.parent.on(Jy,this.refreshFilterRange,this),this.parent.on(mu,this.updateSortCollectionHandler,this),this.parent.on(Tm,this.beforeFilterMenuOpenHandler,this),this.parent.on(km,this.closeDialog,this),this.parent.on(eb,this.reapplyFilterHandler,this),this.parent.on(uI,this.filterByCellValueHandler,this),this.parent.on(jf,this.clearFilterHandler,this),this.parent.on(tb,this.getFilteredColumnHandler,this),this.parent.on(bu,this.cMenuBeforeOpenHandler,this),this.parent.on(Lm,this.filterCboxValueHandler,this),this.parent.on(Du,this.getFilterRangeHandler,this),this.parent.on(ib,this.filterCellKeyDownHandler,this),this.parent.on(cy,this.setFilteredCollection,this),this.parent.on(In,this.updateFilter,this),this.parent.on(Kc,this.beforeInsertHandler,this),this.parent.on(Ef,this.beforeDeleteHandler,this),this.parent.on(ma,this.deleteSheetHandler,this),this.parent.on(ud,this.clearHandler,this),this.parent.on(ef,this.filterDialogCreatedHandler,this),this.parent.on(Yl,this.removeFilterClass,this),this.parent.on(Lx,this.duplicateSheetFilterHandler,this),this.parent.on(_h,this.beforeFilteringHandler,this),this.parent.on(Am,this.customFilterOpen,this),this.parent.on(Ox,this.moveSheetHandler,this),this.parent.on(Yy,this.refreshFilterCellsOnResize,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(zF,this.filterRangeAlertHandler),this.parent.off(Eo,this.initiateFilterUIHandler),this.parent.off(ml,this.filterMouseDownHandler),this.parent.off(qc,this.renderFilterCellHandler),this.parent.off(Jy,this.refreshFilterRange),this.parent.off(mu,this.updateSortCollectionHandler),this.parent.off(Tm,this.beforeFilterMenuOpenHandler),this.parent.off(km,this.closeDialog),this.parent.off(eb,this.reapplyFilterHandler),this.parent.off(uI,this.filterByCellValueHandler),this.parent.off(jf,this.clearFilterHandler),this.parent.off(tb,this.getFilteredColumnHandler),this.parent.off(bu,this.cMenuBeforeOpenHandler),this.parent.off(Lm,this.filterCboxValueHandler),this.parent.off(Du,this.getFilterRangeHandler),this.parent.off(ib,this.filterCellKeyDownHandler),this.parent.off(cy,this.setFilteredCollection),this.parent.off(In,this.updateFilter),this.parent.off(Kc,this.beforeInsertHandler),this.parent.off(Ef,this.beforeDeleteHandler),this.parent.off(ma,this.deleteSheetHandler),this.parent.off(ud,this.clearHandler),this.parent.off(ef,this.filterDialogCreatedHandler),this.parent.off(Yl,this.removeFilterClass),this.parent.off(Lx,this.duplicateSheetFilterHandler),this.parent.off(_h,this.beforeFilteringHandler),this.parent.off(Am,this.customFilterOpen),this.parent.off(Ox,this.moveSheetHandler),this.parent.off(Yy,this.refreshFilterCellsOnResize))},o.prototype.getModuleName=function(){return"filter"},o.prototype.isInValidFilterRange=function(e,t){var i=tt(Qi(t||e.selectedRange)),r=!1;return e.usedRange.colIndex===0&&e.usedRange.rowIndex===0&&g(e.rows[e.usedRange.rowIndex])&&(r=!0),i[0]>e.usedRange.rowIndex||i[1]>e.usedRange.colIndex||r},o.prototype.filterRangeAlertHandler=function(e){var t=this,i=this.parent.serviceLocator.getService(jt);i.show({content:e.error,isModal:!0,height:180,width:400,showCloseIcon:!0,beforeOpen:function(r){var n={dialogName:"FilterRangeDialog",element:r.element,target:r.target,cancel:r.cancel};t.parent.trigger("dialogBeforeOpen",n),n.cancel?r.cancel=!0:Fe(t.parent.element)}}),this.parent.hideSpinner()},o.prototype.beforeFilterMenuOpenHandler=function(e){var t=this.parent.serviceLocator.getService(fe);e.element.classList.add("e-spreadsheet-contextmenu");var i=e.element.querySelector("ul");this.addMenuItem(i,t.getConstant("SortDescending"),"e-filter-sortdesc","e-sort-desc"),this.addMenuItem(i,t.getConstant("SortAscending"),"e-filter-sortasc","e-sort-asc"),e.element.appendChild(i)},o.prototype.addMenuItem=function(e,t,i,r){var n=this.parent.createElement("li",{className:i+" e-menu-item"});this.parent.allowSorting||n.classList.add("e-disabled"),n.innerText=t,n.insertBefore(this.parent.createElement("span",{className:"e-menu-icon e-icons "+r}),n.firstChild),e.insertBefore(n,e.firstChild)},o.prototype.initiateFilterUIHandler=function(e){var t=this,i=e?e.predicates:null,r=e.sIdx;!r&&r!==0&&(r=e.isOpen?0:this.parent.activeSheetIndex);var n;e.promise&&(n=new kn,e.promise=n.promise);var s=function(){n&&n.resolve()},a=e.isInternal||e.isCut;if(this.filterRange.size>0&&this.filterRange.has(r)&&!this.parent.isOpen&&!i){this.removeFilter(r,a,!1),s();return}var l=ke(this.parent,r);if(this.isInValidFilterRange(l,e.range)){var h=this.parent.serviceLocator.getService(fe);this.filterRangeAlertHandler({error:h.getConstant("FilterOutOfRangeError")}),s();return}var u=e.range||l.selectedRange,c,d;if(!a){if(c={range:u,sheetIndex:r,cancel:!1,allowHeaderFilter:!1},e.predicates?(c.predicates=e.predicates,c.previousPredicates=this.filterCollection.get(r)&&[].slice.call(this.filterCollection.get(r))):c.filterOptions={predicates:e.predicates},c.useFilterRange=!1,d={action:"filter",eventArgs:c},this.parent.notify(ai,d),c.cancel){s();return}delete c.cancel,e.useFilterRange=c.useFilterRange,e.allowHeaderFilter=c.allowHeaderFilter}if(!e.range&&(a||u===c.range)){var p=J(u);p[0]===p[2]&&p[1]===p[3]&&(p=wb(p[0],p[1],l),u=Be(p),a||(c.range=u))}else a||(u=c.range);if(i)if(i.length){var f=this.filterRange.get(r);f&&(e.useFilterRange=f.useFilterRange,e.allowHeaderFilter=f.allowHeaderFilter),this.processRange(l,r,u,!0,e.useFilterRange,e.allowHeaderFilter);var v=this.filterRange.get(r).range.slice();e.allowHeaderFilter||(v[0]=v[0]+1),e.useFilterRange||(v[2]=l.usedRange.rowIndex),v[1]=v[3]=vn(i[0].field);var m=l.name+"!"+this.getPredicateRange(v,i.slice(1,i.length)),y=Be(v);fa(this.parent,m,!0,!0,null,!0,null,null,!1,y).then(function(S){t.filterSuccessHandler(new re(S),{action:"filtering",filterCollection:i,field:i[0].field,sIdx:e.sIdx,isInternal:a,isOpen:e.isOpen,prevPredicates:c&&c.previousPredicates}),s()});return}else this.clearFilterHandler({sheetIndex:r}),s();else this.processRange(l,r,u,!1,e.useFilterRange,e.allowHeaderFilter),s();a||(this.parent.notify(mt,d),Fe(this.parent.element))},o.prototype.processRange=function(e,t,i,r,n,s){var a=tt(Qi(i||e.selectedRange));a[0]===a[2]&&a[1]===a[3]?(a[0]=0,a[1]=0,a[2]=e.usedRange.rowIndex,a[3]=e.usedRange.colIndex):a[3]>e.usedRange.colIndex&&(a[3]=e.usedRange.colIndex);var l={useFilterRange:n,range:a};s&&(l.allowHeaderFilter=s),this.filterRange.set(t,l),this.filterCollection.set(t,[]),r||this.refreshFilterRange(a,!1,t)},o.prototype.removeFilter=function(e,t,i,r){var n=this.filterRange.get(e),s=n.range.slice(),a=n.allowHeaderFilter,l=Be(s),h;if(!t){if(h={action:"filter",eventArgs:{range:l,sheetIndex:e,cancel:!1},isClearAction:r},this.parent.notify(ai,h),h.eventArgs.cancel)return;delete h.eventArgs.cancel}if(this.filterCollection.get(e).length||i){if(this.filterCollection.get(e).length&&r){var u={action:"filter",eventArgs:{range:l,sheetIndex:e,predicates:[],previousPredicates:this.filterCollection.get(e)},isClearAction:r};this.parent.notify(mt,u)}this.clearFilterHandler({preventRefresh:i,sheetIndex:e})}this.filterRange.delete(e),this.filterCollection.delete(e),this.refreshFilterRange(s,!0,e,a),t||this.parent.notify(mt,h)},o.prototype.filterByCellValueHandler=function(){var e=this,t=this.parent.activeSheetIndex,i=this.parent.getActiveSheet();if(this.isInValidFilterRange(i)){var r=this.parent.serviceLocator.getService(fe);this.filterRangeAlertHandler({error:r.getConstant("FilterOutOfRangeError")});return}var n=J(i.activeCell),s;this.isFilterRange(t,n[0],n[1])||(s=!0,this.processRange(i,t));var a=this.filterRange.get(t),l=a.range.slice(),h=Be(l);l[0]=l[0]+1,l[2]=i.usedRange.rowIndex,l[1]=l[3]=n[1];var u=Pi(n[1]+1),c=G(n[0],n[1],i),d=Hy(this.parent,c,n[0],n[1]),p=[{field:u,operator:"equal",type:this.getColumnType(i,n[1],n).type,matchCase:!1,value:d}],f=[].slice.call(this.filterCollection.get(t));f.length||(f=void 0);var v={range:h,predicates:p,previousPredicates:f,sheetIndex:t,cancel:!1,allowHeaderFilter:!1};if(this.parent.notify(ai,{action:"filter",eventArgs:v}),v.cancel){s&&this.removeFilter(t,!0);return}v.allowHeaderFilter&&(a.allowHeaderFilter=v.allowHeaderFilter,l[0]--);var m=i.name+"!"+this.getPredicateRange(l,this.filterCollection.get(t)),y=Be(l);fa(this.parent,m,!0,!0,null,!0,null,null,!1,y).then(function(S){e.filterSuccessHandler(new re(S),{action:"filtering",filterCollection:p,field:u,isFilterByValue:!0})})},o.prototype.renderFilterCellHandler=function(e){var t=g(e.sIdx)?this.parent.activeSheetIndex:e.sIdx;if(t===this.parent.activeSheetIndex){var i=this.filterRange.get(t)&&this.filterRange.get(t),r=i&&i.range;if(r&&(r[0]===e.rowIndex||i.allowHeaderFilter)&&r[1]<=e.colIndex&&r[3]>=e.colIndex){if(!e.td||e.td.classList.contains(i.allowHeaderFilter?"e-cell":"e-header-cell"))return;for(var n=e.td.querySelector(".e-filter-icon"),s="",a=this.parent.sortCollection,l=Pi(e.colIndex+1),h=this.filterCollection.get(t),u=0;u<h.length;u++)if(h[u].field===l){s=" e-filtered";break}if(a){for(var u=0;u<a.length;u++)if(a[u].sheetIndex===t&&a[u].columnIndex===e.colIndex){s+=a[u].order==="Ascending"?" e-sortasc-filter":" e-sortdesc-filter";break}}if(n)n.className="e-btn-icon e-icons e-filter-icon"+s;else{var c=!1;if(n=this.filterBtn.cloneNode(!0),e.td.children.length>0&&e.td.children[e.td.childElementCount-1].className.indexOf("e-addNoteIndicator")>-1&&(e.td.removeChild(e.td.children[e.td.childElementCount-1]),c=!0),n.firstElementChild.className="e-btn-icon e-icons e-filter-icon"+s,e.td.insertBefore(n,e.td.firstChild),e.isAction){var d=ke(this.parent,t);G(e.rowIndex,e.colIndex,d,!1,!0).wrap&&this.parent.notify(jI,{rowIdx:e.rowIndex,colIdx:e.colIndex,sheet:d,ele:e.td})}c&&this.parent.notify(bd,{targetElement:e.td,rowIndex:e.rowIndex,columnIndex:e.colIndex})}}}},o.prototype.refreshFilterRange=function(e,t,i,r){var n=i;!n&&n!==0&&(n=this.parent.activeSheetIndex);var s=this.filterRange&&this.filterRange.get(n);s?(e=e||s.range.slice(),r=s.allowHeaderFilter):e||(e=[0,0,0,0]);for(var a=e,l,h=ke(this.parent,n),u=this.parent.frozenColCount(h),c=a[1];c<=a[3];c++){if(r){var d=c<u?this.parent.sheetModule.getSelectAllTable():this.parent.getColHeaderTable(),p=d&&this.parent.getRow(0,d);l=p&&this.parent.getCell(0,c,p)}else st(h,a[0])?l=null:l=this.parent.getCell(a[0],c);if(t){if(l){var f=l.querySelector(".e-filter-btn");if(f){var v=!1;l.children.length>0&&l.children[l.childElementCount-1].className.indexOf("e-addNoteIndicator")>-1&&(l.removeChild(l.children[l.childElementCount-1]),v=!0),f.parentElement.removeChild(f),v&&this.parent.notify(bd,{targetElement:l,rowIndex:a[0],columnIndex:c})}}}else this.renderFilterCellHandler({td:l,rowIndex:a[0],colIndex:c,sIdx:n,isAction:!0})}this.parent.sortCollection&&this.parent.notify(uy,null)},o.prototype.isFilterCell=function(e,t,i){var r=this.filterRange.has(e)&&this.filterRange.get(e).range;return r&&r[0]===t&&r[1]<=i&&r[3]>=i},o.prototype.isFilterRange=function(e,t,i){var r=this.filterRange.get(e)&&this.filterRange.get(e).range;return r&&r[0]<=t&&r[2]>=t&&r[1]<=i&&r[3]>=i},o.prototype.getFilteredColumnHandler=function(e){var t=Ee(e.sheetIndex)?this.parent.activeSheetIndex:e.sheetIndex,i=this.parent.serviceLocator.getService(fe);if(e.clearFilterText=i.getConstant("ClearFilter"),this.filterRange.has(t)){var r=this.filterCollection.get(t);if(e.isClearAll){e.isFiltered=r&&r.length>0;return}var n=this.filterRange.get(t).range.slice(),s=ke(this.parent,t),a=Se(s.activeCell);if(this.isFilterRange(t,a[0],a[1])){e.field=Pi(a[1]+1);var l=G(n[0],a[1],s),h=this.parent.getDisplayText(l);e.clearFilterText=i.getConstant("ClearFilterFrom")+'"'+(h?h.toString():"Column "+e.field)+'"',r.some(function(u){return e.isFiltered=u.field===e.field,e.isFiltered})}}},o.prototype.cMenuBeforeOpenHandler=function(e){var t=this.parent.element.id+"_cmenu";if(e.parentItem&&e.parentItem.id===t+"_filter"&&e.target===""){var i={isFiltered:!1};this.getFilteredColumnHandler(i),this.parent.enableContextMenuItems([t+"_clearfilter",t+"_reapplyfilter"],!!i.isFiltered,!0)}},o.prototype.closeDialog=function(){var e=document.querySelector(".e-filter-popup");if(e&&e.id.includes(this.parent.element.id)){var t=at(e,"dialog");E.remove(e,Cd(),this.filterMouseDownHandler),t&&t.hide(),this.parent.notify(Yl,null)}},o.prototype.removeFilterClass=function(){this.parent.element.style.position==="relative"&&(this.parent.element.style.position=""),this.parent.element.classList.contains("e-filter-open")&&this.parent.element.classList.remove("e-filter-open")},o.prototype.isPopupOpened=function(){var e=document.getElementsByClassName("e-filter-popup")[0];return e&&e.id.includes(this.parent.element.id)&&e.style.display!=="none"},o.prototype.filterCellKeyDownHandler=function(e){var t=this.parent.getActiveSheet(),i=Se(t.activeCell);if(this.isFilterCell(this.parent.activeSheetIndex,i[0],i[1])){if(e.closePopup)this.closeDialog();else if(e.isFilterCell=!0,!this.isPopupOpened()){var r=this.parent.getCell(i[0],i[1]);r&&this.openDialog(r)}}},o.prototype.filterMouseDownHandler=function(e){if(!(B.isDevice&&e.type==="mousedown"||this.parent.getActiveSheet().isProtected)){var t=e.target;if(t.classList.contains("e-filter-icon")||t.classList.contains("e-filter-btn"))this.isPopupOpened()&&this.closeDialog(),this.openDialog(xr(t,"e-cell")||xr(t,"e-header-cell"));else if(this.isPopupOpened()){var i=t.offsetParent;!t.classList.contains("e-searchinput")&&!t.classList.contains("e-searchclear")&&i&&!i.classList.contains("e-filter-popup")&&!i.classList.contains("e-text-content")&&!i.classList.contains("e-checkboxtree")&&!i.classList.contains("e-checkbox-wrapper")?this.closeDialog():this.selectSortItemHandler(t)}}},o.prototype.cboxListSelected=function(e,t,i,r,n){var s=xr(r.target,"e-ftrchk");if(s){var a=n&&s.querySelector(".e-add-current");if(a)return a.classList.contains("e-check")?(wi(a,["e-uncheck"],["e-check"]),t.length||(e.btnObj.element.disabled=!0),!1):(wi(a,["e-check"],["e-uncheck"]),e.btnObj.element.disabled=!1,!0);var l=s.querySelector(".e-selectall");if(l){s.querySelector(".e-chk-hidden").indeterminate=!1;for(var h=s.querySelector(".e-frame").classList.contains("e-check"),u=void 0,c=void 0,d=n?2:1,p=e.element.childElementCount;d<p;d++)u=e.element.children[d].querySelector(".e-frame"),K([u],["e-check","e-stop","e-uncheck"]),h?(e.element.children[d].querySelector(".e-chk-hidden").checked=!1,u.classList.add("e-uncheck"),t.splice(0,1)):(e.element.children[d].querySelector(".e-chk-hidden").checked=!0,u.classList.add("e-check"),c=e.element.children[d].querySelector(".e-checkboxfiltertext").textContent,t.indexOf(c)===-1&&t.push(c))}else{var c=s.querySelector(".e-checkboxfiltertext").textContent;s.querySelector(".e-frame").classList.contains("e-check")?t.splice(t.indexOf(c),1):t.push(c),Vh(s),l=e.element.querySelector(".e-selectall")}this.updateState(e,l,l.parentElement.querySelector(".e-chk-hidden"),t.length!==i,t.length)}return null},o.prototype.initCboxList=function(e,t,i){var r=this,n=e.column.field,s=new re(e.dataSource).executeLocal(new Pe().sortBy(n+"_value","ascending")),a=[],l=this.parent.getActiveSheet(),h=this.parent.serviceLocator.getService(fe),u=document.createDocumentFragment(),c=this.createSelectAll(e,t);u.appendChild(c);var d={},p,f=[],v=[],m;s.forEach(function(N){if(N[n]===""){if(!d.isBlank){d.isBlank=!0;var P={};P[n]=h.getConstant("Blanks"),p=Jn(l,Number(N.__rowIndex)-1);var O=sl(go("cbox"),t.createCheckbox(P[n],!p,P),"e-ftrchk");u.childElementCount===1?u.appendChild(O):u.insertBefore(O,u.children[1]),a.splice(0,0,P[n]),p||(f.push(P[n]),v.push(P[n]))}}else d[N[n]]||(d[N[n]]=!0,p=Jn(l,Number(N.__rowIndex)-1),m=N[n],u.appendChild(sl(go("cbox"),t.createCheckbox(m,!p,N),"e-ftrchk")),a.push(m),p||(f.push(m),v.push(m)))}),e.element.appendChild(u);var y=c.querySelector(".e-frame");y.classList.add("e-selectall");var S=c.querySelector(".e-chk-hidden");this.updateState(e,y,S,v.length!==a.length,v.length);var b=[].slice.call(e.element.childNodes),w,I,x;e.element.addEventListener("click",function(N){if(w){var P=r.cboxListSelected(e,w,e.element.childElementCount-2,N,!0);P!==null&&(x=P)}else r.cboxListSelected(e,v,a.length,N)});var M,D,A=function(N){if(N.toLowerCase().includes(D)){var P={};P[e.column.field]=N,u.appendChild(sl(go("cbox"),t.createCheckbox(N,!0,P),"e-ftrchk")),I.push(N),w.push(N)}},L,T=e.dataSource.length>1e3?e.dataSource.length:1e3,k=a;i.length<=T?L=function(){a.forEach(function(N){A(N)})}:L=function(){M||(k=[],f=[],v=[],M=new re(i).executeLocal(new Pe().sortBy(n+"_value","ascending")),d={},M.forEach(function(O){O[n]===""?d.isBlank||(d.isBlank=!0,m=h.getConstant("Blanks"),k.splice(0,0,m),Jn(l,Number(O.__rowIndex)-1)||(f.push(m),v.push(m))):d[O[n]]||(m=O[n],d[m]=!0,k.push(O[n]),Jn(l,Number(O.__rowIndex)-1)||(v.push(m),f.push(m)))}));for(var N=0,P=k.length;N<P&&I.length<T;N++)A(k[N])};var F=function(N){if(N.event.type==="keyup")D=N.event.target.value.toLowerCase();else if(N.event.target.classList.contains("e-search-icon"))return;if(u=document.createDocumentFragment(),u.appendChild(c),D)if(I=[],w=[],L(),w.length){r.updateState(e,y,S,!1,0),c.classList.remove("e-hide");var P={};P[n]=h.getConstant("AddCurrentSelection");var O=sl(go("cbox"),t.createCheckbox(P[n],!1,P),"e-ftrchk");u.insertBefore(O,u.children[1]),O.querySelector(".e-frame").classList.add("e-add-current")}else{c.classList.add("e-hide");var z=r.parent.createElement("div",{className:"e-checkfltrnmdiv"}),H=r.parent.createElement("span");H.innerText=h.getConstant("NoResult"),z.appendChild(H),u.appendChild(z),e.btnObj.element.disabled=!0}else b&&(w=null,I=null,r.updateState(e,y,S,v.length!==a.length,v.length),c.classList.remove("e-hide"),b.forEach(function(Q){u.appendChild(Q)}));e.element.innerHTML="",e.element.appendChild(u)},R=function(){if(I)if(x){var N=void 0,P=void 0;v=f;for(var O=0,z=I.length;O<z;O++)N=I[O],I.length===w.length||w.indexOf(N)>-1?v.indexOf(N)===-1&&v.push(N):(P=v.indexOf(N),P>-1&&v.splice(P,1))}else v=w;var H=v.length;if(H===a.length&&(!w||i.length<=T))r.filterSuccessHandler(new re(e.dataSource),{action:"clear-filter",field:e.column.field});else{var Q=[],$={field:n,ignoreAccent:!1,matchCase:!1,isFilterByMenu:!0},U=Yi(r.parent.locale),ie=function(ne){var te=e.type;te==="number"&&(ne===h.getConstant("Blanks")?(ne="",te="string"):Me(Zc([ne],r.parent,U)[0])||(te="string")),Q.push(Object.assign({value:ne,type:te},$))};if(H>k.length/2){$.operator="notequal",$.predicate="and";for(var O=0,z=k.length;O<z;O++)v.indexOf(k[O])===-1&&ie(k[O])}else{$.operator="equal",$.predicate="or";for(var O=0,z=H;O<z;O++)ie(v[O])}t.initiateFilter(Q)}};this.wireFilterEvents(e,R,F.bind(this))},o.prototype.createSelectAll=function(e,t){var i={};i[e.column.field]=this.parent.serviceLocator.getService(fe).getConstant("SelectAll");var r=sl(go("cbox"),t.createCheckbox(i[e.column.field],!1,i),"e-ftrchk");return r},o.prototype.updateState=function(e,t,i,r,n){if(K([t],["e-check","e-stop","e-uncheck"]),e.btnObj.element.disabled&&(e.btnObj.element.disabled=!1),r)if(n)t.classList.add("e-stop");else{t.classList.add("e-uncheck");var s=e.element.querySelector(".e-add-current");e.btnObj.element.disabled=!s||!s.classList.contains("e-check")}else t.classList.add("e-check");i.indeterminate=r,i.checked=!r},o.prototype.beforeFilteringHandler=function(e){var t=this;if(e.instance&&e.instance.options){if(e.isOpen&&e.instance.options.type==="string"){var i=Yi(this.parent.locale);if(i.decimal!=="."){var r=e.arg3.toString().split(".");if(r.length===2){var n=r.join(i.decimal);Me(new Et(this.parent.locale).parseNumber(n,{format:"n"}))&&(e.arg3=n)}}}var s=function(h,u){if(u&&(u==="notequal"||t.isCustomNumFilter(u)))if(h){if(Me(h))h=parseFloat(h.toString());else if(typeof h=="string"){var c=Yi(t.parent.locale),d=new Et(t.parent.locale),p={};if(h.includes(c.percentSign)){var f=h.trim().split("%");f[0]!==""&&!f[1]&&(p=ca({value:f[0]},t.parent.locale,c.group,c.decimal))}if(p.isNumber)h=Number(p.value)/100;else{var v=d.parseNumber(h.trim(),{format:"n"});if(Me(v))/^(\(\d+\)|\d+)$/.test(h.trim())?h=-v:h=v;else{var m=h.trim(),y={value:m,cell:{value:m}};t.parent.notify(Jr,y),(y.isTime||y.isDate)&&(h=parseFloat(y.updatedVal))}}}}else u==="notequal"&&h===null&&(h="");else u==="equal"&&(Me(h)?h=h.toString():typeof h=="string"&&Me(s(h,"notequal"))?h=h.trim():h===null&&(h=""));return h};if(e.instance.options.type!=="date")e.arg3=s(e.arg3,e.arg2),e.arg8=s(e.arg8,e.arg7);else if(e.instance.options.format==="yMd"){var a=function(h,u){if(h)if(typeof h=="string"){var c=h.trim(),d={value:c,cell:{value:c}};if(t.parent.notify(Jr,d),d.isDate)h=u==="equal"?d.dateObj:parseFloat(d.updatedVal);else if(u==="equal"||u==="notequal"){var p=s(h,"notequal");Me(p)?(e.instance.options.type="number",u==="notequal"&&(h=p)):e.instance.options.type="string"}}else wo(h)&&u!=="equal"&&(h=Ms(h,!0));return h},l=document.querySelectorAll(".e-xlfl-valuediv input.e-datepicker");l.length===2?(e.arg3=a(e.arg3||l[0].value,e.arg2),e.arg8=a(e.arg8||l[1].value,e.arg7)):e.arg3&&(e.arg3=a(e.arg3,e.arg2))}}},o.prototype.customFilterOpen=function(e){for(var t=document.querySelectorAll(".e-xlfl-optrdiv input.e-dropdownlist"),i=[],r=0;r<t.length;r++){var n=at(t[r],"dropdownlist");n&&i.push(n.value)}var s=[];if(i.length===2)for(var a=this.filterCollection.get(this.parent.activeSheetIndex),l=void 0,r=0;r<a.length;r++)a[r].field===e.column&&a[r].value!==null&&(l=i.indexOf(a[r].operator),l>-1&&(a[r].operator==="equal"&&wo(a[r].value)?s[l]=Ms(a[r].value,!0).toString():s[l]=a[r].value.toString(),i[l]=""));var h=Yi(this.parent.locale),u=function(m){if(h.decimal!=="."&&Me(m)){var y=m.toString();if(y.includes("."))return y.replace(".",h.decimal)}return m},c=document.querySelectorAll(".e-xlfl-valuediv input.e-ss-filter-input");if(c.length)for(var r=0;r<c.length;r++){var d=new Lh({placeholder:this.parent.serviceLocator.getService(fe).getConstant("CustomFilterPlaceHolder")});s[r]&&(d.value=u(s[r])),d.appendTo(c[r])}else for(var p=document.querySelectorAll(".e-xlfl-valuediv input.e-datepicker"),f=void 0,v=void 0,r=0;r<p.length;r++)Me(s[r])?v=this.parent.getDisplayText({value:s[r],format:hr("ShortDate")+(s[r].includes(".")?" "+hr("Time"):"")}):v=u(s[r]),f=at(p[r],"datepicker"),f&&(f.value=v,p[r].value=v)},o.prototype.wireFilterEvents=function(e,t,i){var r=this;e.btnObj.element.addEventListener("click",t.bind(this)),e.searchBox.addEventListener("keydown",function(s){s.keyCode===13&&t()});var n=function(){r.parent.off(GF,i),r.parent.off(Yl,n),Fe(r.parent.element)};this.parent.on(Yl,n,this),this.parent.on(GF,i,this)},o.prototype.initTreeView=function(e,t){var i=this,r=[],n=[],s={},a=[],l=[],h=[],u=[],c,d,p,f,v,m,y,S=["January","February","March","April","May","June","July","August","September","October","November","December"];if(this.parent.locale!=="en-US"){var b=nt.getDependables(zr,this.parent.locale,null).dateObject,w=b.months["stand-alone"]?b.months["stand-alone"].wide:{};Object.keys(w).length===12&&(S=Object.keys(w).map(Number).map(function(O){return w[O]}))}var I,x=!1,M=this.parent.getActiveSheet(),D=function(O){s[""+m]=!0,Jn(M,Number(O.__rowIndex)-1)?x=!0:r.push(m),n.push(m)};e.dataSource.forEach(function(O){f=O[e.column.field],typeof f=="object"&&Date.parse(f.toString())?(c=f.getFullYear().toString(),s[""+c]||(I={__rowIndex:c,hasChild:!0},I[e.column.field]=c,a.push(I),s[""+c]=!0),y=f.getMonth(),d=S[y],v=c+" "+d,s[""+v]||(I={__rowIndex:v,pId:c,hasChild:!0,month:y},I[e.column.field]=d,l.push(I),s[""+v]=!0),p=f.getDate(),m=v+" "+p.toString(),s[""+m]||(I={__rowIndex:m,pId:v},I[e.column.field]=p,h.push(I),D(O))):(!O[e.column.field]&&O[e.column.field]!==0?(m="blanks",c=i.parent.serviceLocator.getService(fe).getConstant("Blanks")):(m="text "+O[e.column.field].toString().toLowerCase(),c=O[e.column.field]),s[""+m]||(I={__rowIndex:m},I[e.column.field]=c,u.push(I),D(O)))}),a=new re(a).executeLocal(new Pe().sortBy(e.column.field,"decending")),l=new re(l).executeLocal(new Pe().sortBy("month","ascending")),h=new re(h).executeLocal(new Pe().sortBy(e.column.field,"ascending")),h=a.concat(l.concat(h)),u.length&&(u=new re(u).executeLocal(new Pe().sortBy(e.column.field,"ascending")),h=h.concat(u));var A=function(O){var z=[O.node];if(O.event.target.classList.contains("e-fullrow")||O.event.key==="Enter"){var H=N.getNode(O.node);H.isChecked==="true"?N.uncheckAll(z):N.checkAll(z)}},L=function(){F.indeterminate=!1,k.classList.contains("e-check")?(N.uncheckAll(),k.classList.add("e-uncheck"),F.checked=!1):(N.checkAll(),k.classList.add("e-check"),F.checked=!0)},T=this.createSelectAll(e,t);T.addEventListener("click",L.bind(this)),T.classList.add("e-spreadsheet-ftrchk");var k=T.querySelector(".e-frame");k.classList.add("e-selectall"),e.element.appendChild(T);var F=T.querySelector(".e-chk-hidden"),R=this.parent.createElement("div"),N=new em({fields:{dataSource:h,id:"__rowIndex",parentID:"pId",text:e.column.field,hasChildren:"hasChild"},enableRtl:this.parent.enableRtl,showCheckBox:!0,cssClass:"e-checkboxtree",checkedNodes:r,nodeClicked:A.bind(this),keyPress:A.bind(this),nodeChecked:function(O){O.action!=="indeterminate"&&(x=N.checkedNodes.length!==N.fields.dataSource.length,i.updateState(e,k,F,x,N.checkedNodes.length))}});N.createElement=this.parent.createElement,N.appendTo(R),e.element.appendChild(R),r=N.checkedNodes,this.updateState(e,k,F,x,N.checkedNodes.length);var P=function(){N.checkedNodes.length===h.length?i.filterSuccessHandler(new re(e.dataSource),{action:"clear-filter",field:e.column.field}):i.generatePredicate(N.checkedNodes,u.length?"string":e.type,e.column.field,t,n,N.checkedNodes.length>h.length/2)};this.treeViewObj=N,this.treeViewEle=R,this.cBox=F,this.wireFilterEvents(e,P,this.refreshCheckbox.bind(this,h,N,r))},o.prototype.generatePredicate=function(e,t,i,r,n,s){var a=[],l,h={January:0,February:1,March:2,April:3,May:4,June:5,July:6,August:7,September:8,October:9,November:10,December:11},u,c,d,p,f=function(){u[0]==="blanks"?a.push(Object.assign({value:"",type:t},l)):u[0]==="text"&&(u.splice(0,1),d=u.join(" "),isNaN(Number(d))?p="string":(d=Number(d),p="number"),a.push(Object.assign({value:d,type:p},l)))},v=function(){c=new Date(Number(u[0]),h[u[1]],Number(u[2])),c.getDate()?a.push(Object.assign({value:c,type:t},l)):f()};if(s){l={field:i,ignoreAccent:!1,matchCase:!1,predicate:"and",operator:"notequal",isFilterByMenu:!0};for(var m=0,y=n.length;m<y;m++)e.indexOf(n[m])===-1&&(u=n[m].split(" "),v())}else{l={field:i,ignoreAccent:!1,matchCase:!1,predicate:"or",operator:"equal",isFilterByMenu:!0};for(var m=0,y=e.length;m<y;m++)u=e[m].split(" "),u.length===3?v():f()}r.initiateFilter(a)},o.prototype.refreshCheckbox=function(e,t,i,r){var n;if(r.event.type==="keyup")n=r.event.target.value;else if(r.event.target.classList.contains("e-search-icon"))return;var s,a=function(){if(s.length&&!t.fields.dataSource.length){var x=t.element.parentElement;x.getElementsByClassName("e-spreadsheet-ftrchk")[0].classList.remove("e-hide"),ee(x.getElementsByClassName("e-checkfltrnmdiv")[0])}t.fields.dataSource=s,t.dataBind()};if(n){s=new re(e).executeLocal(new Pe().where(new St(t.fields.text,"contains",n,!0)));var l={},h=[],u=void 0,c=void 0,d=isNaN(Number(n)),p=void 0,f=void 0;if(d){for(var v=0;v<s.length;v++)s[v].hasChild&&(h.push(new St("pId","equal",s[v].__rowIndex,!1)),u=s[v].pId,l[""+u]||(h.push(new St("__rowIndex","equal",u,!1)),l[""+u]=!0));c=s,f=1}else{var m=void 0,y={};p=[];for(var v=0;v<s.length;v++)u=s[v].pId,u?(m=u.split(" ")[0],l[""+u]||(h.push(new St("__rowIndex","equal",u,!1)),l[""+u]=!0,p.push(m),p.push(u)),y[""+m]||(l[""+m]||(h.push(new St("__rowIndex","equal",m,!1)),l[""+m]=!0),h.push(new St("__rowIndex","equal",s[v].__rowIndex,!1)))):(u=s[v].__rowIndex,y[""+u]||(h.push(new St("__rowIndex","contains",u,!1)),y[""+u]=!0));c=[]}if(s.length){h.length&&(s=c.concat(new re(e).executeLocal(new Pe().where(St.or(h))))),a(),t.checkAll();var S=t.animation.expand.duration;t.animation.expand.duration=0,t.expandAll(p,f),t.animation.expand.duration=S}else if(t.fields.dataSource.length){a();var b=t.element.parentElement;b.getElementsByClassName("e-spreadsheet-ftrchk")[0].classList.add("e-hide");var w=this.parent.createElement("div",{className:"e-checkfltrnmdiv"}),I=this.parent.createElement("span");I.innerText=this.parent.serviceLocator.getService(fe).getConstant("NoResult"),w.appendChild(I),b.appendChild(w)}}else s=e,a(),t.checkedNodes=i,t.refresh()},o.prototype.openDialog=function(e){var t=this,i=parseInt(e.getAttribute("aria-colindex"),10),r=Pi(i);this.parent.showSpinner();var n=this.parent.activeSheetIndex,s=this.filterRange.get(n),a=s.range.slice(),l=this.parent.getActiveSheet(),h=G(a[0],i-1,l),u=this.parent.getDisplayText(h);s.allowHeaderFilter||(a[0]=a[0]+1),s.useFilterRange||(a[2]=l.usedRange.rowIndex);var c=[a[0],i-1,a[2],i-1],d=this.getPredicateRange(c,this.filterCollection.get(n),i-1),p=d.otherColPredicate,f,v=d.curPredicate;v.length&&(f={},f[r]=v);var m=l.name+"!"+d.address,y=Be(c),S=this.getColumnType(l,i-1,a,!0),b=S.type,w,I=b==="date"||S.isDateAvail,x=b==="number",M=I||x,D=S.isMultiFormattedCol;M&&!d.filteredCol&&(w=[]),fa(this.parent,m,!0,!0,null,!0,null,null,!0,y,null,w).then(function(A){var L;t.parent.element.style.position="relative",t.parent.element.classList.add("e-filter-open");var T;if(M){if(w||!p.length)L=new re(w||A);else{var k=t.getPredicates(p),F=Rx(new re(A),k.predicates,k.equalOrPredicates);L=new re(F)}var R=function(ye){t.parent.off(qF,R),ye.isCheckboxFilterTemplate=!0,I?t.initTreeView(ye,$):t.initCboxList(ye,$,A)};t.parent.on(qF,R,t),T=[]}else{if(p.length){var N=t.getPredicates(p),F=Rx(new re(A),N.predicates,N.equalOrPredicates);L=new re(F)}else L=new re(A);T=t.getClonedPredicates(v)}var P=e.querySelector(".e-filter-btn"),O={field:r,filter:{}};if(x){var z=t.parent;O.filterTemplate=function(ye){if(z.isReact&&ye)ye.appendChild(z.createElement("input",{className:"e-ss-filter-input"}));else return[z.createElement("input",{className:"e-ss-filter-input"})]};var H=function(ye){return function(De,ve,ue,Tt,_e,lt,We){return ye(We)}};O.getFilterTemplate=function(){return H(O.filterTemplate)},z.isReact&&!z.renderTemplates&&(z.renderTemplates=function(ye){return ye()})}var Q={type:b,field:r,format:b==="date"?"yMd":null,displayName:u||"Column "+r,dataSource:L||[],height:t.parent.element.classList.contains("e-bigger")?800:500,columns:[],hideSearchbox:!1,filteredColumns:T,column:O,handler:t.filterSuccessHandler.bind(t,new re(A)),target:P,position:{X:0,Y:0},localeObj:t.parent.serviceLocator.getService(fe),actualPredicate:f,isFormatted:M&&!I,isMultiFormattedCol:D},$=new aN(t.parent,t.getLocalizedCustomOperators());$.openDialog(Q);var U=document.querySelector(".e-filter-popup");if(U&&U.id.includes(t.parent.element.id)){E.add(U,Cd(),t.filterMouseDownHandler,t);var ie=t.parent.element.getBoundingClientRect(),ne=P.getBoundingClientRect(),te=U.getBoundingClientRect(),oe=ne.right-ie.left-te.width;oe<0&&(oe=ne.left-ie.left),U.style.left=oe*t.parent.viewport.scaleX+"px",U.style.top="0px",U.style.visibility="hidden",U.classList.contains("e-hide")&&U.classList.remove("e-hide");var ae=ne.bottom-ie.top;te.height-(ie.bottom-ne.bottom)>0&&(ae-=te.height-(ie.bottom-ne.bottom),ae<0&&(ae=0)),U.style.top=ae*t.parent.viewport.scaleY+"px",U.style.visibility=""}t.parent.hideSpinner()})},o.prototype.getPredicateRange=function(e,t,i){var r=Be(e),n,s=[],a=[];if(t&&t.length){var l,h;t.forEach(function(u){u.field&&(l=""+u.field+(e[0]+1)+":"+u.field+(e[2]+1),h=vn(u.field),r.includes(l)||(r+=","+l,h<e[1]&&(e[1]=h),h>e[3]&&(e[3]=h)),i!==void 0&&(h===i?(n=!0,a.push(u)):s.push(u)))})}else n=!0;return i===void 0?r:{address:r,filteredCol:n,otherColPredicate:s,curPredicate:a}},o.prototype.filterDialogCreatedHandler=function(){var e=document.querySelector(".e-filter-popup");e&&e.id.includes(this.parent.element.id)&&e.classList.contains("e-popup-close")&&e.classList.add("e-hide")},o.prototype.filterCboxValueHandler=function(e){if(e.column&&e.data){var t=e.column.field;if(e.value){var i=Se(t+e.data.dataObj.__rowIndex),r=G(i[0],i[1],this.parent.getActiveSheet());r&&r.format&&(e.value=this.parent.getDisplayText(r))}}},o.prototype.selectSortItemHandler=function(e){var t=this.parent.serviceLocator.getService(fe),i=e.classList.contains("e-filter-sortasc")?"Ascending":e.classList.contains("e-filter-sortdesc")?"Descending":null;if(i==="Ascending"?e.setAttribute("aria-label",t.getConstant("SortAscending")):e.setAttribute("aria-label",t.getConstant("SortDescending")),!!i){var r=this.parent.getActiveSheet(),n=this.parent.activeSheetIndex,s=this.filterRange.get(n),a=s.range.slice();if(s.allowHeaderFilter||(a[0]=a[0]+1),s.useFilterRange||(a[2]=r.usedRange.rowIndex),qi(this.parent,a)){this.closeDialog(),this.parent.notify(nr,null);return}this.parent.sortCollection=this.parent.sortCollection?this.parent.sortCollection:[];for(var l=[],h=this.parent.sortCollection.length-1;h>=0;h--)this.parent.sortCollection[h]&&this.parent.sortCollection[h].sheetIndex===n&&(l.push(this.parent.sortCollection[h]),this.parent.sortCollection.splice(h,1));this.parent.sortCollection.push({sortRange:Be(a),columnIndex:Qi(r.activeCell)[1],order:i,sheetIndex:n}),this.parent.notify(Mu,{sortOptions:{sortDescriptors:{order:i},containsHeader:!1},previousSort:l,range:Be(a)}),this.refreshFilterRange(),this.closeDialog()}},o.prototype.filterSuccessHandler=function(e,t){var i=t.sIdx;!i&&i!==0&&(i=t.isOpen?0:this.parent.activeSheetIndex);var r=t.prevPredicates||[].slice.call(this.filterCollection.get(i));t.isFilterByValue&&!r.length&&(r=void 0);var n=this.filterCollection.get(i);if(this.updatePredicate(n,t.field),!(t.action==="clear-filter"&&n.length===r.length)){if(t.action==="filtering"){var s=function(u){return u.map(function(c){return c&&typeof c.value=="string"&&c.value.includes("*")&&(c.value.startsWith("*")&&c.value.endsWith("*")?(c.value=c.value.split("*").join(""),c.operator="contains"):c.value.endsWith("*")?(c.value=c.value.split("*").join(""),c.operator="startswith"):c.value.startsWith("*")&&(c.value=c.value.split("*").join(""),c.operator="endswith")),c})};n=n.concat(s(t.filterCollection))}this.filterCollection.set(i,n);var a=this.getPredicates(n),l={datasource:e,predicates:a.predicates,equalOrPredicates:a.equalOrPredicates},h=this.filterRange.get(i);h.useFilterRange||(h.range[2]=ke(this.parent,i).usedRange.rowIndex),this.applyFilter(l,Be(h.range),i,r,!1,t.isInternal,t.isFilterByValue)}},o.prototype.isCustomNumFilter=function(e){return e.includes("greaterthan")||e.includes("lessthan")||e==="between"},o.prototype.getClonedPredicates=function(e,t){t===void 0&&(t=[]);for(var i=[],r,n,s=0;s<e.length;s++)r=e[s],(this.isCustomNumFilter(r.operator)||!r.isFilterByMenu&&r.operator==="notequal")&&Me(r.value)?(i.push(Object.assign({},r,{field:r.field+"_value",type:"number"})),n=!0):(!r.isFilterByMenu&&r.operator==="equal"&&r.predicate==="or"&&t.push(r.field),i.push(r));return!n&&t.length&&t.splice(0),i},o.prototype.updatePredicate=function(e,t){for(var i=new re(e),r=new Pe,n=i.executeLocal(r.where("field","equal",t)),s=0;s<n.length;s++){for(var a=-1,l=0;l<e.length;l++)if(e[l].field===n[s].field){a=l;break}a!==-1&&e.splice(a,1)}},o.prototype.applyFilter=function(e,t,i,r,n,s,a){var l=this,h={range:t,predicates:[].slice.call(this.filterCollection.get(i)),previousPredicates:r,sheetIndex:i,cancel:!1};if(!(!s&&!a&&(this.parent.notify(ai,{action:"filter",eventArgs:h}),h.cancel))){t.indexOf("!")<0&&(t=this.parent.sheets[i].name+"!"+t),this.parent.showSpinner();var u=new Promise(function(f){f(function(){}())}),c={args:{range:t,filterOptions:e},promise:u,refresh:n},d=eh(this.parent);this.parent.notify(my,c);var p=eh(this.parent);this.parent.notify(hb,{prevChartIndexes:d,currentChartIndexes:p}),c.promise.then(function(f){return l.refreshFilterRange(),l.parent.hideSpinner(),s||(delete h.cancel,l.parent.notify(mt,{action:"filter",eventArgs:h}),document.activeElement.id!==l.parent.element.id+"_SearchBox"&&Fe(l.parent.element)),Promise.resolve(f)}).catch(function(f){return l.filterRangeAlertHandler({error:f}),Promise.reject(f)})}},o.prototype.getPredicates=function(e){var t,i=[],r=this.getClonedPredicates(e,i);if(i.length){for(var n=void 0,s=void 0,a=new Map,l=0;l<r.length;l++)n=r[l].field.replace("_value",""),i.indexOf(n)>-1&&(s=r.splice(l,1)[0],l--,a.has(n)?a.get(n).push(s):a.set(n,[s]));t=[];var h;a.forEach(function(v){h=[];for(var m=Nm.getPredicate(v),y=0,S=Object.keys(m);y<S.length;y++){var b=S[y];h.push(m[""+b])}t.push(h)})}for(var u=[],c=Nm.getPredicate(r),d=0,p=Object.keys(c);d<p.length;d++){var f=p[d];u.push(c[""+f])}return{predicates:u,equalOrPredicates:t}},o.prototype.getColumnType=function(e,t,i,r){for(var n=0,s=0,a=0,l=0,h,u,c,d,p=i[0];p<=i[2];p++)if(h=G(p,t,e),h&&!(r&&!(h.value||Number(h.value)===0))){if(h.format&&h.format!=="General"){var f=Er(h.format).toLowerCase();switch(f){case"number":case"currency":case"accounting":case"percentage":n++;break;case"shortdate":case"longdate":a++;break;case"time":n++;break;case"text":s++;break;default:u={},qs(h.format,!0,u)?u.type==="date"?a++:n++:Me(h.value)?n++:h.value&&s++;break}c||(c=h.format)}else Me(h.value)?n++:h.value&&s++;c&&c!==h.format&&(d=!0)}return{type:n>s&&n>a&&n>l?"number":s>=n&&s>=a&&s>=l?"string":a>n&&a>s&&a>l?"date":"datetime",isDateAvail:!!a,isMultiFormattedCol:d}},o.prototype.clearFilterHandler=function(e){var t=e&&!g(e.sheetIndex)?e.sheetIndex:this.parent.activeSheetIndex;if(e&&e.field){var i=[].slice.call(this.filterCollection.get(t));i&&i.length&&(this.updatePredicate(i,e.field),this.initiateFilterUIHandler({predicates:i,range:Be(this.filterRange.get(t).range),sIdx:t}))}else{var r=e&&e.isAction,n={isFiltered:!1,isClearAll:!0,sheetIndex:t};if(this.getFilteredColumnHandler(n),n.isFiltered||e&&e.preventRefresh){var s=void 0,a=ke(this.parent,t),l=this.filterRange.get(t),h=l.range;if(r&&(s={range:Be(h),predicates:[],previousPredicates:this.filterCollection.get(t),sheetIndex:t,cancel:!1},this.parent.notify(ai,{action:"filter",eventArgs:s}),s.cancel))return;this.filterCollection.set(t,[]);var u=l.useFilterRange?h[2]:a.usedRange.rowIndex;if(this.parent.scrollSettings.enableVirtualization&&u-h[0]+1>this.parent.viewport.rowCount+this.parent.getThreshold("row")*2){for(var c=0;c<=u;c++)hs(a,c,{hidden:!1,isFiltered:!1});(!e||!e.preventRefresh)&&this.parent.renderModule.refreshSheet(!1,!1,!0)}else{this.refreshFilterRange(null,null,t);var d={startIndex:h[0],hide:!1,isFiltering:!0,refreshUI:!1,endIndex:l.useFilterRange?h[2]:a.usedRange.rowIndex,sheetIndex:t};this.parent.notify(Dn,d),d.refreshUI&&(!e||!e.preventRefresh)&&this.parent.renderModule.refreshSheet(!1,!1,!0)}r&&(delete s.cancel,this.parent.notify(mt,{action:"filter",eventArgs:s}),Fe(this.parent.element))}}},o.prototype.reapplyFilterHandler=function(e,t){var i=this,r=this.parent.activeSheetIndex;if(this.filterRange.has(r)){var n=this.filterCollection.get(r);if(n&&n.length){var s=ke(this.parent,r),a=this.filterRange.get(r),l=a.range.slice();a.allowHeaderFilter||(l[0]=l[0]+1),a.useFilterRange||(l[2]=s.usedRange.rowIndex),l[1]=l[3]=vn(n[0].field);var h=s.name+"!"+this.getPredicateRange(l,n.slice(1,n.length));fa(this.parent,h,!0,!0,null,!0,null,null,!1,Be(l)).then(function(u){var c=i.getPredicates(i.filterCollection.get(r));i.applyFilter({predicates:c.predicates,datasource:new re(u),equalOrPredicates:c.equalOrPredicates},Be(a.range),r,[].slice.call(n),t,e)})}}},o.prototype.getFilterRangeHandler=function(e){var t=g(e.sheetIdx)?this.parent.activeSheetIndex:e.sheetIdx,i=this.filterRange&&this.filterRange.get(t);i?(e.hasFilter=!0,e.filterRange=i.range,e.allowHeaderFilter=i.allowHeaderFilter,e.isFiltered=this.filterCollection&&this.filterCollection.get(t)&&this.filterCollection.get(t).length>0):(e.hasFilter=!1,e.filterRange=null)},o.prototype.getLocalizedCustomOperators=function(){var e=this.parent.serviceLocator.getService(fe),t=[{value:"equal",text:e.getConstant("Equal")},{value:"greaterthan",text:e.getConstant("GreaterThan")},{value:"greaterthanorequal",text:e.getConstant("GreaterThanOrEqual")},{value:"lessthan",text:e.getConstant("LessThan")},{value:"lessthanorequal",text:e.getConstant("LessThanOrEqual")},{value:"notequal",text:e.getConstant("NotEqual")}],i={stringOperator:[{value:"startswith",text:e.getConstant("StartsWith")},{value:"endswith",text:e.getConstant("EndsWith")},{value:"contains",text:e.getConstant("Contains")},{value:"equal",text:e.getConstant("Equal")},{value:"isempty",text:e.getConstant("IsEmpty")},{value:"doesnotstartwith",text:e.getConstant("NotStartsWith")},{value:"doesnotendwith",text:e.getConstant("NotEndsWith")},{value:"doesnotcontain",text:e.getConstant("NotContains")},{value:"notequal",text:e.getConstant("NotEqual")},{value:"isnotempty",text:e.getConstant("IsNotEmpty")}],numberOperator:t,dateOperator:t,datetimeOperator:t,booleanOperator:[{value:"equal",text:e.getConstant("Equal")},{value:"notequal",text:e.getConstant("NotEqual")}]};return i},o.prototype.setFilteredCollection=function(e){var t=this,i={sheetIdx:e.sheetIdx};if(this.getFilterRangeHandler(i),i.hasFilter){var r={sheetIndex:e.sheetIdx,filterRange:Be(i.filterRange),hasFilter:!0,column:[],criteria:[],value:[],dataType:[],predicates:[]};e.saveJson.filterCollection.push(r);for(var n=this.filterCollection.get(e.sheetIdx),s=new Map,a=void 0,l,h=function(p){if(g(p))return"";if(e.isSaveAction&&l==="date"){var f=p;p=f.getMonth()+1+"/"+f.getDate()+"/"+f.getFullYear()+" "+f.getHours()+":"+f.getMinutes()+":"+f.getSeconds()}return p},u=0;u<n.length;u++)a=n[u],e.isSaveAction&&a.operator==="notequal"&&a.isFilterByMenu?s.has(a.field)?s.get(a.field).push(a):s.set(a.field,[a]):(r.column.push(vn(a.field)),r.criteria.push(a.operator),e.isSaveAction?a.operator==="equal"?(l=wo(a.value)?"date":"string",r.value.push(h(a.value)),r.dataType.push(l)):(r.value.push(a.value),r.dataType.push("custom")):(r.value.push(a.value),r.dataType.push(a.type)),r.predicates.push(a.predicate));var c=new Map,d;s.forEach(function(p,f){d=vn(f),c.has(f)||c.set(f,t.getColData(d,f,e.sheetIdx));for(var v=c.get(f),m=t.getPredicates(p).predicates,y=new re(v).executeLocal(new Pe().where(St.and(m))),S=0;S<y.length;S++)r.column.push(d),r.criteria.push("equal"),l=wo(y[S][f])?"date":"string",r.value.push(h(y[S][f])),r.dataType.push(l),r.predicates.push("or")})}},o.prototype.updateFilter=function(e){if(this.parent.filterCollection&&(e.initLoad||e.isOpen)){for(var t=void 0,i=void 0,r=void 0,n={},s=void 0,a=void 0,l=void 0,h=0;h<this.parent.filterCollection.length;h++){r=this.parent.filterCollection[h];var u=r.sheetIndex;if(h===0&&!this.parent.isOpen&&!e.isOpen&&(u=0),i=[],r.column)for(var c=0;c<r.column.length;c++)if(a={field:Pi(r.column[c]+1),operator:this.getFilterOperator(r.criteria[c]),value:typeof r.value[c]=="string"?r.value[c].split("*").join(""):r.value[c],predicate:r.predicates&&r.predicates[c],type:r.dataType&&r.dataType[c]},["year","month","day"].indexOf(a.type)>-1){var d={value:a.value,cell:{value:a.value}};if(this.parent.notify(Jr,d),d.isDate){var p=d.dateObj;if(a.value=p,a.type==="day")a.type="date",a.predicate="or",i.push(a);else{a.operator="greaterthanorequal",a.predicate="and";var f=a.type;a.type="date",t=this.getPredicates([a,{field:a.field,operator:"lessthanorequal",predicate:"and",type:"date",value:new Date(p.getFullYear(),f==="year"?12:p.getMonth()+1,0,0,0,0)}]).predicates,n[a.field]||(n[a.field]=this.getColData(r.column[c],a.field,h)),s=new re(n[a.field]).executeLocal(new Pe().where(St.and(t)));for(var v=0;v<s.length;v++)i.push({field:a.field,operator:"equal",predicate:"or",type:"date",value:s[v][a.field]})}}}else{if(l={isOpen:!0,instance:{options:{type:a.type}},arg3:a.value,arg2:a.operator},this.beforeFilteringHandler(l),a.value=l.arg3,a.type==="string"||a.type==="custom")this.isCustomNumFilter(a.operator)&&Me(a.value)&&(a.type="number");else if(a.type==="date"&&a.operator==="equal"&&typeof a.value=="string"&&a.value.includes("/")&&a.value.includes(":")){var m=a.value.split(" ");if(m.length===2){var y=m[0].split("/"),S=m[1].split(":");y.length===3&&S.length===3&&(a.value=new Date(Number(y[2]),Number(y[0])-1,Number(y[1]),Number(S[0]),Number(S[1]),Number(S[2])))}}i.push(a)}if(!e.isOpen)for(var b=0;b<i.length-1;b++)i[b].field===i[b+1].field&&(i[b].predicate||(i[b].predicate="or"),i[b+1].predicate||(i[b+1].predicate="or"));this.parent.notify(Eo,{predicates:i.length?i:void 0,range:r.filterRange,sIdx:u,isInternal:!0,isOpen:e.isOpen})}this.parent.sortCollection&&this.parent.notify(uy,null),this.parent.setProperties({filterCollection:null},!0)}},o.prototype.getColData=function(e,t,i){var r=ke(this.parent,i);if(!r.rows||!r.rows.length)return[];for(var n=[],s,a,l=1,h=r.rows.length;l<h;l++)r.rows[l]&&(a=G(l,e,r,!1,!0),a&&a.value&&(s={},s[t]=Hy(this.parent,a,l,e),n.push(s)));return n},o.prototype.getFilterOperator=function(e){switch(e){case"BeginsWith":e="startswith";break;case"Less":e="lessthan";break;case"EndsWith":e="endswith";break;case"Equal":e="equal";break;case"Notequal":e="notEqual";break;case"Greater":e="greaterthan";break;case"Contains":e="contains";break;case"LessOrEqual":e="lessthanorequal";break;case"GreaterOrEqual":e="greaterthanorequal";break;case"NotContains":e="doesnotcontain";break;case"NotBeginsWith":e="doesnotstartwith";break;case"NotEndsWith":e="doesnotendwith";break;case"Empty":e="isempty";break;case"NotEmpty":e="isnotempty";break}return e},o.prototype.beforeInsertHandler=function(e){if(e.modelType==="Column"){var t=Ee(e.activeSheetIndex)?this.parent.activeSheetIndex:e.activeSheetIndex;if(this.filterRange.size&&this.filterRange.has(t)){var i=this.filterRange.get(t).range;(this.isFilterCell(t,i[0],e.index)||e.index<i[1])&&(i[3]+=e.model.length,e.index<=i[1]&&(i[1]+=e.model.length),this.filterCollection.get(t).forEach(function(a){var l=vn(a.field);e.index<=l&&(a.field=Pi(l+e.model.length+1))}),this.parent.sortCollection&&this.parent.sortCollection.forEach(function(a){a.sheetIndex===t&&e.index<=a.columnIndex&&(a.columnIndex+=e.model.length)}))}}else if(e.modelType==="Sheet"){for(var r=0,n=Array.from(this.filterRange.keys()).sort().reverse();r<n.length;r++){var s=n[r];e.index<=s&&(this.filterRange.set(s+e.model.length,this.filterRange.get(s)),this.filterRange.delete(s),this.filterCollection.set(s+e.model.length,this.filterCollection.get(s)),this.filterCollection.delete(s))}this.parent.sortCollection&&this.parent.sortCollection.forEach(function(a){e.index<=a.sheetIndex&&(a.sheetIndex+=e.model.length)})}},o.prototype.beforeDeleteHandler=function(e){if(e.modelType==="Column"){var t=this.parent.activeSheetIndex;if(this.filterRange.size&&this.filterRange.has(t)){var i=!0,r=this.filterRange.get(t).range;if(e.start>=r[1]&&e.end<=r[3]?r[3]-=e.end-e.start+1:e.start<r[1]&&e.end<r[1]?(r[1]-=e.end-e.start+1,r[3]-=e.end-e.start+1):e.start<r[1]&&e.end>r[1]&&e.end<r[3]?(r[1]=e.start,r[3]-=e.end-e.start+1):i=!1,i){for(var n=this.filterCollection.get(t),s=void 0,a=n.length-1;a>=0;a--){var l=vn(n[a].field);e.end<l?n[a].field=Pi(l-(e.end-e.start+1)+1):e.start<=l&&e.end>=l&&(s=!0,n.splice(a,1))}var h=this.parent.sortCollection;if(h){for(var a=0;a<h.length;a++)if(h[a].sheetIndex===t){if(e.end<h[a].columnIndex){h[a].columnIndex=h[a].columnIndex-(e.end-e.start+1);break}else if(e.start<=h[a].columnIndex&&e.end>=h[a].columnIndex){h.splice(a,1);break}}}r.some(function(u){return u<0})?(this.removeFilter(t,!0,!0),e.refreshSheet=!0):s&&(n&&n.length?(this.reapplyFilterHandler(!0,!0),e.refreshSheet=!1):(this.clearFilterHandler({preventRefresh:!0}),e.refreshSheet=!0))}}}},o.prototype.deleteSheetHandler=function(e){if(Ee(e.sheetIndex))this.filterRange.get(this.parent.activeSheetIndex)&&(this.filterRange.delete(this.parent.activeSheetIndex),this.filterCollection.delete(this.parent.activeSheetIndex));else{for(var t=0,i=Array.from(this.filterRange.keys()).sort().reverse();t<i.length;t++){var r=i[t];e.sheetIndex===r?(this.filterRange.delete(r),this.filterCollection.delete(r)):e.sheetIndex<r&&(this.filterRange.set(r-1,this.filterRange.get(r)),this.filterRange.delete(r),this.filterCollection.set(r-1,this.filterCollection.get(r)),this.filterCollection.delete(r))}var n=this.parent.sortCollection;if(n)for(var s=n.length-1;s>=0;s--)e.sheetIndex===n[s].sheetIndex?n.splice(s,1):e.sheetIndex<n[s].sheetIndex&&(n[s].sheetIndex-=1)}},o.prototype.clearHandler=function(e){var t=this.parent.getAddressInfo(e.range);if(this.filterRange.has(t.sheetIndex)){var i=this.filterRange.get(t.sheetIndex).range.slice();Co(t.indices,i[0],i[1])&&Co(t.indices,i[0],i[3])&&this.removeFilter(t.sheetIndex,null,null,!0)}},o.prototype.duplicateSheetFilterHandler=function(e){for(var t=0,i=Array.from(this.filterRange.keys()).sort().reverse();t<i.length;t++){var r=i[t];if(e.newSheetIndex<=r)this.filterRange.set(r+1,this.filterRange.get(r)),this.filterRange.delete(r),this.filterCollection.set(r+1,this.filterCollection.get(r)),this.filterCollection.delete(r);else break}if(this.filterCollection.has(e.sheetIndex)&&this.filterCollection.set(e.newSheetIndex,this.filterCollection.get(e.sheetIndex).slice()),this.filterRange.has(e.sheetIndex)){var n=this.filterRange.get(e.sheetIndex);this.filterRange.set(e.newSheetIndex,{useFilterRange:n.useFilterRange,range:n.range.slice(),allowHeaderFilter:n.allowHeaderFilter})}},o.prototype.updateSortCollectionHandler=function(e){var t;if(e.isDuplicate){if(this.parent.sortCollection&&this.parent.sortCollection.length>0){for(var i=[],r=0;r<this.parent.sortCollection.length;r++){var n=this.parent.sortCollection[r];if(n.sheetIndex===e.curSheetIndex){var s=Object.assign({},n);s.sheetIndex=e.newSheetIndex,i.push(s)}}(t=this.parent.sortCollection).push.apply(t,i)}return}var a=this.parent.getActiveSheet(),l=this.parent.activeSheetIndex,h=this.filterRange.get(l);if(h){var u=h.range.slice();h.allowHeaderFilter||(u[0]=u[0]+1),h.useFilterRange||(u[2]=a.usedRange.rowIndex);var c=e.sortOptions.sortDescriptors;if(this.parent.sortCollection=this.parent.sortCollection?this.parent.sortCollection:[],Array.isArray(c))for(var d=0;d<c.length;d++)this.parent.sortCollection.push({sortRange:Be(u),columnIndex:vn(c[d].field),order:c[d].order,sheetIndex:l});else this.parent.sortCollection.push({sortRange:Be(u),columnIndex:Qi(a.activeCell)[1],order:c.order,sheetIndex:l})}},o.prototype.moveSheetHandler=function(e){var t,i,r,n;this.filterRange.has(e.prevIndex)&&(t=this.filterRange.get(e.prevIndex),r=this.filterCollection.get(e.prevIndex)),this.filterRange.has(e.currentIndex)&&(i=this.filterRange.get(e.currentIndex),n=this.filterCollection.get(e.currentIndex)),t&&i?(this.filterRange.set(e.currentIndex,t),this.filterRange.set(e.prevIndex,i),this.filterCollection.set(e.currentIndex,r),this.filterCollection.set(e.prevIndex,n)):t?(this.filterRange.set(e.currentIndex,t),this.filterRange.delete(e.prevIndex),this.filterCollection.set(e.currentIndex,r),this.filterCollection.delete(e.prevIndex)):i&&(this.filterRange.set(e.prevIndex,i),this.filterRange.delete(e.currentIndex),this.filterCollection.set(e.prevIndex,n),this.filterCollection.delete(e.currentIndex))},o.prototype.refreshFilterCellsOnResize=function(e){var t=this.filterRange.has(this.parent.activeSheetIndex)&&this.filterRange.get(this.parent.activeSheetIndex).range;if(t&&t[0]===e.rowIndex){for(var i=this.parent.getActiveSheet(),r=t[1];r<=t[3];r++)if(G(e.rowIndex,r,i,!1,!0).notes){var n=this.parent.getCell(e.rowIndex,r);n&&this.parent.serviceLocator.getService("cell").refresh(e.rowIndex,r,!1,n,!1,!1,!0)}}},o}(),Jq=function(){function o(e){this.parent=e,this.addEventListener(),this.renderImageUpload()}return o.prototype.addEventListener=function(){this.parent.on(DI,this.insertImage,this),this.parent.on(Sd,this.refreshImgCellObj,this),this.parent.on(Ya,this.createImageElement,this),this.parent.on(ga,this.deleteImage,this),this.parent.on(ub,this.refreshInsDelImagePosition,this)},o.prototype.renderImageUpload=function(){var e=this.parent.createElement("input",{id:this.parent.element.id+"_imageUpload",attrs:{type:"file",accept:".image, .jpg, .png, .gif ,jpeg",name:"fileUpload"}});e.style.display="none",this.parent.element.appendChild(e),e.onchange=this.imageSelect.bind(this)},o.prototype.imageSelect=function(e){var t=e.target.files[0];t&&(t.type.includes("image")?this.insertImage({file:t,isAction:!0}):this.parent.serviceLocator.getService(jt).show({content:this.parent.serviceLocator.getService("spreadsheetLocale").getConstant("UnsupportedFile"),width:"300"}),e.target.value="")},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(DI,this.insertImage),this.parent.off(Sd,this.refreshImgCellObj),this.parent.off(Ya,this.createImageElement),this.parent.off(ga,this.deleteImage),this.parent.off(ub,this.refreshInsDelImagePosition))},o.prototype.insertImage=function(e,t){var i=this;this.binaryStringVal(e).then(function(r){return i.createImageElement({options:{src:r},range:t,isPublic:!0,isAction:e.isAction})})},o.prototype.binaryStringVal=function(e){return new Promise(function(t,i){var r=new FileReader;r.readAsDataURL(e.file),r.onload=function(){return t(r.result)},r.onerror=function(n){return i(n)}})},o.prototype.createImageElement=function(e){var t=e.range?e.range.lastIndexOf("!"):0,i=e.range?t>0?e.range.substring(t+1):e.range:this.parent.getActiveSheet().selectedRange,r=e.range&&t>0?yt(this.parent,e.range.substring(0,t)):this.parent.activeSheetIndex,n=this.parent.serviceLocator.getService(eM),s=e.options.id?e.options.id:kt(this.parent.element.id+"_overlay_picture_"),a=J(i),l=Ee(r)&&!e.isUndoRedo?this.parent.getActiveSheet():this.parent.sheets[r];if(!(!l||this.parent.element.querySelector("#"+s))){if(e.isPublic&&qi(this.parent,a)){e.isAction&&this.parent.notify(nr,null);return}var h={requestType:"beforeInsertImage",range:l.name+"!"+i,imageData:e.options.src,sheetIndex:r};if(e.isPublic&&this.parent.notify("actionBegin",{eventArgs:h,action:"beforeInsertImage"}),!h.cancel){var u=n.insertOverlayElement(s,i,r);u.element.style.backgroundImage="url('"+e.options.src+"')",(e.options.height||e.options.left)&&(u.element.style.height=e.options.height+"px",u.element.style.width=e.options.width+"px",g(e.options.top)||(u.element.style.top=Number(dh(e.options.top).toFixed(2))+"px"),g(e.options.left)||(u.element.style.left=Number(dh(e.options.left).toFixed(2))+"px")),(l.frozenRows||l.frozenColumns)&&n.adjustFreezePaneSize(e.options,u.element,i);var c={src:e.options.src,id:s,height:parseFloat(u.element.style.height.replace("px","")),width:parseFloat(u.element.style.width.replace("px","")),top:l.frozenRows||l.frozenColumns?a[0]?Ri(l,0,a[0]-1):0:u.top,left:l.frozenRows||l.frozenColumns?a[1]?Ci(l,0,a[1]-1):0:u.left};this.parent.setUsedRange(a[0],a[1]);var d=!1,p=!1;!e.isPublic&&!e.isUndoRedo&&(c.top!==e.options.top||c.left!==e.options.left)&&(e.options.top=c.top,e.options.left=c.left,d=!0);var f={options:[c],range:l.name+"!"+i,isPositionChanged:d,isElementRemoved:p};(e.isPublic||e.isUndoRedo||d)&&this.parent.notify(Dy,f),d&&f.isElementRemoved&&(u=n.insertOverlayElement(s,i,r),u.element.style.backgroundImage="url('"+e.options.src+"')");var v=G(a[0],a[1],l);v.image[v.image.length-1].id||(v.image[v.image.length-1].id=c.id),!e.isUndoRedo&&e.isPublic&&(h={requestType:"insertImage",range:l.name+"!"+i,imageHeight:e.options.height?e.options.height:300,imageWidth:e.options.width?e.options.width:400,imageData:e.options.src,id:s,sheetIndex:r},this.parent.notify("actionComplete",{eventArgs:h,action:"insertImage"}))}}},o.prototype.refreshInsDelImagePosition=function(e){for(var t=e.count,i=e.sheetIdx,r=this.parent.sheets[i],n,s=G(e.rowIdx,e.colIdx,r),a=s.image.length,l,h,u=0;u<a;u++)n=document.getElementById(s.image[u].id),l=e.type==="Row"?e.status==="insert"?s.image[u].top+t*20:s.image[u].top-t*20:s.image[u].top,h=e.type==="Column"?e.status==="insert"?s.image[u].left+t*64:s.image[u].left-t*64:s.image[u].left,s.image[u].top=l,s.image[u].left=h,n&&(n.style.top=l+"px",n.style.left=h+"px")},o.prototype.refreshImgCellObj=function(e){var t=Ee(e.sheetIdx)?this.parent.activeSheetIndex:e.sheetIdx,i=ke(this.parent,t),r=G(e.prevRowIdx,e.prevColIdx,i),n=G(e.currentRowIdx,e.currentColIdx,i),s=r?r.image:[],a,l,h=s&&s.length?s.length:0;if(r&&r.image&&s.length>0){for(var u=0;u<h;u++)s[u]&&s[u].id===e.id&&(a=s[u],a.height=e.currentHeight,a.width=e.currentWidth,a.top=e.currentTop,a.left=e.currentLeft,s.splice(u,1));if(n&&n.image&&(l=n.image,a&&l.push(a)),l?oi(e.currentRowIdx,e.currentColIdx,i,{image:l},!0):oi(e.currentRowIdx,e.currentColIdx,i,{image:[a]},!0),e.requestType==="imageRefresh"&&!e.isUndoRedo){var c={requestType:"imageRefresh",currentRowIdx:e.currentRowIdx,currentColIdx:e.currentColIdx,prevRowIdx:e.prevRowIdx,prevColIdx:e.prevColIdx,prevTop:e.prevTop,prevLeft:e.prevLeft,currentTop:e.currentTop,currentLeft:e.currentLeft,currentHeight:e.currentHeight,currentWidth:e.currentWidth,prevHeight:e.prevHeight,prevWidth:e.prevWidth,id:e.id,sheetIdx:this.parent.activeSheetIndex};this.parent.notify("actionComplete",{eventArgs:c,action:"imageRefresh"})}}},o.prototype.deleteImage=function(e){var t=e.sheet||this.parent.getActiveSheet(),i=document.getElementById(e.id),r=e.rowIdx,n=e.colIdx,s;if(i){if(e.rowIdx===void 0&&e.colIdx===void 0){var a=void 0,l=void 0;if(t.frozenRows||t.frozenColumns){var h=i.getBoundingClientRect();a={clientY:h.top},l={clientX:h.left},h.top<this.parent.getColumnHeaderContent().getBoundingClientRect().bottom&&(a.target=this.parent.getColumnHeaderContent()),h.left<this.parent.getRowHeaderContent().getBoundingClientRect().right&&(l.target=this.parent.getRowHeaderTable())}else a={clientY:parseFloat(i.style.top),isImage:!0},l={clientX:parseFloat(i.style.left),isImage:!0};this.parent.notify(Ys,a),this.parent.notify(Qs,l),r=a.clientY,n=l.clientX}if(s=t.name+"!"+et(r,n),!e.preventEventTrigger){var u={address:s,cancel:!1};if(this.parent.notify(ai,{action:"deleteImage",eventArgs:u}),u.cancel)return}document.getElementById(e.id).remove()}else if(!e.sheet){var c=e.range?e.range.lastIndexOf("!")>0?e.range.substring(e.range.lastIndexOf("!")+1):e.range:this.parent.getActiveSheet().selectedRange,d=e.range&&e.range.lastIndexOf("!")>0?yt(this.parent,e.range.substring(0,e.range.lastIndexOf("!"))):this.parent.activeSheetIndex,p=J(c);r=p[0],n=p[1],t=this.parent.sheets[d]}var f={};if(t){for(var v=G(r,n,t),m=v&&v.image?v.image:[],y=m.length,S=y-1;S>=0;S--)m[S].id===e.id&&(f=m.splice(S,1)[0]);oi(r,n,t,{image:m},!0)}e.preventEventTrigger||this.parent.notify(mt,{action:"deleteImage",eventArgs:{address:s,id:f.id,imageData:f.src,imageWidth:f.width,imageHeight:f.height,cancel:!1},preventAction:e.isUndoRedo,isClearAction:e.clearAction})},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.getModuleName=function(){return"spreadsheetImage"},o}();Zm.Inject(mF,vF,bF,yF,CF,xF,SF,IF);Zm.Inject(wF,gF,TF,EF,AF);ix.Inject(qm,FF,NF,kF);var e9=function(){function o(e){this.parent=e,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(Ey,this.initiateChartHandler,this),this.parent.on(ou,this.refreshChartCellObj,this),this.parent.on(hb,this.refreshChartCellModel,this),this.parent.on(Fx,this.refreshChartCellObj,this),this.parent.on(Eu,this.deleteChart,this),this.parent.on(cb,this.clearBorder,this),this.parent.on(AI,this.insertChartHandler,this),this.parent.on(Qc,this.chartRangeHandler,this),this.parent.on(lu,this.chartDesignTabHandler,this),this.parent.on(WF,this.updateChartElement,this),this.parent.on(TI,this.undoRedoForChartDesign,this),this.parent.on(lh,this.refreshChartData,this)},o.prototype.insertChartHandler=function(e){var t=this,i="Column",r=!1;switch(e.id){case"clusteredColumn":i="Column";break;case"stackedColumn":i="StackingColumn";break;case"stackedColumn100":i="StackingColumn100";break;case"clusteredBar":i="Bar";break;case"stackedBar":i="StackingBar";break;case"stackedBar100":i="StackingBar100";break;case"area":i="Area";break;case"stackedArea":i="StackingArea";break;case"stackedArea100":i="StackingArea100";break;case"line":i="Line";break;case"lineMarker":i="Line",r=!0;break;case"stackedLine":i="StackingLine";break;case"stackedLineMarker":i="StackingLine",r=!0;break;case"stackedLine100":i="StackingLine100";break;case"stackedLine100Marker":i="StackingLine100",r=!0;break;case"pie":i="Pie";break;case"doughnut":i="Doughnut";break;case"scatter":i="Scatter";break}var n=[{type:i,markerSettings:{visible:r,isFilled:!0}}];e.isChart?(this.parent.notify(oh,{chart:n}),cr(function(){return Fe(t.parent.element)})):this.parent.notify(lu,{chartType:i,triggerEvent:!0,markerVisible:r})},o.prototype.chartRangeHandler=function(){var e=document.querySelector(".e-datavisualization-chart.e-ss-overlay-active");if(e)for(var t=e.getElementsByClassName("e-control")[0].id,i=this.parent.chartColl,r=i.length,n=0;n<r;n++){var s=document.getElementById(i[n].id);e&&s&&i[n].id===t&&this.initiateChartHandler({option:i[n],isRefresh:!0})}},o.prototype.refreshChartData=function(e){if(!(!this.parent.chartColl||!this.parent.chartColl.length))for(var t,i,r,n,s,a,l=0,h=this.parent.chartColl.length;l<h;l++){if(t=this.parent.chartColl[l],t.range.includes("!")){if(i=t.range.substring(0,t.range.lastIndexOf("!")),this.parent.activeSheetIndex!==yt(this.parent,i))continue;r=t.range.substring(t.range.lastIndexOf("!")+1)}else r=t.range;if(e.viewportIndexes){for(var u=0;u<e.viewportIndexes.length;u++)if(zy([e.viewportIndexes[u]],r)){n=!0;break}}else n=e.range?zy([e.range],r):e.showHide?this.inRowColumnRange(J(r),e.rIdx,e.showHide):Co(J(r),e.rIdx,e.cIdx);(n||e.isSelectAll&&!e.isRefreshChart)&&(s=this.parent.element.querySelector("."+t.id),s&&(a=at(s,"chart")||at(s,"accumulationchart"),a&&(a.series=this.initiateChartHandler({option:t,isRefresh:!0}),a.refresh())))}},o.prototype.inRowColumnRange=function(e,t,i){return i==="rows"?t>=e[0]&&t<=e[2]:t>=e[1]&&t<=e[3]},o.prototype.refreshChartCellModel=function(e){for(var t=0,i=e.prevChartIndexes.length;t<i;t++){var r=e.prevChartIndexes[t].chart,n=e.prevChartIndexes[t].chartRowIdx,s=e.prevChartIndexes[t].chartColIdx,a=e.currentChartIndexes[t].chartRowIdx,l=e.currentChartIndexes[t].chartColIdx,h={prevTop:r.top,prevLeft:r.left,prevRowIdx:n,prevColIdx:s,prevHeight:r.height,prevWidth:r.width,currentTop:r.top,currentLeft:r.left,currentRowIdx:a,currentColIdx:l,currentHeight:r.height,currentWidth:r.width,id:r.id,requestType:"chartRefreshOnFilter"};this.parent.notify(ou,h)}},o.prototype.refreshChartCellObj=function(e){var t=Ee(e.sheetIdx)?this.parent.activeSheetIndex:e.sheetIdx,i=ke(this.parent,t),r=G(e.prevRowIdx,e.prevColIdx,i),n=G(e.currentRowIdx,e.currentColIdx,i),s=r?r.chart:[],a,l,h=s&&s.length?s.length:0;if(h){for(var u=0;u<h;u++)if(s[u].id===e.id.split("_overlay")[0]){a=s[u],a.height=e.currentHeight,a.width=e.currentWidth,a.top=e.currentTop,a.left=e.currentLeft,s.splice(u,1),u--,h--;for(var c=0,d=this.parent.chartColl.length;c<d;c++)a.id===this.parent.chartColl[c].id&&(a.height=e.currentHeight,this.parent.chartColl[c].width=e.currentWidth,this.parent.chartColl[c].top=e.currentTop,this.parent.chartColl[c].left=e.currentLeft)}if(n&&n.chart&&(l=n.chart,a&&l.push(a)),l?oi(e.currentRowIdx,e.currentColIdx,i,{chart:l},!0):oi(e.currentRowIdx,e.currentColIdx,i,{chart:[a]},!0),e.requestType==="chartRefresh"&&!e.isUndoRedo){var p={requestType:"chartRefresh",currentRowIdx:e.currentRowIdx,currentColIdx:e.currentColIdx,currentWidth:e.currentWidth,prevHeight:e.prevHeight,prevWidth:e.prevWidth,prevRowIdx:e.prevRowIdx,prevColIdx:e.prevColIdx,prevTop:e.prevTop,prevLeft:e.prevLeft,currentTop:e.currentTop,currentLeft:e.currentLeft,currentHeight:e.currentHeight,id:e.id,sheetIdx:t};this.parent.notify("actionComplete",{eventArgs:p,action:"chartRefresh"})}}},o.prototype.processChartRange=function(e,t,i){var r=this,n,s,a,l=e[0],h=e[1],u=!1,c=e[2],d=e[3],p=l===c,f=h===d,v,m,y=ke(this.parent,t),S=Nf(this.parent),b=function(M,D,A,L){var T=G(M,D,y);if(T){T.formula&&g(T.value)&&r.parent.notify(pu,{cell:T,rowIdx:M,colIdx:D,sheetIndex:t});var k=void 0;if(T.format){var F={value:T.value,format:T.format,formattedText:T.value,cell:T,rowIndex:M,colIndex:D};r.parent.notify(en,F);var R=Me(T.value);R&&!qs(T.format,!0,null,!0)?k=Number(T.value):(L&&R?v=!0:A&&R&&(m=!0),k=F.formattedText&&F.formattedText.toString())}else S(T),k=T.value;return g(k)?"":k}else return""},w=y?b(l,d,!1,!0):"",I=y?b(c,h,!0):"",x=y?b(l,h,!0):"";return(!Me(I)||!x)&&(u=!0),(g(x)||i.type==="Scatter"&&!i.isSeriesInRows)&&!p&&!f?(n=[l+1,h,c,h],s=[l+1,h+1,c,d],a=[l,h+1,l,d]):!g(I)&&u&&!p&&!f&&!v?!g(w)&&(!Me(w)||!x)?(n=[l+1,h,c,h],s=[l+1,h+1,c,d],a=[l,h+1,l,d]):(n=[l,h,c,h],s=[l,h+1,c,d]):(s=[l,h,c,d],!g(w)&&!Me(w)&&!v?(a=[l,h,l,d],p||(s[0]=s[0]+1)):(p||f)&&g(x)&&(a=[l,h,l,d],p?(s[1]=s[1]+1,a[3]=a[1]):s[0]=s[0]+1)),{xRange:n,yRange:s,lRange:a,isStringSeries:u,isDateTime:m}},o.prototype.getRangeData=function(e){var t=e.sheet;e.range?typeof e.range=="string"&&(e.range=J(e.range)):e.range=J(t.selectedRange);for(var i=[],r,n,s,a=e.range[0],l=e.isYvalue&&Nf(this.parent);a<=e.range[2];){if(st(t,a)){a++;continue}for(n=e.range[1];n<=e.range[3];){if(Ot(t,n)){n++;continue}var h=G(a,n,t,!1,!0);h.formula&&g(h.value)&&this.parent.notify(pu,{cell:h,rowIdx:a,colIdx:n,sheetIndex:e.sheetIdx}),e.isYvalue&&l(h),r={value:h.value||(h.value===0?0:null)},h.format?(s={formattedText:h.value,value:h.value,format:h.format,cell:h,skipFormatCheck:!0},this.parent.notify(en,s),e.isYvalue?Me(h.value)?(r.value=Number(h.value),r.displayText=s.formattedText?s.formattedText.toString():""):(r.displayText=r.value===null?"":this.parent.getDisplayText({format:h.format,value:"0"}),r.value=0):e.isScatter&&!e.isDateTime&&Me(h.value)?r.value=Number(h.value):r.value=s.formattedText?s.formattedText.toString():null):e.isYvalue&&(Me(r.value)?(r.displayText=r.value.toString(),r.value=Number(r.value)):(r.displayText=r.value===null?"":"0",r.value=0)),i.push(r),n++}a++}return i},o.prototype.toArrayData=function(e){for(var t="value",i,r=0,n=[],s=e.length;r<s;)i=e[r],Object.keys(i).length?t in i&&n.push(i[""+t]):n.push(""),r++;return n},o.prototype.getVirtualXValues=function(e){for(var t=1,i=[];t<e;)i.push(t.toString()),t++;return i},o.prototype.processChartSeries=function(e,t,i,r,n,s){e=e||{};var a,l={name:"displayText"},h,u,c,d,p={},f,v=0,m=0,y=this.parent.isPrintingProcessing,S=[];t=g(t)?this.parent.activeSheetIndex:t;var b=ke(this.parent,t),w=e&&e.type==="Scatter",I=this.getRangeData({range:r,sheet:b,isYvalue:!0,sheetIdx:t}),x=r[2]-r[0]+1-this.parent.hiddenCount(r[0],r[2],"rows",b),M=r[3]-r[1]+1-this.parent.hiddenCount(r[1],r[3],"columns",b);e.isSeriesInRows?(h=n?this.toArrayData(this.getRangeData({range:n,sheet:b,isScatter:w,isDateTime:s})):this.getVirtualXValues(M+1),i&&(u=this.toArrayData(this.getRangeData({range:i,sheet:b}))),c=x):(h=i?this.toArrayData(this.getRangeData({range:i,sheet:b,isScatter:w,isDateTime:s})):this.getVirtualXValues(x+1),n&&(u=this.toArrayData(this.getRangeData({range:n,sheet:b}))),c=M);var D=h.length,A=e.isSeriesInRows?1:c;for(g(e.dataLabelSettings)||(l.visible=e.dataLabelSettings.visible,l.position=e.dataLabelSettings.position);v<c;){for(f=0,d=[],m=e.isSeriesInRows?m:v;f<D;)g(h[f])&&(h[f]=kt("spread-chart-empty-label-")),d.push({x:h[f],y:I[m].value,displayText:I[m].displayText}),m+=A,f++;if(u&&u.length>0?a=u[v]:a=e.type==="Scatter"?"series"+(v+1):"series"+v,a=g(a)?"":a.toString(),e.type){var L=e.type;L==="Line"||L==="StackingLine"||L==="StackingLine100"?p={dataSource:d,type:e.type,xName:"x",yName:"y",name:a,animation:{enable:!y},tooltipMappingName:"displayText",marker:e.markerSettings?{visible:e.markerSettings.visible,width:e.markerSettings.size,height:e.markerSettings.size,shape:e.markerSettings.shape,dataLabel:l,isFilled:e.markerSettings.isFilled,border:e.markerSettings.border,fill:e.markerSettings.isFilled?e.markerSettings.fill:null}:{dataLabel:l}}:L==="Scatter"?p={dataSource:d,type:e.type,xName:"x",yName:"y",name:a,tooltipMappingName:"displayText",animation:{enable:!y},marker:{visible:!1,width:12,height:12,shape:"Circle",dataLabel:l}}:L==="Pie"||L==="Doughnut"?p={dataSource:d,radius:"100%",xName:"x",yName:"y",innerRadius:e.type==="Pie"?"0%":"40%",dataLabel:{visible:!!l.visible,position:l.position==="Outer"?"Outside":"Inside",name:"displayText",font:{fontWeight:"600"}},animation:{enable:!y},tooltipMappingName:"displayText"}:p={dataSource:d,type:e.type,xName:"x",yName:"y",animation:{enable:!y},name:a,marker:{dataLabel:l},tooltipMappingName:"displayText"}}S.push(p),v++}var T;return e.type&&(T={series:S,xRange:e.isSeriesInRows?n:i,yRange:r,lRange:e.isSeriesInRows?i:n}),T},o.prototype.getAxisFormat=function(e){var t="";if(!g(e)){var i=G(e[0],e[1],this.parent.getActiveSheet());i&&i.format&&(t=i.format)}return t},o.prototype.focusChartRange=function(e,t,i){var r=["e-rcborderright","e-rcborderbottom","e-vcborderright","e-vcborderbottom","e-bcborderright","e-bcborderbottom"];this.clearBorder();var n,s=this.parent.getActiveSheet(),a=!!(s.frozenRows||s.frozenColumns);i&&(a?n=i:this.parent.notify(Yc,{startcell:{rowIndex:i[0],colIndex:i[1]},endcell:{rowIndex:i[2],colIndex:i[3]},classes:[r[0],r[1]]})),e&&(a?n?(n[0]=Math.min(i[0],e[0]),n[1]=Math.min(i[1],e[1]),n[2]=Math.max(i[2],e[2]),n[3]=Math.max(i[3],e[3])):n=e:this.parent.notify(Yc,{startcell:{rowIndex:e[0],colIndex:e[1]},endcell:{rowIndex:e[2],colIndex:e[3]},classes:[r[2],r[3]]})),a&&n?this.parent.notify(Yc,{startcell:{rowIndex:Math.min(n[0],t[0]),colIndex:Math.min(n[1],t[1])},endcell:{rowIndex:Math.max(n[2],t[2]),colIndex:Math.max(n[3],t[3])},classes:[r[4],r[5]]}):this.parent.notify(Yc,{startcell:{rowIndex:t[0],colIndex:t[1]},endcell:{rowIndex:t[2],colIndex:t[3]},classes:[r[4],r[5]]})},o.prototype.clearBorder=function(){var e=this.parent.getActiveSheet();if(e.frozenColumns||e.frozenRows){var t=[].slice.call(this.parent.element.getElementsByClassName("e-chart-range"));t.forEach(function(c){ee(c)});return}for(var i=this.parent.getMainContent(),r=["e-rcborderright","e-rcborderbottom","e-vcborderright","e-vcborderbottom","e-bcborderright","e-bcborderbottom"],n=0,s=r.length;n<s;n++)for(var a=i.querySelectorAll("."+r[n]),l=0,h=a.length;l<h;l++){var u=a[l];u.classList.remove(r[n])}},o.prototype.initiateChartHandler=function(e){var t=this,i=e.option,r=!0;r=g(e.isInitCell)?!0:!e.isInitCell,e.triggerEvent=g(e.triggerEvent)?!0:e.triggerEvent;var n;e.isRefresh=g(e.isRefresh)?!1:e.isRefresh;var s=i.range&&i.range.lastIndexOf("!")>0?yt(this.parent,i.range.substring(0,i.range.lastIndexOf("!"))):this.parent.activeSheetIndex,a=ke(this.parent,s),l=i.range?i.range:this.parent.getActiveSheet().selectedRange,h=J(l),u={},c,d;if(!this.parent.allowChart&&a.isProtected)return n;var p={sheetIndex:s,reqType:"shape",type:"actionBegin",shapeType:"chart",action:"create",options:i,range:l,operation:"create"};if(u=p.options,l=p.range,u=u||{},h.length>0&&!e.isRefresh&&r){var f=h[2]-h[0],v=h[3]-h[1];f<v&&(c=!0)}u.isSeriesInRows=c?!0:u.isSeriesInRows?u.isSeriesInRows:!1,e.dataSheetIdx=g(e.dataSheetIdx)?s:e.dataSheetIdx;var m=this.processChartRange(h,e.dataSheetIdx,u),y=m.xRange,S=m.yRange,b=m.lRange;if(s===this.parent.activeSheetIndex&&r&&this.focusChartRange(y,S,b),e.triggerEvent&&!e.isRefresh){if(d={type:i.type,theme:i.theme,isSeriesInRows:i.isSeriesInRows,range:i.range,markerSettings:u.markerSettings,dataLabelSettings:u.dataLabelSettings,title:u.title,legendSettings:u.legendSettings,primaryXAxis:u.primaryXAxis,primaryYAxis:u.primaryYAxis,id:i.id,height:i.height,width:i.width,posRange:e.range,isInitCell:e.isInitCell,cancel:!1,top:i.top,left:i.left},this.parent.notify(ai,{eventArgs:d,action:"beforeInsertChart"}),d.cancel)return[];i.type=d.type,i.theme=d.theme,i.isSeriesInRows=d.isSeriesInRows,i.markerSettings=d.markerSettings,i.range=d.range,i.id=d.id,i.height=d.height,i.width=d.width}var w=this.processChartSeries(u,e.dataSheetIdx,y,S,b,m.isDateTime),I={majorGridLines:i.primaryXAxis&&i.primaryXAxis.majorGridLines&&!g(i.primaryXAxis.majorGridLines.width)?{width:i.primaryXAxis.majorGridLines.width}:{width:0},minorGridLines:i.primaryXAxis&&i.primaryXAxis.minorGridLines&&!g(i.primaryXAxis.minorGridLines.width)?{width:i.primaryXAxis.minorGridLines.width}:{width:0},minorTicksPerInterval:i.primaryXAxis&&i.primaryXAxis.minorGridLines&&i.primaryXAxis.minorGridLines.width>0?5:0,lineStyle:{width:0},valueType:i.type==="Scatter"&&!m.isStringSeries&&!i.isSeriesInRows?"Double":"Category",rangePadding:i.type==="Scatter"&&!m.isStringSeries&&!i.isSeriesInRows?"Round":"Auto",visible:i.primaryXAxis?i.primaryXAxis.visible:!0,title:i.primaryXAxis?i.primaryXAxis.title:"",edgeLabelPlacement:"Shift"},x={lineStyle:{width:0},majorGridLines:i.primaryYAxis&&i.primaryYAxis.majorGridLines&&!g(i.primaryYAxis.majorGridLines.width)?{width:i.primaryYAxis.majorGridLines.width}:{width:1},minorGridLines:i.primaryYAxis&&i.primaryYAxis.minorGridLines&&!g(i.primaryYAxis.minorGridLines.width)?{width:i.primaryYAxis.minorGridLines.width}:{width:0},minorTicksPerInterval:i.primaryYAxis&&i.primaryYAxis.minorGridLines&&i.primaryYAxis.minorGridLines.width>0?5:0,visible:i.primaryYAxis?i.primaryYAxis.visible:!0,title:i.primaryYAxis?i.primaryYAxis.title:"",edgeLabelPlacement:"Shift"};if(e.isRefresh){if(e.isSwitchRowColumn&&i.type==="Scatter"){var M=this.parent.element.querySelector("."+i.id);if(M){var D=at(M,"chart");D.primaryXAxis.valueType=!m.isStringSeries&&!i.isSeriesInRows?"Double":"Category"}}return w.series}var A=i.id+"_overlay",L=this.parent.serviceLocator.getService(eM),T=!g(e.isInitCell)&&e.isInitCell?e.range:l,k=L.insertOverlayElement(A,T,e.isChangeChartType?this.parent.activeSheetIndex:Gs(this.parent,T));k.element.classList.add("e-datavisualization-chart"),k.element.style.width=i.width+"px",k.element.style.height=i.height+"px",a&&(a.frozenRows||a.frozenColumns)?L.adjustFreezePaneSize(i,k.element,T):(g(i.top)?i.top=k.top:k.element.style.top=Number(dh(i.top).toFixed(2))+"px",g(i.left)?i.left=k.left:k.element.style.left=Number(dh(i.left).toFixed(2))+"px"),this.parent.notify(FI,{height:i.height,width:i.width});var F=i.type==="Pie"||i.type==="Doughnut"?{position:"Bottom",visible:!0}:{};g(i.legendSettings)||(F.visible=i.legendSettings.visible,F.position=i.legendSettings.position);var R=this.parent.createElement("div",{id:i.id,className:i.id}),N=i.theme||"Material",P=this.getAxisFormat(S),O=this.getAxisFormat(y),z=Math.round(parseFloat(getComputedStyle(k.element).borderWidth))*2,H=parseFloat(k.element.style.height)-(isNaN(z)?0:z)+"px";return i.type!=="Pie"&&i.type!=="Doughnut"?(this.chart=new Zm({primaryXAxis:I,primaryYAxis:x,background:this.getThemeBgColor(N),chartArea:{border:{width:0}},title:i.title,legendSettings:F,theme:N,series:w.series,tooltip:{enable:!0,format:"${point.x} : <b>${point.tooltip}</b>"},width:k.element.style.width,height:H,enableRtl:this.parent.enableRtl,load:function(Q){Q.chart.theme=i.theme||"Material"},beforeResize:function(Q){Q.cancelResizedEvent=!0},axisLabelRender:function(Q){Q.axis.name==="primaryYAxis"&&P&&!i.type.includes("100")&&!g(Q.value)&&t.parent?Q.text=t.parent.getDisplayText({format:P,value:Q.value.toString()}):Q.axis.name==="primaryXAxis"&&Q.text.startsWith("spread-chart-empty-label-")&&(Q.text=""),Q.axis.name==="primaryXAxis"&&i.type==="Scatter"&&!m.isDateTime&&(Q.axis.labels.length>0&&!Me(Q.text)?Q.text=(Q.axis.labels.indexOf(Q.text)+1).toString():O&&!g(Q.value)&&(Q.text=t.parent.getDisplayText({format:O,value:Q.value.toString()})))}}),this.chart.appendTo(R)):(this.chart=new ix({title:i.title,legendSettings:F,theme:N,background:this.getThemeBgColor(N),series:w.series,width:k.element.style.width,height:H,center:{x:"50%",y:"50%"},tooltip:{enable:!0,format:"${point.x} : <b>${point.tooltip}</b>"},enableSmartLabels:!0,enableAnimation:!0,enableRtl:this.parent.enableRtl,load:function(Q){Q.chart.theme=i.theme||"Material"},beforeResize:function(Q){Q.cancelResizedEvent=!0}}),this.chart.appendTo(R)),k.element.appendChild(R),k.element.classList.contains("e-ss-overlay-active")&&!this.parent.isPrintingProcessing&&this.parent.notify(Uf,{id:k.element.id}),e.triggerEvent&&this.parent.notify(mt,{eventArgs:d,action:"insertChart"}),n},o.prototype.deleteChart=function(e){this.clearBorder();var t=null,i=this.parent.getActiveSheet();if(g(e.id)?(t=document.querySelector(".e-datavisualization-chart.e-ss-overlay-active"),e.id=t?t.getElementsByClassName("e-control")[0].id:null):(e.id=e.id.includes("overlay")?e.id:e.id+"_overlay",t=document.getElementById(e.id)),!g(e.id)){e.id=e.id.includes("overlay")?e.id:e.id+"_overlay";for(var r,n,s,a=!1,l,h=0,u=this.parent.chartColl.length;h<u;h++)if(this.parent.chartColl[h].id===e.id.split("_overlay")[0]){l=this.parent.chartColl[h];break}var c={id:l.id,range:l.range,type:l.type,markerSettings:l.markerSettings,dataLabelSettings:l.dataLabelSettings,title:l.title,legendSettings:l.legendSettings,primaryXAxis:l.primaryXAxis,primaryYAxis:l.primaryYAxis,theme:l.theme,height:l.height,width:l.width,isSeriesInRows:l.isSeriesInRows,isInitCell:!0,posRange:null,top:l.top,left:l.left,cancel:!1};if(t){var d=void 0,p=void 0;if(i.frozenRows||i.frozenColumns){var f=t.getBoundingClientRect();d={clientY:f.top},p={clientX:f.left},f.top<this.parent.getColumnHeaderContent().getBoundingClientRect().bottom&&(d.target=this.parent.getColumnHeaderContent()),f.left<this.parent.getRowHeaderContent().getBoundingClientRect().right&&(p.target=this.parent.getRowHeaderTable())}else d={clientY:parseFloat(t.style.top),isImage:!0},p={clientX:parseFloat(t.style.left),isImage:!0};this.parent.notify(Ay,{id:e.id}),this.parent.notify(Ys,d),this.parent.notify(Qs,p),a=!0,r=d.clientY,n=p.clientX,i=this.parent.sheets[this.parent.activeSheetIndex]}else{this.parent.notify(Ay,{id:e.id});var v=e.range?e.range.lastIndexOf("!"):0,m=e.range&&v>0?yt(this.parent,e.range.substring(0,v)):this.parent.activeSheetIndex,y=e.range?v>0?e.range.substring(v+1):e.range:this.parent.getActiveSheet().selectedRange,S=J(y);r=S[0],n=S[1],i=this.parent.sheets[m]}var b=G(r,n,i);b&&(s=b.chart);for(var w=s?s.length:null,h=0;h<w;h++)e.id===s[h].id+"_overlay"&&(s.splice(h,1),w=s.length);a&&(document.getElementById(e.id).remove(),this.parent.notify(Ao,{})),oi(r,n,i,{chart:s},!0),c.posRange=et(r,n),e.isUndoRedo||this.parent.notify(mt,{eventArgs:c,action:"deleteChart",isClearAction:e.clearAction})}},o.prototype.updateChartModel=function(e,t,i,r,n){var s=t;t=t;var a=this.parent.chartColl[r].id;if(!(n&&["PHAxes","PVAxes","PHAxisTitle","PVAxisTitle","GLMajorHorizontal","GLMajorVertical","GLMinorHorizontal","GLMinorVertical"].indexOf(e)>-1)){for(var l=0,h=i.chart.length;l<h;l++)if(i.chart[l].id===a)switch(e){case"PHAxes":case"PHAxisTitle":g(i.chart[l].primaryXAxis)&&(i.chart[l].primaryXAxis={},this.parent.chartColl[r].primaryXAxis={}),e==="PHAxes"?(i.chart[l].primaryXAxis.visible=t.primaryXAxis.visible,this.parent.chartColl[r].primaryXAxis.visible=t.primaryXAxis.visible):e==="PHAxisTitle"&&(i.chart[l].primaryXAxis.title=t.primaryXAxis.title,this.parent.chartColl[r].primaryXAxis.title=t.primaryXAxis.title);break;case"PVAxes":case"PVAxisTitle":g(i.chart[l].primaryYAxis)&&(i.chart[l].primaryYAxis={},this.parent.chartColl[r].primaryYAxis={}),e==="PVAxes"?(i.chart[l].primaryYAxis.visible=t.primaryYAxis.visible,this.parent.chartColl[r].primaryYAxis.visible=t.primaryYAxis.visible):e==="PVAxisTitle"&&(i.chart[l].primaryYAxis.title=t.primaryYAxis.title,this.parent.chartColl[r].primaryYAxis.title=t.primaryYAxis.title);break;case"ChartTitleNone":case"ChartTitleAbove":i.chart[l].title=t.title,this.parent.chartColl[r].title=t.title;break;case"DLNone":case"DLCenter":case"DLInsideend":case"DLInsidebase":case"DLOutsideend":if(g(i.chart[l].dataLabelSettings)&&(i.chart[l].dataLabelSettings={},this.parent.chartColl[r].dataLabelSettings={}),e==="DLNone")i.chart[l].dataLabelSettings.visible=!1,this.parent.chartColl[r].dataLabelSettings.visible=!1;else{i.chart[l].dataLabelSettings.visible=!0,this.parent.chartColl[r].dataLabelSettings.visible=!0;var u=void 0;n?u=s.series[0].dataLabel.position==="Outside"?"Outer":"Middle":u=t.series[0].marker.dataLabel.position,i.chart[l].dataLabelSettings.position=u,this.parent.chartColl[r].dataLabelSettings.position=u}break;case"GLMajorHorizontal":g(i.chart[l].primaryYAxis)&&(i.chart[l].primaryYAxis={},this.parent.chartColl[r].primaryYAxis={}),g(i.chart[l].primaryYAxis.majorGridLines)&&(i.chart[l].primaryYAxis.majorGridLines={},this.parent.chartColl[r].primaryYAxis.majorGridLines={}),i.chart[l].primaryYAxis.majorGridLines.width=t.primaryYAxis.majorGridLines.width,this.parent.chartColl[r].primaryYAxis.majorGridLines.width=t.primaryYAxis.majorGridLines.width;break;case"GLMajorVertical":g(i.chart[l].primaryXAxis)&&(i.chart[l].primaryXAxis={},this.parent.chartColl[r].primaryXAxis={}),g(i.chart[l].primaryXAxis.majorGridLines)&&(i.chart[l].primaryXAxis.majorGridLines={},this.parent.chartColl[r].primaryXAxis.majorGridLines={}),i.chart[l].primaryXAxis.majorGridLines.width=t.primaryXAxis.majorGridLines.width,this.parent.chartColl[r].primaryXAxis.majorGridLines.width=t.primaryXAxis.majorGridLines.width;break;case"GLMinorHorizontal":g(i.chart[l].primaryYAxis)&&(i.chart[l].primaryYAxis={},this.parent.chartColl[r].primaryYAxis={}),g(i.chart[l].primaryYAxis.minorGridLines)&&(i.chart[l].primaryYAxis.minorGridLines={},this.parent.chartColl[r].primaryYAxis.minorGridLines={}),i.chart[l].primaryYAxis.minorGridLines.width=t.primaryYAxis.minorGridLines.width,this.parent.chartColl[r].primaryYAxis.minorGridLines.width=t.primaryYAxis.minorGridLines.width;break;case"GLMinorVertical":g(i.chart[l].primaryXAxis)&&(i.chart[l].primaryXAxis={},this.parent.chartColl[r].primaryXAxis={}),g(i.chart[l].primaryXAxis.minorGridLines)&&(i.chart[l].primaryXAxis.minorGridLines={},this.parent.chartColl[r].primaryXAxis.minorGridLines={}),i.chart[l].primaryXAxis.minorGridLines.width=t.primaryXAxis.minorGridLines.width,this.parent.chartColl[r].primaryXAxis.minorGridLines.width=t.primaryXAxis.minorGridLines.width;break;case"LegendNone":case"LegendsRight":case"LegendsLeft":case"LegendsBottom":case"LegendsTop":if(g(i.chart[l].legendSettings)&&(i.chart[l].legendSettings={},this.parent.chartColl[r].legendSettings={}),i.chart[l].legendSettings.visible=t.legendSettings.visible,this.parent.chartColl[r].legendSettings.visible=t.legendSettings.visible,e!=="LegendNone"){i.chart[l].legendSettings.position=t.legendSettings.position,this.parent.chartColl[r].legendSettings.position=t.legendSettings.position;break}}}},o.prototype.updateChartElement=function(e,t,i,r,n,s,a,l){if(!(s&&["PHAxes","PVAxes","PHAxisTitle","PVAxisTitle","GLMajorHorizontal","GLMajorVertical","GLMinorHorizontal","GLMinorVertical"].indexOf(e)>-1)){var h;switch(e){case"PHAxes":t=t,t.primaryXAxis.visible=!t.primaryXAxis.visible;break;case"PVAxes":t=t,t.primaryYAxis.visible=!t.primaryYAxis.visible;break;case"PHAxisTitle":t=t,t.primaryXAxis.title=n;break;case"PVAxisTitle":t=t,t.primaryYAxis.title=n;break;case"ChartTitleNone":t.title="";break;case"ChartTitleAbove":t.title=n;break;case"DLNone":case"DLCenter":case"DLInsideend":case"DLInsidebase":case"DLOutsideend":if(t=t,h=t.series,e==="DLNone")for(var u=0,c=h.length;u<c;u++)s?h[u].dataLabel.visible=!1:h[u].marker.dataLabel.visible=!1;else for(var u=0,c=h.length;u<c;u++)if(s){var d=e==="DLOutsideend"?"Outside":"Inside";h[u].dataLabel.visible=!0,h[u].dataLabel.position=d}else{var d=e==="DLCenter"?"Middle":e==="DLInsideend"?"Top":e==="DLInsidebase"?"Bottom":e==="DLOutsideend"?"Outer":h[0].marker.dataLabel.position;h[u].marker.dataLabel.visible=!0,h[u].marker.dataLabel.position=d}t.series=h,s&&t.refresh();break;case"GLMajorHorizontal":t=t,t.primaryYAxis.majorGridLines.width=t.primaryYAxis.majorGridLines.width===0?1:0;break;case"GLMajorVertical":t=t,t.primaryXAxis.majorGridLines.width=t.primaryXAxis.majorGridLines.width===0?1:0;break;case"GLMinorHorizontal":t=t,t.primaryYAxis.minorTicksPerInterval=t.primaryYAxis.minorGridLines.width===0?5:0,t.primaryYAxis.minorGridLines.width=t.primaryYAxis.minorGridLines.width===0?1:0;break;case"GLMinorVertical":t=t,t.primaryXAxis.minorTicksPerInterval=t.primaryXAxis.minorGridLines.width===0?5:0,t.primaryXAxis.minorGridLines.width=t.primaryXAxis.minorGridLines.width===0?1:0;break;case"LegendNone":t.legendSettings.visible=!1;break;case"LegendsRight":case"LegendsLeft":case"LegendsBottom":case"LegendsTop":t.legendSettings.visible=!0,t.legendSettings.position=e==="LegendsRight"?"Right":e==="LegendsLeft"?"Left":e==="LegendsBottom"?"Bottom":e==="LegendsTop"?"Top":t.legendSettings.position;break}if(this.updateChartModel(e,t,i,r,s),l){var p={addChartEle:e,id:t.element.id+"_overlay",title:n,address:a};this.parent.notify(mt,{action:"chartDesign",eventArgs:p})}}},o.prototype.undoRedoForChartDesign=function(e){var t=document.getElementById(e.id);if(t){var i=this.getChartElement(t),r=at(i,"chart");g(r)&&(r=at(i,"accumulationchart"));for(var n=this.parent.getAddressInfo(e.address),s=G(n.indices[0],n.indices[1],ke(this.parent,n.sheetIndex)),a=this.getChartCollectionId(i.id),l,h=e.addChartEle,u=e.title,c=0;c<e.beforeActionData.cellDetails[0].chart.length;c++)if(i.id===e.beforeActionData.cellDetails[0].chart[c].id){l=e.beforeActionData.cellDetails[0].chart[c];break}var d=g(l.markerSettings)?!1:l.markerSettings.visible;if(e.switchRowColumn)this.switchRowColumn(a,i.id,r,s);else if(e.chartTheme)this.switchChartTheme(a,i.id,e.isUndo?l.theme:e.chartTheme,r,s);else if(e.chartType)this.switchChartType(a,i.id,e.isUndo?l.type:e.chartType,r,s,!1,e.isUndo?d:e.chartMarker,"undoRedo");else if(e.addChartEle){if(e.isUndo){var p=void 0;switch(h){case"DLNone":case"DLCenter":case"DLInsideend":case"DLInsidebase":case"DLOutsideend":p=l.dataLabelSettings&&l.dataLabelSettings.position,h=p==="Middle"?"DLCenter":p==="Top"?"DLInsideend":p==="Bottom"?"DLInsidebase":p==="Outer"?"DLOutsideend":"DLNone";break;case"LegendNone":case"LegendsRight":case"LegendsLeft":case"LegendsBottom":case"LegendsTop":l.legendSettings&&!l.legendSettings.visible?p="LegendNone":(p=l.legendSettings&&l.legendSettings.position,h=p==="Right"?"LegendsRight":p==="Left"?"LegendsLeft":p==="Bottom"?"LegendsBottom":p==="Top"?"LegendsTop":"LegendsBottom");break;case"PVAxisTitle":u=l.primaryYAxis&&l.primaryYAxis.title;break;case"PHAxisTitle":u=l.primaryXAxis&&l.primaryXAxis.title;break;case"ChartTitleNone":case"ChartTitleAbove":u=l.title;break}}this.updateChartElement(h,r,s,a,u,null,e.address)}}},o.prototype.chartDesignTabHandler=function(e){var t=!1,i=this.parent.sheets[this.parent.activeSheetIndex],r=e.switchRowColumn,n=e.chartType,s=e.chartTheme,a=e.addChartEle,l=null,h=e.id?document.getElementById(e.id):document.querySelector(".e-datavisualization-chart.e-ss-overlay-active");if(h){var u=a==="ChartTitleAbove"||a==="PHAxisTitle"||a==="PVAxisTitle",c,d;if(i.frozenRows||i.frozenColumns){var p=h.getBoundingClientRect();c={clientY:p.top},d={clientX:p.left},p.top<this.parent.getColumnHeaderContent().getBoundingClientRect().bottom&&(c.target=this.parent.getColumnHeaderContent()),p.left<this.parent.getRowHeaderContent().getBoundingClientRect().right&&(d.target=this.parent.getRowHeaderTable())}else c={clientY:h.offsetTop,isImage:!0},d={clientX:h.offsetLeft,isImage:!0};this.parent.notify(Ys,c),this.parent.notify(Qs,d);var f=G(c.clientY,d.clientX,i),v=i.name+"!"+et(c.clientY,d.clientX);if(e.triggerEvent){var m={switchRowColumn:e.switchRowColumn,chartType:e.chartType,chartTheme:e.chartTheme,addChartEle:e.addChartEle,id:h.id,address:v,cancel:!1};if(this.parent.notify(ai,{action:"chartDesign",eventArgs:m}),m.cancel)return}var y=this.getChartElement(h),S=y.getAttribute("id"),b=this.getChartCollectionId(S);if(y&&(l=at(y,"chart"),g(l)&&(l=at(y,"accumulationchart"),t=!0)),r&&this.switchRowColumn(b,S,l,f),n&&this.switchChartType(b,S,n,l,f,e.markerVisible),s&&this.switchChartTheme(b,S,s,l,f),a)if(u&&!e.title){if(this.parent.element.getElementsByClassName("e-title-dlg").length>0)return;this.titleDlgHandler(a,l,f,b,t,v,e.triggerEvent)}else this.updateChartElement(a,l,f,b,e.title,t);if(e.triggerEvent&&!u){var m={switchRowColumn:e.switchRowColumn,chartType:e.chartType,chartMarker:e.markerVisible,chartTheme:e.chartTheme,addChartEle:e.addChartEle,id:h.id,address:v};this.parent.notify(mt,{action:"chartDesign",eventArgs:m})}}},o.prototype.switchRowColumn=function(e,t,i,r){var n=this.parent.chartColl[e];n.isSeriesInRows=g(n.isSeriesInRows)?!0:!n.isSeriesInRows;for(var s=0,a=r.chart.length;s<a;s++)r.chart[s].id===t&&(r.chart[s].isSeriesInRows=n.isSeriesInRows);var l=this.initiateChartHandler({option:n,isRefresh:!0,isSwitchRowColumn:!0});i.series=l},o.prototype.switchChartTheme=function(e,t,i,r,n){this.parent.chartColl[e].theme=i;for(var s=0,a=n.chart.length;s<a;s++)n.chart[s].id===t&&(n.chart[s].theme=i);r.setProperties({theme:i,background:this.getThemeBgColor(i)},!0),r.refresh()},o.prototype.getThemeBgColor=function(e){var t;if(e.includes("Dark"))switch(e){case"MaterialDark":t="#383838";break;case"FabricDark":t="#242424";break;case"BootstrapDark":t="#1b1b1b";break;case"Bootstrap5Dark":t="#212529";break;case"TailwindDark":t="#1f2937";break;case"Tailwind3Dark":t="#111827";break;case"FluentDark":t="#1b1a19";break;case"Fluent2Dark":t="#292929";break;case"Material3Dark":t="#1C1B1F";break}else e.includes("HighContrast")?t="#000000":t="#FFFFFF";return t},o.prototype.switchChartType=function(e,t,i,r,n,s,a,l){var h=this.parent.chartColl[e].type;this.parent.chartColl[e].type=i;for(var u=0,c=n.chart.length;u<c;u++)n.chart[u].id===t&&(n.chart[u].type=i,g(n.chart[u].markerSettings)||(n.chart[u].markerSettings.visible=s));if(i!=="Pie"&&i!=="Doughnut")if(h==="Pie"||h==="Doughnut")g(this.parent.chartColl[e].markerSettings)?this.parent.chartColl[e].markerSettings={shape:"Circle",visible:!0,isFilled:!1}:s?this.parent.chartColl[e].markerSettings.visible=s:l==="undoRedo"?this.parent.chartColl[e].markerSettings.visible=a:this.parent.chartColl[e].markerSettings.visible=!1,this.changeCharType(e);else{if(h!==i)if(i==="Scatter"){var d=r.primaryXAxis.labels;d&&d.length>0&&Me(d[d.length-1])&&(r.primaryXAxis.valueType="Double")}else r.primaryXAxis.valueType==="Double"&&(r.primaryXAxis.valueType="Category");for(var p=r.series,f=i==="Line"||i==="StackingLine"||i==="StackingLine100",u=0,v=p.length;u<v;u++)p[u].type=i,f?(p[u].marker.visible=s,p[u].marker.shape=g(p[u].marker.shape)?"Circle":p[u].marker.shape,l==="undoRedo"&&(p[u].marker.visible=a)):p[u].marker.visible=!1;r.series=p,r.refresh()}else if(h==="Pie"||h==="Doughnut"){for(var p=r.series,u=0,v=p.length;u<v;u++)p[u].innerRadius=i==="Pie"?"0%":"40%";r.series=p,r.refresh()}else this.changeCharType(e)},o.prototype.getChartElement=function(e){var t=e.querySelector(".e-chart");return g(t)&&(t=e.querySelector(".e-accumulationchart")),t},o.prototype.getChartCollectionId=function(e){for(var t,i=0,r=this.parent.chartColl.length;i<r;i++)e===this.parent.chartColl[i].id&&(t=i);return t},o.prototype.changeCharType=function(e){var t=document.getElementById(this.parent.chartColl[e].id),i=j(t,".e-datavisualization-chart");i.remove(),this.initiateChartHandler({option:this.parent.chartColl[e],isInitCell:!1,triggerEvent:!1,isPaste:!1,isChangeChartType:!0}),t=document.getElementById(this.parent.chartColl[e].id),i=j(t,".e-datavisualization-chart"),i.classList.contains("e-ss-overlay-active")||i.classList.add("e-ss-overlay-active")},o.prototype.titleDlgHandler=function(e,t,i,r,n,s,a){var l=this,h="";if(!(n&&(e==="PHAxisTitle"||e==="PVAxisTitle"))){var u=this.parent.serviceLocator.getService(fe),c=this.parent.serviceLocator.getService(jt);c.show({width:375,showCloseIcon:!0,isModal:!0,cssClass:"e-title-dlg",header:e==="chart_abovechart"?u.getConstant("ChartTitle"):e==="PHAxisTitle"?u.getConstant("HorizontalAxisTitle"):u.getConstant("VerticalAxisTitle"),beforeOpen:function(){c.dialogInstance.content=l.titleDlgContent(e,t),c.dialogInstance.dataBind(),l.parent.element.focus()},buttons:[{buttonModel:{content:u.getConstant("Ok"),isPrimary:!0,cssClass:"e-btn e-clearall-btn e-flat"},click:function(){var d=l.parent.element.querySelector(".e-title-dlg").getElementsByClassName("e-title-dlg-content")[0];h=d.getElementsByTagName("input")[0].value,c.hide(),l.updateChartElement(e,t,i,r,h,null,s,a)}}]}),c.dialogInstance.refresh()}},o.prototype.titleDlgContent=function(e,t){var i=this.parent.serviceLocator.getService(fe),r=this.parent.createElement("div",{className:"e-title-dlg-content"}),n=this.parent.createElement("span",{className:"e-header e-top-header"});n.innerText=i.getConstant("EnterTitle");var s=this.parent.createElement("input",{className:"e-input",id:"titleInput",attrs:{type:"text"}});return r.appendChild(n),r.appendChild(s),t&&(e==="PHAxisTitle"?s.value=t.primaryXAxis.title?t.primaryXAxis.title:s.value:e==="PVAxisTitle"?s.value=t.primaryYAxis.title?t.primaryYAxis.title:s.value:s.value=t.title?t.title:s.value),r},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Ey,this.initiateChartHandler),this.parent.off(ou,this.refreshChartCellObj),this.parent.off(Fx,this.refreshChartCellModel),this.parent.off(hb,this.refreshChartCellModel),this.parent.off(Eu,this.deleteChart),this.parent.off(cb,this.clearBorder),this.parent.off(AI,this.insertChartHandler),this.parent.off(Qc,this.chartRangeHandler),this.parent.off(lu,this.chartDesignTabHandler),this.parent.off(WF,this.updateChartElement),this.parent.off(TI,this.undoRedoForChartDesign),this.parent.off(lh,this.refreshChartData))},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null;var e=null;this.chart&&(e=this.chart.element,this.chart.destroy()),e&&ee(e),this.chart=null},o.prototype.getModuleName=function(){return"spreadsheetChart"},o}(),t9=function(){function o(e){this.totalSheetCount=[],this.workbookActiveSheetCount=0,this.defaultCellWidth=64,this.defaultCellHeight=19,this.pageCounts=[],this.initialRowCount=0,this.chartHeight=0,this.columnIndex=0,this.rowIndex=0,this.multipleCanvasDataURL=[],this.chartElements=[],this.totalCharts=0,this.isChartLoaded=!1,this.chartLoadedCount=0,this.isImageLoaded=!1,this.totalImages=0,this.imageLoadedCount=0,this.endRow=0,this.isColumn=!0,this.startNewPageCount=0,this.allowTimer=!1,this.parent=e}return o.prototype.print=function(e,t){var i=this;if(e.isPrintingProcessing=!0,this.multipleCanvasDataURL=[],this.chartElements=[],t.type==="ActiveSheet"){var r=e.sheets[e.activeSheetIndex];this.activeSheetPrint(e,r,t,e.activeSheetIndex)}else{this.totalSheetCount=[],this.workbookActiveSheetCount=1;for(var n=0;n<e.sheets.length;n++)if(e.sheets[n].state==="Visible"&&(this.totalSheetCount.push(n),this.totalSheetCount.length>1&&this.parent.sheets[n].ranges.length>0)){var s=this.parent.sheets[n].ranges.some(function(h){return!g(h.dataSource)});if(s){this.allowTimer=!0;var r=e.sheets[n],a=et(0,0)+":"+et(r.rowCount-1,r.colCount-1),l=Qi(a);this.parent.notify(ah,{sheet:r,indexes:l})}}this.allowTimer?(this.allowTimer=!1,setTimeout(function(){i.activeSheetPrint(e,e.sheets[i.totalSheetCount[0]],t,i.totalSheetCount[0])},2e3)):this.activeSheetPrint(e,e.sheets[this.totalSheetCount[0]],t,this.totalSheetCount[0])}},o.prototype.updateChartRowAndColumnIndices=function(e,t){var i=e.sheets[t];if(this.rowIndex=i.usedRange.rowIndex,this.columnIndex=i.usedRange.colIndex,e.chartColl.length>0)for(var r=0;r<e.chartColl.length;r++){var n=e.chartColl[r],s=yt(e,n.range.substring(0,n.range.lastIndexOf("!")));if(t===s){var a={clientX:n.left,isImage:!0},l={clientY:n.top,isImage:!0};e.notify(Ys,l),e.notify(Qs,a),l.clientY>i.usedRange.rowIndex&&(this.rowIndex=Math.max(this.rowIndex,l.clientY)),a.clientX>i.usedRange.colIndex&&(this.columnIndex=Math.max(this.columnIndex,a.clientX))}}},o.prototype.activeSheetPrint=function(e,t,i,r){this.updateChartRowAndColumnIndices(e,r),this.pageCounts=this.calculatePageCount(t,1e3,i.allowRowColumnHeader);var n,s;this.initialRowCount=0,this.parent.currentPrintSheetIndex=r,this.endRow=this.rowIndex+1,this.processCell(0,0,this.endRow,2,[],s,n,t,this,0,0,!0,r,i)},o.prototype.processCell=function(e,t,i,r,n,s,a,l,h,u,c,d,p,f){var v=this;u===void 0&&(u=0),c===void 0&&(c=0),d===void 0&&(d=!0);var m=0,y=f.allowRowColumnHeader,S=37,b=0;this.chartHeight=0;for(var w=!1,I=e;I<this.pageCounts.length;I++){this.chartLoadedCount=0,this.totalCharts=0,this.imageLoadedCount=0,this.totalImages=0,u+=I===0?0:1100,a=document.createElement("canvas"),s=a.getContext("2d"),a.width=1e3,a.height=1100,s.font="11pt Calibri",s.textBaseline="bottom",s.index=I,s.width=1e3,(d||!this.isImageLoaded&&!this.isChartLoaded)&&(n=[],r=0,c=0);for(var x=t;x<this.endRow;x++){d=!0;var M=!1;this.isColumn=this.isColumn?this.isColumn:x===0;var D={borderBottom:"1px solid black"},A=l.rows[x]&&l.rows[x].height||this.defaultCellHeight;this.initialRowCount=x,r=m;var L=I===0?0:this.pageCounts[I-1]+1,T=this.pageCounts[I];c+=g(l.rows[x])?this.defaultCellHeight:A+(x===0&&y?this.defaultCellHeight:0);var k=g(l.rows[x])?this.defaultCellHeight:l.rows[x]&&l.rows[x].height||this.defaultCellHeight;if(c>1080){if(this.startNewPageCount=x,b=y?A+(x===0&&y?this.defaultCellHeight:0):0,M=!1,this.isColumn=!0,this.isImageLoaded||this.isChartLoaded)break;u+=1100,d&&this.multipleCanvasDataURL.push(a.toDataURL()),d=!0,a=document.createElement("canvas"),s=a.getContext("2d"),a.width=1e3,a.height=1100,s.font="11pt Calibri",s.textBaseline="bottom",s.index=I,s.width=1e3;for(var F=0;F<n.length;F++)n[F]!==void 0&&(n[F]-=c-k);c=y||f.allowGridLines?A+(y?this.defaultCellHeight:0):A}var R={borderBottom:"1px solid black",borderTop:"1px solid black",borderLeft:"1px solid black",borderRight:"1px solid black"},N={borderRight:"1px solid black"};if(y&&this.isColumn)for(var P=L;P<=T;P++){var O=Pi(P+1),z=P===L?2:1;s.font="11pt Calibri";for(var F=0;F<z;F++){var H=F===0&&z===2?S:l.columns[P]&&l.columns[P].hidden?0:l.columns[P]&&l.columns[P].width||this.defaultCellWidth;if(H=r+H>1e3?H-1-(r+H-1e3):H,H!==0){var Q=s.measureText(O),$=Q.width,U=h.calculateTextPosition($,H,r,"Center"),ie=this.defaultCellHeight;s.fillText(P===L&&F===0?"":O,U,ie),h.drawBorder(s,R,r,0,H,this.defaultCellHeight),r+=H,n[P]=this.defaultCellHeight,P===T&&(z===2?F===1:F===0)&&(this.isColumn=P!==T,r=0)}else P===T&&(this.isColumn=!1,r=0)}}if(!g(l.rows[x])&&(g(l.rows[x].hidden)||!l.rows[x].hidden)){M=this.endRow===l.rows.length?c+(l.rows[x+1]?l.rows[x+1].height||this.defaultCellHeight:this.defaultCellHeight)+(x===0&&y?this.defaultCellHeight:0)>1080||x===l.rows.length-1:!1;for(var ne=function(ve){var ue=l.rows[x]&&!g(l.rows[x].cells)&&l.rows[x].cells[ve];if(!g(ue)&&!g(ue.style)&&(R=te.setBorderStyle(ue,R)),g(l.columns[ve])||g(l.columns[ve].hidden)||!l.columns[ve].hidden){var Tt=!g(l.rows[x].cells)&&!g(l.rows[x].cells[ve])&&!isNaN(l.rows[x].cells[ve].colSpan)&&L>ve+l.rows[x].cells[ve].colSpan,_e=!g(l.rows[x].cells)&&!g(l.rows[x].cells[ve])&&!isNaN(l.rows[x].cells[ve].rowSpan)&&!(x+l.rows[x].cells[ve].rowSpan>te.startNewPageCount)&&te.startNewPageCount!==0,lt="",We,ct,Dt=g(ue)||isNaN(ue.rowSpan)||Tt||_e?1:Math.max(ue.rowSpan,0);if(n[ve]=isNaN(n[ve])?m:n[ve],y&&ve===L){s.font="11pt Calibri";var Xt=n[ve];if(Dt>0)for(var Lt=0;Lt<(Dt===0?1:Dt);Lt++)r=0,Xt+=Lt===0?0:l.rows[x+Lt]&&l.rows[x+Lt-1].height||te.defaultCellHeight,h.rowHeaderText((x+1+Lt).toString(),s,h,S,r,R,Xt,l.rows[x+Lt].height||te.defaultCellHeight),r+=S;else r=0,r+=S}if(!g(ue)&&ue){var Bi=ue.style&&ue.style.fontSize||"11pt",zi=ue.style&&ue.style.color||"#000000";if(!isNaN(l.rows[x].cells[ve].rowSpan)&&l.rows[x].cells[ve].rowSpan>1&&isNaN(l.rows[x+1].cells[ve].rowSpan)&&te.parent.merge(""+Pi(ve+1)+(x+1)+":"+Pi(ve+1)+(x+l.rows[x].cells[ve].rowSpan-1)),!isNaN(l.rows[x].cells[ve].colSpan)&&l.rows[x].cells[ve].colSpan>1){if(!g(l.rows[x+1])&&!g(l.rows[x+1].cells)&&l.rows[x+1].cells.length>0&&!g(l.rows[x+1].cells[ve])&&isNaN(l.rows[x+1].cells[ve].colSpan))te.parent.merge(""+Pi(ve+1)+(x+1)+":"+Pi(ve+1+l.rows[x].cells[ve].colSpan-1)+(x+1));else if(g(l.rows[x].cells[ve+1].colSpan))for(var Ct=1;Ct<l.rows[x].cells[ve].colSpan;Ct++)l.rows[x].cells[ve+Ct].colSpan=-Ct}if(We=isNaN(l.rows[x].cells[ve].colSpan)||Tt?1:Math.max(l.rows[x].cells[ve].colSpan,0),l.rows[x].cells[ve].rowSpan&&!Tt&&l.rows[x].cells[ve].rowSpan<0){var Ei=l.rows[x+l.rows[x].cells[ve].rowSpan].cells[ve].colSpan;We=Ei||We}(ve===L||ve>0&&l.columns&&l.columns[ve-1]&&l.columns[ve-1].hidden&&l.rows[x].cells[ve-1]&&l.rows[x].cells[ve-1].colSpan>1)&&We<=0&&(We=1);var ji=ue.style&&ue.style.backgroundColor||"#ffffff",Ur=ue.style?ue.style.textAlign:"";s.font=Bi,s.fillStyle=zi;var Fi=[];if(We>1){for(var Tr=l.columns.slice(ve,ve+We),Lt=0;Lt<Tr.length;Lt++)Fi.push(Tr.hidden?0:Tr[Lt]&&Tr[Lt].width||te.defaultCellWidth);Fi.length===0?Fi.push(te.defaultCellWidth*We):Fi.length!==We&&(Fi=Fi.map(function(Ca){return Ca+v.defaultCellWidth*(We-1-Fi.length)}))}ct=We>1?Fi.reduce(function(Ca,Md){return Ca+Md},0):We===1?l.columns[ve]&&l.columns[ve].width||te.defaultCellWidth:0,ct=r+ct>1e3?ct-1-(r+ct-1e3):ct,k=Dt>1?l.rows.slice(x,x+Dt).map(function(Ca){return Ca.height||v.defaultCellHeight}).reduce(function(Ca,Md){return Ca+(Md||v.defaultCellHeight)},0):Dt===1?A:0;var _=(ue.style&&ue.style.verticalAlign||"Bottom").toLowerCase();if(!g(ue.image)&&ue.image.length>0&&te.processImages(I,x,ue,a,s,c,te.endRow,A,b,y,f,l,h,r,n,u,p),!g(ue.chart)&&ue.chart.length>0&&te.handleCharts(I,x,ue,s,a,c,te.endRow,te.initialRowCount,b,A,y,f,l,h,te.multipleCanvasDataURL,r,n,u,p),!g(ue.value)||!g(ue.formula)||!g(ue.hyperlink)){var Z;if(ue.formula&&ue.format){te.parent.calculationMode==="Automatic"&&te.parent.notify(xt,{action:"refreshCalculate",rowIndex:x,colIndex:ve,value:ue.formula,isFormula:ut(ue.formula),sheetIndex:p});var we={value:ue.value,format:ue.format,rowIndex:x,colIndex:ve,sheetIndex:te.parent.activeSheetIndex,cell:ue,refresh:!0};lt=te.parent.workbookNumberFormatModule.getFormattedCell(we),Z=""+(Ur||(we.isRightAlign?"Right":"Left"))}else if(ue.format){var we={value:ue.value,format:ue.format,rowIndex:x,colIndex:ve,sheetIndex:te.parent.activeSheetIndex,cell:ue,refresh:!0};lt=te.parent.workbookNumberFormatModule.getFormattedCell(we),Z=""+(Ur||(we.isRightAlign?"Right":"Left"))}else if(ue.formula)te.parent.calculationMode==="Automatic"&&te.parent.notify(xt,{action:"refreshCalculate",rowIndex:x,colIndex:ve,value:ue.formula,isFormula:ut(ue.formula),sheetIndex:p}),lt=ue.value,Z=""+(Ur||"Left");else{g(ue.hyperlink)||(g(ue.value)?ue.value=!g(ue.hyperlink)&&typeof ue.hyperlink=="object"?ue.hyperlink.address:ue.hyperlink||ue.hyperlink.address:(g(ue.value)||ue.value==="")&&(ue.value=typeof ue.hyperlink=="object"?ue.hyperlink.address:ue.hyperlink),zi=ue.style&&ue.style.color||"#00e"),lt=ue.value;var Te=!g(ue.value)&&ue.value!==""?new RegExp("^[^\\p{L}]*$","u").test(ue.value):!1;Z=""+(Ur||(Te?"Right":"Left"))}var je=ue.style&&ue.style.fontSize||"11pt",He=ue.style&&ue.style.fontFamily||"Calibri",gt=ue.style&&ue.style.fontStyle||"",Lr=ue.style&&ue.style.fontWeight||"normal";s.font=gt+" "+Lr+" "+je+" "+He;var Ai=s.measureText(lt),dn=Ai.width,tn=Ai.actualBoundingBoxAscent+Ai.actualBoundingBoxDescent;if(ue.wrap){var mn=te.defaultCellHeight<k?parseInt(je.replace("pt",""),10)/72*96:k,Sa=ue.colSpan>1?ve+ue.colSpan-1:ve,xd=Au(l,x,ve,Sa),yn=h.wrapText(lt,ct,xd,ue.style),ps=yn.length===1?k:yn.length*mn===k?mn:yn.length*mn<k?k-(yn.length-1)*mn:mn,Id=n[ve]+(_==="top"?mn:_==="middle"&&ps>mn+ps/4?mn+ps/4:ps);s.save(),s.beginPath(),s.rect(r,n[ve],ct,k),s.clip(),s.fillStyle=ji,s.fillRect(r,n[ve],ct,k+(_==="top"?mn:0)),yn.forEach(function(Ca,Md){s.fillStyle=zi,Ai=s.measureText(Ca),dn=Ai.width;var Db=h.calculateTextPosition(dn,ct,r,Z,!0),Eb=Id+Md*mn;Z.toLowerCase()==="right"?(s.textAlign="right",s.fillText(Ca.trimEnd(),Db,Eb)):s.fillText(Ca,Db,Eb),h.textDecoration(ue,s,Db,Eb,zi,Ai,lt,ct)}),s.restore()}else{s.save(),s.beginPath(),s.rect(r,n[ve],ct,k),s.clip(),s.fillStyle=ji,s.fillRect(r,n[ve],ct,k),s.fillStyle=zi;var Fo=h.calculateTextPosition(dn,ct,r,Z),ph=n[ve],fM=k/2+tn/2;_==="top"?s.textBaseline="top":_==="middle"&&k>fM?ph+=fM:ph+=k,g(ue.style)||(ph=!g(ue.style.borderBottom)&&ue.style.borderBottom.indexOf("double")>-1||!g(ue.style.borderTop)&&ue.style.borderTop.indexOf("double")>-1?ph-2:ph,Fo=!g(ue.style.borderLeft)&&ue.style.borderLeft.indexOf("double")>-1||!g(ue.style.borderRight)&&ue.style.borderRight.indexOf("double")>-1?Fo+(Z==="Left"?2:-3):Fo),s.fillText(lt,Fo,ph),s.restore(),h.textDecoration(ue,s,Fo,ph,zi,Ai,lt,ct)}}else h.rowHeaderRect(s,r,n[ve],ct,k,ji);ue.style&&(ct>0||k>0)&&(ue.style.borderBottom||ue.style.borderTop||ue.style.borderLeft||ue.style.borderRight&&(g(ue.rowSpan)&&g(ue.colSpan)||!g(ue.rowSpan)&&ue.rowSpan>0||!g(ue.colSpan)&&ue.colSpan>0))&&h.drawBorder(s,ue.style,r,n[ve]<=0?2:n[ve],ct,k)}var gM=We<=0?ct:ct||l.columns[ve]&&l.columns[ve].width||te.defaultCellWidth;f.allowGridLines&&(R.borderRight=ve===T&&y?void 0:"1px solid black",h.drawBorder(s,R,r,n[ve],gM,k)),r+=gM;var Mb=0;if(Dt>1){Mb=n[ve];for(var Ct=ve;Ct<ve+We;Ct++){var Xs=l.rows[x]&&!g(l.rows[x].cells)&&l.rows[x].cells[Ct];Xs&&!g(Xs.image)?te.processImages(I,x,Xs,a,s,c,te.endRow,A,b,y,f,l,h,r,n,u,p):Xs&&!g(Xs.chart)&&te.handleCharts(I,x,Xs,s,a,c,te.endRow,te.initialRowCount,b,A,y,f,l,h,te.multipleCanvasDataURL,r,n,u,p),Xs.style&&Ct===ve&&k>0&&(Xs.style.borderBottom||Xs.style.borderTop||Xs.style.borderLeft||Xs.style.borderRight)&&h.drawBorder(s,Xs.style,r,n[ve],2,k),n[Ct]=(isNaN(n[Ct])?m:n[Ct])+k}ve+=We-1}ve===T&&y&&h.drawBorder(s,N,r-2,n[ve]-Mb,2,k),ve===T&&y&&M&&!w&&(h.drawBorder(s,D,0,n[ve]-Mb,r,k),M=!1),Dt<=1&&(n[ve]+=k)}else if(y&&ve===L){var Dt=g(ue)||isNaN(l.rows[x].cells[ve].rowSpan)?1:Math.max(l.rows[x].cells[ve].rowSpan,0);n[ve]=isNaN(n[ve])?m:n[ve];var Xt=n[ve];s.font="11pt Calibri";for(var Lt=0;Lt<Dt;Lt++)r=0,Xt+=Lt===0?0:l.rows[x+Lt]&&l.rows[x+Lt-1].height||te.defaultCellHeight,h.rowHeaderText((x+1+Lt).toString(),s,h,S,r,R,Xt,l.rows[x+Lt].height||te.defaultCellHeight),r+=S;n[ve]+=k}oe=ve},te=this,oe,P=L;P<=T;P++)ne(P),P=oe}else if(g(l.rows[x])){var ae={borderBottom:"1px solid black",borderTop:"1px solid black",borderLeft:"1px solid black",borderRight:"1px solid black"};M=c+k+(x===0&&y?this.defaultCellHeight:0)>1080||x===l.rows.length-1||x===this.endRow-1;for(var P=L;P<=T;P++){var ye=l.rows[x]&&!g(l.rows[x].cells)&&l.rows[x].cells[P];!g(ye)&&!g(ye.style)&&(ae=this.setBorderStyle(ye,ae)),y&&P===L&&(h.rowHeaderText((x+1).toString(),s,h,S,r,ae,n[P],this.defaultCellHeight),r+=S);var De=l.columns[P]&&l.columns[P].width||this.defaultCellWidth;De=r+De>1e3?De-1-(r+De-1e3):De,n[P]=isNaN(n[P])?m:n[P],f.allowGridLines?h.drawBorder(s,ae,r,n[P],De,k):y&&!f.allowGridLines&&P===T&&h.drawBorder(s,{borderRight:"1px solid black"},r,n[P],De,k),r+=De,P===T&&y&&M&&(h.drawBorder(s,D,0,n[P],r,k),M=!1),n[P]+=k}}}if(!this.isImageLoaded&&!this.isChartLoaded)d&&this.endRow>0&&this.multipleCanvasDataURL.push(a.toDataURL()),t=0,this.pageCounts.length-1===I&&h.canvasPrint(this.parent,p,f);else if(this.isImageLoaded||this.isChartLoaded)break}},o.prototype.setBorderStyle=function(e,t){return t.borderBottom=g(e.style.borderBottom)?t.borderBottom:e.style.borderBottom,t.borderTop=g(e.style.borderTop)?t.borderTop:e.style.borderTop,t.borderRight=g(e.style.borderRight)?t.borderRight:e.style.borderRight,t.borderLeft=g(e.style.borderLeft)?t.borderLeft:e.style.borderLeft,t},o.prototype.setToDefault=function(){this.parent.currentPrintSheetIndex=0,this.initialRowCount=0,this.chartHeight=0,this.totalCharts=0,this.totalImages=0,this.chartLoadedCount=0,this.imageLoadedCount=0,this.endRow=0,this.pageCounts=[],this.multipleCanvasDataURL=[],this.chartElements=[],this.isChartLoaded=!1,this.isImageLoaded=!1,this.startNewPageCount=0},o.prototype.handleCharts=function(e,t,i,r,n,s,a,l,h,u,c,d,p,f,v,m,y,S,b){var w=this;if(!g(i.chart))for(var I=function(L){x.totalCharts+=1;var T=new Image;L.left=g(L.left)?0:L.left,L.top=g(L.top)?0:L.top;var k=document.getElementById(L.id);if(g(k)&&(x.parent.insertChart([L]),k=document.getElementById(L.id),x.chartElements.push(L.id+"_overlay")),!g(k)){x.chartHeight=L.height;var F=x.initialRowCount+Math.ceil(L.height/19)>x.endRow&&(d.allowRowColumnHeader||d.allowGridLines);if(F&&p.rows.length-1===t){var R=u+(c?x.defaultCellHeight:0);n.height>s+(x.chartHeight-R)?x.endRow+=Math.ceil((x.chartHeight-R)/19):x.endRow+=Math.ceil((n.height-(s+R))/19)}var N=k.cloneNode(!0),P=window.URL.createObjectURL(new Blob([new XMLSerializer().serializeToString(N.childNodes[1])],{type:"image/svg+xml"}));T.onload=function(){var O=Math.ceil(L.left/1e3)-1,z=Math.ceil(L.top/1080)-1,H=L.left+(c?37:0),Q=L.top+(c?19:0)+(z>0?h:0);if(r.drawImage(T,O<=0?H:H-O*1e3,z<=0?Q:Q-z*1160,L.width,L.height),w.chartLoadedCount++,w.chartLoadedCount===w.totalCharts&&(m+=L.width,w.isChartLoaded=!1,!w.isImageLoaded)){v.push(n.toDataURL());var $=w.initialRowCount===p.rows.length-1&&s<1080?p.rows.length:w.initialRowCount,U=w.endRow;w.processCell(e,$+1===U?U:$,U,m,y,r,n,p,f,S,s,!1,b,d)}},T.src=P,x.isChartLoaded=!0}},x=this,M=0,D=i.chart;M<D.length;M++){var A=D[M];I(A)}},o.prototype.processImages=function(e,t,i,r,n,s,a,l,h,u,c,d,p,f,v,m,y){var S=this;if(!g(i.image)){for(var b=function(D){w.totalImages+=1;var A=new Image;A.src=D.src,D.left=g(D.left)?0:D.left,D.top=g(D.top)?0:D.top,w.chartHeight=D.height;var L=w.initialRowCount+Math.ceil(D.height/19)>w.endRow&&(c.allowRowColumnHeader||c.allowGridLines);if(L&&t===d.rows.length-1){var T=l+(u?w.defaultCellHeight:0);r.height>s+(w.chartHeight-T)?w.endRow+=Math.ceil((w.chartHeight-T)/19):w.endRow+=Math.ceil((r.height-(s+T))/19)}A.onload=function(){var k=Math.ceil(D.left/1e3)-1,F=Math.ceil(D.top/1080)-1,R=D.left+(u?37:0),N=D.top+(u?19:0)+(F>0?h:0);if(n.drawImage(A,k<=0?R:R-k*1e3,F<=0?N:N-F*1160,D.width,D.height),S.imageLoadedCount++,S.imageLoadedCount===S.totalImages&&(S.isImageLoaded=!1,f+=D.width,!S.isChartLoaded)){S.multipleCanvasDataURL.push(r.toDataURL());var P=S.initialRowCount===d.rows.length-1&&s<1080?d.rows.length:S.initialRowCount,O=S.endRow;S.processCell(e,P+1===O?O:P,O,f,v,n,r,d,p,m,s,!1,y,c)}},A.onerror=function(){if(S.imageLoadedCount++,S.imageLoadedCount===S.totalImages&&(S.isImageLoaded=!1,!S.isChartLoaded)){S.multipleCanvasDataURL.push(r.toDataURL());var k=S.initialRowCount===d.rows.length-1&&s<1080?d.rows.length:S.initialRowCount,F=S.endRow;S.processCell(e,k+1===F?F:k,F,f,v,n,r,d,p,m,s,!1,y,c)}}},w=this,I=0,x=i.image;I<x.length;I++){var M=x[I];b(M)}this.isImageLoaded=!0}},o.prototype.textDecoration=function(e,t,i,r,n,s,a,l){a!==""&&(!g(e.style)&&!g(e.style.textDecoration)&&e.style.textDecoration.toLowerCase().indexOf("underline")>-1||!g(e.hyperlink))&&(t.beginPath(),t.moveTo(i,r-3),t.lineTo(i+(s.width>l?l:s.width),r-3),t.strokeStyle=n,t.lineWidth=1,t.stroke())},o.prototype.rowHeaderRect=function(e,t,i,r,n,s){s===void 0&&(s="#ffffff"),e.save(),e.beginPath(),e.rect(t,i,r,n),e.clip(),e.fillStyle=s,e.fillRect(t,i,r,n),e.restore()},o.prototype.rowHeaderText=function(e,t,i,r,n,s,a,l){var h=t.measureText(e),u=h.width,c=i.calculateTextPosition(u,r,n,"Center"),d=a;t.save(),t.beginPath(),t.rect(n,a,r,l),t.clip(),t.fillStyle="#000000",t.fillText(e,c,d+l),i.drawBorder(t,s,n,a||0,r,l),t.restore()},o.prototype.canvasPrint=function(e,t,i){var r=this;if(i.type==="Workbook"&&this.totalSheetCount.length-1>=this.workbookActiveSheetCount){var n=this.totalSheetCount[this.workbookActiveSheetCount],s=e.sheets[n];this.workbookActiveSheetCount++,this.activeSheetPrint(e,s,i,n)}else{for(var a=0;a<this.chartElements.length;a++){var l=document.getElementById(this.chartElements[a]);g(l)||l.remove()}if(this.multipleCanvasDataURL.length>0){var h=navigator.userAgent,u=window.open(" ","_blank","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no");u.document.write("<html><head><title></title></head><body>");var c=1e3,d=1400;h.indexOf("Chrome")!==-1||h.indexOf("Safari")!==-1||h.indexOf("Firefox")!==-1?(u.document.write("<!DOCTYPE html>"),u.document.write("<html><head><style>html, body {  } img { height: 100%; width: 100%; display: block; }@media print { body {  } img { width:100%; width:100%; box-sizing: border-box; }br, button { display: none; } div{ page-break-inside: avoid; }} @page{ size:"+c.toString()+"px "+d.toString()+"px; }</style></head><body>")):(u.document.write("<!DOCTYPE html>"),u.document.write("<html><head><style>html, body {  } img { height: 100%; width: 100%; }@media print { body {  }img { width:100%; width:100%; box-sizing: border-box; }br, button { display: none; } div{ page-break-inside: avoid; }} @page{ size:"+c.toString()+"px "+d.toString()+"px; }</style></head><body>")),this.multipleCanvasDataURL.forEach(function(p,f){var v=u.document.createElement("canvas");v.width=c,v.height=d;var m=v.getContext("2d"),y=new Image;y.onload=function(){m.drawImage(y,0,0,c,d),f===r.multipleCanvasDataURL.length-1&&(e.isPrintingProcessing=!1,u.print(),u.document.close(),u.close(),e.printModule.setToDefault())},y.src=p,u.document.body.appendChild(v)})}}},o.prototype.drawBorder=function(e,t,i,r,n,s){var a=t.borderBottom,l=t.borderLeft,h=t.borderRight,u=t.borderTop,c=t.borderColor;e.strokeStyle=c||"black",!g(a)&&a.indexOf("#FFFFFF")===-1&&(e.strokeStyle=a.split(" ")[2],this.drawPath(i,(r===2?-2:r)+s,i+n,(r===2?-2:r)+s,e,a,!1,t,"bottom")),!g(l)&&l.indexOf("#FFFFFF")===-1&&(e.strokeStyle=l.split(" ")[2],this.drawPath(i,r,i,(r===2?-2:r)+s,e,l,!0,t,"left")),!g(h)&&h.indexOf("#FFFFFF")===-1&&(e.strokeStyle=h.split(" ")[2],this.drawPath(i+n,r,i+n,(r===2?-2:r)+s,e,h,!1,t,"right")),!g(u)&&u.indexOf("#FFFFFF")===-1&&(e.strokeStyle=u.split(" ")[2],this.drawPath(i,r,i+n,r,e,u,!0,t,"top"))},o.prototype.drawPath=function(e,t,i,r,n,s,a,l,h){if(n.beginPath(),s.indexOf("dashed")>-1)n.setLineDash([3,2]),n.lineWidth=s.split(" ")[0].split("")[0];else if(s.indexOf("dotted")>-1)n.setLineDash([1,1]),n.lineWidth=s.split(" ")[0].split("")[0];else if(s.indexOf("double")>-1){n.setLineDash([]);var u=!g(l.borderBottom)&&!g(l.borderLeft)&&!g(l.borderRight)&&!g(l.borderTop),c=!g(l.borderBottom)&&!g(l.borderLeft)&&g(l.borderRight)&&g(l.borderTop),d=g(l.borderBottom)&&!g(l.borderLeft)&&g(l.borderRight)&&!g(l.borderTop),p=!g(l.borderBottom)&&!g(l.borderLeft)&&g(l.borderRight)&&!g(l.borderTop),f=!g(l.borderBottom)&&g(l.borderLeft)&&!g(l.borderRight)&&g(l.borderTop),v=g(l.borderBottom)&&g(l.borderLeft)&&!g(l.borderRight)&&!g(l.borderTop),m=!g(l.borderBottom)&&g(l.borderLeft)&&!g(l.borderRight)&&!g(l.borderTop),y=g(l.borderBottom)&&!g(l.borderLeft)&&!g(l.borderRight)&&!g(l.borderTop),S=!g(l.borderBottom)&&!g(l.borderLeft)&&!g(l.borderRight)&&g(l.borderTop);n.lineWidth=1;var b=3;u?e===i?a?this.drawDoubleBorder(n,e,t,i,r,e+b,t+b,i+b,r-(b-1)):this.drawDoubleBorder(n,e,t,i,r,e-b,t+b,i-b,r-(b-1)):t===r&&(a?this.drawDoubleBorder(n,e,t,i,r,e+(b-1),t+b,i-(b-1),r+b):this.drawDoubleBorder(n,e,t,i,r,e+(b-1),t-b,i-(b-1),r-b)):c?h==="left"?this.drawDoubleBorder(n,e,t,i,r,e+b,t,i+b,r-(b-1)):this.drawDoubleBorder(n,e,t,i,r,e+(b-1),t-b,i,r-b):d?h==="left"?this.drawDoubleBorder(n,e,t,i,r,e+b,t+(b-1),i+b,r):this.drawDoubleBorder(n,e,t,i,r,e+(b-1),t+b,i,r+b):p?h==="left"?this.drawDoubleBorder(n,e,t,i,r,e+b,t+b,i+b,r-(b-1)):h==="top"?this.drawDoubleBorder(n,e,t,i,r,e+(b-1),t+b,i,r+b):this.drawDoubleBorder(n,e,t,i,r,e+(b-1),t-b,i,r-b):f?h==="right"?this.drawDoubleBorder(n,e,t,i,r,e-b,t,i-b,r-(b-1)):this.drawDoubleBorder(n,e,t,i,r,e,t-b,i-(b-1),r-b):v?h==="right"?this.drawDoubleBorder(n,e,t,i,r,e-b,t+b,i-b,r):this.drawDoubleBorder(n,e,t,i,r,e,t+b,i-(b-1),r+b):m?h==="right"?this.drawDoubleBorder(n,e,t,i,r,e-b,t+b,i-b,r-(b-1)):h==="top"?this.drawDoubleBorder(n,e,t,i,r,e,t+b,i-(b-1),r+b):this.drawDoubleBorder(n,e,t,i,r,e,t-b,i-(b-1),r-b):y?h==="right"?this.drawDoubleBorder(n,e,t,i,r,e-b,t+b,i-b,r):h==="top"?this.drawDoubleBorder(n,e,t,i,r,e+b,t+b,i-(b-1),r+b):this.drawDoubleBorder(n,e,t,i,r,e+b,t+b,i+b,r):S?h==="right"?this.drawDoubleBorder(n,e,t,i,r,e-b,t,i-b,r-(b-1)):h==="bottom"?this.drawDoubleBorder(n,e,t,i,r,e+(b-1),t-b,i-(b-1),r-b):this.drawDoubleBorder(n,e,t,i,r,e+b,t,i+b,r-(b-1)):e===i?this.drawDoubleBorder(n,e,t,i,r,e+(h==="left"?b:-b),t,i+(h==="left"?b:-b),r):t===r&&this.drawDoubleBorder(n,e,t,i,r,e,t+(h==="top"?b:-b),i,r+(h==="top"?b:-b)),n.stroke();return}else n.setLineDash([]),n.lineWidth=s.split(" ")[0].split("")[0];n.moveTo(e,t),n.lineTo(i,r),n.stroke()},o.prototype.drawDoubleBorder=function(e,t,i,r,n,s,a,l,h){e.moveTo(t,i),e.lineTo(r,n),e.moveTo(s,a),e.lineTo(l,h)},o.prototype.calculateTextPosition=function(e,t,i,r,n){var s,a=3,l=t;if(l>=e)switch(r.toLowerCase()){case"left":s=i+a;break;case"center":s=i+(l-e)/2;break;case"right":n?s=i+l:s=i+l-e;break}else e<t?s=r.toLowerCase()==="left"?i+a:r.toLowerCase()==="center"?i+(t-e)/2:i+t-e:s=i+a;return s},o.prototype.calculatePageCount=function(e,t,i){var r=i,n=this.columnIndex;if(e.columns.length===0){var s=Math.floor(t/this.defaultCellWidth)-(r?1:0);return Array(Math.max(1,Math.ceil(n/s))).fill(s)}for(var a=0,l=[],h=0;h<=n;h++){var u=e.columns&&e.columns[h],c=(r?27:0)+(u&&u.hidden?0:u&&!g(u.width)?u.width:this.defaultCellWidth);a+=c,r=!1,a>t&&(l.push(h-1),r=!0,a=c)}return(l.length===0||n>l[l.length-1])&&l.push(n),l},o.prototype.wrapText=function(e,t,i,r){if(g(e))return[""];e=typeof e=="number"?e+"":e;for(var n=[],s=t-i,a="",l=0;l<e.length;l++){var h=e[l],u=a+h,c=Vr(u,r,this.parent.cellStyle)+s;c>t?(n.push(a),a=h):a=u}return n.push(a),n},o.prototype.getModuleName=function(){return"print"},o.prototype.destroy=function(){this.setToDefault(),this.totalSheetCount=[],this.parent=null},o}(),i9=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(e,t)};return function(e,t){o(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Yt=function(o,e,t,i){var r=arguments.length,n=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(e,t,n):s(e,t))||n);return r>3&&n&&Object.defineProperty(e,t,n),n},$O=function(o){i9(e,o);function e(i,r){var n=o.call(this,i)||this;return n.viewport={rowCount:0,colCount:0,height:0,topIndex:0,leftIndex:0,width:0,bottomIndex:0,rightIndex:0,beforeFreezeHeight:0,beforeFreezeWidth:0,scaleX:1,scaleY:1},n.needsID=!0,t.Inject(_O,UO,qO,zO,BO,jO,HO,PO,JI,GO,QO,YO,XO,VO,WO,Rq,SO,uO,cO,bO,fO,pO,Kq,gO,kq,Oq,vO,Zq,Fq,CO,Pq,Bq,wO,nq,zq,xO,t9,jq,MO,Hq,IO,Vq,DO,Jq,_q,mO,EO,e9,yO,Uq,AO,Wq),r&&n.appendTo(r),n}t=e,e.prototype.getCell=function(i,r,n){var s;return this.insideViewport(i,r)&&(n||(n=this.getRow(i,null,r)),r=this.getViewportIndex(r,!0),s=n&&n.cells[r]),s},e.prototype.getRow=function(i,r,n){if(!r){var s=this.getActiveSheet(),a=this.frozenRowCount(s),l=this.frozenColCount(s);g(n)||i>a-1&&n>l-1?r=this.getContentTable():r=i<a&&n<l?this.sheetModule.getSelectAllTable():i<a?this.getColHeaderTable():this.getRowHeaderTable()}return i=this.getViewportIndex(i),r?r.rows[i]:null},e.prototype.hiddenCount=function(i,r,n,s){n===void 0&&(n="rows"),s===void 0&&(s=this.getActiveSheet());for(var a=0,l,h=i;h<=r;h++)l=s[""+n][h],l&&l.hidden&&a++;return a},e.prototype.getViewportIndex=function(i,r){var n=this.getActiveSheet(),s=this.frozenColCount(n),a=this.frozenRowCount(n);if(r)if(s){var l=Se(n.topLeftCell)[1];return i<s?(i-=this.hiddenCount(l,i,"columns"),i-=l,i+1):(i-=this.hiddenCount(this.viewport.leftIndex+s,i,"columns"),i-=this.viewport.leftIndex+s,i)}else i-=this.hiddenCount(this.viewport.leftIndex,i,"columns"),i-=this.viewport.leftIndex;else if(a){var h=Se(n.topLeftCell)[0];return i<a?(i-=this.hiddenCount(h,i),i-=h,i+1):(i-=this.hiddenCount(this.viewport.topIndex+a,i),i-=this.viewport.topIndex+a,i)}else i-=this.hiddenCount(this.viewport.topIndex,i),i-=this.viewport.topIndex;return i},e.prototype.preRender=function(){o.prototype.preRender.call(this),this.serviceLocator=new TO,this.initServices()},e.prototype.initServices=function(){this.serviceLocator.register(fe,new Li(this.getModuleName(),dq,this.locale)),this.serviceLocator.register(jt,new qq(this)),this.serviceLocator.register(hq,new Gq(this)),this.serviceLocator.register(eM,new Yq(this))},e.prototype.render=function(){if(o.prototype.render.call(this),this.element.setAttribute("tabindex","0"),this.renderModule=new Dq(this),this.renderSpreadsheet(),this.wireEvents(),this.created&&!this.refreshing)if(this.created.observers){if(this.created.observers.length>0){var i={observers:this.created.observers};this.isAngular&&(i={observers:this.created.observers,currentObservers:this.created.observers},this.created.currentObservers=[]),this.createdHandler=i,this.created.observers=[]}}else this.createdHandler=this.created,this.setProperties({created:void 0},!0)},e.prototype.renderSpreadsheet=function(){this.cssClass&&Y([this.element],this.cssClass.split(" ")),this.setHeight(),this.setWidth(),Os({target:this.element},this.createElement),this.cssClass&&this.cssClass.indexOf("e-mobile-view")===-1&&this.isMobileView()&&this.element.classList.add("e-mobile-view"),B.isDevice&&this.element.classList.add("e-device"),this.sheetModule=this.serviceLocator.getService("sheet"),this.allowScrolling&&(this.scrollModule=new Tq(this)),this.scrollSettings.enableVirtualization&&new Lq(this),this.renderModule.render(),new Nq(this)},e.prototype.showSpinner=function(){rs(this.element)},e.prototype.hideSpinner=function(){Rs(this.element)},e.prototype.protectSheet=function(i,r,n){o.prototype.protectSheet.call(this,i,r,n)},e.prototype.unprotectSheet=function(i){o.prototype.unprotectSheet.call(this,i)},e.prototype.find=function(i){var r=this.getActiveSheet().activeCell;if(o.prototype.findHandler.call(this,i),!i.isAction)return r!==this.getActiveSheet().activeCell?this.getActiveSheet().name+"!"+this.getActiveSheet().activeCell:null},e.prototype.replace=function(i){i={value:i.value,mode:i.mode?i.mode:"Sheet",isCSen:i.isCSen?i.isCSen:!1,isEMatch:i.isEMatch?i.isEMatch:!1,searchBy:i.searchBy?i.searchBy:"By Row",replaceValue:i.replaceValue,replaceBy:i.replaceBy,sheetIndex:Ee(i.sheetIndex)?this.activeSheetIndex:i.sheetIndex,findOpt:i.findOpt?i.findOpt:""},o.prototype.replaceHandler.call(this,i)},e.prototype.findAll=function(i,r,n,s,a){r=r||"Sheet",a=a<this.sheets.length?a:this.activeSheetIndex,n=n||!1,s=s||!1;var l=[],h={value:i,mode:r,sheetIndex:a,isCSen:n,isEMatch:s,findCollection:l};return this.notify(gx,h),l},e.prototype.goTo=function(i){if(i.includes("!")){var r=yt(this,Ws(i));if(r===void 0)return;if(r!==this.activeSheetIndex){var n=i.substring(i.lastIndexOf("!")+1),s=n.split(":")[0],a=this.sheets[r];this.setSheetPropertyOnMute(a,"activeCell",s),this.setSheetPropertyOnMute(a,"selectedRange",n);var l=Se(s);if(a.frozenColumns||a.frozenRows){var h=Se(a.topLeftCell);if(!(a.frozenRows&&l[0]<h[0]||a.frozenColumns&&l[1]<h[1])){var u=this.frozenRowCount(a),c=this.frozenColCount(a),d=[],p=[],f=Se(a.paneTopLeftCell);u?(d.push(h[0]),l[0]>=u?p.push(l[0]):p.push(f[0])):(d.push(l[0]),p.push(l[0])),c?(d.push(h[1]),l[1]>=c?p.push(l[1]):p.push(f[1])):(d.push(l[1]),p.push(l[1])),this.setSheetPropertyOnMute(a,"topLeftCell",et(d[0],d[1])),this.setSheetPropertyOnMute(a,"paneTopLeftCell",et(p[0],p[1]))}}else l[0]<this.viewport.rowCount&&(l[0]=0),l[1]<this.viewport.colCount&&(l[1]=0),this.updateTopLeftCell(l[0],l[1],null,a);this.activeSheetIndex=r,this.dataBind();return}}var v=J(i),m=this.getActiveSheet(),y=this.frozenRowCount(m),S=this.frozenColCount(m),b=this.insideViewport(v[0],v[1]);if(b){this.selectRange(i);var w=Se(m.paneTopLeftCell),I=this.viewport.height;this.allowScrolling&&(I-=this.getScrollElement().parentElement.getBoundingClientRect().height);var x=0,M=0;if(y){for(var D=Se(m.topLeftCell),A=D[0];A<y;A++)if(x+=li(m,A),x>I){M=A;break}}if(M===0)for(var A=w[0];A<=this.viewport.bottomIndex;A++)if(x+=li(m,A),x>I){M=A;break}else A===this.viewport.bottomIndex&&(M=this.viewport.bottomIndex);w[2]=M;var L=0;if(x=0,I=this.viewport.width-this.sheetModule.getScrollSize(),S){for(var D=Se(m.topLeftCell),A=D[1];A<S;A++)if(x+=_r(m,A),x>I){L=A;break}}if(L===0)for(var A=w[1];A<=this.viewport.rightIndex;A++)if(x+=_r(m,A),x>I){L=A;break}else A===this.viewport.rightIndex&&(L=this.viewport.rightIndex);if(w[3]=L,v[0]>=w[0]&&v[0]<w[2]&&v[1]>=w[1]&&v[1]<w[3]||(y||S)&&(w=[].concat(Se(m.topLeftCell),[y,w[3]]),v[0]>=w[0]&&v[0]<w[2]&&v[1]>=w[1]&&v[1]<w[3]||(w[2]=M,w[3]=S,v[0]>=w[0]&&v[0]<w[2]&&v[1]>=w[1]&&v[1]<w[3])))return}var T=this.getMainContent().parentElement,k,F,R,N,P,O;v[0]===y?R=0:(R=Ri(m,y,v[0]-1,!0),this.scrollSettings.enableVirtualization&&(O=R+this.getContentTable().getBoundingClientRect().height,P=parseFloat(T.querySelector(".e-virtualtrack").style.height),O>P&&(O+=10,k=T.querySelector(".e-virtualtrack"),k.style.height=O+"px",cr(function(){k.style.height=P+"px"})))),T.scrollTop=R,T=this.element.getElementsByClassName("e-scroller")[0],v[1]===S?R=0:(R=Ci(m,S,v[1]-1,!0),this.scrollSettings.enableVirtualization&&(O=R+this.getContentTable().getBoundingClientRect().width,N=parseFloat(T.querySelector(".e-virtualtrack").style.width),O>N&&(O+=10,k=T.querySelector(".e-virtualtrack"),k.style.width=O+"px",F=this.getColumnHeaderContent().querySelector(".e-virtualtrack"),F.style.width=O+"px",k=this.getMainContent().querySelector(".e-virtualtrack"),k.style.width=O+"px",cr(function(){k.style.width=N+"px",F.style.width=N+"px"})))),T.scrollLeft=R,b||this.selectRange(i)},e.prototype.insideViewport=function(i,r){var n=this.getActiveSheet();if(n.frozenRows||n.frozenColumns){var s=this.frozenRowCount(n),a=this.frozenColCount(n),l=Se(n.topLeftCell);return(i>=l[0]&&i<s||i>=this.viewport.topIndex+s&&i<=this.viewport.bottomIndex)&&(r>=l[1]&&r<a||r>=this.viewport.leftIndex+a&&r<=this.viewport.rightIndex)}else return i>=this.viewport.topIndex&&i<=this.viewport.bottomIndex&&r>=this.viewport.leftIndex&&r<=this.viewport.rightIndex},e.prototype.resize=function(){this.renderModule.setSheetPanelSize(),this.scrollSettings.enableVirtualization&&this.renderModule.refreshSheet(!1,!0)},e.prototype.cut=function(i){var r=new Promise(function(n){n(function(){}())});return this.notify(Cu,i?{range:Qi(i),sId:this.sheets[yt(this,Ws(i))]?this.sheets[yt(this,Ws(i))].id:this.getActiveSheet().id,promise:r,invokeCopy:!0,isPublic:!0}:{promise:r,invokeCopy:!0,isPublic:!0}),r},e.prototype.copy=function(i){var r=new Promise(function(n){n(function(){}())});return this.notify(wu,i?{range:Qi(i),sId:this.sheets[yt(this,Ws(i))]?this.sheets[yt(this,Ws(i))].id:this.getActiveSheet().id,promise:r,invokeCopy:!0,isPublic:!0}:{promise:r,invokeCopy:!0,isPublic:!0}),r},e.prototype.paste=function(i,r){this.notify(Ga,{range:i&&Qi(i),sIdx:i&&yt(this,Ws(i)),type:r,isAction:!0,isInternal:!0})},e.prototype.updateAction=function(i){Zr(i,this)},e.prototype.setHeight=function(){this.height&&(this.height.toString().indexOf("%")>-1&&(this.element.style.minHeight="400px"),this.element.style.height=Le(this.height))},e.prototype.setWidth=function(){this.width&&((this.width.toString().indexOf("%")>-1||this.width==="auto")&&(this.element.style.minWidth="300px"),this.element.style.width=Le(this.width))},e.prototype.setColWidth=function(i,r,n){i===void 0&&(i=64),r===void 0&&(r=0);var s=g(n)?this.getActiveSheet():this.sheets[n];if(s&&(!s.isProtected||s.protectSettings.formatColumns)){var a=r,l=typeof i=="number"?i+"px":i;r=g(r)?Se(s.activeCell)[1]:r;var h=function(){Rt(s,a).width=parseInt(l,10)>0?parseInt(l,10):0,s.columns[a].customWidth=!0},u=this.frozenColCount(s);if(s.id===this.getActiveSheet().id){if(r>=this.viewport.leftIndex+u&&r<=this.viewport.rightIndex||u&&r<u){r=this.getViewportIndex(r,!0);var c=_r(s,a,null,!0),d=En(parseInt(l,10))-c;d<0&&c<-d&&(d=-c),h(),this.notify(_n,{threshold:d,colIdx:a,checkWrapCell:!0}),WI(a,r,l,!0,this)}else{var p=_r(s,r),d=void 0;parseInt(l,10)>0?d=-(p-parseInt(l,10)):d=-p,h(),this.notify(_n,{threshold:d,colIdx:r})}this.notify(Za,null)}else h()}},e.prototype.setRowHeight=function(i,r,n,s,a){i===void 0&&(i=20),r===void 0&&(r=0);var l=g(n)?this.getActiveSheet():this.sheets[n];if(l){var h=r;if(r=g(r)?Se(l.activeCell)[0]:r,a&&l.rows[r]&&l.rows[r].customHeight)return;var u=typeof i=="number"?i+"px":i,c=function(){bb(l,h,parseInt(u,10)>0?parseInt(u,10):0),l.rows[h].customHeight=!0};if(l.id===this.getActiveSheet().id){var d=this.frozenRowCount(l);if(r>=this.viewport.topIndex+d&&r<=this.viewport.bottomIndex||d&&r<d){r=this.getViewportIndex(h);var p=li(l,h,!0),f=En(parseInt(u,10))-p;f<0&&p<-f&&(f=-p),c(),this.notify(An,{threshold:f,rowIdx:h,isCustomHgt:!0}),g(s)&&(s=!1),s||(WI(h,r,u,!1,this),s=!1)}else{var v=li(l,r),f=void 0;parseInt(u,10)>0?f=-(v-parseInt(u,10)):f=-v,c(),this.notify(An,{threshold:f,rowIdx:h})}this.notify(Za,null)}else c()}},e.prototype.setRowsHeight=function(i,r,n){i===void 0&&(i=20),r||(r=["1:"+(this.getActiveSheet().usedRange.rowIndex+1)]),this.setSize(i,r,function(s){return Number(s)-1},this.setRowHeight.bind(this),n)},e.prototype.setColumnsWidth=function(i,r){i===void 0&&(i=64),r||(r=["A:"+Pi(this.getActiveSheet().usedRange.colIndex+1)]),this.setSize(i,r,function(n){return vn(n)},this.setColWidth.bind(this))},e.prototype.setSize=function(i,r,n,s,a){var l=this,h,u,c,d,p;r.forEach(function(f){f.includes("!")?(c=f.substring(0,f.lastIndexOf("!")),h=yt(l,c),f=f.substring(f.lastIndexOf("!")+1)):h=l.activeSheetIndex,f.includes(":")?(u=f.split(":"),d=n(u[0]),p=n(u[1])):d=p=n(f);for(var v=d;v<=p;v++)s(i,v,h,!1,a)})},e.prototype.autoFit=function(i){var r;i.indexOf("!")!==-1&&(r=yt(this,i.substring(0,i.lastIndexOf("!"))),i=i.substring(i.lastIndexOf("!")+1));var n=this.getIndexes(i),s=n.startIdx,a=n.endIdx,l=n.isCol,h=l?vn("XFD"):1048576;if(s<=h)a>h&&(a=h);else return;for(s;s<=a;s++)this.notify(cI,{idx:s,isCol:l,sheetIdx:r})},e.prototype.getIndexes=function(i){var r,n,s,a;if(i.indexOf(":")!==-1){var l=i.split(":");s=l[0],a=l[1]}else s=i,a=i;if(!g(s)){var h=this.getAddress(s);s=h.address,r=h.isCol}if(!g(a)){var u=this.getAddress(a);a=u.address,n=u.isCol}var c=r===!0&&n===!0,d=c?vn(s.toUpperCase()):parseInt(s,10),p=c?vn(a.toUpperCase()):parseInt(a,10);return{startIdx:d,endIdx:p,isCol:c}},e.prototype.getAddress=function(i){var r;return i.substring(0,1).match(/\D/g)?(r=!0,i=i.replace(/[0-9]/g,""),{address:i,isCol:r}):i.substring(0,1).match(/[0-9]/g)&&i.match(/\D/g)?{address:"",isCol:!1}:(i=(parseInt(i,10)-1).toString(),{address:i,isCol:r})},e.prototype.addHyperlink=function(i,r,n){this.insertHyperlink(i,r,n,!0)},e.prototype.removeHyperlink=function(i){this.notify(zf,{range:i,preventEventTrigger:!0})},e.prototype.insertHyperlink=function(i,r,n,s){if(this.allowHyperlink){var a=void 0,l=void 0,h=void 0,u=this.getActiveSheet();if(r=r||u.name+"!"+u.activeCell,h=J(r),qi(this,h)){this.notify(nr,null);return}for(var c=this.getCell(h[0],h[1]),d=[],p=0;c&&p<c.classList.length;p++)d.push(c.classList[p]);var f={hyperlink:i,address:r,displayText:n,cancel:!1},v={hyperlink:i,address:r,displayText:n};if(s||(this.trigger(w6,f),this.notify(ai,{action:"hyperlink",eventArgs:f})),!f.cancel){i=f.hyperlink,r=f.address;var m={hyperlink:i,cell:r,displayText:n,triggerEvt:!s};if(this.notify(od,m),r&&r.lastIndexOf("!")!==-1){var y=r.lastIndexOf("!");a=r.substring(0,y);for(var S=this.sheets,b=0;b<S.length;b++)S[b].name===a&&(l=b);u=this.sheets[l],r=r.substring(y+1)}if(!u)return;if(r=r||this.getActiveSheet().activeCell,h=J(r),s||(this.trigger(x6,v),this.notify(mt,{action:"hyperlink",eventArgs:f})),u===this.getActiveSheet()){this.serviceLocator.getService("cell").refreshRange(h,!1,!1,!1,!0,cs(this));for(var p=0;p<d.length;p++)this.getCell(h[0],h[1]).classList.contains(d[p])||this.getCell(h[0],h[1]).classList.add(d[p]);this.notify(Es,null)}}}},e.prototype.addDataValidation=function(i,r){o.prototype.addDataValidation.call(this,i,r)},e.prototype.removeDataValidation=function(i){o.prototype.removeDataValidation.call(this,i)},e.prototype.addInvalidHighlight=function(i){o.prototype.addInvalidHighlight.call(this,i)},e.prototype.removeInvalidHighlight=function(i){o.prototype.removeInvalidHighlight.call(this,i)},e.prototype.conditionalFormat=function(i){o.prototype.conditionalFormat.call(this,i)},e.prototype.clearConditionalFormat=function(i){i=i||this.getActiveSheet().selectedRange,o.prototype.clearConditionalFormat.call(this,i)},e.prototype.setPanelSize=function(){if(this.height!=="auto"){var i=document.getElementById(this.element.id+"_sheet_panel");i.style.height=this.element.getBoundingClientRect().height*this.viewport.scaleY-kO(i,null,this.viewport.scaleY)+"px"}},e.prototype.open=function(i){this.isOpen=!0,o.prototype.open.call(this,i),this.isOpen&&this.showSpinner()},e.prototype.hideRow=function(i,r,n){r===void 0&&(r=i),n===void 0&&(n=!0),this.renderModule?this.notify(Dn,{startIndex:i,endIndex:r,hide:n,actionUpdate:!1}):o.prototype.hideRow.call(this,i,r,n)},e.prototype.hideColumn=function(i,r,n){r===void 0&&(r=i),n===void 0&&(n=!0),this.renderModule?this.notify(Dn,{startIndex:i,endIndex:r,hide:n,isCol:!0,actionUpdate:!1}):o.prototype.hideColumn.call(this,i,r,n)},e.prototype.clear=function(i){this.notify(_f,{options:i})},e.prototype.refresh=function(i){var r=this;if(this.isReact&&this.clearTemplate(),i)this.notify(yd,null),this.sheets.length=0,this.sheetNameCount=1,this.notify(ma,{}),this.notify(uh,null),this.createSheet(),this.activeSheetIndex=this.sheets.length-1,this.notify(rh,null),this.notify(xt,{action:"initSheetInfo"}),this.renderModule.refreshSheet();else if(this.createdHandler){var n=function(){r.off(mI,n),r.refresh()};this.on(mI,n,this)}else this.notify(xu,{}),o.prototype.refresh.call(this)},e.prototype.insertImage=function(i,r){var n;for(n=0;n<i.length;n++)this.notify(Ya,{options:i[n],range:r||this.getActiveSheet().selectedRange,isPublic:!0})},e.prototype.deleteImage=function(i,r){this.notify(ga,{id:i,range:r||this.getActiveSheet().selectedRange})},e.prototype.getRowHeaderContent=function(){return this.sheetModule.getRowHeaderPanel()},e.prototype.getColumnHeaderContent=function(){return this.sheetModule.getColHeaderPanel()},e.prototype.getMainContent=function(){return this.sheetModule.getContentPanel()},e.prototype.getSelectAllContent=function(){return this.sheetModule.getSelectAllContent()},e.prototype.getScrollElement=function(){return this.sheetModule.getScrollElement()},e.prototype.getContentTable=function(){return this.sheetModule.getContentTable()},e.prototype.getRowHeaderTable=function(){return this.sheetModule.getRowHeaderTable()},e.prototype.getColHeaderTable=function(){return this.sheetModule.getColHeaderTable()},e.prototype.getThreshold=function(i){var r=Math.round((this.viewport[i+"Count"]+1)/2);return r<15?15:r},e.prototype.isMobileView=function(){return!g(this.cssClass)&&(this.cssClass.indexOf("e-mobile-view")>-1||B.isDevice)&&this.cssClass.indexOf("e-desktop-view")===-1&&!1},e.prototype.getValueRowCol=function(i,r,n,s,a,l,h){return o.prototype.getValueRowCol.call(this,i,r,n,s,a,l,h)},e.prototype.updateCell=function(i,r,n){g(n)&&(n=!0),this.updateCellInfo(i,r,n,void 0,void 0,!0)},e.prototype.updateCellInfo=function(i,r,n,s,a,l){if(r=r||this.getActiveSheet().activeCell,!qi(this,J(r))){var h=this.scrollSettings.isFinite;o.prototype.updateCellDetails.call(this,i,r,s,a,n,h,l)}},e.prototype.getRowData=function(i,r){return o.prototype.getRowData.call(this,i,r)},e.prototype.sort=function(i,r){var n=this;if(!this.allowSorting)return Promise.reject();var s=[];if(this.sortCollection)for(var a=this.sortCollection.length-1;a>=0;a--)this.sortCollection[a]&&this.sortCollection[a].sheetIndex===this.activeSheetIndex&&(s.push(this.sortCollection[a]),this.sortCollection.splice(a,1));return this.notify(mu,{sortOptions:i}),o.prototype.sort.call(this,i,r,s).then(function(l){return n.notify(ff,l),Promise.resolve(l)})},e.prototype.setValueRowCol=function(i,r,n,s,a,l){if(!this.isEdit&&r==="#CIRCULARREF!"){var h=ke(this,cn(this,i)),u={action:"isCircularReference",argValue:r,address:h.name+"!"+Pi(s)+n};this.notify(vl,u),r=u.argValue}if(o.prototype.setValueRowCol.call(this,i,r,n,s,a,l),this.allowEditing)this.notify(fi,{action:"refreshDependentCellValue",rowIdx:n,colIdx:s,sheetIdx:cn(this,i)});else{var c=cn(this,i);if(n--,s--,this.activeSheetIndex===c){var h=ke(this,c),d=void 0;if(!st(h,n)&&!Ot(h,s)&&(d=this.getCell(n,s)),d){if(d.parentElement){var p=d.parentElement.getAttribute("aria-rowindex");if(p&&Number(p)-1!==n)return}var f=G(n,s,h),v={value:f.value,format:f.format,onLoad:!0,formattedText:f.value,isRightAlign:!1,type:"General",cell:f,rowIndex:n,colIndex:s,isRowFill:!1};this.notify(en,v),this.refreshNode(d,v)}}}},e.prototype.getModuleName=function(){return"spreadsheet"},e.prototype.calculateNow=function(i,r){return o.prototype.calculateNow.call(this,i,r)},e.prototype.refreshNode=function(i,r){var n;if(i){if(r){if(r.result=g(r.formattedText)?g(r.result)?"":r.result:r.formattedText.toString(),!r.isRowFill){var s=i.querySelector(".e-fill-before");s&&ee(s);var a=X(".e-fill",i);a&&(ee(a),i.style.display="table-cell");var l=X(".e-fill-sec",i);l&&ee(l)}var h=X("#"+this.element.id+"_currency",i);if(h&&ee(h),r.type==="Accounting"&&Me(r.value)&&r.result.includes(r.curSymbol)){var u=void 0,c=void 0,d=void 0;r.result.trim().endsWith(r.curSymbol)?c=r.result:(u=r.result.includes(" "+r.curSymbol)?" "+r.curSymbol:r.curSymbol,c=r.result.split(u).join(""));var p=i.querySelector(".e-databar-value"),f=i.querySelector(".e-iconsetspan"),v=i,m=void 0;if(i.children.length>0&&i.children[i.childElementCount-1].className.indexOf("e-addNoteIndicator")>-1&&(m=document.getElementsByClassName("e-addNoteIndicator")[0]),p?(this.refreshNode(p,{result:c}),v=i.querySelector(".e-cf-databar")||i):i.querySelector("a")?i.querySelector("a").textContent=c:(d=!0,i.innerText=""),f&&i.insertBefore(f,i.firstElementChild),u){var y=this.createElement("span",{id:this.element.id+"_currency",styles:"float: left"});y.innerText=u,v.appendChild(y),g(m)||v.appendChild(m)}d&&(i.innerHTML+=c),i.classList.add("e-right-align");return}else{var S=void 0;r.result&&(r.result.toLowerCase()==="true"||r.result.toLowerCase()==="false")?(r.result=r.result.toUpperCase(),S="e-center-align",r.isRightAlign=!0):S="e-right-align",n=r.result,this.allowWrap||n.toString().includes(`
`)&&(n=n.replace(/\n/g,"")),r.isRightAlign?i.classList.add(S):i.classList.remove(S)}}n=g(n)?"":n,!g(r.rowIndex)&&!g(r.colIndex)&&Ie(i,{"aria-label":(n?n+" ":"")+et(r.rowIndex,r.colIndex)});var b=i.lastChild;b&&b.nodeName==="SPAN"&&b.classList.contains("e-iconsetspan")&&(b=null);var w=i.querySelector(".e-addNoteIndicator");w&&(b=w.previousSibling),i.querySelector(".e-databar-value")&&(b=i.querySelector(".e-databar-value").lastChild),i.querySelector(".e-hyperlink")&&(b=i.querySelector(".e-hyperlink").lastChild);var I=i.querySelector(".e-wrap-content");if(I&&!(i.querySelector(".e-hyperlink")||i.querySelector(".e-databar-value"))&&(I.lastChild||I.appendChild(document.createTextNode("")),b=I.lastChild),(this.isAngular||this.isVue)&&i.classList.contains("e-cell-template")&&b&&(b.nodeType===8||b.nodeType===3)){if(b.nodeType===3||n!==""){var x=function(){i.childElementCount||(b.nodeType===3?r.isRowFill||(b.nodeValue=n):i.appendChild(document.createTextNode(n)))};this.isAngular?cr(x):x()}}else b&&(b.nodeType===3||b.nodeType===1)?r.isRowFill||(!g(b.className)&&b.className.indexOf("e-addNoteIndicator")>-1&&(b=i.lastChild),b.nodeValue=n):i.appendChild(document.createTextNode(n))}},e.prototype.calculateHeight=function(i,r,n){r===void 0&&(r=1),n===void 0&&(n=1);var s=i&&i.fontSize||this.cellStyle.fontSize,a=i.fontFamily==="Arial Black"?1.44:1.24;return(s.indexOf("pt")>-1?parseInt(s,10)*1.33:parseInt(s,10))*a*r+n*a},e.prototype.skipHidden=function(i,r,n,s){n===void 0&&(n="rows"),s===void 0&&(s=this.scrollSettings.isFinite);var a=this.getActiveSheet(),l;this.scrollSettings.isFinite&&(l=(n==="rows"?a.rowCount:a.colCount)-1);for(var h=i;h<=r;h++)if(a[""+n][h]&&a[""+n][h].hidden){if(i===h&&i++,r++,s&&r>l){r=l;break}}else if(!s&&this.scrollSettings.isFinite&&r>l&&a[""+n][h-1]&&a[""+n][h-1].hidden){r--;break}return[i,r]},e.prototype.updateActiveBorder=function(i,r){r===void 0&&(r=".e-ribbon");var n=X(r+" .e-tab-header .e-indicator",this.element);n.style.display="none",Ye(n,{left:"",right:""}),Ye(n,{left:i.offsetLeft+"px",right:i.parentElement.offsetWidth-(i.offsetLeft+i.offsetWidth)+"px"}),n.style.display=""},e.prototype.undo=function(){this.notify(Ka,{isUndo:!0,isPublic:!0})},e.prototype.redo=function(){this.notify(Ka,{isUndo:!1,isPublic:!0})},e.prototype.updateUndoRedoCollection=function(i){this.notify(Zy,{args:i,isPublic:!0})},e.prototype.addDefinedName=function(i){var r={action:"addDefinedName",isAdded:!1,definedName:i};return this.notify(vl,r),r.isAdded},e.prototype.removeDefinedName=function(i,r){return o.prototype.removeDefinedName.call(this,i,r)},e.prototype.mouseClickHandler=function(i){this.notify(yu,i)},e.prototype.mouseDownHandler=function(i){this.notify(ml,i)},e.prototype.keyUpHandler=function(i){j(i.target,".e-find-dlg")?this.notify(Ix,i):this.notify(ds,i)},e.prototype.keyDownHandler=function(i){var r=j(i.target,".e-findtool-dlg");if(r){if(i.keyCode===9){var n=i.target;if(i.shiftKey){if(n.classList.contains("e-text-findNext-short")){var s=r.querySelector(".e-findRib-close .e-tbar-btn");s&&(i.preventDefault(),s.focus())}}else n.classList.contains("e-tbar-btn")&&n.parentElement.classList.contains("e-findRib-close")&&Fe(r)}}else{this.notify($a,i);var a=j(i.target,".e-dialog");!this.enableKeyboardNavigation&&(document.activeElement.classList.contains("e-cell")||a)&&[38,40,33,34,35,36,9].indexOf(i.keyCode)>-1&&i.preventDefault()}},e.prototype.freeze=function(i){if(!(!this.allowFreezePane||i.row<0||i.column<0)){if(i.triggerEvent){var r={row:i.row,column:i.column,cancel:!1,sheetIndex:this.activeSheetIndex};if(this.notify(ai,{eventArgs:r,action:"freezePanes"}),r.cancel)return}this.on(In,this.freezePaneUpdated,this),this.freezePanes(i.row,i.column),this.notify(Es,null)}},e.prototype.freezePaneUpdated=function(){this.off(In,this.freezePaneUpdated);var i=this.getActiveSheet();Fe(this.element),this.notify(mt,{eventArgs:{row:i.frozenRows,column:i.frozenColumns,sheetIndex:this.activeSheetIndex},action:"freezePanes"})},e.prototype.wireEvents=function(){E.add(this.element,"click",this.mouseClickHandler,this),E.add(this.element,Cd(),this.mouseDownHandler,this),E.add(this.element,"keyup",this.keyUpHandler,this),E.add(this.element,"keydown",this.keyDownHandler,this),this.on(vf,this.freeze,this),this.on(ls,this.refreshInsertDelete,this)},e.prototype.destroy=function(){this.isReact&&this.clearTemplate(),this.unwireEvents(),this.notify(Un,null),o.prototype.destroy.call(this),this.element.innerHTML="",this.element.removeAttribute("tabindex"),this.element.removeAttribute("role"),this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("min-height"),this.element.style.removeProperty("min-width"),this.sheetModule&&this.sheetModule.destroy()},e.prototype.unwireEvents=function(){E.remove(this.element,"click",this.mouseClickHandler),E.remove(this.element,Cd(),this.mouseDownHandler),E.remove(this.element,"keyup",this.keyUpHandler),E.remove(this.element,"keydown",this.keyDownHandler),this.off(vf,this.freeze),this.off(ls,this.refreshInsertDelete)},e.prototype.refreshInsertDelete=function(i){var r=this;if(i.modelType!=="Sheet"){var n,s;i.sheet.ranges.forEach(function(a){a.template&&a.address&&(s=J(a.address),n=r.updateRangeOnInsertDelete(i,s),n&&(a.address=Be(s)))}),this.setSheetPropertyOnMute(i.sheet,"ranges",i.sheet.ranges)}},e.prototype.addContextMenuItems=function(i,r,n,s){n===void 0&&(n=!0),this.notify(Yx,{items:i,text:r,insertAfter:n,isUniqueId:s})},e.prototype.removeContextMenuItems=function(i,r){this.notify(Qx,{items:i,isUniqueId:r})},e.prototype.enableContextMenuItems=function(i,r,n){r===void 0&&(r=!0),this.notify(Xx,{items:i,enable:r,isUniqueId:n})},e.prototype.enableFileMenuItems=function(i,r,n){r===void 0&&(r=!0),this.notify($x,{items:i,enable:r,isUniqueId:n})},e.prototype.hideFileMenuItems=function(i,r,n){r===void 0&&(r=!0),this.notify(Kx,{items:i,hide:r,isUniqueId:n})},e.prototype.addFileMenuItems=function(i,r,n,s){n===void 0&&(n=!0),this.notify(Zx,{items:i,text:r,insertAfter:n,isUniqueId:s})},e.prototype.hideRibbonTabs=function(i,r){r===void 0&&(r=!0),this.notify(Jx,{tabs:i,hide:r})},e.prototype.enableRibbonTabs=function(i,r){r===void 0&&(r=!0),this.notify(eI,{tabs:i,enable:r})},e.prototype.addRibbonTabs=function(i,r){this.notify(tI,{items:i,insertBefore:r})},e.prototype.enableToolbarItems=function(i,r,n){this.notify(da,[{tab:i,items:r,enable:n===void 0?!0:n}])},e.prototype.hideToolbarItems=function(i,r,n){n===void 0&&(n=!0),this.notify(rI,{tab:i,indexes:r,hide:n})},e.prototype.addToolbarItems=function(i,r,n){this.notify(iI,{tab:i,items:r,index:n})},e.prototype.selectRange=function(i){this.isEdit&&this.notify(fi,{action:"endEdit"}),this.notify(Su,{address:i})},e.prototype.selectChart=function(i){this.selectOverlay(i,!0)},e.prototype.selectImage=function(i){this.selectOverlay(i)},e.prototype.selectOverlay=function(i,r){var n=this.getActiveSheet();if(!(n.isProtected||!this.allowEditing)){if(!i){var s=Se(n.activeCell),a=G(s[0],s[1],n,!1,!0);r?a.chart&&a.chart.length&&(i=a.chart[a.chart.length-1].id):a.image&&a.image.length&&(i=a.image[a.image.length-1].id)}var l;if(i?(l=this.element.querySelector("#"+i),l.classList.contains("e-ss-overlay")||(l=l.parentElement)):l=this.element.querySelector(".e-ss-overlay"+(r?".e-datavisualization-chart":":not(.e-datavisualization-chart)")),l){var h=void 0,u=this.element.getElementsByClassName("e-ss-overlay-active")[0];u&&(u.classList.remove("e-ss-overlay-active"),h=u.classList.contains("e-datavisualization-chart"),h&&this.notify(cb,null)),l.classList.add("e-ss-overlay-active"),l.classList.contains("e-datavisualization-chart")?(this.notify(Ty,{id:l.id}),h||this.notify(Uf,{id:l.id})):h&&this.notify(Ao,null)}}},e.prototype.deselectChart=function(){this.notify(td,{selector:".e-datavisualization-chart"})},e.prototype.deselectImage=function(){this.notify(td,{selector:":not(.e-datavisualization-chart)"})},e.prototype.startEdit=function(){this.notify(fi,{action:"startEdit",isNewValueEdit:!1})},e.prototype.closeEdit=function(){this.notify(fi,{action:"cancelEdit"})},e.prototype.endEdit=function(){this.notify(fi,{action:"endEdit",isPublic:!0})},e.prototype.print=function(i){i===void 0&&(i={type:"ActiveSheet",allowRowColumnHeader:!1,allowGridLines:!1}),this.allowPrint&&!g(this.printModule)&&this.printModule.print(this,i)},e.prototype.onPropertyChanged=function(i,r){var n=this;o.prototype.onPropertyChanged.call(this,i,r);for(var s,a=0,l=Object.keys(i);a<l.length;a++){var h=l[a],u=void 0,c=void 0,d=this.getActiveSheet(),p=this.getScrollElement();switch(h){case"enableRtl":if(i.locale||i.currencyCode||(u=this.getColumnHeaderContent(),u&&(u=u.parentElement),!u))break;if(i.enableRtl?(u.style.marginRight="",document.getElementById(this.element.id+"_sheet_panel").classList.add("e-rtl")):(u.style.marginLeft="",document.getElementById(this.element.id+"_sheet_panel").classList.remove("e-rtl")),this.allowScrolling&&this.scrollModule.setPadding(!0),this.allowAutoFill){var f=this.element.querySelector(".e-dragfill-ddb");if(f){var v=at(f,"dropdown-btn");v&&(v.enableRtl=i.enableRtl,v.dataBind())}}if(this.sheetModule.setPanelWidth(d,this.getRowHeaderContent(),!0),this.allowImage||this.allowChart)for(var m=this.element.getElementsByClassName("e-ss-overlay"),y=void 0,S=void 0,b=void 0,w=0,I=m.length-1;w<=I;w++)S=m[0],S.classList.contains("e-datavisualization-chart")&&(b=S.querySelector(".e-accumulationchart"),b?y=at(b,"accumulationchart"):(b=S.querySelector(".e-chart"),y=b&&at(b,"chart")),y&&y.destroy()),ee(S),w===I&&this.notify(au,{});p&&(p.scrollLeft=0),this.selectRange(d.selectedRange);break;case"cssClass":r.cssClass&&K([this.element],r.cssClass.split(" ")),i.cssClass&&Y([this.element],i.cssClass.split(" "));break;case"activeSheetIndex":this.renderModule.refreshSheet(),this.notify(Iu,{idx:i.activeSheetIndex});break;case"width":this.setWidth(),this.resize();break;case"height":this.setHeight(),this.resize();break;case"showRibbon":this.notify(fl,{prop:"showRibbon",onPropertyChange:!0});break;case"showFormulaBar":this.notify(Ff,{uiUpdate:!0});break;case"showSheetTabs":this.notify(Uy,null);break;case"cellStyle":this.renderModule.refreshSheet();break;case"allowEditing":if(this.allowEditing){if(this.notify(fi,{action:"renderEditor"}),this.enableKeyboardNavigation){this.enableKeyboardNavigation=!1,this.dataBind(),this.enableKeyboardNavigation=!0,this.dataBind();var x=this.selectionSettings.mode;x!=="None"&&(this.selectionSettings.mode="None",this.dataBind(),this.selectionSettings.mode=x,this.dataBind())}}else this.notify(td,null);break;case"allowInsert":c=this.element.getElementsByClassName("e-add-sheet-tab")[0],c&&(c.disabled=!this.allowInsert,this.allowInsert?c.classList.contains("e-disabled")&&c.classList.remove("e-disabled"):c.classList.contains("e-disabled")||c.classList.add("e-disabled"));break;case"sheets":if(i.sheets===this.sheets){this.renderModule.refreshSheet(),this.notify(rh,null),this.notify(xt,{action:"initSheetInfo"});break}Object.keys(i.sheets).forEach(function(D,A){var L=Number(D),T=i.sheets[L],k=ke(n,L);if(T.ranges&&Object.keys(T.ranges).length){var F=Object.keys(T.ranges),R;F.forEach(function(ae,ye){T.ranges[Number(ae)].info||(R=ye)});var N,P,O,z;F.forEach(function(ae,ye){(Ee(R)||R===ye)&&(N=Number(ae),P=T.ranges[N],O=k.ranges[N],z=P.dataSource,P.fieldsOrder&&O.info&&!z&&O.dataSource&&(z=O.dataSource),z&&n.notify(ly,{sheetIdx:L,rangeIdx:N,changedData:z}))})}else if(T.paneTopLeftCell&&r.sheets&&r.sheets[""+L]&&r.sheets[""+L].paneTopLeftCell){if(n.activeSheetIndex!==Number(L))return;var H=Se(T.paneTopLeftCell),Q=Se(r.sheets[""+L].paneTopLeftCell);if(H[0]!==Q[0]){var $=n.frozenRowCount(n.getActiveSheet()),U=H[0]>$?Ri(n.getActiveSheet(),$,H[0]-1):0;n.notify(fb,{top:U})}if(H[1]!==Q[1]){var ie=n.frozenColCount(n.getActiveSheet()),ne=H[1]>ie?Ci(n.getActiveSheet(),ie,H[1]-1):0;n.notify(fb,{left:ne})}}else if(A===0&&n.renderModule.refreshSheet(),n.showSheetTabs&&T.name&&!s){var te=X(".e-sheet-tabs-items",n.element),oe=Number(L);te.children[oe+1]?n.notify($y,{items:te,value:T.name,idx:oe}):(n.notify(rh,null),s=!0)}});break;case"locale":this.refresh();break;case"currencyCode":i.locale||this.refresh();break;case"password":this.password.length>0&&this.showSheetTabs&&(this.element.querySelector(".e-add-sheet-tab").setAttribute("disabled","true"),this.element.querySelector(".e-add-sheet-tab").classList.add("e-disabled"));break;case"isProtected":if(this.isProtected){var M=this.element.getElementsByClassName("e-add-sheet-tab")[0];M&&(M.disabled=this.isProtected,this.isProtected?M.classList.contains("e-disabled")&&M.classList.add("e-disabled"):M.classList.contains("e-disabled")||M.classList.remove("e-disabled"))}break;case"allowFreezePane":this.notify(fl,{prop:"allowFreezePane",onPropertyChange:!0});break;case"allowImage":case"allowChart":this.renderModule.refreshSheet(),this.notify(fl,{prop:h,onPropertyChange:!0});break;case"calculationMode":r.calculationMode==="Manual"&&this.notify(xt,{action:"ClearDependentCellCollection"}),this.notify(fl,{prop:h,onPropertyChange:!0});break;case"allowResizing":i.allowResizing&&this.notify(zI,{propertyName:h});break;case"enableNotes":i.enableNotes&&this.notify(au,{});break;case"allowNumberFormatting":case"allowWrap":case"allowCellFormatting":this.notify(fl,{prop:h,onPropertyChange:!0}),this.notify(au,{});break;case"showAggregate":this.notify(yl,{remove:!this.showAggregate});break}}},e.prototype.requiredModules=function(){return oq(this)},e.prototype.appendTo=function(i){o.prototype.appendTo.call(this,i)},e.prototype.filter=function(i,r){return this.allowFiltering?(r=r||this.getActiveSheet().selectedRange,o.prototype.filter.call(this,i,r)):Promise.reject()},e.prototype.clearFilter=function(i,r){this.notify(jf,{field:i,sheetIndex:r})},e.prototype.applyFilter=function(i,r){var n=this;if(!this.allowFiltering)return Promise.reject();var s=new Promise(function(u){u(function(){}())});if(i&&i.length){var a;i.forEach(function(u){a={instance:{options:{type:u.type,format:u.type==="date"&&"yMd"}},arg3:u.value,arg2:u.operator},n.notify(_h,a),u.value=a.arg3})}var l=r?Gs(this,r):this.activeSheetIndex,h={predicates:i,range:r,isInternal:!0,promise:s,sIdx:l};return this.notify(Eo,h),h.promise},e.prototype.addCustomFunction=function(i,r,n){o.prototype.addCustomFunction.call(this,i,r,n),this.notify(dI,null)},e.prototype.setRangeReadOnly=function(i,r,n){r=r||this.getActiveSheet().selectedRange;var s=n||this.activeSheetIndex,a=tt(J(r)),l=ke(this,s);if(!g(l)){if(this.notify("actionBegin",{action:"readonly",eventArgs:{readOnly:i,range:r,sheetIdx:s}}),OO(r)||a[0]===0&&a[2]===l.rowCount-1)for(var h=a[1];h<=a[3];h++)if(i)ch(l,h,{isReadOnly:i});else{var u=Rt(l,h);u&&u.isReadOnly&&delete u.isReadOnly}else if(Sq(r)||a[1]===0&&a[3]===l.colCount-1)for(var c=a[0];c<=a[2];c++)if(i)hs(l,c,{isReadOnly:i});else{var d=Ar(l,c);d&&d.isReadOnly&&delete d.isReadOnly}else for(var p=a[1];p<=a[3];p++)for(var f=a[0];f<=a[2];f++)if(i)oi(f,p,l,{isReadOnly:i},!0);else{var v=G(f,p,l);v&&v.isReadOnly&&delete v.isReadOnly}for(var m=a[1];m<=a[3];m++)for(var y=a[0];y<=a[2];y++){var v=this.getCell(y,m);!i&&v&&v.classList.contains("e-readonly")?v.classList.remove("e-readonly"):v&&!v.classList.contains("e-readonly")&&(v.className+=" e-readonly")}this.notify("actionComplete",{action:"readonly",eventArgs:{readOnly:i,range:r,sheetIdx:s}})}};var t;return Yt([C("")],e.prototype,"cssClass",void 0),Yt([C(!0)],e.prototype,"allowScrolling",void 0),Yt([C(!0)],e.prototype,"allowResizing",void 0),Yt([C(!0)],e.prototype,"showAggregate",void 0),Yt([C(!0)],e.prototype,"enableClipboard",void 0),Yt([C(!0)],e.prototype,"enableContextMenu",void 0),Yt([C(!0)],e.prototype,"enableKeyboardNavigation",void 0),Yt([C(!0)],e.prototype,"enableKeyboardShortcut",void 0),Yt([C(!0)],e.prototype,"allowUndoRedo",void 0),Yt([C(!0)],e.prototype,"allowWrap",void 0),Yt([be({},wq)],e.prototype,"selectionSettings",void 0),Yt([be({},Cq)],e.prototype,"scrollSettings",void 0),Yt([q()],e.prototype,"beforeCellRender",void 0),Yt([q()],e.prototype,"beforeSelect",void 0),Yt([q()],e.prototype,"select",void 0),Yt([q()],e.prototype,"contextMenuBeforeOpen",void 0),Yt([q()],e.prototype,"fileMenuBeforeOpen",void 0),Yt([q()],e.prototype,"contextMenuBeforeClose",void 0),Yt([q()],e.prototype,"dialogBeforeOpen",void 0),Yt([q()],e.prototype,"fileMenuBeforeClose",void 0),Yt([q()],e.prototype,"contextMenuItemSelect",void 0),Yt([q()],e.prototype,"fileMenuItemSelect",void 0),Yt([q()],e.prototype,"beforeDataBound",void 0),Yt([q()],e.prototype,"dataBound",void 0),Yt([q()],e.prototype,"dataSourceChanged",void 0),Yt([q()],e.prototype,"cellEdit",void 0),Yt([q()],e.prototype,"cellEditing",void 0),Yt([q()],e.prototype,"cellEdited",void 0),Yt([q()],e.prototype,"cellSave",void 0),Yt([q()],e.prototype,"beforeCellSave",void 0),Yt([q()],e.prototype,"created",void 0),Yt([q()],e.prototype,"beforeSort",void 0),Yt([q()],e.prototype,"beforeHyperlinkCreate",void 0),Yt([q()],e.prototype,"afterHyperlinkCreate",void 0),Yt([q()],e.prototype,"beforeHyperlinkClick",void 0),Yt([q()],e.prototype,"afterHyperlinkClick",void 0),Yt([q()],e.prototype,"beforeConditionalFormat",void 0),Yt([q()],e.prototype,"actionBegin",void 0),Yt([q()],e.prototype,"actionComplete",void 0),Yt([q()],e.prototype,"openComplete",void 0),Yt([q()],e.prototype,"sortComplete",void 0),Yt([C("USD")],e.prototype,"currencyCode",void 0),e=t=Yt([bt],e),e}(aq);var KO=["template"],r9=["height","id","left","src","top","width"],n9=[],s9=(()=>{class o extends oo{constructor(t){super(),this.viewContainerRef=t,Na("currentInstance",this,this.viewContainerRef),this.registerEvents(n9),this.directivePropList=r9}}return o.\u0275fac=function(t){return new(t||o)(qn(es))},o.\u0275dir=nn({type:o,selectors:[["e-image"]],inputs:{height:"height",id:"id",left:"left",src:"src",top:"top",width:"width"},features:[Wr]}),o})(),a9=(()=>{class o extends lo{constructor(){super("image")}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275dir=nn({type:o,selectors:[["e-images"]],contentQueries:function(t,i,r){if(t&1&&qr(r,s9,4),t&2){let n;kr(n=Nr())&&(i.children=n)}},features:[Wr]}),o})(),o9=["dataLabelSettings","height","id","isSeriesInRows","legendSettings","markerSettings","primaryXAxis","primaryYAxis","range","theme","title","type","width"],l9=[],h9=(()=>{class o extends oo{constructor(t){super(),this.viewContainerRef=t,Na("currentInstance",this,this.viewContainerRef),this.registerEvents(l9),this.directivePropList=o9}}return o.\u0275fac=function(t){return new(t||o)(qn(es))},o.\u0275dir=nn({type:o,selectors:[["e-chart"]],inputs:{dataLabelSettings:"dataLabelSettings",height:"height",id:"id",isSeriesInRows:"isSeriesInRows",legendSettings:"legendSettings",markerSettings:"markerSettings",primaryXAxis:"primaryXAxis",primaryYAxis:"primaryYAxis",range:"range",theme:"theme",title:"title",type:"type",width:"width"},features:[Wr]}),o})(),u9=(()=>{class o extends lo{constructor(){super("chart")}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275dir=nn({type:o,selectors:[["e-charts"]],contentQueries:function(t,i,r){if(t&1&&qr(r,h9,4),t&2){let n;kr(n=Nr())&&(i.children=n)}},features:[Wr]}),o})(),c9=["chart","colSpan","format","formula","hyperlink","image","index","isLocked","isReadOnly","notes","rowSpan","style","validation","value","wrap"],d9=[],nM=(()=>{class o extends oo{constructor(t){super(),this.viewContainerRef=t,this.tags=["image","chart"],Na("currentInstance",this,this.viewContainerRef),this.registerEvents(d9),this.directivePropList=c9}}return o.\u0275fac=function(t){return new(t||o)(qn(es))},o.\u0275dir=nn({type:o,selectors:[["e-cell"]],contentQueries:function(t,i,r){if(t&1&&(qr(r,a9,5),qr(r,u9,5)),t&2){let n;kr(n=Nr())&&(i.childImage=n.first),kr(n=Nr())&&(i.childChart=n.first)}},inputs:{chart:"chart",colSpan:"colSpan",format:"format",formula:"formula",hyperlink:"hyperlink",image:"image",index:"index",isLocked:"isLocked",isReadOnly:"isReadOnly",notes:"notes",rowSpan:"rowSpan",style:"style",validation:"validation",value:"value",wrap:"wrap"},features:[Wr]}),o})(),sM=(()=>{class o extends lo{constructor(){super("cells")}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275dir=nn({type:o,selectors:[["e-cells"]],contentQueries:function(t,i,r){if(t&1&&qr(r,nM,4),t&2){let n;kr(n=Nr())&&(i.children=n)}},features:[Wr]}),o})(),p9=["cells","customHeight","format","height","hidden","index","isReadOnly"],f9=[],aM=(()=>{class o extends oo{constructor(t){super(),this.viewContainerRef=t,this.tags=["cells"],Na("currentInstance",this,this.viewContainerRef),this.registerEvents(f9),this.directivePropList=p9}}return o.\u0275fac=function(t){return new(t||o)(qn(es))},o.\u0275dir=nn({type:o,selectors:[["e-row"]],contentQueries:function(t,i,r){if(t&1&&qr(r,sM,5),t&2){let n;kr(n=Nr())&&(i.childCells=n.first)}},inputs:{cells:"cells",customHeight:"customHeight",format:"format",height:"height",hidden:"hidden",index:"index",isReadOnly:"isReadOnly"},features:[Wr]}),o})(),oM=(()=>{class o extends lo{constructor(){super("rows")}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275dir=nn({type:o,selectors:[["e-rows"]],contentQueries:function(t,i,r){if(t&1&&qr(r,aM,4),t&2){let n;kr(n=Nr())&&(i.children=n)}},features:[Wr]}),o})(),g9=["customWidth","format","hidden","index","isLocked","isReadOnly","validation","width"],v9=[],lM=(()=>{class o extends oo{constructor(t){super(),this.viewContainerRef=t,Na("currentInstance",this,this.viewContainerRef),this.registerEvents(v9),this.directivePropList=g9}}return o.\u0275fac=function(t){return new(t||o)(qn(es))},o.\u0275dir=nn({type:o,selectors:[["e-column"]],inputs:{customWidth:"customWidth",format:"format",hidden:"hidden",index:"index",isLocked:"isLocked",isReadOnly:"isReadOnly",validation:"validation",width:"width"},features:[Wr]}),o})(),hM=(()=>{class o extends lo{constructor(){super("columns")}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275dir=nn({type:o,selectors:[["e-columns"]],contentQueries:function(t,i,r){if(t&1&&qr(r,lM,4),t&2){let n;kr(n=Nr())&&(i.children=n)}},features:[Wr]}),o})(),m9=["address","dataSource","fieldsOrder","query","showFieldAsHeader","startCell","template"],y9=[],No=class extends oo{constructor(e){super(),this.viewContainerRef=e,Na("currentInstance",this,this.viewContainerRef),this.registerEvents(y9),this.directivePropList=m9}};No.\u0275fac=function(e){return new(e||No)(qn(es))};No.\u0275dir=nn({type:No,selectors:[["e-range"]],contentQueries:function(e,t,i){if(e&1&&qr(i,KO,5),e&2){let r;kr(r=Nr())&&(t.template=r.first)}},inputs:{address:"address",dataSource:"dataSource",fieldsOrder:"fieldsOrder",query:"query",showFieldAsHeader:"showFieldAsHeader",startCell:"startCell",template:"template"},features:[Wr]});Zf([PS()],No.prototype,"template",void 0);var uM=(()=>{class o extends lo{constructor(){super("ranges")}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275dir=nn({type:o,selectors:[["e-ranges"]],contentQueries:function(t,i,r){if(t&1&&qr(r,No,4),t&2){let n;kr(n=Nr())&&(i.children=n)}},features:[Wr]}),o})(),b9=["cFColor","format","range","type","value"],S9=[],C9=(()=>{class o extends oo{constructor(t){super(),this.viewContainerRef=t,Na("currentInstance",this,this.viewContainerRef),this.registerEvents(S9),this.directivePropList=b9}}return o.\u0275fac=function(t){return new(t||o)(qn(es))},o.\u0275dir=nn({type:o,selectors:[["e-conditionalformat"]],inputs:{cFColor:"cFColor",format:"format",range:"range",type:"type",value:"value"},features:[Wr]}),o})(),w9=(()=>{class o extends lo{constructor(){super("conditionalformats")}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275dir=nn({type:o,selectors:[["e-conditionalformats"]],contentQueries:function(t,i,r){if(t&1&&qr(r,C9,4),t&2){let n;kr(n=Nr())&&(i.children=n)}},features:[Wr]}),o})(),x9=["activeCell","colCount","columns","conditionalFormats","frozenColumns","frozenRows","index","isProtected","name","paneTopLeftCell","password","protectSettings","ranges","rowCount","rows","selectedRange","showGridLines","showHeaders","standardHeight","state","topLeftCell","usedRange"],I9=[],cM=(()=>{class o extends oo{constructor(t){super(),this.viewContainerRef=t,this.tags=["rows","columns","ranges","conditionalFormats"],Na("currentInstance",this,this.viewContainerRef),this.registerEvents(I9),this.directivePropList=x9}}return o.\u0275fac=function(t){return new(t||o)(qn(es))},o.\u0275dir=nn({type:o,selectors:[["e-sheet"]],contentQueries:function(t,i,r){if(t&1&&(qr(r,oM,5),qr(r,hM,5),qr(r,uM,5),qr(r,w9,5)),t&2){let n;kr(n=Nr())&&(i.childRows=n.first),kr(n=Nr())&&(i.childColumns=n.first),kr(n=Nr())&&(i.childRanges=n.first),kr(n=Nr())&&(i.childConditionalFormats=n.first)}},inputs:{activeCell:"activeCell",colCount:"colCount",columns:"columns",conditionalFormats:"conditionalFormats",frozenColumns:"frozenColumns",frozenRows:"frozenRows",index:"index",isProtected:"isProtected",name:"name",paneTopLeftCell:"paneTopLeftCell",password:"password",protectSettings:"protectSettings",ranges:"ranges",rowCount:"rowCount",rows:"rows",selectedRange:"selectedRange",showGridLines:"showGridLines",showHeaders:"showHeaders",standardHeight:"standardHeight",state:"state",topLeftCell:"topLeftCell",usedRange:"usedRange"},features:[Wr]}),o})(),dM=(()=>{class o extends lo{constructor(){super("sheets")}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275dir=nn({type:o,selectors:[["e-sheets"]],contentQueries:function(t,i,r){if(t&1&&qr(r,cM,4),t&2){let n;kr(n=Nr())&&(i.children=n)}},features:[Wr]}),o})(),M9=["comment","name","refersTo","scope"],D9=[],E9=(()=>{class o extends oo{constructor(t){super(),this.viewContainerRef=t,Na("currentInstance",this,this.viewContainerRef),this.registerEvents(D9),this.directivePropList=M9}}return o.\u0275fac=function(t){return new(t||o)(qn(es))},o.\u0275dir=nn({type:o,selectors:[["e-definedname"]],inputs:{comment:"comment",name:"name",refersTo:"refersTo",scope:"scope"},features:[Wr]}),o})(),A9=(()=>{class o extends lo{constructor(){super("definednames")}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275dir=nn({type:o,selectors:[["e-definednames"]],contentQueries:function(t,i,r){if(t&1&&qr(r,E9,4),t&2){let n;kr(n=Nr())&&(i.children=n)}},features:[Wr]}),o})();var T9=["actionBegin","actionComplete","afterHyperlinkClick","afterHyperlinkCreate","beforeCellFormat","beforeCellRender","beforeCellSave","beforeCellUpdate","beforeConditionalFormat","beforeDataBound","beforeHyperlinkClick","beforeHyperlinkCreate","beforeOpen","beforeSave","beforeSelect","beforeSort","cellEdit","cellEdited","cellEditing","cellSave","contextMenuBeforeClose","contextMenuBeforeOpen","contextMenuItemSelect","created","dataBound","dataSourceChanged","dialogBeforeOpen","fileMenuBeforeClose","fileMenuBeforeOpen","fileMenuItemSelect","openComplete","openFailure","queryCellInfo","saveComplete","select","sortComplete"],L9=[""],bl=class extends $O{constructor(e,t,i,r){super(),this.ngEle=e,this.srenderer=t,this.viewContainerRef=i,this.injector=r,this.tags=["sheets","definedNames"],this.element=this.ngEle.nativeElement,this.injectedModules=this.injectedModules||[];try{let n=this.injector.get("SpreadsheetClipboard");this.injectedModules.indexOf(n)===-1&&this.injectedModules.push(n)}catch{}try{let n=this.injector.get("SpreadsheetEdit");this.injectedModules.indexOf(n)===-1&&this.injectedModules.push(n)}catch{}try{let n=this.injector.get("SpreadsheetKeyboardNavigation");this.injectedModules.indexOf(n)===-1&&this.injectedModules.push(n)}catch{}try{let n=this.injector.get("SpreadsheetKeyboardShortcut");this.injectedModules.indexOf(n)===-1&&this.injectedModules.push(n)}catch{}try{let n=this.injector.get("SpreadsheetSelection");this.injectedModules.indexOf(n)===-1&&this.injectedModules.push(n)}catch{}try{let n=this.injector.get("SpreadsheetContextMenu");this.injectedModules.indexOf(n)===-1&&this.injectedModules.push(n)}catch{}try{let n=this.injector.get("SpreadsheetFormulaBar");this.injectedModules.indexOf(n)===-1&&this.injectedModules.push(n)}catch{}try{let n=this.injector.get("SpreadsheetRibbon");this.injectedModules.indexOf(n)===-1&&this.injectedModules.push(n)}catch{}try{let n=this.injector.get("SpreadsheetSave");this.injectedModules.indexOf(n)===-1&&this.injectedModules.push(n)}catch{}try{let n=this.injector.get("SpreadsheetOpen");this.injectedModules.indexOf(n)===-1&&this.injectedModules.push(n)}catch{}try{let n=this.injector.get("SpreadsheetSheetTabs");this.injectedModules.indexOf(n)===-1&&this.injectedModules.push(n)}catch{}try{let n=this.injector.get("SpreadsheetDataBind");this.injectedModules.indexOf(n)===-1&&this.injectedModules.push(n)}catch{}try{let n=this.injector.get("SpreadsheetCellFormat");this.injectedModules.indexOf(n)===-1&&this.injectedModules.push(n)}catch{}try{let n=this.injector.get("SpreadsheetNumberFormat");this.injectedModules.indexOf(n)===-1&&this.injectedModules.push(n)}catch{}try{let n=this.injector.get("SpreadsheetFormula");this.injectedModules.indexOf(n)===-1&&this.injectedModules.push(n)}catch{}this.registerEvents(T9),this.addTwoWay.call(this,L9),Na("currentInstance",this,this.viewContainerRef),this.context=new RS}ngOnInit(){this.context.ngOnInit(this)}ngAfterViewInit(){this.context.ngAfterViewInit(this)}ngOnDestroy(){this.context.ngOnDestroy(this)}ngAfterContentChecked(){this.tagObjects[0].instance=this.childSheets,this.childDefinedNames&&(this.tagObjects[1].instance=this.childDefinedNames),this.context.ngAfterContentChecked(this)}};bl.\u0275fac=function(e){return new(e||bl)(qn(Il),qn(Mg),qn(es),qn(Xd))};bl.\u0275cmp=qu({type:bl,selectors:[["ejs-spreadsheet"]],contentQueries:function(e,t,i){if(e&1&&(qr(i,KO,5),qr(i,dM,5),qr(i,A9,5)),e&2){let r;kr(r=Nr())&&(t.template=r.first),kr(r=Nr())&&(t.childSheets=r.first),kr(r=Nr())&&(t.childDefinedNames=r.first)}},inputs:{activeSheetIndex:"activeSheetIndex",allowAutoFill:"allowAutoFill",allowCellFormatting:"allowCellFormatting",allowChart:"allowChart",allowConditionalFormat:"allowConditionalFormat",allowDataValidation:"allowDataValidation",allowDelete:"allowDelete",allowEditing:"allowEditing",allowFiltering:"allowFiltering",allowFindAndReplace:"allowFindAndReplace",allowFreezePane:"allowFreezePane",allowHyperlink:"allowHyperlink",allowImage:"allowImage",allowInsert:"allowInsert",allowMerge:"allowMerge",allowNumberFormatting:"allowNumberFormatting",allowOpen:"allowOpen",allowPrint:"allowPrint",allowResizing:"allowResizing",allowSave:"allowSave",allowScrolling:"allowScrolling",allowSorting:"allowSorting",allowUndoRedo:"allowUndoRedo",allowWrap:"allowWrap",autoFillSettings:"autoFillSettings",calculationMode:"calculationMode",cellStyle:"cellStyle",cssClass:"cssClass",currencyCode:"currencyCode",definedNames:"definedNames",enableClipboard:"enableClipboard",enableContextMenu:"enableContextMenu",enableKeyboardNavigation:"enableKeyboardNavigation",enableKeyboardShortcut:"enableKeyboardShortcut",enableNotes:"enableNotes",enablePersistence:"enablePersistence",enableRtl:"enableRtl",height:"height",isProtected:"isProtected",listSeparator:"listSeparator",locale:"locale",openSettings:"openSettings",openUrl:"openUrl",password:"password",saveUrl:"saveUrl",scrollSettings:"scrollSettings",selectionSettings:"selectionSettings",sheets:"sheets",showAggregate:"showAggregate",showFormulaBar:"showFormulaBar",showRibbon:"showRibbon",showSheetTabs:"showSheetTabs",width:"width"},outputs:{actionBegin:"actionBegin",actionComplete:"actionComplete",afterHyperlinkClick:"afterHyperlinkClick",afterHyperlinkCreate:"afterHyperlinkCreate",beforeCellFormat:"beforeCellFormat",beforeCellRender:"beforeCellRender",beforeCellSave:"beforeCellSave",beforeCellUpdate:"beforeCellUpdate",beforeConditionalFormat:"beforeConditionalFormat",beforeDataBound:"beforeDataBound",beforeHyperlinkClick:"beforeHyperlinkClick",beforeHyperlinkCreate:"beforeHyperlinkCreate",beforeOpen:"beforeOpen",beforeSave:"beforeSave",beforeSelect:"beforeSelect",beforeSort:"beforeSort",cellEdit:"cellEdit",cellEdited:"cellEdited",cellEditing:"cellEditing",cellSave:"cellSave",contextMenuBeforeClose:"contextMenuBeforeClose",contextMenuBeforeOpen:"contextMenuBeforeOpen",contextMenuItemSelect:"contextMenuItemSelect",created:"created",dataBound:"dataBound",dataSourceChanged:"dataSourceChanged",dialogBeforeOpen:"dialogBeforeOpen",fileMenuBeforeClose:"fileMenuBeforeClose",fileMenuBeforeOpen:"fileMenuBeforeOpen",fileMenuItemSelect:"fileMenuItemSelect",openComplete:"openComplete",openFailure:"openFailure",queryCellInfo:"queryCellInfo",saveComplete:"saveComplete",select:"select",sortComplete:"sortComplete"},features:[Wr],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0});Zf([PS()],bl.prototype,"template",void 0);bl=Zf([AA([RS])],bl);var ZO=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=Gd({type:o}),o.\u0275inj=qd({imports:[[lS]]}),o})();var N9=["id","description"],F9=["*"],JO=(()=>{class o{static \u0275fac=function(i){return new(i||o)};static \u0275cmp=qu({type:o,selectors:[["","id","description"]],standalone:!0,features:[Ag],attrs:N9,ngContentSelectors:F9,decls:2,vars:0,consts:[[1,"sb-description-body"]],template:function(i,r){i&1&&(fE(),mi(0,"div",0),gE(1),$t())},encapsulation:2})}return o})();var O9=["remoteDataBinding"];var eR=(()=>{class o{constructor(){}spreadsheetObj;openUrl="https://ej2services.syncfusion.com/production/web-services/api/spreadsheet/open";saveUrl="https://ej2services.syncfusion.com/production/web-services/api/spreadsheet/save";data=new re({url:"https://ej2services.syncfusion.com/production/web-services/api/Orders",adaptor:new pM});created(){this.spreadsheetObj.cellFormat({fontWeight:"bold",textAlign:"center"},"A1:G1")}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=qu({type:o,selectors:[["app-root"]],viewQuery:function(i,r){if(i&1&&SE(O9,5),i&2){let n;kr(n=Nr())&&(r.spreadsheetObj=n.first)}},standalone:!0,features:[Ag],decls:102,vars:10,consts:[[2,"padding-left","20px"],[1,"control-section"],[3,"openUrl","saveUrl","created"],["remoteDataBinding",""],["name","Shipment Details"],["startCell","A2",3,"showFieldAsHeader","dataSource"],["value","Order ID"],["value","Customer Name"],["value","Freight"],["value","Ship Name"],["value","Ship City"],["value","Ship Country"],[3,"width"],["id","description-section"],["id","description"],["target","_blank","href","https://ej2.syncfusion.com/angular/documentation/spreadsheet/data-binding/#remote-data"]],template:function(i,r){i&1&&(mi(0,"div",0)(1,"p"),Ht(2," This sample demonstrates data binding to the "),mi(3,"code"),Ht(4,"Spreadsheet"),$t(),Ht(5," component with a remote service using "),mi(6,"code"),Ht(7,"DataManager"),$t(),Ht(8,". "),$t(),mi(9,"div",1)(10,"ejs-spreadsheet",2,3),rS("created",function(){return r.created()}),mi(12,"e-sheets")(13,"e-sheet",4)(14,"e-ranges"),$d(15,"e-range",5),$t(),mi(16,"e-rows")(17,"e-row")(18,"e-cells"),$d(19,"e-cell",6)(20,"e-cell",7)(21,"e-cell",8)(22,"e-cell",9)(23,"e-cell",10)(24,"e-cell",11),$t()()(),mi(25,"e-columns"),$d(26,"e-column",12)(27,"e-column",12)(28,"e-column",12)(29,"e-column",12)(30,"e-column",12)(31,"e-column",12),$t()()()()(),mi(32,"div",13),Ht(33,"Description"),$t(),mi(34,"div",14)(35,"p"),Ht(36," The "),mi(37,"code"),Ht(38,"Spreadsheet"),$t(),Ht(39," supports data binding. The "),mi(40,"code"),Ht(41,"dataSource"),$t(),Ht(42," property can be assigned with the instance of "),mi(43,"code"),Ht(44,"DataManager"),$t(),Ht(45," to bind remote data. "),$t(),mi(46,"p"),Ht(47," DataManager, which will act as an interface between the service endpoint and the Spreadsheet, requires the following minimum configuration to interact with the service endpoint properly: "),$t(),mi(48,"ul")(49,"li")(50,"code"),Ht(51,"DataManager > url"),$t(),Ht(52," : Defines the service endpoint to fetch data."),$t(),mi(53,"li")(54,"code"),Ht(55,"DataManager > adaptor"),$t(),Ht(56," : Defines the adaptor option. By default, "),mi(57,"code"),Ht(58,"ODataAdaptor"),$t(),Ht(59," is used for remote binding."),$t()(),mi(60,"p"),Ht(61," Adaptor is responsible for processing the response from the service endpoint and the request to it. The "),mi(62,"code"),Ht(63,"@syncfusion/ej2-data"),$t(),Ht(64," package provides some predefined adaptors that are designed to interact with service endpoints. They are: "),$t(),mi(65,"ul")(66,"li")(67,"code"),Ht(68,"UrlAdaptor"),$t(),Ht(69," : Use this to interact with any remote services. This is the base adaptor for all remote-based adaptors. "),$t(),mi(70,"li")(71,"code"),Ht(72,"ODataAdaptor"),$t(),Ht(73," : Use this to interact with OData endpoints."),$t(),mi(74,"li")(75,"code"),Ht(76,"ODataV4Adaptor"),$t(),Ht(77," : Use this to interact with OData V4 endpoints."),$t(),mi(78,"li")(79,"code"),Ht(80,"WebApiAdaptor"),$t(),Ht(81," : Use this to interact with Web API created under OData standards."),$t(),mi(82,"li")(83,"code"),Ht(84,"WebMethodAdaptor"),$t(),Ht(85," : Use this to interact with web methods."),$t()(),mi(86,"p"),Ht(87," In this demo, remote data is bound by assigning service data as an instance of "),mi(88,"code"),Ht(89,"DataManager"),$t(),Ht(90," to the "),mi(91,"code"),Ht(92,"dataSource"),$t(),Ht(93," property under the "),mi(94,"code"),Ht(95,"ranges"),$t(),Ht(96," of sheet. "),$t(),mi(97,"p"),Ht(98," More information about remote data binding can be found in this "),mi(99,"a",15),Ht(100," documentation"),$t(),Ht(101," section. "),$t()()()),i&2&&(jo(10),ao("openUrl",r.openUrl)("saveUrl",r.saveUrl),jo(5),ao("showFieldAsHeader",!1)("dataSource",r.data),jo(11),ao("width",100),jo(),ao("width",130),jo(),ao("width",100),jo(),ao("width",220),jo(),ao("width",150),jo(),ao("width",180))},dependencies:[ZO,bl,nM,sM,aM,oM,lM,hM,No,uM,cM,dM,JO],styles:[`.control-section{height:550px}
`],encapsulation:2})}return o})(),pM=class extends rp{processResponse(){let e=[],t=super.processResponse.apply(this,arguments);return t.result.forEach((i,r)=>{e[r]={},Object.keys(i).forEach(n=>{["OrderID","CustomerID","Freight","ShipName","ShipCity","ShipCountry"].indexOf(n)>-1&&(e[r][n]=i[n])})}),{result:e,count:t.count}}};BE(eR,zE).catch(o=>console.error(o));
