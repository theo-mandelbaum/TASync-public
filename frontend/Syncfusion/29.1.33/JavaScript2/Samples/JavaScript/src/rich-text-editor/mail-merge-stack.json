{"index.html":"<html><head><script src=\"https://cdn.syncfusion.com/ej2/28.1.33/dist/ej2.min.js\" type=\"text/javascript\"></script>\n    <link href=\"https://cdn.syncfusion.com/ej2/28.1.33/{{theme}}.css\" rel=\"stylesheet\">\n\n    <link href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\" rel=\"stylesheet\">\n\n    <style>\n            body{\n                touch-action:none;\n            }\n            .control-section{\n                margin-top:100px;\n            }\n        </style></head><body><div class=\"stackblitz-container {{theme}}\"><div class=\"control-section\">\n    <div class=\"sample-container\">\n        <div id=\"mailMergeEditor\"></div>\n        <button class=\"e-control e-lib e-btn e-formats-tbar-btn e-rte-elements e-tbar-btn\" tabindex=\"-1\" id=\"merge_data\" style=\"width: 100%\">\n            <span style=\"display: inline-flex\"><span class=\"e-tbar-btn-text\">Merge Data</span></span>\n        </button>\n        <button class=\"e-rte-dropdown-btn e-control e-dropdown-btn e-lib e-btn e-rte-dropdown-popup e-rte-dropdown-items e-formats-tbar-btn e-rte-elements e-tbar-btn\" id=\"insertField\"></button>\n        <div id=\"mentionField\"></div>\n    </div>\n</div>\n\n\n\n\n</div></body></html>","index.js":"{{ripple}}/**\n * Rich Text Editor mention integration sample\n */\n\n\n  var rteValue = '<p>Dear <span contenteditable=\"false\" class=\"e-mention-chip\"><span>{{FirstName}}</span></span> ' + '<span contenteditable=\"false\" class=\"e-mention-chip\"><span>{{LastName}}</span></span>,</p>' + '<p>We are thrilled to have you with us! Your unique promotional code for this month is: ' + '<span contenteditable=\"false\" class=\"e-mention-chip\"><span>{{PromoCode}}</span></span>.</p>' + '<p>Your current subscription plan is: ' + '<span contenteditable=\"false\" class=\"e-mention-chip\"><span>{{SubscriptionPlan}}</span></span>.</p>' + '<p>Your customer ID is: ' + '<span contenteditable=\"false\" class=\"e-mention-chip\"><span>{{CustomerID}}</span></span>.</p>' + '<p>Your promotional code expires on: ' + '<span contenteditable=\"false\" class=\"e-mention-chip\"><span>{{ExpirationDate}}</span></span>.</p>' + \"<p>Feel free to browse our latest offerings and updates. If you need any assistance, don't hesitate to contact us at \" + '<a href=\"mailto:{{SupportEmail}}\"><span contenteditable=\"false\" class=\"e-mention-chip\"><span>{{SupportEmail}}</span></span></a> ' + 'or call us at <span contenteditable=\"false\" class=\"e-mention-chip\"><span>{{SupportPhoneNumber}}</span></span>.</p>' + '<p>Best regards,<br>The <span contenteditable=\"false\" class=\"e-mention-chip\"><span>{{CompanyName}}</span></span> Team</p>';\n\n  var dropdownContent =\n    ' <span style=\"display:inline-flex;\"><span class=\"e-rte-dropdown-btn-text\">Insert Field</span></span>';\n\n  var textToValueMap = {\n    'First Name': 'FirstName',\n    'Last Name': 'LastName',\n    'Support Email': 'SupportEmail',\n    'Company Name': 'CompanyName',\n    'Promo Code': 'PromoCode',\n    'Support Phone Number': 'SupportPhoneNumber',\n    'Customer ID': 'CustomerID',\n    'Expiration Date': 'ExpirationDate',\n    'Subscription Plan': 'SubscriptionPlan',\n  };\n\n  var mergeData = [\n    { Name: 'First Name', Field: 'FirstName' },\n    { Name: 'Last Name', Field: 'LastName' },\n    { Name: 'Promo Code', Field: 'PromoCode' },\n    { Name: 'Customer ID', Field: 'CustomerID' },\n    { Name: 'Subscription Plan', Field: 'SubscriptionPlan' },\n    { Name: 'Expiration Date', Field: 'ExpirationDate' },\n    { Name: 'Support Email', Field: 'SupportEmail' },\n    { Name: 'Support Phone Number', Field: 'SupportPhoneNumber' },\n    { Name: 'Company Name', Field: 'CompanyName' },\n  ];\n\n  var placeholderData = {\n    FirstName: 'John',\n    LastName: 'Doe',\n    PromoCode: 'ABC123',\n    SubscriptionPlan: 'Premium',\n    CustomerID: '123456',\n    ExpirationDate: '2024-12-31',\n    SupportEmail: 'support@example.com',\n    SupportPhoneNumber: '+1-800-555-5555',\n    CompanyName: 'Example Inc.',\n  };\n\n  function onActionBegin(args) {\n    if (\n      args.requestType === 'EnterAction' &&\n      mergeObj.element.classList.contains('e-popup-open')\n    ) {\n      args.cancel = true;\n    }\n  }\n\n  function onActionComplete(e) {\n    if (e.requestType === 'SourceCode') {\n      mailMergeEditor.getToolbar().querySelector('#merge_data').parentElement.classList.add('e-overlay');\n      mailMergeEditor.getToolbar().querySelector('#insertField').parentElement.classList.add('e-overlay');\n    } else if (e.requestType === 'Preview') {\n      mailMergeEditor.getToolbar().querySelector('#merge_data').parentElement.classList.remove('e-overlay');\n      mailMergeEditor.getToolbar().querySelector('#insertField').parentElement.classList.remove('e-overlay');\n    }\n  }\n\n  function onItemSelect(args) {\n    if (args.item.text != null) {\n      var value = textToValueMap[args.item.text];\n      var trimmedValue = value.trim();\n      mailMergeEditor.formatter.editorManager.nodeSelection.restore();\n      mailMergeEditor.executeCommand(\n        'insertHTML',\n        '<span contenteditable=\"false\" class=\"e-mention-chip\"><span>{{' +\n        trimmedValue +\n        '}}</span></span>&nbsp;',\n        { undo: true }\n      );\n    }\n  }\n\n  function onClickHandler() {\n    if (mailMergeEditor) {\n      var editorContent = mailMergeEditor.value;\n      var mergedContent = replacePlaceholders(editorContent, placeholderData);\n      if (mailMergeEditor.formatter.getUndoRedoStack().length === 0) {\n        mailMergeEditor.formatter.saveData();\n      }\n      mailMergeEditor.value = mergedContent;\n      mailMergeEditor.formatter.saveData();\n    } else {\n      console.log('MailMergeEditor is not initialized.');\n    }\n  }\n\n  function replacePlaceholders(template, data) {\n    return template.replace(/{{\\s*(\\w+)\\s*}}/g, function (match, key) {\n      var value = data[key.trim()];\n      return value !== undefined ? value : match;\n    });\n  }\n\n  var mailMergeEditor = new ej.richtexteditor.RichTextEditor({\n    value: rteValue,\n    toolbarSettings: {\n      items: [\n        'Bold',\n        'Italic',\n        'Underline',\n        '|',\n        'Formats',\n        'Alignments',\n        'OrderedList',\n        'UnorderedList',\n        '|',\n        'CreateLink',\n        'Image',\n        'CreateTable',\n        '|',\n        { tooltipText: 'Merge Data', template: '#merge_data' },\n        { tooltipText: 'Insert Field', template: '#insertField' },\n        'SourceCode',\n        '|',\n        'Undo',\n        'Redo',\n      ],\n    },\n    actionBegin: onActionBegin,\n    actionComplete: onActionComplete,\n    saveInterval: 1,\n  });\n  mailMergeEditor.appendTo('#mailMergeEditor');\n\n  var insertField = new ej.splitbuttons.DropDownButton({\n    items: [\n      { text: 'First Name' },\n      { text: 'Last Name' },\n      { text: 'Support Email' },\n      { text: 'Company Name' },\n      { text: 'Promo Code' },\n      { text: 'Support Phone Number' },\n      { text: 'Customer ID' },\n      { text: 'Expiration Date' },\n      { text: 'Subscription Plan' },\n    ],\n    content: dropdownContent,\n    select: onItemSelect,\n  });\n  insertField.appendTo('#insertField');\n\n  var mergeField = document.getElementById('merge_data');\n  if (mergeField) {\n    mergeField.addEventListener('click', onClickHandler);\n  }\n\n  var mergeObj = new ej.dropdowns.Mention({\n    dataSource: mergeData,\n    fields: { text: 'Name', value: 'Field' },\n    displayTemplate: '<span>{{${Field}}}</span>',\n\n    popupWidth: '250px',\n    popupHeight: '200px',\n    target: mailMergeEditor.inputElement,\n    mentionChar: '{{',\n    allowSpaces: true,\n  });\n  mergeObj.appendTo('#mentionField');\n\n"}