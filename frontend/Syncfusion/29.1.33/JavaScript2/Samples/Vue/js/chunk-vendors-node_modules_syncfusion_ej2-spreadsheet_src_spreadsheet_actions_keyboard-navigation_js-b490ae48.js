"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkej2_vue_samples"] = self["webpackChunkej2_vue_samples"] || []).push([["chunk-vendors-node_modules_syncfusion_ej2-spreadsheet_src_spreadsheet_actions_keyboard-navigation_js-b490ae48"],{

/***/ "./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/actions/keyboard-navigation.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/actions/keyboard-navigation.js ***!
  \*************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   KeyboardNavigation: () => (/* binding */ KeyboardNavigation)\n/* harmony export */ });\n/* harmony import */ var _common_index__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/index */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/common/index.js\");\n/* harmony import */ var _workbook_index__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../workbook/index */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/workbook/index.js\");\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"./node_modules/@syncfusion/ej2-base/index.js\");\n\n\n\n\n\n\n/**\n * Represents keyboard navigation support for Spreadsheet.\n */\nvar KeyboardNavigation = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Keyboard Navigation module.\n     *\n     * @private\n     * @param {Spreadsheet} parent - Specify the spreadsheet\n     */\n    function KeyboardNavigation(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        /* code snippet */\n    }\n    KeyboardNavigation.prototype.addEventListener = function () {\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.keyDown, this.keyDownHandler, this);\n        /* code snippet */\n    };\n    KeyboardNavigation.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.keyDown, this.keyDownHandler);\n        }\n        /* code snippet */\n    };\n    KeyboardNavigation.prototype.keyDownHandler = function (e) {\n        var _this = this;\n        var target = e.target;\n        var isRtl = this.parent.enableRtl;\n        var isKeyboardShortcut = this.parent.enableKeyboardShortcut;\n        if (e.altKey && (e.keyCode === 38 || e.keyCode === 40) && !isKeyboardShortcut) {\n            e.preventDefault();\n            return;\n        }\n        /*alt + up to close filter popup*/\n        if (e.altKey && e.keyCode === 38 && this.parent.element.lastElementChild.classList.contains('e-filter-popup')) {\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.filterCellKeyDown, { closePopup: true });\n            return;\n        }\n        if (this.parent.allowPrint && e.ctrlKey && e.keyCode === 80 && isKeyboardShortcut) {\n            e.preventDefault();\n            this.parent.print();\n            return;\n        }\n        var textarea = e.target;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(textarea) && textarea.classList.contains('e-addNoteContainer')) {\n            if (e.key === 'Escape' || e.keyCode === 27) {\n                var isNoteCellIndex = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(this.parent.spreadsheetNoteModule.noteCellIndexes);\n                var cellIndexes = isNoteCellIndex ? this.parent.spreadsheetNoteModule.noteCellIndexes :\n                    (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(this.parent.getActiveSheet().activeCell);\n                var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(cellIndexes[0], cellIndexes[1], this.parent.getActiveSheet());\n                var targetElement = this.parent.getCell(cellIndexes[0], cellIndexes[1]);\n                var address = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSheetName)(this.parent, this.parent.activeSheetIndex) + '!' + (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(cellIndexes);\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(textarea) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(textarea.value)\n                    && (((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(cell) || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(cell.notes)) || (cell.notes !== textarea.value))\n                    && document.activeElement.className.indexOf('e-addNoteContainer') > -1) {\n                    var eventAction = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(cell) && cell.notes ? 'editNote' : 'addNote';\n                    this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.setActionData, { args: { action: 'beforeCellSave', eventArgs: { address: address } } });\n                    (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.updateCell)(this.parent, this.parent.getActiveSheet(), { rowIdx: cellIndexes[0], colIdx: cellIndexes[1], preventEvt: true,\n                        cell: { notes: textarea.value, isNoteEditable: false } });\n                    var eventArgs = { notes: textarea.value, address: address };\n                    this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.completeAction, { eventArgs: eventArgs, action: eventAction });\n                }\n                this.parent.spreadsheetNoteModule.isShowNote = null;\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.removeNoteContainer, '');\n                (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(targetElement);\n            }\n            return;\n        }\n        var dlgInst = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_0__.dialog).dialogInstance;\n        var isNameBox = target.id === this.parent.element.id + \"_name_box\";\n        if (this.parent.selectionSettings.mode === 'None' || dlgInst || this.parent.isEdit || (target.classList.contains('e-ss-ddb') &&\n            e.keyCode !== 117 && e.keyCode !== 9) || (isNameBox && e.keyCode !== 117) || target.classList.contains('e-sheet-rename') ||\n            target.id === this.parent.element.id + \"_SearchBox\" || target.classList.contains('e-chk-hidden') || (target.classList.contains('e-ddl') &&\n            target.classList.contains('e-input-focus'))) {\n            if (dlgInst) {\n                if (e.keyCode === 13) {\n                    if (dlgInst.element.classList.contains('e-spreadsheet-function-dlg') &&\n                        (target.classList.contains('e-formula-list') || target.classList.contains('e-list-item'))) {\n                        (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(dlgInst.element.querySelector('.e-footer-content .e-primary'));\n                    }\n                }\n                else if (e.keyCode === 9) { // To maintain the focus inside the dialogs on the tab or shift + tab key\n                    if (dlgInst.element.classList.contains('e-find-dlg')) {\n                        var footerBtns = dlgInst.element.querySelectorAll('.e-footer-content .e-btn:not(:disabled)');\n                        var cls = footerBtns.length ? footerBtns[footerBtns.length - 1].className :\n                            'e-findnreplace-checkmatch';\n                        if (e.shiftKey) {\n                            if (document.activeElement.classList.contains('e-dlg-closeicon-btn')) {\n                                e.preventDefault();\n                                if (footerBtns.length) {\n                                    (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(footerBtns[footerBtns.length - 1]);\n                                }\n                                else {\n                                    var cBoxWrapper = dlgInst.element.querySelector('.e-findnreplace-exactmatchcheckbox');\n                                    if (cBoxWrapper) {\n                                        (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(cBoxWrapper.querySelector('.e-findnreplace-checkmatch'));\n                                        cBoxWrapper.classList.add('e-focus');\n                                    }\n                                }\n                            }\n                        }\n                        else if (document.activeElement.className.includes(cls)) {\n                            (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(dlgInst.element);\n                        }\n                    }\n                    else if (dlgInst.element.classList.contains('e-protect-dlg')) {\n                        if (e.shiftKey ? document.activeElement.classList.contains('e-primary') :\n                            document.activeElement.id === this.parent.element.id + \"_protect_check\") {\n                            var listWrapper = dlgInst.element.querySelector('.e-protect-option-list');\n                            if (listWrapper && !listWrapper.querySelector('.e-list-item.e-focused')) {\n                                var listEle = listWrapper.querySelector('.e-list-item');\n                                if (listEle) {\n                                    listEle.classList.add('e-focused');\n                                }\n                            }\n                        }\n                    }\n                    else if (dlgInst.element.classList.contains('e-custom-format-dlg')) {\n                        if (!e.shiftKey) {\n                            if (document.activeElement.classList.contains('e-btn') &&\n                                document.activeElement.parentElement.classList.contains('e-custom-dialog')) {\n                                var listWrapper = dlgInst.element.querySelector('.e-custom-listview');\n                                var listObj = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.getComponent)(listWrapper, 'listview');\n                                if (listWrapper) {\n                                    var listEle = listWrapper.querySelector('.e-list-item.e-active');\n                                    if (!listEle) {\n                                        listEle = listWrapper.querySelector('.e-list-item');\n                                        if (listEle) {\n                                            listObj.selectItem(listEle);\n                                        }\n                                        else {\n                                            return;\n                                        }\n                                    }\n                                    e.preventDefault();\n                                    listEle.focus();\n                                }\n                            }\n                            else if (document.activeElement.classList.contains('e-list-item')) {\n                                (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(dlgInst.element);\n                            }\n                        }\n                        else if (document.activeElement.className.includes('e-list-item e-active')) {\n                            var listWrapper = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.closest)(document.activeElement, '.e-custom-listview');\n                            if (listWrapper) {\n                                (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(listWrapper);\n                            }\n                        }\n                    }\n                    else if (dlgInst.element.classList.contains('e-spreadsheet-function-dlg')) {\n                        if (e.shiftKey && document.activeElement.className.includes('e-list-item e-active')) {\n                            var listWrapper = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.closest)(document.activeElement, '.e-formula-list');\n                            if (listWrapper) {\n                                (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(listWrapper);\n                            }\n                        }\n                    }\n                    else if (dlgInst.element.classList.contains('e-goto-dlg') && !dlgInst.element.classList.contains('e-dlg-modal')) {\n                        if (e.shiftKey) {\n                            if (document.activeElement.className.includes('e-dlg-closeicon-btn')) {\n                                var footerOkBtn = dlgInst.element.querySelector('.e-footer-content .e-btn');\n                                if (footerOkBtn) {\n                                    e.preventDefault();\n                                    (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(footerOkBtn);\n                                }\n                            }\n                        }\n                        else if (document.activeElement.className.includes('e-btn-goto-ok')) {\n                            (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(dlgInst.element);\n                        }\n                    }\n                }\n            }\n            else if (isNameBox && e.keyCode === 9 && e.shiftKey) {\n                this.focusEle(e, '.e-formula-bar', false, true);\n            }\n            var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.editOperation, eventArgs);\n            var isFormulaEdit = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.checkIsFormula)(eventArgs.editedValue, true);\n            if (this.parent.isEdit && isFormulaEdit && e.shiftKey && !e.ctrlKey && (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isNavigationKey)(e.keyCode)) {\n                this.shiftSelection(e);\n            }\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        var actIdxes = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(sheet.activeCell);\n        if (e.altKey) {\n            if (e.keyCode === 40) {\n                if (target.classList.contains('e-dropdown-btn') || target.classList.contains('e-split-btn')) {\n                    return;\n                }\n                var filterArgs = { e: e, isFilterCell: false };\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.filterCellKeyDown, filterArgs);\n                if (filterArgs.isFilterCell) { /*alt + down to open filter popup*/\n                    return;\n                }\n            }\n            if (e.keyCode === 40 && !document.getElementById(this.parent.element.id + 'listValid_popup')) {\n                var cell = this.parent.getCell(actIdxes[0], actIdxes[1]);\n                if (cell) {\n                    var listValidation = cell.querySelector('.e-validation-list .e-ddl');\n                    if (listValidation) {\n                        (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(listValidation);\n                        var ddlEle = listValidation.querySelector('.e-dropdownlist') || listValidation;\n                        var listObj = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.getComponent)(ddlEle, 'dropdownlist');\n                        if (listObj) {\n                            listObj.showPopup();\n                        }\n                        return;\n                    }\n                }\n            }\n        }\n        if (target.id === this.parent.element.id + \"_File\") {\n            (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(this.parent.element);\n        }\n        var isSheetTabFocus = target.classList.contains('e-add-sheet-tab') || target.classList.contains('e-sheets-list') ||\n            (target.classList.contains('e-tab-wrap') && !!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.closest)(target, '.e-sheet-tabs-items')) ||\n            target.classList.contains('e-aggregate-list') || target.classList.contains('e-scroll-nav');\n        if ([9, 37, 38, 39, 40, 33, 34, 35, 36].indexOf(e.keyCode) > -1 && !isSheetTabFocus) {\n            e.preventDefault();\n        }\n        var isNavigate;\n        var selectIdx = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(sheet.selectedRange);\n        if (e.keyCode === 36) { /* home key */\n            var frozenCol = this.parent.frozenColCount(sheet);\n            var selectIdxes = void 0;\n            if (e.ctrlKey || e.metaKey) {\n                var frozenRow = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, this.parent.frozenRowCount(sheet), true);\n                if (e.shiftKey) { /* ctrl+shift+home */\n                    selectIdxes = [actIdxes[0], actIdxes[1], frozenRow, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, frozenCol, true, 'columns')];\n                }\n                else { /* ctrl+home */\n                    selectIdxes = [frozenRow, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, frozenCol, true, 'columns'), frozenRow];\n                    selectIdxes[3] = selectIdxes[1];\n                }\n                var mainPanel = this.parent.element.querySelector('.e-main-panel');\n                if (mainPanel.scrollTop) {\n                    mainPanel.scrollTop = 0;\n                }\n                var hCont = this.parent.getScrollElement();\n                if (hCont.scrollLeft) {\n                    hCont.scrollLeft = 0;\n                }\n            }\n            else if (e.shiftKey) { /* shift+home */\n                var startCol = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, frozenCol, true, 'columns');\n                if (sheet.frozenColumns && (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, actIdxes[1], true, 'columns') === startCol) {\n                    selectIdxes = [selectIdx[0], actIdxes[1], selectIdx[2], (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, 0, true, 'columns')];\n                }\n                else {\n                    selectIdxes = [selectIdx[0], actIdxes[1], selectIdx[2], startCol];\n                }\n                this.scrollNavigation([selectIdxes[2], selectIdxes[3]], true);\n            }\n            else {\n                var startCol = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, frozenCol, true, 'columns');\n                if (sheet.frozenColumns && (startCol === actIdxes[1] || frozenCol === actIdxes[1])) {\n                    startCol = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, 0, true, 'columns');\n                }\n                selectIdxes = [actIdxes[0], startCol, actIdxes[0], startCol];\n                this.scrollNavigation([selectIdxes[0], selectIdxes[1]], true);\n            }\n            this.updateSelection(sheet, selectIdxes, e);\n        }\n        else if (e.ctrlKey || e.metaKey) {\n            if (e.keyCode === 35) { /*ctrl + end*/\n                e.preventDefault();\n                var lastRow = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, sheet.usedRange.rowIndex, false);\n                lastRow = lastRow > -1 ? lastRow : sheet.usedRange.rowIndex;\n                var lastCol = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, sheet.usedRange.colIndex, false, 'columns');\n                lastCol = lastCol > -1 ? lastCol : sheet.usedRange.colIndex;\n                if (!e.shiftKey) {\n                    actIdxes[0] = lastRow;\n                    actIdxes[1] = lastCol;\n                }\n                actIdxes[2] = lastRow;\n                actIdxes[3] = lastCol;\n                this.updateSelection(sheet, actIdxes.concat(actIdxes), e);\n                this.scrollNavigation([lastRow, lastCol], true);\n            }\n            else if (e.keyCode === 32 && !e.shiftKey && isKeyboardShortcut) { /*ctrl + space*/\n                selectIdx[0] = 0;\n                selectIdx[2] = sheet.rowCount - 1;\n                this.updateSelection(sheet, selectIdx, { shiftKey: true });\n            }\n            if (e.keyCode === 40 || e.keyCode === 39 || e.keyCode === 38 || e.keyCode === 37) {\n                if (e.shiftKey) {\n                    if (e.keyCode === 40) { /* ctrl+shift+down */\n                        selectIdx[2] = this.getNextNonEmptyCell(selectIdx[2], actIdxes[1], 'down');\n                    }\n                    else if ((e.keyCode === 39 && !isRtl) || (e.keyCode === 37 && isRtl)) { /* ctrl+shift+right */\n                        selectIdx[3] = this.getNextNonEmptyCell(actIdxes[0], selectIdx[3], 'right');\n                    }\n                    else if (e.keyCode === 38) { /* ctrl+shift+up */\n                        selectIdx[2] = this.getNextNonEmptyCell(selectIdx[2], actIdxes[1], 'top');\n                    }\n                    else { /* ctrl+shift+left */\n                        selectIdx[3] = this.getNextNonEmptyCell(actIdxes[0], selectIdx[3], 'left');\n                    }\n                    this.updateSelection(sheet, selectIdx, e);\n                    this.scrollNavigation([selectIdx[2], selectIdx[3]], true);\n                }\n                else {\n                    if ((e.keyCode === 37 && !isRtl) || (e.keyCode === 39 && isRtl)) { /*ctrl + left*/\n                        actIdxes[1] = this.getNextNonEmptyCell(actIdxes[0], actIdxes[1], 'left');\n                    }\n                    else if (e.keyCode === 38) { /*ctrl + up*/\n                        actIdxes[0] = this.getNextNonEmptyCell(actIdxes[0], actIdxes[1], 'top');\n                    }\n                    else if ((e.keyCode === 39 && !isRtl) || (e.keyCode === 37 && isRtl)) { /*ctrl+ right*/\n                        actIdxes[1] = this.getNextNonEmptyCell(actIdxes[0], actIdxes[1], 'right');\n                    }\n                    else { /*ctrl+ down*/\n                        actIdxes[0] = this.getNextNonEmptyCell(actIdxes[0], actIdxes[1], 'down');\n                    }\n                    this.parent.selectRange((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(actIdxes));\n                    this.scrollNavigation([actIdxes[0], actIdxes[1]], true);\n                }\n            }\n            else if (e.keyCode === 117) {\n                var activeEle = document.activeElement;\n                if (activeEle.classList.contains('e-spreadsheet') || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.closest)(activeEle, '.e-sheet')) {\n                    this.setFocus('Sheet', e, true);\n                }\n                else if (isSheetTabFocus) {\n                    this.setFocus('SheetTabs', e);\n                }\n                else if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.closest)(activeEle, '.e-ribbon')) {\n                    this.setFocus('Ribbon', e);\n                }\n                else if (isNameBox || activeEle.classList.contains('e-insert-function')) {\n                    this.setFocus('FormulaBar', e);\n                }\n            }\n        }\n        else {\n            if (e.shiftKey) {\n                if (e.keyCode === 32 && isKeyboardShortcut) { /*shift + space*/\n                    e.preventDefault();\n                    selectIdx[1] = 0;\n                    selectIdx[3] = sheet.colCount - 1;\n                    this.updateSelection(sheet, selectIdx, e);\n                }\n                this.shiftSelection(e);\n                if ((e.keyCode === 34 || e.keyCode === 33) && (this.parent.scrollModule &&\n                    this.parent.scrollModule.isKeyScroll)) { /* shift Page Up and Page Down*/\n                    var scrollTop = 0;\n                    var mainPanel = this.parent.element.querySelector('.e-main-panel');\n                    var topRow = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(sheet.paneTopLeftCell)[0], true);\n                    var viewportHgt = (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getBottomOffset)(this.parent, topRow).height;\n                    if (e.keyCode === 34) { /* Page Down*/\n                        scrollTop = viewportHgt + this.parent.scrollModule.offset.top.size;\n                        if (!this.parent.scrollSettings.isFinite) {\n                            var vTrack = this.parent.getMainContent().querySelector('.e-virtualtrack');\n                            if (vTrack && parseFloat(vTrack.style.height) < scrollTop + viewportHgt) {\n                                vTrack.style.height = scrollTop + viewportHgt + \"px\";\n                            }\n                        }\n                    }\n                    else { /* Page up*/\n                        scrollTop = this.parent.scrollModule.offset.top.size - viewportHgt;\n                        if (Math.round(scrollTop) < 0) {\n                            if (mainPanel.scrollTop) {\n                                scrollTop = 0;\n                            }\n                            else {\n                                this.parent.selectRange((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)([selectIdx[0], selectIdx[1], topRow, selectIdx[3]]));\n                                return;\n                            }\n                        }\n                    }\n                    var aRowIdx = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(sheet.selectedRange)[2], true);\n                    var selectDiff_1 = topRow > aRowIdx ? 0 : aRowIdx - topRow;\n                    if (this.parent.scrollModule && mainPanel.scrollTop) {\n                        this.parent.scrollModule.isKeyScroll = false;\n                    }\n                    mainPanel.scrollTop = scrollTop;\n                    (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getUpdateUsingRaf)(function () {\n                        if (e.keyCode === 34) {\n                            selectIdx[2] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(sheet.paneTopLeftCell)[0] + selectDiff_1, true);\n                            if (_this.parent.scrollSettings.isFinite && selectIdx[2] > sheet.rowCount - 1) {\n                                selectIdx[2] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, sheet.rowCount - 1, false);\n                                selectIdx[2] = selectIdx[2] < 0 ? 0 : selectIdx[2];\n                            }\n                        }\n                        else {\n                            selectIdx[2] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(sheet.paneTopLeftCell)[0] + selectDiff_1, false);\n                            selectIdx[2] = selectIdx[2] < 0 ? 0 : selectIdx[2];\n                        }\n                        _this.updateSelection(sheet, selectIdx, e);\n                    });\n                }\n            }\n            else {\n                if (e.keyCode === 9 || (this.parent.enableRtl ? e.keyCode === 37 : e.keyCode === 39)) { /*Right or Tab key*/\n                    var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(actIdxes[0], actIdxes[1], sheet);\n                    if (cell && cell.colSpan > 1) {\n                        actIdxes[1] += (cell.colSpan - 1);\n                    }\n                    if (actIdxes[1] < sheet.colCount - 1 && (!sheet.isProtected || sheet.protectSettings.selectCells)) {\n                        actIdxes[1] += 1;\n                        isNavigate = true;\n                    }\n                    else if (sheet.protectSettings.selectUnLockedCells) {\n                        var idx = this.getNextUnlockedCell('right', actIdxes);\n                        isNavigate = actIdxes[1] !== idx[1] || actIdxes[0] !== idx[0];\n                        actIdxes[1] = idx[1];\n                        actIdxes[0] = idx[0];\n                    }\n                }\n                else if (e.keyCode === 13 || e.keyCode === 40) { /*Down or Enter Key*/\n                    var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(actIdxes[0], actIdxes[1], sheet);\n                    if (cell && cell.rowSpan > 1) {\n                        actIdxes[0] += (cell.rowSpan - 1);\n                    }\n                    if (actIdxes[0] < sheet.rowCount - 1 && (!sheet.isProtected || sheet.protectSettings.selectCells)) {\n                        isNavigate = true;\n                        actIdxes[0] += 1;\n                    }\n                    else if (sheet.protectSettings.selectUnLockedCells) {\n                        var idx = this.getNextUnlockedCell('down', actIdxes);\n                        isNavigate = actIdxes[0] !== idx[0] || actIdxes[1] !== idx[1];\n                        actIdxes[1] = idx[1];\n                        actIdxes[0] = idx[0];\n                    }\n                }\n                else if ((e.keyCode === 34 || e.keyCode === 33) && (this.parent.scrollModule &&\n                    this.parent.scrollModule.isKeyScroll)) { /*Page Up and Page Down*/\n                    var mainPanel = this.parent.element.querySelector('.e-main-panel');\n                    var scrollTop = 0;\n                    var topRow_1 = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(sheet.paneTopLeftCell)[0], true);\n                    var aRowIdx_1 = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(sheet.activeCell)[0], true);\n                    var viewportHgt = (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getBottomOffset)(this.parent, topRow_1).height;\n                    if (e.keyCode === 34) { /*Page Down*/\n                        scrollTop = this.parent.scrollModule.offset.top.size + viewportHgt;\n                        if (!this.parent.scrollSettings.isFinite) {\n                            var vTrack = this.parent.getMainContent().querySelector('.e-virtualtrack');\n                            if (vTrack && parseFloat(vTrack.style.height) < scrollTop + viewportHgt) {\n                                vTrack.style.height = scrollTop + viewportHgt + \"px\";\n                            }\n                        }\n                    }\n                    else { /*Page Up*/\n                        scrollTop = this.parent.scrollModule.offset.top.size - viewportHgt;\n                        if (sheet.frozenRows && actIdxes[0] < this.parent.frozenRowCount(sheet)) {\n                            this.parent.selectRange((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)([topRow_1, selectIdx[1], topRow_1, selectIdx[1]]));\n                            return;\n                        }\n                        if (Math.round(scrollTop) < 0) {\n                            if (mainPanel.scrollTop) {\n                                scrollTop = 0;\n                            }\n                            else {\n                                return;\n                            }\n                        }\n                    }\n                    var selectDiff_2 = topRow_1 > aRowIdx_1 ? 0 : aRowIdx_1 - topRow_1;\n                    if (this.parent.scrollModule && mainPanel.scrollTop) {\n                        this.parent.scrollModule.isKeyScroll = false;\n                    }\n                    mainPanel.scrollTop = scrollTop;\n                    (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getUpdateUsingRaf)(function () {\n                        var activeRow;\n                        if (e.keyCode === 34) {\n                            activeRow = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(sheet.paneTopLeftCell)[0] + selectDiff_2, true);\n                            if (_this.parent.scrollSettings.isFinite) {\n                                if (activeRow > sheet.rowCount - 1) {\n                                    activeRow = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, sheet.rowCount - 1, false);\n                                    activeRow = activeRow < 0 ? 0 : activeRow;\n                                }\n                            }\n                        }\n                        else {\n                            activeRow = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(sheet.paneTopLeftCell)[0] + selectDiff_2;\n                            activeRow -= _this.parent.hiddenCount(topRow_1, aRowIdx_1);\n                            activeRow = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, activeRow, false);\n                            activeRow = activeRow < 0 ? 0 : activeRow;\n                        }\n                        _this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.cellNavigate, { range: [activeRow, actIdxes[1], activeRow, actIdxes[1]], preventAnimation: true });\n                    });\n                }\n            }\n            if (e.shiftKey ? e.keyCode === 9 : (this.parent.enableRtl ? e.keyCode === 39 : e.keyCode === 37)) { /*left or shift+tab key*/\n                if (actIdxes[1] > 0 && (!sheet.isProtected || sheet.protectSettings.selectCells)) {\n                    actIdxes[1] -= 1;\n                    isNavigate = true;\n                }\n                else if (sheet.protectSettings.selectUnLockedCells) {\n                    var idx = this.getNextUnlockedCell('left', actIdxes);\n                    isNavigate = actIdxes[1] !== idx[1] || actIdxes[0] !== idx[0];\n                    actIdxes[1] = idx[1];\n                    actIdxes[0] = idx[0];\n                }\n                if (actIdxes[1] <= 0) {\n                    var content = this.parent.getMainContent();\n                    if (actIdxes[1] === 0 && content.scrollLeft && !this.parent.enableRtl) {\n                        content.scrollLeft = 0;\n                    }\n                }\n            }\n            else if (e.shiftKey ? e.keyCode === 13 : e.keyCode === 38) { /*up or shift+enter key */\n                if (!this.parent.element.querySelector('.e-find-toolbar')) {\n                    if (actIdxes[0] > 0 && (!sheet.isProtected || sheet.protectSettings.selectCells)) {\n                        actIdxes[0] -= 1;\n                        isNavigate = true;\n                    }\n                    else if (sheet.protectSettings.selectUnLockedCells) {\n                        var cellIdx = this.getNextUnlockedCell('up', actIdxes);\n                        isNavigate = actIdxes[0] !== cellIdx[0] || actIdxes[1] !== cellIdx[1];\n                        actIdxes[1] = cellIdx[1];\n                        actIdxes[0] = cellIdx[0];\n                    }\n                    if (actIdxes[0] <= 0) {\n                        var contentEle = this.parent.getMainContent().parentElement;\n                        if (actIdxes[0] === 0 && contentEle.scrollTop) {\n                            contentEle.scrollTop = 0;\n                        }\n                    }\n                }\n            }\n        }\n        if (isNavigate && (!this.parent.scrollModule || this.parent.scrollModule.isKeyScroll) && !isSheetTabFocus &&\n            !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.closest)(document.activeElement, '.e-ribbon') && !target.classList.contains('e-insert-function')\n            && (!target.classList.contains('e-formula-bar') || (target.classList.contains('e-formula-bar') && target.nodeName === 'TEXTAREA' && e.keyCode === 13))) {\n            if (e.keyCode === 40 || e.keyCode === 38 || e.keyCode === 13) { /* down || up */\n                while ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isHiddenRow)(sheet, actIdxes[0])) {\n                    if (e.keyCode === 40 || (!e.shiftKey && e.keyCode === 13)) {\n                        actIdxes[0] = actIdxes[0] + 1;\n                    }\n                    if (e.keyCode === 38 || (e.shiftKey && e.keyCode === 13)) {\n                        actIdxes[0] = actIdxes[0] - 1;\n                        if (actIdxes[0] < 0) {\n                            return;\n                        }\n                    }\n                }\n            }\n            if (e.keyCode === 37 || e.keyCode === 39 || e.keyCode === 9) { /* left || right || tab */\n                while ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isHiddenCol)(sheet, actIdxes[1])) {\n                    if (e.keyCode === 39 || (!e.shiftKey && e.keyCode === 9)) {\n                        actIdxes[1] = actIdxes[1] + 1;\n                    }\n                    if (e.keyCode === 37 || (e.shiftKey && e.keyCode === 9)) {\n                        actIdxes[1] = actIdxes[1] - 1;\n                        if (actIdxes[1] < 0) {\n                            return;\n                        }\n                    }\n                }\n            }\n            var topLeftIdx = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(sheet.topLeftCell);\n            if (sheet.frozenRows && actIdxes[0] < topLeftIdx[0]) {\n                actIdxes[0] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, topLeftIdx[0], true);\n            }\n            if (sheet.frozenColumns && actIdxes[1] < topLeftIdx[1]) {\n                actIdxes[1] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, topLeftIdx[1], true, 'columns');\n            }\n            this.scrollNavigation(actIdxes);\n            var range_1 = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(actIdxes);\n            var navigateFn = function (preventAnimation) {\n                if (range_1 === sheet.selectedRange) {\n                    return;\n                }\n                _this.parent.selectionModule.previousActiveCell = sheet.activeCell;\n                if (document.getElementsByClassName('e-addNoteContainer') && document.getElementsByClassName('e-addNoteContainer').length > 0) {\n                    _this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.removeNoteContainer, '');\n                }\n                _this.parent.setSheetPropertyOnMute(sheet, 'activeCell', range_1);\n                _this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.cellNavigate, { range: actIdxes.concat(actIdxes), preventAnimation: preventAnimation });\n                var ele;\n                if (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.Browser.isDevice && _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.Browser.info.name === 'safari' && (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.Browser.isIos || _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.Browser.isIos7)) {\n                    ele = _this.parent.element.querySelector('.e-ss-focus-edit');\n                }\n                ele = ele || _this.parent.getCell(actIdxes[0], actIdxes[1]);\n                if (ele) {\n                    (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(ele);\n                }\n            };\n            if (this.parent.scrollModule && this.parent.scrollModule.isKeyScroll) {\n                if (range_1 === sheet.selectedRange) {\n                    return;\n                }\n                (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getUpdateUsingRaf)(navigateFn.bind(this, true));\n            }\n            else {\n                navigateFn();\n            }\n        }\n        else if (e.keyCode === 9) {\n            var ribbon = this.parent.showRibbon && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.closest)(document.activeElement, '.e-ribbon');\n            if (ribbon) {\n                if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.closest)(document.activeElement, '.e-tab-header')) {\n                    if (e.shiftKey || ribbon.classList.contains('e-collapsed')) {\n                        this.focusEle(e, '.e-ribbon .e-drop-icon');\n                    }\n                    else {\n                        this.focusEle(e, '.e-ribbon .e-content .e-toolbar-item:not(.e-separator):not(.e-overlay):not(.e-hide) .e-btn');\n                    }\n                }\n                else if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.closest)(document.activeElement, '.e-content')) {\n                    if (e.shiftKey) {\n                        this.focusEle(e, '.e-ribbon .e-toolbar-items .e-toolbar-item.e-active .e-tab-wrap', true);\n                    }\n                    else {\n                        this.focusEle(e, '.e-ribbon .e-drop-icon');\n                    }\n                }\n                else if (document.activeElement.classList.contains('e-drop-icon')) {\n                    if (e.shiftKey && !ribbon.classList.contains('e-collapsed')) {\n                        this.focusEle(e, '.e-ribbon .e-content .e-toolbar-item:not(.e-separator):not(.e-overlay):not(.e-hide) .e-btn');\n                    }\n                    else {\n                        this.focusEle(e, '.e-ribbon .e-toolbar-items .e-toolbar-item.e-active .e-tab-wrap', true);\n                    }\n                }\n            }\n            else if (target.classList.contains('e-insert-function')) {\n                if (e.shiftKey) {\n                    this.focusEle(e, '.e-formula-bar-panel .e-combobox');\n                }\n                else {\n                    this.focusEle(e, '.e-formula-bar', false, true);\n                }\n            }\n            else if (isSheetTabFocus) {\n                if (e.shiftKey) {\n                    var isNavOrAggregate = target.classList.contains('e-aggregate-list') || target.classList.contains('e-scroll-left-nav');\n                    if (target.classList.contains('e-add-sheet-tab') || isNavOrAggregate || (target.classList.contains('e-sheets-list') &&\n                        target.previousElementSibling && target.previousElementSibling.disabled)) {\n                        var focusEle = !isNavOrAggregate && this.parent.element.querySelector('.e-aggregate-list');\n                        if (focusEle) {\n                            this.focusEle(e, null, false, false, focusEle);\n                        }\n                        else if (!target.classList.contains('e-scroll-left-nav') && this.parent.element.querySelector('.e-sheet-tab-panel .e-scroll-nav')) {\n                            this.focusEle(e, '.e-sheet-tab-panel .e-scroll-right-nav', true);\n                        }\n                        else {\n                            var items = [].slice.call(this.parent.element.querySelectorAll('.e-sheet-tab-panel .e-toolbar-item'));\n                            if (items[items.length - 1]) {\n                                this.focusEle(e, null, true, false, items[items.length - 1].querySelector('.e-tab-wrap'));\n                            }\n                        }\n                    }\n                    else if (target.classList.contains('e-scroll-right-nav')) {\n                        this.focusEle(e, '.e-sheet-tab-panel .e-scroll-left-nav', true);\n                    }\n                    else if (target.classList.contains('e-tab-wrap')) {\n                        var items = [].slice.call(this.parent.element.querySelectorAll('.e-sheet-tab-panel .e-toolbar-item'));\n                        var idx = items.indexOf(target.parentElement);\n                        if (idx === 0) {\n                            this.focusEle(e, '.e-sheet-tab-panel .e-sheets-list');\n                        }\n                        else {\n                            this.focusEle(e, null, true, false, items[idx - 1].querySelector('.e-tab-wrap'));\n                        }\n                    }\n                }\n                else {\n                    var isAggAvail = !!this.parent.element.querySelector('.e-aggregate-list');\n                    if (target.classList.contains('e-aggregate-list') || (!isAggAvail && target.classList.contains('e-scroll-right-nav'))) {\n                        this.focusEle(e, '.e-sheet-tab-panel .e-icon-btn:not(:disabled)');\n                    }\n                    else if (target.classList.contains('e-sheets-list')) {\n                        this.focusEle(e, '.e-sheet-tab-panel .e-toolbar-item .e-tab-wrap', true);\n                    }\n                    else if (target.classList.contains('e-scroll-left-nav')) {\n                        this.focusEle(e, '.e-sheet-tab-panel .e-scroll-right-nav', true);\n                    }\n                    else if (target.classList.contains('e-tab-wrap')) {\n                        var items = [].slice.call(this.parent.element.querySelectorAll('.e-sheet-tab-panel .e-toolbar-item'));\n                        var index = items.indexOf(target.parentElement);\n                        if (index === items.length - 1) {\n                            var isNav = !!this.parent.element.querySelector('.e-sheet-tab-panel .e-scroll-nav');\n                            if (isNav || !isAggAvail) {\n                                this.focusEle(e, \".e-sheet-tab-panel .\" + (isNav ? 'e-scroll-nav' : 'e-icon-btn:not(:disabled)'), isNav);\n                            }\n                        }\n                        else {\n                            this.focusEle(e, null, true, false, items[index + 1].querySelector('.e-tab-wrap'));\n                        }\n                    }\n                }\n            }\n        }\n        if (e.keyCode === 121 && e.shiftKey && !this.parent.enableKeyboardShortcut) { /*Shift + F10*/\n            e.preventDefault();\n        }\n    };\n    KeyboardNavigation.prototype.setFocus = function (layout, e, isSheetArea) {\n        if (layout === 'Sheet') {\n            if (e.shiftKey) {\n                if (this.parent.showFormulaBar) {\n                    this.focusEle(e, '.e-formula-bar-panel .e-combobox');\n                }\n                else {\n                    this.setFocus('FormulaBar', e, isSheetArea);\n                }\n            }\n            else {\n                if (this.parent.showSheetTabs) {\n                    this.focusEle(e, '.e-sheet-tab-panel .e-icon-btn:not(:disabled)');\n                }\n                else {\n                    this.setFocus('SheetTabs', e, isSheetArea);\n                }\n            }\n        }\n        else if (layout === 'SheetTabs') {\n            if (e.shiftKey) {\n                if (!isSheetArea) {\n                    this.focusEle(e, '.e-selectall');\n                }\n            }\n            else {\n                if (this.parent.showRibbon) {\n                    this.focusEle(e, '.e-ribbon .e-toolbar-items .e-toolbar-item.e-active .e-tab-wrap', true);\n                }\n                else {\n                    this.setFocus('Ribbon', e, isSheetArea);\n                }\n            }\n        }\n        else if (layout === 'Ribbon') {\n            if (e.shiftKey) {\n                if (this.parent.showSheetTabs) {\n                    this.focusEle(e, '.e-sheet-tab-panel .e-icon-btn:not(:disabled)');\n                }\n                else if (!isSheetArea) {\n                    this.focusEle(e, '.e-selectall');\n                }\n            }\n            else {\n                if (this.parent.showFormulaBar) {\n                    this.focusEle(e, '.e-formula-bar-panel .e-combobox');\n                }\n                else {\n                    this.setFocus('FormulaBar', e, isSheetArea);\n                }\n            }\n        }\n        else if (layout === 'FormulaBar') {\n            if (e.shiftKey) {\n                if (this.parent.showRibbon) {\n                    this.focusEle(e, '.e-ribbon .e-toolbar-items .e-toolbar-item.e-active .e-tab-wrap', true);\n                }\n                else {\n                    this.setFocus('Ribbon', e, isSheetArea);\n                }\n            }\n            else if (!isSheetArea) {\n                this.focusEle(e, '.e-selectall');\n            }\n        }\n    };\n    KeyboardNavigation.prototype.focusEle = function (e, selector, setTabIndex, startEdit, focusEle) {\n        focusEle = focusEle || this.parent.element.querySelector(selector);\n        if (setTabIndex && !focusEle) {\n            var tabEle = this.parent.element.querySelector('.e-ribbon .e-tab');\n            var selectedTab = (tabEle && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.getComponent)(tabEle, 'tab').selectedItem) || 0;\n            focusEle = this.parent.element.querySelector('.e-tab-header').getElementsByClassName('e-toolbar-item')[selectedTab];\n            focusEle = focusEle && focusEle.querySelector('.e-tab-wrap');\n        }\n        if (focusEle) {\n            e.preventDefault();\n            if (startEdit) {\n                focusEle.click();\n                (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(focusEle);\n                focusEle.setSelectionRange(focusEle.value.length, focusEle.value.length);\n            }\n            else if (setTabIndex) {\n                focusEle.setAttribute('tabindex', '0');\n                if (focusEle.parentElement.classList.contains('e-active') && focusEle.parentElement.classList.contains('e-toolbar-item')) {\n                    var tabEle = this.parent.element.querySelector('.e-sheet-tab-panel .e-sheet-tab');\n                    if (!tabEle && tabEle.classList.contains('e-focused')) {\n                        tabEle.classList.add('e-focused');\n                    }\n                }\n                focusEle.focus();\n            }\n            else {\n                (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(focusEle);\n            }\n        }\n    };\n    KeyboardNavigation.prototype.updateSelection = function (sheet, range, e) {\n        if (sheet.isProtected && !sheet.protectSettings.selectCells && sheet.protectSettings.selectUnLockedCells) {\n            if (!(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isLockedCells)(this.parent, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSwapRange)(range))) {\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.cellNavigate, { range: range, shiftKey: e.shiftKey });\n            }\n        }\n        else {\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.cellNavigate, { range: range, shiftKey: e.shiftKey });\n        }\n    };\n    KeyboardNavigation.prototype.getNextNonEmptyCell = function (rowIdx, colIdx, position) {\n        var sheet = this.parent.getActiveSheet();\n        var isNonEmptyCell = function (rowIdx, colIdx) {\n            var cellVal = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(rowIdx, colIdx, sheet, null, true).value;\n            return !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(cellVal) && cellVal !== '';\n        };\n        var checkForEmptyCell;\n        var visibleIdx;\n        if (position === 'down') {\n            var startRow = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, rowIdx + 1, true);\n            checkForEmptyCell = isNonEmptyCell(startRow, colIdx);\n            var lastRow = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, sheet.rowCount - 1, false);\n            for (var rowIdx_1 = startRow; rowIdx_1 < sheet.rowCount; rowIdx_1++) {\n                if (rowIdx_1 === lastRow) {\n                    return rowIdx_1;\n                }\n                if (checkForEmptyCell) {\n                    if (!isNonEmptyCell((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, rowIdx_1, true), colIdx)) {\n                        return (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, rowIdx_1 - 1, false);\n                    }\n                }\n                else {\n                    visibleIdx = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, rowIdx_1 + 1, true);\n                    if (isNonEmptyCell(visibleIdx, colIdx)) {\n                        return visibleIdx;\n                    }\n                }\n            }\n            return rowIdx;\n        }\n        else if (position === 'top') {\n            var startRow = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, rowIdx - 1, false);\n            checkForEmptyCell = isNonEmptyCell(startRow, colIdx);\n            var startIdx = this.parent.frozenRowCount(sheet) ? (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(sheet.topLeftCell)[0] : 0;\n            var endIdx = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, startIdx, true);\n            for (var rowIdx_2 = startRow; rowIdx_2 >= 0; rowIdx_2--) {\n                if (rowIdx_2 === endIdx) {\n                    return rowIdx_2;\n                }\n                if (checkForEmptyCell) {\n                    if (!isNonEmptyCell((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, rowIdx_2, false), colIdx)) {\n                        return (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, rowIdx_2 + 1, true);\n                    }\n                }\n                else {\n                    visibleIdx = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, rowIdx_2 - 1, false);\n                    if (isNonEmptyCell(visibleIdx, colIdx)) {\n                        return visibleIdx;\n                    }\n                }\n            }\n            return rowIdx;\n        }\n        else if (position === 'right') {\n            var startCol = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, colIdx + 1, true, 'columns');\n            checkForEmptyCell = isNonEmptyCell(rowIdx, startCol);\n            var lastCol = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, sheet.colCount - 1, false, 'columns');\n            for (var colIdx_1 = startCol; colIdx_1 < sheet.colCount; colIdx_1++) {\n                if (colIdx_1 === lastCol) {\n                    return colIdx_1;\n                }\n                if (checkForEmptyCell) {\n                    if (!isNonEmptyCell(rowIdx, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, colIdx_1, true, 'columns'))) {\n                        return (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, colIdx_1 - 1, false, 'columns');\n                    }\n                }\n                else {\n                    visibleIdx = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, colIdx_1 + 1, true, 'columns');\n                    if (isNonEmptyCell(rowIdx, visibleIdx)) {\n                        return visibleIdx;\n                    }\n                }\n            }\n            return colIdx;\n        }\n        else {\n            var startCol = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, colIdx - 1, false, 'columns');\n            checkForEmptyCell = isNonEmptyCell(rowIdx, startCol);\n            var startIdx = this.parent.frozenColCount(sheet) ? (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(sheet.topLeftCell)[1] : 0;\n            var endIdx = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, startIdx, true, 'columns');\n            for (var colIdx_2 = startCol; colIdx_2 >= 0; colIdx_2--) {\n                if (colIdx_2 === endIdx) {\n                    return colIdx_2;\n                }\n                if (checkForEmptyCell) {\n                    if (!isNonEmptyCell(rowIdx, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, colIdx_2, false, 'columns'))) {\n                        return (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, colIdx_2 + 1, true, 'columns');\n                    }\n                }\n                else {\n                    visibleIdx = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, colIdx_2 - 1, false, 'columns');\n                    if (isNonEmptyCell(rowIdx, visibleIdx)) {\n                        return visibleIdx;\n                    }\n                }\n            }\n            return colIdx;\n        }\n    };\n    KeyboardNavigation.prototype.getNextUnlockedCell = function (position, actCellIdx) {\n        var sheet = this.parent.getActiveSheet();\n        var cell;\n        var col;\n        if (position === 'right') {\n            var rowIdx = actCellIdx[0];\n            var colIdx = void 0;\n            var secIteration = void 0;\n            var rowLen = sheet.usedRange.rowIndex;\n            var colLen = sheet.usedRange.colIndex;\n            while (rowIdx <= rowLen) {\n                colIdx = colIdx === undefined ? actCellIdx[1] + 1 : 0;\n                if (secIteration && rowIdx === actCellIdx[0]) {\n                    colLen = actCellIdx[1] - 1;\n                }\n                for (colIdx; colIdx <= colLen; colIdx++) {\n                    cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(rowIdx, colIdx, sheet);\n                    col = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColumn)(sheet, colIdx) || {};\n                    if (!(0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isLocked)(cell, col) && !col.hidden && !(0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isHiddenRow)(sheet, rowIdx)) {\n                        return [rowIdx, colIdx];\n                    }\n                }\n                if (rowIdx === sheet.usedRange.rowIndex && !secIteration) {\n                    rowIdx = 0;\n                    rowLen = actCellIdx[0];\n                    secIteration = true;\n                }\n                else {\n                    rowIdx++;\n                }\n            }\n        }\n        else if (position === 'left') {\n            var rowIdx = actCellIdx[0];\n            var colIdx = void 0;\n            var secIteration = void 0;\n            var rowLen = 0;\n            var colLen = 0;\n            while (rowIdx >= rowLen) {\n                colIdx = colIdx === undefined ? actCellIdx[1] - 1 : sheet.usedRange.colIndex;\n                if (secIteration && rowIdx === actCellIdx[0]) {\n                    colLen = actCellIdx[1] + 1;\n                }\n                for (colIdx; colIdx >= colLen; colIdx--) {\n                    cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(rowIdx, colIdx, sheet);\n                    col = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColumn)(sheet, colIdx) || {};\n                    if (!(0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isLocked)(cell, col) && !col.hidden && !(0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isHiddenRow)(sheet, rowIdx)) {\n                        return [rowIdx, colIdx];\n                    }\n                }\n                if (rowIdx === 0 && !secIteration) {\n                    rowIdx = sheet.usedRange.rowIndex;\n                    rowLen = actCellIdx[0];\n                    secIteration = true;\n                }\n                else {\n                    rowIdx--;\n                }\n            }\n        }\n        else if (position === 'down') {\n            var colIdx = actCellIdx[1];\n            var rowIdx = void 0;\n            var secIteration = void 0;\n            var colLen = sheet.usedRange.colIndex;\n            var rowLen = sheet.usedRange.rowIndex;\n            while (colIdx <= colLen) {\n                rowIdx = rowIdx === undefined ? actCellIdx[0] + 1 : 0;\n                if (secIteration && colIdx === actCellIdx[1]) {\n                    rowLen = actCellIdx[0] - 1;\n                }\n                for (rowIdx; rowIdx <= rowLen; rowIdx++) {\n                    cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(rowIdx, colIdx, sheet);\n                    col = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColumn)(sheet, colIdx) || {};\n                    if (!(0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isLocked)(cell, col) && !col.hidden && !(0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isHiddenRow)(sheet, rowIdx)) {\n                        return [rowIdx, colIdx];\n                    }\n                }\n                if (colIdx === sheet.usedRange.colIndex && !secIteration) {\n                    colIdx = 0;\n                    colLen = actCellIdx[1];\n                    secIteration = true;\n                }\n                else {\n                    colIdx++;\n                }\n            }\n        }\n        else {\n            var colIdx = actCellIdx[1];\n            var rowIdx = void 0;\n            var secIteration = void 0;\n            var colLen = 0;\n            var rowLen = 0;\n            while (colIdx >= colLen) {\n                rowIdx = rowIdx === undefined ? actCellIdx[0] - 1 : sheet.usedRange.rowIndex;\n                if (secIteration && colIdx === actCellIdx[1]) {\n                    rowLen = actCellIdx[0] + 1;\n                }\n                for (rowIdx; rowIdx >= rowLen; rowIdx--) {\n                    cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(rowIdx, colIdx, sheet);\n                    col = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColumn)(sheet, colIdx) || {};\n                    if (!(0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isLocked)(cell, col) && !col.hidden && !(0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isHiddenRow)(sheet, rowIdx)) {\n                        return [rowIdx, colIdx];\n                    }\n                }\n                if (colIdx === 0 && !secIteration) {\n                    colIdx = sheet.usedRange.colIndex;\n                    colLen = actCellIdx[1];\n                    secIteration = true;\n                }\n                else {\n                    colIdx--;\n                }\n            }\n        }\n        return actCellIdx;\n    };\n    KeyboardNavigation.prototype.shiftSelection = function (e) {\n        var sheet = this.parent.getActiveSheet();\n        var selectedRange = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(sheet.selectedRange);\n        var swapRange = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSwapRange)(selectedRange);\n        var noHidden = true;\n        var isRtl = this.parent.enableRtl;\n        if (e.keyCode === 38) { /*shift + up arrow*/\n            for (var i = swapRange[1]; i <= swapRange[3]; i++) {\n                var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(selectedRange[2], i, sheet);\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(cell) && cell.rowSpan && cell.rowSpan < 0) {\n                    selectedRange[2] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, selectedRange[2] - (Math.abs(cell.rowSpan) + 1), false);\n                    noHidden = false;\n                    break;\n                }\n            }\n            if (noHidden) {\n                selectedRange[2] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, selectedRange[2] - 1, false);\n            }\n            var startIdx = this.parent.frozenRowCount(sheet) ? (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(sheet.topLeftCell)[0] : 0;\n            if (selectedRange[2] < startIdx) {\n                return;\n            }\n        }\n        if (e.keyCode === 40) { /*shift + down arrow*/\n            for (var i = swapRange[1]; i <= swapRange[3]; i++) {\n                var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(selectedRange[2], i, sheet);\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(cell) && cell.rowSpan && cell.rowSpan > 0) {\n                    selectedRange[2] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, selectedRange[2] + Math.abs(cell.rowSpan), true);\n                    noHidden = false;\n                    break;\n                }\n            }\n            if (noHidden) {\n                selectedRange[2] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, selectedRange[2] + 1, true);\n            }\n            if (selectedRange[2] >= sheet.rowCount) {\n                selectedRange[2] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, sheet.rowCount - 1, false);\n                if (selectedRange[2] < 0) {\n                    return;\n                }\n            }\n        }\n        if ((e.keyCode === 39 && !isRtl) || (e.keyCode === 37 && isRtl)) { /*shift + right arrow*/\n            for (var i = swapRange[0]; i <= swapRange[2]; i++) {\n                var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(i, selectedRange[3], sheet);\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(cell) && cell.colSpan && cell.colSpan > 0) {\n                    selectedRange[3] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, selectedRange[3] + Math.abs(cell.colSpan), true, 'columns');\n                    noHidden = false;\n                    break;\n                }\n            }\n            if (noHidden) {\n                selectedRange[3] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, selectedRange[3] + 1, true, 'columns');\n            }\n            if (selectedRange[3] >= sheet.colCount) {\n                selectedRange[3] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, sheet.colCount - 1, false, 'columns');\n                if (selectedRange[3] < 0) {\n                    return;\n                }\n            }\n        }\n        if ((e.keyCode === 37 && !isRtl) || (e.keyCode === 39 && isRtl)) { /*shift + left arrow*/\n            for (var i = swapRange[0]; i <= swapRange[2]; i++) {\n                var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(i, selectedRange[3], sheet);\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(cell) && cell.colSpan && cell.colSpan < 0) {\n                    selectedRange[3] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, selectedRange[3] - (Math.abs(cell.colSpan) + 1), false, 'columns');\n                    noHidden = false;\n                    break;\n                }\n            }\n            if (noHidden) {\n                selectedRange[3] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, selectedRange[3] - 1, false, 'columns');\n            }\n            var startIdx = this.parent.frozenColCount(sheet) ? (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(sheet.topLeftCell)[1] : 0;\n            if (selectedRange[3] < startIdx) {\n                return;\n            }\n        }\n        if (!this.parent.scrollSettings.enableVirtualization && e.shiftKey && e.ctrlKey) { /*ctrl + shift selection*/\n            var usedRange = [sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n            if (e.keyCode === 37) {\n                if (selectedRange[3] <= usedRange[1]) {\n                    selectedRange[3] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, 0, true, 'columns');\n                }\n                else {\n                    selectedRange[3] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, usedRange[1], true, 'columns');\n                }\n            }\n            if (e.keyCode === 38) {\n                if (selectedRange[2] <= usedRange[0]) {\n                    selectedRange[2] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, 0, true);\n                }\n                else {\n                    selectedRange[2] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, usedRange[0], true);\n                }\n            }\n            if (e.keyCode === 39) {\n                if (selectedRange[3] <= usedRange[1]) {\n                    selectedRange[3] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, usedRange[1], false, 'columns');\n                }\n                else {\n                    selectedRange[3] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, sheet.colCount, false, 'columns');\n                }\n                if (selectedRange[3] < 0) {\n                    return;\n                }\n            }\n            if (e.keyCode === 40) {\n                if (selectedRange[2] <= usedRange[0]) {\n                    selectedRange[2] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, usedRange[0], false);\n                }\n                else {\n                    selectedRange[2] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, sheet.rowCount, false);\n                }\n                if (selectedRange[2] < 0) {\n                    return;\n                }\n            }\n        }\n        if (e.keyCode === 37 || e.keyCode === 39 || e.keyCode === 38 || e.keyCode === 40) { /*left,right,up,down*/\n            var activeIdxes = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(sheet.activeCell);\n            if (this.parent.isEdit && e.shiftKey) {\n                e.preventDefault();\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.rangeSelectionByKeydown, { range: selectedRange, e: e });\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.addressHandle, { range: (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSwapRange)(selectedRange)), isSelect: false });\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.initiateCur, {});\n            }\n            else {\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.cellNavigate, { range: selectedRange, shiftKey: e.shiftKey });\n            }\n            this.scrollNavigation([(0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isColumnSelected)(sheet, selectedRange) ? activeIdxes[0] : selectedRange[2],\n                (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isRowSelected)(sheet, selectedRange) ? activeIdxes[1] : selectedRange[3]]);\n        }\n    };\n    KeyboardNavigation.prototype.scrollNavigation = function (actIdxes, scrollToCell) {\n        if (!this.parent.allowScrolling) {\n            return;\n        }\n        var x = this.parent.enableRtl ? -1 : 1;\n        var cont = this.parent.getMainContent().parentElement;\n        var hCont = this.parent.getScrollElement();\n        var sheet = this.parent.getActiveSheet();\n        var selectedRange = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSwapRange)((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(sheet.selectedRange));\n        var topLeftIdxes = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(sheet.topLeftCell);\n        var frozenRow = this.parent.frozenRowCount(sheet);\n        var frozenCol = this.parent.frozenColCount(sheet);\n        var paneTopLeftIdxes = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(sheet.paneTopLeftCell);\n        var topIdx = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, actIdxes[0] < frozenRow ? topLeftIdxes[0] : paneTopLeftIdxes[0], true);\n        var offsetTopSize = this.parent.scrollModule.offset.top.size;\n        if (cont.scrollTop) {\n            if (frozenRow && actIdxes[0] !== selectedRange[2]) {\n                if (actIdxes[0] === frozenRow) {\n                    cont.scrollTop = 0;\n                    return;\n                }\n                if (actIdxes[0] === frozenRow - 1) {\n                    cont.scrollTop = 0;\n                }\n            }\n            else if (actIdxes[0] === (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, 0, true)) {\n                cont.scrollTop = 0;\n                return;\n            }\n        }\n        if (hCont && hCont.scrollLeft) {\n            if (frozenCol && actIdxes[1] !== selectedRange[3]) {\n                if (actIdxes[1] === frozenCol) {\n                    hCont.scrollLeft = 0;\n                    return;\n                }\n                if (actIdxes[1] === frozenCol - 1) {\n                    hCont.scrollLeft = 0;\n                }\n            }\n            else if (actIdxes[1] === (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.skipHiddenIdx)(sheet, 0, true, 'columns')) {\n                hCont.scrollLeft = 0;\n                return;\n            }\n        }\n        var viewportBtmIdx = (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getBottomOffset)(this.parent, topIdx).index;\n        if (viewportBtmIdx <= actIdxes[0]) {\n            if (actIdxes[0] >= frozenRow) {\n                if (scrollToCell) {\n                    var viewPortHeight = cont.getBoundingClientRect().height;\n                    var rowsHeight = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRowsHeight)(sheet, paneTopLeftIdxes[0], actIdxes[0], true);\n                    if (rowsHeight > viewPortHeight * 2) {\n                        cont.scrollTop = offsetTopSize + rowsHeight - viewPortHeight;\n                    }\n                    else {\n                        cont.scrollTop = offsetTopSize + rowsHeight - (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRowHeight)(sheet, actIdxes[0], true);\n                    }\n                    (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(this.parent.element);\n                }\n                else {\n                    cont.scrollTop = offsetTopSize + (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRowsHeight)(sheet, viewportBtmIdx, actIdxes[0], true);\n                }\n            }\n        }\n        else if (topIdx > actIdxes[0]) {\n            if (cont.scrollTop) {\n                this.parent.scrollModule.isKeyScroll = false;\n            }\n            cont.scrollTop = offsetTopSize - Math.ceil((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRowsHeight)(sheet, actIdxes[0], topIdx - 1, true));\n            if (scrollToCell) {\n                (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(this.parent.element);\n            }\n        }\n        var scrollLeftIdx = (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getRightIdx)(this.parent, paneTopLeftIdxes[1]);\n        if (scrollLeftIdx <= actIdxes[1] && hCont) {\n            if (actIdxes[1] >= frozenCol) {\n                if (scrollToCell) {\n                    var contWidth = hCont.getBoundingClientRect().width;\n                    var scrollWidth = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColumnsWidth)(sheet, paneTopLeftIdxes[1], actIdxes[1], true);\n                    if (scrollWidth > contWidth * 2) {\n                        hCont.scrollLeft = (this.parent.scrollModule.offset.left.size + scrollWidth - contWidth) * x;\n                    }\n                    else {\n                        hCont.scrollLeft = (this.parent.scrollModule.offset.left.size +\n                            (scrollWidth - (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColumnWidth)(sheet, actIdxes[0], null, true))) * x;\n                    }\n                    (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(this.parent.element);\n                }\n                else {\n                    hCont.scrollLeft = (this.parent.scrollModule.offset.left.size + (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColumnsWidth)(sheet, scrollLeftIdx, actIdxes[1], true)) * x;\n                }\n            }\n        }\n        else if (paneTopLeftIdxes[1] > actIdxes[1] && hCont) {\n            if (hCont.scrollLeft) {\n                this.parent.scrollModule.isKeyScroll = false;\n            }\n            hCont.scrollLeft = (this.parent.scrollModule.offset.left.size -\n                (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColumnsWidth)(sheet, actIdxes[1], paneTopLeftIdxes[1] - 1, true)) * x;\n            if (scrollToCell) {\n                (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(this.parent.element);\n            }\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @private\n     * @returns {string} - Get the module name.\n     */\n    KeyboardNavigation.prototype.getModuleName = function () {\n        return 'keyboardNavigation';\n    };\n    KeyboardNavigation.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return KeyboardNavigation;\n}());\n\n\n\n//# sourceURL=webpack://ej2-vue-samples/./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/actions/keyboard-navigation.js?");

/***/ })

}]);