"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkej2_vue_samples"] = self["webpackChunkej2_vue_samples"] || []).push([["chunk-vendors-node_modules_syncfusion_ej2-spreadsheet_src_spreadsheet_actions_data-validation_js-3fa-d2cc5320"],{

/***/ "./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/actions/data-validation.js":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/actions/data-validation.js ***!
  \*********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DataValidation: () => (/* binding */ DataValidation)\n/* harmony export */ });\n/* harmony import */ var _index__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../spreadsheet/index */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/index.js\");\n/* harmony import */ var _workbook_common_index__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../workbook/common/index */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/workbook/common/index.js\");\n/* harmony import */ var _workbook_index__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../workbook/index */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/workbook/index.js\");\n/* harmony import */ var _common_index__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common/index */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/common/index.js\");\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"./node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _workbook_common_internalization__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../workbook/common/internalization */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/workbook/common/internalization.js\");\n/* harmony import */ var _syncfusion_ej2_inputs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @syncfusion/ej2-inputs */ \"./node_modules/@syncfusion/ej2-inputs/index.js\");\n/* harmony import */ var _syncfusion_ej2_buttons__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @syncfusion/ej2-buttons */ \"./node_modules/@syncfusion/ej2-buttons/index.js\");\n/* harmony import */ var _syncfusion_ej2_dropdowns__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @syncfusion/ej2-dropdowns */ \"./node_modules/@syncfusion/ej2-dropdowns/index.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * Represents Data Validation support for Spreadsheet.\n */\nvar DataValidation = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Data Validation module.\n     *\n     * @param {Spreadsheet} parent - Constructor for the Spreadsheet Data Validation module.\n     */\n    function DataValidation(parent) {\n        this.divElements = [];\n        this.spanElements = [];\n        this.inputElements = [];\n        this.checkBoxElements = [];\n        this.numericTextBoxElements = [];\n        this.dropDownListElements = [];\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the Data Validation module.\n     *\n     * @returns {void}\n     */\n    DataValidation.prototype.destroy = function () {\n        this.removeEventListener();\n        var validationArgs = {};\n        if (!this.parent.isDestroyed && !this.parent.refreshing) {\n            var activeCellIndex = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(this.parent.getActiveSheet().activeCell);\n            var activeCell = this.parent.getCell(activeCellIndex[0], activeCellIndex[1]);\n            if (activeCell) {\n                validationArgs = { rowIdx: activeCellIndex[0], colIdx: activeCellIndex[1], td: activeCell, isRefresh: true };\n            }\n        }\n        this.removeListDropdownHandler(this.parent.element.querySelector('.e-validation-list'), validationArgs);\n        var dataValPopup = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.select)('#' + this.parent.element.id + '_datavalidation-popup');\n        if (dataValPopup) {\n            dataValPopup.remove();\n        }\n        this.typeData = [];\n        this.operatorData = [];\n        if (this.dataList) {\n            this.dataList = null;\n        }\n        if (this.formObj) {\n            this.formObj.destroy();\n            this.formObj = null;\n        }\n        this.parent = null;\n    };\n    DataValidation.prototype.addEventListener = function () {\n        if (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.Browser.isDevice && _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.Browser.info.name === 'safari' && (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.Browser.isIos || _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.Browser.isIos7)) {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.EventHandler.add(this.parent.element, 'touchend', this.listOpen, this);\n        }\n        else {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.EventHandler.add(this.parent.element, 'dblclick', this.listOpen, this);\n        }\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_3__.initiateDataValidation, this.initiateDataValidationHandler, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_3__.invalidData, this.invalidDataHandler, this);\n        this.parent.on(_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.isValidation, this.isValidCellHandler, this);\n        this.parent.on(_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.activeCellChanged, this.listHandler, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_3__.keyUp, this.keyUpHandler, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_3__.removeDataValidation, this.removeValidationHandler, this);\n        this.parent.on(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.updateHighlight, this.updateHighlightHandler, this);\n        this.parent.on(_index__WEBPACK_IMPORTED_MODULE_0__.rowHeightChanged, this.listValidationHeightHandler, this);\n        this.parent.on(_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.addListValidationDropdown, this.addListValidationDropdownHandler, this);\n    };\n    DataValidation.prototype.removeEventListener = function () {\n        if (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.Browser.isDevice && _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.Browser.info.name === 'safari' && (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.Browser.isIos || _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.Browser.isIos7)) {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.EventHandler.remove(this.parent.element, 'touchend', this.listOpen);\n        }\n        else {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.EventHandler.remove(this.parent.element, 'dblclick', this.listOpen);\n        }\n        if (!this.parent.isDestroyed) {\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_3__.initiateDataValidation, this.initiateDataValidationHandler);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_3__.invalidData, this.invalidDataHandler);\n            this.parent.off(_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.isValidation, this.isValidCellHandler);\n            this.parent.off(_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.activeCellChanged, this.listHandler);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_3__.keyUp, this.keyUpHandler);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_3__.removeDataValidation, this.removeValidationHandler);\n            this.parent.off(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.updateHighlight, this.updateHighlightHandler);\n            this.parent.off(_index__WEBPACK_IMPORTED_MODULE_0__.rowHeightChanged, this.listValidationHeightHandler);\n            this.parent.off(_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.addListValidationDropdown, this.addListValidationDropdownHandler);\n        }\n    };\n    DataValidation.prototype.removeValidationHandler = function (eventArgs) {\n        var sheet;\n        var range;\n        var args = { cancel: false, isColSelected: eventArgs.isCol };\n        if (eventArgs.range && eventArgs.range.includes('!')) {\n            range = eventArgs.range;\n            sheet = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getSheet)(this.parent, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getSheetIndex)(this.parent, range.substring(0, range.lastIndexOf('!'))));\n            if (!sheet) {\n                return;\n            }\n        }\n        else {\n            sheet = this.parent.getActiveSheet();\n            range = sheet.name + '!';\n            if (eventArgs.range) {\n                range += eventArgs.range;\n            }\n            else {\n                var rangeArgs = this.getRange(sheet.selectedRange);\n                range += rangeArgs.range;\n                args.isColSelected = rangeArgs.isColSelected;\n            }\n        }\n        args.range = range;\n        if (eventArgs.isAction) {\n            this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.beginAction, { eventArgs: args, action: 'removeValidation' });\n        }\n        if (!args.cancel) {\n            this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.cellValidation, { range: range, isRemoveValidation: true });\n            if (eventArgs.isAction) {\n                delete args.cancel;\n                this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_0__.completeAction, { eventArgs: args, action: 'removeValidation' });\n            }\n        }\n    };\n    DataValidation.prototype.updateNoteIndicator = function (td, rowIndex, columnIndex) {\n        var noteIndicator = td.querySelector('.e-addNoteIndicator');\n        if (noteIndicator) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.remove)(noteIndicator);\n            this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_0__.createNoteIndicator, { targetElement: td, rowIndex: rowIndex, columnIndex: columnIndex, skipEvent: true });\n        }\n    };\n    DataValidation.prototype.keyUpHandler = function (e) {\n        var target = e.target;\n        var dlgEle = this.parent.element.querySelector('.e-datavalidation-dlg');\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.closest)(target, '.e-values') && dlgEle && e.keyCode !== 13) {\n            var valuesCont = dlgEle.querySelector('.e-values');\n            var errorEle = valuesCont.querySelector('.e-dlg-error');\n            var footerCont = dlgEle.querySelector('.e-footer-content');\n            var primaryBut = footerCont.querySelector('.e-primary');\n            if (primaryBut.hasAttribute('disabled')) {\n                primaryBut.removeAttribute('disabled');\n            }\n            if (errorEle) {\n                valuesCont.removeChild(errorEle);\n            }\n        }\n    };\n    DataValidation.prototype.listOpen = function (e) {\n        var target = e.target;\n        if (this.listObj && target.classList.contains('e-cell') && target.querySelector('.e-validation-list') && this.parent.isEdit) {\n            this.listObj.showPopup();\n        }\n    };\n    DataValidation.prototype.invalidDataHandler = function (args) {\n        var eventArgs = { range: '', cancel: false };\n        var actionArgs;\n        var action = args.isRemoveHighlight ? _workbook_index__WEBPACK_IMPORTED_MODULE_2__.removeHighlight : _workbook_index__WEBPACK_IMPORTED_MODULE_2__.addHighlight;\n        if (!args.isPublic) {\n            actionArgs = { eventArgs: eventArgs, action: action };\n            this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.beginAction, actionArgs);\n            if (eventArgs.cancel) {\n                return;\n            }\n        }\n        this.parent.notify(action, { range: eventArgs.range, isAction: true });\n        if (!args.isPublic) {\n            actionArgs.preventAction = true;\n            this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_0__.completeAction, actionArgs);\n        }\n    };\n    DataValidation.prototype.listHandler = function () {\n        var sheet = this.parent.getActiveSheet();\n        var indexes = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(sheet.activeCell);\n        var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getCell)(indexes[0], indexes[1], sheet);\n        var tdEle = this.parent.getCell(indexes[0], indexes[1]);\n        if (!tdEle) {\n            return;\n        }\n        this.removeListDropdownHandler(this.parent.element.getElementsByClassName('e-validation-list')[0]);\n        var validation = (cell && cell.validation) || (sheet.columns && sheet.columns[indexes[1]] &&\n            sheet.columns[indexes[1]].validation);\n        if (validation && validation.type === 'List') {\n            if (validation.address && !(0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.isInMultipleRange)(validation.address, indexes[0], indexes[1])) {\n                return;\n            }\n            this.addListValidationDropdownHandler({ cell: cell, validation: validation, td: tdEle, rowIdx: indexes[0], colIdx: indexes[1] });\n        }\n        if (cell && cell.validation) {\n            cell.validation = validation;\n        }\n    };\n    DataValidation.prototype.removeListDropdownHandler = function (listEle, validationArgs) {\n        if (listEle) {\n            if (this.listObj) {\n                this.listObj.destroy();\n            }\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.remove)(listEle);\n            if (!validationArgs) {\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.isNullOrUndefined)(this.parent.selectionModule.previousActiveCell)) {\n                    var pervActiveCellIdx = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(this.parent.selectionModule.previousActiveCell);\n                    var pervActiveCellEle = this.parent.getCell(pervActiveCellIdx[0], pervActiveCellIdx[1]);\n                    if (pervActiveCellEle) {\n                        this.updateNoteIndicator(pervActiveCellEle, pervActiveCellIdx[0], pervActiveCellIdx[1]);\n                    }\n                }\n            }\n            else if (validationArgs.isRefresh) {\n                this.updateNoteIndicator(validationArgs.td, validationArgs.rowIdx, validationArgs.colIdx);\n            }\n        }\n    };\n    DataValidation.prototype.addListValidationDropdownHandler = function (args) {\n        var _this = this;\n        if (args.updatePosition) {\n            this.updateTopPosition({ ddlCont: args.ddlCont, rowIdx: args.rowIdx, colIdx: args.colIdx });\n            return;\n        }\n        var inCellDropDown = args.validation.inCellDropDown;\n        if (args.isRefresh) {\n            if (!args.td) {\n                args.td = this.parent.getCell(args.rowIdx, args.colIdx);\n                if (!args.td) {\n                    return;\n                }\n            }\n            this.removeListDropdownHandler(args.td.querySelector('.e-validation-list'), args);\n            if (args.validation.type !== 'List') {\n                return;\n            }\n            if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.isNullOrUndefined)(inCellDropDown)) {\n                inCellDropDown = true;\n            }\n        }\n        else {\n            if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.isNullOrUndefined)(args.validation.ignoreBlank)) {\n                args.validation.ignoreBlank = true;\n            }\n            if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.isNullOrUndefined)(inCellDropDown)) {\n                inCellDropDown = args.validation.inCellDropDown = true;\n            }\n        }\n        if (inCellDropDown) {\n            var ddlCont = this.parent.createElement('div', { className: 'e-validation-list' });\n            var ddlEle = this.parent.createElement('input', { id: this.parent.element.id + 'listValid' });\n            ddlCont.appendChild(ddlEle);\n            var isDevice_1;\n            var tdEle_1 = args.td;\n            var parent_1 = tdEle_1.getElementsByClassName('e-wrap-content')[0] || tdEle_1;\n            this.updateTopPosition({ ddlCont: ddlCont, rowIdx: args.rowIdx, colIdx: args.colIdx });\n            this.listValidationHeightHandler({ ddlCont: ddlCont });\n            parent_1.insertBefore(ddlCont, parent_1.firstChild);\n            var validationVal = args.validation.value1;\n            if ((!args.cell || !args.cell.validation) && validationVal.startsWith('=')) {\n                validationVal = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.getUpdatedFormula)([args.rowIdx, args.colIdx, args.rowIdx, args.colIdx], [0, args.colIdx, 0, args.colIdx], this.parent.getActiveSheet(), this.parent, { formula: validationVal });\n            }\n            var dataSource = this.getListDataSource(validationVal);\n            this.listObj = new _syncfusion_ej2_dropdowns__WEBPACK_IMPORTED_MODULE_8__.DropDownList({\n                index: this.setDropDownListIndex(dataSource, args.cell),\n                dataSource: dataSource,\n                fields: { text: 'text', value: 'id' },\n                width: '0px',\n                popupHeight: '200px',\n                change: function () { return _this.listValueChange(_this.listObj.text); },\n                beforeOpen: function () {\n                    isDevice_1 = window.browserDetails.isDevice;\n                    if (isDevice_1) {\n                        window.browserDetails.isDevice = false;\n                    }\n                },\n                open: function (args) {\n                    args.popup.offsetX = _this.listObj.enableRtl ? 3 : -tdEle_1.offsetWidth + (_this.parent.enableRtl ? 4 : 24);\n                    args.popup.offsetY = -(tdEle_1.querySelector('.e-control-wrapper.e-ddl').offsetHeight - 18);\n                    args.popup.element.style.width = tdEle_1.offsetWidth - 1 + 'px';\n                    if (isDevice_1) {\n                        window.browserDetails.isDevice = true;\n                    }\n                },\n                close: function (args) {\n                    if (args.event && (args.event.keyCode === 13 ||\n                        (args.event.altKey && args.event.keyCode === 38))) {\n                        args.event.preventDefault();\n                        args.event.stopPropagation();\n                    }\n                    (0,_common_index__WEBPACK_IMPORTED_MODULE_3__.focus)(_this.parent.element);\n                }\n            });\n            this.listObj.appendTo(ddlEle);\n            this.updateNoteIndicator(tdEle_1, args.rowIdx, args.colIdx);\n        }\n    };\n    DataValidation.prototype.updateTopPosition = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getCell)(args.rowIdx, args.colIdx, sheet);\n        if (cell && cell.style && cell.style.fontSize && parseFloat(cell.style.fontSize) > 11) {\n            args.ddlCont.style.top = parseFloat(cell.style.fontSize) - 11 + \"pt\";\n        }\n        else if (args.ddlCont.style.top) {\n            args.ddlCont.style.top = '';\n        }\n    };\n    DataValidation.prototype.listValidationHeightHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var indexes = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(sheet.activeCell);\n        var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getCell)(indexes[0], indexes[1], sheet);\n        var validation = (cell && cell.validation) || (sheet.columns && sheet.columns[indexes[1]] &&\n            sheet.columns[indexes[1]].validation);\n        if (validation && validation.type === 'List') {\n            if (validation.inCellDropDown) {\n                var tdRowHeight = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getRowHeight)(sheet, indexes[0], true) - (0,_index__WEBPACK_IMPORTED_MODULE_0__.getBorderHeight)(indexes[0], indexes[1], sheet);\n                if (tdRowHeight <= 18) {\n                    var ddlCont = args.ddlCont || this.parent.element.querySelector('.e-validation-list');\n                    if (ddlCont) {\n                        ddlCont.style.height = tdRowHeight + 'px';\n                    }\n                }\n                else if (!args.ddlCont) {\n                    var ddlCont = this.parent.element.querySelector('.e-validation-list');\n                    if (ddlCont) {\n                        ddlCont.style.removeProperty('height');\n                    }\n                }\n            }\n        }\n    };\n    DataValidation.prototype.setDropDownListIndex = function (dataSource, cell) {\n        if (cell && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.isNullOrUndefined)(cell.value)) {\n            var cellVal = cell.value.toString();\n            var isNumVal = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(cellVal);\n            var numObj = isNumVal && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.getNumericObject)(this.parent.locale);\n            for (var idx = 0, len = dataSource.length; idx < len; idx++) {\n                if (dataSource[idx].text === cellVal || (isNumVal &&\n                    this.parseValidationValue(dataSource[idx].text, numObj).toString() === cellVal)) {\n                    return idx;\n                }\n            }\n        }\n        return null;\n    };\n    DataValidation.prototype.getListDataSource = function (validationVal) {\n        var _this = this;\n        var data = [];\n        var count = 0;\n        var definedNames = this.parent.definedNames;\n        var value = validationVal;\n        var isRange = value.startsWith('=');\n        if (definedNames.length > 0 && isRange) {\n            var listValue = value.split('=')[1];\n            for (var idx = 0, len = definedNames.length; idx < len; idx++) {\n                if (definedNames[idx].name === listValue) {\n                    var definedNameRange = definedNames[idx].refersTo;\n                    while (definedNameRange.includes('\\'')) {\n                        definedNameRange = definedNameRange.replace('\\'', '');\n                    }\n                    value = definedNameRange;\n                }\n            }\n        }\n        if (isRange) {\n            var sheet = void 0;\n            var address = void 0;\n            var sheetName = void 0;\n            var lastIndex = value.lastIndexOf('!');\n            if (lastIndex > -1) {\n                sheetName = value.substring(1, lastIndex);\n                address = value.substring(lastIndex + 1);\n                if (sheetName.startsWith('\\'') && sheetName.endsWith('\\'')) {\n                    sheetName = sheetName.substring(1, sheetName.length - 1);\n                }\n                sheet = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getSheet)(this.parent, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getSheetIndex)(this.parent, sheetName));\n            }\n            else {\n                sheet = this.parent.getActiveSheet();\n                address = value.substring(1);\n            }\n            var activeSheet_1 = this.parent.getActiveSheet();\n            if (sheet) {\n                if (sheet.name !== activeSheet_1.name) {\n                    var isNotLoaded_1;\n                    var selectedRange_1 = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(activeSheet_1.selectedRange);\n                    sheet.ranges.forEach(function (range) {\n                        if (!range.info || !range.info.loadedRange || !range.info.loadedRange.length) {\n                            isNotLoaded_1 = true;\n                            return;\n                        }\n                    });\n                    if (isNotLoaded_1) {\n                        this.parent.showSpinner();\n                        (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getData)(this.parent, sheet.name + \"!\" + address).then(function () {\n                            _this.parent.hideSpinner();\n                            if (activeSheet_1.name === _this.parent.getActiveSheet().name) {\n                                var curRange = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(_this.parent.getActiveSheet().selectedRange);\n                                if (curRange[0] === selectedRange_1[0] && curRange[1] === selectedRange_1[1]) {\n                                    var dataSource = _this.getListDataSource(validationVal);\n                                    _this.listObj.dataSource = dataSource;\n                                    var cell_1 = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getCell)(curRange[0], curRange[1], activeSheet_1);\n                                    _this.listObj.index = _this.setDropDownListIndex(dataSource, cell_1);\n                                    _this.listObj.dataBind();\n                                }\n                            }\n                        });\n                    }\n                }\n                var indexes = void 0;\n                var range = address.split(':');\n                if (range[0] && range[1] && ((range[0].match(/[a-z]+$/ig) && range[1].match(/[a-z]+$/ig)) ||\n                    (range[0].match(/^[0-9]/g) && range[1].match(/^[0-9]/g)))) {\n                    var addressInfo = this.parent.getIndexes(address);\n                    if (addressInfo.isCol) {\n                        indexes = [0, addressInfo.startIdx, sheet.usedRange.rowIndex, addressInfo.startIdx];\n                    }\n                    else {\n                        indexes = [addressInfo.startIdx, 0, addressInfo.startIdx, sheet.usedRange.colIndex];\n                    }\n                }\n                else {\n                    indexes = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(address);\n                }\n                var cell = void 0;\n                for (var rowIdx = indexes[0]; rowIdx <= indexes[2]; rowIdx++) {\n                    if (!sheet.rows[rowIdx]) {\n                        (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.setRow)(sheet, rowIdx, {});\n                    }\n                    for (var colIdx = indexes[1]; colIdx <= indexes[3]; colIdx++) {\n                        if (!sheet.rows[rowIdx].cells) {\n                            (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.setCell)(rowIdx, colIdx, sheet, {});\n                        }\n                        count += 1;\n                        cell = sheet.rows[rowIdx].cells[colIdx];\n                        var formattedText = this.parent.getDisplayText(cell) || '';\n                        data.push({ text: formattedText, id: 'list-' + count });\n                    }\n                }\n            }\n        }\n        else {\n            var listValues = this.getListOfValues(value);\n            for (var idx = 0; idx < listValues.length; idx++) {\n                count += 1;\n                data.push({ text: listValues[idx], id: 'list-' + count });\n            }\n        }\n        return data;\n    };\n    DataValidation.prototype.listValueChange = function (value) {\n        var sheet = this.parent.getActiveSheet();\n        var cellIdx = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.getIndexesFromAddress)(sheet.activeCell);\n        var cellObj = Object.assign({}, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getCell)(cellIdx[0], cellIdx[1], sheet));\n        if (sheet.isProtected && (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.isLocked)(cellObj, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getColumn)(sheet, cellIdx[1]))) {\n            this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_0__.editAlert, null);\n        }\n        else if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.isReadOnly)(cellObj, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getColumn)(sheet, cellIdx[1]), (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getRow)(sheet, cellIdx[0]))) {\n            this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_0__.readonlyAlert, null);\n        }\n        else {\n            if (this.parent.isEdit) {\n                this.parent.closeEdit();\n            }\n            var args = { value: value, oldValue: cellObj.value,\n                address: sheet.name + '!' + sheet.activeCell, cancel: false };\n            this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.beginAction, { action: 'cellSave', eventArgs: args });\n            if (args.cancel) {\n                return;\n            }\n            var cell = { value: value, formula: '' };\n            if (cellObj.format && (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.isCustomDateTime)(cellObj.format) && !(0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(value)) {\n                var formatArgs = { formattedText: value, value: value, format: 'General',\n                    cell: { value: value, format: 'General' }, isEdit: true };\n                this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getFormattedCellObject, formatArgs);\n                if (formatArgs.format !== 'General' && ['Currency', 'Percentage'].indexOf((0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getTypeFromFormat)(formatArgs.format)) > -1) {\n                    cell.format = formatArgs.format;\n                    cell.value = formatArgs.value;\n                }\n            }\n            var cancelled = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.updateCell)(this.parent, sheet, { cell: cell, rowIdx: cellIdx[0], colIdx: cellIdx[1], valChange: true, lastCell: true, checkCF: true,\n                uiRefresh: true });\n            if (!cancelled) {\n                var cell_2 = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getCell)(cellIdx[0], cellIdx[1], sheet, false, true);\n                delete cell_2.formula;\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_3__.formulaBarOperation, { action: 'refreshFormulabar', cell: cell_2 });\n                this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.refreshRibbonIcons, null);\n                this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_0__.completeAction, { action: 'cellSave', eventArgs: { value: value, oldValue: cellObj.value, address: sheet.name + '!' + sheet.activeCell } });\n            }\n        }\n    };\n    DataValidation.prototype.getRange = function (range) {\n        var indexes = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(range);\n        var sheet = this.parent.getActiveSheet();\n        var maxRowCount = sheet.rowCount;\n        var isColSelected;\n        if (indexes[2] === maxRowCount - 1 && indexes[0] === 0) {\n            range = range.replace(/[0-9]/g, '');\n            isColSelected = true;\n        }\n        return { range: range, isColSelected: isColSelected };\n    };\n    DataValidation.prototype.initiateDataValidationHandler = function () {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var indexes = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(sheet.selectedRange);\n        var rowIdx = indexes[0];\n        var colIdx = indexes[1];\n        var rowIterateCondition;\n        var updateRowIdx;\n        if (indexes[2] >= indexes[0]) {\n            rowIterateCondition = function () { return rowIdx <= indexes[2]; };\n            updateRowIdx = function () { rowIdx++; };\n        }\n        else {\n            rowIterateCondition = function () { return rowIdx >= indexes[2]; };\n            updateRowIdx = function () { rowIdx--; };\n        }\n        var colIterateCondition;\n        var updateColIdx;\n        if (indexes[3] >= indexes[1]) {\n            colIterateCondition = function () { return colIdx <= indexes[3]; };\n            updateColIdx = function () { colIdx++; };\n        }\n        else {\n            colIterateCondition = function () { return colIdx >= indexes[3]; };\n            updateColIdx = function () { colIdx--; };\n        }\n        var cell;\n        var moreValidation;\n        var cellsWithoutValidation;\n        var validation;\n        var curValidation;\n        var isVal1Formula;\n        var isVal2Formula;\n        var updateFormula = function (curIdx, prevIdx) {\n            if (isVal1Formula) {\n                var updatedFormula = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.getUpdatedFormula)(curIdx, prevIdx, sheet, _this.parent, { formula: validation.value1 });\n                if (!updatedFormula.includes('#REF!')) {\n                    validation.value1 = updatedFormula;\n                }\n            }\n            if (isVal2Formula) {\n                var updatedFormula = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.getUpdatedFormula)(curIdx, prevIdx, sheet, _this.parent, { formula: validation.value2 });\n                if (!updatedFormula.includes('#REF!')) {\n                    validation.value2 = updatedFormula;\n                }\n            }\n        };\n        for (rowIdx; rowIterateCondition(); updateRowIdx()) {\n            for (colIdx; colIterateCondition(); updateColIdx()) {\n                cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getCell)(rowIdx, colIdx, sheet, false, true);\n                curValidation = cell.validation || ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.checkColumnValidation)(sheet.columns[colIdx], rowIdx, colIdx) &&\n                    sheet.columns[colIdx].validation);\n                if (curValidation) {\n                    if (validation) {\n                        if (curValidation.type !== validation.type || curValidation.operator !== validation.operator ||\n                            ((!isVal1Formula || !(0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.checkIsFormula)(curValidation.value1)) && curValidation.value1 !== validation.value1) ||\n                            ((!isVal2Formula || !(0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.checkIsFormula)(curValidation.value2)) && curValidation.value2 !== validation.value2)) {\n                            moreValidation = true;\n                            break;\n                        }\n                    }\n                    else {\n                        validation = Object.assign({}, curValidation);\n                        isVal1Formula = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.checkIsFormula)(validation.value1);\n                        isVal2Formula = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.checkIsFormula)(validation.value2);\n                        if (!cell.validation) {\n                            updateFormula([rowIdx, colIdx, rowIdx, colIdx], [0, colIdx, 0, colIdx]);\n                        }\n                        var actIdxes = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(sheet.activeCell);\n                        if (rowIdx !== actIdxes[0] || colIdx !== actIdxes[1]) {\n                            updateFormula(actIdxes, [rowIdx, colIdx, rowIdx, colIdx]);\n                        }\n                    }\n                }\n                else {\n                    cellsWithoutValidation = true;\n                }\n            }\n            colIdx = indexes[1];\n        }\n        var l10n = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_3__.locale);\n        var dialogInst = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_3__.dialog);\n        var validationDialogHandler = function (validation) {\n            if (!_this.parent.element.querySelector('.e-datavalidation-dlg')) {\n                var range_1 = _this.getRange(sheet.selectedRange).range;\n                dialogInst.show({\n                    width: 375, showCloseIcon: true, isModal: true, cssClass: 'e-datavalidation-dlg',\n                    header: l10n.getConstant('DataValidation'),\n                    beforeOpen: function (args) {\n                        var dlgArgs = { dialogName: 'ValidationDialog', element: args.element,\n                            target: args.target, cancel: args.cancel };\n                        _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                        if (dlgArgs.cancel) {\n                            args.cancel = true;\n                        }\n                        else {\n                            dialogInst.dialogInstance.content = _this.dataValidationContent(l10n, range_1, validation);\n                            dialogInst.dialogInstance.dataBind();\n                            (0,_common_index__WEBPACK_IMPORTED_MODULE_3__.focus)(_this.parent.element);\n                        }\n                    },\n                    beforeClose: _this.dialogBeforeClose.bind(_this),\n                    buttons: [{\n                            buttonModel: {\n                                content: l10n.getConstant('ClearAll'),\n                                cssClass: 'e-btn e-clearall-btn e-flat'\n                            },\n                            click: function () {\n                                dialogInst.dialogInstance.content = _this.dataValidationContent(l10n, range_1);\n                                dialogInst.dialogInstance.dataBind();\n                            }\n                        },\n                        {\n                            buttonModel: { content: l10n.getConstant('Apply'), isPrimary: true },\n                            click: function () {\n                                _this.dlgClickHandler(dialogInst);\n                            }\n                        }]\n                });\n            }\n        };\n        if (moreValidation || (validation && cellsWithoutValidation)) {\n            var dialogName_1;\n            var btns = [{\n                    buttonModel: { isPrimary: true, cssClass: 'e-btn-goto-ok' },\n                    click: function () {\n                        dialogInst.hide(true);\n                        validationDialogHandler();\n                    }\n                }];\n            if (moreValidation) {\n                dialogName_1 = 'MoreValidation';\n                btns[0].buttonModel.content = l10n.getConstant('Ok');\n            }\n            else {\n                dialogName_1 = 'ExtendValidation';\n                btns[0].buttonModel.content = l10n.getConstant('No');\n                btns.splice(0, 0, {\n                    buttonModel: {\n                        content: l10n.getConstant('Yes'), isPrimary: true, cssClass: 'e-btn-goto-ok'\n                    },\n                    click: function () {\n                        dialogInst.hide(true);\n                        validationDialogHandler(validation);\n                    }\n                });\n            }\n            var dialogContent_1 = l10n.getConstant(dialogName_1);\n            var dlg = {\n                width: 350, isModal: true, showCloseIcon: true, cssClass: 'e-goto-dlg', header: l10n.getConstant('Spreadsheet'),\n                content: dialogContent_1,\n                beforeOpen: function (args) {\n                    var dlgArgs = { dialogName: dialogName_1, element: args.element, target: args.target,\n                        cancel: args.cancel, content: dialogContent_1 };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    else {\n                        if (dlgArgs.content !== dialogContent_1) {\n                            dialogInst.dialogInstance.content = dlgArgs.content;\n                            dialogInst.dialogInstance.dataBind();\n                        }\n                        (0,_common_index__WEBPACK_IMPORTED_MODULE_3__.focus)(_this.parent.element);\n                    }\n                },\n                buttons: btns\n            };\n            dialogInst.show(dlg);\n        }\n        else {\n            validationDialogHandler(validation);\n        }\n    };\n    DataValidation.prototype.dataValidationContent = function (l10n, range, validation) {\n        var _this = this;\n        var value1;\n        var value2;\n        var type;\n        var isNew = !validation;\n        var operator;\n        var ignoreBlank;\n        if (isNew) {\n            value1 = value2 = '0';\n            ignoreBlank = true;\n        }\n        else {\n            var val1 = validation.value1;\n            var val2 = validation.value2;\n            type = validation.type;\n            operator = validation.operator;\n            ignoreBlank = validation.ignoreBlank === false ? false : true;\n            if (type === 'Date' || type === 'Time') {\n                var getFormattedDate = function (val) {\n                    if ((0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(val)) {\n                        var args = { cell: { value: val }, type: type.toLowerCase(),\n                            value: val };\n                        _this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getFormattedBarText, args);\n                        return args.value;\n                    }\n                    return val;\n                };\n                value1 = getFormattedDate(val1);\n                value2 = getFormattedDate(val2);\n            }\n            else {\n                var getFormattedValue = function (val) {\n                    if ((0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(val)) {\n                        val = val.toString();\n                        var localeObj = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.getNumericObject)(_this.parent.locale);\n                        if (localeObj.decimal !== '.' && val.includes('.')) {\n                            val = val.replace('.', localeObj.decimal);\n                        }\n                    }\n                    return val;\n                };\n                value1 = getFormattedValue(val1);\n                value2 = getFormattedValue(val2);\n            }\n        }\n        var dlgContent = this.parent.createElement('div', { className: 'e-validation-dlg' });\n        var cellRangeCont = this.parent.createElement('div', { className: 'e-cellrange' });\n        var allowDataCont = this.parent.createElement('div', { className: 'e-allowdata' });\n        var valuesCont = this.parent.createElement('div', { className: 'e-values' });\n        var ignoreBlankCont = this.parent.createElement('div', { className: 'e-ignoreblank' });\n        this.divElements.push(dlgContent);\n        this.divElements.push(cellRangeCont);\n        this.divElements.push(allowDataCont);\n        this.divElements.push(valuesCont);\n        this.divElements.push(ignoreBlankCont);\n        dlgContent.appendChild(cellRangeCont);\n        dlgContent.appendChild(allowDataCont);\n        dlgContent.appendChild(valuesCont);\n        dlgContent.appendChild(ignoreBlankCont);\n        var cellRangeText = this.parent.createElement('span', { className: 'e-header' });\n        cellRangeText.innerText = l10n.getConstant('CellRange');\n        var cellRangeEle = this.parent.createElement('input', {\n            className: 'e-input',\n            attrs: { value: range, 'aria-label': l10n.getConstant('CellRange') }\n        });\n        cellRangeCont.appendChild(cellRangeText);\n        cellRangeCont.appendChild(cellRangeEle);\n        var allowCont = this.parent.createElement('div', { className: 'e-allow' });\n        var dataCont = this.parent.createElement('div', { className: 'e-data' });\n        allowDataCont.appendChild(allowCont);\n        allowDataCont.appendChild(dataCont);\n        var allowText = this.parent.createElement('span', { className: 'e-header' });\n        allowText.innerText = l10n.getConstant('Allow');\n        this.typeData = [\n            { text: l10n.getConstant('WholeNumber'), id: 'type-1' },\n            { text: l10n.getConstant('Decimal'), id: 'type-2' },\n            { text: l10n.getConstant('Date'), id: 'type-3' },\n            { text: l10n.getConstant('Time'), id: 'type-4' },\n            { text: l10n.getConstant('TextLength'), id: 'type-5' },\n            { text: l10n.getConstant('List'), id: 'type-6' },\n            { text: l10n.getConstant('Custom'), id: 'type-7' }\n        ];\n        this.operatorData = [\n            { text: l10n.getConstant('Between'), id: 'operator-1' },\n            { text: l10n.getConstant('NotBetween'), id: 'operator-2' },\n            { text: l10n.getConstant('EqualTo'), id: 'operator-3' },\n            { text: l10n.getConstant('NotEqualTo'), id: 'operator-4' },\n            { text: l10n.getConstant('GreaterThan'), id: 'operator-5' },\n            { text: l10n.getConstant('LessThan'), id: 'operator-6' },\n            { text: l10n.getConstant('GreaterThanOrEqualTo'), id: 'operator-7' },\n            { text: l10n.getConstant('LessThanOrEqualTo'), id: 'operator-8' }\n        ];\n        var allowSelectEle = this.parent.createElement('input', { className: 'e-select' });\n        this.spanElements.push(cellRangeText);\n        this.inputElements.push(cellRangeEle);\n        this.divElements.push(allowCont);\n        this.divElements.push(dataCont);\n        this.spanElements.push(allowText);\n        this.inputElements.push(allowSelectEle);\n        var allowIdx = 0;\n        if (!isNew) {\n            if (type) {\n                type = this.formattedType(type);\n            }\n            for (var idx = 0; idx < this.typeData.length; idx++) {\n                if (type === this.formattedType(this.typeData[idx].text)) {\n                    allowIdx = idx;\n                    break;\n                }\n            }\n        }\n        if (isNew || (type !== 'List' && type !== 'Custom')) {\n            var dataIdx = 0;\n            var dataText = this.parent.createElement('span', { className: 'e-header' });\n            dataText.innerText = l10n.getConstant('Data');\n            var dataSelectEle = this.parent.createElement('input', { className: 'e-select' });\n            if (!isNew) {\n                for (var idx = 0; idx < this.operatorData.length; idx++) {\n                    if (operator === this.formattedValue(this.operatorData[idx].text)) {\n                        dataIdx = idx;\n                        break;\n                    }\n                }\n            }\n            dataCont.appendChild(dataText);\n            dataCont.appendChild(dataSelectEle);\n            this.spanElements.push(dataText);\n            this.inputElements.push(dataSelectEle);\n            this.dataList = new _syncfusion_ej2_dropdowns__WEBPACK_IMPORTED_MODULE_8__.DropDownList({\n                dataSource: this.operatorData,\n                index: dataIdx,\n                popupHeight: '200px',\n                change: this.userInput.bind(this)\n            });\n            this.dropDownListElements.push(this.dataList);\n            this.dataList.appendTo(dataSelectEle);\n        }\n        else if (type !== 'Custom') {\n            var ignoreBlankEle_1 = this.parent.createElement('input', { className: 'e-checkbox' });\n            dataCont.appendChild(ignoreBlankEle_1);\n            var ignoreBlankObj_1 = new _syncfusion_ej2_buttons__WEBPACK_IMPORTED_MODULE_7__.CheckBox({ label: l10n.getConstant('InCellDropDown'), checked: validation.inCellDropDown === false ? false : true });\n            this.checkBoxElements.push(ignoreBlankObj_1);\n            ignoreBlankObj_1.appendTo(ignoreBlankEle_1);\n            this.inputElements.push(ignoreBlankEle_1);\n        }\n        allowCont.appendChild(allowText);\n        allowCont.appendChild(allowSelectEle);\n        this.typeList = new _syncfusion_ej2_dropdowns__WEBPACK_IMPORTED_MODULE_8__.DropDownList({\n            dataSource: this.typeData,\n            index: allowIdx,\n            popupHeight: '200px',\n            change: this.userInput.bind(this)\n        });\n        this.dropDownListElements.push(this.typeList);\n        this.typeList.appendTo(allowSelectEle);\n        var createContEle = function (labelKey, value) {\n            var valueText = _this.parent.createElement('span', { className: 'e-header' });\n            valueText.innerText = labelKey;\n            var valueEle = _this.parent.createElement('input', { className: 'e-input', attrs: { value: value } });\n            valuesCont.appendChild(valueText);\n            valuesCont.appendChild(valueEle);\n            _this.spanElements.push(valueText);\n            _this.inputElements.push(valueEle);\n        };\n        if (isNew || ((this.typeList.value !== l10n.getConstant('List') && this.typeList.value !== l10n.getConstant('Custom')) &&\n            (this.dataList.value === l10n.getConstant('Between') || this.dataList.value === l10n.getConstant('NotBetween')))) {\n            var minimumCont = this.parent.createElement('div', { className: 'e-minimum' });\n            var maximumCont = this.parent.createElement('div', { className: 'e-maximum' });\n            valuesCont.appendChild(minimumCont);\n            valuesCont.appendChild(maximumCont);\n            var minimumText = this.parent.createElement('span', { className: 'e-header' });\n            minimumText.innerText = l10n.getConstant('Minimum');\n            var maximumText = this.parent.createElement('span', { className: 'e-header' });\n            maximumText.innerText = l10n.getConstant('Maximum');\n            var minimumInp = this.parent.createElement('input', {\n                id: 'minvalue',\n                className: 'e-input', attrs: { value: value1, 'aria-label': l10n.getConstant('Minimum') }\n            });\n            var maximumInp = this.parent.createElement('input', {\n                id: 'maxvalue',\n                className: 'e-input', attrs: { value: value2, 'aria-label': l10n.getConstant('Maximum') }\n            });\n            minimumCont.appendChild(minimumText);\n            minimumCont.appendChild(minimumInp);\n            maximumCont.appendChild(maximumText);\n            maximumCont.appendChild(maximumInp);\n            this.divElements.push(minimumCont);\n            this.divElements.push(maximumCont);\n            this.spanElements.push(minimumText);\n            this.spanElements.push(maximumText);\n            this.inputElements.push(minimumInp);\n            this.inputElements.push(maximumInp);\n            var numericMin = new _syncfusion_ej2_inputs__WEBPACK_IMPORTED_MODULE_6__.NumericTextBox({\n                value: 0\n            });\n            this.numericTextBoxElements.push(numericMin);\n            numericMin.appendTo('#minvalue');\n            var numericMax = new _syncfusion_ej2_inputs__WEBPACK_IMPORTED_MODULE_6__.NumericTextBox({\n                value: 0\n            });\n            this.numericTextBoxElements.push(numericMax);\n            numericMax.appendTo('#maxvalue');\n        }\n        else if (!isNew && type === 'List') {\n            createContEle(l10n.getConstant('Sources'), value1);\n        }\n        else if (!isNew && type === 'Custom') {\n            createContEle(l10n.getConstant('Formula'), value1);\n        }\n        else {\n            createContEle(l10n.getConstant('Value'), value1);\n        }\n        var ignoreBlankEle = this.parent.createElement('input', { className: 'e-checkbox' });\n        ignoreBlankCont.appendChild(ignoreBlankEle);\n        var ignoreBlankObj = new _syncfusion_ej2_buttons__WEBPACK_IMPORTED_MODULE_7__.CheckBox({ label: l10n.getConstant('IgnoreBlank'), checked: ignoreBlank });\n        this.checkBoxElements.push(ignoreBlankObj);\n        ignoreBlankObj.appendTo(ignoreBlankEle);\n        this.inputElements.push(ignoreBlankEle);\n        return dlgContent;\n    };\n    DataValidation.prototype.dialogBeforeClose = function () {\n        this.checkBoxElements.forEach(function (checkbox) {\n            if (checkbox && checkbox.element) {\n                checkbox.destroy();\n                checkbox.element.remove();\n            }\n        });\n        this.checkBoxElements = [];\n        this.numericTextBoxElements.forEach(function (numericTextBox) {\n            if (numericTextBox && numericTextBox.element) {\n                numericTextBox.destroy();\n                numericTextBox.element.remove();\n            }\n        });\n        this.numericTextBoxElements = [];\n        this.dropDownListElements.forEach(function (dropDownList) {\n            if (dropDownList && dropDownList.element) {\n                dropDownList.destroy();\n                dropDownList.element.remove();\n            }\n        });\n        this.dropDownListElements = [];\n        (0,_common_index__WEBPACK_IMPORTED_MODULE_3__.removeElements)(this.spanElements);\n        this.spanElements = [];\n        (0,_common_index__WEBPACK_IMPORTED_MODULE_3__.removeElements)(this.inputElements);\n        this.inputElements = [];\n        (0,_common_index__WEBPACK_IMPORTED_MODULE_3__.removeElements)(this.divElements);\n        this.divElements = [];\n    };\n    DataValidation.prototype.userInput = function () {\n        var listObj = this.typeList;\n        var listObj1 = this.dataList;\n        var dlgEle = this.parent.element.querySelector('.e-datavalidation-dlg');\n        var dlgCont = dlgEle.querySelector('.e-validation-dlg');\n        var allowDataCont = dlgCont.querySelector('.e-allowdata');\n        var valuesCont = dlgCont.querySelector('.e-values');\n        var l10n = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_3__.locale);\n        var dataCont = allowDataCont.querySelector('.e-data');\n        var clearChildEle = function (element) {\n            while (element.lastChild) {\n                element.removeChild(element.lastChild);\n            }\n        };\n        clearChildEle(valuesCont);\n        if (listObj.value === l10n.getConstant('List')) {\n            clearChildEle(dataCont);\n            var cellDropDownEle = this.parent.createElement('input', { className: 'e-checkbox' });\n            this.inputElements.push(cellDropDownEle);\n            dataCont.appendChild(cellDropDownEle);\n            var cellDropDownOhj = new _syncfusion_ej2_buttons__WEBPACK_IMPORTED_MODULE_7__.CheckBox({ label: l10n.getConstant('InCellDropDown'), checked: true });\n            this.checkBoxElements.push(cellDropDownOhj);\n            cellDropDownOhj.appendTo(cellDropDownEle);\n        }\n        else if (listObj.value === l10n.getConstant('Custom')) {\n            clearChildEle(dataCont);\n        }\n        else if (!dataCont.childElementCount || dataCont.getElementsByClassName('e-checkbox-wrapper')[0]) {\n            clearChildEle(dataCont);\n            var dataText = this.parent.createElement('span', { className: 'e-header' });\n            dataText.innerText = l10n.getConstant('Data');\n            var dataSelectEle = this.parent.createElement('input', { className: 'e-select' });\n            this.spanElements.push(dataText);\n            this.inputElements.push(dataSelectEle);\n            dataCont.appendChild(dataText);\n            dataCont.appendChild(dataSelectEle);\n            listObj1.appendTo(dataSelectEle);\n        }\n        if ((listObj.value !== l10n.getConstant('List') && listObj.value !== l10n.getConstant('Custom')) && (listObj1.value === l10n.getConstant('Between') || listObj1.value === l10n.getConstant('NotBetween'))) {\n            var minimumCont = this.parent.createElement('div', { className: 'e-minimum' });\n            var maximumCont = this.parent.createElement('div', { className: 'e-maximum' });\n            this.divElements.push(minimumCont);\n            this.divElements.push(maximumCont);\n            valuesCont.appendChild(minimumCont);\n            valuesCont.appendChild(maximumCont);\n            var minimumText = this.parent.createElement('span', { className: 'e-header' });\n            minimumText.innerText = l10n.getConstant('Minimum');\n            var maximumText = this.parent.createElement('span', { className: 'e-header' });\n            maximumText.innerText = l10n.getConstant('Maximum');\n            var minimumInp = this.parent.createElement('input', { id: 'min', className: 'e-input', attrs: { value: '0' } });\n            var maximumInp = this.parent.createElement('input', { id: 'max', className: 'e-input', attrs: { value: '0' } });\n            this.spanElements.push(minimumText);\n            this.spanElements.push(maximumText);\n            this.inputElements.push(minimumInp);\n            this.inputElements.push(maximumInp);\n            var numericMin = new _syncfusion_ej2_inputs__WEBPACK_IMPORTED_MODULE_6__.NumericTextBox({\n                value: 0\n            });\n            this.numericTextBoxElements.push(numericMin);\n            numericMin.appendTo('min');\n            var numericMax = new _syncfusion_ej2_inputs__WEBPACK_IMPORTED_MODULE_6__.NumericTextBox({\n                value: 0\n            });\n            this.numericTextBoxElements.push(numericMax);\n            numericMax.appendTo('max');\n            minimumCont.appendChild(minimumText);\n            minimumCont.appendChild(minimumInp);\n            maximumCont.appendChild(maximumText);\n            maximumCont.appendChild(maximumInp);\n        }\n        else {\n            var valueText = this.parent.createElement('span', { className: 'e-header' });\n            valueText.innerText = listObj.value === l10n.getConstant('List') ? l10n.getConstant('Sources') :\n                listObj.value === l10n.getConstant('Custom') ? l10n.getConstant('Formula') : l10n.getConstant('Value');\n            var valueEle = listObj.value === l10n.getConstant('List') ? this.parent.createElement('input', {\n                className: 'e-input',\n                attrs: { placeholder: 'Enter value' }\n            }) :\n                this.parent.createElement('input', { className: 'e-input', attrs: { value: '0' } });\n            this.spanElements.push(valueText);\n            this.inputElements.push(valueEle);\n            valuesCont.appendChild(valueText);\n            valuesCont.appendChild(valueEle);\n        }\n    };\n    DataValidation.prototype.dlgClickHandler = function (dialogInst) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_3__.locale);\n        var errorMsg;\n        var dlgEle = this.parent.element.querySelector('.e-datavalidation-dlg');\n        var dlgFooter = dlgEle.querySelector('.e-footer-content');\n        var dlgContEle = dlgEle.getElementsByClassName('e-dlg-content')[0].\n            getElementsByClassName('e-validation-dlg')[0];\n        var allowData = dlgContEle.getElementsByClassName('e-allowdata')[0];\n        var allowEle = allowData.getElementsByClassName('e-allow')[0].getElementsByTagName('input')[0];\n        var dataEle = allowData.getElementsByClassName('e-data')[0].getElementsByTagName('input')[0];\n        var values = dlgContEle.getElementsByClassName('e-values')[0];\n        var valueArr = [];\n        valueArr[0] = values.getElementsByTagName('input')[0].value;\n        valueArr[1] = values.getElementsByTagName('input')[1] ? values.getElementsByTagName('input')[1].value : '';\n        var type = this.formattedType(allowEle.value);\n        var isValid = true;\n        var ignoreBlank = dlgContEle.querySelector('.e-ignoreblank .e-checkbox').checked;\n        var inCellDropDown = allowData.querySelector('.e-data').querySelector('.e-checkbox-wrapper') ?\n            allowData.querySelector('.e-data').querySelector('.e-checkbox-wrapper').querySelector('.e-check') ? true : false : null;\n        var range = dlgContEle.querySelector('.e-cellrange').getElementsByTagName('input')[0].value;\n        var operator;\n        if (dataEle) {\n            operator = this.formattedValue(dataEle.value);\n        }\n        var valArr = [];\n        if (type === 'List') {\n            if (valueArr[0] !== '') {\n                valArr.push(valueArr[0]);\n            }\n            if (valueArr[0].startsWith('=')) {\n                var address_1 = valueArr[0].substring(1);\n                var definedName = this.parent.definedNames.find(function (item) { return item.name === address_1; });\n                if (definedName) {\n                    address_1 = definedName.refersTo.substring(1);\n                }\n                var isSheetNameValid = void 0;\n                var sheetTokenIdx = void 0;\n                if (address_1.includes('!')) {\n                    sheetTokenIdx = address_1.lastIndexOf('!');\n                    var sheetName = address_1.substring(0, sheetTokenIdx);\n                    address_1 = address_1.substring(sheetTokenIdx + 1);\n                    if (sheetName.startsWith('\\'') && sheetName.endsWith('\\'')) {\n                        sheetName = sheetName.substring(1, sheetName.length - 1);\n                    }\n                    isSheetNameValid = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getSheetIndex)(this.parent, sheetName) > -1;\n                    if (!definedName) {\n                        valArr[0] = '=' + sheetName + '!' + address_1;\n                    }\n                }\n                else {\n                    isSheetNameValid = true;\n                }\n                if (!address_1.includes(':') && (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.isCellReference)(address_1)) {\n                    address_1 = address_1 + \":\" + address_1;\n                }\n                var isSingleRowOrCol = void 0;\n                if (isSheetNameValid) {\n                    var cellRef = address_1.split(':');\n                    if (cellRef.length === 2) {\n                        isSingleRowOrCol = address_1.match(/[a-z]/gi) && cellRef[0].replace(/[0-9]/g, '') === cellRef[1].replace(/[0-9]/g, '')\n                            || address_1.match(/\\d/g) && cellRef[0].replace(/\\D/g, '') === cellRef[1].replace(/\\D/g, '');\n                    }\n                }\n                isValid = isSingleRowOrCol;\n                if (!isValid) {\n                    errorMsg = !definedName && sheetTokenIdx === undefined && !address_1.includes(':') ?\n                        l10n.getConstant('NamedRangeError') : l10n.getConstant('DialogError');\n                }\n            }\n            else if (valueArr[0].length > 256) {\n                isValid = false;\n                errorMsg = l10n.getConstant('ListLengthError');\n            }\n        }\n        else {\n            var numObj_1 = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.getNumericObject)(this.parent.locale);\n            if (type === 'Decimal' && numObj_1.decimal !== '.') {\n                var isNotCulturedNumber = function (val) { return (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(val) && val.includes('.') &&\n                    (numObj_1.group !== '.' || !(0,_workbook_common_internalization__WEBPACK_IMPORTED_MODULE_5__.parseThousandSeparator)(val, _this.parent.locale, numObj_1.group, numObj_1.decimal)); };\n                if (isNotCulturedNumber(valueArr[0]) || isNotCulturedNumber(valueArr[1])) {\n                    isValid = false;\n                    errorMsg = l10n.getConstant('InvalidNumberError');\n                }\n            }\n            (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.parseLocaleNumber)(valueArr, this.parent, numObj_1);\n            if (valueArr[0] !== '') {\n                valArr.push(valueArr[0]);\n            }\n            if (valueArr[1] !== '') {\n                valArr.push(valueArr[1]);\n            }\n        }\n        if (isValid) {\n            var sheet = this.parent.getActiveSheet();\n            var validDlg = this.isDialogValidator(valArr, type, operator);\n            if (operator === 'Between' && validDlg.isValid && !isNaN(parseFloat(valArr[0])) && !isNaN(parseFloat(valArr[1])) &&\n                parseFloat(valArr[0]) > parseFloat(valArr[1])) {\n                validDlg.isValid = false;\n                validDlg.errorMsg = l10n.getConstant('MinMaxError');\n            }\n            if (type === 'Custom') {\n                if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.checkIsFormula)(valArr[0])) {\n                    var errorStrings = ['#N/A', '#VALUE!', '#REF!', '#DIV/0!', '#NUM!', '#NAME?', '#NULL!', '#CALC!'];\n                    var eventArgs = { value: valArr[0] };\n                    this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.commputeFormulaValue, eventArgs);\n                    var customValue = eventArgs.value;\n                    if (errorStrings.indexOf(customValue) > -1) {\n                        validDlg.isValid = false;\n                        validDlg.errorMsg = l10n.getConstant('InvalidFormula');\n                    }\n                }\n            }\n            errorMsg = validDlg.errorMsg;\n            isValid = validDlg.isValid;\n            if (isValid) {\n                if ((0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.isReadOnlyCells)(this.parent, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getSwapRange)((0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(range)))) {\n                    dialogInst.hide(true);\n                    this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_0__.readonlyAlert, null);\n                    return;\n                }\n                var args = { range: sheet.name + '!' + range, value1: valArr[0], value2: valArr[1] || '',\n                    ignoreBlank: ignoreBlank, type: type, operator: operator, inCellDropDown: inCellDropDown, cancel: false };\n                this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.beginAction, { eventArgs: args, action: 'validation' });\n                if (!args.cancel) {\n                    this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.cellValidation, { rules: { type: args.type, operator: args.operator, value1: args.value1, value2: args.value2,\n                            ignoreBlank: args.ignoreBlank, inCellDropDown: args.inCellDropDown }, range: args.range, isAction: true });\n                    delete args.cancel;\n                    if (!this.parent.element.getElementsByClassName('e-validation-error-dlg')[0]) {\n                        if (dialogInst.dialogInstance) {\n                            dialogInst.dialogInstance.hide();\n                        }\n                        else {\n                            dialogInst.hide();\n                        }\n                    }\n                    this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_0__.completeAction, { eventArgs: args, action: 'validation' });\n                }\n            }\n        }\n        if (!isValid) {\n            var errorEle = this.parent.createElement('div', { className: 'e-dlg-error', id: 'e-invalid' });\n            errorEle.innerText = errorMsg;\n            values.appendChild(errorEle);\n            dlgFooter.querySelector('.e-primary').setAttribute('disabled', 'true');\n        }\n    };\n    DataValidation.prototype.formattedValue = function (value) {\n        var l10n = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_3__.locale);\n        switch (value) {\n            case l10n.getConstant('Between'):\n                value = 'Between';\n                break;\n            case l10n.getConstant('NotBetween'):\n                value = 'NotBetween';\n                break;\n            case l10n.getConstant('EqualTo'):\n                value = 'EqualTo';\n                break;\n            case l10n.getConstant('NotEqualTo'):\n                value = 'NotEqualTo';\n                break;\n            case l10n.getConstant('GreaterThan'):\n                value = 'GreaterThan';\n                break;\n            case l10n.getConstant('LessThan'):\n                value = 'LessThan';\n                break;\n            case l10n.getConstant('GreaterThanOrEqualTo'):\n                value = 'GreaterThanOrEqualTo';\n                break;\n            case l10n.getConstant('LessThanOrEqualTo'):\n                value = 'LessThanOrEqualTo';\n                break;\n            default:\n                value = 'Between';\n                break;\n        }\n        return value;\n    };\n    DataValidation.prototype.formattedType = function (value) {\n        var l10n = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_3__.locale);\n        switch (value) {\n            case l10n.getConstant('WholeNumber'):\n                value = 'WholeNumber';\n                break;\n            case l10n.getConstant('Decimal'):\n                value = 'Decimal';\n                break;\n            case l10n.getConstant('Date'):\n                value = 'Date';\n                break;\n            case l10n.getConstant('TextLength'):\n                value = 'TextLength';\n                break;\n            case l10n.getConstant('List'):\n                value = 'List';\n                break;\n            case l10n.getConstant('Time'):\n                value = 'Time';\n                break;\n            case l10n.getConstant('Custom'):\n                value = 'Custom';\n                break;\n            default:\n                break;\n        }\n        return value;\n    };\n    DataValidation.prototype.isDialogValidator = function (values, type, operator) {\n        var l10n = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_3__.locale);\n        var count = 0;\n        var isEmpty = false;\n        var formValidation;\n        if (type === 'List') {\n            isEmpty = values.length > 0 ? false : true;\n        }\n        else {\n            if (operator === 'Between' || operator === 'NotBetween') {\n                isEmpty = values.length === 2 ? false : true;\n            }\n            else {\n                isEmpty = values.length > 0 ? false : true;\n            }\n        }\n        if (!isEmpty) {\n            var value = void 0;\n            for (var idx = 0; idx < values.length; idx++) {\n                if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.checkIsFormula)(values[idx])) {\n                    var eventArgs = { value: values[idx] };\n                    this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.commputeFormulaValue, eventArgs);\n                    value = eventArgs.value;\n                }\n                else if (type === 'Date' || type === 'Time') {\n                    value = values[idx] = this.getDateAsNumber({ range: [], cell: { value: values[idx] } }, values[idx]);\n                }\n                else {\n                    value = values[idx];\n                }\n                formValidation = this.formatValidation(value, type, true);\n                if (formValidation.isValid) {\n                    count = count + 1;\n                }\n                else {\n                    break;\n                }\n            }\n            formValidation.isValid = count === values.length;\n            return formValidation;\n        }\n        else {\n            return { isValid: false, errorMsg: l10n.getConstant('EmptyError') };\n        }\n    };\n    DataValidation.prototype.getDateAsNumber = function (args, cellValue) {\n        var dateEventArgs = { value: cellValue, rowIndex: args.range[0], cell: args.cell,\n            colIndex: args.range[1], sheetIndex: args.sheetIdx, updatedVal: '' };\n        this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.checkDateFormat, dateEventArgs);\n        return dateEventArgs.updatedVal || cellValue;\n    };\n    DataValidation.prototype.getListOfValues = function (listValue) {\n        var listValArr;\n        if (this.parent.listSeparator !== ',' && listValue.includes(this.parent.listSeparator)) {\n            listValArr = listValue.split(this.parent.listSeparator);\n        }\n        else {\n            listValArr = listValue.split(',');\n        }\n        return listValArr;\n    };\n    DataValidation.prototype.checkValidationHandler = function (args, validation) {\n        var enterValue = args.value.toString();\n        var sheet = this.parent.sheets[args.sheetIdx];\n        var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getCell)(args.range[0], args.range[1], sheet, null, true);\n        var value1 = validation.value1;\n        var value2 = validation.value2;\n        if (!cell.validation) {\n            var currIdx = args.range;\n            var prevIdx = [0, args.range[1], 0, args.range[3]];\n            if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.checkIsFormula)(value1)) {\n                value1 = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.getUpdatedFormula)(currIdx, prevIdx, sheet, this.parent, { formula: value1 });\n            }\n            if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.checkIsFormula)(value2)) {\n                value2 = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.getUpdatedFormula)(currIdx, prevIdx, sheet, this.parent, { formula: value2 });\n            }\n        }\n        if (validation.type !== 'List') {\n            if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.checkIsFormula)(value1)) {\n                var eventArgs1 = { value: value1 };\n                this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.commputeFormulaValue, eventArgs1);\n                value1 = eventArgs1.value;\n            }\n            if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.checkIsFormula)(value2)) {\n                var eventArgs2 = { value: value2 };\n                this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.commputeFormulaValue, eventArgs2);\n                value2 = eventArgs2.value;\n            }\n            if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.checkIsFormula)(args.value)) {\n                var eventArgs = { value: args.value };\n                this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.commputeFormulaValue, eventArgs);\n                args.value = eventArgs.value;\n            }\n        }\n        var value = args.value;\n        var opt = validation.operator || 'Between';\n        var type = validation.type || 'WholeNumber';\n        var ignoreBlank = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.isNullOrUndefined)(validation.ignoreBlank) ? true : validation.ignoreBlank;\n        if (ignoreBlank && enterValue === '') {\n            return true;\n        }\n        else {\n            var isDateTimeType = type === 'Date' || type === 'Time';\n            if (args.value) {\n                if (isDateTimeType || validation.type === 'TextLength') {\n                    if (!(0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(args.value)) {\n                        value = args.value = this.getDateAsNumber(args, args.value);\n                    }\n                }\n                else {\n                    var numObj = args.isEdit && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.getNumericObject)(this.parent.locale);\n                    var numVal = this.parseValidationValue(args.value, numObj);\n                    if (numVal !== args.value && (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(numVal)) {\n                        value = args.value = numVal.toString();\n                    }\n                }\n            }\n            var isValid = this.formatValidation(args.value, type).isValid;\n            if (isValid) {\n                isValid = false;\n                if (isDateTimeType) {\n                    if (value1 && !(0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(value1)) {\n                        value1 = this.getDateAsNumber(args, value1);\n                    }\n                    if (value2 && !(0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(value2)) {\n                        value2 = this.getDateAsNumber(args, value2);\n                    }\n                }\n                else if (validation.type === 'TextLength') {\n                    value = args.value.toString().length.toString();\n                }\n                if (type === 'List') {\n                    var val = args.value.toString();\n                    var isNumVal = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(val);\n                    var numObj = isNumVal && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.getNumericObject)(this.parent.locale);\n                    if (value1.startsWith('=')) {\n                        var listVal = void 0;\n                        var data = this.getListDataSource(value1);\n                        for (var idx = 0; idx < data.length; idx++) {\n                            listVal = data[idx].text.toString();\n                            if (enterValue === listVal || val === listVal || (isNumVal &&\n                                val === this.parseValidationValue(listVal, numObj).toString())) {\n                                isValid = true;\n                                break;\n                            }\n                        }\n                    }\n                    else {\n                        var listValues = this.getListOfValues(value1);\n                        for (var idx = 0; idx < listValues.length; idx++) {\n                            if (enterValue === listValues[idx] || val === listValues[idx] || (isNumVal &&\n                                val === this.parseValidationValue(listValues[idx], numObj).toString())) {\n                                isValid = true;\n                                break;\n                            }\n                        }\n                    }\n                    if (!isValid && ignoreBlank && val === '') {\n                        isValid = true;\n                    }\n                }\n                else if (type === 'Custom') {\n                    var numVal = parseFloat(value1.toString());\n                    if ((0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(numVal)) {\n                        if (numVal === 0) {\n                            var cellRefVal = { value: validation.value1 };\n                            this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.getCellRefValue, cellRefVal); // To consider empty cell references cases.\n                            isValid = cellRefVal.value !== '' ? false : true;\n                        }\n                        else {\n                            isValid = true;\n                        }\n                    }\n                    else if (value1.toUpperCase() === 'TRUE') {\n                        isValid = true;\n                    }\n                    else {\n                        isValid = false;\n                    }\n                    if (!isValid && ignoreBlank && value1 === '') {\n                        isValid = true;\n                    }\n                }\n                else {\n                    if (type === 'Decimal' || type === 'Time') {\n                        value = parseFloat(value.toString());\n                        value1 = parseFloat(value1.toString());\n                        value2 = value2 ? parseFloat(value2.toString()) : null;\n                    }\n                    else {\n                        value = parseInt(value.toString(), 10);\n                        value1 = parseInt(value1.toString(), 10);\n                        value2 = value2 ? parseInt(value2.toString(), 10) : null;\n                    }\n                    switch (opt) {\n                        case 'EqualTo':\n                            isValid = value === value1;\n                            break;\n                        case 'NotEqualTo':\n                            isValid = value !== value1;\n                            break;\n                        case 'Between':\n                            isValid = value >= value1 && value <= value2;\n                            break;\n                        case 'NotBetween':\n                            isValid = !(value >= value1 && value <= value2);\n                            break;\n                        case 'GreaterThan':\n                            isValid = value > value1;\n                            break;\n                        case 'LessThan':\n                            isValid = value < value1;\n                            break;\n                        case 'GreaterThanOrEqualTo':\n                            isValid = value >= value1;\n                            break;\n                        case 'LessThanOrEqualTo':\n                            isValid = value <= value1;\n                            break;\n                        default:\n                            break;\n                    }\n                }\n            }\n            return isValid;\n        }\n    };\n    DataValidation.prototype.parseValidationValue = function (val, numObj) {\n        if ((0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(val)) {\n            if (numObj && numObj.group === '.') {\n                val = val.toString();\n                if (val.indexOf('.') && (0,_workbook_common_internalization__WEBPACK_IMPORTED_MODULE_5__.parseThousandSeparator)(val, this.parent.locale, numObj.group, numObj.decimal)) {\n                    val = val.split(numObj.group).join('');\n                }\n            }\n            return val;\n        }\n        var formatArgs = { formattedText: val, value: val, format: 'General', cell: { value: val, format: 'General' },\n            isEdit: !!numObj };\n        this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getFormattedCellObject, formatArgs);\n        return formatArgs.value;\n    };\n    DataValidation.prototype.isValidCellHandler = function (args) {\n        var sheet = this.parent.sheets[args.sheetIdx];\n        var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getCell)(args.range[0], args.range[1], sheet);\n        var formulaArgs = { skip: false, value: '' };\n        var validation = cell && cell.validation;\n        if (validation) {\n            if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.checkIsFormula)(validation.value1) && !(0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.isCellReference)(validation.value1.substring(1, validation.value1.length)) &&\n                validation.value1.indexOf('(') > -1) {\n                var val = validation.value1;\n                val = val.substring(val.indexOf('=') + 1, val.indexOf('('));\n                formulaArgs.value = val.toUpperCase();\n                this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.formulaInValidation, formulaArgs);\n            }\n            if (!formulaArgs.skip && (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.checkIsFormula)(validation.value2) &&\n                !(0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.isCellReference)(validation.value2.substring(1, validation.value2.length)) && validation.value1.indexOf('(') > -1) {\n                var val2 = validation.value2;\n                val2 = val2.substring(val2.indexOf('=') + 1, val2.indexOf('('));\n                formulaArgs.value = val2.toUpperCase();\n                this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.formulaInValidation, formulaArgs);\n            }\n        }\n        if (!formulaArgs.skip) {\n            args.value = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.isNullOrUndefined)(args.value) ? '' : args.value;\n            if (validation) {\n                args.isValid = this.checkValidationHandler(args, validation);\n                if (args.isValid && (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.checkColumnValidation)(sheet.columns[args.range[1]], args.range[0], args.range[1])) {\n                    validation = sheet.columns[args.range[1]].validation;\n                    args.isValid = this.checkValidationHandler(args, validation);\n                }\n            }\n            else if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.checkColumnValidation)(sheet.columns[args.range[1]], args.range[0], args.range[1])) {\n                validation = sheet.columns[args.range[1]].validation;\n                args.isValid = this.checkValidationHandler(args, validation);\n            }\n            if (validation) {\n                var addInvalidHighlight = void 0;\n                if (args.isEdit && !args.isValid) {\n                    args.isValid = addInvalidHighlight = this.validationErrorHandler(this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_3__.locale).getConstant('ValidationError'));\n                }\n                if (args.isValid && validation.isHighlighted && !(0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.isHiddenRow)(sheet, args.range[0]) && !(0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.isHiddenCol)(sheet, args.range[1])) {\n                    this.updateHighlightHandler({\n                        rowIdx: args.range[0], colIdx: args.range[1],\n                        isRemoveHighlightedData: !addInvalidHighlight, isRemoveValidation: true\n                    });\n                }\n            }\n        }\n    };\n    DataValidation.prototype.formatValidation = function (value, type, isDialogValidator) {\n        var sheetPanel = this.parent.element.getElementsByClassName('e-sheet-panel')[0];\n        var errorMsg;\n        var formEle = this.parent.createElement('form', { id: 'formId', className: 'form-horizontal' });\n        var inputEle = this.parent.createElement('input', { id: 'e-validation' });\n        inputEle.setAttribute('name', 'validation');\n        inputEle.setAttribute('type', 'text');\n        if (type === 'Date' && (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(value)) {\n            var valArr = value.toString().split('.');\n            if (valArr.length === 2) {\n                value = valArr[0];\n            }\n        }\n        inputEle.setAttribute('value', value);\n        formEle.appendChild(inputEle);\n        sheetPanel.appendChild(formEle);\n        var options;\n        switch (type) {\n            case 'Date':\n                options = {\n                    rules: {\n                        'validation': { date: true }\n                    },\n                    customPlacement: function (inputElement, error) {\n                        errorMsg = error.innerText;\n                    }\n                };\n                break;\n            case 'Decimal':\n                options = {\n                    rules: {\n                        'validation': { number: true }\n                    },\n                    customPlacement: function (inputElement, error) {\n                        errorMsg = error.innerText;\n                    }\n                };\n                break;\n            case 'WholeNumber':\n                options = {\n                    rules: {\n                        'validation': { regex: /^-?\\d*\\.?[0]*$/ }\n                    },\n                    customPlacement: function (inputElement, error) {\n                        errorMsg = error.innerText;\n                    }\n                };\n                break;\n            case 'TextLength':\n                if (isDialogValidator) {\n                    options = {\n                        rules: {\n                            'validation': { regex: /^\\d*\\.?[0]*$/ }\n                        },\n                        customPlacement: function (inputElement, error) {\n                            errorMsg = error.innerText;\n                        }\n                    };\n                }\n                break;\n            default:\n                break;\n        }\n        this.formObj = new _syncfusion_ej2_inputs__WEBPACK_IMPORTED_MODULE_6__.FormValidator('#formId', options);\n        var isValid = this.formObj.validate();\n        sheetPanel.removeChild(sheetPanel.getElementsByClassName('form-horizontal')[0]);\n        return { isValid: isValid, errorMsg: errorMsg };\n    };\n    DataValidation.prototype.updateHighlightHandler = function (args) {\n        var isValid;\n        if (!args.isRemoveValidation) {\n            var cellValue = args.cell.value || args.cell.value === 0 ? args.cell.value : args.cell.hyperlink ?\n                (typeof args.cell.hyperlink === 'string' ? args.cell.hyperlink : (args.cell.hyperlink.address || '')) : '';\n            var validEventArgs = {\n                value: cellValue, range: [args.rowIdx, args.colIdx], sheetIdx: this.parent.activeSheetIndex\n            };\n            isValid = this.checkValidationHandler(validEventArgs, args.validation);\n            if (isValid && args.col && (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.checkColumnValidation)(args.col, args.rowIdx, args.colIdx)) {\n                validEventArgs.value = cellValue;\n                isValid = this.checkValidationHandler(validEventArgs, args.col.validation);\n            }\n        }\n        if (isValid) {\n            if (args.removeOnValidData) {\n                var cellEle = this.parent.getCell(args.rowIdx, args.colIdx);\n                if (cellEle && cellEle.style.backgroundColor) {\n                    args.td = cellEle;\n                    args.style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [args.rowIdx, args.colIdx]);\n                    this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.applyCellFormat, args);\n                    args.td = null;\n                }\n            }\n        }\n        else {\n            if (args.isRemoveHighlightedData) {\n                args.style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [args.rowIdx, args.colIdx]);\n                this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.applyCellFormat, args);\n            }\n            else {\n                args.style = { backgroundColor: '#ffff00', color: '#ff0000' };\n                this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.applyCellFormat, args);\n            }\n        }\n    };\n    DataValidation.prototype.validationErrorHandler = function (error) {\n        var _this = this;\n        var el = this.parent.element.getElementsByClassName('e-spreadsheet-edit')[0];\n        var l10n = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_3__.locale);\n        var cancel = false;\n        if (!this.parent.element.querySelector('.e-validation-error-dlg')) {\n            var erroDialogInst_1 = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_3__.dialog);\n            var disableCancel = false;\n            var dlgModel = {\n                width: 400, height: 200, isModal: true, showCloseIcon: true, cssClass: 'e-validation-error-dlg',\n                target: document.getElementById(this.parent.element.id) || this.parent.element,\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'ValidationErrorDialog',\n                        element: args.element, target: args.target, cancel: args.cancel, content: error\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                        cancel = true;\n                    }\n                    el.focus();\n                    erroDialogInst_1.dialogInstance.content = dlgArgs.content;\n                    erroDialogInst_1.dialogInstance.dataBind();\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('Retry'), isPrimary: true\n                        },\n                        click: function () {\n                            _this.errorDlgHandler(erroDialogInst_1, 'Retry');\n                        }\n                    },\n                    {\n                        buttonModel: {\n                            content: l10n.getConstant('Cancel')\n                        },\n                        click: function () {\n                            _this.errorDlgHandler(erroDialogInst_1, 'Cancel');\n                        }\n                    }]\n            };\n            erroDialogInst_1.show(dlgModel, disableCancel);\n        }\n        return cancel;\n    };\n    DataValidation.prototype.errorDlgHandler = function (errorDialogInst, buttonName) {\n        if (buttonName === 'Retry') {\n            var el = this.parent.element.getElementsByClassName('e-spreadsheet-edit')[0];\n            errorDialogInst.hide();\n            if (el.innerText) {\n                window.getSelection().selectAllChildren(el);\n                if (this.listObj && !this.listObj.isDestroyed) {\n                    this.listObj.showPopup();\n                }\n            }\n        }\n        else {\n            var indexes = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(this.parent.getActiveSheet().activeCell);\n            var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getCell)(indexes[0], indexes[1], this.parent.getActiveSheet());\n            var value = cell ? this.parent.getDisplayText(cell) : '';\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_3__.editOperation, {\n                action: 'cancelEdit', value: value, refreshFormulaBar: true,\n                refreshEditorElem: true, isAppend: false, trigEvent: true\n            });\n            errorDialogInst.hide();\n        }\n    };\n    /**\n     * Gets the module name.\n     *\n     * @returns {string} - Gets the module name.\n     */\n    DataValidation.prototype.getModuleName = function () {\n        return 'dataValidation';\n    };\n    return DataValidation;\n}());\n\n\n\n//# sourceURL=webpack://ej2-vue-samples/./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/actions/data-validation.js?");

/***/ })

}]);