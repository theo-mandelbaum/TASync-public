"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkej2_vue_samples"] = self["webpackChunkej2_vue_samples"] || []).push([["chunk-vendors-node_modules_syncfusion_ej2-spreadsheet_src_spreadsheet_integrations_sheet-tabs_js-3a0-55597114"],{

/***/ "./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/integrations/sheet-tabs.js":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/integrations/sheet-tabs.js ***!
  \*********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SheetTabs: () => (/* binding */ SheetTabs)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_navigations__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-navigations */ \"./node_modules/@syncfusion/ej2-navigations/index.js\");\n/* harmony import */ var _common_index__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/index */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/common/index.js\");\n/* harmony import */ var _workbook_index__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../workbook/index */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/workbook/index.js\");\n/* harmony import */ var _syncfusion_ej2_splitbuttons__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @syncfusion/ej2-splitbuttons */ \"./node_modules/@syncfusion/ej2-splitbuttons/index.js\");\n/* harmony import */ var _syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @syncfusion/ej2-popups */ \"./node_modules/@syncfusion/ej2-popups/index.js\");\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"./node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _workbook_common_index__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./../../workbook/common/index */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/workbook/common/index.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * Represents SheetTabs for Spreadsheet.\n */\nvar SheetTabs = /** @class */ (function () {\n    function SheetTabs(parent) {\n        this.aggregateContent = '';\n        this.selaggregateCnt = 'Sum';\n        this.parent = parent;\n        this.addEventListener();\n    }\n    SheetTabs.prototype.getModuleName = function () {\n        return 'sheetTabs';\n    };\n    SheetTabs.prototype.createSheetTabs = function () {\n        var _this = this;\n        if (!this.parent.showSheetTabs && this.tabInstance) {\n            this.destroy();\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_1__.locale);\n        var panel = this.parent.createElement('div', {\n            className: 'e-sheet-tab-panel', id: this.parent.element.id + '_sheet_tab_panel'\n        });\n        var addBtn = this.parent.createElement('button', {\n            className: 'e-add-sheet-tab e-btn e-css e-flat e-icon-btn' + (this.parent.allowInsert ? '' : ' e-disabled'),\n            attrs: { 'title': l10n.getConstant('AddSheet'), 'type': 'button' }\n        });\n        addBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons e-add-icon' }));\n        addBtn.addEventListener('click', this.addSheetTab.bind(this));\n        addBtn.disabled = !this.parent.allowInsert;\n        panel.appendChild(addBtn);\n        this.addBtnRipple = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.rippleEffect)(panel, { selector: '.e-add-sheet-tab' });\n        var ddb = this.parent.createElement('button', { attrs: { 'title': l10n.getConstant('ListAllSheets'), 'type': 'button' } });\n        panel.appendChild(ddb);\n        this.parent.element.appendChild(panel);\n        var items = this.getSheetTabItems();\n        this.dropDownInstance = new _syncfusion_ej2_splitbuttons__WEBPACK_IMPORTED_MODULE_3__.DropDownButton({\n            iconCss: 'e-icons',\n            items: items.ddbItems,\n            createPopupOnClick: true,\n            beforeItemRender: function (args) {\n                var sheet = _this.parent.sheets[_this.dropDownInstance.items.indexOf(args.item)];\n                if (sheet.state === 'Hidden') {\n                    args.element.classList.add('e-hide');\n                }\n                else if (sheet.state === 'VeryHidden') {\n                    args.element.style.display = 'none';\n                }\n            },\n            select: function (args) { return _this.updateSheetTab({ idx: _this.dropDownInstance.items.indexOf(args.item) }); },\n            beforeOpen: function (args) { return _this.beforeOpenHandler(_this.dropDownInstance, args.element, l10n.getConstant('ListAllSheets')); },\n            open: function (args) { return _this.openHandler(_this.dropDownInstance, args.element, 'left'); },\n            cssClass: 'e-sheets-list e-flat e-caret-hide',\n            close: function () { return _this.focusTab(_this.tabInstance.element); }\n        });\n        this.dropDownInstance.createElement = this.parent.createElement;\n        this.dropDownInstance.appendTo(ddb);\n        var sheetTab = this.parent.createElement('div', { className: 'e-sheet-tab' });\n        var cancelSelect;\n        this.tabInstance = new _syncfusion_ej2_navigations__WEBPACK_IMPORTED_MODULE_0__.Tab({\n            selectedItem: this.parent.activeSheetIndex,\n            overflowMode: 'Scrollable',\n            items: items.tabItems,\n            scrollStep: 250,\n            selecting: function (args) {\n                if (args.selectingIndex === args.selectedIndex) {\n                    return;\n                }\n                if (cancelSelect) {\n                    cancelSelect = false;\n                }\n                else {\n                    var beginEventArgs = { currentSheetIndex: args.selectingIndex, previousSheetIndex: args.selectedIndex, cancel: false };\n                    _this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.beginAction, { eventArgs: beginEventArgs, action: 'gotoSheet' });\n                    cancelSelect = beginEventArgs.cancel;\n                }\n            },\n            selected: function (args) {\n                if (!args.isInteracted) {\n                    args.preventFocus = true;\n                }\n                _this.goToSheet(args, cancelSelect, true);\n            },\n            created: function () {\n                var tBarItems = _this.tabInstance.element.querySelector('.e-toolbar-items');\n                tBarItems.classList.add('e-sheet-tabs-items');\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.EventHandler.add(tBarItems, 'dblclick', _this.renameSheetTab, _this);\n            }\n        });\n        panel.appendChild(sheetTab);\n        this.tabInstance.createElement = this.parent.createElement;\n        this.tabInstance.appendTo(sheetTab);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.EventHandler.remove(this.tabInstance.element, 'keydown', this.tabInstance.spaceKeyDown);\n        var sheetCount = items.tabItems.length;\n        var sheet;\n        for (var i = 0; i < sheetCount; i++) {\n            sheet = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getSheet)(this.parent, i);\n            var arg = { action: 'addSheet', sheetName: 'Sheet' + sheet.id, sheetId: sheet.id, visibleName: sheet.name };\n            this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_6__.workbookFormulaOperation, arg);\n        }\n        this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_6__.workbookFormulaOperation, { action: 'initiateDefinedNames' });\n        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_1__.protectSheet, null);\n    };\n    SheetTabs.prototype.goToSheet = function (args, cancelSelect, triggerEvent) {\n        var _this = this;\n        if (args.selectedIndex === args.previousIndex) {\n            return;\n        }\n        if (cancelSelect) {\n            this.tabInstance.selectedItem = args.previousIndex;\n            this.tabInstance.dataBind();\n            (0,_common_index__WEBPACK_IMPORTED_MODULE_1__.focus)(this.parent.element);\n            return;\n        }\n        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_1__.removeDesignChart, {});\n        if (this.parent.isEdit) {\n            var selection = window.getSelection();\n            var editArgs = { action: 'getCurrentEditValue', editedValue: '' };\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_1__.editOperation, editArgs);\n            var formula = editArgs.editedValue ? (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_6__.checkIsFormula)(editArgs.editedValue, true) : false;\n            if (!formula && selection && selection.focusNode && selection.focusNode.classList &&\n                selection.focusNode.classList.contains('e-formula-bar-panel')) {\n                formula = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_6__.checkIsFormula)(this.parent.element.querySelector('.e-formula-bar').value, true);\n            }\n            if (!formula) {\n                this.parent.endEdit();\n            }\n        }\n        this.parent.activeSheetIndex = args.selectedIndex;\n        this.parent.dataBind();\n        this.updateDropDownItems(args.selectedIndex, args.previousIndex);\n        var eventArgs = {\n            action: 'registerGridInCalc',\n            sheetID: (args.selectedIndex + 1).toString()\n        };\n        this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_6__.workbookFormulaOperation, eventArgs);\n        if (triggerEvent) {\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_1__.completeAction, {\n                eventArgs: { previousSheetIndex: args.previousIndex, currentSheetIndex: args.selectedIndex }, action: 'gotoSheet'\n            });\n            (0,_common_index__WEBPACK_IMPORTED_MODULE_1__.getUpdateUsingRaf)(function () { return (0,_common_index__WEBPACK_IMPORTED_MODULE_1__.focus)(_this.parent.element); });\n        }\n    };\n    SheetTabs.prototype.updateDropDownItems = function (curIdx, prevIdx) {\n        if (prevIdx > -1) {\n            this.dropDownInstance.items[prevIdx].iconCss = '';\n        }\n        this.dropDownInstance.items[curIdx].iconCss = 'e-selected-icon e-icons';\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n    };\n    SheetTabs.prototype.beforeOpenHandler = function (instance, element, localeText) {\n        var viewportHeight = this.parent.viewport.height;\n        var actualHeight = (parseInt(getComputedStyle(element.firstElementChild).height, 10) *\n            instance.items.length) + (parseInt(getComputedStyle(element).paddingTop, 10) * 2);\n        if (actualHeight > viewportHeight) {\n            element.style.height = viewportHeight + \"px\";\n            element.style.overflowY = 'auto';\n        }\n        element.parentElement.style.visibility = 'hidden';\n        if (localeText) {\n            element.setAttribute('aria-label', localeText);\n        }\n    };\n    SheetTabs.prototype.openHandler = function (instance, element, positionX) {\n        var wrapper = element.parentElement;\n        var height;\n        var collide = (0,_syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_4__.isCollide)(wrapper);\n        if (collide.indexOf('bottom') === -1) {\n            height = element.style.overflowY === 'auto' ? this.parent.viewport.height : wrapper.getBoundingClientRect().height;\n            var offset = (0,_syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_4__.calculatePosition)(instance.element, positionX, 'top');\n            if (positionX === 'right') {\n                offset.left -= wrapper.getBoundingClientRect().width;\n            }\n            wrapper.style.left = offset.left + \"px\";\n            wrapper.style.top = offset.top - height + \"px\";\n        }\n        wrapper.style.visibility = '';\n        (0,_common_index__WEBPACK_IMPORTED_MODULE_1__.focus)(element);\n    };\n    SheetTabs.prototype.getSheetTabItems = function () {\n        var _this = this;\n        var tabItems = [];\n        var ddbItems = [];\n        var sheetName;\n        this.parent.sheets.forEach(function (sheet, index) {\n            sheetName = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getSheetName)(_this.parent, index).replace(/</g, '&lt;').replace(/>/g, '&gt;');\n            tabItems.push({ header: { 'text': sheetName }, visible: sheet.state === 'Visible' });\n            ddbItems.push({ text: sheetName, iconCss: index === _this.parent.activeSheetIndex ? 'e-selected-icon e-icons' : '' });\n        });\n        return { tabItems: tabItems, ddbItems: ddbItems };\n    };\n    SheetTabs.prototype.refreshSheetTab = function () {\n        var items = this.getSheetTabItems();\n        this.dropDownInstance.items = items.ddbItems;\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        this.tabInstance.items = items.tabItems;\n        this.tabInstance.selectedItem = this.parent.activeSheetIndex;\n        this.tabInstance.dataBind();\n    };\n    SheetTabs.prototype.addSheetTab = function () {\n        this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_6__.insertModel, { model: this.parent, start: this.parent.activeSheetIndex + 1, end: this.parent.activeSheetIndex + 1, modelType: 'Sheet', isAction: true, activeSheetIndex: this.parent.activeSheetIndex + 1 });\n    };\n    SheetTabs.prototype.insertSheetTab = function (args) {\n        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_1__.removeDesignChart, {});\n        if (!args.preventUpdate || args.startIdx === this.tabInstance.selectedItem) {\n            this.dropDownInstance.items[this.tabInstance.selectedItem].iconCss = '';\n        }\n        for (var i = args.startIdx; i <= args.endIdx; i++) {\n            var sheetName = this.parent.sheets[i].name.replace(/</g, '&lt;').replace(/>/g, '&gt;');\n            this.dropDownInstance.items.splice(i, 0, { text: sheetName });\n            this.tabInstance.addTab([{ header: { text: sheetName }, content: '' }], i);\n        }\n        if (!args.preventUpdate || args.startIdx === this.tabInstance.selectedItem) {\n            this.dropDownInstance.items[args.startIdx].iconCss = 'e-selected-icon e-icons';\n        }\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        if (args.preventUpdate) {\n            if (args.startIdx !== this.tabInstance.selectedItem) {\n                this.refreshSheetTab();\n            }\n            else {\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_1__.protectSheet, null);\n            }\n        }\n        else {\n            this.updateSheetTab({ idx: args.startIdx, preventDataBind: true });\n        }\n    };\n    SheetTabs.prototype.updateSheetTab = function (args) {\n        if (args.name === 'activeSheetChanged') {\n            args.idx = this.parent.skipHiddenSheets(args.idx);\n        }\n        else {\n            if (this.parent.sheets[args.idx].state === 'Hidden') {\n                if (this.parent.isProtected) {\n                    return;\n                }\n                this.showSheet({ sheetIndex: args.idx, triggerEvent: true });\n            }\n        }\n        this.tabInstance.selectedItem = args.idx;\n        if (!args.preventDataBind) {\n            this.tabInstance.dataBind();\n        }\n        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_1__.protectSheet, null);\n    };\n    SheetTabs.prototype.showSheet = function (args) {\n        this.parent.setSheetPropertyOnMute(this.parent.sheets[args.sheetIndex], 'state', 'Visible');\n        this.tabInstance.hideTab(args.sheetIndex, false);\n        if (args.triggerEvent) {\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_1__.completeAction, { action: 'showSheet', eventArgs: { sheetIndex: args.sheetIndex } });\n        }\n    };\n    SheetTabs.prototype.switchSheetTab = function (args) {\n        var target = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.closest)(args.event.target, '.e-toolbar-item');\n        if (!target) {\n            return;\n        }\n        var name = target.querySelector('.e-tab-text').textContent;\n        var disableItems = [];\n        var id = this.parent.element.id + \"_cmenu\";\n        for (var i = 0, len = this.parent.sheets.length; i < len; i++) {\n            if (this.parent.sheets[i].name === name) {\n                if (this.parent.activeSheetIndex !== i) {\n                    this.updateSheetTab({ idx: i });\n                }\n                break;\n            }\n        }\n        if (args.element.classList.contains('e-contextmenu') && args.items[0] &&\n            args.items[0].id === this.parent.element.id + \"_cmenu_insert_sheet\") {\n            if (this.skipHiddenSheets() === 1) {\n                //let id: string = `${this.parent.element.id}_cmenu`;\n                //this.parent.enableFileMenuItems([`${id}_hide_sheet`, `${id}_delete_sheet`], false, true);\n                disableItems.push(id + \"_hide_sheet\", id + \"_delete_sheet\");\n            }\n            if (!this.parent.allowInsert || this.parent.isProtected) {\n                disableItems.push(id + \"_insert_sheet\");\n            }\n            if (!this.parent.allowDelete && disableItems.indexOf(id + \"_delete_sheet\") > -1) {\n                disableItems.push(id + \"_delete_sheet\");\n            }\n        }\n        if (this.parent.password.length > 0 || this.parent.isProtected) {\n            if (disableItems.indexOf(id + \"_insert_sheet\") > -1) {\n                disableItems.push(id + \"_insert_sheet\");\n            }\n            if (disableItems.indexOf(id + \"_delete_sheet\") > -1) {\n                disableItems.push(id + \"_delete_sheet\");\n            }\n            disableItems.push(id + \"_duplicate\", id + \"_rename\", id + \"_hide_sheet\", id + \"_delete_sheet\", id + \"_insert_sheet\", id + \"_move_left\", id + \"_move_right\");\n        }\n        this.parent.enableContextMenuItems(disableItems, false, true);\n    };\n    SheetTabs.prototype.skipHiddenSheets = function () {\n        var count = this.parent.sheets.length;\n        this.parent.sheets.forEach(function (sheet) {\n            if (sheet.state !== 'Visible') {\n                --count;\n            }\n        });\n        return count;\n    };\n    SheetTabs.prototype.renameSheetTab = function () {\n        var target = this.tabInstance.element.querySelector('.e-toolbar-item.e-active');\n        if (target) {\n            target = target.querySelector('.e-text-wrap');\n            var value = target.querySelector('.e-tab-text').textContent;\n            var args = {\n                eventArgs: {\n                    name: value, index: this.parent.getActiveSheet().id\n                },\n                action: 'renameSheet', cancel: false\n            };\n            this.parent.trigger('actionBegin', args);\n            if (args.cancel || this.parent.isProtected) {\n                return;\n            }\n            var input = this.parent.createElement('input', {\n                id: this.parent.element.id + '_rename_input',\n                className: 'e-input e-sheet-rename', styles: \"width: \" + target.getBoundingClientRect().width + \"px\", attrs: {\n                    'type': 'text', 'name': 'Rename', 'required': '', 'value': value, 'spellcheck': 'false', 'maxlength': '31'\n                }\n            });\n            target.firstElementChild.style.display = 'none';\n            target.appendChild(input);\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.EventHandler.add(document, 'mousedown touchstart', this.renameInputFocusOut, this);\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.EventHandler.add(input, 'keydown', this.renameKeyDown, this);\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.EventHandler.add(input, 'input', this.updateWidth, this);\n            input.focus();\n            input.setSelectionRange(0, value.length);\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.EventHandler.remove((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.closest)(target, '.e-toolbar-items'), 'dblclick', this.renameSheetTab);\n        }\n    };\n    SheetTabs.prototype.updateWidth = function (e) {\n        var target = e.target;\n        var len = target.value.length;\n        var value = target.value.split(' ');\n        if (value.length) {\n            var spaceLen = value.length - 1;\n            len -= spaceLen;\n            len += (spaceLen * 0.5);\n        }\n        target.style.width = len + \"ch\";\n    };\n    SheetTabs.prototype.renameKeyDown = function (e) {\n        if (e.keyCode === 32) {\n            e.stopPropagation();\n        }\n        else if (e.keyCode === 27) {\n            this.removeRenameInput(e.target);\n            this.focusTab(this.tabInstance.element);\n        }\n        else if (e.keyCode === 13) {\n            this.renameInputFocusOut(e);\n        }\n    };\n    SheetTabs.prototype.renameInputFocusOut = function (e) {\n        var target = e.target;\n        if ((e.type === 'mousedown' || e.type === 'touchstart') && (target.classList.contains('e-sheet-rename') ||\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.closest)(target, '.e-dlg-container'))) {\n            return;\n        }\n        target = document.getElementById(this.parent.element.id + '_rename_input');\n        var value = target.value;\n        var l10n = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_1__.locale);\n        if (value) {\n            var idx = this.tabInstance.selectedItem;\n            // eslint-disable-next-line no-useless-escape\n            if (!value.match(new RegExp('.*[\\\\[\\\\]\\\\*\\\\\\\\\\/\\\\?].*'))) {\n                if (this.parent.sheets[idx].name !== value) {\n                    for (var i = 0, len = this.parent.sheets.length; i < len; i++) {\n                        if (i !== this.parent.activeSheetIndex && this.parent.sheets[i].name.toLowerCase() ===\n                            value.toLowerCase()) {\n                            this.showRenameDialog(target, l10n.getConstant('SheetRenameAlreadyExistsAlert'));\n                            return;\n                        }\n                    }\n                }\n                var items = this.removeRenameInput(target);\n                if (this.parent.sheets[idx].name !== value) {\n                    this.parent.setSheetPropertyOnMute(this.parent.sheets[idx], 'name', value);\n                    this.updateSheetName({ value: value, idx: idx, items: items });\n                }\n                if (e.type === 'keydown') {\n                    this.focusTab(items);\n                }\n                else if (((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.closest)(e.target, '.e-spreadsheet'))) {\n                    (0,_common_index__WEBPACK_IMPORTED_MODULE_1__.focus)(this.parent.element);\n                }\n            }\n            else {\n                this.showRenameDialog(target, l10n.getConstant('SheetRenameInvalidAlert'));\n            }\n        }\n        else {\n            this.showRenameDialog(target, l10n.getConstant('SheetRenameEmptyAlert'));\n        }\n        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_1__.completeAction, { eventArgs: { index: this.parent.getActiveSheet().id, value: value }, action: 'renameSheet' });\n    };\n    SheetTabs.prototype.focusTab = function (context) {\n        (0,_common_index__WEBPACK_IMPORTED_MODULE_1__.focus)((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.select)('.e-toolbar-item.e-active .e-tab-wrap', context));\n    };\n    SheetTabs.prototype.updateSheetName = function (args) {\n        var pName = this.tabInstance.items[args.idx].header.text.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n        var name = args.value.replace(/</g, '&lt;').replace(/>/g, '&gt;');\n        this.tabInstance.items[args.idx].header.text = name;\n        this.dropDownInstance.items[args.idx].text = name;\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        var sheetTabText = args.items.querySelectorAll('.e-toolbar-item')[args.idx].querySelector('.e-tab-text');\n        sheetTabText.textContent = '';\n        sheetTabText.appendChild(document.createTextNode(args.value));\n        if (args.value.indexOf('  ') > -1) {\n            this.tabInstance.setProperties({ 'items': this.tabInstance.items }, true);\n        }\n        else {\n            this.tabInstance.dataBind();\n        }\n        this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_6__.sheetRenameUpdate, { value: args.value, pName: pName });\n        if (this.parent.allowChart) {\n            var range_1 = [];\n            var lastIndex_1;\n            this.parent.chartColl.forEach(function (chart) {\n                if (chart.range.includes('!')) {\n                    lastIndex_1 = chart.range.lastIndexOf('!');\n                    range_1[0] = chart.range.substring(0, lastIndex_1);\n                    range_1[1] = chart.range.substring(lastIndex_1 + 1);\n                    if (range_1[0].toLowerCase() === pName.toLowerCase()) {\n                        range_1[0] = args.value;\n                        chart.range = range_1.join('!');\n                    }\n                }\n            });\n        }\n    };\n    SheetTabs.prototype.hideSheet = function (args) {\n        var actionArgs = {\n            action: 'hideSheet', eventArgs: { sheetIndex: args.sheetIndex, cancel: false }\n        };\n        if (args.triggerEvent) {\n            this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.beginAction, actionArgs);\n            if (actionArgs.eventArgs.cancel) {\n                return;\n            }\n        }\n        this.parent.setSheetPropertyOnMute((0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getSheet)(this.parent, args.sheetIndex), 'state', 'Hidden');\n        this.tabInstance.hideTab(args.sheetIndex);\n        if (args.triggerEvent) {\n            delete actionArgs.eventArgs.cancel;\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_1__.completeAction, actionArgs);\n        }\n    };\n    SheetTabs.prototype.removeRenameInput = function (target) {\n        var textEle = target.parentElement.querySelector('.e-tab-text');\n        var sheetItems = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.closest)(target, '.e-toolbar-items');\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.EventHandler.add(sheetItems, 'dblclick', this.renameSheetTab, this);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.EventHandler.remove(document, 'mousedown touchstart', this.renameInputFocusOut);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.EventHandler.remove(target, 'keydown', this.renameKeyDown);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.EventHandler.remove(target, 'input', this.updateWidth);\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.remove)(target);\n        textEle.style.display = '';\n        return sheetItems;\n    };\n    SheetTabs.prototype.showRenameDialog = function (target, content) {\n        var _this = this;\n        var dialogInst = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_1__.dialog);\n        var isCancelled;\n        dialogInst.show({\n            height: 180, width: 400, isModal: true, showCloseIcon: true,\n            content: content,\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'SheetRenameDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    isCancelled = args.preventFocus = args.cancel = true;\n                }\n                else {\n                    args.element.querySelector('.e-footer-content .e-primary').setAttribute('aria-label', content + \" \" + _this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_1__.locale).getConstant('Ok'));\n                    (0,_common_index__WEBPACK_IMPORTED_MODULE_1__.focus)(target);\n                }\n            },\n            close: function () {\n                if (isCancelled) {\n                    (0,_common_index__WEBPACK_IMPORTED_MODULE_1__.getUpdateUsingRaf)(function () {\n                        var curPosition = [target.selectionStart, target.selectionEnd];\n                        (0,_common_index__WEBPACK_IMPORTED_MODULE_1__.focus)(target);\n                        target.setSelectionRange(curPosition[0], curPosition[1]);\n                    });\n                }\n                else {\n                    target.setSelectionRange(0, target.value.length);\n                }\n            }\n        });\n    };\n    SheetTabs.prototype.focusRenameInput = function () {\n        var input = document.getElementById(this.parent.element.id + '_rename_input');\n        if (input) {\n            input.focus();\n        }\n    };\n    SheetTabs.prototype.removeSheetTab = function (args) {\n        var _this = this;\n        if (args.count && (args.count === this.parent.sheets.length)) {\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_1__.locale);\n        if (this.skipHiddenSheets() > 1) {\n            var sheet = args.sheetName ?\n                (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getSheet)(this.parent, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getSheetIndex)(this.parent, args.sheetName)) :\n                this.parent.getActiveSheet();\n            var sheetIndex_1 = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.isNullOrUndefined)(args.index) ? (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getSheetIndex)(this.parent, sheet.name) : args.index;\n            var eventArgs_1 = {\n                index: sheetIndex_1,\n                sheetCount: this.parent.sheets.length,\n                sheetName: sheet.name\n            };\n            var isDataAvail = sheet.rows && sheet.rows.length ?\n                (sheet.rows.length === 1 ? (sheet.rows[0].cells && sheet.rows[0].cells.length ? true : false) : true) : false;\n            if (isDataAvail) {\n                var dialogInst_1 = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_1__.dialog);\n                if (args.clicked) {\n                    this.forceDelete(sheetIndex_1);\n                }\n                else {\n                    dialogInst_1.show({\n                        height: 200, width: 400, isModal: true, showCloseIcon: true, cssClass: 'e-delete-sheet-dlg',\n                        content: l10n.getConstant('DeleteSheetAlert'),\n                        beforeOpen: function (args) {\n                            var dlgArgs = {\n                                dialogName: 'DeleteSheetDialog',\n                                element: args.element, target: args.target, cancel: args.cancel\n                            };\n                            _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                            if (dlgArgs.cancel) {\n                                args.cancel = true;\n                            }\n                            else {\n                                args.element.querySelector('.e-footer-content .e-primary').setAttribute('aria-label', l10n.getConstant('DeleteSheetAlert') + \" \" + l10n.getConstant('Ok'));\n                                (0,_common_index__WEBPACK_IMPORTED_MODULE_1__.focus)(_this.parent.element);\n                            }\n                        },\n                        buttons: [{\n                                buttonModel: { content: l10n.getConstant('Ok'), isPrimary: true },\n                                click: function () {\n                                    dialogInst_1.hide();\n                                    _this.forceDelete(sheetIndex_1);\n                                    _this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_1__.clearUndoRedoCollection, null);\n                                    if (args && !args.isAction) {\n                                        eventArgs_1.sheetCount = _this.parent.sheets.length;\n                                        _this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_1__.completeAction, { eventArgs: eventArgs_1, action: 'removeSheet' });\n                                    }\n                                }\n                            }]\n                    });\n                }\n            }\n            else {\n                this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_6__.refreshInsertDelete, { startIndex: sheetIndex_1, endIndex: sheetIndex_1, modelType: 'Sheet', isDelete: true });\n                this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_6__.workbookFormulaOperation, { action: 'deleteSheetTab', sheetId: (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getSheet)(this.parent, sheetIndex_1).id });\n                this.destroySheet(sheetIndex_1);\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_1__.clearUndoRedoCollection, null);\n                if (args && !args.isAction) {\n                    eventArgs_1.sheetCount = this.parent.sheets.length;\n                    this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_1__.completeAction, { eventArgs: eventArgs_1, action: 'removeSheet' });\n                }\n            }\n        }\n        else {\n            this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_1__.dialog).show({\n                height: 180, width: 400, isModal: true, showCloseIcon: true,\n                content: l10n.getConstant('DeleteSingleLastSheetAlert'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'DeleteSingleSheetDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                }\n            });\n        }\n    };\n    SheetTabs.prototype.forceDelete = function (sheetIndex) {\n        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_1__.removeDesignChart, {});\n        this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_6__.refreshInsertDelete, { startIndex: sheetIndex, endIndex: sheetIndex, modelType: 'Sheet', isDelete: true });\n        this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_6__.workbookFormulaOperation, { action: 'deleteSheetTab', sheetId: (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getSheet)(this.parent, sheetIndex).id });\n        this.destroySheet(sheetIndex);\n    };\n    SheetTabs.prototype.destroySheet = function (sheetIndex) {\n        var activeSheetIdx = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.isNullOrUndefined)(sheetIndex) ? this.parent.activeSheetIndex : sheetIndex;\n        this.parent.removeSheet(activeSheetIdx);\n        this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_6__.sheetsDestroyed, { sheetIndex: activeSheetIdx });\n        this.dropDownInstance.items.splice(activeSheetIdx, 1);\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        this.tabInstance.removeTab(activeSheetIdx);\n        var activeIndex = this.parent.skipHiddenSheets(this.tabInstance.selectedItem);\n        this.parent.activeSheetIndex = activeIndex;\n        this.parent.setProperties({ activeSheetIndex: activeIndex }, true);\n        this.parent.renderModule.refreshSheet();\n        this.tabInstance.selectedItem = activeIndex;\n        this.tabInstance.dataBind();\n        this.updateDropDownItems(activeIndex);\n        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_1__.protectSheet, null);\n    };\n    SheetTabs.prototype.showAggregate = function (args) {\n        var _this = this;\n        if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.isSingleCell)((0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getRangeIndexes)(this.parent.getActiveSheet().selectedRange)) || (args && args.remove)) {\n            this.removeAggregate();\n            return;\n        }\n        var eventArgs = { Count: 0, Sum: '0', Avg: '0', Min: '0', Max: '0', countOnly: true };\n        this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.aggregateComputation, eventArgs);\n        if (eventArgs.Count > 1) {\n            this.aggregateContent = eventArgs.countOnly ? 'Count' : this.selaggregateCnt;\n            if (eventArgs.countOnly) {\n                this.aggregateContent = 'Count';\n                delete eventArgs.Sum;\n                delete eventArgs.Avg;\n                delete eventArgs.Min;\n                delete eventArgs.Max;\n            }\n            var btnClass = eventArgs.countOnly ? 'e-aggregate-list e-flat e-aggregate-list-countonly e-caret-hide'\n                : 'e-aggregate-list e-flat';\n            delete eventArgs.countOnly;\n            var key = this.aggregateContent;\n            var content = key + \": \" + eventArgs[key.toString()];\n            if (!this.aggregateDropDown) {\n                var aggregateEle = this.parent.createElement('button', { id: this.parent.element.id + '_aggregate', attrs: { 'type': 'button' } });\n                document.getElementById(this.parent.element.id + \"_sheet_tab_panel\").appendChild(aggregateEle);\n                this.aggregateDropDown = new _syncfusion_ej2_splitbuttons__WEBPACK_IMPORTED_MODULE_3__.DropDownButton({\n                    content: content,\n                    items: this.getAggregateItems(eventArgs),\n                    createPopupOnClick: true,\n                    select: function (args) {\n                        _this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.aggregateComputation, eventArgs);\n                        _this.updateAggregateContent(args.item.text, { Count: eventArgs.Count, Sum: eventArgs.Sum, Avg: eventArgs.Avg, Min: eventArgs.Min,\n                            Max: eventArgs.Max }, true);\n                    },\n                    beforeOpen: function (args) {\n                        return _this.beforeOpenHandler(_this.aggregateDropDown, args.element);\n                    },\n                    open: function (args) { return _this.openHandler(_this.aggregateDropDown, args.element, 'right'); },\n                    close: function () { return (0,_common_index__WEBPACK_IMPORTED_MODULE_1__.focus)(_this.parent.element); },\n                    cssClass: btnClass\n                });\n                this.aggregateDropDown.createElement = this.parent.createElement;\n                this.aggregateDropDown.appendTo(aggregateEle);\n            }\n            else {\n                this.updateAggregateContent(content, eventArgs);\n            }\n        }\n        else {\n            this.removeAggregate();\n        }\n    };\n    SheetTabs.prototype.getAggregateItems = function (args) {\n        var _this = this;\n        var items = [];\n        var text;\n        var iconCss;\n        var argsKey;\n        Object.keys(args).forEach(function (key) {\n            argsKey = args[\"\" + key];\n            if (argsKey !== _workbook_index__WEBPACK_IMPORTED_MODULE_2__.aggregateComputation) {\n                text = key + \": \" + argsKey;\n                iconCss = key === _this.aggregateContent ? 'e-selected-icon e-icons' : '';\n                items.push({ text: text, iconCss: iconCss });\n            }\n        });\n        return items;\n    };\n    SheetTabs.prototype.updateAggregateContent = function (text, eventArgs, isSelect) {\n        this.aggregateContent = text.split(': ')[0];\n        if (isSelect) {\n            this.selaggregateCnt = text.split(': ')[0];\n        }\n        this.aggregateDropDown.content = text;\n        this.aggregateDropDown.dataBind();\n        this.aggregateDropDown.setProperties({ 'items': this.getAggregateItems(eventArgs) }, true);\n    };\n    SheetTabs.prototype.removeAggregate = function () {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.isNullOrUndefined)(this.aggregateDropDown)) {\n            this.aggregateDropDown.destroy();\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.remove)(this.aggregateDropDown.element);\n            this.aggregateDropDown = null;\n        }\n    };\n    SheetTabs.prototype.addEventListener = function () {\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_1__.sheetTabs, this.createSheetTabs, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_1__.refreshSheetTabs, this.refreshSheetTab, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_1__.insertSheetTab, this.insertSheetTab, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_1__.removeSheetTab, this.removeSheetTab, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_1__.renameSheetTab, this.renameSheetTab, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_1__.cMenuBeforeOpen, this.switchSheetTab, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_1__.activeSheetChanged, this.updateSheetTab, this);\n        this.parent.on(_workbook_common_index__WEBPACK_IMPORTED_MODULE_6__.activeCellChanged, this.removeAggregate, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_1__.focusRenameInput, this.focusRenameInput, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_1__.sheetNameUpdate, this.updateSheetName, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_1__.hideSheet, this.hideSheet, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_1__.showAggregate, this.showAggregate, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_1__.goToSheet, this.goToSheet, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_1__.showSheet, this.showSheet, this);\n    };\n    SheetTabs.prototype.destroy = function () {\n        this.removeEventListener();\n        if (this.dropDownInstance) {\n            this.dropDownInstance.destroy();\n        }\n        this.dropDownInstance = null;\n        if (this.tabInstance) {\n            this.tabInstance.destroy();\n        }\n        this.tabInstance = null;\n        this.removeAggregate();\n        this.aggregateContent = null;\n        if (this.addBtnRipple) {\n            this.addBtnRipple();\n        }\n        this.addBtnRipple = null;\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.EventHandler.remove(document, 'mousedown touchstart', this.renameInputFocusOut);\n        var ele = document.getElementById(this.parent.element.id + '_sheet_tab_panel');\n        if (ele) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_5__.remove)(ele);\n        }\n        if (this.selaggregateCnt) {\n            this.selaggregateCnt = null;\n        }\n        this.parent = null;\n    };\n    SheetTabs.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_1__.sheetTabs, this.createSheetTabs);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_1__.refreshSheetTabs, this.refreshSheetTab);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_1__.insertSheetTab, this.insertSheetTab);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_1__.removeSheetTab, this.removeSheetTab);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_1__.renameSheetTab, this.renameSheetTab);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_1__.cMenuBeforeOpen, this.switchSheetTab);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_1__.activeSheetChanged, this.updateSheetTab);\n            this.parent.off(_workbook_common_index__WEBPACK_IMPORTED_MODULE_6__.activeCellChanged, this.removeAggregate);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_1__.focusRenameInput, this.focusRenameInput);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_1__.sheetNameUpdate, this.updateSheetName);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_1__.hideSheet, this.hideSheet);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_1__.showAggregate, this.showAggregate);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_1__.goToSheet, this.goToSheet);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_1__.showSheet, this.showSheet);\n        }\n    };\n    return SheetTabs;\n}());\n\n\n\n//# sourceURL=webpack://ej2-vue-samples/./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/integrations/sheet-tabs.js?");

/***/ })

}]);