"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkej2_vue_samples"] = self["webpackChunkej2_vue_samples"] || []).push([["chunk-vendors-node_modules_syncfusion_ej2-spreadsheet_src_spreadsheet_integrations_filter_js-5934316-a872ed75"],{

/***/ "./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/integrations/filter.js":
/*!*****************************************************************************************!*\
  !*** ./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/integrations/filter.js ***!
  \*****************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Filter: () => (/* binding */ Filter)\n/* harmony export */ });\n/* harmony import */ var _index__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../spreadsheet/index */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/index.js\");\n/* harmony import */ var _workbook_index__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../workbook/index */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/workbook/index.js\");\n/* harmony import */ var _workbook_common_internalization__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../workbook/common/internalization */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/workbook/common/internalization.js\");\n/* harmony import */ var _workbook_common_event__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../workbook/common/event */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/workbook/common/event.js\");\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"./node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _common_index__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common/index */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/common/index.js\");\n/* harmony import */ var _syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @syncfusion/ej2-grids */ \"./node_modules/@syncfusion/ej2-grids/index.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"./node_modules/@syncfusion/ej2-data/index.js\");\n/* harmony import */ var _syncfusion_ej2_navigations__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @syncfusion/ej2-navigations */ \"./node_modules/@syncfusion/ej2-navigations/index.js\");\n/* harmony import */ var _syncfusion_ej2_inputs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @syncfusion/ej2-inputs */ \"./node_modules/@syncfusion/ej2-inputs/index.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * `Filter` module is used to handle the filter action in Spreadsheet.\n */\nvar Filter = /** @class */ (function () {\n    /**\n     * Constructor for filter module.\n     *\n     * @param {Spreadsheet} parent - Specifies the Spreadsheet.\n     */\n    function Filter(parent) {\n        this.parent = parent;\n        this.filterCollection = new Map();\n        this.filterRange = new Map();\n        this.filterBtn = parent.createElement('div', { className: 'e-filter-btn e-control e-btn e-lib e-filter-iconbtn e-icon-btn' });\n        this.filterBtn.appendChild(parent.createElement('span', { className: 'e-btn-icon e-icons e-filter-icon' }));\n        this.addEventListener();\n    }\n    /**\n     * To destroy the filter module.\n     *\n     * @returns {void} - To destroy the filter module.\n     */\n    Filter.prototype.destroy = function () {\n        var _this = this;\n        this.removeEventListener();\n        if (this.parent.refreshing && this.filterRange.size) {\n            this.parent.filterCollection = [];\n            this.filterRange.forEach(function (_value, sheetIdx) {\n                _this.setFilteredCollection({ sheetIdx: sheetIdx, saveJson: { filterCollection: _this.parent.filterCollection } });\n            });\n        }\n        this.filterRange = null;\n        this.filterCollection = null;\n        if (this.filterBtn) {\n            this.filterBtn.remove();\n        }\n        this.filterBtn = null;\n        if (this.treeViewObj) {\n            this.treeViewObj.destroy();\n        }\n        this.treeViewObj = null;\n        if (this.treeViewEle) {\n            this.treeViewEle.remove();\n        }\n        this.treeViewEle = null;\n        if (this.cBox) {\n            this.cBox.remove();\n            this.cBox = null;\n        }\n        var filterPopupElement = document.querySelectorAll('.e-filter-popup');\n        if (filterPopupElement) {\n            filterPopupElement.forEach(function (element) {\n                element.remove();\n            });\n        }\n        this.parent = null;\n    };\n    Filter.prototype.addEventListener = function () {\n        this.parent.on(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.filterRangeAlert, this.filterRangeAlertHandler, this);\n        this.parent.on(_index__WEBPACK_IMPORTED_MODULE_0__.initiateFilterUI, this.initiateFilterUIHandler, this);\n        this.parent.on(_index__WEBPACK_IMPORTED_MODULE_0__.mouseDown, this.filterMouseDownHandler, this);\n        this.parent.on(_index__WEBPACK_IMPORTED_MODULE_0__.renderFilterCell, this.renderFilterCellHandler, this);\n        this.parent.on(_index__WEBPACK_IMPORTED_MODULE_0__.refreshFilterRange, this.refreshFilterRange, this);\n        this.parent.on(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.updateSortCollection, this.updateSortCollectionHandler, this);\n        this.parent.on(_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.beforeFltrcMenuOpen, this.beforeFilterMenuOpenHandler, this);\n        this.parent.on(_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.filterCmenuSelect, this.closeDialog, this);\n        this.parent.on(_index__WEBPACK_IMPORTED_MODULE_0__.reapplyFilter, this.reapplyFilterHandler, this);\n        this.parent.on(_index__WEBPACK_IMPORTED_MODULE_0__.filterByCellValue, this.filterByCellValueHandler, this);\n        this.parent.on(_index__WEBPACK_IMPORTED_MODULE_0__.clearFilter, this.clearFilterHandler, this);\n        this.parent.on(_index__WEBPACK_IMPORTED_MODULE_0__.getFilteredColumn, this.getFilteredColumnHandler, this);\n        this.parent.on(_index__WEBPACK_IMPORTED_MODULE_0__.cMenuBeforeOpen, this.cMenuBeforeOpenHandler, this);\n        this.parent.on(_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.filterCboxValue, this.filterCboxValueHandler, this);\n        this.parent.on(_index__WEBPACK_IMPORTED_MODULE_0__.getFilterRange, this.getFilterRangeHandler, this);\n        this.parent.on(_index__WEBPACK_IMPORTED_MODULE_0__.filterCellKeyDown, this.filterCellKeyDownHandler, this);\n        this.parent.on(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.setFilteredCollection, this.setFilteredCollection, this);\n        this.parent.on(_index__WEBPACK_IMPORTED_MODULE_0__.contentLoaded, this.updateFilter, this);\n        this.parent.on(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.beforeInsert, this.beforeInsertHandler, this);\n        this.parent.on(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.beforeDelete, this.beforeDeleteHandler, this);\n        this.parent.on(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.sheetsDestroyed, this.deleteSheetHandler, this);\n        this.parent.on(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.clear, this.clearHandler, this);\n        this.parent.on(_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.filterDialogCreated, this.filterDialogCreatedHandler, this);\n        this.parent.on(_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.filterDialogClose, this.removeFilterClass, this);\n        this.parent.on(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.duplicateSheetFilterHandler, this.duplicateSheetFilterHandler, this);\n        this.parent.on(_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.fltrPrevent, this.beforeFilteringHandler, this);\n        this.parent.on(_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.beforeCustomFilterOpen, this.customFilterOpen, this);\n        this.parent.on(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.moveSheetHandler, this.moveSheetHandler, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_5__.refreshFilterCellsOnResize, this.refreshFilterCellsOnResize, this);\n    };\n    Filter.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.filterRangeAlert, this.filterRangeAlertHandler);\n            this.parent.off(_index__WEBPACK_IMPORTED_MODULE_0__.initiateFilterUI, this.initiateFilterUIHandler);\n            this.parent.off(_index__WEBPACK_IMPORTED_MODULE_0__.mouseDown, this.filterMouseDownHandler);\n            this.parent.off(_index__WEBPACK_IMPORTED_MODULE_0__.renderFilterCell, this.renderFilterCellHandler);\n            this.parent.off(_index__WEBPACK_IMPORTED_MODULE_0__.refreshFilterRange, this.refreshFilterRange);\n            this.parent.off(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.updateSortCollection, this.updateSortCollectionHandler);\n            this.parent.off(_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.beforeFltrcMenuOpen, this.beforeFilterMenuOpenHandler);\n            this.parent.off(_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.filterCmenuSelect, this.closeDialog);\n            this.parent.off(_index__WEBPACK_IMPORTED_MODULE_0__.reapplyFilter, this.reapplyFilterHandler);\n            this.parent.off(_index__WEBPACK_IMPORTED_MODULE_0__.filterByCellValue, this.filterByCellValueHandler);\n            this.parent.off(_index__WEBPACK_IMPORTED_MODULE_0__.clearFilter, this.clearFilterHandler);\n            this.parent.off(_index__WEBPACK_IMPORTED_MODULE_0__.getFilteredColumn, this.getFilteredColumnHandler);\n            this.parent.off(_index__WEBPACK_IMPORTED_MODULE_0__.cMenuBeforeOpen, this.cMenuBeforeOpenHandler);\n            this.parent.off(_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.filterCboxValue, this.filterCboxValueHandler);\n            this.parent.off(_index__WEBPACK_IMPORTED_MODULE_0__.getFilterRange, this.getFilterRangeHandler);\n            this.parent.off(_index__WEBPACK_IMPORTED_MODULE_0__.filterCellKeyDown, this.filterCellKeyDownHandler);\n            this.parent.off(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.setFilteredCollection, this.setFilteredCollection);\n            this.parent.off(_index__WEBPACK_IMPORTED_MODULE_0__.contentLoaded, this.updateFilter);\n            this.parent.off(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.beforeInsert, this.beforeInsertHandler);\n            this.parent.off(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.beforeDelete, this.beforeDeleteHandler);\n            this.parent.off(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.sheetsDestroyed, this.deleteSheetHandler);\n            this.parent.off(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.clear, this.clearHandler);\n            this.parent.off(_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.filterDialogCreated, this.filterDialogCreatedHandler);\n            this.parent.off(_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.filterDialogClose, this.removeFilterClass);\n            this.parent.off(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.duplicateSheetFilterHandler, this.duplicateSheetFilterHandler);\n            this.parent.off(_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.fltrPrevent, this.beforeFilteringHandler);\n            this.parent.off(_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.beforeCustomFilterOpen, this.customFilterOpen);\n            this.parent.off(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.moveSheetHandler, this.moveSheetHandler);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_5__.refreshFilterCellsOnResize, this.refreshFilterCellsOnResize);\n        }\n    };\n    /**\n     * Gets the module name.\n     *\n     * @returns {string} - Gets the module name.\n     */\n    Filter.prototype.getModuleName = function () {\n        return 'filter';\n    };\n    /**\n     * Validates the range and returns false when invalid.\n     *\n     * @param {SheetModel} sheet - Specify the sheet.\n     * @param {string} range - Specify the range.\n     * @returns {void} - Validates the range and returns false when invalid.\n     */\n    Filter.prototype.isInValidFilterRange = function (sheet, range) {\n        var selectedRange = range ? (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSwapRange)((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getIndexesFromAddress)(range)) :\n            (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSwapRange)((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getIndexesFromAddress)(sheet.selectedRange));\n        var isEmptySheet = false;\n        if (sheet.usedRange.colIndex === 0 && sheet.usedRange.rowIndex === 0 && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.isNullOrUndefined)(sheet.rows[sheet.usedRange.rowIndex])) {\n            isEmptySheet = true; // For Filtering Empty sheet's A1 cell.\n        }\n        return selectedRange[0] > sheet.usedRange.rowIndex || selectedRange[1] > sheet.usedRange.colIndex || isEmptySheet;\n    };\n    /**\n     * Shows the range error alert dialog.\n     *\n     * @param {any} args - Specifies the args\n     * @param {string} args.error - range error string.\n     * @returns {void} - Shows the range error alert dialog.\n     */\n    Filter.prototype.filterRangeAlertHandler = function (args) {\n        var _this = this;\n        var dialogInst = this.parent.serviceLocator.getService(_index__WEBPACK_IMPORTED_MODULE_0__.dialog);\n        dialogInst.show({\n            content: args.error, isModal: true,\n            height: 180, width: 400, showCloseIcon: true,\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'FilterRangeDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                else {\n                    (0,_index__WEBPACK_IMPORTED_MODULE_0__.focus)(_this.parent.element);\n                }\n            }\n        });\n        this.parent.hideSpinner();\n    };\n    /**\n     * Triggers before filter context menu opened and used to add sorting items.\n     *\n     * @param {any} args - Specifies the args\n     * @param {HTMLElement} args.element - Specify the element\n     * @returns {void} - Triggers before filter context menu opened and used to add sorting items.\n     */\n    Filter.prototype.beforeFilterMenuOpenHandler = function (args) {\n        var l10n = this.parent.serviceLocator.getService(_index__WEBPACK_IMPORTED_MODULE_0__.locale);\n        args.element.classList.add('e-spreadsheet-contextmenu'); // to show sort icons\n        var ul = args.element.querySelector('ul');\n        this.addMenuItem(ul, l10n.getConstant('SortDescending'), 'e-filter-sortdesc', 'e-sort-desc');\n        this.addMenuItem(ul, l10n.getConstant('SortAscending'), 'e-filter-sortasc', 'e-sort-asc');\n        args.element.appendChild(ul);\n    };\n    /**\n     * Creates new menu item element\n     *\n     * @param {Element} ul - Specify the element.\n     * @param {string} text - Specify the text.\n     * @param {string} className - Specify the className\n     * @param {string} iconCss - Specify the iconCss\n     * @returns {void} - Creates new menu item element\n     */\n    Filter.prototype.addMenuItem = function (ul, text, className, iconCss) {\n        var li = this.parent.createElement('li', { className: className + ' e-menu-item' });\n        if (!this.parent.allowSorting) {\n            li.classList.add('e-disabled');\n        }\n        li.innerText = text;\n        li.insertBefore(this.parent.createElement('span', { className: 'e-menu-icon e-icons ' + iconCss }), li.firstChild);\n        ul.insertBefore(li, ul.firstChild);\n    };\n    /**\n     * Initiates the filter UI for the selected range.\n     *\n     * @param {any} args - Specifies the args\n     * @param {PredicateModel[]} args.predicates - Specify the predicates.\n     * @param {number} args.range - Specify the range.\n     * @param {Promise<FilterEventArgs>} args.promise - Spefify the promise.\n     * @param {number} args.sIdx - Specify the sIdx\n     * @param {boolean} args.isCut - Specify the bool value\n     * @param {boolean} args.isUndoRedo - Specify the bool value\n     * @param {boolean} args.isInternal - Specify the isInternal.\n     * @param {boolean} args.useFilterRange - Specify the use Filter Range.\n     * @param {boolean} args.isOpen - Specify the isOpen.\n     * @param {boolean} args.allowHeaderFilter - Specify the allow header filter.\n     * @returns {void} - Initiates the filter UI for the selected range.\n     */\n    Filter.prototype.initiateFilterUIHandler = function (args) {\n        var _this = this;\n        var predicates = args ? args.predicates : null;\n        var sheetIdx = args.sIdx;\n        if (!sheetIdx && sheetIdx !== 0) {\n            sheetIdx = args.isOpen ? 0 : this.parent.activeSheetIndex;\n        }\n        var deferred;\n        if (args.promise) {\n            deferred = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Deferred();\n            args.promise = deferred.promise;\n        }\n        var resolveFn = function () {\n            if (deferred) {\n                deferred.resolve();\n            }\n        };\n        var isInternal = args.isInternal || args.isCut;\n        if (this.filterRange.size > 0 && this.filterRange.has(sheetIdx) && !this.parent.isOpen && !predicates) { //disable filter\n            this.removeFilter(sheetIdx, isInternal, false);\n            resolveFn();\n            return;\n        }\n        var sheet = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSheet)(this.parent, sheetIdx);\n        if (this.isInValidFilterRange(sheet, args.range)) {\n            var l10n = this.parent.serviceLocator.getService(_index__WEBPACK_IMPORTED_MODULE_0__.locale);\n            this.filterRangeAlertHandler({ error: l10n.getConstant('FilterOutOfRangeError') });\n            resolveFn();\n            return;\n        }\n        var selectedRange = args.range || sheet.selectedRange;\n        var eventArgs;\n        var actionArgs;\n        if (!isInternal) {\n            eventArgs = { range: selectedRange, sheetIndex: sheetIdx, cancel: false, allowHeaderFilter: false };\n            if (args.predicates) {\n                eventArgs.predicates = args.predicates;\n                eventArgs.previousPredicates = this.filterCollection.get(sheetIdx) && [].slice.call(this.filterCollection.get(sheetIdx));\n            }\n            else {\n                eventArgs.filterOptions = { predicates: args.predicates };\n            }\n            eventArgs.useFilterRange = false;\n            actionArgs = { action: 'filter', eventArgs: eventArgs };\n            this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.beginAction, actionArgs);\n            if (eventArgs.cancel) {\n                resolveFn();\n                return;\n            }\n            delete eventArgs.cancel;\n            args.useFilterRange = eventArgs.useFilterRange;\n            args.allowHeaderFilter = eventArgs.allowHeaderFilter;\n        }\n        if (!args.range && (isInternal || selectedRange === eventArgs.range)) {\n            var rangeIdx = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(selectedRange);\n            if (rangeIdx[0] === rangeIdx[2] && rangeIdx[1] === rangeIdx[3]) {\n                rangeIdx = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getDataRange)(rangeIdx[0], rangeIdx[1], sheet);\n                selectedRange = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(rangeIdx);\n                if (!isInternal) {\n                    eventArgs.range = selectedRange;\n                }\n            }\n        }\n        else if (!isInternal) {\n            selectedRange = eventArgs.range;\n        }\n        if (predicates) {\n            if (predicates.length) {\n                var filterRange = this.filterRange.get(sheetIdx);\n                if (filterRange) {\n                    args.useFilterRange = filterRange.useFilterRange;\n                    args.allowHeaderFilter = filterRange.allowHeaderFilter;\n                }\n                this.processRange(sheet, sheetIdx, selectedRange, true, args.useFilterRange, args.allowHeaderFilter);\n                var range = this.filterRange.get(sheetIdx).range.slice();\n                if (!args.allowHeaderFilter) {\n                    range[0] = range[0] + 1; // to skip first row.\n                }\n                if (!args.useFilterRange) {\n                    range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n                }\n                range[1] = range[3] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColIndex)(predicates[0].field);\n                var addr = sheet.name + \"!\" + this.getPredicateRange(range, predicates.slice(1, predicates.length));\n                var fullAddr = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(range);\n                (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getData)(this.parent, addr, true, true, null, true, null, null, false, fullAddr).then(function (jsonData) {\n                    _this.filterSuccessHandler(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(jsonData), { action: 'filtering', filterCollection: predicates, field: predicates[0].field, sIdx: args.sIdx,\n                        isInternal: isInternal, isOpen: args.isOpen, prevPredicates: eventArgs && eventArgs.previousPredicates });\n                    resolveFn();\n                });\n                return;\n            }\n            else {\n                this.clearFilterHandler({ sheetIndex: sheetIdx });\n                resolveFn();\n            }\n        }\n        else {\n            this.processRange(sheet, sheetIdx, selectedRange, false, args.useFilterRange, args.allowHeaderFilter);\n            resolveFn();\n        }\n        if (!isInternal) {\n            this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_0__.completeAction, actionArgs);\n            (0,_index__WEBPACK_IMPORTED_MODULE_0__.focus)(this.parent.element);\n        }\n    };\n    /**\n     * Processes the range if no filter applied.\n     *\n     * @param {SheetModel} sheet - Specify the sheet.\n     * @param {number} sheetIdx - Specify the sheet index.\n     * @param {string} filterRange - Specify the filterRange.\n     * @param {boolean} preventRefresh - To prevent refreshing the filter buttons.\n     * @param {boolean} useFilterRange - Specifies whether to consider filtering range or used range during filering.\n     * @param {boolean} allowHeaderFilter - Specifies whether to consider first row during filtering.\n     * @returns {void} - Processes the range if no filter applied.\n     */\n    Filter.prototype.processRange = function (sheet, sheetIdx, filterRange, preventRefresh, useFilterRange, allowHeaderFilter) {\n        var range = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSwapRange)((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getIndexesFromAddress)(filterRange || sheet.selectedRange));\n        if (range[0] === range[2] && range[1] === range[3]) { //if selected range is a single cell\n            range[0] = 0;\n            range[1] = 0;\n            range[2] = sheet.usedRange.rowIndex;\n            range[3] = sheet.usedRange.colIndex;\n        }\n        else if (range[3] > sheet.usedRange.colIndex) {\n            range[3] = sheet.usedRange.colIndex;\n        }\n        var filterOption = { useFilterRange: useFilterRange,\n            range: range };\n        if (allowHeaderFilter) {\n            filterOption.allowHeaderFilter = allowHeaderFilter;\n        }\n        this.filterRange.set(sheetIdx, filterOption);\n        this.filterCollection.set(sheetIdx, []);\n        if (!preventRefresh) {\n            this.refreshFilterRange(range, false, sheetIdx);\n        }\n    };\n    /**\n     * Removes all the filter related collections for the active sheet.\n     *\n     * @param {number} sheetIdx - Specify the sheet index.\n     * @param {boolean} isCut - Specify the bool value.\n     * @param {boolean} preventRefresh - Specify the preventRefresh.\n     * @param {boolean} clearAction - Specify the current action is clear or not.\n     * @returns {void} - Removes all the filter related collections for the active sheet.\n     */\n    Filter.prototype.removeFilter = function (sheetIdx, isCut, preventRefresh, clearAction) {\n        var filterOption = this.filterRange.get(sheetIdx);\n        var range = filterOption.range.slice();\n        var allowHeaderFilter = filterOption.allowHeaderFilter;\n        var rangeAddr = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(range);\n        var args;\n        if (!isCut) {\n            args = { action: 'filter', eventArgs: { range: rangeAddr, sheetIndex: sheetIdx, cancel: false }, isClearAction: clearAction };\n            this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.beginAction, args);\n            if (args.eventArgs.cancel) {\n                return;\n            }\n            delete args.eventArgs.cancel;\n        }\n        if (this.filterCollection.get(sheetIdx).length || preventRefresh) {\n            if (this.filterCollection.get(sheetIdx).length && clearAction) {\n                var newArgs = {\n                    action: 'filter',\n                    eventArgs: {\n                        range: rangeAddr, sheetIndex: sheetIdx, predicates: [], previousPredicates: this.filterCollection.get(sheetIdx)\n                    }, isClearAction: clearAction\n                };\n                this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_0__.completeAction, newArgs);\n            }\n            this.clearFilterHandler({ preventRefresh: preventRefresh, sheetIndex: sheetIdx });\n        }\n        this.filterRange.delete(sheetIdx);\n        this.filterCollection.delete(sheetIdx);\n        this.refreshFilterRange(range, true, sheetIdx, allowHeaderFilter);\n        if (!isCut) {\n            this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_0__.completeAction, args);\n        }\n    };\n    /**\n     * Handles filtering cell value based on context menu.\n     *\n     * @returns {void} - Handles filtering cell value based on context menu.\n     */\n    Filter.prototype.filterByCellValueHandler = function () {\n        var _this = this;\n        var sheetIdx = this.parent.activeSheetIndex;\n        var sheet = this.parent.getActiveSheet();\n        if (this.isInValidFilterRange(sheet)) {\n            var l10n = this.parent.serviceLocator.getService(_index__WEBPACK_IMPORTED_MODULE_0__.locale);\n            this.filterRangeAlertHandler({ error: l10n.getConstant('FilterOutOfRangeError') });\n            return;\n        }\n        var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(sheet.activeCell);\n        var isNotFilterRange;\n        if (!this.isFilterRange(sheetIdx, cell[0], cell[1])) {\n            isNotFilterRange = true;\n            this.processRange(sheet, sheetIdx);\n        }\n        var filterOption = this.filterRange.get(sheetIdx);\n        var range = filterOption.range.slice();\n        var filterRange = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(range);\n        range[0] = range[0] + 1; // to skip first row.\n        range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n        range[1] = range[3] = cell[1];\n        var field = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColumnHeaderText)(cell[1] + 1);\n        var selectedCell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(cell[0], cell[1], sheet);\n        var cellVal = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getValueFromFormat)(this.parent, selectedCell, cell[0], cell[1]);\n        var predicates = [{ field: field, operator: 'equal', type: this.getColumnType(sheet, cell[1], cell).type,\n                matchCase: false, value: cellVal }];\n        var prevPredicates = [].slice.call(this.filterCollection.get(sheetIdx));\n        if (!prevPredicates.length) {\n            prevPredicates = undefined;\n        }\n        var eventArgs = { range: filterRange, predicates: predicates,\n            previousPredicates: prevPredicates, sheetIndex: sheetIdx, cancel: false, allowHeaderFilter: false };\n        this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.beginAction, { action: 'filter', eventArgs: eventArgs });\n        if (eventArgs.cancel) {\n            if (isNotFilterRange) {\n                this.removeFilter(sheetIdx, true);\n            }\n            return;\n        }\n        if (eventArgs.allowHeaderFilter) {\n            filterOption.allowHeaderFilter = eventArgs.allowHeaderFilter;\n            range[0]--;\n        }\n        var addr = sheet.name + \"!\" + this.getPredicateRange(range, this.filterCollection.get(sheetIdx));\n        var fullAddr = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(range);\n        (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getData)(this.parent, addr, true, true, null, true, null, null, false, fullAddr).then(function (jsonData) {\n            _this.filterSuccessHandler(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(jsonData), { action: 'filtering', filterCollection: predicates, field: field, isFilterByValue: true });\n        });\n    };\n    /**\n     * Creates filter buttons and renders the filter applied cells.\n     *\n     * @param { any} args - Specifies the args\n     * @param { HTMLElement} args.td - specify the element\n     * @param { number} args.rowIndex - specify the rowIndex\n     * @param { number} args.colIndex - specify the colIndex\n     * @param { number} args.sIdx - specify the sIdx\n     * @param { boolean} args.isAction - specify the apply filter action.\n     * @returns {void} - Creates filter buttons and renders the filter applied cells.\n     */\n    Filter.prototype.renderFilterCellHandler = function (args) {\n        var sheetIdx = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.isNullOrUndefined)(args.sIdx) ? args.sIdx : this.parent.activeSheetIndex;\n        if (sheetIdx === this.parent.activeSheetIndex) {\n            var option = this.filterRange.get(sheetIdx) &&\n                this.filterRange.get(sheetIdx);\n            var range = option && option.range;\n            if (range && (range[0] === args.rowIndex || option.allowHeaderFilter) && range[1] <= args.colIndex &&\n                range[3] >= args.colIndex) {\n                if (!args.td || args.td.classList.contains(option.allowHeaderFilter ? 'e-cell' : 'e-header-cell')) {\n                    return;\n                }\n                var filterButton = args.td.querySelector('.e-filter-icon');\n                var filterSortCls = '';\n                var sortCollection = this.parent.sortCollection;\n                var field = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColumnHeaderText)(args.colIndex + 1);\n                var predicates = this.filterCollection.get(sheetIdx);\n                for (var i = 0; i < predicates.length; i++) {\n                    if (predicates[i].field === field) {\n                        filterSortCls = ' e-filtered';\n                        break;\n                    }\n                }\n                if (sortCollection) {\n                    for (var i = 0; i < sortCollection.length; i++) {\n                        if (sortCollection[i].sheetIndex === sheetIdx &&\n                            sortCollection[i].columnIndex === args.colIndex) {\n                            filterSortCls += sortCollection[i].order === 'Ascending' ? ' e-sortasc-filter' : ' e-sortdesc-filter';\n                            break;\n                        }\n                    }\n                }\n                if (filterButton) {\n                    filterButton.className = \"e-btn-icon e-icons e-filter-icon\" + filterSortCls;\n                }\n                else {\n                    var isNoteAvailable = false;\n                    filterButton = this.filterBtn.cloneNode(true);\n                    if (args.td.children.length > 0 && args.td.children[args.td.childElementCount - 1].className.indexOf('e-addNoteIndicator') > -1) {\n                        args.td.removeChild(args.td.children[args.td.childElementCount - 1]);\n                        isNoteAvailable = true;\n                    }\n                    filterButton.firstElementChild.className = \"e-btn-icon e-icons e-filter-icon\" + filterSortCls;\n                    args.td.insertBefore(filterButton, args.td.firstChild);\n                    if (args.isAction) {\n                        var sheet = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSheet)(this.parent, sheetIdx);\n                        if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(args.rowIndex, args.colIndex, sheet, false, true).wrap) {\n                            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_5__.updateWrapCell, { rowIdx: args.rowIndex, colIdx: args.colIndex, sheet: sheet, ele: args.td });\n                        }\n                    }\n                    if (isNoteAvailable) {\n                        this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_0__.createNoteIndicator, { targetElement: args.td, rowIndex: args.rowIndex, columnIndex: args.colIndex });\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Refreshes the filter header range.\n     *\n     * @param {number[]} filterRange - Specify the filterRange.\n     * @param {boolean} remove - Specify the bool value\n     * @param {number} sIdx - Specify the index.\n     * @param {boolean} allowHeaderFilter - Specifies whether to consider first row during filtering.\n     * @returns {void} - Refreshes the filter header range.\n     */\n    Filter.prototype.refreshFilterRange = function (filterRange, remove, sIdx, allowHeaderFilter) {\n        var sheetIdx = sIdx;\n        if (!sheetIdx && sheetIdx !== 0) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        var filterOption = this.filterRange && this.filterRange.get(sheetIdx);\n        if (!filterOption) {\n            if (!filterRange) {\n                filterRange = [0, 0, 0, 0];\n            }\n        }\n        else {\n            filterRange = filterRange || filterOption.range.slice();\n            allowHeaderFilter = filterOption.allowHeaderFilter;\n        }\n        var range = filterRange;\n        var cell;\n        var sheet = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSheet)(this.parent, sheetIdx);\n        var frozenCol = this.parent.frozenColCount(sheet);\n        for (var index = range[1]; index <= range[3]; index++) {\n            if (allowHeaderFilter) {\n                var table = index < frozenCol ? this.parent.sheetModule.getSelectAllTable() :\n                    this.parent.getColHeaderTable();\n                var headerRow = table && this.parent.getRow(0, table);\n                cell = headerRow && this.parent.getCell(0, index, headerRow);\n            }\n            else {\n                if (!(0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isHiddenRow)(sheet, range[0])) {\n                    cell = this.parent.getCell(range[0], index);\n                }\n                else {\n                    cell = null;\n                }\n            }\n            if (remove) {\n                if (cell) {\n                    var filterBtn = cell.querySelector('.e-filter-btn');\n                    if (filterBtn) {\n                        var isNoteAvailable = false;\n                        if (cell.children.length > 0 && cell.children[cell.childElementCount - 1].className.indexOf('e-addNoteIndicator') > -1) {\n                            cell.removeChild(cell.children[cell.childElementCount - 1]);\n                            isNoteAvailable = true;\n                        }\n                        filterBtn.parentElement.removeChild(filterBtn);\n                        if (isNoteAvailable) {\n                            this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_0__.createNoteIndicator, { targetElement: cell, rowIndex: range[0], columnIndex: index });\n                        }\n                    }\n                }\n            }\n            else {\n                this.renderFilterCellHandler({ td: cell, rowIndex: range[0], colIndex: index, sIdx: sheetIdx, isAction: true });\n            }\n        }\n        if (this.parent.sortCollection) {\n            this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.sortImport, null);\n        }\n    };\n    /**\n     * Checks whether the provided cell is a filter cell.\n     *\n     * @param {number} sheetIdx - Specify the sheet index.\n     * @param {number} rowIndex - Specify the row index\n     * @param {number} colIndex - Specify the col index.\n     * @returns {boolean} - Checks whether the provided cell is a filter cell.\n     */\n    Filter.prototype.isFilterCell = function (sheetIdx, rowIndex, colIndex) {\n        var range = this.filterRange.has(sheetIdx) && this.filterRange.get(sheetIdx).range;\n        return (range && range[0] === rowIndex && range[1] <= colIndex && range[3] >= colIndex);\n    };\n    /**\n     * Checks whether the provided cell is in a filter range\n     *\n     * @param {number} sheetIdx - Specify the sheet index.\n     * @param {number} rowIndex - Specify the row index\n     * @param {number} colIndex - Specify the col index.\n     * @returns {boolean} - Checks whether the provided cell is in a filter range\n     */\n    Filter.prototype.isFilterRange = function (sheetIdx, rowIndex, colIndex) {\n        var range = this.filterRange.get(sheetIdx) && this.filterRange.get(sheetIdx).range;\n        return (range && range[0] <= rowIndex && range[2] >= rowIndex && range[1] <= colIndex && range[3] >= colIndex);\n    };\n    /**\n     * Gets the filter information from active cell\n     *\n     * @param {any} args - Specifies the args\n     * @param {string} args.field - Specify the field\n     * @param {string} args.clearFilterText - Specify the clearFilterText\n     * @param {boolean} args.isFiltered - Specify the isFiltered\n     * @param {boolean} args.isClearAll - Specify the isClearAll\n     * @param {number} args.sheetIndex - Specify the sheet index value.\n     * @returns {void} - Triggers before context menu created to enable or disable items.\n     */\n    Filter.prototype.getFilteredColumnHandler = function (args) {\n        var sheetIdx = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.isUndefined)(args.sheetIndex) ? this.parent.activeSheetIndex : args.sheetIndex;\n        var l10n = this.parent.serviceLocator.getService(_index__WEBPACK_IMPORTED_MODULE_0__.locale);\n        args.clearFilterText = l10n.getConstant('ClearFilter');\n        if (this.filterRange.has(sheetIdx)) {\n            var filterCollection = this.filterCollection.get(sheetIdx);\n            if (args.isClearAll) {\n                args.isFiltered = filterCollection && filterCollection.length > 0;\n                return;\n            }\n            var range = this.filterRange.get(sheetIdx).range.slice();\n            var sheet = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSheet)(this.parent, sheetIdx);\n            var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(sheet.activeCell);\n            if (this.isFilterRange(sheetIdx, cell[0], cell[1])) {\n                args.field = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColumnHeaderText)(cell[1] + 1);\n                var headerCell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(range[0], cell[1], sheet);\n                var cellValue = this.parent.getDisplayText(headerCell);\n                args.clearFilterText = l10n.getConstant('ClearFilterFrom') + '\"'\n                    + (cellValue ? cellValue.toString() : 'Column ' + args.field) + '\"';\n                filterCollection.some(function (value) {\n                    args.isFiltered = value.field === args.field;\n                    return args.isFiltered;\n                });\n            }\n        }\n    };\n    /**\n     * Triggers before context menu created to enable or disable items.\n     *\n     * @param {any} e - Specifies the args\n     * @param {HTMLElement} e.element - Specify the element\n     * @param {MenuItemModel[]} e.items - Specify the items\n     * @param {MenuItemModel} e.parentItem - Specify the parentItem\n     * @param {string} e.target - Specify the target\n     * @returns {void} - Triggers before context menu created to enable or disable items.\n     */\n    Filter.prototype.cMenuBeforeOpenHandler = function (e) {\n        var id = this.parent.element.id + '_cmenu';\n        if (e.parentItem && e.parentItem.id === id + '_filter' && e.target === '') {\n            var args = { isFiltered: false };\n            this.getFilteredColumnHandler(args);\n            this.parent.enableContextMenuItems([id + '_clearfilter', id + '_reapplyfilter'], !!args.isFiltered, true);\n        }\n    };\n    /**\n     * Closes the filter popup.\n     *\n     * @returns {void} - Closes the filter popup.\n     */\n    Filter.prototype.closeDialog = function () {\n        var filterPopup = document.querySelector('.e-filter-popup');\n        if (filterPopup && filterPopup.id.includes(this.parent.element.id)) {\n            var excelFilter = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.getComponent)(filterPopup, 'dialog');\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.EventHandler.remove(filterPopup, (0,_index__WEBPACK_IMPORTED_MODULE_0__.getStartEvent)(), this.filterMouseDownHandler);\n            if (excelFilter) {\n                excelFilter.hide();\n            }\n            this.parent.notify(_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.filterDialogClose, null);\n        }\n    };\n    Filter.prototype.removeFilterClass = function () {\n        if (this.parent.element.style.position === 'relative') {\n            this.parent.element.style.position = '';\n        }\n        if (this.parent.element.classList.contains('e-filter-open')) {\n            this.parent.element.classList.remove('e-filter-open');\n        }\n    };\n    /**\n     * Returns true if the filter popup is opened.\n     *\n     * @returns {boolean} - Returns true if the filter popup is opened.\n     */\n    Filter.prototype.isPopupOpened = function () {\n        var filterPopup = document.getElementsByClassName('e-filter-popup')[0];\n        return filterPopup && filterPopup.id.includes(this.parent.element.id) && filterPopup.style.display !== 'none';\n    };\n    Filter.prototype.filterCellKeyDownHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var indexes = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(sheet.activeCell);\n        if (this.isFilterCell(this.parent.activeSheetIndex, indexes[0], indexes[1])) {\n            if (args.closePopup) {\n                this.closeDialog();\n            }\n            else {\n                args.isFilterCell = true;\n                if (!this.isPopupOpened()) {\n                    var target = this.parent.getCell(indexes[0], indexes[1]);\n                    if (target) {\n                        this.openDialog(target);\n                    }\n                }\n            }\n        }\n    };\n    Filter.prototype.filterMouseDownHandler = function (e) {\n        if ((_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.Browser.isDevice && e.type === 'mousedown') || this.parent.getActiveSheet().isProtected) {\n            return;\n        }\n        var target = e.target;\n        if (target.classList.contains('e-filter-icon') || target.classList.contains('e-filter-btn')) {\n            if (this.isPopupOpened()) {\n                this.closeDialog();\n            }\n            this.openDialog(((0,_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.parentsUntil)(target, 'e-cell') || (0,_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.parentsUntil)(target, 'e-header-cell')));\n        }\n        else if (this.isPopupOpened()) {\n            var offsetEle = target.offsetParent;\n            if (!target.classList.contains('e-searchinput') && !target.classList.contains('e-searchclear') && (offsetEle &&\n                !offsetEle.classList.contains('e-filter-popup') && !offsetEle.classList.contains('e-text-content') &&\n                !offsetEle.classList.contains('e-checkboxtree') && !offsetEle.classList.contains('e-checkbox-wrapper'))) {\n                this.closeDialog();\n            }\n            else {\n                this.selectSortItemHandler(target);\n            }\n        }\n    };\n    Filter.prototype.cboxListSelected = function (args, selectedList, listCount, e, searched) {\n        var wrapper = (0,_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.parentsUntil)(e.target, 'e-ftrchk');\n        if (wrapper) {\n            var addCurCbox = searched && wrapper.querySelector('.e-add-current');\n            if (addCurCbox) {\n                if (addCurCbox.classList.contains('e-check')) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.classList)(addCurCbox, ['e-uncheck'], ['e-check']);\n                    if (!selectedList.length) {\n                        args.btnObj.element.disabled = true;\n                    }\n                    return false;\n                }\n                else {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.classList)(addCurCbox, ['e-check'], ['e-uncheck']);\n                    args.btnObj.element.disabled = false;\n                    return true;\n                }\n            }\n            var selectAll = wrapper.querySelector('.e-selectall');\n            if (selectAll) {\n                wrapper.querySelector('.e-chk-hidden').indeterminate = false;\n                var uncheck = wrapper.querySelector('.e-frame').classList.contains('e-check');\n                var checkBoxFrame = void 0;\n                var text = void 0;\n                for (var idx = searched ? 2 : 1, len = args.element.childElementCount; idx < len; idx++) {\n                    checkBoxFrame = args.element.children[idx].querySelector('.e-frame');\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.removeClass)([checkBoxFrame], ['e-check', 'e-stop', 'e-uncheck']);\n                    if (uncheck) {\n                        args.element.children[idx].querySelector('.e-chk-hidden').checked = false;\n                        checkBoxFrame.classList.add('e-uncheck');\n                        selectedList.splice(0, 1);\n                    }\n                    else {\n                        args.element.children[idx].querySelector('.e-chk-hidden').checked = true;\n                        checkBoxFrame.classList.add('e-check');\n                        text = args.element.children[idx].querySelector('.e-checkboxfiltertext').textContent;\n                        if (selectedList.indexOf(text) === -1) {\n                            selectedList.push(text);\n                        }\n                    }\n                }\n            }\n            else {\n                var text = wrapper.querySelector('.e-checkboxfiltertext').textContent;\n                if (wrapper.querySelector('.e-frame').classList.contains('e-check')) {\n                    selectedList.splice(selectedList.indexOf(text), 1);\n                }\n                else {\n                    selectedList.push(text);\n                }\n                (0,_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.toogleCheckbox)(wrapper);\n                selectAll = args.element.querySelector('.e-selectall');\n            }\n            this.updateState(args, selectAll, selectAll.parentElement.querySelector('.e-chk-hidden'), selectedList.length !== listCount, selectedList.length);\n        }\n        return null;\n    };\n    Filter.prototype.initCboxList = function (args, excelFilter, filterData) {\n        var _this = this;\n        var field = args.column.field;\n        var sortedData = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(args.dataSource).executeLocal(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Query().sortBy(field + '_value', 'ascending'));\n        var listData = [];\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(_index__WEBPACK_IMPORTED_MODULE_0__.locale);\n        var cBoxFrag = document.createDocumentFragment();\n        var selectAll = this.createSelectAll(args, excelFilter);\n        cBoxFrag.appendChild(selectAll);\n        var idCol = {};\n        var hidden;\n        var initSelectedList = [];\n        var selectedList = [];\n        var dataVal;\n        sortedData.forEach(function (data) {\n            if (data[field] === '') {\n                if (!idCol['isBlank']) {\n                    idCol['isBlank'] = true;\n                    var blankObj = {};\n                    blankObj[field] = l10n.getConstant('Blanks');\n                    hidden = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isFilterHidden)(sheet, Number(data['__rowIndex']) - 1);\n                    var blankCbox = (0,_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.createCboxWithWrap)(\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    (0,_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.getUid)('cbox'), excelFilter.createCheckbox(blankObj[field], !hidden, blankObj), 'e-ftrchk');\n                    if (cBoxFrag.childElementCount === 1) {\n                        cBoxFrag.appendChild(blankCbox);\n                    }\n                    else {\n                        cBoxFrag.insertBefore(blankCbox, cBoxFrag.children[1]);\n                    }\n                    listData.splice(0, 0, blankObj[field]);\n                    if (!hidden) {\n                        initSelectedList.push(blankObj[field]);\n                        selectedList.push(blankObj[field]);\n                    }\n                }\n            }\n            else if (!idCol[data[field]]) {\n                idCol[data[field]] = true;\n                hidden = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isFilterHidden)(sheet, Number(data['__rowIndex']) - 1);\n                dataVal = data[field];\n                cBoxFrag.appendChild(\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                (0,_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.createCboxWithWrap)((0,_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.getUid)('cbox'), excelFilter.createCheckbox(dataVal, !hidden, data), 'e-ftrchk'));\n                listData.push(dataVal);\n                if (!hidden) {\n                    initSelectedList.push(dataVal);\n                    selectedList.push(dataVal);\n                }\n            }\n        });\n        args.element.appendChild(cBoxFrag);\n        var cBoxFrame = selectAll.querySelector('.e-frame');\n        cBoxFrame.classList.add('e-selectall');\n        var cBox = selectAll.querySelector('.e-chk-hidden');\n        this.updateState(args, cBoxFrame, cBox, selectedList.length !== listData.length, selectedList.length);\n        var mainCboxList = [].slice.call(args.element.childNodes);\n        var searchedSelectedList;\n        var searchedList;\n        var addCurCboxSelected;\n        args.element.addEventListener('click', function (e) {\n            if (searchedSelectedList) {\n                var isCurSelect = _this.cboxListSelected(args, searchedSelectedList, args.element.childElementCount - 2, e, true);\n                if (isCurSelect !== null) {\n                    addCurCboxSelected = isCurSelect;\n                }\n            }\n            else {\n                _this.cboxListSelected(args, selectedList, listData.length, e);\n            }\n        });\n        var sortedFullData;\n        var searchValue;\n        var updateSearchedList = function (val) {\n            if (val.toLowerCase().includes(searchValue)) {\n                var obj = {};\n                obj[args.column.field] = val;\n                cBoxFrag.appendChild(\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                (0,_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.createCboxWithWrap)((0,_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.getUid)('cbox'), excelFilter.createCheckbox(val, true, obj), 'e-ftrchk'));\n                searchedList.push(val);\n                searchedSelectedList.push(val);\n            }\n        };\n        var performSearchOnData;\n        var filterDataCount = args.dataSource.length > 1000 ? args.dataSource.length : 1000;\n        var fullListData = listData;\n        if (filterData.length <= filterDataCount) {\n            performSearchOnData = function () {\n                listData.forEach(function (val) {\n                    updateSearchedList(val);\n                });\n            };\n        }\n        else {\n            performSearchOnData = function () {\n                if (!sortedFullData) {\n                    fullListData = [];\n                    initSelectedList = [];\n                    selectedList = [];\n                    sortedFullData = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(filterData).executeLocal(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Query().sortBy(field + '_value', 'ascending'));\n                    idCol = {};\n                    sortedFullData.forEach(function (data) {\n                        if (data[field] === '') {\n                            if (!idCol['isBlank']) {\n                                idCol['isBlank'] = true;\n                                dataVal = l10n.getConstant('Blanks');\n                                fullListData.splice(0, 0, dataVal);\n                                if (!(0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isFilterHidden)(sheet, Number(data['__rowIndex']) - 1)) {\n                                    initSelectedList.push(dataVal);\n                                    selectedList.push(dataVal);\n                                }\n                            }\n                        }\n                        else if (!idCol[data[field]]) {\n                            dataVal = data[field];\n                            idCol[dataVal] = true;\n                            fullListData.push(data[field]);\n                            if (!(0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isFilterHidden)(sheet, Number(data['__rowIndex']) - 1)) {\n                                selectedList.push(dataVal);\n                                initSelectedList.push(dataVal);\n                            }\n                        }\n                    });\n                }\n                for (var filterIdx = 0, len = fullListData.length; filterIdx < len; filterIdx++) {\n                    if (searchedList.length < filterDataCount) {\n                        updateSearchedList(fullListData[filterIdx]);\n                    }\n                    else {\n                        break;\n                    }\n                }\n            };\n        }\n        var refreshCheckbox = function (e) {\n            if (e.event.type === 'keyup') {\n                searchValue = e.event.target.value.toLowerCase();\n            }\n            else if (e.event.target.classList.contains('e-search-icon')) {\n                return;\n            }\n            cBoxFrag = document.createDocumentFragment();\n            cBoxFrag.appendChild(selectAll);\n            if (searchValue) {\n                searchedList = [];\n                searchedSelectedList = [];\n                performSearchOnData();\n                if (searchedSelectedList.length) {\n                    _this.updateState(args, cBoxFrame, cBox, false, 0);\n                    selectAll.classList.remove('e-hide');\n                    var obj = {};\n                    obj[field] = l10n.getConstant('AddCurrentSelection');\n                    var addCurrentCbox = (0,_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.createCboxWithWrap)(\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    (0,_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.getUid)('cbox'), excelFilter.createCheckbox(obj[field], false, obj), 'e-ftrchk');\n                    cBoxFrag.insertBefore(addCurrentCbox, cBoxFrag.children[1]);\n                    addCurrentCbox.querySelector('.e-frame').classList.add('e-add-current');\n                }\n                else {\n                    selectAll.classList.add('e-hide');\n                    var noRecordEle = _this.parent.createElement('div', { className: 'e-checkfltrnmdiv' });\n                    var noRecordText = _this.parent.createElement('span');\n                    noRecordText.innerText = l10n.getConstant('NoResult');\n                    noRecordEle.appendChild(noRecordText);\n                    cBoxFrag.appendChild(noRecordEle);\n                    args.btnObj.element.disabled = true;\n                }\n            }\n            else if (mainCboxList) {\n                searchedSelectedList = null;\n                searchedList = null;\n                _this.updateState(args, cBoxFrame, cBox, selectedList.length !== listData.length, selectedList.length);\n                selectAll.classList.remove('e-hide');\n                mainCboxList.forEach(function (element) {\n                    cBoxFrag.appendChild(element);\n                });\n            }\n            args.element.innerHTML = '';\n            args.element.appendChild(cBoxFrag);\n        };\n        var applyBtnClickHandler = function () {\n            if (searchedList) {\n                if (addCurCboxSelected) {\n                    var text = void 0;\n                    var index = void 0;\n                    selectedList = initSelectedList;\n                    for (var idx = 0, len = searchedList.length; idx < len; idx++) {\n                        text = searchedList[idx];\n                        if (searchedList.length === searchedSelectedList.length || searchedSelectedList.indexOf(text) > -1) {\n                            if (selectedList.indexOf(text) === -1) {\n                                selectedList.push(text);\n                            }\n                        }\n                        else {\n                            index = selectedList.indexOf(text);\n                            if (index > -1) {\n                                selectedList.splice(index, 1);\n                            }\n                        }\n                    }\n                }\n                else {\n                    selectedList = searchedSelectedList;\n                }\n            }\n            var checkedLength = selectedList.length;\n            if (checkedLength === listData.length && (!searchedSelectedList || filterData.length <= filterDataCount)) {\n                _this.filterSuccessHandler(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(args.dataSource), { action: 'clear-filter', field: args.column.field });\n            }\n            else {\n                var predicates_1 = [];\n                var model_1 = { field: field, ignoreAccent: false, matchCase: false, isFilterByMenu: true };\n                var localeObj_1 = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.getNumericObject)(_this.parent.locale);\n                var updatePredicate = function (val) {\n                    var type = args.type;\n                    if (type === 'number') {\n                        if (val === l10n.getConstant('Blanks')) {\n                            val = '';\n                            type = 'string';\n                        }\n                        else if (!(0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.parseLocaleNumber)([val], _this.parent, localeObj_1)[0])) {\n                            type = 'string';\n                        }\n                    }\n                    predicates_1.push(Object.assign({ value: val, type: type }, model_1));\n                };\n                if (checkedLength > fullListData.length / 2) {\n                    model_1.operator = 'notequal';\n                    model_1.predicate = 'and';\n                    for (var idx = 0, len = fullListData.length; idx < len; idx++) {\n                        if (selectedList.indexOf(fullListData[idx]) === -1) {\n                            updatePredicate(fullListData[idx]);\n                        }\n                    }\n                }\n                else {\n                    model_1.operator = 'equal';\n                    model_1.predicate = 'or';\n                    for (var idx = 0, len = checkedLength; idx < len; idx++) {\n                        updatePredicate(selectedList[idx]);\n                    }\n                }\n                excelFilter.initiateFilter(predicates_1);\n            }\n        };\n        this.wireFilterEvents(args, applyBtnClickHandler, refreshCheckbox.bind(this));\n    };\n    Filter.prototype.createSelectAll = function (args, excelFilter) {\n        var selectAllObj = {};\n        selectAllObj[args.column.field] = this.parent.serviceLocator.getService(_index__WEBPACK_IMPORTED_MODULE_0__.locale).getConstant('SelectAll');\n        var selectAll = (0,_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.createCboxWithWrap)(\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        (0,_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.getUid)('cbox'), excelFilter.createCheckbox(selectAllObj[args.column.field], false, selectAllObj), 'e-ftrchk');\n        return selectAll;\n    };\n    Filter.prototype.updateState = function (args, cBoxFrame, cBox, indeterminate, checkedCount) {\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.removeClass)([cBoxFrame], ['e-check', 'e-stop', 'e-uncheck']);\n        if (args.btnObj.element.disabled) {\n            args.btnObj.element.disabled = false;\n        }\n        if (indeterminate) {\n            if (checkedCount) {\n                cBoxFrame.classList.add('e-stop');\n            }\n            else {\n                cBoxFrame.classList.add('e-uncheck');\n                var addCurCbox = args.element.querySelector('.e-add-current');\n                args.btnObj.element.disabled = !addCurCbox || !addCurCbox.classList.contains('e-check');\n            }\n        }\n        else {\n            cBoxFrame.classList.add('e-check');\n        }\n        cBox.indeterminate = indeterminate;\n        cBox.checked = !indeterminate;\n    };\n    Filter.prototype.beforeFilteringHandler = function (evt) {\n        var _this = this;\n        if (evt.instance && evt.instance.options) {\n            if (evt.isOpen && evt.instance.options.type === 'string') {\n                var localeObj = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.getNumericObject)(this.parent.locale);\n                if (localeObj.decimal !== '.') {\n                    var valArr = evt.arg3.toString().split('.');\n                    if (valArr.length === 2) {\n                        var parsedNumVal = valArr.join(localeObj.decimal);\n                        if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(new _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.Internationalization(this.parent.locale).parseNumber(parsedNumVal, { format: 'n' }))) {\n                            evt.arg3 = parsedNumVal;\n                        }\n                    }\n                }\n            }\n            var parseValue_1 = function (val, operator) {\n                if (operator && (operator === 'notequal' || _this.isCustomNumFilter(operator))) {\n                    if (val) {\n                        if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(val)) {\n                            val = parseFloat(val.toString());\n                        }\n                        else if (typeof val === 'string') {\n                            var localeObj = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.getNumericObject)(_this.parent.locale);\n                            var intl = new _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.Internationalization(_this.parent.locale);\n                            var numArgs = {};\n                            if (val.includes(localeObj.percentSign)) {\n                                var valArr = val.trim().split('%');\n                                if (valArr[0] !== '' && !valArr[1]) {\n                                    numArgs = (0,_workbook_common_internalization__WEBPACK_IMPORTED_MODULE_2__.checkIsNumberAndGetNumber)({ value: valArr[0] }, _this.parent.locale, localeObj.group, localeObj.decimal);\n                                }\n                            }\n                            if (numArgs.isNumber) {\n                                val = Number(numArgs.value) / 100;\n                            }\n                            else {\n                                var parsedNumVal = intl.parseNumber(val.trim(), { format: 'n' });\n                                if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(parsedNumVal)) {\n                                    if (/^(\\(\\d+\\)|\\d+)$/.test(val.trim())) {\n                                        val = -parsedNumVal;\n                                    }\n                                    else {\n                                        val = parsedNumVal;\n                                    }\n                                }\n                                else {\n                                    var checkVal = val.trim();\n                                    var dateEventArgs = { value: checkVal, cell: { value: checkVal } };\n                                    _this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.checkDateFormat, dateEventArgs);\n                                    if (dateEventArgs.isTime || dateEventArgs.isDate) {\n                                        val = parseFloat(dateEventArgs.updatedVal);\n                                    }\n                                }\n                            }\n                        }\n                    }\n                    else if (operator === 'notequal' && val === null) {\n                        val = '';\n                    }\n                }\n                else if (operator === 'equal') {\n                    if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(val)) {\n                        val = val.toString();\n                    }\n                    else if (typeof val === 'string' && (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(parseValue_1(val, 'notequal'))) {\n                        val = val.trim();\n                    }\n                    else if (val === null) {\n                        val = '';\n                    }\n                }\n                return val;\n            };\n            if (evt.instance.options.type !== 'date') {\n                evt.arg3 = parseValue_1(evt.arg3, evt.arg2);\n                evt.arg8 = parseValue_1(evt.arg8, evt.arg7);\n            }\n            else if (evt.instance.options.format === 'yMd') {\n                var parseDateTime = function (val, operator) {\n                    if (val) {\n                        if (typeof val === 'string') {\n                            var checkVal = val.trim();\n                            var dateEventArgs = { value: checkVal, cell: { value: checkVal } };\n                            _this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.checkDateFormat, dateEventArgs);\n                            if (dateEventArgs.isDate) {\n                                val = operator === 'equal' ? dateEventArgs.dateObj : parseFloat(dateEventArgs.updatedVal);\n                            }\n                            else {\n                                if (operator === 'equal' || operator === 'notequal') {\n                                    var parsedNumVal = parseValue_1(val, 'notequal');\n                                    if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(parsedNumVal)) {\n                                        evt.instance.options.type = 'number';\n                                        if (operator === 'notequal') {\n                                            val = parsedNumVal;\n                                        }\n                                    }\n                                    else {\n                                        evt.instance.options.type = 'string';\n                                    }\n                                }\n                            }\n                        }\n                        else if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isDateTime)(val) && operator !== 'equal') {\n                            val = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.dateToInt)(val, true);\n                        }\n                    }\n                    return val;\n                };\n                var filterDateInputs = document.querySelectorAll('.e-xlfl-valuediv input.e-datepicker');\n                if (filterDateInputs.length === 2) {\n                    evt.arg3 = parseDateTime(evt.arg3 || filterDateInputs[0].value, evt.arg2);\n                    evt.arg8 = parseDateTime(evt.arg8 || filterDateInputs[1].value, evt.arg7);\n                }\n                else if (evt.arg3) {\n                    evt.arg3 = parseDateTime(evt.arg3, evt.arg2);\n                }\n            }\n        }\n    };\n    Filter.prototype.customFilterOpen = function (args) {\n        var filterOptDiv = document.querySelectorAll('.e-xlfl-optrdiv input.e-dropdownlist');\n        var criterias = [];\n        for (var idx = 0; idx < filterOptDiv.length; idx++) {\n            var dropDownList = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.getComponent)(filterOptDiv[idx], 'dropdownlist');\n            if (dropDownList) {\n                criterias.push(dropDownList.value);\n            }\n        }\n        var customFilterValues = [];\n        if (criterias.length === 2) {\n            var predicates = this.filterCollection.get(this.parent.activeSheetIndex);\n            var criteriaIdx = void 0;\n            for (var idx = 0; idx < predicates.length; idx++) {\n                if (predicates[idx].field === args.column && predicates[idx].value !== null) {\n                    criteriaIdx = criterias.indexOf(predicates[idx].operator);\n                    if (criteriaIdx > -1) {\n                        if (predicates[idx].operator === 'equal' && (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isDateTime)(predicates[idx].value)) {\n                            customFilterValues[criteriaIdx] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.dateToInt)(predicates[idx].value, true).toString();\n                        }\n                        else {\n                            customFilterValues[criteriaIdx] = predicates[idx].value.toString();\n                        }\n                        criterias[criteriaIdx] = '';\n                    }\n                }\n            }\n        }\n        var localeNumObj = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.getNumericObject)(this.parent.locale);\n        var getParsedVal = function (val) {\n            if (localeNumObj.decimal !== '.' && (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(val)) {\n                var parsedVal = val.toString();\n                if (parsedVal.includes('.')) {\n                    return parsedVal.replace('.', localeNumObj.decimal);\n                }\n            }\n            return val;\n        };\n        var filterValInputs = document.querySelectorAll('.e-xlfl-valuediv input.e-ss-filter-input');\n        if (filterValInputs.length) {\n            for (var idx = 0; idx < filterValInputs.length; idx++) {\n                var textObj = new _syncfusion_ej2_inputs__WEBPACK_IMPORTED_MODULE_9__.TextBox({ placeholder: this.parent.serviceLocator.getService(_index__WEBPACK_IMPORTED_MODULE_0__.locale).getConstant('CustomFilterPlaceHolder') });\n                if (customFilterValues[idx]) {\n                    textObj.value = getParsedVal(customFilterValues[idx]);\n                }\n                textObj.appendTo(filterValInputs[idx]);\n            }\n        }\n        else {\n            var filterValInputs_1 = document.querySelectorAll('.e-xlfl-valuediv input.e-datepicker');\n            var datePickerObj = void 0;\n            var val = void 0;\n            for (var idx = 0; idx < filterValInputs_1.length; idx++) {\n                if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(customFilterValues[idx])) {\n                    val = this.parent.getDisplayText({ value: customFilterValues[idx], format: (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getFormatFromType)('ShortDate') +\n                            (customFilterValues[idx].includes('.') ? \" \" + (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getFormatFromType)('Time') : '') });\n                }\n                else {\n                    val = getParsedVal(customFilterValues[idx]);\n                }\n                datePickerObj = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.getComponent)(filterValInputs_1[idx], 'datepicker');\n                if (datePickerObj) {\n                    datePickerObj.value = val;\n                    filterValInputs_1[idx].value = val;\n                }\n            }\n        }\n    };\n    Filter.prototype.wireFilterEvents = function (args, applyBtnClickHandler, refreshCheckboxes) {\n        var _this = this;\n        args.btnObj.element.addEventListener('click', applyBtnClickHandler.bind(this));\n        args.searchBox.addEventListener('keydown', function (e) {\n            if (e.keyCode === 13) {\n                applyBtnClickHandler();\n            }\n        });\n        var filterDlgCloseHandler = function () {\n            _this.parent.off(_index__WEBPACK_IMPORTED_MODULE_0__.refreshCheckbox, refreshCheckboxes);\n            _this.parent.off(_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.filterDialogClose, filterDlgCloseHandler);\n            (0,_index__WEBPACK_IMPORTED_MODULE_0__.focus)(_this.parent.element);\n        };\n        this.parent.on(_syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.filterDialogClose, filterDlgCloseHandler, this);\n        this.parent.on(_index__WEBPACK_IMPORTED_MODULE_0__.refreshCheckbox, refreshCheckboxes, this);\n    };\n    Filter.prototype.initTreeView = function (args, excelFilter) {\n        var _this = this;\n        var checkedNodes = [];\n        var allNodes = [];\n        var idColl = {};\n        var groupedYears = [];\n        var groupedMonths = [];\n        var groupedData = [];\n        var otherData = [];\n        var value;\n        var month;\n        var day;\n        var date;\n        var mId;\n        var dId;\n        var monthNum;\n        var months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October',\n            'November', 'December'];\n        if (this.parent.locale !== 'en-US') {\n            var formats = _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.IntlBase.getDependables(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.cldrData, this.parent.locale, null).dateObject;\n            var monthObj_1 = formats.months['stand-alone'] ? formats.months['stand-alone'].wide : {};\n            if (Object.keys(monthObj_1).length === 12) {\n                months = Object.keys(monthObj_1).map(Number).map(function (key) { return monthObj_1[key]; });\n            }\n        }\n        var grpObj;\n        var indeterminate = false;\n        var sheet = this.parent.getActiveSheet();\n        var addNodes = function (data) {\n            idColl[\"\" + dId] = true;\n            if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isFilterHidden)(sheet, Number(data['__rowIndex']) - 1)) {\n                indeterminate = true;\n            }\n            else {\n                checkedNodes.push(dId);\n            }\n            allNodes.push(dId);\n        };\n        args.dataSource.forEach(function (data) {\n            date = data[args.column.field];\n            if (typeof date === 'object' && !!Date.parse(date.toString())) {\n                value = date.getFullYear().toString();\n                if (!idColl[\"\" + value]) {\n                    grpObj = { __rowIndex: value, hasChild: true };\n                    grpObj[args.column.field] = value;\n                    groupedYears.push(grpObj);\n                    idColl[\"\" + value] = true;\n                }\n                monthNum = date.getMonth();\n                month = months[monthNum];\n                mId = value + ' ' + month;\n                if (!idColl[\"\" + mId]) {\n                    grpObj = { __rowIndex: mId, pId: value, hasChild: true, month: monthNum };\n                    grpObj[args.column.field] = month;\n                    groupedMonths.push(grpObj);\n                    idColl[\"\" + mId] = true;\n                }\n                day = date.getDate();\n                dId = mId + ' ' + day.toString();\n                if (!idColl[\"\" + dId]) {\n                    grpObj = { __rowIndex: dId, pId: mId };\n                    grpObj[args.column.field] = day;\n                    groupedData.push(grpObj);\n                    addNodes(data);\n                }\n            }\n            else {\n                if (!data[args.column.field] && data[args.column.field] !== 0) {\n                    dId = 'blanks';\n                    value = _this.parent.serviceLocator.getService(_index__WEBPACK_IMPORTED_MODULE_0__.locale).getConstant('Blanks');\n                }\n                else {\n                    dId = 'text ' + data[args.column.field].toString().toLowerCase();\n                    value = data[args.column.field];\n                }\n                if (!idColl[\"\" + dId]) {\n                    grpObj = { __rowIndex: dId };\n                    grpObj[args.column.field] = value;\n                    otherData.push(grpObj);\n                    addNodes(data);\n                }\n            }\n        });\n        groupedYears = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(groupedYears).executeLocal(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Query().sortBy(args.column.field, 'decending'));\n        groupedMonths = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(groupedMonths).executeLocal(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Query().sortBy('month', 'ascending'));\n        groupedData = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(groupedData).executeLocal(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Query().sortBy(args.column.field, 'ascending'));\n        groupedData = groupedYears.concat(groupedMonths.concat(groupedData));\n        if (otherData.length) {\n            otherData = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(otherData).executeLocal(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Query().sortBy(args.column.field, 'ascending'));\n            groupedData = groupedData.concat(otherData);\n        }\n        var nodeClick = function (args) {\n            var checkedNode = [args.node];\n            if (args.event.target.classList.contains('e-fullrow') || args.event.key === 'Enter') {\n                var getNodeDetails = treeViewObj.getNode(args.node);\n                if (getNodeDetails.isChecked === 'true') {\n                    treeViewObj.uncheckAll(checkedNode);\n                }\n                else {\n                    treeViewObj.checkAll(checkedNode);\n                }\n            }\n        };\n        var selectAllClick = function () {\n            cBox.indeterminate = false;\n            if (cBoxFrame.classList.contains('e-check')) {\n                treeViewObj.uncheckAll();\n                cBoxFrame.classList.add('e-uncheck');\n                cBox.checked = false;\n            }\n            else {\n                treeViewObj.checkAll();\n                cBoxFrame.classList.add('e-check');\n                cBox.checked = true;\n            }\n        };\n        var selectAll = this.createSelectAll(args, excelFilter);\n        selectAll.addEventListener('click', selectAllClick.bind(this));\n        selectAll.classList.add('e-spreadsheet-ftrchk');\n        var cBoxFrame = selectAll.querySelector('.e-frame');\n        cBoxFrame.classList.add('e-selectall');\n        args.element.appendChild(selectAll);\n        var cBox = selectAll.querySelector('.e-chk-hidden');\n        var treeViewEle = this.parent.createElement('div');\n        var treeViewObj = new _syncfusion_ej2_navigations__WEBPACK_IMPORTED_MODULE_8__.TreeView({\n            fields: { dataSource: groupedData, id: '__rowIndex', parentID: 'pId', text: args.column.field, hasChildren: 'hasChild' },\n            enableRtl: this.parent.enableRtl, showCheckBox: true, cssClass: 'e-checkboxtree', checkedNodes: checkedNodes,\n            nodeClicked: nodeClick.bind(this),\n            keyPress: nodeClick.bind(this),\n            nodeChecked: function (e) {\n                if (e.action !== 'indeterminate') {\n                    indeterminate = treeViewObj.checkedNodes.length !== treeViewObj.fields.dataSource.length;\n                    _this.updateState(args, cBoxFrame, cBox, indeterminate, treeViewObj.checkedNodes.length);\n                }\n            }\n        });\n        treeViewObj.createElement = this.parent.createElement;\n        treeViewObj.appendTo(treeViewEle);\n        args.element.appendChild(treeViewEle);\n        checkedNodes = treeViewObj.checkedNodes;\n        this.updateState(args, cBoxFrame, cBox, indeterminate, treeViewObj.checkedNodes.length);\n        var applyBtnClickHandler = function () {\n            if (treeViewObj.checkedNodes.length === groupedData.length) {\n                _this.filterSuccessHandler(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(args.dataSource), { action: 'clear-filter', field: args.column.field });\n            }\n            else {\n                _this.generatePredicate(treeViewObj.checkedNodes, otherData.length ? 'string' : args.type, args.column.field, excelFilter, allNodes, treeViewObj.checkedNodes.length > groupedData.length / 2);\n            }\n        };\n        this.treeViewObj = treeViewObj;\n        this.treeViewEle = treeViewEle;\n        this.cBox = cBox;\n        this.wireFilterEvents(args, applyBtnClickHandler, this.refreshCheckbox.bind(this, groupedData, treeViewObj, checkedNodes));\n    };\n    Filter.prototype.generatePredicate = function (checkedNodes, type, field, excelFilter, allNodes, isNotEqual) {\n        var predicates = [];\n        var predicate;\n        var months = { 'January': 0, 'February': 1, 'March': 2, 'April': 3, 'May': 4, 'June': 5, 'July': 6,\n            'August': 7, 'September': 8, 'October': 9, 'November': 10, 'December': 11 };\n        var valArr;\n        var date;\n        var val;\n        var otherType;\n        var updateOtherPredicate = function () {\n            if (valArr[0] === 'blanks') {\n                predicates.push(Object.assign({ value: '', type: type }, predicate));\n            }\n            else if (valArr[0] === 'text') {\n                valArr.splice(0, 1);\n                val = valArr.join(' ');\n                if (isNaN(Number(val))) {\n                    otherType = 'string';\n                }\n                else {\n                    val = Number(val);\n                    otherType = 'number';\n                }\n                predicates.push(Object.assign({ value: val, type: otherType }, predicate));\n            }\n        };\n        var setDate = function () {\n            date = new Date(Number(valArr[0]), months[valArr[1]], Number(valArr[2]));\n            if (date.getDate()) {\n                predicates.push(Object.assign({ value: date, type: type }, predicate));\n            }\n            else {\n                updateOtherPredicate();\n            }\n        };\n        if (isNotEqual) {\n            predicate = { field: field, ignoreAccent: false, matchCase: false, predicate: 'and', operator: 'notequal',\n                isFilterByMenu: true };\n            for (var i = 0, len = allNodes.length; i < len; i++) {\n                if (checkedNodes.indexOf(allNodes[i]) === -1) {\n                    valArr = allNodes[i].split(' ');\n                    setDate();\n                }\n            }\n        }\n        else {\n            predicate = { field: field, ignoreAccent: false, matchCase: false, predicate: 'or', operator: 'equal', isFilterByMenu: true };\n            for (var i = 0, len = checkedNodes.length; i < len; i++) {\n                valArr = checkedNodes[i].split(' ');\n                if (valArr.length === 3) {\n                    setDate();\n                }\n                else {\n                    updateOtherPredicate();\n                }\n            }\n        }\n        excelFilter.initiateFilter(predicates);\n    };\n    Filter.prototype.refreshCheckbox = function (groupedData, treeViewObj, checkedNodes, args) {\n        var searchValue;\n        if (args.event.type === 'keyup') {\n            searchValue = args.event.target.value;\n        }\n        else if (args.event.target.classList.contains('e-search-icon')) {\n            return;\n        }\n        var filteredList;\n        var changeData = function () {\n            if (filteredList.length && !treeViewObj.fields.dataSource.length) {\n                var wrapper = treeViewObj.element.parentElement;\n                wrapper.getElementsByClassName('e-spreadsheet-ftrchk')[0].classList.remove('e-hide');\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.detach)(wrapper.getElementsByClassName('e-checkfltrnmdiv')[0]);\n            }\n            treeViewObj.fields.dataSource = filteredList;\n            treeViewObj.dataBind();\n        };\n        if (searchValue) {\n            filteredList = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(groupedData).executeLocal(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Query().where(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Predicate(treeViewObj.fields.text, 'contains', searchValue, true)));\n            var filterId = {};\n            var predicates = [];\n            var key = void 0;\n            var initList = void 0;\n            var strFilter = isNaN(Number(searchValue));\n            var expandId = void 0;\n            var level = void 0;\n            if (strFilter) {\n                for (var i = 0; i < filteredList.length; i++) {\n                    if (!filteredList[i]['hasChild']) {\n                        continue;\n                    }\n                    predicates.push(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Predicate('pId', 'equal', filteredList[i]['__rowIndex'], false));\n                    key = filteredList[i]['pId'];\n                    if (!filterId[\"\" + key]) {\n                        predicates.push(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Predicate('__rowIndex', 'equal', key, false));\n                        filterId[\"\" + key] = true;\n                    }\n                }\n                initList = filteredList;\n                level = 1;\n            }\n            else {\n                var year = void 0;\n                var filterParentId = {};\n                expandId = [];\n                for (var i = 0; i < filteredList.length; i++) {\n                    key = filteredList[i]['pId'];\n                    if (key) {\n                        year = key.split(' ')[0];\n                        if (!filterId[\"\" + key]) {\n                            predicates.push(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Predicate('__rowIndex', 'equal', key, false));\n                            filterId[\"\" + key] = true;\n                            expandId.push(year);\n                            expandId.push(key);\n                        }\n                        if (!filterParentId[\"\" + year]) {\n                            if (!filterId[\"\" + year]) {\n                                predicates.push(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Predicate('__rowIndex', 'equal', year, false));\n                                filterId[\"\" + year] = true;\n                            }\n                            predicates.push(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Predicate('__rowIndex', 'equal', filteredList[i]['__rowIndex'], false));\n                        }\n                    }\n                    else {\n                        key = filteredList[i]['__rowIndex'];\n                        if (!filterParentId[\"\" + key]) {\n                            predicates.push(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Predicate('__rowIndex', 'contains', key, false));\n                            filterParentId[\"\" + key] = true;\n                        }\n                    }\n                }\n                initList = [];\n            }\n            if (filteredList.length) {\n                if (predicates.length) {\n                    filteredList = initList.concat(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(groupedData).executeLocal(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Query().where(_syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Predicate.or(predicates))));\n                }\n                changeData();\n                treeViewObj.checkAll();\n                var duration = treeViewObj.animation.expand.duration;\n                treeViewObj.animation.expand.duration = 0;\n                treeViewObj.expandAll(expandId, level);\n                treeViewObj.animation.expand.duration = duration;\n            }\n            else if (treeViewObj.fields.dataSource.length) {\n                changeData();\n                var wrapper = treeViewObj.element.parentElement;\n                wrapper.getElementsByClassName('e-spreadsheet-ftrchk')[0].classList.add('e-hide');\n                var noRecordEle = this.parent.createElement('div', { className: 'e-checkfltrnmdiv' });\n                var noRecordText = this.parent.createElement('span');\n                noRecordText.innerText = this.parent.serviceLocator.getService(_index__WEBPACK_IMPORTED_MODULE_0__.locale).getConstant('NoResult');\n                noRecordEle.appendChild(noRecordText);\n                wrapper.appendChild(noRecordEle);\n            }\n        }\n        else {\n            filteredList = groupedData;\n            changeData();\n            treeViewObj.checkedNodes = checkedNodes;\n            treeViewObj.refresh();\n        }\n    };\n    Filter.prototype.openDialog = function (cell) {\n        var _this = this;\n        var colIndex = parseInt(cell.getAttribute('aria-colindex'), 10);\n        var field = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColumnHeaderText)(colIndex);\n        this.parent.showSpinner();\n        var sheetIdx = this.parent.activeSheetIndex;\n        var filterRange = this.filterRange.get(sheetIdx);\n        var range = filterRange.range.slice();\n        var sheet = this.parent.getActiveSheet();\n        var filterCell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(range[0], colIndex - 1, sheet);\n        var displayName = this.parent.getDisplayText(filterCell);\n        if (!filterRange.allowHeaderFilter) {\n            range[0] = range[0] + 1; // to skip first row.\n        }\n        if (!filterRange.useFilterRange) {\n            range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n        }\n        var fullRange = [range[0], colIndex - 1, range[2], colIndex - 1];\n        var totalRange = this.getPredicateRange(fullRange, this.filterCollection.get(sheetIdx), colIndex - 1);\n        var otherColPredicate = totalRange.otherColPredicate;\n        var curColPredicates;\n        var curPredicate = totalRange.curPredicate;\n        if (curPredicate.length) {\n            curColPredicates = {};\n            curColPredicates[field] = curPredicate;\n        }\n        var addr = sheet.name + \"!\" + totalRange.address;\n        var fullAddr = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(fullRange);\n        var col = this.getColumnType(sheet, colIndex - 1, range, true);\n        var type = col.type;\n        var templateColData;\n        var isDateCol = type === 'date' || col.isDateAvail;\n        var isNumCol = type === 'number';\n        var templateFilter = isDateCol || isNumCol;\n        var isMultiFormattedCol = col.isMultiFormattedCol;\n        if (templateFilter && !totalRange.filteredCol) {\n            templateColData = [];\n        }\n        (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getData)(this.parent, addr, true, true, null, true, null, null, true, fullAddr, null, templateColData).then(function (jsonData) {\n            var checkBoxData;\n            _this.parent.element.style.position = 'relative';\n            _this.parent.element.classList.add('e-filter-open');\n            var filterCollection;\n            if (templateFilter) {\n                if (templateColData || !otherColPredicate.length) {\n                    checkBoxData = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(templateColData || jsonData);\n                }\n                else {\n                    var options_1 = _this.getPredicates(otherColPredicate);\n                    var data = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.applyPredicates)(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(jsonData), options_1.predicates, options_1.equalOrPredicates);\n                    checkBoxData = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(data);\n                }\n                var beforeCboxRender_1 = function (args) {\n                    _this.parent.off(_index__WEBPACK_IMPORTED_MODULE_0__.beforeCheckboxRender, beforeCboxRender_1);\n                    args.isCheckboxFilterTemplate = true;\n                    if (isDateCol) {\n                        _this.initTreeView(args, excelFilter);\n                    }\n                    else {\n                        _this.initCboxList(args, excelFilter, jsonData);\n                    }\n                };\n                _this.parent.on(_index__WEBPACK_IMPORTED_MODULE_0__.beforeCheckboxRender, beforeCboxRender_1, _this);\n                filterCollection = [];\n            }\n            else {\n                if (otherColPredicate.length) {\n                    var options_2 = _this.getPredicates(otherColPredicate);\n                    var data = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.applyPredicates)(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(jsonData), options_2.predicates, options_2.equalOrPredicates);\n                    checkBoxData = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(data);\n                }\n                else {\n                    checkBoxData = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(jsonData);\n                }\n                filterCollection = _this.getClonedPredicates(curPredicate);\n            }\n            var target = cell.querySelector('.e-filter-btn');\n            var filterCol = {\n                field: field, filter: {}\n            };\n            if (isNumCol) {\n                var parent_1 = _this.parent;\n                filterCol.filterTemplate = function (element) {\n                    if (parent_1.isReact && element) {\n                        element.appendChild(parent_1.createElement('input', { className: 'e-ss-filter-input' }));\n                    }\n                    else {\n                        return [parent_1.createElement('input', { className: 'e-ss-filter-input' })];\n                    }\n                };\n                var filterTemplateCallback_1 = function (template) {\n                    return function (_data, _parent, _prop, _id, _isStringTemplate, _index, element) {\n                        return template(element);\n                    };\n                };\n                filterCol.getFilterTemplate = function () { return filterTemplateCallback_1(filterCol.filterTemplate); };\n                if (parent_1.isReact && !parent_1.renderTemplates) {\n                    parent_1.renderTemplates = function (callback) { return callback(); };\n                }\n            }\n            var options = {\n                type: type, field: field, format: (type === 'date' ? 'yMd' : null), displayName: displayName || 'Column ' + field,\n                dataSource: checkBoxData || [], height: _this.parent.element.classList.contains('e-bigger') ? 800 : 500, columns: [],\n                hideSearchbox: false, filteredColumns: filterCollection, column: filterCol,\n                handler: _this.filterSuccessHandler.bind(_this, new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(jsonData)), target: target,\n                position: { X: 0, Y: 0 }, localeObj: _this.parent.serviceLocator.getService(_index__WEBPACK_IMPORTED_MODULE_0__.locale), actualPredicate: curColPredicates,\n                isFormatted: templateFilter && !isDateCol, isMultiFormattedCol: isMultiFormattedCol\n            };\n            var excelFilter = new _syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.ExcelFilterBase(_this.parent, _this.getLocalizedCustomOperators());\n            excelFilter.openDialog(options);\n            var filterPopup = document.querySelector('.e-filter-popup');\n            if (filterPopup && filterPopup.id.includes(_this.parent.element.id)) {\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.EventHandler.add(filterPopup, (0,_index__WEBPACK_IMPORTED_MODULE_0__.getStartEvent)(), _this.filterMouseDownHandler, _this);\n                var parentOff = _this.parent.element.getBoundingClientRect();\n                var cellOff = target.getBoundingClientRect();\n                var popupOff = filterPopup.getBoundingClientRect();\n                var left = (cellOff.right - parentOff.left) - popupOff.width;\n                if (left < 0) { // Left collision wrt spreadsheet left\n                    left = cellOff.left - parentOff.left;\n                }\n                filterPopup.style.left = left * _this.parent.viewport.scaleX + \"px\";\n                filterPopup.style.top = '0px';\n                filterPopup.style.visibility = 'hidden';\n                if (filterPopup.classList.contains('e-hide')) {\n                    filterPopup.classList.remove('e-hide');\n                }\n                var top_1 = cellOff.bottom - parentOff.top;\n                if (popupOff.height - (parentOff.bottom - cellOff.bottom) > 0) { // Bottom collision wrt spreadsheet bottom\n                    top_1 -= popupOff.height - (parentOff.bottom - cellOff.bottom);\n                    if (top_1 < 0) {\n                        top_1 = 0;\n                    }\n                }\n                filterPopup.style.top = top_1 * _this.parent.viewport.scaleY + \"px\";\n                filterPopup.style.visibility = '';\n            }\n            _this.parent.hideSpinner();\n        });\n    };\n    Filter.prototype.getPredicateRange = function (range, predicates, col) {\n        var addr = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(range);\n        var filteredCol;\n        var otherColPredicate = [];\n        var curPredicate = [];\n        if (predicates && predicates.length) {\n            var predicateRange_1;\n            var colIdx_1;\n            predicates.forEach(function (predicate) {\n                if (predicate.field) {\n                    predicateRange_1 = \"\" + predicate.field + (range[0] + 1) + \":\" + predicate.field + (range[2] + 1);\n                    colIdx_1 = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColIndex)(predicate.field);\n                    if (!addr.includes(predicateRange_1)) {\n                        addr += \",\" + predicateRange_1;\n                        if (colIdx_1 < range[1]) {\n                            range[1] = colIdx_1;\n                        }\n                        if (colIdx_1 > range[3]) {\n                            range[3] = colIdx_1;\n                        }\n                    }\n                    if (col !== undefined) {\n                        if (colIdx_1 === col) {\n                            filteredCol = true;\n                            curPredicate.push(predicate);\n                        }\n                        else {\n                            otherColPredicate.push(predicate);\n                        }\n                    }\n                }\n            });\n        }\n        else {\n            filteredCol = true;\n        }\n        return col === undefined ? addr :\n            { address: addr, filteredCol: filteredCol, otherColPredicate: otherColPredicate, curPredicate: curPredicate };\n    };\n    Filter.prototype.filterDialogCreatedHandler = function () {\n        var filterPopup = document.querySelector('.e-filter-popup');\n        if (filterPopup && filterPopup.id.includes(this.parent.element.id) && filterPopup.classList.contains('e-popup-close')) {\n            filterPopup.classList.add('e-hide');\n        }\n    };\n    /**\n     * Formats cell value for listing it in filter popup.\n     *\n     * @param {any} args - Specifies the args\n     * @param {string | number} args.value - Specify the value\n     * @param {object} args.column - Specify the column\n     * @param {object} args.data - Specify the data\n     * @returns {void} - Formats cell value for listing it in filter popup.\n     */\n    Filter.prototype.filterCboxValueHandler = function (args) {\n        if (args.column && args.data) {\n            var field = args.column.field;\n            if (args.value) {\n                var indexes = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(field + args.data['dataObj']['__rowIndex']);\n                var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(indexes[0], indexes[1], this.parent.getActiveSheet());\n                if (cell && cell.format) {\n                    args.value = this.parent.getDisplayText(cell);\n                }\n            }\n        }\n    };\n    /**\n     * Triggers when sorting items are chosen on context menu of filter popup.\n     *\n     * @param {HTMLElement} target - Specify the element.\n     * @returns {void} - Triggers when sorting items are chosen on context menu of filter popup.\n     */\n    Filter.prototype.selectSortItemHandler = function (target) {\n        var l10n = this.parent.serviceLocator.getService(_index__WEBPACK_IMPORTED_MODULE_0__.locale);\n        var sortOrder = target.classList.contains('e-filter-sortasc') ? 'Ascending'\n            : target.classList.contains('e-filter-sortdesc') ? 'Descending' : null;\n        if (sortOrder === 'Ascending') {\n            target.setAttribute('aria-label', l10n.getConstant('SortAscending'));\n        }\n        else {\n            target.setAttribute('aria-label', l10n.getConstant('SortDescending'));\n        }\n        if (!sortOrder) {\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        var sheetIdx = this.parent.activeSheetIndex;\n        var filterRange = this.filterRange.get(sheetIdx);\n        var range = filterRange.range.slice();\n        if (!filterRange.allowHeaderFilter) {\n            range[0] = range[0] + 1; // to skip first row.\n        }\n        if (!filterRange.useFilterRange) {\n            range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n        }\n        if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isReadOnlyCells)(this.parent, range)) {\n            this.closeDialog();\n            this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_0__.readonlyAlert, null);\n            return;\n        }\n        this.parent.sortCollection = this.parent.sortCollection ? this.parent.sortCollection : [];\n        var prevSort = [];\n        for (var i = this.parent.sortCollection.length - 1; i >= 0; i--) {\n            if (this.parent.sortCollection[i] && this.parent.sortCollection[i].sheetIndex === sheetIdx) {\n                prevSort.push(this.parent.sortCollection[i]);\n                this.parent.sortCollection.splice(i, 1);\n            }\n        }\n        this.parent.sortCollection.push({ sortRange: (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(range), columnIndex: (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getIndexesFromAddress)(sheet.activeCell)[1], order: sortOrder,\n            sheetIndex: sheetIdx });\n        this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_0__.applySort, { sortOptions: { sortDescriptors: { order: sortOrder }, containsHeader: false }, previousSort: prevSort, range: (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(range) });\n        this.refreshFilterRange();\n        this.closeDialog();\n    };\n    /**\n     * Triggers when OK button or clear filter item is selected\n     *\n     * @param {DataManager} dataSource - Specify the data source\n     * @param {Object} args - Specify the data source\n     * @param {string} args.action - Specify the action\n     * @param {PredicateModel[]} args.filterCollection - Specify the filter collection.\n     * @param {string} args.field - Specify the field.\n     * @param {number} args.sIdx - Specify the index.\n     * @param {boolean} args.isInternal - Specify the isInternal.\n     * @param {boolean} args.isFilterByValue - Specify the isFilterByValue.\n     * @param {PredicateModel[]} args.prevPredicates - Specify the prevPredicates.\n     * @param {boolean} args.isOpen - Specify the filtering action is after importing.\n     * @returns {void} - Triggers when OK button or clear filter item is selected\n     */\n    Filter.prototype.filterSuccessHandler = function (dataSource, args) {\n        var sheetIdx = args.sIdx;\n        if (!sheetIdx && sheetIdx !== 0) {\n            sheetIdx = args.isOpen ? 0 : this.parent.activeSheetIndex;\n        }\n        var prevPredicates = args.prevPredicates || [].slice.call(this.filterCollection.get(sheetIdx));\n        if (args.isFilterByValue && !prevPredicates.length) {\n            prevPredicates = undefined;\n        }\n        var predicates = this.filterCollection.get(sheetIdx);\n        this.updatePredicate(predicates, args.field);\n        if (args.action === 'clear-filter' && predicates.length === prevPredicates.length) {\n            return;\n        }\n        if (args.action === 'filtering') {\n            var processWildcards = function (filterCollection) {\n                return filterCollection.map(function (predicate) {\n                    if (predicate && typeof predicate.value === 'string' && predicate.value.includes('*')) {\n                        if (predicate.value.startsWith('*') && predicate.value.endsWith('*')) {\n                            predicate.value = predicate.value.split('*').join('');\n                            predicate.operator = 'contains';\n                        }\n                        else if (predicate.value.endsWith('*')) {\n                            predicate.value = predicate.value.split('*').join('');\n                            predicate.operator = 'startswith';\n                        }\n                        else if (predicate.value.startsWith('*')) {\n                            predicate.value = predicate.value.split('*').join('');\n                            predicate.operator = 'endswith';\n                        }\n                    }\n                    return predicate;\n                });\n            };\n            predicates = predicates.concat(processWildcards(args.filterCollection));\n        }\n        this.filterCollection.set(sheetIdx, predicates);\n        var options = this.getPredicates(predicates);\n        var filterOptions = { datasource: dataSource, predicates: options.predicates,\n            equalOrPredicates: options.equalOrPredicates };\n        var filterRange = this.filterRange.get(sheetIdx);\n        if (!filterRange.useFilterRange) {\n            filterRange.range[2] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSheet)(this.parent, sheetIdx).usedRange.rowIndex; //extend the range if filtered\n        }\n        this.applyFilter(filterOptions, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(filterRange.range), sheetIdx, prevPredicates, false, args.isInternal, args.isFilterByValue);\n    };\n    Filter.prototype.isCustomNumFilter = function (operator) {\n        return operator.includes('greaterthan') || operator.includes('lessthan') || operator === 'between';\n    };\n    Filter.prototype.getClonedPredicates = function (predicates, equalOrFields) {\n        if (equalOrFields === void 0) { equalOrFields = []; }\n        var predicateCol = [];\n        var predicate;\n        var isNumCustomPredicate;\n        for (var i = 0; i < predicates.length; i++) {\n            predicate = predicates[i];\n            if ((this.isCustomNumFilter(predicate.operator) || (!predicate.isFilterByMenu && predicate.operator === 'notequal')) &&\n                (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(predicate.value)) {\n                predicateCol.push(Object.assign({}, predicate, { field: predicate.field + \"_value\", type: 'number' }));\n                isNumCustomPredicate = true;\n            }\n            else {\n                if (!predicate.isFilterByMenu && predicate.operator === 'equal' && predicate.predicate === 'or') {\n                    equalOrFields.push(predicate.field);\n                }\n                predicateCol.push(predicate);\n            }\n        }\n        if (!isNumCustomPredicate && equalOrFields.length) {\n            equalOrFields.splice(0);\n        }\n        return predicateCol;\n    };\n    Filter.prototype.updatePredicate = function (predicates, field) {\n        var dataManager = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(predicates);\n        var query = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Query();\n        var fields = dataManager.executeLocal(query.where('field', 'equal', field));\n        for (var index = 0; index < fields.length; index++) {\n            var sameIndex = -1;\n            for (var filterIndex = 0; filterIndex < predicates.length; filterIndex++) {\n                if (predicates[filterIndex].field === fields[index].field) {\n                    sameIndex = filterIndex;\n                    break;\n                }\n            }\n            if (sameIndex !== -1) {\n                predicates.splice(sameIndex, 1);\n            }\n        }\n    };\n    /**\n     * Triggers events for filtering and applies filter.\n     *\n     * @param {FilterOptions} filterOptions - Specify the filteroptions.\n     * @param {string} range - Specify the range.\n     * @param {number} sheetIdx - Specify the sheet index.\n     * @param {PredicateModel[]} prevPredicates - Specify the predicates.\n     * @param {boolean} refresh - Spefify the refresh.\n     * @param {boolean} isInternal - Specify the isInternal.\n     * @param {boolean} isFilterByValue - Specify the it is filter by value or not.\n     * @returns {void} - Triggers events for filtering and applies filter.\n     */\n    Filter.prototype.applyFilter = function (filterOptions, range, sheetIdx, prevPredicates, refresh, isInternal, isFilterByValue) {\n        var _this = this;\n        var eventArgs = { range: range, predicates: [].slice.call(this.filterCollection.get(sheetIdx)),\n            previousPredicates: prevPredicates, sheetIndex: sheetIdx, cancel: false };\n        if (!isInternal && !isFilterByValue) {\n            this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.beginAction, { action: 'filter', eventArgs: eventArgs });\n            if (eventArgs.cancel) {\n                return;\n            }\n        }\n        if (range.indexOf('!') < 0) {\n            range = this.parent.sheets[sheetIdx].name + '!' + range;\n        }\n        this.parent.showSpinner();\n        var promise = new Promise(function (resolve) { resolve((function () { })()); });\n        var filterArgs = { args: { range: range,\n                filterOptions: filterOptions }, promise: promise, refresh: refresh };\n        var prevChartIndexes = (0,_index__WEBPACK_IMPORTED_MODULE_0__.getChartsIndexes)(this.parent);\n        this.parent.notify(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.initiateFilter, filterArgs);\n        var currentChartIndexes = (0,_index__WEBPACK_IMPORTED_MODULE_0__.getChartsIndexes)(this.parent);\n        this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_0__.refreshChartCellModel, { prevChartIndexes: prevChartIndexes, currentChartIndexes: currentChartIndexes });\n        filterArgs.promise.then(function (args) {\n            _this.refreshFilterRange();\n            _this.parent.hideSpinner();\n            if (!isInternal) {\n                delete eventArgs.cancel;\n                _this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_0__.completeAction, { action: 'filter', eventArgs: eventArgs });\n                if (document.activeElement.id !== _this.parent.element.id + \"_SearchBox\") {\n                    (0,_index__WEBPACK_IMPORTED_MODULE_0__.focus)(_this.parent.element);\n                }\n            }\n            return Promise.resolve(args);\n        }).catch(function (error) {\n            _this.filterRangeAlertHandler({ error: error });\n            return Promise.reject(error);\n        });\n    };\n    /**\n     * Gets the predicates for the sheet\n     *\n     * @param {PredicateModel[]} predicateModel - Specifies the predicate collection.\n     * @returns {Predicate[]} - Gets the predicates for the sheet\n     */\n    Filter.prototype.getPredicates = function (predicateModel) {\n        var equalOrPredicates;\n        var equalOrFields = [];\n        var predicateCol = this.getClonedPredicates(predicateModel, equalOrFields);\n        if (equalOrFields.length) {\n            var field = void 0;\n            var predicate = void 0;\n            var equalOrPredicatesModel = new Map();\n            for (var idx = 0; idx < predicateCol.length; idx++) {\n                field = predicateCol[idx].field.replace('_value', '');\n                if (equalOrFields.indexOf(field) > -1) {\n                    predicate = predicateCol.splice(idx, 1)[0];\n                    idx--;\n                    if (equalOrPredicatesModel.has(field)) {\n                        equalOrPredicatesModel.get(field).push(predicate);\n                    }\n                    else {\n                        equalOrPredicatesModel.set(field, [predicate]);\n                    }\n                }\n            }\n            equalOrPredicates = [];\n            var predicateList_1;\n            equalOrPredicatesModel.forEach(function (predicates) {\n                predicateList_1 = [];\n                var excelPredicate = _syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.CheckBoxFilterBase.getPredicate(predicates);\n                for (var _i = 0, _a = Object.keys(excelPredicate); _i < _a.length; _i++) {\n                    var prop = _a[_i];\n                    predicateList_1.push(excelPredicate[\"\" + prop]);\n                }\n                equalOrPredicates.push(predicateList_1);\n            });\n        }\n        var predicateList = [];\n        var excelPredicate = _syncfusion_ej2_grids__WEBPACK_IMPORTED_MODULE_6__.CheckBoxFilterBase.getPredicate(predicateCol);\n        for (var _i = 0, _a = Object.keys(excelPredicate); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            predicateList.push(excelPredicate[\"\" + prop]);\n        }\n        return { predicates: predicateList, equalOrPredicates: equalOrPredicates };\n    };\n    /**\n     * Gets the column type to pass it into the excel filter options.\n     *\n     * @param {SheetModel} sheet - Specify the sheet.\n     * @param {number} colIndex - Specify the colindex\n     * @param {number[]} range - Specify the range.\n     * @param {boolean} isFilterDialog - Indicates whether the filter dialog UI is open.\n     * @returns {string} - Gets the column type to pass it into the excel filter options.\n     */\n    Filter.prototype.getColumnType = function (sheet, colIndex, range, isFilterDialog) {\n        var num = 0;\n        var str = 0;\n        var date = 0;\n        var time = 0;\n        var cell;\n        var formatOption;\n        var format;\n        var isMultiFormattedCol;\n        for (var i = range[0]; i <= range[2]; i++) {\n            cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(i, colIndex, sheet);\n            if (cell && !(isFilterDialog && !(cell.value || Number(cell.value) === 0))) {\n                if (cell.format && cell.format !== 'General') {\n                    var type = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getTypeFromFormat)(cell.format).toLowerCase();\n                    switch (type) {\n                        case 'number':\n                        case 'currency':\n                        case 'accounting':\n                        case 'percentage':\n                            num++;\n                            break;\n                        case 'shortdate':\n                        case 'longdate':\n                            date++;\n                            break;\n                        case 'time':\n                            num++;\n                            break;\n                        case 'text':\n                            str++;\n                            break;\n                        default:\n                            formatOption = {};\n                            if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isCustomDateTime)(cell.format, true, formatOption)) {\n                                if (formatOption.type === 'date') {\n                                    date++;\n                                }\n                                else {\n                                    num++;\n                                }\n                            }\n                            else if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(cell.value)) {\n                                num++;\n                            }\n                            else if (cell.value) {\n                                str++;\n                            }\n                            break;\n                    }\n                    if (!format) {\n                        format = cell.format;\n                    }\n                }\n                else if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(cell.value)) {\n                    num++;\n                }\n                else if (cell.value) {\n                    str++;\n                }\n                if (format && format !== cell.format) {\n                    isMultiFormattedCol = true;\n                }\n            }\n        }\n        return { type: (num > str && num > date && num > time) ? 'number' : (str >= num && str >= date && str >= time) ? 'string'\n                : (date > num && date > str && date > time) ? 'date' : 'datetime', isDateAvail: !!date, isMultiFormattedCol: isMultiFormattedCol };\n    };\n    /**\n     * Clear filter from the field.\n     *\n     * @param {any} args - Specifies the args\n     * @param {{ field: string }} args.field - Specify the args\n     * @param {boolean} args.isAction - Specify the isAction.\n     * @param {boolean} args.preventRefresh - Specify the preventRefresh.\n     * @param {number} args.sheetIndex - Specify the sheet index value.\n     * @returns {void} - Clear filter from the field.\n     */\n    Filter.prototype.clearFilterHandler = function (args) {\n        var sheetIndex = args && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.isNullOrUndefined)(args.sheetIndex) ? args.sheetIndex : this.parent.activeSheetIndex;\n        if (args && args.field) {\n            var predicates = [].slice.call(this.filterCollection.get(sheetIndex));\n            if (predicates && predicates.length) {\n                this.updatePredicate(predicates, args.field);\n                this.initiateFilterUIHandler({ predicates: predicates, range: (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(this.filterRange.get(sheetIndex).range), sIdx: sheetIndex });\n            }\n        }\n        else {\n            var isAction = args && args.isAction;\n            var filterArgs = { isFiltered: false, isClearAll: true, sheetIndex: sheetIndex };\n            this.getFilteredColumnHandler(filterArgs);\n            if (filterArgs.isFiltered || (args && args.preventRefresh)) {\n                var eventArgs = void 0;\n                var sheet = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSheet)(this.parent, sheetIndex);\n                var filterRange = this.filterRange.get(sheetIndex);\n                var range = filterRange.range;\n                if (isAction) {\n                    eventArgs = { range: (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(range), predicates: [], previousPredicates: this.filterCollection.get(sheetIndex), sheetIndex: sheetIndex, cancel: false };\n                    this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.beginAction, { action: 'filter', eventArgs: eventArgs });\n                    if (eventArgs.cancel) {\n                        return;\n                    }\n                }\n                this.filterCollection.set(sheetIndex, []);\n                var len = filterRange.useFilterRange ? range[2] : sheet.usedRange.rowIndex;\n                if (this.parent.scrollSettings.enableVirtualization && ((len - range[0]) + 1 > (this.parent.viewport.rowCount +\n                    (this.parent.getThreshold('row') * 2)))) {\n                    for (var i = 0; i <= len; i++) {\n                        (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.setRow)(sheet, i, { hidden: false, isFiltered: false });\n                    }\n                    if (!args || !args.preventRefresh) {\n                        this.parent.renderModule.refreshSheet(false, false, true);\n                    }\n                }\n                else {\n                    this.refreshFilterRange(null, null, sheetIndex);\n                    var evtArgs = { startIndex: range[0], hide: false, isFiltering: true, refreshUI: false, endIndex: filterRange.useFilterRange ? range[2] : sheet.usedRange.rowIndex, sheetIndex: sheetIndex };\n                    this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.hideShow, evtArgs);\n                    if (evtArgs.refreshUI && (!args || !args.preventRefresh)) {\n                        this.parent.renderModule.refreshSheet(false, false, true);\n                    }\n                }\n                if (isAction) {\n                    delete eventArgs.cancel;\n                    this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_0__.completeAction, { action: 'filter', eventArgs: eventArgs });\n                    (0,_index__WEBPACK_IMPORTED_MODULE_0__.focus)(this.parent.element);\n                }\n            }\n        }\n    };\n    /**\n     * Reapplies the filter.\n     *\n     * @param {boolean} isInternal - Specifies the isInternal.\n     * @param {boolean} refresh - Specifies the refresh.\n     * @returns {void} - Reapplies the filter.\n     */\n    Filter.prototype.reapplyFilterHandler = function (isInternal, refresh) {\n        var _this = this;\n        var sheetIdx = this.parent.activeSheetIndex;\n        if (this.filterRange.has(sheetIdx)) {\n            var predicates_2 = this.filterCollection.get(sheetIdx);\n            if (predicates_2 && predicates_2.length) {\n                var sheet = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSheet)(this.parent, sheetIdx);\n                var filterRange_1 = this.filterRange.get(sheetIdx);\n                var range = filterRange_1.range.slice();\n                if (!filterRange_1.allowHeaderFilter) {\n                    range[0] = range[0] + 1;\n                }\n                if (!filterRange_1.useFilterRange) {\n                    range[2] = sheet.usedRange.rowIndex;\n                }\n                range[1] = range[3] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColIndex)(predicates_2[0].field);\n                var addr = sheet.name + \"!\" + this.getPredicateRange(range, predicates_2.slice(1, predicates_2.length));\n                (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getData)(this.parent, addr, true, true, null, true, null, null, false, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(range)).then(function (jsonData) {\n                    var options = _this.getPredicates(_this.filterCollection.get(sheetIdx));\n                    _this.applyFilter({ predicates: options.predicates, datasource: new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(jsonData),\n                        equalOrPredicates: options.equalOrPredicates }, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(filterRange_1.range), sheetIdx, [].slice.call(predicates_2), refresh, isInternal);\n                });\n            }\n        }\n    };\n    /**\n     * Gets the filter information of the sheet.\n     *\n     * @param {FilterInfoArgs} args - Specify the args\n     * @returns {void} - Gets the filter information of the sheet.\n     */\n    Filter.prototype.getFilterRangeHandler = function (args) {\n        var sheetIdx = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.isNullOrUndefined)(args.sheetIdx) ? this.parent.activeSheetIndex : args.sheetIdx;\n        var filterOption = this.filterRange && this.filterRange.get(sheetIdx);\n        if (filterOption) {\n            args.hasFilter = true;\n            args.filterRange = filterOption.range;\n            args.allowHeaderFilter = filterOption.allowHeaderFilter;\n            args.isFiltered = this.filterCollection && this.filterCollection.get(sheetIdx) &&\n                this.filterCollection.get(sheetIdx).length > 0;\n        }\n        else {\n            args.hasFilter = false;\n            args.filterRange = null;\n        }\n    };\n    /**\n     * Returns the custom operators for filter items.\n     *\n     * @returns {Object} - Returns the custom operators for filter items.\n     */\n    Filter.prototype.getLocalizedCustomOperators = function () {\n        var l10n = this.parent.serviceLocator.getService(_index__WEBPACK_IMPORTED_MODULE_0__.locale);\n        var numOptr = [\n            { value: 'equal', text: l10n.getConstant('Equal') },\n            { value: 'greaterthan', text: l10n.getConstant('GreaterThan') },\n            { value: 'greaterthanorequal', text: l10n.getConstant('GreaterThanOrEqual') },\n            { value: 'lessthan', text: l10n.getConstant('LessThan') },\n            { value: 'lessthanorequal', text: l10n.getConstant('LessThanOrEqual') },\n            { value: 'notequal', text: l10n.getConstant('NotEqual') }\n        ];\n        var customOperators = {\n            stringOperator: [\n                { value: 'startswith', text: l10n.getConstant('StartsWith') },\n                { value: 'endswith', text: l10n.getConstant('EndsWith') },\n                { value: 'contains', text: l10n.getConstant('Contains') },\n                { value: 'equal', text: l10n.getConstant('Equal') },\n                { value: 'isempty', text: l10n.getConstant('IsEmpty') },\n                { value: 'doesnotstartwith', text: l10n.getConstant('NotStartsWith') },\n                { value: 'doesnotendwith', text: l10n.getConstant('NotEndsWith') },\n                { value: 'doesnotcontain', text: l10n.getConstant('NotContains') },\n                { value: 'notequal', text: l10n.getConstant('NotEqual') },\n                { value: 'isnotempty', text: l10n.getConstant('IsNotEmpty') }\n            ],\n            numberOperator: numOptr,\n            dateOperator: numOptr,\n            datetimeOperator: numOptr,\n            booleanOperator: [\n                { value: 'equal', text: l10n.getConstant('Equal') },\n                { value: 'notequal', text: l10n.getConstant('NotEqual') }\n            ]\n        };\n        return customOperators;\n    };\n    /**\n     * To set the filtered range and predicates collections in the save JSON object.\n     *\n     * @param {any} args - Specifies the args\n     * @param {number} args.sheetIdx - Specifies the sheet index value.\n     * @param {boolean} args.isSaveAction - Specifies the Save action.\n     * @param {any} args.saveJson - Specifies save as Json.\n     * @param {FilterCollectionModel[]} args.saveJson.filterCollection - Specifies the filter collection values.\n     * @returns {void}\n     */\n    Filter.prototype.setFilteredCollection = function (args) {\n        var _this = this;\n        var filterArgs = { sheetIdx: args.sheetIdx };\n        this.getFilterRangeHandler(filterArgs);\n        if (filterArgs.hasFilter) {\n            var filterModel_1 = { sheetIndex: args.sheetIdx, filterRange: (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(filterArgs.filterRange),\n                hasFilter: true, column: [], criteria: [], value: [], dataType: [], predicates: [] };\n            args.saveJson.filterCollection.push(filterModel_1);\n            var predicates = this.filterCollection.get(args.sheetIdx);\n            var predicateMap = new Map();\n            var predicate = void 0;\n            var type_1;\n            var getPredicateValue_1 = function (val) {\n                if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.isNullOrUndefined)(val)) {\n                    return '';\n                }\n                else if (args.isSaveAction && type_1 === 'date') {\n                    var dateVal = val;\n                    val = dateVal.getMonth() + 1 + \"/\" + dateVal.getDate() + \"/\" + dateVal.getFullYear() + \" \" + dateVal.getHours() + \":\" + dateVal.getMinutes() + \":\" + dateVal.getSeconds();\n                }\n                return val;\n            };\n            for (var idx = 0; idx < predicates.length; idx++) {\n                predicate = predicates[idx];\n                if (args.isSaveAction && predicate.operator === 'notequal' && predicate.isFilterByMenu) {\n                    if (predicateMap.has(predicate.field)) {\n                        predicateMap.get(predicate.field).push(predicate);\n                    }\n                    else {\n                        predicateMap.set(predicate.field, [predicate]);\n                    }\n                }\n                else {\n                    filterModel_1.column.push((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColIndex)(predicate.field));\n                    filterModel_1.criteria.push(predicate.operator);\n                    if (args.isSaveAction) {\n                        if (predicate.operator === 'equal') {\n                            type_1 = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isDateTime)(predicate.value) ? 'date' : 'string';\n                            filterModel_1.value.push(getPredicateValue_1(predicate.value));\n                            filterModel_1.dataType.push(type_1);\n                        }\n                        else {\n                            filterModel_1.value.push(predicate.value);\n                            filterModel_1.dataType.push('custom');\n                        }\n                    }\n                    else {\n                        filterModel_1.value.push(predicate.value);\n                        filterModel_1.dataType.push(predicate.type);\n                    }\n                    filterModel_1.predicates.push(predicate.predicate);\n                }\n            }\n            var colDataMap_1 = new Map();\n            var colIdx_2;\n            predicateMap.forEach(function (predicate, field) {\n                colIdx_2 = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColIndex)(field);\n                if (!colDataMap_1.has(field)) {\n                    colDataMap_1.set(field, _this.getColData(colIdx_2, field, args.sheetIdx));\n                }\n                var colData = colDataMap_1.get(field);\n                var predicateCol = _this.getPredicates(predicate).predicates;\n                var filteredData = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(colData).executeLocal(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Query().where(_syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Predicate.and(predicateCol)));\n                for (var idx = 0; idx < filteredData.length; idx++) {\n                    filterModel_1.column.push(colIdx_2);\n                    filterModel_1.criteria.push('equal');\n                    type_1 = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isDateTime)(filteredData[idx][field]) ? 'date' : 'string';\n                    filterModel_1.value.push(getPredicateValue_1(filteredData[idx][field]));\n                    filterModel_1.dataType.push(type_1);\n                    filterModel_1.predicates.push('or');\n                }\n            });\n        }\n    };\n    Filter.prototype.updateFilter = function (args) {\n        if (this.parent.filterCollection && (args.initLoad || args.isOpen)) {\n            var datePredicate = void 0;\n            var predicates = void 0;\n            var filterCol = void 0;\n            var dateColData = {};\n            var filteredData = void 0;\n            var predicateCol = void 0;\n            var filterOption = void 0;\n            for (var i = 0; i < this.parent.filterCollection.length; i++) {\n                filterCol = this.parent.filterCollection[i];\n                var sIdx = filterCol.sheetIndex;\n                if (i === 0 && !this.parent.isOpen && !args.isOpen) {\n                    sIdx = 0;\n                }\n                predicates = [];\n                if (filterCol.column) {\n                    for (var j = 0; j < filterCol.column.length; j++) {\n                        predicateCol = {\n                            field: (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColumnHeaderText)(filterCol.column[j] + 1),\n                            operator: this.getFilterOperator(filterCol.criteria[j]), value: typeof filterCol.value[j]\n                                === 'string' ? filterCol.value[j].split('*').join('') : filterCol.value[j],\n                            predicate: filterCol.predicates && filterCol.predicates[j],\n                            type: filterCol.dataType && filterCol.dataType[j]\n                        };\n                        if (['year', 'month', 'day'].indexOf(predicateCol.type) > -1) {\n                            var dateEventArgs = { value: predicateCol.value,\n                                cell: { value: predicateCol.value } };\n                            this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.checkDateFormat, dateEventArgs);\n                            if (dateEventArgs.isDate) {\n                                var predicateVal = dateEventArgs.dateObj;\n                                predicateCol.value = predicateVal;\n                                if (predicateCol.type === 'day') {\n                                    predicateCol.type = 'date';\n                                    predicateCol.predicate = 'or';\n                                    predicates.push(predicateCol);\n                                }\n                                else {\n                                    predicateCol.operator = 'greaterthanorequal';\n                                    predicateCol.predicate = 'and';\n                                    var type = predicateCol.type;\n                                    predicateCol.type = 'date';\n                                    datePredicate = this.getPredicates([predicateCol, { field: predicateCol.field, operator: 'lessthanorequal', predicate: 'and',\n                                            type: 'date', value: new Date(predicateVal.getFullYear(), type === 'year' ? 12 :\n                                                predicateVal.getMonth() + 1, 0, 0, 0, 0) }]).predicates;\n                                    if (!dateColData[predicateCol.field]) {\n                                        dateColData[predicateCol.field] = this.getColData(filterCol.column[j], predicateCol.field, i);\n                                    }\n                                    filteredData = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.DataManager(dateColData[predicateCol.field]).executeLocal(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Query().where(_syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_7__.Predicate.and(datePredicate)));\n                                    for (var k = 0; k < filteredData.length; k++) {\n                                        predicates.push({ field: predicateCol.field, operator: 'equal', predicate: 'or', type: 'date',\n                                            value: filteredData[k][predicateCol.field] });\n                                    }\n                                }\n                            }\n                        }\n                        else {\n                            filterOption = { isOpen: true, instance: { options: { type: predicateCol.type } },\n                                arg3: predicateCol.value, arg2: predicateCol.operator };\n                            this.beforeFilteringHandler(filterOption);\n                            predicateCol.value = filterOption.arg3;\n                            if (predicateCol.type === 'string' || predicateCol.type === 'custom') {\n                                if (this.isCustomNumFilter(predicateCol.operator) && (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isNumber)(predicateCol.value)) {\n                                    predicateCol.type = 'number';\n                                }\n                            }\n                            else if (predicateCol.type === 'date' && predicateCol.operator === 'equal' &&\n                                typeof predicateCol.value === 'string' && predicateCol.value.includes('/') &&\n                                predicateCol.value.includes(':')) {\n                                var dateTimeStr = predicateCol.value.split(' ');\n                                if (dateTimeStr.length === 2) {\n                                    var dateArr = dateTimeStr[0].split('/');\n                                    var timeArr = dateTimeStr[1].split(':');\n                                    if (dateArr.length === 3 && timeArr.length === 3) {\n                                        predicateCol.value = new Date(Number(dateArr[2]), Number(dateArr[0]) - 1, Number(dateArr[1]), Number(timeArr[0]), Number(timeArr[1]), Number(timeArr[2]));\n                                    }\n                                }\n                            }\n                            predicates.push(predicateCol);\n                        }\n                    }\n                }\n                if (!args.isOpen) {\n                    for (var i_1 = 0; i_1 < predicates.length - 1; i_1++) {\n                        if (predicates[i_1].field === predicates[i_1 + 1].field) {\n                            if (!predicates[i_1].predicate) {\n                                predicates[i_1].predicate = 'or';\n                            }\n                            if (!predicates[i_1 + 1].predicate) {\n                                predicates[i_1 + 1].predicate = 'or';\n                            }\n                        }\n                    }\n                }\n                this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_0__.initiateFilterUI, { predicates: predicates.length ? predicates : undefined, range: filterCol.filterRange, sIdx: sIdx, isInternal: true, isOpen: args.isOpen });\n            }\n            if (this.parent.sortCollection) {\n                this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.sortImport, null);\n            }\n            this.parent.setProperties({ filterCollection: null }, true);\n        }\n    };\n    Filter.prototype.getColData = function (colIdx, field, sheetIdx) {\n        var sheet = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSheet)(this.parent, sheetIdx);\n        if (!sheet.rows || !sheet.rows.length) {\n            return [];\n        }\n        var rows = [];\n        var row;\n        var cell;\n        for (var rowIdx = 1, rowLen = sheet.rows.length; rowIdx < rowLen; rowIdx++) {\n            if (sheet.rows[rowIdx]) {\n                cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(rowIdx, colIdx, sheet, false, true);\n                if (cell && cell.value) {\n                    row = {};\n                    row[field] = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getValueFromFormat)(this.parent, cell, rowIdx, colIdx);\n                    rows.push(row);\n                }\n            }\n        }\n        return rows;\n    };\n    Filter.prototype.getFilterOperator = function (value) {\n        switch (value) {\n            case 'BeginsWith':\n                value = 'startswith';\n                break;\n            case 'Less':\n                value = 'lessthan';\n                break;\n            case 'EndsWith':\n                value = 'endswith';\n                break;\n            case 'Equal':\n                value = 'equal';\n                break;\n            case 'Notequal':\n                value = 'notEqual';\n                break;\n            case 'Greater':\n                value = 'greaterthan';\n                break;\n            case 'Contains':\n                value = 'contains';\n                break;\n            case 'LessOrEqual':\n                value = 'lessthanorequal';\n                break;\n            case 'GreaterOrEqual':\n                value = 'greaterthanorequal';\n                break;\n            case 'NotContains':\n                value = 'doesnotcontain';\n                break;\n            case 'NotBeginsWith':\n                value = 'doesnotstartwith';\n                break;\n            case 'NotEndsWith':\n                value = 'doesnotendwith';\n                break;\n            case 'Empty':\n                value = 'isempty';\n                break;\n            case 'NotEmpty':\n                value = 'isnotempty';\n                break;\n        }\n        return value;\n    };\n    Filter.prototype.beforeInsertHandler = function (args) {\n        if (args.modelType === 'Column') {\n            var sheetIdx_1 = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.isUndefined)(args.activeSheetIndex) ? this.parent.activeSheetIndex : args.activeSheetIndex;\n            if (this.filterRange.size && this.filterRange.has(sheetIdx_1)) {\n                var range = this.filterRange.get(sheetIdx_1).range;\n                if (this.isFilterCell(sheetIdx_1, range[0], args.index) || args.index < range[1]) {\n                    range[3] += args.model.length;\n                    if (args.index <= range[1]) {\n                        range[1] += args.model.length;\n                    }\n                    this.filterCollection.get(sheetIdx_1).forEach(function (predicate) {\n                        var colIdx = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColIndex)(predicate.field);\n                        if (args.index <= colIdx) {\n                            predicate.field = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColumnHeaderText)(colIdx + args.model.length + 1);\n                        }\n                    });\n                    if (this.parent.sortCollection) {\n                        this.parent.sortCollection.forEach(function (sortCollection) {\n                            if (sortCollection.sheetIndex === sheetIdx_1 && args.index <= sortCollection.columnIndex) {\n                                sortCollection.columnIndex += args.model.length;\n                            }\n                        });\n                    }\n                }\n            }\n        }\n        else if (args.modelType === 'Sheet') {\n            for (var _i = 0, _a = Array.from(this.filterRange.keys()).sort().reverse(); _i < _a.length; _i++) {\n                var key = _a[_i];\n                if (args.index <= key) {\n                    this.filterRange.set(key + args.model.length, this.filterRange.get(key));\n                    this.filterRange.delete(key);\n                    this.filterCollection.set(key + args.model.length, this.filterCollection.get(key));\n                    this.filterCollection.delete(key);\n                }\n            }\n            if (this.parent.sortCollection) {\n                this.parent.sortCollection.forEach(function (sortCollection) {\n                    if (args.index <= sortCollection.sheetIndex) {\n                        sortCollection.sheetIndex += args.model.length;\n                    }\n                });\n            }\n        }\n    };\n    Filter.prototype.beforeDeleteHandler = function (args) {\n        if (args.modelType === 'Column') {\n            var sheetIdx = this.parent.activeSheetIndex;\n            if (this.filterRange.size && this.filterRange.has(sheetIdx)) {\n                var isChanged = true;\n                var range = this.filterRange.get(sheetIdx).range;\n                if (args.start >= range[1] && args.end <= range[3]) { // in between\n                    range[3] -= args.end - args.start + 1;\n                }\n                else if (args.start < range[1] && args.end < range[1]) { // before\n                    range[1] -= args.end - args.start + 1;\n                    range[3] -= args.end - args.start + 1;\n                }\n                else if (args.start < range[1] && args.end > range[1] && args.end < range[3]) { // from before to inbetween\n                    range[1] = args.start;\n                    range[3] -= args.end - args.start + 1;\n                }\n                else {\n                    isChanged = false;\n                }\n                if (isChanged) {\n                    var filterCollection = this.filterCollection.get(sheetIdx);\n                    var isPredicateRemoved = void 0;\n                    for (var i = filterCollection.length - 1; i >= 0; i--) {\n                        var colIdx = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColIndex)(filterCollection[i].field);\n                        if (args.end < colIdx) {\n                            filterCollection[i].field = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColumnHeaderText)(colIdx - (args.end - args.start + 1) + 1);\n                        }\n                        else if (args.start <= colIdx && args.end >= colIdx) {\n                            isPredicateRemoved = true;\n                            filterCollection.splice(i, 1);\n                        }\n                    }\n                    var sortColl = this.parent.sortCollection;\n                    if (sortColl) {\n                        for (var i = 0; i < sortColl.length; i++) {\n                            if (sortColl[i].sheetIndex === sheetIdx) {\n                                if (args.end < sortColl[i].columnIndex) {\n                                    sortColl[i].columnIndex = sortColl[i].columnIndex - (args.end - args.start + 1);\n                                    break;\n                                }\n                                else if (args.start <= sortColl[i].columnIndex && args.end >= sortColl[i].columnIndex) {\n                                    sortColl.splice(i, 1);\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                    if (range.some(function (value) { return value < 0; })) {\n                        this.removeFilter(sheetIdx, true, true);\n                        args.refreshSheet = true;\n                    }\n                    else if (isPredicateRemoved) {\n                        if (filterCollection && filterCollection.length) {\n                            this.reapplyFilterHandler(true, true);\n                            args.refreshSheet = false;\n                        }\n                        else {\n                            this.clearFilterHandler({ preventRefresh: true });\n                            args.refreshSheet = true;\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Filter.prototype.deleteSheetHandler = function (args) {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.isUndefined)(args.sheetIndex)) {\n            for (var _i = 0, _a = Array.from(this.filterRange.keys()).sort().reverse(); _i < _a.length; _i++) {\n                var key = _a[_i];\n                if (args.sheetIndex === key) {\n                    this.filterRange.delete(key);\n                    this.filterCollection.delete(key);\n                }\n                else if (args.sheetIndex < key) {\n                    this.filterRange.set(key - 1, this.filterRange.get(key));\n                    this.filterRange.delete(key);\n                    this.filterCollection.set(key - 1, this.filterCollection.get(key));\n                    this.filterCollection.delete(key);\n                }\n            }\n            var sortColl = this.parent.sortCollection;\n            if (sortColl) {\n                for (var i = sortColl.length - 1; i >= 0; i--) {\n                    if (args.sheetIndex === sortColl[i].sheetIndex) {\n                        sortColl.splice(i, 1);\n                    }\n                    else if (args.sheetIndex < sortColl[i].sheetIndex) {\n                        sortColl[i].sheetIndex -= 1;\n                    }\n                }\n            }\n        }\n        else if (this.filterRange.get(this.parent.activeSheetIndex)) {\n            this.filterRange.delete(this.parent.activeSheetIndex);\n            this.filterCollection.delete(this.parent.activeSheetIndex);\n        }\n    };\n    Filter.prototype.clearHandler = function (args) {\n        var info = this.parent.getAddressInfo(args.range);\n        if (this.filterRange.has(info.sheetIndex)) {\n            var indexes = this.filterRange.get(info.sheetIndex).range.slice();\n            if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.inRange)(info.indices, indexes[0], indexes[1]) && (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.inRange)(info.indices, indexes[0], indexes[3])) {\n                this.removeFilter(info.sheetIndex, null, null, true);\n            }\n        }\n    };\n    Filter.prototype.duplicateSheetFilterHandler = function (args) {\n        for (var _i = 0, _a = Array.from(this.filterRange.keys()).sort().reverse(); _i < _a.length; _i++) {\n            var key = _a[_i];\n            if (args.newSheetIndex <= key) {\n                this.filterRange.set(key + 1, this.filterRange.get(key));\n                this.filterRange.delete(key);\n                this.filterCollection.set(key + 1, this.filterCollection.get(key));\n                this.filterCollection.delete(key);\n            }\n            else {\n                break;\n            }\n        }\n        if (this.filterCollection.has(args.sheetIndex)) {\n            this.filterCollection.set(args.newSheetIndex, this.filterCollection.get(args.sheetIndex).slice());\n        }\n        if (this.filterRange.has(args.sheetIndex)) {\n            var filterRange = this.filterRange.get(args.sheetIndex);\n            this.filterRange.set(args.newSheetIndex, {\n                useFilterRange: filterRange.useFilterRange, range: filterRange.range.slice(),\n                allowHeaderFilter: filterRange.allowHeaderFilter\n            });\n        }\n    };\n    Filter.prototype.updateSortCollectionHandler = function (args) {\n        var _a;\n        if (args.isDuplicate) {\n            if (this.parent.sortCollection && this.parent.sortCollection.length > 0) {\n                var newSortCollection = [];\n                for (var j = 0; j < this.parent.sortCollection.length; j++) {\n                    var sortCol = this.parent.sortCollection[j];\n                    if (sortCol.sheetIndex === args.curSheetIndex) {\n                        var updatedSortCol = Object.assign({}, sortCol);\n                        updatedSortCol.sheetIndex = args.newSheetIndex;\n                        newSortCollection.push(updatedSortCol);\n                    }\n                }\n                (_a = this.parent.sortCollection).push.apply(_a, newSortCollection);\n            }\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        var sheetIdx = this.parent.activeSheetIndex;\n        var filterRange = this.filterRange.get(sheetIdx);\n        if (filterRange) {\n            var range = filterRange.range.slice();\n            if (!filterRange.allowHeaderFilter) {\n                range[0] = range[0] + 1; // to skip first row.\n            }\n            if (!filterRange.useFilterRange) {\n                range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n            }\n            var sortDescriptors = args.sortOptions.sortDescriptors;\n            this.parent.sortCollection = this.parent.sortCollection ? this.parent.sortCollection : [];\n            if (Array.isArray(sortDescriptors)) {\n                for (var i = 0; i < sortDescriptors.length; i++) {\n                    this.parent.sortCollection.push({\n                        sortRange: (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(range), columnIndex: (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColIndex)(sortDescriptors[i].field),\n                        order: sortDescriptors[i].order, sheetIndex: sheetIdx\n                    });\n                }\n            }\n            else {\n                this.parent.sortCollection.push({\n                    sortRange: (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(range), columnIndex: (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getIndexesFromAddress)(sheet.activeCell)[1],\n                    order: sortDescriptors.order, sheetIndex: sheetIdx\n                });\n            }\n        }\n    };\n    Filter.prototype.moveSheetHandler = function (args) {\n        var prevSheetFilterRange;\n        var currentSheetFilterRange;\n        var prevSheetFilterCollection;\n        var currentSheetFilterCollection;\n        if (this.filterRange.has(args.prevIndex)) {\n            prevSheetFilterRange = this.filterRange.get(args.prevIndex);\n            prevSheetFilterCollection = this.filterCollection.get(args.prevIndex);\n        }\n        if (this.filterRange.has(args.currentIndex)) {\n            currentSheetFilterRange = this.filterRange.get(args.currentIndex);\n            currentSheetFilterCollection = this.filterCollection.get(args.currentIndex);\n        }\n        if (prevSheetFilterRange && currentSheetFilterRange) {\n            this.filterRange.set(args.currentIndex, prevSheetFilterRange);\n            this.filterRange.set(args.prevIndex, currentSheetFilterRange);\n            this.filterCollection.set(args.currentIndex, prevSheetFilterCollection);\n            this.filterCollection.set(args.prevIndex, currentSheetFilterCollection);\n        }\n        else if (prevSheetFilterRange) {\n            this.filterRange.set(args.currentIndex, prevSheetFilterRange);\n            this.filterRange.delete(args.prevIndex);\n            this.filterCollection.set(args.currentIndex, prevSheetFilterCollection);\n            this.filterCollection.delete(args.prevIndex);\n        }\n        else if (currentSheetFilterRange) {\n            this.filterRange.set(args.prevIndex, currentSheetFilterRange);\n            this.filterRange.delete(args.currentIndex);\n            this.filterCollection.set(args.prevIndex, currentSheetFilterCollection);\n            this.filterCollection.delete(args.currentIndex);\n        }\n    };\n    Filter.prototype.refreshFilterCellsOnResize = function (args) {\n        var range = this.filterRange.has(this.parent.activeSheetIndex) &&\n            this.filterRange.get(this.parent.activeSheetIndex).range;\n        if (range && range[0] === args.rowIndex) {\n            var sheet = this.parent.getActiveSheet();\n            for (var colIdx = range[1]; colIdx <= range[3]; colIdx++) {\n                if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(args.rowIndex, colIdx, sheet, false, true).notes) {\n                    var cellEle = this.parent.getCell(args.rowIndex, colIdx);\n                    if (cellEle) {\n                        this.parent.serviceLocator.getService('cell').refresh(args.rowIndex, colIdx, false, cellEle, false, false, true);\n                    }\n                }\n            }\n        }\n    };\n    return Filter;\n}());\n\n\n\n//# sourceURL=webpack://ej2-vue-samples/./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/integrations/filter.js?");

/***/ })

}]);