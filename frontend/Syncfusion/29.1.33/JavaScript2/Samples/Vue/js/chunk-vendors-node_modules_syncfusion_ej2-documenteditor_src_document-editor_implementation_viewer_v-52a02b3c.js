"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkej2_vue_samples"] = self["webpackChunkej2_vue_samples"] || []).push([["chunk-vendors-node_modules_syncfusion_ej2-documenteditor_src_document-editor_implementation_viewer_v-52a02b3c"],{

/***/ "./node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/viewer/viewer.js":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/viewer/viewer.js ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ColumnLayout: () => (/* binding */ ColumnLayout),\n/* harmony export */   DocumentHelper: () => (/* binding */ DocumentHelper),\n/* harmony export */   LayoutViewer: () => (/* binding */ LayoutViewer),\n/* harmony export */   PageLayoutViewer: () => (/* binding */ PageLayoutViewer),\n/* harmony export */   WebLayoutViewer: () => (/* binding */ WebLayoutViewer)\n/* harmony export */ });\n/* harmony import */ var _base_dictionary__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../base/dictionary */ \"./node_modules/@syncfusion/ej2-documenteditor/src/document-editor/base/dictionary.js\");\n/* harmony import */ var _list_abstract_list__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../list/abstract-list */ \"./node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/list/abstract-list.js\");\n/* harmony import */ var _list_level_override__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../list/level-override */ \"./node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/list/level-override.js\");\n/* harmony import */ var _format_index__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../format/index */ \"./node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/format/index.js\");\n/* harmony import */ var _layout__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./layout */ \"./node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/viewer/layout.js\");\n/* harmony import */ var _render__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./render */ \"./node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/viewer/render.js\");\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"./node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _page__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./page */ \"./node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/viewer/page.js\");\n/* harmony import */ var _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../editor/editor-helper */ \"./node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/editor/editor-helper.js\");\n/* harmony import */ var _text_helper__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./text-helper */ \"./node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/viewer/text-helper.js\");\n/* harmony import */ var _index__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../index */ \"./node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/index.js\");\n/* harmony import */ var _zooming__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./zooming */ \"./node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/viewer/zooming.js\");\n/* harmony import */ var _syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @syncfusion/ej2-popups */ \"./node_modules/@syncfusion/ej2-popups/index.js\");\n/* harmony import */ var _base_index__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../base/index */ \"./node_modules/@syncfusion/ej2-documenteditor/src/document-editor/base/index.js\");\n/* harmony import */ var _restrict_editing_restrict_editing_pane__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../restrict-editing/restrict-editing-pane */ \"./node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/restrict-editing/restrict-editing-pane.js\");\n/* harmony import */ var _dialogs_form_field_popup__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../dialogs/form-field-popup */ \"./node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/dialogs/form-field-popup.js\");\n/* harmony import */ var _dialogs_content_control_popup__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../dialogs/content-control-popup */ \"./node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/dialogs/content-control-popup.js\");\n/* harmony import */ var _track_changes_track_changes_pane__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../track-changes/track-changes-pane */ \"./node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/track-changes/track-changes-pane.js\");\n/* harmony import */ var _themes_themes__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../themes/themes */ \"./node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/themes/themes.js\");\n/* harmony import */ var _base_constants__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../base/constants */ \"./node_modules/@syncfusion/ej2-documenteditor/src/document-editor/base/constants.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n/* eslint-disable */\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * @private\n */\nvar DocumentHelper = /** @class */ (function () {\n    //#endregion\n    function DocumentHelper(owner) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.isCompleted = true;\n        /**\n         * @private\n         * To set the copied content to the clipboard. Reserved for internal use.\n         */\n        this.isCopying = false;\n        /**\n         * @private\n         */\n        this.isSelectionCompleted = true;\n        /**\n         * @private\n         */\n        this.scrollbarWidth = 0;\n        /**\n         * @private\n         */\n        this.isWebPrinting = false;\n        /**\n         * @private\n         */\n        this.isHeaderFooter = false;\n        /**\n         * @private\n         */\n        this.isSpellCheckPending = false;\n        /**\n         * @private\n         */\n        this.currentPage = undefined;\n        this.selectionStartPageIn = undefined;\n        this.selectionEndPageIn = undefined;\n        /**\n         * @private\n         */\n        this.fieldStacks = [];\n        /**\n         * @private\n         */\n        this.showRevision = false;\n        /**\n         * @private\n         */\n        this.splittedCellWidgets = [];\n        /**\n         * @private\n         */\n        this.tableLefts = [];\n        /**\n         * @private\n         */\n        this.tapCount = 0;\n        this.timer = -1;\n        this.isTimerStarted = false;\n        /**\n         * @private\n         */\n        this.isFirstLineFitInShiftWidgets = false;\n        /**\n         * @private\n         */\n        this.preZoomFactor = 0;\n        /**\n         * @private\n         */\n        this.preDifference = -1;\n        /**\n         * @private\n         */\n        this.isDragging = false;\n        /**\n         * @private\n         */\n        this.fieldEndParagraph = undefined;\n        /**\n         * @private\n         */\n        this.fieldToLayout = undefined;\n        /**\n         * @private\n         */\n        this.backgroundColor = '#FFFFFF';\n        // Event\n        /**\n         * @private\n         */\n        this.isMouseDown = false;\n        this.isMouseEntered = false;\n        this.scrollMoveTimer = 0;\n        /**\n         * @private\n         */\n        this.isSelectionChangedOnMouseMoved = false;\n        /**\n         * @private\n         */\n        this.isControlPressed = false;\n        /**\n         * @private\n         */\n        this.isTouchInput = false;\n        /**\n         * @private\n         */\n        this.isTouchMoved = false;\n        /**\n         * @private\n         */\n        this.useTouchSelectionMark = false;\n        /**\n         * @private\n         */\n        this.touchDownOnSelectionMark = 0;\n        /**\n         * @private\n         */\n        this.isComposingIME = false;\n        /**\n         * @private\n         */\n        this.lastComposedText = '';\n        /**\n         * @private\n         */\n        this.isCompositionStart = false;\n        /**\n         * @private\n         */\n        this.isCompositionUpdated = false;\n        /**\n         * @private\n         */\n        this.isCompositionCanceled = false;\n        /**\n         * @private\n         */\n        this.isCompositionEnd = false;\n        /**\n         * @private\n         */\n        this.prefix = '';\n        /**\n         * @private\n         */\n        this.suffix = '';\n        /**\n         * @private\n         */\n        this.fields = [];\n        /**\n         * @private\n         */\n        this.heightInfoCollection = {};\n        /**\n         * @private\n         */\n        this.defaultTabWidth = 36;\n        /**\n         * @private\n         */\n        this.dontUseHtmlParagraphAutoSpacing = false;\n        /**\n         * @private\n         */\n        this.allowSpaceOfSameStyleInTable = false;\n        /**\n         * @private\n         */\n        this.alignTablesRowByRow = false;\n        /**\n         * @private\n         */\n        this.compatibilityMode = 'Word2013';\n        /**\n         * @private\n         */\n        this.lists = [];\n        /**\n         * @private\n         */\n        this.comments = [];\n        /**\n         * @private\n         */\n        this.authors = new _base_dictionary__WEBPACK_IMPORTED_MODULE_0__.Dictionary();\n        /**\n         * @private\n         */\n        this.revisionsInternal = new _base_dictionary__WEBPACK_IMPORTED_MODULE_0__.Dictionary();\n        /**\n         * @private\n         */\n        this.commentUserOptionId = 1;\n        /**\n         * @private\n         */\n        this.abstractLists = [];\n        /**\n         * @private\n         */\n        this.styles = new _format_index__WEBPACK_IMPORTED_MODULE_3__.WStyles();\n        /**\n         * @private\n         */\n        this.stylesMap = new _base_dictionary__WEBPACK_IMPORTED_MODULE_0__.Dictionary();\n        /**\n         * @private\n         */\n        this.preDefinedStyles = undefined;\n        /**\n         * @private\n         */\n        this.isRowOrCellResizing = false;\n        /**\n         * @private\n         */\n        this.endBookmarksUpdated = [];\n        /**\n         * @private\n         */\n        this.formFields = [];\n        this.isMouseDownInFooterRegion = false;\n        this.pageFitTypeIn = 'None';\n        /**\n         * @private\n         */\n        this.fieldCollection = [];\n        /**\n         * @private\n         */\n        this.isPageField = false;\n        /**\n         * @private\n         */\n        this.mouseDownOffset = new _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.Point(0, 0);\n        this.zoomFactorInternal = 1;\n        /**\n         * If movecaretposition is 1, Home key is pressed\n         * If moveCaretPosition is 2, End key is pressed\n         *\n         * @private\n         */\n        this.moveCaretPosition = 0;\n        /**\n         * @private\n         */\n        this.isTextInput = false;\n        /**\n         * @private\n         */\n        this.isScrollHandler = false;\n        /**\n         * @private\n         */\n        this.triggerElementsOnLoading = false;\n        /**\n         * @private\n         */\n        this.triggerSpellCheck = false;\n        //Document Protection Properties Starts\n        /**\n         * preserve the format\n         *\n         * @private\n         */\n        this.restrictFormatting = false;\n        /**\n         * preserve the document protection type either readonly or no protection\n         *\n         * @private\n         */\n        this.protectionType = 'NoProtection';\n        /**\n         * Preserve the password protection is enforced or not\n         *\n         * @private\n         */\n        this.isDocumentProtected = false;\n        /**\n         * preserve the hash value of password\n         *\n         * @private\n         */\n        this.hashValue = '';\n        /**\n         * @private\n         */\n        this.saltValue = '';\n        /**\n         * @private\n         */\n        this.userCollection = [];\n        /**\n         * @private\n         */\n        this.cachedPages = [];\n        /**\n         * @private\n         */\n        this.skipScrollToPosition = false;\n        /**\n         * @private\n         */\n        this.isIosDevice = false;\n        /**\n         * @private\n         */\n        this.isMobileDevice = false;\n        /**\n         * @private\n         */\n        this.isLinuxOS = false;\n        /**\n         * @private\n         */\n        this.isFormFilling = false;\n        /**\n         * @private\n         */\n        this.fontSubstitutionTable = undefined;\n        /**\n         * @private\n         */\n        this.themes = new _themes_themes__WEBPACK_IMPORTED_MODULE_18__.Themes();\n        /**\n         * @private\n         */\n        this.hasThemes = false;\n        /**\n         * @private\n         */\n        this.footnotes = new _page__WEBPACK_IMPORTED_MODULE_7__.Footnote();\n        /**\n         * @private\n         */\n        this.endnotes = new _page__WEBPACK_IMPORTED_MODULE_7__.Footnote();\n        /**\n         * @private\n         */\n        this.isFootnoteWidget = false;\n        /**\n         * @private\n         */\n        this.isDragStarted = false;\n        /**\n         * @private\n         */\n        this.isMouseDownInSelection = false;\n        /**\n         * @private\n         */\n        this.isBookmarkInserted = true;\n        this.isMappedContentControlUpdated = true;\n        this.isAutoResizeCanStart = false;\n        this.isRestartNumbering = false;\n        /**\n         * @private\n         * @param {TextEvent} event - Specifies text event.\n         * @returns {void}\n         */\n        this.onTextInput = function (event) {\n            if (!_this.isComposingIME) {\n                event.preventDefault();\n                var text = event.data;\n                _this.owner.editorModule.handleTextInput(text);\n            }\n        };\n        //#region Composition Event\n        /**\n         * Fires when composition starts.\n         *\n         * @private\n         * @returns {void}\n         */\n        this.compositionStart = function () {\n            if (!_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.Browser.isDevice && !_this.owner.isReadOnlyMode) {\n                _this.isComposingIME = true;\n                _this.positionEditableTarget();\n                if (_this.owner.editorHistoryModule) {\n                    _this.owner.editorModule.initComplexHistory('IMEInput');\n                }\n            }\n            _this.isCompositionStart = true;\n        };\n        /**\n         * Fires on every input during composition.\n         *\n         * @private\n         * @returns {void}\n         */\n        this.compositionUpdated = function () {\n            if (_this.isComposingIME && !_this.owner.isReadOnlyMode) {\n                setTimeout(function () {\n                    _this.owner.editorModule.insertIMEText(_this.getEditableDivTextContent(), true);\n                }, 0);\n            }\n            _this.isCompositionUpdated = true;\n        };\n        /**\n         * Fires when user selects a character/word and finalizes the input.\n         *\n         * @private\n         * @param {CompositionEvent} event - Specifies text compisition event.\n         * @returns {void}\n         */\n        this.compositionEnd = function (event) {\n            if (_this.isComposingIME && !_this.owner.isReadOnlyMode) {\n                var text_1 = _this.getEditableDivTextContent();\n                setTimeout(function () {\n                    if (text_1 !== '') {\n                        _this.owner.editorModule.insertIMEText(text_1, false);\n                    }\n                    _this.isComposingIME = false;\n                    _this.lastComposedText = '';\n                    var cssText = 'pointer-events:none;position:absolute;left:' + _this.owner.viewer.containerLeft + 'px;top:' + _this.owner.viewer.containerTop + 'px;outline:none;background-color:transparent;width:0px;height:0px;overflow:hidden';\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.updateCSSText)(_this.iframe, cssText);\n                    _this.editableDiv.innerHTML = '';\n                    if (_this.owner.editorHistoryModule) {\n                        if (text_1 !== '') {\n                            _this.owner.editorModule.isSkipOperationsBuild = _this.owner.enableCollaborativeEditing;\n                        }\n                        _this.owner.editorHistoryModule.updateComplexHistory();\n                        if (text_1 === '') {\n                            //When the composition in live. The Undo operation will terminate the composition and empty text will be return from text box.\n                            //At that time the the history should be updated. Undo the operation and clear the redo stack. This undo operation will not be saved for redo operation.\n                            _this.owner.editorModule.isSkipOperationsBuild = _this.owner.enableCollaborativeEditing;\n                            _this.owner.editorHistoryModule.undo();\n                            _this.owner.editorHistoryModule.redoStack.pop();\n                        }\n                        _this.owner.editorModule.isSkipOperationsBuild = false;\n                    }\n                }, 0);\n            }\n            event.preventDefault();\n            _this.isCompositionUpdated = false;\n            _this.isCompositionEnd = true;\n        };\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        this.onImageResizer = function (args) {\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner.imageResizerModule) &&\n                _this.owner.imageResizerModule.isImageResizerVisible && _this.owner.imageResizerModule.isImageResizing) {\n                if (args instanceof MouseEvent) {\n                    _this.onMouseUpInternal(args);\n                }\n                else if (args instanceof TouchEvent) {\n                    _this.onTouchUpInternal(args);\n                }\n            }\n            if (_this.scrollMoveTimer) {\n                _this.isMouseEntered = true;\n                clearInterval(_this.scrollMoveTimer);\n            }\n        };\n        /* eslint-enable @typescript-eslint/no-explicit-any */\n        /**\n         * @private\n         * @param {KeyboardEvent} event - Specifies keyboard event\n         * @returns {void}\n         */\n        this.onKeyPressInternal = function (event) {\n            var key = event.which || event.keyCode;\n            _this.triggerElementsOnLoading = false;\n            var ctrl = (event.ctrlKey || event.metaKey) ? true : ((key === 17) ? true : false); // ctrl detection\n            var alt = event.altKey ? event.altKey : ((key === 18) ? true : false); // alt key detection\n            if (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.Browser.isIE && alt && ctrl) {\n                ctrl = false;\n            }\n            // tslint:disable-next-line:max-line-length\n            if (ctrl && event.key === 'v' || ctrl && event.key === 'a' || (ctrl || (_this.isControlPressed && _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.Browser.isIE)) && event.key === 'p') {\n                if (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.Browser.isIE) {\n                    _this.isControlPressed = false;\n                }\n                return;\n            }\n            if (!_this.owner.isReadOnlyMode && _this.owner.editorModule.canEditContentControl || (_this.owner.documentHelper.protectionType === 'FormFieldsOnly' && _this.owner.editorModule.canEditContentControl && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner.documentHelper.selection) && _this.owner.documentHelper.selection.checkContentControlLocked()) || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.selection) && _this.selection.isInlineFormFillMode())) {\n                var key_1 = event.keyCode || event.charCode;\n                var char = '';\n                if (key_1) {\n                    char = String.fromCharCode(key_1);\n                }\n                else if (event.key) {\n                    char = event.key;\n                }\n                if (char !== ' ' && char !== '\\r' && char !== '\\b' && char !== String.fromCharCode(27) && !ctrl) {\n                    _this.triggerSpellCheck = false;\n                    _this.isSpellCheckPending = true;\n                    _this.owner.editorModule.handleTextInput(char);\n                }\n                else if (char === ' ') {\n                    _this.isSpellCheckPending = false;\n                    _this.triggerSpellCheck = true;\n                    _this.owner.editorModule.handleTextInput(' ');\n                    _this.triggerSpellCheck = false;\n                }\n                event.preventDefault();\n            }\n            _this.owner.focusIn();\n        };\n        /**\n         * @private\n         * @param {KeyboardEvent} event - Specifies keyboard event\n         * @returns {void}\n         */\n        this.onTextInputInternal = function (event) {\n            if (!_this.owner.isReadOnlyMode) {\n                _this.owner.editorModule.onTextInputInternal();\n            }\n            else {\n                _this.editableDiv.innerText = '';\n            }\n        };\n        /**\n         * Fired on copy.\n         *\n         * @private\n         * @param {ClipboardEvent} event - Specifies clipboard event.\n         * @returns {void}\n         */\n        this.onCopy = function (event) {\n            if (_this.isCopying && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.selection) && !_this.selection.isEmpty) {\n                _this.owner.selection.onCopy(event);\n                event.preventDefault();\n            }\n        };\n        /**\n         * Fired on paste.\n         *\n         * @private\n         * @param {ClipboardEvent} event - Specifies clipboard event.\n         * @returns {void}\n         */\n        this.onPaste = function (event) {\n            if ((!_this.owner.isReadOnlyMode && _this.owner.editorModule.canEditContentControl) || _this.selection.isInlineFormFillMode()) {\n                _this.owner.editorModule.pasteInternal(event);\n            }\n            _this.editableDiv.innerText = '';\n            event.preventDefault();\n        };\n        /**\n         * Fires when editable div loses focus.\n         *\n         * @private\n         * @returns {void}\n         */\n        this.onFocusOut = function () {\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.selection)) {\n                if (_this.owner.contextMenuModule && _this.owner.contextMenuModule.contextMenuInstance &&\n                    _this.owner.contextMenuModule.contextMenuInstance.element.style.display === 'block') {\n                    return;\n                }\n                _this.selection.hideCaret();\n            }\n        };\n        /**\n         * Updates focus to editor area.\n         *\n         * @private\n         * @returns {void}\n         */\n        this.updateFocus = function () {\n            if (_this.owner.enableCollaborativeEditing && _this.owner.editorModule.isRemoteAction) {\n                return;\n            }\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.currentSelectedComment) && !_this.owner.commentReviewPane.commentPane.isEditMode) {\n                if (_this.owner.commentReviewPane && _this.owner.commentReviewPane.commentPane.isEditMode) {\n                    _this.owner.commentReviewPane.commentPane.selectComment(_this.currentSelectedComment);\n                }\n                _this.selection.hideCaret();\n                return;\n            }\n            if (_this.selection && !(_this.isMobileDevice && _this.owner.isReadOnly)) {\n                if (navigator !== undefined && !_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.Browser.isDevice && !_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.Browser.isIE && !navigator.userAgent.match('Edge')\n                    && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.iframe)) {\n                    _this.iframe.focus();\n                }\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.editableDiv)) {\n                    _this.editableDiv.focus();\n                }\n                _this.selection.showCaret();\n            }\n        };\n        /**\n         * Fires on scrolling.\n         *\n         * @returns {void}\n         */\n        this.scrollHandler = function () {\n            if (_this.scrollTimer) {\n                clearTimeout(_this.scrollTimer);\n            }\n            _this.clearContent();\n            _this.isScrollHandler = true;\n            if (!_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.Browser.isDevice && !_this.isComposingIME) {\n                _this.iframe.style.top = _this.owner.viewer.containerTop + 'px';\n                _this.iframe.style.left = _this.owner.viewer.containerLeft + 'px';\n            }\n            if (_this.owner.hRuler) {\n                _this.hRuler = document.getElementById(_this.owner.element.id + ('_hRulerBottom'));\n                _this.hRuler.style.top = _this.viewerContainer.scrollTop + 'px';\n                _this.markIndicator = document.getElementById(_this.owner.element.id + ('_markIndicator'));\n                if (_this.markIndicator) {\n                    _this.markIndicator.style.top = _this.viewerContainer.scrollTop + 'px';\n                }\n            }\n            if (_this.owner.vRuler) {\n                _this.vRuler = document.getElementById(_this.owner.element.id + ('_vRulerBottom'));\n                _this.vRuler.style.left = _this.viewerContainer.scrollLeft + 'px';\n                _this.markIndicator = document.getElementById(_this.owner.element.id + ('_markIndicator'));\n                if (_this.markIndicator) {\n                    _this.markIndicator.style.left = _this.viewerContainer.scrollLeft + 'px';\n                }\n            }\n            if (_this.owner.rulerHelper && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner.rulerHelper.vRulerBottom)) {\n                _this.owner.rulerHelper.vRulerBottom.style.height = _this.pageContainer.offsetHeight + 'px';\n            }\n            _this.owner.viewer.updateScrollBars();\n            var vtHeight = _this.owner.viewer.containerTop + _this.visibleBounds.height - (_this.owner.viewer.padding.top + _this.owner.viewer.padding.bottom);\n            if (vtHeight > _this.pageContainer.offsetHeight) {\n                _this.viewerContainer.scrollTop = _this.owner.viewer.containerTop - (vtHeight - _this.pageContainer.offsetHeight);\n            }\n            if (_this.owner.viewer instanceof PageLayoutViewer && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner)) {\n                _this.owner.fireViewChange();\n            }\n            _this.isScrollHandler = false;\n            _this.scrollTimer = setTimeout(function () {\n                if (!_this.isScrollHandler && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner) && _this.owner.isSpellCheck) {\n                    _this.isScrollToSpellCheck = true;\n                    _this.owner.viewer.updateScrollBars();\n                }\n            }, 200);\n        };\n        /**\n         * Fires when the window gets resized.\n         *\n         * @private\n         * @returns {void}\n         */\n        this.onWindowResize = function () {\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner) && _this.owner.isContainerResize) {\n                _this.owner.isContainerResize = false;\n                return;\n            }\n            if (_this.resizeTimer) {\n                clearTimeout(_this.resizeTimer);\n            }\n            _this.resizeTimer = setTimeout(function () {\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner.element)) {\n                    _this.updateViewerSize();\n                    if (_this.owner.rulerHelper && _this.owner.documentEditorSettings && _this.owner.documentEditorSettings.showRuler) {\n                        _this.owner.rulerHelper.updateRuler(_this.owner, true);\n                    }\n                    if (_this.owner.enableCollaborativeEditing && _this.owner.collaborativeEditingHandlerModule) {\n                        _this.owner.collaborativeEditingHandlerModule.updateCaretPosition();\n                    }\n                    _this.clearContent();\n                    _this.owner.viewer.updateScrollBars();\n                    if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.selection)) {\n                        _this.selection.updateCaretPosition();\n                    }\n                    _this.updateTouchMarkPosition();\n                    if (_this.owner.contextMenuModule && _this.owner.contextMenuModule.contextMenuInstance) {\n                        _this.owner.contextMenuModule.contextMenuInstance.close();\n                    }\n                    if (_this.resizeTimer) {\n                        clearTimeout(_this.resizeTimer);\n                    }\n                }\n            }, 200);\n        };\n        /**\n         * @private\n         * @param {MouseEvent} event - Specified mouse event.\n         * @returns {void}\n         */\n        this.onContextMenu = function (event) {\n            if (_this.owner.contextMenuModule) {\n                if (_this.isMouseDown) {\n                    _this.isMouseDown = false;\n                }\n                _this.owner.contextMenuModule.onContextMenuInternal(event);\n                _this.updateFocus();\n            }\n        };\n        /**\n         * Called on mouse down.\n         *\n         * @private\n         * @param {MouseEvent} event - Specifies mouse event.\n         * @returns {void}\n         */\n        this.onMouseDownInternal = function (event) {\n            var target = event.target;\n            _this.owner.focusIn();\n            if ((!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(target) && target !== _this.viewerContainer) || _this.owner.isTableMarkerDragging || _this.isTouchInput ||\n                event.offsetX > (_this.visibleBounds.width - (_this.visibleBounds.width - _this.viewerContainer.clientWidth))\n                || event.offsetY > (_this.visibleBounds.height - (_this.visibleBounds.height - _this.viewerContainer.clientHeight))) {\n                return;\n            }\n            _this.isFootnoteWidget = false;\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.selection)) {\n                _this.updateCursor(event);\n                if (_this.formFillPopup) {\n                    _this.formFillPopup.hidePopup();\n                }\n                if (_this.contentDropDown) {\n                    _this.contentDropDown.hidePopup();\n                }\n                if (_this.isLeftButtonPressed(event) && !_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner.imageResizerModule.selectedResizeElement)) {\n                    if (_this.selection.isInShape) {\n                        var textFram = _this.owner.selectionModule.getCurrentTextFrame();\n                        var shape = textFram.containerShape;\n                        _this.selection.selectShape(shape);\n                    }\n                    _this.owner.imageResizerModule.isImageResizing = true;\n                }\n                event.preventDefault();\n                if (!_this.isTouchInput) {\n                    _this.selection.hideCaret();\n                }\n                var cursorPoint = new _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.Point(event.offsetX, event.offsetY);\n                var touchPoint = _this.owner.viewer.findFocusedPage(cursorPoint, true, true);\n                _this.mouseDownOffset.x = touchPoint.x;\n                _this.mouseDownOffset.y = touchPoint.y;\n                _this.isMouseDownInFooterRegion = _this.selection.isCursorInsidePageRect(cursorPoint, _this.currentPage) && _this.selection.isCursorInFooterRegion(cursorPoint, _this.currentPage);\n                _this.isSelectionChangedOnMouseMoved = false;\n                if (!_this.owner.isReadOnlyMode && (_this.owner.editorModule.tableResize.isInCellResizerArea(touchPoint) ||\n                    _this.owner.editorModule.tableResize.isInRowResizerArea(touchPoint))) {\n                    _this.selection.hideCaret();\n                    _this.isMouseDown = true;\n                    _this.isSelectionChangedOnMouseMoved = false;\n                    if (_this.isLeftButtonPressed(event)) {\n                        _this.owner.editorModule.tableResize.startingPoint.x = touchPoint.x;\n                        _this.owner.editorModule.tableResize.startingPoint.y = touchPoint.y;\n                        _this.owner.editorModule.tableResize.handleResize(touchPoint);\n                    }\n                    return;\n                }\n                if (event.ctrlKey) {\n                    _this.isControlPressed = true;\n                }\n                if (_this.owner.selectionModule.isEmpty) {\n                    _this.useTouchSelectionMark = false;\n                }\n                var widget = _this.getLineWidget(touchPoint);\n                if (event.which === 3 && !_this.owner.selectionModule.isEmpty\n                    && _this.selection.checkCursorIsInSelection(widget, touchPoint)) {\n                    event.preventDefault();\n                    return;\n                }\n                if (_this.owner && _this.owner.documentEditorSettings && _this.owner.documentEditorSettings.allowDragAndDrop &&\n                    !_this.owner.selectionModule.isEmpty\n                    && _this.selection.checkCursorIsInSelection(widget, touchPoint)) {\n                    _this.isMouseDownInSelection = true;\n                }\n                _this.isTouchInput = false;\n                _this.isMouseDown = true;\n                _this.updateFocus();\n                /* eslint-disable @typescript-eslint/indent */\n                _this.timer = setTimeout(function () {\n                    _this.tapCount++;\n                    if (_this.tapCount > 1) {\n                        _this.tapCount = 1;\n                    }\n                    if (!_this.isScrollHandler && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner) && _this.owner.isSpellCheck) {\n                        _this.isScrollToSpellCheck = true;\n                        _this.owner.viewer.updateScrollBars();\n                    }\n                }, 100);\n            }\n        };\n        /**\n         * Called on mouse move.\n         *\n         * @private\n         * @param {MouseEvent} event - Specified mouse event.\n         * @returns {void}\n         */\n        this.onMouseMoveInternal = function (event) {\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(event.target) && event.target !== _this.viewerContainer || _this.owner.isTableMarkerDragging) {\n                return;\n            }\n            event.preventDefault();\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.selection)) {\n                //For image Resizing\n                if (!_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode\n                    && _this.owner.imageResizerModule.isImageResizing) {\n                    if (!_this.owner.imageResizerModule.isImageMoveToNextPage) {\n                        _this.owner.imageResizerModule.handleImageResizingOnMouse(event);\n                    }\n                    return;\n                }\n                var cursorPoint = new _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.Point(event.offsetX, event.offsetY);\n                var touchPoint = _this.owner.viewer.findFocusedPage(cursorPoint, !_this.owner.enableHeaderAndFooter);\n                var widget = _this.getLineWidget(touchPoint);\n                if (_this.isMouseDown) {\n                    if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.currentPage)) {\n                        var xPosition = touchPoint.x;\n                        var yPosition = touchPoint.y;\n                        if (!_this.owner.isReadOnlyMode && _this.isRowOrCellResizing) {\n                            var table = _this.owner.editorModule.tableResize.currentResizingTable;\n                            var startPosition = _this.selection.setPositionForBlock(table, true);\n                            var endPosition = _this.selection.setPositionForBlock(table, false);\n                            if (!(_this.owner.documentHelper.isDocumentProtected) || _this.selection.checkSelectionIsAtEditRegion(startPosition, endPosition)) {\n                                _this.owner.editorModule.tableResize.handleResizing(touchPoint);\n                            }\n                        }\n                        else {\n                            if ((!_this.isDragStarted\n                                && _this.isMouseDownInSelection\n                                && _this.isLeftButtonPressed(event)\n                                && !_this.owner.selectionModule.isEmpty\n                                && _this.selection.checkCursorIsInSelection(widget, touchPoint)) || (!_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode && !_this.isDragStarted && _this.isLeftButtonPressed(event) && !_this.owner.selectionModule.isEmpty && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(widget) && _this.owner.imageResizerModule.selectedImageWidget.containsKey(widget) && !_this.owner.imageResizerModule.isImageResizing)) {\n                                _this.isDragStarted = true;\n                                _this.isMouseDownInSelection = false;\n                                if (_this.selection.isForward) {\n                                    _this.dragStartParaInfo = _this.selection.getParagraphInfo(_this.selection.start);\n                                    _this.dragEndParaInfo = _this.selection.getParagraphInfo(_this.selection.end);\n                                }\n                                else {\n                                    _this.dragStartParaInfo = _this.selection.getParagraphInfo(_this.selection.end);\n                                    _this.dragEndParaInfo = _this.selection.getParagraphInfo(_this.selection.start);\n                                }\n                                _this.selection.caret.classList.remove(\"e-de-cursor-animation\");\n                            }\n                            if (!(_this.isTouchInput || _this.isSelectionChangedOnMouseMoved || _this.touchDownOnSelectionMark > 0 || _this.isDragStarted)) {\n                                _this.updateTextPositionForSelection(touchPoint, 1);\n                                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.currentSelectedComment) && _this.owner.commentReviewPane\n                                    && !_this.owner.commentReviewPane.commentPane.isEditMode) {\n                                    _this.currentSelectedComment = undefined;\n                                }\n                            }\n                            if (_this.isLeftButtonPressed(event) && !_this.isDragStarted) {\n                                event.preventDefault();\n                                var touchY = yPosition;\n                                var textPosition = _this.owner.selectionModule.end;\n                                var touchPoint_1 = new _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.Point(xPosition, touchY);\n                                if (!_this.owner.enableImageResizerMode || !_this.owner.imageResizerModule.isImageResizerVisible\n                                    || _this.owner.imageResizerModule.isShapeResize) {\n                                    _this.isCompleted = false;\n                                    _this.owner.selectionModule.moveTextPosition(touchPoint_1, textPosition);\n                                }\n                                _this.isSelectionChangedOnMouseMoved = true;\n                            }\n                            if (_this.isDragStarted && _this.isLeftButtonPressed(event)) {\n                                _this.autoScrollOnSelection(cursorPoint);\n                                _this.selection.updateTextPosition(widget, touchPoint);\n                            }\n                        }\n                    }\n                    _this.selection.checkForCursorVisibility();\n                }\n                if (!_this.isRowOrCellResizing && !_this.isSelectionChangedOnMouseMoved) {\n                    _this.updateCursor(event);\n                }\n                if (_this.isRowOrCellResizing) {\n                    _this.selection.hideCaret();\n                }\n            }\n        };\n        /**\n         * @private\n         * @param {MouseEvent} event - Specifies mouse event\n         * @returns {void}\n         */\n        this.onMouseLeaveInternal = function (event) {\n            event.preventDefault();\n            var cursorPoint = new _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.Point(event.offsetX, event.offsetY);\n            if (_this.isMouseDown) {\n                var viewerTop = _this.viewerContainer.scrollTop;\n                clearInterval(_this.scrollMoveTimer);\n                if (event.offsetY + viewerTop > viewerTop) {\n                    _this.scrollMoveTimer = setInterval(function () {\n                        _this.scrollForwardOnSelection(cursorPoint);\n                    }, 100);\n                }\n                else {\n                    _this.scrollMoveTimer = setInterval(function () {\n                        _this.scrollBackwardOnSelection(cursorPoint);\n                    }, 100);\n                }\n                if (_this.isMouseEntered) {\n                    _this.isMouseEntered = false;\n                }\n            }\n            if (_this.isDragStarted) {\n                _this.selection.hideCaret();\n                if (_this.scrollMoveTimer) {\n                    clearInterval(_this.scrollMoveTimer);\n                    _this.scrollMoveTimer = 0;\n                }\n            }\n        };\n        /**\n         * @private\n         * @returns {void}\n         */\n        this.onMouseEnterInternal = function (event) {\n            if (!_this.isMouseEntered) {\n                _this.owner.viewer.updateScrollBars();\n            }\n            _this.isMouseEntered = true;\n            if (_this.scrollMoveTimer) {\n                clearInterval(_this.scrollMoveTimer);\n            }\n            if (!_this.isLeftButtonPressed(event) && _this.isDragStarted) {\n                if (!_this.selection.caret.classList.contains(\"e-de-cursor-animation\")) {\n                    _this.selection.caret.classList.add(\"e-de-cursor-animation\");\n                }\n                _this.isDragStarted = false;\n            }\n            if (!_this.isLeftButtonPressed(event) && _this.isMouseDown) {\n                _this.onMouseUpInternal(event);\n            }\n        };\n        /**\n         * Fired on double tap.\n         *\n         * @private\n         * @param {MouseEvent} event - Specifies mouse event.\n         * @returns {void}\n         */\n        this.onDoubleTap = function (event) {\n            _this.owner.focusIn();\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(event.target) && event.target !== _this.viewerContainer) {\n                return;\n            }\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.selection)) {\n                _this.isTouchInput = false;\n                var cursorPoint = new _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.Point(event.offsetX, event.offsetY);\n                var touchPoint = _this.owner.viewer.findFocusedPage(cursorPoint, true);\n                if (_this.selection.checkAndEnableHeaderFooter(cursorPoint, _this.owner.viewer.findFocusedPage(cursorPoint, true))) {\n                    return;\n                }\n                var widget = _this.getLineWidget(touchPoint);\n                if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(widget)) {\n                    return;\n                }\n                var formField = _this.selection.getHyperLinkFieldInCurrentSelection(widget, touchPoint, true);\n                if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(formField)) {\n                    formField = _this.selection.getCurrentFormField();\n                }\n                if (!_this.isDocumentProtected && _this.owner.enableFormField && !_this.owner.isReadOnlyMode) {\n                    var formatType = _this.selection.getFormFieldType(formField);\n                    if (formatType) {\n                        if (formatType.toString() !== '') {\n                            _this.selection.selectField(formField);\n                        }\n                        switch (formatType) {\n                            case 'Text':\n                                _this.owner.textFormFieldDialogModule.show();\n                                break;\n                            case 'CheckBox':\n                                _this.owner.checkBoxFormFieldDialogModule.show();\n                                break;\n                            case 'DropDown':\n                                _this.owner.dropDownFormFieldDialogModule.show();\n                                break;\n                        }\n                    }\n                }\n                else if (_this.isDocumentProtected && formField && formField.formFieldData instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TextFormField\n                    && formField.formFieldData.type === 'Text') {\n                    _this.selection.selectField();\n                }\n                var startPosition = _this.selection.start.clone();\n                var endPosition = _this.selection.end.clone();\n                var inlineObj = startPosition.currentWidget.getInline(startPosition.offset, 0);\n                var inline = inlineObj.element;\n                if (_this.owner.layoutType === 'Pages') {\n                    if (inline instanceof _page__WEBPACK_IMPORTED_MODULE_7__.FootnoteElementBox) {\n                        if (inline.footnoteType === 'Footnote') {\n                            var footnotes = _this.currentPage.footnoteWidget;\n                            var i = void 0;\n                            for (i = 0; i <= footnotes.bodyWidgets.length; i++) {\n                                var footnoteText = (footnotes.bodyWidgets[i]).footNoteReference;\n                                if (inline.text === footnoteText.text) {\n                                    break;\n                                }\n                            }\n                            startPosition.setPositionParagraph(footnotes.bodyWidgets[i].childWidgets[0].childWidgets[0], 0);\n                            endPosition.setPositionParagraph(footnotes.bodyWidgets[i].childWidgets[0].childWidgets[0], 0);\n                            _this.selection.selectRange(startPosition, endPosition);\n                        }\n                        else {\n                            _this.navigateToEndNote(inline, startPosition, endPosition);\n                        }\n                    }\n                    else {\n                        if (inline instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TextElementBox && (_this.selection.isinEndnote || _this.selection.isinFootnote)) {\n                            _this.selection.footnoteReferenceElement(startPosition, endPosition, inline);\n                        }\n                    }\n                }\n                if (_this.selection.isEmpty && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.currentPage) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner.selectionModule.start)) {\n                    _this.owner.selectionModule.selectCurrentWord();\n                    _this.selection.checkForCursorVisibility();\n                    _this.tapCount = 2;\n                }\n            }\n        };\n        /**\n         * Called on mouse up.\n         *\n         * @private\n         * @param {MouseEvent} event - Specifies mouse event.\n         * @return {void}\n         */\n        /* eslint-disable  */\n        this.onMouseUpInternal = function (event) {\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(event.target) && event.target !== _this.viewerContainer || _this.owner.isTableMarkerDragging) {\n                return;\n            }\n            event.preventDefault();\n            _this.isListTextSelected = false;\n            var cursorPoint = new _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.Point(event.offsetX, event.offsetY);\n            var touchPoint = _this.owner.viewer.findFocusedPage(cursorPoint, true);\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.selection)) {\n                var tapCount = 1;\n                if (!_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.Browser.isIE) {\n                    if (event.detail > 2) {\n                        tapCount = event.detail;\n                    }\n                }\n                else {\n                    tapCount = _this.tapCount;\n                }\n                if (_this.isRowOrCellResizing) {\n                    _this.owner.editorModule.tableResize.updateResizingHistory(touchPoint);\n                }\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner.editor) && _this.selection.checkContentControlLocked()) {\n                    _this.owner.editorModule.insertContentControlPlaceholder();\n                }\n                if (_this.isMouseDown && !_this.isSelectionChangedOnMouseMoved\n                    && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.currentPage) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner.selectionModule.start)\n                    && (!_this.owner.enableImageResizerMode || !_this.owner.imageResizerModule.isImageResizing)) {\n                    if (_this.touchDownOnSelectionMark === 0 && !_this.isRowOrCellResizing) {\n                        var isShiftKeyPressed = event.shiftKey;\n                        if (isShiftKeyPressed) {\n                            var textPosition = _this.owner.selectionModule.end;\n                            _this.owner.selectionModule.moveTextPosition(touchPoint, textPosition);\n                        }\n                        else {\n                            _this.updateTextPositionForSelection(touchPoint, tapCount);\n                            // to check whether the image is selected\n                            if (_this.owner.selectionModule.isImageSelected) {\n                                var contentControlImage = _this.owner.getImageContentControl();\n                                // to check whether selected image has content control and type as picture , then the dialog opens\n                                if (contentControlImage instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ContentControl) {\n                                    if (contentControlImage.contentControlProperties.type == 'Picture') {\n                                        var picturePositionY = _this.owner.picturePositionY;\n                                        _this.owner.renderPictureContentControlElement(_this.owner, true, false, picturePositionY);\n                                    }\n                                }\n                            }\n                            else {\n                                _this.owner.renderPictureContentControlElement(_this.owner, false, false);\n                            }\n                        }\n                        if (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.Browser.isIE && tapCount === 2) {\n                            _this.selection.checkAndEnableHeaderFooter(cursorPoint, touchPoint);\n                        }\n                    }\n                    _this.selection.checkForCursorVisibility();\n                    if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.currentSelectedComment) && _this.owner.commentReviewPane\n                        && !_this.owner.commentReviewPane.commentPane.isEditMode) {\n                        _this.currentSelectedComment = undefined;\n                    }\n                }\n                var isCtrlkeyPressed = _this.isIosDevice ? event.metaKey : event.ctrlKey;\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner.editorModule) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner.selectionModule)) {\n                    var contentControl = _this.owner.selection.currentContentControl;\n                    var iscontentControl = _this.owner.selectionModule.checkContentControlLocked();\n                    if ((!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(contentControl) && !contentControl.contentControlProperties.lockContents && iscontentControl && event.button === 0) || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(contentControl) && !contentControl.contentControlProperties.lockContents && _this.protectionType == 'FormFieldsOnly' && event.button === 0)) {\n                        if (!_this.owner.isReadOnly) {\n                            if (_this.isDocumentProtected) {\n                                if ((_this.selection.checkSelectionIsAtEditRegion() || _this.isFormFillProtectedMode) && contentControl.contentControlProperties.type === 'CheckBox') {\n                                    _this.owner.editor.toggleContentControlCheckBox(contentControl, !contentControl.contentControlProperties.isChecked);\n                                    if (contentControl.contentControlProperties.isTemporary) {\n                                        _this.owner.editor.removeContentControl();\n                                    }\n                                }\n                            }\n                            else {\n                                if (contentControl.contentControlProperties.type === 'CheckBox') {\n                                    _this.owner.editor.toggleContentControlCheckBox(contentControl, !contentControl.contentControlProperties.isChecked);\n                                    if (contentControl.contentControlProperties.isTemporary) {\n                                        _this.owner.editor.removeContentControl();\n                                    }\n                                }\n                            }\n                        }\n                    }\n                    if (contentControl) {\n                        _this.selection.selectPlaceHolderText(contentControl);\n                    }\n                }\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.currentPage) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner.selectionModule.start)\n                    && (_this.owner.selectionModule.isEmpty || _this.owner.selectionModule.isImageSelected) &&\n                    (((isCtrlkeyPressed && _this.owner.useCtrlClickToFollowHyperlink ||\n                        !_this.owner.useCtrlClickToFollowHyperlink) && _this.isLeftButtonPressed(event) === true))) {\n                    _this.selection.navigateHyperLinkOnEvent(touchPoint, false);\n                }\n                if (_this.isMouseDown && _this.isLeftButtonPressed(event) && _this.isDocumentProtected\n                    && _this.protectionType === 'FormFieldsOnly' && _this.selection) {\n                    var widget = _this.getLineWidget(touchPoint);\n                    if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(widget)) {\n                        return;\n                    }\n                    var formField = _this.selection.getHyperLinkFieldInCurrentSelection(widget, touchPoint, true);\n                    if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(formField)) {\n                        formField = _this.selection.getCurrentFormField(true);\n                    }\n                    if (formField && formField.formFieldData && formField.formFieldData.enabled && !_this.selection.isInlineFormFillMode(formField)) {\n                        var data = { 'fieldName': formField.formFieldData.name };\n                        if (formField.formFieldData instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TextFormField) {\n                            data.value = formField.resultText;\n                        }\n                        else if (formField.formFieldData instanceof _page__WEBPACK_IMPORTED_MODULE_7__.CheckBoxFormField) {\n                            data.value = formField.formFieldData.checked;\n                        }\n                        else {\n                            data.value = formField.formFieldData.selectedIndex;\n                        }\n                        data.isCanceled = false;\n                        if (_this.owner.documentEditorSettings.formFieldSettings.formFillingMode === 'Popup' && _this.selection.previousSelectedFormField !== _this.selection.getCurrentFormField()) {\n                            _this.owner.trigger(_base_index__WEBPACK_IMPORTED_MODULE_13__.beforeFormFieldFillEvent, data);\n                        }\n                        else {\n                            _this.owner.trigger(_base_index__WEBPACK_IMPORTED_MODULE_13__.beforeFormFieldFillEvent, data);\n                        }\n                        if (!data.isCanceled) {\n                            if (_this.owner.documentEditorSettings.formFieldSettings.formFillingMode === 'Popup' && !(formField.formFieldData instanceof _page__WEBPACK_IMPORTED_MODULE_7__.CheckBoxFormField)\n                                || (formField.formFieldData instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TextFormField && !(formField.formFieldData.type === 'Text'))\n                                || formField.formFieldData instanceof _page__WEBPACK_IMPORTED_MODULE_7__.DropDownFormField) {\n                                _this.formFillPopup.showPopUp(formField);\n                            }\n                            else {\n                                _this.owner.editorModule.toggleCheckBoxFormField(formField);\n                                data.value = formField.formFieldData.checked;\n                                data.isCanceled = false;\n                                _this.owner.trigger(_base_index__WEBPACK_IMPORTED_MODULE_13__.afterFormFieldFillEvent, data);\n                            }\n                        }\n                    }\n                    if (!formField && _this.isFormFillProtectedMode) {\n                        var contentControl = _this.owner.selection.currentContentControl;\n                        var canEditContentControl = false;\n                        if ((!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(contentControl) && contentControl instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ContentControl && !contentControl.contentControlProperties.lockContentControl)) {\n                            canEditContentControl = true;\n                        }\n                        if (!canEditContentControl) {\n                            _this.selection.navigateToNextFormField();\n                        }\n                    }\n                }\n                else if (_this.isMouseDown) {\n                    if (_this.formFields.length > 0) {\n                        var formField = _this.selection.getCurrentFormField(true);\n                        if (formField && formField.formFieldData instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TextFormField) {\n                            _this.selection.selectField();\n                        }\n                        else if (_this.isLeftButtonPressed(event) && formField && formField.formFieldData instanceof _page__WEBPACK_IMPORTED_MODULE_7__.DropDownFormField) {\n                            var offset = formField.line.getOffset(formField, 0);\n                            var point = _this.selection.getPhysicalPositionInternal(formField.line, offset, false);\n                            _this.selection.selectInternal(formField.line, formField, 0, point);\n                        }\n                    }\n                    if (_this.contentControlCollection.length > 0) {\n                        _this.selection.triggerContentControlFillEvent();\n                    }\n                    if (_this.isSelectionChangedOnMouseMoved) {\n                        _this.selection.fireSelectionChanged(true);\n                    }\n                }\n                if (!_this.owner.isReadOnlyMode && _this.isSelectionInListText(touchPoint)) {\n                    _this.selection.selectListText();\n                }\n                if (!_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n                    _this.owner.imageResizerModule.mouseUpInternal();\n                    _this.scrollToPosition(_this.owner.selectionModule.start, _this.owner.selectionModule.end);\n                    _this.owner.imageResizerModule.isImageResizing = false;\n                }\n                if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizerVisible && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.selection.caret)) {\n                    _this.selection.caret.style.display = 'none';\n                }\n                if (_this.isDragStarted) {\n                    if (_this.selection.selectedWidgets.length === 0 && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.dragStartParaInfo) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.dragEndParaInfo) && _this.dragEndParaInfo.paragraph.equals(_this.dragStartParaInfo.paragraph)) {\n                        var currentInline = _this.dragStartParaInfo.paragraph.getInline(_this.dragEndParaInfo.offset, 0);\n                        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(currentInline.element) && currentInline.element instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ImageElementBox && currentInline.element.textWrappingStyle !== \"Inline\") {\n                            _this.isDragStarted = false;\n                        }\n                    }\n                    else if (_this.selection.selectedWidgets.length > 0) {\n                        for (var i = 0; i < _this.selection.selectedWidgets.values.length; i++) {\n                            var selectedWidgetInfo = _this.selection.selectedWidgets.values[i];\n                            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(selectedWidgetInfo.floatingItems) && selectedWidgetInfo.floatingItems.length > 0) {\n                                for (var j = 0; j < selectedWidgetInfo.floatingItems.length; j++) {\n                                    if (selectedWidgetInfo.floatingItems[j] instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ImageElementBox && selectedWidgetInfo.floatingItems[j].textWrappingStyle !== \"Inline\") {\n                                        _this.isDragStarted = false;\n                                        break;\n                                    }\n                                }\n                            }\n                            if (!_this.isDragStarted) {\n                                break;\n                            }\n                        }\n                    }\n                    if (!_this.isDragStarted) {\n                        _this.dragStartParaInfo = undefined;\n                        _this.dragEndParaInfo = undefined;\n                        _this.selection.caret.classList.add(\"e-de-cursor-animation\");\n                    }\n                }\n                if (_this.isDragStarted) {\n                    _this.isDragging = true;\n                    _this.moveSelectedContent();\n                    _this.isDragging = false;\n                }\n                if (_this.isMouseDown) {\n                    _this.updateFocus();\n                }\n                _this.isMouseDownInSelection = false;\n                _this.isMouseDown = false;\n                _this.isFootnoteWidget = false;\n                _this.isSelectionChangedOnMouseMoved = false;\n                _this.isTouchInput = false;\n                _this.useTouchSelectionMark = true;\n                _this.isControlPressed = false;\n                if (_this.isListTextSelected) {\n                    _this.selection.hideCaret();\n                }\n                if (_this.owner.enableImageResizerMode) {\n                    var imageResizer = _this.owner.imageResizerModule;\n                    imageResizer.isImageResizing = false;\n                    imageResizer.isImageMoveToNextPage = false;\n                    imageResizer.leftValue = undefined;\n                    imageResizer.topValue = undefined;\n                }\n                _this.isMouseDownInFooterRegion = false;\n            }\n            if (_this.selection) {\n                _this.selection.isCellPrevSelected = false;\n            }\n            if (_this.owner.documentHelper.contentControlCollection.length > 0) {\n                //Need to work on these\n                _this.clearContent();\n                _this.owner.documentHelper.viewer.updateScrollBars();\n            }\n        };\n        /**\n         * Fired on touch start.\n         *\n         * @private\n         * @param {TouchEvent} event - Specifies touch event.\n         * @returns {void}\n         */\n        this.onTouchStartInternal = function (event) {\n            if (_this.selection) {\n                _this.isTouchMoved = false;\n                _this.isCompositionStart = false;\n                _this.isCompositionEnd = false;\n                _this.isCompositionUpdated = false;\n                _this.isCompositionCanceled = true;\n                _this.isTouchInput = true;\n                if (_this.isTimerStarted) {\n                    if (_this.tapCount === 1) {\n                        _this.tapCount = 2;\n                    }\n                    else {\n                        _this.tapCount = 3;\n                        _this.isTimerStarted = false;\n                    }\n                }\n                else {\n                    _this.isTimerStarted = true;\n                    _this.tapCount = 1;\n                }\n                if (event.touches.length === 1) {\n                    _this.zoomX = event.touches[0].clientX;\n                    _this.zoomY = event.touches[0].clientY;\n                    if (_this.owner.selectionModule.isEmpty) {\n                        _this.useTouchSelectionMark = false;\n                    }\n                    _this.isMouseDown = true;\n                    _this.isSelectionChangedOnMouseMoved = false;\n                    var point = void 0;\n                    if (_this.isMouseDown) {\n                        point = _this.getTouchOffsetValue(event);\n                    }\n                    point = _this.owner.viewer.findFocusedPage(point, true, true);\n                    if (_this.owner.enableImageResizerMode) {\n                        var resizeObj = _this.owner.imageResizerModule.getImagePointOnTouch(point);\n                        _this.owner.imageResizerModule.selectedResizeElement = resizeObj.selectedElement;\n                    }\n                    if (_this.owner.enableImageResizerMode && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner.imageResizerModule.selectedResizeElement)) {\n                        _this.owner.imageResizerModule.isImageResizing = true;\n                    }\n                    if (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.Browser.isDevice) {\n                        _this.editableDiv.contentEditable = _this.owner.isReadOnlyMode ? 'false' : 'true';\n                    }\n                    var x = _this.owner.selectionModule.end.location.x;\n                    var y = _this.selection.getCaretBottom(_this.owner.selectionModule.end, _this.owner.selectionModule.isEmpty) + 9;\n                    //TouchDownOnSelectionMark will be 2 when touch end is pressed\n                    _this.touchDownOnSelectionMark = ((point.y <= y && point.y >= y - 20 || point.y >= y && point.y <= y + 20)\n                        && (point.x <= x && point.x >= x - 20 || point.x >= x && point.x <= x + 20)) ? 1 : 0;\n                    if (!_this.owner.selectionModule.isEmpty && _this.touchDownOnSelectionMark === 0) {\n                        x = _this.owner.selectionModule.start.location.x;\n                        y = _this.selection.getCaretBottom(_this.owner.selectionModule.start, false) + 9;\n                        //TouchDownOnSelectionMark will be 1 when touch start is pressed\n                        _this.touchDownOnSelectionMark = ((point.y <= y && point.y >= y - 20 || point.y >= y && point.y <= y + 20)\n                            && (point.x <= x && point.x >= x - 20 || point.x >= x && point.x <= x + 20)) ? 2 : 0;\n                    }\n                }\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner.contextMenuModule) && _this.owner.contextMenuModule.contextMenuInstance) {\n                    _this.owner.contextMenuModule.contextMenuInstance.close();\n                }\n                if (_this.touchDownOnSelectionMark || event.touches.length > 1) {\n                    event.preventDefault();\n                }\n                _this.longTouchTimer = setTimeout(_this.onLongTouch, 500, event);\n                _this.timer = setTimeout(function () {\n                    _this.isTimerStarted = false;\n                }, 200);\n                _this.owner.focusIn();\n            }\n        };\n        /**\n         * Fired on long touch\n         *\n         * @private\n         * @param {TouchEvent} event - Specifies touch event.\n         * @returns {void}\n         */\n        this.onLongTouch = function (event) {\n            if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner) || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.viewerContainer) || _this.isTouchMoved || event.touches.length !== 1) {\n                return;\n            }\n            var point = _this.getTouchOffsetValue(event);\n            var pointRelToPage = _this.owner.viewer.findFocusedPage(point, true);\n            var selStart = _this.selection.start;\n            var selEnd = _this.selection.end;\n            var updateSel = false;\n            if (!_this.selection.isForward) {\n                selStart = _this.selection.end;\n                selEnd = _this.selection.start;\n            }\n            var selStartPt = selStart.location;\n            var selEndPt = selEnd.location;\n            if (selStart.currentWidget !== selEnd.currentWidget) {\n                updateSel = !(pointRelToPage.x >= selStartPt.x && pointRelToPage.x <= selEndPt.x)\n                    && !(pointRelToPage.y >= selStartPt.y && pointRelToPage.y <= selEndPt.y);\n            }\n            else {\n                updateSel = !(pointRelToPage.x >= selStartPt.x && pointRelToPage.x <= selEndPt.x)\n                    || !(pointRelToPage.y >= selStartPt.y && pointRelToPage.y <= selEndPt.y);\n            }\n            if (event.changedTouches.length === 1 && updateSel) {\n                _this.updateSelectionOnTouch(point, pointRelToPage);\n                _this.isMouseDown = false;\n                _this.touchDownOnSelectionMark = 0;\n                _this.useTouchSelectionMark = true;\n                _this.isSelectionChangedOnMouseMoved = false;\n            }\n            if (_this.selection.isEmpty) {\n                _this.selection.selectCurrentWord();\n            }\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner.contextMenuModule) && _this.owner.contextMenuModule.contextMenuInstance) {\n                _this.owner.contextMenuModule.onContextMenuInternal(event);\n            }\n        };\n        /**\n         *\n         * @private\n         * @param {TouchEvent} event - Specifies touch event.\n         * @returns {void}\n         */\n        this.onTouchMoveInternal = function (event) {\n            _this.isTouchMoved = true;\n            var touch = event.touches;\n            var cursorPoint;\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.selection)) {\n                if (_this.owner.editorModule && _this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n                    event.preventDefault();\n                    if (!_this.owner.imageResizerModule.isImageMoveToNextPage) {\n                        _this.owner.imageResizerModule.handleImageResizingOnTouch(event);\n                        _this.selection.caret.style.display = 'none';\n                    }\n                    return;\n                }\n                if (_this.isMouseDown) {\n                    cursorPoint = _this.getTouchOffsetValue(event);\n                    var touchPoint = _this.owner.viewer.findFocusedPage(cursorPoint, true);\n                    if (_this.touchDownOnSelectionMark > 0 /*|| !this.useTouchSelectionMark*/) {\n                        _this.isCompleted = false;\n                        event.preventDefault();\n                        var touchY = touchPoint.y;\n                        var textPosition = _this.owner.selectionModule.end;\n                        var touchPointer = void 0;\n                        if (touchPoint.y <= 26) {\n                            touchY -= touchPoint.y < 0 ? 0 : touchPoint.y + 0.5;\n                        }\n                        else {\n                            touchY -= 36.5;\n                        }\n                        textPosition = _this.touchDownOnSelectionMark === 2 ? _this.selection.start : _this.selection.end;\n                        touchPoint = new _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.Point(touchPoint.x, touchY);\n                        _this.owner.selectionModule.moveTextPosition(touchPoint, textPosition);\n                        _this.isSelectionChangedOnMouseMoved = true;\n                    }\n                    _this.selection.checkForCursorVisibility();\n                    _this.updateTouchMarkPosition();\n                }\n            }\n            if (touch.length > 1) {\n                event.preventDefault();\n                _this.isMouseDown = false;\n                _this.zoomX = (touch[0].clientX + touch[1].clientX) / 2;\n                _this.zoomY = (touch[0].clientY + touch[1].clientY) / 2;\n                var currentDiff = Math.sqrt(Math.pow((touch[0].clientX - touch[1].clientX), 2) + Math.pow((touch[0].clientY - touch[1].clientY), 2));\n                if (_this.preDifference > -1) {\n                    if (currentDiff > _this.preDifference) {\n                        _this.onPinchOutInternal(event);\n                    }\n                    else if (currentDiff < _this.preDifference) {\n                        _this.onPinchInInternal(event);\n                    }\n                }\n                else if (_this.zoomFactor < 2) {\n                    if (_this.preDifference !== -1) {\n                        if (currentDiff > _this.preDifference) {\n                            _this.onPinchInInternal(event);\n                        }\n                    }\n                }\n                else if (_this.preDifference === -1) {\n                    if (_this.zoomFactor > 2) {\n                        if (currentDiff > _this.preDifference) {\n                            _this.onPinchInInternal(event);\n                        }\n                    }\n                }\n                _this.preDifference = currentDiff;\n            }\n            if (_this.longTouchTimer) {\n                clearTimeout(_this.longTouchTimer);\n                _this.longTouchTimer = undefined;\n            }\n        };\n        /**\n         * Fired on touch up.\n         *\n         * @private\n         * @param {TouchEvent} event - Specifies touch event.\n         * @returns {void}\n         */\n        this.onTouchUpInternal = function (event) {\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.selection)) {\n                var point = _this.getTouchOffsetValue(event);\n                var touchPoint = _this.owner.viewer.findFocusedPage(point, true);\n                if (event.changedTouches.length === 1) {\n                    if (!_this.isTouchMoved || (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing)) {\n                        _this.updateSelectionOnTouch(point, touchPoint);\n                        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.currentPage) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.selection.start)\n                            && !_this.isSelectionChangedOnMouseMoved && (_this.selection.isEmpty ||\n                            _this.selection.isImageField() && (!_this.owner.enableImageResizerMode ||\n                                _this.owner.enableImageResizerMode && !_this.owner.imageResizerModule.isImageResizing))) {\n                            _this.selection.navigateHyperLinkOnEvent(touchPoint, true);\n                        }\n                    }\n                    if (_this.isSelectionChangedOnMouseMoved) {\n                        _this.selection.fireSelectionChanged(true);\n                    }\n                    _this.isMouseDown = false;\n                    _this.touchDownOnSelectionMark = 0;\n                    _this.useTouchSelectionMark = true;\n                    _this.isSelectionChangedOnMouseMoved = false;\n                }\n                if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n                    _this.owner.imageResizerModule.mouseUpInternal();\n                    _this.owner.imageResizerModule.isImageResizing = false;\n                    _this.owner.imageResizerModule.isImageMoveToNextPage = false;\n                    _this.scrollToPosition(_this.owner.selectionModule.start, _this.owner.selectionModule.end);\n                }\n                if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizerVisible && _this.isTouchInput) {\n                    _this.touchStart.style.display = 'none';\n                    _this.touchEnd.style.display = 'none';\n                }\n                // if (!this.owner.isReadOnlyMode && this.isSelectionInListText(touchPoint)) {\n                //     this.selection.selectListText();\n                // }\n                event.preventDefault();\n            }\n            _this.preDifference = -1;\n            _this.isTouchInput = false;\n            if (_this.longTouchTimer) {\n                clearTimeout(_this.longTouchTimer);\n                _this.longTouchTimer = undefined;\n            }\n            if (!_this.isTimerStarted) {\n                _this.tapCount = 1;\n            }\n            if (_this.isListTextSelected) {\n                _this.selection.hideCaret();\n            }\n            _this.owner.focusIn();\n        };\n        /**\n         * Fired on keyup event.\n         *\n         * @private\n         * @param {KeyboardEvent} event - Specifies keyboard event.\n         * @returns {void}\n         */\n        this.onKeyUpInternal = function (event) {\n            if (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.Browser.isDevice && event.target === _this.editableDiv) {\n                if (window.getSelection().anchorOffset !== _this.prefix.length) {\n                    _this.selection.setEditableDivCaretPosition(_this.editableDiv.innerText.length);\n                }\n            }\n            if (event.ctrlKey || (event.keyCode === 17 || event.which === 17)) {\n                _this.isControlPressed = false;\n            }\n        };\n        /**\n         * Fired on keydown.\n         *\n         * @private\n         * @param {KeyboardEvent} event - Specifies keyboard event.\n         * @returns {void}\n         */\n        this.onKeyDownInternal = function (event) {\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(event.target) && event.target !== _this.editableDiv && event.target.id !== \"container_editor_iconsplitbtn\") {\n                return;\n            }\n            _this.owner.focusIn();\n            var isHandled = false;\n            var keyEventArgs = { 'event': event, 'isHandled': false, source: _this.owner };\n            _this.owner.trigger(_base_index__WEBPACK_IMPORTED_MODULE_13__.keyDownEvent, keyEventArgs);\n            if (keyEventArgs.isHandled) {\n                return;\n            }\n            var key = event.which || event.keyCode;\n            var ctrl = (event.ctrlKey || event.metaKey) ? true : ((key === 17) ? true : false); // ctrl detection       \n            var shift = event.shiftKey ? event.shiftKey : ((key === 16) ? true : false); // Shift Key detection        \n            var alt = event.altKey ? event.altKey : ((key === 18) ? true : false); // alt key detection\n            if (ctrl && !shift && !alt) {\n                switch (key) {\n                    case 80:\n                        event.preventDefault();\n                        _this.owner.print();\n                        isHandled = true;\n                        break;\n                    case 83:\n                        event.preventDefault();\n                        _this.owner.save(_this.owner.documentName === '' ? 'sample' : _this.owner.documentName, 'Sfdt');\n                        isHandled = true;\n                        break;\n                }\n            }\n            if (event.keyCode !== 8 && event.keyCode !== 46 && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner.editor) && _this.selection.checkContentControlLocked()) {\n                _this.owner.editorModule.insertContentControlPlaceholder();\n            }\n            if (!isHandled && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.selection)) {\n                _this.selection.caret.classList.remove(\"e-de-cursor-animation\");\n                _this.selection.onKeyDownInternal(event, ctrl, shift, alt);\n            }\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner.documentHelper) && _this.owner.documentHelper.contentControlCollection.length > 0) {\n                //Need to work on these\n                _this.clearContent();\n                _this.owner.documentHelper.viewer.updateScrollBars();\n            }\n            if (isHandled) {\n                event.preventDefault();\n            }\n            _this.timer = setTimeout(function () {\n                if (!_this.isScrollHandler && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner) && _this.owner.isSpellCheck) {\n                    _this.isScrollToSpellCheck = true;\n                    _this.owner.viewer.updateScrollBars();\n                }\n            }, 100);\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.selection) && !_this.selection.caret.classList.contains(\"e-de-cursor-animation\")) {\n                _this.selection.caret.classList.add(\"e-de-cursor-animation\");\n            }\n        };\n        this.owner = owner;\n        this.pages = [];\n        this.lists = [];\n        this.abstractLists = [];\n        this.render = new _render__WEBPACK_IMPORTED_MODULE_5__.Renderer(this);\n        this.characterFormat = new _format_index__WEBPACK_IMPORTED_MODULE_3__.WCharacterFormat(this);\n        this.themeFontLanguage = new _format_index__WEBPACK_IMPORTED_MODULE_3__.WCharacterFormat(this);\n        this.paragraphFormat = new _format_index__WEBPACK_IMPORTED_MODULE_3__.WParagraphFormat(this);\n        this.renderedLists = new _base_dictionary__WEBPACK_IMPORTED_MODULE_0__.Dictionary();\n        this.renderedLevelOverrides = [];\n        this.headersFooters = [];\n        this.styles = new _format_index__WEBPACK_IMPORTED_MODULE_3__.WStyles();\n        this.stylesMap = new _base_dictionary__WEBPACK_IMPORTED_MODULE_0__.Dictionary();\n        if (this.owner) {\n            this.L10n = new _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.L10n('documenteditor', this.owner.defaultLocale);\n            this.L10n.setLocale(this.owner.locale);\n        }\n        this.preDefinedStyles = new _base_dictionary__WEBPACK_IMPORTED_MODULE_0__.Dictionary();\n        this.initalizeStyles();\n        this.bookmarks = new _base_dictionary__WEBPACK_IMPORTED_MODULE_0__.Dictionary();\n        this.editRanges = new _base_dictionary__WEBPACK_IMPORTED_MODULE_0__.Dictionary();\n        this.isIosDevice = typeof window !== 'undefined' ? /Mac|iPad|iPod/i.test(navigator.userAgent) : false;\n        this.isMobileDevice = typeof window !== 'undefined' ? /Android|Windows Phone|webOS/i.test(navigator.userAgent) : false;\n        this.isLinuxOS = typeof window !== 'undefined' ? /Linux/i.test(navigator.userAgent) : false;\n        this.formFillPopup = new _dialogs_form_field_popup__WEBPACK_IMPORTED_MODULE_15__.FormFieldPopUp(this.owner);\n        this.contentDropDown = new _dialogs_content_control_popup__WEBPACK_IMPORTED_MODULE_16__.ContentControlPopUp(this.owner);\n        this.customXmlData = new _base_dictionary__WEBPACK_IMPORTED_MODULE_0__.Dictionary();\n        this.fontSubstitutionTable = new _base_dictionary__WEBPACK_IMPORTED_MODULE_0__.Dictionary();\n        this.contentControlCollection = [];\n        this.footnoteCollection = [];\n        this.endnoteCollection = [];\n        this.themes = new _themes_themes__WEBPACK_IMPORTED_MODULE_18__.Themes();\n        this.images = new _base_dictionary__WEBPACK_IMPORTED_MODULE_0__.Dictionary();\n    }\n    Object.defineProperty(DocumentHelper.prototype, \"visibleBounds\", {\n        /**\n         * Gets visible bounds.\n         *\n         * @private\n         * @returns {Rect} - Returns visible bounds.\n         */\n        get: function () {\n            return this.visibleBoundsIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"viewer\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"containerCanvas\", {\n        //Document Protection Properties Ends\n        //#region Properties\n        /**\n         * Gets container canvas.\n         *\n         * @private\n         * @returns {HTMLCanvasElement} - Returns page canvas.\n         */\n        get: function () {\n            if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.containerCanvasIn)) {\n                this.containerCanvasIn = document.createElement('canvas');\n                this.containerCanvasIn.getContext('2d').save();\n            }\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.pageContainer)\n                && this.containerCanvasIn.parentElement !== this.pageContainer) {\n                this.pageContainer.appendChild(this.containerCanvasIn);\n            }\n            return this.containerCanvasIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     * @param {string} text - Specifies the text string.\n     */\n    DocumentHelper.prototype.openTextFile = function (text) {\n        this.layout.isTextFormat = true;\n        var arr = [];\n        text = text.replace(/\\r\\n/g, '\\n');\n        arr = text.split('\\n');\n        var widget = [];\n        var bodyWidget = new _page__WEBPACK_IMPORTED_MODULE_7__.BodyWidget();\n        bodyWidget.sectionFormat = new _format_index__WEBPACK_IMPORTED_MODULE_3__.WSectionFormat(bodyWidget);\n        bodyWidget.childWidgets = widget;\n        var paragraph1 = new _page__WEBPACK_IMPORTED_MODULE_7__.ParagraphWidget();\n        var line1 = new _page__WEBPACK_IMPORTED_MODULE_7__.LineWidget(paragraph1);\n        for (var i = 0; i < arr.length; i++) {\n            if (i === arr.length - 1 && arr[i].length === 0) {\n                paragraph1.childWidgets.push(line1);\n                paragraph1.index = i;\n                paragraph1.containerWidget = bodyWidget;\n                bodyWidget.childWidgets.push(paragraph1);\n                continue;\n            }\n            var paragraph = new _page__WEBPACK_IMPORTED_MODULE_7__.ParagraphWidget();\n            var line = new _page__WEBPACK_IMPORTED_MODULE_7__.LineWidget(paragraph);\n            if (arr[i].length > 0) {\n                var singleLineLength = 90;\n                if (arr[i].length > singleLineLength) {\n                    var start = 0;\n                    var increment = singleLineLength;\n                    var split = void 0;\n                    var lineLength = (arr[i].length / singleLineLength) + 1;\n                    var count = 0;\n                    while (count < lineLength) {\n                        if (lineLength - 1 != count) {\n                            split = arr[i].substring(start, increment);\n                        }\n                        else {\n                            increment = arr[i].length % singleLineLength;\n                            split = arr[i].substring(start, increment);\n                        }\n                        var textElement = new _page__WEBPACK_IMPORTED_MODULE_7__.TextElementBox();\n                        textElement.text = split;\n                        line.children.push(textElement);\n                        textElement.line = line;\n                        count++;\n                        increment += singleLineLength;\n                        start += singleLineLength;\n                    }\n                }\n                else {\n                    var textElement = new _page__WEBPACK_IMPORTED_MODULE_7__.TextElementBox();\n                    textElement.text = arr[i];\n                    line.children.push(textElement);\n                    textElement.line = line;\n                }\n            }\n            paragraph.childWidgets.push(line);\n            paragraph.index = i;\n            paragraph.containerWidget = bodyWidget;\n            bodyWidget.childWidgets.push(paragraph);\n        }\n        this.onDocumentChanged([bodyWidget]);\n        this.layout.isTextFormat = false;\n    };\n    Object.defineProperty(DocumentHelper.prototype, \"selectionCanvas\", {\n        /**\n         * Gets selection canvas.\n         *\n         * @private\n         * @returns {HTMLCanvasElement} - Returns selection canvas.\n         */\n        get: function () {\n            if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.selectionCanvasIn)) {\n                this.selectionCanvasIn = document.createElement('canvas');\n                this.selectionCanvas.getContext('2d').save();\n            }\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.pageContainer)\n                && this.selectionCanvasIn.parentElement !== this.pageContainer) {\n                this.pageContainer.appendChild(this.selectionCanvasIn);\n            }\n            return this.selectionCanvasIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"containerContext\", {\n        /**\n         * Gets container context.\n         *\n         * @private\n         * @returns {CanvasRenderingContext2D} - Returns page canvas context.\n         */\n        get: function () {\n            return this.containerCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"selectionContext\", {\n        /**\n         * Gets selection context.\n         *\n         * @private\n         * @returns {CanvasRenderingContext2D} - Returns selection canvas context.\n         */\n        get: function () {\n            return this.selectionCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"currentRenderingPage\", {\n        /**\n         * Gets the current rendering page.\n         *\n         * @returns {Page} - Returns current rendering page.\n         */\n        get: function () {\n            if (this.pages.length === 0) {\n                return undefined;\n            }\n            return this.pages[this.pages.length - 1];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"zoomFactor\", {\n        /**\n         * Gets or sets zoom factor.\n         *\n         * @private\n         * @returns {number} - Returns zoom factor value.\n         */\n        get: function () {\n            return this.zoomFactorInternal;\n        },\n        set: function (value) {\n            if (this.zoomFactorInternal !== value) {\n                this.preZoomFactor = this.zoomFactor;\n                this.zoomFactorInternal = value;\n                this.zoomModule.setZoomFactor();\n                this.owner.zoomFactor = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"selection\", {\n        /**\n         * Gets the selection.\n         *\n         * @private\n         * @returns {Selection} - Returns selection module.\n         */\n        get: function () {\n            return this.owner.selectionModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"selectionStartPage\", {\n        /**\n         * Gets or sets selection start page.\n         *\n         * @private\n         * @returns {Page} - Return selection start page.\n         */\n        get: function () {\n            return this.selectionStartPageIn;\n        },\n        set: function (value) {\n            this.selectionStartPageIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"selectionEndPage\", {\n        /**\n         * Gets or sets selection end page.\n         *\n         * @private\n         * @returns {Page} - Return selection end page.\n         */\n        get: function () {\n            return this.selectionEndPageIn;\n        },\n        set: function (value) {\n            this.selectionEndPageIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"dialog\", {\n        /**\n         * Gets the initialized default dialog.\n         *\n         * @private\n         * @returns {Dialog} - Returns dialog instance.\n         */\n        get: function () {\n            if (!this.dialogInternal) {\n                this.initDialog(this.owner.enableRtl);\n            }\n            return this.dialogInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"dialog2\", {\n        /**\n         * Gets the initialized default dialog.\n         *\n         * @private\n         * @returns {Dialog} - Returns dialog instance.\n         */\n        get: function () {\n            if (!this.dialogInternal2) {\n                this.initDialog2(this.owner.enableRtl);\n            }\n            return this.dialogInternal2;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"dialog3\", {\n        /**\n         * Gets the initialized default dialog.\n         *\n         * @private\n         * @returns {Dialog} - Returns dialog instance.\n         */\n        get: function () {\n            if (!this.dialogInternal3) {\n                this.initDialog3(this.owner.enableRtl);\n            }\n            return this.dialogInternal3;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"currentSelectedComment\", {\n        /**\n         * @private\n         * @returns {void}\n         */\n        get: function () {\n            return this.currentSelectedCommentInternal;\n        },\n        set: function (value) {\n            if (this.owner && this.owner.commentReviewPane) {\n                this.owner.commentReviewPane.previousSelectedComment = this.currentSelectedCommentInternal;\n            }\n            this.currentSelectedCommentInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"currentSelectedRevision\", {\n        /**\n         * @private\n         * @returns {void}\n         */\n        get: function () {\n            return this.currentSelectedRevisionInternal;\n        },\n        set: function (value) {\n            // if (this.owner && this.owner.commentReviewPane) {\n            //     this.owner.commentReviewPane.previousSelectedComment = this.currentSelectedCommentInternal;\n            // }\n            this.currentSelectedRevisionInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"isInlineFormFillProtectedMode\", {\n        /**\n         * @private\n         * @returns {void}\n         */\n        get: function () {\n            return this.isFormFillProtectedMode && this.owner.documentEditorSettings.formFieldSettings.formFillingMode === 'Inline';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"isFormFillProtectedMode\", {\n        /**\n         * @private\n         * @returns {void}\n         */\n        get: function () {\n            return this.isDocumentProtected && this.protectionType === 'FormFieldsOnly';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"isCommentOnlyMode\", {\n        /**\n         * @private\n         * @returns {Boolean}\n         */\n        get: function () {\n            return this.isDocumentProtected && this.protectionType === 'CommentsOnly';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"isTrackedOnlyMode\", {\n        get: function () {\n            return this.isDocumentProtected && this.protectionType === 'RevisionsOnly';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    DocumentHelper.prototype.initalizeStyles = function () {\n        this.preDefinedStyles.add('Normal', '{\"type\":\"Paragraph\",\"name\":\"Normal\",\"next\":\"Normal\"}');\n        this.preDefinedStyles.add('Heading 1', '{\"type\":\"Paragraph\",\"name\":\"Heading 1\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 1 Char\",\"characterFormat\":{\"fontSize\":16.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":12.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level1\"}}');\n        this.preDefinedStyles.add('Heading 2', '{\"type\":\"Paragraph\",\"name\":\"Heading 2\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 2 Char\",\"characterFormat\":{\"fontSize\":13.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level2\"}}');\n        this.preDefinedStyles.add('Heading 3', '{\"type\":\"Paragraph\",\"name\":\"Heading 3\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 3 Char\",\"characterFormat\":{\"fontSize\":12.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level3\"}}');\n        this.preDefinedStyles.add('Heading 4', '{\"type\":\"Paragraph\",\"name\":\"Heading 4\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 4 Char\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level4\"}}');\n        this.preDefinedStyles.add('Heading 5', '{\"type\":\"Paragraph\",\"name\":\"Heading 5\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 5 Char\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level5\"}}');\n        this.preDefinedStyles.add('Heading 6', '{\"type\":\"Paragraph\",\"name\":\"Heading 6\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 6 Char\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level6\"}}');\n        this.preDefinedStyles.add('Heading 7', '{\"type\":\"Paragraph\",\"name\":\"Heading 7\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 7 Char\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level7\"}}');\n        this.preDefinedStyles.add('Heading 8', '{\"type\":\"Paragraph\",\"name\":\"Heading 8\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 8 Char\",\"characterFormat\":{\"fontSize\":10.5,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#333333\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level8\"}}');\n        this.preDefinedStyles.add('Heading 9', '{\"type\":\"Paragraph\",\"name\":\"Heading 9\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 9 Char\",\"characterFormat\":{\"fontSize\":10.5,\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#333333\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level9\"}}');\n        this.preDefinedStyles.add('Default Paragraph Font', '{\"type\":\"Character\",\"name\":\"Default Paragraph Font\"}');\n        this.preDefinedStyles.add('Heading 1 Char', '{\"type\":\"Character\",\"name\":\"Heading 1 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":16.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        this.preDefinedStyles.add('Heading 2 Char', '{\"type\":\"Character\",\"name\":\"Heading 2 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":13.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        this.preDefinedStyles.add('Heading 3 Char', '{\"type\":\"Character\",\"name\":\"Heading 3 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":12.0,\"fontFamily\":\"Calibri Light\",\"fontColor\": \"#1F3763\"}}');\n        this.preDefinedStyles.add('Heading 4 Char', '{\"type\":\"Character\",\"name\":\"Heading 4 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        this.preDefinedStyles.add('Heading 5 Char', '{\"type\":\"Character\",\"name\":\"Heading 5 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        this.preDefinedStyles.add('Heading 6 Char', '{\"type\":\"Character\",\"name\":\"Heading 6 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"}}');\n        this.preDefinedStyles.add('Heading 7 Char', '{\"type\":\"Character\",\"name\":\"Heading 7 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"}}');\n        this.preDefinedStyles.add('Heading 8 Char', '{\"type\":\"Character\",\"name\":\"Heading 8 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":10.5,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#333333\"}}');\n        this.preDefinedStyles.add('Heading 9 Char', '{\"type\":\"Character\",\"name\":\"Heading 9 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":10.5,\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#333333\"}}');\n        this.preDefinedStyles.add('Hyperlink', '{\"type\":\"Character\",\"name\":\"Hyperlink\",\"basedOn\":\"Default Paragraph Font\",\"next\":\"Normal\",\"characterFormat\":{\"fontColor\":\"#0563C1\",\"underline\": \"Single\"}}');\n        this.preDefinedStyles.add('TOC 1', '{\"type\":\"Paragraph\",\"name\":\"TOC 1\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"afterSpacing\":5.0}}');\n        this.preDefinedStyles.add('TOC 2', '{\"type\":\"Paragraph\",\"name\":\"TOC 2\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :11.0,\"afterSpacing\":5.0}}');\n        this.preDefinedStyles.add('TOC 3', '{\"type\":\"Paragraph\",\"name\":\"TOC 3\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :22.0,\"afterSpacing\":5.0}}');\n        this.preDefinedStyles.add('TOC 4', '{\"type\":\"Paragraph\",\"name\":\"TOC 4\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :33.0,\"afterSpacing\":5.0}}');\n        this.preDefinedStyles.add('TOC 5', '{\"type\":\"Paragraph\",\"name\":\"TOC 5\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :44.0,\"afterSpacing\":5.0}}');\n        this.preDefinedStyles.add('TOC 6', '{\"type\":\"Paragraph\",\"name\":\"TOC 6\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :55.0,\"afterSpacing\":5.0}}');\n        this.preDefinedStyles.add('TOC 7', '{\"type\":\"Paragraph\",\"name\":\"TOC 7\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :66.0,\"afterSpacing\":5.0}}');\n        this.preDefinedStyles.add('TOC 8', '{\"type\":\"Paragraph\",\"name\":\"TOC 8\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :77.0,\"afterSpacing\":5.0}}');\n        this.preDefinedStyles.add('TOC 9', '{\"type\":\"Paragraph\",\"name\":\"TOC 9\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :88.0,\"afterSpacing\":5.0}}');\n        this.preDefinedStyles.add('Header', '{\"type\":\"Paragraph\",\"name\":\"Header\",\"basedOn\":\"Normal\",\"next\":\"Header\",\"paragraphFormat\":{\"afterSpacing\":0,\"lineSpacing\":1,\"lineSpacingType\":\"Multiple\"}}');\n        this.preDefinedStyles.add('Footer', '{\"type\":\"Paragraph\",\"name\":\"Footer\",\"basedOn\":\"Normal\",\"next\":\"Footer\",\"paragraphFormat\":{\"afterSpacing\":0,\"lineSpacing\":1,\"lineSpacingType\":\"Multiple\"}}');\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    DocumentHelper.prototype.clearDocumentItems = function () {\n        if (this.owner.editorModule) {\n            this.owner.editorModule.clear();\n        }\n        if (this.owner.searchModule) {\n            this.owner.searchModule.clearSearchHighlight();\n        }\n        if (this.owner.selectionModule) {\n            this.owner.selectionModule.clear();\n        }\n        this.editRanges.clear();\n        this.headersFooters = [];\n        this.fields = [];\n        this.formFields = [];\n        this.currentSelectedComment = undefined;\n        this.currentSelectedRevision = undefined;\n        for (var i = 0; i < this.comments.length; i++) {\n            var commentStart = this.comments[i].commentStart;\n            if (commentStart) {\n                commentStart.destroy();\n            }\n        }\n        this.comments = [];\n        this.bookmarks.clear();\n        this.endBookmarksUpdated = [];\n        this.styles.clear();\n        this.stylesMap.clear();\n        if (this.pages && this.pages.length > 0) {\n            for (var i = 0; i < this.pages.length; i++) {\n                var page = this.pages[i];\n                page.componentDestroy();\n            }\n            this.pages = [];\n        }\n        this.authors.clear();\n        this.revisionsInternal.clear();\n        this.owner.revisions.clear();\n        this.characterFormat.clearFormat();\n        this.themeFontLanguage.clearFormat();\n        this.paragraphFormat.clearFormat();\n        if (this.owner.trackChangesPane) {\n            this.owner.trackChangesPane.clear();\n        }\n        if (this.owner.xmlPaneModule) {\n            this.owner.xmlPaneModule.clear();\n        }\n        this.setDefaultCharacterValue(this.characterFormat);\n        this.setDefaultParagraphValue(this.paragraphFormat);\n        if (this.owner.commentReviewPane) {\n            this.owner.commentReviewPane.clear();\n        }\n        this.isHeaderFooter = false;\n        this.defaultTabWidth = 36;\n        this.isDocumentProtected = false;\n        this.protectionType = 'NoProtection';\n        this.restrictFormatting = false;\n        this.hashValue = '';\n        this.saltValue = '';\n        this.userCollection = [];\n        if (this.formFillPopup) {\n            this.formFillPopup.hidePopup();\n        }\n        if (this.contentDropDown) {\n            this.contentDropDown.hidePopup();\n        }\n        this.customXmlData.clear();\n        this.fontSubstitutionTable.clear();\n        this.images.clear();\n        this.contentControlCollection = [];\n        this.backgroundColor = '#FFFFFF';\n        this.endnotes.clear();\n        this.footnotes.clear();\n        this.footnoteCollection = [];\n        this.endnoteCollection = [];\n        if (this.lists && this.lists.length > 0) {\n            for (var i = 0; i < this.lists.length; i++) {\n                var list = this.lists[i];\n                list.clear();\n            }\n        }\n        this.lists = [];\n        this.abstractLists = [];\n        this.themes = new _themes_themes__WEBPACK_IMPORTED_MODULE_18__.Themes();\n        this.hasThemes = false;\n        this.isRestartNumbering = false;\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    DocumentHelper.prototype.setDefaultDocumentFormat = function () {\n        this.owner.parser.parseCharacterFormat(0, this.owner.characterFormat, this.characterFormat);\n        this.owner.parser.parseParagraphFormat(0, this.owner.paragraphFormat, this.paragraphFormat);\n    };\n    DocumentHelper.prototype.setDefaultCharacterValue = function (characterFormat) {\n        characterFormat.bold = false;\n        characterFormat.italic = false;\n        characterFormat.fontFamily = 'Calibri';\n        characterFormat.fontSize = 11;\n        characterFormat.underline = 'None';\n        characterFormat.strikethrough = 'None';\n        characterFormat.fontSizeBidi = 11;\n        characterFormat.fontFamilyBidi = 'Calibri';\n        characterFormat.baselineAlignment = 'Normal';\n        characterFormat.highlightColor = 'NoColor';\n        characterFormat.allCaps = false;\n    };\n    DocumentHelper.prototype.setDefaultParagraphValue = function (paragraphFormat) {\n        paragraphFormat.leftIndent = 0;\n        paragraphFormat.rightIndent = 0;\n        paragraphFormat.firstLineIndent = 0;\n        paragraphFormat.textAlignment = 'Left';\n        paragraphFormat.beforeSpacing = 0;\n        paragraphFormat.afterSpacing = 0;\n        paragraphFormat.lineSpacing = 1;\n        paragraphFormat.lineSpacingType = 'Multiple';\n        paragraphFormat.bidi = false;\n        paragraphFormat.keepWithNext = false;\n        paragraphFormat.keepLinesTogether = false;\n        paragraphFormat.widowControl = true;\n        paragraphFormat.outlineLevel = 'BodyText';\n    };\n    /**\n     * @private\n     * @param {number} id - Specfies abstract list id.\n     * @returns {WAbstractList} - Returns abstract list.\n     */\n    DocumentHelper.prototype.getAbstractListById = function (id, isNsid) {\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.abstractLists)) {\n            return undefined;\n        }\n        for (var i = 0; i < this.abstractLists.length; i++) {\n            var abstractList = this.abstractLists[i];\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(abstractList)) {\n                if (isNsid && abstractList.nsid === id) {\n                    return abstractList;\n                }\n                else if (abstractList.abstractListId === id) {\n                    return abstractList;\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     * @param {number} id - Specfies list id.\n     * @returns {WAbstractList} - Returns list.\n     */\n    DocumentHelper.prototype.getListById = function (id, isNsid) {\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.lists)) {\n            return undefined;\n        }\n        for (var i = 0; i < this.lists.length; i++) {\n            var list = this.lists[i];\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(list)) {\n                if (isNsid && list.nsid === id) {\n                    return list;\n                }\n                else if (list.listId === id) {\n                    return list;\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     * @param {WListLevel} listLevel - Specfies list level.\n     * @returns {number} - Returns list level number.\n     */\n    DocumentHelper.getListLevelNumber = function (listLevel) {\n        if (listLevel.ownerBase instanceof _list_level_override__WEBPACK_IMPORTED_MODULE_2__.WLevelOverride) {\n            return listLevel.ownerBase.levelNumber;\n        }\n        else if (listLevel.ownerBase instanceof _list_abstract_list__WEBPACK_IMPORTED_MODULE_1__.WAbstractList && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(listLevel.ownerBase.levels)) {\n            return listLevel.ownerBase.levels.indexOf(listLevel);\n        }\n        else {\n            return -1;\n        }\n    };\n    /**\n    * @private\n    * @param {ImageElementBox} image - Specfies image.\n    * @returns {number} - Returns base64string.\n    */\n    DocumentHelper.prototype.getImageString = function (image) {\n        var base64ImageString = this.images.get(parseInt(image.imageString));\n        var imageStr;\n        if (image.isMetaFile && _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.formatClippedString(base64ImageString[0]).extension !== \".svg\") {\n            imageStr = base64ImageString[1];\n        }\n        else if (_editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.formatClippedString(base64ImageString[0]).extension === \".tif\") {\n            imageStr = base64ImageString[1];\n        }\n        else {\n            imageStr = base64ImageString[0];\n        }\n        return imageStr;\n    };\n    /**\n     * @private\n     * @param {ImageElementBox} image - Specfies image.\n     * @returns {number} - Returns key for specific image.\n     */\n    DocumentHelper.prototype.addBase64StringInCollection = function (image) {\n        return __awaiter(this, void 0, void 0, function () {\n            var key, addToCollection, base64ImageString, i, index, imageStringCol;\n            return __generator(this, function (_a) {\n                key = this.images.length > 0 ? Math.max.apply(Math, this.images.keys) + 1 : 0;\n                addToCollection = true;\n                base64ImageString = [];\n                for (i = 0; i < this.images.length; i++) {\n                    index = this.images.keys[parseInt(i.toString(), 10)];\n                    imageStringCol = this.images.get(index);\n                    if (image.isMetaFile && image.metaFileImageString === imageStringCol[0]) {\n                        key = index;\n                        addToCollection = false;\n                        break;\n                    }\n                    else if (image.imageString === imageStringCol[0]) {\n                        key = index;\n                        addToCollection = false;\n                        break;\n                    }\n                }\n                if (addToCollection) {\n                    if (image.isMetaFile) {\n                        base64ImageString.push(!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(image.metaFileImageString) ? image.metaFileImageString : image.imageString);\n                        base64ImageString.push(image.imageString === \"\" ? image.metaFileImageString : image.imageString);\n                    }\n                    else {\n                        base64ImageString.push(image.imageString);\n                    }\n                    this.images.add(key, base64ImageString);\n                }\n                if (image.isMetaFile && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(image.metaFileImageString)) {\n                    image.metaFileImageString = key.toString();\n                }\n                image.imageString = key.toString();\n                return [2 /*return*/];\n            });\n        });\n    };\n    /**\n     * Gets the bookmarks.\n     *\n     * @private\n     * @param {boolean} includeHidden - Include hidden bookmark.\n     * @returns {string[]} - Returns bookmars present in current document.\n     */\n    DocumentHelper.prototype.getBookmarks = function (includeHidden) {\n        var bookmarks = [];\n        for (var i = 0; i < this.bookmarks.keys.length; i++) {\n            var bookmark = this.bookmarks.keys[i];\n            if (includeHidden || bookmark.indexOf('_') !== 0) {\n                bookmarks.push(bookmark);\n            }\n        }\n        return bookmarks;\n    };\n    DocumentHelper.prototype.selectComment = function (comment) {\n        var _this = this;\n        if (this.owner.selectionModule && this.owner.commentReviewPane) {\n            this.owner.showComments = true;\n            setTimeout(function () {\n                if (_this.owner && _this.owner.selectionModule) {\n                    _this.owner.selectionModule.selectComment(comment);\n                }\n            });\n        }\n    };\n    DocumentHelper.prototype.showComments = function (show) {\n        if (this.owner && show && this.owner.enableComment) {\n            var eventArgs = { type: 'Comment' };\n            this.owner.trigger(_base_index__WEBPACK_IMPORTED_MODULE_13__.beforePaneSwitchEvent, eventArgs);\n        }\n        this.owner.commentReviewPane.reviewTab.hideTab(0, false);\n        this.owner.commentReviewPane.reviewTab.hideTab(1, false);\n        this.owner.commentReviewPane.showHidePane(show && this.owner.enableComment, 'Comments');\n    };\n    DocumentHelper.prototype.showRevisions = function (show) {\n        var isCommentTabVisible = false;\n        this.showRevision = show;\n        if (this.owner && show) {\n            var eventArgs = { type: 'comment' };\n            this.owner.trigger(_base_index__WEBPACK_IMPORTED_MODULE_13__.beforePaneSwitchEvent, eventArgs);\n        }\n        if (!show && this.owner.showComments) {\n            this.owner.commentReviewPane.reviewTab.hideTab(0, false);\n            this.owner.commentReviewPane.showHidePane(true, 'Comments');\n        }\n        else {\n            this.owner.commentReviewPane.showHidePane(show, 'Changes');\n            if (!this.owner.enableComment) {\n                isCommentTabVisible = true;\n            }\n            // this.owner.commentReviewPane.reviewTab.hideTab(0, isCommentTabVisible);\n            this.showRevision = false;\n        }\n        if (show) {\n            this.owner.trackChangesPane.enableDisableButton(!this.owner.isReadOnly && !this.isDocumentProtected);\n        }\n    };\n    /**\n     * Initializes components.\n     *\n     * @private\n     * @returns {void}\n     */\n    DocumentHelper.prototype.initializeComponents = function () {\n        var element = this.owner.element;\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(element)) {\n            return;\n        }\n        //let viewer: LayoutViewer = this;\n        this.optionsPaneContainer = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.createElement)('div', {\n            className: 'e-documenteditor-optionspane'\n        });\n        this.optionsPaneContainer.contentEditable = 'false';\n        element.appendChild(this.optionsPaneContainer);\n        var isRtl = this.owner.enableRtl;\n        var viewerContainerStyle;\n        if (isRtl) {\n            viewerContainerStyle = 'direction:ltr;';\n        }\n        this.viewerContainer = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.createElement)('div', { id: this.owner.containerId + '_viewerContainer' });\n        this.viewerContainer.style.cssText = 'position:relative;backgroundColor:#FBFBFB;overflow:auto;' + viewerContainerStyle;\n        this.optionsPaneContainer.appendChild(this.viewerContainer);\n        this.viewerContainer.tabIndex = -1;\n        this.viewerContainer.style.outline = 'none';\n        this.pageContainer = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.createElement)('div', { id: this.owner.containerId + '_pageContainer', className: 'e-de-background' });\n        this.viewerContainer.appendChild(this.pageContainer);\n        this.pageContainer.style.top = '0px';\n        this.pageContainer.style.left = '0px';\n        this.pageContainer.style.position = 'relative';\n        this.pageContainer.style.pointerEvents = 'none';\n        if (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.Browser.isDevice) {\n            this.createEditableDiv(element);\n        }\n        else {\n            this.createEditableIFrame();\n        }\n        if (this.owner.enableImageResizerMode) {\n            this.owner.imageResizerModule.initializeImageResizer();\n        }\n        this.updateViewerSizeInternal(element);\n        this.layout = new _layout__WEBPACK_IMPORTED_MODULE_4__.Layout(this);\n        this.textHelper = new _text_helper__WEBPACK_IMPORTED_MODULE_9__.TextHelper(this);\n        this.zoomModule = new _zooming__WEBPACK_IMPORTED_MODULE_11__.Zoom(this);\n        this.initTouchEllipse();\n        this.wireEvent();\n        this.restrictEditingPane = new _restrict_editing_restrict_editing_pane__WEBPACK_IMPORTED_MODULE_14__.RestrictEditing(this);\n        this.owner.commentReviewPane = new _index__WEBPACK_IMPORTED_MODULE_10__.CommentReviewPane(this.owner);\n        this.owner.trackChangesPane = new _track_changes_track_changes_pane__WEBPACK_IMPORTED_MODULE_17__.TrackChangesPane(this.owner, this.owner.commentReviewPane);\n        (0,_syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_12__.createSpinner)({ target: this.owner.element, cssClass: 'e-spin-overlay' });\n    };\n    DocumentHelper.prototype.measureScrollbarWidth = function (element) {\n        var parentDiv = document.createElement('div');\n        parentDiv.style.cssText = 'visibility:hidden;overflow:scroll;';\n        element.appendChild(parentDiv);\n        var childDiv = document.createElement('div');\n        parentDiv.appendChild(childDiv);\n        this.scrollbarWidth = (parentDiv.getBoundingClientRect().width - childDiv.getBoundingClientRect().width);\n        parentDiv.parentNode.removeChild(parentDiv);\n    };\n    DocumentHelper.prototype.createEditableDiv = function (element) {\n        this.editableDiv = document.createElement('div');\n        this.editableDiv.contentEditable = this.owner.isReadOnlyMode ? 'false' : 'true';\n        this.editableDiv.style.position = 'fixed';\n        this.editableDiv.style.left = '-150em';\n        this.editableDiv.style.width = '100%';\n        this.editableDiv.style.height = '100%';\n        this.editableDiv.id = element.id + '_editableDiv';\n        document.body.appendChild(this.editableDiv);\n    };\n    DocumentHelper.prototype.createEditableIFrame = function () {\n        this.iframe = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.createElement)('iframe', {\n            attrs: {\n                'scrolling': 'no',\n                'title': 'Document Editor',\n                'style': 'pointer-events:none;position:absolute;left:0px;top:0px;outline:none;background-color:transparent;width:0px;height:0px;overflow:hidden',\n                'tabindex': \"0\"\n            },\n            className: 'e-de-text-target'\n        });\n        this.viewerContainer.appendChild(this.iframe);\n        this.initIframeContent();\n    };\n    DocumentHelper.prototype.initIframeContent = function () {\n        var innerHtml = \"<!DOCTYPE html>\\n            <html lang=\\\"\" + this.owner.locale + \"\\\">\\n            <head></head>\\n            <body spellcheck=\\\"false\\\">\\n                <div contenteditable=\\\"true\\\"></div>\\n            </body>\\n            </html>\";\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.iframe.contentDocument)) {\n            this.iframe.contentDocument.open();\n            this.iframe.contentDocument.write(innerHtml);\n            this.iframe.contentDocument.close();\n            this.editableDiv = this.iframe.contentDocument.body.children[0];\n            var cssText = 'background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px';\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.updateCSSText)(this.iframe.contentDocument.body, cssText);\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.updateCSSText)(this.editableDiv, cssText);\n        }\n    };\n    /**\n     * Wires events and methods.\n     *\n     * @returns {void}\n     */\n    DocumentHelper.prototype.wireEvent = function () {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner.selectionModule)) {\n            this.selection.initCaret();\n        }\n        this.wireInputEvents();\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.iframe)) {\n            this.iframe.addEventListener('load', this.onIframeLoad.bind(this));\n        }\n        this.viewerContainer.addEventListener('scroll', this.scrollHandler);\n        this.viewerContainer.addEventListener('mousedown', this.onMouseDownInternal);\n        this.viewerContainer.addEventListener('keydown', this.onKeyDownInternal);\n        this.viewerContainer.addEventListener('mousemove', this.onMouseMoveInternal);\n        this.viewerContainer.addEventListener('mouseleave', this.onMouseLeaveInternal);\n        this.viewerContainer.addEventListener('mouseenter', this.onMouseEnterInternal);\n        this.viewerContainer.addEventListener('contextmenu', this.onContextMenu);\n        this.viewerContainer.addEventListener('dblclick', this.onDoubleTap);\n        this.viewerContainer.addEventListener('mouseup', this.onMouseUpInternal);\n        window.addEventListener('resize', this.onWindowResize);\n        window.addEventListener('keyup', this.onKeyUpInternal);\n        window.addEventListener('mouseup', this.onImageResizer);\n        window.addEventListener('touchend', this.onImageResizer);\n        window.addEventListener('copy', this.onCopy);\n        this.viewerContainer.addEventListener('touchstart', this.onTouchStartInternal);\n        this.viewerContainer.addEventListener('touchmove', this.onTouchMoveInternal);\n        this.viewerContainer.addEventListener('touchend', this.onTouchUpInternal);\n        if (navigator !== undefined && navigator.userAgent.match('Firefox')) {\n            this.viewerContainer.addEventListener('DOMMouseScroll', this.zoomModule.onMouseWheelInternal);\n        }\n        this.viewerContainer.addEventListener('mousewheel', this.zoomModule.onMouseWheelInternal);\n        this.editableDiv.addEventListener('focus', this.updateFocus);\n    };\n    DocumentHelper.prototype.wireInputEvents = function () {\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.editableDiv)) {\n            return;\n        }\n        this.editableDiv.addEventListener('paste', this.onPaste);\n        if (!_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.Browser.isDevice) {\n            this.editableDiv.addEventListener('keypress', this.onKeyPressInternal);\n            if (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.Browser.info.name === 'chrome') {\n                this.editableDiv.addEventListener('textInput', this.onTextInput);\n            }\n        }\n        else {\n            this.editableDiv.addEventListener('input', this.onTextInputInternal);\n        }\n        this.editableDiv.addEventListener('blur', this.onFocusOut);\n        this.editableDiv.addEventListener('keydown', this.onKeyDownInternal);\n        this.editableDiv.addEventListener('compositionstart', this.compositionStart);\n        this.editableDiv.addEventListener('compositionupdate', this.compositionUpdated);\n        this.editableDiv.addEventListener('compositionend', this.compositionEnd);\n    };\n    DocumentHelper.prototype.onIframeLoad = function () {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.iframe) && this.iframe.contentDocument.body.children.length === 0) {\n            this.initIframeContent();\n            this.wireInputEvents();\n        }\n    };\n    DocumentHelper.prototype.getEditableDivTextContent = function () {\n        return this.editableDiv.textContent;\n    };\n    DocumentHelper.prototype.updateAuthorIdentity = function () {\n        var revisions = this.owner.revisions.changes;\n        for (var i = 0; i < revisions.length; i++) {\n            this.getAuthorColor(revisions[i].author);\n        }\n    };\n    DocumentHelper.prototype.getAvatar = function (userInfo, userName, comment, revision) {\n        var author;\n        var userinitial;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(comment)) {\n            author = comment.author;\n            userinitial = comment.initial;\n        }\n        else {\n            author = revision.author;\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(author)) {\n            var avatarDiv = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.createElement)('div', { className: 'e-de-cmt-avatar' });\n            var avatar = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.createElement)('div', { className: 'e-de-ff-cmt-avatar' });\n            avatar.style.backgroundColor = this.owner.documentHelper.getAuthorColor(author);\n            if (userinitial === '' || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(userinitial)) {\n                var authorName = author.split(' ');\n                var initial = authorName[0].charAt(0);\n                if (authorName.length > 1 && authorName[authorName.length - 1] !== '') {\n                    initial += authorName[authorName.length - 1][0];\n                }\n                avatar.innerText = initial.toUpperCase();\n            }\n            else {\n                if (userinitial.length > 2) {\n                    avatar.innerText = userinitial.substring(0, 2);\n                }\n                else {\n                    avatar.innerText = userinitial;\n                }\n            }\n            avatarDiv.appendChild(avatar);\n            avatarDiv.appendChild(userName);\n            userInfo.appendChild(avatarDiv);\n        }\n    };\n    /**\n     * @private\n     * @param {string} author - Specifies author name.\n     * @returns {string} - Return autor color.\n     */\n    DocumentHelper.prototype.getAuthorColor = function (author) {\n        if (this.authors.containsKey(author)) {\n            return this.authors.get(author);\n        }\n        var color;\n        if (this.authors.length === 0) {\n            color = '#b5082e'; //dark red\n        }\n        else {\n            color = this.generateRandomColor();\n        }\n        this.authors.add(author, color);\n        return color;\n    };\n    DocumentHelper.prototype.generateRandomColor = function () {\n        var userColors = ['#b5082e',\n            '#2e97d3',\n            '#bb00ff',\n            '#f37e43',\n            '#03a60b',\n            '#881824',\n            '#e09a2b',\n            '#50565e']; //dark grey\n        return userColors[(this.authors.length % 8)];\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    DocumentHelper.prototype.positionEditableTarget = function () {\n        var point = this.selection.getRect(this.selection.start);\n        var page = this.selection.getSelectionPage(this.selection.start);\n        // const caretInfo: CaretHeightInfo = this.selection.updateCaretSize(this.owner.selection.start);\n        var sectionFormat = page.bodyWidgets[0].sectionFormat;\n        var left = page.boundingRectangle.x + (_editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(sectionFormat.leftMargin) * this.zoomFactor);\n        var top = point.y;\n        var pageWidth = sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin;\n        var iframeStyle = 'left:' + left + 'px;';\n        iframeStyle += 'top:' + top + 'px;';\n        iframeStyle += 'width:' + (_editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(pageWidth) * this.zoomFactor) + 'px;';\n        iframeStyle += 'height:250px;outline-style:none;position:absolute';\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.updateCSSText)(this.iframe, iframeStyle);\n        var style = 'background-color:transparent;width:100%;height:250px;padding: 0px; margin: 0px;';\n        style += 'text-indent:' + (point.x - left) + 'px;';\n        style += 'color:transparent;pointer-events:none;outline-style:none;';\n        style += 'font-size:' + (_editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(this.selection.characterFormat.fontSize) * this.zoomFactor) + 'px;';\n        style += 'font-family' + this.selection.characterFormat.fontFamily + ';';\n        style += 'overflow:hidden;text-decoration:none;white-space:normal;';\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.updateCSSText)(this.editableDiv, style);\n    };\n    DocumentHelper.prototype.initDialog = function (isRtl) {\n        if (!this.dialogInternal) {\n            this.dialogTarget1 = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.createElement)('div', { className: 'e-de-dlg-target' });\n            this.dialogTarget1.contentEditable = 'false';\n            document.body.appendChild(this.dialogTarget1);\n            if (isRtl) {\n                this.dialogTarget1.classList.add('e-de-rtl');\n            }\n            this.dialogInternal = new _syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_12__.Dialog({\n                target: this.owner.documentEditorSettings.popupTarget, showCloseIcon: true,\n                allowDragging: true, enableRtl: isRtl, visible: false,\n                width: '1px', isModal: true, position: { X: 'center', Y: 'center' }, zIndex: this.owner.zIndex + 20,\n                animationSettings: { effect: 'None' }\n            });\n            this.dialogInternal.isStringTemplate = true;\n            this.dialogInternal.open = this.selection.hideCaret;\n            this.dialogInternal.beforeClose = this.updateFocus;\n            this.dialogInternal.appendTo(this.dialogTarget1);\n        }\n    };\n    DocumentHelper.prototype.initDialog3 = function (isRtl) {\n        if (!this.dialogInternal3) {\n            this.dialogTarget3 = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.createElement)('div', { className: 'e-de-dlg-target' });\n            this.dialogTarget3.contentEditable = 'false';\n            document.body.appendChild(this.dialogTarget3);\n            if (isRtl) {\n                this.dialogTarget3.classList.add('e-de-rtl');\n            }\n            this.dialogInternal3 = new _syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_12__.Dialog({\n                target: this.owner.documentEditorSettings.popupTarget, showCloseIcon: true,\n                allowDragging: true, enableRtl: isRtl, visible: false,\n                width: '1px', isModal: true, position: { X: 'center', Y: 'center' }, zIndex: this.owner.zIndex,\n                animationSettings: { effect: 'None' }\n            });\n            this.dialogInternal3.isStringTemplate = true;\n            this.dialogInternal3.open = this.selection.hideCaret;\n            this.dialogInternal3.beforeClose = this.updateFocus;\n            this.dialogInternal3.appendTo(this.dialogTarget3);\n        }\n    };\n    DocumentHelper.prototype.hideDialog = function () {\n        this.dialog.hide();\n        this.updateFocus();\n    };\n    DocumentHelper.prototype.initDialog2 = function (isRtl) {\n        if (!this.dialogInternal2) {\n            this.dialogTarget2 = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.createElement)('div', { className: 'e-de-dlg-target' });\n            this.dialogTarget2.contentEditable = 'false';\n            document.body.appendChild(this.dialogTarget2);\n            if (isRtl) {\n                this.dialogTarget2.classList.add('e-de-rtl');\n            }\n            this.dialogInternal2 = new _syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_12__.Dialog({\n                target: this.owner.documentEditorSettings.popupTarget, showCloseIcon: true,\n                allowDragging: true, enableRtl: isRtl, visible: false,\n                width: '1px', isModal: true, position: { X: 'center', Y: 'Top' }, zIndex: this.owner.zIndex + 10\n            });\n            this.dialogInternal2.isStringTemplate = true;\n            this.dialogInternal2.appendTo(this.dialogTarget2);\n        }\n    };\n    DocumentHelper.prototype.getBase64 = function (base64String, width, height) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, new Promise(function (resolve, reject) {\n                        var drawImage = new Image();\n                        drawImage.onload = function () {\n                            var displayPixelRatio = Math.max(1, window.devicePixelRatio || 1);\n                            var draw = document.createElement('canvas');\n                            draw.width = width * displayPixelRatio;\n                            draw.height = height * displayPixelRatio;\n                            var context = draw.getContext('2d');\n                            context.scale(displayPixelRatio, displayPixelRatio);\n                            context.drawImage(drawImage, 0, 0, width, height);\n                            var imageString = draw.toDataURL('image/png', 1);\n                            resolve(imageString);\n                        };\n                        drawImage.onerror = function () {\n                            reject();\n                        };\n                        if (base64String && (_editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.startsWith(base64String, 'http://') || _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.startsWith(base64String, 'https://'))) {\n                            fetch(base64String, { cache: 'no-cache' }).then(function (response) {\n                                return response.blob();\n                            }).then(function (blob) {\n                                return new Promise(function (resolve, reject) {\n                                    var reader = new FileReader();\n                                    reader.onloadend = function () { return resolve(reader.result); };\n                                    reader.onerror = reject;\n                                    reader.readAsDataURL(blob);\n                                });\n                            }).then(function (dataUrl) {\n                                drawImage.src = dataUrl;\n                            }).catch(function () {\n                                reject();\n                            });\n                        }\n                    })];\n            });\n        });\n    };\n    /**\n     * Clears the context.\n     *\n     * @private\n     * @returns {void}\n     */\n    DocumentHelper.prototype.clearContent = function () {\n        this.containerContext.clearRect(0, 0, this.containerCanvas.width, this.containerCanvas.height);\n        this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n        // Hide comment mark\n        if (this.pageContainer) {\n            var commentMarkElement = this.pageContainer.getElementsByClassName('e-de-cmt-mark');\n            for (var i = 0; i < commentMarkElement.length; i++) {\n                commentMarkElement[i].style.display = 'none';\n            }\n        }\n        if (this.pageContainer) {\n            var editRangeStart = this.pageContainer.getElementsByClassName('e-de-lock-mark');\n            for (var i = 0; i < editRangeStart.length; i++) {\n                editRangeStart[i].style.display = 'none';\n            }\n        }\n    };\n    /**\n     * Fired when the document gets changed.\n     *\n     * @private\n     * @param {BodyWidget[]} sections - Specified document content.\n     * @returns {void}\n     */\n    DocumentHelper.prototype.onDocumentChanged = function (sections, iOps) {\n        var _this = this;\n        this.clearContent();\n        if (this.owner.editorModule) {\n            this.owner.editorModule.tocStyles = {};\n            this.owner.editorModule.tocBookmarkId = 0;\n        }\n        this.heightInfoCollection = {};\n        this.owner.isDocumentLoaded = false;\n        this.viewer.columnLayoutArea.clear();\n        this.layout.isDocumentContainsRtl = false;\n        this.layout.isMultiColumnDoc = false;\n        this.isMappedContentControlUpdated = true;\n        this.isSpellCheckPending = false;\n        this.updateAuthorIdentity();\n        for (var i = 0; i < this.pages.length; i++) {\n            for (var j = 0; j < this.pages[i].bodyWidgets.length; j++) {\n                this.pages[i].bodyWidgets[j].destroy();\n            }\n        }\n        this.pages = [];\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.renderedLists)) {\n            this.renderedLists.clear();\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.renderedLevelOverrides)) {\n            this.renderedLevelOverrides = [];\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner.editorHistoryModule)) {\n            this.owner.editorHistoryModule.destroy();\n        }\n        this.owner.isDocumentLoaded = true;\n        this.owner.isUpdateTrackChanges = false;\n        this.layout.isInitialLoad = true;\n        this.layout.footHeight = 0;\n        this.layout.footnoteHeight = 0;\n        this.layout.layoutItems(sections, false);\n        if (this.owner.selectionModule) {\n            this.selection.previousSelectedFormField = undefined;\n            if (this.formFields.length > 0) {\n                this.owner.selectionModule.highlightFormFields();\n            }\n            this.owner.selectionModule.editRangeCollection = [];\n            this.owner.selectionModule.selectRange(this.owner.documentStart, this.owner.documentStart);\n            if (this.isDocumentProtected && this.protectionType == 'FormFieldsOnly') {\n                this.owner.selectionModule.navigateToNextFormField();\n            }\n            if (this.isDocumentProtected) {\n                this.restrictEditingPane.showHideRestrictPane(true);\n            }\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(iOps) && this.owner.editorModule) {\n            this.owner.editorModule.intializeDefaultStyles();\n        }\n        if (this.owner.enableCollaborativeEditing && this.owner.collaborativeEditingHandlerModule && this.owner.enableEditor) {\n            this.owner.editorModule.isRemoteAction = true;\n            this.owner.editorModule.isIncrementalSave = true;\n            if (iOps && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(iOps[_base_index__WEBPACK_IMPORTED_MODULE_13__.incrementalOps[0]])\n                && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(iOps[_base_index__WEBPACK_IMPORTED_MODULE_13__.incrementalOps[0]].length > 0)) {\n                for (var k = 0; k < iOps[_base_index__WEBPACK_IMPORTED_MODULE_13__.incrementalOps[0]].length; k++) {\n                    this.owner.collaborativeEditingHandlerModule.applyRemoteAction('action', iOps[_base_index__WEBPACK_IMPORTED_MODULE_13__.incrementalOps[0]][k]);\n                }\n            }\n            this.owner.editorModule.isRemoteAction = false;\n            this.owner.editorModule.isIncrementalSave = false;\n            this.owner.selectionModule.selectRange(this.owner.documentStart, this.owner.documentStart);\n        }\n        if (this.owner.optionsPaneModule) {\n            this.owner.optionsPaneModule.showHideOptionsPane(false);\n        }\n        if (this.restrictEditingPane.restrictPane && !this.isDocumentProtected) {\n            this.restrictEditingPane.showHideRestrictPane(false);\n        }\n        if (this.owner.xmlPaneModule) {\n            this.owner.editor.XMLFilesNameSpaceCount = 1;\n            this.owner.xmlPaneModule.showXmlProperties(false);\n            this.owner.xmlPaneModule.isXmlPaneShow = false;\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner.selectionModule) && this.owner.selectionModule.isViewPasteOptions) {\n            this.owner.selectionModule.isViewPasteOptions = false;\n            this.owner.selectionModule.showHidePasteOptions(undefined, undefined);\n        }\n        this.owner.fireDocumentChange();\n        this.owner.showHideRulers();\n        setTimeout(function () {\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner) && _this.owner.showRevisions) {\n                _this.showRevisions(true);\n            }\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner)) {\n                _this.owner.isUpdateTrackChanges = true;\n            }\n        });\n        var picture_cc = document.getElementById(this.owner.element.id + 'PICTURE_CONTENT_CONTROL');\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(picture_cc)) {\n            this.owner.renderPictureContentControlElement(this.owner, false, false);\n        }\n        this.layout.isInitialLoad = false;\n    };\n    /**\n     * Initialize touch ellipse.\n     *\n     * @returns {void}\n     */\n    DocumentHelper.prototype.initTouchEllipse = function () {\n        var style = 'height: 30px;width: 30px;position: absolute;background-color: transparent;margin: 0px;padding: 0px;z-index:5';\n        var ellipse = ' height: 12px;width: 12px;border-radius: 50%;background-color: white;position: absolute;margin: 0px 6px 0px 6px;border-width: 2px;border-style: solid;border-color: #000000;box-sizing: unset;';\n        this.touchStart = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.createElement)('div', { className: 'e-touch-ellipse', styles: style });\n        var start = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.createElement)('div', { styles: ellipse });\n        this.touchEnd = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.createElement)('div', { className: 'e-touch-ellipse', styles: style });\n        this.touchStart.style.display = 'none';\n        var end = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.createElement)('div', { styles: ellipse });\n        this.touchStart.appendChild(start);\n        this.touchEnd.appendChild(end);\n        this.touchEnd.style.display = 'none';\n        this.viewerContainer.appendChild(this.touchStart);\n        this.viewerContainer.appendChild(this.touchEnd);\n    };\n    /**\n     * Updates touch mark position.\n     *\n     * @private\n     * @returns {void}\n     */\n    DocumentHelper.prototype.updateTouchMarkPosition = function () {\n        if (this.touchStart.style.display !== 'none' && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.selection)) {\n            if (!this.selection.isEmpty) {\n                var y = this.selection.getCaretBottom(this.selection.start, false);\n                var page = this.selection.getPage(this.selection.start.paragraph);\n                var pageTop = (page.boundingRectangle.y - (this.owner.viewer.pageGap * (this.pages.indexOf(page) + 1)) * this.zoomFactor + this.owner.viewer.pageGap * (this.pages.indexOf(page) + 1));\n                this.touchStart.style.left = page.boundingRectangle.x + (Math.round(this.selection.start.location.x) * this.zoomFactor - 14) + 'px';\n                this.touchStart.style.top = pageTop + ((y) * this.zoomFactor) + 'px';\n                if (!this.selection.isEmpty) {\n                    y = this.selection.getCaretBottom(this.selection.end, false);\n                    page = this.selection.getPage(this.selection.end.paragraph);\n                }\n                this.touchEnd.style.left = page.boundingRectangle.x + (Math.round(this.selection.end.location.x) * this.zoomFactor - 14) + 'px';\n                this.touchEnd.style.top = pageTop + (y * this.zoomFactor) + 'px';\n            }\n            else {\n                this.selection.updateCaretPosition();\n            }\n        }\n    };\n    DocumentHelper.prototype.autoScrollOnSelection = function (cursorPoint) {\n        var _this = this;\n        //Auto scroll when mouse moved hold on the edge of the viewer container.\n        if (this.scrollMoveTimer && (cursorPoint.y <= 0 || cursorPoint.y > 50 || cursorPoint.y < (this.viewerContainer.offsetHeight - 50))) {\n            clearInterval(this.scrollMoveTimer);\n            this.scrollMoveTimer = 0;\n        }\n        else if (cursorPoint.y < 60) {\n            clearInterval(this.scrollMoveTimer);\n            //Scroll up\n            this.scrollMoveTimer = setInterval(function () {\n                _this.viewerContainer.scrollTop -= 20;\n                setTimeout(function () {\n                    var touchPoint = _this.owner.viewer.findFocusedPage(cursorPoint, !_this.owner.enableHeaderAndFooter);\n                    var widget = _this.getLineWidget(touchPoint);\n                    _this.selection.updateTextPosition(widget, touchPoint);\n                }, 200);\n            }, 200);\n        }\n        else if (cursorPoint.y > (this.viewerContainer.offsetHeight - 70)) {\n            clearInterval(this.scrollMoveTimer);\n            //Scroll down\n            this.scrollMoveTimer = setInterval(function () {\n                _this.viewerContainer.scrollTop += 20;\n                setTimeout(function () {\n                    var touchPoint = _this.owner.viewer.findFocusedPage(cursorPoint, !_this.owner.enableHeaderAndFooter);\n                    var widget = _this.getLineWidget(touchPoint);\n                    _this.selection.updateTextPosition(widget, touchPoint);\n                }, 200);\n            }, 200);\n        }\n    };\n    DocumentHelper.prototype.scrollForwardOnSelection = function (cursorPoint) {\n        if (this.viewerContainer) {\n            this.viewerContainer.scrollTop = this.viewerContainer.scrollTop + 200;\n            var touchPoint = this.owner.viewer.findFocusedPage(cursorPoint, !this.owner.enableHeaderAndFooter);\n            var textPosition = this.owner.selectionModule.end;\n            if (!this.owner.enableImageResizerMode || !this.owner.imageResizerModule.isImageResizerVisible\n                || this.owner.imageResizerModule.isShapeResize) {\n                this.skipScrollToPosition = true;\n                this.owner.selectionModule.moveTextPosition(touchPoint, textPosition, true);\n            }\n        }\n    };\n    DocumentHelper.prototype.scrollBackwardOnSelection = function (cursorPoint) {\n        this.viewerContainer.scrollTop = this.viewerContainer.scrollTop - 200;\n        var touchPoint = this.owner.viewer.findFocusedPage(cursorPoint, !this.owner.enableHeaderAndFooter);\n        var textPosition = this.owner.selectionModule.end;\n        if (!this.owner.enableImageResizerMode || !this.owner.imageResizerModule.isImageResizerVisible\n            || this.owner.imageResizerModule.isShapeResize) {\n            this.skipScrollToPosition = true;\n            this.owner.selectionModule.moveTextPosition(touchPoint, textPosition, true);\n        }\n    };\n    DocumentHelper.prototype.navigateToEndNote = function (inline, startPosition, endPosition) {\n        var pageIndex = this.pages.length - 1;\n        var endnotes;\n        // Loop through pages starting from the last page and move backwards\n        while (pageIndex >= 0) {\n            endnotes = this.pages[pageIndex].endnoteWidget;\n            // Break the loop if endnotes is null or undefined\n            if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(endnotes)) {\n                break;\n            }\n            for (var i = 0; i < endnotes.bodyWidgets.length; i++) {\n                // check if the endNote reference isn't continued from the previous page\n                if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(endnotes.bodyWidgets[i].previousSplitWidget)) {\n                    var endnoteText = (endnotes.bodyWidgets[i]).footNoteReference;\n                    if (inline.text === endnoteText.text) {\n                        startPosition.setPositionParagraph(endnotes.bodyWidgets[i].childWidgets[0].childWidgets[0], 0);\n                        endPosition.setPositionParagraph(endnotes.bodyWidgets[i].childWidgets[0].childWidgets[0], 0);\n                        this.selection.selectRange(startPosition, endPosition);\n                        break;\n                    }\n                }\n            }\n            pageIndex--;\n        }\n    };\n    DocumentHelper.prototype.moveSelectedContent = function () {\n        this.isDragStarted = false;\n        var info = this.owner.editor.getSelectionInfo(true);\n        if (this.owner.selection.start.paragraph.isInsideTable) {\n            info = this.owner.selection.updateSelectionInfo(info);\n        }\n        var start = this.selection.getTextPosBasedOnLogicalIndex(info.start);\n        var end = this.selection.getTextPosBasedOnLogicalIndex(info.end);\n        if (!this.selection.isForward) {\n            start = this.selection.getTextPosBasedOnLogicalIndex(info.end);\n            end = this.selection.getTextPosBasedOnLogicalIndex(info.start);\n        }\n        var dropSelectionStartParaInfo = this.selection.getParagraphInfo(start);\n        var dropSelectionEndParaInfo = this.selection.getParagraphInfo(end);\n        var dropSelectionStartParaIndex = this.selection.getHierarchicalIndex(dropSelectionStartParaInfo.paragraph, dropSelectionStartParaInfo.offset.toString());\n        var dropSelectionEndParaIndex = this.selection.getHierarchicalIndex(dropSelectionEndParaInfo.paragraph, dropSelectionEndParaInfo.offset.toString());\n        var dropSelectionStartPos = this.selection.getTextPosBasedOnLogicalIndex(dropSelectionStartParaIndex);\n        var dropSelectionEndPos = this.selection.getTextPosBasedOnLogicalIndex(dropSelectionEndParaIndex);\n        var dragOnSelectionStartParaIndex = this.selection.getHierarchicalIndex(this.dragStartParaInfo.paragraph, this.dragStartParaInfo.offset.toString());\n        var dragOnSelectionEndParaIndex = this.selection.getHierarchicalIndex(this.dragEndParaInfo.paragraph, this.dragEndParaInfo.offset.toString());\n        var dragOnSelectionStartPos = this.selection.getTextPosBasedOnLogicalIndex(dragOnSelectionStartParaIndex);\n        var dragOnSelectionEndPos = this.selection.getTextPosBasedOnLogicalIndex(dragOnSelectionEndParaIndex);\n        var isDraggedInSamePara = false;\n        if (dropSelectionStartParaInfo.paragraph === dragOnSelectionStartPos.paragraph) {\n            isDraggedInSamePara = true;\n        }\n        if (dropSelectionStartPos.isExistBefore(dragOnSelectionStartPos)\n            || dropSelectionEndPos.isExistAfter(dragOnSelectionEndPos)) {\n            this.owner.editorModule.initComplexHistory('DragAndDropContent');\n            this.selection.start = dragOnSelectionStartPos;\n            this.selection.end = dragOnSelectionEndPos;\n            var isEnableLocalPasteTrue = this.owner.enableLocalPaste;\n            if (!isEnableLocalPasteTrue) {\n                this.owner.enableLocalPaste = true;\n            }\n            var dropExtraOffset = this.dragEndParaInfo.paragraph.getLength();\n            var hasNewLineChar = false;\n            if (dropExtraOffset < this.dragEndParaInfo.offset\n                || !this.dragStartParaInfo.paragraph.equals(this.dragEndParaInfo.paragraph)) {\n                hasNewLineChar = true;\n            }\n            this.owner.editorModule.cut();\n            if (this.dragEndParaInfo.paragraph.equals(dropSelectionStartParaInfo.paragraph)\n                && this.dragEndParaInfo.offset < dropSelectionStartParaInfo.offset\n                && !this.owner.enableTrackChanges) {\n                dropExtraOffset -= this.dragEndParaInfo.paragraph.getLength();\n                dropSelectionStartParaInfo.offset -= dropExtraOffset;\n                dropSelectionEndParaInfo.offset -= dropExtraOffset;\n                dropSelectionStartParaIndex = this.selection.getHierarchicalIndex(dropSelectionStartParaInfo.paragraph, dropSelectionStartParaInfo.offset.toString());\n                dropSelectionEndParaIndex = this.selection.getHierarchicalIndex(dropSelectionEndParaInfo.paragraph, dropSelectionEndParaInfo.offset.toString());\n            }\n            if (!hasNewLineChar || !this.dragEndParaInfo.paragraph.equals(dropSelectionEndParaInfo.paragraph) && !isDraggedInSamePara) {\n                dropSelectionStartParaIndex = this.selection.getHierarchicalIndex(dropSelectionStartParaInfo.paragraph, dropSelectionStartParaInfo.offset.toString());\n                dropSelectionEndParaIndex = this.selection.getHierarchicalIndex(dropSelectionEndParaInfo.paragraph, dropSelectionEndParaInfo.offset.toString());\n            }\n            dropSelectionStartPos = this.selection.getTextPosBasedOnLogicalIndex(dropSelectionStartParaIndex);\n            dropSelectionEndPos = this.selection.getTextPosBasedOnLogicalIndex(dropSelectionEndParaIndex);\n            this.selection.start = dropSelectionStartPos;\n            this.selection.end = dropSelectionEndPos;\n            this.owner.editorModule.copiedTextContent = '';\n            this.owner.editorModule.paste();\n            if (!isEnableLocalPasteTrue) {\n                this.owner.enableLocalPaste = false;\n            }\n            this.owner.editorHistoryModule.updateComplexHistory();\n        }\n        else {\n            this.owner.selectionModule.selectPosition(dragOnSelectionStartPos, dragOnSelectionEndPos);\n        }\n        this.dragStartParaInfo = undefined;\n        this.dragEndParaInfo = undefined;\n        this.selection.caret.classList.add(\"e-de-cursor-animation\");\n    };\n    DocumentHelper.prototype.isSelectionInListText = function (cursorPoint) {\n        var widget = this.getLineWidget(cursorPoint);\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(widget) && widget.children[0] instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ListTextElementBox) {\n            var left = this.getLeftValue(widget);\n            var width = widget.children[0].width;\n            var height = widget.children[0].height;\n            if (this.isInsideRect(left, widget.paragraph.y, width, height, cursorPoint)) {\n                this.selectionLineWidget = widget;\n                return true;\n            }\n        }\n        return false;\n    };\n    DocumentHelper.prototype.isInShapeBorder = function (floatElement, cursorPoint) {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(floatElement)) {\n            var width = floatElement.width;\n            var height = floatElement.height;\n            if (this.isInsideRect(floatElement.x - floatElement.margin.left, floatElement.y - floatElement.margin.top, width, height, cursorPoint)) {\n                // this.selectionLineWidget = this.getLineWidget(cursorPoint);\n                if (floatElement instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ImageElementBox) {\n                    return true;\n                }\n                else if (floatElement instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ShapeElementBox) {\n                    var lineWidth = floatElement.lineFormat.weight;\n                    if (!(this.isInsideRect(floatElement.x + lineWidth, floatElement.y + lineWidth + floatElement.textFrame.marginTop, width - (lineWidth * 2), height - ((lineWidth * 2) + floatElement.textFrame.marginTop + floatElement.textFrame.marginBottom), cursorPoint))) {\n                        return true;\n                    }\n                }\n            }\n        }\n        return false;\n    };\n    /**\n     * Check whether touch point is inside the rectangle or not.\n     *\n     * @private\n     * @param {number} x - Specifies left position.\n     * @param {number} y - Specifies top position.\n     * @param {number} width - Specifies width.\n     * @param {number} height - Specifies height\n     * @param {Point} touchPoint - Specifies the point to check.\n     * @returns {boolean} - Return true if points intersect.\n     */\n    DocumentHelper.prototype.isInsideRect = function (x, y, width, height, touchPoint) {\n        if ((touchPoint.x > x && touchPoint.x <= x + width) && (touchPoint.y > y && touchPoint.y <= y + height)) {\n            return true;\n        }\n        return false;\n    };\n    DocumentHelper.prototype.getLeftValue = function (widget) {\n        var left = widget.paragraph.x;\n        var paragraphFormat = widget.paragraph.paragraphFormat;\n        if (this.selection.isParagraphFirstLine(widget)) {\n            if (paragraphFormat.textAlignment === 'Right') {\n                left -= _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n                left -= _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(paragraphFormat.leftIndent);\n            }\n            else {\n                left += _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n            }\n        }\n        var element = widget.children[0];\n        if (element instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ListTextElementBox) {\n            left += element.margin.left;\n        }\n        return left;\n    };\n    /**\n     * Checks whether left mouse button is pressed or not.\n     *\n     * @param {MouseEvent} event - Specifies mouse event.\n     * @returns {boolean} - Returns true if left mouse button is clicked.\n     */\n    DocumentHelper.prototype.isLeftButtonPressed = function (event) {\n        this.isTouchInput = false;\n        var button = event.which || event.button;\n        return button === 1;\n    };\n    DocumentHelper.prototype.updateSelectionOnTouch = function (point, touchPoint) {\n        this.zoomX = undefined;\n        this.zoomY = undefined;\n        if (this.isMouseDown && !this.isSelectionChangedOnMouseMoved && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.currentPage) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner.selectionModule.start)) {\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.currentSelectedComment) && this.owner.commentReviewPane\n                && !this.owner.commentReviewPane.commentPane.isEditMode) {\n                this.currentSelectedComment = undefined;\n            }\n            if (this.touchDownOnSelectionMark === 0) {\n                this.updateTextPositionForSelection(new _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.Point(touchPoint.x, touchPoint.y), this.tapCount);\n                if (this.tapCount === 2) {\n                    this.selection.checkAndEnableHeaderFooter(point, touchPoint);\n                }\n            }\n            if (this.owner.selectionModule.isEmpty) {\n                this.selection.updateCaretPosition();\n            }\n            this.selection.checkForCursorVisibility();\n        }\n    };\n    /**\n     * Gets touch offset value.\n     *\n     * @private\n     * @param {TouchEvent} event - Specifies touch event\n     * @returns {Point}  - Returns modified touch offset\n     */\n    DocumentHelper.prototype.getTouchOffsetValue = function (event) {\n        var targetElement = this.viewerContainer;\n        var offset = targetElement.getBoundingClientRect();\n        var touchOffsetValues = event.touches[0];\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(touchOffsetValues)) {\n            touchOffsetValues = event.changedTouches[0];\n        }\n        var offsetX = touchOffsetValues.clientX - offset.left;\n        var offsetY = touchOffsetValues.clientY - offset.top;\n        return new _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.Point(offsetX, offsetY);\n    };\n    /**\n     * Fired on pinch zoom in.\n     *\n     * @private\n     * @param {TouchEvent} event - Specifies touch event\n     * @returns {void}\n     */\n    DocumentHelper.prototype.onPinchInInternal = function (event) {\n        this.preZoomFactor = this.zoomFactor;\n        var updatedZoomFactor = this.zoomFactor - 0.01;\n        if (updatedZoomFactor < 5 && updatedZoomFactor > 2) {\n            updatedZoomFactor = updatedZoomFactor - 0.01;\n        }\n        if (updatedZoomFactor < 0.1) {\n            updatedZoomFactor = 0.1;\n        }\n        this.zoomFactor = updatedZoomFactor;\n    };\n    DocumentHelper.prototype.onPinchOutInternal = function (event) {\n        this.preZoomFactor = this.zoomFactor;\n        var updatedZoomFactor = this.zoomFactor + 0.01;\n        if (updatedZoomFactor > 2) {\n            updatedZoomFactor = updatedZoomFactor + 0.01;\n        }\n        if (updatedZoomFactor > 5) {\n            updatedZoomFactor = 5;\n        }\n        this.zoomFactor = updatedZoomFactor;\n    };\n    DocumentHelper.prototype.getPageWidth = function (page) {\n        var width = page.boundingRectangle.width;\n        return width;\n    };\n    /**\n     * Removes specified page.\n     * @private\n     * @param {Page} page - Specifies page to remove\n     * @returns {void}\n     */\n    DocumentHelper.prototype.removePage = function (page) {\n        if (this.currentPage === page) {\n            this.currentPage = undefined;\n        }\n        if (page.headerWidgetIn) {\n            page.headerWidgetIn.page = undefined;\n        }\n        if (page.footerWidgetIn) {\n            page.footerWidgetIn.page = undefined;\n        }\n        if (page.headerWidget && page.headerWidget.page === page) {\n            page.headerWidget.page = undefined;\n        }\n        if (page.footerWidget && page.footerWidget.page === page) {\n            page.footerWidget.page = undefined;\n        }\n        var index = this.pages.indexOf(page);\n        if (index > -1) {\n            this.pages.splice(index, 1);\n        }\n        //this.removeRenderedPages();\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner.viewer.visiblePages)) {\n            if ((this.owner.viewer.visiblePages).indexOf(page) > -1) {\n                var pageIndex = (this.owner.viewer.visiblePages).indexOf(page);\n                (this.owner.viewer.visiblePages).splice(pageIndex, 1);\n            }\n        }\n        //(viewer as PageLayoutViewer).visiblePages.remove(page);\n        var height = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            height = height + this.pages[i].boundingRectangle.height;\n        }\n        //Updates the vertical height.\n        height -= page.boundingRectangle.height + 20;\n        //ToDo:Update horizontal width, if removed page has max width.\n        var top = 20;\n        if (index > 0) {\n            top += this.pages[index - 1].boundingRectangle.bottom;\n        }\n        if (index !== -1) {\n            for (var i = index; i < this.pages.length; i++) {\n                //Update bounding rectangle of next pages in collection.\n                page = this.pages[i];\n                page.boundingRectangle = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(page.boundingRectangle.x, top, page.boundingRectangle.width, page.boundingRectangle.height);\n                top = page.boundingRectangle.bottom + 20;\n                if (page.bodyWidgets.length > 0 && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(page.bodyWidgets[0].firstChild) && !(page.bodyWidgets[0].firstChild instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget && page.bodyWidgets[0].firstChild.header)) {\n                    page.repeatHeaderRowTableWidget = false;\n                }\n            }\n        }\n    };\n    // private removeRenderedPages(): void {\n    //     for (let i: number = 0; i < this.pages.length; i++) {\n    //         this.clearContainer(this.pages[i]);\n    //     }\n    // }\n    /**\n     * Updates viewer size on window resize.\n     *\n     * @private\n     * @returns {void}\n     */\n    DocumentHelper.prototype.updateViewerSize = function () {\n        var _this = this;\n        var element = this.owner.getDocumentEditorElement();\n        this.updateViewerSizeInternal(element);\n        this.owner.viewer.updateScrollBars();\n        if (this.owner.viewer instanceof WebLayoutViewer && (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner)) && (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(element))) {\n            if (this.resizerTimer) {\n                clearTimeout(this.resizerTimer);\n            }\n            /* eslint-disable @typescript-eslint/indent */\n            this.resizerTimer = setTimeout(function () {\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner)) {\n                    var currentVisibleWidth = void 0;\n                    if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.visibleBounds)) {\n                        currentVisibleWidth = _this.visibleBounds.width;\n                    }\n                    else {\n                        currentVisibleWidth = 0;\n                    }\n                    if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner.viewer.preVisibleWidth)) {\n                        _this.owner.viewer.preVisibleWidth = 0;\n                    }\n                    if ((!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.visibleBounds) && (currentVisibleWidth !== _this.owner.viewer.preVisibleWidth))) {\n                        _this.owner.editorModule.layoutWholeDocument();\n                        _this.owner.viewer.preVisibleWidth = currentVisibleWidth;\n                    }\n                    if (_this.resizerTimer) {\n                        clearTimeout(_this.resizerTimer);\n                    }\n                }\n            }, 50);\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.selection)) {\n            this.selection.updateCaretPosition();\n        }\n        // if(!isNullOrUndefined(this.owner) && (!isNullOrUndefined(this.owner.hRuler && !isNullOrUndefined(this.owner.vRuler))))\n        // {\n        //      updateRuler(this.owner);\n        // }\n    };\n    /**\n     * @private\n     */\n    DocumentHelper.prototype.triggerAutoResizeInterval = function () {\n        var _this = this;\n        var timer = 0;\n        var element = this.owner.element;\n        var args = { cancel: false };\n        this.owner.notify(_base_constants__WEBPACK_IMPORTED_MODULE_19__.beforeAutoResize, args);\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(args.element)) {\n            element = args.element;\n        }\n        element.style.visibility = 'hidden';\n        (0,_syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_12__.showSpinner)(element);\n        var counter = 0;\n        var internal = this.owner.documentEditorSettings.autoResizeSettings.interval;\n        if (this.isAutoResizeCanStart) {\n            timer = setInterval(function () {\n                counter++;\n                var tempRect = _this.owner.element.getBoundingClientRect();\n                if (tempRect.width !== 0 && tempRect.height !== 0) {\n                    _this.isAutoResizeCanStart = false;\n                    var args_1 = { cancel: false };\n                    _this.owner.notify(_base_constants__WEBPACK_IMPORTED_MODULE_19__.internalAutoResize, args_1);\n                    clearInterval(timer);\n                    if (!args_1.cancel) {\n                        _this.owner.resize();\n                    }\n                    (0,_syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_12__.hideSpinner)(element);\n                    element.style.visibility = 'visible';\n                }\n                else if (counter > _this.owner.documentEditorSettings.autoResizeSettings.iterationCount) {\n                    clearInterval(timer);\n                    (0,_syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_12__.hideSpinner)(element);\n                    element.style.visibility = 'visible';\n                }\n            }, internal);\n        }\n        else {\n            (0,_syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_12__.hideSpinner)(element);\n            element.style.visibility = 'visible';\n        }\n    };\n    DocumentHelper.prototype.updateViewerSizeInternal = function (element) {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(element)) {\n            var computedStyle = getComputedStyle(element);\n            var rectHeight = parseFloat(computedStyle.height.replace('px', ''));\n            var rectWidth = parseFloat(computedStyle.width.replace('px', ''));\n            if (rectWidth === 0 && rectHeight === 0) {\n                this.isAutoResizeCanStart = true;\n            }\n            else {\n                this.isAutoResizeCanStart = false;\n            }\n            var width = 0;\n            var height = 0;\n            height = rectHeight > 0 ? rectHeight : 200;\n            var restrictPaneRect = this.restrictEditingPane && this.restrictEditingPane.isShowRestrictPane ?\n                this.getComputedWidth(this.restrictEditingPane.restrictPane) : undefined;\n            var optionsRect = this.owner.optionsPaneModule && this.owner.optionsPaneModule.isOptionsPaneShow ?\n                this.getComputedWidth(this.owner.optionsPaneModule.optionsPane) : undefined;\n            var commentPane = 0;\n            if (this.owner.commentReviewPane && this.owner.commentReviewPane.parentPaneElement) {\n                commentPane = this.getComputedWidth(this.owner.commentReviewPane.parentPaneElement);\n            }\n            var xmlPaneRect = this.owner.xmlPaneModule && this.owner.xmlPaneModule.isXmlPaneShow ?\n                this.getComputedWidth(this.owner.xmlPaneModule.element) : undefined;\n            if (restrictPaneRect || optionsRect || commentPane || xmlPaneRect) {\n                var paneWidth = restrictPaneRect ? restrictPaneRect : 0;\n                paneWidth += optionsRect ? optionsRect : 0;\n                paneWidth += commentPane ? commentPane : 0;\n                paneWidth += xmlPaneRect ? xmlPaneRect : 0;\n                width = (rectWidth - paneWidth) > 0 ? (rectWidth - paneWidth) : 200;\n            }\n            else {\n                width = rectWidth > 0 ? rectWidth : 200;\n            }\n            this.viewerContainer.style.height = height.toString() + 'px';\n            this.viewerContainer.style.width = Math.ceil(width) + 'px';\n            this.visibleBoundsIn = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(0, 0, width, height);\n            this.containerCanvas.width = width;\n            this.containerCanvas.height = height;\n            this.containerCanvas.style.width = width + 'px';\n            this.containerCanvas.style.height = height + 'px';\n            this.selectionCanvas.width = width;\n            this.selectionCanvas.height = height;\n            this.selectionCanvas.style.width = width + 'px';\n            this.selectionCanvas.style.height = height + 'px';\n            this.measureScrollbarWidth(element);\n        }\n    };\n    DocumentHelper.prototype.getComputedWidth = function (element) {\n        var style = getComputedStyle(element);\n        if (style.display === 'block') {\n            return parseFloat(style.width.replace('px', ''));\n        }\n        return 0;\n    };\n    /**\n     * Inserts page in specified index.\n     *\n     * @private\n     * @param {number} index - Specifes index to insert page\n     * @param {Page} page - Page to insert.\n     * @returns {void}\n     */\n    DocumentHelper.prototype.insertPage = function (index, page) {\n        if (this.pages.indexOf(page) > -1) {\n            this.pages.splice(this.pages.indexOf(page), 1);\n        }\n        this.pages.splice(index, 0, page);\n        var top = 20;\n        if (index > 0) {\n            top += this.pages[index - 1].boundingRectangle.bottom;\n        }\n        for (var i = index; i < this.pages.length; i++) {\n            //Update bounding rectangle of next pages in collection.\n            page = this.pages[i];\n            page.boundingRectangle = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(page.boundingRectangle.x, top, page.boundingRectangle.width, page.boundingRectangle.height);\n            top = page.boundingRectangle.bottom + 20;\n        }\n    };\n    DocumentHelper.prototype.updateTextPositionForSelection = function (cursorPoint, tapCount) {\n        var widget = this.getLineWidget(cursorPoint);\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(widget)) {\n            this.selection.updateTextPosition(widget, cursorPoint);\n        }\n        if (tapCount > 1) {\n            this.isMouseDown = false;\n            this.useTouchSelectionMark = false;\n            if (this.pages.length === 0) {\n                return;\n            }\n            //Double tap/triple tap selection\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.currentPage) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner.selectionModule.start)) {\n                if (tapCount % 2 === 0) {\n                    this.owner.selectionModule.selectCurrentWord();\n                }\n                else if (!this.isDragStarted) {\n                    this.owner.selectionModule.selectParagraph();\n                }\n            }\n        }\n    };\n    DocumentHelper.prototype.scrollToPosition = function (startPosition, endPosition, skipCursorUpdate, isBookmark) {\n        if (this.skipScrollToPosition || this.isWebPrinting || (this.owner.editorModule && this.owner.editorModule.isRemoteAction)) {\n            this.skipScrollToPosition = false;\n            return;\n        }\n        if (this.owner.enableImageResizerMode && this.owner.imageResizerModule.isImageResizing\n            || this.isMouseDownInFooterRegion || this.isRowOrCellResizing) {\n            return;\n        }\n        var lineWidget = this.selection.getLineWidgetInternal(endPosition.currentWidget, endPosition.offset, true);\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(lineWidget)) {\n            return;\n        }\n        var top = this.selection.getTop(lineWidget);\n        if (this.isMouseDown) {\n            var prevLineWidget = this.selection.getLineWidgetInternal(endPosition.currentWidget, endPosition.offset, false);\n            var prevTop = this.selection.getTop(prevLineWidget);\n            if (prevLineWidget !== lineWidget && endPosition.location.y >= prevTop) {\n                lineWidget = prevLineWidget;\n            }\n        }\n        var height = lineWidget.height;\n        //Gets current page.\n        var endPage = this.selection.getPage(lineWidget.paragraph);\n        this.currentPage = endPage;\n        var x = 0;\n        var y = 0;\n        var horizontalWidth = 0;\n        var isPageLayout = this.owner.viewer instanceof PageLayoutViewer;\n        var pageLayout = this.owner.viewer;\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(endPage)) {\n            return;\n        }\n        var pageWidth = endPage.boundingRectangle.width;\n        x = (this.visibleBounds.width - pageWidth * this.zoomFactor) / 2;\n        if (x < 30) {\n            x = 30;\n        }\n        y = endPage.boundingRectangle.y * this.zoomFactor + (this.pages.indexOf(endPage) + 1) * this.owner.viewer.pageGap * (1 - this.zoomFactor);\n        var scrollTop = this.viewerContainer.scrollTop;\n        var scrollLeft = this.viewerContainer.scrollLeft;\n        var pageHeight = this.visibleBounds.height;\n        var caretInfo = this.selection.updateCaretSize(this.owner.selectionModule.end, true);\n        var topMargin = caretInfo.topMargin;\n        var caretHeight = caretInfo.height;\n        x += (endPosition.location.x) * this.zoomFactor;\n        y += (endPosition.location.y + topMargin) * this.zoomFactor;\n        if (!isBookmark) {\n            //vertical scroll bar update\n            if ((scrollTop + 20) > y) {\n                this.viewerContainer.scrollTop = (y - 10);\n            }\n            else if (scrollTop + pageHeight < y + caretHeight) {\n                this.viewerContainer.scrollTop = y + caretHeight - pageHeight + 10;\n            }\n        }\n        else {\n            // As per MS Word behaviour, update vertical scroll bar using static value while navigate bookmark\n            this.viewerContainer.scrollTop = y - 96;\n        }\n        if (!skipCursorUpdate) {\n            this.selection.updateCaretToPage(startPosition, endPage);\n        }\n        var scrollBarWidth = this.viewerContainer.offsetWidth - this.viewerContainer.clientWidth;\n        if (scrollLeft > x) {\n            this.viewerContainer.scrollLeft = x - (this.pageContainer.offsetWidth / 100) * 20;\n        }\n        else if (scrollLeft + this.visibleBounds.width < x + scrollBarWidth) {\n            this.viewerContainer.scrollLeft = scrollLeft + (this.pageContainer.offsetWidth / 100) * 15 + scrollBarWidth;\n            while (x < this.owner.viewer.containerWidth && this.viewerContainer.scrollLeft + this.visibleBounds.width < x + scrollBarWidth) {\n                this.viewerContainer.scrollLeft = this.viewerContainer.scrollLeft + (this.pageContainer.offsetWidth / 100) * 15 + scrollBarWidth;\n                if (this.viewerContainer.scrollLeft === 0) {\n                    break;\n                }\n            }\n        }\n    };\n    DocumentHelper.prototype.getLineWidget = function (cursorPoint) {\n        return this.getLineWidgetInternal(cursorPoint, false);\n    };\n    DocumentHelper.prototype.getLineWidgetInternal = function (cursorPoint, isMouseDragged) {\n        var widget = undefined;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.currentPage)) {\n            var childWidgets = void 0;\n            if (this.owner.enableHeaderAndFooter) {\n                var page = this.currentPage;\n                var pageBottom = page.boundingRectangle.height;\n                var headerHeight = Math.max((page.headerWidget.y + page.headerWidget.height), _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin)) * this.zoomFactor;\n                var footerDistance = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.footerDistance);\n                var footerHeight = (page.boundingRectangle.height -\n                    Math.max(page.footerWidget.height + footerDistance, footerDistance * 2));\n                if (isMouseDragged) {\n                    if (this.isBlockInHeader(this.selection.start.paragraph)) {\n                        childWidgets = this.currentPage.headerWidget;\n                    }\n                    else {\n                        childWidgets = this.currentPage.footerWidget;\n                    }\n                }\n                else {\n                    if (cursorPoint.y <= pageBottom && cursorPoint.y >= footerHeight) {\n                        childWidgets = this.currentPage.footerWidget;\n                    }\n                    else if ((cursorPoint.y) >= 0 && (cursorPoint.y) <= headerHeight) {\n                        childWidgets = this.currentPage.headerWidget;\n                    }\n                }\n                if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(childWidgets)) {\n                    return undefined;\n                }\n                var shapeElementInfo = this.checkFloatingItems(childWidgets, cursorPoint, isMouseDragged);\n                if (shapeElementInfo.isShapeSelected) {\n                    if (shapeElementInfo.isInShapeBorder) {\n                        return shapeElementInfo.element.line;\n                    }\n                    return this.selection.getLineWidgetBodyWidget(shapeElementInfo.element.textFrame, cursorPoint);\n                }\n                else {\n                    return this.selection.getLineWidgetBodyWidget(childWidgets, cursorPoint);\n                }\n            }\n            else {\n                var shapeInfo = undefined;\n                var behindShapeInfo = undefined;\n                for (var i = 0; i < this.currentPage.bodyWidgets.length; i++) {\n                    var bodyWidget = this.currentPage.bodyWidgets[i];\n                    shapeInfo = this.checkFloatingItems(bodyWidget, cursorPoint, isMouseDragged, false);\n                    behindShapeInfo = this.checkFloatingItems(bodyWidget, cursorPoint, isMouseDragged, true);\n                    if (shapeInfo.isShapeSelected || behindShapeInfo.isShapeSelected) {\n                        break;\n                    }\n                }\n                if (shapeInfo.isShapeSelected && !this.isEmptyShape(shapeInfo)) {\n                    if (shapeInfo.isInShapeBorder) {\n                        return shapeInfo.element.line;\n                    }\n                    if (shapeInfo.element instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ShapeElementBox) {\n                        widget = this.selection.getLineWidgetBodyWidget(shapeInfo.element.textFrame, cursorPoint);\n                    }\n                }\n                else if (isMouseDragged && this.isFootnoteWidget) {\n                    if (this.selection.start.paragraph.bodyWidget.footNoteReference !== undefined && this.selection.start.paragraph.bodyWidget.containerWidget instanceof _page__WEBPACK_IMPORTED_MODULE_7__.FootNoteWidget && this.selection.start.paragraph.bodyWidget.containerWidget.footNoteType === 'Footnote') {\n                        return this.selection.getLineWidgetBodyWidget(this.currentPage.footnoteWidget, cursorPoint);\n                    }\n                    else if (this.selection.start.paragraph.bodyWidget.footNoteReference !== undefined &&\n                        this.selection.start.paragraph.bodyWidget.containerWidget instanceof _page__WEBPACK_IMPORTED_MODULE_7__.FootNoteWidget\n                        && this.selection.start.paragraph.bodyWidget.containerWidget.footNoteType === 'Endnote') {\n                        return this.selection.getLineWidgetBodyWidget(this.currentPage.endnoteWidget, cursorPoint);\n                    }\n                }\n                else {\n                    if (!isMouseDragged && this.currentPage.footnoteWidget && this.isInFootnoteWidget(this.currentPage.footnoteWidget, cursorPoint)) {\n                        widget = this.selection.getLineWidgetBodyWidget(this.currentPage.footnoteWidget, cursorPoint);\n                        if (widget) {\n                            this.isFootnoteWidget = true;\n                        }\n                    }\n                    else if (!isMouseDragged && this.currentPage.endnoteWidget &&\n                        this.isInFootnoteWidget(this.currentPage.endnoteWidget, cursorPoint)) {\n                        widget = this.selection.getLineWidgetBodyWidget(this.currentPage.endnoteWidget, cursorPoint);\n                        if (widget) {\n                            this.isFootnoteWidget = true;\n                        }\n                    }\n                    else {\n                        for (var i_1 = 0; i_1 < this.currentPage.bodyWidgets.length; i_1++) {\n                            var bodyWidget_1 = this.currentPage.bodyWidgets[i_1];\n                            if (i_1 < this.currentPage.bodyWidgets.length - 1) {\n                                if (cursorPoint.x <= bodyWidget_1.x + bodyWidget_1.width) {\n                                    //let isGetFirstChild: boolean = i === this.currentPage.bodyWidgets.length - 1;\n                                    widget = this.selection.getLineWidgetBodyWidget(bodyWidget_1, cursorPoint, true);\n                                    if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(widget) && widget.paragraph.y <= cursorPoint.y\n                                        && (widget.paragraph.y + widget.paragraph.height) >= cursorPoint.y) {\n                                        this.isFootnoteWidget = false;\n                                        break;\n                                    }\n                                }\n                            }\n                            if (cursorPoint.x > bodyWidget_1.x + bodyWidget_1.width && this.layout.getNextWidgetHeight(bodyWidget_1) >= cursorPoint.y && bodyWidget_1.y <= cursorPoint.y) {\n                                if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(bodyWidget_1.nextRenderedWidget) || !(this.layout.getNextWidgetHeight(bodyWidget_1.nextRenderedWidget) >= cursorPoint.y && bodyWidget_1.nextRenderedWidget.y <= cursorPoint.y)) {\n                                    widget = this.selection.getLineWidgetBodyWidget(bodyWidget_1, cursorPoint, true);\n                                    if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(widget) && widget.paragraph.y <= cursorPoint.y\n                                        && (widget.paragraph.y + widget.paragraph.height) >= cursorPoint.y) {\n                                        this.isFootnoteWidget = false;\n                                        break;\n                                    }\n                                }\n                            }\n                            if (i_1 == this.currentPage.bodyWidgets.length - 1) {\n                                widget = this.selection.getLineWidgetBodyWidget(bodyWidget_1, cursorPoint, true);\n                                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(widget) && widget.paragraph.y <= cursorPoint.y\n                                    && (widget.paragraph.y + widget.paragraph.height) >= cursorPoint.y) {\n                                    this.isFootnoteWidget = false;\n                                    break;\n                                }\n                            }\n                            if (cursorPoint.x < bodyWidget_1.x && i_1 < this.currentPage.bodyWidgets.length - 1) {\n                                widget = this.selection.getLineWidgetBodyWidget(bodyWidget_1, cursorPoint, true);\n                                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(widget) && widget.paragraph.y <= cursorPoint.y\n                                    && (widget.paragraph.y + widget.paragraph.height) >= cursorPoint.y) {\n                                    this.isFootnoteWidget = false;\n                                    break;\n                                }\n                                else if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(widget) && i_1 === this.currentPage.bodyWidgets.length - 1) {\n                                    this.isFootnoteWidget = false;\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                    var inlineShapeInfo = this.checkInlineShapeItems(widget, cursorPoint, isMouseDragged);\n                    if (inlineShapeInfo.isShapeSelected) {\n                        if (inlineShapeInfo.isInShapeBorder) {\n                            return inlineShapeInfo.element.line;\n                        }\n                        if (inlineShapeInfo.element instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ShapeElementBox) {\n                            widget = this.selection.getLineWidgetBodyWidget(inlineShapeInfo.element.textFrame, cursorPoint);\n                        }\n                    }\n                    else if (!this.checkPointIsInLine(widget, cursorPoint) && behindShapeInfo.isShapeSelected) {\n                        if (behindShapeInfo.isInShapeBorder) {\n                            return behindShapeInfo.element.line;\n                        }\n                        if (behindShapeInfo.element instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ShapeElementBox) {\n                            widget = this.selection.getLineWidgetBodyWidget(behindShapeInfo.element.textFrame, cursorPoint);\n                        }\n                    }\n                }\n            }\n        }\n        return widget;\n    };\n    DocumentHelper.prototype.checkInlineShapeItems = function (widget, cursorPoint, isMouseDragged) {\n        var isInShape = false;\n        var isInShapeBorder = false;\n        var floatingElement;\n        var selectionInShape = this.selection.isInShape;\n        var isMouseDraggedInShape = isMouseDragged && selectionInShape;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(widget) && widget.children.length > 0) {\n            if (isMouseDraggedInShape) {\n                var textFrame = this.owner.selectionModule.getCurrentTextFrame();\n                if (textFrame) {\n                    floatingElement = textFrame.containerShape;\n                    isInShape = true;\n                }\n            }\n            else {\n                for (var i = 0; i < widget.children.length; i++) {\n                    if (!(widget.children[i] instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ShapeElementBox && widget.children[i].textWrappingStyle === 'Inline')) {\n                        continue;\n                    }\n                    floatingElement = widget.children[i];\n                    if (cursorPoint.x < floatingElement.x + floatingElement.margin.left + floatingElement.width &&\n                        cursorPoint.x > floatingElement.x && cursorPoint.y < floatingElement.y + floatingElement.margin.top +\n                        floatingElement.height && cursorPoint.y > floatingElement.y) {\n                        isInShape = true;\n                        if (this.isInShapeBorder(floatingElement, cursorPoint)) {\n                            isInShapeBorder = true;\n                        }\n                        break;\n                    }\n                }\n                if (isMouseDragged && !selectionInShape) {\n                    isInShape = false;\n                }\n            }\n        }\n        return {\n            'element': floatingElement,\n            'caretPosition': cursorPoint,\n            'isInShapeBorder': isInShapeBorder,\n            'isShapeSelected': isInShape\n        };\n    };\n    /**\n     * @private\n     */\n    DocumentHelper.prototype.checkPointIsInLine = function (widget, cursorPoint) {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(widget) && widget.children.length > 0) {\n            var element = void 0;\n            var left = widget.paragraph.x;\n            var top_1 = this.selection.getTop(widget);\n            for (var i = widget.children.indexOf(widget.children[0]); i < widget.children.length; i++) {\n                element = widget.children[i];\n                if (element instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ShapeBase && element.textWrappingStyle !== 'Inline') {\n                    continue;\n                }\n                if (cursorPoint.x < left + element.margin.left + element.width + element.padding.left\n                    && cursorPoint.x > left && cursorPoint.y < top_1 + widget.height && cursorPoint.y > top_1) {\n                    return true;\n                }\n                left += element.margin.left + element.width + element.padding.left;\n            }\n        }\n        else if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(widget) && widget.children.length === 0) {\n            var left = widget.paragraph.x;\n            var top_2 = this.selection.getTop(widget);\n            if (cursorPoint.x < left + widget.width && cursorPoint.x > left && cursorPoint.y < top_2 + widget.height && cursorPoint.y > top_2) {\n                return true;\n            }\n        }\n        return false;\n    };\n    DocumentHelper.prototype.isInFootnoteWidget = function (footnoteWidget, point) {\n        for (var i = 0; i < footnoteWidget.bodyWidgets.length; i++) {\n            for (var j = 0; j < footnoteWidget.bodyWidgets[i].childWidgets.length; j++) {\n                var childWidget = footnoteWidget.bodyWidgets[i].childWidgets[j];\n                if (childWidget instanceof _page__WEBPACK_IMPORTED_MODULE_7__.Widget && childWidget.y <= point.y\n                    && (childWidget.y + childWidget.height) >= point.y) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    DocumentHelper.prototype.checkFloatingItems = function (blockContainer, cursorPoint, isMouseDragged, isBehind) {\n        var isInShape = false;\n        var isInShapeBorder = false;\n        var floatElement;\n        var selectionInShape = this.selection.isInShape;\n        var isMouseDraggedInShape = isMouseDragged && selectionInShape;\n        if (blockContainer.floatingElements.length > 0) {\n            var page = this.currentPage;\n            /* eslint-disable */\n            blockContainer.floatingElements.sort(function (a, b) {\n                if (a instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget || b instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget) {\n                    return 0;\n                }\n                else {\n                    return a.zOrderPosition - b.zOrderPosition;\n                }\n            });\n            if (isMouseDraggedInShape) {\n                var textFrame = this.owner.selectionModule.getCurrentTextFrame();\n                if (textFrame) {\n                    floatElement = textFrame.containerShape;\n                    isInShape = true;\n                }\n            }\n            else {\n                for (var i = blockContainer.floatingElements.length - 1; i >= 0; i--) {\n                    if (blockContainer.floatingElements[i] instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget\n                        || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(isBehind) && isBehind ? blockContainer.floatingElements[i].textWrappingStyle !== 'Behind' : blockContainer.floatingElements[i].textWrappingStyle === 'Behind')) {\n                        continue;\n                    }\n                    floatElement = blockContainer.floatingElements[i];\n                    if (cursorPoint.x < floatElement.x + floatElement.margin.left + floatElement.width &&\n                        cursorPoint.x > floatElement.x && cursorPoint.y < floatElement.y + floatElement.margin.top +\n                        floatElement.height && cursorPoint.y > floatElement.y) {\n                        isInShape = true;\n                        if (this.isInShapeBorder(floatElement, cursorPoint)) {\n                            isInShapeBorder = true;\n                        }\n                        break;\n                    }\n                }\n                if (isMouseDragged && !selectionInShape) {\n                    isInShape = false;\n                }\n            }\n        }\n        return {\n            'element': floatElement,\n            'caretPosition': cursorPoint,\n            'isShapeSelected': isInShape,\n            'isInShapeBorder': isInShapeBorder\n        };\n    };\n    DocumentHelper.prototype.isBlockInHeader = function (block) {\n        while (!(block.containerWidget instanceof _page__WEBPACK_IMPORTED_MODULE_7__.HeaderFooterWidget)) {\n            if (!block.containerWidget) {\n                return false;\n            }\n            block = block.containerWidget;\n            if (block instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TextFrame) {\n                block = block.containerShape.paragraph;\n            }\n        }\n        return block.containerWidget.headerFooterType.indexOf('Header') !== -1;\n    };\n    DocumentHelper.prototype.clearSelectionHighlight = function () {\n        var canClear = true;\n        canClear = (!this.isControlPressed || !this.isMouseDown);\n        // if (this.owner.selection.selectionRanges.length > 0 && canClear) {\n        if (this.owner.selectionModule.clearSelectionHighlightInSelectedWidgets()) {\n            this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n        }\n        // } else if (!isNullOrUndefined(this.owner.selection.currentSelectionRange) && this.isMouseDown) {\n        //     this.owner.selection.currentSelectionRange.clearSelectionHighlight();\n        // }\n        //this.renderVisiblePages();\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    DocumentHelper.prototype.removeEmptyPages = function (skipEndLayout) {\n        var scrollToLastPage = false;\n        var isLayoutEndnote = false;\n        var pageIndex = this.selection.startPage - 1;\n        for (var j = 0; j < this.pages.length; j++) {\n            var page = this.pages[j];\n            for (var i = 0; i < page.bodyWidgets.length; i++) {\n                if (page.bodyWidgets.length === 0 || page.bodyWidgets[i].childWidgets.length === 0) {\n                    if (page.bodyWidgets.length >= 1) {\n                        var startindex = page.bodyWidgets.indexOf(page.bodyWidgets[i]);\n                        page.bodyWidgets.splice(startindex, 1);\n                        i--;\n                    }\n                }\n            }\n            if (page.bodyWidgets.length <= 0) {\n                if (j === this.pages.length - 1 && this.owner.viewer instanceof PageLayoutViewer && this.owner.viewer.visiblePages.indexOf(this.pages[j]) !== -1) {\n                    scrollToLastPage = true;\n                }\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(page.endnoteWidget) && page.endnoteWidget.bodyWidgets.length > 0) {\n                    var endnote = page.endnoteWidget;\n                    var previousPage = page.previousPage;\n                    if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(previousPage)) {\n                        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(previousPage.endnoteWidget)) {\n                            previousPage.endnoteWidget = new _page__WEBPACK_IMPORTED_MODULE_7__.FootNoteWidget();\n                            previousPage.endnoteWidget.footNoteType = 'Endnote';\n                            previousPage.endnoteWidget.page = previousPage;\n                        }\n                        for (var k = 0; k < endnote.bodyWidgets.length; k++) {\n                            var bodyWidget = endnote.bodyWidgets[k];\n                            var isCombined = false;\n                            if (previousPage.endnoteWidget.bodyWidgets.length > 0) {\n                                var lastBodyWidget = previousPage.endnoteWidget.bodyWidgets[previousPage.endnoteWidget.bodyWidgets.length - 1];\n                                if (bodyWidget.index === lastBodyWidget.index && bodyWidget.footNoteReference === lastBodyWidget.footNoteReference) {\n                                    lastBodyWidget.combineWidget(this.owner.viewer);\n                                    endnote.bodyWidgets.splice(k, 1);\n                                    isCombined = true;\n                                }\n                            }\n                            if (!isCombined) {\n                                endnote.bodyWidgets.splice(k, 1);\n                                bodyWidget.index = previousPage.endnoteWidget.bodyWidgets.length;\n                                previousPage.endnoteWidget.bodyWidgets.push(bodyWidget);\n                                bodyWidget.containerWidget = previousPage.endnoteWidget;\n                                bodyWidget.page = previousPage;\n                            }\n                            k--;\n                        }\n                        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(page.endnoteWidget) && page.endnoteWidget.bodyWidgets.length === 0) {\n                            page.endnoteWidget = undefined;\n                        }\n                        isLayoutEndnote = true;\n                        scrollToLastPage = false;\n                    }\n                }\n                if (this.pages.indexOf(page) !== -1 && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.pages[j])) {\n                    this.removePage(this.pages[j]);\n                }\n                j--;\n            }\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.pages[pageIndex])) {\n            var page = this.pages[pageIndex];\n            if (page.headerWidget) {\n                page.headerWidget.page = page;\n            }\n            if (page.footerWidget) {\n                page.footerWidget.page = page;\n            }\n        }\n        if (isLayoutEndnote && !skipEndLayout) {\n            this.layout.reLayoutEndnote();\n        }\n        if (scrollToLastPage) {\n            this.scrollToBottom();\n        }\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    DocumentHelper.prototype.scrollToBottom = function () {\n        if (this.selection.start.paragraph && this.selection.start.paragraph.bodyWidget) {\n            var page = this.selection.start.paragraph.bodyWidget.page;\n            var containerHeight = this.visibleBounds.height;\n            this.viewerContainer.scrollTop = page.boundingRectangle.bottom - containerHeight;\n        }\n    };\n    DocumentHelper.prototype.getFieldResult = function (fieldBegin, page) {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(page) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.selection) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(fieldBegin)) {\n            var fieldCode = this.selection.getFieldCode(fieldBegin);\n            var fieldCodes = fieldCode.split('\\*');\n            var fieldCategory = fieldCodes[0].replace(/[^\\w\\s]/gi, '').trim().toLowerCase();\n            var fieldPattern = '';\n            if (fieldCodes.length > 1) {\n                if (fieldCodes[1] !== ' MERGEFORMAT') {\n                    fieldPattern = fieldCodes[1].replace(/[^\\w\\s]/gi, '').trim();\n                }\n            }\n            if (fieldPattern == '') {\n                fieldPattern = page.bodyWidgets[0].sectionFormat.pageNumberStyle;\n            }\n            if (fieldCategory.indexOf(' ') !== -1) {\n                fieldCategory = fieldCategory.split(' ')[0];\n            }\n            switch (fieldCategory) {\n                case 'page':\n                    if (page.bodyWidgets[0].sectionFormat.restartPageNumbering && page.sectionIndex !== 0) {\n                        var currentSectionIndex_1 = page.sectionIndex;\n                        var previousPage = page.previousPage;\n                        this.isRestartNumbering = true;\n                        if (currentSectionIndex_1 !== previousPage.sectionIndex && previousPage.bodyWidgets[previousPage.bodyWidgets.length - 1].sectionIndex !== currentSectionIndex_1) {\n                            page.currentPageNum = (page.bodyWidgets[0].sectionFormat.pageStartingNumber);\n                            return this.getFieldText(fieldPattern, page.currentPageNum);\n                        }\n                        if (previousPage.currentPageNum === 1 && currentSectionIndex_1 !== previousPage.sectionIndex) {\n                            previousPage.currentPageNum = (page.bodyWidgets[0].sectionFormat.pageStartingNumber);\n                        }\n                        page.currentPageNum = previousPage.currentPageNum + 1;\n                        return this.getFieldText(fieldPattern, page.currentPageNum);\n                    }\n                    else if (page.bodyWidgets[0].sectionFormat.restartPageNumbering && page.sectionIndex === 0) {\n                        page.currentPageNum = page.bodyWidgets[0].sectionFormat.pageStartingNumber + page.index;\n                        return this.getFieldText(fieldPattern, page.currentPageNum);\n                    }\n                    if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(page.previousPage) && ((page.previousPage.bodyWidgets[0].sectionFormat.restartPageNumbering && page.previousPage.currentPageNum >= 1)\n                        || (this.isRestartNumbering && page.previousPage.currentPageNum !== 1))) {\n                        if (page.previousPage.bodyWidgets[0].sectionFormat.restartPageNumbering) {\n                            this.isRestartNumbering = true;\n                        }\n                        page.currentPageNum = page.previousPage.currentPageNum + 1;\n                    }\n                    else {\n                        page.currentPageNum = page.index + 1;\n                    }\n                    return this.getFieldText(fieldPattern, page.currentPageNum);\n                case 'numpages':\n                    return this.getFieldText(fieldPattern, page.documentHelper.pages.length);\n                case 'sectionpages':\n                    var currentSectionIndex = page.sectionIndex;\n                    var currentPageCount = 0;\n                    for (var i = 0; i < page.documentHelper.pages.length; i++) {\n                        if (page.documentHelper.pages[i].sectionIndex === currentSectionIndex) {\n                            currentPageCount++;\n                        }\n                        else if (currentPageCount !== 0) {\n                            break;\n                        }\n                    }\n                    return this.getFieldText(fieldPattern, currentPageCount);\n                default:\n                    break;\n            }\n        }\n        return '';\n    };\n    DocumentHelper.prototype.getFieldText = function (pattern, value) {\n        switch (pattern) {\n            case 'ALPHABETIC':\n                return this.layout.getAsLetter(value).toUpperCase();\n            case 'alphabetic':\n                return this.layout.getAsLetter(value).toLowerCase();\n            case 'roman':\n                return this.layout.getAsRoman(value).toLowerCase();\n            case 'ROMAN':\n                return this.layout.getAsRoman(value).toUpperCase();\n            case 'RomanUpper':\n                return this.layout.getAsRoman(value).toUpperCase();\n            case 'RomanLower':\n                return this.layout.getAsRoman(value).toLowerCase();\n            case 'LetterUpper':\n                return this.layout.getAsLetter(value).toUpperCase();\n            case 'LetterLower':\n                return this.layout.getAsLetter(value).toLowerCase();\n            default:\n                return value.toString();\n        }\n    };\n    DocumentHelper.prototype.isEmptyShape = function (shape) {\n        var isEmpty = true;\n        if (shape.element instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ImageElementBox) {\n            return isEmpty;\n        }\n        var textFrame = shape.element.textFrame;\n        if (textFrame.childWidgets.length === 0) {\n            return isEmpty;\n        }\n        else {\n            return false;\n        }\n    };\n    /**\n     * Destroys the internal objects maintained for control.\n     *\n     * @returns {void}\n     */\n    DocumentHelper.prototype.destroy = function () {\n        var _this = this;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner)) {\n            this.unWireEvent();\n        }\n        if (this.vRuler) {\n            this.vRuler.childNodes.forEach(function (element) {\n                _this.vRuler.removeChild(element);\n                element = null;\n            });\n            this.vRuler.innerHTML = '';\n            this.vRuler.remove();\n            this.vRuler = null;\n        }\n        if (this.hRuler) {\n            this.hRuler.childNodes.forEach(function (element) {\n                _this.hRuler.removeChild(element);\n                element = null;\n            });\n            this.hRuler.innerHTML = '';\n            this.hRuler.remove();\n            this.hRuler = null;\n        }\n        if (this.markIndicator) {\n            this.markIndicator.remove();\n        }\n        if (this.styles) {\n            this.styles.destroy();\n            this.styles = undefined;\n        }\n        if (this.stylesMap) {\n            this.stylesMap.destroy();\n            this.stylesMap = undefined;\n        }\n        if (this.characterFormat) {\n            this.characterFormat.destroy();\n            this.characterFormat = undefined;\n        }\n        if (this.themeFontLanguage) {\n            this.themeFontLanguage.destroy();\n            this.themeFontLanguage = undefined;\n        }\n        if (this.paragraphFormat) {\n            this.paragraphFormat.destroy();\n            this.paragraphFormat = undefined;\n        }\n        if (this.pages && this.pages.length > 0) {\n            for (var i = 0; i < this.pages.length; i++) {\n                var page = this.pages[i];\n                page.componentDestroy();\n            }\n            this.pages = [];\n        }\n        this.pages = undefined;\n        if (this.lists && this.lists.length > 0) {\n            for (var i = 0; i < this.lists.length; i++) {\n                var list = this.lists[i];\n                list.destroy();\n            }\n            this.lists = [];\n        }\n        this.lists = undefined;\n        if (this.formFillPopup) {\n            this.formFillPopup.destroy();\n            this.formFillPopup = undefined;\n        }\n        if (this.contentDropDown) {\n            this.contentDropDown.destroy();\n            this.contentDropDown = undefined;\n        }\n        this.L10n = undefined;\n        this.currentPage = undefined;\n        this.selectionStartPageIn = undefined;\n        this.selectionEndPageIn = undefined;\n        this.fieldStacks = [];\n        this.fieldStacks = undefined;\n        this.splittedCellWidgets = [];\n        this.splittedCellWidgets = undefined;\n        this.fields = [];\n        this.fields = undefined;\n        this.abstractLists = [];\n        this.abstractLists = undefined;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner)) {\n            this.renderedLists.destroy();\n        }\n        this.renderedLists = undefined;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner)) {\n            this.authors.destroy();\n        }\n        this.authors = undefined;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner)) {\n            this.revisionsInternal.destroy();\n        }\n        this.revisionsInternal = undefined;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner)) {\n            this.preDefinedStyles.destroy();\n        }\n        this.preDefinedStyles = undefined;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner)) {\n            this.bookmarks.destroy();\n        }\n        this.bookmarks = undefined;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner)) {\n            this.editRanges.destroy();\n        }\n        this.editRanges = undefined;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner)) {\n            this.customXmlData.destroy();\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner)) {\n            this.images.destroy();\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner)) {\n            this.fontSubstitutionTable.destroy();\n        }\n        this.fontSubstitutionTable = undefined;\n        this.customXmlData = undefined;\n        this.images = undefined;\n        this.blockToShift = undefined;\n        this.cachedPages = [];\n        this.cachedPages = undefined;\n        if (this.comments && this.comments.length > 0) {\n            for (var i = 0; i < this.comments.length; i++) {\n                var comment = this.comments[i];\n                comment.destroy();\n            }\n            this.comments = [];\n        }\n        this.comments = undefined;\n        this.compositionEnd = undefined;\n        this.compositionStart = undefined;\n        this.compositionUpdated = undefined;\n        this.contentControlCollection = [];\n        this.contentControlCollection = undefined;\n        this.renderedLevelOverrides = [];\n        this.renderedLevelOverrides = undefined;\n        this.headersFooters = [];\n        this.headersFooters = undefined;\n        this.listParagraphs = [];\n        this.listParagraphs = undefined;\n        this.formFields = [];\n        this.formFields = undefined;\n        this.fieldCollection = [];\n        this.fieldCollection = undefined;\n        this.userCollection = [];\n        this.userCollection = undefined;\n        if (this.footnotes) {\n            this.footnotes.componentDestroy();\n            this.footnotes = undefined;\n        }\n        if (this.endnotes) {\n            this.endnotes.componentDestroy();\n            this.endnotes = undefined;\n        }\n        if (this.zoomModule) {\n            this.zoomModule.destroy();\n            this.zoomModule = undefined;\n        }\n        this.footnoteCollection = [];\n        this.footnoteCollection = undefined;\n        this.endnoteCollection = [];\n        this.endnoteCollection = undefined;\n        if (this.restrictEditingPane) {\n            this.restrictEditingPane.destroy();\n            this.restrictEditingPane = undefined;\n        }\n        if (this.layout) {\n            this.layout.destroy();\n        }\n        this.layout = undefined;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.render)) {\n            this.render.destroy();\n        }\n        this.render = undefined;\n        if (this.dialogInternal) {\n            this.dialogInternal.destroy();\n        }\n        this.dialogInternal = undefined;\n        if (this.dialogInternal2) {\n            this.dialogInternal2.destroy();\n            this.dialogInternal2 = undefined;\n        }\n        if (this.dialogInternal3) {\n            this.dialogInternal3.destroy();\n            this.dialogInternal3 = undefined;\n        }\n        if (this.dialogTarget1 && this.dialogTarget1.parentElement) {\n            this.dialogTarget1.parentElement.removeChild(this.dialogTarget1);\n        }\n        this.dialogTarget1 = undefined;\n        if (this.dialogTarget2 && this.dialogTarget2.parentElement) {\n            this.dialogTarget2.parentElement.removeChild(this.dialogTarget2);\n        }\n        this.dialogTarget2 = undefined;\n        if (this.dialogTarget3 && this.dialogTarget3.parentElement) {\n            this.dialogTarget3.parentElement.removeChild(this.dialogTarget3);\n        }\n        this.dialogTarget3 = undefined;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.touchStart)) {\n            this.touchStart.innerHTML = '';\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.touchStart.parentElement)) {\n                this.touchStart.parentElement.removeChild(this.touchStart);\n            }\n        }\n        this.touchStart = undefined;\n        if (this.textHelper) {\n            this.textHelper.destroy();\n        }\n        this.textHelper = undefined;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.touchEnd)) {\n            this.touchEnd.innerHTML = '';\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.touchEnd.parentElement)) {\n                this.touchEnd.parentElement.removeChild(this.touchEnd);\n            }\n        }\n        this.touchEnd = undefined;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.containerCanvasIn)) {\n            this.containerCanvasIn.innerHTML = '';\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.containerCanvasIn.parentElement)) {\n                this.containerCanvasIn.parentElement.removeChild(this.containerCanvasIn);\n            }\n        }\n        this.containerCanvasIn = undefined;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.selectionCanvasIn)) {\n            this.selectionCanvasIn.innerHTML = '';\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.selectionCanvasIn.parentElement)) {\n                this.selectionCanvasIn.parentElement.removeChild(this.selectionCanvasIn);\n            }\n        }\n        this.selectionCanvasIn = undefined;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.editableDiv)) {\n            this.editableDiv.innerHTML = '';\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.editableDiv.parentElement)) {\n                this.editableDiv.parentElement.removeChild(this.editableDiv);\n            }\n        }\n        this.editableDiv = undefined;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.pageContainer)) {\n            this.pageContainer.innerHTML = '';\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.pageContainer.parentElement)) {\n                this.pageContainer.parentElement.removeChild(this.pageContainer);\n            }\n        }\n        this.pageContainer = undefined;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.viewerContainer)) {\n            this.viewerContainer.innerHTML = '';\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.viewerContainer.parentElement)) {\n                this.viewerContainer.parentElement.removeChild(this.viewerContainer);\n            }\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.iframe)) {\n            this.iframe.innerHTML = '';\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.iframe.parentElement)) {\n                this.iframe.parentElement.removeChild(this.iframe);\n            }\n            this.iframe = undefined;\n        }\n        if (this.optionsPaneContainer) {\n            this.optionsPaneContainer.innerHTML = '';\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.optionsPaneContainer.parentElement)) {\n                this.optionsPaneContainer.parentElement.removeChild(this.optionsPaneContainer);\n            }\n        }\n        this.optionsPaneContainer = undefined;\n        this.visibleBoundsIn = undefined;\n        this.mouseDownOffset = undefined;\n        this.viewerContainer = undefined;\n        this.currentPage = undefined;\n        this.selectionStartPageIn = undefined;\n        this.selectionEndPageIn = undefined;\n        this.currentSelectedCommentInternal = undefined;\n        this.currentSelectedRevisionInternal = undefined;\n        this.owner = undefined;\n        this.heightInfoCollection = undefined;\n        this.isRestartNumbering = false;\n    };\n    /**\n     * Un-Wires events and methods\n     *\n     * @returns {void}\n     */\n    DocumentHelper.prototype.unWireEvent = function () {\n        this.viewerContainer.removeEventListener('scroll', this.scrollHandler);\n        this.viewerContainer.removeEventListener('mousedown', this.onMouseDownInternal);\n        this.viewerContainer.removeEventListener('mousemove', this.onMouseMoveInternal);\n        if (!_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.Browser.isDevice) {\n            this.editableDiv.removeEventListener('keypress', this.onKeyPressInternal);\n            if (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.Browser.info.name === 'chrome') {\n                this.editableDiv.removeEventListener('textInput', this.onTextInput);\n            }\n        }\n        else {\n            this.editableDiv.removeEventListener('input', this.onTextInputInternal);\n        }\n        this.editableDiv.removeEventListener('paste', this.onPaste);\n        this.viewerContainer.removeEventListener('contextmenu', this.onContextMenu);\n        this.editableDiv.removeEventListener('blur', this.onFocusOut);\n        this.editableDiv.removeEventListener('keydown', this.onKeyDownInternal);\n        this.editableDiv.removeEventListener('compositionstart', this.compositionStart);\n        this.editableDiv.removeEventListener('compositionupdate', this.compositionUpdated);\n        this.editableDiv.removeEventListener('compositionend', this.compositionEnd);\n        this.viewerContainer.removeEventListener('mouseup', this.onMouseUpInternal);\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.iframe)) {\n            this.iframe.removeEventListener('load', this.onIframeLoad);\n        }\n        this.viewerContainer.removeEventListener('dblclick', this.onDoubleTap);\n        window.removeEventListener('resize', this.onWindowResize);\n        window.removeEventListener('keyup', this.onKeyUpInternal);\n        window.removeEventListener('mouseup', this.onImageResizer);\n        window.removeEventListener('touchend', this.onImageResizer);\n        window.removeEventListener('copy', this.onCopy);\n        if (navigator !== undefined && navigator.userAgent.match('Firefox')) {\n            this.viewerContainer.removeEventListener('DOMMouseScroll', this.zoomModule.onMouseWheelInternal);\n        }\n        this.viewerContainer.removeEventListener('mousewheel', this.zoomModule.onMouseWheelInternal);\n    };\n    DocumentHelper.prototype.updateCursor = function (event) {\n        var hyperlinkField = undefined;\n        var footnoteElement = undefined;\n        var div = this.viewerContainer;\n        var point = new _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.Point(event.offsetX, event.offsetY);\n        var touchPoint = this.owner.viewer.findFocusedPage(point, true);\n        var widget = this.getLineWidget(touchPoint);\n        var widgetInfo;\n        var left;\n        var top;\n        var editor = !this.owner.isReadOnlyMode ? this.owner.editorModule : undefined;\n        var isRowResize = editor ? editor.tableResize.isInRowResizerArea(touchPoint) : false;\n        var isCellResize = editor ? editor.tableResize.isInCellResizerArea(touchPoint) : false;\n        var floatItemInfo = this.selection.checkAllFloatingElements(widget, touchPoint);\n        var resizePosition = '';\n        if (this.owner.enableImageResizerMode) {\n            var resizeObj = this.owner.imageResizerModule.getImagePoint(touchPoint);\n            this.owner.imageResizerModule.selectedResizeElement = resizeObj.selectedElement;\n            resizePosition = resizeObj.resizePosition;\n        }\n        var lineLeft = 0;\n        var formField = undefined;\n        var referenceField = undefined;\n        var isInInline = this.checkPointIsInLine(widget, touchPoint);\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(widget)) {\n            lineLeft = this.selection.getLineStartLeft(widget);\n            hyperlinkField = this.selection.getHyperLinkFieldInCurrentSelection(widget, touchPoint);\n            if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(hyperlinkField)) {\n                formField = this.selection.getHyperLinkFieldInCurrentSelection(widget, touchPoint, true);\n            }\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(hyperlinkField)) {\n                var code = this.selection.getFieldCode(hyperlinkField);\n                if (code.toLowerCase().indexOf('ref ') === 0 && !code.match('\\\\h')) {\n                    hyperlinkField = undefined;\n                }\n            }\n            widgetInfo = this.selection.updateTextPositionIn(widget, undefined, 0, touchPoint, true);\n            left = this.selection.getLeft(widget);\n            top = this.selection.getTop(widget);\n            if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(hyperlinkField) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(formField) && this.isDocumentProtected &&\n                this.protectionType === 'FormFieldsOnly' && !this.isFormFilling) {\n                this.selection.setHyperlinkContentToToolTip(formField, widget, touchPoint.x, true);\n            }\n            else {\n                this.selection.setHyperlinkContentToToolTip(hyperlinkField, widget, touchPoint.x, false);\n            }\n            if (formField) {\n                var isInlineFormFillMode = (formField.formFieldData instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TextFormField) && formField.formFieldData.type === 'Text';\n                if (this.owner.documentEditorSettings.formFieldSettings.formFillingMode === 'Inline' && isInlineFormFillMode) {\n                    //Update text cursor in text form field.\n                    formField = undefined;\n                }\n            }\n            if (this.owner.enableLockAndEdit) {\n                var isLocked = false;\n                var block = widget.paragraph;\n                if (block.isInsideTable) {\n                    block = this.layout.getParentTable(block);\n                }\n                if (block.locked && block.lockedBy !== this.owner.currentUser) {\n                    isLocked = true;\n                }\n                var sectionFormat = widget.paragraph.bodyWidget.sectionFormat;\n                var pageWidth = sectionFormat.pageWidth - sectionFormat.rightMargin - sectionFormat.leftMargin;\n                pageWidth = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(pageWidth) * this.zoomFactor;\n                if (this.viewer instanceof WebLayoutViewer) {\n                    pageWidth = (this.visibleBounds.width - (this.viewer.padding.right * 5)) / this.zoomFactor;\n                }\n                if (isLocked && touchPoint.x >= lineLeft && touchPoint.x < lineLeft + pageWidth) {\n                    this.selection.setLockInfoTooptip(widget, touchPoint.x, block.lockedBy);\n                }\n                else {\n                    this.selection.setLockInfoTooptip(undefined, touchPoint.x, '');\n                }\n            }\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(widget)) {\n            if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(footnoteElement) && this.owner.layoutType == 'Pages') {\n                footnoteElement = this.selection.getFootNoteElementInCurrentSelection(widget, touchPoint);\n                if (footnoteElement instanceof _page__WEBPACK_IMPORTED_MODULE_7__.FootnoteElementBox) {\n                    this.selection.setFootnoteContentToToolTip(footnoteElement, widget, touchPoint.x);\n                }\n            }\n        }\n        var isCtrlkeyPressed = this.isIosDevice ? event.metaKey : event.ctrlKey;\n        if ((!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(hyperlinkField) && (isCtrlkeyPressed &&\n            this.owner.useCtrlClickToFollowHyperlink || !this.owner.useCtrlClickToFollowHyperlink)) || formField) {\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(formField)) {\n                if (this.isFormFillProtectedMode) {\n                    div.style.cursor = 'default';\n                }\n            }\n            else {\n                div.style.cursor = 'pointer';\n            }\n            return;\n        }\n        else if (touchPoint.x >= lineLeft &&\n            event.offsetX < (this.visibleBounds.width - (this.visibleBounds.width - this.viewerContainer.clientWidth)) &&\n            event.offsetY < (this.visibleBounds.height - (this.visibleBounds.height - this.viewerContainer.clientHeight))) {\n            if (this.selection.isEmpty) {\n                div.style.cursor = 'text';\n            }\n            else {\n                div.style.cursor = this.selection.checkCursorIsInSelection(widget, touchPoint) ? 'default' : 'text';\n            }\n        }\n        else {\n            div.style.cursor = 'default';\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(resizePosition) && resizePosition !== '') {\n            if (!this.owner.imageResizerModule.isShapeResize || this.owner.imageResizerModule.isShapeResize && resizePosition !== 'move') {\n                div.style.cursor = resizePosition;\n            }\n        }\n        else if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(widgetInfo) && widgetInfo.isImageSelected && left < touchPoint.x && top < touchPoint.y &&\n            left + widget.width > touchPoint.x && top + widget.height > touchPoint.y) {\n            div.style.cursor = 'move';\n        }\n        if (isRowResize) {\n            div.style.cursor = 'row-resize';\n        }\n        else if (isCellResize) {\n            div.style.cursor = 'col-resize';\n        }\n        // currently we doesn't provide drag support for shapes, so we commented this line.\n        // if (floatItemInfo.isInShapeBorder && !isInInline) {\n        //     div.style.cursor = 'all-scroll';\n        // }\n    };\n    /**\n     * @private\n     */\n    DocumentHelper.prototype.updateDialogTabHeight = function (dialogElement, targetElement) {\n        var header = dialogElement.getElementsByClassName('e-dlg-header-content')[0];\n        var contentElement = dialogElement.getElementsByClassName('e-dlg-content')[0];\n        var footer = dialogElement.getElementsByClassName('e-footer-content')[0];\n        var contentStyle = getComputedStyle(contentElement);\n        var dialogStyle = getComputedStyle(dialogElement);\n        var paddingTop = parseInt(contentStyle.paddingTop, 10);\n        var paddingBottom = parseInt(contentStyle.paddingBottom, 10);\n        var paddingVertical = (isNaN(paddingTop) ? 0 : paddingTop) + (isNaN(paddingBottom) ? 0 : paddingBottom);\n        var borderTop = parseInt(dialogStyle.borderTop, 10);\n        var borderBottom = parseInt(dialogStyle.borderBottom, 10);\n        var borderVertical = (isNaN(borderTop) ? 0 : borderTop) + (isNaN(borderBottom) ? 0 : borderBottom);\n        var contentHeight = dialogElement.offsetHeight - (header.offsetHeight + footer.offsetHeight + paddingVertical + borderVertical);\n        targetElement.style.height = contentHeight + 'px';\n        var paddingLeft = parseInt(contentStyle.paddingLeft, 10);\n        var paddingRight = parseInt(contentStyle.paddingRight, 10);\n        var paddingHorizontal = (isNaN(paddingLeft) ? 0 : paddingLeft) + (isNaN(paddingRight) ? 0 : paddingRight);\n        var borderLeft = parseInt(dialogStyle.borderLeft, 10);\n        var borderRight = parseInt(dialogStyle.borderRight, 10);\n        var borderHorizontal = (isNaN(borderLeft) ? 0 : borderLeft) + (isNaN(borderRight) ? 0 : borderRight);\n        var contentWidth = dialogElement.offsetWidth - (paddingHorizontal + borderHorizontal);\n        return contentWidth;\n    };\n    /**\n     *\n     * @private\n     */\n    DocumentHelper.prototype.canRenderBorder = function (paragraph) {\n        var skipTopBorder = false;\n        var skipBottomBorder = false;\n        var isSamePreviousBorder;\n        var isSameNextBorder;\n        var isSameTopBorder;\n        var isSameBottomBorder;\n        var isSameLeftBorder;\n        var isSameRightBorder;\n        var previousBlock = paragraph.previousRenderedWidget;\n        var nextBlock = paragraph.nextRenderedWidget;\n        var paragraphX = this.getParagraphLeftPosition(paragraph);\n        var previousBlockX = 0;\n        var nextBlockX = 0;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(previousBlock) && previousBlock instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ParagraphWidget) {\n            previousBlockX = this.getParagraphLeftPosition(previousBlock);\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(nextBlock) && nextBlock instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ParagraphWidget) {\n            nextBlockX = this.getParagraphLeftPosition(nextBlock);\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(previousBlock) && previousBlock instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ParagraphWidget && paragraphX === previousBlockX) {\n            isSameTopBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.top, previousBlock.paragraphFormat.borders.top);\n            isSameBottomBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.bottom, previousBlock.paragraphFormat.borders.bottom);\n            isSameLeftBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.left, previousBlock.paragraphFormat.borders.left);\n            isSameRightBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.right, previousBlock.paragraphFormat.borders.right);\n            if (isSameTopBorder && isSameBottomBorder && isSameLeftBorder && isSameRightBorder\n                && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(previousBlock.paragraphFormat.borders.horizontal) && previousBlock.paragraphFormat.borders.horizontal.lineStyle === 'None') {\n                skipTopBorder = true;\n            }\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(nextBlock) && nextBlock instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ParagraphWidget && (paragraphX === nextBlockX || (this.owner.documentHelper.layout.isInitialLoad && this.skipBottomBorder(paragraph, nextBlock)))) {\n            isSameTopBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.top, nextBlock.paragraphFormat.borders.top);\n            isSameBottomBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.bottom, nextBlock.paragraphFormat.borders.bottom);\n            isSameLeftBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.left, nextBlock.paragraphFormat.borders.left);\n            isSameRightBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.right, nextBlock.paragraphFormat.borders.right);\n            if (isSameBottomBorder && isSameTopBorder && isSameLeftBorder && isSameRightBorder) {\n                skipBottomBorder = true;\n            }\n        }\n        return {\n            'skipTopBorder': skipTopBorder,\n            'skipBottomBorder': skipBottomBorder\n        };\n    };\n    DocumentHelper.prototype.checkEqualBorder = function (source, dest) {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(source) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(dest)) {\n            return source.isEqualFormat(dest);\n        }\n        else {\n            if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(source) && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(dest)) {\n                return true;\n            }\n            else {\n                return false;\n            }\n        }\n    };\n    /**\n    * @private\n    */\n    DocumentHelper.prototype.getParagraphLeftPosition = function (paragraphWidget) {\n        var hangingIndent = 0;\n        var startX = 0;\n        if (paragraphWidget.paragraphFormat.firstLineIndent < 0) {\n            hangingIndent = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(Math.abs(paragraphWidget.paragraphFormat.firstLineIndent));\n            hangingIndent = parseFloat(hangingIndent.toFixed(5));\n        }\n        if (paragraphWidget.isEmpty() && ((paragraphWidget.paragraphFormat.textAlignment !== 'Left' && paragraphWidget.paragraphFormat.textAlignment !== 'Justify')\n            || (paragraphWidget.paragraphFormat.textAlignment === 'Justify' && paragraphWidget.paragraphFormat.bidi))) {\n            startX = paragraphWidget.clientX > hangingIndent ? paragraphWidget.clientX - hangingIndent : paragraphWidget.clientX;\n            return startX;\n        }\n        else {\n            startX = paragraphWidget.x > hangingIndent ? paragraphWidget.x - hangingIndent : paragraphWidget.x;\n            return startX;\n        }\n    };\n    /**\n  * @private\n  */\n    DocumentHelper.prototype.skipBottomBorder = function (paragraph, nextWidget) {\n        var currentIndent = 0;\n        var previousIndent = 0;\n        if (paragraph.paragraphFormat.leftIndent === nextWidget.paragraphFormat.leftIndent) {\n            return true;\n        }\n        else {\n            currentIndent = paragraph.paragraphFormat.firstLineIndent < 0 ? Math.abs(paragraph.paragraphFormat.firstLineIndent) : 0;\n            previousIndent = nextWidget.paragraphFormat.firstLineIndent < 0 ? Math.abs(nextWidget.paragraphFormat.firstLineIndent) : 0;\n            currentIndent = paragraph.paragraphFormat.leftIndent > currentIndent ? paragraph.paragraphFormat.leftIndent - currentIndent : 0;\n            previousIndent = nextWidget.paragraphFormat.leftIndent > previousIndent ? nextWidget.paragraphFormat.leftIndent - previousIndent : 0;\n            if (currentIndent === previousIndent) {\n                return true;\n            }\n            else {\n                return false;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    DocumentHelper.prototype.isPageInVisibleBound = function (page, pageTop) {\n        var height = this.visibleBounds.height;\n        var vertical = this.viewerContainer.scrollTop;\n        var pageH = page.boundingRectangle.height * this.zoomFactor;\n        var isTopFit = pageTop >= vertical && pageTop <= vertical + height;\n        var isBottomFit = pageTop + pageH >= vertical && pageTop + pageH <= vertical + height;\n        var isMiddleFit = pageTop <= vertical && pageTop + pageH >= vertical + height;\n        return isTopFit || isBottomFit || isMiddleFit;\n    };\n    /**\n     * Get first paragraph in cell\n     *\n     * @private\n     * @returns {ParagraphWidget}\n     */\n    DocumentHelper.prototype.getFirstParagraphInCell = function (cell) {\n        var firstBlock = cell.childWidgets[0];\n        if (firstBlock instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ParagraphWidget) {\n            return firstBlock;\n        }\n        else {\n            return this.getFirstParagraphInFirstCell(firstBlock);\n        }\n    };\n    /**\n     * Get first paragraph in first cell\n     *\n     * @private\n     * @returns {TableWidget}\n     */\n    DocumentHelper.prototype.getFirstParagraphInFirstCell = function (table) {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(table.childWidgets) && table.childWidgets.length > 0) {\n            var firstRow = table.childWidgets[0];\n            var cell = firstRow.childWidgets[0];\n            var block = cell.childWidgets[0];\n            return this.getFirstParagraphBlock(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get last paragraph in last cell\n     *\n     * @private\n     * @returns {ParagraphWidget}\n     */\n    DocumentHelper.prototype.getLastParagraphInLastCell = function (table) {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(table.childWidgets) && table.childWidgets.length > 0) {\n            var lastrow = table.lastChild;\n            var lastcell = lastrow.lastChild;\n            var lastBlock = lastcell.lastChild;\n            return this.getLastParagraphBlock(lastBlock);\n        }\n        return undefined;\n    };\n    /**\n     * Get first paragraph in block\n     *\n     * @private\n     * @returns {ParagraphWidget}\n     */\n    DocumentHelper.prototype.getFirstParagraphBlock = function (block) {\n        if (block instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ParagraphWidget) {\n            return block;\n        }\n        else if (block instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget) {\n            return this.getFirstParagraphInFirstCell(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get last paragraph in block\n     *\n     * @private\n     * @returns {ParagraphWidget}\n     */\n    DocumentHelper.prototype.getLastParagraphBlock = function (block) {\n        if (block instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ParagraphWidget) {\n            return block;\n        }\n        else if (block instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget) {\n            return this.getLastParagraphInLastCell(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get last paragraph in first row\n     *\n     * @private\n     * @returns {ParagraphWidget}\n     */\n    DocumentHelper.prototype.getLastParagraphInFirstRow = function (table) {\n        if (table.childWidgets.length > 0) {\n            var row = table.firstChild;\n            var lastcell = row.lastChild;\n            var lastBlock = lastcell.lastChild;\n            return this.getLastParagraphBlock(lastBlock);\n        }\n        return undefined;\n    };\n    /**\n     * Get first paragraph in last row\n     *\n     * @private\n     */\n    DocumentHelper.prototype.getFirstParagraphInLastRow = function (table) {\n        if (table.childWidgets.length > 0) {\n            var lastRow = table.childWidgets[table.childWidgets.length - 1];\n            var lastCell = lastRow.childWidgets[0];\n            var lastBlock = lastCell.childWidgets[0];\n            return this.getFirstParagraphBlock(lastBlock);\n        }\n        return undefined;\n    };\n    /**\n     * Add the given WStyle Object ot stylesMap Dictionary\n     *\n     * @private\n     */\n    /* eslint-disable  */\n    DocumentHelper.prototype.addToStylesMap = function (style) {\n        var returnStyle = {};\n        var returnStyleObject = {};\n        var paraIcon = 'e-list-icon e-de-listview-icon e-de-e-paragraph-style-mark e-icons';\n        var charIcon = 'e-list-icon e-de-listview-icon e-de-e-character-style-mark e-icons';\n        var linkedIcon = 'e-list-icon e-de-listview-icon e-de-e-linked-style-mark e-icons';\n        // StyleName for the dropDownItem\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(style)) {\n            var styleName = this.owner ? this.L10n.getConstant(style.name) : style.name;\n            returnStyle.StyleName = (styleName === '') ? style.name : styleName;\n            if (style.type == \"Paragraph\") {\n                returnStyleObject.paragraphFormat = {};\n                _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.writeParagraphFormat(returnStyleObject.paragraphFormat, true, style.paragraphFormat);\n            }\n            returnStyleObject.characterFormat = {};\n            _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.writeCharacterFormat(returnStyleObject.characterFormat, true, style.characterFormat);\n            // CSS Style for dropDownItem\n            returnStyle.Style = this.parseStyle(JSON.stringify(returnStyleObject));\n            // Setting type for segregating and adding iconcss\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(style.type)) {\n                returnStyle.type = style.type;\n                if (returnStyle.type == \"Paragraph\" && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(style.link)) {\n                    returnStyle.type = \"Linked\";\n                }\n            }\n            // Adding IconCss to the dropDownItem\n            if (returnStyle.type == \"Paragraph\") {\n                returnStyle.IconClass = paraIcon;\n            }\n            else if (returnStyle.type == \"Character\") {\n                returnStyle.IconClass = charIcon;\n            }\n            else {\n                returnStyle.IconClass = linkedIcon;\n            }\n            if (this.stylesMap.get(returnStyle.type)) {\n                this.stylesMap.get(returnStyle.type).push(returnStyle);\n            }\n            else {\n                this.stylesMap.add(returnStyle.type, [returnStyle]);\n            }\n        }\n    };\n    DocumentHelper.prototype.parseStyle = function (style) {\n        var domStyle = '';\n        var styleObj = JSON.parse(style);\n        var textDecoration = '';\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(styleObj.characterFormat.baselineAlignment) && styleObj.characterFormat.baselineAlignment !== 'Normal') {\n            var vAlign = '';\n            switch (styleObj.characterFormat.baselineAlignment) {\n                case 'Superscript':\n                    vAlign = 'super';\n                    break;\n                case 'Subscript':\n                    vAlign = 'sub';\n                    break;\n            }\n            if (vAlign.length > 1) {\n                domStyle += 'vertical-align:' + vAlign + ';';\n            }\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(styleObj.characterFormat.underline) && styleObj.characterFormat.underline !== 'None') {\n            textDecoration += 'underline ';\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(styleObj.characterFormat.strikethrough) && styleObj.characterFormat.strikethrough !== 'None') {\n            textDecoration += 'line-through ';\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(styleObj.characterFormat.fontSize)) {\n            domStyle += 'font-size:' + styleObj.characterFormat.fontSize + 'px;';\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(styleObj.characterFormat.fontFamily)) {\n            domStyle += 'font-family:' + styleObj.characterFormat.fontFamily + ';';\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(styleObj.characterFormat.bold) && styleObj.characterFormat.bold) {\n            domStyle += 'font-weight:bold;';\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(styleObj.characterFormat.italic) && styleObj.characterFormat.italic) {\n            domStyle += 'font-style:italic;';\n        }\n        // if (!isNullOrUndefined(styleObj.characterFormat.fontColor)) {\n        //     domStyle += 'color: ' + styleObj.characterFormat.fontColor + ';';\n        // }\n        if (textDecoration.length > 1) {\n            domStyle += 'text-decoration:' + textDecoration + ';';\n        }\n        return domStyle;\n    };\n    /**\n     * Get next valid element\n     *\n     * @private\n     */\n    DocumentHelper.prototype.getNextValidElement = function (inline) {\n        var nextValidInline = undefined;\n        if (inline instanceof _page__WEBPACK_IMPORTED_MODULE_7__.BookmarkElementBox && inline.bookmarkType === 1) {\n            return inline;\n        }\n        while (inline instanceof _page__WEBPACK_IMPORTED_MODULE_7__.FieldElementBox) {\n            if (inline.fieldType === 0 && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(inline.fieldEnd)) {\n                return (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(nextValidInline) ? inline : nextValidInline;\n            }\n            else if (inline.fieldType === 1 && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(inline.fieldBegin)) {\n                nextValidInline = inline;\n            }\n            inline = inline.nextNode;\n        }\n        return ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(nextValidInline) ? inline : nextValidInline);\n    };\n    /**\n     * @private\n     */\n    DocumentHelper.prototype.getNextValidElementForField = function (firstInline) {\n        if (firstInline instanceof _page__WEBPACK_IMPORTED_MODULE_7__.FieldElementBox && firstInline.fieldType === 0\n            && _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.isLinkedFieldCharacter(firstInline)) {\n            var fieldBegin = firstInline;\n            if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(fieldBegin.fieldSeparator)) {\n                firstInline = fieldBegin.fieldEnd;\n            }\n            else {\n                firstInline = fieldBegin.fieldSeparator;\n            }\n        }\n        var nextValidInline = undefined;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(firstInline.nextNode)) {\n            nextValidInline = this.getNextValidElement(firstInline.nextNode);\n        }\n        return nextValidInline;\n    };\n    return DocumentHelper;\n}());\n\n/**\n * @private\n */\nvar LayoutViewer = /** @class */ (function () {\n    function LayoutViewer(owner) {\n        /**\n         * @private\n         */\n        this.visiblePages = [];\n        /**\n         * @private\n         */\n        this.padding = new _page__WEBPACK_IMPORTED_MODULE_7__.Padding(10, 10, 30, 10);\n        /**\n         * @private\n         */\n        this.textWrap = true;\n        /**\n         * @private\n         */\n        this.pageFitTypeIn = 'None';\n        /**\n         * @private\n         */\n        this.containerTop = 0;\n        /**\n         * @private\n         */\n        this.containerWidth = 0;\n        /**\n         * @private\n         */\n        this.containerLeft = 0;\n        this.owner = owner;\n        this.columnLayoutArea = new ColumnLayout(this);\n    }\n    Object.defineProperty(LayoutViewer.prototype, \"documentHelper\", {\n        get: function () {\n            return this.owner.documentHelper;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"pageFitType\", {\n        /**\n         * Gets or sets page fit type.\n         * @private\n         */\n        get: function () {\n            return this.pageFitTypeIn;\n        },\n        set: function (value) {\n            this.pageFitTypeIn = value;\n            this.onPageFitTypeChanged(this.pageFitTypeIn);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    LayoutViewer.prototype.updateClientArea = function (bodyWidget, page, isReLayout) {\n        var sectionFormat;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(bodyWidget)) {\n            sectionFormat = bodyWidget.sectionFormat;\n            this.columnLayoutArea.setColumns(sectionFormat);\n        }\n        var width = 0;\n        var height = 0;\n        if (this instanceof WebLayoutViewer) {\n            var top_3 = 0;\n            width = (this.documentHelper.visibleBounds.width - (this.padding.right * 4) - (this.padding.left * 2)) / this.documentHelper.zoomFactor;\n            if (width < 0) {\n                width = 0;\n            }\n            height = Number.POSITIVE_INFINITY;\n            this.clientArea = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(this.padding.left / this.documentHelper.zoomFactor, top_3, width, height);\n            this.clientActiveArea = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n        }\n        else {\n            var top_4 = 0;\n            var headerDistance = 48;\n            var footerDistance = 48;\n            var pageHeight = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(sectionFormat.pageHeight);\n            var bottomMargin = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(sectionFormat.bottomMargin);\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(sectionFormat)) {\n                top_4 = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(sectionFormat.topMargin);\n                headerDistance = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(sectionFormat.headerDistance);\n                footerDistance = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(sectionFormat.footerDistance);\n            }\n            var isEmptyWidget = false;\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(page.headerWidget)) {\n                isEmptyWidget = page.headerWidget.isEmpty;\n                if (top_4 >= 0) {\n                    if (!isEmptyWidget || isEmptyWidget && this.owner.enableHeaderAndFooter) {\n                        top_4 = Math.min(Math.max(headerDistance + page.headerWidget.height, top_4), pageHeight / 100 * 40);\n                    }\n                }\n                else {\n                    top_4 = Math.abs(top_4);\n                }\n            }\n            var bottom = 0.667 + bottomMargin;\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(page.footerWidget)) {\n                isEmptyWidget = page.footerWidget.isEmpty;\n                var footnoteHeight = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(page.footnoteWidget) ? page.footnoteWidget.height : 0;\n                footnoteHeight = Math.min(footnoteHeight, ((pageHeight - top_4 - bottom) / 100 * 90));\n                if (bottom >= 0) {\n                    if (!isEmptyWidget || isEmptyWidget && this.owner.enableHeaderAndFooter) {\n                        bottom = 0.667 + Math.min(pageHeight / 100 * 40, Math.max(footerDistance + page.footerWidget.height, bottomMargin));\n                    }\n                }\n                else {\n                    bottom = Math.abs(bottom);\n                }\n                bottom += footnoteHeight;\n            }\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(sectionFormat)) {\n                width = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n                height = pageHeight - top_4 - bottom;\n            }\n            if (width < 0) {\n                width = 0;\n            }\n            var clientArea = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(_editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(sectionFormat.leftMargin), top_4, width, pageHeight - top_4 - bottom);\n            if (page.footnoteWidget && isReLayout && !this.documentHelper.owner.editorModule.isFootNote) {\n                if (page.footnoteWidget.y !== 0 && this.clientArea.y + this.clientArea.height > page.footnoteWidget.y) {\n                    var sub = (this.clientArea.y + this.clientArea.height - page.footnoteWidget.y);\n                    this.clientArea.height -= sub / 2;\n                }\n            }\n            if (bodyWidget.page.bodyWidgets[0].columnIndex !== 0) {\n                this.owner.editorModule.updateColumnIndex(bodyWidget, false);\n            }\n            this.setClientArea(bodyWidget, clientArea);\n            this.clientActiveArea = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n        }\n    };\n    LayoutViewer.prototype.setClientArea = function (bodyWidget, clientArea) {\n        this.clientArea = this.columnLayoutArea.getColumnBoundsByBodyWidget(bodyWidget, clientArea);\n        bodyWidget.x = this.clientArea.x;\n        bodyWidget.width = this.clientArea.width;\n    };\n    LayoutViewer.prototype.updateClientAreaTopOrLeft = function (tableWidget, beforeLayout) {\n        if (beforeLayout) {\n            this.clientActiveArea.y = this.clientActiveArea.y + tableWidget.topBorderWidth;\n            this.clientActiveArea.x = this.clientActiveArea.x + tableWidget.leftBorderWidth;\n        }\n    };\n    LayoutViewer.prototype.updateClientAreaForTable = function (tableWidget) {\n        this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n        this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n    };\n    LayoutViewer.prototype.updateClientAreaForRow = function (row, beforeLayout) {\n        var tableWidget = row.ownerTable;\n        if (beforeLayout) {\n        }\n        else {\n            this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n            this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n            this.clientArea = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            this.clientActiveArea = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n    };\n    LayoutViewer.prototype.updateClientAreaForCell = function (cell, beforeLayout) {\n        var rowWidget = cell.ownerRow;\n        var cellWidget = cell;\n        if (beforeLayout) {\n            this.clientActiveArea.x = this.clientArea.x = cellWidget.x;\n            this.clientActiveArea.y = cellWidget.y;\n            this.clientActiveArea.width = this.clientArea.width = cellWidget.width > 0 ? cellWidget.width : 0;\n            if (this instanceof PageLayoutViewer) {\n                this.clientActiveArea.height = Number.POSITIVE_INFINITY;\n            }\n            this.clientArea = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            this.clientActiveArea = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n        else {\n            this.clientActiveArea.x = this.clientArea.x = cellWidget.x + cellWidget.width + cellWidget.margin.right;\n            if (rowWidget.x + rowWidget.width - this.clientArea.x < 0) {\n                this.clientActiveArea.width = this.clientArea.width = 0;\n            }\n            else {\n                this.clientActiveArea.width = this.clientArea.width = rowWidget.x + rowWidget.width - this.clientArea.x;\n            }\n            this.clientActiveArea.y = cellWidget.y - cellWidget.margin.top - _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing);\n            if (!cell.ownerTable.isInsideTable) {\n                this.clientActiveArea.height = this.clientArea.bottom - rowWidget.y > 0 ? this.clientArea.bottom - rowWidget.y : 0;\n                if (!cell.ownerTable.wrapTextAround && this.documentHelper.layout.existFootnoteHeight > 0) {\n                    var updateHeight = this.clientActiveArea.height - this.documentHelper.layout.existFootnoteHeight;\n                    this.clientActiveArea.height = updateHeight < 0 ? 0 : updateHeight;\n                }\n            }\n            this.clientArea = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            this.clientActiveArea = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n    };\n    LayoutViewer.prototype.updateClientAreaForTextBoxShape = function (textBox, beforeLayout, shiftNextWidget) {\n        if (textBox.textWrappingStyle === 'Inline' && !shiftNextWidget) {\n            textBox.y = this.clientActiveArea.y;\n            textBox.x = this.clientActiveArea.x;\n        }\n        if (beforeLayout) {\n            var marginLeft = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(textBox.textFrame.marginLeft);\n            var marginRight = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(textBox.textFrame.marginRight);\n            var marginTop = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(textBox.textFrame.marginTop);\n            var marginBottom = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(textBox.textFrame.marginBottom);\n            var width = textBox.width;\n            var height = Number.POSITIVE_INFINITY;\n            this.clientArea = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(textBox.x + marginLeft, textBox.y + marginTop, width - marginLeft - marginRight, height - marginTop - marginBottom);\n            this.clientActiveArea = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n        }\n    };\n    LayoutViewer.prototype.updateClientAreaByWidgetFootNote = function (widget) {\n        this.clientArea.x = widget.x;\n        this.clientArea.y = widget.y;\n        this.clientActiveArea.x = widget.x;\n        this.clientActiveArea.y = widget.y;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForTextWrap = function (area) {\n        this.clientActiveArea = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(area.x, area.y, area.width, area.height);\n    };\n    LayoutViewer.prototype.updateBoundsBasedOnTextWrap = function (bottom) {\n        var diff = bottom - this.clientActiveArea.y;\n        this.clientActiveArea.y = bottom;\n        this.clientActiveArea.height = this.clientActiveArea.height - diff;\n    };\n    LayoutViewer.prototype.updateBoundsBasedOnTextWrapTable = function (bottom) {\n        var diff = bottom - this.clientArea.y;\n        this.clientArea.y = bottom;\n        this.clientArea.height = this.clientArea.height - diff;\n        this.clientActiveArea = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n    };\n    LayoutViewer.prototype.updateClientAreaByWidget = function (widget) {\n        this.clientArea.x = widget.x;\n        this.clientArea.y = widget.y;\n        this.clientActiveArea.x = widget.x;\n        this.clientActiveArea.y = widget.y;\n    };\n    LayoutViewer.prototype.updateClientAreaLocation = function (widget, area) {\n        widget.x = area.x;\n        widget.y = area.y;\n        widget.width = area.width;\n    };\n    LayoutViewer.prototype.updateClientAreaForBlock = function (block, beforeLayout, tableCollection, updateYPosition, updateXPosition) {\n        var leftIndent = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(block.leftIndent);\n        var rightIndent = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(block.rightIndent);\n        var bidi = block.bidi;\n        var width = 0;\n        if (beforeLayout) {\n            if (block instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget && tableCollection) {\n                var tableWidget = tableCollection[0];\n                if (block.bodyWidget.sectionFormat.columns.length <= 1) {\n                    this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n                    this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n                }\n                //Updates the location of last item.\n                tableWidget = tableCollection[tableCollection.length - 1];\n                tableWidget.x = this.clientActiveArea.x;\n                tableWidget.y = this.clientActiveArea.y;\n            }\n            else {\n                if (block instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(block.tableFormat)) {\n                    if (!block.isGridUpdated) {\n                        block.buildTableColumns();\n                        block.isGridUpdated = true;\n                    }\n                    var tableAlignment = this.tableAlignmentForBidi(block, bidi);\n                    if (tableAlignment !== 'Left') {\n                        var tableWidth = 0;\n                        // If the grid is calculated, we can direclty get the width from the grid.\n                        // Otherwise, calculate the width.\n                        tableWidth = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(block.tableHolder.getTotalWidth(0));\n                        tableWidth = tableWidth === 0 ? block.tableHolder.tableWidth === 0 ?\n                            block.getTableClientWidth(block.getOwnerWidth(false)) : block.tableHolder.tableWidth : tableWidth;\n                        // Fore resizing table, the tableholder table width taken for updated width. \n                        // Since, the columns will be cleared if we performed resizing.\n                        if (this.owner.editorModule && this.owner.editorModule.tableResize.currentResizingTable === block\n                            && this.owner.editorModule.tableResize.resizerPosition === 0) {\n                            tableWidth = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(block.tableHolder.tableWidth);\n                        }\n                        if (tableAlignment === 'Center') {\n                            if (!this.documentHelper.isRowOrCellResizing) {\n                                tableWidth = block.getTableCellWidth();\n                            }\n                            leftIndent = (this.clientArea.width - tableWidth) / 2;\n                        }\n                        else {\n                            leftIndent = this.clientArea.width - tableWidth;\n                        }\n                        if (bidi) {\n                            leftIndent = leftIndent - _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(block.leftIndent);\n                            rightIndent = leftIndent;\n                        }\n                        if (!block.isInsideTable) {\n                            //leftIndent = (block.tableFormat.horizontalPositionAbs === 'Left') ? block.tableFormat.horizontalPosition : leftIndent;\n                        }\n                        this.documentHelper.tableLefts.push(leftIndent);\n                    }\n                }\n                width = this.clientArea.width - (leftIndent + _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(block.rightIndent));\n                var x = this.clientArea.x + (bidi ? rightIndent : leftIndent);\n                width = width > 0 ? width : 0;\n                this.clientActiveArea.x = this.clientArea.x = x;\n                this.clientActiveArea.width = this.clientArea.width = width;\n                if (updateYPosition) {\n                    this.updateParagraphYPositionBasedonTextWrap(block, new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height));\n                }\n                if (updateXPosition) {\n                    if (block instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ParagraphWidget) {\n                        this.updateParagraphXPositionBasedOnTextWrap(block);\n                    }\n                    else {\n                        this.updateTableXPositionBasedOnTextWrap(block);\n                    }\n                }\n            }\n        }\n        else {\n            // Clears table left for table with right or center alignment.\n            if (block instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(block.tableFormat)) {\n                var tableAlignment = this.tableAlignmentForBidi(block, bidi);\n                if (!block.isGridUpdated) {\n                    block.buildTableColumns();\n                    block.isGridUpdated = true;\n                }\n                if (tableAlignment !== 'Left' && this.documentHelper.tableLefts.length > 0) {\n                    leftIndent = this.documentHelper.tableLefts.pop();\n                    if (bidi) {\n                        rightIndent = leftIndent;\n                    }\n                }\n            }\n            width = this.clientArea.width + leftIndent + _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(block.rightIndent);\n            var x = this.clientArea.x - (bidi ? rightIndent : leftIndent);\n            width = width > 0 ? width : 0;\n            this.clientActiveArea.x = this.clientArea.x = x;\n            this.clientActiveArea.width = this.clientArea.width = width;\n        }\n        this.clientArea = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n        this.clientActiveArea = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n    };\n    LayoutViewer.prototype.updateParagraphYPositionBasedonTextWrap = function (block, rect) {\n        var bodyWidget = block.bodyWidget;\n        var clientLayoutArea = this.clientActiveArea;\n        if (bodyWidget && bodyWidget.floatingElements.length > 0 && block instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ParagraphWidget && !(block.containerWidget instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TextFrame)\n            && !block.isInsideTable && !(block.containerWidget instanceof _page__WEBPACK_IMPORTED_MODULE_7__.FootNoteWidget)) {\n            var isWord2013 = this.documentHelper.compatibilityMode === 'Word2013';\n            var paragraph = block;\n            var isEmptyPara = paragraph.isEmpty();\n            var paragraphHeight = paragraph.height;\n            if (paragraphHeight === 0) {\n                paragraphHeight = this.documentHelper.textHelper.getParagraphMarkSize(paragraph.characterFormat).Height;\n            }\n            //Update Layout area based on text wrap\n            if (((!paragraph.isInHeaderFooter || paragraph.isInsideTable)\n                || isWord2013)) {\n                var yposition = rect.y;\n                // As per Microsoft Word behavior, need to update bottom position of first inline item to floating item bottom,\n                // when first inline item of page intersects in-between two adjacent floating items parallel in vertical\n                // for Word document lower than Microsoft Word 2013 version.\n                // To do: Currently this behavior handled for bottom position update based on Y position,\n                // need to handle this behavior for bottom position update based on X position in UpdateParagraphXPositionBasedOnTextWrap method.\n                var isFirstItemBottomPositionUpdated = false;\n                //Need to handle sorting floating items.\n                // Sort based on Y position\n                bodyWidget.floatingElements.sort(function (a, b) { return a.y - b.y; });\n                // Sort based on X position\n                bodyWidget.floatingElements.sort(function (a, b) { return a.x - b.x; });\n                var previousItem = paragraph.previousRenderedWidget;\n                if (previousItem && (previousItem instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget) && previousItem.wrapTextAround\n                    && !isEmptyPara && !paragraph.isContainsShapeAlone() && isWord2013 && rect.y < previousItem.y) {\n                    rect.y = previousItem.y;\n                }\n                for (var i = 0; i < bodyWidget.floatingElements.length; i++) {\n                    var floatingItem = bodyWidget.floatingElements[i];\n                    var isInsideHeaderFooter = false;\n                    if (floatingItem instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ShapeBase) {\n                        isInsideHeaderFooter = floatingItem.paragraph.isInHeaderFooter;\n                    }\n                    else {\n                        isInsideHeaderFooter = floatingItem.bodyWidget instanceof _page__WEBPACK_IMPORTED_MODULE_7__.HeaderFooterWidget ? true : false;\n                    }\n                    if (paragraph.isInsideTable) {\n                        if (floatingItem instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget && !floatingItem.isInsideTable) {\n                            continue;\n                        }\n                    }\n                    var textWrappingBounds = this.getTextWrappingBound(floatingItem);\n                    var textWrappingStyle = floatingItem instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget ? 'Square' : floatingItem.textWrappingStyle;\n                    var textWrappingType = floatingItem instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget ? 'Both' : floatingItem.textWrappingType;\n                    var minimumWidthRequired = 24;\n                    if (!(clientLayoutArea.x > (textWrappingBounds.right + minimumWidthRequired) || clientLayoutArea.right < textWrappingBounds.x - minimumWidthRequired)) {\n                        if ((((rect.y + (floatingItem instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget && !isEmptyPara && paragraph.floatingElements.length === 0 ? paragraphHeight : paragraph.height) > textWrappingBounds.y\n                            || isFirstItemBottomPositionUpdated) && rect.y < (textWrappingBounds.bottom))) && textWrappingStyle !== 'Inline'\n                            && textWrappingStyle !== 'TopAndBottom' && textWrappingStyle !== 'InFrontOfText'\n                            && textWrappingStyle !== 'Behind') {\n                            var rightIndent = 0;\n                            var paragarphRightIndent = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(paragraph.paragraphFormat.rightIndent);\n                            var firstLineIndent = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent);\n                            firstLineIndent = ((!isEmptyPara && paragraph.childWidgets[0].isFirstLine()) && firstLineIndent > 0) ? firstLineIndent : 0;\n                            if (rect.x >= textWrappingBounds.x && textWrappingType !== 'Left') {\n                                rightIndent = paragarphRightIndent;\n                            }\n                            // Gets the value from right indent when it is negative, otherwise sets the value as zero.\n                            rightIndent = rightIndent < 0 ? rightIndent : 0;\n                            if (rect.x < textWrappingBounds.x && rect.x > textWrappingBounds.x && textWrappingType !== 'Left') {\n                                if (rect.right > textWrappingBounds.x) {\n                                    rect.width = rect.width - (rect.right - textWrappingBounds.right);\n                                }\n                                if (rect.width < minimumWidthRequired) {\n                                    //Skip to wrap the immediate paragraph of floating table based on corresponding floating table. \n                                    if (isWord2013 || !((floatingItem instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget) && previousItem === floatingItem)) {\n                                        this.updateBoundsBasedOnTextWrap(textWrappingBounds.bottom);\n                                        rect = this.clientActiveArea;\n                                    }\n                                    if ((!isEmptyPara && paragraph.childWidgets[0].isFirstLine() || isEmptyPara) && isWord2013 ? true : !isInsideHeaderFooter) {\n                                        paragraph.y = this.clientActiveArea.y;\n                                    }\n                                }\n                                else {\n                                    rect.x = textWrappingBounds.right;\n                                }\n                            }\n                            else if (rect.x >= textWrappingBounds.x && rect.x < textWrappingBounds.right) {\n                                rect.width = rect.width - (textWrappingBounds.right - rect.x) - rightIndent;\n                                //checks minimum width\n                                if (rect.width < minimumWidthRequired || isFirstItemBottomPositionUpdated) {\n                                    rect.width = this.clientActiveArea.right - textWrappingBounds.right - rightIndent;\n                                    var isPositionsUpdated = false;\n                                    if (rect.width < minimumWidthRequired || isFirstItemBottomPositionUpdated) {\n                                        // If left side of floating item has minimum width to layout the paragraph, then find the minimum bottom among the floating items to the left side of current floating item.\n                                        // Then update the Y position to that bottom.\n                                        if (this.clientActiveArea.x + minimumWidthRequired < textWrappingBounds.x) {\n                                            var tempBounds = this.getIntersectingItemBounds(bodyWidget.floatingElements, floatingItem, yposition);\n                                            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(tempBounds) && tempBounds.bottom <= textWrappingBounds.bottom) {\n                                                this.updateBoundsBasedOnTextWrap(tempBounds.bottom);\n                                                rect = this.clientActiveArea;\n                                                isPositionsUpdated = true;\n                                                //When we update the client area to the bottom of floating item, we also need to updtae the X position. \n                                                //To-Do: Some more X position updating cases also need to handle.\n                                                paragraph.x = tempBounds.x;\n                                            }\n                                        }\n                                        // Skip to wrap the immediate paragraph of floating table based on corresponding floating table.\n                                        if ((isWord2013) && !isPositionsUpdated) {\n                                            if (floatingItem instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget && previousItem === floatingItem) {\n                                                this.updateBoundsBasedOnTextWrapTable(textWrappingBounds.bottom);\n                                            }\n                                            else {\n                                                this.updateBoundsBasedOnTextWrap(textWrappingBounds.bottom);\n                                            }\n                                            rect = this.clientActiveArea;\n                                        }\n                                        if ((!isEmptyPara && paragraph.childWidgets[0].isFirstLine() || isEmptyPara) && isWord2013 ? true : !isInsideHeaderFooter) {\n                                            paragraph.y = this.clientActiveArea.y;\n                                        }\n                                    }\n                                    else {\n                                        rect.x = textWrappingBounds.right;\n                                    }\n                                }\n                                else {\n                                    rect.x = textWrappingBounds.right;\n                                }\n                            }\n                            else if (textWrappingBounds.x > rect.x && rect.right > textWrappingBounds.x) {\n                                rect.width = textWrappingBounds.x - rect.x;\n                                //checks minimum width\n                                if (rect.width < minimumWidthRequired) {\n                                    rect.width = this.clientActiveArea.right - textWrappingBounds.right - rightIndent;\n                                    if (rect.width < minimumWidthRequired) {\n                                        //Skip to wrap the immediate paragraph of floating table based on corresponding floating table. \n                                        if (isWord2013 || !((floatingItem instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget) && previousItem === floatingItem)) {\n                                            this.updateBoundsBasedOnTextWrap(textWrappingBounds.bottom);\n                                            rect = this.clientActiveArea;\n                                        }\n                                        if ((!isEmptyPara && paragraph.childWidgets[0].isFirstLine() || isEmptyPara) && isWord2013 ? true : !isInsideHeaderFooter) {\n                                            paragraph.y = this.clientActiveArea.y;\n                                        }\n                                    }\n                                    else {\n                                        rect.x = textWrappingBounds.right;\n                                    }\n                                }\n                            }\n                        }\n                        else if ((bodyWidget.floatingElements.length > 0 && ((rect.y >= (textWrappingBounds.y) && rect.y < (textWrappingBounds.bottom))\n                            || ((rect.y + paragraphHeight >= textWrappingBounds.y) && (rect.y + paragraphHeight < (textWrappingBounds.bottom))))\n                            && textWrappingStyle === 'TopAndBottom')) {\n                            //Skip to wrap the immediate paragraph of floating table based on corresponding floating table. \n                            if (isWord2013 || !((floatingItem instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget) && previousItem === floatingItem)) {\n                                this.updateBoundsBasedOnTextWrap(textWrappingBounds.bottom);\n                                // Sets true to update bottom position of first inline item in page\n                                // when this item's bottom position already updated based on previous floating item.\n                                if (!isWord2013 && (!isEmptyPara && paragraph.childWidgets[0].isFirstLine() || isEmptyPara)) {\n                                    isFirstItemBottomPositionUpdated = true;\n                                }\n                            }\n                            if ((!isEmptyPara && paragraph.childWidgets[0].isFirstLine() || isEmptyPara) && isWord2013 ? true : !isInsideHeaderFooter) {\n                                paragraph.y = this.clientActiveArea.y;\n                            }\n                        }\n                    }\n                    // //Reset the floating item bounds to original position\n                    // ResetXPositionForRTLLayouting(i, ref textWrappingBounds, floatingItemXPosition);\n                }\n                //Update the wrapping difference value.\n                // if (isFirstItem && yValue < rect.Y) {\n                //     (m_lcOperator as Layouter).WrappingDifference = (float)(rect.Y - (m_lcOperator as Layouter).PageTopMargin);\n                // }\n            }\n        }\n    };\n    LayoutViewer.prototype.updateParagraphXPositionBasedOnTextWrap = function (block) {\n        // #region textwrap\n        var yValue = 0;\n        var isFirstItem = false;\n        var isWord2013 = this.documentHelper.compatibilityMode === 'Word2013';\n        var bodyWidget = block.containerWidget;\n        var clientLayoutArea = this.clientActiveArea;\n        // if (!(m_lcOperator as Layouter).IsLayoutingHeaderFooter &&\n        //     (m_lcOperator as Layouter).WrappingDifference === Number.MIN_VALUE &&\n        //     Math.round(yPosition, 2) === Math.round((m_lcOperator as Layouter).PageTopMargin, 2)) {\n        //     yValue = yPosition;\n        //     isFirstItem = true;\n        // }\n        if (this instanceof PageLayoutViewer && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(bodyWidget) && block instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ParagraphWidget && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(bodyWidget.page) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(bodyWidget.page.headerWidget)) {\n            var floatingItems = bodyWidget.page.headerWidget.floatingElements;\n            if (floatingItems.length > 0 &&\n                (!block.isInHeaderFooter || block.isInsideTable ||\n                    isWord2013) &&\n                !(block.containerWidget instanceof _page__WEBPACK_IMPORTED_MODULE_7__.FootNoteWidget) && !(block.bodyWidget instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TextFrame)) {\n                // const clientLayoutArea: RectangleF = (m_lcOperator as Layouter).ClientLayoutArea;\n                // clientLayoutArea.X = xPosition;\n                // clientLayoutArea.Y = yPosition;\n                //let cellPadings: number = 0;\n                var paragraph = block;\n                //if (paragraph.isInsideTable) {\n                //const cellLayoutInfo: CellLayoutInfo = ((paragraph.GetOwnerEntity() as WTableCell) as IWidget).LayoutInfo as CellLayoutInfo;\n                //cellPadings = cellLayoutInfo.Paddings.Left + cellLayoutInfo.Paddings.Right;\n                // }\n                // let defMinWidth: number = minimumWidthRequired - cellPadings;\n                // const size: SizeF = (paragraph as IWidget).LayoutInfo.Size;\n                for (var i = 0; i < floatingItems.length; i++) {\n                    var floatingItem = floatingItems[i];\n                    // if (paragraph.IsInCell && floatingItems[i].allowOverlap &&\n                    //     (paragraph.associatedCell.ownerRow.ownerTable.tableFormat.positioning.allowOverlap) {\n                    if (paragraph.isInsideTable) {\n                        if (floatingItem instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget && !floatingItem.isInsideTable) {\n                            continue;\n                        }\n                    }\n                    // }\n                    var textWrappingBounds = this.getTextWrappingBound(floatingItem);\n                    var textWrappingStyle = floatingItem instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget ? 'Square' : floatingItem.textWrappingStyle;\n                    var textWrappingType = floatingItem instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget ? 'Both' : floatingItem.textWrappingType;\n                    //let ownerBody: BodyWidget = undefined;\n                    //As per Microsoft Word behavior, when floating item and paragraph in cell means,\n                    //then, wrap the bounds for the items in same cell only.                 \n                    //Skip, if it is in different cell.\n                    // let ownerBody: BodyWidget = undefined\n                    // if (!this.isInSameTextBody(paragraph, floatingItem, ownerBody) &&\n                    //     paragraph.isInsideTable && bodyWidget instanceof TableCellWidget) {\n                    //     continue;\n                    // }\n                    // if (this.IsInFrame((m_lcOperator as Layouter).FloatingItems[i].FloatingEntity as WParagraph) &&\n                    //     this.IsOwnerCellInFrame(paragraph)) {\n                    //     continue;\n                    // }\n                    // if (paragraph.ParagraphFormat.Bidi &&\n                    //     (this.IsInSameTextBody(paragraph, (m_lcOperator as Layouter).FloatingItems[i], ownerBody) &&\n                    //         paragraph.IsInCell && ownerBody instanceof WTableCell)) {\n                    //     this.ModifyXPositionForRTLLayouting(i, textWrappingBounds, (m_layoutArea as any).ClientArea);\n                    // } else if (paragraph.ParagraphFormat.Bidi) {\n                    //     this.ModifyXPositionForRTLLayouting(i, textWrappingBounds, (m_lcOperator as Layouter).ClientLayoutArea);\n                    // }\n                    var minimumWidthRequired = 24;\n                    // if (textWrappingStyle === TextWrappingStyle.Tight || textWrappingStyle === TextWrappingStyle.Through) {\n                    //     minimumWidthRequired = paragraph.Document.Settings.CompatibilityMode === CompatibilityMode.Word2013 ?\n                    //         DEF_MIN_WIDTH_2013_TIGHTANDTHROW : DEF_MIN_WIDTH_TIGHTANDTHROW;\n                    // }\n                    // minimumWidthRequired -= cellPadings;\n                    // defMinWidth = minimumWidthRequired;\n                    // if (textWrappingStyle === TextWrappingStyle.Tight || textWrappingStyle === TextWrappingStyle.Through &&\n                    //     (m_lcOperator as Layouter).FloatingItems[i].IsDoesNotDenotesRectangle) {\n                    //     const temp: RectangleF = this.AdjustTightAndThroughBounds(\n                    //         (m_lcOperator as Layouter).FloatingItems[i], clientLayoutArea, size.Height);\n                    //     if (temp.X !== 0) {\n                    //         textWrappingBounds = temp;\n                    //         defMinWidth = size.Width;\n                    //     }\n                    // }\n                    if (!paragraph.isInsideTable &&\n                        (!(clientLayoutArea.x > textWrappingBounds.right + minimumWidthRequired ||\n                            clientLayoutArea.right < textWrappingBounds.x - minimumWidthRequired))) {\n                        if (floatingItems.length > 0 &&\n                            (clientLayoutArea.y + paragraph.height > textWrappingBounds.y && clientLayoutArea.y < textWrappingBounds.bottom) &&\n                            textWrappingStyle !== \"Inline\" &&\n                            textWrappingStyle !== \"TopAndBottom\" &&\n                            textWrappingStyle !== \"InFrontOfText\" &&\n                            textWrappingStyle !== \"Behind\") {\n                            var rightIndent = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(paragraph.paragraphFormat.rightIndent);\n                            if (paragraph.paragraphFormat.textAlignment != \"Left\" && (clientLayoutArea.x < textWrappingBounds.x && clientLayoutArea.x + paragraph.width > textWrappingBounds.x)) {\n                                paragraph.x = clientLayoutArea.x;\n                            }\n                            else if (clientLayoutArea.x >= textWrappingBounds.x && clientLayoutArea.x < textWrappingBounds.right && !paragraph.paragraphFormat.bidi) {\n                                clientLayoutArea.width = clientLayoutArea.width - (textWrappingBounds.right - clientLayoutArea.x) - rightIndent;\n                                if (clientLayoutArea.width < minimumWidthRequired) {\n                                    clientLayoutArea.width = this.clientActiveArea.right - textWrappingBounds.right - rightIndent;\n                                    if (clientLayoutArea.width < minimumWidthRequired) {\n                                        paragraph.x = clientLayoutArea.x;\n                                        clientLayoutArea.width = clientLayoutArea.width;\n                                        clientLayoutArea.height = textWrappingBounds.bottom - clientLayoutArea.x;\n                                        clientLayoutArea.y = textWrappingBounds.bottom;\n                                    }\n                                    else {\n                                        clientLayoutArea.x = textWrappingBounds.right;\n                                    }\n                                }\n                                else if (this.documentHelper.compatibilityMode === \"Word2007\" ||\n                                    clientLayoutArea.y <= textWrappingBounds.bottom) {\n                                    // if (this.IsNeedToUpdateParagraphYPosition(clientLayoutArea.Y, textWrappingStyle,\n                                    //     paragraph, clientLayoutArea.Y + size.Height + paragraph.ParagraphFormat.AfterSpacing, textWrappingBounds.Bottom)) {\n                                    //     paragraph.x = clientLayoutArea.x;\n                                    //     clientLayoutArea.width = clientLayoutArea.width;\n                                    //     clientLayoutArea.y = textWrappingBounds.bottom;\n                                    //     clientLayoutArea.height = clientLayoutArea.height -\n                                    //         (textWrappingBounds.bottom - clientLayoutArea.y);\n                                    //     this.updateBoundsBasedOnTextWrap(textWrappingBounds.bottom);\n                                    // } else {\n                                    //const paraInfo: ParagraphLayoutInfo = paragraph.m_layoutInfo as ParagraphLayoutInfo;\n                                    var leftIndent = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(paragraph.paragraphFormat.leftIndent);\n                                    var firstLineIndent = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent);\n                                    if (leftIndent + firstLineIndent + clientLayoutArea.x < textWrappingBounds.right) {\n                                        //paragraph.x = textWrappingBounds.right;\n                                        clientLayoutArea.x = textWrappingBounds.right;\n                                        if (isWord2013) {\n                                            //this.documentHelper.layout.IsXpositionUpated = true;\n                                        }\n                                    }\n                                    // }\n                                }\n                            }\n                            else if ((textWrappingBounds.x - minimumWidthRequired > clientLayoutArea.x && clientLayoutArea.right > textWrappingBounds.x) ||\n                                (clientLayoutArea.x > textWrappingBounds.x && clientLayoutArea.x > textWrappingBounds.right)) {\n                                paragraph.x = clientLayoutArea.x;\n                            }\n                            // else if (clientLayoutArea.x > textWrappingBounds.x - minimumWidthRequired && clientLayoutArea.x < textWrappingBounds.right) {\n                            //     const width: number = clientLayoutArea.width + (clientLayoutArea.x - textWrappingBounds.right);\n                            //     if (width < minimumWidthRequired) {\n                            //         clientLayoutArea.y = textWrappingBounds.bottom;\n                            //     } else {\n                            //         paragraph.x = textWrappingBounds.right;\n                            //     }\n                            // } \n                            // else if (this.IsNeedToUpdateParagraphYPosition(clientLayoutArea.Y, textWrappingStyle,\n                            //     paragraph, clientLayoutArea.Y + size.Height + paragraph.ParagraphFormat.AfterSpacing, textWrappingBounds.Bottom)) {\n                            //     (paragraph.m_layoutInfo as ParagraphLayoutInfo).XPosition = clientLayoutArea.X;\n                            //     clientLayoutArea.Width = (m_lcOperator as Layouter).ClientLayoutArea.Width;\n                            //     clientLayoutArea.Y = textWrappingBounds.Bottom;\n                            //     clientLayoutArea.Height = (m_lcOperator as Layouter).ClientLayoutArea.Height -\n                            //         (textWrappingBounds.Bottom - (m_lcOperator as Layouter).ClientLayoutArea.Y);\n                            //     (m_layoutArea as any).UpdateBoundsBasedOnTextWrap(textWrappingBounds.Bottom);\n                            // }\n                        }\n                    }\n                    //this.ResetXPositionForRTLLayouting(i, textWrappingBounds, floatingItemXPosition);\n                }\n            }\n            // if (m_widget instanceof WParagraph) {\n            //     const sortYPosition: FloatingItem[] = (m_lcOperator as Layouter).FloatingItems.slice(0);\n            //     FloatingItem.SortFloatingItems(sortYPosition, SortPosition.Y);\n            //     this.UpdateXYPositionBasedOnAdjacentFloatingItems(sortYPosition, clientLayoutArea, size,\n            //         m_widget as WParagraph, false);\n            // }\n            // if (isFirstItem && yValue < yPosition) {\n            //     (m_lcOperator as Layouter).WrappingDifference = yPosition - (m_lcOperator as Layouter).PageTopMargin;\n            // }\n        }\n    };\n    LayoutViewer.prototype.updateTableXPositionBasedOnTextWrap = function (block) {\n        // Get the first row width\n        var firstRowWidth = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(block.childWidgets[0].getFirstRowWidth());\n        var bodyWidget = block.bodyWidget;\n        if (this instanceof PageLayoutViewer && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(bodyWidget) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(bodyWidget.page) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(bodyWidget.page.headerWidget)) {\n            var floatingItems = bodyWidget.page.headerWidget.floatingElements;\n            // textwrap\n            // Update Layout area based on text wrap and ignore the yposition update while \n            // wrapping bounds already added to the collection\n            if (floatingItems.length > 0 && (!block.isInHeaderFooter || !block.isInsideTable || this.documentHelper.compatibilityMode === 'Word2013')\n                && !(block.containerWidget instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TextFrame)) {\n                var rect = this.clientActiveArea;\n                //let wrapItemIndex: number = -1;\n                // sort the list items based on y position,\n                // Call Sort on the list. This will use the  \n                // default comparer, which is the Compare method  \n                // implemented on FloatingItem.\n                //FloatingItem.sortFloatingItems(this.m_lcOperator.floatingItems, SortPosition.Y);\n                for (var i = 0; i < floatingItems.length; i++) {\n                    var floatingItem = floatingItems[i];\n                    var textWrappingBounds = this.getTextWrappingBound(floatingItem);\n                    var textWrappingStyle = floatingItem instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget ? 'Square' : floatingItem.textWrappingStyle;\n                    var allowOverlap = floatingItem instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget ? floatingItem.positioning.allowOverlap : floatingItem.allowOverlap;\n                    // if (this.isAdjustTightAndThroughBounds(textWrappingStyle, i)) {\n                    //     let temp: RectangleF = this.adjustTightAndThroughBounds(this.m_lcOperator.floatingItems[i], rect, size.height);\n                    //     textWrappingBounds = temp;\n                    // }\n                    // let ownerBody: WTextBody = null;\n                    // // As per Microsoft Word behavior, when floating item and table in cell means,\n                    // // then, wrap the bounds for the items in same cell only.                 \n                    // // Skip, if it is in different cell.\n                    // if (!this.isInSameTextBody(this.m_table, this.m_lcOperator.floatingItems[i], ownerBody)\n                    //     && this.m_table.isInCell && ownerBody instanceof WTableCell)\n                    //     continue;\n                    // // Skip if the current table is in different frame\n                    // if (this.isInFrame(this.m_lcOperator.floatingItems[i].floatingEntity as WParagraph) && this.m_table.isFrame)\n                    //     continue;\n                    // // Adjusts the text wrapping bounds based on distance from text values when floating table intersects with another floating item.\n                    // textWrappingBounds = this.adjustTextWrappingBounds(this.m_lcOperator.floatingItems[i], clientLayoutArea, size,\n                    //     wrapItemIndex, i, rect, textWrappingBounds, textWrappingStyle, allowOverlap);\n                    var minimumWidthRequired = 24;\n                    var paragarph = this.documentHelper.getFirstParagraphInFirstCell(block);\n                    var height = this.documentHelper.textHelper.getParagraphMarkSize(paragarph.characterFormat).Height;\n                    var rowHeight = block.childWidgets[0] instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableRowWidget ? block.childWidgets[0].height : 0;\n                    if (rowHeight > height) {\n                        height = rowHeight;\n                    }\n                    var width = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(block.getTableClientWidth(block.getContainerWidth()));\n                    if (!(this.clientArea.x > textWrappingBounds.right + minimumWidthRequired || this.clientArea.right < textWrappingBounds.x - minimumWidthRequired)) {\n                        if (this.isFloatingItemIntersect(block, rect, textWrappingBounds, textWrappingStyle, allowOverlap, height, width)) {\n                            if (rect.x >= textWrappingBounds.x && rect.x < textWrappingBounds.right) {\n                                rect.width = rect.width - (textWrappingBounds.right - rect.x);\n                                //checks minimum width\n                                if (rect.width < minimumWidthRequired || (rect.width < firstRowWidth && firstRowWidth > 0)) {\n                                    rect.width = this.clientActiveArea.right - textWrappingBounds.right;\n                                    //Check if the client active area width is lesser than table width to update the y position\n                                    if (rect.width < minimumWidthRequired || ((rect.width < firstRowWidth && firstRowWidth > 0) &&\n                                        this.clientArea.right <= firstRowWidth + textWrappingBounds.right)) {\n                                        //When the table y position is lesser than the text wrapping bottom position then \n                                        //difference of these two should be subtracted from the table client height instead of the floating item height.\n                                        var remainingHeightOfFloatingItem = (textWrappingBounds.bottom > rect.y) ? textWrappingBounds.bottom - rect.y : 0;\n                                        rect.y = textWrappingBounds.bottom;\n                                        rect.width = this.clientArea.width;\n                                        rect.height = rect.height - remainingHeightOfFloatingItem;\n                                        this.updateClientAreaForTextWrap(rect);\n                                    }\n                                    else {\n                                        rect.x = textWrappingBounds.right;\n                                        // if (textWrappingStyle == TextWrappingStyle.Through\n                                        //     && this.m_lcOperator.floatingItems[i].isDoesNotDenotesRectangle) {\n                                        //     textWrappingBounds = this.adjustTightAndThroughBounds(this.m_lcOperator.floatingItems[i], rect, size.height);\n                                        //     if (textWrappingBounds.x != 0)\n                                        //         rect.width = textWrappingBounds.x - rect.x;\n                                        // }\n                                        this.updateClientAreaForTextWrap(rect);\n                                    }\n                                }\n                                else {\n                                    rect.x = textWrappingBounds.right;\n                                    // if (textWrappingStyle == TextWrappingStyle.Through\n                                    //     && this.m_lcOperator.floatingItems[i].isDoesNotDenotesRectangle) {\n                                    //     textWrappingBounds = this.adjustTightAndThroughBounds(this.m_lcOperator.floatingItems[i], rect, size.height);\n                                    //     if (textWrappingBounds.x != 0)\n                                    //         rect.width = textWrappingBounds.x - rect.x;\n                                    // }\n                                    this.updateClientAreaForTextWrap(rect);\n                                }\n                            }\n                            // else if ((rect.right - textWrappingBounds.right) > 0\n                            //     && (rect.right - textWrappingBounds.right) < rect.width\n                            //     && (rect.y >= textWrappingBounds.y\n                            //         || (rect.y + size.height) >= textWrappingBounds.y)) {\n                            //     //If the table is intersect with  another floating item from the top ,then we need to consider distance from text with respect to relative margin position.\n                            //     if (rect.x < textWrappingBounds.x && rect.right > textWrappingBounds.x) {\n                            //         if (this.m_table.tableFormat.positioning.horizPositionAbs == HorizontalPosition.Left)\n                            //             rect.x += this.m_table.tableFormat.positioning.distanceFromLeft;\n                            //         else if (this.m_table.tableFormat.positioning.horizPositionAbs == HorizontalPosition.Right)\n                            //             rect.x -= this.m_table.tableFormat.positioning.distanceFromRight;\n                            //     }\n                            //     //When the table y position is lesser than the text wrapping bottom position then \n                            //     //difference of these two should be subtracted from the table client height instead of the floating item height.\n                            //     let remainingHeightOfFloatingItem = (textWrappingBounds.bottom > rect.y) ? textWrappingBounds.bottom - rect.y : 0;\n                            //     rect.y = textWrappingBounds.bottom;\n                            //     rect.height = rect.height - remainingHeightOfFloatingItem;\n                            //     this.createLayoutArea(rect);\n                            // }\n                            // else if (textWrappingBounds.x > rect.x && rect.right > textWrappingBounds.x) {\n                            //     rect.width = textWrappingBounds.x - rect.x;\n                            //     //checks minimum width\n                            //     if (rect.width < DEF_MIN_WIDTH || (rect.width < firstRowWidth && firstRowWidth > 0)) {\n                            //         rect.width = this.m_layoutArea.clientActiveArea.right - textWrappingBounds.right;\n                            //         if (rect.width < DEF_MIN_WIDTH || (rect.width < firstRowWidth && firstRowWidth > 0)) {\n                            //             //Check if the client active area width is greater than table width to update the x position\n                            //             if (this.m_layoutArea.clientArea.right < this.m_lcOperator.clientLayoutArea.right\n                            //                 && textWrappingBounds.right < this.m_lcOperator.clientLayoutArea.right\n                            //                 && this.m_lcOperator.clientLayoutArea.right - textWrappingBounds.right > DEF_MIN_WIDTH\n                            //                 && Math.round(this.m_layoutArea.clientActiveArea.width, 2) > Math.round(firstRowWidth, 2)) {\n                            //                 rect.width = this.m_lcOperator.clientLayoutArea.right - textWrappingBounds.right;\n                            //                 rect.x = textWrappingBounds.right;\n                            //                 if (textWrappingStyle == TextWrappingStyle.Through\n                            //                     && this.m_lcOperator.floatingItems[i].isDoesNotDenotesRectangle) {\n                            //                     textWrappingBounds = this.adjustTightAndThroughBounds(this.m_lcOperator.floatingItems[i], rect, size.height);\n                            //                     if (textWrappingBounds.x != 0)\n                            //                         rect.width = textWrappingBounds.x - rect.x;\n                            //                 }\n                            //             }\n                            //             else {\n                            //                 //When the table y position is lesser than the text wrapping bottom position then \n                            //                 //difference of these two should be subtracted from the table client height instead of the floating item height.\n                            //                 let remainingHeightOfFloatingItem = (textWrappingBounds.bottom > rect.y) ? textWrappingBounds.bottom - rect.y : 0;\n                            //                 rect.y = textWrappingBounds.bottom;\n                            //                 rect.height = rect.height - remainingHeightOfFloatingItem;\n                            //             }\n                            //             this.createLayoutArea(rect);\n                            //         }\n                            //     }\n                            //     else\n                            //         this.createLayoutArea(rect);\n                            // }\n                            // else if (rect.x > textWrappingBounds.x && rect.x > textWrappingBounds.right) {\n                            //     rect.width = this.m_layoutArea.clientArea.width;\n                            //     this.createLayoutArea(rect);\n                            // }\n                            // else if (rect.x > textWrappingBounds.x && rect.x < textWrappingBounds.right) {\n                            //     rect.width = rect.width - (textWrappingBounds.right - rect.x);\n                            //     rect.x = textWrappingBounds.right;\n                            //     if (textWrappingStyle == TextWrappingStyle.Through\n                            //         && this.m_lcOperator.floatingItems[i].isDoesNotDenotesRectangle) {\n                            //         textWrappingBounds = this.adjustTightAndThroughBounds(this.m_lcOperator.floatingItems[i], rect, size.height);\n                            //         if (textWrappingBounds.x != 0)\n                            //             rect.width = textWrappingBounds.x - rect.x;\n                            //     }\n                            //     this.createLayoutArea(rect);\n                            // }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    LayoutViewer.prototype.isFloatingItemIntersect = function (table, rect, textWrappingBounds, textWrappingStyle, allowOverlap, height, width) {\n        return ((Math.round(rect.y + height) >= Math.round(textWrappingBounds.y)\n            && Math.round(rect.y) < Math.round(textWrappingBounds.bottom))\n            //Checks whether the bottom of the table intersects with floating item.\n            || Math.round(rect.y + height) <= Math.round(textWrappingBounds.bottom)\n                && Math.round(rect.y + height) >= Math.round(textWrappingBounds.y))\n            && textWrappingStyle !== \"Inline\"\n            && textWrappingStyle !== \"TopAndBottom\"\n            && textWrappingStyle !== \"InFrontOfText\"\n            && textWrappingStyle !== \"Behind\"\n            && !(allowOverlap && (table.tableFormat !== null && table.wrapTextAround && table.positioning.allowOverlap));\n    };\n    LayoutViewer.prototype.getIntersectingItemBounds = function (floatingElements, intersectedfloatingItem, yPosition) {\n        var floatingItem = this.getMinBottomFloatingItem(floatingElements, this.getIntersectingFloatingItems(floatingElements, intersectedfloatingItem, yPosition));\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(floatingItem)) {\n            var floatingItemBound = this.getTextWrappingBound(floatingItem);\n            return floatingItemBound;\n        }\n        return undefined;\n    };\n    LayoutViewer.prototype.getMinBottomFloatingItem = function (floatingElements, fItems) {\n        var minBottomItemIndex = -1;\n        var minBottom = Number.MAX_VALUE;\n        var skippedCount = 0;\n        // Sort based on X position\n        floatingElements.sort(function (a, b) { return a.x - b.x; });\n        for (var i = 0; i < fItems.length; i++) {\n            var floatingItem = floatingElements[i];\n            var item = this.getTextWrappingBound(floatingItem);\n            if (minBottom > item.bottom) {\n                // Need to ignore if floating items preserved in same frame.\n                if (floatingItem && fItems.indexOf(floatingItem) + 1 < fItems.length) {\n                    skippedCount++;\n                }\n                else {\n                    minBottom = item.bottom;\n                    minBottomItemIndex = fItems.indexOf(floatingItem);\n                }\n            }\n        }\n        //If floating item which has minimum bottom is first item (no items preserved left side of this item).\n        //Then return current item Other cases need to handle.\n        return minBottomItemIndex - skippedCount == 0 ? fItems[minBottomItemIndex] : null;\n    };\n    LayoutViewer.prototype.getIntersectingFloatingItems = function (floatingElements, intersectedfloatingItem, yPosition) {\n        var fItems = [];\n        //Get all the items which preserved left side of the current floating item.\n        for (var i = 0; i < floatingElements.length; i++) {\n            {\n                var floatingItem = floatingElements[i];\n                var itemTextWrapBound = this.getTextWrappingBound(floatingItem);\n                var intersectItemTextWrapBound = this.getTextWrappingBound(intersectedfloatingItem);\n                if (yPosition <= itemTextWrapBound.bottom\n                    && intersectItemTextWrapBound.bottom >= itemTextWrapBound.bottom\n                    && itemTextWrapBound.right > this.clientActiveArea.x\n                    && itemTextWrapBound.x < intersectItemTextWrapBound.x)\n                    fItems.push(floatingItem);\n            }\n        }\n        return fItems;\n    };\n    LayoutViewer.prototype.getTextWrappingBound = function (floatingItem) {\n        var distanceLeft = 0;\n        var distanceTop = 0;\n        var distanceRight = 0;\n        var distanceBottom = 0;\n        var width = 0;\n        if (floatingItem instanceof _page__WEBPACK_IMPORTED_MODULE_7__.ShapeBase) {\n            distanceLeft = floatingItem.distanceLeft;\n            distanceTop = floatingItem.distanceTop;\n            distanceRight = floatingItem.distanceRight;\n            distanceBottom = floatingItem.distanceBottom;\n            width = floatingItem.width;\n        }\n        else {\n            width = floatingItem.getTableCellWidth();\n            distanceLeft = floatingItem.positioning.distanceLeft;\n            distanceTop = floatingItem.positioning.distanceTop;\n            distanceRight = floatingItem.positioning.distanceRight;\n            distanceBottom = floatingItem.positioning.distanceBottom;\n        }\n        var textWrappingBounds = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(floatingItem.x - distanceLeft, floatingItem.y - distanceTop, width + distanceLeft + distanceRight, floatingItem.height + distanceTop + distanceBottom);\n        return textWrappingBounds;\n    };\n    LayoutViewer.prototype.tableAlignmentForBidi = function (block, bidi) {\n        var tableAlignment = block.tableFormat.tableAlignment;\n        if (bidi) {\n            if (tableAlignment === 'Left') {\n                tableAlignment = 'Right';\n            }\n            else if (tableAlignment === 'Right') {\n                tableAlignment = 'Left';\n            }\n        }\n        return tableAlignment;\n    };\n    LayoutViewer.prototype.cutFromLeft = function (x) {\n        if (x < this.clientActiveArea.x) {\n            x = this.clientActiveArea.x;\n        }\n        if (x > this.clientActiveArea.right && this.textWrap) {\n            x = this.clientActiveArea.right;\n        }\n        this.clientActiveArea.width = this.clientActiveArea.right > x ? this.clientActiveArea.right - x : 0;\n        this.clientActiveArea.x = x;\n    };\n    LayoutViewer.prototype.cutFromTop = function (y) {\n        if (y < this.clientActiveArea.y) {\n            y = this.clientActiveArea.y;\n        }\n        if (y > this.clientActiveArea.bottom) {\n            y = this.clientActiveArea.bottom;\n        }\n        this.clientActiveArea.height = this.clientActiveArea.bottom - y;\n        this.clientActiveArea.x = this.clientArea.x;\n        this.clientActiveArea.width = this.clientArea.width;\n        this.clientActiveArea.y = y;\n    };\n    LayoutViewer.prototype.updateClientWidth = function (width) {\n        this.clientActiveArea.x -= width;\n        if (this.clientActiveArea.width + width > 0) {\n            this.clientActiveArea.width += width;\n        }\n        else {\n            this.clientActiveArea.width = 0;\n        }\n    };\n    LayoutViewer.prototype.findFocusedPage = function (currentPoint, updateCurrentPage, updateHeaderFooterPage) {\n        var point = new _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.Point(currentPoint.x, currentPoint.y);\n        point.x += this.documentHelper.viewerContainer.scrollLeft;\n        point.y += this.documentHelper.viewerContainer.scrollTop;\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            var page = this.documentHelper.pages[i];\n            var pageTop = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.documentHelper.zoomFactor + this.pageGap * (i + 1);\n            var pageHeight = (page.boundingRectangle.height * this.documentHelper.zoomFactor) + this.pageGap;\n            var pageLeft = page.boundingRectangle.x;\n            var pageRight = void 0;\n            if (this instanceof PageLayoutViewer) {\n                pageRight = ((page.boundingRectangle.right - pageLeft) * this.documentHelper.zoomFactor) + pageLeft;\n            }\n            else {\n                pageRight = page.boundingRectangle.right + pageLeft;\n            }\n            if (pageTop <= point.y && pageTop + pageHeight >= point.y) {\n                if (updateCurrentPage) {\n                    this.documentHelper.currentPage = page;\n                    if (updateHeaderFooterPage) {\n                        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(page.headerWidget)) {\n                            page.headerWidget.page = page;\n                        }\n                        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(page.footerWidget)) {\n                            page.footerWidget.page = page;\n                        }\n                    }\n                }\n                point.y = (point.y - (pageTop)) / this.documentHelper.zoomFactor;\n                if (point.x > pageRight) {\n                    point.x = page.boundingRectangle.right;\n                }\n                else if (point.x < pageLeft) {\n                    point.x = 0;\n                }\n                else {\n                    point.x = (point.x - pageLeft) / this.documentHelper.zoomFactor;\n                }\n                return point;\n            }\n        }\n        return point;\n    };\n    LayoutViewer.prototype.getPageHeightAndWidth = function (height, width, viewerWidth, viewerHeight) {\n        height = 0;\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            height = height + this.documentHelper.pages[i].boundingRectangle.height;\n        }\n        width = 0;\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            if (width < this.documentHelper.pages[i].boundingRectangle.width) {\n                width = this.documentHelper.pages[i].boundingRectangle.width;\n            }\n        }\n        //this.documentHelper.visibleBoundsIn = new Rect(0, 0, width, height);\n        viewerWidth = this.documentHelper.visibleBounds.width;\n        viewerHeight = this.documentHelper.visibleBounds.height;\n        return {\n            'height': height,\n            'width': width,\n            'viewerWidth': viewerWidth,\n            'viewerHeight': viewerHeight\n        };\n    };\n    LayoutViewer.prototype.renderVisiblePages = function () {\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.visiblePages) || this.visiblePages.length < 1) {\n            return;\n        }\n        this.documentHelper.clearContent();\n        for (var i = 0; i < this.visiblePages.length; i++) {\n            var page = this.visiblePages[i];\n            var width = page.boundingRectangle.width * this.documentHelper.zoomFactor;\n            var height = page.boundingRectangle.height * this.documentHelper.zoomFactor;\n            var x = page.boundingRectangle.x;\n            var y = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.documentHelper.zoomFactor + this.pageGap * (i + 1);\n            this.owner.viewer.renderPage(page, x, y, width, height);\n        }\n    };\n    /* eslint-disable  */\n    LayoutViewer.prototype.handleZoom = function () {\n        var prevScaleFactor = this.documentHelper.preZoomFactor;\n        var page = null;\n        var verticalHeight = 0;\n        var scrollToPosition = false;\n        if (this.documentHelper.selection && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.documentHelper.zoomX && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.documentHelper.zoomY))) {\n            var x = 0;\n            var y = 0;\n            var endPage = this.documentHelper.selection.getPage(this.documentHelper.selection.end.currentWidget.paragraph);\n            x = (this.documentHelper.visibleBounds.width - endPage.boundingRectangle.width * prevScaleFactor) / 2;\n            if (x < 30) {\n                x = 30;\n            }\n            y = endPage.boundingRectangle.y * prevScaleFactor + (this.documentHelper.pages.indexOf(endPage) + 1) * this.pageGap * (1 - prevScaleFactor);\n            var caretInfo = this.documentHelper.selection.updateCaretSize(this.owner.selectionModule.end, true);\n            var topMargin = caretInfo.topMargin;\n            var caretHeight = caretInfo.height;\n            x += (this.documentHelper.selection.end.location.x) * prevScaleFactor;\n            y += (this.documentHelper.selection.end.location.y + topMargin) * prevScaleFactor;\n            if (x >= this.containerLeft && x <= this.documentHelper.visibleBounds.width &&\n                y >= this.containerTop && y <= this.containerTop + this.documentHelper.visibleBounds.height) {\n                scrollToPosition = true;\n            }\n        }\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            verticalHeight = verticalHeight + this.documentHelper.pages[i].boundingRectangle.height;\n        }\n        var horizontalWidth = 0;\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            if (horizontalWidth < this.documentHelper.pages[i].boundingRectangle.width) {\n                horizontalWidth = this.documentHelper.pages[i].boundingRectangle.width;\n            }\n        }\n        var height = (verticalHeight * this.documentHelper.zoomFactor + (this.documentHelper.pages.length + 1) * this.pageGap * (1 - this.documentHelper.zoomFactor)) - this.documentHelper.visibleBounds.height;\n        var horWidth = horizontalWidth * this.documentHelper.zoomFactor - this.documentHelper.visibleBounds.width;\n        if (this.documentHelper.visibleBounds.width - horizontalWidth * this.documentHelper.zoomFactor < 60) {\n            horWidth += 60;\n        }\n        //Update Vertical Scroll bar\n        if (height > 0) {\n            var value = this.containerTop;\n            if (this.visiblePages.length > 0) {\n                page = this.visiblePages[0];\n                var prevPageTop = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * prevScaleFactor + (page.index + 1) * this.pageGap;\n                var zoomY = this.documentHelper.zoomY;\n                if (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined) {\n                    zoomY = this.documentHelper.visibleBounds.height / 2;\n                }\n                var prevY = value + zoomY;\n                while (prevY > prevPageTop + (page.boundingRectangle.height * prevScaleFactor)) {\n                    var pageIndex = page.index + 1;\n                    if (pageIndex === this.documentHelper.pages.length) {\n                        break;\n                    }\n                    page = this.documentHelper.pages[pageIndex];\n                    prevPageTop = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * prevScaleFactor + (page.index + 1) * this.pageGap;\n                }\n                var currentY = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * this.documentHelper.zoomFactor + (page.index + 1) * this.pageGap\n                    + ((prevY - prevPageTop) < 0 ? prevY - prevPageTop : (prevY - prevPageTop) * (this.documentHelper.zoomFactor / prevScaleFactor));\n                value = currentY - zoomY;\n                zoomY = this.documentHelper.visibleBounds.height / 2;\n            }\n            this.documentHelper.viewerContainer.scrollTop = value;\n        }\n        else {\n            this.documentHelper.viewerContainer.scrollTop = 0;\n        }\n        // update Horizontal Scroll Bar\n        if (horWidth > 0) {\n            var value = this.containerLeft;\n            if (this.visiblePages.length > 0) {\n                if (page === null) {\n                    page = this.visiblePages[0];\n                }\n                var zoomX = this.documentHelper.zoomX;\n                if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(zoomX)) {\n                    zoomX = this.documentHelper.visibleBounds.width / 2;\n                }\n                var prevValue = (page.boundingRectangle.width * prevScaleFactor) / page.boundingRectangle.width;\n                var prevX = value + zoomX;\n                var currentX = page.boundingRectangle.x\n                    + ((prevX - page.boundingRectangle.x) < 0 ? prevX - page.boundingRectangle.x : (prevX - page.boundingRectangle.x) * (this.documentHelper.zoomFactor / prevValue));\n                value = currentX - zoomX;\n                zoomX = this.documentHelper.visibleBounds.width / 2;\n            }\n            this.documentHelper.viewerContainer.scrollLeft = value;\n        }\n        else {\n            this.documentHelper.viewerContainer.scrollLeft = 0;\n        }\n        this.updateScrollBars();\n        if (scrollToPosition) {\n            this.documentHelper.scrollToPosition(this.documentHelper.selection.start, this.documentHelper.selection.end);\n        }\n        if (this instanceof WebLayoutViewer) {\n            this.owner.editorModule.layoutWholeDocument();\n        }\n    };\n    LayoutViewer.prototype.updateCanvasWidthAndHeight = function (viewerWidth, viewerHeight, containerHeight, containerWidth, width, height) {\n        if (this instanceof PageLayoutViewer) {\n            if (this.documentHelper.visibleBounds.width !== this.documentHelper.viewerContainer.clientWidth) {\n                viewerWidth -= (this.documentHelper.visibleBounds.width - this.documentHelper.viewerContainer.clientWidth);\n            }\n            else if (containerHeight > viewerHeight) {\n                viewerWidth -= this.documentHelper.viewerContainer.offsetWidth - this.documentHelper.viewerContainer.clientWidth;\n            }\n        }\n        else {\n            if (containerHeight > viewerHeight) {\n                viewerWidth -= this.documentHelper.scrollbarWidth;\n                containerWidth -= this.documentHelper.scrollbarWidth;\n            }\n        }\n        if (containerWidth > viewerWidth) {\n            viewerHeight -= this.documentHelper.scrollbarWidth;\n        }\n        width = containerWidth > viewerWidth ? containerWidth : viewerWidth;\n        height = containerHeight > viewerHeight ? containerHeight : viewerHeight;\n        if (parseInt(this.documentHelper.pageContainer.style.width.replace('px', ''), 10) !== width ||\n            parseInt(this.documentHelper.pageContainer.style.height.replace('px', ''), 10) !== width) {\n            this.documentHelper.pageContainer.style.width = width.toString() + 'px';\n            this.documentHelper.pageContainer.style.height = height.toString() + 'px';\n        }\n        // if (!isNullOrUndefined(this.selection) && !this.selection.isEmpty) {\n        //     this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n        var displayPixelRatio = Math.max(1, window.devicePixelRatio || 1);\n        if (this.documentHelper.containerCanvas.width !== Math.floor(viewerWidth * displayPixelRatio)\n            || this.documentHelper.containerCanvas.height !== Math.floor(viewerHeight * displayPixelRatio)) {\n            this.documentHelper.containerCanvas.width = viewerWidth * displayPixelRatio;\n            this.documentHelper.containerCanvas.height = viewerHeight * displayPixelRatio;\n            this.documentHelper.containerCanvas.style.width = viewerWidth + 'px';\n            this.documentHelper.containerCanvas.style.height = viewerHeight + 'px';\n            this.documentHelper.containerContext.scale(displayPixelRatio, displayPixelRatio);\n            this.documentHelper.selectionCanvas.width = viewerWidth * displayPixelRatio;\n            this.documentHelper.selectionCanvas.height = viewerHeight * displayPixelRatio;\n            this.documentHelper.selectionCanvas.style.width = viewerWidth + 'px';\n            this.documentHelper.selectionCanvas.style.height = viewerHeight + 'px';\n            this.documentHelper.selectionContext.scale(displayPixelRatio, displayPixelRatio);\n        }\n        return {\n            'height': height,\n            'width': width,\n            'viewerWidth': viewerWidth,\n            'viewerHeight': viewerHeight,\n            'containerHeight': containerHeight,\n            'containerWidth': containerWidth\n        };\n    };\n    LayoutViewer.prototype.updateScrollBarPosition = function (containerWidth, containerHeight, viewerWidth, viewerHeight, width, height) {\n        this.owner.viewer.containerTop = this.documentHelper.viewerContainer.scrollTop;\n        this.owner.viewer.containerWidth = containerWidth;\n        this.documentHelper.containerCanvas.style.position = 'absolute';\n        this.documentHelper.containerCanvas.style.top = this.owner.viewer.containerTop.toString() + 'px';\n        this.documentHelper.selectionCanvas.style.position = 'absolute';\n        this.documentHelper.selectionCanvas.style.top = this.owner.viewer.containerTop.toString() + 'px';\n        this.owner.viewer.containerLeft = this.documentHelper.viewerContainer.scrollLeft;\n        this.documentHelper.containerCanvas.style.left = this.owner.viewer.containerLeft + 'px';\n        this.documentHelper.selectionCanvas.style.left = this.owner.viewer.containerLeft + 'px';\n    };\n    LayoutViewer.prototype.destroy = function () {\n        this.clientArea = undefined;\n        this.clientActiveArea = undefined;\n    };\n    /**\n     * Disposes the internal objects which are maintained.\n     * @private\n     */\n    LayoutViewer.prototype.componentDestroy = function () {\n        this.clientArea = undefined;\n        this.clientActiveArea = undefined;\n        this.owner = undefined;\n    };\n    return LayoutViewer;\n}());\n\n/**\n * @private\n */\nvar PageLayoutViewer = /** @class */ (function (_super) {\n    __extends(PageLayoutViewer, _super);\n    /**\n     * Initialize the constructor of PageLayoutViewer\n     */\n    function PageLayoutViewer(owner) {\n        var _this = _super.call(this, owner) || this;\n        _this.pageLeft = 30;\n        // if (isNullOrUndefined(owner) || isNullOrUndefined(owner.element)) {\n        //     return;\n        // }\n        _this.owner = owner;\n        return _this;\n    }\n    Object.defineProperty(PageLayoutViewer.prototype, \"pageGap\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.pageGap;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageLayoutViewer.prototype, \"documentHelper\", {\n        get: function () {\n            return this.owner.documentHelper;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    PageLayoutViewer.prototype.createNewPage = function (section, index) {\n        var viewer = this;\n        var yPos = this.pageGap;\n        if (this.documentHelper.pages.length > 0) {\n            yPos = this.documentHelper.pages[this.documentHelper.pages.length - 1].boundingRectangle.bottom + this.pageGap;\n        }\n        var page = new _page__WEBPACK_IMPORTED_MODULE_7__.Page(this.documentHelper);\n        this.updatePageBoundingRectangle(section, page, yPos);\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(index)) {\n            this.documentHelper.pages.push(page);\n        }\n        else {\n            this.documentHelper.pages.splice(index, 0, page);\n        }\n        page.bodyWidgets.push(section);\n        page.bodyWidgets[page.bodyWidgets.length - 1].page = page;\n        this.updateClientArea(section, page);\n        this.documentHelper.layout.layoutHeaderFooter(section, viewer, page);\n        this.updateClientArea(section, page);\n        this.documentHelper.layout.footnoteHeight = 0;\n        return page;\n    };\n    PageLayoutViewer.prototype.updatePageBoundingRectangle = function (section, page, yPosition) {\n        //page.viewer = this;\n        var pageWidth = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(section.sectionFormat) ? _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(section.sectionFormat.pageWidth) : 816;\n        var pageHeight = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(section.sectionFormat) ? _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(section.sectionFormat.pageHeight) : 1056;\n        var xPos = (this.documentHelper.visibleBounds.width - pageWidth * this.documentHelper.zoomFactor) / 2;\n        if (xPos < this.pageLeft) {\n            xPos = this.pageLeft;\n        }\n        page.boundingRectangle = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(xPos, yPosition, pageWidth, pageHeight);\n    };\n    PageLayoutViewer.prototype.onPageFitTypeChanged = function (pageFitType) {\n        var width = this.documentHelper.visibleBounds.width;\n        var height = this.documentHelper.visibleBounds.height;\n        var section = this.visiblePages[0].bodyWidgets[0];\n        var pageWidth = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(section.sectionFormat.pageWidth);\n        var pageHeight = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(section.sectionFormat.pageHeight);\n        switch (pageFitType) {\n            case 'FitOnePage':\n                if (height > 0 && pageHeight > 0) {\n                    var zoomFactor = (this.documentHelper.visibleBounds.height - 2 * this.pageGap - (this.pageGap - 2)) / pageHeight;\n                    if (zoomFactor === this.documentHelper.zoomFactor) {\n                        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner.selectionModule) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner.selectionModule.start) &&\n                            !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner.selectionModule.end)) {\n                            this.documentHelper.scrollToPosition(this.owner.selectionModule.start, this.owner.selectionModule.end);\n                        }\n                    }\n                    else {\n                        this.documentHelper.zoomFactor = zoomFactor;\n                    }\n                }\n                break;\n            case 'FitPageWidth':\n                if (width > 0 && pageWidth > 0) {\n                    this.documentHelper.zoomFactor = (this.documentHelper.visibleBounds.width - 80) / pageWidth;\n                }\n                break;\n            default:\n                this.documentHelper.zoomFactor = 100 / 100;\n                break;\n        }\n    };\n    PageLayoutViewer.prototype.getCurrentPageHeaderFooter = function (section, isHeader) {\n        return this.getCurrentHeaderFooter(this.getHeaderFooterType(section, isHeader), section.index);\n    };\n    PageLayoutViewer.prototype.getHeaderFooterType = function (section, isHeader) {\n        var type;\n        type = isHeader ? 'OddHeader' : 'OddFooter';\n        var page = section.page;\n        if (section.sectionFormat.differentFirstPage && ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(page.previousPage) || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(page.previousPage) && page.sectionIndex !== page.previousPage.sectionIndex && page.previousPage.bodyWidgets[page.previousPage.bodyWidgets.length - 1].sectionIndex !== page.bodyWidgets[0].sectionIndex))) {\n            type = isHeader ? 'FirstPageHeader' : 'FirstPageFooter';\n        }\n        else if (section.sectionFormat.differentOddAndEvenPages && (page.index + 1) % 2 === 0) {\n            type = isHeader ? 'EvenHeader' : 'EvenFooter';\n        }\n        return type;\n    };\n    PageLayoutViewer.prototype.getCurrentHeaderFooter = function (type, sectionIndex) {\n        if (this.documentHelper.headersFooters[sectionIndex]) {\n            var index = this.getHeaderFooter(type);\n            var headerFooter = this.documentHelper.headersFooters[sectionIndex][index];\n            if (!headerFooter) {\n                var currentSecIndex = sectionIndex > 0 ? sectionIndex - 1 : sectionIndex;\n                while (!headerFooter && currentSecIndex !== -1) {\n                    headerFooter = this.documentHelper.headersFooters[currentSecIndex][index];\n                    currentSecIndex--;\n                }\n                if (!headerFooter) {\n                    headerFooter = this.createHeaderFooterWidget(type);\n                    headerFooter.isEmpty = true;\n                }\n                if (sectionIndex == 0) {\n                    this.documentHelper.headersFooters[sectionIndex][index] = headerFooter;\n                }\n            }\n            return headerFooter;\n        }\n        else if (sectionIndex > 0) {\n            return this.getCurrentHeaderFooter(type, sectionIndex - 1);\n        }\n        return undefined;\n    };\n    PageLayoutViewer.prototype.createHeaderFooterWidget = function (type) {\n        var headerFooter = new _page__WEBPACK_IMPORTED_MODULE_7__.HeaderFooterWidget(type);\n        var paragraph = new _page__WEBPACK_IMPORTED_MODULE_7__.ParagraphWidget();\n        paragraph.childWidgets.push(new _page__WEBPACK_IMPORTED_MODULE_7__.LineWidget(paragraph));\n        var style;\n        if (type.indexOf('Header') !== -1) {\n            style = this.documentHelper.styles.findByName('Header');\n        }\n        else {\n            style = this.documentHelper.styles.findByName('Footer');\n        }\n        paragraph.paragraphFormat.baseStyle = style;\n        paragraph.paragraphFormat.listFormat.baseStyle = style;\n        headerFooter.childWidgets.push(paragraph);\n        paragraph.containerWidget = headerFooter;\n        return headerFooter;\n    };\n    PageLayoutViewer.prototype.getHeaderFooter = function (type) {\n        switch (type) {\n            case 'OddHeader':\n                return 0;\n            case 'OddFooter':\n                return 1;\n            case 'EvenHeader':\n                return 2;\n            case 'EvenFooter':\n                return 3;\n            case 'FirstPageHeader':\n                return 4;\n            case 'FirstPageFooter':\n                return 5;\n        }\n    };\n    PageLayoutViewer.prototype.updateHFClientArea = function (sectionFormat, isHeader) {\n        var width = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n        if (width < 0) {\n            width = 0;\n        }\n        if (isHeader) {\n            this.clientArea = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(_editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(sectionFormat.leftMargin), _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(sectionFormat.headerDistance), width, Number.POSITIVE_INFINITY);\n        }\n        else {\n            this.clientArea = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(_editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(sectionFormat.leftMargin), _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(sectionFormat.pageHeight - sectionFormat.footerDistance), width, Number.POSITIVE_INFINITY);\n        }\n        this.clientActiveArea = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n    };\n    PageLayoutViewer.prototype.updateHeaderFooterClientAreaWithTop = function (sectionFormat, isHeader, page) {\n        this.updateHFClientArea(sectionFormat, isHeader);\n        if (!isHeader) {\n            if (page.footerWidget.y < this.clientActiveArea.y) {\n                this.clientActiveArea.y = page.footerWidget.y;\n                this.clientActiveArea.height = Number.POSITIVE_INFINITY;\n            }\n        }\n    };\n    PageLayoutViewer.prototype.updateFootnoteClientArea = function (sectionFormat, footnote, footNoteType, para) {\n        var width = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n        var left = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(sectionFormat.leftMargin);\n        var bottomMargin = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(sectionFormat.bottomMargin);\n        var footerDistance = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(sectionFormat.footerDistance);\n        var top = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(sectionFormat.pageHeight) - Math.max(footerDistance + footnote.page.footerWidget.height, bottomMargin);\n        this.clientArea = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(left, top, width, Number.POSITIVE_INFINITY);\n        this.clientActiveArea = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, Number.POSITIVE_INFINITY);\n    };\n    PageLayoutViewer.prototype.scrollToPage = function (pageIndex) {\n        var top = 0;\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            top = (this.documentHelper.pages[i].boundingRectangle.y * (this.documentHelper.zoomFactor > 1 ? this.documentHelper.zoomFactor : 1)) - (this.pageGap / 2);\n            if (i === pageIndex) {\n                break;\n            }\n        }\n        this.documentHelper.viewerContainer.scrollTop = top;\n        this.updateScrollBars();\n    };\n    PageLayoutViewer.prototype.updateScrollBars = function () {\n        var updatePositionObj;\n        updatePositionObj = this.getPageHeightAndWidth(0, 0, 0, 0);\n        var containerWidth = (updatePositionObj.width * this.documentHelper.zoomFactor) + (this.pageLeft * 2);\n        var containerHeight = (updatePositionObj.height * this.documentHelper.zoomFactor) + (this.documentHelper.pages.length + 1) * this.pageGap;\n        var updateObj;\n        updateObj = this.updateCanvasWidthAndHeight(updatePositionObj.viewerWidth, updatePositionObj.viewerHeight, containerHeight, containerWidth, updatePositionObj.width, updatePositionObj.height);\n        containerHeight = updateObj.containerHeight;\n        containerWidth = updateObj.containerWidth;\n        this.documentHelper.containerContext.globalAlpha = 1;\n        this.documentHelper.selectionContext.globalAlpha = 0.4;\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            var left = (updateObj.width - this.documentHelper.pages[i].boundingRectangle.width * this.documentHelper.zoomFactor) / 2;\n            if (left > this.pageLeft) {\n                this.documentHelper.pages[i].boundingRectangle = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(left, this.documentHelper.pages[i].boundingRectangle.y, this.documentHelper.pages[i].boundingRectangle.width, this.documentHelper.pages[i].boundingRectangle.height);\n            }\n            else {\n                this.documentHelper.pages[i].boundingRectangle = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(this.pageLeft, this.documentHelper.pages[i].boundingRectangle.y, this.documentHelper.pages[i].boundingRectangle.width, this.documentHelper.pages[i].boundingRectangle.height);\n            }\n        }\n        this.updateScrollBarPosition(containerWidth, containerHeight, updateObj.viewerWidth, updateObj.viewerHeight, updateObj.width, updateObj.height);\n        this.updateVisiblePages();\n        this.documentHelper.isScrollToSpellCheck = false;\n    };\n    PageLayoutViewer.prototype.updateVisiblePages = function () {\n        // Clears the container first.\n        this.visiblePages = [];\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            var page = this.documentHelper.pages[i];\n            var y = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.documentHelper.zoomFactor + this.pageGap * (i + 1);\n            var left = page.boundingRectangle.x;\n            //UI Virtualization\n            if (this.documentHelper.isPageInVisibleBound(page, y)) {\n                this.addVisiblePage(page, left, y);\n            }\n        }\n    };\n    PageLayoutViewer.prototype.addVisiblePage = function (page, x, y) {\n        var _this = this;\n        var width = page.boundingRectangle.width * this.documentHelper.zoomFactor;\n        var height = page.boundingRectangle.height * this.documentHelper.zoomFactor;\n        if (this.owner.enableImageResizerMode && this.owner.imageResizerModule.currentPage !== undefined && this.owner.imageResizerModule.currentPage === page && this.owner.imageResizerModule.isImageResizerVisible) {\n            this.owner.imageResizerModule.setImageResizerPositions(x, y, width, height);\n        }\n        var pictureElement = document.getElementById(this.owner.element.id + 'PICTURE_CONTENT_CONTROL');\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(pictureElement) && pictureElement.style.display !== 'none') {\n            this.owner.setPictureContentControlPositions(pictureElement);\n        }\n        this.visiblePages.push(page);\n        if (this.documentHelper.owner.isSpellCheck && this.documentHelper.owner.spellCheckerModule.enableOptimizedSpellCheck && (this.owner.documentHelper.triggerElementsOnLoading || this.owner.documentHelper.isScrollHandler) && (this.documentHelper.cachedPages.indexOf(page.index) < 0 || this.owner.editorModule.isPasteContentCheck)) {\n            this.owner.documentHelper.cachedPages.push(page.index);\n            var content = void 0;\n            if (this.owner.editorModule.isPasteContentCheck) {\n                content = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner.editorModule.copiedTextContent) ? this.owner.editorModule.copiedTextContent : '';\n            }\n            else {\n                content = this.documentHelper.owner.spellCheckerModule.getPageContent(page);\n            }\n            if (content.trim().length > 0) {\n                page.allowNextPageRendering = false;\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner.spellCheckerModule)) {\n                    this.owner.spellCheckerModule.updateUniqueWords(_editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.getSpellCheckData(content));\n                }\n                /* eslint-disable @typescript-eslint/no-explicit-any */\n                this.owner.spellCheckerModule.callSpellChecker(this.owner.spellCheckerModule.languageID, content, true, false, false, true).then(function (data) {\n                    /* eslint-disable @typescript-eslint/no-explicit-any */\n                    var jsonObject = JSON.parse(data);\n                    if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner)) {\n                        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner.spellCheckerModule)) {\n                            _this.owner.spellCheckerModule.updateUniqueWords(jsonObject.SpellCollection);\n                        }\n                        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(page)) {\n                            page.allowNextPageRendering = true;\n                        }\n                        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.documentHelper)) {\n                            _this.documentHelper.triggerElementsOnLoading = true;\n                            _this.documentHelper.triggerSpellCheck = true;\n                            _this.documentHelper.triggerElementsOnLoading = true;\n                            _this.renderPage(page, x, y, width, height);\n                            _this.documentHelper.triggerSpellCheck = false;\n                            _this.documentHelper.triggerElementsOnLoading = false;\n                        }\n                    }\n                })\n                    .catch();\n                {\n                    if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(page)) {\n                        page.allowNextPageRendering = true;\n                    }\n                }\n            }\n            else {\n                this.renderPage(page, x, y, width, height);\n            }\n        }\n        else {\n            this.renderPage(page, x, y, width, height);\n        }\n    };\n    PageLayoutViewer.prototype.renderPage = function (page, x, y, width, height) {\n        this.documentHelper.render.renderWidgets(page, x - this.owner.viewer.containerLeft, y - this.owner.viewer.containerTop, width, height);\n    };\n    return PageLayoutViewer;\n}(LayoutViewer));\n\nvar WebLayoutViewer = /** @class */ (function (_super) {\n    __extends(WebLayoutViewer, _super);\n    function WebLayoutViewer(owner) {\n        var _this = _super.call(this, owner) || this;\n        /**\n         * @private\n         */\n        _this.visiblePages = [];\n        /* if (isNullOrUndefined(owner) || isNullOrUndefined(owner.element)) {\n             return;\n         }*/\n        _this.owner = owner;\n        return _this;\n    }\n    Object.defineProperty(WebLayoutViewer.prototype, \"documentHelper\", {\n        get: function () {\n            try {\n                return this.owner.documentHelper;\n            }\n            catch (_a) {\n                return undefined;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WebLayoutViewer.prototype, \"pageGap\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Creates new page.\n     * @private\n     */\n    WebLayoutViewer.prototype.createNewPage = function (section, index) {\n        var page;\n        var yPos = 0;\n        var x = 10;\n        if (this.documentHelper.pages.length > 0) {\n            yPos = this.documentHelper.pages[this.documentHelper.pages.length - 1].boundingRectangle.bottom;\n        }\n        page = new _page__WEBPACK_IMPORTED_MODULE_7__.Page(this.documentHelper);\n        if (this.documentHelper.pages.length === 0) {\n            page.boundingRectangle = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(x, yPos, this.documentHelper.visibleBounds.width, this.documentHelper.visibleBounds.height);\n        }\n        else {\n            page.boundingRectangle = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(x, yPos - 20, this.documentHelper.visibleBounds.width, this.documentHelper.visibleBounds.height);\n        }\n        this.documentHelper.pages.push(page);\n        this.updateClientArea(undefined, page);\n        page.bodyWidgets.push(section);\n        page.bodyWidgets[page.bodyWidgets.length - 1].page = page;\n        return page;\n    };\n    WebLayoutViewer.prototype.onPageFitTypeChanged = function (pageFitType) {\n        this.documentHelper.zoomFactor = 1;\n    };\n    WebLayoutViewer.prototype.scrollToPage = function (pageIndex) {\n        this.updateScrollBars();\n    };\n    WebLayoutViewer.prototype.getContentHeight = function () {\n        var height = 0;\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            var page = this.documentHelper.pages[i];\n            if (i === 0) {\n                height += this.padding.top;\n                page.boundingRectangle.y = this.padding.top;\n            }\n            else {\n                page.boundingRectangle.y = this.documentHelper.pages[i - 1].boundingRectangle.bottom;\n            }\n            page.boundingRectangle.height = page.bodyWidgets[0].height;\n            height += page.bodyWidgets[0].height;\n            if (i === this.documentHelper.pages.length - 1) {\n                height += this.padding.bottom;\n            }\n        }\n        return height;\n    };\n    /**\n     * @private\n     */\n    WebLayoutViewer.prototype.getContentWidth = function () {\n        var width = this.documentHelper.visibleBounds.width;\n        var currentWidth = width;\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            var page = this.documentHelper.pages[i];\n            for (var j = 0; j < page.bodyWidgets[0].childWidgets.length; j++) {\n                if (page.bodyWidgets[0].childWidgets[j] instanceof _page__WEBPACK_IMPORTED_MODULE_7__.TableWidget) {\n                    var tableWidget = page.bodyWidgets[0].childWidgets[j];\n                    var tableWidth = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(tableWidget.getTableWidth()) *\n                        this.documentHelper.zoomFactor + this.padding.left * 4 + this.padding.right * 4\n                        + page.boundingRectangle.x;\n                    if (currentWidth < tableWidth) {\n                        width = tableWidth;\n                        currentWidth = tableWidth;\n                    }\n                }\n            }\n            page.boundingRectangle.width = width;\n        }\n        return width;\n    };\n    WebLayoutViewer.prototype.updateScrollBars = function () {\n        var updatePositionObj;\n        updatePositionObj = this.getPageHeightAndWidth(0, 0, 0, 0);\n        var containerWidth = this.getContentWidth() * this.documentHelper.zoomFactor;\n        var containerHeight = this.getContentHeight() * this.documentHelper.zoomFactor + this.padding.top + this.padding.bottom;\n        var updateObj;\n        updateObj = this.updateCanvasWidthAndHeight(updatePositionObj.viewerWidth, updatePositionObj.viewerHeight, containerHeight, containerWidth, updatePositionObj.width, updatePositionObj.height);\n        this.documentHelper.containerContext.globalAlpha = 1;\n        this.documentHelper.selectionContext.globalAlpha = 0.4;\n        this.updateScrollBarPosition(containerWidth, containerHeight, updateObj.viewerWidth, updateObj.viewerHeight, updateObj.width, updateObj.height);\n        this.updateVisiblePages();\n        this.documentHelper.isScrollToSpellCheck = false;\n    };\n    WebLayoutViewer.prototype.updateVisiblePages = function () {\n        this.visiblePages = [];\n        var page;\n        var y;\n        var height = this.documentHelper.visibleBounds.height;\n        var vertical = this.documentHelper.viewerContainer.scrollTop;\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            page = this.documentHelper.pages[i];\n            y = (page.boundingRectangle.y) * this.documentHelper.zoomFactor;\n            var pageH = page.boundingRectangle.height * this.documentHelper.zoomFactor;\n            var isTopFit = y >= vertical && y <= vertical + height;\n            var isBottomFit = y + pageH >= vertical && y + pageH <= vertical + height;\n            var isMiddleFit = y <= vertical && y + pageH >= vertical + height;\n            //UI Virtualization\n            if (isTopFit || isBottomFit || isMiddleFit) {\n                this.addVisiblePage(page, this.padding.left, y);\n            }\n        }\n    };\n    WebLayoutViewer.prototype.addVisiblePage = function (page, x, y) {\n        var _this = this;\n        var width = this.getContentWidth();\n        var height = this.getContentHeight() * this.documentHelper.zoomFactor + this.padding.top + this.padding.bottom;\n        if (this.owner.enableImageResizerMode && this.owner.imageResizerModule.currentPage !== undefined && this.owner.imageResizerModule.currentPage === page && this.owner.imageResizerModule.isImageResizerVisible) {\n            this.owner.imageResizerModule.setImageResizerPositions(x, y, width, height);\n        }\n        var pictureElement = document.getElementById(this.owner.element.id + 'PICTURE_CONTENT_CONTROL');\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(pictureElement) && pictureElement.style.display !== 'none') {\n            this.owner.setPictureContentControlPositions(pictureElement);\n        }\n        this.visiblePages.push(page);\n        if (this.documentHelper.owner.isSpellCheck && this.documentHelper.owner.spellCheckerModule.enableOptimizedSpellCheck && (this.owner.documentHelper.triggerElementsOnLoading || this.owner.documentHelper.isScrollHandler) && (this.documentHelper.cachedPages.indexOf(page.index) < 0 || this.owner.editorModule.isPasteContentCheck)) {\n            this.owner.documentHelper.cachedPages.push(page.index);\n            var contentlen = void 0;\n            if (this.owner.editorModule.isPasteContentCheck) {\n                contentlen = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner.editorModule.copiedTextContent) ? this.owner.editorModule.copiedTextContent : '';\n            }\n            else {\n                contentlen = this.documentHelper.owner.spellCheckerModule.getPageContent(page);\n            }\n            if (contentlen.trim().length > 0) {\n                page.allowNextPageRendering = false;\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.owner.spellCheckerModule)) {\n                    this.owner.spellCheckerModule.updateUniqueWords(_editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.getSpellCheckData(contentlen));\n                }\n                /* eslint-disable @typescript-eslint/no-explicit-any */\n                this.owner.spellCheckerModule.callSpellChecker(this.owner.spellCheckerModule.languageID, contentlen, true, false, false, true).then(function (data) {\n                    /* eslint-disable @typescript-eslint/no-explicit-any */\n                    var jsonObj = JSON.parse(data);\n                    if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner)) {\n                        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.owner.spellCheckerModule)) {\n                            _this.owner.spellCheckerModule.updateUniqueWords(jsonObj.SpellCollection);\n                        }\n                        page.allowNextPageRendering = true;\n                        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(_this.documentHelper)) {\n                            _this.documentHelper.triggerSpellCheck = true;\n                            _this.documentHelper.triggerElementsOnLoading = true;\n                            _this.renderPage(page, x, y, width, height);\n                            _this.documentHelper.triggerSpellCheck = false;\n                            _this.documentHelper.triggerElementsOnLoading = false;\n                        }\n                    }\n                })\n                    .catch();\n                {\n                    if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(page)) {\n                        page.allowNextPageRendering = true;\n                    }\n                }\n            }\n            else {\n                this.renderPage(page, x, y, width, height);\n            }\n        }\n        else {\n            this.renderPage(page, x, y, width, height);\n        }\n    };\n    /**\n     * @private\n     */\n    WebLayoutViewer.prototype.renderPage = function (page, x, y, width, height) {\n        this.documentHelper.render.renderWidgets(page, x - this.owner.viewer.containerLeft, y - this.owner.viewer.containerTop, width, height);\n    };\n    return WebLayoutViewer;\n}(LayoutViewer));\n\n/**\n * @private\n */\nvar ColumnLayout = /** @class */ (function () {\n    /**\n     * Initialize the constructor of Column Layout Settings\n     */\n    function ColumnLayout(viewer) {\n        this.viewerIn = viewer;\n        this.clear();\n    }\n    Object.defineProperty(ColumnLayout.prototype, \"currentIndex\", {\n        get: function () {\n            return this.currentIndexIn;\n        },\n        set: function (value) {\n            if (value >= 0) {\n                this.currentIndexIn = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ColumnLayout.prototype, \"columnCount\", {\n        get: function () {\n            var colCount;\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.columnIn)) {\n                colCount = this.numberOfColumnsIn;\n            }\n            colCount = colCount > 0 ? colCount : 1;\n            return colCount;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     * @param sectionFormat\n     */\n    ColumnLayout.prototype.setColumns = function (sectionFormat) {\n        this.pageWidth = _editor_editor_helper__WEBPACK_IMPORTED_MODULE_8__.HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n        this.numberOfColumnsIn = sectionFormat.numberOfColumns;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(sectionFormat.columns)) {\n            var columns = sectionFormat.columns;\n            var columnList = [];\n            for (var i = 0; i < sectionFormat.numberOfColumns; i++) {\n                var space = this.defaultSpaceIn;\n                var width = 0;\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(columns) && columns.length > 0) {\n                    space = columns[i].space;\n                    width = columns[i].width;\n                }\n                var col = this.getColumnObj(width, space, sectionFormat.numberOfColumns, sectionFormat.equalWidth);\n                col.index = i;\n                columnList.push(col);\n            }\n            this.columnIn = columnList;\n        }\n    };\n    /**\n     * @private\n     */\n    ColumnLayout.prototype.clear = function () {\n        this.currentIndexIn = 0;\n        this.defaultSpaceIn = 36;\n        this.columnIn = null;\n        this.pageWidth = 0;\n    };\n    ColumnLayout.prototype.reset = function () {\n        this.currentIndex = 0;\n    };\n    /**\n     * @private\n     * @param bodyWidget\n     * @param clientArea\n     * @returns\n     */\n    ColumnLayout.prototype.getColumnBounds = function (bodyWidget, clientArea) {\n        var colIndex = this.currentIndexIn;\n        return this.getColumnBoundsByIndex(colIndex, clientArea);\n    };\n    /**\n     * @private\n     * @param bodyWidget\n     * @param clientArea\n     * @returns\n     */\n    ColumnLayout.prototype.getColumnBoundsByBodyWidget = function (bodyWidget, clientArea) {\n        var colIndex = bodyWidget.columnIndex;\n        return this.getColumnBoundsByIndex(colIndex, clientArea);\n    };\n    /**\n     * @private\n     * @param bodyWidget\n     * @param clientArea\n     * @returns\n     */\n    ColumnLayout.prototype.getNextColumnByBodyWidget = function (bodyWidget) {\n        var colIndex = bodyWidget.columnIndex;\n        var nextColumn = this.getColumnByIndex(colIndex + 1);\n        return nextColumn;\n    };\n    ColumnLayout.prototype.getColumnByIndex = function (index) {\n        if (index >= 0 && index < this.columnCount && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.columnIn) && this.columnIn.length > 0) {\n            return this.columnIn[index];\n        }\n        return undefined;\n    };\n    ColumnLayout.prototype.getColumnObj = function (colWidth, colSpace, noOfCols, isEqualWidth) {\n        var totalSpace = (noOfCols - 1) * colSpace;\n        var colObj = new _format_index__WEBPACK_IMPORTED_MODULE_3__.WColumnFormat();\n        if ((isEqualWidth || colWidth === 0) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.pageWidth)) {\n            colWidth = (this.pageWidth - totalSpace) / noOfCols;\n        }\n        colObj.width = colWidth;\n        colObj.space = colSpace;\n        return colObj;\n    };\n    ColumnLayout.prototype.getColumnBoundsByIndex = function (colIndex, clientArea) {\n        var colRect = new _page__WEBPACK_IMPORTED_MODULE_7__.Rect(clientArea.x, clientArea.y, clientArea.width, clientArea.height);\n        if (colIndex >= 0 && this.columnIn.length > 0) {\n            var curColumn = void 0;\n            var prevColumn = void 0;\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_6__.isNullOrUndefined)(this.columnIn[colIndex])) {\n                curColumn = this.getColumnByIndex(colIndex);\n                colRect.width = curColumn.width;\n                for (var i = 0; i < colIndex; i++) {\n                    prevColumn = this.columnIn[i];\n                    colRect.x += prevColumn.width;\n                    colRect.x += prevColumn.space;\n                }\n            }\n        }\n        return colRect;\n    };\n    return ColumnLayout;\n}());\n\n\n\n//# sourceURL=webpack://ej2-vue-samples/./node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/viewer/viewer.js?");

/***/ })

}]);