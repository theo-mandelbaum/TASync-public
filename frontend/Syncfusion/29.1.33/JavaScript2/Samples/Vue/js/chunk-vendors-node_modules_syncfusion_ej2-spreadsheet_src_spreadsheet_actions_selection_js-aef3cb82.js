"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkej2_vue_samples"] = self["webpackChunkej2_vue_samples"] || []).push([["chunk-vendors-node_modules_syncfusion_ej2-spreadsheet_src_spreadsheet_actions_selection_js-aef3cb82"],{

/***/ "./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/actions/selection.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/actions/selection.js ***!
  \***************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Selection: () => (/* binding */ Selection)\n/* harmony export */ });\n/* harmony import */ var _common_index__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/index */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/common/index.js\");\n/* harmony import */ var _workbook_index__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../workbook/index */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/workbook/index.js\");\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"./node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _workbook_common_address__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../workbook/common/address */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/workbook/common/address.js\");\n/* harmony import */ var _workbook_common_index__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../workbook/common/index */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/workbook/common/index.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * Represents selection support for Spreadsheet.\n */\nvar Selection = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet selection module.\n     *\n     * @param {Spreadsheet} parent - Constructor for the Spreadsheet selection module.\n     * @private\n     */\n    function Selection(parent) {\n        this.invalidOperators = ['%'];\n        this.formulaRange = [];\n        /** @hidden */\n        this.isNoteActiveElement = false;\n        this.isNoteTouch = false;\n        this.parent = parent;\n        this.addEventListener();\n        this.mouseMoveEvt = this.mouseMoveHandler.bind(this);\n    }\n    Selection.prototype.addEventListener = function () {\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.contentLoaded, this.init, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.mouseDown, this.mouseDownHandler, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.virtualContentLoaded, this.virtualContentLoadedHandler, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.cellNavigate, this.cellNavigateHandler, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.selectRange, this.selectRange, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.rowHeightChanged, this.rowHeightChanged, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.colWidthChanged, this.colWidthChanged, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.protectSelection, this.protectHandler, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.initiateFormulaReference, this.initiateFormulaSelection, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.clearCellRef, this.clearBorder, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.getRowIdxFromClientY, this.getRowIdxFromClientY, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.getColIdxFromClientX, this.getColIdxFromClientX, this);\n        this.parent.on(_workbook_common_index__WEBPACK_IMPORTED_MODULE_4__.getChartRowIdxFromClientY, this.getRowIdxFromClientY, this);\n        this.parent.on(_workbook_common_index__WEBPACK_IMPORTED_MODULE_4__.getChartColIdxFromClientX, this.getColIdxFromClientX, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.focusBorder, this.chartBorderHandler, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.selectionStatus, this.isTouchSelectionStarted, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.rangeSelectionByKeydown, this.selectionByKeydown, this);\n    };\n    Selection.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.contentLoaded, this.init);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.mouseDown, this.mouseDownHandler);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.virtualContentLoaded, this.virtualContentLoadedHandler);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.cellNavigate, this.cellNavigateHandler);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.selectRange, this.selectRange);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.rowHeightChanged, this.rowHeightChanged);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.colWidthChanged, this.colWidthChanged);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.protectSelection, this.protectHandler);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.initiateFormulaReference, this.initiateFormulaSelection);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.clearCellRef, this.clearBorder);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.getRowIdxFromClientY, this.getRowIdxFromClientY);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.getColIdxFromClientX, this.getColIdxFromClientX);\n            this.parent.off(_workbook_common_index__WEBPACK_IMPORTED_MODULE_4__.getChartRowIdxFromClientY, this.getRowIdxFromClientY);\n            this.parent.off(_workbook_common_index__WEBPACK_IMPORTED_MODULE_4__.getChartColIdxFromClientX, this.getColIdxFromClientX);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.focusBorder, this.chartBorderHandler);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.selectionStatus, this.isTouchSelectionStarted);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.rangeSelectionByKeydown, this.selectionByKeydown);\n        }\n    };\n    Selection.prototype.isTouchSelectionStarted = function (args) {\n        args.touchSelectionStarted = this.touchSelectionStarted;\n    };\n    Selection.prototype.selectionByKeydown = function (args) {\n        this.selectRangeByIdx(args.range, args.e, false, false, false, false, undefined, false);\n    };\n    Selection.prototype.rowHeightChanged = function (args) {\n        var _this = this;\n        if (!args.threshold) {\n            return;\n        }\n        (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getUpdateUsingRaf)(function () {\n            if (!_this.parent) {\n                return;\n            }\n            var sheet = _this.parent.getActiveSheet();\n            var ele = _this.getActiveCell();\n            if (ele && (sheet.frozenRows || sheet.frozenColumns || sheet.selectedRange.includes(' '))) {\n                _this.selectRange({ address: sheet.selectedRange, isRowHeightChanged: true });\n                return;\n            }\n            var sRange = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getSwapRange)((0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeIndexes)(sheet.selectedRange));\n            var mergeArgs = { range: sRange, isActiveCell: false, skipChecking: true };\n            var isActiveCell;\n            if (ele) {\n                var rowIdx = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getCellIndexes)(sheet.activeCell)[0];\n                _this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.mergedRange, mergeArgs);\n                if (mergeArgs.isActiveCell) {\n                    var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(sRange[0], sRange[1], sheet, false, true);\n                    isActiveCell = cell.rowSpan > 1 && sRange[0] <= args.rowIdx && sRange[2] >= args.rowIdx;\n                }\n                if (rowIdx === args.rowIdx || isActiveCell) {\n                    ele.style.height = parseFloat(ele.style.height) + args.threshold + \"px\";\n                }\n                else if (rowIdx > args.rowIdx) {\n                    ele.style.top = parseFloat(ele.style.top) + args.threshold + \"px\";\n                }\n            }\n            ele = _this.getSelectionElement();\n            if (ele) {\n                if (isActiveCell || (sRange[0] === sRange[2] && sRange[1] === sRange[3])) {\n                    return;\n                }\n                var rowStart = sRange[0];\n                var rowEnd = sRange[2];\n                if (rowStart <= args.rowIdx && rowEnd >= args.rowIdx && ele) {\n                    ele.style.height = parseFloat(ele.style.height) + args.threshold + \"px\";\n                }\n                else if (rowStart > args.rowIdx && ele) {\n                    ele.style.top = parseFloat(ele.style.top) + args.threshold + \"px\";\n                }\n            }\n        });\n    };\n    Selection.prototype.colWidthChanged = function (args) {\n        var _this = this;\n        if (!args.threshold) {\n            return;\n        }\n        (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getUpdateUsingRaf)(function () {\n            if (!_this.parent) {\n                return;\n            }\n            var sheet = _this.parent.getActiveSheet();\n            var ele = _this.getActiveCell();\n            var isRtl = _this.parent.enableRtl;\n            if (ele && (sheet.frozenRows || sheet.frozenColumns || sheet.selectedRange.includes(' '))) {\n                _this.selectRange({ address: sheet.selectedRange });\n                return;\n            }\n            var sRange = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getSwapRange)((0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeIndexes)(sheet.selectedRange));\n            var e = { range: sRange, isActiveCell: false, skipChecking: true };\n            var isActiveCell;\n            if (ele) {\n                _this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.mergedRange, e);\n                var colIdx = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getCellIndexes)(sheet.activeCell)[1];\n                if (e.isActiveCell) {\n                    var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(sRange[0], sRange[1], sheet, false, true);\n                    isActiveCell = cell.rowSpan > 1 || cell.colSpan > 1;\n                }\n                if (colIdx === args.colIdx || isActiveCell) {\n                    ele.style.width = parseFloat(ele.style.width) + args.threshold + \"px\";\n                }\n                else if (colIdx > args.colIdx) {\n                    if (isRtl) {\n                        ele.style.right = parseFloat(ele.style.right) + args.threshold + \"px\";\n                    }\n                    else {\n                        ele.style.left = parseFloat(ele.style.left) + args.threshold + \"px\";\n                    }\n                }\n            }\n            ele = _this.getSelectionElement();\n            if (!ele || isActiveCell || (sRange[0] === sRange[2] && sRange[1] === sRange[3])) {\n                return;\n            }\n            var colStart = sRange[1];\n            var colEnd = sRange[3];\n            if (colStart <= args.colIdx && colEnd >= args.colIdx && ele) {\n                ele.style.width = parseFloat(ele.style.width) + args.threshold + \"px\";\n            }\n            else if (colStart > args.colIdx && ele) {\n                if (isRtl) {\n                    ele.style.right = parseFloat(ele.style.right) + args.threshold + \"px\";\n                }\n                else {\n                    ele.style.left = parseFloat(ele.style.left) + args.threshold + \"px\";\n                }\n            }\n        });\n    };\n    Selection.prototype.selectRange = function (args) {\n        args.address = this.parent.selectionSettings.mode === 'Single' ? (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeAddress)((0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getCellIndexes)(args.address)) : args.address;\n        this.selectMultiRange(args.address, null, null, args.skipChecking, args.isRowHeightChanged);\n    };\n    Selection.prototype.init = function () {\n        this.createSelectionElement();\n        var sheet = this.parent.getActiveSheet();\n        var sRange = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getSwapRange)((0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeIndexes)(sheet.selectedRange));\n        var actRange = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getCellIndexes)(sheet.activeCell);\n        var inRange = sRange[0] <= actRange[0] && sRange[2] >= actRange[0] && sRange[1] <= actRange[1]\n            && sRange[3] >= actRange[1];\n        this.selectMultiRange(sheet.selectedRange, true, inRange);\n    };\n    Selection.prototype.selectMultiRange = function (address, isInit, inRange, skipChecking, isisRowHeightChanged) {\n        var _this = this;\n        var sheetIdx = this.parent.activeSheetIndex;\n        if (address.indexOf('!') > -1) {\n            sheetIdx = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSheetIndex)(this.parent, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSheetNameFromAddress)(address));\n            address = address.substring(address.lastIndexOf('!') + 1);\n        }\n        if (this.parent.activeSheetIndex === sheetIdx) {\n            address.split(' ').forEach(function (rng, idx) {\n                _this.selectRangeByIdx((0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeIndexes)(rng), { type: 'mousedown', ctrlKey: idx !== 0 }, null, inRange, isInit, skipChecking, undefined, false, isisRowHeightChanged);\n            });\n        }\n        else {\n            (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.updateSelectedRange)(this.parent, address, this.parent.sheets[sheetIdx]);\n        }\n    };\n    Selection.prototype.createSelectionElement = function () {\n        var content = this.parent.getMainContent();\n        var ele = this.parent.createElement('div', { className: 'e-selection' });\n        content.appendChild(ele);\n        ele = this.parent.createElement('div', { className: 'e-active-cell' });\n        content.appendChild(ele);\n    };\n    Selection.prototype.isMergeActiveCell = function (sheet, activeIdx, rowIdx, colIdx) {\n        var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(rowIdx, colIdx, sheet, false, true);\n        if ((!!cell.rowSpan && cell.rowSpan !== 1) || (!!cell.colSpan && cell.colSpan !== 1)) {\n            var mergeArgs = { range: [rowIdx, colIdx, rowIdx, colIdx] };\n            this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.activeCellMergedRange, mergeArgs);\n            var mergeRange = mergeArgs.range;\n            return mergeRange[0] === activeIdx[0] && mergeRange[1] === activeIdx[1];\n        }\n        return false;\n    };\n    Selection.prototype.mouseDownHandler = function (e) {\n        var _this = this;\n        this.isNoteActiveElement = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(document) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(document.activeElement) &&\n            typeof document.activeElement.className === 'string' && document.activeElement.className.indexOf('e-addNoteContainer') > -1;\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.closest)(e.target, '.e-scrollbar') || e.target.classList.contains('e-main-panel') ||\n            e.target.classList.contains('e-sheet')) {\n            return;\n        }\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        var sheet = this.parent.getActiveSheet();\n        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.editOperation, eventArgs);\n        var isFormulaEdit = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.checkIsFormula)(eventArgs.editedValue, true);\n        var isNoteCellIndex = this.parent.enableNotes && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(this.parent.spreadsheetNoteModule.noteCellIndexes);\n        var cellIndexes = isNoteCellIndex ? this.parent.spreadsheetNoteModule.noteCellIndexes :\n            (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getCellIndexes)(this.parent.getActiveSheet().activeCell);\n        var targetElement = this.parent.getCell(cellIndexes[0], cellIndexes[1]);\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(targetElement) && targetElement.children !== null && targetElement.children.length > 0\n            && this.isNoteActiveElement && targetElement.children[targetElement.children.length - 1].classList.contains('e-addNoteIndicator')) {\n            var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(cellIndexes[0], cellIndexes[1], sheet);\n            var eventAction = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(cell) && cell.notes ? 'editNote' : 'addNote';\n            var noteContainer = document.getElementsByClassName('e-addNoteContainer')[0];\n            var address = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSheetName)(this.parent, this.parent.activeSheetIndex) + '!' + (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeAddress)(cellIndexes);\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(noteContainer) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(noteContainer.value) && e.target.className !== 'e-addNoteContainer'\n                && (((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(cell) || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(cell.notes)) || (cell.notes !== noteContainer.value))) {\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.setActionData, { args: { action: 'beforeCellSave', eventArgs: { address: address } } });\n                (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.updateCell)(this.parent, this.parent.getActiveSheet(), { rowIdx: cellIndexes[0], colIdx: cellIndexes[1], preventEvt: true,\n                    cell: { notes: noteContainer.value, isNoteEditable: false } });\n                var eventArgs_1 = { notes: noteContainer.value, address: address };\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.completeAction, { eventArgs: eventArgs_1, action: eventAction });\n            }\n            else if (e.target.className !== 'e-addNoteContainer') {\n                (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.updateCell)(this.parent, this.parent.getActiveSheet(), { rowIdx: cellIndexes[0], colIdx: cellIndexes[1], preventEvt: true,\n                    cell: { isNoteEditable: false } });\n            }\n            this.parent.spreadsheetNoteModule.isShowNote = null;\n        }\n        if (!this.isNoteTouch && e.target.className !== 'e-addNoteContainer' && document.getElementsByClassName('e-addNoteContainer') && document.getElementsByClassName('e-addNoteContainer').length > 0) {\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.removeNoteContainer, '');\n        }\n        if (this.isNoteTouch && e.type.indexOf('mouse') > -1) {\n            this.isNoteTouch = false;\n        }\n        if (!this.parent.isEdit || isFormulaEdit) {\n            var overlayElem = document.getElementById(this.parent.element.id + '_overlay');\n            if (typeof (e.target.className) === 'string') {\n                if (e.target.className.indexOf('e-ss-overlay') > -1) {\n                    return;\n                }\n            }\n            else if (overlayElem) {\n                overlayElem.classList.remove('e-ss-overlay-active');\n            }\n            if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.closest)(e.target, '.e-datavisualization-chart')) {\n                return;\n            }\n            if (sheet.isProtected && !sheet.protectSettings.selectCells && !sheet.protectSettings.selectUnLockedCells) {\n                return;\n            }\n            if (!((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.closest)(e.target, '.e-findtool-dlg') || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.closest)(e.target, '.e-dragfill-ddb'))) {\n                if (this.getSheetElement().contains(e.target) && !e.target.classList.contains('e-colresize')\n                    && !e.target.classList.contains('e-rowresize')) {\n                    var sheet_1 = this.parent.getActiveSheet();\n                    var mode = this.parent.selectionSettings.mode;\n                    var mouseClientX = (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getClientX)(e);\n                    var mouseClientY = (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getClientY)(e);\n                    var rowIdx = this.getRowIdxFromClientY({ clientY: mouseClientY, target: e.target });\n                    var colIdx = this.getColIdxFromClientX({ clientX: mouseClientX, target: e.target });\n                    var activeIdx = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getCellIndexes)(sheet_1.activeCell);\n                    var isRowSelected = void 0;\n                    var isColSelected = void 0;\n                    if (sheet_1.showHeaders) {\n                        var trgt = e.target;\n                        if (sheet_1.frozenColumns || sheet_1.frozenRows) {\n                            var headerEle = this.parent.getSelectAllContent().querySelector('thead');\n                            if (headerEle) {\n                                isColSelected = (this.parent.getColumnHeaderContent().contains(trgt) || headerEle.contains(trgt)) &&\n                                    trgt.classList.contains('e-header-cell') || (trgt.classList.contains('e-selectall-table') &&\n                                    rowIdx < 0 && colIdx >= this.parent.frozenColCount(sheet_1));\n                            }\n                            else {\n                                isColSelected = this.parent.getColumnHeaderContent().contains(trgt) &&\n                                    trgt.classList.contains('e-header-cell');\n                            }\n                            headerEle = this.parent.getSelectAllContent().querySelector('tbody');\n                            if (headerEle) {\n                                isRowSelected = (this.parent.getRowHeaderContent().contains(trgt) || headerEle.contains(trgt)) &&\n                                    trgt.classList.contains('e-header-cell') || (trgt.classList.contains('e-selectall-table') &&\n                                    colIdx < 0 && rowIdx >= this.parent.frozenRowCount(sheet_1));\n                            }\n                            else {\n                                isRowSelected = this.parent.getRowHeaderContent().contains(trgt) &&\n                                    trgt.classList.contains('e-header-cell');\n                            }\n                            if (rowIdx === -1) {\n                                rowIdx = 0;\n                            }\n                            if (colIdx === -1) {\n                                colIdx = 0;\n                            }\n                        }\n                        else {\n                            isRowSelected = this.parent.getRowHeaderContent().contains(e.target);\n                            isColSelected = this.parent.getColumnHeaderContent().contains(e.target);\n                        }\n                    }\n                    if ((sheet_1.frozenRows || sheet_1.frozenColumns) && !isColSelected && !isRowSelected) {\n                        var trgt_1 = e.target;\n                        var idx = ['e-rowhdr-table', 'e-selectall-table', 'e-colhdr-table'].findIndex(function (cls) { return trgt_1.classList.contains(cls); });\n                        if (idx > -1) {\n                            var selector = ['.e-row-header', '.e-selectall-container', '.e-column-header'][idx];\n                            var closestEle = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.closest)(trgt_1, selector);\n                            if (closestEle && closestEle.style.zIndex) {\n                                var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(rowIdx, colIdx, sheet_1);\n                                if ((cell && cell.validation && cell.validation.type === 'List') ||\n                                    ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.checkColumnValidation)(sheet_1.columns[colIdx], rowIdx, colIdx) &&\n                                        sheet_1.columns[colIdx].validation.type === 'List')) {\n                                    var td = this.parent.getCell(rowIdx, colIdx);\n                                    if (td) {\n                                        var listEle = td.querySelector('.e-validation-list');\n                                        if (listEle) {\n                                            var listEleRect = listEle.getBoundingClientRect();\n                                            var dropdownClicked = mouseClientX >= listEleRect.left &&\n                                                mouseClientX <= listEleRect.right && mouseClientY >= listEleRect.top &&\n                                                mouseClientY <= listEleRect.bottom;\n                                            if (dropdownClicked) {\n                                                var ddlEle = listEle.querySelector('.e-dropdownlist');\n                                                if (ddlEle) {\n                                                    var ddlInst = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.getComponent)(ddlEle, 'dropdownlist');\n                                                    if (ddlInst) {\n                                                        ddlInst.showPopup();\n                                                    }\n                                                }\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                    if (e.which === 3 && this.isSelected(rowIdx, colIdx)) {\n                        return;\n                    }\n                    if (e.target.classList.contains('e-autofill')) {\n                        this.isautoFillClicked = true;\n                        var autoFillDdb = e.target.parentElement.querySelector('.e-dragfill-ddb');\n                        if (!autoFillDdb || autoFillDdb.classList.contains('e-hide')) {\n                            this.dAutoFillCell = sheet_1.selectedRange;\n                        }\n                    }\n                    var topLeftIdx = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeIndexes)(sheet_1.topLeftCell);\n                    var range = void 0;\n                    if (isRowSelected) {\n                        this.isRowSelected = true;\n                        if (!e.shiftKey || mode === 'Single') {\n                            this.startCell = [rowIdx, 0];\n                        }\n                        else if (!this.startCell) {\n                            this.startCell = [topLeftIdx[0], 0];\n                        }\n                        range = [this.startCell[0], sheet_1.frozenColumns ? topLeftIdx[1] : 0, rowIdx, sheet_1.colCount - 1];\n                    }\n                    else if (isColSelected) {\n                        this.isColSelected = true;\n                        if (!e.shiftKey || mode === 'Single') {\n                            this.startCell = [0, colIdx];\n                        }\n                        else if (!this.startCell) {\n                            this.startCell = [0, topLeftIdx[1]];\n                        }\n                        range = [sheet_1.frozenRows ? topLeftIdx[0] : 0, this.startCell[1], sheet_1.rowCount - 1, colIdx];\n                    }\n                    else if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.closest)(e.target, '.e-select-all-cell')) {\n                        this.startCell = [sheet_1.frozenRows ? topLeftIdx[0] : 0, sheet_1.frozenColumns ? topLeftIdx[1] : 0];\n                        range = [].concat(this.startCell, [sheet_1.rowCount - 1, sheet_1.colCount - 1]);\n                    }\n                    else if (!e.target.classList.contains('e-sheet-content')) {\n                        if (!e.shiftKey || mode === 'Single') {\n                            this.startCell = [rowIdx, colIdx];\n                        }\n                        if (!this.isautoFillClicked && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.closest)(e.target, '.e-filloption')) {\n                            range = [].concat(this.startCell ? this.startCell : (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getCellIndexes)(sheet_1.activeCell), [rowIdx, colIdx]);\n                        }\n                    }\n                    if ((0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isTouchStart)(e) && !(isRowSelected || isColSelected) && range) {\n                        var colRowSelectArgs = this.isRowColSelected(range);\n                        this.isRowSelected = colRowSelectArgs.isRowSelected;\n                        this.isColSelected = colRowSelectArgs.isColSelected;\n                    }\n                    var preventEvt = e.ctrlKey && range && sheet_1.selectedRange.includes((0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeAddress)(range));\n                    if (!preventEvt && mode === 'Multiple' && (!(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isTouchEnd)(e) && (!(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isTouchStart)(e) ||\n                        ((0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isTouchStart)(e) && ((activeIdx[0] === rowIdx && activeIdx[1] === colIdx) ||\n                            this.isMergeActiveCell(sheet_1, activeIdx, rowIdx, colIdx)))) || isColSelected || isRowSelected)) {\n                        document.addEventListener((0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getMoveEvent)().split(' ')[0], this.mouseMoveEvt);\n                        if (!_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.Browser.isPointer) {\n                            if (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.Browser.isIos && (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isTouchStart)(e) && e.target && e.target.classList.contains('e-cell')) {\n                                e.preventDefault();\n                            }\n                            document.addEventListener((0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getMoveEvent)().split(' ')[1], this.mouseMoveEvt, { passive: false });\n                        }\n                        this.touchSelectionStarted = true;\n                    }\n                    else {\n                        this.touchSelectionStarted = false;\n                    }\n                    if (!(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isTouchEnd)(e)) {\n                        if (preventEvt) {\n                            if (this.parent.isEdit) {\n                                var updateFormulaCurPos_1 = function (e) {\n                                    _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.EventHandler.remove(document, (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getEndEvent)(), updateFormulaCurPos_1);\n                                    _this.updateFormulaCursorPosition(e);\n                                };\n                                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.EventHandler.add(document, (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getEndEvent)(), updateFormulaCurPos_1, this);\n                            }\n                        }\n                        else {\n                            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.EventHandler.add(document, (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getEndEvent)(), this.mouseUpHandler, this);\n                        }\n                    }\n                    var isNoteAvailable = (e.target.className === 'e-addNoteIndicator' ||\n                        (e.target.children.length > 0 && e.target.children[e.target.childElementCount - 1].className.indexOf('e-addNoteIndicator') > -1));\n                    if ((0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isTouchStart)(e) && isNoteAvailable) {\n                        var cellIndexes_1 = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getCellIndexes)((0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeAddress)(range).split(':')[0]);\n                        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.showNote, { rowIndex: cellIndexes_1[0], columnIndex: cellIndexes_1[1], isNoteEditable: false });\n                        this.isNoteTouch = true;\n                        this.parent.spreadsheetNoteModule.isNoteVisibleOnTouch = true;\n                    }\n                    if ((0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isTouchStart)(e) && !(isColSelected || isRowSelected)) {\n                        this.touchEvt = e;\n                        return;\n                    }\n                    if (range) {\n                        this.selectRangeByIdx(range, e);\n                    }\n                    if (!this.isNoteTouch && e.type.indexOf('mouse') > -1 && isNoteAvailable) {\n                        var cellIndexes_2 = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getCellIndexes)((0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeAddress)(range).split(':')[0]);\n                        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.showNote, { rowIndex: cellIndexes_2[0], columnIndex: cellIndexes_2[1], isNoteEditable: false });\n                        this.parent.spreadsheetNoteModule.isNoteVisible = true;\n                    }\n                    if (this.parent.isMobileView()) {\n                        this.parent.element.classList.add('e-mobile-focused');\n                        this.parent.renderModule.setSheetPanelSize();\n                    }\n                }\n            }\n        }\n        if (isFormulaEdit && (e.target.classList.contains('e-cell') || e.target.classList.contains('e-wrap-content') ||\n            e.target.classList.contains('e-header-cell')) && this.parent.isEdit) {\n            var range = this.parent.getActiveSheet().selectedRange;\n            var lastRange = range.split(' ');\n            range = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isSingleCell)((0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_4__.getIndexesFromAddress)(lastRange[lastRange.length - 1])) ? lastRange[lastRange.length - 1].split(':')[0] : lastRange[lastRange.length - 1];\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.addressHandle, { range: range, isSelect: false, isMouseDown: e.ctrlKey });\n        }\n    };\n    Selection.prototype.mouseMoveHandler = function (e) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        if ((0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isTouchMove)(e)) {\n            e.preventDefault();\n        }\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.editOperation, eventArgs);\n        var isFormulaEdit = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.checkIsFormula)(eventArgs.editedValue, true);\n        var verticalContent = this.parent.getMainContent().parentElement;\n        var horizontalContent = this.parent.element.getElementsByClassName('e-scroller')[0];\n        var clientRect = verticalContent.getBoundingClientRect();\n        var frozenCol = this.parent.frozenColCount(sheet);\n        var left = clientRect.left + this.parent.sheetModule.getRowHeaderWidth(sheet, false, true);\n        var right = clientRect.right - (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getScrollBarWidth)();\n        var top = clientRect.top;\n        var bottom = clientRect.bottom;\n        var clientX = (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getClientX)(e);\n        var clientY = (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getClientY)(e);\n        // remove math.min or handle top and left auto scroll\n        var colIdx = this.isRowSelected ? sheet.colCount - 1 :\n            this.getColIdxFromClientX({ clientX: clientX, target: e.target });\n        var rowIdx = this.isColSelected ? sheet.rowCount - 1 :\n            this.getRowIdxFromClientY({ clientY: clientY, target: e.target });\n        var prevIndex;\n        var rangeIndex;\n        if (e.ctrlKey) {\n            var selRanges = sheet.selectedRange.split(' ');\n            prevIndex = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeIndexes)(selRanges[selRanges.length - 1]);\n        }\n        else {\n            prevIndex = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeIndexes)(sheet.selectedRange);\n        }\n        if (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.Browser.isDevice) {\n            var screenWidth = screen.availWidth;\n            if (right >= screenWidth - 40) {\n                right -= (40 - (screenWidth - right));\n            }\n            if (!sheet.showHeaders && left < 40) {\n                left += (40 - left);\n            }\n        }\n        var mergeArgs = { range: [rowIdx, colIdx, rowIdx, colIdx] };\n        this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.activeCellMergedRange, mergeArgs);\n        if (mergeArgs.range[2] === prevIndex[2] && mergeArgs.range[3] === prevIndex[3] && clientY <= bottom && clientY >= top &&\n            clientX <= right && clientX >= left) {\n            return;\n        }\n        var frozenRow = this.parent.frozenRowCount(sheet);\n        if (!isFormulaEdit && !this.isColSelected && !this.isRowSelected) {\n            prevIndex = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getCellIndexes)(sheet.activeCell);\n        }\n        var isScrollDown = clientY > bottom && !this.isColSelected && rowIdx < sheet.rowCount;\n        var isScrollUp = clientY < top && rowIdx >= 0 && !this.isColSelected &&\n            !!verticalContent.scrollTop && (!frozenRow || prevIndex[0] >= frozenRow);\n        var isScrollRight = clientX > right && !this.isRowSelected && colIdx < sheet.colCount;\n        var isScrollLeft = clientX < left && colIdx >= 0 && !this.isRowSelected &&\n            !!horizontalContent.scrollLeft && (!frozenCol || prevIndex[1] >= frozenCol);\n        this.clearInterval();\n        var scrollUpRowIdx;\n        var scrollUpColIdx;\n        if (isScrollDown || isScrollUp || isScrollRight || isScrollLeft) {\n            if (isScrollUp || isScrollLeft) {\n                scrollUpRowIdx = rowIdx;\n                scrollUpColIdx = colIdx;\n            }\n            var scrollSelection_1 = function () {\n                if (isScrollDown || isScrollUp) {\n                    rowIdx = _this.getRowIdxFromClientY({ clientY: isScrollDown ? bottom : top });\n                    if (rowIdx >= sheet.rowCount) { // clear interval when scroll up\n                        _this.clearInterval();\n                        return;\n                    }\n                    verticalContent.scrollTop += (isScrollDown ? 1 : -1) * (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRowHeight)(sheet, rowIdx);\n                }\n                if (isScrollRight || isScrollLeft) {\n                    colIdx = _this.getColIdxFromClientX({ clientX: isScrollRight ? right : left, isFScroll: true });\n                    if (colIdx >= sheet.colCount) { // clear interval when scroll left\n                        _this.clearInterval();\n                        return;\n                    }\n                    horizontalContent.scrollLeft += (isScrollRight ? 1 : -1) * (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColumnWidth)(sheet, colIdx);\n                }\n                if ((isScrollUp && sheet.frozenRows && !verticalContent.scrollTop) ||\n                    (isScrollLeft && sheet.frozenColumns && !horizontalContent.scrollLeft)) {\n                    _this.selectRangeByIdx([].concat(prevIndex[0], prevIndex[1], [scrollUpRowIdx, scrollUpColIdx]), e);\n                    _this.clearInterval();\n                    return;\n                }\n                _this.selectRangeByIdx([].concat(prevIndex[0], prevIndex[1], [rowIdx, colIdx]), e);\n            };\n            scrollSelection_1();\n            this.scrollInterval = setInterval(function () {\n                scrollSelection_1();\n                _this.clearInterval();\n                _this.scrollInterval = setInterval(scrollSelection_1, 100);\n            });\n        }\n        else {\n            var indexes = [].concat(prevIndex[0], prevIndex[1], [rowIdx, colIdx]);\n            if (frozenRow && indexes[0] < frozenRow && indexes[2] >= frozenRow && verticalContent.scrollTop) {\n                verticalContent.scrollTop = 0;\n                indexes[2] = frozenRow;\n            }\n            if (frozenCol && indexes[1] < frozenCol && indexes[3] >= frozenCol && horizontalContent.scrollLeft) {\n                horizontalContent.scrollLeft = 0;\n                indexes[3] = frozenCol;\n            }\n            if (this.isautoFillClicked) {\n                if (e.target.classList.contains('e-autofill')) {\n                    this.dAutoFillCell = sheet.selectedRange;\n                }\n                var args = { e: e, indexes: null };\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.selectAutoFillRange, args);\n                indexes = args.indexes;\n                rangeIndex = indexes;\n            }\n            this.selectRangeByIdx(indexes, e);\n        }\n        if (isFormulaEdit && this.parent.isEdit && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.closest)(e.target, '#' + this.parent.element.id + '_edit')) {\n            var range = void 0;\n            if (this.isautoFillClicked) {\n                range = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeAddress)(rangeIndex);\n            }\n            else {\n                range = this.parent.getActiveSheet().selectedRange;\n            }\n            var lastRange = range.split(' ');\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.addressHandle, { range: lastRange[lastRange.length - 1], isSelect: false });\n        }\n    };\n    Selection.prototype.mouseUpHandler = function (e) {\n        var rowIdx = this.getRowIdxFromClientY({ clientY: (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getClientY)(e), target: e.target });\n        var colIdx = this.getColIdxFromClientX({ clientX: (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getClientX)(e), target: e.target });\n        this.clearInterval();\n        if ((0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isTouchEnd)(e) && !(this.isColSelected || this.isRowSelected) &&\n            (this.getRowIdxFromClientY({ clientY: (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getClientY)(this.touchEvt), target: e.target }) === rowIdx &&\n                this.getColIdxFromClientX({ clientX: (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getClientX)(this.touchEvt), target: e.target }) === colIdx)) {\n            this.mouseDownHandler(e);\n        }\n        document.removeEventListener((0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getMoveEvent)().split(' ')[0], this.mouseMoveEvt);\n        if (!_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.Browser.isPointer) {\n            document.removeEventListener((0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getMoveEvent)().split(' ')[1], this.mouseMoveEvt);\n        }\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.EventHandler.remove(document, (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getEndEvent)(), this.mouseUpHandler);\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.frozenRows || sheet.frozenColumns) {\n            (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.removeRangeEle)(this.parent.element, null, 'e-cur-selection', true, true);\n        }\n        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.mouseUpAfterSelection, e);\n        if (this.isautoFillClicked) {\n            var sheet_2 = this.parent.getActiveSheet();\n            var indexes = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeIndexes)(sheet_2.selectedRange);\n            if (!(this.isColSelected && indexes[1] === colIdx) && !(this.isRowSelected && indexes[0] === rowIdx)) {\n                var autoFillDdb = e.target.parentElement.querySelector('.e-dragfill-ddb');\n                if (!autoFillDdb || autoFillDdb.classList.contains('e-hide')) {\n                    this.dAutoFillCell = sheet_2.selectedRange;\n                }\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.performAutoFill, { event: e, dAutoFillCell: this.dAutoFillCell });\n            }\n            this.isautoFillClicked = false;\n        }\n        else if (!e.ctrlKey && !(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isDiscontinuousRange)((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSelectedRange)(this.parent.getActiveSheet()))) {\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.positionAutoFillElement, null);\n        }\n        else {\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.hideAutoFillElement, null);\n        }\n        this.updateFormulaCursorPosition(e);\n    };\n    Selection.prototype.updateFormulaCursorPosition = function (e) {\n        if (this.parent.isEdit) {\n            var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.editOperation, eventArgs);\n            var isFormulaEdit = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.checkIsFormula)(eventArgs.editedValue, true);\n            if (isFormulaEdit) {\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.initiateCur, { isCellEdit: e.target.classList.contains('e-spreadsheet-edit') });\n            }\n        }\n    };\n    Selection.prototype.isSelected = function (rowIdx, colIdx) {\n        var isSelected = false;\n        var indexes;\n        var ranges = this.parent.getActiveSheet().selectedRange.split(' ');\n        for (var i = 0; i < ranges.length; i++) {\n            indexes = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getSwapRange)((0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeIndexes)(ranges[i]));\n            if (indexes[0] <= rowIdx && rowIdx <= indexes[2] && indexes[1] <= colIdx && colIdx <= indexes[3]) {\n                isSelected = true;\n                break;\n            }\n        }\n        return isSelected;\n    };\n    Selection.prototype.virtualContentLoadedHandler = function (args) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var indexes;\n        var isColSelected;\n        var isRowSelected;\n        sheet.selectedRange.split(' ').forEach(function (rng, idx) {\n            indexes = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeIndexes)(rng);\n            isRowSelected = (indexes[1] === 0 && indexes[3] === args.prevRowColCnt.colCount - 1);\n            isColSelected = (indexes[0] === 0 && indexes[2] === args.prevRowColCnt.rowCount - 1);\n            if (isRowSelected || isColSelected) {\n                if (isColSelected && isRowSelected) {\n                    indexes = [0, 0, sheet.rowCount - 1, sheet.colCount - 1];\n                }\n                else if (isColSelected) {\n                    indexes = [0, indexes[1], sheet.rowCount - 1, indexes[3]];\n                }\n                else {\n                    indexes = [indexes[0], 0, indexes[2], sheet.colCount - 1];\n                }\n                if (sheet.frozenRows || sheet.frozenColumns) {\n                    _this.selectRangeByIdx(indexes, { type: 'mousedown', ctrlKey: idx !== 0 }, false, false, false, false, undefined, true);\n                }\n                else {\n                    _this.selectRangeByIdx(indexes, null, true, null, null, null, idx);\n                }\n            }\n            else {\n                indexes = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeIndexes)(rng);\n                var topIdx = _this.parent.viewport.topIndex + _this.parent.frozenRowCount(sheet);\n                var leftIdx = _this.parent.viewport.leftIndex + _this.parent.frozenColCount(sheet);\n                _this.highlightHdr(indexes, idx === 0 ? false : true, indexes[0] >= topIdx || indexes[2] >= topIdx, indexes[1] >= leftIdx || indexes[3] >= leftIdx);\n            }\n        });\n    };\n    Selection.prototype.clearInterval = function () {\n        if (this.scrollInterval) {\n            clearInterval(this.scrollInterval);\n            this.scrollInterval = null;\n        }\n    };\n    Selection.prototype.getScrollLeft = function () {\n        return this.parent.scrollModule ? this.parent.scrollModule.prevScroll.scrollLeft : 0;\n    };\n    Selection.prototype.cellNavigateHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.isProtected && !sheet.protectSettings.selectCells && !sheet.protectSettings.selectUnLockedCells) {\n            return;\n        }\n        args.type = 'mousedown';\n        this.selectRangeByIdx(args.range, args, false, false, false, false, undefined, args.preventAnimation);\n    };\n    Selection.prototype.getColIdxFromClientX = function (e) {\n        var _this = this;\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        var left = 0;\n        if (e.isImage) {\n            left = e.clientX;\n        }\n        else {\n            var cliRect = document.getElementById(this.parent.element.id + '_sheet').getBoundingClientRect();\n            if (this.parent.enableRtl) {\n                left = (cliRect.right - this.parent.sheetModule.getRowHeaderWidth(sheet, true, true) - 1) - e.clientX;\n            }\n            else {\n                left = e.clientX - (cliRect.left + this.parent.sheetModule.getRowHeaderWidth(sheet, true, true) + 1);\n            }\n            left += this.parent.viewport.beforeFreezeWidth;\n            var frozenColPosition = function () {\n                var frozenCol = _this.parent.element.querySelector('.e-frozen-column');\n                return parseInt(frozenCol.style[_this.parent.enableRtl ? 'right' : 'left'], 10) / _this.parent.viewport.scaleX;\n            };\n            if ((!e.target || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.closest)(e.target, '.e-row-header') && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.closest)(e.target, '.e-selectall-container')) ||\n                this.isScrollableArea(e.clientX, e.target, true)) && (!this.parent.frozenColCount(sheet) ||\n                left > frozenColPosition() || e.isFScroll)) {\n                left += (this.getScrollLeft() / this.parent.viewport.scaleX);\n            }\n            if (sheet.frozenRows && left < 0 && sheet.showHeaders) {\n                return -1;\n            }\n        }\n        var size;\n        for (var i = 0;; i++) {\n            size = width += (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColumnWidth)(sheet, i, null, !e.isImage) / this.parent.viewport.scaleX;\n            if (left < (e.isImage ? Number((0,_common_index__WEBPACK_IMPORTED_MODULE_0__.addDPRValue)(size).toFixed(2)) : size) ||\n                (this.parent.scrollSettings.isFinite && i === sheet.colCount - 1)) {\n                if (!e.isImage) {\n                    e.size = left;\n                }\n                e.clientX = i;\n                return i;\n            }\n        }\n    };\n    Selection.prototype.isScrollableArea = function (offset, target, isclientX) {\n        if (!target.classList.contains('e-table')) {\n            return false;\n        }\n        if (isclientX) {\n            return offset > this.parent.getMainContent().getBoundingClientRect().left;\n        }\n        else {\n            return offset > this.parent.getMainContent().parentElement.getBoundingClientRect().top;\n        }\n    };\n    Selection.prototype.getRowIdxFromClientY = function (args) {\n        var height = 0;\n        var sheet = this.parent.getActiveSheet();\n        var top = 0;\n        if (args.isImage) {\n            top = args.clientY;\n        }\n        else {\n            var sheetEle = document.getElementById(this.parent.element.id + '_sheet');\n            top = args.clientY + this.parent.viewport.beforeFreezeHeight -\n                (sheetEle.getBoundingClientRect().top + (sheet.showHeaders ? 31 / this.parent.viewport.scaleY : 0));\n            if (!args.target || !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.closest)(args.target, '.e-header-panel') || this.isScrollableArea(args.clientY, args.target)) {\n                top += (this.parent.getMainContent().parentElement.scrollTop / this.parent.viewport.scaleY);\n            }\n            if (sheet.frozenColumns && top < 0 && sheet.showHeaders) {\n                return -1;\n            }\n        }\n        var size;\n        for (var i = 0;; i++) {\n            size = height += (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getRowHeight)(sheet, i, !args.isImage) / this.parent.viewport.scaleY;\n            if (top < (args.isImage ? Number((0,_common_index__WEBPACK_IMPORTED_MODULE_0__.addDPRValue)(size).toFixed(2)) : size) ||\n                (this.parent.scrollSettings.isFinite && i === sheet.rowCount - 1)) {\n                if (!args.isImage) {\n                    args.size = top;\n                }\n                args.clientY = i;\n                return i;\n            }\n        }\n    };\n    Selection.prototype.initFormulaReferenceIndicator = function (range) {\n        if (this.parent.isEdit) {\n            var forRefIndicator = this.parent.createElement('div', { className: 'e-formularef-indicator' });\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-top' }));\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-bottom' }));\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-left' }));\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-right' }));\n            this.parent.getMainContent().appendChild(forRefIndicator);\n            (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.setPosition)(this.parent, forRefIndicator, range, 'e-formularef-indicator');\n        }\n    };\n    Selection.prototype.isMouseEvent = function (e) {\n        return (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isMouseDown)(e) || (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isMouseUp)(e) || (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isMouseMove)(e);\n    };\n    Selection.prototype.selectRangeByIdx = function (range, e, isScrollRefresh, isActCellChanged, isInit, skipChecking, selectedRowColIdx, preventAnimation, isisRowHeightChanged) {\n        var _this = this;\n        var isMouseEvent = e && this.isMouseEvent(e);\n        if (e && e.target && isMouseEvent && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.closest)(e.target, '#' + this.parent.element.id + '_edit')) {\n            return;\n        }\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '',\n            endFormulaRef: false };\n        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.editOperation, eventArgs);\n        var isFormulaEdit = (this.parent.isEdit ? (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.checkIsFormula)(eventArgs.editedValue, true) : false) &&\n            !eventArgs.endFormulaRef;\n        var isMultiRange = e && e.ctrlKey && (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isMouseDown)(e);\n        var ele;\n        if (!isMultiRange) {\n            ele = this.getSelectionElement(e, selectedRowColIdx);\n        }\n        var sheet = this.parent.getActiveSheet();\n        var topLeftIdx = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeIndexes)(sheet.topLeftCell);\n        var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n        var mergeArgs = { range: [].slice.call(range), isActiveCell: false, skipChecking: skipChecking };\n        var isMergeRange;\n        var rowColSelectArgs = this.isRowColSelected(range);\n        if (!rowColSelectArgs.isColSelected && !rowColSelectArgs.isRowSelected) {\n            this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.mergedRange, mergeArgs);\n        }\n        if (range !== mergeArgs.range) {\n            isMergeRange = true;\n        }\n        range = mergeArgs.range;\n        var promise = new Promise(function (resolve) { resolve((function () { })()); });\n        var args = { range: (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeAddress)(range), cancel: false };\n        if (sheet.isProtected) {\n            var protectCell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(range[2], range[3], sheet);\n            if (sheet.protectSettings.selectUnLockedCells && !sheet.protectSettings.selectCells) {\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(protectCell)) {\n                    if ((protectCell.isLocked === true || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(protectCell.isLocked))) {\n                        return;\n                    }\n                    else {\n                        var sheetEle = this.parent.element.getElementsByClassName('e-sheet-panel')[0];\n                        if (sheetEle && sheetEle.classList.contains('e-protected')) {\n                            sheetEle.classList.remove('e-protected');\n                        }\n                    }\n                }\n                else if (!sheet.protectSettings.selectCells) {\n                    return;\n                }\n            }\n        }\n        this.parent.trigger('beforeSelect', args);\n        if (args.cancel) {\n            return;\n        }\n        if (isFormulaEdit && formulaRefIndicator) {\n            formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n        }\n        if (!isisRowHeightChanged) {\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.hideAutoFillOptions, null);\n        }\n        if (((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isSingleCell)(range) || mergeArgs.isActiveCell) && !isMultiRange) {\n            if (ele) {\n                if (!ele.classList.contains('e-multi-range')) {\n                    ele.classList.add('e-hide');\n                }\n                if (sheet.frozenRows || sheet.frozenColumns) {\n                    var clsName = (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isMouseMove)(e) ? 'e-cur-selection' : 'e-selection';\n                    (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.removeRangeEle)(this.parent.getSelectAllContent(), null, clsName, true);\n                    (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.removeRangeEle)(this.parent.getColumnHeaderContent(), null, clsName, true);\n                    (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.removeRangeEle)(this.parent.getRowHeaderContent(), null, clsName, true);\n                }\n            }\n            if (!sheet.frozenColumns && !sheet.frozenRows && ele) {\n                (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.setPosition)(this.parent, ele, range);\n            }\n            if (isFormulaEdit && e && e.target && (!isMouseEvent || !e.target.classList.contains('e-spreadsheet-edit'))\n                && this.parent.isEdit) {\n                var addRefArgs = {\n                    range: (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeAddress)(range).split(':')[0], isSelect: true\n                };\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.addressHandle, addRefArgs);\n                if (addRefArgs.isAlertDlgOpen) {\n                    return;\n                }\n                this.initFormulaReferenceIndicator(range);\n            }\n        }\n        else {\n            if (isMultiRange) {\n                if (selectedRowColIdx === undefined) {\n                    var selRange_1 = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeAddress)(range);\n                    if (sheet.selectedRange.includes(selRange_1) && !isFormulaEdit) {\n                        var selRanges = sheet.selectedRange.split(' ');\n                        if (selRanges.length > 1) {\n                            selRanges.splice(selRanges.indexOf(selRange_1), 1);\n                            selRange_1 = selRanges.join(' ');\n                        }\n                        else {\n                            selRange_1 = sheet.activeCell + ':' + sheet.activeCell;\n                        }\n                        this.selectRange({ address: selRange_1 });\n                        return;\n                    }\n                    else {\n                        ele = this.getSelectionElement(e, selectedRowColIdx);\n                    }\n                }\n                else {\n                    ele = this.getSelectionElement(e, selectedRowColIdx);\n                }\n            }\n            if (isFormulaEdit && this.parent.isEdit) {\n                if (e && e.target && (!isMouseEvent || !e.target.classList.contains('e-spreadsheet-edit')) && this.parent.isEdit) {\n                    var addRefArgs = {\n                        range: (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeAddress)(range), isSelect: true\n                    };\n                    this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.addressHandle, addRefArgs);\n                    if (addRefArgs.isAlertDlgOpen) {\n                        return;\n                    }\n                    this.initFormulaReferenceIndicator(range);\n                }\n            }\n            else {\n                var clsName = void 0;\n                if (ele) {\n                    ele.classList.remove('e-hide');\n                    if (sheet.frozenRows || sheet.frozenColumns) {\n                        if (e && e.target || isMultiRange) {\n                            clsName = 'e-cur-selection';\n                            if ((0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isMouseMove)(e) && ele.classList.contains('e-cur-selection')) {\n                                ele.classList.add('e-hide');\n                            }\n                            else {\n                                ele.classList.add(clsName);\n                            }\n                        }\n                        if (!isMultiRange && (this.isColSelected || this.isRowSelected) && (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isMouseDown)(e)) {\n                            (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.removeRangeEle)(this.parent.getSelectAllContent(), null, 'e-selection');\n                            (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.removeRangeEle)(this.parent.getColumnHeaderContent(), null, 'e-selection');\n                            (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.removeRangeEle)(this.parent.getRowHeaderContent(), null, 'e-selection');\n                        }\n                    }\n                }\n                var offset = (this.isColSelected && this.isRowSelected) ? undefined\n                    : this.getOffset(range[2], range[3]);\n                if (isMergeRange && offset) { // Need to handle half hidden merge cell in better way\n                    offset.left = { idx: 0, size: 0 };\n                }\n                promise = (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.setPosition)(this.parent, ele, range, clsName, preventAnimation, isMultiRange, isMultiRange && !e.target) ||\n                    promise;\n            }\n        }\n        var eArgs = { action: 'getCurrentEditSheetIdx', sheetIndex: null };\n        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.editOperation, eArgs);\n        if (sheet.frozenColumns && range[1] > 0 && range[1] === topLeftIdx[1] && range[3] === sheet.colCount - 1) {\n            range[1] = 0;\n        }\n        if (sheet.frozenRows && range[0] > 0 && range[0] === topLeftIdx[0] && range[2] === sheet.rowCount - 1) {\n            range[0] = 0;\n        }\n        var selRange = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeAddress)(range);\n        if (e && e.ctrlKey && ((0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isMouseMove)(e) || (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isMouseUp)(e)) && !isFormulaEdit) {\n            selRange = sheet.selectedRange.slice(0, sheet.selectedRange.lastIndexOf(' ')) + ' ' + selRange;\n        }\n        else if (selectedRowColIdx > -1) {\n            var selRanges = sheet.selectedRange.split(' ');\n            selRanges[selectedRowColIdx] = selRange;\n            selRange = selRanges.join(' ');\n        }\n        if (!isFormulaEdit && !this.isautoFillClicked) {\n            var isSelectRangeChange = false;\n            if (sheet.selectedRange !== selRange) {\n                isSelectRangeChange = true;\n            }\n            (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.updateSelectedRange)(this.parent, selRange, sheet, isMultiRange);\n            if (isSelectRangeChange) {\n                promise.then(function () {\n                    if (_this.parent) {\n                        _this.parent.trigger('select', { range: _this.parent.getActiveSheet().selectedRange });\n                    }\n                });\n            }\n        }\n        else if (!isInit && !this.isautoFillClicked) {\n            (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.updateSelectedRange)(this.parent, selRange, sheet, isMultiRange);\n        }\n        rowColSelectArgs = this.isRowColSelected(range);\n        this.isRowSelected = rowColSelectArgs.isRowSelected;\n        this.isColSelected = rowColSelectArgs.isColSelected;\n        this.highlightHdr(range, e && e.ctrlKey);\n        if (!isScrollRefresh && !(e && (e.type === 'mousemove' || (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isTouchMove)(e)))) {\n            if (!isFormulaEdit) {\n                this.updateActiveCell(isActCellChanged ? (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeIndexes)(sheet.activeCell) : range, isInit, preventAnimation);\n            }\n            else if (eArgs.sheetIndex === this.parent.getActiveSheet().id - 1 && isInit) {\n                isActCellChanged = true;\n                this.updateActiveCell(isActCellChanged ? (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeIndexes)(sheet.activeCell) : range, isInit, preventAnimation);\n            }\n            else if (!this.parent.isEdit) {\n                this.updateActiveCell(isActCellChanged ? (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeIndexes)(sheet.activeCell) : range, isInit, preventAnimation);\n            }\n        }\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(e)) {\n            e = { type: 'mousedown' };\n        }\n        if (!isFormulaEdit) {\n            this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_4__.selectionComplete, e);\n        }\n        else if (!isInit) {\n            this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_4__.selectionComplete, e);\n        }\n        if (!isMultiRange && !(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isDiscontinuousRange)((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSelectedRange)(this.parent.getActiveSheet()))) {\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.positionAutoFillElement, { preventAnimation: preventAnimation });\n        }\n        else {\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.hideAutoFillElement, null);\n        }\n        if (this.parent.showAggregate) {\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.showAggregate, {});\n        }\n        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.refreshOverlayElem, null);\n    };\n    Selection.prototype.isRowColSelected = function (indexes) {\n        var sheet = this.parent.getActiveSheet();\n        return { isRowSelected: indexes[1] === 0 && indexes[3] === sheet.colCount - 1,\n            isColSelected: indexes[0] === 0 && indexes[2] === sheet.rowCount - 1 };\n    };\n    Selection.prototype.updateActiveCell = function (range, isInit, preventAnimation) {\n        var sheet = this.parent.getActiveSheet();\n        var topLeftIdx = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeIndexes)(sheet.topLeftCell);\n        var rowIdx;\n        var colIdx;\n        var isMergeRange;\n        if (this.isColSelected) {\n            rowIdx = topLeftIdx[0];\n            colIdx = range[1];\n            if (this.isRowSelected) {\n                colIdx = topLeftIdx[1];\n            }\n        }\n        else {\n            rowIdx = range[0];\n            colIdx = range[1];\n            if (this.isRowSelected) {\n                colIdx = topLeftIdx[1];\n            }\n        }\n        var mergeArgs = { range: [rowIdx, colIdx].concat([rowIdx, colIdx]) };\n        this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.activeCellMergedRange, mergeArgs);\n        if (range !== mergeArgs.range) {\n            isMergeRange = true;\n        }\n        range = mergeArgs.range;\n        if (sheet.activeCell !== (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getCellAddress)(range[0], range[1]) || isInit) {\n            this.previousActiveCell = sheet.activeCell.indexOf(':') > -1 ? this.previousActiveCell : sheet.activeCell;\n            this.parent.setSheetPropertyOnMute(sheet, 'activeCell', (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getCellAddress)(range[0], range[1]));\n            if (sheet.isProtected) {\n                var element = this.parent.element.querySelector('.e-formula-bar');\n                var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getCell)(range[0], range[1], sheet);\n                var isCellLocked = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isLocked)(cell, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getColumn)(sheet, range[1]));\n                if (isCellLocked && element && !element.disabled) {\n                    element.disabled = true;\n                }\n                else if (!isCellLocked && element && element.disabled) {\n                    element.disabled = false;\n                }\n            }\n            if (this.getActiveCell()) {\n                var offset = this.getOffset(range[2], range[3]);\n                if (isMergeRange) {\n                    offset.left = { idx: 0, size: 0 };\n                }\n                (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.setPosition)(this.parent, this.getActiveCell(), range, 'e-active-cell', preventAnimation);\n            }\n            this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_1__.activeCellChanged, null);\n        }\n        else {\n            (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.setPosition)(this.parent, this.getActiveCell(), range, 'e-active-cell', preventAnimation);\n        }\n    };\n    Selection.prototype.getOffset = function (rowIdx, colIdx) {\n        var offset = { left: { idx: 0, size: 0 }, top: { idx: 0, size: 0 } };\n        if (this.parent.scrollModule) {\n            if (colIdx >= this.parent.scrollModule.offset.left.idx) {\n                offset.left = this.parent.scrollModule.offset.left;\n            }\n            if (rowIdx >= this.parent.scrollModule.offset.top.idx) {\n                offset.top = this.parent.scrollModule.offset.top;\n            }\n        }\n        return offset;\n    };\n    Selection.prototype.getSelectionElement = function (e, selectedRowColIdx) {\n        var sheet = this.parent.getActiveSheet();\n        if (e && e.ctrlKey && !this.parent.isEdit) {\n            if ((0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isMouseUp)(e) || (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isMouseMove)(e)) {\n                if (sheet.frozenColumns || sheet.frozenRows) {\n                    var ele = this.parent.getMainContent().querySelector('.e-cur-selection');\n                    if (ele) {\n                        return ele;\n                    }\n                    else {\n                        ele = this.parent.element.querySelector('.e-multi-range');\n                        return ele && ele.cloneNode();\n                    }\n                }\n                else {\n                    return this.parent.getMainContent().querySelector('.e-selection:last-child');\n                }\n            }\n            else {\n                var selElem = this.parent.getMainContent().getElementsByClassName('e-selection')[0];\n                var ele = selElem.cloneNode();\n                ele.classList.add('e-multi-range');\n                if (sheet.frozenColumns || sheet.frozenRows) {\n                    if (!sheet.selectedRange.includes(' ')) {\n                        selElem.classList.remove('e-hide');\n                        (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.setPosition)(this.parent, selElem, (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getSwapRange)((0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeIndexes)(sheet.selectedRange)), undefined, false, true);\n                    }\n                    if (!this.parent.getMainContent().querySelector('.e-multi-range') && selElem.classList.contains('e-hide')) {\n                        return selElem;\n                    }\n                    return ele;\n                }\n                else {\n                    selElem.classList.remove('e-hide');\n                    return this.parent.getMainContent().appendChild(ele);\n                }\n            }\n        }\n        else if (selectedRowColIdx > -1) {\n            return ((sheet.frozenRows || sheet.frozenColumns) ?\n                this.parent.element.querySelector('.e-sheet').getElementsByClassName('e-selection')[selectedRowColIdx] :\n                this.parent.getMainContent().getElementsByClassName('e-selection')[selectedRowColIdx]);\n        }\n        else {\n            var elems = [].slice.call(this.parent.element.getElementsByClassName('e-multi-range'));\n            elems.forEach(function (ele) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.remove)(ele);\n            });\n            return this.parent.getMainContent().getElementsByClassName('e-selection')[0];\n        }\n    };\n    Selection.prototype.getActiveCell = function () {\n        return this.parent.getMainContent().getElementsByClassName('e-active-cell')[0];\n    };\n    Selection.prototype.getSheetElement = function () {\n        return document.getElementById(this.parent.element.id + '_sheet');\n    };\n    Selection.prototype.highlightHdr = function (range, isMultiRange, isRowRefresh, isColRefresh) {\n        var _this = this;\n        if (isRowRefresh === void 0) { isRowRefresh = true; }\n        if (isColRefresh === void 0) { isColRefresh = true; }\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.showHeaders) {\n            if (!isMultiRange) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.removeClass)(this.getSheetElement().querySelectorAll('.e-highlight'), 'e-highlight');\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.removeClass)(this.getSheetElement().querySelectorAll('.e-prev-highlight'), 'e-prev-highlight');\n            }\n            var selectAllEle = this.parent.element.getElementsByClassName('e-select-all-cell')[0];\n            if (selectAllEle) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.removeClass)([selectAllEle], ['e-prev-highlight-right', 'e-prev-highlight-bottom']);\n            }\n            var rowHdr = [];\n            var colHdr = [];\n            var swapRange_1 = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getSwapRange)(range);\n            if (this.isRowSelected) {\n                swapRange_1[1] = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_4__.skipHiddenIdx)(sheet, swapRange_1[1], true, 'columns');\n            }\n            if (this.isColSelected) {\n                swapRange_1[0] = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_4__.skipHiddenIdx)(sheet, swapRange_1[0], true);\n            }\n            var frozenIdx_1 = [0, 0, 0, 0];\n            var indexes_1 = [0, 0, 0, 0];\n            var topLeftIndex_1 = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getCellIndexes)(sheet.topLeftCell);\n            var i_1;\n            var j_1;\n            var updateIndex = function (freezePane, layout, offset) {\n                var idx;\n                var hiddenCount;\n                if (freezePane && swapRange_1[i_1] < freezePane) {\n                    topLeftIndex_1[i_1] = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_4__.skipHiddenIdx)(sheet, topLeftIndex_1[i_1], true, layout);\n                    var startIdx = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_4__.skipHiddenIdx)(sheet, swapRange_1[i_1], true, layout);\n                    if (startIdx === topLeftIndex_1[i_1]) {\n                        swapRange_1[i_1] = startIdx;\n                    }\n                    hiddenCount = _this.parent.hiddenCount(topLeftIndex_1[i_1], swapRange_1[i_1] - 1, layout, sheet);\n                    frozenIdx_1[i_1] = swapRange_1[i_1] - hiddenCount - topLeftIndex_1[i_1];\n                    idx = swapRange_1[j_1] < freezePane ? swapRange_1[j_1] : freezePane - 1;\n                    frozenIdx_1[j_1] = idx - _this.parent.hiddenCount(swapRange_1[i_1], idx, layout, sheet) - hiddenCount -\n                        topLeftIndex_1[i_1] + 1;\n                    idx = _this.parent.viewport[\"\" + offset] + freezePane;\n                    if (swapRange_1[j_1] >= idx) {\n                        indexes_1[i_1] = 0;\n                        indexes_1[i_1] -= _this.parent.hiddenCount(idx, idx, layout, sheet);\n                        indexes_1[j_1] = swapRange_1[j_1] - _this.parent.hiddenCount(idx, swapRange_1[j_1], layout, sheet) - idx + 1;\n                    }\n                }\n                else {\n                    idx = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_4__.skipHiddenIdx)(sheet, _this.parent.viewport[\"\" + offset] + freezePane, true, layout);\n                    var startIdx = (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_4__.skipHiddenIdx)(sheet, swapRange_1[i_1], true, layout);\n                    if (idx === startIdx) {\n                        swapRange_1[i_1] = idx;\n                    }\n                    hiddenCount = _this.parent.hiddenCount(idx, swapRange_1[i_1] - 1, layout, sheet);\n                    indexes_1[i_1] = swapRange_1[i_1] - hiddenCount - idx;\n                    indexes_1[j_1] = swapRange_1[j_1] - _this.parent.hiddenCount(swapRange_1[i_1], swapRange_1[j_1], layout, sheet) - hiddenCount - idx + 1;\n                }\n            };\n            var updateCell_1 = function (idx, parent, hdrArr) {\n                var header = [].slice.call(parent.getElementsByClassName('e-header-cell'));\n                for (var k = idx[i_1]; k < idx[j_1]; k++) {\n                    if (header[k]) {\n                        hdrArr.push(header[k]);\n                    }\n                }\n            };\n            if (isRowRefresh) {\n                i_1 = 0;\n                j_1 = 2;\n                updateIndex(this.parent.frozenRowCount(sheet), 'rows', 'topIndex');\n                if (sheet.frozenRows) {\n                    var selectAllBody = this.parent.getSelectAllContent().querySelector('tbody');\n                    if (selectAllBody) {\n                        updateCell_1(frozenIdx_1, selectAllBody, rowHdr);\n                    }\n                }\n                updateCell_1(indexes_1, this.parent.getRowHeaderContent(), rowHdr);\n            }\n            if (isColRefresh) {\n                i_1 = 1;\n                j_1 = 3;\n                updateIndex(this.parent.frozenColCount(sheet), 'columns', 'leftIndex');\n                if (sheet.frozenColumns) {\n                    var selectAllHdr = this.parent.getSelectAllContent().querySelector('thead');\n                    if (selectAllHdr) {\n                        updateCell_1(frozenIdx_1, selectAllHdr, colHdr);\n                    }\n                }\n                updateCell_1(indexes_1, this.parent.getColumnHeaderContent(), colHdr);\n            }\n            if (sheet.isProtected && !sheet.protectSettings.selectCells) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.removeClass)([].concat(rowHdr, colHdr), 'e-highlight');\n            }\n            else {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.addClass)([].concat(rowHdr, colHdr), 'e-highlight');\n            }\n            if (rowHdr.length && rowHdr[0].parentElement.previousElementSibling) {\n                rowHdr[0].parentElement.previousElementSibling.classList.add('e-prev-highlight');\n            }\n            if (colHdr.length && colHdr[0].previousElementSibling) {\n                colHdr[0].previousElementSibling.classList.add('e-prev-highlight');\n            }\n            if (this.isRowSelected && this.isColSelected) {\n                if (sheet.isProtected && !sheet.protectSettings.selectCells) {\n                    document.getElementById(this.parent.element.id + \"_select_all\").classList.remove('e-highlight');\n                }\n                else {\n                    document.getElementById(this.parent.element.id + \"_select_all\").classList.add('e-highlight');\n                }\n            }\n            if (selectAllEle) {\n                if ((0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_4__.skipHiddenIdx)(sheet, swapRange_1[0], true) === (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_4__.skipHiddenIdx)(sheet, 0, true)) {\n                    selectAllEle.classList.add('e-prev-highlight-bottom');\n                }\n                if ((0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_4__.skipHiddenIdx)(sheet, swapRange_1[1], true, 'columns') === (0,_workbook_common_index__WEBPACK_IMPORTED_MODULE_4__.skipHiddenIdx)(sheet, 0, true, 'columns')) {\n                    selectAllEle.classList.add('e-prev-highlight-right');\n                }\n            }\n        }\n    };\n    Selection.prototype.protectHandler = function () {\n        var range = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeIndexes)(this.parent.getActiveSheet().selectedRange);\n        var swapRange = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getSwapRange)(range);\n        var actRange = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getCellIndexes)(this.parent.getActiveSheet().activeCell);\n        var inRange = swapRange[0] <= actRange[0] && swapRange[2] >= actRange[0] && swapRange[1] <= actRange[1]\n            && swapRange[3] >= actRange[1];\n        this.selectRangeByIdx(range, null, null, inRange);\n    };\n    Selection.prototype.initiateFormulaSelection = function (args) {\n        this.processFormulaEditRange(args.range, args.formulaSheetIdx);\n    };\n    Selection.prototype.processFormulaEditRange = function (val, formulaStartSheetIdx) {\n        var str;\n        var formulaSheetIdx = formulaStartSheetIdx;\n        var i = 0;\n        var eventArgs = { formula: val };\n        this.parent.notify(_workbook_common_index__WEBPACK_IMPORTED_MODULE_4__.parseFormulaArgument, eventArgs);\n        var parsedVal = eventArgs.formulaArr;\n        var len = parsedVal.length;\n        var ctrlKeyCount = 0;\n        var formulaBorder = [['e-vborderright', 'e-vborderbottom'], ['e-pborderright', 'e-pborderbottom'],\n            ['e-cborderright', 'e-cborderbottom'], ['e-gborderright', 'e-gborderbottom'], ['e-oborderright', 'e-oborderbottom'],\n            ['e-bborderright', 'e-bborderbottom']];\n        this.clearBorder();\n        var actSheetIdx = this.parent.getActiveSheet().id - 1;\n        while (i < len) {\n            str = parsedVal[i];\n            if (this.invalidOperators.indexOf(str) > -1) {\n                break;\n            }\n            if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isCellReference)(str.toUpperCase())) {\n                str = str.replace(/\\$/g, '');\n                if (i > 0) {\n                    if (parsedVal[i - 1].lastIndexOf('!') === parsedVal[i - 1].length - 1) {\n                        var sheetName = parsedVal[i - 1].substring(1, parsedVal[i - 1].lastIndexOf('!') - 1);\n                        formulaSheetIdx = sheetName ? (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.getSheetIndex)(this.parent, sheetName) : formulaSheetIdx;\n                    }\n                }\n                if (parsedVal[i + 1] === ':') {\n                    i++;\n                    if (parsedVal[i + 1] && (0,_workbook_index__WEBPACK_IMPORTED_MODULE_1__.isCellReference)(parsedVal[i + 1].toUpperCase())) {\n                        str = str + ':' + parsedVal[i + 1];\n                        i++;\n                    }\n                }\n                if (actSheetIdx === formulaSheetIdx) {\n                    this.updateFormulaEditRange(str, ctrlKeyCount, formulaBorder);\n                }\n                formulaSheetIdx = formulaStartSheetIdx;\n                ctrlKeyCount++;\n            }\n            i++;\n        }\n    };\n    Selection.prototype.updateFormulaEditRange = function (str, i, formulaBorder) {\n        var indices = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeIndexes)(str);\n        this.formulaRange[i] = str;\n        this.dStartCell = { rowIndex: indices[0], colIndex: indices[1] };\n        this.dEndCell = { rowIndex: indices[2], colIndex: indices[3] };\n        this.focusBorder(this.dStartCell, this.dEndCell, formulaBorder[i % 6]);\n    };\n    Selection.prototype.chartBorderHandler = function (args) {\n        this.focusBorder(args.startcell, args.endcell, args.classes, true);\n    };\n    Selection.prototype.focusBorder = function (startcell, endcell, classes, isChart) {\n        isChart = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.isNullOrUndefined)(isChart) ? false : isChart;\n        var sheet = this.parent.getActiveSheet();\n        var range = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getSwapRange)([startcell.rowIndex, startcell.colIndex, endcell.rowIndex, endcell.colIndex]);\n        var topLeftIdx = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_3__.getRangeIndexes)(sheet.topLeftCell);\n        var hiddenCol = this.parent.hiddenCount(topLeftIdx[1], range[3] - 1, 'columns', sheet);\n        if (isChart && hiddenCol > 0) {\n            range[1] -= hiddenCol;\n            range[3] -= hiddenCol;\n        }\n        if (sheet.frozenRows || sheet.frozenColumns) {\n            var rangeReference = this.parent.createElement('div', {\n                className: isChart ? 'e-range-indicator e-chart-range' : 'e-range-indicator e-formuala-range'\n            });\n            rangeReference.appendChild(this.parent.createElement('div', { className: 'e-top' }));\n            rangeReference.appendChild(this.parent.createElement('div', { className: 'e-bottom' }));\n            rangeReference.appendChild(this.parent.createElement('div', { className: 'e-left' }));\n            rangeReference.appendChild(this.parent.createElement('div', { className: 'e-right' }));\n            (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.setPosition)(this.parent, rangeReference, range, 'e-range-indicator');\n            return;\n        }\n        var minr = range[0];\n        var minc = range[1];\n        var maxr = range[2];\n        var maxc = range[3];\n        if (minr) {\n            (this.getEleFromRange([minr - 1, minc, minr - 1, maxc])).forEach(function (td) {\n                if (td) {\n                    td.classList.add(classes[1]);\n                    if (!isChart) {\n                        td.classList.add('e-formularef-selection');\n                    }\n                }\n            }); // top\n        }\n        (this.getEleFromRange([minr, maxc, maxr, maxc])).forEach(function (td) {\n            if (td) {\n                td.classList.add(classes[0]);\n                if (!isChart) {\n                    td.classList.add('e-formularef-selection');\n                }\n            }\n        }); // right\n        this.getEleFromRange([maxr, minc, maxr, maxc]).forEach(function (td) {\n            if (td) {\n                td.classList.add(classes[1]);\n                if (!isChart) {\n                    td.classList.add('e-formularef-selection');\n                }\n            }\n        }); // bottom\n        if (minc) {\n            (this.getEleFromRange([minr, minc - 1, maxr, minc - 1])).forEach(function (td) {\n                if (td) {\n                    td.classList.add(classes[0]);\n                    if (!isChart) {\n                        td.classList.add('e-formularef-selection');\n                    }\n                }\n            }); // left\n        }\n    };\n    Selection.prototype.getEleFromRange = function (range) {\n        var startRIndex = range[0];\n        var startCIndex = range[1];\n        var endRIndex = range[2];\n        var endCIndex = range[3];\n        var i;\n        var rowIdx;\n        var temp;\n        var tempCells = [];\n        var rowCells;\n        var cells = [];\n        if (startRIndex > endRIndex) {\n            temp = startRIndex;\n            startRIndex = endRIndex;\n            endRIndex = temp;\n        }\n        if (startCIndex > endCIndex) {\n            temp = startCIndex;\n            startCIndex = endCIndex;\n            endCIndex = temp;\n        }\n        if (this.parent.scrollSettings.enableVirtualization) {\n            for (i = startRIndex; i <= endRIndex; i++) {\n                rowIdx = i;\n                if (rowIdx > -1) {\n                    var row = this.parent.getRow(rowIdx, null);\n                    if (row) {\n                        rowCells = row.getElementsByClassName('e-cell');\n                        tempCells = (endCIndex === startCIndex) ?\n                            [rowCells[endCIndex]] : this.getRowCells(rowCells, startCIndex, endCIndex + 1);\n                        this.merge(cells, tempCells);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    Selection.prototype.getRowCells = function (rowCells, startCIndex, endCIndex) {\n        var tdCol = [];\n        for (startCIndex; startCIndex < endCIndex; startCIndex++) {\n            if (rowCells[startCIndex]) {\n                tdCol.push(rowCells[startCIndex]);\n            }\n        }\n        return tdCol;\n    };\n    Selection.prototype.merge = function (first, second) {\n        if (!first || !second) {\n            return;\n        }\n        Array.prototype.push.apply(first, second);\n    };\n    Selection.prototype.clearBorder = function () {\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.frozenColumns || sheet.frozenRows) {\n            var formualIndicator = [].slice.call(this.parent.element.getElementsByClassName('e-formuala-range'));\n            formualIndicator.forEach(function (indicator) { (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.detach)(indicator); });\n            return;\n        }\n        var borderEleColl = this.parent.element.getElementsByClassName('e-formularef-selection');\n        for (var idx = borderEleColl.length - 1; idx >= 0; idx--) {\n            var td = borderEleColl[idx];\n            var classArr = ['e-vborderright', 'e-vborderbottom', 'e-pborderright', 'e-pborderbottom',\n                'e-cborderright', 'e-cborderbottom', 'e-gborderright', 'e-gborderbottom', 'e-oborderright',\n                'e-oborderbottom', 'e-bborderright', 'e-bborderbottom', 'e-formularef-selection'];\n            for (var idx_1 = 0; idx_1 < classArr.length; idx_1++) {\n                td.classList.remove(classArr[idx_1]);\n            }\n        }\n        // for (let idx: number = 0; idx < borderEleColl.length; idx++) {\n        //     const td: HTMLElement = borderEleColl[idx] as HTMLElement;\n        // }\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @private\n     * @returns {string} - Get the module name.\n     */\n    Selection.prototype.getModuleName = function () {\n        return 'selection';\n    };\n    Selection.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return Selection;\n}());\n\n\n\n//# sourceURL=webpack://ej2-vue-samples/./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/actions/selection.js?");

/***/ })

}]);