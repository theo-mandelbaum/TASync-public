"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkej2_vue_samples"] = self["webpackChunkej2_vue_samples"] || []).push([["chunk-vendors-node_modules_syncfusion_ej2-spreadsheet_src_spreadsheet_actions_edit_js-d3c55d0d"],{

/***/ "./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/actions/edit.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/actions/edit.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Edit: () => (/* binding */ Edit)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"./node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _workbook_common_address__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../workbook/common/address */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/workbook/common/address.js\");\n/* harmony import */ var _common_index__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/index */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/common/index.js\");\n/* harmony import */ var _workbook_common_event__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../workbook/common/event */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/workbook/common/event.js\");\n/* harmony import */ var _workbook_base_index__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../workbook/base/index */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/workbook/base/index.js\");\n/* harmony import */ var _workbook_index__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../workbook/index */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/workbook/index.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * The `Protect-Sheet` module is used to handle the Protecting functionalities in Spreadsheet.\n */\nvar Edit = /** @class */ (function () {\n    /**\n     * Constructor for edit module in Spreadsheet.\n     *\n     * @param {Spreadsheet} parent - Constructor for edit module in Spreadsheet.\n     * @private\n     */\n    function Edit(parent) {\n        this.editorElem = null;\n        this.editCellData = {};\n        this.isEdit = false;\n        this.isCellEdit = true;\n        this.isNewValueEdit = true;\n        this.isAltEnter = false;\n        this.curEndPos = null;\n        this.curStartPos = null;\n        this.uniqueColl = '';\n        this.uniqueActCell = '';\n        this.isSpill = false;\n        this.keyCodes = {\n            BACKSPACE: 8,\n            SPACE: 32,\n            TAB: 9,\n            DELETE: 46,\n            ESC: 27,\n            ENTER: 13,\n            FIRSTALPHABET: 65,\n            LASTALPHABET: 90,\n            FIRSTNUMBER: 48,\n            LASTNUMBER: 59,\n            FIRSTNUMPAD: 96,\n            LASTNUMPAD: 111,\n            SYMBOLSETONESTART: 186,\n            SYMBOLSETONEEND: 192,\n            SYMBOLSETTWOSTART: 219,\n            SYMBOLSETTWOEND: 222,\n            FIREFOXEQUALPLUS: 61,\n            FIREFOXMINUS: 173,\n            F2: 113\n        };\n        this.formulaErrorStrings = [\n            'mismatched parentheses',\n            'requires 3 arguments',\n            'improper formula',\n            'empty expression',\n            'mismatched string quotes',\n            'wrong number of arguments',\n            'invalid arguments'\n        ];\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookEdit);\n    }\n    /**\n     * To destroy the edit module.\n     *\n     * @returns {void} - To destroy the edit module.\n     * @hidden\n     */\n    Edit.prototype.destroy = function () {\n        if (this.isEdit) {\n            this.cancelEdit(true, false);\n        }\n        this.removeEventListener();\n        this.editorElem = null;\n        if (this.formulaErrorStrings) {\n            this.formulaErrorStrings = [];\n        }\n        if (this.editCellData) {\n            this.editCellData = {};\n        }\n        if (this.keyCodes) {\n            this.keyCodes = {};\n        }\n        this.parent = null;\n    };\n    Edit.prototype.addEventListener = function () {\n        if (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isDevice && _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.info.name === 'safari' && (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isIos || _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isIos7)) {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.parent.element, 'touchend', this.tapHandler, this);\n        }\n        else {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.parent.element, 'dblclick', this.dblClickHandler, this);\n        }\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_2__.mouseDown, this.mouseDownHandler, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_2__.keyUp, this.keyUpHandler, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_2__.keyDown, this.keyDownHandler, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_2__.editOperation, this.performEditOperation, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_2__.initiateCur, this.initiateCurPosition, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_2__.editValue, this.updateFormulaBarValue, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_2__.addressHandle, this.addressHandler, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_2__.initiateEdit, this.initiateRefSelection, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_2__.forRefSelRender, this.refSelectionRender, this);\n        this.parent.on(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.checkUniqueRange, this.checkUniqueRange, this);\n        this.parent.on(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.reApplyFormula, this.reApplyFormula, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_2__.activeSheetChanged, this.sheetChangeHandler, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_2__.readonlyAlert, this.readOnlyAlertHandler, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_2__.finiteAlert, this.finiteAlertHandler, this);\n    };\n    Edit.prototype.removeEventListener = function () {\n        if (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isDevice && _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.info.name === 'safari' && (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isIos || _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isIos7)) {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.parent.element, 'touchend', this.tapHandler);\n        }\n        else {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.parent.element, 'dblclick', this.dblClickHandler);\n        }\n        if (!this.parent.isDestroyed) {\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_2__.mouseDown, this.mouseDownHandler);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_2__.keyUp, this.keyUpHandler);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_2__.keyDown, this.keyDownHandler);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_2__.editOperation, this.performEditOperation);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_2__.initiateCur, this.initiateCurPosition);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_2__.editValue, this.updateFormulaBarValue);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_2__.addressHandle, this.addressHandler);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_2__.initiateEdit, this.initiateRefSelection);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_2__.forRefSelRender, this.refSelectionRender);\n            this.parent.off(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.checkUniqueRange, this.checkUniqueRange);\n            this.parent.off(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.reApplyFormula, this.reApplyFormula);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_2__.activeSheetChanged, this.sheetChangeHandler);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_2__.readonlyAlert, this.readOnlyAlertHandler);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_2__.finiteAlert, this.finiteAlertHandler);\n        }\n    };\n    /**\n     * Get the module name.\n     *\n     * @returns {string} - Get the module name.\n     * @private\n     */\n    Edit.prototype.getModuleName = function () {\n        return 'edit';\n    };\n    Edit.prototype.performEditOperation = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'renderEditor':\n                this.renderEditor();\n                if (args.initLoad && _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isDevice && _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.info.name === 'safari' && (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isIos || _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isIos7)) {\n                    var focusEditEle_1 = this.parent.createElement('div', { className: 'e-ss-focus-edit', attrs: { 'contentEditable': 'true', 'inputmode': 'none', 'tabindex': '-1' } });\n                    var sheetPanel = this.parent.element.querySelector('.e-sheet-panel');\n                    if (sheetPanel) {\n                        sheetPanel.style.position = 'relative';\n                        sheetPanel.appendChild(focusEditEle_1);\n                    }\n                    this.parent.element.onfocus = function () {\n                        (0,_common_index__WEBPACK_IMPORTED_MODULE_2__.focus)(focusEditEle_1);\n                    };\n                }\n                break;\n            case 'refreshEditor':\n                this.refreshEditor(args.value, args.refreshFormulaBar, args.refreshEditorElem, args.isAppend, args.trigEvent);\n                if (args.refreshCurPos) {\n                    this.setCursorPosition();\n                }\n                break;\n            case 'startEdit':\n                if (!this.isEdit) {\n                    this.isNewValueEdit = args.isNewValueEdit;\n                    this.startEdit(args.address, args.value, args.refreshCurPos);\n                }\n                else {\n                    var isEdit = false;\n                    var arg = { isEdit: isEdit };\n                    this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.isFormulaBarEdit, arg);\n                    if (arg.isEdit) {\n                        this.isNewValueEdit = args.isNewValueEdit;\n                        this.startEdit(args.address, args.value, args.refreshCurPos);\n                    }\n                }\n                break;\n            case 'endEdit':\n                if (this.isEdit) {\n                    this.endEdit(args.refreshFormulaBar, null, args.isPublic);\n                }\n                break;\n            case 'cancelEdit':\n                if (this.isEdit) {\n                    this.cancelEdit(args.refreshFormulaBar);\n                }\n                break;\n            case 'getCurrentEditValue':\n                args.editedValue = this.editCellData.value;\n                if (args.endFormulaRef !== undefined) {\n                    args.endFormulaRef = this.endFormulaRef;\n                }\n                break;\n            case 'refreshDependentCellValue':\n                this.refreshDependentCellValue(args.rowIdx, args.colIdx, args.sheetIdx);\n                break;\n            case 'getElement':\n                args.element = this.getEditElement(this.parent.getActiveSheet());\n                break;\n            case 'focusEditorElem':\n                this.editorElem.focus();\n                break;\n            case 'getCurrentEditSheetIdx':\n                args.sheetIndex = this.editCellData.sheetIndex;\n                break;\n        }\n    };\n    Edit.prototype.keyUpHandler = function (e) {\n        if (this.isEdit) {\n            var editElement = this.getEditElement(this.parent.getActiveSheet());\n            if (e.altKey && e.keyCode === 13) {\n                editElement.focus();\n                this.altEnter();\n                this.isAltEnter = true;\n            }\n            else if (this.isCellEdit && this.editCellData.value !== editElement.textContent && e.keyCode !== 16 && (!e.shiftKey ||\n                (e.shiftKey && !(0,_common_index__WEBPACK_IMPORTED_MODULE_2__.isNavigationKey)(e.keyCode)))) {\n                this.refreshEditor(editElement.textContent, this.isCellEdit);\n            }\n            var isFormulaEdit = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.checkIsFormula)(this.editCellData.value, true);\n            if (isFormulaEdit && (!e || (e.keyCode !== 16 && e.keyCode !== 17 && (!e.shiftKey || !(0,_common_index__WEBPACK_IMPORTED_MODULE_2__.isNavigationKey)(e.keyCode))))) {\n                this.updateFormulaReference(editElement);\n                if (this.endFormulaRef) {\n                    var curOffset = this.getCurPosition();\n                    var validCharacters = ['+', '-', '*', '/', this.parent.listSeparator, '(', '=', '&', ':'];\n                    if (curOffset.end && validCharacters.indexOf(this.editCellData.value[curOffset.end - 1]) > -1) {\n                        this.endFormulaRef = false;\n                    }\n                }\n            }\n        }\n    };\n    Edit.prototype.updateFormulaReference = function (editElement) {\n        var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n        if (formulaRefIndicator) {\n            formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n        }\n        if (this.editCellData.value !== editElement.textContent) {\n            this.refreshEditor(editElement.textContent, true);\n        }\n        var sheetIdx = this.editCellData.sheetIndex;\n        var editValue = this.editCellData.value;\n        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.initiateFormulaReference, { range: editValue, formulaSheetIdx: sheetIdx });\n    };\n    Edit.prototype.keyDownHandler = function (e) {\n        var trgtElem = e.target;\n        var keyCode = e.keyCode;\n        var sheet = this.parent.getActiveSheet();\n        var actCell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.getCellIndexes)(sheet.activeCell);\n        var cell = (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getCell)(actCell[0], actCell[1], sheet, false, true);\n        var isKeyboardShortcut = this.parent.enableKeyboardShortcut;\n        if (!isKeyboardShortcut && keyCode === this.keyCodes.SPACE && !e.ctrlKey && !e.altKey && !e.metaKey) {\n            e.preventDefault();\n            return;\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(trgtElem, '.e-spreadsheet .e-dialog')) {\n            if (!sheet.isProtected || trgtElem.classList.contains('e-sheet-rename') || !(0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.isLocked)(cell, (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getColumn)(sheet, actCell[1])) || ((trgtElem.classList.contains('e-formula-bar') || trgtElem.classList.contains('e-combobox')) && !trgtElem.disabled)) {\n                if (this.isEdit) {\n                    var editorElem = this.getEditElement(sheet);\n                    var isFormulaEdit = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.checkIsFormula)(this.editCellData.value, true);\n                    if (this.isCellEdit || (isFormulaEdit && this.editCellData.value !== editorElem.textContent && e.keyCode !== 16 &&\n                        e.keyCode !== 17)) {\n                        if (actCell[1] < this.parent.frozenColCount(sheet) && (!sheet.frozenRows || actCell[0] >=\n                            this.parent.frozenRowCount(sheet)) && editorElem && editorElem.style.height !== 'auto') {\n                            if ((0,_common_index__WEBPACK_IMPORTED_MODULE_2__.getTextWidth)(editorElem.textContent, cell.style, this.parent.cellStyle) > parseInt(editorElem.style.maxWidth, 10)) {\n                                editorElem.style.height = 'auto';\n                            }\n                        }\n                        if ((0,_common_index__WEBPACK_IMPORTED_MODULE_2__.getTextWidth)(editorElem.textContent, cell.style, this.parent.cellStyle) > parseInt(editorElem.style.maxWidth, 10) - 5) { // 5 decreased for padding.\n                            editorElem.style.height = 'auto';\n                        }\n                        if (actCell[0] < this.parent.frozenRowCount(sheet) && editorElem && !editorElem.style.overflow && (0,_common_index__WEBPACK_IMPORTED_MODULE_2__.getTextWidth)(editorElem.textContent, cell.style, this.parent.cellStyle) > parseInt(editorElem.style.maxWidth, 10)) {\n                            editorElem.style.overflow = 'auto';\n                        }\n                        if (!e.shiftKey || (e.shiftKey && !(0,_common_index__WEBPACK_IMPORTED_MODULE_2__.isNavigationKey)(e.keyCode))) {\n                            this.refreshEditor(editorElem.textContent, this.isCellEdit, false, false, false);\n                        }\n                    }\n                    if (!e.altKey) {\n                        switch (keyCode) {\n                            case this.keyCodes.ENTER:\n                                if (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isWindows) {\n                                    e.preventDefault();\n                                }\n                                if (!isFormulaEdit) {\n                                    this.endEdit(false, e);\n                                }\n                                else {\n                                    var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.getSheet)(this.parent, this.editCellData.sheetIndex).id === sheet.id) {\n                                        this.endEdit(false, e);\n                                    }\n                                    else {\n                                        this.parent.goTo(this.editCellData.fullAddr);\n                                        this.endEdit(false, e);\n                                    }\n                                }\n                                break;\n                            case this.keyCodes.TAB:\n                                if (!this.hasFormulaSuggSelected()) {\n                                    this.endEdit(false, e);\n                                }\n                                break;\n                            case this.keyCodes.ESC:\n                                if (isKeyboardShortcut) {\n                                    this.cancelEdit(true, true, e);\n                                }\n                                break;\n                        }\n                    }\n                }\n                else if (trgtElem.classList.contains('e-spreadsheet') || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(trgtElem, '.e-sheet-panel')) {\n                    if (keyCode === 13 && trgtElem.contentEditable === 'true') {\n                        e.preventDefault();\n                    }\n                    var key = String.fromCharCode(keyCode);\n                    var isAlphabet = (keyCode >= this.keyCodes.FIRSTALPHABET && keyCode <= this.keyCodes.LASTALPHABET) ||\n                        (key.toLowerCase() !== key.toUpperCase() && !(keyCode >= 112 && keyCode <= 123));\n                    var isNumeric = (keyCode >= this.keyCodes.FIRSTNUMBER && keyCode <= this.keyCodes.LASTNUMBER);\n                    var isNumpadKeys = (keyCode >= this.keyCodes.FIRSTNUMPAD && keyCode <= this.keyCodes.LASTNUMPAD);\n                    var isSymbolkeys = (keyCode >= this.keyCodes.SYMBOLSETONESTART &&\n                        keyCode <= this.keyCodes.SYMBOLSETONEEND);\n                    if (!isSymbolkeys) {\n                        isSymbolkeys = (keyCode >= this.keyCodes.SYMBOLSETTWOSTART && keyCode <= this.keyCodes.SYMBOLSETTWOEND);\n                    }\n                    var isFirefoxExceptionkeys = (keyCode === this.keyCodes.FIREFOXEQUALPLUS) ||\n                        (keyCode === this.keyCodes.FIREFOXMINUS);\n                    var isF2Edit = (!e.shiftKey && !e.ctrlKey && !e.metaKey && keyCode === this.keyCodes.F2) &&\n                        isKeyboardShortcut;\n                    var isBackSpace = keyCode === this.keyCodes.BACKSPACE && isKeyboardShortcut;\n                    var isMacDelete = /(Macintosh|MacIntel|MacPPC|Mac68K|Mac|Mac OS|iPod|iPad)/i.test(navigator.userAgent) && isBackSpace;\n                    var readonlyDialog = this.parent.element.querySelector('.e-readonly-alert-dlg');\n                    var overlayElements = this.parent.element.getElementsByClassName('e-ss-overlay-active');\n                    if ((!e.ctrlKey && !e.metaKey && !e.altKey && ((!e.shiftKey && keyCode === this.keyCodes.SPACE) || isAlphabet || isNumeric ||\n                        isNumpadKeys || isSymbolkeys || (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.info.name === 'mozilla' && isFirefoxExceptionkeys))) || isF2Edit || isBackSpace) {\n                        if (isF2Edit) {\n                            this.isNewValueEdit = false;\n                        }\n                        if (!readonlyDialog) {\n                            if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.isReadOnlyCells)(this.parent) && overlayElements.length === 0) {\n                                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.readonlyAlert, null);\n                            }\n                            else if (overlayElements.length) {\n                                if (isBackSpace && !isMacDelete) {\n                                    this.editingHandler('delete');\n                                }\n                            }\n                            else {\n                                this.startEdit(null, null, true, true);\n                                (0,_common_index__WEBPACK_IMPORTED_MODULE_2__.focus)(this.getEditElement(sheet));\n                            }\n                        }\n                    }\n                    if ((keyCode === this.keyCodes.DELETE || isMacDelete) && isKeyboardShortcut) {\n                        var islockcell = sheet.isProtected && (0,_common_index__WEBPACK_IMPORTED_MODULE_2__.isLockedCells)(this.parent);\n                        if (!readonlyDialog) {\n                            if (islockcell) {\n                                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.editAlert, null);\n                            }\n                            else if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.isReadOnlyCells)(this.parent) && overlayElements.length === 0) {\n                                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.readonlyAlert, null);\n                            }\n                            else {\n                                this.editingHandler('delete');\n                                this.parent.notify(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.activeCellChanged, null);\n                            }\n                        }\n                    }\n                }\n            }\n            else if (((keyCode >= this.keyCodes.FIRSTALPHABET && keyCode <= this.keyCodes.LASTALPHABET) ||\n                (keyCode >= this.keyCodes.FIRSTNUMBER && keyCode <= this.keyCodes.LASTNUMBER)\n                || (keyCode === this.keyCodes.DELETE) || (keyCode === this.keyCodes.BACKSPACE) || (keyCode === this.keyCodes.SPACE)\n                || (keyCode >= this.keyCodes.FIRSTNUMPAD && keyCode <= this.keyCodes.LASTNUMPAD) ||\n                (keyCode >= this.keyCodes.SYMBOLSETONESTART && keyCode <= this.keyCodes.SYMBOLSETONEEND)\n                || (keyCode >= 219 && keyCode <= 222) || (!e.shiftKey && !e.ctrlKey && !e.metaKey && keyCode === this.keyCodes.F2))\n                && (keyCode !== 67) && (keyCode !== 89) && (keyCode !== 90)) {\n                if (sheet.protectSettings.insertLink && keyCode === 75) {\n                    return;\n                }\n                if (e.altKey && (keyCode === 65 || keyCode === 70 || keyCode === 72 || keyCode === 77\n                    || keyCode === 78 || keyCode === 87)) {\n                    return;\n                }\n                if (!e.ctrlKey && e.keyCode !== 70 && !this.parent.element.querySelector('.e-editAlert-dlg') &&\n                    !trgtElem.parentElement.classList.contains('e-unprotectpwd-content') &&\n                    !trgtElem.parentElement.classList.contains('e-password-content') &&\n                    !trgtElem.parentElement.classList.contains('e-sheet-password-content') &&\n                    !trgtElem.parentElement.classList.contains('e-unprotectsheetpwd-content') &&\n                    !trgtElem.parentElement.classList.contains('e-reenterpwd-content')) {\n                    this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.editAlert, null);\n                }\n            }\n        }\n    };\n    Edit.prototype.renderEditor = function () {\n        if (!this.editorElem || !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.select)('#' + this.parent.element.id + '_edit', this.parent.element)) {\n            var editor = this.parent.createElement('div', { id: this.parent.element.id + '_edit', className: 'e-spreadsheet-edit', attrs: { 'contentEditable': 'true',\n                    'role': 'textbox', 'spellcheck': 'false', 'aria-multiline': 'true' } });\n            if (this.parent.element.getElementsByClassName('e-spreadsheet-edit')[0]) {\n                this.parent.element.getElementsByClassName('e-spreadsheet-edit')[0].remove();\n            }\n            var sheetContentElem = this.parent.element.querySelector('.e-sheet-content');\n            if (!sheetContentElem) {\n                return;\n            }\n            sheetContentElem.appendChild(editor);\n            this.editorElem = editor;\n        }\n        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.formulaOperation, { action: 'renderAutoComplete' });\n    };\n    Edit.prototype.refreshEditor = function (value, refreshFormulaBar, refreshEditorElem, isAppend, trigEvent, prevCellValue) {\n        if (trigEvent === void 0) { trigEvent = true; }\n        if (isAppend) {\n            value = this.editCellData.value = this.editCellData.value + value;\n        }\n        else {\n            this.editCellData.value = prevCellValue ? prevCellValue : value;\n        }\n        var editorElem = this.getEditElement(this.parent.getActiveSheet());\n        if (refreshEditorElem && editorElem) {\n            editorElem.textContent = value;\n        }\n        if (refreshFormulaBar) {\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.formulaBarOperation, { action: 'refreshFormulabar', value: value });\n        }\n        if (this.parent.isEdit && editorElem && trigEvent && this.editCellData.value === editorElem.textContent) {\n            if (this.triggerEvent('cellEditing').cancel) {\n                this.cancelEdit(false, false, null, true);\n            }\n        }\n        // if (this.editorElem.scrollHeight + 2 <= this.editCellData.element.offsetHeight) {\n        //     this.editorElem.style.height = (this.editCellData.element.offsetHeight + 1) + 'px';\n        // } else {\n        //     this.editorElem.style.removeProperty('height');\n        // }\n    };\n    Edit.prototype.startEdit = function (address, value, refreshCurPos, preventFormulaReference) {\n        if (refreshCurPos === void 0) { refreshCurPos = true; }\n        if (this.parent.showSheetTabs) {\n            this.parent.element.querySelector('.e-add-sheet-tab').setAttribute('disabled', 'true');\n        }\n        var sheet = this.parent.getActiveSheet();\n        var range = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.getCellIndexes)(sheet.activeCell);\n        var cell = (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getCell)(range[0], range[1], sheet, false, true);\n        if (this.parent.calculationMode === 'Manual' && (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.checkIsFormula)(cell.formula)) {\n            this.editCellData.prevFormulaValue = cell.value;\n        }\n        if ((0,_common_index__WEBPACK_IMPORTED_MODULE_2__.hasTemplate)(this.parent, range[0], range[1], this.parent.activeSheetIndex)) {\n            var cellEle = this.parent.getCell(range[0], range[1]);\n            var isDelTemplate = false;\n            var value_1 = cellEle.innerHTML;\n            if (cellEle) {\n                if (value_1.indexOf('<') > -1 && value_1.indexOf('>') > -1 && value_1.indexOf('input') > -1) {\n                    isDelTemplate = true;\n                }\n            }\n            if (isDelTemplate) {\n                return;\n            }\n        }\n        var isMergedHiddenCell = this.updateEditCellDetail(address, value);\n        this.initiateEditor(refreshCurPos, isMergedHiddenCell);\n        this.positionEditor();\n        this.parent.isEdit = this.isEdit = true;\n        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.clearCopy, null);\n        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.enableToolbarItems, [{ enable: false }]);\n        if (cell.formula && !preventFormulaReference) {\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.initiateFormulaReference, { range: cell.formula, formulaSheetIdx: this.editCellData.sheetIndex });\n        }\n    };\n    Edit.prototype.setCursorPosition = function () {\n        var elem = this.getEditElement(this.parent.getActiveSheet());\n        var textLen = elem.textContent.length;\n        if (textLen) {\n            var selection = document.getSelection();\n            var range = document.createRange();\n            range.setStart(elem.firstChild, textLen);\n            range.collapse(true);\n            selection.removeAllRanges();\n            selection.addRange(range);\n        }\n        elem.focus();\n    };\n    Edit.prototype.hasFormulaSuggSelected = function () {\n        var suggDdlElem = document.getElementById(this.parent.element.id + '_ac_popup');\n        return suggDdlElem && suggDdlElem.style.visibility === 'visible' &&\n            suggDdlElem.querySelectorAll('.e-item-focus').length > 0;\n    };\n    Edit.prototype.editingHandler = function (action) {\n        var pictureElements = document.getElementsByClassName('e-ss-overlay-active');\n        var pictureLen = pictureElements.length;\n        var isSpill;\n        switch (action) {\n            case 'delete':\n                if (pictureLen > 0) {\n                    if (pictureElements[0].classList.contains('e-datavisualization-chart')) {\n                        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.deleteChart, {\n                            id: pictureElements[0].id, sheetIdx: this.parent.activeSheetIndex + 1\n                        });\n                    }\n                    else {\n                        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.deleteImage, {\n                            id: pictureElements[0].id, sheetIdx: this.parent.activeSheetIndex + 1\n                        });\n                    }\n                }\n                else {\n                    var sheet = this.parent.getActiveSheet();\n                    var address = sheet.selectedRange;\n                    var range = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getIndexesFromAddress)(address);\n                    range = range[0] > range[2] || range[1] > range[3] ? (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.getSwapRange)(range) : range;\n                    address = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(range);\n                    var cellDeleteArgs = { address: sheet.name + '!' + address, cancel: false };\n                    this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_5__.beginAction, { action: 'cellDelete', eventArgs: cellDeleteArgs });\n                    if (cellDeleteArgs.cancel) {\n                        return;\n                    }\n                    address = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeFromAddress)(cellDeleteArgs.address);\n                    range = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(address);\n                    (0,_common_index__WEBPACK_IMPORTED_MODULE_2__.clearRange)(this.parent, range, this.parent.activeSheetIndex);\n                    this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_5__.selectionComplete, {});\n                    if (range[0] === 0 && range[1] === 0 && range[2] >= sheet.usedRange.rowIndex && range[3] >= sheet.usedRange.colIndex) {\n                        this.parent.setUsedRange(0, 0, sheet, false, true);\n                    }\n                    var args = { cellIdx: range, isUnique: false };\n                    this.checkUniqueRange(args);\n                    if (args.isUnique) {\n                        var indexes = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(this.uniqueColl);\n                        var cell = (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getCell)(indexes[0], indexes[1], this.parent.getActiveSheet());\n                        if (cell && cell.value) {\n                            isSpill = cell.value.toString().indexOf('#SPILL!') > -1;\n                        }\n                    }\n                    if (args.isUnique && this.uniqueColl.split(':')[0] === address.split(':')[0]) {\n                        var index = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(this.uniqueColl);\n                        for (var i = index[0]; i <= index[2]; i++) {\n                            for (var j = index[1]; j <= index[3]; j++) {\n                                this.parent.updateCellInfo({ value: '', formula: '' }, (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)([i, j]), true);\n                            }\n                        }\n                        this.parent.notify(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.removeUniquecol, null);\n                        this.uniqueColl = '';\n                    }\n                    else if (args.isUnique) {\n                        var uniqueRange = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(this.uniqueColl);\n                        if ((0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getCell)(uniqueRange[0], uniqueRange[1], sheet).value === '#SPILL!') {\n                            var skip = false;\n                            for (var j = uniqueRange[0]; j <= uniqueRange[2]; j++) {\n                                for (var k = uniqueRange[1]; k <= uniqueRange[3]; k++) {\n                                    var cell = (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getCell)(j, k, sheet);\n                                    if (j === uniqueRange[0] && k === uniqueRange[1]) {\n                                        skip = false;\n                                    }\n                                    else if (cell && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cell.value) && cell.value !== '') {\n                                        skip = true;\n                                    }\n                                }\n                            }\n                            if (!skip) {\n                                this.reApplyFormula();\n                            }\n                        }\n                    }\n                    if (args.isUnique) {\n                        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.completeAction, { action: 'cellDelete',\n                            eventArgs: { address: sheet.name + '!' + address, isSpill: isSpill } });\n                    }\n                    else {\n                        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.completeAction, { action: 'cellDelete', eventArgs: { address: sheet.name + '!' + address } });\n                    }\n                }\n                break;\n        }\n    };\n    Edit.prototype.getCurPosition = function () {\n        var cursorOffset = {};\n        var selection = window.getSelection();\n        if (selection && selection.focusNode && selection.focusNode.classList &&\n            selection.focusNode.classList.contains('e-formula-bar-panel')) {\n            var formulaBar = selection.focusNode.getElementsByClassName('e-formula-bar e-css')[0];\n            if (formulaBar.value === this.editCellData.value) {\n                cursorOffset.start = formulaBar.selectionStart;\n                cursorOffset.end = formulaBar.selectionEnd;\n            }\n        }\n        else if (this.getEditElement(this.parent.getActiveSheet()).textContent === this.editCellData.value) {\n            cursorOffset.start = selection.anchorOffset;\n            cursorOffset.end = selection.focusOffset;\n            if (cursorOffset.start > cursorOffset.end) {\n                var x = cursorOffset.start;\n                cursorOffset.start = cursorOffset.end;\n                cursorOffset.end = x;\n            }\n        }\n        return cursorOffset;\n    };\n    Edit.prototype.mouseDownHandler = function (e) {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, '.e-findtool-dlg') && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, '.e-validation-error-dlg')) {\n            if (this.isEdit) {\n                var curOffset = this.getCurPosition();\n                var selectionStart = void 0;\n                var selectionEnd = void 0;\n                if (curOffset.start) {\n                    this.curStartPos = selectionStart = curOffset.start;\n                }\n                if (curOffset.end) {\n                    this.curEndPos = selectionEnd = curOffset.end;\n                }\n                var trgtElem = e.target;\n                var sheet = this.parent.getActiveSheet();\n                var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n                this.isCellEdit = trgtElem.classList.contains('e-spreadsheet-edit');\n                var isFormula = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.checkIsFormula)(this.editCellData.value, true);\n                var editorElem = this.getEditElement(sheet);\n                var validCharacters = ['+', '-', '*', '/', this.parent.listSeparator, '(', '=', '&', ':'];\n                if (trgtElem.classList.contains('e-cell') || trgtElem.classList.contains('e-header-cell') ||\n                    trgtElem.classList.contains('e-selectall') || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(trgtElem, '.e-toolbar-item.e-active') || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(trgtElem, '.e-table')) {\n                    if (!isFormula || this.endFormulaRef) {\n                        this.endFormulaRef = false;\n                        this.endEdit(false, e);\n                    }\n                    else {\n                        var actCellIdx = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.getCellIndexes)(sheet.activeCell);\n                        var cell = (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getCell)(actCellIdx[0], actCellIdx[1], sheet);\n                        var editorValue = document.activeElement.classList.contains('e-formula-bar') ?\n                            document.activeElement.value : editorElem.textContent;\n                        if (this.editCellData.value === editorValue) {\n                            if (selectionStart === selectionEnd) {\n                                if (this.editCellData.sheetIndex !== (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getSheetIndex)(this.parent, sheet.name)) {\n                                    if (validCharacters.indexOf(editorValue.substring(selectionStart - 1, selectionStart)) === -1) {\n                                        if (formulaRefIndicator) {\n                                            formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                        }\n                                        this.parent.goTo(this.editCellData.fullAddr);\n                                        this.endEdit(false, e);\n                                        return;\n                                    }\n                                }\n                                else if (validCharacters.indexOf(editorElem.textContent.substring(selectionStart - 1, selectionStart)) === -1) {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                    return;\n                                }\n                            }\n                            else if (validCharacters.indexOf(editorValue.substring(selectionStart - 1, selectionStart)) !== -1 &&\n                                (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.isCellReference)(editorValue.substring(selectionStart, selectionEnd)) &&\n                                editorValue.indexOf(':') !== selectionEnd) {\n                                this.editCellData.value = editorValue.substring(0, selectionStart) +\n                                    editorValue.substring(selectionEnd, editorValue.length);\n                            }\n                        }\n                        if (!cell) {\n                            return;\n                        }\n                        isFormula = cell.formula && ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.checkIsFormula)(cell.formula) || (this.editCellData.value &&\n                            this.editCellData.value.toString().indexOf('=') === 0));\n                        if (isFormula && this.parent.isEdit) {\n                            var curPos = selectionEnd;\n                            if (this.editCellData.value.length === curPos) {\n                                if (this.editCellData.value.substring(this.editCellData.value.length - 1) === ')' ||\n                                    (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.isNumber)(this.editCellData.value.substring(this.editCellData.value.length - 1))) {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                }\n                            }\n                            else if (this.editCellData.value === editorValue &&\n                                validCharacters.indexOf(editorValue.substring(curPos - 1, curPos)) === -1) {\n                                if (formulaRefIndicator) {\n                                    formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                }\n                                this.endEdit(false, e);\n                            }\n                        }\n                    }\n                }\n                else {\n                    if (isFormula && this.editCellData.value === editorElem.textContent && editorElem.textContent.indexOf('(') !==\n                        editorElem.textContent.length - 1 && !this.isCellEdit && !trgtElem.classList.contains('e-formula-bar') &&\n                        validCharacters.indexOf(this.editCellData.value.substring(selectionStart - 1, selectionStart)) === -1) {\n                        if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.getSheet)(this.parent, this.editCellData.sheetIndex).id === sheet.id) {\n                            var curPos = window.getSelection().focusOffset;\n                            if (validCharacters.indexOf(editorElem.textContent.substring(curPos - 1, curPos)) === -1) {\n                                if (formulaRefIndicator) {\n                                    formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                }\n                                this.parent.goTo(this.editCellData.fullAddr);\n                                if (this.isEdit) {\n                                    this.endEdit(false, e);\n                                }\n                                return;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Edit.prototype.tapHandler = function (e) {\n        var _this = this;\n        if (!this.tapedTwice) {\n            this.tapedTwice = true;\n            setTimeout(function () {\n                _this.tapedTwice = false;\n                if (!_this.parent.isEdit && e.target.classList.contains('e-cell')) {\n                    var focusEditEle = _this.parent.element.querySelector('.e-ss-focus-edit');\n                    if (focusEditEle) {\n                        (0,_common_index__WEBPACK_IMPORTED_MODULE_2__.focus)(focusEditEle);\n                    }\n                }\n            }, 300);\n            return;\n        }\n        e.preventDefault();\n        this.dblClickHandler(e);\n    };\n    Edit.prototype.dblClickHandler = function (e) {\n        var trgt = e.target;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(trgt, '.e-datavisualization-chart') && !trgt.classList.contains('e-ss-overlay') &&\n            (trgt.classList.contains('e-active-cell') || trgt.classList.contains('e-cell') || trgt.classList.contains('e-wrap-content') ||\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(trgt, '.e-sheet-content') || trgt.classList.contains('e-table'))) {\n            var sheet = this.parent.getActiveSheet();\n            var actCell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.getCellIndexes)(sheet.activeCell);\n            var cell = (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getCell)(actCell[0], actCell[1], sheet, false, true);\n            if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.isReadOnly)(cell, (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getColumn)(sheet, actCell[1]), (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.getRow)(sheet, actCell[0]))) {\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.readonlyAlert, null);\n            }\n            else if (!sheet.isProtected || !(0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.isLocked)(cell, (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getColumn)(sheet, actCell[1]))) {\n                if (this.isEdit) {\n                    if (!trgt.classList.contains('e-spreadsheet-edit')) {\n                        if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.checkIsFormula)(this.editCellData.value)) {\n                            var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.lastIndexOf('!'));\n                            if (this.parent.getActiveSheet().name === sheetName) {\n                                this.endEdit();\n                            }\n                        }\n                        else {\n                            this.endEdit();\n                        }\n                    }\n                }\n                else {\n                    this.isNewValueEdit = false;\n                    this.startEdit();\n                    (0,_common_index__WEBPACK_IMPORTED_MODULE_2__.focus)(this.getEditElement(sheet));\n                }\n            }\n            else {\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.editAlert, null);\n            }\n        }\n    };\n    Edit.prototype.updateEditCellDetail = function (addr, value) {\n        var sheetIdx;\n        var sheet;\n        var isMergedHiddenCell;\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.editCellData.sheetIndex)) {\n            if (addr && addr.lastIndexOf('!') > -1) {\n                sheetIdx = (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getSheetIndex)(this.parent, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.getSheetNameFromAddress)(addr));\n            }\n            else {\n                sheetIdx = this.parent.activeSheetIndex;\n            }\n        }\n        else {\n            sheetIdx = this.editCellData.sheetIndex;\n        }\n        if (!this.editCellData.addr) {\n            sheet = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.getSheet)(this.parent, sheetIdx);\n            if (addr) {\n                addr = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeFromAddress)(addr);\n            }\n            else {\n                addr = sheet.activeCell;\n            }\n        }\n        else if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.checkIsFormula)(this.editCellData.value, true)) {\n            sheet = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.getSheet)(this.parent, sheetIdx);\n            this.isNewValueEdit = false;\n        }\n        if (addr) {\n            var range = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(addr);\n            var rowIdx = range[0];\n            var colIdx = range[1];\n            var model = (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getCell)(rowIdx, colIdx, sheet, false, true);\n            if (model.colSpan > 1 || model.rowSpan > 1) {\n                var mergeArgs = { sheet: sheet, cell: model, rowIdx: rowIdx, colIdx: colIdx };\n                (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.setVisibleMergeIndex)(mergeArgs);\n                rowIdx = mergeArgs.rowIdx;\n                colIdx = mergeArgs.colIdx;\n                isMergedHiddenCell = mergeArgs.isMergedHiddenCell;\n            }\n            var cellElem = this.parent.getCell(rowIdx, colIdx);\n            var cellPosition = (0,_common_index__WEBPACK_IMPORTED_MODULE_2__.getCellPosition)(sheet, range, this.parent.frozenRowCount(sheet), this.parent.frozenColCount(sheet), this.parent.viewport.beforeFreezeHeight, this.parent.viewport.beforeFreezeWidth, this.parent.sheetModule.colGroupWidth);\n            this.editCellData = {\n                addr: addr,\n                fullAddr: (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getSheetName)(this.parent, sheetIdx) + '!' + addr,\n                rowIndex: rowIdx,\n                colIndex: colIdx,\n                sheetIndex: sheetIdx,\n                element: cellElem,\n                value: value || '',\n                position: cellPosition,\n                prevFormulaValue: this.editCellData.prevFormulaValue\n            };\n        }\n        return isMergedHiddenCell;\n    };\n    Edit.prototype.initiateEditor = function (refreshCurPos, isMergedHiddenCell) {\n        var _this = this;\n        (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.getData)(this.parent, this.editCellData.fullAddr, false, isMergedHiddenCell).then(function (values) {\n            if (!_this.parent) {\n                return;\n            }\n            values.forEach(function (cell) {\n                var value;\n                var updateEditValue = function () {\n                    var args = { cell: cell, value: cell ? cell.value : '',\n                        showFormattedText: _this.editCellData.showFormattedText };\n                    _this.parent.notify(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.getFormattedBarText, args);\n                    value = cell ? (cell.formula || args.value) : '';\n                    _this.editCellData.oldValue = value;\n                };\n                updateEditValue();\n                var evtArgs = _this.triggerEvent('cellEdit', null, value);\n                if (evtArgs.cancel) {\n                    _this.cancelEdit(true, false, null, true);\n                    return;\n                }\n                if (evtArgs.showFormattedText) {\n                    // For SF-354174 ticket we have provided 'dd/MM/yyyy' support and diplayed the formatted value in the editor which is\n                    // not a default behavior. To handle this, we have added this property and it applies only for the 'dd/MM/yyyy' format.\n                    _this.editCellData.showFormattedText = true;\n                    updateEditValue();\n                }\n                if (_this.editCellData.value) {\n                    value = _this.editCellData.value;\n                }\n                else {\n                    _this.editCellData.value = value;\n                }\n                var prevCellValue;\n                if (_this.isNewValueEdit) {\n                    prevCellValue = value;\n                    value = '';\n                }\n                else {\n                    _this.isNewValueEdit = true;\n                }\n                if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isUndefined)(value)) {\n                    value = '';\n                }\n                _this.refreshEditor(value, false, true, false, false, prevCellValue);\n                if (refreshCurPos) {\n                    _this.setCursorPosition();\n                }\n            });\n        });\n    };\n    Edit.prototype.positionEditor = function (isWrap) {\n        var tdElem = this.editCellData.element;\n        var isEdit = false;\n        var cellEle;\n        var arg = { isEdit: isEdit };\n        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.isFormulaBarEdit, arg);\n        if (arg.isEdit && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(tdElem)) {\n            cellEle = this.parent.getCell(this.editCellData.rowIndex, this.editCellData.colIndex);\n            tdElem = cellEle;\n            this.editCellData.element = cellEle;\n        }\n        if (tdElem) {\n            tdElem.classList.add('e-ss-edited');\n            var sheet = this.parent.getActiveSheet();\n            var cell = (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getCell)(this.editCellData.rowIndex, this.editCellData.colIndex, sheet, false, true);\n            var left = this.editCellData.position.left + 1;\n            var top_1 = this.editCellData.position.top + 1;\n            var args = { range: [this.editCellData.rowIndex, this.editCellData.colIndex, this.editCellData.rowIndex,\n                    this.editCellData.colIndex] };\n            this.parent.notify(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.activeCellMergedRange, args);\n            var minHeight = (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getRowsHeight)(sheet, args.range[0], args.range[2]) - 3;\n            var minWidth = (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getColumnsWidth)(sheet, args.range[1], args.range[3]) - 3;\n            var cont = this.parent.getMainContent();\n            var mainContElement = cont.parentElement;\n            var editWidth = void 0;\n            var frozenCol = this.parent.frozenColCount(sheet);\n            var zIndex = void 0;\n            var preventWrap = void 0;\n            var frozenRow = this.parent.frozenRowCount(sheet);\n            var addWrap = void 0;\n            if (this.editCellData.colIndex < frozenCol) {\n                editWidth = Math.abs(this.parent.getRowHeaderContent().getBoundingClientRect()[this.parent.enableRtl ? 'left' : 'right'] -\n                    tdElem.getBoundingClientRect()[this.parent.enableRtl ? 'right' : 'left']) - 1;\n                if (this.editCellData.rowIndex < frozenRow) {\n                    if (this.parent.getRowHeaderContent().style.zIndex === '2') {\n                        zIndex = '3';\n                    }\n                }\n                else {\n                    if ((0,_common_index__WEBPACK_IMPORTED_MODULE_2__.getTextWidth)(cell.value, cell.style, this.parent.cellStyle) > editWidth) {\n                        addWrap = true;\n                    }\n                }\n            }\n            else {\n                editWidth = (mainContElement.offsetWidth - (left - cont.scrollLeft) - 28) -\n                    this.parent.sheetModule.getRowHeaderWidth(sheet);\n                var tdEleInf = tdElem.getBoundingClientRect();\n                var mainContEleInf = mainContElement.getBoundingClientRect();\n                var getCellRight = this.parent.enableRtl ? tdEleInf.left : tdEleInf.right;\n                var getMainConEleRight = this.parent.enableRtl ? mainContEleInf.left : mainContEleInf.right;\n                var horizontalScrollBar = this.parent.getScrollElement();\n                var verticalScrollBarWidth = this.parent.sheetModule.getScrollSize();\n                if (this.parent.enableRtl) {\n                    if ((getMainConEleRight + verticalScrollBarWidth) > getCellRight) {\n                        horizontalScrollBar.scrollLeft -= tdEleInf.width;\n                    }\n                }\n                else {\n                    if ((getMainConEleRight - verticalScrollBarWidth) < getCellRight) {\n                        horizontalScrollBar.scrollLeft += tdEleInf.width;\n                    }\n                }\n            }\n            if (this.editCellData.rowIndex < frozenRow) {\n                preventWrap = true;\n            }\n            var height = !preventWrap && ((cell && cell.wrap) || (tdElem && isWrap) || addWrap) ? 'auto;' : minHeight + 'px;';\n            // let editHeight: number = mainContElement.offsetHeight - top - 28;\n            var inlineStyles_1 = 'display:block;top:' + top_1 + 'px;' + (this.parent.enableRtl ? 'right:' : 'left:') + left + 'px;' +\n                'min-width:' + minWidth + 'px;max-width:' + (cell && cell.wrap ? minWidth : editWidth) + 'px;' +\n                'height:' + height + (cell && cell.wrap ? ('width:' + minWidth + 'px;') : '') + 'min-height:' + minHeight + 'px;' +\n                (zIndex ? 'z-index: ' + zIndex + ';' : '') + (preventWrap && ((cell && !cell.wrap) || (tdElem && isWrap)) && ((0,_common_index__WEBPACK_IMPORTED_MODULE_2__.getTextWidth)(cell.value, cell.style, this.parent.cellStyle) > editWidth || (tdElem && isWrap)) ? 'overflow: auto;' : '');\n            var styles = tdElem.style.cssText.split(';');\n            styles.forEach(function (style) {\n                if (!style.includes('border')) {\n                    inlineStyles_1 += style + ';';\n                }\n            });\n            var editorElem = this.getEditElement(sheet, true);\n            editorElem.style.cssText = inlineStyles_1;\n            if ((0,_common_index__WEBPACK_IMPORTED_MODULE_2__.getTextWidth)(editorElem.textContent, cell.style, this.parent.cellStyle) > editWidth) {\n                editorElem.style.height = 'auto';\n            }\n            // we using edit div height as auto , while editing div enlarges and hide active cell bottom border for that\n            // we increasing 1px height to active cell.\n            var actCell = this.parent.element.querySelector('.e-active-cell');\n            if (actCell) {\n                actCell.style.height = (minHeight + 4) + 'px';\n            }\n            if (tdElem.classList.contains('e-right-align')) {\n                editorElem.classList.add('e-right-align');\n            }\n            else if (tdElem.classList.contains('e-center-align')) {\n                editorElem.classList.add('e-center-align');\n            }\n        }\n    };\n    Edit.prototype.updateEditedValue = function (tdRefresh, value, e, isPublic) {\n        var _this = this;\n        var oldCellValue = this.editCellData.oldValue;\n        if (value) {\n            this.editCellData.value = value;\n        }\n        var newVal = this.editCellData.value;\n        /* To set the before cell details for undo redo. */\n        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.setActionData, { args: { action: 'beforeCellSave', eventArgs: { address: this.editCellData.addr } } });\n        var isValidCellValue = true;\n        if (this.parent.allowDataValidation) {\n            var sheet = this.parent.getActiveSheet();\n            var cellIndex = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(sheet.activeCell);\n            var cell = (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getCell)(cellIndex[0], cellIndex[1], sheet, false, true);\n            var column = (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getColumn)(sheet, cellIndex[1]);\n            if (cell.validation || (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.checkColumnValidation)(column, cellIndex[0], cellIndex[1])) {\n                var editedValue = this.editCellData.value || this.getEditElement(sheet).innerText;\n                var sheetIdx = this.parent.activeSheetIndex;\n                var range = typeof this.editCellData.addr === 'string' ? (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(this.editCellData.addr) :\n                    this.editCellData.addr;\n                var validEventArgs = { value: editedValue, range: range, sheetIdx: sheetIdx, isEdit: true, td: null, isValid: true };\n                var currEditedCell = Object.assign({}, cell, { value: editedValue }); // Update edited value for validation purpose.\n                (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.setCell)(cellIndex[0], cellIndex[1], sheet, currEditedCell);\n                this.parent.notify(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.isValidation, validEventArgs);\n                (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.setCell)(cellIndex[0], cellIndex[1], sheet, cell);\n                isValidCellValue = validEventArgs.isValid;\n                if (isValidCellValue) {\n                    if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.checkIsFormula)(editedValue) || !cell.format) {\n                        if (!this.editCellData.value) {\n                            this.editCellData.value = editedValue;\n                        }\n                    }\n                    else if (editedValue !== validEventArgs.value || (!this.editCellData.value && validEventArgs.value)) {\n                        this.editCellData.value = validEventArgs.value;\n                    }\n                }\n                else {\n                    this.isCellEdit = true;\n                }\n            }\n        }\n        if (!isPublic && (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.checkIsFormula)(this.editCellData.value)) {\n            var eventArgs_1 = { formula: this.editCellData.value };\n            this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_5__.checkFormulaRef, eventArgs_1);\n            if (eventArgs_1.isInvalid) {\n                var isYesBtnClick_1;\n                this.isCellEdit = true;\n                isValidCellValue = false;\n                var l10n = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_2__.locale);\n                var erroDialogInst_1 = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_2__.dialog);\n                erroDialogInst_1.show({\n                    width: 400, isModal: true, showCloseIcon: true, target: this.parent.element, cssClass: 'e-validation-error-dlg',\n                    content: l10n.getConstant('CellReferenceTypoError') + \"<br>\" + eventArgs_1.formula,\n                    beforeOpen: function () { return _this.editCellData.element.focus(); },\n                    buttons: [{\n                            buttonModel: { content: l10n.getConstant('Yes'), isPrimary: true },\n                            click: function () {\n                                isYesBtnClick_1 = true;\n                                erroDialogInst_1.hide();\n                            }\n                        },\n                        {\n                            buttonModel: { content: l10n.getConstant('No') },\n                            click: function () { return erroDialogInst_1.hide(); }\n                        }],\n                    close: function () {\n                        if (isYesBtnClick_1) {\n                            value = _this.editCellData.value = eventArgs_1.formula;\n                            _this.updateCell(oldCellValue, tdRefresh, value, newVal, e);\n                            _this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.formulaBarOperation, { action: 'refreshFormulabar', value: eventArgs_1.formula });\n                        }\n                        else {\n                            var editorElem = _this.getEditElement(_this.parent.getActiveSheet());\n                            if (editorElem.innerText) {\n                                window.getSelection().selectAllChildren(editorElem);\n                            }\n                        }\n                    }\n                }, false);\n            }\n        }\n        if (isValidCellValue) {\n            this.updateCell(oldCellValue, tdRefresh, value, newVal, e);\n        }\n        else if (e) {\n            e.preventDefault();\n        }\n    };\n    Edit.prototype.updateCell = function (oldCellValue, tdRefresh, value, newVal, e) {\n        var oldValue = oldCellValue ? oldCellValue.toString().toUpperCase() : '';\n        var sheet = this.parent.getActiveSheet();\n        if (oldCellValue || oldCellValue === 0) {\n            oldCellValue = oldCellValue.toString();\n        }\n        var curCellValue = this.editCellData.value;\n        if (curCellValue) {\n            curCellValue = curCellValue.toString();\n        }\n        var isCellValChanged = oldCellValue !== curCellValue || (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.checkIsFormula)(oldValue);\n        if (isCellValChanged) {\n            if (this.isAltEnter && curCellValue && curCellValue.includes('\\n')) {\n                (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.wrap)(sheet.activeCell, true, this.parent, true);\n                this.refreshEditor(curCellValue, this.isCellEdit, false, false, false);\n            }\n            var cellIndex = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(sheet.activeCell);\n            if (oldCellValue && oldCellValue.indexOf('=UNIQUE(') > -1 && this.editCellData.value === '') {\n                this.parent.notify(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.removeUniquecol, null);\n            }\n            var args = { cellIdx: cellIndex, isUnique: false };\n            this.checkUniqueRange(args);\n            var isUniqueRange = args.isUnique;\n            if (isUniqueRange && oldCellValue !== '' && this.editCellData.value === '') {\n                var rangeIdx = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(this.uniqueColl);\n                if ((0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getCell)(rangeIdx[0], rangeIdx[1], sheet).value.toString().indexOf('#SPILL!') === -1) {\n                    return;\n                }\n            }\n            if (oldCellValue && oldCellValue.indexOf('UNIQUE') > -1 &&\n                this.editCellData.value && this.editCellData.value.toString().indexOf('UNIQUE') > -1 && isUniqueRange) {\n                this.updateUniqueRange('');\n            }\n            var evtArgs = {\n                action: 'updateCellValue',\n                address: this.editCellData.addr, value: this.editCellData.value, skipCellFormat: this.editCellData.showFormattedText\n            };\n            this.parent.notify(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.workbookEditOperation, evtArgs);\n            var updatedCell = (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getCell)(cellIndex[0], cellIndex[1], sheet, true);\n            var cellValue = void 0;\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(updatedCell)) {\n                cellValue = updatedCell.value.toString();\n            }\n            var isCircularRefError = cellValue === '#CIRCULARREF!';\n            var isInvalidFormula = this.formulaErrorStrings.indexOf(cellValue) > -1;\n            if (isInvalidFormula || isCircularRefError) {\n                var isDlgOpenCancel = void 0;\n                if (e) {\n                    var target_1 = e.target;\n                    var ribbonCls = ['e-toolbar-item', 'e-tab-wrap', 'e-text-wrap', 'e-tab-text', 'e-caret'];\n                    var skipAlertCls = ['e-scroller', 'e-main-panel', 'e-autofill'];\n                    if ((!ribbonCls.some(function (cls) { return target_1.classList.contains(cls); }) || !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(target_1, '.e-ribbon')) &&\n                        !skipAlertCls.some(function (cls) { return target_1.classList.contains(cls); })) {\n                        isDlgOpenCancel = this.showFormulaAlertDlg(cellValue, isCircularRefError);\n                    }\n                    if (!isDlgOpenCancel) {\n                        e.preventDefault();\n                    }\n                }\n                if (!isDlgOpenCancel) {\n                    delete updatedCell.value;\n                    delete updatedCell.formula;\n                    this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_5__.clearFormulaDependentCells, { cellRef: sheet.activeCell, clearFormulaInfo: true });\n                    if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.checkIsFormula)(oldValue)) {\n                        this.parent.updateCellInfo({ formula: oldValue }, sheet.activeCell);\n                    }\n                    else if (oldCellValue) {\n                        this.parent.updateCellInfo({ value: oldCellValue }, sheet.activeCell);\n                    }\n                    return;\n                }\n                else {\n                    updatedCell.value = '0';\n                }\n            }\n            var indexes = void 0;\n            if (evtArgs.isFormulaDependent) {\n                indexes = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.getViewportIndexes)(this.parent, this.parent.viewport);\n            }\n            var cell = (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getCell)(cellIndex[0], cellIndex[1], sheet, true);\n            var eventArgs = this.getRefreshNodeArgs(cell, this.editCellData.element, this.editCellData.rowIndex, this.editCellData.colIndex);\n            this.editCellData.value = eventArgs.value;\n            this.parent.notify(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.refreshChart, { cell: null, rIdx: this.editCellData.rowIndex, cIdx: this.editCellData.colIndex, viewportIndexes: indexes });\n            if (cell && cell.formula) {\n                this.editCellData.formula = cell.formula;\n            }\n            if (tdRefresh) {\n                this.parent.refreshNode(this.editCellData.element, eventArgs);\n            }\n            if (cell && cell.hyperlink) {\n                this.parent.serviceLocator.getService('cell').refreshRange(cellIndex);\n            }\n            if (sheet.conditionalFormats && sheet.conditionalFormats.length) {\n                this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_5__.applyCF, {\n                    indexes: [this.editCellData.rowIndex, this.editCellData.colIndex], isAction: true,\n                    refreshAll: evtArgs.isFormulaDependent, isEdit: true\n                });\n            }\n            if (cell && cell.wrap) {\n                this.parent.notify(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.wrapEvent, { range: cellIndex, wrap: true, sheet: sheet });\n            }\n            if (isUniqueRange) {\n                var rangeIdx = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(this.uniqueColl);\n                if ((0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getCell)(rangeIdx[0], rangeIdx[1], sheet).value.toString().indexOf('#SPILL!') > -1) {\n                    this.isSpill = true;\n                }\n                if ((oldCellValue !== '' && this.editCellData.value === '') ||\n                    (this.editCellData.formula && this.editCellData.formula.length > 1 &&\n                        oldCellValue !== this.editCellData.formula)) {\n                    var skip = false;\n                    for (var j = rangeIdx[0]; j <= rangeIdx[2]; j++) {\n                        for (var k = rangeIdx[1]; k <= rangeIdx[3]; k++) {\n                            var cell_1 = (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getCell)(j, k, sheet);\n                            if (j === rangeIdx[0] && k === rangeIdx[1]) {\n                                skip = false;\n                            }\n                            else if (cell_1 && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cell_1.value) && cell_1.value !== '') {\n                                skip = true;\n                            }\n                        }\n                    }\n                    if (!skip) {\n                        this.reApplyFormula();\n                    }\n                }\n                else {\n                    this.updateUniqueRange(newVal);\n                }\n            }\n        }\n        this.triggerEvent('cellSave', e, value);\n        this.resetEditState();\n        this.focusElement(e);\n    };\n    Edit.prototype.checkUniqueRange = function (uniquArgs) {\n        var args = { range: [] };\n        this.parent.notify(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.getUniqueRange, args);\n        var collection = args.range;\n        if (!uniquArgs.sheetName) {\n            uniquArgs.sheetName = this.parent.getActiveSheet().name;\n        }\n        for (var i = 0; i < collection.length; i++) {\n            if (collection[i].substring(0, collection[i].lastIndexOf('!')) === uniquArgs.sheetName) {\n                var rangeIdx = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(collection[i]);\n                for (var j = rangeIdx[0]; j <= rangeIdx[2]; j++) {\n                    for (var k = rangeIdx[1]; k <= rangeIdx[3]; k++) {\n                        if (uniquArgs.cellIdx[0] === j && uniquArgs.cellIdx[1] === k) {\n                            uniquArgs.isUnique = true;\n                            this.uniqueCell = true;\n                            var uniqueIndex = this.uniqueColl !== '' ? (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(this.uniqueColl) : [0, 0, 0, 0];\n                            var collectionIndex = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(collection[i]);\n                            if (uniqueIndex[0] === collectionIndex[0] && uniqueIndex[1] === collectionIndex[1]) {\n                                var index = [uniqueIndex[0], collectionIndex[1], uniqueIndex[0], collectionIndex[1]];\n                                index[2] = uniqueIndex[2] > collectionIndex[2] ? uniqueIndex[2] : collectionIndex[2];\n                                index[3] = uniqueIndex[3] > collectionIndex[3] ? uniqueIndex[3] : collectionIndex[3];\n                                this.uniqueColl = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(index);\n                                uniquArgs.uniqueRange = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)(index);\n                            }\n                            else {\n                                this.uniqueColl = collection[i];\n                                uniquArgs.uniqueRange = collection[i];\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Edit.prototype.updateUniqueRange = function (value) {\n        var rangeIdx = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(this.uniqueColl);\n        var skip = false;\n        if ((0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getCell)(rangeIdx[0], rangeIdx[1], this.parent.getActiveSheet()).value !== '#SPILL!') {\n            skip = true;\n        }\n        for (var j = rangeIdx[0]; j <= rangeIdx[2]; j++) {\n            for (var k = rangeIdx[1]; k <= rangeIdx[3]; k++) {\n                if (skip) {\n                    if (j === rangeIdx[0] && k === rangeIdx[1]) {\n                        this.parent.updateCellInfo({ value: '#SPILL!' }, (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)([j, k]), true);\n                    }\n                    else {\n                        if ((0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)([j, k]).split(':')[0] === this.editCellData.addr) {\n                            this.parent.updateCellInfo({ value: value }, (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)([j, k]), true);\n                        }\n                        else {\n                            this.parent.updateCellInfo({ value: '' }, (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)([j, k]), true);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Edit.prototype.reApplyFormula = function () {\n        var cellIdx = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(this.uniqueColl);\n        var cell = (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getCell)(cellIdx[0], cellIdx[1], this.parent.getActiveSheet());\n        this.parent.updateCellInfo({ value: '' }, (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeAddress)([cellIdx[0], cellIdx[1]]), true);\n        var sheets = this.parent.sheets;\n        var formula = cell.formula;\n        for (var i = 0; i < sheets.length; i++) {\n            if (formula.indexOf(sheets[i].name) > -1) {\n                formula = formula.replace(sheets[i].name, '!' + i);\n            }\n        }\n        this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_5__.workbookFormulaOperation, { action: 'computeExpression', formula: formula });\n        this.uniqueCell = false;\n        if (this.uniqueActCell !== '') {\n            this.editCellData.value = this.uniqueActCell;\n            this.uniqueActCell = '';\n        }\n    };\n    Edit.prototype.refreshDependentCellValue = function (rowIdx, colIdx, sheetIdx) {\n        if (rowIdx && colIdx) {\n            rowIdx--;\n            colIdx--;\n            if (((this.editCellData.rowIndex !== rowIdx || this.editCellData.colIndex !== colIdx)\n                && this.parent.activeSheetIndex === sheetIdx) || (this.uniqueCell && this.parent.activeSheetIndex === sheetIdx)) {\n                var sheet = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.getSheet)(this.parent, sheetIdx);\n                var td = void 0;\n                if (!(0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.isHiddenRow)(sheet, rowIdx) && !(0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.isHiddenCol)(sheet, colIdx)) {\n                    td = this.parent.getCell(rowIdx, colIdx);\n                }\n                if (td) {\n                    if (td.parentElement) {\n                        var curRowIdx = td.parentElement.getAttribute('aria-rowindex');\n                        if (curRowIdx && Number(curRowIdx) - 1 !== rowIdx) {\n                            return;\n                        }\n                    }\n                    var cell = (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getCell)(rowIdx, colIdx, sheet);\n                    var actCell = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(sheet.activeCell);\n                    if (actCell[0] === rowIdx && actCell[1] === colIdx) {\n                        this.uniqueActCell = cell.value;\n                    }\n                    var eventArgs = this.getRefreshNodeArgs(cell, td, rowIdx, colIdx);\n                    this.parent.refreshNode(td, eventArgs);\n                }\n            }\n        }\n    };\n    Edit.prototype.getRefreshNodeArgs = function (cell, tdEle, rowIdx, colIdx) {\n        cell = cell || {};\n        var eventArgs = {\n            value: cell.value, format: cell.format,\n            formattedText: cell.formattedText && cell.formattedText !== '' ? cell.formattedText : cell.value, isRightAlign: false,\n            type: 'General', cell: cell, rowIndex: rowIdx, td: tdEle, colIndex: colIdx, refresh: true, isEdit: true\n        };\n        this.parent.notify(_workbook_common_event__WEBPACK_IMPORTED_MODULE_3__.getFormattedCellObject, eventArgs);\n        return eventArgs;\n    };\n    Edit.prototype.endEdit = function (refreshFormulaBar, event, isPublic) {\n        if (refreshFormulaBar === void 0) { refreshFormulaBar = false; }\n        if (refreshFormulaBar) {\n            this.refreshEditor(this.editCellData.oldValue, false, true, false, false);\n        }\n        var triggerEventArgs = this.triggerEvent('beforeCellSave');\n        if (triggerEventArgs.cancel) {\n            if (this.parent.isEdit && event) {\n                event.preventDefault();\n            }\n            return;\n        }\n        if (!this.isAltEnter && triggerEventArgs.value && triggerEventArgs.value.toString().indexOf('\\n') > -1) {\n            var cell = (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getCell)(this.editCellData.rowIndex, this.editCellData.colIndex, this.parent.getActiveSheet());\n            (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.wrap)(this.parent.getActiveSheet().activeCell, cell ? (cell.wrap === false ? false : true) :\n                true, this.parent);\n            this.refreshEditor(triggerEventArgs.value, this.isCellEdit, false, false, false);\n        }\n        this.updateEditedValue(true, triggerEventArgs.value, event, isPublic);\n    };\n    Edit.prototype.cancelEdit = function (refreshFormulaBar, trigEvent, event, isInternal) {\n        if (refreshFormulaBar === void 0) { refreshFormulaBar = true; }\n        if (trigEvent === void 0) { trigEvent = true; }\n        this.refreshEditor(this.editCellData.oldValue, refreshFormulaBar, false, false, false);\n        if (!isInternal) {\n            if (trigEvent) {\n                this.triggerEvent('cellSave', event, undefined, true);\n            }\n            else {\n                this.triggerEvent('cellEdited');\n            }\n        }\n        this.resetEditState();\n        this.focusElement();\n    };\n    Edit.prototype.focusElement = function (e) {\n        if (e && e.keyCode === 9 && document.activeElement.classList.contains('e-formula-bar')) {\n            var focusEle = this.parent.element.querySelector(\".e-formula-bar-panel \" + (e.shiftKey ? '.e-insert-function' : '.e-combobox'));\n            if (focusEle) {\n                (0,_common_index__WEBPACK_IMPORTED_MODULE_2__.focus)(focusEle);\n            }\n        }\n        else {\n            (0,_common_index__WEBPACK_IMPORTED_MODULE_2__.focus)(this.parent.element);\n        }\n        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.enableToolbarItems, [{ enable: true }]);\n    };\n    Edit.prototype.triggerEvent = function (eventName, event, value, pvtManualCalc) {\n        var sheet = this.parent.getActiveSheet();\n        var cell = (0,_workbook_base_index__WEBPACK_IMPORTED_MODULE_4__.getCell)(this.editCellData.rowIndex, this.editCellData.colIndex, sheet);\n        var eventArgs = {\n            element: this.editCellData.element,\n            value: value ? value : this.editCellData.value,\n            oldValue: this.editCellData.oldValue,\n            address: this.editCellData.fullAddr,\n            displayText: this.parent.getDisplayText(cell),\n            previousFormulaValue: this.editCellData.prevFormulaValue\n        };\n        if (eventArgs.address) {\n            var indexes = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(eventArgs.address);\n            var args = { cellIdx: indexes, isUnique: false };\n            this.checkUniqueRange(args);\n            if (args.isUnique) {\n                eventArgs.isSpill = this.isSpill;\n            }\n        }\n        var isValueChanged = (eventArgs.value ? eventArgs.value.toString() : eventArgs.value) !==\n            (eventArgs.oldValue || eventArgs.oldValue === 0 ? eventArgs.oldValue.toString() : eventArgs.oldValue);\n        if (isValueChanged || (!pvtManualCalc && (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.checkIsFormula)(eventArgs.value) && (!cell || !cell.format ||\n            (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.getTypeFromFormat)(cell.format) !== 'Text'))) {\n            if (eventName !== 'cellSave') {\n                eventArgs.cancel = false;\n            }\n            if (eventName === 'beforeCellSave') {\n                this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_5__.beginAction, { eventArgs: eventArgs, action: 'cellSave', preventAction: true });\n                cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.checkIsFormula)(eventArgs.value) ? { formula: eventArgs.value } : { value: eventArgs.value };\n                var cancel = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.updateCell)(this.parent, sheet, { cell: cell, rowIdx: this.editCellData.rowIndex, colIdx: this.editCellData.colIndex,\n                    eventOnly: true });\n                if (cancel) {\n                    this.cancelEdit(false, false, null, true);\n                    eventArgs.cancel = true;\n                    return eventArgs;\n                }\n            }\n            this.parent.trigger(eventName, eventArgs);\n            if (eventName === 'cellSave') {\n                this.parent.trigger('cellEdited', eventArgs);\n                if (this.editCellData.formula) {\n                    eventArgs.formula = this.editCellData.formula;\n                }\n                else if (!isValueChanged) {\n                    eventArgs.formula = eventArgs.value;\n                }\n                if (cell.format) {\n                    eventArgs.format = cell.format;\n                }\n                eventArgs.originalEvent = event;\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.completeAction, { eventArgs: eventArgs, action: 'cellSave' });\n            }\n        }\n        else if (eventName !== 'beforeCellSave') {\n            if (eventName === 'cellSave') {\n                this.parent.trigger('cellEdited', eventArgs);\n            }\n            else {\n                this.parent.trigger(eventName, eventArgs);\n            }\n        }\n        return eventArgs;\n    };\n    Edit.prototype.altEnter = function () {\n        this.positionEditor(true);\n        var selection = window.getSelection();\n        var node = selection.anchorNode;\n        var offset;\n        var range = document.createRange();\n        offset = (node.nodeType === 3) ? selection.anchorOffset : node.textContent.length;\n        if (offset === 0 && node.textContent.length > 0) {\n            offset = node.textContent.length;\n        }\n        var text = node.textContent;\n        var textBefore = text.slice(0, offset);\n        var textAfter = text.slice(offset) || ' ';\n        node.textContent = textBefore + '\\n' + textAfter;\n        range = document.createRange();\n        if (node.nodeType === 3) {\n            range.setStart(node, offset + 1);\n            range.setEnd(node, offset + 1);\n        }\n        else if (node.nodeType === 1) {\n            range.setStart(node.firstChild, offset + 1);\n            range.setEnd(node.firstChild, offset + 1);\n        }\n        selection.removeAllRanges();\n        selection.addRange(range);\n    };\n    Edit.prototype.resetEditState = function (elemRefresh) {\n        if (elemRefresh === void 0) { elemRefresh = true; }\n        if (elemRefresh) {\n            var editorElem = this.getEditElement(this.parent.getActiveSheet());\n            if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.checkIsFormula)(editorElem.textContent) || editorElem.textContent === '') {\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.clearCellRef, null);\n            }\n            if (this.editCellData.element) {\n                this.editCellData.element.classList.remove('e-ss-edited');\n                this.editorElem.textContent = '';\n                if (editorElem === this.editorElem) {\n                    this.editorElem.removeAttribute('style');\n                    this.editorElem.classList.remove('e-right-align');\n                }\n                else {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.detach)(editorElem);\n                }\n            }\n        }\n        this.editCellData = {};\n        this.parent.isEdit = this.isEdit = false;\n        this.isCellEdit = true;\n        this.isAltEnter = false;\n        this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.formulaOperation, { action: 'endEdit' });\n        if (this.parent.showSheetTabs && !this.parent.isProtected) {\n            var addSheetBtn = this.parent.element.querySelector('.e-add-sheet-tab');\n            if (addSheetBtn) {\n                addSheetBtn.removeAttribute('disabled');\n            }\n        }\n    };\n    Edit.prototype.refSelectionRender = function () {\n        var editorElem = this.getEditElement(this.parent.getActiveSheet());\n        if (editorElem) {\n            if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.checkIsFormula)(editorElem.textContent)) {\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.initiateFormulaReference, {\n                    range: editorElem.textContent, formulaSheetIdx: this.editCellData.sheetIndex\n                });\n            }\n        }\n    };\n    // Start edit the formula cell and set cursor position\n    Edit.prototype.initiateRefSelection = function () {\n        var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.lastIndexOf('!'));\n        var value = this.editCellData.value;\n        if (this.parent.getActiveSheet().name === sheetName && (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.checkIsFormula)(this.editCellData.value, true)) {\n            this.startEdit(this.editCellData.addr, value, false);\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.initiateFormulaReference, {\n                range: this.editCellData.value, formulaSheetIdx: this.editCellData.sheetIndex\n            });\n            this.getEditElement(this.parent.getActiveSheet()).textContent = value;\n            this.initiateCurPosition();\n        }\n        else {\n            this.initiateCurPosition();\n        }\n    };\n    Edit.prototype.addressHandler = function (args) {\n        var dlgInst = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_2__.dialog).dialogInstance;\n        if (dlgInst && dlgInst.element && dlgInst.element.classList.contains('e-validation-error-dlg')) {\n            args.isAlertDlgOpen = true;\n            return;\n        }\n        if (!this.curStartPos) {\n            var curOffset = this.getCurPosition();\n            if (curOffset.start) {\n                this.curStartPos = curOffset.start;\n            }\n            if (curOffset.end) {\n                this.curEndPos = curOffset.end;\n            }\n        }\n        var address = args.range;\n        var sheetIdx = this.editCellData.sheetIndex;\n        var editorEle = this.getEditElement(this.parent.getActiveSheet());\n        if (this.parent.activeSheetIndex !== sheetIdx) {\n            address = '\\'' + this.parent.getActiveSheet().name + '\\'' + '!' + address;\n            if (args.isNameBoxSelect) {\n                sheetIdx = this.parent.activeSheetIndex;\n            }\n        }\n        var editedValue = this.editCellData.value;\n        if (args.isSelect) {\n            this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.initiateFormulaReference, { range: editedValue + address, formulaSheetIdx: sheetIdx });\n        }\n        else if (this.parent.activeSheetIndex === sheetIdx) {\n            var editorContent = document.activeElement.classList.contains('e-formula-bar') ?\n                document.activeElement.value : editorEle.textContent;\n            if (args.isNameBoxSelect) {\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.initiateFormulaReference, { range: editedValue + address, formulaSheetIdx: sheetIdx });\n                this.curStartPos = editedValue.length;\n            }\n            var startVal = void 0;\n            var endVal = void 0;\n            if (args.isMouseDown && editorContent !== editedValue) {\n                startVal = editorContent.substring(0, this.curEndPos) + this.parent.listSeparator;\n                endVal = editorContent.substring(this.curEndPos);\n                this.refreshEditor(startVal + endVal, false, true);\n                this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_2__.initiateFormulaReference, { range: editorEle.textContent, formulaSheetIdx: sheetIdx });\n                this.curEndPos += this.parent.listSeparator.length;\n                this.curStartPos = this.curEndPos;\n                startVal += address;\n            }\n            else {\n                startVal = editedValue.substring(0, this.curStartPos) + address;\n                endVal = editedValue.substring(this.curStartPos);\n                if (args.isNameBoxSelect) {\n                    this.refreshEditor(startVal + endVal, true, true);\n                }\n            }\n            editorEle.textContent = startVal + endVal;\n            this.curEndPos = startVal.length;\n        }\n    };\n    Edit.prototype.updateFormulaBarValue = function (args) {\n        var value = this.editCellData.value;\n        var lastRange = this.parent.getActiveSheet().selectedRange.split(' ');\n        var address = lastRange[lastRange.length - 1];\n        address = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.isSingleCell)((0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getIndexesFromAddress)(address)) ? address.split(':')[0] : address;\n        var formulaBar = this.parent.element.querySelector('.e-formula-bar');\n        if (value && (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.checkIsFormula)(value, true)) {\n            var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.lastIndexOf('!'));\n            var otherSheet = this.parent.getActiveSheet().name !== sheetName;\n            if (otherSheet) {\n                address = '\\'' + this.parent.getActiveSheet().name + '\\'' + '!' + address;\n            }\n            var startVal = void 0;\n            var endVal = void 0;\n            if (otherSheet && args.isMouseDown && lastRange.length > 1 && args.formulaBarVal && args.formulaBarVal !== value) {\n                startVal = args.formulaBarVal.substring(0, this.curEndPos) + this.parent.listSeparator;\n                endVal = args.formulaBarVal.substring(this.curEndPos);\n                this.refreshEditor(startVal + endVal, true);\n                this.curEndPos += this.parent.listSeparator.length;\n                this.curStartPos = this.curEndPos;\n                startVal += address;\n            }\n            else {\n                startVal = value.substring(0, this.curStartPos) + address;\n                endVal = value.substring(this.curStartPos);\n            }\n            formulaBar.value = startVal + endVal;\n            this.curEndPos = startVal.length;\n        }\n    };\n    Edit.prototype.setFormulaBarCurPosition = function (input, selectionStart, selectionEnd) {\n        if (input.setSelectionRange) {\n            input.focus();\n            input.selectionStart = selectionStart;\n            input.selectionEnd = selectionStart;\n            input.setSelectionRange(selectionStart, selectionEnd);\n        }\n    };\n    Edit.prototype.initiateCurPosition = function (args) {\n        if (args === void 0) { args = { isCellEdit: false }; }\n        var el = this.getEditElement(this.parent.getActiveSheet(), true);\n        if (args.isCellEdit) {\n            var curOffset = this.getCurPosition();\n            if (!this.endFormulaRef && curOffset.start === curOffset.end) {\n                this.updateFormulaReference(el);\n                var validCharacters = ['+', '-', '*', '/', this.parent.listSeparator, '(', '=', '&', ':'];\n                if (curOffset.end && validCharacters.indexOf(this.editCellData.value[curOffset.end - 1]) === -1) {\n                    this.endFormulaRef = true;\n                }\n            }\n            return;\n        }\n        var value = el.innerText;\n        var selection = window.getSelection();\n        if ((selection && selection.focusNode && selection.focusNode.classList &&\n            selection.focusNode.classList.contains('e-formula-bar-panel'))) {\n            var formulaBar = this.parent.element.querySelector('.e-formula-bar');\n            this.setFormulaBarCurPosition(formulaBar, this.curEndPos, this.curEndPos);\n            return;\n        }\n        if (value) {\n            var range = document.createRange();\n            if (value.indexOf(')') === value.length - 1) {\n                range.setStart(el.childNodes[0], this.curEndPos);\n                range.setEnd(el.childNodes[0], this.curEndPos);\n            }\n            else {\n                range.setStart(el.childNodes[0], this.curEndPos);\n                range.setEnd(el.childNodes[0], this.curEndPos);\n            }\n            selection.removeAllRanges();\n            selection.addRange(range);\n        }\n        var sheetIdx = this.editCellData.sheetIndex;\n        if (sheetIdx !== this.parent.activeSheetIndex) {\n            var elem = this.parent.element.querySelector('.e-formula-bar');\n            if (elem.value) {\n                if (elem.value.indexOf(')') === this.curEndPos - 1) {\n                    this.setFormulaBarCurPosition(elem, this.curEndPos - 1, this.curEndPos - 1);\n                }\n                else {\n                    this.setFormulaBarCurPosition(elem, this.curEndPos, this.curEndPos);\n                }\n            }\n        }\n    };\n    Edit.prototype.getEditElement = function (sheet, isEdit) {\n        if ((this.isEdit || isEdit) && (sheet.frozenRows || sheet.frozenColumns)) {\n            var frozenRow = this.parent.frozenRowCount(sheet);\n            var frozenCol = this.parent.frozenColCount(sheet);\n            var range = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_5__.getCellIndexes)(sheet.activeCell);\n            var content = void 0;\n            if (range[0] < frozenRow && range[1] < frozenCol) {\n                content = this.parent.getSelectAllContent();\n            }\n            else if (range[0] < frozenRow) {\n                content = this.parent.getColumnHeaderContent();\n            }\n            else if (range[1] < frozenCol) {\n                content = this.parent.getRowHeaderContent();\n            }\n            else {\n                return this.editorElem;\n            }\n            var editEle = content.getElementsByClassName('e-spreadsheet-edit')[0];\n            if (!editEle && isEdit) {\n                editEle = content.appendChild(this.editorElem.cloneNode());\n            }\n            return editEle;\n        }\n        return this.editorElem;\n    };\n    Edit.prototype.sheetChangeHandler = function () {\n        if (!this.isEdit) {\n            this.editCellData.value = null;\n        }\n    };\n    Edit.prototype.showFormulaAlertDlg = function (errorString, triggerBeforeOpenEvt) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_2__.locale);\n        var alertDialog = this.parent.serviceLocator.getService('dialog');\n        var cursorPosition;\n        var errorKey = this.getFormulaErrorKey(errorString);\n        var cancel;\n        var content = l10n.getConstant(errorKey);\n        var dlgInst = alertDialog.dialogInstance;\n        if (dlgInst && dlgInst.visible && dlgInst.element.classList.contains('e-circularref-dlg')) {\n            return cancel;\n        }\n        alertDialog.show({\n            width: 400, isModal: true, showCloseIcon: true, target: this.parent.element, cssClass: 'e-validation-error-dlg e-circularref-dlg',\n            content: content,\n            beforeOpen: function (args) {\n                if (triggerBeforeOpenEvt) {\n                    var sheet = _this.parent.getActiveSheet();\n                    var dlgArgs = { dialogName: 'CircularReferenceDialog', element: args.element,\n                        target: args.target, cancel: args.cancel, cellAddress: sheet.name + \"!\" + sheet.activeCell, content: content };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = cancel = true;\n                        return;\n                    }\n                    else if (dlgArgs.content !== content) {\n                        alertDialog.dialogInstance.content = dlgArgs.content;\n                        alertDialog.dialogInstance.dataBind();\n                    }\n                }\n                if (window.getSelection().rangeCount > 0) {\n                    var range = window.getSelection().getRangeAt(0);\n                    cursorPosition = range.endOffset;\n                }\n            },\n            buttons: [{\n                    buttonModel: { content: l10n.getConstant('Ok'), isPrimary: true },\n                    click: function () { return alertDialog.hide(); }\n                }],\n            close: function () {\n                if (!cancel) {\n                    var elem = _this.getEditElement(_this.parent.getActiveSheet());\n                    if (elem.childElementCount) {\n                        var textContent = elem.textContent;\n                        cursorPosition = textContent.length;\n                        elem.textContent = textContent;\n                    }\n                    var selection = document.getSelection();\n                    var range = document.createRange();\n                    range.setStart(elem.firstChild, cursorPosition);\n                    range.collapse(true);\n                    selection.removeAllRanges();\n                    selection.addRange(range);\n                    elem.focus();\n                }\n            }\n        }, false);\n        return cancel;\n    };\n    Edit.prototype.getFormulaErrorKey = function (errorString) {\n        var errorKey;\n        switch (errorString) {\n            case 'invalid arguments':\n                errorKey = 'InvalidArguments';\n                break;\n            case 'improper formula':\n                errorKey = 'ImproperFormula';\n                break;\n            case 'empty expression':\n                errorKey = 'EmptyExpression';\n                break;\n            case 'mismatched parentheses':\n                errorKey = 'MismatchedParenthesis';\n                break;\n            case 'mismatched string quotes':\n                errorKey = 'MismatchedStringQuotes';\n                break;\n            case 'wrong number of arguments':\n                errorKey = 'WrongNumberOfArguments';\n                break;\n            case 'requires 3 arguments':\n                errorKey = 'Requires3Arguments';\n                break;\n            case '#CIRCULARREF!':\n                errorKey = 'FormulaCircularRef';\n                break;\n            default:\n                errorKey = 'InvalidFormulaError';\n        }\n        return errorKey;\n    };\n    Edit.prototype.readOnlyAlertHandler = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_2__.locale);\n        var dialog = this.parent.serviceLocator.getService('dialog');\n        var findDialog = this.parent.element.querySelector('.e-find-dlg');\n        var findDlgInst;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(findDialog)) {\n            findDlgInst = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getComponent)(findDialog, 'dialog');\n        }\n        dialog.show({\n            content: l10n.getConstant('ReadonlyAlert'),\n            isModal: true,\n            closeOnEscape: true,\n            showCloseIcon: true,\n            width: '400px',\n            cssClass: 'e-readonly-alert-dlg',\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'ReadOnlyAlertDialog',\n                    content: l10n.getConstant('ReadonlyAlert'),\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                else {\n                    dialog.dialogInstance.content = dlgArgs.content;\n                    (0,_common_index__WEBPACK_IMPORTED_MODULE_2__.focus)(_this.parent.element);\n                }\n            },\n            close: function () {\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(findDialog)) {\n                    dialog.dialogInstance = findDlgInst;\n                }\n                (0,_common_index__WEBPACK_IMPORTED_MODULE_2__.focus)(_this.parent.element);\n            }\n        });\n    };\n    Edit.prototype.finiteAlertHandler = function () {\n        var l10n = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_2__.locale);\n        var dialog = this.parent.serviceLocator.getService('dialog');\n        dialog.show({\n            header: l10n.getConstant('Alert'),\n            content: l10n.getConstant('FiniteAlert'),\n            isModal: true,\n            closeOnEscape: true,\n            showCloseIcon: true,\n            width: '400px',\n            cssClass: 'e-finite-alert-dlg'\n        });\n    };\n    return Edit;\n}());\n\n\n\n//# sourceURL=webpack://ej2-vue-samples/./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/actions/edit.js?");

/***/ })

}]);