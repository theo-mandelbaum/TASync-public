"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkej2_vue_samples"] = self["webpackChunkej2_vue_samples"] || []).push([["chunk-vendors-node_modules_syncfusion_ej2-spreadsheet_src_spreadsheet_integrations_formula-bar_js-76-a36e2b9f"],{

/***/ "./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/integrations/formula-bar.js":
/*!**********************************************************************************************!*\
  !*** ./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/integrations/formula-bar.js ***!
  \**********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   FormulaBar: () => (/* binding */ FormulaBar)\n/* harmony export */ });\n/* harmony import */ var _common_index__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/index */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/common/index.js\");\n/* harmony import */ var _workbook_common_address__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./../../workbook/common/address */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/workbook/common/address.js\");\n/* harmony import */ var _workbook_index__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../workbook/index */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/workbook/index.js\");\n/* harmony import */ var _syncfusion_ej2_dropdowns__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @syncfusion/ej2-dropdowns */ \"./node_modules/@syncfusion/ej2-dropdowns/index.js\");\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"./node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _common_event__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common/event */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/common/event.js\");\n/* harmony import */ var _workbook_common_math__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../workbook/common/math */ \"./node_modules/@syncfusion/ej2-spreadsheet/src/workbook/common/math.js\");\n/* harmony import */ var _syncfusion_ej2_lists__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @syncfusion/ej2-lists */ \"./node_modules/@syncfusion/ej2-lists/index.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * Represents Formula bar for Spreadsheet.\n */\nvar FormulaBar = /** @class */ (function () {\n    function FormulaBar(parent) {\n        this.categoryCollection = [];\n        this.formulaCollection = [];\n        this.isGoto = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    FormulaBar.prototype.getModuleName = function () {\n        return 'formulaBar';\n    };\n    FormulaBar.prototype.createFormulaBar = function (args) {\n        var _this = this;\n        if (!this.parent.showFormulaBar && this.insertFnRipple) {\n            this.destroy();\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_0__.locale);\n        var id = this.parent.element.id;\n        var fBarWrapper = this.parent.createElement('div', { className: 'e-formula-bar-panel' });\n        if (!this.parent.isMobileView()) {\n            var nameBox = this.parent.createElement('input', { id: id + '_name_box', attrs: { type: 'text' } });\n            fBarWrapper.appendChild(nameBox);\n            this.comboBoxInstance = new _syncfusion_ej2_dropdowns__WEBPACK_IMPORTED_MODULE_3__.ComboBox({\n                value: 'A1',\n                cssClass: 'e-name-box',\n                width: '',\n                noRecordsTemplate: (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.initializeCSPTemplate)(function () { return ''; }),\n                fields: { text: 'name', value: 'refersTo' },\n                beforeOpen: this.nameBoxBeforeOpen.bind(this),\n                blur: this.nameBoxBlur.bind(this),\n                select: this.nameBoxSelect.bind(this),\n                open: function () {\n                    if (_this.isDevice) {\n                        window.browserDetails.isDevice = true;\n                    }\n                },\n                change: function () {\n                    /** */\n                }\n            });\n            this.comboBoxInstance.createElement = this.parent.createElement;\n            this.comboBoxInstance.appendTo(nameBox);\n            this.comboBoxInstance.element.parentElement.title = l10n.getConstant('NameBox');\n        }\n        var insertFnBtn = fBarWrapper.appendChild(this.parent.createElement('button', {\n            className: 'e-btn e-css e-flat e-icon-btn e-insert-function', attrs: { 'title': l10n.getConstant('InsertFunction'), 'type': 'button' }\n        }));\n        insertFnBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons' }));\n        this.insertFnRipple = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.rippleEffect)(fBarWrapper, { selector: '.e-insert-function' });\n        fBarWrapper.appendChild(this.parent.createElement('div', { className: 'e-separator' }));\n        var formulaBarLocale = l10n.getConstant('FormulaBar');\n        var textarea = fBarWrapper.appendChild(this.parent.createElement('textarea', {\n            className: 'e-formula-bar e-css', id: id + '_formula_input',\n            attrs: { 'title': formulaBarLocale, 'aria-label': formulaBarLocale, 'spellcheck': 'false' }\n        }));\n        textarea.rows = 1;\n        if (this.parent.isMobileView()) {\n            textarea.placeholder = l10n.getConstant('MobileFormulaBarPlaceHolder');\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.EventHandler.add(textarea, 'focus', this.textAreaFocusIn, this);\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.EventHandler.add(textarea, 'blur', this.textAreaFocusOut, this);\n        }\n        else {\n            var text = l10n.getConstant('ExpandFormulaBar');\n            fBarWrapper.appendChild(this.parent.createElement('span', { className: 'e-drop-icon e-icons', attrs: { 'title': text, 'role': 'button',\n                    'tabindex': '-1', 'aria-label': text } }));\n        }\n        if (args && args.uiUpdate) {\n            this.parent.element.insertBefore(fBarWrapper, document.getElementById(id + '_sheet_panel'));\n        }\n        else {\n            this.parent.element.appendChild(fBarWrapper);\n        }\n    };\n    FormulaBar.prototype.textAreaFocusIn = function () {\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        var tickBtn = this.parent.createElement('button', { className: 'e-btn e-css e-flat e-icon-btn e-formula-submit', attrs: { 'type': 'button' } });\n        tickBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons e-tick-icon' }));\n        formulaPanel.classList.add('e-focused');\n        formulaPanel.appendChild(tickBtn);\n    };\n    FormulaBar.prototype.textAreaFocusOut = function () {\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        formulaPanel.classList.remove('e-focused');\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.detach)(formulaPanel.querySelector('.e-formula-submit'));\n    };\n    FormulaBar.prototype.keyDownHandler = function (e) {\n        var trgtElem = e.target;\n        if (this.parent.isEdit && (!this.parent.getActiveSheet().isProtected || (trgtElem.classList.contains('e-formula-bar') && !trgtElem.disabled))) {\n            if (((0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.checkIsFormula)(trgtElem.value) || (trgtElem.validity && trgtElem.value.toString().indexOf('=') === 0)) &&\n                (e.keyCode === 16 || e.keyCode === 17)) {\n                return;\n            }\n            if (trgtElem.classList.contains('e-formula-bar') && (!e.shiftKey || (e.shiftKey && !(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isNavigationKey)(e.keyCode)))) {\n                this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.editOperation, { action: 'refreshEditor', value: trgtElem.value, refreshEditorElem: true });\n            }\n        }\n    };\n    FormulaBar.prototype.keyUpHandler = function (e) {\n        if (this.parent.isEdit) {\n            var trgtElem = e.target;\n            if (trgtElem.classList.contains('e-formula-bar')) {\n                var eventArg = { action: 'getCurrentEditValue', editedValue: '' };\n                this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.editOperation, eventArg);\n                if (eventArg.editedValue !== trgtElem.value && e.keyCode !== 16 && e.keyCode !== 17 &&\n                    (!e.shiftKey || (e.shiftKey && !(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isNavigationKey)(e.keyCode)))) {\n                    this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.editOperation, { action: 'refreshEditor', value: trgtElem.value, refreshEditorElem: true });\n                }\n            }\n        }\n    };\n    FormulaBar.prototype.nameBoxBeforeOpen = function (args) {\n        if (this.comboBoxInstance.element.classList.contains('e-name-editing')) {\n            args.cancel = true;\n        }\n        else {\n            this.comboBoxInstance.element.select();\n            this.isDevice = window.browserDetails.isDevice;\n            if (this.isDevice) {\n                window.browserDetails.isDevice = false;\n            }\n        }\n    };\n    FormulaBar.prototype.nameBoxBlur = function () {\n        if (this.comboBoxInstance.element.classList.contains('e-name-editing')) {\n            this.comboBoxInstance.element.classList.remove('e-name-editing');\n            this.updateValueAfterMouseUp();\n        }\n    };\n    FormulaBar.prototype.nameBoxSelect = function (args) {\n        if (args.isInteracted && (!args.e || args.e.type !== 'keydown' || (args.e.keyCode !== 40 &&\n            args.e.keyCode !== 38))) {\n            var refersTo = args.itemData.refersTo.substr(1);\n            var sheetIdx = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getSheetIndex)(this.parent, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getSheetNameFromAddress)(refersTo));\n            if (sheetIdx === undefined) {\n                return;\n            }\n            var range = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeFromAddress)(refersTo);\n            var sheet = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getSheet)(this.parent, sheetIdx);\n            var left = void 0;\n            var right = void 0;\n            if (range.indexOf(':') === -1) {\n                left = right = range.replace('$', '');\n            }\n            else {\n                var colIndex = range.indexOf(':');\n                left = range.substr(0, colIndex).replace('$', '');\n                right = range.substr(colIndex + 1, range.length).replace('$', '');\n            }\n            if (right.match(/\\D/g) && !right.match(/[0-9]/g) && left.match(/\\D/g) && !left.match(/[0-9]/g)) {\n                left = left + '1';\n                right = right + sheet.rowCount;\n                range = left + ':' + right;\n            }\n            else if (!right.match(/\\D/g) && right.match(/[0-9]/g) && !left.match(/\\D/g) && left.match(/[0-9]/g)) {\n                left = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getCellAddress)(parseInt(left, 10) - 1, 0);\n                right = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getCellAddress)(parseInt(right, 10) - 1, sheet.colCount - 1);\n                range = left + ':' + right;\n            }\n            if (sheetIdx === this.parent.activeSheetIndex) {\n                if (!this.parent.isEdit) {\n                    this.parent.selectRange(range);\n                }\n                this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.addressHandle, { range: range, isSelect: false, isMouseDown: false, isNameBoxSelect: true });\n                (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(this.parent.element);\n            }\n            else {\n                (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.updateSelectedRange)(this.parent, range, sheet);\n                this.parent.activeSheetIndex = sheetIdx;\n                this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.addressHandle, { range: range, isSelect: false, isMouseDown: false, isNameBoxSelect: true });\n                (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(this.parent.element);\n            }\n        }\n    };\n    FormulaBar.prototype.formulaBarUpdateHandler = function (e) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var range = sheet.selectedRange.split(':');\n        var address;\n        var editArgs = { action: 'getElement', element: null };\n        this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.editOperation, editArgs);\n        var formulaBar = this.parent.element.querySelector('.e-formula-bar');\n        if (e.type === 'mousemove' || e.type === 'pointermove') {\n            var indexes1 = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(range[0]);\n            var indexes2 = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(range[1]);\n            address = Math.abs(indexes1[0] - indexes2[0]) + 1 + \"R x \" + (Math.abs(indexes1[1] - indexes2[1]) + 1) + \"C\";\n            if (this.parent.isEdit) {\n                if (e.target && !e.target.classList.contains('e-spreadsheet-edit')) {\n                    this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.editValue, {});\n                }\n                else if (editArgs.element) {\n                    formulaBar.value = editArgs.element.textContent;\n                }\n            }\n        }\n        else {\n            address = range[0];\n            var cellAddr = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getSheetName)(this.parent) + \"!\" + address;\n            (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getData)(this.parent, cellAddr, false, true).then(function (values) {\n                if (!_this.parent) {\n                    return;\n                }\n                values.forEach(function (cell) {\n                    var value = _this.getFormulaBarValue(cell);\n                    var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n                    _this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.editOperation, eventArgs);\n                    var formulaInp = document.getElementById(_this.parent.element.id + '_formula_input');\n                    var previousVal = formulaInp.value;\n                    formulaInp.value = value;\n                    if (!eventArgs.editedValue || !(0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.checkIsFormula)(eventArgs.editedValue.toString(), true)) {\n                        _this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.editOperation, { action: 'refreshEditor', value: value, refreshEditorElem: true });\n                    }\n                    if (_this.parent.isEdit) {\n                        if (e.target && !e.target.classList.contains('e-spreadsheet-edit')) {\n                            _this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.editValue, { isMouseDown: (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.isMouseDown)(e), formulaBarVal: previousVal });\n                        }\n                        else if (editArgs.element) {\n                            formulaBar.value = editArgs.element.textContent;\n                        }\n                    }\n                });\n            });\n        }\n        this.updateComboBoxValue(address);\n    };\n    FormulaBar.prototype.getFormulaBarValue = function (cell) {\n        var value = '';\n        if (cell) {\n            if (cell.formula) {\n                value = cell.formula;\n            }\n            else if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.isNullOrUndefined)(cell.value) && cell.value !== '') {\n                var option = {};\n                var type = cell.format && (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.isCustomDateTime)(cell.format, true, option, true) && option.type;\n                if (type === 'date' || type === 'time' || type === 'datetime') {\n                    var dateVal = (0,_workbook_common_math__WEBPACK_IMPORTED_MODULE_6__.intToDate)(Number(cell.value));\n                    if (dateVal && dateVal.toString() !== 'Invalid Date' && dateVal.getFullYear() >= 1900) {\n                        var intl = new _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.Internationalization();\n                        var time = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getFormatFromType)('Time');\n                        if (time === 'h:mm:ss AM/PM') {\n                            time = 'h:mm:ss a';\n                        }\n                        var format = cell.format.toLowerCase();\n                        // isCustomDateTime returns as type 'time' for 'm', 'mm' and 'mmm' format, so we converting as 'date' type.\n                        if (type === 'time' && format.includes('m') && !format.includes(':m') && !format.includes('m:') &&\n                            !format.includes('[m') && !format.includes('am')) {\n                            type = 'date';\n                        }\n                        var valArr = cell.value.toString().split('.');\n                        var isDateTimeVal = valArr.length === 2;\n                        var timeVal = isDateTimeVal ? (0,_workbook_common_math__WEBPACK_IMPORTED_MODULE_6__.intToDate)(parseFloat((valArr[0] + 1) + '.' + valArr[1]) ||\n                            Number(cell.value)) : dateVal;\n                        if (type === 'date') {\n                            var dateObj = { type: 'date' };\n                            dateObj.skeleton = 'yMd';\n                            value = intl.formatDate(dateVal, dateObj);\n                            if (isDateTimeVal) {\n                                value += ' ' + intl.formatDate(timeVal, { type: 'time', skeleton: 'medium', format: time });\n                            }\n                        }\n                        else {\n                            if (Number(cell.value) >= 1 || type === 'datetime') {\n                                value = intl.formatDate(dateVal, { type: 'date', skeleton: 'yMd' }) + ' ';\n                            }\n                            value += intl.formatDate(timeVal, { type: 'time', skeleton: 'medium', format: time });\n                        }\n                    }\n                }\n                else if (cell.format && cell.format.includes('%') && (0,_workbook_common_math__WEBPACK_IMPORTED_MODULE_6__.isNumber)(cell.value)) {\n                    value = this.parent.getDisplayText(cell);\n                    if (!value.includes('%')) {\n                        value = '';\n                    }\n                }\n                if (!value) {\n                    value = cell.value.toString();\n                    if (value.toLowerCase() === 'true' || value.toLowerCase() === 'false') {\n                        value = value.toUpperCase();\n                    }\n                    else if (this.parent.locale !== 'en-US') {\n                        var decimalSep = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.getNumericObject)(this.parent.locale).decimal;\n                        if (decimalSep !== '.' && (0,_workbook_common_math__WEBPACK_IMPORTED_MODULE_6__.isNumber)(value) && value.includes('.')) {\n                            value = value.replace('.', decimalSep);\n                        }\n                    }\n                }\n            }\n            else if (cell.hyperlink) {\n                value = typeof cell.hyperlink === 'string' ? cell.hyperlink : (cell.hyperlink.address || '');\n            }\n        }\n        return value;\n    };\n    FormulaBar.prototype.updateValueAfterMouseUp = function () {\n        this.updateComboBoxValue(this.parent.getActiveSheet().selectedRange.split(':')[0]);\n    };\n    FormulaBar.prototype.updateComboBoxValue = function (value) {\n        var sheet = this.parent.getActiveSheet();\n        var range = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getSheetName)(this.parent) + '!' + sheet.selectedRange;\n        var eventArgs = {\n            action: 'getNameFromRange', range: range, definedName: null\n        };\n        this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.formulaOperation, eventArgs);\n        if (eventArgs.definedName) {\n            value = eventArgs.definedName.name;\n        }\n        if (!this.parent.isMobileView()) {\n            if (this.comboBoxInstance.text === value) {\n                return;\n            }\n            this.comboBoxInstance.text = value;\n            this.comboBoxInstance.dataBind();\n        }\n    };\n    FormulaBar.prototype.disabletextarea = function () {\n        var element = this.getFormulaBar();\n        if (this.parent.getActiveSheet().isProtected && !this.parent.isEdit) {\n            element.disabled = true;\n        }\n        else {\n            element.disabled = false;\n        }\n    };\n    FormulaBar.prototype.updateNameBoxValue = function (definedName, isRemove) {\n        var id = this.parent.element.id;\n        var comboBoxInstance = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.getComponent)(this.parent.element.querySelector(\"#\" + id + \"_name_box\"), 'combobox');\n        var activeSheet = this.parent.getActiveSheet();\n        if (isRemove) {\n            if (comboBoxInstance.text === definedName.name) {\n                comboBoxInstance.value = activeSheet.activeCell;\n                comboBoxInstance.dataBind();\n            }\n        }\n        else {\n            var refRangeArr = definedName.refersTo.split('!');\n            if (refRangeArr.length === 2 && definedName.refersTo.startsWith('=')) {\n                var refSheetName = refRangeArr[0].split('=')[1].replace(/'/g, '');\n                var referredRange = definedName.refersTo.split('!')[1];\n                if (refSheetName === activeSheet.name && referredRange === activeSheet.selectedRange) {\n                    comboBoxInstance.value = definedName.name;\n                    comboBoxInstance.dataBind();\n                }\n            }\n        }\n    };\n    FormulaBar.prototype.formulaBarScrollEdit = function () {\n        var index = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getRangeIndexes)(this.parent.getActiveSheet().selectedRange);\n        var viewportIndexes = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(this.parent.getActiveSheet().topLeftCell);\n        if (index[0] < viewportIndexes[0]) {\n            this.parent.goTo(this.parent.getActiveSheet().selectedRange);\n            this.isGoto = true;\n        }\n        this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.editOperation, { action: 'startEdit', refreshCurPos: false });\n    };\n    FormulaBar.prototype.formulaBarClickHandler = function (e) {\n        var target = e.target;\n        var sheet = this.parent.getActiveSheet();\n        var isSheetProtected = sheet.isProtected;\n        var range = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(sheet.activeCell);\n        var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getCell)(range[0], range[1], sheet);\n        var isCellLocked = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.isLocked)(cell, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getColumn)(sheet, range[1]));\n        if (target.classList.contains('e-drop-icon') && target.parentElement.classList.contains('e-formula-bar-panel')) {\n            this.toggleFormulaBar(target);\n        }\n        else if (target.classList.contains('e-formula-bar')) {\n            if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.isReadOnly)(cell, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getColumn)(sheet, range[1]), (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getRow)(sheet, range[0]))) {\n                this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.readonlyAlert, null);\n                return;\n            }\n            if ((!this.parent.isEdit && (!isSheetProtected || (isSheetProtected && !isCellLocked))) ||\n                (this.parent.isEdit && isSheetProtected && !target.disabled)) {\n                this.formulaBarScrollEdit();\n            }\n            else if (isSheetProtected && isCellLocked) {\n                this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.editAlert, null);\n            }\n        }\n        else if (target.parentElement && target.parentElement.classList.contains('e-name-box')) {\n            if (target.classList.contains('e-ddl-icon')) {\n                var eventArgs = { action: 'getNames', names: [] };\n                this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.formulaOperation, eventArgs);\n                if (this.comboBoxInstance.dataSource.length !== eventArgs.names.length ||\n                    this.comboBoxInstance.value === this.comboBoxInstance.text) {\n                    var searchText_1 = this.comboBoxInstance.text;\n                    this.comboBoxInstance.dataSource = eventArgs.names;\n                    var definedName = eventArgs.names.find(function (name) { return name.name === searchText_1; });\n                    this.comboBoxInstance.value = definedName ? definedName.refersTo : this.comboBoxInstance.value;\n                    this.comboBoxInstance.dataBind();\n                }\n            }\n            else {\n                this.comboBoxInstance.element.classList.add('e-name-editing');\n                this.comboBoxInstance.element.select();\n            }\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.isNullOrUndefined)(target.offsetParent) && ((target.offsetParent.classList.contains('e-insert-function')) ||\n            (target.classList.contains('e-insert-function')) || (this.parent.element.id + '_insert_function' === target.offsetParent.id)\n            || (this.parent.element.id + '_insert_function' === target.id) ||\n            target.parentElement.classList.contains('e-insert-function')\n            || (this.parent.element.id + '_insert_function' === target.parentElement.id))) {\n            this.renderInsertDlg();\n        }\n    };\n    FormulaBar.prototype.renderInsertDlg = function () {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var activeCell = (0,_workbook_common_address__WEBPACK_IMPORTED_MODULE_1__.getCellIndexes)(sheet.activeCell);\n        if (sheet.isProtected) {\n            if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.isLocked)((0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getCell)(activeCell[0], activeCell[1], sheet), (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getColumn)(sheet, activeCell[1])) && !this.parent.isEdit) {\n                this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.editAlert, null);\n                return;\n            }\n        }\n        var cell = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getCell)(activeCell[0], activeCell[1], sheet);\n        if ((0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.isReadOnly)(cell, (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getColumn)(sheet, activeCell[1]), (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getRow)(sheet, activeCell[0]))) {\n            this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.readonlyAlert, null);\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_0__.locale);\n        var isOpen = !this.parent.isEdit;\n        var args = { action: 'getCurrentEditValue', editedValue: '' };\n        if (!isOpen) {\n            var eventArgs = { action: 'isFormulaEditing', isFormulaEdit: false };\n            this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.formulaOperation, eventArgs);\n            isOpen = eventArgs.isFormulaEdit;\n            this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.editOperation, args);\n        }\n        if (isOpen || args.editedValue === '') {\n            if (!this.parent.element.querySelector('.e-spreadsheet-function-dlg')) {\n                if (args.editedValue === '') {\n                    this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.editOperation, { action: 'refreshEditor', value: '=' });\n                }\n                var formulaDescription = this.parent.createElement('div', { className: 'e-formula-description', id: this.parent.element.id + '_description_content' });\n                var categoryContent = this.parent.createElement('div', { className: 'e-category-content', id: this.parent.element.id + '_category_content' });\n                categoryContent.innerText = l10n.getConstant('PickACategory');\n                var dropDownElement = this.parent.createElement('input', { className: 'e-formula-category', id: this.parent.element.id + '_formula_category' });\n                var listViewElement = this.parent.createElement('div', { className: 'e-formula-list', id: this.parent.element.id + '_formula_list' });\n                var descriptionContent = this.parent.createElement('div', { className: 'e-description-content' });\n                descriptionContent.innerText = l10n.getConstant('Description');\n                var headerContent = this.parent.createElement('div', { className: 'e-header-content' });\n                headerContent.innerText = l10n.getConstant('InsertFunction');\n                var categoryArgs = { action: 'getFormulaCategory', categoryCollection: [] };\n                this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.workbookFormulaOperation, categoryArgs);\n                this.categoryCollection = categoryArgs.categoryCollection;\n                var categoryPopupOpen_1;\n                this.categoryList = new _syncfusion_ej2_dropdowns__WEBPACK_IMPORTED_MODULE_3__.DropDownList({\n                    dataSource: this.categoryCollection, cssClass: 'e-ss-formula-category', index: 0, width: '285px', popupHeight: '210px',\n                    select: this.dropDownSelect.bind(this),\n                    open: function () { return categoryPopupOpen_1 = true; },\n                    close: function () { return categoryPopupOpen_1 = false; }\n                });\n                var listArgs = { action: 'getLibraryFormulas', formulaCollection: [] };\n                this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.workbookFormulaOperation, listArgs);\n                this.formulaCollection = listArgs.formulaCollection;\n                this.formulaList = new _syncfusion_ej2_lists__WEBPACK_IMPORTED_MODULE_7__.ListView({\n                    dataSource: this.formulaCollection.sort(),\n                    actionComplete: this.updateFormulaList.bind(this),\n                    select: this.listSelected.bind(this), width: '285px', height: '200px'\n                });\n                var isCancelled_1;\n                this.dialog = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_0__.dialog);\n                this.dialog.show({\n                    header: headerContent.outerHTML,\n                    content: categoryContent.outerHTML + dropDownElement.outerHTML + listViewElement.outerHTML +\n                        descriptionContent.outerHTML + formulaDescription.outerHTML,\n                    width: '320px', height: '485px', cssClass: 'e-spreadsheet-function-dlg',\n                    showCloseIcon: true, isModal: true,\n                    beforeOpen: function (args) {\n                        var dlgArgs = {\n                            dialogName: 'InsertFunctionDialog', element: args.element, target: args.target, cancel: args.cancel\n                        };\n                        _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                        if (dlgArgs.cancel) {\n                            _this.dialog.dialogInstance.setProperties({ beforeClose: undefined }, true);\n                            isCancelled_1 = args.cancel = true;\n                        }\n                        else {\n                            (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(_this.parent.element);\n                        }\n                    },\n                    open: this.dialogOpen.bind(this), beforeClose: this.dialogBeforeClose.bind(this), close: this.dialogClose.bind(this),\n                    buttons: [\n                        {\n                            click: function (event) {\n                                if (event && event.keyCode === 13 && !categoryPopupOpen_1) {\n                                    return;\n                                }\n                                _this.selectFormula();\n                            },\n                            buttonModel: { content: l10n.getConstant('Ok'), isPrimary: true }\n                        }\n                    ]\n                });\n                if (isCancelled_1) {\n                    this.categoryList = this.formulaList = null;\n                }\n                else {\n                    this.categoryList.appendTo('#' + this.parent.element.id + '_formula_category');\n                    this.formulaList.appendTo('#' + this.parent.element.id + '_formula_list');\n                    _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.EventHandler.add(this.formulaList.element, 'dblclick', this.formulaClickHandler, this);\n                }\n            }\n        }\n    };\n    FormulaBar.prototype.toggleFormulaBar = function (target) {\n        var parent = target.parentElement;\n        var l10n = this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_0__.locale);\n        if (parent.classList.contains('e-expanded')) {\n            parent.classList.remove('e-expanded');\n            document.getElementById(this.parent.element.id + '_formula_input').rows = 1;\n            target.title = l10n.getConstant('ExpandFormulaBar');\n            target.setAttribute('aria-label', l10n.getConstant('CollapseFormulaBar'));\n        }\n        else {\n            parent.classList.add('e-expanded');\n            document.getElementById(this.parent.element.id + '_formula_input').rows = 3;\n            target.title = l10n.getConstant('CollapseFormulaBar');\n            target.setAttribute('aria-label', l10n.getConstant('ExpandFormulaBar'));\n        }\n        this.parent.setPanelSize();\n    };\n    FormulaBar.prototype.dialogOpen = function () {\n        var _this = this;\n        (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.getUpdateUsingRaf)(function () {\n            var okBtn = _this.dialog.dialogInstance.element.querySelector('.e-footer-content .e-primary');\n            var l10n = _this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_0__.locale);\n            okBtn.setAttribute('aria-label', l10n.getConstant('InsertFunction') + ' ' + l10n.getConstant('Ok'));\n            if (_this.categoryList) {\n                (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.focus)(_this.categoryList.element);\n            }\n        });\n    };\n    FormulaBar.prototype.dialogClose = function () {\n        var args = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.editOperation, args);\n        if (args.editedValue.toString().trim() === '=') {\n            this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.editOperation, { action: 'refreshEditor', value: '' });\n        }\n    };\n    FormulaBar.prototype.dialogBeforeClose = function () {\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.EventHandler.remove(this.formulaList.element, 'dblclick', this.formulaClickHandler);\n        var dialogContentEle = document.getElementsByClassName('e-spreadsheet-function-dlg')[0].\n            querySelector('.e-dlg-content');\n        dialogContentEle.parentNode.removeChild(dialogContentEle);\n        this.categoryList.destroy();\n        this.categoryList = null;\n        this.formulaList.destroy();\n        this.formulaList = null;\n    };\n    FormulaBar.prototype.selectFormula = function () {\n        var formulaText = this.formulaList.getSelectedItems().text;\n        var sheet = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getSheet)(this.parent, this.parent.activeSheetIndex);\n        if (this.parent.isEdit) {\n            this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.editOperation, {\n                action: 'refreshEditor', value: formulaText + '(', refreshFormulaBar: true,\n                refreshEditorElem: true, isAppend: true\n            });\n        }\n        else {\n            this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.editOperation, { action: 'startEdit', value: '=' + formulaText + '(', address: sheet.activeCell });\n            this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.formulaBarOperation, { action: 'refreshFormulabar', value: '=' + formulaText + '(' });\n        }\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        this.dialog.dialogInstance.storeActiveElement = document.getElementById(this.parent.element.id + '_edit');\n        this.dialog.hide();\n    };\n    FormulaBar.prototype.listSelected = function (args) {\n        this.updateFormulaDescription();\n        if (args.isInteracted && args.item) {\n            args.item.focus();\n        }\n    };\n    FormulaBar.prototype.updateFormulaList = function () {\n        this.activeListFormula();\n        this.updateFormulaDescription();\n    };\n    FormulaBar.prototype.dropDownSelect = function (args) {\n        this.formulaCollection = [];\n        var listArgs = {\n            action: 'getLibraryFormulas',\n            formulaCollection: []\n        };\n        if (args.item.textContent === 'All') {\n            this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.workbookFormulaOperation, listArgs);\n            this.formulaCollection = listArgs.formulaCollection;\n        }\n        else {\n            var category = args.item.textContent;\n            var selectArgs = {\n                action: 'dropDownSelectFormulas',\n                formulaCollection: [],\n                selectCategory: category\n            };\n            this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.workbookFormulaOperation, selectArgs);\n            this.formulaCollection = selectArgs.formulaCollection;\n        }\n        this.formulaList.dataSource = this.formulaCollection.sort();\n    };\n    FormulaBar.prototype.activeListFormula = function () {\n        var acListEle = document.getElementById(this.parent.element.id + '_formula_list');\n        var firstElement = acListEle.children[0].children[0].firstElementChild;\n        this.formulaList.selectItem(firstElement);\n    };\n    FormulaBar.prototype.updateFormulaDescription = function () {\n        var selectedFormula = this.formulaList.getSelectedItems().text;\n        var descriptionArgs = {\n            action: 'getFormulaDescription',\n            description: '',\n            selectedList: selectedFormula,\n            isCustom: false\n        };\n        this.parent.notify(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.workbookFormulaOperation, descriptionArgs);\n        var okBtn = this.dialog.dialogInstance.element.querySelector('.e-footer-content .e-primary');\n        if (okBtn.hasAttribute('aria-label')) {\n            okBtn.removeAttribute('aria-label');\n        }\n        var descriptionArea = document.getElementById(this.parent.element.id + '_description_content');\n        selectedFormula = (selectedFormula === 'AND') ? 'CalculateAND' : (selectedFormula === 'OR') ? 'CalculateOR' : selectedFormula;\n        descriptionArea.textContent = descriptionArgs.isCustom ? descriptionArgs.description :\n            this.parent.serviceLocator.getService(_common_index__WEBPACK_IMPORTED_MODULE_0__.locale).getConstant(selectedFormula);\n    };\n    FormulaBar.prototype.formulaClickHandler = function (args) {\n        var trgtElem = args.target;\n        var sheet = (0,_workbook_index__WEBPACK_IMPORTED_MODULE_2__.getSheet)(this.parent, this.parent.activeSheetIndex);\n        if (trgtElem.offsetParent.classList.contains('e-text-content') || trgtElem.classList.contains('e-list-item')) {\n            if (this.parent.isEdit) {\n                this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.editOperation, {\n                    action: 'refreshEditor', value: trgtElem.innerText + '(', refreshFormulaBar: true,\n                    refreshEditorElem: true, isAppend: true\n                });\n            }\n            else {\n                this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.editOperation, { action: 'startEdit', value: '=' + trgtElem.innerText + '(', address: sheet.activeCell });\n                this.parent.notify(_common_event__WEBPACK_IMPORTED_MODULE_5__.formulaBarOperation, { action: 'refreshFormulabar', value: '=' + trgtElem.innerText + '(' });\n            }\n            this.dialog.hide();\n        }\n    };\n    FormulaBar.prototype.addEventListener = function () {\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.formulaBar, this.createFormulaBar, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.click, this.formulaBarClickHandler, this);\n        this.parent.on(_common_event__WEBPACK_IMPORTED_MODULE_5__.keyDown, this.keyDownHandler, this);\n        this.parent.on(_common_event__WEBPACK_IMPORTED_MODULE_5__.renderInsertDlg, this.renderInsertDlg, this);\n        this.parent.on(_common_event__WEBPACK_IMPORTED_MODULE_5__.keyUp, this.keyUpHandler, this);\n        this.parent.on(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.selectionComplete, this.formulaBarUpdateHandler, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.mouseUpAfterSelection, this.updateValueAfterMouseUp, this);\n        this.parent.on(_common_event__WEBPACK_IMPORTED_MODULE_5__.formulaBarOperation, this.editOperationHandler, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.enableFormulaInput, this.disabletextarea, this);\n        this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.isFormulaBarEdit, this.isFormulaBarEdit, this);\n    };\n    FormulaBar.prototype.destroy = function () {\n        this.removeEventListener();\n        if (this.comboBoxInstance) {\n            this.comboBoxInstance.destroy();\n        }\n        this.comboBoxInstance = null;\n        this.categoryCollection = null;\n        this.formulaCollection = null;\n        this.dialog = null;\n        this.isGoto = null;\n        if (this.insertFnRipple) {\n            this.insertFnRipple();\n        }\n        this.insertFnRipple = null;\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        if (formulaPanel) {\n            (0,_common_index__WEBPACK_IMPORTED_MODULE_0__.removeAllChildren)(formulaPanel);\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.detach)(formulaPanel);\n        }\n        this.parent = null;\n    };\n    FormulaBar.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.formulaBar, this.createFormulaBar);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.click, this.formulaBarClickHandler);\n            this.parent.off(_common_event__WEBPACK_IMPORTED_MODULE_5__.renderInsertDlg, this.renderInsertDlg);\n            this.parent.off(_common_event__WEBPACK_IMPORTED_MODULE_5__.keyDown, this.keyDownHandler);\n            this.parent.off(_common_event__WEBPACK_IMPORTED_MODULE_5__.keyUp, this.keyUpHandler);\n            this.parent.off(_workbook_index__WEBPACK_IMPORTED_MODULE_2__.selectionComplete, this.formulaBarUpdateHandler);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.mouseUpAfterSelection, this.updateValueAfterMouseUp);\n            this.parent.off(_common_event__WEBPACK_IMPORTED_MODULE_5__.formulaBarOperation, this.editOperationHandler);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.enableFormulaInput, this.disabletextarea);\n            this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.isFormulaBarEdit, this.isFormulaBarEdit);\n        }\n    };\n    FormulaBar.prototype.editOperationHandler = function (args) {\n        switch (args.action) {\n            case 'refreshFormulabar':\n                if (args.cell) {\n                    this.getFormulaBar().value = this.getFormulaBarValue(args.cell);\n                }\n                else {\n                    this.getFormulaBar().value = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.isUndefined)(args.value) ? '' : args.value;\n                }\n                break;\n            case 'setNameBoxValue':\n                this.updateNameBoxValue(args.definedName, args.isRemove);\n                break;\n            case 'getElement':\n                args.element = this.getFormulaBar();\n                break;\n        }\n    };\n    FormulaBar.prototype.isFormulaBarEdit = function (args) {\n        var edit = this.parent.isEdit;\n        if (edit && this.isGoto) {\n            args.isEdit = true;\n        }\n        else {\n            args.isEdit = false;\n        }\n    };\n    FormulaBar.prototype.getFormulaBar = function () {\n        return (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_4__.select)('#' + this.parent.element.id + '_formula_input', this.parent.element);\n    };\n    return FormulaBar;\n}());\n\n\n\n//# sourceURL=webpack://ej2-vue-samples/./node_modules/@syncfusion/ej2-spreadsheet/src/spreadsheet/integrations/formula-bar.js?");

/***/ })

}]);